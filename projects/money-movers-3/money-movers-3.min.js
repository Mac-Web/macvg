!function(t){var e;"object"==typeof exports?module.exports=t():("undefined"!=typeof window?e=window:"undefined"!=typeof global?e=global:"undefined"!=typeof self&&(e=self),e.p2=t())}(function(){return function n(r,o,s){function a(e,t){if(!o[e]){if(!r[e]){var i="function"==typeof require&&require;if(!t&&i)return i(e,!0);if(h)return h(e,!0);throw new Error("Cannot find module '"+e+"'")}i=o[e]={exports:{}};r[e][0].call(i.exports,function(t){return a(r[e][1][t]||t)},i,i.exports,n,r,o,s)}return o[e].exports}for(var h="function"==typeof require&&require,t=0;t<s.length;t++)a(s[t]);return a}({1:[function(t,e,i){function n(){}var l=t("./Scalar");(e.exports=n).lineInt=function(t,e,i){var n=[0,0],r=t[1][1]-t[0][1],o=t[0][0]-t[1][0],s=r*t[0][0]+o*t[0][1],a=e[1][1]-e[0][1],h=e[0][0]-e[1][0],t=a*e[0][0]+h*e[0][1],e=r*h-a*o;return l.eq(e,0,i=i||0)||(n[0]=(h*s-o*t)/e,n[1]=(r*t-a*s)/e),n},n.segmentsIntersect=function(t,e,i,n){var r=e[0]-t[0],o=e[1]-t[1],s=n[0]-i[0],e=n[1]-i[1];if(s*o-e*r==0)return!1;n=(r*(i[1]-t[1])+o*(t[0]-i[0]))/(s*o-e*r),o=(s*(t[1]-i[1])+e*(i[0]-t[0]))/(e*r-s*o);return 0<=n&&n<=1&&0<=o&&o<=1}},{"./Scalar":4}],2:[function(t,e,i){function a(){}(e.exports=a).area=function(t,e,i){return(e[0]-t[0])*(i[1]-t[1])-(i[0]-t[0])*(e[1]-t[1])},a.left=function(t,e,i){return 0<a.area(t,e,i)},a.leftOn=function(t,e,i){return 0<=a.area(t,e,i)},a.right=function(t,e,i){return a.area(t,e,i)<0},a.rightOn=function(t,e,i){return a.area(t,e,i)<=0};var h=[],l=[];a.collinear=function(t,e,i,n){if(n){var r=h,o=l;r[0]=e[0]-t[0],r[1]=e[1]-t[1],o[0]=i[0]-e[0],o[1]=i[1]-e[1];var s=r[0]*o[0]+r[1]*o[1],r=Math.sqrt(r[0]*r[0]+r[1]*r[1]),o=Math.sqrt(o[0]*o[0]+o[1]*o[1]);return Math.acos(s/(r*o))<n}return 0==a.area(t,e,i)},a.sqdist=function(t,e){var i=e[0]-t[0],t=e[1]-t[1];return i*i+t*t}},{}],3:[function(t,e,i){function z(){this.vertices=[]}function b(t,e,i,n,r){var o=e[1]-t[1],s=t[0]-e[0],a=o*t[0]+s*t[1],e=n[1]-i[1],t=i[0]-n[0],n=e*i[0]+t*i[1],i=o*t-e*s;return h.eq(i,0,r=r||0)?[0,0]:[(t*a-s*n)/i,(o*n-e*a)/i]}var a=t("./Line"),S=t("./Point"),h=t("./Scalar");(e.exports=z).prototype.at=function(t){var e=this.vertices,i=e.length;return e[t<0?t%i+i:t%i]},z.prototype.first=function(){return this.vertices[0]},z.prototype.last=function(){return this.vertices[this.vertices.length-1]},z.prototype.clear=function(){this.vertices.length=0},z.prototype.append=function(t,e,i){if(void 0===e)throw new Error("From is not given!");if(void 0===i)throw new Error("To is not given!");if(i-1<e)throw new Error("lol1");if(i>t.vertices.length)throw new Error("lol2");if(e<0)throw new Error("lol3");for(var n=e;n<i;n++)this.vertices.push(t.vertices[n])},z.prototype.makeCCW=function(){for(var t=0,e=this.vertices,i=1;i<this.vertices.length;++i)(e[i][1]<e[t][1]||e[i][1]==e[t][1]&&e[i][0]>e[t][0])&&(t=i);S.left(this.at(t-1),this.at(t),this.at(t+1))||this.reverse()},z.prototype.reverse=function(){for(var t=[],e=0,i=this.vertices.length;e!==i;e++)t.push(this.vertices.pop());this.vertices=t},z.prototype.isReflex=function(t){return S.right(this.at(t-1),this.at(t),this.at(t+1))};var l=[],p=[];z.prototype.canSee=function(t,e){var i,n=l,r=p;if(S.leftOn(this.at(t+1),this.at(t),this.at(e))&&S.rightOn(this.at(t-1),this.at(t),this.at(e)))return!1;for(var o=S.sqdist(this.at(t),this.at(e)),s=0;s!==this.vertices.length;++s)if((s+1)%this.vertices.length!==t&&s!==t&&S.leftOn(this.at(t),this.at(e),this.at(s+1))&&S.rightOn(this.at(t),this.at(e),this.at(s))&&(n[0]=this.at(t),n[1]=this.at(e),r[0]=this.at(s),r[1]=this.at(s+1),i=a.lineInt(n,r),S.sqdist(this.at(t),i)<o))return!1;return!0},z.prototype.copy=function(t,e,i){var n=i||new z;if(n.clear(),t<e)for(var r=t;r<=e;r++)n.vertices.push(this.vertices[r]);else{for(r=0;r<=e;r++)n.vertices.push(this.vertices[r]);for(r=t;r<this.vertices.length;r++)n.vertices.push(this.vertices[r])}return n},z.prototype.getCutEdges=function(){for(var t=[],e=[],i=new z,n=Number.MAX_VALUE,r=0;r<this.vertices.length;++r)if(this.isReflex(r))for(var o=0;o<this.vertices.length;++o)if(this.canSee(r,o)){for(var e=this.copy(r,o,i).getCutEdges(),s=this.copy(o,r,i).getCutEdges(),a=0;a<s.length;a++)e.push(s[a]);e.length<n&&(n=(t=e).length,t.push([this.at(r),this.at(o)]))}return t},z.prototype.decomp=function(){var t=this.getCutEdges();return 0<t.length?this.slice(t):[this]},z.prototype.slice=function(t){if(0==t.length)return[this];if(t instanceof Array&&t.length&&t[0]instanceof Array&&2==t[0].length&&t[0][0]instanceof Array){for(var e=[this],i=0;i<t.length;i++)for(var n=t[i],r=0;r<e.length;r++){var o=e[r].slice(n);if(o){e.splice(r,1),e.push(o[0],o[1]);break}}return e}n=t,i=this.vertices.indexOf(n[0]),r=this.vertices.indexOf(n[1]);return-1!=i&&-1!=r&&[this.copy(i,r),this.copy(r,i)]},z.prototype.isSimple=function(){for(var t=this.vertices,e=0;e<t.length-1;e++)for(var i=0;i<e-1;i++)if(a.segmentsIntersect(t[e],t[e+1],t[i],t[i+1]))return!1;for(e=1;e<t.length-2;e++)if(a.segmentsIntersect(t[0],t[t.length-1],t[e],t[e+1]))return!1;return!0},z.prototype.quickDecomp=function(t,e,i,n,r,o){r=r||100,o=o||0,n=n||25,t=void 0!==t?t:[],e=e||[],i=i||[];var s=[0,0],a=[0,0],h=[0,0],l=0,p=0,u=0,d=0,c=0,y=0,_=0,m=new z,g=new z,f=this,x=this.vertices;if(x.length<3)return t;if(++o>r)return t;for(var v=0;v<this.vertices.length;++v)if(f.isReflex(v)){e.push(f.vertices[v]);for(var l=p=Number.MAX_VALUE,w=0;w<this.vertices.length;++w)S.left(f.at(v-1),f.at(v),f.at(w))&&S.rightOn(f.at(v-1),f.at(v),f.at(w-1))&&(h=b(f.at(v-1),f.at(v),f.at(w),f.at(w-1)),S.right(f.at(v+1),f.at(v),h)&&(u=S.sqdist(f.vertices[v],h))<p&&(p=u,a=h,y=w)),S.left(f.at(v+1),f.at(v),f.at(w+1))&&S.rightOn(f.at(v+1),f.at(v),f.at(w))&&(h=b(f.at(v+1),f.at(v),f.at(w),f.at(w+1)),S.left(f.at(v-1),f.at(v),h)&&(u=S.sqdist(f.vertices[v],h))<l&&(l=u,s=h,c=w));if(y==(c+1)%this.vertices.length)h[0]=(a[0]+s[0])/2,h[1]=(a[1]+s[1])/2,i.push(h),v<c?(m.append(f,v,c+1),m.vertices.push(h),g.vertices.push(h),0!=y&&g.append(f,y,f.vertices.length),g.append(f,0,v+1)):(0!=v&&m.append(f,v,f.vertices.length),m.append(f,0,c+1),m.vertices.push(h),g.vertices.push(h),g.append(f,y,v+1));else{if(c<y&&(c+=this.vertices.length),d=Number.MAX_VALUE,c<y)return t;for(w=y;w<=c;++w)S.leftOn(f.at(v-1),f.at(v),f.at(w))&&S.rightOn(f.at(v+1),f.at(v),f.at(w))&&(u=S.sqdist(f.at(v),f.at(w)))<d&&(d=u,_=w%this.vertices.length);v<_?(m.append(f,v,_+1),0!=_&&g.append(f,_,x.length),g.append(f,0,v+1)):(0!=v&&m.append(f,v,x.length),m.append(f,0,_+1),g.append(f,_,v+1))}return m.vertices.length<g.vertices.length?(m.quickDecomp(t,e,i,n,r,o),g.quickDecomp(t,e,i,n,r,o)):(g.quickDecomp(t,e,i,n,r,o),m.quickDecomp(t,e,i,n,r,o)),t}return t.push(this),t},z.prototype.removeCollinearPoints=function(t){for(var e=0,i=this.vertices.length-1;3<this.vertices.length&&0<=i;--i)S.collinear(this.at(i-1),this.at(i),this.at(i+1),t)&&(this.vertices.splice(i%this.vertices.length,1),i--,e++);return e}},{"./Line":1,"./Point":2,"./Scalar":4}],4:[function(t,e,i){function n(){}(e.exports=n).eq=function(t,e,i){return i=i||0,Math.abs(t-e)<i}},{}],5:[function(t,e,i){e.exports={Polygon:t("./Polygon"),Point:t("./Point")}},{"./Point":2,"./Polygon":3}],6:[function(t,e,i){e.exports={name:"p2",version:"0.7.0",description:"A JavaScript 2D physics engine.",author:"Stefan Hedman <schteppe@gmail.com> (http://steffe.se)",keywords:["p2.js","p2","physics","engine","2d"],main:"./src/p2.js",engines:{node:"*"},repository:{type:"git",url:"https://github.com/schteppe/p2.js.git"},bugs:{url:"https://github.com/schteppe/p2.js/issues"},licenses:[{type:"MIT"}],devDependencies:{grunt:"^0.4.5","grunt-contrib-jshint":"^0.11.2","grunt-contrib-nodeunit":"^0.4.1","grunt-contrib-uglify":"~0.4.0","grunt-contrib-watch":"~0.5.0","grunt-browserify":"~2.0.1","grunt-contrib-concat":"^0.4.0"},dependencies:{"poly-decomp":"0.1.0"}}},{}],7:[function(t,e,i){function n(t){this.lowerBound=c.create(),t&&t.lowerBound&&c.copy(this.lowerBound,t.lowerBound),this.upperBound=c.create(),t&&t.upperBound&&c.copy(this.upperBound,t.upperBound)}var c=t("../math/vec2");t("../utils/Utils"),e.exports=n;var y=c.create();n.prototype.setFromPoints=function(t,e,i,n){var r=this.lowerBound,o=this.upperBound;0!==(i="number"!=typeof i?0:i)?c.rotate(r,t[0],i):c.copy(r,t[0]),c.copy(o,r);for(var s=Math.cos(i),a=Math.sin(i),h=1;h<t.length;h++){var l,p,u=t[h];0!==i&&(l=u[0],p=u[1],y[0]=s*l-a*p,y[1]=a*l+s*p,u=y);for(var d=0;d<2;d++)u[d]>o[d]&&(o[d]=u[d]),u[d]<r[d]&&(r[d]=u[d])}e&&(c.add(this.lowerBound,this.lowerBound,e),c.add(this.upperBound,this.upperBound,e)),n&&(this.lowerBound[0]-=n,this.lowerBound[1]-=n,this.upperBound[0]+=n,this.upperBound[1]+=n)},n.prototype.copy=function(t){c.copy(this.lowerBound,t.lowerBound),c.copy(this.upperBound,t.upperBound)},n.prototype.extend=function(t){for(var e=2;e--;){var i=t.lowerBound[e];this.lowerBound[e]>i&&(this.lowerBound[e]=i);i=t.upperBound[e];this.upperBound[e]<i&&(this.upperBound[e]=i)}},n.prototype.overlaps=function(t){var e=this.lowerBound,i=this.upperBound,n=t.lowerBound,t=t.upperBound;return(n[0]<=i[0]&&i[0]<=t[0]||e[0]<=t[0]&&t[0]<=i[0])&&(n[1]<=i[1]&&i[1]<=t[1]||e[1]<=t[1]&&t[1]<=i[1])},n.prototype.containsPoint=function(t){var e=this.lowerBound,i=this.upperBound;return e[0]<=t[0]&&t[0]<=i[0]&&e[1]<=t[1]&&t[1]<=i[1]},n.prototype.overlapsRay=function(t){var e=1/t.direction[0],i=1/t.direction[1],n=(this.lowerBound[0]-t.from[0])*e,r=(this.upperBound[0]-t.from[0])*e,e=(this.lowerBound[1]-t.from[1])*i,t=(this.upperBound[1]-t.from[1])*i,i=Math.max(Math.max(Math.min(n,r),Math.min(e,t))),t=Math.min(Math.min(Math.max(n,r),Math.max(e,t)));return t<0||t<i?-1:i}},{"../math/vec2":30,"../utils/Utils":57}],8:[function(t,e,i){function n(t){this.type=t,this.result=[],this.world=null,this.boundingVolumeType=n.AABB}var r=t("../math/vec2"),o=t("../objects/Body");(e.exports=n).AABB=1,n.BOUNDING_CIRCLE=2,n.prototype.setWorld=function(t){this.world=t},n.prototype.getCollisionPairs=function(t){};var s=r.create();n.boundingRadiusCheck=function(t,e){r.sub(s,t.position,e.position);var i=r.squaredLength(s),e=t.boundingRadius+e.boundingRadius;return i<=e*e},n.aabbCheck=function(t,e){return t.getAABB().overlaps(e.getAABB())},n.prototype.boundingVolumeCheck=function(t,e){var i;switch(this.boundingVolumeType){case n.BOUNDING_CIRCLE:i=n.boundingRadiusCheck(t,e);break;case n.AABB:i=n.aabbCheck(t,e);break;default:throw new Error("Bounding volume type not recognized: "+this.boundingVolumeType)}return i},n.canCollide=function(t,e){var i=o.KINEMATIC,n=o.STATIC;return!(t.type===n&&e.type===n||t.type===i&&e.type===n||t.type===n&&e.type===i||t.type===i&&e.type===i||t.sleepState===o.SLEEPING&&e.sleepState===o.SLEEPING||t.sleepState===o.SLEEPING&&e.type===n||e.sleepState===o.SLEEPING&&t.type===n)},n.NAIVE=1,n.SAP=2},{"../math/vec2":30,"../objects/Body":31}],9:[function(t,e,i){function n(){h.call(this,h.NAIVE)}var h=(t("../shapes/Circle"),t("../shapes/Plane"),t("../shapes/Shape"),t("../shapes/Particle"),t("../collision/Broadphase"));t("../math/vec2"),(((e.exports=n).prototype=new h).constructor=n).prototype.getCollisionPairs=function(t){for(var e=t.bodies,i=this.result,n=i.length=0,r=e.length;n!==r;n++)for(var o=e[n],s=0;s<n;s++){var a=e[s];h.canCollide(o,a)&&this.boundingVolumeCheck(o,a)&&i.push(o,a)}return i},n.prototype.aabbQuery=function(t,e,i){i=i||[];for(var n=t.bodies,r=0;r<n.length;r++){var o=n[r];o.aabbNeedsUpdate&&o.updateAABB(),o.aabb.overlaps(e)&&i.push(o)}return i}},{"../collision/Broadphase":8,"../math/vec2":30,"../shapes/Circle":39,"../shapes/Particle":43,"../shapes/Plane":44,"../shapes/Shape":45}],10:[function(t,e,i){function N(){this.contactEquations=[],this.frictionEquations=[],this.enableFriction=!0,this.enabledEquations=!0,this.slipForce=10,this.frictionCoefficient=.3,this.surfaceVelocity=0,this.contactEquationPool=new n({size:32}),this.frictionEquationPool=new r({size:64}),this.restitution=0,this.stiffness=s.DEFAULT_STIFFNESS,this.relaxation=s.DEFAULT_RELAXATION,this.frictionStiffness=s.DEFAULT_STIFFNESS,this.frictionRelaxation=s.DEFAULT_RELAXATION,this.enableFrictionReduction=!0,this.collidingBodiesLastStep=new o,this.contactSkinSize=.01}function f(t,e){j.set(t.vertices[0],.5*-e.length,-e.radius),j.set(t.vertices[1],.5*e.length,-e.radius),j.set(t.vertices[2],.5*e.length,e.radius),j.set(t.vertices[3],.5*-e.length,e.radius)}function A(t,e,i,n){for(var r=y,o=_,s=m,a=g,h=t,l=e.vertices,p=null,u=0;u!==l.length+1;u++){var d=l[u%l.length],c=l[(u+1)%l.length];j.rotate(r,d,n),j.rotate(o,c,n),V(r,r,i),V(o,o,i),U(s,r,h),U(a,o,h);c=j.crossLength(s,a);if(c*(p=null===p?c:p)<=0)return;p=c}return 1}var j=t("../math/vec2"),U=j.sub,V=j.add,W=j.dot,n=(t("../utils/Utils"),t("../utils/ContactEquationPool")),r=t("../utils/FrictionEquationPool"),o=t("../utils/TupleDictionary"),s=t("../equations/Equation"),a=(t("../equations/ContactEquation"),t("../equations/FrictionEquation"),t("../shapes/Circle")),h=t("../shapes/Convex"),l=t("../shapes/Shape"),b=(t("../objects/Body"),t("../shapes/Box"));e.exports=N;var S=j.fromValues(0,1),X=j.fromValues(0,0),H=j.fromValues(0,0),q=j.fromValues(0,0),Y=j.fromValues(0,0),K=j.fromValues(0,0),k=j.fromValues(0,0),Z=j.fromValues(0,0),J=j.fromValues(0,0),Q=j.fromValues(0,0),O=j.fromValues(0,0),E=j.fromValues(0,0),I=j.fromValues(0,0),G=j.fromValues(0,0),D=j.fromValues(0,0),L=j.fromValues(0,0),B=j.fromValues(0,0),P=j.fromValues(0,0),M=j.fromValues(0,0),R=[],p=j.create(),u=j.create();N.prototype.bodiesOverlap=function(t,e){for(var i=p,n=u,r=0,o=t.shapes.length;r!==o;r++){var s=t.shapes[r];t.toWorldFrame(i,s.position);for(var a=0,h=e.shapes.length;a!==h;a++){var l=e.shapes[a];if(e.toWorldFrame(n,l.position),this[s.type|l.type](t,s,i,s.angle+t.angle,e,l,n,l.angle+e.angle,!0))return!0}}return!1},N.prototype.collidedLastStep=function(t,e){t=0|t.id,e=0|e.id;return!!this.collidingBodiesLastStep.get(t,e)},N.prototype.reset=function(){this.collidingBodiesLastStep.reset();for(var t=this.contactEquations,e=t.length;e--;){var i=t[e],n=i.bodyA.id,i=i.bodyB.id;this.collidingBodiesLastStep.set(n,i,!0)}for(var r=this.contactEquations,o=this.frictionEquations,s=0;s<r.length;s++)this.contactEquationPool.release(r[s]);for(s=0;s<o.length;s++)this.frictionEquationPool.release(o[s]);this.contactEquations.length=this.frictionEquations.length=0},N.prototype.createContactEquation=function(t,e,i,n){var r=this.contactEquationPool.get();return r.bodyA=t,r.bodyB=e,r.shapeA=i,r.shapeB=n,r.restitution=this.restitution,r.firstImpact=!this.collidedLastStep(t,e),r.stiffness=this.stiffness,r.relaxation=this.relaxation,r.needsUpdate=!0,r.enabled=this.enabledEquations,r.offset=this.contactSkinSize,r},N.prototype.createFrictionEquation=function(t,e,i,n){var r=this.frictionEquationPool.get();return r.bodyA=t,r.bodyB=e,r.shapeA=i,r.shapeB=n,r.setSlipForce(this.slipForce),r.frictionCoefficient=this.frictionCoefficient,r.relativeVelocity=this.surfaceVelocity,r.enabled=this.enabledEquations,r.needsUpdate=!0,r.stiffness=this.frictionStiffness,r.relaxation=this.frictionRelaxation,r.contactEquations.length=0,r},N.prototype.createFrictionFromContact=function(t){var e=this.createFrictionEquation(t.bodyA,t.bodyB,t.shapeA,t.shapeB);return j.copy(e.contactPointA,t.contactPointA),j.copy(e.contactPointB,t.contactPointB),j.rotate90cw(e.t,t.normalA),e.contactEquations.push(t),e},N.prototype.createFrictionFromAverage=function(t){var e=this.contactEquations[this.contactEquations.length-1],i=this.createFrictionEquation(e.bodyA,e.bodyB,e.shapeA,e.shapeB),n=e.bodyA;e.bodyB,j.set(i.contactPointA,0,0),j.set(i.contactPointB,0,0),j.set(i.t,0,0);for(var r=0;r!==t;r++)(e=this.contactEquations[this.contactEquations.length-1-r]).bodyA===n?(j.add(i.t,i.t,e.normalA),j.add(i.contactPointA,i.contactPointA,e.contactPointA),j.add(i.contactPointB,i.contactPointB,e.contactPointB)):(j.sub(i.t,i.t,e.normalA),j.add(i.contactPointA,i.contactPointA,e.contactPointB),j.add(i.contactPointB,i.contactPointB,e.contactPointA)),i.contactEquations.push(e);var o=1/t;return j.scale(i.contactPointA,i.contactPointA,o),j.scale(i.contactPointB,i.contactPointB,o),j.normalize(i.t,i.t),j.rotate90cw(i.t,i.t),i},N.prototype[l.LINE|l.CONVEX]=N.prototype.convexLine=function(t,e,i,n,r,o,s,a,h){return!h&&0},N.prototype[l.LINE|l.BOX]=N.prototype.lineBox=function(t,e,i,n,r,o,s,a,h){return!h&&0};var d=new b({width:1,height:1}),c=j.create();N.prototype[l.CAPSULE|l.CONVEX]=N.prototype[l.CAPSULE|l.BOX]=N.prototype.convexCapsule=function(t,e,i,n,r,o,s,a,h){var l=c;j.set(l,o.length/2,0),j.rotate(l,l,a),j.add(l,l,s);var p=this.circleConvex(r,o,l,a,t,e,i,n,h,o.radius);j.set(l,-o.length/2,0),j.rotate(l,l,a),j.add(l,l,s);var u=this.circleConvex(r,o,l,a,t,e,i,n,h,o.radius);if(h&&(p||u))return!0;l=d;return f(l,o),this.convexConvex(t,e,i,n,r,l,s,a,h)+p+u},N.prototype[l.CAPSULE|l.LINE]=N.prototype.lineCapsule=function(t,e,i,n,r,o,s,a,h){return!h&&0};var x=j.create(),v=j.create(),w=new b({width:1,height:1});N.prototype[l.CAPSULE|l.CAPSULE]=N.prototype.capsuleCapsule=function(t,e,i,n,r,o,s,a,h){for(var l=x,p=v,u=0,d=0;d<2;d++){j.set(l,(0===d?-1:1)*e.length/2,0),j.rotate(l,l,n),j.add(l,l,i);for(var c=0;c<2;c++){j.set(p,(0===c?-1:1)*o.length/2,0),j.rotate(p,p,a),j.add(p,p,s),this.enableFrictionReduction&&(m=this.enableFriction,this.enableFriction=!1);var y=this.circleCircle(t,e,l,n,r,o,p,a,h,e.radius,o.radius);if(this.enableFrictionReduction&&(this.enableFriction=m),h&&y)return!0;u+=y}}this.enableFrictionReduction&&(m=this.enableFriction,this.enableFriction=!1);var _=w;f(_,e);var m,g=this.convexCapsule(t,_,i,n,r,o,s,a,h);if(this.enableFrictionReduction&&(this.enableFriction=m),h&&g)return!0;u+=g,this.enableFrictionReduction&&(m=this.enableFriction,this.enableFriction=!1),f(_,o);_=this.convexCapsule(r,_,s,a,t,e,i,n,h);return this.enableFrictionReduction&&(this.enableFriction=m),!(!h||!_)||(u+=_,this.enableFrictionReduction&&u&&this.enableFriction&&this.frictionEquations.push(this.createFrictionFromAverage(u)),u)},N.prototype[l.LINE|l.LINE]=N.prototype.lineLine=function(t,e,i,n,r,o,s,a,h){return!h&&0},N.prototype[l.PLANE|l.LINE]=N.prototype.planeLine=function(t,e,i,n,r,o,s,a,h){var l=X,p=H,u=q,d=Y,c=K,y=k,_=Z,m=J,g=Q,f=R,x=0;j.set(l,-o.length/2,0),j.set(p,o.length/2,0),j.rotate(u,l,a),j.rotate(d,p,a),V(u,u,s),V(d,d,s),j.copy(l,u),j.copy(p,d),U(c,p,l),j.normalize(y,c),j.rotate90cw(g,y),j.rotate(m,S,n),f[0]=l,f[1]=p;for(var v=0;v<f.length;v++){var w=f[v];U(_,w,i);var z=W(_,m);if(z<0){if(h)return!0;var b=this.createContactEquation(t,r,e,o);x++,j.copy(b.normalA,m),j.normalize(b.normalA,b.normalA),j.scale(_,m,z),U(b.contactPointA,w,_),U(b.contactPointA,b.contactPointA,t.position),U(b.contactPointB,w,s),V(b.contactPointB,b.contactPointB,s),U(b.contactPointB,b.contactPointB,r.position),this.contactEquations.push(b),this.enableFrictionReduction||this.enableFriction&&this.frictionEquations.push(this.createFrictionFromContact(b))}}return!h&&(this.enableFrictionReduction||x&&this.enableFriction&&this.frictionEquations.push(this.createFrictionFromAverage(x)),x)},N.prototype[l.PARTICLE|l.CAPSULE]=N.prototype.particleCapsule=function(t,e,i,n,r,o,s,a,h){return this.circleLine(t,e,i,n,r,o,s,a,h,o.radius,0)},N.prototype[l.CIRCLE|l.LINE]=N.prototype.circleLine=function(t,e,i,n,r,o,s,a,h,l,p){var l=l||0,p=void 0!==p?p:e.radius,u=X,d=H,c=q,y=Y,_=K,m=k,g=Z,f=J,x=Q,v=O,w=E,z=I,b=G,S=D,C=R;j.set(f,-o.length/2,0),j.set(x,o.length/2,0),j.rotate(v,f,a),j.rotate(w,x,a),V(v,v,s),V(w,w,s),j.copy(f,v),j.copy(x,w),U(m,x,f),j.normalize(g,m),j.rotate90cw(_,g),U(z,i,f);m=W(z,_);U(y,f,s),U(b,i,s);var P=p+l;if(Math.abs(m)<P){j.scale(u,_,m),U(c,i,u),j.scale(d,_,W(_,b)),j.normalize(d,d),j.scale(d,d,l),V(c,c,d);b=W(g,c),d=W(g,f),g=W(g,x);if(d<b&&b<g){if(h)return!0;var M=this.createContactEquation(t,r,e,o);return j.scale(M.normalA,u,-1),j.normalize(M.normalA,M.normalA),j.scale(M.contactPointA,M.normalA,p),V(M.contactPointA,M.contactPointA,i),U(M.contactPointA,M.contactPointA,t.position),U(M.contactPointB,c,s),V(M.contactPointB,M.contactPointB,s),U(M.contactPointB,M.contactPointB,r.position),this.contactEquations.push(M),this.enableFriction&&this.frictionEquations.push(this.createFrictionFromContact(M)),1}}C[0]=f,C[1]=x;for(var T=0;T<C.length;T++){var A=C[T];if(U(z,A,i),j.squaredLength(z)<Math.pow(P,2)){if(h)return!0;M=this.createContactEquation(t,r,e,o);return j.copy(M.normalA,z),j.normalize(M.normalA,M.normalA),j.scale(M.contactPointA,M.normalA,p),V(M.contactPointA,M.contactPointA,i),U(M.contactPointA,M.contactPointA,t.position),U(M.contactPointB,A,s),j.scale(S,M.normalA,-l),V(M.contactPointB,M.contactPointB,S),V(M.contactPointB,M.contactPointB,s),U(M.contactPointB,M.contactPointB,r.position),this.contactEquations.push(M),this.enableFriction&&this.frictionEquations.push(this.createFrictionFromContact(M)),1}}return 0},N.prototype[l.CIRCLE|l.CAPSULE]=N.prototype.circleCapsule=function(t,e,i,n,r,o,s,a,h){return this.circleLine(t,e,i,n,r,o,s,a,h,o.radius)},N.prototype[l.CIRCLE|l.CONVEX]=N.prototype[l.CIRCLE|l.BOX]=N.prototype.circleConvex=function(t,e,i,n,r,o,s,a,h,l){for(var l="number"==typeof l?l:e.radius,p=X,u=H,d=q,c=Y,y=K,_=O,m=E,g=G,f=D,x=L,v=B,w=!1,z=Number.MAX_VALUE,b=o.vertices,S=0;S!==b.length+1;S++){var C=b[S%b.length],P=b[(S+1)%b.length];j.rotate(p,C,a),j.rotate(u,P,a),V(p,p,s),V(u,u,s),U(d,u,p),j.normalize(c,d),j.rotate90cw(y,c),j.scale(f,y,-e.radius),V(f,f,i),A(f,o,s,a)&&(j.sub(x,p,f),(P=Math.abs(j.dot(x,y)))<z&&(j.copy(v,f),j.scale(g,y,z=P),j.add(g,g,f),w=!0))}if(w){if(h)return!0;var M=this.createContactEquation(t,r,e,o);return j.sub(M.normalA,v,i),j.normalize(M.normalA,M.normalA),j.scale(M.contactPointA,M.normalA,l),V(M.contactPointA,M.contactPointA,i),U(M.contactPointA,M.contactPointA,t.position),U(M.contactPointB,g,s),V(M.contactPointB,M.contactPointB,s),U(M.contactPointB,M.contactPointB,r.position),this.contactEquations.push(M),this.enableFriction&&this.frictionEquations.push(this.createFrictionFromContact(M)),1}if(0<l)for(S=0;S<b.length;S++){var T=b[S];if(j.rotate(m,T,a),V(m,m,s),U(_,m,i),j.squaredLength(_)<Math.pow(l,2)){if(h)return!0;M=this.createContactEquation(t,r,e,o);return j.copy(M.normalA,_),j.normalize(M.normalA,M.normalA),j.scale(M.contactPointA,M.normalA,l),V(M.contactPointA,M.contactPointA,i),U(M.contactPointA,M.contactPointA,t.position),U(M.contactPointB,m,s),V(M.contactPointB,M.contactPointB,s),U(M.contactPointB,M.contactPointB,r.position),this.contactEquations.push(M),this.enableFriction&&this.frictionEquations.push(this.createFrictionFromContact(M)),1}}return 0};var y=j.create(),_=j.create(),m=j.create(),g=j.create();N.prototype[l.PARTICLE|l.CONVEX]=N.prototype[l.PARTICLE|l.BOX]=N.prototype.particleConvex=function(t,e,i,n,r,o,s,a,h){var l=X,p=H,u=q,d=Y,c=K,y=k,_=Z,m=O,g=G,f=P,x=M,v=Number.MAX_VALUE,w=!1,z=o.vertices;if(!A(i,o,s,a))return 0;if(h)return!0;for(var b=0;b!==z.length+1;b++){var S=z[b%z.length],C=z[(b+1)%z.length];j.rotate(l,S,a),j.rotate(p,C,a),V(l,l,s),V(p,p,s),U(u,p,l),j.normalize(d,u),j.rotate90cw(c,d),U(m,i,l),W(m,c),U(y,l,s),U(_,i,s),j.sub(f,l,i);C=Math.abs(j.dot(f,c));C<v&&(j.scale(g,c,v=C),j.add(g,g,i),j.copy(x,c),w=!0)}if(w){o=this.createContactEquation(t,r,e,o);return j.scale(o.normalA,x,-1),j.normalize(o.normalA,o.normalA),j.set(o.contactPointA,0,0),V(o.contactPointA,o.contactPointA,i),U(o.contactPointA,o.contactPointA,t.position),U(o.contactPointB,g,s),V(o.contactPointB,o.contactPointB,s),U(o.contactPointB,o.contactPointB,r.position),this.contactEquations.push(o),this.enableFriction&&this.frictionEquations.push(this.createFrictionFromContact(o)),1}return 0},N.prototype[l.CIRCLE]=N.prototype.circleCircle=function(t,e,i,n,r,o,s,a,h,l,p){var u=X,l=l||e.radius,p=p||o.radius;U(u,i,s);var d=l+p;if(j.squaredLength(u)>Math.pow(d,2))return 0;if(h)return!0;o=this.createContactEquation(t,r,e,o);return U(o.normalA,s,i),j.normalize(o.normalA,o.normalA),j.scale(o.contactPointA,o.normalA,l),j.scale(o.contactPointB,o.normalA,-p),V(o.contactPointA,o.contactPointA,i),U(o.contactPointA,o.contactPointA,t.position),V(o.contactPointB,o.contactPointB,s),U(o.contactPointB,o.contactPointB,r.position),this.contactEquations.push(o),this.enableFriction&&this.frictionEquations.push(this.createFrictionFromContact(o)),1},N.prototype[l.PLANE|l.CONVEX]=N.prototype[l.PLANE|l.BOX]=N.prototype.planeConvex=function(t,e,i,n,r,o,s,a,h){var l=X,p=H,u=q,d=0;j.rotate(p,S,n);for(var c=0;c!==o.vertices.length;c++){var y=o.vertices[c];if(j.rotate(l,y,a),V(l,l,s),U(u,l,i),W(u,p)<=0){if(h)return!0;d++;var _=this.createContactEquation(t,r,e,o);U(u,l,i),j.copy(_.normalA,p);y=W(u,_.normalA);j.scale(u,_.normalA,y),U(_.contactPointB,l,r.position),U(_.contactPointA,l,u),U(_.contactPointA,_.contactPointA,t.position),this.contactEquations.push(_),this.enableFrictionReduction||this.enableFriction&&this.frictionEquations.push(this.createFrictionFromContact(_))}}return this.enableFrictionReduction&&this.enableFriction&&d&&this.frictionEquations.push(this.createFrictionFromAverage(d)),d},N.prototype[l.PARTICLE|l.PLANE]=N.prototype.particlePlane=function(t,e,i,n,r,o,s,a,h){var l=X,p=H;a=a||0,U(l,i,s),j.rotate(p,S,a);a=W(l,p);if(0<a)return 0;if(h)return!0;e=this.createContactEquation(r,t,o,e);return j.copy(e.normalA,p),j.scale(l,e.normalA,a),U(e.contactPointA,i,l),U(e.contactPointA,e.contactPointA,r.position),U(e.contactPointB,i,t.position),this.contactEquations.push(e),this.enableFriction&&this.frictionEquations.push(this.createFrictionFromContact(e)),1},N.prototype[l.CIRCLE|l.PARTICLE]=N.prototype.circleParticle=function(t,e,i,n,r,o,s,a,h){var l=X;if(U(l,s,i),j.squaredLength(l)>Math.pow(e.radius,2))return 0;if(h)return!0;o=this.createContactEquation(t,r,e,o);return j.copy(o.normalA,l),j.normalize(o.normalA,o.normalA),j.scale(o.contactPointA,o.normalA,e.radius),V(o.contactPointA,o.contactPointA,i),U(o.contactPointA,o.contactPointA,t.position),U(o.contactPointB,s,r.position),this.contactEquations.push(o),this.enableFriction&&this.frictionEquations.push(this.createFrictionFromContact(o)),1};var z=new a({radius:1}),C=j.create(),T=j.create();j.create(),N.prototype[l.PLANE|l.CAPSULE]=N.prototype.planeCapsule=function(t,e,i,n,r,o,s,a,h){var l,p=C,u=T,d=z;j.set(p,-o.length/2,0),j.rotate(p,p,a),V(p,p,s),j.set(u,o.length/2,0),j.rotate(u,u,a),V(u,u,s),d.radius=o.radius,this.enableFrictionReduction&&(l=this.enableFriction,this.enableFriction=!1);p=this.circlePlane(r,d,p,0,t,e,i,n,h),n=this.circlePlane(r,d,u,0,t,e,i,n,h);if(this.enableFrictionReduction&&(this.enableFriction=l),h)return p||n;n=p+n;return this.enableFrictionReduction&&n&&this.frictionEquations.push(this.createFrictionFromAverage(n)),n},N.prototype[l.CIRCLE|l.PLANE]=N.prototype.circlePlane=function(t,e,i,n,r,o,s,a,h){var l=t,p=e,u=i,d=r,t=s,i=a||0,r=X,s=H,a=q;U(r,u,t),j.rotate(s,S,i);i=W(s,r);if(i>p.radius)return 0;if(h)return!0;e=this.createContactEquation(d,l,o,e);return j.copy(e.normalA,s),j.scale(e.contactPointB,e.normalA,-p.radius),V(e.contactPointB,e.contactPointB,u),U(e.contactPointB,e.contactPointB,l.position),j.scale(a,e.normalA,i),U(e.contactPointA,r,a),V(e.contactPointA,e.contactPointA,t),U(e.contactPointA,e.contactPointA,d.position),this.contactEquations.push(e),this.enableFriction&&this.frictionEquations.push(this.createFrictionFromContact(e)),1},N.prototype[l.CONVEX]=N.prototype[l.CONVEX|l.BOX]=N.prototype[l.BOX]=N.prototype.convexConvex=function(t,e,i,n,r,o,s,a,h,l){var p=X,u=H,d=q,c=Y,y=K,_=Z,m=J,g=Q,f=0,l="number"==typeof l?l:0;if(!N.findSeparatingAxis(e,i,n,o,s,a,p))return 0;U(m,s,i),0<W(p,m)&&j.scale(p,p,-1);var x=N.getClosestEdge(e,n,p,!0),v=N.getClosestEdge(o,a,p);if(-1===x||-1===v)return 0;for(var w=0;w<2;w++){var z,b=x,S=v,C=e,P=o,M=i,T=s,A=n,k=a,O=t,E=r;0===w&&(z=b,b=S,S=z,z=C,C=P,P=z,z=M,M=T,T=z,z=A,A=a,k=z,z=O,O=E,E=z);for(var I=S;I<S+2;I++){var G=P.vertices[(I+P.vertices.length)%P.vertices.length];j.rotate(u,G,k),V(u,u,T);for(var D=0,L=b-1;L<b+2;L++){var B=C.vertices[(L+C.vertices.length)%C.vertices.length],R=C.vertices[(L+1+C.vertices.length)%C.vertices.length];j.rotate(d,B,A),j.rotate(c,R,A),V(d,d,M),V(c,c,M),U(y,c,d),j.rotate90cw(g,y),j.normalize(g,g),U(m,u,d);var F=W(g,m);(L===b&&F<=l||L!==b&&F<=0)&&D++}if(3<=D){if(h)return!0;G=this.createContactEquation(O,E,C,P);f++;B=C.vertices[b%C.vertices.length],R=C.vertices[(b+1)%C.vertices.length];j.rotate(d,B,A),j.rotate(c,R,A),V(d,d,M),V(c,c,M),U(y,c,d),j.rotate90cw(G.normalA,y),j.normalize(G.normalA,G.normalA),U(m,u,d);F=W(G.normalA,m);j.scale(_,G.normalA,F),U(G.contactPointA,u,M),U(G.contactPointA,G.contactPointA,_),V(G.contactPointA,G.contactPointA,M),U(G.contactPointA,G.contactPointA,O.position),U(G.contactPointB,u,T),V(G.contactPointB,G.contactPointB,T),U(G.contactPointB,G.contactPointB,E.position),this.contactEquations.push(G),this.enableFrictionReduction||this.enableFriction&&this.frictionEquations.push(this.createFrictionFromContact(G))}}}return this.enableFrictionReduction&&this.enableFriction&&f&&this.frictionEquations.push(this.createFrictionFromAverage(f)),f};var F=j.fromValues(0,0);N.projectConvexOntoAxis=function(t,e,i,n,r){var o,s=null,a=null,h=F;j.rotate(h,n,-i);for(var l=0;l<t.vertices.length;l++)o=t.vertices[l],o=W(o,h),(null===s||s<o)&&(s=o),(null===a||o<a)&&(a=o);s<a&&(i=a,a=s,s=i);n=W(e,n);j.set(r,a+n,s+n)};var $=j.fromValues(0,0),tt=j.fromValues(0,0),et=j.fromValues(0,0),it=j.fromValues(0,0),nt=j.fromValues(0,0),rt=j.fromValues(0,0);N.findSeparatingAxis=function(t,e,i,n,r,o,s){var a=null,h=!1,l=!1,p=$,u=tt,d=et,c=it,y=nt,_=rt;if(t instanceof b&&n instanceof b)for(var m=0;2!==m;m++){var g=t,f=i;1===m&&(g=n,f=o);for(var x=0;2!==x;x++){0===x?j.set(c,0,1):1===x&&j.set(c,1,0),0!==f&&j.rotate(c,c,f),N.projectConvexOntoAxis(t,e,i,c,y),N.projectConvexOntoAxis(n,r,o,c,_);var v=y,w=_;y[0]>_[0]&&(w=y,v=_);h=(z=w[0]-v[1])<=0;(null===a||a<z)&&(j.copy(s,c),a=z,l=h)}}else for(m=0;2!==m;m++){g=t,f=i;1===m&&(g=n,f=o);for(x=0;x!==g.vertices.length;x++){j.rotate(u,g.vertices[x],f),j.rotate(d,g.vertices[(x+1)%g.vertices.length],f),U(p,d,u),j.rotate90cw(c,p),j.normalize(c,c),N.projectConvexOntoAxis(t,e,i,c,y),N.projectConvexOntoAxis(n,r,o,c,_);var z,v=y,w=_;y[0]>_[0]&&(w=y,v=_),h=(z=w[0]-v[1])<=0,(null===a||a<z)&&(j.copy(s,c),a=z,l=h)}}return l};var ot=j.fromValues(0,0),st=j.fromValues(0,0),at=j.fromValues(0,0);N.getClosestEdge=function(t,e,i,n){var r=ot,o=st,s=at;j.rotate(r,i,-e),n&&j.scale(r,r,-1);for(var a=-1,h=t.vertices.length,l=-1,p=0;p!==h;p++){U(o,t.vertices[(p+1)%h],t.vertices[p%h]),j.rotate90cw(s,o),j.normalize(s,s);var u=W(s,r);(-1===a||l<u)&&(a=p%h,l=u)}return a};var ht=j.create(),lt=j.create(),pt=j.create(),ut=j.create(),dt=j.create(),ct=j.create(),yt=j.create();N.prototype[l.CIRCLE|l.HEIGHTFIELD]=N.prototype.circleHeightfield=function(t,e,i,n,r,o,s,a,h,l){var p=o.heights,l=l||e.radius,u=o.elementWidth,d=lt,c=ht,y=dt,_=yt,m=ct,g=pt,f=ut,x=Math.floor((i[0]-l-s[0])/u),v=Math.ceil((i[0]+l-s[0])/u);v>=p.length&&(v=p.length-1);for(var w=p[x=x<0?0:x],z=p[v],b=x;b<v;b++)p[b]<z&&(z=p[b]),p[b]>w&&(w=p[b]);if(i[1]-l>w)return!h&&0;for(var S=!1,b=x;b<v;b++){j.set(g,b*u,p[b]),j.set(f,(b+1)*u,p[b+1]),j.add(g,g,s),j.add(f,f,s),j.sub(m,f,g),j.rotate(m,m,Math.PI/2),j.normalize(m,m),j.scale(c,m,-l),j.add(c,c,i),j.sub(d,c,g);var C=j.dot(d,m);if(c[0]>=g[0]&&c[0]<f[0]&&C<=0){if(h)return!0;S=!0,j.scale(d,m,-C),j.add(y,c,d),j.copy(_,m);var P=this.createContactEquation(r,t,o,e);j.copy(P.normalA,_),j.scale(P.contactPointB,P.normalA,-l),V(P.contactPointB,P.contactPointB,i),U(P.contactPointB,P.contactPointB,t.position),j.copy(P.contactPointA,y),j.sub(P.contactPointA,P.contactPointA,r.position),this.contactEquations.push(P),this.enableFriction&&this.frictionEquations.push(this.createFrictionFromContact(P))}}if(S=!1,0<l)for(b=x;b<=v;b++)if(j.set(g,b*u,p[b]),j.add(g,g,s),j.sub(d,i,g),j.squaredLength(d)<Math.pow(l,2)){if(h)return!0;S=!0,P=this.createContactEquation(r,t,o,e);j.copy(P.normalA,d),j.normalize(P.normalA,P.normalA),j.scale(P.contactPointB,P.normalA,-l),V(P.contactPointB,P.contactPointB,i),U(P.contactPointB,P.contactPointB,t.position),U(P.contactPointA,g,s),V(P.contactPointA,P.contactPointA,s),U(P.contactPointA,P.contactPointA,r.position),this.contactEquations.push(P),this.enableFriction&&this.frictionEquations.push(this.createFrictionFromContact(P))}return S?1:0};var _t=j.create(),mt=j.create(),gt=j.create(),ft=new h({vertices:[j.create(),j.create(),j.create(),j.create()]});N.prototype[l.BOX|l.HEIGHTFIELD]=N.prototype[l.CONVEX|l.HEIGHTFIELD]=N.prototype.convexHeightfield=function(t,e,i,n,r,o,s,a,h){var l=o.heights,p=o.elementWidth,u=_t,d=mt,c=gt,y=ft,o=Math.floor((t.aabb.lowerBound[0]-s[0])/p),_=Math.ceil((t.aabb.upperBound[0]-s[0])/p);_>=l.length&&(_=l.length-1);for(var m=l[o=o<0?0:o],g=l[_],f=o;f<_;f++)l[f]<g&&(g=l[f]),l[f]>m&&(m=l[f]);if(t.aabb.lowerBound[1]>m)return!h&&0;for(var x=0,f=o;f<_;f++){j.set(u,f*p,l[f]),j.set(d,(f+1)*p,l[f+1]),j.add(u,u,s),j.add(d,d,s);j.set(c,.5*(d[0]+u[0]),.5*(d[1]+u[1]-100)),j.sub(y.vertices[0],d,c),j.sub(y.vertices[1],u,c),j.copy(y.vertices[2],y.vertices[1]),j.copy(y.vertices[3],y.vertices[0]),y.vertices[2][1]-=100,y.vertices[3][1]-=100,x+=this.convexConvex(t,e,i,n,r,y,c,0,h)}return x}},{"../equations/ContactEquation":21,"../equations/Equation":22,"../equations/FrictionEquation":23,"../math/vec2":30,"../objects/Body":31,"../shapes/Box":37,"../shapes/Circle":39,"../shapes/Convex":40,"../shapes/Shape":45,"../utils/ContactEquationPool":48,"../utils/FrictionEquationPool":49,"../utils/TupleDictionary":56,"../utils/Utils":57}],11:[function(t,e,i){function s(t){this.from=(t=t||{}).from?h.fromValues(t.from[0],t.from[1]):h.create(),this.to=t.to?h.fromValues(t.to[0],t.to[1]):h.create(),this.checkCollisionResponse=void 0===t.checkCollisionResponse||t.checkCollisionResponse,this.skipBackfaces=!!t.skipBackfaces,this.collisionMask=void 0!==t.collisionMask?t.collisionMask:-1,this.collisionGroup=void 0!==t.collisionGroup?t.collisionGroup:-1,this.mode=void 0!==t.mode?t.mode:s.ANY,this.callback=t.callback||function(t){},this.direction=h.create(),this.length=1,this.update()}e.exports=s;var h=t("../math/vec2");t("../collision/RaycastResult"),t("../shapes/Shape"),t("../collision/AABB"),(s.prototype.constructor=s).CLOSEST=1,s.ANY=2,s.ALL=4,s.prototype.update=function(){var t=this.direction;h.sub(t,this.to,this.from),this.length=h.length(t),h.normalize(t,t)},s.prototype.intersectBodies=function(t,e){for(var i=0,n=e.length;!t.shouldStop(this)&&i<n;i++){var r=e[i],o=r.getAABB();(0<=o.overlapsRay(this)||o.containsPoint(this.from))&&this.intersectBody(t,r)}};var l=h.create();s.prototype.intersectBody=function(t,e){var i=this.checkCollisionResponse;if(!i||e.collisionResponse)for(var n=l,r=0,o=e.shapes.length;r<o;r++){var s=e.shapes[r];if((!i||s.collisionResponse)&&0!=(this.collisionGroup&s.collisionMask)&&0!=(s.collisionGroup&this.collisionMask)){h.rotate(n,s.position,e.angle),h.add(n,n,e.position);var a=s.angle+e.angle;if(this.intersectShape(t,s,a,n,e),t.shouldStop(this))break}}},s.prototype.intersectShape=function(t,e,i,n,r){(function(t,e,i){h.sub(o,i,t);var n=h.dot(o,e);return h.scale(a,e,n),h.add(a,a,t),h.squaredDistance(i,a)})(this.from,this.direction,n)>e.boundingRadius*e.boundingRadius||(this._currentBody=r,(this._currentShape=e).raycast(t,this,n,i),this._currentBody=this._currentShape=null)},s.prototype.getAABB=function(t){var e=this.to,i=this.from;h.set(t.lowerBound,Math.min(e[0],i[0]),Math.min(e[1],i[1])),h.set(t.upperBound,Math.max(e[0],i[0]),Math.max(e[1],i[1]))},h.create(),s.prototype.reportIntersection=function(t,e,i,n){var r=(this.from,this.to,this._currentShape),o=this._currentBody;if(!(this.skipBackfaces&&0<h.dot(i,this.direction)))switch(this.mode){case s.ALL:t.set(i,r,o,e,n),this.callback(t);break;case s.CLOSEST:(e<t.fraction||!t.hasHit())&&t.set(i,r,o,e,n);break;case s.ANY:t.set(i,r,o,e,n)}};var o=h.create(),a=h.create()},{"../collision/AABB":7,"../collision/RaycastResult":12,"../math/vec2":30,"../shapes/Shape":45}],12:[function(t,e,i){function n(){this.normal=o.create(),this.shape=null,this.body=null,this.faceIndex=-1,this.fraction=-1,this.isStopped=!1}var o=t("../math/vec2"),r=t("../collision/Ray");(e.exports=n).prototype.reset=function(){o.set(this.normal,0,0),this.shape=null,this.body=null,this.faceIndex=-1,this.fraction=-1,this.isStopped=!1},n.prototype.getHitDistance=function(t){return o.distance(t.from,t.to)*this.fraction},n.prototype.hasHit=function(){return-1!==this.fraction},n.prototype.getHitPoint=function(t,e){o.lerp(t,e.from,e.to,this.fraction)},n.prototype.stop=function(){this.isStopped=!0},n.prototype.shouldStop=function(t){return this.isStopped||-1!==this.fraction&&t.mode===r.ANY},n.prototype.set=function(t,e,i,n,r){o.copy(this.normal,t),this.shape=e,this.body=i,this.fraction=n,this.faceIndex=r}},{"../collision/Ray":11,"../math/vec2":30}],13:[function(t,e,i){function n(){u.call(this,u.SAP),this.axisList=[],this.axisIndex=0;var e=this;this._addBodyHandler=function(t){e.axisList.push(t.body)},this._removeBodyHandler=function(t){t=e.axisList.indexOf(t.body);-1!==t&&e.axisList.splice(t,1)}}var r=t("../utils/Utils"),u=t("../collision/Broadphase");(((e.exports=n).prototype=new u).constructor=n).prototype.setWorld=function(t){this.axisList.length=0,r.appendArray(this.axisList,t.bodies),t.off("addBody",this._addBodyHandler).off("removeBody",this._removeBodyHandler),t.on("addBody",this._addBodyHandler).on("removeBody",this._removeBodyHandler),this.world=t},n.sortAxisList=function(t,e){e|=0;for(var i=1,n=t.length;i<n;i++){for(var r=t[i],o=i-1;0<=o&&!(t[o].aabb.lowerBound[e]<=r.aabb.lowerBound[e]);o--)t[o+1]=t[o];t[o+1]=r}return t},n.prototype.sortList=function(){var t=this.axisList,e=this.axisIndex;n.sortAxisList(t,e)},n.prototype.getCollisionPairs=function(t){var e=this.axisList,i=this.result,n=this.axisIndex;i.length=0;for(var r=e.length;r--;){var o=e[r];o.aabbNeedsUpdate&&o.updateAABB()}this.sortList();for(var s=0,a=0|e.length;s!==a;s++)for(var h=e[s],l=s+1;l<a;l++){var p=e[l];if(!(p.aabb.lowerBound[n]<=h.aabb.upperBound[n]))break;u.canCollide(h,p)&&this.boundingVolumeCheck(h,p)&&i.push(h,p)}return i},n.prototype.aabbQuery=function(t,e,i){i=i||[],this.sortList();for(var n=this.axisIndex,n=2===n?"z":1===n?"y":"x",r=this.axisList,o=(e.lowerBound[n],e.upperBound[n],0);o<r.length;o++){var s=r[o];s.aabbNeedsUpdate&&s.updateAABB(),s.aabb.overlaps(e)&&i.push(s)}return i}},{"../collision/Broadphase":8,"../utils/Utils":57}],14:[function(t,e,i){function n(t,e,i,n){this.type=i,n=r.defaults(n,{collideConnected:!0,wakeUpBodies:!0}),this.equations=[],this.bodyA=t,this.bodyB=e,this.collideConnected=n.collideConnected,n.wakeUpBodies&&(t&&t.wakeUp(),e&&e.wakeUp())}e.exports=n;var r=t("../utils/Utils");n.prototype.update=function(){throw new Error("method update() not implmemented in this Constraint subclass!")},n.DISTANCE=1,n.GEAR=2,n.LOCK=3,n.PRISMATIC=4,n.REVOLUTE=5,n.prototype.setStiffness=function(t){for(var e=this.equations,i=0;i!==e.length;i++){var n=e[i];n.stiffness=t,n.needsUpdate=!0}},n.prototype.setRelaxation=function(t){for(var e=this.equations,i=0;i!==e.length;i++){var n=e[i];n.relaxation=t,n.needsUpdate=!0}}},{"../utils/Utils":57}],15:[function(t,e,i){function n(t,e,i){i=y.defaults(i,{localAnchorA:[0,0],localAnchorB:[0,0]}),u.call(this,t,e,u.DISTANCE,i),this.localAnchorA=c.fromValues(i.localAnchorA[0],i.localAnchorA[1]),this.localAnchorB=c.fromValues(i.localAnchorB[0],i.localAnchorB[1]);var n,r,o=this.localAnchorA,s=this.localAnchorB;this.distance=0,"number"==typeof i.distance?this.distance=i.distance:(n=c.create(),r=c.create(),a=c.create(),c.rotate(n,o,t.angle),c.rotate(r,s,e.angle),c.add(a,e.position,r),c.sub(a,a,n),c.sub(a,a,t.position),this.distance=c.length(a));i=void 0===i.maxForce?Number.MAX_VALUE:i.maxForce,e=new d(t,e,-i,i);this.equations=[e],this.maxForce=i;var a=c.create(),h=c.create(),l=c.create(),p=this;e.computeGq=function(){var t=this.bodyA,e=this.bodyB,i=t.position,n=e.position;return c.rotate(h,o,t.angle),c.rotate(l,s,e.angle),c.add(a,n,l),c.sub(a,a,h),c.sub(a,a,i),c.length(a)-p.distance},this.setMaxForce(i),this.upperLimitEnabled=!1,this.upperLimit=1,this.lowerLimitEnabled=!1,this.lowerLimit=0,this.position=0}var u=t("./Constraint"),d=t("../equations/Equation"),c=t("../math/vec2"),y=t("../utils/Utils");((e.exports=n).prototype=new u).constructor=n;var s=c.create(),a=c.create(),h=c.create();n.prototype.update=function(){var t=this.equations[0],e=this.bodyA,i=this.bodyB,n=(this.distance,e.position),r=i.position,o=this.equations[0],t=t.G;c.rotate(a,this.localAnchorA,e.angle),c.rotate(h,this.localAnchorB,i.angle),c.add(s,r,h),c.sub(s,s,a),c.sub(s,s,n),this.position=c.length(s);var r=!1;this.upperLimitEnabled&&this.position>this.upperLimit&&(o.maxForce=0,o.minForce=-this.maxForce,this.distance=this.upperLimit,r=!0),this.lowerLimitEnabled&&this.position<this.lowerLimit&&(o.maxForce=this.maxForce,o.minForce=0,this.distance=this.lowerLimit,r=!0),!this.lowerLimitEnabled&&!this.upperLimitEnabled||r?(o.enabled=!0,c.normalize(s,s),n=c.crossLength(a,s),r=c.crossLength(h,s),t[0]=-s[0],t[1]=-s[1],t[2]=-n,t[3]=s[0],t[4]=s[1],t[5]=r):o.enabled=!1},n.prototype.setMaxForce=function(t){var e=this.equations[0];e.minForce=-t,e.maxForce=t},n.prototype.getMaxForce=function(){return this.equations[0].maxForce}},{"../equations/Equation":22,"../math/vec2":30,"../utils/Utils":57,"./Constraint":14}],16:[function(t,e,i){function n(t,e,i){r.call(this,t,e,r.GEAR,i=i||{}),this.ratio=void 0!==i.ratio?i.ratio:1,this.angle=void 0!==i.angle?i.angle:e.angle-this.ratio*t.angle,i.angle=this.angle,i.ratio=this.ratio,this.equations=[new o(t,e,i)],void 0!==i.maxTorque&&this.setMaxTorque(i.maxTorque)}var r=t("./Constraint"),o=(t("../equations/Equation"),t("../equations/AngleLockEquation"));t("../math/vec2"),(((e.exports=n).prototype=new r).constructor=n).prototype.update=function(){var t=this.equations[0];t.ratio!==this.ratio&&t.setRatio(this.ratio),t.angle=this.angle},n.prototype.setMaxTorque=function(t){this.equations[0].setMaxTorque(t)},n.prototype.getMaxTorque=function(t){return this.equations[0].maxForce}},{"../equations/AngleLockEquation":20,"../equations/Equation":22,"../math/vec2":30,"./Constraint":14}],17:[function(t,e,i){function n(t,e,i){d.call(this,t,e,d.LOCK,i=i||{});var n=void 0===i.maxForce?Number.MAX_VALUE:i.maxForce,r=(i.localAngleB,new y(t,e,-n,n)),o=new y(t,e,-n,n),s=new y(t,e,-n,n),a=c.create(),h=c.create(),l=this;r.computeGq=function(){return c.rotate(a,l.localOffsetB,t.angle),c.sub(h,e.position,t.position),c.sub(h,h,a),h[0]},o.computeGq=function(){return c.rotate(a,l.localOffsetB,t.angle),c.sub(h,e.position,t.position),c.sub(h,h,a),h[1]};var p=c.create(),u=c.create();s.computeGq=function(){return c.rotate(p,l.localOffsetB,e.angle-l.localAngleB),c.scale(p,p,-1),c.sub(h,t.position,e.position),c.add(h,h,p),c.rotate(u,p,-Math.PI/2),c.normalize(u,u),c.dot(h,u)},this.localOffsetB=c.create(),i.localOffsetB?c.copy(this.localOffsetB,i.localOffsetB):(c.sub(this.localOffsetB,e.position,t.position),c.rotate(this.localOffsetB,this.localOffsetB,-t.angle)),this.localAngleB=0,"number"==typeof i.localAngleB?this.localAngleB=i.localAngleB:this.localAngleB=e.angle-t.angle,this.equations.push(r,o,s),this.setMaxForce(n)}var d=t("./Constraint"),c=t("../math/vec2"),y=t("../equations/Equation");(((e.exports=n).prototype=new d).constructor=n).prototype.setMaxForce=function(t){for(var e=this.equations,i=0;i<this.equations.length;i++)e[i].maxForce=t,e[i].minForce=-t},n.prototype.getMaxForce=function(){return this.equations[0].maxForce};var o=c.create(),s=c.create(),a=c.create(),h=c.fromValues(1,0),l=c.fromValues(0,1);n.prototype.update=function(){var t=this.equations[0],e=this.equations[1],i=this.equations[2],n=this.bodyA,r=this.bodyB;c.rotate(o,this.localOffsetB,n.angle),c.rotate(s,this.localOffsetB,r.angle-this.localAngleB),c.scale(s,s,-1),c.rotate(a,s,Math.PI/2),c.normalize(a,a),t.G[0]=-1,t.G[1]=0,t.G[2]=-c.crossLength(o,h),t.G[3]=1,e.G[0]=0,e.G[1]=-1,e.G[2]=-c.crossLength(o,l),e.G[4]=1,i.G[0]=-a[0],i.G[1]=-a[1],i.G[3]=a[0],i.G[4]=a[1],i.G[5]=c.crossLength(s,a)}},{"../equations/Equation":22,"../math/vec2":30,"./Constraint":14}],18:[function(t,e,i){function n(n,r,t){c.call(this,n,r,c.PRISMATIC,t=t||{});var o=m.fromValues(0,0),s=m.fromValues(1,0),a=m.fromValues(0,0);t.localAnchorA&&m.copy(o,t.localAnchorA),t.localAxisA&&m.copy(s,t.localAxisA),t.localAnchorB&&m.copy(a,t.localAnchorB),this.localAnchorA=o,this.localAnchorB=a,this.localAxisA=s;var e=this.maxForce=void 0!==t.maxForce?t.maxForce:Number.MAX_VALUE,i=new _(n,r,-e,e),h=new m.create,l=new m.create,p=new m.create,u=new m.create;i.computeGq=function(){return m.dot(p,u)},i.updateJacobian=function(){var t=this.G,e=n.position,i=r.position;m.rotate(h,o,n.angle),m.rotate(l,a,r.angle),m.add(p,i,l),m.sub(p,p,e),m.sub(p,p,h),m.rotate(u,s,n.angle+Math.PI/2),t[0]=-u[0],t[1]=-u[1],t[2]=-m.crossLength(h,u)+m.crossLength(u,p),t[3]=u[0],t[4]=u[1],t[5]=m.crossLength(l,u)},this.equations.push(i),t.disableRotationalLock||(i=new g(n,r,-e,e),this.equations.push(i)),this.position=0,this.velocity=0,this.lowerLimitEnabled=void 0!==t.lowerLimit,this.upperLimitEnabled=void 0!==t.upperLimit,this.lowerLimit=void 0!==t.lowerLimit?t.lowerLimit:0,this.upperLimit=void 0!==t.upperLimit?t.upperLimit:1,this.upperLimitEquation=new y(n,r),this.lowerLimitEquation=new y(n,r),this.upperLimitEquation.minForce=this.lowerLimitEquation.minForce=0,this.upperLimitEquation.maxForce=this.lowerLimitEquation.maxForce=e,this.motorEquation=new _(n,r),this.motorEnabled=!1,this.motorSpeed=0;var d=this,e=this.motorEquation;e.computeGW,e.computeGq=function(){return 0},e.computeGW=function(){var t=this.G,e=this.bodyA,i=this.bodyB,n=e.velocity,r=i.velocity,e=e.angularVelocity,i=i.angularVelocity;return this.gmult(t,n,e,r,i)+d.motorSpeed}}var c=t("./Constraint"),y=t("../equations/ContactEquation"),_=t("../equations/Equation"),m=t("../math/vec2"),g=t("../equations/RotationalLockEquation");((e.exports=n).prototype=new c).constructor=n;var d=m.create(),f=m.create(),x=m.create(),v=m.create(),w=m.create(),z=m.create();n.prototype.update=function(){var t=this.equations,e=t[0],i=this.upperLimit,n=this.lowerLimit,r=this.upperLimitEquation,o=this.lowerLimitEquation,s=this.bodyA,a=this.bodyB,h=this.localAxisA,l=this.localAnchorA,p=this.localAnchorB;e.updateJacobian(),m.rotate(d,h,s.angle),m.rotate(v,l,s.angle),m.add(f,v,s.position),m.rotate(w,p,a.angle),m.add(x,w,a.position);var u,l=this.position=m.dot(x,d)-m.dot(f,d);this.motorEnabled&&((p=this.motorEquation.G)[0]=d[0],p[1]=d[1],p[2]=m.crossLength(d,w),p[3]=-d[0],p[4]=-d[1],p[5]=-m.crossLength(d,v)),this.upperLimitEnabled&&i<l?(m.scale(r.normalA,d,-1),m.sub(r.contactPointA,f,s.position),m.sub(r.contactPointB,x,a.position),m.scale(z,d,i),m.add(r.contactPointA,r.contactPointA,z),-1===t.indexOf(r)&&t.push(r)):-1!==(u=t.indexOf(r))&&t.splice(u,1),this.lowerLimitEnabled&&l<n?(m.scale(o.normalA,d,1),m.sub(o.contactPointA,f,s.position),m.sub(o.contactPointB,x,a.position),m.scale(z,d,n),m.sub(o.contactPointB,o.contactPointB,z),-1===t.indexOf(o)&&t.push(o)):-1!==(u=t.indexOf(o))&&t.splice(u,1)},n.prototype.enableMotor=function(){this.motorEnabled||(this.equations.push(this.motorEquation),this.motorEnabled=!0)},n.prototype.disableMotor=function(){var t;this.motorEnabled&&(t=this.equations.indexOf(this.motorEquation),this.equations.splice(t,1),this.motorEnabled=!1)},n.prototype.setLimits=function(t,e){"number"==typeof t?(this.lowerLimit=t,this.lowerLimitEnabled=!0):(this.lowerLimit=t,this.lowerLimitEnabled=!1),"number"==typeof e?(this.upperLimit=e,this.upperLimitEnabled=!0):(this.upperLimit=e,this.upperLimitEnabled=!1)}},{"../equations/ContactEquation":21,"../equations/Equation":22,"../equations/RotationalLockEquation":24,"../math/vec2":30,"./Constraint":14}],19:[function(t,e,i){function n(t,e,i){s.call(this,t,e,s.REVOLUTE,i=i||{});var n=this.maxForce=void 0!==i.maxForce?i.maxForce:Number.MAX_VALUE;this.pivotA=c.create(),this.pivotB=c.create(),i.worldPivot?(c.sub(this.pivotA,i.worldPivot,t.position),c.sub(this.pivotB,i.worldPivot,e.position),c.rotate(this.pivotA,this.pivotA,-t.angle),c.rotate(this.pivotB,this.pivotB,-e.angle)):(c.copy(this.pivotA,i.localPivotA),c.copy(this.pivotB,i.localPivotB));var r=this.equations=[new a(t,e,-n,n),new a(t,e,-n,n)],i=r[0],r=r[1],o=this;i.computeGq=function(){return c.rotate(y,o.pivotA,t.angle),c.rotate(_,o.pivotB,e.angle),c.add(p,e.position,_),c.sub(p,p,t.position),c.sub(p,p,y),c.dot(p,m)},r.computeGq=function(){return c.rotate(y,o.pivotA,t.angle),c.rotate(_,o.pivotB,e.angle),c.add(p,e.position,_),c.sub(p,p,t.position),c.sub(p,p,y),c.dot(p,g)},r.minForce=i.minForce=-n,r.maxForce=i.maxForce=n,this.motorEquation=new h(t,e),this.motorEnabled=!1,this.angle=0,this.lowerLimitEnabled=!1,this.upperLimitEnabled=!1,this.lowerLimit=0,this.upperLimit=0,this.upperLimitEquation=new l(t,e),this.lowerLimitEquation=new l(t,e),this.upperLimitEquation.minForce=0,this.lowerLimitEquation.maxForce=0}var s=t("./Constraint"),a=t("../equations/Equation"),h=t("../equations/RotationalVelocityEquation"),l=t("../equations/RotationalLockEquation"),c=t("../math/vec2");e.exports=n;var y=c.create(),_=c.create(),m=c.fromValues(1,0),g=c.fromValues(0,1),p=c.create();((n.prototype=new s).constructor=n).prototype.setLimits=function(t,e){"number"==typeof t?(this.lowerLimit=t,this.lowerLimitEnabled=!0):(this.lowerLimit=t,this.lowerLimitEnabled=!1),"number"==typeof e?(this.upperLimit=e,this.upperLimitEnabled=!0):(this.upperLimit=e,this.upperLimitEnabled=!1)},n.prototype.update=function(){var t,e=this.bodyA,i=this.bodyB,n=this.pivotA,r=this.pivotB,o=this.equations,s=(o[0],o[1],o[0]),a=o[1],h=this.upperLimit,l=this.lowerLimit,p=this.upperLimitEquation,u=this.lowerLimitEquation,d=this.angle=i.angle-e.angle;this.upperLimitEnabled&&h<d?(p.angle=h,-1===o.indexOf(p)&&o.push(p)):-1!==(t=o.indexOf(p))&&o.splice(t,1),this.lowerLimitEnabled&&d<l?(u.angle=l,-1===o.indexOf(u)&&o.push(u)):-1!==(t=o.indexOf(u))&&o.splice(t,1),c.rotate(y,n,e.angle),c.rotate(_,r,i.angle),s.G[0]=-1,s.G[1]=0,s.G[2]=-c.crossLength(y,m),s.G[3]=1,s.G[4]=0,s.G[5]=c.crossLength(_,m),a.G[0]=0,a.G[1]=-1,a.G[2]=-c.crossLength(y,g),a.G[3]=0,a.G[4]=1,a.G[5]=c.crossLength(_,g)},n.prototype.enableMotor=function(){this.motorEnabled||(this.equations.push(this.motorEquation),this.motorEnabled=!0)},n.prototype.disableMotor=function(){var t;this.motorEnabled&&(t=this.equations.indexOf(this.motorEquation),this.equations.splice(t,1),this.motorEnabled=!1)},n.prototype.motorIsEnabled=function(){return!!this.motorEnabled},n.prototype.setMotorSpeed=function(t){var e;this.motorEnabled&&(e=this.equations.indexOf(this.motorEquation),this.equations[e].relativeVelocity=t)},n.prototype.getMotorSpeed=function(){return!!this.motorEnabled&&this.motorEquation.relativeVelocity}},{"../equations/Equation":22,"../equations/RotationalLockEquation":24,"../equations/RotationalVelocityEquation":25,"../math/vec2":30,"./Constraint":14}],20:[function(t,e,i){function n(t,e,i){i=i||{},r.call(this,t,e,-Number.MAX_VALUE,Number.MAX_VALUE),this.angle=i.angle||0,this.ratio="number"==typeof i.ratio?i.ratio:1,this.setRatio(this.ratio)}var r=t("./Equation");t("../math/vec2"),(((e.exports=n).prototype=new r).constructor=n).prototype.computeGq=function(){return this.ratio*this.bodyA.angle-this.bodyB.angle+this.angle},n.prototype.setRatio=function(t){var e=this.G;e[2]=t,e[5]=-1,this.ratio=t},n.prototype.setMaxTorque=function(t){this.maxForce=t,this.minForce=-t}},{"../math/vec2":30,"./Equation":22}],21:[function(t,e,i){function n(t,e){r.call(this,t,e,0,Number.MAX_VALUE),this.contactPointA=c.create(),this.penetrationVec=c.create(),this.contactPointB=c.create(),this.normalA=c.create(),this.restitution=0,this.firstImpact=!1,this.shapeA=null,this.shapeB=null}var r=t("./Equation"),c=t("../math/vec2");(((e.exports=n).prototype=new r).constructor=n).prototype.computeB=function(t,e,i){var n,r=this.bodyA,o=this.bodyB,s=this.contactPointA,a=this.contactPointB,h=r.position,l=o.position,p=this.penetrationVec,u=this.normalA,d=this.G,r=c.crossLength(s,u),o=c.crossLength(a,u);return d[0]=-u[0],d[1]=-u[1],d[2]=-r,d[3]=u[0],d[4]=u[1],d[5]=o,c.add(p,l,a),c.sub(p,p,h),c.sub(p,p,s),p=this.firstImpact&&0!==this.restitution?(n=0,1/e*(1+this.restitution)*this.computeGW()):(n=c.dot(u,p)+this.offset,this.computeGW()),-n*t-p*e-i*this.computeGiMf()}},{"../math/vec2":30,"./Equation":22}],22:[function(t,e,i){function o(t,e,i,n){this.minForce=void 0===i?-Number.MAX_VALUE:i,this.maxForce=void 0===n?Number.MAX_VALUE:n,this.bodyA=t,this.bodyB=e,this.stiffness=o.DEFAULT_STIFFNESS,this.relaxation=o.DEFAULT_RELAXATION,this.G=new s.ARRAY_TYPE(6);for(var r=0;r<6;r++)this.G[r]=0;this.offset=0,this.a=0,this.b=0,this.epsilon=0,this.timeStep=1/60,this.needsUpdate=!0,this.multiplier=0,this.relativeVelocity=0,this.enabled=!0}e.exports=o;var u=t("../math/vec2"),s=t("../utils/Utils");t("../objects/Body"),(o.prototype.constructor=o).DEFAULT_STIFFNESS=1e6,o.DEFAULT_RELAXATION=4,o.prototype.update=function(){var t=this.stiffness,e=this.relaxation,i=this.timeStep;this.a=4/(i*(1+4*e)),this.b=4*e/(1+4*e),this.epsilon=4/(i*i*t*(1+4*e)),this.needsUpdate=!1},o.prototype.gmult=function(t,e,i,n,r){return t[0]*e[0]+t[1]*e[1]+t[2]*i+t[3]*n[0]+t[4]*n[1]+t[5]*r},o.prototype.computeB=function(t,e,i){var n=this.computeGW();return-this.computeGq()*t-n*e-this.computeGiMf()*i};var n=u.create(),r=u.create();o.prototype.computeGq=function(){var t=this.G,e=this.bodyA,i=this.bodyB,e=(e.position,i.position,e.angle),i=i.angle;return this.gmult(t,n,e,r,i)+this.offset},o.prototype.computeGW=function(){var t=this.G,e=this.bodyA,i=this.bodyB,n=e.velocity,r=i.velocity,e=e.angularVelocity,i=i.angularVelocity;return this.gmult(t,n,e,r,i)+this.relativeVelocity},o.prototype.computeGWlambda=function(){var t=this.G,e=this.bodyA,i=this.bodyB,n=e.vlambda,r=i.vlambda,e=e.wlambda,i=i.wlambda;return this.gmult(t,n,e,r,i)};var d=u.create(),c=u.create();o.prototype.computeGiMf=function(){var t=this.bodyA,e=this.bodyB,i=t.force,n=t.angularForce,r=e.force,o=e.angularForce,s=t.invMassSolve,a=e.invMassSolve,h=t.invInertiaSolve,l=e.invInertiaSolve,p=this.G;return u.scale(d,i,s),u.multiply(d,t.massMultiplier,d),u.scale(c,r,a),u.multiply(c,e.massMultiplier,c),this.gmult(p,d,n*h,c,o*l)},o.prototype.computeGiMGt=function(){var t=this.bodyA,e=this.bodyB,i=t.invMassSolve,n=e.invMassSolve,r=t.invInertiaSolve,o=e.invInertiaSolve,s=this.G;return s[0]*s[0]*i*t.massMultiplier[0]+s[1]*s[1]*i*t.massMultiplier[1]+s[2]*s[2]*r+s[3]*s[3]*n*e.massMultiplier[0]+s[4]*s[4]*n*e.massMultiplier[1]+s[5]*s[5]*o};var y=u.create(),_=u.create(),m=u.create();u.create(),u.create(),u.create(),o.prototype.addToWlambda=function(t){var e=this.bodyA,i=this.bodyB,n=y,r=_,o=m,s=e.invMassSolve,a=i.invMassSolve,h=e.invInertiaSolve,l=i.invInertiaSolve,p=this.G;r[0]=p[0],r[1]=p[1],o[0]=p[3],o[1]=p[4],u.scale(n,r,s*t),u.multiply(n,n,e.massMultiplier),u.add(e.vlambda,e.vlambda,n),e.wlambda+=h*p[2]*t,u.scale(n,o,a*t),u.multiply(n,n,i.massMultiplier),u.add(i.vlambda,i.vlambda,n),i.wlambda+=l*p[5]*t},o.prototype.computeInvC=function(t){return 1/(this.computeGiMGt()+t)}},{"../math/vec2":30,"../objects/Body":31,"../utils/Utils":57}],23:[function(t,e,i){function n(t,e,i){r.call(this,t,e,-i,i),this.contactPointA=a.create(),this.contactPointB=a.create(),this.t=a.create(),this.contactEquations=[],this.shapeA=null,this.shapeB=null,this.frictionCoefficient=.3}var a=t("../math/vec2"),r=t("./Equation");t("../utils/Utils"),(((e.exports=n).prototype=new r).constructor=n).prototype.setSlipForce=function(t){this.maxForce=t,this.minForce=-t},n.prototype.getSlipForce=function(){return this.maxForce},n.prototype.computeB=function(t,e,i){var n=(this.bodyA,this.bodyB,this.contactPointA),r=this.contactPointB,o=this.t,s=this.G;return s[0]=-o[0],s[1]=-o[1],s[2]=-a.crossLength(n,o),s[3]=o[0],s[4]=o[1],s[5]=a.crossLength(r,o),-this.computeGW()*e-i*this.computeGiMf()}},{"../math/vec2":30,"../utils/Utils":57,"./Equation":22}],24:[function(t,e,i){function n(t,e,i){i=i||{},r.call(this,t,e,-Number.MAX_VALUE,Number.MAX_VALUE),this.angle=i.angle||0;i=this.G;i[2]=1,i[5]=-1}var r=t("./Equation"),o=t("../math/vec2");((e.exports=n).prototype=new r).constructor=n;var s=o.create(),a=o.create(),h=o.fromValues(1,0),l=o.fromValues(0,1);n.prototype.computeGq=function(){return o.rotate(s,h,this.bodyA.angle+this.angle),o.rotate(a,l,this.bodyB.angle),o.dot(s,a)}},{"../math/vec2":30,"./Equation":22}],25:[function(t,e,i){function n(t,e){r.call(this,t,e,-Number.MAX_VALUE,Number.MAX_VALUE),this.relativeVelocity=1,this.ratio=1}var r=t("./Equation");t("../math/vec2"),(((e.exports=n).prototype=new r).constructor=n).prototype.computeB=function(t,e,i){var n=this.G;n[2]=-1,n[5]=this.ratio;n=this.computeGiMf();return-this.computeGW()*e-i*n}},{"../math/vec2":30,"./Equation":22}],26:[function(t,e,i){function n(){}(e.exports=n).prototype={constructor:n,on:function(t,e,i){e.context=i||this,void 0===this._listeners&&(this._listeners={});i=this._listeners;return void 0===i[t]&&(i[t]=[]),-1===i[t].indexOf(e)&&i[t].push(e),this},has:function(t,e){if(void 0===this._listeners)return!1;var i=this._listeners;if(e){if(void 0!==i[t]&&-1!==i[t].indexOf(e))return!0}else if(void 0!==i[t])return!0;return!1},off:function(t,e){if(void 0===this._listeners)return this;var i=this._listeners,e=i[t].indexOf(e);return-1!==e&&i[t].splice(e,1),this},emit:function(t){if(void 0===this._listeners)return this;var e=this._listeners[t.type];if(void 0!==e){t.target=this;for(var i=0,n=e.length;i<n;i++){var r=e[i];r.call(r.context,t)}}return this}}},{}],27:[function(t,e,i){function n(t,e,i){if(i=i||{},!(t instanceof r&&e instanceof r))throw new Error("First two arguments must be Material instances.");this.id=n.idCounter++,this.materialA=t,this.materialB=e,this.friction=void 0!==i.friction?Number(i.friction):.3,this.restitution=void 0!==i.restitution?Number(i.restitution):0,this.stiffness=void 0!==i.stiffness?Number(i.stiffness):o.DEFAULT_STIFFNESS,this.relaxation=void 0!==i.relaxation?Number(i.relaxation):o.DEFAULT_RELAXATION,this.frictionStiffness=void 0!==i.frictionStiffness?Number(i.frictionStiffness):o.DEFAULT_STIFFNESS,this.frictionRelaxation=void 0!==i.frictionRelaxation?Number(i.frictionRelaxation):o.DEFAULT_RELAXATION,this.surfaceVelocity=void 0!==i.surfaceVelocity?Number(i.surfaceVelocity):0,this.contactSkinSize=.005}var r=t("./Material"),o=t("../equations/Equation");(e.exports=n).idCounter=0},{"../equations/Equation":22,"./Material":28}],28:[function(t,e,i){function n(t){this.id=t||n.idCounter++}(e.exports=n).idCounter=0},{}],29:[function(t,e,i){var f={GetArea:function(t){if(t.length<6)return 0;for(var e=t.length-2,i=0,n=0;n<e;n+=2)i+=(t[n+2]-t[n])*(t[n+1]+t[n+3]);return.5*-(i+(t[0]-t[e])*(t[1+e]+t[1]))},Triangulate:function(t){var e=t.length>>1;if(e<3)return[];for(var i=[],n=[],r=0;r<e;r++)n.push(r);for(var r=0,o=e;3<o;){var s=n[(r+0)%o],a=n[(r+1)%o],h=n[(r+2)%o],l=t[2*s],p=t[2*s+1],u=t[2*a],d=t[2*a+1],c=t[2*h],y=t[2*h+1],_=!1;if(f._convex(l,p,u,d,c,y))for(var _=!0,m=0;m<o;m++){var g=n[m];if(g!=s&&g!=a&&g!=h&&f._PointInTriangle(t[2*g],t[2*g+1],l,p,u,d,c,y)){_=!1;break}}if(_)i.push(s,a,h),n.splice((r+1)%o,1),o--,r=0;else if(r++>3*o)break}return i.push(n[0],n[1],n[2]),i},_PointInTriangle:function(t,e,i,n,r,o,s,a){s-=i,a-=n,r-=i,o-=n,t-=i,i=e-n,e=s*s+a*a,n=s*r+a*o,s=s*t+a*i,a=r*r+o*o,o=r*t+o*i,i=1/(e*a-n*n),a=(a*s-n*o)*i,i*=e*o-n*s;return 0<=a&&0<=i&&a+i<1},_convex:function(t,e,i,n,r,o){return 0<=(e-n)*(r-i)+(i-t)*(o-n)}};e.exports=f},{}],30:[function(t,e,i){var o=e.exports={},n=t("../utils/Utils");o.crossLength=function(t,e){return t[0]*e[1]-t[1]*e[0]},o.crossVZ=function(t,e,i){return o.rotate(t,e,-Math.PI/2),o.scale(t,t,i),t},o.crossZV=function(t,e,i){return o.rotate(t,i,Math.PI/2),o.scale(t,t,e),t},o.rotate=function(t,e,i){var n,r,o;0!==i?(n=Math.cos(i),r=Math.sin(i),o=e[0],i=e[1],t[0]=n*o-r*i,t[1]=r*o+n*i):(t[0]=e[0],t[1]=e[1])},o.rotate90cw=function(t,e){var i=e[0],e=e[1];t[0]=e,t[1]=-i},o.toLocalFrame=function(t,e,i,n){o.copy(t,e),o.sub(t,t,i),o.rotate(t,t,-n)},o.toGlobalFrame=function(t,e,i,n){o.copy(t,e),o.rotate(t,t,n),o.add(t,t,i)},o.vectorToLocalFrame=function(t,e,i){o.rotate(t,e,-i)},o.vectorToGlobalFrame=function(t,e,i){o.rotate(t,e,i)},o.centroid=function(t,e,i,n){return o.add(t,e,i),o.add(t,t,n),o.scale(t,t,1/3),t},o.create=function(){var t=new n.ARRAY_TYPE(2);return t[0]=0,t[1]=0,t},o.clone=function(t){var e=new n.ARRAY_TYPE(2);return e[0]=t[0],e[1]=t[1],e},o.fromValues=function(t,e){var i=new n.ARRAY_TYPE(2);return i[0]=t,i[1]=e,i},o.copy=function(t,e){return t[0]=e[0],t[1]=e[1],t},o.set=function(t,e,i){return t[0]=e,t[1]=i,t},o.add=function(t,e,i){return t[0]=e[0]+i[0],t[1]=e[1]+i[1],t},o.subtract=function(t,e,i){return t[0]=e[0]-i[0],t[1]=e[1]-i[1],t},o.sub=o.subtract,o.multiply=function(t,e,i){return t[0]=e[0]*i[0],t[1]=e[1]*i[1],t},o.mul=o.multiply,o.divide=function(t,e,i){return t[0]=e[0]/i[0],t[1]=e[1]/i[1],t},o.div=o.divide,o.scale=function(t,e,i){return t[0]=e[0]*i,t[1]=e[1]*i,t},o.distance=function(t,e){var i=e[0]-t[0],t=e[1]-t[1];return Math.sqrt(i*i+t*t)},o.dist=o.distance,o.squaredDistance=function(t,e){var i=e[0]-t[0],t=e[1]-t[1];return i*i+t*t},o.sqrDist=o.squaredDistance,o.length=function(t){var e=t[0],t=t[1];return Math.sqrt(e*e+t*t)},o.len=o.length,o.squaredLength=function(t){var e=t[0],t=t[1];return e*e+t*t},o.sqrLen=o.squaredLength,o.negate=function(t,e){return t[0]=-e[0],t[1]=-e[1],t},o.normalize=function(t,e){var i=e[0],n=e[1],n=i*i+n*n;return 0<n&&(n=1/Math.sqrt(n),t[0]=e[0]*n,t[1]=e[1]*n),t},o.dot=function(t,e){return t[0]*e[0]+t[1]*e[1]},o.str=function(t){return"vec2("+t[0]+", "+t[1]+")"},o.lerp=function(t,e,i,n){var r=e[0],e=e[1];return t[0]=r+n*(i[0]-r),t[1]=e+n*(i[1]-e),t},o.reflect=function(t,e,i){var n=e[0]*i[0]+e[1]*i[1];t[0]=e[0]-2*i[0]*n,t[1]=e[1]-2*i[1]*n},o.getLineSegmentsIntersection=function(t,e,i,n,r){r=o.getLineSegmentsIntersectionFraction(e,i,n,r);return!(r<0||(t[0]=e[0]+r*(i[0]-e[0]),t[1]=e[1]+r*(i[1]-e[1]),0))},o.getLineSegmentsIntersectionFraction=function(t,e,i,n){var r=e[0]-t[0],o=e[1]-t[1],s=n[0]-i[0],e=n[1]-i[1],n=(-o*(t[0]-i[0])+r*(t[1]-i[1]))/(-s*o+r*e),e=(s*(t[1]-i[1])-e*(t[0]-i[0]))/(-s*o+r*e);return 0<=n&&n<=1&&0<=e&&e<=1?e:-1}},{"../utils/Utils":57}],31:[function(t,e,i){function a(t){t=t||{},s.call(this),this.id=t.id||++a._idCounter,this.world=null,this.shapes=[],this.mass=t.mass||0,this.invMass=0,this.inertia=0,this.invInertia=0,this.invMassSolve=0,this.invInertiaSolve=0,this.fixedRotation=!!t.fixedRotation,this.fixedX=!!t.fixedX,this.fixedY=!!t.fixedY,this.massMultiplier=u.create(),this.position=u.fromValues(0,0),t.position&&u.copy(this.position,t.position),this.interpolatedPosition=u.fromValues(0,0),this.interpolatedAngle=0,this.previousPosition=u.fromValues(0,0),this.previousAngle=0,this.velocity=u.fromValues(0,0),t.velocity&&u.copy(this.velocity,t.velocity),this.vlambda=u.fromValues(0,0),this.wlambda=0,this.angle=t.angle||0,this.angularVelocity=t.angularVelocity||0,this.force=u.create(),t.force&&u.copy(this.force,t.force),this.angularForce=t.angularForce||0,this.damping="number"==typeof t.damping?t.damping:.1,this.angularDamping="number"==typeof t.angularDamping?t.angularDamping:.1,this.type=a.STATIC,void 0!==t.type?this.type=t.type:t.mass?this.type=a.DYNAMIC:this.type=a.STATIC,this.boundingRadius=0,this.aabb=new o,this.aabbNeedsUpdate=!0,this.allowSleep=void 0===t.allowSleep||t.allowSleep,this.wantsToSleep=!1,this.sleepState=a.AWAKE,this.sleepSpeedLimit=void 0!==t.sleepSpeedLimit?t.sleepSpeedLimit:.2,this.sleepTimeLimit=void 0!==t.sleepTimeLimit?t.sleepTimeLimit:1,this.gravityScale=void 0!==t.gravityScale?t.gravityScale:1,this.collisionResponse=void 0===t.collisionResponse||t.collisionResponse,this.idleTime=0,this.timeLastSleepy=0,this.ccdSpeedThreshold=void 0!==t.ccdSpeedThreshold?t.ccdSpeedThreshold:-1,this.ccdIterations=void 0!==t.ccdIterations?t.ccdIterations:10,this.concavePath=null,this._wakeUpAfterNarrowphase=!1,this.updateMassProperties()}var u=t("../math/vec2"),l=t("poly-decomp"),p=t("../shapes/Convex"),n=t("../collision/RaycastResult"),r=t("../collision/Ray"),o=t("../collision/AABB"),s=t("../events/EventEmitter");(((e.exports=a).prototype=new s).constructor=a)._idCounter=0,a.prototype.updateSolveMassProperties=function(){this.sleepState===a.SLEEPING||this.type===a.KINEMATIC?(this.invMassSolve=0,this.invInertiaSolve=0):(this.invMassSolve=this.invMass,this.invInertiaSolve=this.invInertia)},a.prototype.setDensity=function(t){var e=this.getArea();this.mass=e*t,this.updateMassProperties()},a.prototype.getArea=function(){for(var t=0,e=0;e<this.shapes.length;e++)t+=this.shapes[e].area;return t},a.prototype.getAABB=function(){return this.aabbNeedsUpdate&&this.updateAABB(),this.aabb};var h=new o,d=u.create();a.prototype.updateAABB=function(){for(var t=this.shapes,e=t.length,i=d,n=this.angle,r=0;r!==e;r++){var o=t[r],s=o.angle+n;u.rotate(i,o.position,n),u.add(i,i,this.position),o.computeAABB(h,i,s),0===r?this.aabb.copy(h):this.aabb.extend(h)}this.aabbNeedsUpdate=!1},a.prototype.updateBoundingRadius=function(){for(var t=this.shapes,e=t.length,i=0,n=0;n!==e;n++){var r=t[n],o=u.length(r.position),r=r.boundingRadius;i<o+r&&(i=o+r)}this.boundingRadius=i},a.prototype.addShape=function(t,e,i){if(t.body)throw new Error("A shape can only be added to one body.");t.body=this,e?u.copy(t.position,e):u.set(t.position,0,0),t.angle=i||0,this.shapes.push(t),this.updateMassProperties(),this.updateBoundingRadius(),this.aabbNeedsUpdate=!0},a.prototype.removeShape=function(t){var e=this.shapes.indexOf(t);return-1!==e&&(this.shapes.splice(e,1),this.aabbNeedsUpdate=!0,!(t.body=null))},a.prototype.updateMassProperties=function(){if(this.type===a.STATIC||this.type===a.KINEMATIC)this.mass=Number.MAX_VALUE,this.invMass=0,this.inertia=Number.MAX_VALUE,this.invInertia=0;else{var t=this.shapes,e=t.length,i=this.mass/e,n=0;if(this.fixedRotation)this.inertia=Number.MAX_VALUE,this.invInertia=0;else{for(var r=0;r<e;r++){var o=t[r],s=u.squaredLength(o.position);n+=o.computeMomentOfInertia(i)+i*s}this.inertia=n,this.invInertia=0<n?1/n:0}this.invMass=1/this.mass,u.set(this.massMultiplier,this.fixedX?0:1,this.fixedY?0:1)}},u.create(),a.prototype.applyForce=function(t,e){u.add(this.force,this.force,t),e&&(t=u.crossLength(e,t),this.angularForce+=t)};var c=u.create(),y=u.create(),_=u.create();a.prototype.applyForceLocal=function(t,e){e=e||_;var i=c,n=y;this.vectorToWorldFrame(i,t),this.vectorToWorldFrame(n,e),this.applyForce(i,n)};var m=u.create();a.prototype.applyImpulse=function(t,e){var i;this.type===a.DYNAMIC&&(u.scale(i=m,t,this.invMass),u.multiply(i,this.massMultiplier,i),u.add(this.velocity,i,this.velocity),e&&(t=u.crossLength(e,t),t*=this.invInertia,this.angularVelocity+=t))};var g=u.create(),f=u.create(),x=u.create();a.prototype.applyImpulseLocal=function(t,e){e=e||x;var i=g,n=f;this.vectorToWorldFrame(i,t),this.vectorToWorldFrame(n,e),this.applyImpulse(i,n)},a.prototype.toLocalFrame=function(t,e){u.toLocalFrame(t,e,this.position,this.angle)},a.prototype.toWorldFrame=function(t,e){u.toGlobalFrame(t,e,this.position,this.angle)},a.prototype.vectorToLocalFrame=function(t,e){u.vectorToLocalFrame(t,e,this.angle)},a.prototype.vectorToWorldFrame=function(t,e){u.vectorToGlobalFrame(t,e,this.angle)},a.prototype.fromPolygon=function(t,e){e=e||{};for(var i=this.shapes.length;0<=i;--i)this.removeShape(this.shapes[i]);var n=new l.Polygon;if(n.vertices=t,n.makeCCW(),"number"==typeof e.removeCollinearPoints&&n.removeCollinearPoints(e.removeCollinearPoints),void 0===e.skipSimpleCheck&&!n.isSimple())return!1;this.concavePath=n.vertices.slice(0);for(i=0;i<this.concavePath.length;i++){var r=[0,0];u.copy(r,this.concavePath[i]),this.concavePath[i]=r}for(var o=e.optimalDecomp?n.decomp():n.quickDecomp(),s=u.create(),i=0;i!==o.length;i++){for(var a=new p({vertices:o[i].vertices}),h=0;h!==a.vertices.length;h++){r=a.vertices[h];u.sub(r,r,a.centerOfMass)}u.scale(s,a.centerOfMass,1),a.updateTriangles(),a.updateCenterOfMass(),a.updateBoundingRadius(),this.addShape(a,s)}return this.adjustCenterOfMass(),this.aabbNeedsUpdate=!0};var v=(u.fromValues(0,0),u.fromValues(0,0)),w=u.fromValues(0,0),z=u.fromValues(0,0);a.prototype.adjustCenterOfMass=function(){var t=v,e=w,i=z,n=0;u.set(e,0,0);for(var r=0;r!==this.shapes.length;r++){var o=this.shapes[r];u.scale(t,o.position,o.area),u.add(e,e,t),n+=o.area}u.scale(i,e,1/n);for(r=0;r!==this.shapes.length;r++){o=this.shapes[r];u.sub(o.position,o.position,i)}u.add(this.position,this.position,i);for(r=0;this.concavePath&&r<this.concavePath.length;r++)u.sub(this.concavePath[r],this.concavePath[r],i);this.updateMassProperties(),this.updateBoundingRadius()},a.prototype.setZeroForce=function(){u.set(this.force,0,0),this.angularForce=0},a.prototype.resetConstraintVelocity=function(){var t=this.vlambda;u.set(t,0,0),this.wlambda=0},a.prototype.addConstraintVelocity=function(){var t=this.velocity;u.add(t,t,this.vlambda),this.angularVelocity+=this.wlambda},a.prototype.applyDamping=function(t){var e;this.type===a.DYNAMIC&&(e=this.velocity,u.scale(e,e,Math.pow(1-this.damping,t)),this.angularVelocity*=Math.pow(1-this.angularDamping,t))},a.prototype.wakeUp=function(){var t=this.sleepState;this.sleepState=a.AWAKE,this.idleTime=0,t!==a.AWAKE&&this.emit(a.wakeUpEvent)},a.prototype.sleep=function(){this.sleepState=a.SLEEPING,this.angularVelocity=0,this.angularForce=0,u.set(this.velocity,0,0),u.set(this.force,0,0),this.emit(a.sleepEvent)},a.prototype.sleepTick=function(t,e,i){this.allowSleep&&this.type!==a.SLEEPING&&(this.wantsToSleep=!1,this.sleepState,u.squaredLength(this.velocity)+Math.pow(this.angularVelocity,2)>=Math.pow(this.sleepSpeedLimit,2)?(this.idleTime=0,this.sleepState=a.AWAKE):(this.idleTime+=i,this.sleepState=a.SLEEPY),this.idleTime>this.sleepTimeLimit&&(e?this.wantsToSleep=!0:this.sleep()))},a.prototype.overlaps=function(t){return this.world.overlapKeeper.bodiesAreOverlapping(this,t)};var b=u.create(),S=u.create();a.prototype.integrate=function(t){var e=this.invMass,i=this.force,n=this.position,r=this.velocity;u.copy(this.previousPosition,this.position),this.previousAngle=this.angle,this.fixedRotation||(this.angularVelocity+=this.angularForce*this.invInertia*t),u.scale(b,i,t*e),u.multiply(b,this.massMultiplier,b),u.add(r,b,r),this.integrateToTimeOfImpact(t)||(u.scale(S,r,t),u.add(n,n,S),this.fixedRotation||(this.angle+=this.angularVelocity*t)),this.aabbNeedsUpdate=!0};var C=new n,P=new r({mode:r.ALL}),M=u.create(),T=u.create(),A=u.create(),k=u.create();a.prototype.integrateToTimeOfImpact=function(t){if(this.ccdSpeedThreshold<0||u.squaredLength(this.velocity)<Math.pow(this.ccdSpeedThreshold,2))return!1;u.normalize(M,this.velocity),u.scale(T,this.velocity,t),u.add(T,T,this.position),u.sub(A,T,this.position);var e,i=this.angularVelocity*t,n=u.length(A),r=1,o=this;if(C.reset(),P.callback=function(t){t.body!==o&&(e=t.body,t.getHitPoint(T,P),u.sub(A,T,o.position),r=u.length(A)/n,t.stop())},u.copy(P.from,this.position),u.copy(P.to,T),P.update(),this.world.raycast(C,P),!e)return!1;var s=this.angle;u.copy(k,this.position);for(var a=0,h=0,l=0,p=r;h<=p&&a<this.ccdIterations;)a++,l=(p-h)/2,u.scale(S,A,r),u.add(this.position,k,S),this.angle=s+i*r,this.updateAABB(),this.aabb.overlaps(e.aabb)&&this.world.narrowphase.bodiesOverlap(this,e)?h=l:p=l;return r=l,u.copy(this.position,k),this.angle=s,u.scale(S,A,r),u.add(this.position,this.position,S),this.fixedRotation||(this.angle+=i*r),!0},a.prototype.getVelocityAtPoint=function(t,e){return u.crossVZ(t,e,this.angularVelocity),u.subtract(t,this.velocity,t),t},a.sleepyEvent={type:"sleepy"},a.sleepEvent={type:"sleep"},a.wakeUpEvent={type:"wakeup"},a.DYNAMIC=1,a.STATIC=2,a.KINEMATIC=4,a.AWAKE=0,a.SLEEPY=1,a.SLEEPING=2},{"../collision/AABB":7,"../collision/Ray":11,"../collision/RaycastResult":12,"../events/EventEmitter":26,"../math/vec2":30,"../shapes/Convex":40,"poly-decomp":5}],32:[function(t,e,i){function n(t,e,i){r.call(this,t,e,i=i||{}),this.localAnchorA=y.fromValues(0,0),this.localAnchorB=y.fromValues(0,0),i.localAnchorA&&y.copy(this.localAnchorA,i.localAnchorA),i.localAnchorB&&y.copy(this.localAnchorB,i.localAnchorB),i.worldAnchorA&&this.setWorldAnchorA(i.worldAnchorA),i.worldAnchorB&&this.setWorldAnchorB(i.worldAnchorB);t=y.create(),e=y.create();this.getWorldAnchorA(t),this.getWorldAnchorB(e);e=y.distance(t,e);this.restLength="number"==typeof i.restLength?i.restLength:e}var y=t("../math/vec2"),r=t("./Spring");t("../utils/Utils"),(((e.exports=n).prototype=new r).constructor=n).prototype.setWorldAnchorA=function(t){this.bodyA.toLocalFrame(this.localAnchorA,t)},n.prototype.setWorldAnchorB=function(t){this.bodyB.toLocalFrame(this.localAnchorB,t)},n.prototype.getWorldAnchorA=function(t){this.bodyA.toWorldFrame(t,this.localAnchorA)},n.prototype.getWorldAnchorB=function(t){this.bodyB.toWorldFrame(t,this.localAnchorB)};var _=y.create(),m=y.create(),g=y.create(),f=y.create(),x=y.create(),v=y.create(),w=y.create(),z=y.create(),b=y.create();n.prototype.applyForce=function(){var t=this.stiffness,e=this.damping,i=this.restLength,n=this.bodyA,r=this.bodyB,o=_,s=m,a=g,h=f,l=b,p=x,u=v,d=w,c=z;this.getWorldAnchorA(p),this.getWorldAnchorB(u),y.sub(d,p,n.position),y.sub(c,u,r.position),y.sub(o,u,p);p=y.len(o);y.normalize(s,o),y.sub(a,r.velocity,n.velocity),y.crossZV(l,r.angularVelocity,c),y.add(a,a,l),y.crossZV(l,n.angularVelocity,d),y.sub(a,a,l),y.scale(h,s,-t*(p-i)-e*y.dot(a,s)),y.sub(n.force,n.force,h),y.add(r.force,r.force,h);d=y.crossLength(d,h),h=y.crossLength(c,h);n.angularForce-=d,r.angularForce+=h}},{"../math/vec2":30,"../utils/Utils":57,"./Spring":34}],33:[function(t,e,i){function n(t,e,i){r.call(this,t,e,i=i||{}),this.restAngle="number"==typeof i.restAngle?i.restAngle:e.angle-t.angle}var r=(t("../math/vec2"),t("./Spring"));(((e.exports=n).prototype=new r).constructor=n).prototype.applyForce=function(){var t=this.stiffness,e=this.damping,i=this.restAngle,n=this.bodyA,r=this.bodyB,e=-t*(r.angle-n.angle-i)-e*(r.angularVelocity-n.angularVelocity)*0;n.angularForce-=e,r.angularForce+=e}},{"../math/vec2":30,"./Spring":34}],34:[function(t,e,i){function n(t,e,i){i=r.defaults(i,{stiffness:100,damping:1}),this.stiffness=i.stiffness,this.damping=i.damping,this.bodyA=t,this.bodyB=e}var r=(t("../math/vec2"),t("../utils/Utils"));(e.exports=n).prototype.applyForce=function(){}},{"../math/vec2":30,"../utils/Utils":57}],35:[function(t,e,i){function n(t,e){this.chassisBody=t,this.wheels=[],this.groundBody=new h({mass:0}),this.world=null;var i=this;this.preStepCallback=function(){i.update()}}function r(t,e){e=e||{},this.vehicle=t,this.forwardEquation=new a(t.chassisBody,t.groundBody),this.sideEquation=new a(t.chassisBody,t.groundBody),this.steerValue=0,this.engineForce=0,this.setSideFriction(void 0!==e.sideFriction?e.sideFriction:5),this.localForwardVector=o.fromValues(0,1),e.localForwardVector&&o.copy(this.localForwardVector,e.localForwardVector),this.localPosition=o.fromValues(0,0),e.localPosition&&o.copy(this.localPosition,e.localPosition),s.apply(this,t.chassisBody,t.groundBody),this.equations.push(this.forwardEquation,this.sideEquation),this.setBrakeForce(0)}var o=t("../math/vec2"),s=(t("../utils/Utils"),t("../constraints/Constraint")),a=t("../equations/FrictionEquation"),h=t("../objects/Body");(e.exports=n).prototype.addToWorld=function(t){(this.world=t).addBody(this.groundBody),t.on("preStep",this.preStepCallback);for(var e=0;e<this.wheels.length;e++){var i=this.wheels[e];t.addConstraint(i)}},n.prototype.removeFromWorld=function(){var t=this.world;t.removeBody(this.groundBody),t.off("preStep",this.preStepCallback);for(var e=0;e<this.wheels.length;e++){var i=this.wheels[e];t.removeConstraint(i)}this.world=null},n.prototype.addWheel=function(t){t=new r(this,t);return this.wheels.push(t),t},n.prototype.update=function(){for(var t=0;t<this.wheels.length;t++)this.wheels[t].update()},(r.prototype=new s).setBrakeForce=function(t){this.forwardEquation.setSlipForce(t)},r.prototype.setSideFriction=function(t){this.sideEquation.setSlipForce(t)};var l=o.create(),p=o.create();r.prototype.getSpeed=function(){return this.vehicle.chassisBody.vectorToWorldFrame(p,this.localForwardVector),this.vehicle.chassisBody.getVelocityAtPoint(l,p),o.dot(l,p)};var u=o.create();r.prototype.update=function(){this.vehicle.chassisBody.vectorToWorldFrame(this.forwardEquation.t,this.localForwardVector),o.rotate(this.sideEquation.t,this.localForwardVector,Math.PI/2),this.vehicle.chassisBody.vectorToWorldFrame(this.sideEquation.t,this.sideEquation.t),o.rotate(this.forwardEquation.t,this.forwardEquation.t,this.steerValue),o.rotate(this.sideEquation.t,this.sideEquation.t,this.steerValue),this.vehicle.chassisBody.toWorldFrame(this.forwardEquation.contactPointB,this.localPosition),o.copy(this.sideEquation.contactPointB,this.forwardEquation.contactPointB),this.vehicle.chassisBody.vectorToWorldFrame(this.forwardEquation.contactPointA,this.localPosition),o.copy(this.sideEquation.contactPointA,this.forwardEquation.contactPointA),o.normalize(u,this.forwardEquation.t),o.scale(u,u,this.engineForce),this.vehicle.chassisBody.applyForce(u,this.forwardEquation.contactPointA)}},{"../constraints/Constraint":14,"../equations/FrictionEquation":23,"../math/vec2":30,"../objects/Body":31,"../utils/Utils":57}],36:[function(t,e,i){t=e.exports={AABB:t("./collision/AABB"),AngleLockEquation:t("./equations/AngleLockEquation"),Body:t("./objects/Body"),Broadphase:t("./collision/Broadphase"),Capsule:t("./shapes/Capsule"),Circle:t("./shapes/Circle"),Constraint:t("./constraints/Constraint"),ContactEquation:t("./equations/ContactEquation"),ContactEquationPool:t("./utils/ContactEquationPool"),ContactMaterial:t("./material/ContactMaterial"),Convex:t("./shapes/Convex"),DistanceConstraint:t("./constraints/DistanceConstraint"),Equation:t("./equations/Equation"),EventEmitter:t("./events/EventEmitter"),FrictionEquation:t("./equations/FrictionEquation"),FrictionEquationPool:t("./utils/FrictionEquationPool"),GearConstraint:t("./constraints/GearConstraint"),GSSolver:t("./solver/GSSolver"),Heightfield:t("./shapes/Heightfield"),Line:t("./shapes/Line"),LockConstraint:t("./constraints/LockConstraint"),Material:t("./material/Material"),Narrowphase:t("./collision/Narrowphase"),NaiveBroadphase:t("./collision/NaiveBroadphase"),Particle:t("./shapes/Particle"),Plane:t("./shapes/Plane"),Pool:t("./utils/Pool"),RevoluteConstraint:t("./constraints/RevoluteConstraint"),PrismaticConstraint:t("./constraints/PrismaticConstraint"),Ray:t("./collision/Ray"),RaycastResult:t("./collision/RaycastResult"),Box:t("./shapes/Box"),RotationalVelocityEquation:t("./equations/RotationalVelocityEquation"),SAPBroadphase:t("./collision/SAPBroadphase"),Shape:t("./shapes/Shape"),Solver:t("./solver/Solver"),Spring:t("./objects/Spring"),TopDownVehicle:t("./objects/TopDownVehicle"),LinearSpring:t("./objects/LinearSpring"),RotationalSpring:t("./objects/RotationalSpring"),Utils:t("./utils/Utils"),World:t("./world/World"),vec2:t("./math/vec2"),version:t("../package.json").version};Object.defineProperty(t,"Rectangle",{get:function(){return this.Box}})},{"../package.json":6,"./collision/AABB":7,"./collision/Broadphase":8,"./collision/NaiveBroadphase":9,"./collision/Narrowphase":10,"./collision/Ray":11,"./collision/RaycastResult":12,"./collision/SAPBroadphase":13,"./constraints/Constraint":14,"./constraints/DistanceConstraint":15,"./constraints/GearConstraint":16,"./constraints/LockConstraint":17,"./constraints/PrismaticConstraint":18,"./constraints/RevoluteConstraint":19,"./equations/AngleLockEquation":20,"./equations/ContactEquation":21,"./equations/Equation":22,"./equations/FrictionEquation":23,"./equations/RotationalVelocityEquation":25,"./events/EventEmitter":26,"./material/ContactMaterial":27,"./material/Material":28,"./math/vec2":30,"./objects/Body":31,"./objects/LinearSpring":32,"./objects/RotationalSpring":33,"./objects/Spring":34,"./objects/TopDownVehicle":35,"./shapes/Box":37,"./shapes/Capsule":38,"./shapes/Circle":39,"./shapes/Convex":40,"./shapes/Heightfield":41,"./shapes/Line":42,"./shapes/Particle":43,"./shapes/Plane":44,"./shapes/Shape":45,"./solver/GSSolver":46,"./solver/Solver":47,"./utils/ContactEquationPool":48,"./utils/FrictionEquationPool":49,"./utils/Pool":55,"./utils/Utils":57,"./world/World":61}],37:[function(t,e,i){function n(t){"number"==typeof arguments[0]&&"number"==typeof arguments[1]&&(t={width:arguments[0],height:arguments[1]});var e=this.width=(t=t||{}).width||1,i=this.height=t.height||1,e=[r.fromValues(-e/2,-i/2),r.fromValues(e/2,-i/2),r.fromValues(e/2,i/2),r.fromValues(-e/2,i/2)],i=[r.fromValues(1,0),r.fromValues(0,1)];t.vertices=e,t.axes=i,t.type=o.BOX,s.call(this,t)}var r=t("../math/vec2"),o=t("./Shape"),s=t("./Convex");(((e.exports=n).prototype=new s).constructor=n).prototype.computeMomentOfInertia=function(t){var e=this.width,i=this.height;return t*(i*i+e*e)/12},n.prototype.updateBoundingRadius=function(){var t=this.width,e=this.height;this.boundingRadius=Math.sqrt(t*t+e*e)/2},r.create(),r.create(),r.create(),r.create(),n.prototype.computeAABB=function(t,e,i){t.setFromPoints(this.vertices,e,i,0)},n.prototype.updateArea=function(){this.area=this.width*this.height}},{"../math/vec2":30,"./Convex":40,"./Shape":45}],38:[function(t,e,i){function n(t){"number"==typeof arguments[0]&&"number"==typeof arguments[1]&&(t={length:arguments[0],radius:arguments[1]}),this.length=(t=t||{}).length||1,this.radius=t.radius||1,t.type=r.CAPSULE,r.call(this,t)}var r=t("./Shape"),x=t("../math/vec2");(((e.exports=n).prototype=new r).constructor=n).prototype.computeMomentOfInertia=function(t){var e=this.radius,i=this.length+e,e=2*e;return t*(e*e+i*i)/12},n.prototype.updateBoundingRadius=function(){this.boundingRadius=this.radius+this.length/2},n.prototype.updateArea=function(){this.area=Math.PI*this.radius*this.radius+2*this.radius*this.length};var o=x.create();n.prototype.computeAABB=function(t,e,i){var n=this.radius;x.set(o,this.length/2,0),0!==i&&x.rotate(o,o,i),x.set(t.upperBound,Math.max(o[0]+n,-o[0]+n),Math.max(o[1]+n,-o[1]+n)),x.set(t.lowerBound,Math.min(o[0]-n,-o[0]-n),Math.min(o[1]-n,-o[1]-n)),x.add(t.lowerBound,t.lowerBound,e),x.add(t.upperBound,t.upperBound,e)};var v=x.create(),w=x.create(),z=x.create(),b=x.create(),S=x.fromValues(0,1);n.prototype.raycast=function(t,e,i,n){for(var r=e.from,o=e.to,s=(e.direction,v),a=w,h=z,l=b,p=this.length/2,u=0;u<2;u++){var d=this.radius*(2*u-1);if(x.set(h,-p,d),x.set(l,p,d),x.toGlobalFrame(h,h,i,n),x.toGlobalFrame(l,l,i,n),0<=(y=x.getLineSegmentsIntersectionFraction(r,o,h,l))&&(x.rotate(a,S,n),x.scale(a,a,2*u-1),e.reportIntersection(t,y,a,-1),t.shouldStop(e)))return}for(var c=Math.pow(this.radius,2)+Math.pow(p,2),u=0;u<2;u++){x.set(h,p*(2*u-1),0),x.toGlobalFrame(h,h,i,n);var y,_=Math.pow(o[0]-r[0],2)+Math.pow(o[1]-r[1],2),m=2*((o[0]-r[0])*(r[0]-h[0])+(o[1]-r[1])*(r[1]-h[1])),g=Math.pow(r[0]-h[0],2)+Math.pow(r[1]-h[1],2)-Math.pow(this.radius,2);if(!((y=Math.pow(m,2)-4*_*g)<0))if(0===y){if(x.lerp(s,r,o,y),x.squaredDistance(s,i)>c&&(x.sub(a,s,h),x.normalize(a,a),e.reportIntersection(t,y,a,-1),t.shouldStop(e)))return}else{var f=Math.sqrt(y),g=1/(2*_),_=(-m-f)*g,g=(-m+f)*g;if(0<=_&&_<=1&&(x.lerp(s,r,o,_),x.squaredDistance(s,i)>c&&(x.sub(a,s,h),x.normalize(a,a),e.reportIntersection(t,_,a,-1),t.shouldStop(e))))return;if(0<=g&&g<=1&&(x.lerp(s,r,o,g),x.squaredDistance(s,i)>c&&(x.sub(a,s,h),x.normalize(a,a),e.reportIntersection(t,g,a,-1),t.shouldStop(e))))return}}}},{"../math/vec2":30,"./Shape":45}],39:[function(t,e,i){function n(t){"number"==typeof arguments[0]&&(t={radius:arguments[0]}),this.radius=(t=t||{}).radius||1,t.type=r.CIRCLE,r.call(this,t)}var r=t("./Shape"),d=t("../math/vec2");(((e.exports=n).prototype=new r).constructor=n).prototype.computeMomentOfInertia=function(t){var e=this.radius;return t*e*e/2},n.prototype.updateBoundingRadius=function(){this.boundingRadius=this.radius},n.prototype.updateArea=function(){this.area=Math.PI*this.radius*this.radius},n.prototype.computeAABB=function(t,e,i){var n=this.radius;d.set(t.upperBound,n,n),d.set(t.lowerBound,-n,-n),e&&(d.add(t.lowerBound,t.lowerBound,e),d.add(t.upperBound,t.upperBound,e))};var c=d.create(),y=d.create();n.prototype.raycast=function(t,e,i,n){var r=e.from,o=e.to,s=this.radius,a=Math.pow(o[0]-r[0],2)+Math.pow(o[1]-r[1],2),h=2*((o[0]-r[0])*(r[0]-i[0])+(o[1]-r[1])*(r[1]-i[1])),l=Math.pow(r[0]-i[0],2)+Math.pow(r[1]-i[1],2)-Math.pow(s,2),p=Math.pow(h,2)-4*a*l,u=c,s=y;p<0||(0==p?(d.lerp(u,r,o,p),d.sub(s,u,i),d.normalize(s,s),e.reportIntersection(t,p,s,-1)):(a=(-h+(l=Math.sqrt(p)))*(p=1/(2*a)),0<=(p=(-h-l)*p)&&p<=1&&(d.lerp(u,r,o,p),d.sub(s,u,i),d.normalize(s,s),e.reportIntersection(t,p,s,-1),t.shouldStop(e))||0<=a&&a<=1&&(d.lerp(u,r,o,a),d.sub(s,u,i),d.normalize(s,s),e.reportIntersection(t,a,s,-1))))}},{"../math/vec2":30,"./Shape":45}],40:[function(t,e,i){function p(t){t=(t=Array.isArray(arguments[0])?{vertices:arguments[0],axes:arguments[1]}:t)||{},this.vertices=[];for(var e=void 0!==t.vertices?t.vertices:[],i=0;i<e.length;i++){var n=c.create();c.copy(n,e[i]),this.vertices.push(n)}if(this.axes=[],t.axes)for(i=0;i<t.axes.length;i++){var r=c.create();c.copy(r,t.axes[i]),this.axes.push(r)}else for(i=0;i<this.vertices.length;i++){var o=this.vertices[i],s=this.vertices[(i+1)%this.vertices.length],a=c.create();c.sub(a,s,o),c.rotate90cw(a,a),c.normalize(a,a),this.axes.push(a)}if(this.centerOfMass=c.fromValues(0,0),this.triangles=[],this.vertices.length&&(this.updateTriangles(),this.updateCenterOfMass()),this.boundingRadius=0,t.type=h.CONVEX,h.call(this,t),this.updateBoundingRadius(),this.updateArea(),this.area<0)throw new Error("Convex vertices must be given in conter-clockwise winding.")}var h=t("./Shape"),c=t("../math/vec2"),a=t("../math/polyk");t("poly-decomp"),((e.exports=p).prototype=new h).constructor=p;var l=c.create(),o=c.create();p.prototype.projectOntoLocalAxis=function(t,e){for(var i,n,r=null,o=null,t=l,s=0;s<this.vertices.length;s++)i=this.vertices[s],i=c.dot(i,t),(null===r||r<i)&&(r=i),(null===o||i<o)&&(o=i);r<o&&(n=o,o=r,r=n),c.set(e,o,r)},p.prototype.projectOntoWorldAxis=function(t,e,i,n){var r=o;this.projectOntoLocalAxis(t,n),0!==i?c.rotate(r,t,i):r=t;r=c.dot(e,r);c.set(n,n[0]+r,n[1]+r)},p.prototype.updateTriangles=function(){for(var t=[],e=this.triangles.length=0;e<this.vertices.length;e++){var i=this.vertices[e];t.push(i[0],i[1])}for(var n=a.Triangulate(t),e=0;e<n.length;e+=3){var r=n[e],o=n[e+1],s=n[e+2];this.triangles.push([r,o,s])}};var u=c.create(),d=c.create();c.create(),c.create(),c.create();c.create(),c.create(),c.create(),c.create(),p.prototype.updateCenterOfMass=function(){var t=this.triangles,e=this.vertices,i=this.centerOfMass,n=u,r=d;c.set(i,0,0);for(var o=0,s=0;s!==t.length;s++){var a=t[s],h=e[a[0]],l=e[a[1]],a=e[a[2]];c.centroid(n,h,l,a);a=p.triangleArea(h,l,a);o+=a,c.scale(r,n,a),c.add(i,i,r)}c.scale(i,i,1/o)},p.prototype.computeMomentOfInertia=function(t){for(var e=0,i=0,n=this.vertices.length,r=n-1,o=0;o<n;r=o,o++){var s=this.vertices[r],a=this.vertices[o],h=Math.abs(c.crossLength(s,a));e+=h*(c.dot(a,a)+c.dot(a,s)+c.dot(s,s)),i+=h}return t/6*(e/i)},p.prototype.updateBoundingRadius=function(){for(var t=this.vertices,e=0,i=0;i!==t.length;i++){var n=c.squaredLength(t[i]);e<n&&(e=n)}this.boundingRadius=Math.sqrt(e)},p.triangleArea=function(t,e,i){return.5*((e[0]-t[0])*(i[1]-t[1])-(i[0]-t[0])*(e[1]-t[1]))},p.prototype.updateArea=function(){this.updateTriangles(),this.area=0;for(var t=this.triangles,e=this.vertices,i=0;i!==t.length;i++){var n=t[i],r=e[n[0]],o=e[n[1]],n=e[n[2]],n=p.triangleArea(r,o,n);this.area+=n}},p.prototype.computeAABB=function(t,e,i){t.setFromPoints(this.vertices,e,i,0)};var y=c.create(),_=c.create(),m=c.create();p.prototype.raycast=function(t,e,i,n){var r=y,o=_,s=m,a=this.vertices;c.toLocalFrame(r,e.from,i,n),c.toLocalFrame(o,e.to,i,n);for(var h=a.length,l=0;l<h&&!t.shouldStop(e);l++){var p=a[l],u=a[(l+1)%h],d=c.getLineSegmentsIntersectionFraction(r,o,p,u);0<=d&&(c.sub(s,u,p),c.rotate(s,s,-Math.PI/2+n),c.normalize(s,s),e.reportIntersection(t,d,s,l))}}},{"../math/polyk":29,"../math/vec2":30,"./Shape":45,"poly-decomp":5}],41:[function(t,e,i){function n(t){if(Array.isArray(arguments[0])&&(t={heights:arguments[0]},"object"==typeof arguments[1]))for(var e in arguments[1])t[e]=arguments[1][e];this.heights=(t=t||{}).heights?t.heights.slice(0):[],this.maxValue=t.maxValue||null,this.minValue=t.minValue||null,this.elementWidth=t.elementWidth||.1,void 0!==t.maxValue&&void 0!==t.minValue||this.updateMaxMinValues(),t.type=r.HEIGHTFIELD,r.call(this,t)}var r=t("./Shape"),c=t("../math/vec2");t("../utils/Utils"),(((e.exports=n).prototype=new r).constructor=n).prototype.updateMaxMinValues=function(){for(var t=this.heights,e=t[0],i=t[0],n=0;n!==t.length;n++){var r=t[n];e<r&&(e=r),r<i&&(i=r)}this.maxValue=e,this.minValue=i},n.prototype.computeMomentOfInertia=function(t){return Number.MAX_VALUE},n.prototype.updateBoundingRadius=function(){this.boundingRadius=Number.MAX_VALUE},n.prototype.updateArea=function(){for(var t=this.heights,e=0,i=0;i<t.length-1;i++)e+=(t[i]+t[i+1])/2*this.elementWidth;this.area=e};var o=[c.create(),c.create(),c.create(),c.create()];n.prototype.computeAABB=function(t,e,i){c.set(o[0],0,this.maxValue),c.set(o[1],this.elementWidth*this.heights.length,this.maxValue),c.set(o[2],this.elementWidth*this.heights.length,this.minValue),c.set(o[3],0,this.minValue),t.setFromPoints(o,e,i)},n.prototype.getLineSegment=function(t,e,i){var n=this.heights,r=this.elementWidth;c.set(t,i*r,n[i]),c.set(e,(i+1)*r,n[i+1])},n.prototype.getSegmentIndex=function(t){return Math.floor(t[0]/this.elementWidth)},n.prototype.getClampedSegmentIndex=function(t){t=this.getSegmentIndex(t);return Math.min(this.heights.length,Math.max(t,0))};var y=(c.create(),c.create()),_=c.create(),m=c.create(),g=c.create(),f=c.create();c.fromValues(0,1),n.prototype.raycast=function(t,e,i,n){var r=e.from,o=e.to,s=(e.direction,y),a=_,h=m,l=g,p=f;c.toLocalFrame(l,r,i,n),c.toLocalFrame(p,o,i,n);var r=this.getClampedSegmentIndex(l),o=this.getClampedSegmentIndex(p);o<r&&(i=r,r=o,o=i);for(var u=0;u<this.heights.length-1;u++){this.getLineSegment(a,h,u);var d=c.getLineSegmentsIntersectionFraction(l,p,a,h);if(0<=d&&(c.sub(s,h,a),c.rotate(s,s,n+Math.PI/2),c.normalize(s,s),e.reportIntersection(t,d,s,-1),t.shouldStop(e)))return}}},{"../math/vec2":30,"../utils/Utils":57,"./Shape":45}],42:[function(t,e,i){function n(t){"number"==typeof arguments[0]&&(t={length:arguments[0]}),this.length=(t=t||{}).length||1,t.type=r.LINE,r.call(this,t)}var r=t("./Shape"),l=t("../math/vec2");(((e.exports=n).prototype=new r).constructor=n).prototype.computeMomentOfInertia=function(t){return t*Math.pow(this.length,2)/12},n.prototype.updateBoundingRadius=function(){this.boundingRadius=this.length/2};var o=[l.create(),l.create()];n.prototype.computeAABB=function(t,e,i){var n=this.length/2;l.set(o[0],-n,0),l.set(o[1],n,0),t.setFromPoints(o,e,i,0)};var p=(l.create(),l.create()),u=l.create(),d=l.create(),c=l.fromValues(0,1);n.prototype.raycast=function(t,e,i,n){var r=e.from,o=e.to,s=u,a=d,h=this.length/2;l.set(s,-h,0),l.set(a,h,0),l.toGlobalFrame(s,s,i,n),l.toGlobalFrame(a,a,i,n);r=l.getLineSegmentsIntersectionFraction(s,a,r,o);0<=r&&(l.rotate(o=p,c,n),e.reportIntersection(t,r,o,-1))}},{"../math/vec2":30,"./Shape":45}],43:[function(t,e,i){function n(t){(t=t||{}).type=r.PARTICLE,r.call(this,t)}var r=t("./Shape"),o=t("../math/vec2");(((e.exports=n).prototype=new r).constructor=n).prototype.computeMomentOfInertia=function(t){return 0},n.prototype.updateBoundingRadius=function(){this.boundingRadius=0},n.prototype.computeAABB=function(t,e,i){o.copy(t.lowerBound,e),o.copy(t.upperBound,e)}},{"../math/vec2":30,"./Shape":45}],44:[function(t,e,i){function n(t){(t=t||{}).type=r.PLANE,r.call(this,t)}var r=t("./Shape"),p=t("../math/vec2");t("../utils/Utils"),(((e.exports=n).prototype=new r).constructor=n).prototype.computeMomentOfInertia=function(t){return 0},n.prototype.updateBoundingRadius=function(){this.boundingRadius=Number.MAX_VALUE},n.prototype.computeAABB=function(t,e,i){var n=i%(2*Math.PI),r=p.set,o=Number.MAX_VALUE,i=t.lowerBound,t=t.upperBound;0==n?(r(i,-o,-o),r(t,o,0)):n==Math.PI/2?(r(i,0,-o),r(t,o,o)):n===Math.PI?(r(i,-o,0),r(t,o,o)):n==3*Math.PI/2?(r(i,-o,-o),r(t,0,o)):(r(i,-o,-o),r(t,o,o)),p.add(i,i,e),p.add(t,t,e)},n.prototype.updateArea=function(){this.area=Number.MAX_VALUE};var u=p.create(),d=(p.create(),p.create(),p.create()),c=p.create();n.prototype.raycast=function(t,e,i,n){var r=e.from,o=e.to,s=e.direction,a=u,h=d,l=c;p.set(h,0,1),p.rotate(h,h,n),p.sub(l,r,i);n=p.dot(l,h);p.sub(l,o,i),0<n*p.dot(l,h)||p.squaredDistance(r,o)<n*n||(s=p.dot(h,s),p.sub(a,r,i),s=-p.dot(h,a)/s/e.length,e.reportIntersection(t,s,h,-1))}},{"../math/vec2":30,"../utils/Utils":57,"./Shape":45}],45:[function(t,e,i){function n(t){t=t||{},this.body=null,this.position=r.fromValues(0,0),t.position&&r.copy(this.position,t.position),this.angle=t.angle||0,this.type=t.type||0,this.id=n.idCounter++,this.boundingRadius=0,this.collisionGroup=void 0!==t.collisionGroup?t.collisionGroup:1,this.collisionResponse=void 0===t.collisionResponse||t.collisionResponse,this.collisionMask=void 0!==t.collisionMask?t.collisionMask:1,this.material=t.material||null,this.area=0,this.sensor=void 0!==t.sensor&&t.sensor,this.type&&this.updateBoundingRadius(),this.updateArea()}e.exports=n;var r=t("../math/vec2");n.idCounter=0,n.CIRCLE=1,n.PARTICLE=2,n.PLANE=4,n.CONVEX=8,n.LINE=16,n.BOX=32,Object.defineProperty(n,"RECTANGLE",{get:function(){return n.BOX}}),n.CAPSULE=64,n.HEIGHTFIELD=128,n.prototype.computeMomentOfInertia=function(t){},n.prototype.updateBoundingRadius=function(){},n.prototype.updateArea=function(){},n.prototype.computeAABB=function(t,e,i){},n.prototype.raycast=function(t,e,i,n){}},{"../math/vec2":30}],46:[function(t,e,i){function z(t){n.call(this,t,n.GS),this.iterations=(t=t||{}).iterations||10,this.tolerance=t.tolerance||1e-7,this.arrayStep=30,this.lambda=new S.ARRAY_TYPE(this.arrayStep),this.Bs=new S.ARRAY_TYPE(this.arrayStep),this.invCs=new S.ARRAY_TYPE(this.arrayStep),this.useZeroRHS=!1,this.frictionIterations=0,this.usedIterations=0}var b=t("../math/vec2"),n=t("./Solver"),S=t("../utils/Utils"),C=t("../equations/FrictionEquation");(((e.exports=z).prototype=new n).constructor=z).prototype.solve=function(t,e){this.sortEquations();var i=0,n=this.iterations,r=this.frictionIterations,o=this.equations,s=o.length,a=Math.pow(this.tolerance*s,2),h=e.bodies,l=e.bodies.length,p=(b.add,b.set,this.useZeroRHS),u=this.lambda;if(this.usedIterations=0,s)for(var d=0;d!==l;d++)h[d].updateSolveMassProperties();u.length<s&&(u=this.lambda=new S.ARRAY_TYPE(s+this.arrayStep),this.Bs=new S.ARRAY_TYPE(s+this.arrayStep),this.invCs=new S.ARRAY_TYPE(s+this.arrayStep)),function(t){for(var e=t.length;e--;)t[e]=0}(u);for(var c,y,_,m=this.invCs,g=this.Bs,u=this.lambda,d=0;d!==o.length;d++)(c=o[d]).timeStep===t&&!c.needsUpdate||(c.timeStep=t,c.update()),g[d]=c.computeB(c.a,c.b,t),m[d]=c.computeInvC(c.epsilon);if(0!==s){for(d=0;d!==l;d++)h[d].resetConstraintVelocity();if(r){for(i=0;i!==r;i++){for(_=y=0;_!==s;_++){c=o[_];var f=z.iterateEquation(_,c,c.epsilon,g,m,u,p,t,i);y+=Math.abs(f)}if(this.usedIterations++,y*y<=a)break}for(z.updateMultipliers(o,u,1/t),_=0;_!==s;_++){var x=o[_];if(x instanceof C){for(var v=0,w=0;w!==x.contactEquations.length;w++)v+=x.contactEquations[w].multiplier;v*=x.frictionCoefficient/x.contactEquations.length,x.maxForce=v,x.minForce=-v}}}for(i=0;i!==n;i++){for(_=y=0;_!==s;_++){c=o[_];f=z.iterateEquation(_,c,c.epsilon,g,m,u,p,t,i);y+=Math.abs(f)}if(this.usedIterations++,y*y<=a)break}for(d=0;d!==l;d++)h[d].addConstraintVelocity();z.updateMultipliers(o,u,1/t)}},z.updateMultipliers=function(t,e,i){for(var n=t.length;n--;)t[n].multiplier=e[n]*i},z.iterateEquation=function(t,e,i,n,r,o,s,a,h){var l=n[t],p=r[t],u=o[t],d=e.computeGWlambda(),n=e.maxForce,r=e.minForce,d=p*((l=s?0:l)-d-i*u),i=u+d;return i<r*a?d=r*a-u:n*a<i&&(d=n*a-u),o[t]+=d,e.addToWlambda(d),d}},{"../equations/FrictionEquation":23,"../math/vec2":30,"../utils/Utils":57,"./Solver":47}],47:[function(t,e,i){function n(t,e){t=t||{},r.call(this),this.type=e,this.equations=[],this.equationSortFunction=t.equationSortFunction||!1}var r=(t("../utils/Utils"),t("../events/EventEmitter"));(((e.exports=n).prototype=new r).constructor=n).prototype.solve=function(t,e){throw new Error("Solver.solve should be implemented by subclasses!")};var o={bodies:[]};n.prototype.solveIsland=function(t,e){this.removeAllEquations(),e.equations.length&&(this.addEquations(e.equations),o.bodies.length=0,e.getBodies(o.bodies),o.bodies.length&&this.solve(t,o))},n.prototype.sortEquations=function(){this.equationSortFunction&&this.equations.sort(this.equationSortFunction)},n.prototype.addEquation=function(t){t.enabled&&this.equations.push(t)},n.prototype.addEquations=function(t){for(var e=0,i=t.length;e!==i;e++){var n=t[e];n.enabled&&this.equations.push(n)}},n.prototype.removeEquation=function(t){t=this.equations.indexOf(t);-1!==t&&this.equations.splice(t,1)},n.prototype.removeAllEquations=function(){this.equations.length=0},n.GS=1,n.ISLAND=2},{"../events/EventEmitter":26,"../utils/Utils":57}],48:[function(t,e,i){function n(){o.apply(this,arguments)}var r=t("../equations/ContactEquation"),o=t("./Pool");(((e.exports=n).prototype=new o).constructor=n).prototype.create=function(){return new r},n.prototype.destroy=function(t){return t.bodyA=t.bodyB=null,this}},{"../equations/ContactEquation":21,"./Pool":55}],49:[function(t,e,i){function n(){o.apply(this,arguments)}var r=t("../equations/FrictionEquation"),o=t("./Pool");(((e.exports=n).prototype=new o).constructor=n).prototype.create=function(){return new r},n.prototype.destroy=function(t){return t.bodyA=t.bodyB=null,this}},{"../equations/FrictionEquation":23,"./Pool":55}],50:[function(t,e,i){function n(){o.apply(this,arguments)}var r=t("../world/IslandNode"),o=t("./Pool");(((e.exports=n).prototype=new o).constructor=n).prototype.create=function(){return new r},n.prototype.destroy=function(t){return t.reset(),this}},{"../world/IslandNode":60,"./Pool":55}],51:[function(t,e,i){function n(){o.apply(this,arguments)}var r=t("../world/Island"),o=t("./Pool");(((e.exports=n).prototype=new o).constructor=n).prototype.create=function(){return new r},n.prototype.destroy=function(t){return t.reset(),this}},{"../world/Island":58,"./Pool":55}],52:[function(t,e,i){function n(){this.overlappingShapesLastState=new r,this.overlappingShapesCurrentState=new r,this.recordPool=new o({size:16}),this.tmpDict=new r,this.tmpArray1=[]}var r=t("./TupleDictionary"),o=(t("./OverlapKeeperRecord"),t("./OverlapKeeperRecordPool"));t("./Utils"),(e.exports=n).prototype.tick=function(){for(var t=this.overlappingShapesLastState,e=this.overlappingShapesCurrentState,i=t.keys.length;i--;){var n=t.keys[i],r=t.getByKey(n);e.getByKey(n),r&&this.recordPool.release(r)}t.reset(),t.copy(e),e.reset()},n.prototype.setOverlapping=function(t,e,i,n){var r,o=(this.overlappingShapesLastState,this.overlappingShapesCurrentState);o.get(e.id,n.id)||((r=this.recordPool.get()).set(t,e,i,n),o.set(e.id,n.id,r))},n.prototype.getNewOverlaps=function(t){return this.getDiff(this.overlappingShapesLastState,this.overlappingShapesCurrentState,t)},n.prototype.getEndOverlaps=function(t){return this.getDiff(this.overlappingShapesCurrentState,this.overlappingShapesLastState,t)},n.prototype.bodiesAreOverlapping=function(t,e){for(var i=this.overlappingShapesCurrentState,n=i.keys.length;n--;){var r=i.keys[n],r=i.data[r];if(r.bodyA===t&&r.bodyB===e||r.bodyA===e&&r.bodyB===t)return!0}return!1},n.prototype.getDiff=function(t,e,i){var n=t,r=e;(i=i||[]).length=0;for(var o=r.keys.length;o--;){var s=r.keys[o],a=r.data[s];if(!a)throw new Error("Key "+s+" had no data!");n.data[s]||i.push(a)}return i},n.prototype.isNewOverlap=function(t,e){var i=0|t.id,n=0|e.id,t=this.overlappingShapesLastState,e=this.overlappingShapesCurrentState;return!t.get(i,n)&&!!e.get(i,n)},n.prototype.getNewBodyOverlaps=function(t){this.tmpArray1.length=0;var e=this.getNewOverlaps(this.tmpArray1);return this.getBodyDiff(e,t)},n.prototype.getEndBodyOverlaps=function(t){this.tmpArray1.length=0;var e=this.getEndOverlaps(this.tmpArray1);return this.getBodyDiff(e,t)},n.prototype.getBodyDiff=function(t,e){e=e||[];for(var i=this.tmpDict,n=t.length;n--;){var r=t[n];i.set(0|r.bodyA.id,0|r.bodyB.id,r)}for(n=i.keys.length;n--;)(r=i.getByKey(i.keys[n]))&&e.push(r.bodyA,r.bodyB);return i.reset(),e}},{"./OverlapKeeperRecord":53,"./OverlapKeeperRecordPool":54,"./TupleDictionary":56,"./Utils":57}],53:[function(t,e,i){function r(t,e,i,n){this.shapeA=e,this.shapeB=n,this.bodyA=t,this.bodyB=i}(e.exports=r).prototype.set=function(t,e,i,n){r.call(this,t,e,i,n)}},{}],54:[function(t,e,i){function n(){o.apply(this,arguments)}var r=t("./OverlapKeeperRecord"),o=t("./Pool");(((e.exports=n).prototype=new o).constructor=n).prototype.create=function(){return new r},n.prototype.destroy=function(t){return t.bodyA=t.bodyB=t.shapeA=t.shapeB=null,this}},{"./OverlapKeeperRecord":53,"./Pool":55}],55:[function(t,e,i){function n(t){t=t||{},this.objects=[],void 0!==t.size&&this.resize(t.size)}(e.exports=n).prototype.resize=function(t){for(var e=this.objects;e.length>t;)e.pop();for(;e.length<t;)e.push(this.create());return this},n.prototype.get=function(){var t=this.objects;return t.length?t.pop():this.create()},n.prototype.release=function(t){return this.destroy(t),this.objects.push(t),this}},{}],56:[function(t,e,i){function n(){this.data={},this.keys=[]}var r=t("./Utils");(e.exports=n).prototype.getKey=function(t,e){return(0|(t|=0))==(0|(e|=0))?-1:0|((0|e)<(0|t)?t<<16|65535&e:e<<16|65535&t)},n.prototype.getByKey=function(t){return this.data[t|=0]},n.prototype.get=function(t,e){return this.data[this.getKey(t,e)]},n.prototype.set=function(t,e,i){if(!i)throw new Error("No data!");e=this.getKey(t,e);return this.data[e]||this.keys.push(e),this.data[e]=i,e},n.prototype.reset=function(){for(var t=this.data,e=this.keys,i=e.length;i--;)delete t[e[i]];e.length=0},n.prototype.copy=function(t){this.reset(),r.appendArray(this.keys,t.keys);for(var e=t.keys.length;e--;){var i=t.keys[e];this.data[i]=t.data[i]}}},{"./Utils":57}],57:[function(t,e,i){function n(){}(e.exports=n).appendArray=function(t,e){if(e.length<15e4)t.push.apply(t,e);else for(var i=0,n=e.length;i!==n;++i)t.push(e[i])},n.splice=function(t,e,i){for(var n=e,r=t.length-(i=i||1);n<r;n++)t[n]=t[n+i];t.length=r},"undefined"!=typeof P2_ARRAY_TYPE?n.ARRAY_TYPE=P2_ARRAY_TYPE:"undefined"!=typeof Float32Array?n.ARRAY_TYPE=Float32Array:n.ARRAY_TYPE=Array,n.extend=function(t,e){for(var i in e)t[i]=e[i]},n.defaults=function(t,e){for(var i in t=t||{},e)i in t||(t[i]=e[i]);return t}},{}],58:[function(t,e,i){function n(){this.equations=[],this.bodies=[]}var r=t("../objects/Body");(e.exports=n).prototype.reset=function(){this.equations.length=this.bodies.length=0};var o=[];n.prototype.getBodies=function(t){for(var e=t||[],i=this.equations,n=o.length=0;n!==i.length;n++){var r=i[n];-1===o.indexOf(r.bodyA.id)&&(e.push(r.bodyA),o.push(r.bodyA.id)),-1===o.indexOf(r.bodyB.id)&&(e.push(r.bodyB),o.push(r.bodyB.id))}return e},n.prototype.wantsToSleep=function(){for(var t=0;t<this.bodies.length;t++){var e=this.bodies[t];if(e.type===r.DYNAMIC&&!e.wantsToSleep)return!1}return!0},n.prototype.sleep=function(){for(var t=0;t<this.bodies.length;t++)this.bodies[t].sleep();return!0}},{"../objects/Body":31}],59:[function(t,e,i){function c(t){this.nodePool=new n({size:16}),this.islandPool=new r({size:8}),this.equations=[],this.islands=[],this.nodes=[],this.queue=[]}var n=(t("../math/vec2"),t("./Island"),t("./IslandNode"),t("./../utils/IslandNodePool")),r=t("./../utils/IslandPool"),s=t("../objects/Body");(e.exports=c).getUnvisitedNode=function(t){for(var e=t.length,i=0;i!==e;i++){var n=t[i];if(!n.visited&&n.body.type===s.DYNAMIC)return n}return!1},c.prototype.visit=function(t,e,i){e.push(t.body);for(var n=t.equations.length,r=0;r!==n;r++){var o=t.equations[r];-1===i.indexOf(o)&&i.push(o)}},c.prototype.bfs=function(t,e,i){var n=this.queue;for(n.length=0,n.push(t),t.visited=!0,this.visit(t,e,i);n.length;)for(var r,o=n.pop();r=c.getUnvisitedNode(o.neighbors);)r.visited=!0,this.visit(r,e,i),r.body.type===s.DYNAMIC&&n.push(r)},c.prototype.split=function(t){for(var e=t.bodies,i=this.nodes,n=this.equations;i.length;)this.nodePool.release(i.pop());for(var r=0;r!==e.length;r++){var o=this.nodePool.get();o.body=e[r],i.push(o)}for(var s=0;s!==n.length;s++){var a=n[s],r=e.indexOf(a.bodyA),h=e.indexOf(a.bodyB),l=i[r],h=i[h];l.neighbors.push(h),h.neighbors.push(l),l.equations.push(a),h.equations.push(a)}for(var p,u=this.islands,r=0;r<u.length;r++)this.islandPool.release(u[r]);for(u.length=0;p=c.getUnvisitedNode(i);){var d=this.islandPool.get();this.bfs(p,d.bodies,d.equations),u.push(d)}return u}},{"../math/vec2":30,"../objects/Body":31,"./../utils/IslandNodePool":50,"./../utils/IslandPool":51,"./Island":58,"./IslandNode":60}],60:[function(t,e,i){function n(t){this.body=t,this.neighbors=[],this.equations=[],this.visited=!1}(e.exports=n).prototype.reset=function(){this.equations.length=0,this.neighbors.length=0,this.visited=!1,this.body=null}},{}],61:[function(t,e,i){function W(t){r.apply(this),t=t||{},this.springs=[],this.bodies=[],this.disabledBodyCollisionPairs=[],this.solver=t.solver||new n,this.narrowphase=new l(this),this.islandManager=new u,this.gravity=X.fromValues(0,-9.78),t.gravity&&X.copy(this.gravity,t.gravity),this.frictionGravity=X.length(this.gravity)||10,this.useWorldGravityAsFrictionGravity=!0,this.useFrictionGravityOnZeroGravity=!0,this.broadphase=t.broadphase||new h,this.broadphase.setWorld(this),this.constraints=[],this.defaultMaterial=new o,this.defaultContactMaterial=new s(this.defaultMaterial,this.defaultMaterial),this.lastTimeStep=1/60,this.applySpringForces=!0,this.applyDamping=!0,this.applyGravity=!0,this.solveConstraints=!0,this.contactMaterials=[],this.time=0,this.accumulator=0,this.stepping=!1,this.bodiesToBeRemoved=[],this.islandSplit=void 0===t.islandSplit||!!t.islandSplit,this.emitImpactEvent=!0,this._constraintIdCounter=0,this._bodyIdCounter=0,this.postStepEvent={type:"postStep"},this.addBodyEvent={type:"addBody",body:null},this.removeBodyEvent={type:"removeBody",body:null},this.addSpringEvent={type:"addSpring",spring:null},this.impactEvent={type:"impact",bodyA:null,bodyB:null,shapeA:null,shapeB:null,contactEquation:null},this.postBroadphaseEvent={type:"postBroadphase",pairs:null},this.sleepMode=W.NO_SLEEPING,this.beginContactEvent={type:"beginContact",shapeA:null,shapeB:null,bodyA:null,bodyB:null,contactEquations:[]},this.endContactEvent={type:"endContact",shapeA:null,shapeB:null,bodyA:null,bodyB:null},this.preSolveEvent={type:"preSolve",contactEquations:null,frictionEquations:null},this.overlappingShapesLastState={keys:[]},this.overlappingShapesCurrentState={keys:[]},this.overlapKeeper=new p}var n=t("../solver/GSSolver"),X=(t("../solver/Solver"),t("../collision/Ray"),t("../math/vec2")),g=t("../shapes/Circle"),f=t("../shapes/Convex"),x=(t("../shapes/Line"),t("../shapes/Plane")),v=t("../shapes/Capsule"),w=t("../shapes/Particle"),r=t("../events/EventEmitter"),H=t("../objects/Body"),o=(t("../shapes/Shape"),t("../objects/LinearSpring"),t("../material/Material")),s=t("../material/ContactMaterial"),a=(t("../constraints/DistanceConstraint"),t("../constraints/Constraint"),t("../constraints/LockConstraint"),t("../constraints/RevoluteConstraint"),t("../constraints/PrismaticConstraint"),t("../constraints/GearConstraint"),t("../../package.json"),t("../collision/Broadphase"),t("../collision/AABB")),h=t("../collision/SAPBroadphase"),l=t("../collision/Narrowphase"),q=t("../utils/Utils"),p=t("../utils/OverlapKeeper"),u=t("./IslandManager");t("../objects/RotationalSpring"),(((e.exports=W).prototype=new Object(r.prototype)).constructor=W).NO_SLEEPING=1,W.BODY_SLEEPING=2,W.ISLAND_SLEEPING=4,W.prototype.addConstraint=function(t){this.constraints.push(t)},W.prototype.addContactMaterial=function(t){this.contactMaterials.push(t)},W.prototype.removeContactMaterial=function(t){t=this.contactMaterials.indexOf(t);-1!==t&&q.splice(this.contactMaterials,t,1)},W.prototype.getContactMaterial=function(t,e){for(var i=this.contactMaterials,n=0,r=i.length;n!==r;n++){var o=i[n];if(o.materialA.id===t.id&&o.materialB.id===e.id||o.materialA.id===e.id&&o.materialB.id===t.id)return o}return!1},W.prototype.removeConstraint=function(t){t=this.constraints.indexOf(t);-1!==t&&q.splice(this.constraints,t,1)};var Y=(X.create(),X.create(),X.create(),X.create(),X.create(),X.create(),X.create()),_=X.fromValues(0,0),m=X.fromValues(0,0);X.fromValues(0,0),X.fromValues(0,0),W.prototype.step=function(t,e,i){if(i=i||10,0===(e=e||0))this.internalStep(t),this.time+=t;else{this.accumulator+=e;for(var n=0;this.accumulator>=t&&n<i;)this.internalStep(t),this.time+=t,this.accumulator-=t,n++;for(var r=this.accumulator%t/t,o=0;o!==this.bodies.length;o++){var s=this.bodies[o];X.lerp(s.interpolatedPosition,s.previousPosition,s.position,r),s.interpolatedAngle=s.previousAngle+r*(s.angle-s.previousAngle)}}};var K=[];W.prototype.internalStep=function(t){this.stepping=!0;var e,i=this.springs.length,n=this.springs,r=this.bodies,o=this.gravity,s=this.solver,a=this.bodies.length,h=this.broadphase,l=this.narrowphase,p=this.constraints,u=Y,d=(X.scale,X.add),c=(X.rotate,this.islandManager);if(this.overlapKeeper.tick(),this.lastTimeStep=t,this.useWorldGravityAsFrictionGravity&&(0===(e=X.length(this.gravity))&&this.useFrictionGravityOnZeroGravity||(this.frictionGravity=e)),this.applyGravity)for(var y=0;y!==a;y++){var _,m=(_=r[y]).force;_.type===H.DYNAMIC&&_.sleepState!==H.SLEEPING&&(X.scale(u,o,_.mass*_.gravityScale),d(m,m,u))}if(this.applySpringForces)for(y=0;y!==i;y++)n[y].applyForce();if(this.applyDamping)for(y=0;y!==a;y++)(_=r[y]).type===H.DYNAMIC&&_.applyDamping(t);for(var g=h.getCollisionPairs(this),f=this.disabledBodyCollisionPairs,y=f.length-2;0<=y;y-=2)for(var x=g.length-2;0<=x;x-=2)(f[y]===g[x]&&f[y+1]===g[x+1]||f[y+1]===g[x]&&f[y]===g[x+1])&&g.splice(x,2);var v=p.length;for(y=0;y!==v;y++){var w=p[y];if(!w.collideConnected)for(x=g.length-2;0<=x;x-=2)(w.bodyA===g[x]&&w.bodyB===g[x+1]||w.bodyB===g[x]&&w.bodyA===g[x+1])&&g.splice(x,2)}this.postBroadphaseEvent.pairs=g,this.emit(this.postBroadphaseEvent),this.postBroadphaseEvent.pairs=null,l.reset(this);for(var y=0,z=g.length;y!==z;y+=2)for(var b=g[y],S=g[y+1],C=0,P=b.shapes.length;C!==P;C++)for(var M=b.shapes[C],T=M.position,A=M.angle,k=0,O=S.shapes.length;k!==O;k++){var E,I=S.shapes[k],G=I.position,D=I.angle,L=this.defaultContactMaterial;M.material&&I.material&&((E=this.getContactMaterial(M.material,I.material))&&(L=E)),this.runNarrowphase(l,b,M,T,A,S,I,G,D,L,this.frictionGravity)}for(y=0;y!==a;y++)(F=r[y])._wakeUpAfterNarrowphase&&(F.wakeUp(),F._wakeUpAfterNarrowphase=!1);if(this.has("endContact")){this.overlapKeeper.getEndOverlaps(K);for(var B=this.endContactEvent,k=K.length;k--;){var R=K[k];B.shapeA=R.shapeA,B.shapeB=R.shapeB,B.bodyA=R.bodyA,B.bodyB=R.bodyB,this.emit(B)}K.length=0}h=this.preSolveEvent;h.contactEquations=l.contactEquations,h.frictionEquations=l.frictionEquations,this.emit(h),h.contactEquations=h.frictionEquations=null;v=p.length;for(y=0;y!==v;y++)p[y].update();if(l.contactEquations.length||l.frictionEquations.length||v)if(this.islandSplit){for(c.equations.length=0,q.appendArray(c.equations,l.contactEquations),q.appendArray(c.equations,l.frictionEquations),y=0;y!==v;y++)q.appendArray(c.equations,p[y].equations);c.split(this);for(y=0;y!==c.islands.length;y++)(U=c.islands[y]).equations.length&&s.solveIsland(t,U)}else{for(s.addEquations(l.contactEquations),s.addEquations(l.frictionEquations),y=0;y!==v;y++)s.addEquations(p[y].equations);this.solveConstraints&&s.solve(t,this),s.removeAllEquations()}for(var F,y=0;y!==a;y++)(F=r[y]).integrate(t);for(y=0;y!==a;y++)r[y].setZeroForce();if(this.emitImpactEvent&&this.has("impact"))for(var N=this.impactEvent,y=0;y!==l.contactEquations.length;y++){var j=l.contactEquations[y];j.firstImpact&&(N.bodyA=j.bodyA,N.bodyB=j.bodyB,N.shapeA=j.shapeA,N.shapeB=j.shapeB,N.contactEquation=j,this.emit(N))}if(this.sleepMode===W.BODY_SLEEPING)for(y=0;y!==a;y++)r[y].sleepTick(this.time,!1,t);else if(this.sleepMode===W.ISLAND_SLEEPING&&this.islandSplit){for(y=0;y!==a;y++)r[y].sleepTick(this.time,!0,t);for(var U,y=0;y<this.islandManager.islands.length;y++)(U=this.islandManager.islands[y]).wantsToSleep()&&U.sleep()}this.stepping=!1;for(var V=this.bodiesToBeRemoved,y=0;y!==V.length;y++)this.removeBody(V[y]);V.length=0,this.emit(this.postStepEvent)},W.prototype.runNarrowphase=function(t,e,i,n,r,o,s,a,h,l,p){if(0!=(i.collisionGroup&s.collisionMask)&&0!=(s.collisionGroup&i.collisionMask)){X.rotate(_,n,e.angle),X.rotate(m,a,o.angle),X.add(_,_,e.position),X.add(m,m,o.position);a=r+e.angle,r=h+o.angle;t.enableFriction=0<l.friction,t.frictionCoefficient=l.friction,h=e.type===H.STATIC||e.type===H.KINEMATIC?o.mass:o.type===H.STATIC||o.type===H.KINEMATIC?e.mass:e.mass*o.mass/(e.mass+o.mass),t.slipForce=l.friction*p*h,t.restitution=l.restitution,t.surfaceVelocity=l.surfaceVelocity,t.frictionStiffness=l.frictionStiffness,t.frictionRelaxation=l.frictionRelaxation,t.stiffness=l.stiffness,t.relaxation=l.relaxation,t.contactSkinSize=l.contactSkinSize,t.enabledEquations=e.collisionResponse&&o.collisionResponse&&i.collisionResponse&&s.collisionResponse;p=t[i.type|s.type];if(p){var h=i.sensor||s.sensor,l=t.frictionEquations.length,h=i.type<s.type?p.call(t,e,i,_,a,o,s,m,r,h):p.call(t,o,s,m,r,e,i,_,a,h),u=t.frictionEquations.length-l;if(h){if(e.allowSleep&&e.type===H.DYNAMIC&&e.sleepState===H.SLEEPING&&o.sleepState===H.AWAKE&&o.type!==H.STATIC&&X.squaredLength(o.velocity)+Math.pow(o.angularVelocity,2)>=2*Math.pow(o.sleepSpeedLimit,2)&&(e._wakeUpAfterNarrowphase=!0),o.allowSleep&&o.type===H.DYNAMIC&&o.sleepState===H.SLEEPING&&e.sleepState===H.AWAKE&&e.type!==H.STATIC&&X.squaredLength(e.velocity)+Math.pow(e.angularVelocity,2)>=2*Math.pow(e.sleepSpeedLimit,2)&&(o._wakeUpAfterNarrowphase=!0),this.overlapKeeper.setOverlapping(e,i,o,s),this.has("beginContact")&&this.overlapKeeper.isNewOverlap(i,s)){var d=this.beginContactEvent;if(d.shapeA=i,d.shapeB=s,d.bodyA=e,d.bodyB=o,d.contactEquations.length=0,"number"==typeof h)for(var c=t.contactEquations.length-h;c<t.contactEquations.length;c++)d.contactEquations.push(t.contactEquations[c]);this.emit(d)}if("number"==typeof h&&1<u)for(c=t.frictionEquations.length-u;c<t.frictionEquations.length;c++){var y=t.frictionEquations[c];y.setSlipForce(y.getSlipForce()/u)}}}}},W.prototype.addSpring=function(t){this.springs.push(t);var e=this.addSpringEvent;e.spring=t,this.emit(e),e.spring=null},W.prototype.removeSpring=function(t){t=this.springs.indexOf(t);-1!==t&&q.splice(this.springs,t,1)},W.prototype.addBody=function(t){var e;-1===this.bodies.indexOf(t)&&(this.bodies.push(t),(e=(t.world=this).addBodyEvent).body=t,this.emit(e),e.body=null)},W.prototype.removeBody=function(t){var e;this.stepping?this.bodiesToBeRemoved.push(t):(t.world=null,-1!==(e=this.bodies.indexOf(t))&&(q.splice(this.bodies,e,1),(this.removeBodyEvent.body=t).resetConstraintVelocity(),this.emit(this.removeBodyEvent),this.removeBodyEvent.body=null))},W.prototype.getBodyById=function(t){for(var e=this.bodies,i=0;i<e.length;i++){var n=e[i];if(n.id===t)return n}return!1},W.prototype.disableBodyCollision=function(t,e){this.disabledBodyCollisionPairs.push(t,e)},W.prototype.enableBodyCollision=function(t,e){for(var i=this.disabledBodyCollisionPairs,n=0;n<i.length;n+=2)if(i[n]===t&&i[n+1]===e||i[n+1]===t&&i[n]===e)return void i.splice(n,2)},W.prototype.clear=function(){this.time=0,this.solver&&this.solver.equations.length&&this.solver.removeAllEquations();for(var t=this.constraints,e=t.length-1;0<=e;e--)this.removeConstraint(t[e]);for(var i=this.bodies,e=i.length-1;0<=e;e--)this.removeBody(i[e]);for(var n=this.springs,e=n.length-1;0<=e;e--)this.removeSpring(n[e]);for(var r=this.contactMaterials,e=r.length-1;0<=e;e--)this.removeContactMaterial(r[e]);W.apply(this)};var z=X.create(),b=(X.fromValues(0,0),X.fromValues(0,0));W.prototype.hitTest=function(t,e,i){i=i||0;var n=new H({position:t}),r=new w,o=t,s=z,a=b;n.addShape(r);for(var h=this.narrowphase,l=[],p=0,u=e.length;p!==u;p++)for(var d=e[p],c=0,y=d.shapes.length;c!==y;c++){var _=d.shapes[c];X.rotate(s,_.position,d.angle),X.add(s,s,d.position);var m=_.angle+d.angle;(_ instanceof g&&h.circleParticle(d,_,s,m,n,r,o,0,!0)||_ instanceof f&&h.particleConvex(n,r,o,0,d,_,s,m,!0)||_ instanceof x&&h.particlePlane(n,r,o,0,d,_,s,m,!0)||_ instanceof v&&h.particleCapsule(n,r,o,0,d,_,s,m,!0)||_ instanceof w&&X.squaredLength(X.sub(a,s,t))<i*i)&&l.push(d)}return l},W.prototype.setGlobalStiffness=function(t){for(var e=this.constraints,i=0;i!==e.length;i++)for(var n=e[i],r=0;r!==n.equations.length;r++){var o=n.equations[r];o.stiffness=t,o.needsUpdate=!0}for(var s=this.contactMaterials,i=0;i!==s.length;i++)(n=s[i]).stiffness=n.frictionStiffness=t;(n=this.defaultContactMaterial).stiffness=n.frictionStiffness=t},W.prototype.setGlobalRelaxation=function(t){for(var e=0;e!==this.constraints.length;e++)for(var i=this.constraints[e],n=0;n!==i.equations.length;n++){var r=i.equations[n];r.relaxation=t,r.needsUpdate=!0}for(e=0;e!==this.contactMaterials.length;e++)(i=this.contactMaterials[e]).relaxation=i.frictionRelaxation=t;(i=this.defaultContactMaterial).relaxation=i.frictionRelaxation=t};var d=new a,c=[];W.prototype.raycast=function(t,e){return e.getAABB(d),this.broadphase.aabbQuery(this,d,c),e.intersectBodies(t,c),c.length=0,t.hasHit()}},{"../../package.json":6,"../collision/AABB":7,"../collision/Broadphase":8,"../collision/Narrowphase":10,"../collision/Ray":11,"../collision/SAPBroadphase":13,"../constraints/Constraint":14,"../constraints/DistanceConstraint":15,"../constraints/GearConstraint":16,"../constraints/LockConstraint":17,"../constraints/PrismaticConstraint":18,"../constraints/RevoluteConstraint":19,"../events/EventEmitter":26,"../material/ContactMaterial":27,"../material/Material":28,"../math/vec2":30,"../objects/Body":31,"../objects/LinearSpring":32,"../objects/RotationalSpring":33,"../shapes/Capsule":38,"../shapes/Circle":39,"../shapes/Convex":40,"../shapes/Line":42,"../shapes/Particle":43,"../shapes/Plane":44,"../shapes/Shape":45,"../solver/GSSolver":46,"../solver/Solver":47,"../utils/OverlapKeeper":52,"../utils/Utils":57,"./IslandManager":59}]},{},[36])(36)}),function(){var t=this,P={game:null,WEBGL_RENDERER:0,CANVAS_RENDERER:1,VERSION:"v2.2.9",_UID:0};return"undefined"!=typeof Float32Array?(P.Float32Array=Float32Array,P.Uint16Array=Uint16Array,P.Uint32Array=Uint32Array,P.ArrayBuffer=ArrayBuffer):(P.Float32Array=Array,P.Uint16Array=Array),P.PI_2=2*Math.PI,P.RAD_TO_DEG=180/Math.PI,P.DEG_TO_RAD=Math.PI/180,P.RETINA_PREFIX="@2x",P.DisplayObject=function(){this.position=new P.Point(0,0),this.scale=new P.Point(1,1),this.pivot=new P.Point(0,0),this.rotation=0,this.alpha=1,this.visible=!0,this.hitArea=null,this.renderable=!1,this.parent=null,this.worldAlpha=1,this.worldTransform=new P.Matrix,this.worldPosition=new P.Point(0,0),this.worldScale=new P.Point(1,1),this.worldRotation=0,this.filterArea=null,this._sr=0,this._cr=1,this._bounds=new P.Rectangle(0,0,0,0),this._currentBounds=null,this._mask=null,this._cacheAsBitmap=!1,this._cacheIsDirty=!1},P.DisplayObject.prototype.constructor=P.DisplayObject,P.DisplayObject.prototype={destroy:function(){if(this.children){for(var t=this.children.length;t--;)this.children[t].destroy();this.children=[]}this.hitArea=null,this.parent=null,this.worldTransform=null,this.filterArea=null,this.renderable=!1,this._bounds=null,this._currentBounds=null,this._mask=null,this._destroyCachedSprite()},updateTransform:function(t){if(!t&&!this.parent&&!this.game)return this;var e=this.parent;t?e=t:this.parent||(e=this.game.world);var i,n,r,o,s,a=e.worldTransform,h=this.worldTransform;return this.rotation%P.PI_2?(this.rotation!==this.rotationCache&&(this.rotationCache=this.rotation,this._sr=Math.sin(this.rotation),this._cr=Math.cos(this.rotation)),i=this._cr*this.scale.x,n=this._sr*this.scale.x,t=-this._sr*this.scale.y,r=this._cr*this.scale.y,o=this.position.x,s=this.position.y,(this.pivot.x||this.pivot.y)&&(o-=this.pivot.x*i+this.pivot.y*t,s-=this.pivot.x*n+this.pivot.y*r),h.a=i*a.a+n*a.c,h.b=i*a.b+n*a.d,h.c=t*a.a+r*a.c,h.d=t*a.b+r*a.d):(i=this.scale.x,r=this.scale.y,o=this.position.x-this.pivot.x*i,s=this.position.y-this.pivot.y*r,h.a=i*a.a,h.b=i*a.b,h.c=r*a.c,h.d=r*a.d),h.tx=o*a.a+s*a.c+a.tx,h.ty=o*a.b+s*a.d+a.ty,this.worldAlpha=this.alpha*e.worldAlpha,this.worldPosition.set(h.tx,h.ty),this.worldScale.set(this.scale.x*Math.sqrt(h.a*h.a+h.c*h.c),this.scale.y*Math.sqrt(h.b*h.b+h.d*h.d)),this.worldRotation=Math.atan2(-h.c,h.d),this._currentBounds=null,this.transformCallback&&this.transformCallback.call(this.transformCallbackContext,h,a),this},preUpdate:function(){},generateTexture:function(t,e,i){var n=this.getLocalBounds(),t=new P.RenderTexture(0|n.width,0|n.height,i,e,t);return P.DisplayObject._tempMatrix.tx=-n.x,P.DisplayObject._tempMatrix.ty=-n.y,t.render(this,P.DisplayObject._tempMatrix),t},updateCache:function(){return this._generateCachedSprite(),this},toGlobal:function(t){return this.updateTransform(),this.worldTransform.apply(t)},toLocal:function(t,e){return e&&(t=e.toGlobal(t)),this.updateTransform(),this.worldTransform.applyInverse(t)},_renderCachedSprite:function(t){this._cachedSprite.worldAlpha=this.worldAlpha,(t.gl?P.Sprite.prototype._renderWebGL:P.Sprite.prototype._renderCanvas).call(this._cachedSprite,t)},_generateCachedSprite:function(){this._cacheAsBitmap=!1;var t=this.getLocalBounds();t.width=Math.max(1,Math.ceil(t.width)),t.height=Math.max(1,Math.ceil(t.height)),this.updateTransform(),this._cachedSprite?this._cachedSprite.texture.resize(t.width,t.height):(e=new P.RenderTexture(t.width,t.height),this._cachedSprite=new P.Sprite(e),this._cachedSprite.worldTransform=this.worldTransform);var e=this._filters;this._filters=null,this._cachedSprite.filters=e,P.DisplayObject._tempMatrix.tx=-t.x,P.DisplayObject._tempMatrix.ty=-t.y,this._cachedSprite.texture.render(this,P.DisplayObject._tempMatrix,!0),this._cachedSprite.anchor.x=-t.x/t.width,this._cachedSprite.anchor.y=-t.y/t.height,this._filters=e,this._cacheAsBitmap=!0},_destroyCachedSprite:function(){this._cachedSprite&&(this._cachedSprite.texture.destroy(!0),this._cachedSprite=null)}},P.DisplayObject.prototype.displayObjectUpdateTransform=P.DisplayObject.prototype.updateTransform,Object.defineProperties(P.DisplayObject.prototype,{x:{get:function(){return this.position.x},set:function(t){this.position.x=t}},y:{get:function(){return this.position.y},set:function(t){this.position.y=t}},worldVisible:{get:function(){if(this.visible){var t=this.parent;if(!t)return this.visible;do{if(!t.visible)return!1}while(t=t.parent);return!0}return!1}},mask:{get:function(){return this._mask},set:function(t){this._mask&&(this._mask.isMask=!1),(this._mask=t)&&(this._mask.isMask=!0)}},filters:{get:function(){return this._filters},set:function(t){if(Array.isArray(t)){for(var e=[],i=0;i<t.length;i++)for(var n=t[i].passes,r=0;r<n.length;r++)e.push(n[r]);this._filterBlock={target:this,filterPasses:e}}this._filters=t,this.blendMode&&this.blendMode===P.blendModes.MULTIPLY&&(this.blendMode=P.blendModes.NORMAL)}},cacheAsBitmap:{get:function(){return this._cacheAsBitmap},set:function(t){this._cacheAsBitmap!==t&&(t?this._generateCachedSprite():this._destroyCachedSprite(),this._cacheAsBitmap=t)}}}),P.DisplayObjectContainer=function(){P.DisplayObject.call(this),this.children=[],this.ignoreChildInput=!1},P.DisplayObjectContainer.prototype=Object.create(P.DisplayObject.prototype),P.DisplayObjectContainer.prototype.constructor=P.DisplayObjectContainer,P.DisplayObjectContainer.prototype.addChild=function(t){return this.addChildAt(t,this.children.length)},P.DisplayObjectContainer.prototype.addChildAt=function(t,e){if(0<=e&&e<=this.children.length)return t.parent&&t.parent.removeChild(t),(t.parent=this).children.splice(e,0,t),t;throw new Error(t+"addChildAt: The index "+e+" supplied is out of bounds "+this.children.length)},P.DisplayObjectContainer.prototype.swapChildren=function(t,e){if(t!==e){var i=this.getChildIndex(t),n=this.getChildIndex(e);if(i<0||n<0)throw new Error("swapChildren: Both the supplied DisplayObjects must be a child of the caller.");this.children[i]=e,this.children[n]=t}},P.DisplayObjectContainer.prototype.getChildIndex=function(t){t=this.children.indexOf(t);if(-1===t)throw new Error("The supplied DisplayObject must be a child of the caller");return t},P.DisplayObjectContainer.prototype.setChildIndex=function(t,e){if(e<0||e>=this.children.length)throw new Error("The supplied index is out of bounds");var i=this.getChildIndex(t);this.children.splice(i,1),this.children.splice(e,0,t)},P.DisplayObjectContainer.prototype.getChildAt=function(t){if(t<0||t>=this.children.length)throw new Error("getChildAt: Supplied index "+t+" does not exist in the child list, or the supplied DisplayObject must be a child of the caller");return this.children[t]},P.DisplayObjectContainer.prototype.removeChild=function(t){t=this.children.indexOf(t);if(-1!==t)return this.removeChildAt(t)},P.DisplayObjectContainer.prototype.removeChildAt=function(t){var e=this.getChildAt(t);return e&&(e.parent=void 0,this.children.splice(t,1)),e},P.DisplayObjectContainer.prototype.removeChildren=function(t,e){var i=(e=void 0===e?this.children.length:e)-(t=void 0===t?0:t);if(0<i&&i<=e){for(var n=this.children.splice(t,i),r=0;r<n.length;r++)n[r].parent=void 0;return n}if(0==i&&0===this.children.length)return[];throw new Error("removeChildren: Range Error, numeric values are outside the acceptable range")},P.DisplayObjectContainer.prototype.updateTransform=function(){if(this.visible&&(this.displayObjectUpdateTransform(),!this._cacheAsBitmap))for(var t=0;t<this.children.length;t++)this.children[t].updateTransform()},P.DisplayObjectContainer.prototype.displayObjectContainerUpdateTransform=P.DisplayObjectContainer.prototype.updateTransform,P.DisplayObjectContainer.prototype.getBounds=function(t){var e=t&&t instanceof P.DisplayObject,i=!0;if(e?i=t instanceof P.DisplayObjectContainer&&t.contains(this):t=this,e){var n=t.worldTransform;for(t.worldTransform=P.identityMatrix,u=0;u<t.children.length;u++)t.children[u].updateTransform()}for(var r,o,s=1/0,a=1/0,h=-1/0,l=-1/0,p=!1,u=0;u<this.children.length;u++)this.children[u].visible&&(p=!0,s=s<(o=this.children[u].getBounds()).x?s:o.x,a=a<o.y?a:o.y,h=(r=o.width+o.x)<h?h:r,l=(o=o.height+o.y)<l?l:o);var d,c,y,_,m,g,f,x,v,w,z,b,S,C=this._bounds;if(p||(v=(C=new P.Rectangle).x,d=C.width+C.x,z=C.y,c=C.height+C.y,y=(S=this.worldTransform).a,_=S.b,g=S.c,m=S.d,s=(b=y*d+g*z+(f=S.tx))<(s=(w=y*v+g*z+f)<(s=(x=y*v+g*c+f)<(s=g=y*d+g*c+f)?x:s)?w:s)?b:s,a=(S=m*z+_*d+(f=S.ty))<(a=(z=m*z+_*v+f)<(a=(v=m*c+_*v+f)<(a=f=m*c+_*d+f)?v:a)?z:a)?S:a,h=(h=(h=(h=g)<x?x:h)<w?w:h)<b?b:h,l=(l=(l=(l=f)<v?v:l)<z?z:l)<S?S:l),C.x=s,C.y=a,C.width=h-s,C.height=l-a,e)for(t.worldTransform=n,u=0;u<t.children.length;u++)t.children[u].updateTransform();return i||(i=t.getBounds(),C.x-=i.x,C.y-=i.y),C},P.DisplayObjectContainer.prototype.getLocalBounds=function(){return this.getBounds(this)},P.DisplayObjectContainer.prototype.contains=function(t){return!!t&&(t===this||this.contains(t.parent))},P.DisplayObjectContainer.prototype._renderWebGL=function(t){var e;if(this.visible&&!(this.alpha<=0))if(this._cacheAsBitmap)this._renderCachedSprite(t);else if(this._mask||this._filters){for(this._filters&&(t.spriteBatch.flush(),t.filterManager.pushFilter(this._filterBlock)),this._mask&&(t.spriteBatch.stop(),t.maskManager.pushMask(this.mask,t),t.spriteBatch.start()),e=0;e<this.children.length;e++)this.children[e]._renderWebGL(t);t.spriteBatch.stop(),this._mask&&t.maskManager.popMask(this._mask,t),this._filters&&t.filterManager.popFilter(),t.spriteBatch.start()}else for(e=0;e<this.children.length;e++)this.children[e]._renderWebGL(t)},P.DisplayObjectContainer.prototype._renderCanvas=function(t){if(!1!==this.visible&&0!==this.alpha)if(this._cacheAsBitmap)this._renderCachedSprite(t);else{this._mask&&t.maskManager.pushMask(this._mask,t);for(var e=0;e<this.children.length;e++)this.children[e]._renderCanvas(t);this._mask&&t.maskManager.popMask(t)}},Object.defineProperty(P.DisplayObjectContainer.prototype,"width",{get:function(){return this.getLocalBounds().width*this.scale.x},set:function(t){var e=this.getLocalBounds().width;this.scale.x=0!==e?t/e:1,this._width=t}}),Object.defineProperty(P.DisplayObjectContainer.prototype,"height",{get:function(){return this.getLocalBounds().height*this.scale.y},set:function(t){var e=this.getLocalBounds().height;this.scale.y=0!==e?t/e:1,this._height=t}}),P.Sprite=function(t){P.DisplayObjectContainer.call(this),this.anchor=new P.Point,this.texture=t||P.Texture.emptyTexture,this._width=0,this._height=0,this.tint=16777215,this.cachedTint=-1,this.tintedTexture=null,this.blendMode=P.blendModes.NORMAL,this.shader=null,this.exists=!0,this.texture.baseTexture.hasLoaded&&this.onTextureUpdate(),this.renderable=!0},P.Sprite.prototype=Object.create(P.DisplayObjectContainer.prototype),P.Sprite.prototype.constructor=P.Sprite,Object.defineProperty(P.Sprite.prototype,"width",{get:function(){return this.scale.x*this.texture.frame.width},set:function(t){this.scale.x=t/this.texture.frame.width,this._width=t}}),Object.defineProperty(P.Sprite.prototype,"height",{get:function(){return this.scale.y*this.texture.frame.height},set:function(t){this.scale.y=t/this.texture.frame.height,this._height=t}}),P.Sprite.prototype.setTexture=function(t,e){void 0!==e&&this.texture.baseTexture.destroy(),this.texture.baseTexture.skipRender=!1,this.texture=t,this.texture.valid=!0,this.cachedTint=-1},P.Sprite.prototype.onTextureUpdate=function(){this._width&&(this.scale.x=this._width/this.texture.frame.width),this._height&&(this.scale.y=this._height/this.texture.frame.height)},P.Sprite.prototype.getBounds=function(t){var e,i=this.texture.frame.width,n=this.texture.frame.height,r=i*(1-this.anchor.x),o=i*-this.anchor.x,s=n*(1-this.anchor.y),a=n*-this.anchor.y,h=t||this.worldTransform,l=h.a,p=h.b,u=h.c,d=h.d,c=h.tx,y=h.ty,_=-1/0,m=-1/0,i=1/0,n=1/0,m=0===p&&0===u?(l<0&&(l*=-1,e=r,r=-o,o=-e),d<0&&(d*=-1,e=s,s=-a,a=-e),i=l*o+c,_=l*r+c,n=d*a+y,d*s+y):(i=(t=l*o+u*s+c)<(i=(h=l*r+u*s+c)<(i=(e=l*r+u*a+c)<(i=(c=l*o+u*a+c)<i?c:i)?e:i)?h:i)?t:i,n=(g=d*s+p*o+y)<(n=(s=d*s+p*r+y)<(n=(r=d*a+p*r+y)<(n=(y=d*a+p*o+y)<n?y:n)?r:n)?s:n)?g:n,_=(_=(_=(_=_<c?c:_)<e?e:_)<h?h:_)<t?t:_,(m=(m=(m=m<y?y:m)<r?r:m)<s?s:m)<g?g:m),g=this._bounds;return g.x=i,g.width=_-i,g.y=n,g.height=m-n,this._currentBounds=g},P.Sprite.prototype.getLocalBounds=function(){var t=this.worldTransform;this.worldTransform=P.identityMatrix;for(var e=0;e<this.children.length;e++)this.children[e].updateTransform();var i=this.getBounds();for(this.worldTransform=t,e=0;e<this.children.length;e++)this.children[e].updateTransform();return i},P.Sprite.prototype._renderWebGL=function(t,e){if(this.visible&&!(this.alpha<=0)&&this.renderable){var i=this.worldTransform;if(e&&(i=e),this._mask||this._filters){e=t.spriteBatch;this._filters&&(e.flush(),t.filterManager.pushFilter(this._filterBlock)),this._mask&&(e.stop(),t.maskManager.pushMask(this.mask,t),e.start()),e.render(this);for(var n=0;n<this.children.length;n++)this.children[n]._renderWebGL(t);e.stop(),this._mask&&t.maskManager.popMask(this._mask,t),this._filters&&t.filterManager.popFilter(),e.start()}else{t.spriteBatch.render(this);for(n=0;n<this.children.length;n++)this.children[n]._renderWebGL(t,i)}}},P.Sprite.prototype._renderCanvas=function(t,e){if(!(!this.visible||0===this.alpha||!this.renderable||this.texture.crop.width<=0||this.texture.crop.height<=0)){var i,n,r,o,s,a=this.worldTransform;e&&(a=e),this.blendMode!==t.currentBlendMode&&(t.currentBlendMode=this.blendMode,t.context.globalCompositeOperation=P.blendModesCanvas[t.currentBlendMode]),this._mask&&t.maskManager.pushMask(this._mask,t),this.texture.valid&&(i=this.texture.baseTexture.resolution/t.resolution,t.context.globalAlpha=this.worldAlpha,t.smoothProperty&&t.scaleMode!==this.texture.baseTexture.scaleMode&&(t.scaleMode=this.texture.baseTexture.scaleMode,t.context[t.smoothProperty]=t.scaleMode===P.scaleModes.LINEAR),n=this.texture.trim?this.texture.trim.x-this.anchor.x*this.texture.trim.width:this.anchor.x*-this.texture.frame.width,r=this.texture.trim?this.texture.trim.y-this.anchor.y*this.texture.trim.height:this.anchor.y*-this.texture.frame.height,o=a.tx*t.resolution+t.shakeX,s=a.ty*t.resolution+t.shakeY,t.roundPixels?(t.context.setTransform(a.a,a.b,a.c,a.d,0|o,0|s),n|=0,r|=0):t.context.setTransform(a.a,a.b,a.c,a.d,o,s),e=this.texture.crop.width,a=this.texture.crop.height,n/=i,r/=i,16777215!==this.tint?(!this.texture.requiresReTint&&this.cachedTint===this.tint||(this.tintedTexture=P.CanvasTinter.getTintedTexture(this,this.tint),this.cachedTint=this.tint,this.texture.requiresReTint=!1),t.context.drawImage(this.tintedTexture,0,0,e,a,n,r,e/i,a/i)):(o=this.texture.crop.x,s=this.texture.crop.y,t.context.drawImage(this.texture.baseTexture.source,o,s,e,a,n,r,e/i,a/i)));for(var h=0;h<this.children.length;h++)this.children[h]._renderCanvas(t);this._mask&&t.maskManager.popMask(t)}},P.SpriteBatch=function(t){P.DisplayObjectContainer.call(this),this.textureThing=t,this.ready=!1},P.SpriteBatch.prototype=Object.create(P.DisplayObjectContainer.prototype),P.SpriteBatch.prototype.constructor=P.SpriteBatch,P.SpriteBatch.prototype.initWebGL=function(t){this.fastSpriteBatch=new P.WebGLFastSpriteBatch(t),this.ready=!0},P.SpriteBatch.prototype.updateTransform=function(){this.displayObjectUpdateTransform()},P.SpriteBatch.prototype._renderWebGL=function(t){!this.visible||this.alpha<=0||!this.children.length||(this.ready||this.initWebGL(t.gl),this.fastSpriteBatch.gl!==t.gl&&this.fastSpriteBatch.setContext(t.gl),t.spriteBatch.stop(),t.shaderManager.setShader(t.shaderManager.fastShader),this.fastSpriteBatch.begin(this,t),this.fastSpriteBatch.render(this),t.spriteBatch.start())},P.SpriteBatch.prototype._renderCanvas=function(t){if(this.visible&&!(this.alpha<=0)&&this.children.length){var e=t.context;e.globalAlpha=this.worldAlpha,this.displayObjectUpdateTransform();for(var i=this.worldTransform,n=!0,r=0;r<this.children.length;r++){var o,s,a,h,l,p=this.children[r];p.visible&&(s=(o=p.texture).frame,e.globalAlpha=this.worldAlpha*p.alpha,p.rotation%(2*Math.PI)==0?(n&&(e.setTransform(i.a,i.b,i.c,i.d,i.tx,i.ty),n=!1),e.drawImage(o.baseTexture.source,s.x,s.y,s.width,s.height,p.anchor.x*(-s.width*p.scale.x)+p.position.x+.5+t.shakeX|0,p.anchor.y*(-s.height*p.scale.y)+p.position.y+.5+t.shakeY|0,s.width*p.scale.x,s.height*p.scale.y)):(n=n||!0,p.displayObjectUpdateTransform(),h=(a=p.worldTransform).tx*t.resolution+t.shakeX,l=a.ty*t.resolution+t.shakeY,t.roundPixels?e.setTransform(a.a,a.b,a.c,a.d,0|h,0|l):e.setTransform(a.a,a.b,a.c,a.d,h,l),e.drawImage(o.baseTexture.source,s.x,s.y,s.width,s.height,p.anchor.x*-s.width+.5|0,p.anchor.y*-s.height+.5|0,s.width,s.height)))}}},P.hex2rgb=function(t){return[(t>>16&255)/255,(t>>8&255)/255,(255&t)/255]},P.rgb2hex=function(t){return(255*t[0]<<16)+(255*t[1]<<8)+255*t[2]},P.canUseNewCanvasBlendModes=function(){if(void 0===document)return!1;var t="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAQAAAABAQMAAADD8p2OAAAAA1BMVEX/",e="AAAACklEQVQI12NgAAAAAgAB4iG8MwAAAABJRU5ErkJggg==",i=new Image;i.src=t+"AP804Oa6"+e;var n=new Image;n.src=t+"/wCKxvRF"+e;e=P.CanvasPool.create(this,6,1).getContext("2d");if(e.globalCompositeOperation="multiply",e.drawImage(i,0,0),e.drawImage(n,2,0),!e.getImageData(2,0,1,1))return!1;e=e.getImageData(2,0,1,1).data;return P.CanvasPool.remove(this),255===e[0]&&0===e[1]&&0===e[2]},P.getNextPowerOfTwo=function(t){if(0<t&&0==(t&t-1))return t;for(var e=1;e<t;)e<<=1;return e},P.isPowerOfTwo=function(t,e){return 0<t&&0==(t&t-1)&&0<e&&0==(e&e-1)},P.CanvasPool={create:function(t,e,i){var n,r=P.CanvasPool.getFirst(),r=-1===r?(n={parent:t,canvas:document.createElement("canvas")},P.CanvasPool.pool.push(n),n.canvas):(P.CanvasPool.pool[r].parent=t,P.CanvasPool.pool[r].canvas);return void 0!==e&&(r.width=e,r.height=i),r},getFirst:function(){for(var t=P.CanvasPool.pool,e=0;e<t.length;e++)if(!t[e].parent)return e;return-1},remove:function(t){for(var e=P.CanvasPool.pool,i=0;i<e.length;i++)e[i].parent===t&&(e[i].parent=null,e[i].canvas.width=1,e[i].canvas.height=1)},removeByCanvas:function(t){for(var e=P.CanvasPool.pool,i=0;i<e.length;i++)e[i].canvas===t&&(e[i].parent=null,e[i].canvas.width=1,e[i].canvas.height=1)},getTotal:function(){for(var t=P.CanvasPool.pool,e=0,i=0;i<t.length;i++)t[i].parent&&e++;return e},getFree:function(){for(var t=P.CanvasPool.pool,e=0,i=0;i<t.length;i++)t[i].parent||e++;return e}},P.CanvasPool.pool=[],P.initDefaultShaders=function(){},P.CompileVertexShader=function(t,e){return P._CompileShader(t,e,t.VERTEX_SHADER)},P.CompileFragmentShader=function(t,e){return P._CompileShader(t,e,t.FRAGMENT_SHADER)},P._CompileShader=function(t,e,i){var n=e;Array.isArray(e)&&(n=e.join("\n"));i=t.createShader(i);return t.shaderSource(i,n),t.compileShader(i),t.getShaderParameter(i,t.COMPILE_STATUS)?i:(window.console.log(t.getShaderInfoLog(i)),null)},P.compileProgram=function(t,e,i){var n=P.CompileFragmentShader(t,i),i=P.CompileVertexShader(t,e),e=t.createProgram();return t.attachShader(e,i),t.attachShader(e,n),t.linkProgram(e),t.getProgramParameter(e,t.LINK_STATUS)||(window.console.log(t.getProgramInfoLog(e)),window.console.log("Could not initialise shaders")),e},P.PixiShader=function(t){this._UID=P._UID++,this.gl=t,this.program=null,this.fragmentSrc=["precision lowp float;","varying vec2 vTextureCoord;","varying vec4 vColor;","uniform sampler2D uSampler;","void main(void) {","   gl_FragColor = texture2D(uSampler, vTextureCoord) * vColor ;","}"],this.textureCount=0,this.firstRun=!0,this.dirty=!0,this.attributes=[],this.init()},P.PixiShader.prototype.constructor=P.PixiShader,P.PixiShader.prototype.init=function(){var t,e=this.gl,i=P.compileProgram(e,this.vertexSrc||P.PixiShader.defaultVertexSrc,this.fragmentSrc);for(t in e.useProgram(i),this.uSampler=e.getUniformLocation(i,"uSampler"),this.projectionVector=e.getUniformLocation(i,"projectionVector"),this.offsetVector=e.getUniformLocation(i,"offsetVector"),this.dimensions=e.getUniformLocation(i,"dimensions"),this.aVertexPosition=e.getAttribLocation(i,"aVertexPosition"),this.aTextureCoord=e.getAttribLocation(i,"aTextureCoord"),this.colorAttribute=e.getAttribLocation(i,"aColor"),-1===this.colorAttribute&&(this.colorAttribute=2),this.attributes=[this.aVertexPosition,this.aTextureCoord,this.colorAttribute],this.uniforms)this.uniforms[t].uniformLocation=e.getUniformLocation(i,t);this.initUniforms(),this.program=i},P.PixiShader.prototype.initUniforms=function(){this.textureCount=1;var t,e=this.gl;for(t in this.uniforms){var i,n=(i=this.uniforms[t]).type;"sampler2D"===n?(i._init=!1,null!==i.value&&this.initSampler2D(i)):"mat2"===n||"mat3"===n||"mat4"===n?(i.glMatrix=!0,i.glValueLength=1,"mat2"===n?i.glFunc=e.uniformMatrix2fv:"mat3"===n?i.glFunc=e.uniformMatrix3fv:"mat4"===n&&(i.glFunc=e.uniformMatrix4fv)):(i.glFunc=e["uniform"+n],i.glValueLength="2f"===n||"2i"===n?2:"3f"===n||"3i"===n?3:"4f"===n||"4i"===n?4:1)}},P.PixiShader.prototype.initSampler2D=function(t){var e,i,n,r,o,s,a,h,l;t.value&&t.value.baseTexture&&t.value.baseTexture.hasLoaded&&((e=this.gl).activeTexture(e["TEXTURE"+this.textureCount]),e.bindTexture(e.TEXTURE_2D,t.value.baseTexture._glTextures[e.id]),t.textureData&&(i=(l=t.textureData).magFilter||e.LINEAR,n=l.minFilter||e.LINEAR,r=l.wrapS||e.CLAMP_TO_EDGE,o=l.wrapT||e.CLAMP_TO_EDGE,s=l.luminance?e.LUMINANCE:e.RGBA,l.repeat&&(r=e.REPEAT,o=e.REPEAT),e.pixelStorei(e.UNPACK_FLIP_Y_WEBGL,!!l.flipY),l.width?(a=l.width||512,h=l.height||2,l=l.border||0,e.texImage2D(e.TEXTURE_2D,0,s,a,h,l,s,e.UNSIGNED_BYTE,null)):e.texImage2D(e.TEXTURE_2D,0,s,e.RGBA,e.UNSIGNED_BYTE,t.value.baseTexture.source),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,i),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,n),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,r),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,o)),e.uniform1i(t.uniformLocation,this.textureCount),t._init=!0,this.textureCount++)},P.PixiShader.prototype.syncUniforms=function(){this.textureCount=1;var t,e,i=this.gl;for(e in this.uniforms)t=this.uniforms[e],1===t.glValueLength?!0===t.glMatrix?t.glFunc.call(i,t.uniformLocation,t.transpose,t.value):t.glFunc.call(i,t.uniformLocation,t.value):2===t.glValueLength?t.glFunc.call(i,t.uniformLocation,t.value.x,t.value.y):3===t.glValueLength?t.glFunc.call(i,t.uniformLocation,t.value.x,t.value.y,t.value.z):4===t.glValueLength?t.glFunc.call(i,t.uniformLocation,t.value.x,t.value.y,t.value.z,t.value.w):"sampler2D"===t.type&&(t._init?(i.activeTexture(i["TEXTURE"+this.textureCount]),t.value.baseTexture._dirty[i.id]?P.instances[i.id].updateTexture(t.value.baseTexture):i.bindTexture(i.TEXTURE_2D,t.value.baseTexture._glTextures[i.id]),i.uniform1i(t.uniformLocation,this.textureCount),this.textureCount++):this.initSampler2D(t))},P.PixiShader.prototype.destroy=function(){this.gl.deleteProgram(this.program),this.uniforms=null,this.gl=null,this.attributes=null},P.PixiShader.defaultVertexSrc=["attribute vec2 aVertexPosition;","attribute vec2 aTextureCoord;","attribute vec4 aColor;","uniform vec2 projectionVector;","uniform vec2 offsetVector;","varying vec2 vTextureCoord;","varying vec4 vColor;","const vec2 center = vec2(-1.0, 1.0);","void main(void) {","   gl_Position = vec4( ((aVertexPosition + offsetVector) / projectionVector) + center , 0.0, 1.0);","   vTextureCoord = aTextureCoord;","   vColor = vec4(aColor.rgb * aColor.a, aColor.a);","}"],P.PixiFastShader=function(t){this._UID=P._UID++,this.gl=t,this.program=null,this.fragmentSrc=["precision lowp float;","varying vec2 vTextureCoord;","varying float vColor;","uniform sampler2D uSampler;","void main(void) {","   gl_FragColor = texture2D(uSampler, vTextureCoord) * vColor ;","}"],this.vertexSrc=["attribute vec2 aVertexPosition;","attribute vec2 aPositionCoord;","attribute vec2 aScale;","attribute float aRotation;","attribute vec2 aTextureCoord;","attribute float aColor;","uniform vec2 projectionVector;","uniform vec2 offsetVector;","uniform mat3 uMatrix;","varying vec2 vTextureCoord;","varying float vColor;","const vec2 center = vec2(-1.0, 1.0);","void main(void) {","   vec2 v;","   vec2 sv = aVertexPosition * aScale;","   v.x = (sv.x) * cos(aRotation) - (sv.y) * sin(aRotation);","   v.y = (sv.x) * sin(aRotation) + (sv.y) * cos(aRotation);","   v = ( uMatrix * vec3(v + aPositionCoord , 1.0) ).xy ;","   gl_Position = vec4( ( v / projectionVector) + center , 0.0, 1.0);","   vTextureCoord = aTextureCoord;","   vColor = aColor;","}"],this.textureCount=0,this.init()},P.PixiFastShader.prototype.constructor=P.PixiFastShader,P.PixiFastShader.prototype.init=function(){var t=this.gl,e=P.compileProgram(t,this.vertexSrc,this.fragmentSrc);t.useProgram(e),this.uSampler=t.getUniformLocation(e,"uSampler"),this.projectionVector=t.getUniformLocation(e,"projectionVector"),this.offsetVector=t.getUniformLocation(e,"offsetVector"),this.dimensions=t.getUniformLocation(e,"dimensions"),this.uMatrix=t.getUniformLocation(e,"uMatrix"),this.aVertexPosition=t.getAttribLocation(e,"aVertexPosition"),this.aPositionCoord=t.getAttribLocation(e,"aPositionCoord"),this.aScale=t.getAttribLocation(e,"aScale"),this.aRotation=t.getAttribLocation(e,"aRotation"),this.aTextureCoord=t.getAttribLocation(e,"aTextureCoord"),this.colorAttribute=t.getAttribLocation(e,"aColor"),-1===this.colorAttribute&&(this.colorAttribute=2),this.attributes=[this.aVertexPosition,this.aPositionCoord,this.aScale,this.aRotation,this.aTextureCoord,this.colorAttribute],this.program=e},P.PixiFastShader.prototype.destroy=function(){this.gl.deleteProgram(this.program),this.uniforms=null,this.gl=null,this.attributes=null},P.StripShader=function(t){this._UID=P._UID++,this.gl=t,this.program=null,this.fragmentSrc=["precision mediump float;","varying vec2 vTextureCoord;","uniform float alpha;","uniform sampler2D uSampler;","void main(void) {","   gl_FragColor = texture2D(uSampler, vec2(vTextureCoord.x, vTextureCoord.y)) * alpha;","}"],this.vertexSrc=["attribute vec2 aVertexPosition;","attribute vec2 aTextureCoord;","uniform mat3 translationMatrix;","uniform vec2 projectionVector;","uniform vec2 offsetVector;","varying vec2 vTextureCoord;","void main(void) {","   vec3 v = translationMatrix * vec3(aVertexPosition , 1.0);","   v -= offsetVector.xyx;","   gl_Position = vec4( v.x / projectionVector.x -1.0, v.y / -projectionVector.y + 1.0 , 0.0, 1.0);","   vTextureCoord = aTextureCoord;","}"],this.init()},P.StripShader.prototype.constructor=P.StripShader,P.StripShader.prototype.init=function(){var t=this.gl,e=P.compileProgram(t,this.vertexSrc,this.fragmentSrc);t.useProgram(e),this.uSampler=t.getUniformLocation(e,"uSampler"),this.projectionVector=t.getUniformLocation(e,"projectionVector"),this.offsetVector=t.getUniformLocation(e,"offsetVector"),this.colorAttribute=t.getAttribLocation(e,"aColor"),this.aVertexPosition=t.getAttribLocation(e,"aVertexPosition"),this.aTextureCoord=t.getAttribLocation(e,"aTextureCoord"),this.attributes=[this.aVertexPosition,this.aTextureCoord],this.translationMatrix=t.getUniformLocation(e,"translationMatrix"),this.alpha=t.getUniformLocation(e,"alpha"),this.program=e},P.StripShader.prototype.destroy=function(){this.gl.deleteProgram(this.program),this.uniforms=null,this.gl=null,this.attribute=null},P.PrimitiveShader=function(t){this._UID=P._UID++,this.gl=t,this.program=null,this.fragmentSrc=["precision mediump float;","varying vec4 vColor;","void main(void) {","   gl_FragColor = vColor;","}"],this.vertexSrc=["attribute vec2 aVertexPosition;","attribute vec4 aColor;","uniform mat3 translationMatrix;","uniform vec2 projectionVector;","uniform vec2 offsetVector;","uniform float alpha;","uniform float flipY;","uniform vec3 tint;","varying vec4 vColor;","void main(void) {","   vec3 v = translationMatrix * vec3(aVertexPosition , 1.0);","   v -= offsetVector.xyx;","   gl_Position = vec4( v.x / projectionVector.x -1.0, (v.y / projectionVector.y * -flipY) + flipY , 0.0, 1.0);","   vColor = aColor * vec4(tint * alpha, alpha);","}"],this.init()},P.PrimitiveShader.prototype.constructor=P.PrimitiveShader,P.PrimitiveShader.prototype.init=function(){var t=this.gl,e=P.compileProgram(t,this.vertexSrc,this.fragmentSrc);t.useProgram(e),this.projectionVector=t.getUniformLocation(e,"projectionVector"),this.offsetVector=t.getUniformLocation(e,"offsetVector"),this.tintColor=t.getUniformLocation(e,"tint"),this.flipY=t.getUniformLocation(e,"flipY"),this.aVertexPosition=t.getAttribLocation(e,"aVertexPosition"),this.colorAttribute=t.getAttribLocation(e,"aColor"),this.attributes=[this.aVertexPosition,this.colorAttribute],this.translationMatrix=t.getUniformLocation(e,"translationMatrix"),this.alpha=t.getUniformLocation(e,"alpha"),this.program=e},P.PrimitiveShader.prototype.destroy=function(){this.gl.deleteProgram(this.program),this.uniforms=null,this.gl=null,this.attributes=null},P.ComplexPrimitiveShader=function(t){this._UID=P._UID++,this.gl=t,this.program=null,this.fragmentSrc=["precision mediump float;","varying vec4 vColor;","void main(void) {","   gl_FragColor = vColor;","}"],this.vertexSrc=["attribute vec2 aVertexPosition;","uniform mat3 translationMatrix;","uniform vec2 projectionVector;","uniform vec2 offsetVector;","uniform vec3 tint;","uniform float alpha;","uniform vec3 color;","uniform float flipY;","varying vec4 vColor;","void main(void) {","   vec3 v = translationMatrix * vec3(aVertexPosition , 1.0);","   v -= offsetVector.xyx;","   gl_Position = vec4( v.x / projectionVector.x -1.0, (v.y / projectionVector.y * -flipY) + flipY , 0.0, 1.0);","   vColor = vec4(color * alpha * tint, alpha);","}"],this.init()},P.ComplexPrimitiveShader.prototype.constructor=P.ComplexPrimitiveShader,P.ComplexPrimitiveShader.prototype.init=function(){var t=this.gl,e=P.compileProgram(t,this.vertexSrc,this.fragmentSrc);t.useProgram(e),this.projectionVector=t.getUniformLocation(e,"projectionVector"),this.offsetVector=t.getUniformLocation(e,"offsetVector"),this.tintColor=t.getUniformLocation(e,"tint"),this.color=t.getUniformLocation(e,"color"),this.flipY=t.getUniformLocation(e,"flipY"),this.aVertexPosition=t.getAttribLocation(e,"aVertexPosition"),this.attributes=[this.aVertexPosition,this.colorAttribute],this.translationMatrix=t.getUniformLocation(e,"translationMatrix"),this.alpha=t.getUniformLocation(e,"alpha"),this.program=e},P.ComplexPrimitiveShader.prototype.destroy=function(){this.gl.deleteProgram(this.program),this.uniforms=null,this.gl=null,this.attribute=null},P.glContexts=[],P.instances=[],P.WebGLRenderer=function(t){this.game=t,P.defaultRenderer||(P.defaultRenderer=this),this.type=P.WEBGL_RENDERER,this.resolution=t.resolution,this.transparent=t.transparent,this.autoResize=!1,this.preserveDrawingBuffer=t.preserveDrawingBuffer,this.clearBeforeRender=t.clearBeforeRender,this.width=t.width,this.height=t.height,this.view=t.canvas,this._contextOptions={alpha:this.transparent,antialias:t.antialias,premultipliedAlpha:this.transparent&&"notMultiplied"!==this.transparent,stencil:!0,preserveDrawingBuffer:this.preserveDrawingBuffer},this.projection=new P.Point,this.offset=new P.Point,this.shaderManager=new P.WebGLShaderManager,this.spriteBatch=new P.WebGLSpriteBatch,this.maskManager=new P.WebGLMaskManager,this.filterManager=new P.WebGLFilterManager,this.stencilManager=new P.WebGLStencilManager,this.blendModeManager=new P.WebGLBlendModeManager,this.renderSession={},this.renderSession.game=this.game,this.renderSession.gl=this.gl,this.renderSession.drawCount=0,this.renderSession.shaderManager=this.shaderManager,this.renderSession.maskManager=this.maskManager,this.renderSession.filterManager=this.filterManager,this.renderSession.blendModeManager=this.blendModeManager,this.renderSession.spriteBatch=this.spriteBatch,this.renderSession.stencilManager=this.stencilManager,(this.renderSession.renderer=this).renderSession.resolution=this.resolution,this.initContext(),this.mapBlendModes()},P.WebGLRenderer.prototype.constructor=P.WebGLRenderer,P.WebGLRenderer.prototype.initContext=function(){var t=this.view.getContext("webgl",this._contextOptions)||this.view.getContext("experimental-webgl",this._contextOptions);if(!(this.gl=t))throw new Error("This browser does not support webGL. Try using the canvas renderer");this.glContextId=t.id=P.WebGLRenderer.glContextId++,P.glContexts[this.glContextId]=t,P.instances[this.glContextId]=this,t.disable(t.DEPTH_TEST),t.disable(t.CULL_FACE),t.enable(t.BLEND),this.shaderManager.setContext(t),this.spriteBatch.setContext(t),this.maskManager.setContext(t),this.filterManager.setContext(t),this.blendModeManager.setContext(t),this.stencilManager.setContext(t),this.renderSession.gl=this.gl,this.resize(this.width,this.height)},P.WebGLRenderer.prototype.render=function(t){var e;this.contextLost||((e=this.gl).viewport(0,0,this.width,this.height),e.bindFramebuffer(e.FRAMEBUFFER,null),this.game.clearBeforeRender&&(e.clearColor(t._bgColor.r,t._bgColor.g,t._bgColor.b,t._bgColor.a),e.clear(e.COLOR_BUFFER_BIT)),this.offset.x=this.game.camera._shake.x,this.offset.y=this.game.camera._shake.y,this.renderDisplayObject(t,this.projection))},P.WebGLRenderer.prototype.renderDisplayObject=function(t,e,i,n){this.renderSession.blendModeManager.setBlendMode(P.blendModes.NORMAL),this.renderSession.drawCount=0,this.renderSession.flipY=i?-1:1,this.renderSession.projection=e,this.renderSession.offset=this.offset,this.spriteBatch.begin(this.renderSession),this.filterManager.begin(this.renderSession,i),t._renderWebGL(this.renderSession,n),this.spriteBatch.end()},P.WebGLRenderer.prototype.resize=function(t,e){this.width=t*this.resolution,this.height=e*this.resolution,this.view.width=this.width,this.view.height=this.height,this.autoResize&&(this.view.style.width=this.width/this.resolution+"px",this.view.style.height=this.height/this.resolution+"px"),this.gl.viewport(0,0,this.width,this.height),this.projection.x=this.width/2/this.resolution,this.projection.y=-this.height/2/this.resolution},P.WebGLRenderer.prototype.updateTexture=function(t){if(!t.hasLoaded)return!1;var e=this.gl;return t._glTextures[e.id]||(t._glTextures[e.id]=e.createTexture()),e.bindTexture(e.TEXTURE_2D,t._glTextures[e.id]),e.pixelStorei(e.UNPACK_PREMULTIPLY_ALPHA_WEBGL,t.premultipliedAlpha),e.texImage2D(e.TEXTURE_2D,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,t.source),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,t.scaleMode===P.scaleModes.LINEAR?e.LINEAR:e.NEAREST),t.mipmap&&P.isPowerOfTwo(t.width,t.height)?(e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,t.scaleMode===P.scaleModes.LINEAR?e.LINEAR_MIPMAP_LINEAR:e.NEAREST_MIPMAP_NEAREST),e.generateMipmap(e.TEXTURE_2D)):e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,t.scaleMode===P.scaleModes.LINEAR?e.LINEAR:e.NEAREST),t._powerOf2?(e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.REPEAT),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.REPEAT)):(e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE)),!(t._dirty[e.id]=!1)},P.WebGLRenderer.prototype.destroy=function(){P.glContexts[this.glContextId]=null,this.projection=null,this.offset=null,this.shaderManager.destroy(),this.spriteBatch.destroy(),this.maskManager.destroy(),this.filterManager.destroy(),this.shaderManager=null,this.spriteBatch=null,this.maskManager=null,this.filterManager=null,this.gl=null,this.renderSession=null,P.CanvasPool.remove(this),P.instances[this.glContextId]=null,P.WebGLRenderer.glContextId--},P.WebGLRenderer.prototype.mapBlendModes=function(){var t,e,i=this.gl;P.blendModesWebGL||((t=[])[(e=P.blendModes).NORMAL]=[i.ONE,i.ONE_MINUS_SRC_ALPHA],t[e.ADD]=[i.SRC_ALPHA,i.DST_ALPHA],t[e.MULTIPLY]=[i.DST_COLOR,i.ONE_MINUS_SRC_ALPHA],t[e.SCREEN]=[i.SRC_ALPHA,i.ONE],t[e.OVERLAY]=[i.ONE,i.ONE_MINUS_SRC_ALPHA],t[e.DARKEN]=[i.ONE,i.ONE_MINUS_SRC_ALPHA],t[e.LIGHTEN]=[i.ONE,i.ONE_MINUS_SRC_ALPHA],t[e.COLOR_DODGE]=[i.ONE,i.ONE_MINUS_SRC_ALPHA],t[e.COLOR_BURN]=[i.ONE,i.ONE_MINUS_SRC_ALPHA],t[e.HARD_LIGHT]=[i.ONE,i.ONE_MINUS_SRC_ALPHA],t[e.SOFT_LIGHT]=[i.ONE,i.ONE_MINUS_SRC_ALPHA],t[e.DIFFERENCE]=[i.ONE,i.ONE_MINUS_SRC_ALPHA],t[e.EXCLUSION]=[i.ONE,i.ONE_MINUS_SRC_ALPHA],t[e.HUE]=[i.ONE,i.ONE_MINUS_SRC_ALPHA],t[e.SATURATION]=[i.ONE,i.ONE_MINUS_SRC_ALPHA],t[e.COLOR]=[i.ONE,i.ONE_MINUS_SRC_ALPHA],t[e.LUMINOSITY]=[i.ONE,i.ONE_MINUS_SRC_ALPHA],P.blendModesWebGL=t)},P.WebGLRenderer.glContextId=0,P.WebGLBlendModeManager=function(){this.currentBlendMode=99999},P.WebGLBlendModeManager.prototype.constructor=P.WebGLBlendModeManager,P.WebGLBlendModeManager.prototype.setContext=function(t){this.gl=t},P.WebGLBlendModeManager.prototype.setBlendMode=function(t){if(this.currentBlendMode===t)return!1;this.currentBlendMode=t;t=P.blendModesWebGL[this.currentBlendMode];return t&&this.gl.blendFunc(t[0],t[1]),!0},P.WebGLBlendModeManager.prototype.destroy=function(){this.gl=null},P.WebGLMaskManager=function(){},P.WebGLMaskManager.prototype.constructor=P.WebGLMaskManager,P.WebGLMaskManager.prototype.setContext=function(t){this.gl=t},P.WebGLMaskManager.prototype.pushMask=function(t,e){var i=e.gl;t.dirty&&P.WebGLGraphics.updateGraphics(t,i),void 0!==t._webGL[i.id]&&void 0!==t._webGL[i.id].data&&0!==t._webGL[i.id].data.length&&e.stencilManager.pushStencil(t,t._webGL[i.id].data[0],e)},P.WebGLMaskManager.prototype.popMask=function(t,e){var i=this.gl;void 0!==t._webGL[i.id]&&void 0!==t._webGL[i.id].data&&0!==t._webGL[i.id].data.length&&e.stencilManager.popStencil(t,t._webGL[i.id].data[0],e)},P.WebGLMaskManager.prototype.destroy=function(){this.gl=null},P.WebGLStencilManager=function(){this.stencilStack=[],this.reverse=!0,this.count=0},P.WebGLStencilManager.prototype.setContext=function(t){this.gl=t},P.WebGLStencilManager.prototype.pushStencil=function(t,e,i){var n=this.gl;this.bindGraphics(t,e,i),0===this.stencilStack.length&&(n.enable(n.STENCIL_TEST),n.clear(n.STENCIL_BUFFER_BIT),this.reverse=!0,this.count=0),this.stencilStack.push(e);i=this.count;n.colorMask(!1,!1,!1,!1),n.stencilFunc(n.ALWAYS,0,255),n.stencilOp(n.KEEP,n.KEEP,n.INVERT),1===e.mode?(n.drawElements(n.TRIANGLE_FAN,e.indices.length-4,n.UNSIGNED_SHORT,0),this.reverse?(n.stencilFunc(n.EQUAL,255-i,255),n.stencilOp(n.KEEP,n.KEEP,n.DECR)):(n.stencilFunc(n.EQUAL,i,255),n.stencilOp(n.KEEP,n.KEEP,n.INCR)),n.drawElements(n.TRIANGLE_FAN,4,n.UNSIGNED_SHORT,2*(e.indices.length-4)),this.reverse?n.stencilFunc(n.EQUAL,255-(i+1),255):n.stencilFunc(n.EQUAL,i+1,255),this.reverse=!this.reverse):(this.reverse?(n.stencilFunc(n.EQUAL,i,255),n.stencilOp(n.KEEP,n.KEEP,n.INCR)):(n.stencilFunc(n.EQUAL,255-i,255),n.stencilOp(n.KEEP,n.KEEP,n.DECR)),n.drawElements(n.TRIANGLE_STRIP,e.indices.length,n.UNSIGNED_SHORT,0),this.reverse?n.stencilFunc(n.EQUAL,i+1,255):n.stencilFunc(n.EQUAL,255-(i+1),255)),n.colorMask(!0,!0,!0,!0),n.stencilOp(n.KEEP,n.KEEP,n.KEEP),this.count++},P.WebGLStencilManager.prototype.bindGraphics=function(t,e,i){this._currentGraphics=t;var n,r=this.gl,o=i.projection,s=i.offset;1===e.mode?(n=i.shaderManager.complexPrimitiveShader,i.shaderManager.setShader(n),r.uniform1f(n.flipY,i.flipY),r.uniformMatrix3fv(n.translationMatrix,!1,t.worldTransform.toArray(!0)),r.uniform2f(n.projectionVector,o.x,-o.y),r.uniform2f(n.offsetVector,-s.x,-s.y),r.uniform3fv(n.tintColor,P.hex2rgb(t.tint)),r.uniform3fv(n.color,e.color),r.uniform1f(n.alpha,t.worldAlpha*e.alpha),r.bindBuffer(r.ARRAY_BUFFER,e.buffer),r.vertexAttribPointer(n.aVertexPosition,2,r.FLOAT,!1,8,0)):(n=i.shaderManager.primitiveShader,i.shaderManager.setShader(n),r.uniformMatrix3fv(n.translationMatrix,!1,t.worldTransform.toArray(!0)),r.uniform1f(n.flipY,i.flipY),r.uniform2f(n.projectionVector,o.x,-o.y),r.uniform2f(n.offsetVector,-s.x,-s.y),r.uniform3fv(n.tintColor,P.hex2rgb(t.tint)),r.uniform1f(n.alpha,t.worldAlpha),r.bindBuffer(r.ARRAY_BUFFER,e.buffer),r.vertexAttribPointer(n.aVertexPosition,2,r.FLOAT,!1,24,0),r.vertexAttribPointer(n.colorAttribute,4,r.FLOAT,!1,24,8)),r.bindBuffer(r.ELEMENT_ARRAY_BUFFER,e.indexBuffer)},P.WebGLStencilManager.prototype.popStencil=function(t,e,i){var n,r=this.gl;this.stencilStack.pop(),this.count--,0===this.stencilStack.length?r.disable(r.STENCIL_TEST):(n=this.count,this.bindGraphics(t,e,i),r.colorMask(!1,!1,!1,!1),1===e.mode?(this.reverse=!this.reverse,this.reverse?(r.stencilFunc(r.EQUAL,255-(n+1),255),r.stencilOp(r.KEEP,r.KEEP,r.INCR)):(r.stencilFunc(r.EQUAL,n+1,255),r.stencilOp(r.KEEP,r.KEEP,r.DECR)),r.drawElements(r.TRIANGLE_FAN,4,r.UNSIGNED_SHORT,2*(e.indices.length-4)),r.stencilFunc(r.ALWAYS,0,255),r.stencilOp(r.KEEP,r.KEEP,r.INVERT),r.drawElements(r.TRIANGLE_FAN,e.indices.length-4,r.UNSIGNED_SHORT,0)):(this.reverse?(r.stencilFunc(r.EQUAL,n+1,255),r.stencilOp(r.KEEP,r.KEEP,r.DECR)):(r.stencilFunc(r.EQUAL,255-(n+1),255),r.stencilOp(r.KEEP,r.KEEP,r.INCR)),r.drawElements(r.TRIANGLE_STRIP,e.indices.length,r.UNSIGNED_SHORT,0)),this.reverse?r.stencilFunc(r.EQUAL,n,255):r.stencilFunc(r.EQUAL,255-n,255),r.colorMask(!0,!0,!0,!0),r.stencilOp(r.KEEP,r.KEEP,r.KEEP))},P.WebGLStencilManager.prototype.destroy=function(){this.stencilStack=null,this.gl=null},P.WebGLShaderManager=function(){this.maxAttibs=10,this.attribState=[],this.tempAttribState=[];for(var t=0;t<this.maxAttibs;t++)this.attribState[t]=!1;this.stack=[]},P.WebGLShaderManager.prototype.constructor=P.WebGLShaderManager,P.WebGLShaderManager.prototype.setContext=function(t){this.gl=t,this.primitiveShader=new P.PrimitiveShader(t),this.complexPrimitiveShader=new P.ComplexPrimitiveShader(t),this.defaultShader=new P.PixiShader(t),this.fastShader=new P.PixiFastShader(t),this.stripShader=new P.StripShader(t),this.setShader(this.defaultShader)},P.WebGLShaderManager.prototype.setAttribs=function(t){for(var e=0;e<this.tempAttribState.length;e++)this.tempAttribState[e]=!1;for(e=0;e<t.length;e++){var i=t[e];this.tempAttribState[i]=!0}var n=this.gl;for(e=0;e<this.attribState.length;e++)this.attribState[e]!==this.tempAttribState[e]&&(this.attribState[e]=this.tempAttribState[e],this.tempAttribState[e]?n.enableVertexAttribArray(e):n.disableVertexAttribArray(e))},P.WebGLShaderManager.prototype.setShader=function(t){return this._currentId!==t._UID&&(this._currentId=t._UID,this.currentShader=t,this.gl.useProgram(t.program),this.setAttribs(t.attributes),!0)},P.WebGLShaderManager.prototype.destroy=function(){this.attribState=null,this.tempAttribState=null,this.primitiveShader.destroy(),this.complexPrimitiveShader.destroy(),this.defaultShader.destroy(),this.fastShader.destroy(),this.stripShader.destroy(),this.gl=null},P.WebGLSpriteBatch=function(){this.vertSize=5,this.size=2e3;var t=4*this.size*4*this.vertSize,e=6*this.size;this.vertices=new P.ArrayBuffer(t),this.positions=new P.Float32Array(this.vertices),this.colors=new P.Uint32Array(this.vertices),this.indices=new P.Uint16Array(e);for(var i=this.lastIndexCount=0,n=0;i<e;i+=6,n+=4)this.indices[i+0]=n+0,this.indices[i+1]=n+1,this.indices[i+2]=n+2,this.indices[i+3]=n+0,this.indices[i+4]=n+2,this.indices[i+5]=n+3;this.drawing=!1,this.currentBatchSize=0,this.currentBaseTexture=null,this.dirty=!0,this.textures=[],this.blendModes=[],this.shaders=[],this.sprites=[],this.defaultShader=new P.AbstractFilter(["precision lowp float;","varying vec2 vTextureCoord;","varying vec4 vColor;","uniform sampler2D uSampler;","void main(void) {","   gl_FragColor = texture2D(uSampler, vTextureCoord) * vColor ;","}"])},P.WebGLSpriteBatch.prototype.setContext=function(t){this.gl=t,this.vertexBuffer=t.createBuffer(),this.indexBuffer=t.createBuffer(),t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,this.indexBuffer),t.bufferData(t.ELEMENT_ARRAY_BUFFER,this.indices,t.STATIC_DRAW),t.bindBuffer(t.ARRAY_BUFFER,this.vertexBuffer),t.bufferData(t.ARRAY_BUFFER,this.vertices,t.DYNAMIC_DRAW),this.currentBlendMode=99999;var e=new P.PixiShader(t);e.fragmentSrc=this.defaultShader.fragmentSrc,e.uniforms={},e.init(),this.defaultShader.shaders[t.id]=e},P.WebGLSpriteBatch.prototype.begin=function(t){this.renderSession=t,this.shader=this.renderSession.shaderManager.defaultShader,this.start()},P.WebGLSpriteBatch.prototype.end=function(){this.flush()},P.WebGLSpriteBatch.prototype.render=function(t,e){var i=t.texture,n=t.worldTransform;e&&(n=e),this.currentBatchSize>=this.size&&(this.flush(),this.currentBaseTexture=i.baseTexture);var r,o,s,a,h,l,p,u,d,c,y=i._uvs;y&&(u=t.anchor.x,d=t.anchor.y,i.trim?(o=(r=(p=i.trim).x-u*p.width)+i.crop.width,a=(s=p.y-d*p.height)+i.crop.height):(o=i.frame.width*(1-u),r=i.frame.width*-u,a=i.frame.height*(1-d),s=i.frame.height*-d),h=4*this.currentBatchSize*this.vertSize,c=i.baseTexture.resolution,l=n.a/c,e=n.b/c,p=n.c/c,u=n.d/c,d=n.tx,i=n.ty,c=this.colors,n=this.positions,this.renderSession.roundPixels?(n[h]=l*r+p*s+d|0,n[1+h]=u*s+e*r+i|0,n[5+h]=l*o+p*s+d|0,n[6+h]=u*s+e*o+i|0,n[10+h]=l*o+p*a+d|0,n[11+h]=u*a+e*o+i|0,n[15+h]=l*r+p*a+d|0,n[16+h]=u*a+e*r+i|0):(n[h]=l*r+p*s+d,n[1+h]=u*s+e*r+i,n[5+h]=l*o+p*s+d,n[6+h]=u*s+e*o+i,n[10+h]=l*o+p*a+d,n[11+h]=u*a+e*o+i,n[15+h]=l*r+p*a+d,n[16+h]=u*a+e*r+i),n[2+h]=y.x0,n[3+h]=y.y0,n[7+h]=y.x1,n[8+h]=y.y1,n[12+h]=y.x2,n[13+h]=y.y2,n[17+h]=y.x3,n[18+h]=y.y3,y=t.tint,c[4+h]=c[9+h]=c[14+h]=c[19+h]=(y>>16)+(65280&y)+((255&y)<<16)+(255*t.worldAlpha<<24),this.sprites[this.currentBatchSize++]=t)},P.WebGLSpriteBatch.prototype.renderTilingSprite=function(t){var e=t.tilingTexture;this.currentBatchSize>=this.size&&(this.flush(),this.currentBaseTexture=e.baseTexture),t._uvs||(t._uvs=new P.TextureUvs);var i=t._uvs,n=e.baseTexture.width,r=e.baseTexture.height;t.tilePosition.x%=n*t.tileScaleOffset.x,t.tilePosition.y%=r*t.tileScaleOffset.y;var o=t.tilePosition.x/(n*t.tileScaleOffset.x),s=t.tilePosition.y/(r*t.tileScaleOffset.y),a=t.width/n/(t.tileScale.x*t.tileScaleOffset.x),h=t.height/r/(t.tileScale.y*t.tileScaleOffset.y);i.x0=0-o,i.y0=0-s,i.x1=a-o,i.y1=0-s,i.x2=a-o,i.y2=h-s,i.x3=0-o,i.y3=h-s;var l=t.tint,p=(l>>16)+(65280&l)+((255&l)<<16)+(255*t.worldAlpha<<24),u=this.positions,d=this.colors,c=t.width,y=t.height,_=t.anchor.x,n=t.anchor.y,r=c*(1-_),a=c*-_,o=y*(1-n),h=y*-n,s=4*this.currentBatchSize*this.vertSize,l=e.baseTexture.resolution,c=t.worldTransform,_=c.a/l,y=c.b/l,n=c.c/l,e=c.d/l,l=c.tx,c=c.ty;u[s++]=_*a+n*h+l,u[s++]=e*h+y*a+c,u[s++]=i.x0,u[s++]=i.y0,d[s++]=p,u[s++]=_*r+n*h+l,u[s++]=e*h+y*r+c,u[s++]=i.x1,u[s++]=i.y1,d[s++]=p,u[s++]=_*r+n*o+l,u[s++]=e*o+y*r+c,u[s++]=i.x2,u[s++]=i.y2,d[s++]=p,u[s++]=_*a+n*o+l,u[s++]=e*o+y*a+c,u[s++]=i.x3,u[s++]=i.y3,d[+s]=p,this.sprites[this.currentBatchSize++]=t},P.WebGLSpriteBatch.prototype.flush=function(){if(0!==this.currentBatchSize){var t,e,i=this.gl;this.dirty&&(this.dirty=!1,i.activeTexture(i.TEXTURE0),i.bindBuffer(i.ARRAY_BUFFER,this.vertexBuffer),i.bindBuffer(i.ELEMENT_ARRAY_BUFFER,this.indexBuffer),t=this.defaultShader.shaders[i.id],e=4*this.vertSize,i.vertexAttribPointer(t.aVertexPosition,2,i.FLOAT,!1,e,0),i.vertexAttribPointer(t.aTextureCoord,2,i.FLOAT,!1,e,8),i.vertexAttribPointer(t.colorAttribute,4,i.UNSIGNED_BYTE,!0,e,16)),this.currentBatchSize>.5*this.size?i.bufferSubData(i.ARRAY_BUFFER,0,this.vertices):(e=this.positions.subarray(0,4*this.currentBatchSize*this.vertSize),i.bufferSubData(i.ARRAY_BUFFER,0,e));for(var n=0,r=0,o=null,s=this.renderSession.blendModeManager.currentBlendMode,a=null,h=0,l=this.currentBatchSize;h<l;h++){var p,u,d,c=((p=this.sprites[h]).tilingTexture||p.texture).baseTexture,y=s!==(u=p.blendMode),_=a!==(d=p.shader||this.defaultShader),m=c.skipRender;m&&0<p.children.length&&(m=!1),(o!==c&&!m||y||_)&&(this.renderBatch(o,n,r),r=h,n=0,o=c,y&&this.renderSession.blendModeManager.setBlendMode(s=u),_)&&((t=(a=d).shaders[i.id])||((t=new P.PixiShader(i)).fragmentSrc=a.fragmentSrc,t.uniforms=a.uniforms,t.init(),a.shaders[i.id]=t),this.renderSession.shaderManager.setShader(t),t.dirty&&t.syncUniforms(),d=this.renderSession.projection,i.uniform2f(t.projectionVector,d.x,d.y),d=this.renderSession.offset,i.uniform2f(t.offsetVector,d.x,d.y)),n++}this.renderBatch(o,n,r),this.currentBatchSize=0}},P.WebGLSpriteBatch.prototype.renderBatch=function(t,e,i){if(0!==e){var n=this.gl;if(t._dirty[n.id]){if(!this.renderSession.renderer.updateTexture(t))return}else n.bindTexture(n.TEXTURE_2D,t._glTextures[n.id]);n.drawElements(n.TRIANGLES,6*e,n.UNSIGNED_SHORT,6*i*2),this.renderSession.drawCount++}},P.WebGLSpriteBatch.prototype.stop=function(){this.flush(),this.dirty=!0},P.WebGLSpriteBatch.prototype.start=function(){this.dirty=!0},P.WebGLSpriteBatch.prototype.destroy=function(){this.vertices=null,this.indices=null,this.gl.deleteBuffer(this.vertexBuffer),this.gl.deleteBuffer(this.indexBuffer),this.currentBaseTexture=null,this.gl=null},P.WebGLFastSpriteBatch=function(t){this.vertSize=10,this.maxSize=6e3,this.size=this.maxSize;var e=4*this.size*this.vertSize,i=6*this.maxSize;this.vertices=new P.Float32Array(e),this.indices=new P.Uint16Array(i),this.vertexBuffer=null,this.indexBuffer=null;for(var n=this.lastIndexCount=0,r=0;n<i;n+=6,r+=4)this.indices[n+0]=r+0,this.indices[n+1]=r+1,this.indices[n+2]=r+2,this.indices[n+3]=r+0,this.indices[n+4]=r+2,this.indices[n+5]=r+3;this.drawing=!1,this.currentBatchSize=0,this.currentBaseTexture=null,this.currentBlendMode=0,this.renderSession=null,this.shader=null,this.matrix=null,this.setContext(t)},P.WebGLFastSpriteBatch.prototype.constructor=P.WebGLFastSpriteBatch,P.WebGLFastSpriteBatch.prototype.setContext=function(t){this.gl=t,this.vertexBuffer=t.createBuffer(),this.indexBuffer=t.createBuffer(),t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,this.indexBuffer),t.bufferData(t.ELEMENT_ARRAY_BUFFER,this.indices,t.STATIC_DRAW),t.bindBuffer(t.ARRAY_BUFFER,this.vertexBuffer),t.bufferData(t.ARRAY_BUFFER,this.vertices,t.DYNAMIC_DRAW)},P.WebGLFastSpriteBatch.prototype.begin=function(t,e){this.renderSession=e,this.shader=this.renderSession.shaderManager.fastShader,this.matrix=t.worldTransform.toArray(!0),this.start()},P.WebGLFastSpriteBatch.prototype.end=function(){this.flush()},P.WebGLFastSpriteBatch.prototype.render=function(t){var e=t.children,t=e[0];if(t.texture._uvs){this.currentBaseTexture=t.texture.baseTexture,t.blendMode!==this.renderSession.blendModeManager.currentBlendMode&&(this.flush(),this.renderSession.blendModeManager.setBlendMode(t.blendMode));for(var i=0,n=e.length;i<n;i++)this.renderSprite(e[i]);this.flush()}},P.WebGLFastSpriteBatch.prototype.renderSprite=function(t){var e,i,n,r,o,s,a;t.visible&&(t.texture.baseTexture===this.currentBaseTexture||t.texture.baseTexture.skipRender||(this.flush(),this.currentBaseTexture=t.texture.baseTexture,t.texture._uvs))&&(e=this.vertices,a=t.texture._uvs,t.texture.frame.width,t.texture.frame.height,t.texture.trim?(r=(n=(i=t.texture.trim).x-t.anchor.x*i.width)+t.texture.crop.width,s=(o=i.y-t.anchor.y*i.height)+t.texture.crop.height):(r=t.texture.frame.width*(1-t.anchor.x),n=t.texture.frame.width*-t.anchor.x,s=t.texture.frame.height*(1-t.anchor.y),o=t.texture.frame.height*-t.anchor.y),i=4*this.currentBatchSize*this.vertSize,e[i++]=n,e[i++]=o,e[i++]=t.position.x,e[i++]=t.position.y,e[i++]=t.scale.x,e[i++]=t.scale.y,e[i++]=t.rotation,e[i++]=a.x0,e[i++]=a.y1,e[i++]=t.alpha,e[i++]=r,e[i++]=o,e[i++]=t.position.x,e[i++]=t.position.y,e[i++]=t.scale.x,e[i++]=t.scale.y,e[i++]=t.rotation,e[i++]=a.x1,e[i++]=a.y1,e[i++]=t.alpha,e[i++]=r,e[i++]=s,e[i++]=t.position.x,e[i++]=t.position.y,e[i++]=t.scale.x,e[i++]=t.scale.y,e[i++]=t.rotation,e[i++]=a.x2,e[i++]=a.y2,e[i++]=t.alpha,e[i++]=n,e[i++]=s,e[i++]=t.position.x,e[i++]=t.position.y,e[i++]=t.scale.x,e[i++]=t.scale.y,e[i++]=t.rotation,e[i++]=a.x3,e[i++]=a.y3,e[+i]=t.alpha,this.currentBatchSize++,this.currentBatchSize>=this.size&&this.flush())},P.WebGLFastSpriteBatch.prototype.flush=function(){var t,e;0!==this.currentBatchSize&&(t=this.gl,this.currentBaseTexture._glTextures[t.id]||this.renderSession.renderer.updateTexture(this.currentBaseTexture,t),t.bindTexture(t.TEXTURE_2D,this.currentBaseTexture._glTextures[t.id]),this.currentBatchSize>.5*this.size?t.bufferSubData(t.ARRAY_BUFFER,0,this.vertices):(e=this.vertices.subarray(0,4*this.currentBatchSize*this.vertSize),t.bufferSubData(t.ARRAY_BUFFER,0,e)),t.drawElements(t.TRIANGLES,6*this.currentBatchSize,t.UNSIGNED_SHORT,0),this.currentBatchSize=0,this.renderSession.drawCount++)},P.WebGLFastSpriteBatch.prototype.stop=function(){this.flush()},P.WebGLFastSpriteBatch.prototype.start=function(){var t=this.gl;t.activeTexture(t.TEXTURE0),t.bindBuffer(t.ARRAY_BUFFER,this.vertexBuffer),t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,this.indexBuffer);var e=this.renderSession.projection;t.uniform2f(this.shader.projectionVector,e.x,e.y),t.uniformMatrix3fv(this.shader.uMatrix,!1,this.matrix);e=4*this.vertSize;t.vertexAttribPointer(this.shader.aVertexPosition,2,t.FLOAT,!1,e,0),t.vertexAttribPointer(this.shader.aPositionCoord,2,t.FLOAT,!1,e,8),t.vertexAttribPointer(this.shader.aScale,2,t.FLOAT,!1,e,16),t.vertexAttribPointer(this.shader.aRotation,1,t.FLOAT,!1,e,24),t.vertexAttribPointer(this.shader.aTextureCoord,2,t.FLOAT,!1,e,28),t.vertexAttribPointer(this.shader.colorAttribute,1,t.FLOAT,!1,e,36)},P.WebGLFilterManager=function(){this.filterStack=[],this.offsetX=0,this.offsetY=0},P.WebGLFilterManager.prototype.constructor=P.WebGLFilterManager,P.WebGLFilterManager.prototype.setContext=function(t){this.gl=t,this.texturePool=[],this.initShaderBuffers()},P.WebGLFilterManager.prototype.begin=function(t,e){this.renderSession=t,this.defaultShader=t.shaderManager.defaultShader;t=this.renderSession.projection;this.width=2*t.x,this.height=2*-t.y,this.buffer=e},P.WebGLFilterManager.prototype.pushFilter=function(t){var e=this.gl,i=this.renderSession.projection,n=this.renderSession.offset;t._filterArea=t.target.filterArea||t.target.getBounds(),t._previous_stencil_mgr=this.renderSession.stencilManager,this.renderSession.stencilManager=new P.WebGLStencilManager,this.renderSession.stencilManager.setContext(e),e.disable(e.STENCIL_TEST),this.filterStack.push(t);var r=t.filterPasses[0];this.offsetX+=t._filterArea.x,this.offsetY+=t._filterArea.y;var o=this.texturePool.pop();o?o.resize(this.width*this.renderSession.resolution,this.height*this.renderSession.resolution):o=new P.FilterTexture(this.gl,this.width*this.renderSession.resolution,this.height*this.renderSession.resolution),e.bindTexture(e.TEXTURE_2D,o.texture);var s=t._filterArea,r=r.padding;s.x-=r,s.y-=r,s.width+=2*r,s.height+=2*r,s.x<0&&(s.x=0),s.width>this.width&&(s.width=this.width),s.y<0&&(s.y=0),s.height>this.height&&(s.height=this.height),e.bindFramebuffer(e.FRAMEBUFFER,o.frameBuffer),e.viewport(0,0,s.width*this.renderSession.resolution,s.height*this.renderSession.resolution),i.x=s.width/2,i.y=-s.height/2,n.x=-s.x,n.y=-s.y,e.colorMask(!0,!0,!0,!0),e.clearColor(0,0,0,0),e.clear(e.COLOR_BUFFER_BIT),t._glFilterTexture=o},P.WebGLFilterManager.prototype.popFilter=function(){var t=this.gl,e=this.filterStack.pop(),i=e._filterArea,n=e._glFilterTexture,r=this.renderSession.projection,o=this.renderSession.offset;if(1<e.filterPasses.length){t.viewport(0,0,i.width*this.renderSession.resolution,i.height*this.renderSession.resolution),t.bindBuffer(t.ARRAY_BUFFER,this.vertexBuffer),this.vertexArray[0]=0,this.vertexArray[1]=i.height,this.vertexArray[2]=i.width,this.vertexArray[3]=i.height,this.vertexArray[4]=0,this.vertexArray[5]=0,this.vertexArray[6]=i.width,this.vertexArray[7]=0,t.bufferSubData(t.ARRAY_BUFFER,0,this.vertexArray),t.bindBuffer(t.ARRAY_BUFFER,this.uvBuffer),this.uvArray[2]=i.width/this.width,this.uvArray[5]=i.height/this.height,this.uvArray[6]=i.width/this.width,this.uvArray[7]=i.height/this.height,t.bufferSubData(t.ARRAY_BUFFER,0,this.uvArray);var s=n;(l=(l=this.texturePool.pop())||new P.FilterTexture(this.gl,this.width*this.renderSession.resolution,this.height*this.renderSession.resolution)).resize(this.width*this.renderSession.resolution,this.height*this.renderSession.resolution),t.bindFramebuffer(t.FRAMEBUFFER,l.frameBuffer),t.clear(t.COLOR_BUFFER_BIT),t.disable(t.BLEND);for(var a=0;a<e.filterPasses.length-1;a++){var h=e.filterPasses[a];t.bindFramebuffer(t.FRAMEBUFFER,l.frameBuffer),t.activeTexture(t.TEXTURE0),t.bindTexture(t.TEXTURE_2D,s.texture),this.applyFilterPass(h,i,i.width,i.height);var h=s,s=l,l=h}t.enable(t.BLEND),n=s,this.texturePool.push(l)}var p=e.filterPasses[e.filterPasses.length-1];this.offsetX-=i.x,this.offsetY-=i.y;var u,d=this.width,c=this.height,y=0,_=0,m=this.buffer;0===this.filterStack.length?t.colorMask(!0,!0,!0,!0):(d=(i=(u=this.filterStack[this.filterStack.length-1])._filterArea).width,c=i.height,y=i.x,_=i.y,m=u._glFilterTexture.frameBuffer),r.x=d/2,r.y=-c/2,o.x=y,o.y=_;y=(i=e._filterArea).x-y,_=i.y-_;t.bindBuffer(t.ARRAY_BUFFER,this.vertexBuffer),this.vertexArray[0]=y,this.vertexArray[1]=_+i.height,this.vertexArray[2]=y+i.width,this.vertexArray[3]=_+i.height,this.vertexArray[4]=y,this.vertexArray[5]=_,this.vertexArray[6]=y+i.width,this.vertexArray[7]=_,t.bufferSubData(t.ARRAY_BUFFER,0,this.vertexArray),t.bindBuffer(t.ARRAY_BUFFER,this.uvBuffer),this.uvArray[2]=i.width/this.width,this.uvArray[5]=i.height/this.height,this.uvArray[6]=i.width/this.width,this.uvArray[7]=i.height/this.height,t.bufferSubData(t.ARRAY_BUFFER,0,this.uvArray),t.viewport(0,0,d*this.renderSession.resolution,c*this.renderSession.resolution),t.bindFramebuffer(t.FRAMEBUFFER,m),t.activeTexture(t.TEXTURE0),t.bindTexture(t.TEXTURE_2D,n.texture),this.renderSession.stencilManager&&this.renderSession.stencilManager.destroy(),this.renderSession.stencilManager=e._previous_stencil_mgr,e._previous_stencil_mgr=null,0<this.renderSession.stencilManager.count?t.enable(t.STENCIL_TEST):t.disable(t.STENCIL_TEST),this.applyFilterPass(p,i,d,c),this.texturePool.push(n),e._glFilterTexture=null},P.WebGLFilterManager.prototype.applyFilterPass=function(t,e,i,n){var r=this.gl,o=t.shaders[r.id];o||((o=new P.PixiShader(r)).fragmentSrc=t.fragmentSrc,o.uniforms=t.uniforms,o.init(),t.shaders[r.id]=o),this.renderSession.shaderManager.setShader(o),r.uniform2f(o.projectionVector,i/2,-n/2),r.uniform2f(o.offsetVector,0,0),t.uniforms.dimensions&&(t.uniforms.dimensions.value[0]=this.width,t.uniforms.dimensions.value[1]=this.height,t.uniforms.dimensions.value[2]=this.vertexArray[0],t.uniforms.dimensions.value[3]=this.vertexArray[5]),o.syncUniforms(),r.bindBuffer(r.ARRAY_BUFFER,this.vertexBuffer),r.vertexAttribPointer(o.aVertexPosition,2,r.FLOAT,!1,0,0),r.bindBuffer(r.ARRAY_BUFFER,this.uvBuffer),r.vertexAttribPointer(o.aTextureCoord,2,r.FLOAT,!1,0,0),r.bindBuffer(r.ARRAY_BUFFER,this.colorBuffer),r.vertexAttribPointer(o.colorAttribute,2,r.FLOAT,!1,0,0),r.bindBuffer(r.ELEMENT_ARRAY_BUFFER,this.indexBuffer),r.drawElements(r.TRIANGLES,6,r.UNSIGNED_SHORT,0),this.renderSession.drawCount++},P.WebGLFilterManager.prototype.initShaderBuffers=function(){var t=this.gl;this.vertexBuffer=t.createBuffer(),this.uvBuffer=t.createBuffer(),this.colorBuffer=t.createBuffer(),this.indexBuffer=t.createBuffer(),this.vertexArray=new P.Float32Array([0,0,1,0,0,1,1,1]),t.bindBuffer(t.ARRAY_BUFFER,this.vertexBuffer),t.bufferData(t.ARRAY_BUFFER,this.vertexArray,t.STATIC_DRAW),this.uvArray=new P.Float32Array([0,0,1,0,0,1,1,1]),t.bindBuffer(t.ARRAY_BUFFER,this.uvBuffer),t.bufferData(t.ARRAY_BUFFER,this.uvArray,t.STATIC_DRAW),this.colorArray=new P.Float32Array([1,16777215,1,16777215,1,16777215,1,16777215]),t.bindBuffer(t.ARRAY_BUFFER,this.colorBuffer),t.bufferData(t.ARRAY_BUFFER,this.colorArray,t.STATIC_DRAW),t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,this.indexBuffer),t.bufferData(t.ELEMENT_ARRAY_BUFFER,new Uint16Array([0,1,2,1,3,2]),t.STATIC_DRAW)},P.WebGLFilterManager.prototype.destroy=function(){var t=this.gl;this.filterStack=null,this.offsetX=0;for(var e=this.offsetY=0;e<this.texturePool.length;e++)this.texturePool[e].destroy();this.texturePool=null,t.deleteBuffer(this.vertexBuffer),t.deleteBuffer(this.uvBuffer),t.deleteBuffer(this.colorBuffer),t.deleteBuffer(this.indexBuffer)},P.FilterTexture=function(t,e,i,n){this.gl=t,this.frameBuffer=t.createFramebuffer(),this.texture=t.createTexture(),n=n||P.scaleModes.DEFAULT,t.bindTexture(t.TEXTURE_2D,this.texture),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,n===P.scaleModes.LINEAR?t.LINEAR:t.NEAREST),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,n===P.scaleModes.LINEAR?t.LINEAR:t.NEAREST),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE),t.bindFramebuffer(t.FRAMEBUFFER,this.frameBuffer),t.bindFramebuffer(t.FRAMEBUFFER,this.frameBuffer),t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,this.texture,0),this.renderBuffer=t.createRenderbuffer(),t.bindRenderbuffer(t.RENDERBUFFER,this.renderBuffer),t.framebufferRenderbuffer(t.FRAMEBUFFER,t.DEPTH_STENCIL_ATTACHMENT,t.RENDERBUFFER,this.renderBuffer),this.resize(e,i)},P.FilterTexture.prototype.constructor=P.FilterTexture,P.FilterTexture.prototype.clear=function(){var t=this.gl;t.clearColor(0,0,0,0),t.clear(t.COLOR_BUFFER_BIT)},P.FilterTexture.prototype.resize=function(t,e){var i;this.width===t&&this.height===e||(this.width=t,this.height=e,(i=this.gl).bindTexture(i.TEXTURE_2D,this.texture),i.texImage2D(i.TEXTURE_2D,0,i.RGBA,t,e,0,i.RGBA,i.UNSIGNED_BYTE,null),i.bindRenderbuffer(i.RENDERBUFFER,this.renderBuffer),i.renderbufferStorage(i.RENDERBUFFER,i.DEPTH_STENCIL,t,e))},P.FilterTexture.prototype.destroy=function(){var t=this.gl;t.deleteFramebuffer(this.frameBuffer),t.deleteTexture(this.texture),this.frameBuffer=null,this.texture=null},P.CanvasBuffer=function(t,e){this.width=t,this.height=e,this.canvas=P.CanvasPool.create(this,this.width,this.height),this.context=this.canvas.getContext("2d"),this.canvas.width=t,this.canvas.height=e},P.CanvasBuffer.prototype.constructor=P.CanvasBuffer,P.CanvasBuffer.prototype.clear=function(){this.context.setTransform(1,0,0,1,0,0),this.context.clearRect(0,0,this.width,this.height)},P.CanvasBuffer.prototype.resize=function(t,e){this.width=this.canvas.width=t,this.height=this.canvas.height=e},P.CanvasBuffer.prototype.destroy=function(){P.CanvasPool.remove(this)},P.CanvasMaskManager=function(){},P.CanvasMaskManager.prototype.constructor=P.CanvasMaskManager,P.CanvasMaskManager.prototype.pushMask=function(t,e){var i=e.context;i.save();var n=t.alpha,r=t.worldTransform,e=e.resolution;i.setTransform(r.a*e,r.b*e,r.c*e,r.d*e,r.tx*e,r.ty*e),P.CanvasGraphics.renderGraphicsMask(t,i),i.clip(),t.worldAlpha=n},P.CanvasMaskManager.prototype.popMask=function(t){t.context.restore()},P.CanvasTinter=function(){},P.CanvasTinter.getTintedTexture=function(t,e){var i=t.tintedTexture||P.CanvasPool.create(this);return P.CanvasTinter.tintMethod(t.texture,e,i),i},P.CanvasTinter.tintWithMultiply=function(t,e,i){var n=i.getContext("2d"),r=t.crop;i.width===r.width&&i.height===r.height||(i.width=r.width,i.height=r.height),n.clearRect(0,0,r.width,r.height),n.fillStyle="#"+("00000"+(0|e).toString(16)).substr(-6),n.fillRect(0,0,r.width,r.height),n.globalCompositeOperation="multiply",n.drawImage(t.baseTexture.source,r.x,r.y,r.width,r.height,0,0,r.width,r.height),n.globalCompositeOperation="destination-atop",n.drawImage(t.baseTexture.source,r.x,r.y,r.width,r.height,0,0,r.width,r.height)},P.CanvasTinter.tintWithPerPixel=function(t,e,i){var n=i.getContext("2d"),r=t.crop;i.width=r.width,i.height=r.height,n.globalCompositeOperation="copy",n.drawImage(t.baseTexture.source,r.x,r.y,r.width,r.height,0,0,r.width,r.height);for(var o,e=P.hex2rgb(e),s=e[0],a=e[1],h=e[2],r=n.getImageData(0,0,r.width,r.height),l=r.data,p=0;p<l.length;p+=4)l[p+0]*=s,l[p+1]*=a,l[p+2]*=h,P.CanvasTinter.canHandleAlpha||(o=l[p+3],l[p+0]/=255/o,l[p+1]/=255/o,l[p+2]/=255/o);n.putImageData(r,0,0)},P.CanvasTinter.checkInverseAlpha=function(){var t=new P.CanvasBuffer(2,1);t.context.fillStyle="rgba(10, 20, 30, 0.5)",t.context.fillRect(0,0,1,1);var e=t.context.getImageData(0,0,1,1);if(null===e)return!1;t.context.putImageData(e,1,0);t=t.context.getImageData(1,0,1,1);return t.data[0]===e.data[0]&&t.data[1]===e.data[1]&&t.data[2]===e.data[2]&&t.data[3]===e.data[3]},P.CanvasTinter.canHandleAlpha=P.CanvasTinter.checkInverseAlpha(),P.CanvasTinter.canUseMultiply=P.canUseNewCanvasBlendModes(),P.CanvasTinter.tintMethod=P.CanvasTinter.canUseMultiply?P.CanvasTinter.tintWithMultiply:P.CanvasTinter.tintWithPerPixel,P.CanvasRenderer=function(t){this.game=t,P.defaultRenderer||(P.defaultRenderer=this),this.type=P.CANVAS_RENDERER,this.resolution=t.resolution,this.clearBeforeRender=t.clearBeforeRender,this.transparent=t.transparent,this.autoResize=!1,this.width=t.width*this.resolution,this.height=t.height*this.resolution,this.view=t.canvas,this.context=this.view.getContext("2d",{alpha:this.transparent}),this.refresh=!0,this.count=0,this.maskManager=new P.CanvasMaskManager,this.renderSession={context:this.context,maskManager:this.maskManager,scaleMode:null,smoothProperty:Phaser.Canvas.getSmoothingPrefix(this.context),roundPixels:!1},this.mapBlendModes(),this.resize(this.width,this.height)},P.CanvasRenderer.prototype.constructor=P.CanvasRenderer,P.CanvasRenderer.prototype.render=function(t){this.context.setTransform(1,0,0,1,0,0),this.context.globalAlpha=1,this.renderSession.currentBlendMode=0,this.renderSession.shakeX=this.game.camera._shake.x,this.renderSession.shakeY=this.game.camera._shake.y,this.context.globalCompositeOperation="source-over",navigator.isCocoonJS&&this.view.screencanvas&&(this.context.fillStyle="black",this.context.clear()),this.clearBeforeRender&&(this.transparent?this.context.clearRect(0,0,this.width,this.height):t._bgColor&&(this.context.fillStyle=t._bgColor.rgba,this.context.fillRect(0,0,this.width,this.height))),this.renderDisplayObject(t)},P.CanvasRenderer.prototype.destroy=function(t){(t=void 0===t?!0:t)&&this.view.parent&&this.view.parent.removeChild(this.view),this.view=null,this.context=null,this.maskManager=null,this.renderSession=null},P.CanvasRenderer.prototype.resize=function(t,e){this.width=t*this.resolution,this.height=e*this.resolution,this.view.width=this.width,this.view.height=this.height,this.autoResize&&(this.view.style.width=this.width/this.resolution+"px",this.view.style.height=this.height/this.resolution+"px"),this.renderSession.smoothProperty&&(this.context[this.renderSession.smoothProperty]=this.renderSession.scaleMode===P.scaleModes.LINEAR)},P.CanvasRenderer.prototype.renderDisplayObject=function(t,e,i){this.renderSession.context=e||this.context,this.renderSession.resolution=this.resolution,t._renderCanvas(this.renderSession,i)},P.CanvasRenderer.prototype.mapBlendModes=function(){var t,e,i;P.blendModesCanvas||(t=[],e=P.blendModes,i=P.canUseNewCanvasBlendModes(),t[e.NORMAL]="source-over",t[e.ADD]="lighter",t[e.MULTIPLY]=i?"multiply":"source-over",t[e.SCREEN]=i?"screen":"source-over",t[e.OVERLAY]=i?"overlay":"source-over",t[e.DARKEN]=i?"darken":"source-over",t[e.LIGHTEN]=i?"lighten":"source-over",t[e.COLOR_DODGE]=i?"color-dodge":"source-over",t[e.COLOR_BURN]=i?"color-burn":"source-over",t[e.HARD_LIGHT]=i?"hard-light":"source-over",t[e.SOFT_LIGHT]=i?"soft-light":"source-over",t[e.DIFFERENCE]=i?"difference":"source-over",t[e.EXCLUSION]=i?"exclusion":"source-over",t[e.HUE]=i?"hue":"source-over",t[e.SATURATION]=i?"saturation":"source-over",t[e.COLOR]=i?"color":"source-over",t[e.LUMINOSITY]=i?"luminosity":"source-over",P.blendModesCanvas=t)},P.BaseTexture=function(t,e){this.resolution=1,this.width=100,this.height=100,this.scaleMode=e||P.scaleModes.DEFAULT,this.hasLoaded=!1,this.source=t,this.premultipliedAlpha=!0,this._glTextures=[],this.mipmap=!1,this._dirty=[!0,!0,!0,!0],t&&((this.source.complete||this.source.getContext)&&this.source.width&&this.source.height&&(this.hasLoaded=!0,this.width=this.source.naturalWidth||this.source.width,this.height=this.source.naturalHeight||this.source.height,this.dirty()),this.skipRender=!1,this._powerOf2=!1)},P.BaseTexture.prototype.constructor=P.BaseTexture,P.BaseTexture.prototype.forceLoaded=function(t,e){this.hasLoaded=!0,this.width=t,this.height=e,this.dirty()},P.BaseTexture.prototype.destroy=function(){this.source&&P.CanvasPool.removeByCanvas(this.source),this.source=null,this.unloadFromGPU()},P.BaseTexture.prototype.updateSourceImage=function(t){},P.BaseTexture.prototype.dirty=function(){for(var t=0;t<this._glTextures.length;t++)this._dirty[t]=!0},P.BaseTexture.prototype.unloadFromGPU=function(){this.dirty();for(var t=this._glTextures.length-1;0<=t;t--){var e=this._glTextures[t],i=P.glContexts[t];i&&e&&i.deleteTexture(e)}this._glTextures.length=0,this.dirty()},P.BaseTexture.fromCanvas=function(t,e){return 0===t.width&&(t.width=1),0===t.height&&(t.height=1),new P.BaseTexture(t,e)},P.TextureSilentFail=!1,P.Texture=function(t,e,i,n){this.noFrame=!1,e||(this.noFrame=!0,e=new P.Rectangle(0,0,1,1)),t instanceof P.Texture&&(t=t.baseTexture),this.baseTexture=t,this.frame=e,this.trim=n,this.valid=!1,this.isTiling=!1,this.requiresUpdate=!1,this.requiresReTint=!1,this._uvs=null,this.width=0,this.height=0,this.crop=i||new P.Rectangle(0,0,1,1),t.hasLoaded&&(this.noFrame&&(e=new P.Rectangle(0,0,t.width,t.height)),this.setFrame(e))},P.Texture.prototype.constructor=P.Texture,P.Texture.prototype.onBaseTextureLoaded=function(){var t=this.baseTexture;this.noFrame&&(this.frame=new P.Rectangle(0,0,t.width,t.height)),this.setFrame(this.frame)},P.Texture.prototype.destroy=function(t){t&&this.baseTexture.destroy(),this.valid=!1},P.Texture.prototype.setFrame=function(t){if(this.noFrame=!1,this.frame=t,this.width=t.width,this.height=t.height,this.crop.x=t.x,this.crop.y=t.y,this.crop.width=t.width,this.crop.height=t.height,this.trim||!(t.x+t.width>this.baseTexture.width||t.y+t.height>this.baseTexture.height))this.valid=t&&t.width&&t.height&&this.baseTexture.source&&this.baseTexture.hasLoaded,this.trim&&(this.width=this.trim.width,this.height=this.trim.height,this.frame.width=this.trim.width,this.frame.height=this.trim.height),this.valid&&this._updateUvs();else{if(!P.TextureSilentFail)throw new Error("Texture Error: frame does not fit inside the base Texture dimensions "+this);this.valid=!1}},P.Texture.prototype._updateUvs=function(){this._uvs||(this._uvs=new P.TextureUvs);var t=this.crop,e=this.baseTexture.width,i=this.baseTexture.height;this._uvs.x0=t.x/e,this._uvs.y0=t.y/i,this._uvs.x1=(t.x+t.width)/e,this._uvs.y1=t.y/i,this._uvs.x2=(t.x+t.width)/e,this._uvs.y2=(t.y+t.height)/i,this._uvs.x3=t.x/e,this._uvs.y3=(t.y+t.height)/i},P.Texture.fromCanvas=function(t,e){e=P.BaseTexture.fromCanvas(t,e);return new P.Texture(e)},P.TextureUvs=function(){this.x0=0,this.y0=0,this.x1=0,this.y1=0,this.x2=0,this.y2=0,this.x3=0,this.y3=0},P.RenderTexture=function(t,e,i,n,r){this.width=t||100,this.height=e||100,this.resolution=r||1,this.frame=new P.Rectangle(0,0,this.width*this.resolution,this.height*this.resolution),this.crop=new P.Rectangle(0,0,this.width*this.resolution,this.height*this.resolution),this.baseTexture=new P.BaseTexture,this.baseTexture.width=this.width*this.resolution,this.baseTexture.height=this.height*this.resolution,this.baseTexture._glTextures=[],this.baseTexture.resolution=this.resolution,this.baseTexture.scaleMode=n||P.scaleModes.DEFAULT,this.baseTexture.hasLoaded=!0,P.Texture.call(this,this.baseTexture,new P.Rectangle(0,0,this.width*this.resolution,this.height*this.resolution)),this.renderer=i||P.defaultRenderer,this.renderer.type===P.WEBGL_RENDERER?(i=this.renderer.gl,this.baseTexture._dirty[i.id]=!1,this.textureBuffer=new P.FilterTexture(i,this.width,this.height,this.baseTexture.scaleMode),this.baseTexture._glTextures[i.id]=this.textureBuffer.texture,this.render=this.renderWebGL,this.projection=new P.Point(.5*this.width,.5*-this.height)):(this.render=this.renderCanvas,this.textureBuffer=new P.CanvasBuffer(this.width*this.resolution,this.height*this.resolution),this.baseTexture.source=this.textureBuffer.canvas),this.valid=!0,this.tempMatrix=new Phaser.Matrix,this._updateUvs()},P.RenderTexture.prototype=Object.create(P.Texture.prototype),P.RenderTexture.prototype.constructor=P.RenderTexture,P.RenderTexture.prototype.resize=function(t,e,i){t===this.width&&e===this.height||(this.valid=0<t&&0<e,this.width=t,this.height=e,this.frame.width=this.crop.width=t*this.resolution,this.frame.height=this.crop.height=e*this.resolution,i&&(this.baseTexture.width=this.width*this.resolution,this.baseTexture.height=this.height*this.resolution),this.renderer.type===P.WEBGL_RENDERER&&(this.projection.x=this.width/2,this.projection.y=-this.height/2),this.valid&&this.textureBuffer.resize(this.width,this.height))},P.RenderTexture.prototype.clear=function(){this.valid&&(this.renderer.type===P.WEBGL_RENDERER&&this.renderer.gl.bindFramebuffer(this.renderer.gl.FRAMEBUFFER,this.textureBuffer.frameBuffer),this.textureBuffer.clear())},P.RenderTexture.prototype.renderWebGL=function(t,e,i){if(this.valid&&0!==t.alpha){var n=t.worldTransform;n.identity(),n.translate(0,2*this.projection.y),e&&n.append(e),n.scale(1,-1);for(var r=0;r<t.children.length;r++)t.children[r].updateTransform();n=this.renderer.gl;n.viewport(0,0,this.width*this.resolution,this.height*this.resolution),n.bindFramebuffer(n.FRAMEBUFFER,this.textureBuffer.frameBuffer),i&&this.textureBuffer.clear(),this.renderer.spriteBatch.dirty=!0,this.renderer.renderDisplayObject(t,this.projection,this.textureBuffer.frameBuffer,e),this.renderer.spriteBatch.dirty=!0}},P.RenderTexture.prototype.renderCanvas=function(t,e,i){if(this.valid&&0!==t.alpha){var n=t.worldTransform;n.identity(),e&&n.append(e);for(var r=0;r<t.children.length;r++)t.children[r].updateTransform();i&&this.textureBuffer.clear();i=this.renderer.resolution;this.renderer.resolution=this.resolution,this.renderer.renderDisplayObject(t,this.textureBuffer.context,e),this.renderer.resolution=i}},P.RenderTexture.prototype.getImage=function(){var t=new Image;return t.src=this.getBase64(),t},P.RenderTexture.prototype.getBase64=function(){return this.getCanvas().toDataURL()},P.RenderTexture.prototype.getCanvas=function(){if(this.renderer.type!==P.WEBGL_RENDERER)return this.textureBuffer.canvas;var t=this.renderer.gl,e=this.textureBuffer.width,i=this.textureBuffer.height,n=new Uint8Array(4*e*i);t.bindFramebuffer(t.FRAMEBUFFER,this.textureBuffer.frameBuffer),t.readPixels(0,0,e,i,t.RGBA,t.UNSIGNED_BYTE,n),t.bindFramebuffer(t.FRAMEBUFFER,null);t=new P.CanvasBuffer(e,i),i=t.context.getImageData(0,0,e,i);return i.data.set(n),t.context.putImageData(i,0,0),t.canvas},P.AbstractFilter=function(t,e){this.passes=[this],this.shaders=[],this.dirty=!0,this.padding=0,this.uniforms=e||{},this.fragmentSrc=t||[]},P.AbstractFilter.prototype.constructor=P.AbstractFilter,P.AbstractFilter.prototype.syncUniforms=function(){for(var t=0,e=this.shaders.length;t<e;t++)this.shaders[t].dirty=!0},P.Strip=function(t){P.DisplayObjectContainer.call(this),this.texture=t,this.uvs=new P.Float32Array([0,1,1,1,1,0,0,1]),this.vertices=new P.Float32Array([0,0,100,0,100,100,0,100]),this.colors=new P.Float32Array([1,1,1,1]),this.indices=new P.Uint16Array([0,1,2,3]),this.dirty=!0,this.blendMode=P.blendModes.NORMAL,this.canvasPadding=0,this.drawMode=P.Strip.DrawModes.TRIANGLE_STRIP},P.Strip.prototype=Object.create(P.DisplayObjectContainer.prototype),P.Strip.prototype.constructor=P.Strip,P.Strip.prototype._renderWebGL=function(t){!this.visible||this.alpha<=0||(t.spriteBatch.stop(),this._vertexBuffer||this._initWebGL(t),t.shaderManager.setShader(t.shaderManager.stripShader),this._renderStrip(t),t.spriteBatch.start())},P.Strip.prototype._initWebGL=function(t){t=t.gl;this._vertexBuffer=t.createBuffer(),this._indexBuffer=t.createBuffer(),this._uvBuffer=t.createBuffer(),this._colorBuffer=t.createBuffer(),t.bindBuffer(t.ARRAY_BUFFER,this._vertexBuffer),t.bufferData(t.ARRAY_BUFFER,this.vertices,t.DYNAMIC_DRAW),t.bindBuffer(t.ARRAY_BUFFER,this._uvBuffer),t.bufferData(t.ARRAY_BUFFER,this.uvs,t.STATIC_DRAW),t.bindBuffer(t.ARRAY_BUFFER,this._colorBuffer),t.bufferData(t.ARRAY_BUFFER,this.colors,t.STATIC_DRAW),t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,this._indexBuffer),t.bufferData(t.ELEMENT_ARRAY_BUFFER,this.indices,t.STATIC_DRAW)},P.Strip.prototype._renderStrip=function(t){var e=t.gl,i=t.projection,n=t.offset,r=t.shaderManager.stripShader,o=this.drawMode===P.Strip.DrawModes.TRIANGLE_STRIP?e.TRIANGLE_STRIP:e.TRIANGLES;t.blendModeManager.setBlendMode(this.blendMode),e.uniformMatrix3fv(r.translationMatrix,!1,this.worldTransform.toArray(!0)),e.uniform2f(r.projectionVector,i.x,-i.y),e.uniform2f(r.offsetVector,-n.x,-n.y),e.uniform1f(r.alpha,this.worldAlpha),this.dirty?(this.dirty=!1,e.bindBuffer(e.ARRAY_BUFFER,this._vertexBuffer),e.bufferData(e.ARRAY_BUFFER,this.vertices,e.STATIC_DRAW),e.vertexAttribPointer(r.aVertexPosition,2,e.FLOAT,!1,0,0),e.bindBuffer(e.ARRAY_BUFFER,this._uvBuffer),e.bufferData(e.ARRAY_BUFFER,this.uvs,e.STATIC_DRAW),e.vertexAttribPointer(r.aTextureCoord,2,e.FLOAT,!1,0,0),e.activeTexture(e.TEXTURE0),this.texture.baseTexture._dirty[e.id]?t.renderer.updateTexture(this.texture.baseTexture):e.bindTexture(e.TEXTURE_2D,this.texture.baseTexture._glTextures[e.id]),e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,this._indexBuffer),e.bufferData(e.ELEMENT_ARRAY_BUFFER,this.indices,e.STATIC_DRAW)):(e.bindBuffer(e.ARRAY_BUFFER,this._vertexBuffer),e.bufferSubData(e.ARRAY_BUFFER,0,this.vertices),e.vertexAttribPointer(r.aVertexPosition,2,e.FLOAT,!1,0,0),e.bindBuffer(e.ARRAY_BUFFER,this._uvBuffer),e.vertexAttribPointer(r.aTextureCoord,2,e.FLOAT,!1,0,0),e.activeTexture(e.TEXTURE0),this.texture.baseTexture._dirty[e.id]?t.renderer.updateTexture(this.texture.baseTexture):e.bindTexture(e.TEXTURE_2D,this.texture.baseTexture._glTextures[e.id]),e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,this._indexBuffer)),e.drawElements(o,this.indices.length,e.UNSIGNED_SHORT,0)},P.Strip.prototype._renderCanvas=function(t){var e=t.context,i=this.worldTransform,n=i.tx*t.resolution+t.shakeX,r=i.ty*t.resolution+t.shakeY;t.roundPixels?e.setTransform(i.a,i.b,i.c,i.d,0|n,0|r):e.setTransform(i.a,i.b,i.c,i.d,n,r),this.drawMode===P.Strip.DrawModes.TRIANGLE_STRIP?this._renderCanvasTriangleStrip(e):this._renderCanvasTriangles(e)},P.Strip.prototype._renderCanvasTriangleStrip=function(t){var e=this.vertices,i=this.uvs,n=e.length/2;this.count++;for(var r=0;r<n-2;r++){var o=2*r;this._renderCanvasDrawTriangle(t,e,i,o,2+o,4+o)}},P.Strip.prototype._renderCanvasTriangles=function(t){var e=this.vertices,i=this.uvs,n=this.indices,r=n.length;this.count++;for(var o=0;o<r;o+=3){var s=2*n[o],a=2*n[o+1],h=2*n[o+2];this._renderCanvasDrawTriangle(t,e,i,s,a,h)}},P.Strip.prototype._renderCanvasDrawTriangle=function(t,e,i,n,r,o){var s=this.texture.baseTexture.source,a=this.texture.width,h=this.texture.height,l=e[n],p=e[r],u=e[o],d=e[n+1],c=e[r+1],y=e[o+1],_=i[n]*a,m=i[r]*a,g=i[o]*a,f=i[n+1]*h,x=i[r+1]*h,e=i[o+1]*h;0<this.canvasPadding&&(a=this.canvasPadding/this.worldTransform.a,v=this.canvasPadding/this.worldTransform.d,r=d-(n=(d+c+y)/3),l=(i=(l+p+u)/3)+(o=l-i)/(h=Math.sqrt(o*o+r*r))*(h+a),d=n+r/h*(h+v),r=c-n,p=i+(o=p-i)/(h=Math.sqrt(o*o+r*r))*(h+a),c=n+r/h*(h+v),r=y-n,u=i+(o=u-i)/(h=Math.sqrt(o*o+r*r))*(h+a),y=n+r/h*(h+v)),t.save(),t.beginPath(),t.moveTo(l,d),t.lineTo(p,c),t.lineTo(u,y),t.closePath(),t.clip();var v=_*x+f*g+m*e-x*g-f*m-_*e;t.transform((l*x+f*u+p*e-x*u-f*p-l*e)/v,(d*x+f*y+c*e-x*y-f*c-d*e)/v,(_*p+l*g+m*u-p*g-l*m-_*u)/v,(_*c+d*g+m*y-c*g-d*m-_*y)/v,(_*x*u+f*p*g+l*m*e-l*x*g-f*m*u-_*p*e)/v,(_*x*y+f*c*g+d*m*e-d*x*g-f*m*y-_*c*e)/v),t.drawImage(s,0,0),t.restore()},P.Strip.prototype.renderStripFlat=function(t){var e=this.context,i=t.vertices,n=i.length/2;this.count++,e.beginPath();for(var r=1;r<n-2;r++){var o=2*r,s=i[o],a=i[2+o],h=i[4+o],l=i[1+o],p=i[3+o],o=i[5+o];e.moveTo(s,l),e.lineTo(a,p),e.lineTo(h,o)}e.fillStyle="#FF0000",e.fill(),e.closePath()},P.Strip.prototype.onTextureUpdate=function(){this.updateFrame=!0},P.Strip.prototype.getBounds=function(t){for(var t=t||this.worldTransform,e=t.a,i=t.b,n=t.c,r=t.d,o=t.tx,s=t.ty,a=-1/0,h=-1/0,l=1/0,p=1/0,u=this.vertices,d=0,c=u.length;d<c;d+=2)var y=u[d],_=u[d+1],m=e*y+n*_+o,y=r*_+i*y+s,l=m<l?m:l,p=y<p?y:p,a=a<m?m:a,h=h<y?y:h;if(l===-1/0||h===1/0)return P.EmptyRectangle;t=this._bounds;return t.x=l,t.width=a-l,t.y=p,t.height=h-p,this._currentBounds=t},P.Strip.DrawModes={TRIANGLE_STRIP:0,TRIANGLES:1},P.Rope=function(t,e){P.Strip.call(this,t),this.points=e,this.vertices=new P.Float32Array(4*e.length),this.uvs=new P.Float32Array(4*e.length),this.colors=new P.Float32Array(2*e.length),this.indices=new P.Uint16Array(2*e.length),this.refresh()},P.Rope.prototype=Object.create(P.Strip.prototype),P.Rope.prototype.constructor=P.Rope,P.Rope.prototype.refresh=function(){var t=this.points;if(!(t.length<1)){var e=this.uvs,i=(t[0],this.indices),n=this.colors;this.count-=.2,e[0]=0,e[1]=0,e[2]=0,e[3]=1,n[0]=1,n[1]=1,i[0]=0,i[1]=1;for(var r,o,s=t.length,a=1;a<s;a++)t[a],e[r=4*a]=o=a/(s-1),e[1+r]=0,e[2+r]=o,e[3+r]=1,n[r=2*a]=1,n[1+r]=1,i[r=2*a]=r,i[1+r]=1+r}},P.Rope.prototype.updateTransform=function(){var t=this.points;if(!(t.length<1)){var e=t[0],i={x:0,y:0};this.count-=.2;for(var n,r,o,s,a=this.vertices,h=t.length,l=0;l<h;l++)n=t[l],r=4*l,s=l<t.length-1?t[l+1]:n,i.y=-(s.x-e.x),i.x=s.y-e.y,o=Math.sqrt(i.x*i.x+i.y*i.y),s=this.texture.height/2,i.x/=o,i.y/=o,i.x*=s,i.y*=s,a[r]=n.x+i.x,a[1+r]=n.y+i.y,a[2+r]=n.x-i.x,a[3+r]=n.y-i.y,e=n;P.DisplayObjectContainer.prototype.updateTransform.call(this)}},P.Rope.prototype.setTexture=function(t){this.texture=t},P.TilingSprite=function(t,e,i){P.Sprite.call(this,t),this._width=e||128,this._height=i||128,this.tileScale=new P.Point(1,1),this.tileScaleOffset=new P.Point(1,1),this.tilePosition=new P.Point,this.renderable=!0,this.tint=16777215,this.textureDebug=!1,this.blendMode=P.blendModes.NORMAL,this.canvasBuffer=null,this.tilingTexture=null,this.tilePattern=null,this.refreshTexture=!0,this.frameWidth=0,this.frameHeight=0},P.TilingSprite.prototype=Object.create(P.Sprite.prototype),P.TilingSprite.prototype.constructor=P.TilingSprite,P.TilingSprite.prototype.setTexture=function(t){this.texture!==t&&(this.texture=t,this.refreshTexture=!0,this.cachedTint=16777215)},P.TilingSprite.prototype._renderWebGL=function(t){if(this.visible&&this.renderable&&0!==this.alpha){if(this._mask&&(t.spriteBatch.stop(),t.maskManager.pushMask(this.mask,t),t.spriteBatch.start()),this._filters&&(t.spriteBatch.flush(),t.filterManager.pushFilter(this._filterBlock)),this.refreshTexture){if(this.generateTilingTexture(!0,t),!this.tilingTexture)return;this.tilingTexture.needsUpdate&&(t.renderer.updateTexture(this.tilingTexture.baseTexture),this.tilingTexture.needsUpdate=!1)}t.spriteBatch.renderTilingSprite(this);for(var e=0;e<this.children.length;e++)this.children[e]._renderWebGL(t);t.spriteBatch.stop(),this._filters&&t.filterManager.popFilter(),this._mask&&t.maskManager.popMask(this._mask,t),t.spriteBatch.start()}},P.TilingSprite.prototype._renderCanvas=function(t){if(this.visible&&this.renderable&&0!==this.alpha){var e=t.context;this._mask&&t.maskManager.pushMask(this._mask,t),e.globalAlpha=this.worldAlpha;var i=this.worldTransform,n=t.resolution,r=i.tx*n+t.shakeX,o=i.ty*n+t.shakeY;if(e.setTransform(i.a*n,i.b*n,i.c*n,i.d*n,r,o),this.refreshTexture){if(this.generateTilingTexture(!1,t),!this.tilingTexture)return;this.tilePattern=e.createPattern(this.tilingTexture.baseTexture.source,"repeat")}var s=t.currentBlendMode;this.blendMode!==t.currentBlendMode&&(t.currentBlendMode=this.blendMode,e.globalCompositeOperation=P.blendModesCanvas[t.currentBlendMode]);var a=this.tilePosition,h=this.tileScale;a.x%=this.tilingTexture.baseTexture.width,a.y%=this.tilingTexture.baseTexture.height,e.scale(h.x,h.y),e.translate(a.x+this.anchor.x*-this._width,a.y+this.anchor.y*-this._height),e.fillStyle=this.tilePattern;r=-a.x,o=-a.y,i=this._width/h.x,n=this._height/h.y;t.roundPixels&&(r|=0,o|=0,i|=0,n|=0),e.fillRect(r,o,i,n),e.scale(1/h.x,1/h.y),e.translate(-a.x+this.anchor.x*this._width,-a.y+this.anchor.y*this._height),this._mask&&t.maskManager.popMask(t);for(var l=0;l<this.children.length;l++)this.children[l]._renderCanvas(t);s!==this.blendMode&&(t.currentBlendMode=s,e.globalCompositeOperation=P.blendModesCanvas[s])}},P.TilingSprite.prototype.onTextureUpdate=function(){},P.TilingSprite.prototype.generateTilingTexture=function(t,e){var i,n,r,o,s,a,h;this.texture.baseTexture.hasLoaded&&(n=(i=this.texture).frame,r=this._frame.sourceSizeW||this._frame.width,o=this._frame.sourceSizeH||this._frame.height,a=s=0,this._frame.trimmed&&(s=this._frame.spriteSourceSizeX,a=this._frame.spriteSourceSizeY),t&&(r=P.getNextPowerOfTwo(r),o=P.getNextPowerOfTwo(o)),this.canvasBuffer?(this.canvasBuffer.resize(r,o),this.tilingTexture.baseTexture.width=r,this.tilingTexture.baseTexture.height=o):(this.canvasBuffer=new P.CanvasBuffer(r,o),this.tilingTexture=P.Texture.fromCanvas(this.canvasBuffer.canvas),this.tilingTexture.isTiling=!0),this.tilingTexture.needsUpdate=!0,this.textureDebug&&(this.canvasBuffer.context.strokeStyle="#00ff00",this.canvasBuffer.context.strokeRect(0,0,r,o)),h=i.crop.width,t=i.crop.height,h===r&&t===o||(h=r,t=o),this.canvasBuffer.context.drawImage(i.baseTexture.source,i.crop.x,i.crop.y,i.crop.width,i.crop.height,s,a,h,t),this.tileScaleOffset.x=n.width/r,this.tileScaleOffset.y=n.height/o,this.refreshTexture=!1,this.tilingTexture.baseTexture._powerOf2=!0)},P.TilingSprite.prototype.getBounds=function(){var t=this._width,e=this._height,i=t*(1-this.anchor.x),n=t*-this.anchor.x,r=e*(1-this.anchor.y),o=e*-this.anchor.y,s=this.worldTransform,a=s.a,h=s.b,l=s.c,p=s.d,u=s.tx,d=s.ty,c=a*n+l*o+u,t=p*o+h*n+d,e=a*i+l*o+u,s=p*o+h*i+d,o=a*i+l*r+u,i=p*r+h*i+d,u=a*n+l*r+u,r=p*r+h*n+d,h=c<(h=1/0)?c:h,n=r<(n=i<(n=s<(n=t<(n=1/0)?t:n)?s:n)?i:n)?r:n,d=(d=(d=(d=(d=-1/0)<c?c:d)<e?e:d)<o?o:d)<u?u:d,c=(c=(c=(c=(c=-1/0)<t?t:c)<s?s:c)<i?i:c)<r?r:c,r=this._bounds;return r.x=h=u<(h=o<(h=e<h?e:h)?o:h)?u:h,r.width=d-h,r.y=n,r.height=c-n,this._currentBounds=r},P.TilingSprite.prototype.destroy=function(){P.Sprite.prototype.destroy.call(this),this.canvasBuffer&&(this.canvasBuffer.destroy(),this.canvasBuffer=null),this.tileScale=null,this.tileScaleOffset=null,this.tilePosition=null,this.tilingTexture&&(this.tilingTexture.destroy(!0),this.tilingTexture=null)},Object.defineProperty(P.TilingSprite.prototype,"width",{get:function(){return this._width},set:function(t){this._width=t}}),Object.defineProperty(P.TilingSprite.prototype,"height",{get:function(){return this._height},set:function(t){this._height=t}}),"undefined"!=typeof exports?(exports="undefined"!=typeof module&&module.exports?module.exports=P:exports).PIXI=P:"undefined"!=typeof define&&define.amd?define("PIXI",t.PIXI=P):t.PIXI=P,P}.call(this),function(){function n(t,e){this._scaleFactor=t,this._deltaMode=e,this.originalEvent=null}var t,o,e,i,r=this,U={VERSION:"2.6.15",GAMES:[],AUTO:0,CANVAS:1,WEBGL:2,HEADLESS:3,NONE:0,LEFT:1,RIGHT:2,UP:3,DOWN:4,SPRITE:0,BUTTON:1,IMAGE:2,GRAPHICS:3,TEXT:4,TILESPRITE:5,BITMAPTEXT:6,GROUP:7,RENDERTEXTURE:8,TILEMAP:9,TILEMAPLAYER:10,EMITTER:11,POLYGON:12,BITMAPDATA:13,CANVAS_FILTER:14,WEBGL_FILTER:15,ELLIPSE:16,SPRITEBATCH:17,RETROFONT:18,POINTER:19,ROPE:20,CIRCLE:21,RECTANGLE:22,LINE:23,MATRIX:24,POINT:25,ROUNDEDRECTANGLE:26,CREATURE:27,VIDEO:28,PENDING_ATLAS:-1,HORIZONTAL:0,VERTICAL:1,LANDSCAPE:0,PORTRAIT:1,ANGLE_UP:270,ANGLE_DOWN:90,ANGLE_LEFT:180,ANGLE_RIGHT:0,ANGLE_NORTH_EAST:315,ANGLE_NORTH_WEST:225,ANGLE_SOUTH_EAST:45,ANGLE_SOUTH_WEST:135,TOP_LEFT:0,TOP_CENTER:1,TOP_RIGHT:2,LEFT_TOP:3,LEFT_CENTER:4,LEFT_BOTTOM:5,CENTER:6,RIGHT_TOP:7,RIGHT_CENTER:8,RIGHT_BOTTOM:9,BOTTOM_LEFT:10,BOTTOM_CENTER:11,BOTTOM_RIGHT:12,blendModes:{NORMAL:0,ADD:1,MULTIPLY:2,SCREEN:3,OVERLAY:4,DARKEN:5,LIGHTEN:6,COLOR_DODGE:7,COLOR_BURN:8,HARD_LIGHT:9,SOFT_LIGHT:10,DIFFERENCE:11,EXCLUSION:12,HUE:13,SATURATION:14,COLOR:15,LUMINOSITY:16},scaleModes:{DEFAULT:0,LINEAR:0,NEAREST:1},PIXI:PIXI||{}};for(e in Math.trunc||(Math.trunc=function(t){return t<0?Math.ceil(t):Math.floor(t)}),Function.prototype.bind||(Function.prototype.bind=(o=Array.prototype.slice,function(e){function i(){var t=r.concat(o.call(arguments));n.apply(this instanceof i?this:e,t)}var n=this,r=o.call(arguments,1);if("function"!=typeof n)throw new TypeError;return i.prototype=function t(e){if(e&&(t.prototype=e),!(this instanceof t))return new t}(n.prototype),i})),Array.isArray||(Array.isArray=function(t){return"[object Array]"===Object.prototype.toString.call(t)}),Array.prototype.forEach||(Array.prototype.forEach=function(t){"use strict";if(null==this)throw new TypeError;var e=Object(this),i=e.length>>>0;if("function"!=typeof t)throw new TypeError;for(var n=2<=arguments.length?arguments[1]:void 0,r=0;r<i;r++)r in e&&t.call(n,e[r],r,e)}),"function"!=typeof window.Uint32Array&&"object"!=typeof window.Uint32Array&&((t=function(t){var e=new Array;window[t]=function(t){if("number"==typeof t){Array.call(this,t),this.length=t;for(var e=0;e<this.length;e++)this[e]=0}else{Array.call(this,t.length),this.length=t.length;for(e=0;e<this.length;e++)this[e]=t[e]}},window[t].prototype=e,window[t].constructor=window[t]})("Uint32Array"),t("Int16Array")),window.console||(window.console={},window.console.log=window.console.assert=function(){},window.console.warn=window.console.assert=function(){}),/firefox/i.test(navigator.userAgent)&&(window.oldGetComputedStyle=window.getComputedStyle,window.getComputedStyle=function(t,e){e=window.oldGetComputedStyle(t,e);return null===e?{getPropertyValue:function(){}}:e}),U.Utils={reverseString:function(t){return t.split("").reverse().join("")},getProperty:function(t,e){for(var i=e.split("."),e=i.pop(),n=i.length,r=1,o=i[0];r<n&&(t=t[o]);)o=i[r],r++;return t?t[e]:null},setProperty:function(t,e,i){for(var n=e.split("."),e=n.pop(),r=n.length,o=1,s=n[0];o<r&&(t=t[s]);)s=n[o],o++;return t&&(t[e]=i),t},chanceRoll:function(t){return 0<(t=void 0===t?50:t)&&100*Math.random()<=t},randomChoice:function(t,e){return Math.random()<.5?t:e},parseDimension:function(t,e){var i;return"string"==typeof t?"%"===t.substr(-1)?(i=parseInt(t,10)/100,0===e?window.innerWidth*i:window.innerHeight*i):parseInt(t,10):t},pad:function(t,e,i,n){void 0===i&&(i=" "),void 0===n&&(n=3);var r;if((e=void 0===e?0:e)+1>=(t=t.toString()).length)switch(n){case 1:t=new Array(e+1-t.length).join(i)+t;break;case 3:var o=Math.ceil((r=e-t.length)/2);t=new Array(1+(r-o)).join(i)+t+new Array(o+1).join(i);break;default:t+=new Array(e+1-t.length).join(i)}return t},isPlainObject:function(t){if("object"!=typeof t||t.nodeType||t===t.window)return!1;try{if(t.constructor&&!{}.hasOwnProperty.call(t.constructor.prototype,"isPrototypeOf"))return!1}catch(t){return!1}return!0},extend:function(){var t,e,i,n,r,o=arguments[0]||{},s=1,a=arguments.length,h=!1;for("boolean"==typeof o&&(h=o,o=arguments[1]||{},s=2),a===s&&(o=this,--s);s<a;s++)if(null!=(t=arguments[s]))for(e in t)r=o[e],i=t[e],o!==i&&(h&&i&&(U.Utils.isPlainObject(i)||(n=Array.isArray(i)))?(r=n?(n=!1,r&&Array.isArray(r)?r:[]):r&&U.Utils.isPlainObject(r)?r:{},o[e]=U.Utils.extend(h,r,i)):void 0!==i&&(o[e]=i));return o},mixinPrototype:function(t,e,i){void 0===i&&(i=!1);for(var n=Object.keys(e),r=0;r<n.length;r++){var o=n[r],s=e[o];!i&&o in t||(!s||"function"!=typeof s.get&&"function"!=typeof s.set?t[o]=s:"function"==typeof s.clone?t[o]=s.clone():Object.defineProperty(t,o,s))}},mixin:function(t,e){if(!t||"object"!=typeof t)return e;for(var i in t){var n,r=t[i];r.childNodes||r.cloneNode||(n=typeof t[i],t[i]&&"object"==n?typeof e[i]==n?e[i]=U.Utils.mixin(t[i],e[i]):e[i]=U.Utils.mixin(t[i],new r.constructor):e[i]=t[i])}return e}},U.Circle=function(t,e,i){e=e||0,i=i||0,this.x=t=t||0,this.y=e,this._diameter=i,(this._radius=0)<i&&(this._radius=.5*i),this.type=U.CIRCLE},U.Circle.prototype={circumference:function(){return Math.PI*this._radius*2},random:function(t){void 0===t&&(t=new U.Point);var e=2*Math.PI*Math.random(),i=Math.random()+Math.random(),n=1<i?2-i:i,i=n*Math.cos(e),e=n*Math.sin(e);return t.x=this.x+i*this.radius,t.y=this.y+e*this.radius,t},getBounds:function(){return new U.Rectangle(this.x-this.radius,this.y-this.radius,this.diameter,this.diameter)},setTo:function(t,e,i){return this.x=t,this.y=e,this._diameter=i,this._radius=.5*i,this},copyFrom:function(t){return this.setTo(t.x,t.y,t.diameter)},copyTo:function(t){return t.x=this.x,t.y=this.y,t.diameter=this._diameter,t},distance:function(t,e){t=U.Math.distance(this.x,this.y,t.x,t.y);return e?Math.round(t):t},clone:function(t){return null==t?t=new U.Circle(this.x,this.y,this.diameter):t.setTo(this.x,this.y,this.diameter),t},contains:function(t,e){return U.Circle.contains(this,t,e)},circumferencePoint:function(t,e,i){return U.Circle.circumferencePoint(this,t,e,i)},offset:function(t,e){return this.x+=t,this.y+=e,this},offsetPoint:function(t){return this.offset(t.x,t.y)},toString:function(){return"[{Phaser.Circle (x="+this.x+" y="+this.y+" diameter="+this.diameter+" radius="+this.radius+")}]"}},U.Circle.prototype.constructor=U.Circle,Object.defineProperty(U.Circle.prototype,"diameter",{get:function(){return this._diameter},set:function(t){0<t&&(this._diameter=t,this._radius=.5*t)}}),Object.defineProperty(U.Circle.prototype,"radius",{get:function(){return this._radius},set:function(t){0<t&&(this._radius=t,this._diameter=2*t)}}),Object.defineProperty(U.Circle.prototype,"left",{get:function(){return this.x-this._radius},set:function(t){t>this.x?(this._radius=0,this._diameter=0):this.radius=this.x-t}}),Object.defineProperty(U.Circle.prototype,"right",{get:function(){return this.x+this._radius},set:function(t){t<this.x?(this._radius=0,this._diameter=0):this.radius=t-this.x}}),Object.defineProperty(U.Circle.prototype,"top",{get:function(){return this.y-this._radius},set:function(t){t>this.y?(this._radius=0,this._diameter=0):this.radius=this.y-t}}),Object.defineProperty(U.Circle.prototype,"bottom",{get:function(){return this.y+this._radius},set:function(t){t<this.y?(this._radius=0,this._diameter=0):this.radius=t-this.y}}),Object.defineProperty(U.Circle.prototype,"area",{get:function(){return 0<this._radius?Math.PI*this._radius*this._radius:0}}),Object.defineProperty(U.Circle.prototype,"empty",{get:function(){return 0===this._diameter},set:function(t){!0===t&&this.setTo(0,0,0)}}),U.Circle.contains=function(t,e,i){return 0<t.radius&&e>=t.left&&e<=t.right&&i>=t.top&&i<=t.bottom&&(t.x-e)*(t.x-e)+(t.y-i)*(t.y-i)<=t.radius*t.radius},U.Circle.equals=function(t,e){return t.x===e.x&&t.y===e.y&&t.diameter===e.diameter},U.Circle.intersects=function(t,e){return U.Math.distance(t.x,t.y,e.x,e.y)<=t.radius+e.radius},U.Circle.circumferencePoint=function(t,e,i,n){return void 0===i&&(i=!1),void 0===n&&(n=new U.Point),!0===i&&(e=U.Math.degToRad(e)),n.x=t.x+t.radius*Math.cos(e),n.y=t.y+t.radius*Math.sin(e),n},U.Circle.intersectsRectangle=function(t,e){var i=Math.abs(t.x-e.x-e.halfWidth);if(i>e.halfWidth+t.radius)return!1;var n=Math.abs(t.y-e.y-e.halfHeight);if(n>e.halfHeight+t.radius)return!1;if(i<=e.halfWidth||n<=e.halfHeight)return!0;i-=e.halfWidth,e=n-e.halfHeight;return i*i+e*e<=t.radius*t.radius},PIXI.Circle=U.Circle,U.Ellipse=function(t,e,i,n){e=e||0,i=i||0,n=n||0,this.x=t=t||0,this.y=e,this.width=i,this.height=n,this.type=U.ELLIPSE},U.Ellipse.prototype={setTo:function(t,e,i,n){return this.x=t,this.y=e,this.width=i,this.height=n,this},getBounds:function(){return new U.Rectangle(this.x-this.width,this.y-this.height,this.width,this.height)},copyFrom:function(t){return this.setTo(t.x,t.y,t.width,t.height)},copyTo:function(t){return t.x=this.x,t.y=this.y,t.width=this.width,t.height=this.height,t},clone:function(t){return null==t?t=new U.Ellipse(this.x,this.y,this.width,this.height):t.setTo(this.x,this.y,this.width,this.height),t},contains:function(t,e){return U.Ellipse.contains(this,t,e)},random:function(t){void 0===t&&(t=new U.Point);var e=Math.random()*Math.PI*2,i=Math.random();return t.x=Math.sqrt(i)*Math.cos(e),t.y=Math.sqrt(i)*Math.sin(e),t.x=this.x+t.x*this.width/2,t.y=this.y+t.y*this.height/2,t},toString:function(){return"[{Phaser.Ellipse (x="+this.x+" y="+this.y+" width="+this.width+" height="+this.height+")}]"}},U.Ellipse.prototype.constructor=U.Ellipse,Object.defineProperty(U.Ellipse.prototype,"left",{get:function(){return this.x},set:function(t){this.x=t}}),Object.defineProperty(U.Ellipse.prototype,"right",{get:function(){return this.x+this.width},set:function(t){t<this.x?this.width=0:this.width=t-this.x}}),Object.defineProperty(U.Ellipse.prototype,"top",{get:function(){return this.y},set:function(t){this.y=t}}),Object.defineProperty(U.Ellipse.prototype,"bottom",{get:function(){return this.y+this.height},set:function(t){t<this.y?this.height=0:this.height=t-this.y}}),Object.defineProperty(U.Ellipse.prototype,"empty",{get:function(){return 0===this.width||0===this.height},set:function(t){!0===t&&this.setTo(0,0,0,0)}}),U.Ellipse.contains=function(t,e,i){if(t.width<=0||t.height<=0)return!1;e=(e-t.x)/t.width-.5,t=(i-t.y)/t.height-.5;return(e*=e)+(t*=t)<.25},PIXI.Ellipse=U.Ellipse,U.Line=function(t,e,i,n){i=i||0,n=n||0,this.start=new U.Point(t=t||0,e=e||0),this.end=new U.Point(i,n),this.type=U.LINE},U.Line.prototype={setTo:function(t,e,i,n){return this.start.setTo(t,e),this.end.setTo(i,n),this},fromSprite:function(t,e,i){return(i=void 0===i?!1:i)?this.setTo(t.center.x,t.center.y,e.center.x,e.center.y):this.setTo(t.x,t.y,e.x,e.y)},fromAngle:function(t,e,i,n){return this.start.setTo(t,e),this.end.setTo(t+Math.cos(i)*n,e+Math.sin(i)*n),this},rotate:function(t,e){var i=(this.start.x+this.end.x)/2,n=(this.start.y+this.end.y)/2;return this.start.rotate(i,n,t,e),this.end.rotate(i,n,t,e),this},rotateAround:function(t,e,i,n){return this.start.rotate(t,e,i,n),this.end.rotate(t,e,i,n),this},intersects:function(t,e,i){return U.Line.intersectsPoints(this.start,this.end,t.start,t.end,e,i)},reflect:function(t){return U.Line.reflect(this,t)},midPoint:function(t){return(t=void 0===t?new U.Point:t).x=(this.start.x+this.end.x)/2,t.y=(this.start.y+this.end.y)/2,t},centerOn:function(t,e){t-=(this.start.x+this.end.x)/2,e-=(this.start.y+this.end.y)/2;this.start.add(t,e),this.end.add(t,e)},pointOnLine:function(t,e){return(t-this.start.x)*(this.end.y-this.start.y)==(this.end.x-this.start.x)*(e-this.start.y)},pointOnSegment:function(t,e){var i=Math.min(this.start.x,this.end.x),n=Math.max(this.start.x,this.end.x),r=Math.min(this.start.y,this.end.y),o=Math.max(this.start.y,this.end.y);return this.pointOnLine(t,e)&&i<=t&&t<=n&&r<=e&&e<=o},random:function(t){void 0===t&&(t=new U.Point);var e=Math.random();return t.x=this.start.x+e*(this.end.x-this.start.x),t.y=this.start.y+e*(this.end.y-this.start.y),t},coordinatesOnLine:function(t,e){void 0===t&&(t=1),void 0===e&&(e=[]);var i=Math.round(this.start.x),n=Math.round(this.start.y),r=Math.round(this.end.x),o=Math.round(this.end.y),s=Math.abs(r-i),a=Math.abs(o-n),h=i<r?1:-1,l=n<o?1:-1,p=s-a;e.push([i,n]);for(var u=1;i!==r||n!==o;){var d=p<<1;-a<d&&(p-=a,i+=h),d<s&&(p+=s,n+=l),u%t==0&&e.push([i,n]),u++}return e},clone:function(t){return null==t?t=new U.Line(this.start.x,this.start.y,this.end.x,this.end.y):t.setTo(this.start.x,this.start.y,this.end.x,this.end.y),t}},Object.defineProperty(U.Line.prototype,"length",{get:function(){return Math.sqrt((this.end.x-this.start.x)*(this.end.x-this.start.x)+(this.end.y-this.start.y)*(this.end.y-this.start.y))}}),Object.defineProperty(U.Line.prototype,"angle",{get:function(){return Math.atan2(this.end.y-this.start.y,this.end.x-this.start.x)}}),Object.defineProperty(U.Line.prototype,"slope",{get:function(){return(this.end.y-this.start.y)/(this.end.x-this.start.x)}}),Object.defineProperty(U.Line.prototype,"perpSlope",{get:function(){return-(this.end.x-this.start.x)/(this.end.y-this.start.y)}}),Object.defineProperty(U.Line.prototype,"x",{get:function(){return Math.min(this.start.x,this.end.x)}}),Object.defineProperty(U.Line.prototype,"y",{get:function(){return Math.min(this.start.y,this.end.y)}}),Object.defineProperty(U.Line.prototype,"left",{get:function(){return Math.min(this.start.x,this.end.x)}}),Object.defineProperty(U.Line.prototype,"right",{get:function(){return Math.max(this.start.x,this.end.x)}}),Object.defineProperty(U.Line.prototype,"top",{get:function(){return Math.min(this.start.y,this.end.y)}}),Object.defineProperty(U.Line.prototype,"bottom",{get:function(){return Math.max(this.start.y,this.end.y)}}),Object.defineProperty(U.Line.prototype,"width",{get:function(){return Math.abs(this.start.x-this.end.x)}}),Object.defineProperty(U.Line.prototype,"height",{get:function(){return Math.abs(this.start.y-this.end.y)}}),Object.defineProperty(U.Line.prototype,"normalX",{get:function(){return Math.cos(this.angle-1.5707963267948966)}}),Object.defineProperty(U.Line.prototype,"normalY",{get:function(){return Math.sin(this.angle-1.5707963267948966)}}),Object.defineProperty(U.Line.prototype,"normalAngle",{get:function(){return U.Math.wrap(this.angle-1.5707963267948966,-Math.PI,Math.PI)}}),U.Line.intersectsPoints=function(t,e,i,n,r,o){void 0===r&&(r=!0),void 0===o&&(o=new U.Point);var s=e.y-t.y,a=n.y-i.y,h=t.x-e.x,l=i.x-n.x,p=e.x*t.y-t.x*e.y,u=n.x*i.y-i.x*n.y,d=s*l-a*h;if(0==d)return null;if(o.x=(h*u-l*p)/d,o.y=(a*p-s*u)/d,r){r=(n.y-i.y)*(e.x-t.x)-(n.x-i.x)*(e.y-t.y),n=((n.x-i.x)*(t.y-i.y)-(n.y-i.y)*(t.x-i.x))/r,r=((e.x-t.x)*(t.y-i.y)-(e.y-t.y)*(t.x-i.x))/r;return 0<=n&&n<=1&&0<=r&&r<=1?o:null}return o},U.Line.intersects=function(t,e,i,n){return U.Line.intersectsPoints(t.start,t.end,e.start,e.end,i,n)},U.Line.intersectsRectangle=function(t,e){if(!U.Rectangle.intersects(t,e))return!1;var i=t.start.x,n=t.start.y,r=t.end.x,o=t.end.y,s=e.x,a=e.y,h=e.right,t=e.bottom,e=0;if(s<=i&&i<=h&&a<=n&&n<=t||s<=r&&r<=h&&a<=o&&o<=t)return!0;if(i<s&&s<=r){if((e=n+(o-n)*(s-i)/(r-i))>a&&e<=t)return!0}else if(h<i&&r<=h&&(e=n+(o-n)*(h-i)/(r-i))>=a&&e<=t)return!0;if(n<a&&a<=o){if((e=i+(r-i)*(a-n)/(o-n))>=s&&e<=h)return!0}else if(t<n&&o<=t&&(e=i+(r-i)*(t-n)/(o-n))>=s&&e<=h)return!0;return!1},U.Line.reflect=function(t,e){return 2*e.normalAngle-3.141592653589793-t.angle},U.Matrix=function(t,e,i,n,r,o){null!=e||(e=0),null!=i||(i=0),null!=n||(n=1),null!=r||(r=0),null!=o||(o=0),this.a=t=null==t?1:t,this.b=e,this.c=i,this.d=n,this.tx=r,this.ty=o,this.type=U.MATRIX},U.Matrix.prototype={fromArray:function(t){return this.setTo(t[0],t[1],t[3],t[4],t[2],t[5])},setTo:function(t,e,i,n,r,o){return this.a=t,this.b=e,this.c=i,this.d=n,this.tx=r,this.ty=o,this},clone:function(t){return null==t?t=new U.Matrix(this.a,this.b,this.c,this.d,this.tx,this.ty):(t.a=this.a,t.b=this.b,t.c=this.c,t.d=this.d,t.tx=this.tx,t.ty=this.ty),t},copyTo:function(t){return t.copyFrom(this),t},copyFrom:function(t){return this.a=t.a,this.b=t.b,this.c=t.c,this.d=t.d,this.tx=t.tx,this.ty=t.ty,this},toArray:function(t,e){return void 0===e&&(e=new PIXI.Float32Array(9)),t?(e[0]=this.a,e[1]=this.b,e[2]=0,e[3]=this.c,e[4]=this.d,e[5]=0,e[6]=this.tx,e[7]=this.ty):(e[0]=this.a,e[1]=this.c,e[2]=this.tx,e[3]=this.b,e[4]=this.d,e[5]=this.ty,e[6]=0,e[7]=0),e[8]=1,e},apply:function(t,e){return(e=void 0===e?new U.Point:e).x=this.a*t.x+this.c*t.y+this.tx,e.y=this.b*t.x+this.d*t.y+this.ty,e},applyInverse:function(t,e){void 0===e&&(e=new U.Point);var i=1/(this.a*this.d+this.c*-this.b),n=t.x,t=t.y;return e.x=this.d*i*n+-this.c*i*t+(this.ty*this.c-this.tx*this.d)*i,e.y=this.a*i*t+-this.b*i*n+(-this.ty*this.a+this.tx*this.b)*i,e},translate:function(t,e){return this.tx+=t,this.ty+=e,this},scale:function(t,e){return this.a*=t,this.d*=e,this.c*=t,this.b*=e,this.tx*=t,this.ty*=e,this},rotate:function(t){var e=Math.cos(t),i=Math.sin(t),n=this.a,r=this.c,t=this.tx;return this.a=n*e-this.b*i,this.b=n*i+this.b*e,this.c=r*e-this.d*i,this.d=r*i+this.d*e,this.tx=t*e-this.ty*i,this.ty=t*i+this.ty*e,this},append:function(t){var e=this.a,i=this.b,n=this.c,r=this.d;return this.a=t.a*e+t.b*n,this.b=t.a*i+t.b*r,this.c=t.c*e+t.d*n,this.d=t.c*i+t.d*r,this.tx=t.tx*e+t.ty*n+this.tx,this.ty=t.tx*i+t.ty*r+this.ty,this},identity:function(){return this.setTo(1,0,0,1,0,0)}},U.identityMatrix=new U.Matrix,PIXI.Matrix=U.Matrix,PIXI.identityMatrix=U.identityMatrix,U.Point=function(t,e){e=e||0,this.x=t=t||0,this.y=e,this.type=U.POINT},U.Point.prototype={copyFrom:function(t){return this.setTo(t.x,t.y)},invert:function(){return this.setTo(this.y,this.x)},setTo:function(t,e){return this.x=t||0,this.y=e||(0!==e?this.x:0),this},set:function(t,e){return this.x=t||0,this.y=e||(0!==e?this.x:0),this},add:function(t,e){return this.x+=t,this.y+=e,this},subtract:function(t,e){return this.x-=t,this.y-=e,this},multiply:function(t,e){return this.x*=t,this.y*=e,this},divide:function(t,e){return this.x/=t,this.y/=e,this},clampX:function(t,e){return this.x=U.Math.clamp(this.x,t,e),this},clampY:function(t,e){return this.y=U.Math.clamp(this.y,t,e),this},clamp:function(t,e){return this.x=U.Math.clamp(this.x,t,e),this.y=U.Math.clamp(this.y,t,e),this},clone:function(t){return null==t?t=new U.Point(this.x,this.y):t.setTo(this.x,this.y),t},copyTo:function(t){return t.x=this.x,t.y=this.y,t},distance:function(t,e){return U.Point.distance(this,t,e)},equals:function(t){return t.x===this.x&&t.y===this.y},angle:function(t,e){return(e=void 0===e?!1:e)?U.Math.radToDeg(Math.atan2(t.y-this.y,t.x-this.x)):Math.atan2(t.y-this.y,t.x-this.x)},rotate:function(t,e,i,n,r){return U.Point.rotate(this,t,e,i,n,r)},getMagnitude:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},getMagnitudeSq:function(){return this.x*this.x+this.y*this.y},setMagnitude:function(t){return this.normalize().multiply(t,t)},normalize:function(){var t;return this.isZero()||(t=this.getMagnitude(),this.x/=t,this.y/=t),this},isZero:function(){return 0===this.x&&0===this.y},dot:function(t){return this.x*t.x+this.y*t.y},cross:function(t){return this.x*t.y-this.y*t.x},perp:function(){return this.setTo(-this.y,this.x)},rperp:function(){return this.setTo(this.y,-this.x)},normalRightHand:function(){return this.setTo(-1*this.y,this.x)},floor:function(){return this.setTo(Math.floor(this.x),Math.floor(this.y))},ceil:function(){return this.setTo(Math.ceil(this.x),Math.ceil(this.y))},toString:function(){return"[{Point (x="+this.x+" y="+this.y+")}]"}},U.Point.prototype.constructor=U.Point,U.Point.add=function(t,e,i){return(i=void 0===i?new U.Point:i).x=t.x+e.x,i.y=t.y+e.y,i},U.Point.subtract=function(t,e,i){return(i=void 0===i?new U.Point:i).x=t.x-e.x,i.y=t.y-e.y,i},U.Point.multiply=function(t,e,i){return(i=void 0===i?new U.Point:i).x=t.x*e.x,i.y=t.y*e.y,i},U.Point.divide=function(t,e,i){return(i=void 0===i?new U.Point:i).x=t.x/e.x,i.y=t.y/e.y,i},U.Point.equals=function(t,e){return t.x===e.x&&t.y===e.y},U.Point.angle=function(t,e){return Math.atan2(t.y-e.y,t.x-e.x)},U.Point.negative=function(t,e){return(e=void 0===e?new U.Point:e).setTo(-t.x,-t.y)},U.Point.multiplyAdd=function(t,e,i,n){return(n=void 0===n?new U.Point:n).setTo(t.x+e.x*i,t.y+e.y*i)},U.Point.interpolate=function(t,e,i,n){return(n=void 0===n?new U.Point:n).setTo(t.x+(e.x-t.x)*i,t.y+(e.y-t.y)*i)},U.Point.perp=function(t,e){return(e=void 0===e?new U.Point:e).setTo(-t.y,t.x)},U.Point.rperp=function(t,e){return(e=void 0===e?new U.Point:e).setTo(t.y,-t.x)},U.Point.distance=function(t,e,i){e=U.Math.distance(t.x,t.y,e.x,e.y);return i?Math.round(e):e},U.Point.project=function(t,e,i){void 0===i&&(i=new U.Point);t=t.dot(e)/e.getMagnitudeSq();return 0!=t&&i.setTo(t*e.x,t*e.y),i},U.Point.projectUnit=function(t,e,i){void 0===i&&(i=new U.Point);t=t.dot(e);return 0!==t&&i.setTo(t*e.x,t*e.y),i},U.Point.normalRightHand=function(t,e){return(e=void 0===e?new U.Point:e).setTo(-1*t.y,t.x)},U.Point.normalize=function(t,e){void 0===e&&(e=new U.Point);var i=t.getMagnitude();return 0!==i&&e.setTo(t.x/i,t.y/i),e},U.Point.rotate=function(t,e,i,n,r,o){var s,a;return r&&(n=U.Math.degToRad(n)),void 0===o?(t.subtract(e,i),s=Math.sin(n),r=(a=Math.cos(n))*t.x-s*t.y,a=s*t.x+a*t.y,t.x=r+e,t.y=a+i):(n=n+Math.atan2(t.y-i,t.x-e),t.x=e+o*Math.cos(n),t.y=i+o*Math.sin(n)),t},U.Point.centroid=function(t,e){if(void 0===e&&(e=new U.Point),"[object Array]"!==Object.prototype.toString.call(t))throw new Error("Phaser.Point. Parameter 'points' must be an array");var i=t.length;if(i<1)throw new Error("Phaser.Point. Parameter 'points' array must not be empty");if(1===i)return e.copyFrom(t[0]),e;for(var n=0;n<i;n++)U.Point.add(e,t[n],e);return e.divide(i,i),e},U.Point.parse=function(t,e,i){e=e||"x",i=i||"y";var n=new U.Point;return t[e]&&(n.x=parseInt(t[e],10)),t[i]&&(n.y=parseInt(t[i],10)),n},PIXI.Point=U.Point,U.Polygon=function(){this.area=0,this._points=[],0<arguments.length&&this.setTo.apply(this,arguments),this.closed=!0,this.flattened=!1,this.type=U.POLYGON},U.Polygon.prototype={toNumberArray:function(t){void 0===t&&(t=[]);for(var e=0;e<this._points.length;e++)"number"==typeof this._points[e]?(t.push(this._points[e]),t.push(this._points[e+1]),e++):(t.push(this._points[e].x),t.push(this._points[e].y));return t},flatten:function(){return this._points=this.toNumberArray(),this.flattened=!0,this},clone:function(t){var e=this._points.slice();return null==t?t=new U.Polygon(e):t.setTo(e),t},contains:function(t,e){var i=!1;if(this.flattened)for(var n=-2,r=this._points.length-2;(n+=2)<this._points.length;r=n){var o=this._points[n],s=this._points[n+1],a=this._points[r],h=this._points[r+1];(s<=e&&e<h||h<=e&&e<s)&&t<(a-o)*(e-s)/(h-s)+o&&(i=!i)}else for(n=-1,r=this._points.length-1;++n<this._points.length;r=n){o=this._points[n].x,s=this._points[n].y,a=this._points[r].x,h=this._points[r].y;(s<=e&&e<h||h<=e&&e<s)&&t<(a-o)*(e-s)/(h-s)+o&&(i=!i)}return i},setTo:function(t){if(this.area=0,this._points=[],0<arguments.length){Array.isArray(t)||(t=Array.prototype.slice.call(arguments));for(var e,i=Number.MAX_VALUE,n=0,r=t.length;n<r;n++)"number"==typeof t[n]?(e=new PIXI.Point(t[n],t[n+1]),n++):e=Array.isArray(t[n])?new PIXI.Point(t[n][0],t[n][1]):new PIXI.Point(t[n].x,t[n].y),this._points.push(e),e.y<i&&(i=e.y);this.calculateArea(i)}return this},calculateArea:function(t){for(var e,i,n,r=0,o=this._points.length;r<o;r++)e=this._points[r],n=r===o-1?this._points[0]:this._points[r+1],i=(e.y-t+(n.y-t))/2,n=e.x-n.x,this.area+=i*n;return this.area}},U.Polygon.prototype.constructor=U.Polygon,Object.defineProperty(U.Polygon.prototype,"points",{get:function(){return this._points},set:function(t){null!=t?this.setTo(t):this.setTo()}}),PIXI.Polygon=U.Polygon,U.Rectangle=function(t,e,i,n){e=e||0,i=i||0,n=n||0,this.x=t=t||0,this.y=e,this.width=i,this.height=n,this.type=U.RECTANGLE},U.Rectangle.prototype={offset:function(t,e){return this.x+=t,this.y+=e,this},offsetPoint:function(t){return this.offset(t.x,t.y)},setTo:function(t,e,i,n){return this.x=t,this.y=e,this.width=i,this.height=n,this},scale:function(t,e){return void 0===e&&(e=t),this.width*=t,this.height*=e,this},centerOn:function(t,e){return this.centerX=t,this.centerY=e,this},floor:function(){this.x=Math.floor(this.x),this.y=Math.floor(this.y)},floorAll:function(){this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.width=Math.floor(this.width),this.height=Math.floor(this.height)},ceil:function(){this.x=Math.ceil(this.x),this.y=Math.ceil(this.y)},ceilAll:function(){this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.width=Math.ceil(this.width),this.height=Math.ceil(this.height)},copyFrom:function(t){return this.setTo(t.x,t.y,t.width,t.height)},copyTo:function(t){return t.x=this.x,t.y=this.y,t.width=this.width,t.height=this.height,t},inflate:function(t,e){return U.Rectangle.inflate(this,t,e)},size:function(t){return U.Rectangle.size(this,t)},resize:function(t,e){return this.width=t,this.height=e,this},clone:function(t){return U.Rectangle.clone(this,t)},contains:function(t,e){return U.Rectangle.contains(this,t,e)},containsRect:function(t){return U.Rectangle.containsRect(t,this)},equals:function(t){return U.Rectangle.equals(this,t)},intersection:function(t,e){return U.Rectangle.intersection(this,t,e)},intersects:function(t){return U.Rectangle.intersects(this,t)},intersectsRaw:function(t,e,i,n,r){return U.Rectangle.intersectsRaw(this,t,e,i,n,r)},union:function(t,e){return U.Rectangle.union(this,t,e)},random:function(t){return(t=void 0===t?new U.Point:t).x=this.randomX,t.y=this.randomY,t},getPoint:function(t,e){switch(void 0===e&&(e=new U.Point),t){default:case U.TOP_LEFT:return e.set(this.x,this.y);case U.TOP_CENTER:return e.set(this.centerX,this.y);case U.TOP_RIGHT:return e.set(this.right,this.y);case U.LEFT_CENTER:return e.set(this.x,this.centerY);case U.CENTER:return e.set(this.centerX,this.centerY);case U.RIGHT_CENTER:return e.set(this.right,this.centerY);case U.BOTTOM_LEFT:return e.set(this.x,this.bottom);case U.BOTTOM_CENTER:return e.set(this.centerX,this.bottom);case U.BOTTOM_RIGHT:return e.set(this.right,this.bottom)}},toString:function(){return"[{Rectangle (x="+this.x+" y="+this.y+" width="+this.width+" height="+this.height+" empty="+this.empty+")}]"}},Object.defineProperty(U.Rectangle.prototype,"halfWidth",{get:function(){return Math.round(this.width/2)}}),Object.defineProperty(U.Rectangle.prototype,"halfHeight",{get:function(){return Math.round(this.height/2)}}),Object.defineProperty(U.Rectangle.prototype,"bottom",{get:function(){return this.y+this.height},set:function(t){t<=this.y?this.height=0:this.height=t-this.y}}),Object.defineProperty(U.Rectangle.prototype,"bottomLeft",{get:function(){return new U.Point(this.x,this.bottom)},set:function(t){this.x=t.x,this.bottom=t.y}}),Object.defineProperty(U.Rectangle.prototype,"bottomRight",{get:function(){return new U.Point(this.right,this.bottom)},set:function(t){this.right=t.x,this.bottom=t.y}}),Object.defineProperty(U.Rectangle.prototype,"left",{get:function(){return this.x},set:function(t){t>=this.right?this.width=0:this.width=this.right-t,this.x=t}}),Object.defineProperty(U.Rectangle.prototype,"right",{get:function(){return this.x+this.width},set:function(t){t<=this.x?this.width=0:this.width=t-this.x}}),Object.defineProperty(U.Rectangle.prototype,"volume",{get:function(){return this.width*this.height}}),Object.defineProperty(U.Rectangle.prototype,"perimeter",{get:function(){return 2*this.width+2*this.height}}),Object.defineProperty(U.Rectangle.prototype,"centerX",{get:function(){return this.x+this.halfWidth},set:function(t){this.x=t-this.halfWidth}}),Object.defineProperty(U.Rectangle.prototype,"centerY",{get:function(){return this.y+this.halfHeight},set:function(t){this.y=t-this.halfHeight}}),Object.defineProperty(U.Rectangle.prototype,"randomX",{get:function(){return this.x+Math.random()*this.width}}),Object.defineProperty(U.Rectangle.prototype,"randomY",{get:function(){return this.y+Math.random()*this.height}}),Object.defineProperty(U.Rectangle.prototype,"top",{get:function(){return this.y},set:function(t){t>=this.bottom?(this.height=0,this.y=t):this.height=this.bottom-t}}),Object.defineProperty(U.Rectangle.prototype,"topLeft",{get:function(){return new U.Point(this.x,this.y)},set:function(t){this.x=t.x,this.y=t.y}}),Object.defineProperty(U.Rectangle.prototype,"topRight",{get:function(){return new U.Point(this.x+this.width,this.y)},set:function(t){this.right=t.x,this.y=t.y}}),Object.defineProperty(U.Rectangle.prototype,"empty",{get:function(){return!this.width||!this.height},set:function(t){!0===t&&this.setTo(0,0,0,0)}}),U.Rectangle.prototype.constructor=U.Rectangle,U.Rectangle.inflate=function(t,e,i){return t.x-=e,t.width+=2*e,t.y-=i,t.height+=2*i,t},U.Rectangle.inflatePoint=function(t,e){return U.Rectangle.inflate(t,e.x,e.y)},U.Rectangle.size=function(t,e){return null==e?e=new U.Point(t.width,t.height):e.setTo(t.width,t.height),e},U.Rectangle.clone=function(t,e){return null==e?e=new U.Rectangle(t.x,t.y,t.width,t.height):e.setTo(t.x,t.y,t.width,t.height),e},U.Rectangle.contains=function(t,e,i){return!(t.width<=0||t.height<=0)&&e>=t.x&&e<t.right&&i>=t.y&&i<t.bottom},U.Rectangle.containsRaw=function(t,e,i,n,r,o){return t<=r&&r<t+i&&e<=o&&o<e+n},U.Rectangle.containsPoint=function(t,e){return U.Rectangle.contains(t,e.x,e.y)},U.Rectangle.containsRect=function(t,e){return!(t.volume>e.volume)&&t.x>=e.x&&t.y>=e.y&&t.right<e.right&&t.bottom<e.bottom},U.Rectangle.equals=function(t,e){return t.x===e.x&&t.y===e.y&&t.width===e.width&&t.height===e.height},U.Rectangle.sameDimensions=function(t,e){return t.width===e.width&&t.height===e.height},U.Rectangle.intersection=function(t,e,i){return void 0===i&&(i=new U.Rectangle),U.Rectangle.intersects(t,e)&&(i.x=Math.max(t.x,e.x),i.y=Math.max(t.y,e.y),i.width=Math.min(t.right,e.right)-i.x,i.height=Math.min(t.bottom,e.bottom)-i.y),i},U.Rectangle.intersects=function(t,e){return!(t.width<=0||t.height<=0||e.width<=0||e.height<=0||t.right<e.x||t.bottom<e.y||t.x>e.right||t.y>e.bottom)},U.Rectangle.intersectsRaw=function(t,e,i,n,r,o){return!(e>t.right+(o=void 0===o?0:o)||i<t.left-o||n>t.bottom+o||r<t.top-o)},U.Rectangle.union=function(t,e,i){return(i=void 0===i?new U.Rectangle:i).setTo(Math.min(t.x,e.x),Math.min(t.y,e.y),Math.max(t.right,e.right)-Math.min(t.left,e.left),Math.max(t.bottom,e.bottom)-Math.min(t.top,e.top))},U.Rectangle.aabb=function(t,e){void 0===e&&(e=new U.Rectangle);var i=Number.NEGATIVE_INFINITY,n=Number.POSITIVE_INFINITY,r=Number.NEGATIVE_INFINITY,o=Number.POSITIVE_INFINITY;return t.forEach(function(t){t.x>i&&(i=t.x),t.x<n&&(n=t.x),t.y>r&&(r=t.y),t.y<o&&(o=t.y)}),e.setTo(n,o,i-n,r-o),e},PIXI.Rectangle=U.Rectangle,PIXI.EmptyRectangle=new U.Rectangle(0,0,0,0),U.RoundedRectangle=function(t,e,i,n,r){void 0===e&&(e=0),void 0===i&&(i=0),void 0===n&&(n=0),void 0===r&&(r=20),this.x=t=void 0===t?0:t,this.y=e,this.width=i,this.height=n,this.radius=r||20,this.type=U.ROUNDEDRECTANGLE},U.RoundedRectangle.prototype={clone:function(){return new U.RoundedRectangle(this.x,this.y,this.width,this.height,this.radius)},contains:function(t,e){if(this.width<=0||this.height<=0)return!1;var i=this.x;if(i<=t&&t<=i+this.width){i=this.y;if(i<=e&&e<=i+this.height)return!0}return!1}},U.RoundedRectangle.prototype.constructor=U.RoundedRectangle,PIXI.RoundedRectangle=U.RoundedRectangle,U.Camera=function(t,e,i,n,r,o){this.game=t,this.world=t.world,this.id=0,this.view=new U.Rectangle(i,n,r,o),this.bounds=new U.Rectangle(i,n,r,o),this.deadzone=null,this.visible=!0,this.roundPx=!0,this.atLimit={x:!1,y:!1},this.target=null,this.displayObject=null,this.scale=null,this.totalInView=0,this.lerp=new U.Point(1,1),this.onShakeComplete=new U.Signal,this.onFlashComplete=new U.Signal,this.onFadeComplete=new U.Signal,this.fx=null,this._targetPosition=new U.Point,this._edge=0,this._position=new U.Point,this._shake={intensity:0,duration:0,horizontal:!1,vertical:!1,shakeBounds:!0,x:0,y:0},this._fxDuration=0,this._fxType=0},U.Camera.FOLLOW_LOCKON=0,U.Camera.FOLLOW_PLATFORMER=1,U.Camera.FOLLOW_TOPDOWN=2,U.Camera.FOLLOW_TOPDOWN_TIGHT=3,U.Camera.SHAKE_BOTH=4,U.Camera.SHAKE_HORIZONTAL=5,U.Camera.SHAKE_VERTICAL=6,U.Camera.ENABLE_FX=!0,U.Camera.prototype={boot:function(){this.displayObject=this.game.world,this.scale=this.game.world.scale,this.game.camera=this,U.Graphics&&U.Camera.ENABLE_FX&&(this.fx=new U.Graphics(this.game),this.game.stage.addChild(this.fx))},preUpdate:function(){this.totalInView=0},follow:function(t,e,i,n){var r;switch(void 0===e&&(e=U.Camera.FOLLOW_LOCKON),void 0===i&&(i=1),void 0===n&&(n=1),this.target=t,this.lerp.set(i,n),e){case U.Camera.FOLLOW_PLATFORMER:var o=this.width/8,s=this.height/3;this.deadzone=new U.Rectangle((this.width-o)/2,(this.height-s)/2-.25*s,o,s);break;case U.Camera.FOLLOW_TOPDOWN:r=Math.max(this.width,this.height)/4,this.deadzone=new U.Rectangle((this.width-r)/2,(this.height-r)/2,r,r);break;case U.Camera.FOLLOW_TOPDOWN_TIGHT:r=Math.max(this.width,this.height)/8,this.deadzone=new U.Rectangle((this.width-r)/2,(this.height-r)/2,r,r);break;default:U.Camera.FOLLOW_LOCKON;this.deadzone=null}},unfollow:function(){this.target=null},focusOn:function(t){this.setPosition(Math.round(t.x-this.view.halfWidth),Math.round(t.y-this.view.halfHeight))},focusOnXY:function(t,e){this.setPosition(Math.round(t-this.view.halfWidth),Math.round(e-this.view.halfHeight))},shake:function(t,e,i,n,r){return void 0===t&&(t=.05),void 0===e&&(e=500),void 0===n&&(n=U.Camera.SHAKE_BOTH),void 0===r&&(r=!0),!(!(i=void 0===i?!0:i)&&0<this._shake.duration||(this._shake.intensity=t,this._shake.duration=e,this._shake.shakeBounds=r,this._shake.x=0,this._shake.y=0,this._shake.horizontal=n===U.Camera.SHAKE_BOTH||n===U.Camera.SHAKE_HORIZONTAL,this._shake.vertical=n===U.Camera.SHAKE_BOTH||n===U.Camera.SHAKE_VERTICAL,0))},flash:function(t,e,i){return void 0===t&&(t=16777215),void 0===e&&(e=500),void 0===i&&(i=!1),!(!this.fx||!i&&0<this._fxDuration||(this.fx.clear(),this.fx.beginFill(t),this.fx.drawRect(0,0,this.width,this.height),this.fx.endFill(),this.fx.alpha=1,this._fxDuration=e,this._fxType=0))},fade:function(t,e,i){return void 0===t&&(t=0),void 0===e&&(e=500),void 0===i&&(i=!1),!(!this.fx||!i&&0<this._fxDuration||(this.fx.clear(),this.fx.beginFill(t),this.fx.drawRect(0,0,this.width,this.height),this.fx.endFill(),this.fx.alpha=0,this._fxDuration=e,this._fxType=1,0))},update:function(){0<this._fxDuration&&this.updateFX(),0<this._shake.duration&&this.updateShake(),this.bounds&&this.checkBounds(),this.roundPx&&(this.view.floor(),this._shake.x=Math.floor(this._shake.x),this._shake.y=Math.floor(this._shake.y)),this.displayObject.position.x=-this.view.x,this.displayObject.position.y=-this.view.y},updateFX:function(){0===this._fxType?(this.fx.alpha-=this.game.time.elapsedMS/this._fxDuration,this.fx.alpha<=0&&(this._fxDuration=0,this.fx.alpha=0,this.onFlashComplete.dispatch())):(this.fx.alpha+=this.game.time.elapsedMS/this._fxDuration,1<=this.fx.alpha&&(this._fxDuration=0,this.fx.alpha=1,this.onFadeComplete.dispatch()))},updateShake:function(){this._shake.duration-=this.game.time.elapsedMS,this._shake.duration<=0?(this.onShakeComplete.dispatch(),this._shake.x=0,this._shake.y=0):(this._shake.horizontal&&(this._shake.x=this.game.rnd.frac()*this._shake.intensity*this.view.width*2-this._shake.intensity*this.view.width),this._shake.vertical&&(this._shake.y=this.game.rnd.frac()*this._shake.intensity*this.view.height*2-this._shake.intensity*this.view.height))},updateTarget:function(){this._targetPosition.x=this.view.x+this.target.worldPosition.x,this._targetPosition.y=this.view.y+this.target.worldPosition.y,this.deadzone?(this._edge=this._targetPosition.x-this.view.x,this._edge<this.deadzone.left?this.view.x=this.game.math.linear(this.view.x,this._targetPosition.x-this.deadzone.left,this.lerp.x):this._edge>this.deadzone.right&&(this.view.x=this.game.math.linear(this.view.x,this._targetPosition.x-this.deadzone.right,this.lerp.x)),this._edge=this._targetPosition.y-this.view.y,this._edge<this.deadzone.top?this.view.y=this.game.math.linear(this.view.y,this._targetPosition.y-this.deadzone.top,this.lerp.y):this._edge>this.deadzone.bottom&&(this.view.y=this.game.math.linear(this.view.y,this._targetPosition.y-this.deadzone.bottom,this.lerp.y))):(this.view.x=this.game.math.linear(this.view.x,this._targetPosition.x-this.view.halfWidth,this.lerp.x),this.view.y=this.game.math.linear(this.view.y,this._targetPosition.y-this.view.halfHeight,this.lerp.y)),this.bounds&&this.checkBounds(),this.roundPx&&this.view.floor(),this.displayObject.position.x=-this.view.x,this.displayObject.position.y=-this.view.y},setBoundsToWorld:function(){this.bounds&&this.bounds.copyFrom(this.game.world.bounds)},checkBounds:function(){this.atLimit.x=!1,this.atLimit.y=!1;var t=this.view.x+this._shake.x,e=this.view.right+this._shake.x,i=this.view.y+this._shake.y,n=this.view.bottom+this._shake.y;t<=this.bounds.x*this.scale.x&&(this.atLimit.x=!0,this.view.x=this.bounds.x*this.scale.x,this._shake.shakeBounds||(this._shake.x=0)),e>=this.bounds.right*this.scale.x&&(this.atLimit.x=!0,this.view.x=this.bounds.right*this.scale.x-this.width,this._shake.shakeBounds||(this._shake.x=0)),i<=this.bounds.top*this.scale.y&&(this.atLimit.y=!0,this.view.y=this.bounds.top*this.scale.y,this._shake.shakeBounds||(this._shake.y=0)),n>=this.bounds.bottom*this.scale.y&&(this.atLimit.y=!0,this.view.y=this.bounds.bottom*this.scale.y-this.height,this._shake.shakeBounds||(this._shake.y=0))},setPosition:function(t,e){this.view.x=t,this.view.y=e,this.bounds&&this.checkBounds()},setSize:function(t,e){this.view.width=t,this.view.height=e},reset:function(){this.target=null,this.view.x=0,this.view.y=0,this._shake.duration=0,this.resetFX()},resetFX:function(){this.fx&&(this.fx.clear(),this.fx.alpha=0,this._fxDuration=0)}},U.Camera.prototype.constructor=U.Camera,Object.defineProperty(U.Camera.prototype,"x",{get:function(){return this.view.x},set:function(t){this.view.x=t,this.bounds&&this.checkBounds()}}),Object.defineProperty(U.Camera.prototype,"y",{get:function(){return this.view.y},set:function(t){this.view.y=t,this.bounds&&this.checkBounds()}}),Object.defineProperty(U.Camera.prototype,"position",{get:function(){return this._position.set(this.view.x,this.view.y),this._position},set:function(t){void 0!==t.x&&(this.view.x=t.x),void 0!==t.y&&(this.view.y=t.y),this.bounds&&this.checkBounds()}}),Object.defineProperty(U.Camera.prototype,"width",{get:function(){return this.view.width},set:function(t){this.view.width=t}}),Object.defineProperty(U.Camera.prototype,"height",{get:function(){return this.view.height},set:function(t){this.view.height=t}}),Object.defineProperty(U.Camera.prototype,"shakeIntensity",{get:function(){return this._shake.intensity},set:function(t){this._shake.intensity=t}}),U.State=function(){this.game=null,this.key="",this.add=null,this.make=null,this.camera=null,this.cache=null,this.input=null,this.load=null,this.math=null,this.sound=null,this.scale=null,this.stage=null,this.state=null,this.time=null,this.tweens=null,this.world=null,this.particles=null,this.physics=null,this.rnd=null},U.State.prototype={init:function(){},preload:function(){},loadUpdate:function(){},loadRender:function(){},create:function(){},update:function(){},preRender:function(){},render:function(){},resize:function(){},paused:function(){},resumed:function(){},pauseUpdate:function(){},shutdown:function(){}},U.State.prototype.constructor=U.State,U.StateManager=function(t,e){this.game=t,this.states={},(this._pendingState=null)!=e&&(this._pendingState=e),this._clearWorld=!1,this._clearCache=!1,this._created=!1,this._args=[],this.current="",this.onStateChange=new U.Signal,this.onInitCallback=null,this.onPreloadCallback=null,this.onCreateCallback=null,this.onUpdateCallback=null,this.onRenderCallback=null,this.onResizeCallback=null,this.onPreRenderCallback=null,this.onLoadUpdateCallback=null,this.onLoadRenderCallback=null,this.onPausedCallback=null,this.onResumedCallback=null,this.onPauseUpdateCallback=null,this.onShutDownCallback=null},U.StateManager.prototype={boot:function(){this.game.onPause.add(this.pause,this),this.game.onResume.add(this.resume,this),null!==this._pendingState&&"string"!=typeof this._pendingState&&this.add("default",this._pendingState,!0)},add:function(t,e,i){var n;return void 0===i&&(i=!1),e instanceof U.State?n=e:"object"==typeof e?(n=e).game=this.game:"function"==typeof e&&(n=new e(this.game)),this.states[t]=n,i&&(this.game.isBooted?this.start(t):this._pendingState=t),n},remove:function(t){this.current===t&&(this.callbackContext=null,this.onInitCallback=null,this.onShutDownCallback=null,this.onPreloadCallback=null,this.onLoadRenderCallback=null,this.onLoadUpdateCallback=null,this.onCreateCallback=null,this.onUpdateCallback=null,this.onPreRenderCallback=null,this.onRenderCallback=null,this.onResizeCallback=null,this.onPausedCallback=null,this.onResumedCallback=null,this.onPauseUpdateCallback=null),delete this.states[t]},start:function(t,e,i){void 0===e&&(e=!0),void 0===i&&(i=!1),this.checkState(t)&&(this._pendingState=t,this._clearWorld=e,this._clearCache=i,3<arguments.length&&(this._args=Array.prototype.splice.call(arguments,3)))},restart:function(t,e){void 0===t&&(t=!0),void 0===e&&(e=!1),this._pendingState=this.current,this._clearWorld=t,this._clearCache=e,2<arguments.length&&(this._args=Array.prototype.slice.call(arguments,2))},dummy:function(){},preUpdate:function(){var t;this._pendingState&&this.game.isBooted&&(t=this.current,this.clearCurrentState(),this.setCurrentState(this._pendingState),this.onStateChange.dispatch(this.current,t),this.current===this._pendingState&&(this._pendingState=null,this.onPreloadCallback?(this.game.load.reset(!0),this.onPreloadCallback.call(this.callbackContext,this.game),0===this.game.load.totalQueuedFiles()&&0===this.game.load.totalQueuedPacks()?this.loadComplete():this.game.load.start()):this.loadComplete()))},clearCurrentState:function(){this.current&&(this.onShutDownCallback&&this.onShutDownCallback.call(this.callbackContext,this.game),this.game.tweens.removeAll(),this.game.camera.reset(),this.game.input.reset(!0),this.game.physics.clear(),this.game.time.removeAll(),this.game.scale.reset(this._clearWorld),this.game.debug&&this.game.debug.reset(),this._clearWorld&&(this.game.world.shutdown(),this._clearCache&&this.game.cache.destroy()))},checkState:function(t){return this.states[t]&&!!(this.states[t].preload||this.states[t].create||this.states[t].update||this.states[t].render)||!1},link:function(t){this.states[t].game=this.game,this.states[t].add=this.game.add,this.states[t].make=this.game.make,this.states[t].camera=this.game.camera,this.states[t].cache=this.game.cache,this.states[t].input=this.game.input,this.states[t].load=this.game.load,this.states[t].math=this.game.math,this.states[t].sound=this.game.sound,this.states[t].scale=this.game.scale,(this.states[t].state=this).states[t].stage=this.game.stage,this.states[t].time=this.game.time,this.states[t].tweens=this.game.tweens,this.states[t].world=this.game.world,this.states[t].particles=this.game.particles,this.states[t].rnd=this.game.rnd,this.states[t].physics=this.game.physics,this.states[t].key=t},unlink:function(t){this.states[t]&&(this.states[t].game=null,this.states[t].add=null,this.states[t].make=null,this.states[t].camera=null,this.states[t].cache=null,this.states[t].input=null,this.states[t].load=null,this.states[t].math=null,this.states[t].sound=null,this.states[t].scale=null,this.states[t].state=null,this.states[t].stage=null,this.states[t].time=null,this.states[t].tweens=null,this.states[t].world=null,this.states[t].particles=null,this.states[t].rnd=null,this.states[t].physics=null)},setCurrentState:function(t){this.callbackContext=this.states[t],this.link(t),this.onInitCallback=this.states[t].init||this.dummy,this.onPreloadCallback=this.states[t].preload||null,this.onLoadRenderCallback=this.states[t].loadRender||null,this.onLoadUpdateCallback=this.states[t].loadUpdate||null,this.onCreateCallback=this.states[t].create||null,this.onUpdateCallback=this.states[t].update||null,this.onPreRenderCallback=this.states[t].preRender||null,this.onRenderCallback=this.states[t].render||null,this.onResizeCallback=this.states[t].resize||null,this.onPausedCallback=this.states[t].paused||null,this.onResumedCallback=this.states[t].resumed||null,this.onPauseUpdateCallback=this.states[t].pauseUpdate||null,this.onShutDownCallback=this.states[t].shutdown||this.dummy,""!==this.current&&this.game.physics.reset(),this.current=t,this._created=!1,this.onInitCallback.apply(this.callbackContext,this._args),t===this._pendingState&&(this._args=[]),this.game._kickstart=!0},getCurrentState:function(){return this.states[this.current]},loadComplete:function(){!1===this._created&&this.onLoadUpdateCallback&&this.onLoadUpdateCallback.call(this.callbackContext,this.game),!1===this._created&&this.onCreateCallback?(this._created=!0,this.onCreateCallback.call(this.callbackContext,this.game)):this._created=!0},pause:function(){this._created&&this.onPausedCallback&&this.onPausedCallback.call(this.callbackContext,this.game)},resume:function(){this._created&&this.onResumedCallback&&this.onResumedCallback.call(this.callbackContext,this.game)},update:function(){this._created?this.onUpdateCallback&&this.onUpdateCallback.call(this.callbackContext,this.game):this.onLoadUpdateCallback&&this.onLoadUpdateCallback.call(this.callbackContext,this.game)},pauseUpdate:function(){this._created?this.onPauseUpdateCallback&&this.onPauseUpdateCallback.call(this.callbackContext,this.game):this.onLoadUpdateCallback&&this.onLoadUpdateCallback.call(this.callbackContext,this.game)},preRender:function(t){this._created&&this.onPreRenderCallback&&this.onPreRenderCallback.call(this.callbackContext,this.game,t)},resize:function(t,e){this.onResizeCallback&&this.onResizeCallback.call(this.callbackContext,t,e)},render:function(){this._created?this.onRenderCallback&&(this.game.renderType===U.CANVAS?(this.game.context.save(),this.game.context.setTransform(1,0,0,1,0,0),this.onRenderCallback.call(this.callbackContext,this.game),this.game.context.restore()):this.onRenderCallback.call(this.callbackContext,this.game)):this.onLoadRenderCallback&&this.onLoadRenderCallback.call(this.callbackContext,this.game)},destroy:function(){this._clearWorld=!0,this._clearCache=!0,this.clearCurrentState(),this.callbackContext=null,this.onInitCallback=null,this.onShutDownCallback=null,this.onPreloadCallback=null,this.onLoadRenderCallback=null,this.onLoadUpdateCallback=null,this.onCreateCallback=null,this.onUpdateCallback=null,this.onRenderCallback=null,this.onPausedCallback=null,this.onResumedCallback=null,this.onPauseUpdateCallback=null,this.game=null,this.states={},this._pendingState=null,this.current=""}},U.StateManager.prototype.constructor=U.StateManager,Object.defineProperty(U.StateManager.prototype,"created",{get:function(){return this._created}}),U.Signal=function(){},U.Signal.prototype={_bindings:null,_prevParams:null,memorize:!1,_shouldPropagate:!0,active:!0,_boundDispatch:!1,validateListener:function(t,e){if("function"!=typeof t)throw new Error("Phaser.Signal: listener is a required param of {fn}() and should be a Function.".replace("{fn}",e))},_registerListener:function(t,e,i,n,r){var o,s=this._indexOfListener(t,i);if(-1!==s){if((o=this._bindings[s]).isOnce()!==e)throw new Error("You cannot add"+(e?"":"Once")+"() then add"+(e?"Once":"")+"() the same listener without removing the relationship first.")}else o=new U.SignalBinding(this,t,e,i,n,r),this._addBinding(o);return this.memorize&&this._prevParams&&o.execute(this._prevParams),o},_addBinding:function(t){this._bindings||(this._bindings=[]);for(var e=this._bindings.length;this._bindings[--e]&&t._priority<=this._bindings[e]._priority;);this._bindings.splice(e+1,0,t)},_indexOfListener:function(t,e){if(!this._bindings)return-1;void 0===e&&(e=null);for(var i,n=this._bindings.length;n--;)if((i=this._bindings[n])._listener===t&&i.context===e)return n;return-1},has:function(t,e){return-1!==this._indexOfListener(t,e)},add:function(t,e,i){this.validateListener(t,"add");var n=[];if(3<arguments.length)for(var r=3;r<arguments.length;r++)n.push(arguments[r]);return this._registerListener(t,!1,e,i,n)},addOnce:function(t,e,i){this.validateListener(t,"addOnce");var n=[];if(3<arguments.length)for(var r=3;r<arguments.length;r++)n.push(arguments[r]);return this._registerListener(t,!0,e,i,n)},remove:function(t,e){this.validateListener(t,"remove");e=this._indexOfListener(t,e);return-1!==e&&(this._bindings[e]._destroy(),this._bindings.splice(e,1)),t},removeAll:function(t){if(void 0===t&&(t=null),this._bindings){for(var e=this._bindings.length;e--;)t?this._bindings[e].context===t&&(this._bindings[e]._destroy(),this._bindings.splice(e,1)):this._bindings[e]._destroy();t||(this._bindings.length=0)}},getNumListeners:function(){return this._bindings?this._bindings.length:0},halt:function(){this._shouldPropagate=!1},dispatch:function(){if(this.active&&this._bindings){var t,e=Array.prototype.slice.call(arguments),i=this._bindings.length;if(this.memorize&&(this._prevParams=e),i)for(t=this._bindings.slice(),this._shouldPropagate=!0;t[--i]&&this._shouldPropagate&&!1!==t[i].execute(e););}},forget:function(){this._prevParams&&(this._prevParams=null)},dispose:function(){this.removeAll(),this._bindings=null,this._prevParams&&(this._prevParams=null)},toString:function(){return"[Phaser.Signal active:"+this.active+" numListeners:"+this.getNumListeners()+"]"}},Object.defineProperty(U.Signal.prototype,"boundDispatch",{get:function(){var t=this;return this._boundDispatch||(this._boundDispatch=function(){return t.dispatch.apply(t,arguments)})}}),U.Signal.prototype.constructor=U.Signal,U.SignalBinding=function(t,e,i,n,r,o){this._listener=e,i&&(this._isOnce=!0),null!=n&&(this.context=n),this._signal=t,r&&(this._priority=r),o&&o.length&&(this._args=o)},U.SignalBinding.prototype={context:null,_isOnce:!1,_priority:0,_args:null,callCount:0,active:!0,params:null,execute:function(t){var e;return this.active&&this._listener&&(e=this.params?this.params.concat(t):t,this._args&&(e=e.concat(this._args)),e=this._listener.apply(this.context,e),this.callCount++,this._isOnce&&this.detach()),e},detach:function(){return this.isBound()?this._signal.remove(this._listener,this.context):null},isBound:function(){return!!this._signal&&!!this._listener},isOnce:function(){return this._isOnce},getListener:function(){return this._listener},getSignal:function(){return this._signal},_destroy:function(){delete this._signal,delete this._listener,delete this.context},toString:function(){return"[Phaser.SignalBinding isOnce:"+this._isOnce+", isBound:"+this.isBound()+", active:"+this.active+"]"}},U.SignalBinding.prototype.constructor=U.SignalBinding,U.Filter=function(t,e,i){this.game=t,this.type=U.WEBGL_FILTER,this.passes=[this],this.shaders=[],this.dirty=!0,this.padding=0,this.prevPoint=new U.Point;t=new Date;if(this.uniforms={resolution:{type:"2f",value:{x:256,y:256}},time:{type:"1f",value:0},mouse:{type:"2f",value:{x:0,y:0}},date:{type:"4fv",value:[t.getFullYear(),t.getMonth(),t.getDate(),60*t.getHours()*60+60*t.getMinutes()+t.getSeconds()]},sampleRate:{type:"1f",value:44100},iChannel0:{type:"sampler2D",value:null,textureData:{repeat:!0}},iChannel1:{type:"sampler2D",value:null,textureData:{repeat:!0}},iChannel2:{type:"sampler2D",value:null,textureData:{repeat:!0}},iChannel3:{type:"sampler2D",value:null,textureData:{repeat:!0}}},e)for(var n in e)this.uniforms[n]=e[n];this.fragmentSrc=i||""},U.Filter.prototype={init:function(){},setResolution:function(t,e){this.uniforms.resolution.value.x=t,this.uniforms.resolution.value.y=e},update:function(t){var e;void 0!==t&&(e=t.x/this.game.width,t=1-t.y/this.game.height,e===this.prevPoint.x&&t===this.prevPoint.y||(this.uniforms.mouse.value.x=e.toFixed(2),this.uniforms.mouse.value.y=t.toFixed(2),this.prevPoint.set(e,t))),this.uniforms.time.value=this.game.time.totalElapsedSeconds()},addToWorld:function(t,e,i,n,r,o){void 0===r&&(r=0),void 0===o&&(o=0),null!=i?this.width=i:i=this.width,null!=n?this.height=n:n=this.height;e=this.game.add.image(t,e,"__default");return e.width=i,e.height=n,e.anchor.set(r,o),e.filters=[this],e},destroy:function(){this.game=null}},U.Filter.prototype.constructor=U.Filter,Object.defineProperty(U.Filter.prototype,"width",{get:function(){return this.uniforms.resolution.value.x},set:function(t){this.uniforms.resolution.value.x=t}}),Object.defineProperty(U.Filter.prototype,"height",{get:function(){return this.uniforms.resolution.value.y},set:function(t){this.uniforms.resolution.value.y=t}}),U.Plugin=function(t,e){void 0===e&&(e=null),this.game=t,this.parent=e,this.active=!1,this.visible=!1,this.hasPreUpdate=!1,this.hasUpdate=!1,this.hasPostUpdate=!1,this.hasRender=!1,this.hasPostRender=!1},U.Plugin.prototype={preUpdate:function(){},update:function(){},render:function(){},postRender:function(){},destroy:function(){this.game=null,this.parent=null,this.active=!1,this.visible=!1}},U.Plugin.prototype.constructor=U.Plugin,U.PluginManager=function(t){this.game=t,this.plugins=[],this._len=0,this._i=0},U.PluginManager.prototype={add:function(t){var e=Array.prototype.slice.call(arguments,1),i=!1;return"function"==typeof t?t=new t(this.game,this):(t.game=this.game,t.parent=this),"function"==typeof t.preUpdate&&(i=t.hasPreUpdate=!0),"function"==typeof t.update&&(i=t.hasUpdate=!0),"function"==typeof t.postUpdate&&(i=t.hasPostUpdate=!0),"function"==typeof t.render&&(i=t.hasRender=!0),(i="function"==typeof t.postRender?t.hasPostRender=!0:i)?((t.hasPreUpdate||t.hasUpdate||t.hasPostUpdate)&&(t.active=!0),(t.hasRender||t.hasPostRender)&&(t.visible=!0),this._len=this.plugins.push(t),"function"==typeof t.init&&t.init.apply(t,e),t):null},remove:function(t,e){for(void 0===e&&(e=!0),this._i=this._len;this._i--;)if(this.plugins[this._i]===t)return e&&t.destroy(),this.plugins.splice(this._i,1),void this._len--},removeAll:function(){for(this._i=this._len;this._i--;)this.plugins[this._i].destroy();this.plugins.length=0,this._len=0},preUpdate:function(){for(this._i=this._len;this._i--;)this.plugins[this._i].active&&this.plugins[this._i].hasPreUpdate&&this.plugins[this._i].preUpdate()},update:function(){for(this._i=this._len;this._i--;)this.plugins[this._i].active&&this.plugins[this._i].hasUpdate&&this.plugins[this._i].update()},postUpdate:function(){for(this._i=this._len;this._i--;)this.plugins[this._i].active&&this.plugins[this._i].hasPostUpdate&&this.plugins[this._i].postUpdate()},render:function(){for(this._i=this._len;this._i--;)this.plugins[this._i].visible&&this.plugins[this._i].hasRender&&this.plugins[this._i].render()},postRender:function(){for(this._i=this._len;this._i--;)this.plugins[this._i].visible&&this.plugins[this._i].hasPostRender&&this.plugins[this._i].postRender()},destroy:function(){this.removeAll(),this.game=null}},U.PluginManager.prototype.constructor=U.PluginManager,U.Stage=function(t){this.game=t,PIXI.DisplayObjectContainer.call(this),this.name="_stage_root",this.disableVisibilityChange=!1,this.exists=!0,this.worldTransform=new PIXI.Matrix,(this.stage=this).currentRenderOrderID=0,this._hiddenVar="hidden",this._onChange=null,this._bgColor={r:0,g:0,b:0,a:0,color:0,rgba:"#000000"},this.game.transparent||(this._bgColor.a=1),t.config&&this.parseConfig(t.config)},U.Stage.prototype=Object.create(PIXI.DisplayObjectContainer.prototype),U.Stage.prototype.constructor=U.Stage,U.Stage.prototype.parseConfig=function(t){t.disableVisibilityChange&&(this.disableVisibilityChange=t.disableVisibilityChange),t.backgroundColor&&this.setBackgroundColor(t.backgroundColor)},U.Stage.prototype.boot=function(){U.DOM.getOffset(this.game.canvas,this.offset),U.Canvas.setUserSelect(this.game.canvas,"none"),U.Canvas.setTouchAction(this.game.canvas,"none"),this.checkVisibility()},U.Stage.prototype.preUpdate=function(){for(var t=this.currentRenderOrderID=0;t<this.children.length;){var e=this.children[t];e.preUpdate(),this===e.parent&&t++}},U.Stage.prototype.update=function(){for(var t=this.children.length;t--;)this.children[t].update()},U.Stage.prototype.postUpdate=function(){this.game.camera.update(),this.game.camera.target&&(this.game.camera.target.postUpdate(),this.updateTransform(),this.game.camera.updateTarget());for(var t=0;t<this.children.length;t++)this.children[t].postUpdate();this.updateTransform()},U.Stage.prototype.updateTransform=function(){this.worldAlpha=1;for(var t=0;t<this.children.length;t++)this.children[t].updateTransform()},U.Stage.prototype.checkVisibility=function(){void 0!==document.hidden?this._hiddenVar="visibilitychange":void 0!==document.webkitHidden?this._hiddenVar="webkitvisibilitychange":void 0!==document.mozHidden?this._hiddenVar="mozvisibilitychange":void 0!==document.msHidden?this._hiddenVar="msvisibilitychange":this._hiddenVar=null;var e=this;this._onChange=function(t){return e.visibilityChange(t)},this._onClick=function(t){document.hasFocus()||e.visibilityChange(t)},this._hiddenVar&&document.addEventListener(this._hiddenVar,this._onChange,!1),window.onblur=this._onChange,window.onfocus=this._onChange,window.onpagehide=this._onChange,window.onpageshow=this._onChange,window.addEventListener("click",this._onClick),this.game.device.cocoonJSApp&&(CocoonJS.App.onSuspended.addEventListener(function(){U.Stage.prototype.visibilityChange.call(e,{type:"pause"})}),CocoonJS.App.onActivated.addEventListener(function(){U.Stage.prototype.visibilityChange.call(e,{type:"resume"})}))},U.Stage.prototype.visibilityChange=function(t){switch(t.type){case"blur":case"pagehide":return void this.game.focusLoss(t);case"click":case"focus":case"pageshow":return void this.game.focusGain(t)}this.disableVisibilityChange||(document.hidden||document.mozHidden||document.msHidden||document.webkitHidden||"pause"===t.type?this.game.gamePaused(t):this.game.gameResumed(t))},U.Stage.prototype.setBackgroundColor=function(t){this.game.transparent||(U.Color.valueToColor(t,this._bgColor),U.Color.updateColor(this._bgColor),this._bgColor.r/=255,this._bgColor.g/=255,this._bgColor.b/=255,this._bgColor.a=1)},U.Stage.prototype.destroy=function(){this._hiddenVar&&document.removeEventListener(this._hiddenVar,this._onChange,!1),window.onpagehide=null,window.onpageshow=null,window.onblur=null,window.onfocus=null,window.removeEventListener("click",this._onClick)},Object.defineProperty(U.Stage.prototype,"backgroundColor",{get:function(){return this._bgColor.color},set:function(t){this.setBackgroundColor(t)}}),Object.defineProperty(U.Stage.prototype,"smoothed",{get:function(){return PIXI.scaleModes.DEFAULT===PIXI.scaleModes.LINEAR},set:function(t){PIXI.scaleModes.DEFAULT=t?PIXI.scaleModes.LINEAR:PIXI.scaleModes.NEAREST}}),U.Group=function(t,e,i,n,r,o){void 0===n&&(n=!1),void 0===r&&(r=!1),void 0===o&&(o=U.Physics.ARCADE),this.game=t,void 0===e&&(e=t.world),this.name=i||"group",this.z=0,PIXI.DisplayObjectContainer.call(this),n?(this.game.stage.addChild(this),this.z=this.game.stage.children.length):e&&(e.addChild(this),this.z=e.children.length),this.type=U.GROUP,this.physicsType=U.GROUP,this.alive=!0,this.exists=!0,this.ignoreDestroy=!1,this.pendingDestroy=!1,this.classType=U.Sprite,this.cursor=null,this.inputEnableChildren=!1,this.onChildInputDown=new U.Signal,this.onChildInputUp=new U.Signal,this.onChildInputOver=new U.Signal,this.onChildInputOut=new U.Signal,this.enableBody=r,this.enableBodyDebug=!1,this.physicsBodyType=o,this.physicsSortDirection=null,this.onDestroy=new U.Signal,this.cursorIndex=0,this.fixedToCamera=!1,this.cameraOffset=new U.Point,this.hash=[],this._sortProperty="z"},U.Group.prototype=Object.create(PIXI.DisplayObjectContainer.prototype),U.Group.prototype.constructor=U.Group,U.Group.RETURN_NONE=0,U.Group.RETURN_TOTAL=1,U.Group.RETURN_CHILD=2,U.Group.RETURN_ALL=3,U.Group.SORT_ASCENDING=-1,U.Group.SORT_DESCENDING=1,U.Group.prototype.add=function(t,e,i){return void 0===e&&(e=!1),t.parent===this||(t.body&&t.parent&&t.parent.hash&&t.parent.removeFromHash(t),void 0===i?(t.z=this.children.length,this.addChild(t)):(this.addChildAt(t,i),this.updateZ()),this.enableBody&&t.hasOwnProperty("body")&&null===t.body?this.game.physics.enable(t,this.physicsBodyType):t.body&&this.addToHash(t),!this.inputEnableChildren||t.input&&!t.inputEnabled||(t.inputEnabled=!0),!e&&t.events&&t.events.onAddedToGroup$dispatch(t,this),null===this.cursor&&(this.cursor=t)),t},U.Group.prototype.addAt=function(t,e,i){this.add(t,i,e)},U.Group.prototype.addToHash=function(t){return t.parent===this&&-1===this.hash.indexOf(t)&&(this.hash.push(t),!0)},U.Group.prototype.removeFromHash=function(t){if(t){t=this.hash.indexOf(t);if(-1!==t)return this.hash.splice(t,1),!0}return!1},U.Group.prototype.addMultiple=function(t,e){if(t instanceof U.Group)t.moveAll(this,e);else if(Array.isArray(t))for(var i=0;i<t.length;i++)this.add(t[i],e);return t},U.Group.prototype.getAt=function(t){return t<0||t>=this.children.length?-1:this.getChildAt(t)},U.Group.prototype.create=function(t,e,i,n,r,o){void 0===r&&(r=!0);n=new this.classType(this.game,t,e,i,n);return n.exists=r,n.visible=r,n.alive=r,this.add(n,!1,o)},U.Group.prototype.createMultiple=function(n,t,e,r){void 0===e&&(e=0),void 0===r&&(r=!1),Array.isArray(t)||(t=[t]),Array.isArray(e)||(e=[e]);var o=this,s=[];return t.forEach(function(i){e.forEach(function(t){for(var e=0;e<n;e++)s.push(o.create(0,0,i,t,r))})}),s},U.Group.prototype.updateZ=function(){for(var t=this.children.length;t--;)this.children[t].z=t},U.Group.prototype.align=function(t,e,i,n,r,o){if(void 0===r&&(r=U.TOP_LEFT),void 0===o&&(o=0),0===this.children.length||o>this.children.length||-1===t&&-1===e)return!1;for(var s=new U.Rectangle(0,0,i,n),a=t*i,h=e*n,l=o;l<this.children.length;l++){var p=this.children[l];if(p.alignIn)if(p.alignIn(s,r),-1===t)s.y+=n,s.y===h&&(s.x+=i,s.y=0);else if(-1===e)s.x+=i,s.x===a&&(s.x=0,s.y+=n);else if(s.x+=i,s.x===a&&(s.x=0,s.y+=n,s.y===h))return!0}return!0},U.Group.prototype.resetCursor=function(t){if((t=void 0===t?0:t)>this.children.length-1&&(t=0),this.cursor)return this.cursorIndex=t,this.cursor=this.children[this.cursorIndex],this.cursor},U.Group.prototype.next=function(){if(this.cursor)return this.cursorIndex>=this.children.length-1?this.cursorIndex=0:this.cursorIndex++,this.cursor=this.children[this.cursorIndex],this.cursor},U.Group.prototype.previous=function(){if(this.cursor)return 0===this.cursorIndex?this.cursorIndex=this.children.length-1:this.cursorIndex--,this.cursor=this.children[this.cursorIndex],this.cursor},U.Group.prototype.swap=function(t,e){this.swapChildren(t,e),this.updateZ()},U.Group.prototype.bringToTop=function(t){return t.parent===this&&this.getIndex(t)<this.children.length&&(this.remove(t,!1,!0),this.add(t,!0)),t},U.Group.prototype.sendToBack=function(t){return t.parent===this&&0<this.getIndex(t)&&(this.remove(t,!1,!0),this.addAt(t,0,!0)),t},U.Group.prototype.moveUp=function(t){var e;return t.parent===this&&this.getIndex(t)<this.children.length-1&&(e=this.getIndex(t),(e=this.getAt(e+1))&&this.swap(t,e)),t},U.Group.prototype.moveDown=function(t){var e;return t.parent===this&&0<this.getIndex(t)&&(e=this.getIndex(t),(e=this.getAt(e-1))&&this.swap(t,e)),t},U.Group.prototype.xy=function(t,e,i){if(t<0||t>this.children.length)return-1;this.getChildAt(t).x=e,this.getChildAt(t).y=i},U.Group.prototype.reverse=function(){this.children.reverse(),this.updateZ()},U.Group.prototype.getIndex=function(t){return this.children.indexOf(t)},U.Group.prototype.getByName=function(t){for(var e=0;e<this.children.length;e++)if(this.children[e].name===t)return this.children[e];return null},U.Group.prototype.replace=function(t,e){var i=this.getIndex(t);if(-1!==i)return e.parent&&(e.parent instanceof U.Group?e.parent.remove(e):e.parent.removeChild(e)),this.remove(t),this.addAt(e,i),t},U.Group.prototype.hasProperty=function(t,e){var i=e.length;return 1===i&&e[0]in t||2===i&&e[0]in t&&e[1]in t[e[0]]||3===i&&e[0]in t&&e[1]in t[e[0]]&&e[2]in t[e[0]][e[1]]||4===i&&e[0]in t&&e[1]in t[e[0]]&&e[2]in t[e[0]][e[1]]&&e[3]in t[e[0]][e[1]][e[2]]},U.Group.prototype.setProperty=function(t,e,i,n,r){if(void 0===r&&(r=!1),n=n||0,!this.hasProperty(t,e)&&(!r||0<n))return!1;r=e.length;return 1===r?0===n?t[e[0]]=i:1===n?t[e[0]]+=i:2===n?t[e[0]]-=i:3===n?t[e[0]]*=i:4===n&&(t[e[0]]/=i):2===r?0===n?t[e[0]][e[1]]=i:1===n?t[e[0]][e[1]]+=i:2===n?t[e[0]][e[1]]-=i:3===n?t[e[0]][e[1]]*=i:4===n&&(t[e[0]][e[1]]/=i):3===r?0===n?t[e[0]][e[1]][e[2]]=i:1===n?t[e[0]][e[1]][e[2]]+=i:2===n?t[e[0]][e[1]][e[2]]-=i:3===n?t[e[0]][e[1]][e[2]]*=i:4===n&&(t[e[0]][e[1]][e[2]]/=i):4===r&&(0===n?t[e[0]][e[1]][e[2]][e[3]]=i:1===n?t[e[0]][e[1]][e[2]][e[3]]+=i:2===n?t[e[0]][e[1]][e[2]][e[3]]-=i:3===n?t[e[0]][e[1]][e[2]][e[3]]*=i:4===n&&(t[e[0]][e[1]][e[2]][e[3]]/=i)),!0},U.Group.prototype.checkProperty=function(t,e,i,n){return void 0===n&&(n=!1),!(!U.Utils.getProperty(t,e)&&n)&&U.Utils.getProperty(t,e)===i},U.Group.prototype.set=function(t,e,i,n,r,o,s){if(void 0===s&&(s=!1),e=e.split("."),void 0===r&&(r=!1),(!1===(n=void 0===n?!1:n)||n&&t.alive)&&(!1===r||r&&t.visible))return this.setProperty(t,e,i,o,s)},U.Group.prototype.setAll=function(t,e,i,n,r,o){void 0===i&&(i=!1),void 0===n&&(n=!1),void 0===o&&(o=!1),t=t.split("."),r=r||0;for(var s=0;s<this.children.length;s++)i&&!this.children[s].alive||n&&!this.children[s].visible||this.setProperty(this.children[s],t,e,r,o)},U.Group.prototype.setAllChildren=function(t,e,i,n,r,o){void 0===i&&(i=!1),void 0===n&&(n=!1),void 0===o&&(o=!1),r=r||0;for(var s=0;s<this.children.length;s++)i&&!this.children[s].alive||n&&!this.children[s].visible||(this.children[s]instanceof U.Group?this.children[s].setAllChildren(t,e,i,n,r,o):this.setProperty(this.children[s],t.split("."),e,r,o))},U.Group.prototype.checkAll=function(t,e,i,n,r){void 0===i&&(i=!1),void 0===n&&(n=!1),void 0===r&&(r=!1);for(var o=0;o<this.children.length;o++)if((!i||this.children[o].alive)&&(!n||this.children[o].visible)&&!this.checkProperty(this.children[o],t,e,r))return!1;return!0},U.Group.prototype.addAll=function(t,e,i,n){this.setAll(t,e,i,n,1)},U.Group.prototype.subAll=function(t,e,i,n){this.setAll(t,e,i,n,2)},U.Group.prototype.multiplyAll=function(t,e,i,n){this.setAll(t,e,i,n,3)},U.Group.prototype.divideAll=function(t,e,i,n){this.setAll(t,e,i,n,4)},U.Group.prototype.callAllExists=function(t,e){if(2<arguments.length)for(var i=[],n=2;n<arguments.length;n++)i.push(arguments[n]);for(n=0;n<this.children.length;n++)this.children[n].exists===e&&this.children[n][t]&&this.children[n][t].apply(this.children[n],i)},U.Group.prototype.callbackFromArray=function(t,e,i){if(1===i){if(t[e[0]])return t[e[0]]}else if(2===i){if(t[e[0]][e[1]])return t[e[0]][e[1]]}else if(3===i){if(t[e[0]][e[1]][e[2]])return t[e[0]][e[1]][e[2]]}else if(4===i){if(t[e[0]][e[1]][e[2]][e[3]])return t[e[0]][e[1]][e[2]][e[3]]}else if(t[e])return t[e];return!1},U.Group.prototype.callAll=function(t,e){if(void 0!==t){var i,n=(t=t.split(".")).length;if(null==e||""===e?e=null:"string"==typeof e&&(i=(e=e.split(".")).length),2<arguments.length)for(var r=[],o=2;o<arguments.length;o++)r.push(arguments[o]);for(var s,a=null,o=0;o<this.children.length;o++)a=this.callbackFromArray(this.children[o],t,n),e&&a?(s=this.callbackFromArray(this.children[o],e,i),a&&a.apply(s,r)):a&&a.apply(this.children[o],r)}},U.Group.prototype.preUpdate=function(){if(this.pendingDestroy)return this.destroy(),!1;if(!this.exists||!this.parent.exists)return!(this.renderOrderID=-1);for(var t=0;t<this.children.length;t++)this.children[t].preUpdate();return!0},U.Group.prototype.update=function(){for(var t=this.children.length;t--;)this.children[t].update()},U.Group.prototype.postUpdate=function(){this.fixedToCamera&&(this.x=this.game.camera.view.x+this.cameraOffset.x,this.y=this.game.camera.view.y+this.cameraOffset.y);for(var t=0;t<this.children.length;t++)this.children[t].postUpdate()},U.Group.prototype.filter=function(t,e){for(var i=-1,n=this.children.length,r=[];++i<n;){var o=this.children[i];e&&!o.exists||!t(o,i,this.children)||r.push(o)}return new U.ArraySet(r)},U.Group.prototype.forEach=function(t,e,i){if(void 0===i&&(i=!1),arguments.length<=3)for(var n=0;n<this.children.length;n++)i&&!this.children[n].exists||t.call(e,this.children[n]);else{for(var r=[null],n=3;n<arguments.length;n++)r.push(arguments[n]);for(n=0;n<this.children.length;n++)i&&!this.children[n].exists||(r[0]=this.children[n],t.apply(e,r))}},U.Group.prototype.forEachExists=function(t,e){if(2<arguments.length)for(var i=[null],n=2;n<arguments.length;n++)i.push(arguments[n]);this.iterate("exists",!0,U.Group.RETURN_TOTAL,t,e,i)},U.Group.prototype.forEachAlive=function(t,e){if(2<arguments.length)for(var i=[null],n=2;n<arguments.length;n++)i.push(arguments[n]);this.iterate("alive",!0,U.Group.RETURN_TOTAL,t,e,i)},U.Group.prototype.forEachDead=function(t,e){if(2<arguments.length)for(var i=[null],n=2;n<arguments.length;n++)i.push(arguments[n]);this.iterate("alive",!1,U.Group.RETURN_TOTAL,t,e,i)},U.Group.prototype.sort=function(t,e){this.children.length<2||(void 0===e&&(e=U.Group.SORT_ASCENDING),this._sortProperty=t=void 0===t?"z":t,e===U.Group.SORT_ASCENDING?this.children.sort(this.ascendingSortHandler.bind(this)):this.children.sort(this.descendingSortHandler.bind(this)),this.updateZ())},U.Group.prototype.customSort=function(t,e){this.children.length<2||(this.children.sort(t.bind(e)),this.updateZ())},U.Group.prototype.ascendingSortHandler=function(t,e){return t[this._sortProperty]<e[this._sortProperty]||!(t[this._sortProperty]>e[this._sortProperty])&&t.z<e.z?-1:1},U.Group.prototype.descendingSortHandler=function(t,e){return t[this._sortProperty]<e[this._sortProperty]?1:t[this._sortProperty]>e[this._sortProperty]?-1:0},U.Group.prototype.iterate=function(t,e,i,n,r,o){if(0===this.children.length){if(i===U.Group.RETURN_TOTAL)return 0;if(i===U.Group.RETURN_ALL)return[]}var s,a=0;i===U.Group.RETURN_ALL&&(s=[]);for(var h=0;h<this.children.length;h++)if(this.children[h][t]===e){if(a++,n&&(o?(o[0]=this.children[h],n.apply(r,o)):n.call(r,this.children[h])),i===U.Group.RETURN_CHILD)return this.children[h];i===U.Group.RETURN_ALL&&s.push(this.children[h])}return i===U.Group.RETURN_TOTAL?a:i===U.Group.RETURN_ALL?s:null},U.Group.prototype.getFirstExists=function(t,e,i,n,r,o){void 0===e&&(e=!1);t=this.iterate("exists",t="boolean"!=typeof t?!0:t,U.Group.RETURN_CHILD);return null===t&&e?this.create(i,n,r,o):this.resetChild(t,i,n,r,o)},U.Group.prototype.getFirstAlive=function(t,e,i,n,r){void 0===t&&(t=!1);var o=this.iterate("alive",!0,U.Group.RETURN_CHILD);return null===o&&t?this.create(e,i,n,r):this.resetChild(o,e,i,n,r)},U.Group.prototype.getFirstDead=function(t,e,i,n,r){void 0===t&&(t=!1);var o=this.iterate("alive",!1,U.Group.RETURN_CHILD);return null===o&&t?this.create(e,i,n,r):this.resetChild(o,e,i,n,r)},U.Group.prototype.resetChild=function(t,e,i,n,r){return null===t?null:(void 0===i&&(i=null),null!==(e=void 0===e?null:e)&&null!==i&&t.reset(e,i),void 0!==n&&t.loadTexture(n,r),t)},U.Group.prototype.getTop=function(){if(0<this.children.length)return this.children[this.children.length-1]},U.Group.prototype.getBottom=function(){if(0<this.children.length)return this.children[0]},U.Group.prototype.getClosestTo=function(t,e,i){for(var n=Number.MAX_VALUE,r=0,o=null,s=0;s<this.children.length;s++){var a=this.children[s];a.exists&&(r=Math.abs(U.Point.distance(t,a)))<n&&(!e||e.call(i,a,r))&&(n=r,o=a)}return o},U.Group.prototype.getFurthestFrom=function(t,e,i){for(var n=0,r=0,o=null,s=0;s<this.children.length;s++){var a=this.children[s];a.exists&&(r=Math.abs(U.Point.distance(t,a)))>n&&(!e||e.call(i,a,r))&&(n=r,o=a)}return o},U.Group.prototype.countLiving=function(){return this.iterate("alive",!0,U.Group.RETURN_TOTAL)},U.Group.prototype.countDead=function(){return this.iterate("alive",!1,U.Group.RETURN_TOTAL)},U.Group.prototype.getRandom=function(t,e){return void 0===t&&(t=0),0===(e=void 0===e?this.children.length:e)?null:U.ArrayUtils.getRandomItem(this.children,t,e)},U.Group.prototype.getRandomExists=function(t,e){e=this.getAll("exists",!0,t,e);return this.game.rnd.pick(e)},U.Group.prototype.getAll=function(t,e,i,n){void 0===n&&(n=this.children.length);for(var r=[],o=i=void 0===i?0:i;o<n;o++){var s=this.children[o];t&&s[t]===e&&r.push(s)}return r},U.Group.prototype.remove=function(t,e,i){if(void 0===e&&(e=!1),void 0===i&&(i=!1),0===this.children.length||-1===this.children.indexOf(t))return!1;i||!t.events||t.destroyPhase||t.events.onRemovedFromGroup$dispatch(t,this);i=this.removeChild(t);return this.removeFromHash(t),this.updateZ(),this.cursor===t&&this.next(),e&&i&&i.destroy(!0),!0},U.Group.prototype.moveAll=function(t,e){if(void 0===e&&(e=!1),0<this.children.length&&t instanceof U.Group){for(;t.add(this.children[0],e),0<this.children.length;);this.hash=[],this.cursor=null}return t},U.Group.prototype.removeAll=function(t,e,i){if(void 0===t&&(t=!1),void 0===e&&(e=!1),void 0===i&&(i=!1),0!==this.children.length){do{!e&&this.children[0].events&&this.children[0].events.onRemovedFromGroup$dispatch(this.children[0],this);var n=this.removeChild(this.children[0])}while(this.removeFromHash(n),t&&n&&n.destroy(!0,i),0<this.children.length);this.hash=[],this.cursor=null}},U.Group.prototype.removeBetween=function(t,e,i,n){if(void 0===e&&(e=this.children.length-1),void 0===i&&(i=!1),void 0===n&&(n=!1),0!==this.children.length){if(e<t||t<0||e>this.children.length)return!1;for(var r=e;t<=r;){!n&&this.children[r].events&&this.children[r].events.onRemovedFromGroup$dispatch(this.children[r],this);var o=this.removeChild(this.children[r]);this.removeFromHash(o),i&&o&&o.destroy(!0),this.cursor===this.children[r]&&(this.cursor=null),r--}this.updateZ()}},U.Group.prototype.destroy=function(t,e){null===this.game||this.ignoreDestroy||(this.onDestroy.dispatch(this,t=void 0===t?!0:t,e=void 0===e?!1:e),this.removeAll(t),this.cursor=null,this.filters=null,this.pendingDestroy=!1,e||(this.parent&&this.parent.removeChild(this),this.game=null,this.exists=!1))},Object.defineProperty(U.Group.prototype,"total",{get:function(){return this.iterate("exists",!0,U.Group.RETURN_TOTAL)}}),Object.defineProperty(U.Group.prototype,"length",{get:function(){return this.children.length}}),Object.defineProperty(U.Group.prototype,"angle",{get:function(){return U.Math.radToDeg(this.rotation)},set:function(t){this.rotation=U.Math.degToRad(t)}}),Object.defineProperty(U.Group.prototype,"centerX",{get:function(){return this.getBounds(this.parent).centerX},set:function(t){var e=this.getBounds(this.parent),i=this.x-e.x;this.x=t+i-e.halfWidth}}),Object.defineProperty(U.Group.prototype,"centerY",{get:function(){return this.getBounds(this.parent).centerY},set:function(t){var e=this.getBounds(this.parent),i=this.y-e.y;this.y=t+i-e.halfHeight}}),Object.defineProperty(U.Group.prototype,"left",{get:function(){return this.getBounds(this.parent).left},set:function(t){var e=this.getBounds(this.parent),e=this.x-e.x;this.x=t+e}}),Object.defineProperty(U.Group.prototype,"right",{get:function(){return this.getBounds(this.parent).right},set:function(t){var e=this.getBounds(this.parent),i=this.x-e.x;this.x=t+i-e.width}}),Object.defineProperty(U.Group.prototype,"top",{get:function(){return this.getBounds(this.parent).top},set:function(t){var e=this.getBounds(this.parent),e=this.y-e.y;this.y=t+e}}),Object.defineProperty(U.Group.prototype,"bottom",{get:function(){return this.getBounds(this.parent).bottom},set:function(t){var e=this.getBounds(this.parent),i=this.y-e.y;this.y=t+i-e.height}}),U.World=function(t){U.Group.call(this,t,null,"__world",!1),this.bounds=new U.Rectangle(0,0,t.width,t.height),this.camera=null,this._definedSize=!1,this._width=t.width,this._height=t.height,this.game.state.onStateChange.add(this.stateChange,this)},U.World.prototype=Object.create(U.Group.prototype),U.World.prototype.constructor=U.World,U.World.prototype.boot=function(){this.camera=new U.Camera(this.game,0,0,0,this.game.width,this.game.height),this.game.stage.addChild(this),this.camera.boot()},U.World.prototype.stateChange=function(){this.x=0,this.y=0,this.camera.reset()},U.World.prototype.setBounds=function(t,e,i,n){this._definedSize=!0,this._width=i,this._height=n,this.bounds.setTo(t,e,i,n),this.x=t,this.y=e,this.camera.bounds&&this.camera.bounds.setTo(t,e,Math.max(i,this.game.width),Math.max(n,this.game.height)),this.game.physics.setBoundsToWorld()},U.World.prototype.resize=function(t,e){this._definedSize&&(t<this._width&&(t=this._width),e<this._height&&(e=this._height)),this.bounds.width=t,this.bounds.height=e,this.game.camera.setBoundsToWorld(),this.game.physics.setBoundsToWorld()},U.World.prototype.shutdown=function(){this.destroy(!0,!0)},U.World.prototype.wrap=function(t,e,i,n,r){void 0===e&&(e=0),void 0===n&&(n=!0),void 0===r&&(r=!0),(i=void 0===i?!1:i)?(t.getBounds(),n&&(t.x+t._currentBounds.width<this.bounds.x?t.x=this.bounds.right:t.x>this.bounds.right&&(t.x=this.bounds.left)),r&&(t.y+t._currentBounds.height<this.bounds.top?t.y=this.bounds.bottom:t.y>this.bounds.bottom&&(t.y=this.bounds.top))):(n&&t.x+e<this.bounds.x?t.x=this.bounds.right+e:n&&t.x-e>this.bounds.right&&(t.x=this.bounds.left-e),r&&t.y+e<this.bounds.top?t.y=this.bounds.bottom+e:r&&t.y-e>this.bounds.bottom&&(t.y=this.bounds.top-e))},Object.defineProperty(U.World.prototype,"width",{get:function(){return this.bounds.width},set:function(t){t<this.game.width&&(t=this.game.width),this.bounds.width=t,this._width=t,this._definedSize=!0}}),Object.defineProperty(U.World.prototype,"height",{get:function(){return this.bounds.height},set:function(t){t<this.game.height&&(t=this.game.height),this.bounds.height=t,this._height=t,this._definedSize=!0}}),Object.defineProperty(U.World.prototype,"centerX",{get:function(){return this.bounds.halfWidth+this.bounds.x}}),Object.defineProperty(U.World.prototype,"centerY",{get:function(){return this.bounds.halfHeight+this.bounds.y}}),Object.defineProperty(U.World.prototype,"randomX",{get:function(){return this.bounds.x<0?this.game.rnd.between(this.bounds.x,this.bounds.width-Math.abs(this.bounds.x)):this.game.rnd.between(this.bounds.x,this.bounds.width)}}),Object.defineProperty(U.World.prototype,"randomY",{get:function(){return this.bounds.y<0?this.game.rnd.between(this.bounds.y,this.bounds.height-Math.abs(this.bounds.y)):this.game.rnd.between(this.bounds.y,this.bounds.height)}}),U.Game=function(t,e,i,n,r,o,s,a){return this.id=U.GAMES.push(this)-1,this.config=null,this.physicsConfig=a,this.parent="",this.width=800,this.height=600,this.resolution=1,this._width=800,this._height=600,this.transparent=!1,this.antialias=!0,this.preserveDrawingBuffer=!1,this.clearBeforeRender=!0,this.renderer=null,this.renderType=U.AUTO,this.state=null,this.isBooted=!1,this.isRunning=!1,this.raf=null,this.add=null,this.make=null,this.cache=null,this.input=null,this.load=null,this.math=null,this.net=null,this.scale=null,this.sound=null,this.stage=null,this.time=null,this.tweens=null,this.world=null,this.physics=null,this.plugins=null,this.rnd=null,this.device=U.Device,this.camera=null,this.canvas=null,this.context=null,this.debug=null,this.particles=null,this.create=null,this.lockRender=!1,this.stepping=!1,this.pendingStep=!1,this.stepCount=0,this.onPause=null,this.onResume=null,this.onBlur=null,this.onFocus=null,this._paused=!1,this._codePaused=!1,this.currentUpdateID=0,this.updatesThisFrame=1,this._deltaTime=0,this._lastCount=0,this._spiraling=0,this._kickstart=!0,this.fpsProblemNotifier=new U.Signal,this.forceSingleUpdate=!0,this._nextFpsNotification=0,1===arguments.length&&"object"==typeof t?this.parseConfig(t):(this.config={enableDebug:!0},void 0!==t&&(this._width=t),void 0!==e&&(this._height=e),void 0!==i&&(this.renderType=i),void 0!==n&&(this.parent=n),void 0!==o&&(this.transparent=o),void 0!==s&&(this.antialias=s),this.rnd=new U.RandomDataGenerator([(Date.now()*Math.random()).toString()]),this.state=new U.StateManager(this,r)),this.device.whenReady(this.boot,this),this},U.Game.prototype={parseConfig:function(t){void 0===(this.config=t).enableDebug&&(this.config.enableDebug=!0),t.width&&(this._width=t.width),t.height&&(this._height=t.height),t.renderer&&(this.renderType=t.renderer),t.parent&&(this.parent=t.parent),void 0!==t.transparent&&(this.transparent=t.transparent),void 0!==t.antialias&&(this.antialias=t.antialias),t.resolution&&(this.resolution=t.resolution),void 0!==t.preserveDrawingBuffer&&(this.preserveDrawingBuffer=t.preserveDrawingBuffer),t.physicsConfig&&(this.physicsConfig=t.physicsConfig);var e=[(Date.now()*Math.random()).toString()];t.seed&&(e=t.seed),this.rnd=new U.RandomDataGenerator(e);e=null;t.state&&(e=t.state),this.state=new U.StateManager(this,e)},boot:function(){this.isBooted||(this.onPause=new U.Signal,this.onResume=new U.Signal,this.onBlur=new U.Signal,this.onFocus=new U.Signal,this.isBooted=!0,(PIXI.game=this).math=U.Math,this.scale=new U.ScaleManager(this,this._width,this._height),this.stage=new U.Stage(this),this.setUpRenderer(),this.world=new U.World(this),this.add=new U.GameObjectFactory(this),this.make=new U.GameObjectCreator(this),this.cache=new U.Cache(this),this.load=new U.Loader(this),this.time=new U.Time(this),this.tweens=new U.TweenManager(this),this.input=new U.Input(this),this.sound=new U.SoundManager(this),this.physics=new U.Physics(this,this.physicsConfig),this.particles=new U.Particles(this),this.create=new U.Create(this),this.plugins=new U.PluginManager(this),this.net=new U.Net(this),this.time.boot(),this.stage.boot(),this.world.boot(),this.scale.boot(),this.input.boot(),this.sound.boot(),this.state.boot(),this.config.enableDebug?(this.debug=new U.Utils.Debug(this),this.debug.boot()):this.debug={preUpdate:function(){},update:function(){},reset:function(){}},this.showDebugHeader(),this.isRunning=!0,this.config&&this.config.forceSetTimeOut?this.raf=new U.RequestAnimationFrame(this,this.config.forceSetTimeOut):this.raf=new U.RequestAnimationFrame(this,!1),this._kickstart=!0,window.focus&&(!window.PhaserGlobal||window.PhaserGlobal&&!window.PhaserGlobal.stopFocus)&&window.focus(),this.raf.start())},showDebugHeader:function(){if(!window.PhaserGlobal||!window.PhaserGlobal.hideBanner){var t=U.VERSION,e="Canvas",i="HTML Audio",n=1;if(this.renderType===U.WEBGL?(e="WebGL",n++):this.renderType===U.HEADLESS&&(e="Headless"),this.device.webAudio&&(i="WebAudio",n++),this.device.chrome)for(var r=["%c %c %c @azerion/phaser v"+t+" | Pixi.js | "+e+" | "+i+"  %c %c %c https://github.com/azerion / https://www.azerion.com %c%c%c","background: #7ab3eb","background: #378ce1","color: #ffffff; background: #207cd8;","background: #378ce1","background: #7ab3eb","background: #ffffff"],o=0;o<3;o++)o<n?r.push("color: #ff2424; background: #fff"):r.push("color: #959595; background: #fff");else window.console}},setUpRenderer:function(){if(this.config.canvas?this.canvas=this.config.canvas:this.canvas=U.Canvas.create(this,this.width,this.height,this.config.canvasID,!0),this.config.canvasStyle?this.canvas.style=this.config.canvasStyle:this.canvas.style["-webkit-full-screen"]="width: 100%; height: 100%",this.renderType===U.HEADLESS||this.renderType===U.CANVAS||this.renderType===U.AUTO&&!this.device.webGL){if(!this.device.canvas)throw new Error("Phaser.Game - Cannot create Canvas or WebGL context, aborting.");this.renderType=U.CANVAS,this.renderer=new PIXI.CanvasRenderer(this),this.context=this.renderer.context}else this.renderType=U.WEBGL,this.renderer=new PIXI.WebGLRenderer(this),this.context=null,this.canvas.addEventListener("webglcontextlost",this.contextLost.bind(this),!1),this.canvas.addEventListener("webglcontextrestored",this.contextRestored.bind(this),!1);this.device.cocoonJS&&(this.canvas.screencanvas=this.renderType===U.CANVAS),this.renderType!==U.HEADLESS&&(this.stage.smoothed=this.antialias,U.Canvas.addToDOM(this.canvas,this.parent,!1),U.Canvas.setTouchAction(this.canvas))},contextLost:function(t){t.preventDefault(),this.renderer.contextLost=!0},contextRestored:function(){this.renderer.initContext(),this.cache.clearGLTextures(),this.renderer.contextLost=!1},update:function(t){if(this.time.update(t),this._kickstart)return this.updateLogic(this.time.desiredFpsMult),this.updateRender(this.time.slowMotion*this.time.desiredFps),void(this._kickstart=!1);if(1<this._spiraling&&!this.forceSingleUpdate)this.time.time>this._nextFpsNotification&&(this._nextFpsNotification=this.time.time+1e4,this.fpsProblemNotifier.dispatch()),this._deltaTime=0,this._spiraling=0,this.updateRender(this.time.slowMotion*this.time.desiredFps);else{var e=1e3*this.time.slowMotion/this.time.desiredFps;this._deltaTime+=Math.max(Math.min(3*e,this.time.elapsed),0);var i=0;for(this.updatesThisFrame=Math.floor(this._deltaTime/e),this.forceSingleUpdate&&(this.updatesThisFrame=Math.min(1,this.updatesThisFrame));this._deltaTime>=e&&(this._deltaTime-=e,this.currentUpdateID=i,this.updateLogic(this.time.desiredFpsMult),i++,!this.forceSingleUpdate||1!==i);)this.time.refresh();i>this._lastCount?this._spiraling++:i<this._lastCount&&(this._spiraling=0),this._lastCount=i,this.updateRender(this._deltaTime/e)}},updateLogic:function(t){this._paused||this.pendingStep?(this.scale.pauseUpdate(),this.state.pauseUpdate(),this.debug.preUpdate()):(this.stepping&&(this.pendingStep=!0),this.scale.preUpdate(),this.debug.preUpdate(),this.camera.preUpdate(),this.physics.preUpdate(),this.state.preUpdate(t),this.plugins.preUpdate(t),this.stage.preUpdate(),this.state.update(),this.stage.update(),this.tweens.update(),this.sound.update(),this.input.update(),this.physics.update(),this.particles.update(),this.plugins.update(),this.stage.postUpdate(),this.plugins.postUpdate()),this.stage.updateTransform()},updateRender:function(t){this.lockRender||(this.state.preRender(t),this.renderType!==U.HEADLESS&&(this.renderer.render(this.stage),this.plugins.render(t),this.state.render(t)),this.plugins.postRender(t))},enableStep:function(){this.stepping=!0,this.pendingStep=!1,this.stepCount=0},disableStep:function(){this.stepping=!1,this.pendingStep=!1},step:function(){this.pendingStep=!1,this.stepCount++},destroy:function(){this.raf.stop(),this.state.destroy(),this.sound.destroy(),this.scale.destroy(),this.stage.destroy(),this.input.destroy(),this.physics.destroy(),this.plugins.destroy(),this.state=null,this.sound=null,this.scale=null,this.stage=null,this.input=null,this.physics=null,this.plugins=null,this.cache=null,this.load=null,this.time=null,this.world=null,this.isBooted=!1,this.renderer.destroy(!1),U.Canvas.removeFromDOM(this.canvas),PIXI.defaultRenderer=null,U.GAMES[this.id]=null},gamePaused:function(t){this._paused||(this._paused=!0,this.time.gamePaused(),this.sound.muteOnPause&&this.sound.setMute(),this.onPause.dispatch(t),this.device.cordova&&this.device.iOS&&(this.lockRender=!0))},gameResumed:function(t){this._paused&&!this._codePaused&&(this._paused=!1,this.time.gameResumed(),this.input.reset(),this.sound.muteOnPause&&this.sound.unsetMute(),this.onResume.dispatch(t),this.device.cordova&&this.device.iOS&&(this.lockRender=!1))},focusLoss:function(t){this.onBlur.dispatch(t),this.stage.disableVisibilityChange||this.gamePaused(t)},focusGain:function(t){this.onFocus.dispatch(t),this.stage.disableVisibilityChange||this.gameResumed(t)}},U.Game.prototype.constructor=U.Game,Object.defineProperty(U.Game.prototype,"paused",{get:function(){return this._paused},set:function(t){!0===t?(!1===this._paused&&(this._paused=!0,this.sound.setMute(),this.time.gamePaused(),this.onPause.dispatch(this)),this._codePaused=!0):(this._paused&&(this._paused=!1,this.input.reset(),this.sound.unsetMute(),this.time.gameResumed(),this.onResume.dispatch(this)),this._codePaused=!1)}}),U.Input=function(t){this.game=t,this.hitCanvas=null,this.hitContext=null,this.moveCallbacks=[],this.customCandidateHandler=null,this.customCandidateHandlerContext=null,this.pollRate=0,this.enabled=!0,this.multiInputOverride=U.Input.MOUSE_TOUCH_COMBINE,this.position=null,this.speed=null,this.circle=null,this.scale=null,this.maxPointers=-1,this.tapRate=200,this.doubleTapRate=300,this.holdRate=2e3,this.justPressedRate=200,this.justReleasedRate=200,this.recordPointerHistory=!1,this.recordRate=100,this.recordLimit=100,this.pointer1=null,this.pointer2=null,this.pointer3=null,this.pointer4=null,this.pointer5=null,this.pointer6=null,this.pointer7=null,this.pointer8=null,this.pointer9=null,this.pointer10=null,this.pointers=[],this.activePointer=null,this.mousePointer=null,this.mouse=null,this.keyboard=null,this.touch=null,this.mspointer=null,this.gamepad=null,this.resetLocked=!1,this.onDown=null,this.onUp=null,this.onTap=null,this.onHold=null,this.minPriorityID=0,this.interactiveItems=new U.ArraySet,this._localPoint=new U.Point,this._pollCounter=0,this._oldPosition=null,this._x=0,this._y=0},U.Input.MOUSE_OVERRIDES_TOUCH=0,U.Input.TOUCH_OVERRIDES_MOUSE=1,U.Input.MOUSE_TOUCH_COMBINE=2,U.Input.MAX_POINTERS=10,U.Input.prototype={boot:function(){this.mousePointer=new U.Pointer(this.game,0,U.PointerMode.CURSOR),this.addPointer(),this.addPointer(),this.mouse=new U.Mouse(this.game),this.touch=new U.Touch(this.game),this.mspointer=new U.MSPointer(this.game),U.Keyboard&&(this.keyboard=new U.Keyboard(this.game)),U.Gamepad&&(this.gamepad=new U.Gamepad(this.game)),this.onDown=new U.Signal,this.onUp=new U.Signal,this.onTap=new U.Signal,this.onHold=new U.Signal,this.scale=new U.Point(1,1),this.speed=new U.Point,this.position=new U.Point,this._oldPosition=new U.Point,this.circle=new U.Circle(0,0,45),this.activePointer=this.mousePointer,this.hitCanvas=PIXI.CanvasPool.create(this,1,1),this.hitContext=this.hitCanvas.getContext("2d"),this.game.device.mspointer?this.mspointer.start():this.game.device.touch&&this.touch.start(),this.mspointer.active||this.mouse.start(),this.mousePointer.active=!0,this.keyboard&&this.keyboard.start();var e=this;this._onClickTrampoline=function(t){e.onClickTrampoline(t)},this.game.canvas.addEventListener("click",this._onClickTrampoline,!1)},destroy:function(){this.mouse.stop(),this.touch.stop(),this.mspointer.stop(),this.keyboard&&this.keyboard.stop(),this.gamepad&&this.gamepad.stop(),this.moveCallbacks=[],PIXI.CanvasPool.remove(this),this.game.canvas.removeEventListener("click",this._onClickTrampoline)},setInteractiveCandidateHandler:function(t,e){this.customCandidateHandler=t,this.customCandidateHandlerContext=e},addMoveCallback:function(t,e){this.moveCallbacks.push({callback:t,context:e})},deleteMoveCallback:function(t,e){for(var i=this.moveCallbacks.length;i--;)if(this.moveCallbacks[i].callback===t&&this.moveCallbacks[i].context===e)return void this.moveCallbacks.splice(i,1)},addPointer:function(){if(this.pointers.length>=U.Input.MAX_POINTERS)return null;var t=this.pointers.length+1,e=new U.Pointer(this.game,t,U.PointerMode.TOUCH);return this.pointers.push(e),this["pointer"+t]=e},update:function(){if(this.keyboard&&this.keyboard.update(),0<this.pollRate&&this._pollCounter<this.pollRate)this._pollCounter++;else{this.speed.x=this.position.x-this._oldPosition.x,this.speed.y=this.position.y-this._oldPosition.y,this._oldPosition.copyFrom(this.position),this.mousePointer.update(),this.gamepad&&this.gamepad.active&&this.gamepad.update();for(var t=0;t<this.pointers.length;t++)this.pointers[t].update();this._pollCounter=0}},reset:function(t){if(this.game.isBooted&&!this.resetLocked){void 0===t&&(t=!1),this.mousePointer.reset(),this.keyboard&&this.keyboard.reset(t),this.gamepad&&this.gamepad.reset();for(var e=0;e<this.pointers.length;e++)this.pointers[e].reset();"none"!==this.game.canvas.style.cursor&&(this.game.canvas.style.cursor="inherit"),t&&(this.onDown.dispose(),this.onUp.dispose(),this.onTap.dispose(),this.onHold.dispose(),this.onDown=new U.Signal,this.onUp=new U.Signal,this.onTap=new U.Signal,this.onHold=new U.Signal,this.moveCallbacks=[]),this._pollCounter=0}},resetSpeed:function(t,e){this._oldPosition.setTo(t,e),this.speed.setTo(0,0)},startPointer:function(t){if(0<=this.maxPointers&&this.countActivePointers(this.maxPointers)>=this.maxPointers)return null;if(!this.pointer1.active)return this.pointer1.start(t);if(!this.pointer2.active)return this.pointer2.start(t);for(var e=2;e<this.pointers.length;e++){var i=this.pointers[e];if(!i.active)return i.start(t)}return null},updatePointer:function(t){if(this.pointer1.active&&this.pointer1.identifier===t.identifier)return this.pointer1.move(t);if(this.pointer2.active&&this.pointer2.identifier===t.identifier)return this.pointer2.move(t);for(var e=2;e<this.pointers.length;e++){var i=this.pointers[e];if(i.active&&i.identifier===t.identifier)return i.move(t)}return null},stopPointer:function(t){if(this.pointer1.active&&this.pointer1.identifier===t.identifier)return this.pointer1.stop(t);if(this.pointer2.active&&this.pointer2.identifier===t.identifier)return this.pointer2.stop(t);for(var e=2;e<this.pointers.length;e++){var i=this.pointers[e];if(i.active&&i.identifier===t.identifier)return i.stop(t)}return null},countActivePointers:function(t){for(var e=t=void 0===t?this.pointers.length:t,i=0;i<this.pointers.length&&0<e;i++)this.pointers[i].active&&e--;return t-e},getPointer:function(t){void 0===t&&(t=!1);for(var e=0;e<this.pointers.length;e++){var i=this.pointers[e];if(i.active===t)return i}return null},getPointerFromIdentifier:function(t){for(var e=0;e<this.pointers.length;e++){var i=this.pointers[e];if(i.identifier===t)return i}return null},getPointerFromId:function(t){for(var e=0;e<this.pointers.length;e++){var i=this.pointers[e];if(i.pointerId===t)return i}return null},getLocalPosition:function(t,e,i){void 0===i&&(i=new U.Point);var n=t.worldTransform,t=1/(n.a*n.d+n.c*-n.b);return i.setTo(n.d*t*e.x+-n.c*t*e.y+(n.ty*n.c-n.tx*n.d)*t,n.a*t*e.y+-n.b*t*e.x+(-n.ty*n.a+n.tx*n.b)*t)},hitTest:function(t,e,i){if(!t.worldVisible)return!1;if(this.getLocalPosition(t,e,this._localPoint),i.copyFrom(this._localPoint),t.hitArea&&t.hitArea.contains)return t.hitArea.contains(this._localPoint.x,this._localPoint.y);if(t instanceof U.TileSprite){var n=t.width,r=t.height,o=-n*t.anchor.x;if(this._localPoint.x>=o&&this._localPoint.x<o+n){var s=-r*t.anchor.y;if(this._localPoint.y>=s&&this._localPoint.y<s+r)return!0}}else if(t instanceof PIXI.Sprite){n=t.texture.frame.width,r=t.texture.frame.height,o=-n*t.anchor.x;if(this._localPoint.x>=o&&this._localPoint.x<o+n){s=-r*t.anchor.y;if(this._localPoint.y>=s&&this._localPoint.y<s+r)return!0}}else if(U.Graphics&&t instanceof U.Graphics)for(var a=0;a<t.graphicsData.length;a++){var h=t.graphicsData[a];if(h.fill&&h.shape&&h.shape.contains(this._localPoint.x,this._localPoint.y))return!0}for(a=0;a<t.children.length;a++)if(this.hitTest(t.children[a],e,i))return!0;return!1},onClickTrampoline:function(){this.activePointer.processClickTrampolines()}},U.Input.prototype.constructor=U.Input,Object.defineProperty(U.Input.prototype,"x",{get:function(){return this._x},set:function(t){this._x=Math.floor(t)}}),Object.defineProperty(U.Input.prototype,"y",{get:function(){return this._y},set:function(t){this._y=Math.floor(t)}}),Object.defineProperty(U.Input.prototype,"pollLocked",{get:function(){return 0<this.pollRate&&this._pollCounter<this.pollRate}}),Object.defineProperty(U.Input.prototype,"totalInactivePointers",{get:function(){return this.pointers.length-this.countActivePointers()}}),Object.defineProperty(U.Input.prototype,"totalActivePointers",{get:function(){return this.countActivePointers()}}),Object.defineProperty(U.Input.prototype,"worldX",{get:function(){return this.game.camera.view.x+this.x}}),Object.defineProperty(U.Input.prototype,"worldY",{get:function(){return this.game.camera.view.y+this.y}}),U.Mouse=function(t){this.game=t,this.input=t.input,this.callbackContext=this.game,this.mouseDownCallback=null,this.mouseUpCallback=null,this.mouseOutCallback=null,this.mouseOverCallback=null,this.mouseWheelCallback=null,this.capture=!1,this.button=-1,this.wheelDelta=0,this.enabled=!0,this.locked=!1,this.stopOnGameOut=!1,this.pointerLock=new U.Signal,this.event=null,this._onMouseDown=null,this._onMouseMove=null,this._onMouseUp=null,this._onMouseOut=null,this._onMouseOver=null,this._onMouseWheel=null,this._wheelEvent=null},U.Mouse.NO_BUTTON=-1,U.Mouse.LEFT_BUTTON=0,U.Mouse.MIDDLE_BUTTON=1,U.Mouse.RIGHT_BUTTON=2,U.Mouse.BACK_BUTTON=3,U.Mouse.FORWARD_BUTTON=4,U.Mouse.WHEEL_UP=1,U.Mouse.WHEEL_DOWN=-1,U.Mouse.prototype={start:function(){var e,t,i;this.game.device.android&&!1===this.game.device.chrome||null!==this._onMouseDown||((e=this)._onMouseDown=function(t){return e.onMouseDown(t)},this._onMouseMove=function(t){return e.onMouseMove(t)},this._onMouseUp=function(t){return e.onMouseUp(t)},this._onMouseUpGlobal=function(t){return e.onMouseUpGlobal(t)},this._onMouseOutGlobal=function(t){return e.onMouseOutGlobal(t)},this._onMouseOut=function(t){return e.onMouseOut(t)},this._onMouseOver=function(t){return e.onMouseOver(t)},this._onMouseWheel=function(t){return e.onMouseWheel(t)},(t=this.game.canvas).addEventListener("mousedown",this._onMouseDown,!0),t.addEventListener("mousemove",this._onMouseMove,!0),t.addEventListener("mouseup",this._onMouseUp,!0),this.game.device.cocoonJS||(window.addEventListener("mouseup",this._onMouseUpGlobal,!0),window.addEventListener("mouseout",this._onMouseOutGlobal,!0),t.addEventListener("mouseover",this._onMouseOver,!0),t.addEventListener("mouseout",this._onMouseOut,!0)),(i=this.game.device.wheelEvent)&&(t.addEventListener(i,this._onMouseWheel,!0),"mousewheel"===i?this._wheelEvent=new n(-.025,1):"DOMMouseScroll"===i&&(this._wheelEvent=new n(1,1))))},onMouseDown:function(t){this.event=t,this.capture&&t.preventDefault(),this.mouseDownCallback&&this.mouseDownCallback.call(this.callbackContext,t),this.input.enabled&&this.enabled&&(t.identifier=0,this.input.mousePointer.start(t))},onMouseMove:function(t){this.event=t,this.capture&&t.preventDefault(),this.mouseMoveCallback&&this.mouseMoveCallback.call(this.callbackContext,t),this.input.enabled&&this.enabled&&(t.identifier=0,this.input.mousePointer.move(t))},onMouseUp:function(t){this.event=t,this.capture&&t.preventDefault(),this.mouseUpCallback&&this.mouseUpCallback.call(this.callbackContext,t),this.input.enabled&&this.enabled&&(t.identifier=0,this.input.mousePointer.stop(t))},onMouseUpGlobal:function(t){this.input.mousePointer.withinGame||(this.mouseUpCallback&&this.mouseUpCallback.call(this.callbackContext,t),t.identifier=0,this.input.mousePointer.stop(t))},onMouseOutGlobal:function(t){this.event=t,this.capture&&t.preventDefault(),this.input.mousePointer.withinGame=!1,this.input.enabled&&this.enabled&&(this.input.mousePointer.stop(t),this.input.mousePointer.leftButton.stop(t),this.input.mousePointer.rightButton.stop(t))},onMouseOut:function(t){this.event=t,this.capture&&t.preventDefault(),this.input.mousePointer.withinGame=!1,this.mouseOutCallback&&this.mouseOutCallback.call(this.callbackContext,t),this.input.enabled&&this.enabled&&this.stopOnGameOut&&(t.identifier=0,this.input.mousePointer.stop(t))},onMouseOver:function(t){this.event=t,this.capture&&t.preventDefault(),this.input.mousePointer.withinGame=!0,this.mouseOverCallback&&this.mouseOverCallback.call(this.callbackContext,t)},onMouseWheel:function(t){this._wheelEvent&&(t=this._wheelEvent.bindEvent(t)),this.event=t,this.capture&&t.preventDefault(),this.wheelDelta=U.Math.clamp(-t.deltaY,-1,1),this.mouseWheelCallback&&this.mouseWheelCallback.call(this.callbackContext,t)},requestPointerLock:function(){var t,e;this.game.device.pointerLock&&((t=this.game.canvas).requestPointerLock=t.requestPointerLock||t.mozRequestPointerLock||t.webkitRequestPointerLock,t.requestPointerLock(),(e=this)._pointerLockChange=function(t){return e.pointerLockChange(t)},document.addEventListener("pointerlockchange",this._pointerLockChange,!0),document.addEventListener("mozpointerlockchange",this._pointerLockChange,!0),document.addEventListener("webkitpointerlockchange",this._pointerLockChange,!0))},pointerLockChange:function(t){var e=this.game.canvas;document.pointerLockElement===e||document.mozPointerLockElement===e||document.webkitPointerLockElement===e?(this.locked=!0,this.pointerLock.dispatch(!0,t)):(this.locked=!1,this.pointerLock.dispatch(!1,t))},releasePointerLock:function(){document.exitPointerLock=document.exitPointerLock||document.mozExitPointerLock||document.webkitExitPointerLock,document.exitPointerLock(),document.removeEventListener("pointerlockchange",this._pointerLockChange,!0),document.removeEventListener("mozpointerlockchange",this._pointerLockChange,!0),document.removeEventListener("webkitpointerlockchange",this._pointerLockChange,!0)},stop:function(){var t=this.game.canvas;t.removeEventListener("mousedown",this._onMouseDown,!0),t.removeEventListener("mousemove",this._onMouseMove,!0),t.removeEventListener("mouseup",this._onMouseUp,!0),t.removeEventListener("mouseover",this._onMouseOver,!0),t.removeEventListener("mouseout",this._onMouseOut,!0);var e=this.game.device.wheelEvent;e&&t.removeEventListener(e,this._onMouseWheel,!0),window.removeEventListener("mouseup",this._onMouseUpGlobal,!0),window.removeEventListener("mouseout",this._onMouseOutGlobal,!0),document.removeEventListener("pointerlockchange",this._pointerLockChange,!0),document.removeEventListener("mozpointerlockchange",this._pointerLockChange,!0),document.removeEventListener("webkitpointerlockchange",this._pointerLockChange,!0)}},U.Mouse.prototype.constructor=U.Mouse,((n.prototype={}).constructor=n).prototype.bindEvent=function(t){if(!n._stubsGenerated&&t){for(var e in t)e in n.prototype||Object.defineProperty(n.prototype,e,{get:function(e){return function(){var t=this.originalEvent[e];return"function"!=typeof t?t:t.bind(this.originalEvent)}}(e)});n._stubsGenerated=!0}return this.originalEvent=t,this},Object.defineProperties(n.prototype,{type:{value:"wheel"},deltaMode:{get:function(){return this._deltaMode}},deltaY:{get:function(){return this._scaleFactor*(this.originalEvent.wheelDelta||this.originalEvent.detail)||0}},deltaX:{get:function(){return this._scaleFactor*this.originalEvent.wheelDeltaX||0}},deltaZ:{value:0}}),U.MSPointer=function(t){this.game=t,this.input=t.input,this.callbackContext=this.game,this.pointerDownCallback=null,this.pointerMoveCallback=null,this.pointerUpCallback=null,this.capture=!1,this.event=null,this.active=!1,this.enabled=!0,this._onMSPointerDown=null,this._onMSPointerMove=null,this._onMSPointerUp=null,this._onMSPointerUpGlobal=null,this._onMSPointerOut=null,this._onMSPointerOver=null},U.MSPointer.prototype={start:function(){if(!this.game.device.mspointer)return!1;if(null!==this._onMSPointerDown)return!1;var e=this;this._onMSPointerDown=function(t){return e.onPointerDown(t)},this._onMSPointerMove=function(t){return e.onPointerMove(t)},this._onMSPointerUp=function(t){return e.onPointerUp(t)},this._onMSPointerUpGlobal=function(t){return e.onPointerUpGlobal(t)},this._onMSPointerOut=function(t){return e.onPointerOut(t)},this._onMSPointerOver=function(t){return e.onPointerOver(t)};var t=this.game.canvas;return t.addEventListener("MSPointerDown",this._onMSPointerDown,!1),t.addEventListener("MSPointerMove",this._onMSPointerMove,!1),t.addEventListener("MSPointerUp",this._onMSPointerUp,!1),t.addEventListener("pointerdown",this._onMSPointerDown,!1),t.addEventListener("pointermove",this._onMSPointerMove,!1),t.addEventListener("pointerup",this._onMSPointerUp,!1),t.style["-ms-content-zooming"]="none",t.style["-ms-touch-action"]="none",this.game.device.cocoonJS||(window.addEventListener("MSPointerUp",this._onMSPointerUpGlobal,!0),t.addEventListener("MSPointerOver",this._onMSPointerOver,!0),t.addEventListener("MSPointerOut",this._onMSPointerOut,!0),window.addEventListener("pointerup",this._onMSPointerUpGlobal,!0),t.addEventListener("pointerover",this._onMSPointerOver,!0),t.addEventListener("pointerout",this._onMSPointerOut,!0)),this.active=!0},onPointerDown:function(t){this.event=t,this.capture&&t.preventDefault(),this.pointerDownCallback&&this.pointerDownCallback.call(this.callbackContext,t),this.input.enabled&&this.enabled&&(t.identifier=t.pointerId,"mouse"===t.pointerType||4===t.pointerType?this.input.mousePointer.start(t):this.input.startPointer(t))},onPointerMove:function(t){this.event=t,this.capture&&t.preventDefault(),this.pointerMoveCallback&&this.pointerMoveCallback.call(this.callbackContext,t),this.input.enabled&&this.enabled&&(t.identifier=t.pointerId,"mouse"===t.pointerType||4===t.pointerType?this.input.mousePointer.move(t):this.input.updatePointer(t))},onPointerUp:function(t){this.event=t,this.capture&&t.preventDefault(),this.pointerUpCallback&&this.pointerUpCallback.call(this.callbackContext,t),this.input.enabled&&this.enabled&&(t.identifier=t.pointerId,"mouse"===t.pointerType||4===t.pointerType?this.input.mousePointer.stop(t):this.input.stopPointer(t))},onPointerUpGlobal:function(t){var e;(!("mouse"!==t.pointerType&&4!==t.pointerType||this.input.mousePointer.withinGame)||(e=this.input.getPointerFromIdentifier(t.identifier))&&e.withinGame)&&this.onPointerUp(t)},onPointerOut:function(t){var e;this.event=t,this.capture&&t.preventDefault(),"mouse"===t.pointerType||4===t.pointerType?this.input.mousePointer.withinGame=!1:(e=this.input.getPointerFromIdentifier(t.identifier))&&(e.withinGame=!1),this.input.mouse.mouseOutCallback&&this.input.mouse.mouseOutCallback.call(this.input.mouse.callbackContext,t),this.input.enabled&&this.enabled&&this.input.mouse.stopOnGameOut&&(t.identifier=0,(e||this.input.mousePointer).stop(t))},onPointerOver:function(t){var e;this.event=t,this.capture&&t.preventDefault(),"mouse"===t.pointerType||4===t.pointerType?this.input.mousePointer.withinGame=!0:(e=this.input.getPointerFromIdentifier(t.identifier))&&(e.withinGame=!0),this.input.mouse.mouseOverCallback&&this.input.mouse.mouseOverCallback.call(this.input.mouse.callbackContext,t)},stop:function(){var t=this.game.canvas;t.removeEventListener("MSPointerDown",this._onMSPointerDown,!1),t.removeEventListener("MSPointerMove",this._onMSPointerMove,!1),t.removeEventListener("MSPointerUp",this._onMSPointerUp,!1),t.removeEventListener("pointerdown",this._onMSPointerDown,!1),t.removeEventListener("pointermove",this._onMSPointerMove,!1),t.removeEventListener("pointerup",this._onMSPointerUp,!1),window.removeEventListener("MSPointerUp",this._onMSPointerUpGlobal,!0),t.removeEventListener("MSPointerOver",this._onMSPointerOver,!0),t.removeEventListener("MSPointerOut",this._onMSPointerOut,!0),window.removeEventListener("pointerup",this._onMSPointerUpGlobal,!0),t.removeEventListener("pointerover",this._onMSPointerOver,!0),t.removeEventListener("pointerout",this._onMSPointerOut,!0),this.active=!1}},U.MSPointer.prototype.constructor=U.MSPointer,U.DeviceButton=function(t,e){this.parent=t,this.game=t.game,this.event=null,this.isDown=!1,this.isUp=!0,this.timeDown=0,this.timeUp=0,this.repeats=0,this.altKey=!1,this.shiftKey=!1,this.ctrlKey=!1,this.value=0,this.buttonCode=e,this.onDown=new U.Signal,this.onUp=new U.Signal,this.onFloat=new U.Signal},U.DeviceButton.prototype={start:function(t,e){this.isDown||(this.isDown=!0,this.isUp=!1,this.timeDown=this.game.time.time,this.repeats=0,this.event=t,this.value=e,t&&(this.altKey=t.altKey,this.shiftKey=t.shiftKey,this.ctrlKey=t.ctrlKey),this.onDown.dispatch(this,e))},stop:function(t,e){this.isUp||(this.isDown=!1,this.isUp=!0,this.timeUp=this.game.time.time,this.event=t,this.value=e,t&&(this.altKey=t.altKey,this.shiftKey=t.shiftKey,this.ctrlKey=t.ctrlKey),this.onUp.dispatch(this,e))},padFloat:function(t){this.value=t,this.onFloat.dispatch(this,t)},justPressed:function(t){return t=t||250,this.isDown&&this.timeDown+t>this.game.time.time},justReleased:function(t){return t=t||250,this.isUp&&this.timeUp+t>this.game.time.time},reset:function(){this.isDown=!1,this.isUp=!0,this.timeDown=this.game.time.time,this.repeats=0,this.altKey=!1,this.shiftKey=!1,this.ctrlKey=!1},destroy:function(){this.onDown.dispose(),this.onUp.dispose(),this.onFloat.dispose(),this.parent=null,this.game=null}},U.DeviceButton.prototype.constructor=U.DeviceButton,Object.defineProperty(U.DeviceButton.prototype,"duration",{get:function(){return this.isUp?-1:this.game.time.time-this.timeDown}}),U.Pointer=function(t,e,i){this.game=t,this.id=e,this.type=U.POINTER,this.exists=!0,this.identifier=0,this.pointerId=null,this.pointerMode=i||U.PointerMode.CURSOR|U.PointerMode.CONTACT,this.target=null,this.button=null,this.leftButton=new U.DeviceButton(this,U.Pointer.LEFT_BUTTON),this.middleButton=new U.DeviceButton(this,U.Pointer.MIDDLE_BUTTON),this.rightButton=new U.DeviceButton(this,U.Pointer.RIGHT_BUTTON),this.backButton=new U.DeviceButton(this,U.Pointer.BACK_BUTTON),this.forwardButton=new U.DeviceButton(this,U.Pointer.FORWARD_BUTTON),this.eraserButton=new U.DeviceButton(this,U.Pointer.ERASER_BUTTON),this._holdSent=!1,this._history=[],this._nextDrop=0,this._stateReset=!1,this.withinGame=!1,this.clientX=-1,this.clientY=-1,this.pageX=-1,this.pageY=-1,this.screenX=-1,this.screenY=-1,this.rawMovementX=0,this.rawMovementY=0,this.movementX=0,this.movementY=0,this.x=-1,this.y=-1,this.isMouse=0===e,this.isDown=!1,this.isUp=!0,this.timeDown=0,this.timeUp=0,this.previousTapTime=0,this.totalTouches=0,this.msSinceLastClick=Number.MAX_VALUE,this.targetObject=null,this.interactiveCandidates=[],this.active=!1,this.dirty=!1,this.position=new U.Point,this.positionDown=new U.Point,this.positionUp=new U.Point,this.circle=new U.Circle(0,0,44),this._clickTrampolines=null,this._trampolineTargetObject=null},U.Pointer.NO_BUTTON=0,U.Pointer.LEFT_BUTTON=1,U.Pointer.RIGHT_BUTTON=2,U.Pointer.MIDDLE_BUTTON=4,U.Pointer.BACK_BUTTON=8,U.Pointer.FORWARD_BUTTON=16,U.Pointer.ERASER_BUTTON=32,U.Pointer.prototype={resetButtons:function(){this.isDown=!1,this.isUp=!0,this.isMouse&&(this.leftButton.reset(),this.middleButton.reset(),this.rightButton.reset(),this.backButton.reset(),this.forwardButton.reset(),this.eraserButton.reset())},processButtonsDown:function(t,e){U.Pointer.LEFT_BUTTON&t&&this.leftButton.start(e),U.Pointer.RIGHT_BUTTON&t&&this.rightButton.start(e),U.Pointer.MIDDLE_BUTTON&t&&this.middleButton.start(e),U.Pointer.BACK_BUTTON&t&&this.backButton.start(e),U.Pointer.FORWARD_BUTTON&t&&this.forwardButton.start(e),U.Pointer.ERASER_BUTTON&t&&this.eraserButton.start(e)},processButtonsUp:function(t,e){t===U.Mouse.LEFT_BUTTON&&this.leftButton.stop(e),t===U.Mouse.RIGHT_BUTTON&&this.rightButton.stop(e),t===U.Mouse.MIDDLE_BUTTON&&this.middleButton.stop(e),t===U.Mouse.BACK_BUTTON&&this.backButton.stop(e),t===U.Mouse.FORWARD_BUTTON&&this.forwardButton.stop(e),5===t&&this.eraserButton.stop(e)},updateButtons:function(t){this.button=t.button;var e="down"===t.type.toLowerCase().substr(-4);void 0!==t.buttons?e?this.processButtonsDown(t.buttons,t):this.processButtonsUp(t.button,t):e?this.leftButton.start(t):(this.leftButton.stop(t),this.rightButton.stop(t)),1===t.buttons&&t.ctrlKey&&this.leftButton.isDown&&(this.leftButton.stop(t),this.rightButton.start(t)),this.isUp=!0,this.isDown=!1,(this.leftButton.isDown||this.rightButton.isDown||this.middleButton.isDown||this.backButton.isDown||this.forwardButton.isDown||this.eraserButton.isDown)&&(this.isUp=!1,this.isDown=!0)},start:function(t){var e=this.game.input;return t.pointerId&&(this.pointerId=t.pointerId),this.identifier=t.identifier,this.target=t.target,this.isMouse?this.updateButtons(t):(this.isDown=!0,this.isUp=!1),this.active=!0,this.withinGame=!0,this.dirty=!1,this._history=[],this._clickTrampolines=null,this._trampolineTargetObject=null,this.msSinceLastClick=this.game.time.time-this.timeDown,this.timeDown=this.game.time.time,this._holdSent=!1,this.move(t,!0),this.positionDown.setTo(this.x,this.y),(e.multiInputOverride===U.Input.MOUSE_OVERRIDES_TOUCH||e.multiInputOverride===U.Input.MOUSE_TOUCH_COMBINE||e.multiInputOverride===U.Input.TOUCH_OVERRIDES_MOUSE&&0===e.totalActivePointers)&&(e.x=this.x,e.y=this.y,e.position.setTo(this.x,this.y),e.onDown.dispatch(this,t),e.resetSpeed(this.x,this.y)),this._stateReset=!1,this.totalTouches++,null!==this.targetObject&&this.targetObject._touchedHandler(this),this},update:function(){var t=this.game.input;this.active&&(this.dirty&&(0<t.interactiveItems.total&&this.processInteractiveObjects(!1),this.dirty=!1),!1===this._holdSent&&this.duration>=t.holdRate&&((t.multiInputOverride===U.Input.MOUSE_OVERRIDES_TOUCH||t.multiInputOverride===U.Input.MOUSE_TOUCH_COMBINE||t.multiInputOverride===U.Input.TOUCH_OVERRIDES_MOUSE&&0===t.totalActivePointers)&&t.onHold.dispatch(this),this._holdSent=!0),t.recordPointerHistory&&this.game.time.time>=this._nextDrop&&(this._nextDrop=this.game.time.time+t.recordRate,this._history.push({x:this.position.x,y:this.position.y}),this._history.length>t.recordLimit&&this._history.shift()))},move:function(t,e){var i=this.game.input;if(!i.pollLocked){void 0===e&&(e=!1),void 0!==t.button&&(this.button=t.button),e&&this.isMouse&&this.updateButtons(t),this.clientX=t.clientX,this.clientY=t.clientY,this.pageX=t.pageX,this.pageY=t.pageY,this.screenX=t.screenX,this.screenY=t.screenY,this.isMouse&&i.mouse.locked&&!e&&(this.rawMovementX=t.movementX||t.mozMovementX||t.webkitMovementX||0,this.rawMovementY=t.movementY||t.mozMovementY||t.webkitMovementY||0,this.movementX+=this.rawMovementX,this.movementY+=this.rawMovementY),this.x=(this.pageX-this.game.scale.offset.x)*i.scale.x,this.y=(this.pageY-this.game.scale.offset.y)*i.scale.y,this.position.setTo(this.x,this.y),this.circle.x=this.x,this.circle.y=this.y,(i.multiInputOverride===U.Input.MOUSE_OVERRIDES_TOUCH||i.multiInputOverride===U.Input.MOUSE_TOUCH_COMBINE||i.multiInputOverride===U.Input.TOUCH_OVERRIDES_MOUSE&&0===i.totalActivePointers)&&(i.activePointer=this,i.x=this.x,i.y=this.y,i.position.setTo(i.x,i.y),i.circle.x=i.x,i.circle.y=i.y),this.withinGame=this.game.scale.bounds.contains(this.pageX,this.pageY);for(var n=i.moveCallbacks.length;n--;)i.moveCallbacks[n].callback.call(i.moveCallbacks[n].context,this,this.x,this.y,e);return null!==this.targetObject&&!0===this.targetObject.isDragged?!1===this.targetObject.update(this)&&(this.targetObject=null):0<i.interactiveItems.total&&this.processInteractiveObjects(e),this}},processInteractiveObjects:function(t){var e=0,i=-1,n=null,r=this.game.input.interactiveItems.first;for(this.interactiveCandidates=[];r;)r.checked=!1,r.validForInput(i,e,!1)&&(r.checked=!0,(t&&r.checkPointerDown(this,!0)||!t&&r.checkPointerOver(this,!0))&&(e=r.sprite.renderOrderID,i=r.priorityID,n=r,this.interactiveCandidates.push(r))),r=this.game.input.interactiveItems.next;for(r=this.game.input.interactiveItems.first;r;)!r.checked&&r.validForInput(i,e,!0)&&(t&&r.checkPointerDown(this,!1)||!t&&r.checkPointerOver(this,!1))&&(e=r.sprite.renderOrderID,i=r.priorityID,n=r,this.interactiveCandidates.push(r)),r=this.game.input.interactiveItems.next;return this.game.input.customCandidateHandler&&(n=this.game.input.customCandidateHandler.call(this.game.input.customCandidateHandlerContext,this,this.interactiveCandidates,n)),this.swapTarget(n,!1),null!==this.targetObject},swapTarget:function(t,e){void 0===e&&(e=!1),null===t?this.targetObject&&(this.targetObject._pointerOutHandler(this,e),this.targetObject=null):null===this.targetObject?(this.targetObject=t)._pointerOverHandler(this,e):this.targetObject===t?!1===t.update(this)&&(this.targetObject=null):(this.targetObject._pointerOutHandler(this,e),this.targetObject=t,this.targetObject._pointerOverHandler(this,e))},leave:function(t){this.withinGame=!1,this.move(t,!1)},stop:function(t){var e=this.game.input;return this._stateReset&&this.withinGame?void t.preventDefault():(this.timeUp=this.game.time.time,(e.multiInputOverride===U.Input.MOUSE_OVERRIDES_TOUCH||e.multiInputOverride===U.Input.MOUSE_TOUCH_COMBINE||e.multiInputOverride===U.Input.TOUCH_OVERRIDES_MOUSE&&0===e.totalActivePointers)&&(e.onUp.dispatch(this,t),0<=this.duration&&this.duration<=e.tapRate&&(this.timeUp-this.previousTapTime<e.doubleTapRate?e.onTap.dispatch(this,!0):e.onTap.dispatch(this,!1),this.previousTapTime=this.timeUp)),this.isMouse?this.updateButtons(t):(this.isDown=!1,this.isUp=!0),0<this.id&&(this.active=!1),this.withinGame=this.game.scale.bounds.contains(t.pageX,t.pageY),this.pointerId=null,this.identifier=null,this.positionUp.setTo(this.x,this.y),!1===this.isMouse&&e.currentPointers--,e.interactiveItems.callAll("_releasedHandler",this),this._clickTrampolines&&(this._trampolineTargetObject=this.targetObject),this.targetObject=null,this)},justPressed:function(t){return t=t||this.game.input.justPressedRate,!0===this.isDown&&this.timeDown+t>this.game.time.time},justReleased:function(t){return t=t||this.game.input.justReleasedRate,this.isUp&&this.timeUp+t>this.game.time.time},addClickTrampoline:function(t,e,i,n){if(this.isDown){for(var r=this._clickTrampolines=this._clickTrampolines||[],o=0;o<r.length;o++)if(r[o].name===t){r.splice(o,1);break}r.push({name:t,targetObject:this.targetObject,callback:e,callbackContext:i,callbackArgs:n})}},processClickTrampolines:function(){var t=this._clickTrampolines;if(t){for(var e=0;e<t.length;e++){var i=t[e];i.targetObject===this._trampolineTargetObject&&i.callback.apply(i.callbackContext,i.callbackArgs)}this._clickTrampolines=null,this._trampolineTargetObject=null}},reset:function(){!1===this.isMouse&&(this.active=!1),this.pointerId=null,this.identifier=null,this.dirty=!1,this.totalTouches=0,this._holdSent=!1,this._history.length=0,this._stateReset=!0,this.resetButtons(),this.targetObject&&this.targetObject._releasedHandler(this),this.targetObject=null},resetMovement:function(){this.movementX=0,this.movementY=0}},U.Pointer.prototype.constructor=U.Pointer,Object.defineProperty(U.Pointer.prototype,"duration",{get:function(){return this.isUp?-1:this.game.time.time-this.timeDown}}),Object.defineProperty(U.Pointer.prototype,"worldX",{get:function(){return this.game.world.camera.x+this.x}}),Object.defineProperty(U.Pointer.prototype,"worldY",{get:function(){return this.game.world.camera.y+this.y}}),U.PointerMode={CURSOR:1,CONTACT:2},U.Touch=function(t){this.game=t,this.enabled=!0,this.touchLockCallbacks=[],this.callbackContext=this.game,this.touchStartCallback=null,this.touchMoveCallback=null,this.touchEndCallback=null,this.touchEnterCallback=null,this.touchLeaveCallback=null,this.touchCancelCallback=null,this.preventDefault=!0,this.event=null,this._onTouchStart=null,this._onTouchMove=null,this._onTouchEnd=null,this._onTouchEnter=null,this._onTouchLeave=null,this._onTouchCancel=null,this._onTouchMove=null},U.Touch.prototype={start:function(){var e;null!==this._onTouchStart||(e=this).game.device.touch&&(this._onTouchStart=function(t){return e.onTouchStart(t)},this._onTouchMove=function(t){return e.onTouchMove(t)},this._onTouchEnd=function(t){return e.onTouchEnd(t)},this._onTouchEnter=function(t){return e.onTouchEnter(t)},this._onTouchLeave=function(t){return e.onTouchLeave(t)},this._onTouchCancel=function(t){return e.onTouchCancel(t)},this.game.canvas.addEventListener("touchstart",this._onTouchStart,!1),this.game.canvas.addEventListener("touchmove",this._onTouchMove,!1),this.game.canvas.addEventListener("touchend",this._onTouchEnd,!1),this.game.canvas.addEventListener("touchcancel",this._onTouchCancel,!1),this.game.device.cocoonJS||(this.game.canvas.addEventListener("touchenter",this._onTouchEnter,!1),this.game.canvas.addEventListener("touchleave",this._onTouchLeave,!1)))},consumeDocumentTouches:function(){this._documentTouchMove=function(t){t.preventDefault()},document.addEventListener("touchmove",this._documentTouchMove,!1)},addTouchLockCallback:function(t,e,i){this.touchLockCallbacks.push({callback:t,context:e,onEnd:i=void 0===i?!1:i})},removeTouchLockCallback:function(t,e){for(var i=this.touchLockCallbacks.length;i--;)if(this.touchLockCallbacks[i].callback===t&&this.touchLockCallbacks[i].context===e)return this.touchLockCallbacks.splice(i,1),!0;return!1},onTouchStart:function(t){for(var e=this.touchLockCallbacks.length;e--;){var i=this.touchLockCallbacks[e];!i.onEnd&&i.callback.call(i.context,this,t)&&this.touchLockCallbacks.splice(e,1)}if(this.event=t,this.game.input.enabled&&this.enabled){this.touchStartCallback&&this.touchStartCallback.call(this.callbackContext,t),this.preventDefault&&t.preventDefault();for(e=0;e<t.changedTouches.length;e++)this.game.input.startPointer(t.changedTouches[e])}},onTouchCancel:function(t){if(this.event=t,this.touchCancelCallback&&this.touchCancelCallback.call(this.callbackContext,t),this.game.input.enabled&&this.enabled){this.preventDefault&&t.preventDefault();for(var e=0;e<t.changedTouches.length;e++)this.game.input.stopPointer(t.changedTouches[e])}},onTouchEnter:function(t){this.event=t,this.touchEnterCallback&&this.touchEnterCallback.call(this.callbackContext,t),this.game.input.enabled&&this.enabled&&this.preventDefault&&t.preventDefault()},onTouchLeave:function(t){this.event=t,this.touchLeaveCallback&&this.touchLeaveCallback.call(this.callbackContext,t),this.preventDefault&&t.preventDefault()},onTouchMove:function(t){this.event=t,this.touchMoveCallback&&this.touchMoveCallback.call(this.callbackContext,t),this.preventDefault&&t.preventDefault();for(var e=0;e<t.changedTouches.length;e++)this.game.input.updatePointer(t.changedTouches[e])},onTouchEnd:function(t){for(var e=this.touchLockCallbacks.length;e--;){var i=this.touchLockCallbacks[e];i.onEnd&&i.callback.call(i.context,this,t)&&this.touchLockCallbacks.splice(e,1)}this.event=t,this.touchEndCallback&&this.touchEndCallback.call(this.callbackContext,t),this.preventDefault&&t.preventDefault();for(e=0;e<t.changedTouches.length;e++)this.game.input.stopPointer(t.changedTouches[e])},stop:function(){this.game.device.touch&&(this.game.canvas.removeEventListener("touchstart",this._onTouchStart),this.game.canvas.removeEventListener("touchmove",this._onTouchMove),this.game.canvas.removeEventListener("touchend",this._onTouchEnd),this.game.canvas.removeEventListener("touchenter",this._onTouchEnter),this.game.canvas.removeEventListener("touchleave",this._onTouchLeave),this.game.canvas.removeEventListener("touchcancel",this._onTouchCancel))}},U.Touch.prototype.constructor=U.Touch,U.InputHandler=function(t){this.sprite=t,this.game=t.game,this.enabled=!1,this.checked=!1,this.priorityID=0,this.useHandCursor=!1,this._setHandCursor=!1,this.isDragged=!1,this.allowHorizontalDrag=!0,this.allowVerticalDrag=!0,this.bringToTop=!1,this.snapOffset=null,this.snapOnDrag=!1,this.snapOnRelease=!1,this.snapX=0,this.snapY=0,this.snapOffsetX=0,this.snapOffsetY=0,this.pixelPerfectOver=!1,this.pixelPerfectClick=!1,this.pixelPerfectAlpha=255,this.draggable=!1,this.boundsRect=null,this.boundsSprite=null,this.scaleLayer=!1,this.dragOffset=new U.Point,this.dragFromCenter=!1,this.dragStopBlocksInputUp=!1,this.dragStartPoint=new U.Point,this.dragDistanceThreshold=0,this.dragTimeThreshold=0,this.downPoint=new U.Point,this.snapPoint=new U.Point,this._dragPoint=new U.Point,this._dragPhase=!1,this._pendingDrag=!1,this._dragTimePass=!1,this._dragDistancePass=!1,this._wasEnabled=!1,this._tempPoint=new U.Point,this._pointerData=[],this._pointerData.push({id:0,x:0,y:0,camX:0,camY:0,isDown:!1,isUp:!1,isOver:!1,isOut:!1,timeOver:0,timeOut:0,timeDown:0,timeUp:0,downDuration:0,isDragged:!1})},U.InputHandler.prototype={start:function(t,e){if(t=t||0,void 0===e&&(e=!1),!1===this.enabled){this.game.input.interactiveItems.add(this),this.useHandCursor=e,this.priorityID=t;for(var i=0;i<10;i++)this._pointerData[i]={id:i,x:0,y:0,isDown:!1,isUp:!1,isOver:!1,isOut:!1,timeOver:0,timeOut:0,timeDown:0,timeUp:0,downDuration:0,isDragged:!1};this.snapOffset=new U.Point,this.enabled=!0,this._wasEnabled=!0}return this.sprite.events.onAddedToGroup.add(this.addedToGroup,this),this.sprite.events.onRemovedFromGroup.add(this.removedFromGroup,this),this.sprite},addedToGroup:function(){this._dragPhase||this._wasEnabled&&!this.enabled&&this.start()},removedFromGroup:function(){this._dragPhase||(this.enabled?(this._wasEnabled=!0,this.stop()):this._wasEnabled=!1)},reset:function(){this.enabled=!1;for(var t=0;t<10;t++)this._pointerData[t]={id:t,x:0,y:0,isDown:!1,isUp:!1,isOver:!1,isOut:!1,timeOver:0,timeOut:0,timeDown:0,timeUp:0,downDuration:0,isDragged:!1}},stop:function(){!1!==this.enabled&&(this.enabled=!1,this.game.input.interactiveItems.remove(this))},destroy:function(){this.sprite&&(this._setHandCursor&&(this.game.canvas.style.cursor="default",this._setHandCursor=!1),this.enabled=!1,this.game.input.interactiveItems.remove(this),this._pointerData.length=0,this.boundsRect=null,this.boundsSprite=null,this.sprite=null)},validForInput:function(t,e,i){return void 0===i&&(i=!0),!(!this.enabled||0===this.sprite.scale.x||0===this.sprite.scale.y||this.priorityID<this.game.input.minPriorityID||this.sprite.parent&&this.sprite.parent.ignoreChildInput||!i&&(this.pixelPerfectClick||this.pixelPerfectOver)||!(this.priorityID>t||this.priorityID===t&&this.sprite.renderOrderID>e))},isPixelPerfect:function(){return this.pixelPerfectClick||this.pixelPerfectOver},pointerX:function(t){return this._pointerData[t=t||0].x},pointerY:function(t){return this._pointerData[t=t||0].y},pointerDown:function(t){return this._pointerData[t=t||0].isDown},pointerUp:function(t){return this._pointerData[t=t||0].isUp},pointerTimeDown:function(t){return this._pointerData[t=t||0].timeDown},pointerTimeUp:function(t){return this._pointerData[t=t||0].timeUp},pointerOver:function(t){if(!this.enabled)return!1;if(void 0!==t)return this._pointerData[t].isOver;for(var e=0;e<10;e++)if(this._pointerData[e].isOver)return!0;return!1},pointerOut:function(t){if(!this.enabled)return!1;if(void 0!==t)return this._pointerData[t].isOut;for(var e=0;e<10;e++)if(this._pointerData[e].isOut)return!0},pointerTimeOver:function(t){return this._pointerData[t=t||0].timeOver},pointerTimeOut:function(t){return this._pointerData[t=t||0].timeOut},pointerDragged:function(t){return this._pointerData[t=t||0].isDragged},checkPointerDown:function(t,e){return!!(t.isDown&&this.enabled&&this.sprite&&this.sprite.parent&&this.sprite.visible&&this.sprite.parent.visible&&0!==this.sprite.worldScale.x&&0!==this.sprite.worldScale.y)&&!!this.game.input.hitTest(this.sprite,t,this._tempPoint)&&(!(!(e=void 0===e?!1:e)&&this.pixelPerfectClick)||this.checkPixel(this._tempPoint.x,this._tempPoint.y))},checkPointerOver:function(t,e){return!!(this.enabled&&this.sprite&&this.sprite.parent&&this.sprite.visible&&this.sprite.parent.visible&&0!==this.sprite.worldScale.x&&0!==this.sprite.worldScale.y)&&!!this.game.input.hitTest(this.sprite,t,this._tempPoint)&&(!(!(e=void 0===e?!1:e)&&this.pixelPerfectOver)||this.checkPixel(this._tempPoint.x,this._tempPoint.y))},checkPixel:function(t,e,i){if(this.sprite.texture.baseTexture.source){if(null===t&&null===e&&(this.game.input.getLocalPosition(this.sprite,i,this._tempPoint),t=this._tempPoint.x,e=this._tempPoint.y),0!==this.sprite.anchor.x&&(t-=-this.sprite.texture.frame.width*this.sprite.anchor.x),0!==this.sprite.anchor.y&&(e-=-this.sprite.texture.frame.height*this.sprite.anchor.y),t+=this.sprite.texture.frame.x,e+=this.sprite.texture.frame.y,this.sprite.texture.trim&&(t-=this.sprite.texture.trim.x,e-=this.sprite.texture.trim.y,t<this.sprite.texture.crop.x||t>this.sprite.texture.crop.right||e<this.sprite.texture.crop.y||e>this.sprite.texture.crop.bottom))return this._dx=t,this._dy=e,!1;if(this._dx=t,this._dy=e,this.game.input.hitContext.clearRect(0,0,1,1),this.game.input.hitContext.drawImage(this.sprite.texture.baseTexture.source,t,e,1,1,0,0,1,1),this.game.input.hitContext.getImageData(0,0,1,1).data[3]>=this.pixelPerfectAlpha)return!0}return!1},update:function(t){if(null!==this.sprite&&void 0!==this.sprite.parent)return this.enabled&&this.sprite.visible&&this.sprite.parent.visible?this._pendingDrag?(this._dragDistancePass||(this._dragDistancePass=U.Math.distance(t.x,t.y,this.downPoint.x,this.downPoint.y)>=this.dragDistanceThreshold),this._dragDistancePass&&this._dragTimePass&&this.startDrag(t),!0):this.draggable&&this._draggedPointerID===t.id?this.updateDrag(t,!1):this._pointerData[t.id].isOver?this.checkPointerOver(t)?(this._pointerData[t.id].x=t.x-this.sprite.x,this._pointerData[t.id].y=t.y-this.sprite.y,!0):(this._pointerOutHandler(t),!1):void 0:(this._pointerOutHandler(t),!1)},_pointerOverHandler:function(t,e){var i,n;null!==this.sprite&&(!1!==(i=this._pointerData[t.id]).isOver&&!t.dirty||(n=!1===i.isOver,i.isOver=!0,i.isOut=!1,i.timeOver=this.game.time.time,i.x=t.x-this.sprite.x,i.y=t.y-this.sprite.y,this.useHandCursor&&!1===i.isDragged&&(this.game.canvas.style.cursor="pointer",this._setHandCursor=!0),!e&&n&&this.sprite&&this.sprite.events&&this.sprite.events.onInputOver$dispatch(this.sprite,t),this.sprite.parent&&this.sprite.parent.type===U.GROUP&&this.sprite.parent.onChildInputOver.dispatch(this.sprite,t)))},_pointerOutHandler:function(t,e){var i;null!==this.sprite&&((i=this._pointerData[t.id]).isOver=!1,i.isOut=!0,i.timeOut=this.game.time.time,this.useHandCursor&&!1===i.isDragged&&(this.game.canvas.style.cursor="default",this._setHandCursor=!1),!e&&this.sprite&&this.sprite.events&&(this.sprite.events.onInputOut$dispatch(this.sprite,t),this.sprite&&this.sprite.parent&&this.sprite.parent.type===U.GROUP&&this.sprite.parent.onChildInputOut.dispatch(this.sprite,t)))},_touchedHandler:function(t){var e;null===this.sprite||!(e=this._pointerData[t.id]).isDown&&e.isOver&&(this.pixelPerfectClick&&!this.checkPixel(null,null,t)||(e.isDown=!0,e.isUp=!1,e.timeDown=this.game.time.time,this.downPoint.set(t.x,t.y),t.dirty=!0,this.sprite&&this.sprite.events&&(this.sprite.events.onInputDown$dispatch(this.sprite,t),this.sprite&&this.sprite.parent&&this.sprite.parent.type===U.GROUP&&this.sprite.parent.onChildInputDown.dispatch(this.sprite,t),null===this.sprite)||(this.draggable&&!1===this.isDragged&&(0===this.dragTimeThreshold&&0===this.dragDistanceThreshold?this.startDrag(t):(this._pendingDrag=!0,this._dragDistancePass=0===this.dragDistanceThreshold,0<this.dragTimeThreshold?(this._dragTimePass=!1,this.game.time.events.add(this.dragTimeThreshold,this.dragTimeElapsed,this,t)):this._dragTimePass=!0)),this.bringToTop&&this.sprite.bringToTop())))},dragTimeElapsed:function(t){this._dragTimePass=!0,this._pendingDrag&&this.sprite&&this._dragDistancePass&&this.startDrag(t)},_releasedHandler:function(t){var e,i;null===this.sprite||(e=this._pointerData[t.id]).isDown&&t.isUp&&(e.isDown=!1,e.isUp=!0,e.timeUp=this.game.time.time,e.downDuration=e.timeUp-e.timeDown,i=this.checkPointerOver(t),this.sprite&&this.sprite.events&&(this.dragStopBlocksInputUp&&(!this.dragStopBlocksInputUp||this.draggable&&this.isDragged&&this._draggedPointerID===t.id)||this.sprite.events.onInputUp$dispatch(this.sprite,t,i),this.sprite&&this.sprite.parent&&this.sprite.parent.type===U.GROUP&&this.sprite.parent.onChildInputUp.dispatch(this.sprite,t,i),i=i&&this.checkPointerOver(t)),!(e.isOver=i)&&this.useHandCursor&&(this.game.canvas.style.cursor="default",this._setHandCursor=!1),t.dirty=!0,this._pendingDrag=!1,this.draggable&&this.isDragged&&this._draggedPointerID===t.id&&this.stopDrag(t))},updateDrag:function(t,e){if(void 0===e&&(e=!1),t.isUp)return this.stopDrag(t),!1;var i,n,r=this.globalToLocalX(t.x)+this._dragPoint.x+this.dragOffset.x,o=this.globalToLocalY(t.y)+this._dragPoint.y+this.dragOffset.y;return this.sprite.fixedToCamera?(this.allowHorizontalDrag&&(this.sprite.cameraOffset.x=r),this.allowVerticalDrag&&(this.sprite.cameraOffset.y=o),this.boundsRect&&this.checkBoundsRect(),this.boundsSprite&&this.checkBoundsSprite(),this.snapOnDrag&&(this.sprite.cameraOffset.x=Math.round((this.sprite.cameraOffset.x-this.snapOffsetX%this.snapX)/this.snapX)*this.snapX+this.snapOffsetX%this.snapX,this.sprite.cameraOffset.y=Math.round((this.sprite.cameraOffset.y-this.snapOffsetY%this.snapY)/this.snapY)*this.snapY+this.snapOffsetY%this.snapY,this.snapPoint.set(this.sprite.cameraOffset.x,this.sprite.cameraOffset.y))):(i=this.game.camera.x-this._pointerData[t.id].camX,n=this.game.camera.y-this._pointerData[t.id].camY,this.allowHorizontalDrag&&(this.sprite.x=r+i),this.allowVerticalDrag&&(this.sprite.y=o+n),this.boundsRect&&this.checkBoundsRect(),this.boundsSprite&&this.checkBoundsSprite(),this.snapOnDrag&&(this.sprite.x=Math.round((this.sprite.x-this.snapOffsetX%this.snapX)/this.snapX)*this.snapX+this.snapOffsetX%this.snapX,this.sprite.y=Math.round((this.sprite.y-this.snapOffsetY%this.snapY)/this.snapY)*this.snapY+this.snapOffsetY%this.snapY,this.snapPoint.set(this.sprite.x,this.sprite.y))),this.sprite.events.onDragUpdate.dispatch(this.sprite,t,r,o,this.snapPoint,e),!0},justOver:function(t,e){return e=e||500,this._pointerData[t=t||0].isOver&&this.overDuration(t)<e},justOut:function(t,e){return e=e||500,this._pointerData[t=t||0].isOut&&this.game.time.time-this._pointerData[t].timeOut<e},justPressed:function(t,e){return e=e||500,this._pointerData[t=t||0].isDown&&this.downDuration(t)<e},justReleased:function(t,e){return e=e||500,this._pointerData[t=t||0].isUp&&this.game.time.time-this._pointerData[t].timeUp<e},overDuration:function(t){return this._pointerData[t=t||0].isOver?this.game.time.time-this._pointerData[t].timeOver:-1},downDuration:function(t){return this._pointerData[t=t||0].isDown?this.game.time.time-this._pointerData[t].timeDown:-1},enableDrag:function(t,e,i,n,r,o){void 0===t&&(t=!1),void 0===e&&(e=!1),void 0===i&&(i=!1),void 0===n&&(n=255),void 0===r&&(r=null),void 0===o&&(o=null),this._dragPoint=new U.Point,this.draggable=!0,this.bringToTop=e,this.dragOffset=new U.Point,this.dragFromCenter=t,this.pixelPerfectClick=i,this.pixelPerfectAlpha=n,r&&(this.boundsRect=r),o&&(this.boundsSprite=o)},disableDrag:function(){if(this._pointerData)for(var t=0;t<10;t++)this._pointerData[t].isDragged=!1;this.draggable=!1,this.isDragged=!1,this._draggedPointerID=-1,this._pendingDrag=!1},startDrag:function(t){var e,i=this.sprite.x,n=this.sprite.y;this.isDragged=!0,this._draggedPointerID=t.id,this._pointerData[t.id].camX=this.game.camera.x,this._pointerData[t.id].camY=this.game.camera.y,this._pointerData[t.id].isDragged=!0,this.sprite.fixedToCamera?(this.dragFromCenter&&(e=this.sprite.getBounds(),this.sprite.cameraOffset.x=this.globalToLocalX(t.x)+(this.sprite.cameraOffset.x-e.centerX),this.sprite.cameraOffset.y=this.globalToLocalY(t.y)+(this.sprite.cameraOffset.y-e.centerY)),this._dragPoint.setTo(this.sprite.cameraOffset.x-t.x,this.sprite.cameraOffset.y-t.y)):(this.dragFromCenter&&(e=this.sprite.getBounds(),this.sprite.x=this.globalToLocalX(t.x)+(this.sprite.x-e.centerX),this.sprite.y=this.globalToLocalY(t.y)+(this.sprite.y-e.centerY)),this._dragPoint.setTo(this.sprite.x-this.globalToLocalX(t.x),this.sprite.y-this.globalToLocalY(t.y))),this.updateDrag(t,!0),this.bringToTop&&(this._dragPhase=!0,this.sprite.bringToTop()),this.dragStartPoint.set(i,n),this.sprite.events.onDragStart$dispatch(this.sprite,t,i,n),this._pendingDrag=!1},globalToLocalX:function(t){return this.scaleLayer&&(t-=this.game.scale.grid.boundsFluid.x,t*=this.game.scale.grid.scaleFluidInversed.x),t},globalToLocalY:function(t){return this.scaleLayer&&(t-=this.game.scale.grid.boundsFluid.y,t*=this.game.scale.grid.scaleFluidInversed.y),t},stopDrag:function(t){this.isDragged=!1,this._draggedPointerID=-1,this._pointerData[t.id].isDragged=!1,this._dragPhase=!1,this._pendingDrag=!1,this.snapOnRelease&&(this.sprite.fixedToCamera?(this.sprite.cameraOffset.x=Math.round((this.sprite.cameraOffset.x-this.snapOffsetX%this.snapX)/this.snapX)*this.snapX+this.snapOffsetX%this.snapX,this.sprite.cameraOffset.y=Math.round((this.sprite.cameraOffset.y-this.snapOffsetY%this.snapY)/this.snapY)*this.snapY+this.snapOffsetY%this.snapY):(this.sprite.x=Math.round((this.sprite.x-this.snapOffsetX%this.snapX)/this.snapX)*this.snapX+this.snapOffsetX%this.snapX,this.sprite.y=Math.round((this.sprite.y-this.snapOffsetY%this.snapY)/this.snapY)*this.snapY+this.snapOffsetY%this.snapY)),this.sprite.events.onDragStop$dispatch(this.sprite,t),!1===this.checkPointerOver(t)&&this._pointerOutHandler(t)},setDragLock:function(t,e){void 0===e&&(e=!0),this.allowHorizontalDrag=t=void 0===t?!0:t,this.allowVerticalDrag=e},enableSnap:function(t,e,i,n,r,o){void 0===i&&(i=!0),void 0===n&&(n=!1),void 0===r&&(r=0),void 0===o&&(o=0),this.snapX=t,this.snapY=e,this.snapOffsetX=r,this.snapOffsetY=o,this.snapOnDrag=i,this.snapOnRelease=n},disableSnap:function(){this.snapOnDrag=!1,this.snapOnRelease=!1},checkBoundsRect:function(){this.sprite.fixedToCamera?(this.sprite.cameraOffset.x<this.boundsRect.left?this.sprite.cameraOffset.x=this.boundsRect.left:this.sprite.cameraOffset.x+this.sprite.width>this.boundsRect.right&&(this.sprite.cameraOffset.x=this.boundsRect.right-this.sprite.width),this.sprite.cameraOffset.y<this.boundsRect.top?this.sprite.cameraOffset.y=this.boundsRect.top:this.sprite.cameraOffset.y+this.sprite.height>this.boundsRect.bottom&&(this.sprite.cameraOffset.y=this.boundsRect.bottom-this.sprite.height)):(this.sprite.left<this.boundsRect.left?this.sprite.x=this.boundsRect.x+this.sprite.offsetX:this.sprite.right>this.boundsRect.right&&(this.sprite.x=this.boundsRect.right-(this.sprite.width-this.sprite.offsetX)),this.sprite.top<this.boundsRect.top?this.sprite.y=this.boundsRect.top+this.sprite.offsetY:this.sprite.bottom>this.boundsRect.bottom&&(this.sprite.y=this.boundsRect.bottom-(this.sprite.height-this.sprite.offsetY)))},checkBoundsSprite:function(){this.sprite.fixedToCamera&&this.boundsSprite.fixedToCamera?(this.sprite.cameraOffset.x<this.boundsSprite.cameraOffset.x?this.sprite.cameraOffset.x=this.boundsSprite.cameraOffset.x:this.sprite.cameraOffset.x+this.sprite.width>this.boundsSprite.cameraOffset.x+this.boundsSprite.width&&(this.sprite.cameraOffset.x=this.boundsSprite.cameraOffset.x+this.boundsSprite.width-this.sprite.width),this.sprite.cameraOffset.y<this.boundsSprite.cameraOffset.y?this.sprite.cameraOffset.y=this.boundsSprite.cameraOffset.y:this.sprite.cameraOffset.y+this.sprite.height>this.boundsSprite.cameraOffset.y+this.boundsSprite.height&&(this.sprite.cameraOffset.y=this.boundsSprite.cameraOffset.y+this.boundsSprite.height-this.sprite.height)):(this.sprite.left<this.boundsSprite.left?this.sprite.x=this.boundsSprite.left+this.sprite.offsetX:this.sprite.right>this.boundsSprite.right&&(this.sprite.x=this.boundsSprite.right-(this.sprite.width-this.sprite.offsetX)),this.sprite.top<this.boundsSprite.top?this.sprite.y=this.boundsSprite.top+this.sprite.offsetY:this.sprite.bottom>this.boundsSprite.bottom&&(this.sprite.y=this.boundsSprite.bottom-(this.sprite.height-this.sprite.offsetY)))}},U.InputHandler.prototype.constructor=U.InputHandler,U.Gamepad=function(t){this.game=t,this._gamepadIndexMap={},this._rawPads=[],this._active=!1,this.enabled=!0,this._gamepadSupportAvailable=!!navigator.webkitGetGamepads||!!navigator.webkitGamepads||-1!==navigator.userAgent.indexOf("Firefox/")||!!navigator.getGamepads,this._prevRawGamepadTypes=[],this._prevTimestamps=[],(this.callbackContext=this).onConnectCallback=null,this.onDisconnectCallback=null,this.onDownCallback=null,this.onUpCallback=null,this.onAxisCallback=null,this.onFloatCallback=null,this._ongamepadconnected=null,this._gamepaddisconnected=null,this._gamepads=[new U.SinglePad(t,this),new U.SinglePad(t,this),new U.SinglePad(t,this),new U.SinglePad(t,this)]},U.Gamepad.prototype={addCallbacks:function(t,e){void 0!==e&&(this.onConnectCallback="function"==typeof e.onConnect?e.onConnect:this.onConnectCallback,this.onDisconnectCallback="function"==typeof e.onDisconnect?e.onDisconnect:this.onDisconnectCallback,this.onDownCallback="function"==typeof e.onDown?e.onDown:this.onDownCallback,this.onUpCallback="function"==typeof e.onUp?e.onUp:this.onUpCallback,this.onAxisCallback="function"==typeof e.onAxis?e.onAxis:this.onAxisCallback,this.onFloatCallback="function"==typeof e.onFloat?e.onFloat:this.onFloatCallback,this.callbackContext=t)},start:function(){var e;this._active||(this._active=!0,(e=this)._onGamepadConnected=function(t){return e.onGamepadConnected(t)},this._onGamepadDisconnected=function(t){return e.onGamepadDisconnected(t)},window.addEventListener("gamepadconnected",this._onGamepadConnected,!1),window.addEventListener("gamepaddisconnected",this._onGamepadDisconnected,!1))},onGamepadConnected:function(t){t=t.gamepad;this._rawPads.push(t),this._gamepads[t.index].connect(t)},onGamepadDisconnected:function(t){var e,i=t.gamepad;for(e in this._rawPads)this._rawPads[e].index===i.index&&this._rawPads.splice(e,1);this._gamepads[i.index].disconnect()},update:function(){this._pollGamepads(),this.pad1.pollStatus(),this.pad2.pollStatus(),this.pad3.pollStatus(),this.pad4.pollStatus()},_pollGamepads:function(){var t;if(this._active&&(navigator.getGamepads?t=navigator.getGamepads():navigator.webkitGetGamepads?t=navigator.webkitGetGamepads():navigator.webkitGamepads&&(t=navigator.webkitGamepads()),t)){for(var e=!(this._rawPads=[]),i=0;i<t.length&&(typeof t[i]!==this._prevRawGamepadTypes[i]&&(e=!0,this._prevRawGamepadTypes[i]=typeof t[i]),t[i]&&this._rawPads.push(t[i]),3!==i);i++);for(var n=0;n<this._gamepads.length;n++)this._gamepads[n]._rawPad=this._rawPads[n];if(e){for(var r,o={rawIndices:{},padIndices:{}},s=0;s<this._gamepads.length;s++)if((r=this._gamepads[s]).connected)for(var a=0;a<this._rawPads.length;a++)this._rawPads[a].index===r.index&&(o.rawIndices[r.index]=!0,o.padIndices[s]=!0);for(var h=0;h<this._gamepads.length;h++)if(r=this._gamepads[h],!o.padIndices[h]){this._rawPads.length<1&&r.disconnect();for(var l=0;l<this._rawPads.length&&!o.padIndices[h];l++){var p=this._rawPads[l];!p||o.rawIndices[p.index]?r.disconnect():(r.connect(p),o.rawIndices[p.index]=!0,o.padIndices[h]=!0)}}}}},setDeadZones:function(t){for(var e=0;e<this._gamepads.length;e++)this._gamepads[e].deadZone=t},stop:function(){this._active=!1,window.removeEventListener("gamepadconnected",this._onGamepadConnected),window.removeEventListener("gamepaddisconnected",this._onGamepadDisconnected)},reset:function(){this.update();for(var t=0;t<this._gamepads.length;t++)this._gamepads[t].reset()},justPressed:function(t,e){for(var i=0;i<this._gamepads.length;i++)if(!0===this._gamepads[i].justPressed(t,e))return!0;return!1},justReleased:function(t,e){for(var i=0;i<this._gamepads.length;i++)if(!0===this._gamepads[i].justReleased(t,e))return!0;return!1},isDown:function(t){for(var e=0;e<this._gamepads.length;e++)if(!0===this._gamepads[e].isDown(t))return!0;return!1},destroy:function(){this.stop();for(var t=0;t<this._gamepads.length;t++)this._gamepads[t].destroy()}},U.Gamepad.prototype.constructor=U.Gamepad,Object.defineProperty(U.Gamepad.prototype,"active",{get:function(){return this._active}}),Object.defineProperty(U.Gamepad.prototype,"supported",{get:function(){return this._gamepadSupportAvailable}}),Object.defineProperty(U.Gamepad.prototype,"padsConnected",{get:function(){return this._rawPads.length}}),Object.defineProperty(U.Gamepad.prototype,"pad1",{get:function(){return this._gamepads[0]}}),Object.defineProperty(U.Gamepad.prototype,"pad2",{get:function(){return this._gamepads[1]}}),Object.defineProperty(U.Gamepad.prototype,"pad3",{get:function(){return this._gamepads[2]}}),Object.defineProperty(U.Gamepad.prototype,"pad4",{get:function(){return this._gamepads[3]}}),U.Gamepad.BUTTON_0=0,U.Gamepad.BUTTON_1=1,U.Gamepad.BUTTON_2=2,U.Gamepad.BUTTON_3=3,U.Gamepad.BUTTON_4=4,U.Gamepad.BUTTON_5=5,U.Gamepad.BUTTON_6=6,U.Gamepad.BUTTON_7=7,U.Gamepad.BUTTON_8=8,U.Gamepad.BUTTON_9=9,U.Gamepad.BUTTON_10=10,U.Gamepad.BUTTON_11=11,U.Gamepad.BUTTON_12=12,U.Gamepad.BUTTON_13=13,U.Gamepad.BUTTON_14=14,U.Gamepad.BUTTON_15=15,U.Gamepad.AXIS_0=0,U.Gamepad.AXIS_1=1,U.Gamepad.AXIS_2=2,U.Gamepad.AXIS_3=3,U.Gamepad.AXIS_4=4,U.Gamepad.AXIS_5=5,U.Gamepad.AXIS_6=6,U.Gamepad.AXIS_7=7,U.Gamepad.AXIS_8=8,U.Gamepad.AXIS_9=9,U.Gamepad.XBOX360_A=0,U.Gamepad.XBOX360_B=1,U.Gamepad.XBOX360_X=2,U.Gamepad.XBOX360_Y=3,U.Gamepad.XBOX360_LEFT_BUMPER=4,U.Gamepad.XBOX360_RIGHT_BUMPER=5,U.Gamepad.XBOX360_LEFT_TRIGGER=6,U.Gamepad.XBOX360_RIGHT_TRIGGER=7,U.Gamepad.XBOX360_BACK=8,U.Gamepad.XBOX360_START=9,U.Gamepad.XBOX360_STICK_LEFT_BUTTON=10,U.Gamepad.XBOX360_STICK_RIGHT_BUTTON=11,U.Gamepad.XBOX360_DPAD_LEFT=14,U.Gamepad.XBOX360_DPAD_RIGHT=15,U.Gamepad.XBOX360_DPAD_UP=12,U.Gamepad.XBOX360_DPAD_DOWN=13,U.Gamepad.XBOX360_STICK_LEFT_X=0,U.Gamepad.XBOX360_STICK_LEFT_Y=1,U.Gamepad.XBOX360_STICK_RIGHT_X=2,U.Gamepad.XBOX360_STICK_RIGHT_Y=3,U.Gamepad.PS3XC_X=0,U.Gamepad.PS3XC_CIRCLE=1,U.Gamepad.PS3XC_SQUARE=2,U.Gamepad.PS3XC_TRIANGLE=3,U.Gamepad.PS3XC_L1=4,U.Gamepad.PS3XC_R1=5,U.Gamepad.PS3XC_L2=6,U.Gamepad.PS3XC_R2=7,U.Gamepad.PS3XC_SELECT=8,U.Gamepad.PS3XC_START=9,U.Gamepad.PS3XC_STICK_LEFT_BUTTON=10,U.Gamepad.PS3XC_STICK_RIGHT_BUTTON=11,U.Gamepad.PS3XC_DPAD_UP=12,U.Gamepad.PS3XC_DPAD_DOWN=13,U.Gamepad.PS3XC_DPAD_LEFT=14,U.Gamepad.PS3XC_DPAD_RIGHT=15,U.Gamepad.PS3XC_STICK_LEFT_X=0,U.Gamepad.PS3XC_STICK_LEFT_Y=1,U.Gamepad.PS3XC_STICK_RIGHT_X=2,U.Gamepad.PS3XC_STICK_RIGHT_Y=3,U.SinglePad=function(t,e){this.game=t,this.index=null,this.connected=!1,(this.callbackContext=this).onConnectCallback=null,this.onDisconnectCallback=null,this.onDownCallback=null,this.onUpCallback=null,this.onAxisCallback=null,this.onFloatCallback=null,this.deadZone=.26,this._padParent=e,this._rawPad=null,this._prevTimestamp=null,this._buttons=[],this._buttonsLen=0,this._axes=[],this._axesLen=0},U.SinglePad.prototype={addCallbacks:function(t,e){void 0!==e&&(this.onConnectCallback="function"==typeof e.onConnect?e.onConnect:this.onConnectCallback,this.onDisconnectCallback="function"==typeof e.onDisconnect?e.onDisconnect:this.onDisconnectCallback,this.onDownCallback="function"==typeof e.onDown?e.onDown:this.onDownCallback,this.onUpCallback="function"==typeof e.onUp?e.onUp:this.onUpCallback,this.onAxisCallback="function"==typeof e.onAxis?e.onAxis:this.onAxisCallback,this.onFloatCallback="function"==typeof e.onFloat?e.onFloat:this.onFloatCallback,this.callbackContext=t)},getButton:function(t){return this._buttons[t]||null},pollStatus:function(){if(this.connected&&this.game.input.enabled&&this.game.input.gamepad.enabled&&(!this._rawPad.timestamp||this._rawPad.timestamp!==this._prevTimestamp)){for(var t=0;t<this._buttonsLen;t++){var e=isNaN(this._rawPad.buttons[t])?this._rawPad.buttons[t].value:this._rawPad.buttons[t];e!==this._buttons[t].value&&(1===e?this.processButtonDown(t,e):0===e?this.processButtonUp(t,e):this.processButtonFloat(t,e))}for(var i=0;i<this._axesLen;i++){var n=this._rawPad.axes[i];0<n&&n>this.deadZone||n<0&&n<-this.deadZone?this.processAxisChange(i,n):this.processAxisChange(i,0)}this._prevTimestamp=this._rawPad.timestamp}},connect:function(t){var e=!this.connected;this.connected=!0,this.index=t.index,this._rawPad=t,this._buttons=[],this._buttonsLen=t.buttons.length,this._axes=[],this._axesLen=t.axes.length;for(var i,n=0;n<this._axesLen;n++)this._axes[n]=t.axes[n];for(i in t.buttons)i=parseInt(i,10),this._buttons[i]=new U.DeviceButton(this,i);e&&this._padParent.onConnectCallback&&this._padParent.onConnectCallback.call(this._padParent.callbackContext,this.index),e&&this.onConnectCallback&&this.onConnectCallback.call(this.callbackContext)},disconnect:function(){var t=this.connected,e=this.index;this.connected=!1,this.index=null,this._rawPad=void 0;for(var i=0;i<this._buttonsLen;i++)this._buttons[i].destroy();this._buttons=[],this._buttonsLen=0,this._axes=[],this._axesLen=0,t&&this._padParent.onDisconnectCallback&&this._padParent.onDisconnectCallback.call(this._padParent.callbackContext,e),t&&this.onDisconnectCallback&&this.onDisconnectCallback.call(this.callbackContext)},destroy:function(){this._rawPad=void 0;for(var t=0;t<this._buttonsLen;t++)this._buttons[t].destroy();this._buttons=[],this._buttonsLen=0,this._axes=[],this._axesLen=0,this.onConnectCallback=null,this.onDisconnectCallback=null,this.onDownCallback=null,this.onUpCallback=null,this.onAxisCallback=null,this.onFloatCallback=null},processAxisChange:function(t,e){this._axes[t]!==e&&(this._axes[t]=e,this._padParent.onAxisCallback&&this._padParent.onAxisCallback.call(this._padParent.callbackContext,this,t,e),this.onAxisCallback&&this.onAxisCallback.call(this.callbackContext,this,t,e))},processButtonDown:function(t,e){this._buttons[t]&&this._buttons[t].start(null,e),this._padParent.onDownCallback&&this._padParent.onDownCallback.call(this._padParent.callbackContext,t,e,this.index),this.onDownCallback&&this.onDownCallback.call(this.callbackContext,t,e)},processButtonUp:function(t,e){this._padParent.onUpCallback&&this._padParent.onUpCallback.call(this._padParent.callbackContext,t,e,this.index),this.onUpCallback&&this.onUpCallback.call(this.callbackContext,t,e),this._buttons[t]&&this._buttons[t].stop(null,e)},processButtonFloat:function(t,e){this._padParent.onFloatCallback&&this._padParent.onFloatCallback.call(this._padParent.callbackContext,t,e,this.index),this.onFloatCallback&&this.onFloatCallback.call(this.callbackContext,t,e),this._buttons[t]&&this._buttons[t].padFloat(e)},axis:function(t){return!!this._axes[t]&&this._axes[t]},isDown:function(t){return!!this._buttons[t]&&this._buttons[t].isDown},isUp:function(t){return!!this._buttons[t]&&this._buttons[t].isUp},justReleased:function(t,e){if(this._buttons[t])return this._buttons[t].justReleased(e)},justPressed:function(t,e){if(this._buttons[t])return this._buttons[t].justPressed(e)},buttonValue:function(t){return this._buttons[t]?this._buttons[t].value:null},reset:function(){for(var t=0;t<this._axes.length;t++)this._axes[t]=0}},U.SinglePad.prototype.constructor=U.SinglePad,U.Key=function(t,e){this.game=t,this._enabled=!0,this.event=null,this.isDown=!1,this.isUp=!0,this.altKey=!1,this.ctrlKey=!1,this.shiftKey=!1,this.timeDown=0,this.duration=0,this.timeUp=-2500,this.repeats=0,this.keyCode=e,this.onDown=new U.Signal,this.onHoldCallback=null,this.onHoldContext=null,this.onUp=new U.Signal,this._justDown=!1,this._justUp=!1},U.Key.prototype={update:function(){this._enabled&&this.isDown&&(this.duration=this.game.time.time-this.timeDown,this.repeats++,this.onHoldCallback&&this.onHoldCallback.call(this.onHoldContext,this))},processKeyDown:function(t){this._enabled&&(this.event=t,this.isDown||(this.altKey=t.altKey,this.ctrlKey=t.ctrlKey,this.shiftKey=t.shiftKey,this.isDown=!0,this.isUp=!1,this.timeDown=this.game.time.time,this.duration=0,this.repeats=0,this._justDown=!0,this.onDown.dispatch(this)))},processKeyUp:function(t){this._enabled&&(this.event=t,this.isUp||(this.isDown=!1,this.isUp=!0,this.timeUp=this.game.time.time,this.duration=this.game.time.time-this.timeDown,this._justUp=!0,this.onUp.dispatch(this)))},reset:function(t){void 0===t&&(t=!0),this.isDown=!1,this.isUp=!0,this.timeUp=this.game.time.time,this.duration=0,this._enabled=!0,this._justDown=!1,this._justUp=!1,t&&(this.onDown.removeAll(),this.onUp.removeAll(),this.onHoldCallback=null,this.onHoldContext=null)},downDuration:function(t){return void 0===t&&(t=50),this.isDown&&this.duration<t},upDuration:function(t){return void 0===t&&(t=50),!this.isDown&&this.game.time.time-this.timeUp<t}},Object.defineProperty(U.Key.prototype,"justDown",{get:function(){var t=this._justDown;return this._justDown=!1,t}}),Object.defineProperty(U.Key.prototype,"justUp",{get:function(){var t=this._justUp;return this._justUp=!1,t}}),Object.defineProperty(U.Key.prototype,"enabled",{get:function(){return this._enabled},set:function(t){(t=!!t)!==this._enabled&&(t||this.reset(!1),this._enabled=t)}}),U.Key.prototype.constructor=U.Key,U.Keyboard=function(t){this.game=t,this.enabled=!0,this.event=null,this.pressEvent=null,(this.callbackContext=this).onDownCallback=null,this.onPressCallback=null,this.onUpCallback=null,this._keys=[],this._capture=[],this._onKeyDown=null,this._onKeyPress=null,this._onKeyUp=null,this._i=0,this._k=0},U.Keyboard.prototype={addCallbacks:function(t,e,i,n){this.callbackContext=t,null!=e&&(this.onDownCallback=e),null!=i&&(this.onUpCallback=i),null!=n&&(this.onPressCallback=n)},addKey:function(t){return this._keys[t]||(this._keys[t]=new U.Key(this.game,t),this.addKeyCapture(t)),this._keys[t]},addKeys:function(t){var e,i={};for(e in t)i[e]=this.addKey(t[e]);return i},removeKey:function(t){this._keys[t]&&(this._keys[t]=null,this.removeKeyCapture(t))},createCursorKeys:function(){return this.addKeys({up:U.KeyCode.UP,down:U.KeyCode.DOWN,left:U.KeyCode.LEFT,right:U.KeyCode.RIGHT})},start:function(){var e;this.game.device.cocoonJS||null!==this._onKeyDown||((e=this)._onKeyDown=function(t){return e.processKeyDown(t)},this._onKeyUp=function(t){return e.processKeyUp(t)},this._onKeyPress=function(t){return e.processKeyPress(t)},window.addEventListener("keydown",this._onKeyDown,!1),window.addEventListener("keyup",this._onKeyUp,!1),window.addEventListener("keypress",this._onKeyPress,!1))},stop:function(){window.removeEventListener("keydown",this._onKeyDown),window.removeEventListener("keyup",this._onKeyUp),window.removeEventListener("keypress",this._onKeyPress),this._onKeyDown=null,this._onKeyUp=null,this._onKeyPress=null},destroy:function(){this.stop(),this.clearCaptures(),this._keys.length=0,this._i=0},addKeyCapture:function(t){if("object"==typeof t)for(var e in t)this._capture[t[e]]=!0;else this._capture[t]=!0},removeKeyCapture:function(t){delete this._capture[t]},clearCaptures:function(){this._capture={}},update:function(){for(this._i=this._keys.length;this._i--;)this._keys[this._i]&&this._keys[this._i].update()},processKeyDown:function(t){var e;this.event=t,this.game.input.enabled&&this.enabled&&(e=t.keyCode,this._capture[e]&&t.preventDefault(),this._keys[e]||(this._keys[e]=new U.Key(this.game,e)),this._keys[e].processKeyDown(t),this._k=e,this.onDownCallback&&this.onDownCallback.call(this.callbackContext,t))},processKeyPress:function(t){this.pressEvent=t,this.game.input.enabled&&this.enabled&&this.onPressCallback&&this.onPressCallback.call(this.callbackContext,String.fromCharCode(t.charCode),t)},processKeyUp:function(t){var e;this.event=t,this.game.input.enabled&&this.enabled&&(e=t.keyCode,this._capture[e]&&t.preventDefault(),this._keys[e]||(this._keys[e]=new U.Key(this.game,e)),this._keys[e].processKeyUp(t),this.onUpCallback&&this.onUpCallback.call(this.callbackContext,t))},reset:function(t){void 0===t&&(t=!0),this.event=null;for(var e=this._keys.length;e--;)this._keys[e]&&this._keys[e].reset(t)},downDuration:function(t,e){return this._keys[t]?this._keys[t].downDuration(e):null},upDuration:function(t,e){return this._keys[t]?this._keys[t].upDuration(e):null},isDown:function(t){return this._keys[t]?this._keys[t].isDown:null}},Object.defineProperty(U.Keyboard.prototype,"lastChar",{get:function(){return 32===this.event.charCode?"":String.fromCharCode(this.pressEvent.charCode)}}),Object.defineProperty(U.Keyboard.prototype,"lastKey",{get:function(){return this._keys[this._k]}}),U.Keyboard.prototype.constructor=U.Keyboard,U.KeyCode={A:"A".charCodeAt(0),B:"B".charCodeAt(0),C:"C".charCodeAt(0),D:"D".charCodeAt(0),E:"E".charCodeAt(0),F:"F".charCodeAt(0),G:"G".charCodeAt(0),H:"H".charCodeAt(0),I:"I".charCodeAt(0),J:"J".charCodeAt(0),K:"K".charCodeAt(0),L:"L".charCodeAt(0),M:"M".charCodeAt(0),N:"N".charCodeAt(0),O:"O".charCodeAt(0),P:"P".charCodeAt(0),Q:"Q".charCodeAt(0),R:"R".charCodeAt(0),S:"S".charCodeAt(0),T:"T".charCodeAt(0),U:"U".charCodeAt(0),V:"V".charCodeAt(0),W:"W".charCodeAt(0),X:"X".charCodeAt(0),Y:"Y".charCodeAt(0),Z:"Z".charCodeAt(0),ZERO:"0".charCodeAt(0),ONE:"1".charCodeAt(0),TWO:"2".charCodeAt(0),THREE:"3".charCodeAt(0),FOUR:"4".charCodeAt(0),FIVE:"5".charCodeAt(0),SIX:"6".charCodeAt(0),SEVEN:"7".charCodeAt(0),EIGHT:"8".charCodeAt(0),NINE:"9".charCodeAt(0),NUMPAD_0:96,NUMPAD_1:97,NUMPAD_2:98,NUMPAD_3:99,NUMPAD_4:100,NUMPAD_5:101,NUMPAD_6:102,NUMPAD_7:103,NUMPAD_8:104,NUMPAD_9:105,NUMPAD_MULTIPLY:106,NUMPAD_ADD:107,NUMPAD_ENTER:108,NUMPAD_SUBTRACT:109,NUMPAD_DECIMAL:110,NUMPAD_DIVIDE:111,F1:112,F2:113,F3:114,F4:115,F5:116,F6:117,F7:118,F8:119,F9:120,F10:121,F11:122,F12:123,F13:124,F14:125,F15:126,COLON:186,EQUALS:187,COMMA:188,UNDERSCORE:189,PERIOD:190,QUESTION_MARK:191,TILDE:192,OPEN_BRACKET:219,BACKWARD_SLASH:220,CLOSED_BRACKET:221,QUOTES:222,BACKSPACE:8,TAB:9,CLEAR:12,ENTER:13,SHIFT:16,CONTROL:17,ALT:18,CAPS_LOCK:20,ESC:27,SPACEBAR:32,PAGE_UP:33,PAGE_DOWN:34,END:35,HOME:36,LEFT:37,UP:38,RIGHT:39,DOWN:40,PLUS:43,MINUS:44,INSERT:45,DELETE:46,HELP:47,NUM_LOCK:144},U.KeyCode)U.KeyCode.hasOwnProperty(e)&&!e.match(/[a-z]/)&&(U.Keyboard[e]=U.KeyCode[e]);for(i in U.Component=function(){},U.Component.Angle=function(){},U.Component.Angle.prototype={angle:{get:function(){return U.Math.wrapAngle(U.Math.radToDeg(this.rotation))},set:function(t){this.rotation=U.Math.degToRad(U.Math.wrapAngle(t))}}},U.Component.Animation=function(){},U.Component.Animation.prototype={play:function(t,e,i,n){if(this.animations)return this.animations.play(t,e,i,n)}},U.Component.AutoCull=function(){},U.Component.AutoCull.prototype={autoCull:!1,inCamera:{get:function(){return this.autoCull||this.checkWorldBounds||(this._bounds.copyFrom(this.getBounds()),this._bounds.x+=this.game.camera.view.x,this._bounds.y+=this.game.camera.view.y),this.game.world.camera.view.intersects(this._bounds)}}},U.Component.Bounds=function(){},U.Component.Bounds.prototype={offsetX:{get:function(){return this.anchor.x*this.width}},offsetY:{get:function(){return this.anchor.y*this.height}},centerX:{get:function(){return this.x-this.offsetX+.5*this.width},set:function(t){this.x=t+this.offsetX-.5*this.width}},centerY:{get:function(){return this.y-this.offsetY+.5*this.height},set:function(t){this.y=t+this.offsetY-.5*this.height}},left:{get:function(){return this.x-this.offsetX},set:function(t){this.x=t+this.offsetX}},right:{get:function(){return this.x+this.width-this.offsetX},set:function(t){this.x=t-this.width+this.offsetX}},top:{get:function(){return this.y-this.offsetY},set:function(t){this.y=t+this.offsetY}},bottom:{get:function(){return this.y+this.height-this.offsetY},set:function(t){this.y=t-this.height+this.offsetY}},alignIn:function(t,e,i,n){switch(void 0===i&&(i=0),void 0===n&&(n=0),e){default:case U.TOP_LEFT:this.left=t.left-i,this.top=t.top-n;break;case U.TOP_CENTER:this.centerX=t.centerX+i,this.top=t.top-n;break;case U.TOP_RIGHT:this.right=t.right+i,this.top=t.top-n;break;case U.LEFT_CENTER:this.left=t.left-i,this.centerY=t.centerY+n;break;case U.CENTER:this.centerX=t.centerX+i,this.centerY=t.centerY+n;break;case U.RIGHT_CENTER:this.right=t.right+i,this.centerY=t.centerY+n;break;case U.BOTTOM_LEFT:this.left=t.left-i,this.bottom=t.bottom+n;break;case U.BOTTOM_CENTER:this.centerX=t.centerX+i,this.bottom=t.bottom+n;break;case U.BOTTOM_RIGHT:this.right=t.right+i,this.bottom=t.bottom+n}return this},alignTo:function(t,e,i,n){switch(void 0===i&&(i=0),void 0===n&&(n=0),e){default:case U.TOP_LEFT:this.left=t.left-i,this.bottom=t.top-n;break;case U.TOP_CENTER:this.centerX=t.centerX+i,this.bottom=t.top-n;break;case U.TOP_RIGHT:this.right=t.right+i,this.bottom=t.top-n;break;case U.LEFT_TOP:this.right=t.left-i,this.top=t.top-n;break;case U.LEFT_CENTER:this.right=t.left-i,this.centerY=t.centerY+n;break;case U.LEFT_BOTTOM:this.right=t.left-i,this.bottom=t.bottom+n;break;case U.RIGHT_TOP:this.left=t.right+i,this.top=t.top-n;break;case U.RIGHT_CENTER:this.left=t.right+i,this.centerY=t.centerY+n;break;case U.RIGHT_BOTTOM:this.left=t.right+i,this.bottom=t.bottom+n;break;case U.BOTTOM_LEFT:this.left=t.left-i,this.top=t.bottom+n;break;case U.BOTTOM_CENTER:this.centerX=t.centerX+i,this.top=t.bottom+n;break;case U.BOTTOM_RIGHT:this.right=t.right+i,this.top=t.bottom+n}return this}},U.Group.prototype.alignIn=U.Component.Bounds.prototype.alignIn,U.Group.prototype.alignTo=U.Component.Bounds.prototype.alignTo,U.Component.BringToTop=function(){},U.Component.BringToTop.prototype.bringToTop=function(){return this.parent&&this.parent.bringToTop(this),this},U.Component.BringToTop.prototype.sendToBack=function(){return this.parent&&this.parent.sendToBack(this),this},U.Component.BringToTop.prototype.moveUp=function(){return this.parent&&this.parent.moveUp(this),this},U.Component.BringToTop.prototype.moveDown=function(){return this.parent&&this.parent.moveDown(this),this},U.Component.Core=function(){},U.Component.Core.install=function(t){U.Utils.mixinPrototype(this,U.Component.Core.prototype),this.components={};for(var e=0;e<t.length;e++){var i=t[e],n="Destroy"===i?!0:!1;U.Utils.mixinPrototype(this,U.Component[i].prototype,n),this.components[i]=!0}},U.Component.Core.init=function(t,e,i,n,r){this.game=t,this.key=n,this.data={},this.position.set(e,i),this.world=new U.Point(e,i),this.previousPosition=new U.Point(e,i),this.events=new U.Events(this),this._bounds=new U.Rectangle,this.components.PhysicsBody&&(this.body=this.body),this.components.Animation&&(this.animations=new U.AnimationManager(this)),this.components.LoadTexture&&null!==n&&this.loadTexture(n,r),this.components.FixedToCamera&&(this.cameraOffset=new U.Point(e,i))},U.Component.Core.preUpdate=function(){if(!this.pendingDestroy){if(this.previousPosition.set(this.world.x,this.world.y),this.previousRotation=this.rotation,!this.exists||!this.parent.exists)return!(this.renderOrderID=-1);this.world.setTo(this.game.camera.x+this.worldTransform.tx,this.game.camera.y+this.worldTransform.ty),this.visible&&(this.renderOrderID=this.game.stage.currentRenderOrderID++),this.animations&&this.animations.update(),this.body&&this.body.preUpdate();for(var t=0;t<this.children.length;t++)this.children[t].preUpdate();return!0}this.destroy()},U.Component.Core.prototype={game:null,name:"",data:{},components:{},z:0,events:void 0,animations:void 0,key:"",world:null,debug:!1,previousPosition:null,previousRotation:0,renderOrderID:0,fresh:!0,pendingDestroy:!1,_bounds:null,_exists:!0,exists:{get:function(){return this._exists},set:function(t){t?(this._exists=!0,this.body&&this.body.type===U.Physics.P2JS&&this.body.addToWorld(),this.visible=!0):(this._exists=!1,this.body&&this.body.type===U.Physics.P2JS&&this.body.removeFromWorld(),this.visible=!1)}},update:function(){},postUpdate:function(){this.customRender&&this.key.render(),this.components.PhysicsBody&&U.Component.PhysicsBody.postUpdate.call(this),this.components.FixedToCamera&&U.Component.FixedToCamera.postUpdate.call(this);for(var t=0;t<this.children.length;t++)this.children[t].postUpdate()}},U.Component.Crop=function(){},U.Component.Crop.prototype={cropRect:null,_crop:null,crop:function(t,e){void 0===e&&(e=!1),t?(e&&null!==this.cropRect?this.cropRect.setTo(t.x,t.y,t.width,t.height):e&&null===this.cropRect?this.cropRect=new U.Rectangle(t.x,t.y,t.width,t.height):this.cropRect=t,this.updateCrop()):(this._crop=null,this.cropRect=null,this.resetFrame())},updateCrop:function(){var t,e,i,n,r,o,s,a;this.cropRect&&(t=this.texture.crop.x,e=this.texture.crop.y,i=this.texture.crop.width,n=this.texture.crop.height,this._crop=U.Rectangle.clone(this.cropRect,this._crop),this._crop.x+=this._frame.x,this._crop.y+=this._frame.y,r=Math.max(this._frame.x,this._crop.x),o=Math.max(this._frame.y,this._crop.y),s=Math.min(this._frame.right,this._crop.right)-r,a=Math.min(this._frame.bottom,this._crop.bottom)-o,this.texture.crop.x=r,this.texture.crop.y=o,this.texture.crop.width=s,this.texture.crop.height=a,this.texture.frame.width=Math.min(s,this.cropRect.width),this.texture.frame.height=Math.min(a,this.cropRect.height),this.texture.width=this.texture.frame.width,this.texture.height=this.texture.frame.height,this.texture._updateUvs(),16777215===this.tint||t===r&&e===o&&i===s&&n===a||(this.texture.requiresReTint=!0))}},U.Component.Delta=function(){},U.Component.Delta.prototype={deltaX:{get:function(){return this.world.x-this.previousPosition.x}},deltaY:{get:function(){return this.world.y-this.previousPosition.y}},deltaZ:{get:function(){return this.rotation-this.previousRotation}}},U.Component.Destroy=function(){},U.Component.Destroy.prototype={destroyPhase:!1,destroy:function(t,e){if(null!==this.game&&!this.destroyPhase){void 0===t&&(t=!0),void 0===e&&(e=!1),this.destroyPhase=!0,this.events&&this.events.onDestroy$dispatch(this),this.parent&&(this.parent instanceof U.Group?this.parent.remove(this):this.parent.removeChild(this)),this.input&&this.input.destroy(),this.animations&&this.animations.destroy(),this.body&&this.body.destroy(),this.events&&this.events.destroy(),this.game.tweens.removeFrom(this);var i=this.children.length;if(t)for(;i--;)this.children[i].destroy(t);else for(;i--;)this.removeChild(this.children[i]);this._crop&&(this._crop=null,this.cropRect=null),this._frame&&(this._frame=null),U.Video&&this.key instanceof U.Video&&this.key.onChangeSource.remove(this.resizeFrame,this),U.BitmapText&&this._glyphs&&(this._glyphs=[]),this.alive=!1,this.exists=!1,this.visible=!1,this.filters=null,this.mask=null,this.game=null,this.data={},this.renderable=!1,this.transformCallback&&(this.transformCallback=null,this.transformCallbackContext=null),this.hitArea=null,this.parent=null,this.stage=null,this.worldTransform=null,this.filterArea=null,this._bounds=null,this._currentBounds=null,this._mask=null,this._destroyCachedSprite(),e&&this.texture.destroy(!0),this.destroyPhase=!1,this.pendingDestroy=!1}}},U.Events=function(t){this.parent=t},U.Events.prototype={destroy:function(){this._parent=null,this._onDestroy&&this._onDestroy.dispose(),this._onAddedToGroup&&this._onAddedToGroup.dispose(),this._onRemovedFromGroup&&this._onRemovedFromGroup.dispose(),this._onRemovedFromWorld&&this._onRemovedFromWorld.dispose(),this._onKilled&&this._onKilled.dispose(),this._onRevived&&this._onRevived.dispose(),this._onEnterBounds&&this._onEnterBounds.dispose(),this._onOutOfBounds&&this._onOutOfBounds.dispose(),this._onInputOver&&this._onInputOver.dispose(),this._onInputOut&&this._onInputOut.dispose(),this._onInputDown&&this._onInputDown.dispose(),this._onInputUp&&this._onInputUp.dispose(),this._onDragStart&&this._onDragStart.dispose(),this._onDragUpdate&&this._onDragUpdate.dispose(),this._onDragStop&&this._onDragStop.dispose(),this._onAnimationStart&&this._onAnimationStart.dispose(),this._onAnimationComplete&&this._onAnimationComplete.dispose(),this._onAnimationLoop&&this._onAnimationLoop.dispose()},onAddedToGroup:null,onRemovedFromGroup:null,onRemovedFromWorld:null,onDestroy:null,onKilled:null,onRevived:null,onOutOfBounds:null,onEnterBounds:null,onInputOver:null,onInputOut:null,onInputDown:null,onInputUp:null,onDragStart:null,onDragUpdate:null,onDragStop:null,onAnimationStart:null,onAnimationComplete:null,onAnimationLoop:null},U.Events.prototype.constructor=U.Events,U.Events.prototype)U.Events.prototype.hasOwnProperty(i)&&0===i.indexOf("on")&&null===U.Events.prototype[i]&&function(t,e){"use strict";Object.defineProperty(U.Events.prototype,t,{get:function(){return this[e]||(this[e]=new U.Signal)}}),U.Events.prototype[t+"$dispatch"]=function(){return this[e]?this[e].dispatch.apply(this[e],arguments):null}}(i,"_"+i);U.Component.FixedToCamera=function(){},U.Component.FixedToCamera.postUpdate=function(){this.fixedToCamera&&(this.position.x=(this.game.camera.view.x+this.cameraOffset.x)/this.game.camera.scale.x,this.position.y=(this.game.camera.view.y+this.cameraOffset.y)/this.game.camera.scale.y)},U.Component.FixedToCamera.prototype={_fixedToCamera:!1,fixedToCamera:{get:function(){return this._fixedToCamera},set:function(t){t?(this._fixedToCamera=!0,this.cameraOffset.set(this.x,this.y)):this._fixedToCamera=!1}},cameraOffset:new U.Point},U.Component.Health=function(){},U.Component.Health.prototype={health:1,maxHealth:100,damage:function(t){return this.alive&&(this.health-=t,this.health<=0&&this.kill()),this},setHealth:function(t){return this.health=t,this.health>this.maxHealth&&(this.health=this.maxHealth),this},heal:function(t){return this.alive&&(this.health+=t,this.health>this.maxHealth&&(this.health=this.maxHealth)),this}},U.Component.InCamera=function(){},U.Component.InCamera.prototype={inCamera:{get:function(){return this.game.world.camera.view.intersects(this._bounds)}}},U.Component.InputEnabled=function(){},U.Component.InputEnabled.prototype={input:null,inputEnabled:{get:function(){return this.input&&this.input.enabled},set:function(t){t?null===this.input?(this.input=new U.InputHandler(this),this.input.start()):this.input&&!this.input.enabled&&this.input.start():this.input&&this.input.enabled&&this.input.stop()}}},U.Component.InWorld=function(){},U.Component.InWorld.preUpdate=function(){if(this.autoCull||this.checkWorldBounds){if(this._bounds.copyFrom(this.getBounds()),this._bounds.x+=this.game.camera.view.x,this._bounds.y+=this.game.camera.view.y,this.autoCull)if(this.game.world.camera.view.intersects(this._bounds))this.renderable=!0,this.game.world.camera.totalInView++;else if(this.renderable=!1,this.outOfCameraBoundsKill)return this.kill(),!1;if(this.checkWorldBounds)if(this._outOfBoundsFired&&this.game.world.bounds.intersects(this._bounds))this._outOfBoundsFired=!1,this.events.onEnterBounds$dispatch(this);else if(!this._outOfBoundsFired&&!this.game.world.bounds.intersects(this._bounds)&&(this._outOfBoundsFired=!0,this.events.onOutOfBounds$dispatch(this),this.outOfBoundsKill))return this.kill(),!1}return!0},U.Component.InWorld.prototype={checkWorldBounds:!1,outOfBoundsKill:!1,outOfCameraBoundsKill:!1,_outOfBoundsFired:!1,inWorld:{get:function(){return this.game.world.bounds.intersects(this.getBounds())}}},U.Component.LifeSpan=function(){},U.Component.LifeSpan.preUpdate=function(){return!(0<this.lifespan&&(this.lifespan-=this.game.time.physicsElapsedMS,this.lifespan<=0)&&(this.kill(),1))},U.Component.LifeSpan.prototype={alive:!0,lifespan:0,revive:function(t){return void 0===t&&(t=100),this.alive=!0,this.exists=!0,this.visible=!0,"function"==typeof this.setHealth&&this.setHealth(t),this.events&&this.events.onRevived$dispatch(this),this},kill:function(){return this.alive=!1,this.exists=!1,this.visible=!1,this.events&&this.events.onKilled$dispatch(this),this}},U.Component.LoadTexture=function(){},U.Component.LoadTexture.prototype={customRender:!1,_frame:null,loadTexture:function(t,e,i){e=t===U.PENDING_ATLAS?(t=e,0):e||0,(i||void 0===i)&&this.animations&&this.animations.stop(),this.key=t,this.customRender=!1;var n=this.game.cache,r=!0,o=!this.texture.baseTexture.scaleMode;U.RenderTexture&&t instanceof U.RenderTexture?(this.key=t.key,this.setTexture(t)):U.BitmapData&&t instanceof U.BitmapData?(this.customRender=!0,this.setTexture(t.texture),r=n.hasFrameData(t.key,U.Cache.BITMAPDATA)?!this.animations.loadFrameData(n.getFrameData(t.key,U.Cache.BITMAPDATA),e):!this.animations.loadFrameData(t.frameData,0)):U.Video&&t instanceof U.Video?(this.customRender=!0,i=t.texture.valid,this.setTexture(t.texture),this.setFrame(t.texture.frame.clone()),t.onChangeSource.add(this.resizeFrame,this),this.texture.valid=i):U.Tilemap&&t instanceof U.TilemapLayer?this.setTexture(PIXI.Texture.fromCanvas(t.canvas)):t instanceof PIXI.Texture?this.setTexture(t):(n=n.getImage(t,!0),this.key=n.key,this.setTexture(new PIXI.Texture(n.base)),this.texture.baseTexture.skipRender="__default"===t,r=!this.animations.loadFrameData(n.frameData,e)),r&&(this._frame=U.Rectangle.clone(this.texture.frame)),o||(this.texture.baseTexture.scaleMode=1)},setFrame:function(t){this._frame=t,this.texture.frame.x=t.x,this.texture.frame.y=t.y,this.texture.frame.width=t.width,this.texture.frame.height=t.height,this.texture.crop.x=t.x,this.texture.crop.y=t.y,this.texture.crop.width=t.width,this.texture.crop.height=t.height,t.trimmed?(this.texture.trim?(this.texture.trim.x=t.spriteSourceSizeX,this.texture.trim.y=t.spriteSourceSizeY,this.texture.trim.width=t.sourceSizeW,this.texture.trim.height=t.sourceSizeH):this.texture.trim={x:t.spriteSourceSizeX,y:t.spriteSourceSizeY,width:t.sourceSizeW,height:t.sourceSizeH},this.texture.width=t.sourceSizeW,this.texture.height=t.sourceSizeH,this.texture.frame.width=t.sourceSizeW,this.texture.frame.height=t.sourceSizeH):!t.trimmed&&this.texture.trim&&(this.texture.trim=null),this.cropRect&&this.updateCrop(),this.texture.requiresReTint=!0,this.texture._updateUvs(),this.tilingTexture&&(this.refreshTexture=!0)},resizeFrame:function(t,e,i){this.texture.frame.resize(e,i),this.texture.setFrame(this.texture.frame)},resetFrame:function(){this._frame&&this.setFrame(this._frame)},frame:{get:function(){return this.animations.frame},set:function(t){this.animations.frame=t}},frameName:{get:function(){return this.animations.frameName},set:function(t){this.animations.frameName=t}}},U.Component.Overlap=function(){},U.Component.Overlap.prototype={overlap:function(t){return U.Rectangle.intersects(this.getBounds(),t.getBounds())}},U.Component.PhysicsBody=function(){},U.Component.PhysicsBody.preUpdate=function(){return this.fresh&&this.exists?(this.world.setTo(this.parent.position.x+this.position.x,this.parent.position.y+this.position.y),this.worldTransform.tx=this.world.x,this.worldTransform.ty=this.world.y,this.previousPosition.set(this.world.x,this.world.y),this.previousRotation=this.rotation,this.body&&this.body.preUpdate(),this.fresh=!1):(this.previousPosition.set(this.world.x,this.world.y),this.previousRotation=this.rotation,!(!this._exists||!this.parent.exists)||!(this.renderOrderID=-1))},U.Component.PhysicsBody.postUpdate=function(){this.exists&&this.body&&this.body.postUpdate()},U.Component.PhysicsBody.prototype={body:null,x:{get:function(){return this.position.x},set:function(t){this.position.x=t,this.body&&!this.body.dirty&&(this.body._reset=!0)}},y:{get:function(){return this.position.y},set:function(t){this.position.y=t,this.body&&!this.body.dirty&&(this.body._reset=!0)}}},U.Component.Reset=function(){},U.Component.Reset.prototype.reset=function(t,e,i){return void 0===i&&(i=1),this.world.set(t,e),this.position.set(t,e),this.fresh=!0,this.exists=!0,this.visible=!0,this.renderable=!0,this.components.InWorld&&(this._outOfBoundsFired=!1),this.components.LifeSpan&&(this.alive=!0,this.health=i),this.components.PhysicsBody&&this.body&&this.body.reset(t,e,!1,!1),this},U.Component.ScaleMinMax=function(){},U.Component.ScaleMinMax.prototype={transformCallback:null,transformCallbackContext:this,scaleMin:null,scaleMax:null,checkTransform:function(t){this.scaleMin&&(t.a<this.scaleMin.x&&(t.a=this.scaleMin.x),t.d<this.scaleMin.y&&(t.d=this.scaleMin.y)),this.scaleMax&&(t.a>this.scaleMax.x&&(t.a=this.scaleMax.x),t.d>this.scaleMax.y&&(t.d=this.scaleMax.y))},setScaleMinMax:function(t,e,i,n){void 0===e?e=i=n=t:void 0===i&&(i=n=e,e=t),null===t?this.scaleMin=null:this.scaleMin?this.scaleMin.set(t,e):this.scaleMin=new U.Point(t,e),null===i?this.scaleMax=null:this.scaleMax?this.scaleMax.set(i,n):this.scaleMax=new U.Point(i,n),null===this.scaleMin?this.transformCallback=null:(this.transformCallback=this.checkTransform,this.transformCallbackContext=this)}},U.Component.Smoothed=function(){},U.Component.Smoothed.prototype={smoothed:{get:function(){return!this.texture.baseTexture.scaleMode},set:function(t){t?this.texture&&(this.texture.baseTexture.scaleMode=0):this.texture&&(this.texture.baseTexture.scaleMode=1)}}},U.GameObjectFactory=function(t){this.game=t,this.world=this.game.world},U.GameObjectFactory.prototype={existing:function(t){return this.world.add(t)},weapon:function(t,e,i,n){var r=this.game.plugins.add(U.Weapon);return r.createBullets(t,e,i,n),r},image:function(t,e,i,n,r){return(r=void 0===r?this.world:r).add(new U.Image(this.game,t,e,i,n))},sprite:function(t,e,i,n,r){return(r=void 0===r?this.world:r).create(t,e,i,n)},creature:function(t,e,i,n,r){void 0===r&&(r=this.world);n=new U.Creature(this.game,t,e,i,n);return r.add(n),n},tween:function(t){return this.game.tweens.create(t)},group:function(t,e,i,n,r){return new U.Group(this.game,t,e,i,n,r)},physicsGroup:function(t,e,i,n){return new U.Group(this.game,e,i,n,!0,t)},spriteBatch:function(t,e,i){return new U.SpriteBatch(this.game,t=void 0===t?null:t,e=void 0===e?"group":e,i=void 0===i?!1:i)},audio:function(t,e,i,n){return this.game.sound.add(t,e,i,n)},sound:function(t,e,i,n){return this.game.sound.add(t,e,i,n)},audioSprite:function(t){return this.game.sound.addSprite(t)},tileSprite:function(t,e,i,n,r,o,s){return(s=void 0===s?this.world:s).add(new U.TileSprite(this.game,t,e,i,n,r,o))},rope:function(t,e,i,n,r,o){return(o=void 0===o?this.world:o).add(new U.Rope(this.game,t,e,i,n,r))},text:function(t,e,i,n,r){return(r=void 0===r?this.world:r).add(new U.Text(this.game,t,e,i,n))},button:function(t,e,i,n,r,o,s,a,h,l){return(l=void 0===l?this.world:l).add(new U.Button(this.game,t,e,i,n,r,o,s,a,h))},graphics:function(t,e,i){return(i=void 0===i?this.world:i).add(new U.Graphics(this.game,t,e))},emitter:function(t,e,i){return this.game.particles.add(new U.Particles.Arcade.Emitter(this.game,t,e,i))},retroFont:function(t,e,i,n,r,o,s,a,h){return new U.RetroFont(this.game,t,e,i,n,r,o,s,a,h)},bitmapText:function(t,e,i,n,r,o){return(o=void 0===o?this.world:o).add(new U.BitmapText(this.game,t,e,i,n,r))},tilemap:function(t,e,i,n,r){return new U.Tilemap(this.game,t,e,i,n,r)},renderTexture:function(t,e,i,n){void 0!==i&&""!==i||(i=this.game.rnd.uuid()),void 0===n&&(n=!1);e=new U.RenderTexture(this.game,t,e,i);return n&&this.game.cache.addRenderTexture(i,e),e},video:function(t,e){return new U.Video(this.game,t,e)},bitmapData:function(t,e,i,n){void 0===n&&(n=!1),void 0!==i&&""!==i||(i=this.game.rnd.uuid());e=new U.BitmapData(this.game,i,t,e);return n&&this.game.cache.addBitmapData(i,e),e},filter:function(t){var e=Array.prototype.slice.call(arguments,1),t=new U.Filter[t](this.game);return t.init.apply(t,e),t},plugin:function(t){return this.game.plugins.add(t)}},U.GameObjectFactory.prototype.constructor=U.GameObjectFactory,U.GameObjectCreator=function(t){this.game=t,this.world=this.game.world},U.GameObjectCreator.prototype={image:function(t,e,i,n){return new U.Image(this.game,t,e,i,n)},sprite:function(t,e,i,n){return new U.Sprite(this.game,t,e,i,n)},tween:function(t){return new U.Tween(t,this.game,this.game.tweens)},group:function(t,e,i,n,r){return new U.Group(this.game,t,e,i,n,r)},spriteBatch:function(t,e,i){return new U.SpriteBatch(this.game,t,e=void 0===e?"group":e,i=void 0===i?!1:i)},audio:function(t,e,i,n){return this.game.sound.add(t,e,i,n)},audioSprite:function(t){return this.game.sound.addSprite(t)},sound:function(t,e,i,n){return this.game.sound.add(t,e,i,n)},tileSprite:function(t,e,i,n,r,o){return new U.TileSprite(this.game,t,e,i,n,r,o)},rope:function(t,e,i,n,r){return new U.Rope(this.game,t,e,i,n,r)},text:function(t,e,i,n){return new U.Text(this.game,t,e,i,n)},button:function(t,e,i,n,r,o,s,a,h){return new U.Button(this.game,t,e,i,n,r,o,s,a,h)},graphics:function(t,e){return new U.Graphics(this.game,t,e)},emitter:function(t,e,i){return new U.Particles.Arcade.Emitter(this.game,t,e,i)},retroFont:function(t,e,i,n,r,o,s,a,h){return new U.RetroFont(this.game,t,e,i,n,r,o,s,a,h)},bitmapText:function(t,e,i,n,r,o){return new U.BitmapText(this.game,t,e,i,n,r,o)},tilemap:function(t,e,i,n,r){return new U.Tilemap(this.game,t,e,i,n,r)},renderTexture:function(t,e,i,n){void 0!==i&&""!==i||(i=this.game.rnd.uuid()),void 0===n&&(n=!1);e=new U.RenderTexture(this.game,t,e,i);return n&&this.game.cache.addRenderTexture(i,e),e},bitmapData:function(t,e,i,n){void 0===n&&(n=!1),void 0!==i&&""!==i||(i=this.game.rnd.uuid());e=new U.BitmapData(this.game,i,t,e);return n&&this.game.cache.addBitmapData(i,e),e},filter:function(t){var e=Array.prototype.slice.call(arguments,1),t=new U.Filter[t](this.game);return t.init.apply(t,e),t}},U.GameObjectCreator.prototype.constructor=U.GameObjectCreator,U.Sprite=function(t,e,i,n,r){e=e||0,i=i||0,n=n||null,r=r||null,this.type=U.SPRITE,this.physicsType=U.SPRITE,PIXI.Sprite.call(this,U.Cache.DEFAULT),U.Component.Core.init.call(this,t,e,i,n,r)},U.Sprite.prototype=Object.create(PIXI.Sprite.prototype),U.Sprite.prototype.constructor=U.Sprite,U.Component.Core.install.call(U.Sprite.prototype,["Angle","Animation","AutoCull","Bounds","BringToTop","Crop","Delta","Destroy","FixedToCamera","Health","InCamera","InputEnabled","InWorld","LifeSpan","LoadTexture","Overlap","PhysicsBody","Reset","ScaleMinMax","Smoothed"]),U.Sprite.prototype.preUpdatePhysics=U.Component.PhysicsBody.preUpdate,U.Sprite.prototype.preUpdateLifeSpan=U.Component.LifeSpan.preUpdate,U.Sprite.prototype.preUpdateInWorld=U.Component.InWorld.preUpdate,U.Sprite.prototype.preUpdateCore=U.Component.Core.preUpdate,U.Sprite.prototype.preUpdate=function(){return!!(this.preUpdatePhysics()&&this.preUpdateLifeSpan()&&this.preUpdateInWorld())&&this.preUpdateCore()},U.Image=function(t,e,i,n,r){e=e||0,i=i||0,n=n||null,r=r||null,this.type=U.IMAGE,PIXI.Sprite.call(this,U.Cache.DEFAULT),U.Component.Core.init.call(this,t,e,i,n,r)},U.Image.prototype=Object.create(PIXI.Sprite.prototype),U.Image.prototype.constructor=U.Image,U.Component.Core.install.call(U.Image.prototype,["Angle","Animation","AutoCull","Bounds","BringToTop","Crop","Destroy","FixedToCamera","InputEnabled","LifeSpan","LoadTexture","Overlap","Reset","ScaleMinMax","Smoothed"]),U.Image.prototype.preUpdateInWorld=U.Component.InWorld.preUpdate,U.Image.prototype.preUpdateCore=U.Component.Core.preUpdate,U.Image.prototype.preUpdate=function(){return!!this.preUpdateInWorld()&&this.preUpdateCore()},U.Button=function(t,e,i,n,r,o,s,a,h,l){r=r||null,o=o||this,U.Image.call(this,t,e=e||0,i=i||0,n=n||null,a),this.type=U.BUTTON,this.physicsType=U.SPRITE,this._onOverFrame=null,this._onOutFrame=null,this._onDownFrame=null,this._onUpFrame=null,this.onOverSound=null,this.onOutSound=null,this.onDownSound=null,this.onUpSound=null,this.onOverSoundMarker="",this.onOutSoundMarker="",this.onDownSoundMarker="",this.onUpSoundMarker="",this.onInputOver=new U.Signal,this.onInputOut=new U.Signal,this.onInputDown=new U.Signal,this.onInputUp=new U.Signal,this.onOverMouseOnly=!0,this.justReleasedPreventsOver=U.PointerMode.TOUCH,this.freezeFrames=!1,this.forceOut=!1,this.inputEnabled=!0,this.input.start(0,!0),this.input.useHandCursor=!0,this.setFrames(s,a,h,l),null!==r&&this.onInputUp.add(r,o),this.events.onInputOver.add(this.onInputOverHandler,this),this.events.onInputOut.add(this.onInputOutHandler,this),this.events.onInputDown.add(this.onInputDownHandler,this),this.events.onInputUp.add(this.onInputUpHandler,this),this.events.onRemovedFromWorld.add(this.removedFromWorld,this)},U.Button.prototype=Object.create(U.Image.prototype),U.Button.prototype.constructor=U.Button;var h="Over",l="Out",p="Down",u="Up";U.Button.prototype.clearFrames=function(){this.setFrames(null,null,null,null)},U.Button.prototype.removedFromWorld=function(){this.inputEnabled=!1},U.Button.prototype.setStateFrame=function(t,e,i){var n="_on"+t+"Frame";null!==e?(this[n]=e,i&&this.changeStateFrame(t)):this[n]=null},U.Button.prototype.changeStateFrame=function(t){if(this.freezeFrames)return!1;t=this["_on"+t+"Frame"];return"string"==typeof t?(this.frameName=t,!0):"number"==typeof t&&(this.frame=t,!0)},U.Button.prototype.setFrames=function(t,e,i,n){this.setStateFrame(h,t,this.input.pointerOver()),this.setStateFrame(l,e,!this.input.pointerOver()),this.setStateFrame(p,i,this.input.pointerDown()),this.setStateFrame(u,n,this.input.pointerUp())},U.Button.prototype.setStateSound=function(t,e,i){var n="on"+t+"Sound",t="on"+t+"SoundMarker";e instanceof U.Sound||e instanceof U.AudioSprite?(this[n]=e,this[t]="string"==typeof i?i:""):(this[n]=null,this[t]="")},U.Button.prototype.playStateSound=function(t){var e=this["on"+t+"Sound"];if(e){t=this["on"+t+"SoundMarker"];return e.play(t),!0}return!1},U.Button.prototype.setSounds=function(t,e,i,n,r,o,s,a){this.setStateSound(h,t,e),this.setStateSound(l,r,o),this.setStateSound(p,i,n),this.setStateSound(u,s,a)},U.Button.prototype.setOverSound=function(t,e){this.setStateSound(h,t,e)},U.Button.prototype.setOutSound=function(t,e){this.setStateSound(l,t,e)},U.Button.prototype.setDownSound=function(t,e){this.setStateSound(p,t,e)},U.Button.prototype.setUpSound=function(t,e){this.setStateSound(u,t,e)},U.Button.prototype.onInputOverHandler=function(t,e){e.justReleased()&&(this.justReleasedPreventsOver&e.pointerMode)===e.pointerMode||(this.changeStateFrame(h),this.onOverMouseOnly&&!e.isMouse||(this.playStateSound(h),this.onInputOver&&this.onInputOver.dispatch(this,e)))},U.Button.prototype.onInputOutHandler=function(t,e){this.changeStateFrame(l),this.playStateSound(l),this.onInputOut&&this.onInputOut.dispatch(this,e)},U.Button.prototype.onInputDownHandler=function(t,e){this.changeStateFrame(p),this.playStateSound(p),this.onInputDown&&this.onInputDown.dispatch(this,e)},U.Button.prototype.onInputUpHandler=function(t,e,i){this.playStateSound(u),this.onInputUp&&this.onInputUp.dispatch(this,e,i),this.freezeFrames||(!0===this.forceOut||(this.forceOut&e.pointerMode)===e.pointerMode?this.changeStateFrame(l):this.changeStateFrame(u)||(i?this.changeStateFrame(h):this.changeStateFrame(l)))},U.SpriteBatch=function(t,e,i,n){null!=e||(e=t.world),PIXI.SpriteBatch.call(this),U.Group.call(this,t,e,i,n),this.type=U.SPRITEBATCH},U.SpriteBatch.prototype=U.Utils.extend(!0,U.SpriteBatch.prototype,PIXI.SpriteBatch.prototype,U.Group.prototype),U.SpriteBatch.prototype.constructor=U.SpriteBatch,U.BitmapData=function(t,e,i,n,r){void 0!==i&&0!==i||(i=256),void 0!==n&&0!==n||(n=256),void 0===r&&(r=!1),this.game=t,this.key=e,this.width=i,this.height=n,this.canvas=U.Canvas.create(this,i,n,null,r),this.context=this.canvas.getContext("2d",{alpha:!0}),this.ctx=this.context,this.smoothProperty=t.renderType===U.CANVAS?t.renderer.renderSession.smoothProperty:U.Canvas.getSmoothingPrefix(this.context),this.imageData=this.context.getImageData(0,0,i,n),this.data=null,this.imageData&&(this.data=this.imageData.data),this.pixels=null,this.data&&(this.imageData.data.buffer?(this.buffer=this.imageData.data.buffer,this.pixels=new Uint32Array(this.buffer)):window.ArrayBuffer?(this.buffer=new ArrayBuffer(this.imageData.data.length),this.pixels=new Uint32Array(this.buffer)):this.pixels=this.imageData.data),this.baseTexture=new PIXI.BaseTexture(this.canvas),this.texture=new PIXI.Texture(this.baseTexture),this.frameData=new U.FrameData,this.textureFrame=this.frameData.addFrame(new U.Frame(0,0,0,i,n,"bitmapData")),this.texture.frame=this.textureFrame,this.type=U.BITMAPDATA,this.disableTextureUpload=!1,this.dirty=!1,this.cls=this.clear,this._image=null,this._pos=new U.Point,this._size=new U.Point,this._scale=new U.Point,this._rotate=0,this._alpha={prev:1,current:1},this._anchor=new U.Point,this._tempR=0,this._tempG=0,this._tempB=0,this._circle=new U.Circle,this._swapCanvas=void 0},U.BitmapData.prototype={move:function(t,e,i){return 0!==t&&this.moveH(t,i),0!==e&&this.moveV(e,i),this},moveH:function(t,e){void 0===e&&(e=!0),void 0===this._swapCanvas&&(this._swapCanvas=PIXI.CanvasPool.create(this,this.width,this.height));var i,n=this._swapCanvas.getContext("2d"),r=this.height,o=this.canvas;return n.clearRect(0,0,this.width,this.height),t<0?(t=Math.abs(t),i=this.width-t,e&&n.drawImage(o,0,0,t,r,i,0,t,r),n.drawImage(o,t,0,i,r,0,0,i,r)):(i=this.width-t,e&&n.drawImage(o,i,0,t,r,0,0,t,r),n.drawImage(o,0,0,i,r,t,0,i,r)),this.clear(),this.copy(this._swapCanvas)},moveV:function(t,e){void 0===e&&(e=!0),void 0===this._swapCanvas&&(this._swapCanvas=PIXI.CanvasPool.create(this,this.width,this.height));var i,n=this._swapCanvas.getContext("2d"),r=this.width,o=this.canvas;return n.clearRect(0,0,this.width,this.height),t<0?(t=Math.abs(t),i=this.height-t,e&&n.drawImage(o,0,0,r,t,0,i,r,t),n.drawImage(o,0,t,r,i,0,0,r,i)):(i=this.height-t,e&&n.drawImage(o,0,i,r,t,0,0,r,t),n.drawImage(o,0,0,r,i,0,t,r,i)),this.clear(),this.copy(this._swapCanvas)},add:function(t){if(Array.isArray(t))for(var e=0;e<t.length;e++)t[e].loadTexture&&t[e].loadTexture(this);else t.loadTexture(this);return this},load:function(t){if(t="string"==typeof t?this.game.cache.getImage(t):t)return this.resize(t.width,t.height),this.cls(),this.draw(t),this.update(),this},clear:function(t,e,i,n){return void 0===i&&(i=this.width),void 0===n&&(n=this.height),this.context.clearRect(t=void 0===t?0:t,e=void 0===e?0:e,i,n),this.dirty=!0,this},fill:function(t,e,i,n){return this.context.fillStyle="rgba("+t+","+e+","+i+","+(n=void 0===n?1:n)+")",this.context.fillRect(0,0,this.width,this.height),this.dirty=!0,this},generateTexture:function(t){var e=new Image;e.src=this.canvas.toDataURL("image/png");e=this.game.cache.addImage(t,"",e);return new PIXI.Texture(e.base)},resize:function(t,e){return t===this.width&&e===this.height||(this.width=t,this.height=e,this.canvas.width=t,this.canvas.height=e,void 0!==this._swapCanvas&&(this._swapCanvas.width=t,this._swapCanvas.height=e),this.baseTexture.width=t,this.baseTexture.height=e,this.textureFrame.width=t,this.textureFrame.height=e,this.texture.width=t,this.texture.height=e,this.texture.crop.width=t,this.texture.crop.height=e,this.update(),this.dirty=!0),this},update:function(t,e,i,n){return void 0===t&&(t=0),void 0===e&&(e=0),void 0===i&&(i=Math.max(1,this.width)),void 0===n&&(n=Math.max(1,this.height)),this.imageData=this.context.getImageData(t,e,i,n),this.data=this.imageData.data,this.imageData.data.buffer?(this.buffer=this.imageData.data.buffer,this.pixels=new Uint32Array(this.buffer)):window.ArrayBuffer?(this.buffer=new ArrayBuffer(this.imageData.data.length),this.pixels=new Uint32Array(this.buffer)):this.pixels=this.imageData.data,this},processPixelRGB:function(t,e,i,n,r,o){for(var s,a=(i=void 0===i?0:i)+(r=void 0===r?this.width:r),h=(n=void 0===n?0:n)+(o=void 0===o?this.height:o),l=U.Color.createColor(),p=!1,u=n;u<h;u++)for(var d=i;d<a;d++)U.Color.unpackPixel(this.getPixel32(d,u),l),!1!==(s=t.call(e,l,d,u))&&null!=s&&(this.setPixel32(d,u,s.r,s.g,s.b,s.a,!1),p=!0);return p&&(this.context.putImageData(this.imageData,0,0),this.dirty=!0),this},processPixel:function(t,e,i,n,r,o){for(var s,a,h=(i=void 0===i?0:i)+(r=void 0===r?this.width:r),l=(n=void 0===n?0:n)+(o=void 0===o?this.height:o),p=!1,u=n;u<l;u++)for(var d=i;d<h;d++)s=this.getPixel32(d,u),(a=t.call(e,s,d,u))!==s&&(this.pixels[u*this.width+d]=a,p=!0);return p&&(this.context.putImageData(this.imageData,0,0),this.dirty=!0),this},replaceRGB:function(t,e,i,n,r,o,s,a,h){var l=0,p=0,u=this.width,d=this.height,c=U.Color.packPixel(t,e,i,n);void 0!==h&&h instanceof U.Rectangle&&(l=h.x,p=h.y,u=h.width,d=h.height);for(var y=0;y<d;y++)for(var _=0;_<u;_++)this.getPixel32(l+_,p+y)===c&&this.setPixel32(l+_,p+y,r,o,s,a,!1);return this.context.putImageData(this.imageData,0,0),this.dirty=!0,this},setHSL:function(t,e,i,n){var r=t||0===t,o=e||0===e,s=i||0===i;if(r||o||s){void 0===n&&(n=new U.Rectangle(0,0,this.width,this.height));for(var a=U.Color.createColor(),h=n.y;h<n.bottom;h++)for(var l=n.x;l<n.right;l++)U.Color.unpackPixel(this.getPixel32(l,h),a,!0),r&&(a.h=t),o&&(a.s=e),s&&(a.l=i),U.Color.HSLtoRGB(a.h,a.s,a.l,a),this.setPixel32(l,h,a.r,a.g,a.b,a.a,!1);return this.context.putImageData(this.imageData,0,0),this.dirty=!0,this}},shiftHSL:function(t,e,i,n){if(null!=e||(e=!1),null!=i||(i=!1),(t=null==t?!1:t)||e||i){void 0===n&&(n=new U.Rectangle(0,0,this.width,this.height));for(var r=U.Color.createColor(),o=n.y;o<n.bottom;o++)for(var s=n.x;s<n.right;s++)U.Color.unpackPixel(this.getPixel32(s,o),r,!0),t&&(r.h=this.game.math.wrap(r.h+t,0,1)),e&&(r.s=this.game.math.clamp(r.s+e,0,1)),i&&(r.l=this.game.math.clamp(r.l+i,0,1)),U.Color.HSLtoRGB(r.h,r.s,r.l,r),this.setPixel32(s,o,r.r,r.g,r.b,r.a,!1);return this.context.putImageData(this.imageData,0,0),this.dirty=!0,this}},setPixel32:function(t,e,i,n,r,o,s){return void 0===s&&(s=!0),0<=t&&t<=this.width&&0<=e&&e<=this.height&&(U.Device.LITTLE_ENDIAN?this.pixels[e*this.width+t]=o<<24|r<<16|n<<8|i:this.pixels[e*this.width+t]=i<<24|n<<16|r<<8|o,s&&(this.context.putImageData(this.imageData,0,0),this.dirty=!0)),this},setPixel:function(t,e,i,n,r,o){return this.setPixel32(t,e,i,n,r,255,o)},getPixel:function(t,e,i){i=i||U.Color.createColor();e=~~(t+e*this.width);return i.r=this.data[e*=4],i.g=this.data[++e],i.b=this.data[++e],i.a=this.data[++e],i},getPixel32:function(t,e){if(0<=t&&t<=this.width&&0<=e&&e<=this.height)return this.pixels[e*this.width+t]},getPixelRGB:function(t,e,i,n,r){return U.Color.unpackPixel(this.getPixel32(t,e),i,n,r)},getPixels:function(t){return this.context.getImageData(t.x,t.y,t.width,t.height)},getFirstPixel:function(t){void 0===t&&(t=0);var e=U.Color.createColor(),i=0,n=0,r=1,o=!1;for(1===t?(r=-1,n=this.height):3===t&&(r=-1,i=this.width);U.Color.unpackPixel(this.getPixel32(i,n),e),0===t||1===t?++i===this.width&&(i=0,((n+=r)>=this.height||n<=0)&&(o=!0)):2!==t&&3!==t||++n===this.height&&(n=0,((i+=r)>=this.width||i<=0)&&(o=!0)),0===e.a&&!o;);return e.x=i,e.y=n,e},getBounds:function(t){return(t=void 0===t?new U.Rectangle:t).x=this.getFirstPixel(2).x,t.x===this.width?t.setTo(0,0,0,0):(t.y=this.getFirstPixel(0).y,t.width=this.getFirstPixel(3).x-t.x+1,t.height=this.getFirstPixel(1).y-t.y+1,t)},addToWorld:function(t,e,i,n,r,o){r=r||1,o=o||1;e=this.game.add.image(t,e,this);return e.anchor.set(i,n),e.scale.set(r,o),e},copy:function(t,e,i,n,r,o,s,a,h,l,p,u,d,c,y,_,m){if(((t=null==t?this:t)instanceof U.RenderTexture||t instanceof PIXI.RenderTexture)&&(t=t.getCanvas()),(this._image=t)instanceof U.Sprite||t instanceof U.Image||t instanceof U.Text||t instanceof PIXI.Sprite)this._pos.set(t.texture.crop.x,t.texture.crop.y),this._size.set(t.texture.crop.width,t.texture.crop.height),this._scale.set(t.scale.x,t.scale.y),this._anchor.set(t.anchor.x,t.anchor.y),this._rotate=t.rotation,this._alpha.current=t.alpha,t.texture instanceof U.RenderTexture||t.texture instanceof PIXI.RenderTexture?this._image=t.texture.getCanvas():this._image=t.texture.baseTexture.source,null!=o||(o=t.x),null!=s||(s=t.y),t.texture.trim&&(o+=t.texture.trim.x-t.anchor.x*t.texture.trim.width,s+=t.texture.trim.y-t.anchor.y*t.texture.trim.height),16777215!==t.tint&&(t.cachedTint!==t.tint&&(t.cachedTint=t.tint,t.tintedTexture=PIXI.CanvasTinter.getTintedTexture(t,t.tint)),this._image=t.tintedTexture,this._pos.set(0));else{if(this._pos.set(0),this._scale.set(1),this._anchor.set(0),this._rotate=0,this._alpha.current=1,t instanceof U.BitmapData)this._image=t.canvas;else if("string"==typeof t){if(null===(t=this.game.cache.getImage(t)))return;this._image=t}this._size.set(this._image.width,this._image.height)}if(null!=e||(e=0),null!=i||(i=0),n&&(this._size.x=n),r&&(this._size.y=r),null!=o||(o=e),null!=s||(s=i),null!=a||(a=this._size.x),null!=h||(h=this._size.y),"number"==typeof l&&(this._rotate=l),"number"==typeof p&&(this._anchor.x=p),"number"==typeof u&&(this._anchor.y=u),"number"==typeof d&&(this._scale.x=d),"number"==typeof c&&(this._scale.y=c),"number"==typeof y&&(this._alpha.current=y),void 0===_&&(_=null),void 0===m&&(m=!1),!(this._alpha.current<=0||0===this._scale.x||0===this._scale.y||0===this._size.x||0===this._size.y)){y=this.context;return this._alpha.prev=y.globalAlpha,y.save(),y.globalAlpha=this._alpha.current,_&&(this.op=_),m&&(o|=0,s|=0),y.translate(o,s),y.scale(this._scale.x,this._scale.y),y.rotate(this._rotate),y.drawImage(this._image,this._pos.x+e,this._pos.y+i,this._size.x,this._size.y,-a*this._anchor.x,-h*this._anchor.y,a,h),y.restore(),y.globalAlpha=this._alpha.prev,this.dirty=!0,this}},copyTransform:function(t,e,i){if(void 0===e&&(e=null),void 0===i&&(i=!1),!t.hasOwnProperty("worldTransform")||!t.worldVisible||0===t.worldAlpha)return this;var n=t.worldTransform;if(this._pos.set(t.texture.crop.x,t.texture.crop.y),this._size.set(t.texture.crop.width,t.texture.crop.height),0===n.a||0===n.d||0===this._size.x||0===this._size.y)return this;t.texture instanceof U.RenderTexture||t.texture instanceof PIXI.RenderTexture?this._image=t.texture.getCanvas():this._image=t.texture.baseTexture.source;var r=n.tx,o=n.ty;t.texture.trim&&(r+=t.texture.trim.x-t.anchor.x*t.texture.trim.width,o+=t.texture.trim.y-t.anchor.y*t.texture.trim.height),16777215!==t.tint&&(t.cachedTint!==t.tint&&(t.cachedTint=t.tint,t.tintedTexture=PIXI.CanvasTinter.getTintedTexture(t,t.tint)),this._image=t.tintedTexture,this._pos.set(0)),i&&(r|=0,o|=0);i=this.context;return this._alpha.prev=i.globalAlpha,i.save(),i.globalAlpha=this._alpha.current,e&&(this.op=e),i[this.smoothProperty]=t.texture.baseTexture.scaleMode===PIXI.scaleModes.LINEAR,i.setTransform(n.a,n.b,n.c,n.d,r,o),i.drawImage(this._image,this._pos.x,this._pos.y,this._size.x,this._size.y,-this._size.x*t.anchor.x,-this._size.y*t.anchor.y,this._size.x,this._size.y),i.restore(),i.globalAlpha=this._alpha.prev,this.dirty=!0,this},copyRect:function(t,e,i,n,r,o,s){return this.copy(t,e.x,e.y,e.width,e.height,i,n,e.width,e.height,0,0,0,1,1,r,o,s)},draw:function(t,e,i,n,r,o,s){return this.copy(t,null,null,null,null,e,i,n,r,null,null,null,null,null,null,o,s)},drawGroup:function(t,e,i){return 0<t.total&&t.forEachExists(this.drawGroupProxy,this,e,i),this},drawGroupProxy:function(t,e,i){if(t.hasOwnProperty("texture")&&this.copyTransform(t,e,i),t.type===U.GROUP&&t.exists)this.drawGroup(t,e,i);else if(t.hasOwnProperty("children")&&0<t.children.length)for(var n=0;n<t.children.length;n++)t.children[n].exists&&this.copyTransform(t.children[n],e,i)},drawFull:function(t,e,i){if(!1===t.worldVisible||0===t.worldAlpha||t.hasOwnProperty("exists")&&!1===t.exists)return this;var n;if(t.type!==U.GROUP&&t.type!==U.EMITTER&&t.type!==U.BITMAPTEXT&&(t.type===U.GRAPHICS?(n=t.getBounds(),this.ctx.save(),this.ctx.translate(n.x,n.y),PIXI.CanvasGraphics.renderGraphics(t,this.ctx),this.ctx.restore()):this.copy(t,null,null,null,null,t.worldPosition.x,t.worldPosition.y,null,null,t.worldRotation,null,null,t.worldScale.x,t.worldScale.y,t.worldAlpha,e,i)),t.children)for(var r=0;r<t.children.length;r++)this.drawFull(t.children[r],e,i);return this},shadow:function(t,e,i,n){var r=this.context;return null==t?r.shadowColor="rgba(0,0,0,0)":(r.shadowColor=t,r.shadowBlur=e||5,r.shadowOffsetX=i||10,r.shadowOffsetY=n||10),this},alphaMask:function(t,e,i,n){return(null==n?this.draw(e):this.draw(e,n.x,n.y,n.width,n.height)).blendSourceAtop(),(null==i?this.draw(t):this.draw(t,i.x,i.y,i.width,i.height)).blendReset(),this},extract:function(n,r,o,s,a,t,h,l,p){return void 0===a&&(a=255),void 0===h&&(h=r),void 0===l&&(l=o),void 0===p&&(p=s),(t=void 0===t?!1:t)&&n.resize(this.width,this.height),this.processPixelRGB(function(t,e,i){return t.r===r&&t.g===o&&t.b===s&&n.setPixel32(e,i,h,l,p,a,!1),!1},this),n.context.putImageData(n.imageData,0,0),n.dirty=!0,n},rect:function(t,e,i,n,r){return void 0!==r&&(this.context.fillStyle=r),this.context.fillRect(t,e,i,n),this},text:function(t,e,i,n,r,o){void 0===e&&(e=0),void 0===i&&(i=0),void 0===r&&(r="rgb(255,255,255)"),void 0===o&&(o=!0);var s=this.context,a=s.font;return s.font=n=void 0===n?"14px Courier":n,o&&(s.fillStyle="rgb(0,0,0)",s.fillText(t,e+1,i+1)),s.fillStyle=r,s.fillText(t,e,i),s.font=a,this},circle:function(t,e,i,n){var r=this.context;return void 0!==n&&(r.fillStyle=n),r.beginPath(),r.arc(t,e,i,0,2*Math.PI,!1),r.closePath(),r.fill(),this},line:function(t,e,i,n,r,o){void 0===r&&(r="#fff"),void 0===o&&(o=1);var s=this.context;return s.beginPath(),s.moveTo(t,e),s.lineTo(i,n),s.lineWidth=o,s.strokeStyle=r,s.stroke(),s.closePath(),this},textureLine:function(t,e,i){if(void 0===i&&(i="repeat-x"),"string"!=typeof e||(e=this.game.cache.getImage(e))){var n=t.length;"no-repeat"===i&&n>e.width&&(n=e.width);var r=this.context;return r.fillStyle=r.createPattern(e,i),this._circle=new U.Circle(t.start.x,t.start.y,e.height),this._circle.circumferencePoint(t.angle-1.5707963267948966,!1,this._pos),r.save(),r.translate(this._pos.x,this._pos.y),r.rotate(t.angle),r.fillRect(0,0,n,e.height),r.restore(),this.dirty=!0,this}},render:function(){return!this.disableTextureUpload&&this.dirty&&(this.baseTexture.dirty(),this.dirty=!1),this},destroy:function(){this.frameData.destroy(),this.texture.destroy(!0),PIXI.CanvasPool.remove(this)},blendReset:function(){return this.op="source-over",this},blendSourceOver:function(){return this.op="source-over",this},blendSourceIn:function(){return this.op="source-in",this},blendSourceOut:function(){return this.op="source-out",this},blendSourceAtop:function(){return this.op="source-atop",this},blendDestinationOver:function(){return this.op="destination-over",this},blendDestinationIn:function(){return this.op="destination-in",this},blendDestinationOut:function(){return this.op="destination-out",this},blendDestinationAtop:function(){return this.op="destination-atop",this},blendXor:function(){return this.op="xor",this},blendAdd:function(){return this.op="lighter",this},blendMultiply:function(){return this.op="multiply",this},blendScreen:function(){return this.op="screen",this},blendOverlay:function(){return this.op="overlay",this},blendDarken:function(){return this.op="darken",this},blendLighten:function(){return this.op="lighten",this},blendColorDodge:function(){return this.op="color-dodge",this},blendColorBurn:function(){return this.op="color-burn",this},blendHardLight:function(){return this.op="hard-light",this},blendSoftLight:function(){return this.op="soft-light",this},blendDifference:function(){return this.op="difference",this},blendExclusion:function(){return this.op="exclusion",this},blendHue:function(){return this.op="hue",this},blendSaturation:function(){return this.op="saturation",this},blendColor:function(){return this.op="color",this},blendLuminosity:function(){return this.op="luminosity",this}},Object.defineProperty(U.BitmapData.prototype,"smoothed",{get:function(){U.Canvas.getSmoothingEnabled(this.context)},set:function(t){U.Canvas.setSmoothingEnabled(this.context,t)}}),Object.defineProperty(U.BitmapData.prototype,"op",{get:function(){return this.context.globalCompositeOperation},set:function(t){this.context.globalCompositeOperation=t}}),U.BitmapData.getTransform=function(t,e,i,n,r,o){return{sx:i="number"!=typeof i?1:i,sy:n="number"!=typeof n?1:n,scaleX:i,scaleY:n,skewX:r="number"!=typeof r?0:r,skewY:o="number"!=typeof o?0:o,translateX:t="number"!=typeof t?0:t,translateY:e="number"!=typeof e?0:e,tx:t,ty:e}},U.BitmapData.prototype.constructor=U.BitmapData,PIXI.Graphics=function(){PIXI.DisplayObjectContainer.call(this),this.renderable=!0,this.fillAlpha=1,this.lineWidth=0,this.lineColor=0,this.graphicsData=[],this.tint=16777215,this.blendMode=PIXI.blendModes.NORMAL,this.currentPath=null,this._webGL=[],this.isMask=!1,this.boundsPadding=0,this._localBounds=new PIXI.Rectangle(0,0,1,1),this.dirty=!0,this._boundsDirty=!1,this.webGLDirty=!1,this.cachedSpriteDirty=!1},PIXI.Graphics.prototype=Object.create(PIXI.DisplayObjectContainer.prototype),PIXI.Graphics.prototype.constructor=PIXI.Graphics,PIXI.Graphics.prototype.lineStyle=function(t,e,i){return this.lineWidth=t||0,this.lineColor=e||0,this.lineAlpha=void 0===i?1:i,this.currentPath&&(this.currentPath.shape.points.length?this.drawShape(new PIXI.Polygon(this.currentPath.shape.points.slice(-2))):(this.currentPath.lineWidth=this.lineWidth,this.currentPath.lineColor=this.lineColor,this.currentPath.lineAlpha=this.lineAlpha)),this},PIXI.Graphics.prototype.moveTo=function(t,e){return this.drawShape(new PIXI.Polygon([t,e])),this},PIXI.Graphics.prototype.lineTo=function(t,e){return this.currentPath||this.moveTo(0,0),this.currentPath.shape.points.push(t,e),this.dirty=!0,this._boundsDirty=!0,this},PIXI.Graphics.prototype.quadraticCurveTo=function(t,e,i,n){this.currentPath?0===this.currentPath.shape.points.length&&(this.currentPath.shape.points=[0,0]):this.moveTo(0,0);var r,o=this.currentPath.shape.points;0===o.length&&this.moveTo(0,0);for(var s,a=o[o.length-2],h=o[o.length-1],l=1;l<=20;++l)o.push((r=a+(t-a)*(s=l/20))+(t+(i-t)*s-r)*s,(r=h+(e-h)*s)+(e+(n-e)*s-r)*s);return this.dirty=!0,this._boundsDirty=!0,this},PIXI.Graphics.prototype.bezierCurveTo=function(t,e,i,n,r,o){this.currentPath?0===this.currentPath.shape.points.length&&(this.currentPath.shape.points=[0,0]):this.moveTo(0,0);for(var s,a,h,l,p,u,d=this.currentPath.shape.points,c=d[d.length-2],y=d[d.length-1],_=1;_<=20;++_)d.push((h=(a=(s=1-(u=_/20))*s)*s)*c+3*a*u*t+3*s*(l=u*u)*i+(p=l*u)*r,h*y+3*a*u*e+3*s*l*n+p*o);return this.dirty=!0,this._boundsDirty=!0,this},PIXI.Graphics.prototype.arcTo=function(t,e,i,n,r){this.currentPath?0===this.currentPath.shape.points.length&&this.currentPath.shape.points.push(t,e):this.moveTo(t,e);var o,s,a=this.currentPath.shape.points,h=a[a.length-2],l=a[a.length-1]-e,p=h-t,u=n-e,d=i-t,c=Math.abs(l*d-p*u);return c<1e-8||0===r?a[a.length-2]===t&&a[a.length-1]===e||a.push(t,e):(o=l*l+p*p,s=u*u+d*d,h=l*u+p*d,i=(n=r*Math.sqrt(o)/c)*h/o,o=n*d+(a=r*Math.sqrt(s)/c)*p,c=n*u+a*l,s=d*(n+(h=a*h/s)),h=u*(n+h),i=Math.atan2(l*(a+i)-c,p*(a+i)-o),s=Math.atan2(h-c,s-o),this.arc(o+t,c+e,r,i,s,d*l<p*u)),this.dirty=!0,this._boundsDirty=!0,this},PIXI.Graphics.prototype.arc=function(t,e,i,n,r,o,s){if(n===r)return this;void 0===s&&(s=40),!(o=void 0===o?!1:o)&&r<=n?r+=2*Math.PI:o&&n<=r&&(n+=2*Math.PI);var a=o?-1*(n-r):r-n,h=Math.ceil(Math.abs(a)/(2*Math.PI))*s;if(0==a)return this;r=t+Math.cos(n)*i,s=e+Math.sin(n)*i;o&&this.filling?this.moveTo(t,e):this.moveTo(r,s);for(var l=this.currentPath.shape.points,p=a/(2*h),u=2*p,d=Math.cos(p),c=Math.sin(p),y=h-1,_=y%1/y,m=0;m<=y;m++){var g=p+n+u*(m+_*m),f=Math.cos(g),g=-Math.sin(g);l.push((d*f+c*g)*i+t,(d*-g+c*f)*i+e)}return this.dirty=!0,this._boundsDirty=!0,this},PIXI.Graphics.prototype.beginFill=function(t,e){return this.filling=!0,this.fillColor=t||0,this.fillAlpha=void 0===e?1:e,this.currentPath&&this.currentPath.shape.points.length<=2&&(this.currentPath.fill=this.filling,this.currentPath.fillColor=this.fillColor,this.currentPath.fillAlpha=this.fillAlpha),this},PIXI.Graphics.prototype.endFill=function(){return this.filling=!1,this.fillColor=null,this.fillAlpha=1,this},PIXI.Graphics.prototype.drawRect=function(t,e,i,n){return this.drawShape(new PIXI.Rectangle(t,e,i,n)),this},PIXI.Graphics.prototype.drawRoundedRect=function(t,e,i,n,r){return this.drawShape(new PIXI.RoundedRectangle(t,e,i,n,r)),this},PIXI.Graphics.prototype.drawCircle=function(t,e,i){return this.drawShape(new PIXI.Circle(t,e,i)),this},PIXI.Graphics.prototype.drawEllipse=function(t,e,i,n){return this.drawShape(new PIXI.Ellipse(t,e,i,n)),this},PIXI.Graphics.prototype.drawPolygon=function(t){var e=t=t instanceof U.Polygon||t instanceof PIXI.Polygon?t.points:t;if(!Array.isArray(e))for(var e=new Array(arguments.length),i=0;i<e.length;++i)e[i]=arguments[i];return this.drawShape(new U.Polygon(e)),this},PIXI.Graphics.prototype.clear=function(){return this.lineWidth=0,this.filling=!1,this.dirty=!0,this._boundsDirty=!0,this.clearDirty=!0,this.graphicsData=[],this.updateLocalBounds(),this},PIXI.Graphics.prototype.generateTexture=function(t,e,i){void 0===t&&(t=1),void 0===e&&(e=PIXI.scaleModes.DEFAULT),void 0===i&&(i=0);var n=this.getBounds();n.width+=i,n.height+=i;i=new PIXI.CanvasBuffer(n.width*t,n.height*t),e=PIXI.Texture.fromCanvas(i.canvas,e);return e.baseTexture.resolution=t,i.context.scale(t,t),i.context.translate(-n.x,-n.y),PIXI.CanvasGraphics.renderGraphics(this,i.context),e},PIXI.Graphics.prototype._renderWebGL=function(t){if(!1!==this.visible&&0!==this.alpha&&!0!==this.isMask){if(this._cacheAsBitmap)return(this.dirty||this.cachedSpriteDirty)&&(this._generateCachedSprite(),this.updateCachedSpriteTexture(),this.cachedSpriteDirty=!1,this.dirty=!1),this._cachedSprite.worldAlpha=this.worldAlpha,void PIXI.Sprite.prototype._renderWebGL.call(this._cachedSprite,t);var e;if(t.spriteBatch.stop(),t.blendModeManager.setBlendMode(this.blendMode),this._mask&&t.maskManager.pushMask(this._mask,t),this._filters&&t.filterManager.pushFilter(this._filterBlock),this.blendMode!==t.spriteBatch.currentBlendMode&&(t.spriteBatch.currentBlendMode=this.blendMode,e=PIXI.blendModesWebGL[t.spriteBatch.currentBlendMode],t.spriteBatch.gl.blendFunc(e[0],e[1])),this.webGLDirty&&(this.dirty=!0,this.webGLDirty=!1),PIXI.WebGLGraphics.renderGraphics(this,t),this.children.length){t.spriteBatch.start();for(var i=0;i<this.children.length;i++)this.children[i]._renderWebGL(t);t.spriteBatch.stop()}this._filters&&t.filterManager.popFilter(),this._mask&&t.maskManager.popMask(this.mask,t),t.drawCount++,t.spriteBatch.start()}},PIXI.Graphics.prototype._renderCanvas=function(t){if(!1!==this.visible&&0!==this.alpha&&!0!==this.isMask){if(this._prevTint!==this.tint&&(this.dirty=!0,this._prevTint=this.tint),this._cacheAsBitmap)return(this.dirty||this.cachedSpriteDirty)&&(this._generateCachedSprite(),this.updateCachedSpriteTexture(),this.cachedSpriteDirty=!1,this.dirty=!1),this._cachedSprite.alpha=this.alpha,void PIXI.Sprite.prototype._renderCanvas.call(this._cachedSprite,t);var e=t.context,i=this.worldTransform;this.blendMode!==t.currentBlendMode&&(t.currentBlendMode=this.blendMode,e.globalCompositeOperation=PIXI.blendModesCanvas[t.currentBlendMode]),this._mask&&t.maskManager.pushMask(this._mask,t);var n=t.resolution,r=i.tx*t.resolution+t.shakeX,o=i.ty*t.resolution+t.shakeY;e.setTransform(i.a*n,i.b*n,i.c*n,i.d*n,r,o),PIXI.CanvasGraphics.renderGraphics(this,e);for(var s=0;s<this.children.length;s++)this.children[s]._renderCanvas(t);this._mask&&t.maskManager.popMask(t)}},PIXI.Graphics.prototype.getBounds=function(t){if(!this._currentBounds){if(!this.renderable)return PIXI.EmptyRectangle;this.dirty&&(this.updateLocalBounds(),this.webGLDirty=!0,this.cachedSpriteDirty=!0,this.dirty=!1);var e=this._localBounds,i=e.x,n=e.width+e.x,r=e.y,o=e.height+e.y,s=t||this.worldTransform,a=s.a,h=s.b,l=s.c,p=s.d,u=s.tx,d=s.ty,c=a*n+l*o+u,e=p*o+h*n+d,t=a*i+l*o+u,s=p*o+h*i+d,o=a*i+l*r+u,i=p*r+h*i+d,u=a*n+l*r+u,h=p*r+h*n+d,n=t<(n=c)?t:n,d=h<(d=i<(d=s<(d=e)?s:d)?i:d)?h:d,c=(c=(c=(c=c)<t?t:c)<o?o:c)<u?u:c,e=(e=(e=(e=e)<s?s:e)<i?i:e)<h?h:e;this._bounds.x=n=u<(n=o<n?o:n)?u:n,this._bounds.width=c-n,this._bounds.y=d,this._bounds.height=e-d,this._currentBounds=this._bounds}return this._currentBounds},PIXI.Graphics.prototype.getLocalBounds=function(){var t=this.worldTransform;this.worldTransform=PIXI.identityMatrix;for(var e=0;e<this.children.length;e++)this.children[e].updateTransform();var i=this.getBounds();for(this.worldTransform=t,e=0;e<this.children.length;e++)this.children[e].updateTransform();return i},PIXI.Graphics.prototype.containsPoint=function(t){this.worldTransform.applyInverse(t,tempPoint);for(var e=this.graphicsData,i=0;i<e.length;i++){var n=e[i];if(n.fill&&n.shape&&n.shape.contains(tempPoint.x,tempPoint.y))return!0}return!1},PIXI.Graphics.prototype.updateLocalBounds=function(){var t=1/0,e=-1/0,i=1/0,n=-1/0;if(this.graphicsData.length)for(var r,o,s,a,h=0;h<this.graphicsData.length;h++){var l=this.graphicsData[h],p=l.type,u=l.lineWidth,l=l.shape;if(p===PIXI.Graphics.RECT||p===PIXI.Graphics.RREC)r=l.x-u/2,o=l.y-u/2,t=r<t?r:t,e=e<r+(s=l.width+u)?r+s:e,i=o<i?o:i,n=n<o+(a=l.height+u)?o+a:n;else if(p===PIXI.Graphics.CIRC)r=l.x,o=l.y,t=r-(s=l.radius+u/2)<t?r-s:t,e=e<r+s?r+s:e,i=o-(a=l.radius+u/2)<i?o-a:i,n=n<o+a?o+a:n;else if(p===PIXI.Graphics.ELIP)r=l.x,o=l.y,t=r-(s=l.width+u/2)<t?r-s:t,e=e<r+s?r+s:e,i=o-(a=l.height+u/2)<i?o-a:i,n=n<o+a?o+a:n;else for(var d=l.points,c=0;c<d.length;c++)d[c]instanceof U.Point?(r=d[c].x,o=d[c].y):(r=d[c],o=d[c+1],c<d.length-1&&c++),t=r-u<t?r-u:t,e=e<r+u?r+u:e,i=o-u<i?o-u:i,n=n<o+u?o+u:n}else n=i=e=t=0;var y=this.boundsPadding;this._localBounds.x=t-y,this._localBounds.width=e-t+2*y,this._localBounds.y=i-y,this._localBounds.height=n-i+2*y},PIXI.Graphics.prototype._generateCachedSprite=function(){var t,e,i=this.getLocalBounds();this._cachedSprite?this._cachedSprite.buffer.resize(i.width,i.height):(t=new PIXI.CanvasBuffer(i.width,i.height),e=PIXI.Texture.fromCanvas(t.canvas),this._cachedSprite=new PIXI.Sprite(e),this._cachedSprite.buffer=t,this._cachedSprite.worldTransform=this.worldTransform),this._cachedSprite.anchor.x=-i.x/i.width,this._cachedSprite.anchor.y=-i.y/i.height,this._cachedSprite.buffer.context.translate(-i.x,-i.y),this.worldAlpha=1,PIXI.CanvasGraphics.renderGraphics(this,this._cachedSprite.buffer.context),this._cachedSprite.alpha=this.alpha},PIXI.Graphics.prototype.updateCachedSpriteTexture=function(){var t=this._cachedSprite,e=t.texture,i=t.buffer.canvas;e.baseTexture.width=i.width,e.baseTexture.height=i.height,e.crop.width=e.frame.width=i.width,e.crop.height=e.frame.height=i.height,t._width=i.width,t._height=i.height,e.baseTexture.dirty()},PIXI.Graphics.prototype.destroyCachedSprite=function(){this._cachedSprite.texture.destroy(!0),this._cachedSprite=null},PIXI.Graphics.prototype.drawShape=function(t){this.currentPath&&this.currentPath.shape.points.length<=2&&this.graphicsData.pop(),this.currentPath=null,t instanceof U.Polygon&&(t=t.clone()).flatten();t=new PIXI.GraphicsData(this.lineWidth,this.lineColor,this.lineAlpha,this.fillColor,this.fillAlpha,this.filling,t);return this.graphicsData.push(t),t.type===PIXI.Graphics.POLY&&(t.shape.closed=this.filling,this.currentPath=t),this.dirty=!0,this._boundsDirty=!0,t},Object.defineProperty(PIXI.Graphics.prototype,"cacheAsBitmap",{get:function(){return this._cacheAsBitmap},set:function(t){this._cacheAsBitmap=t,this._cacheAsBitmap?this._generateCachedSprite():this.destroyCachedSprite(),this.dirty=!0,this.webGLDirty=!0}}),PIXI.GraphicsData=function(t,e,i,n,r,o,s){this.lineWidth=t,this.lineColor=e,this.lineAlpha=i,this._lineTint=e,this.fillColor=n,this.fillAlpha=r,this._fillTint=n,this.fill=o,this.shape=s,this.type=s.type},PIXI.GraphicsData.prototype.constructor=PIXI.GraphicsData,PIXI.GraphicsData.prototype.clone=function(){return new GraphicsData(this.lineWidth,this.lineColor,this.lineAlpha,this.fillColor,this.fillAlpha,this.fill,this.shape)},PIXI.EarCut={},PIXI.EarCut.Triangulate=function(t,e,i){i=i||2;var n,r,o,s,a,h=e&&e.length,l=h?e[0]*i:t.length,p=PIXI.EarCut.linkedList(t,0,l,i,!0),u=[];if(!p)return u;if(h&&(p=PIXI.EarCut.eliminateHoles(t,e,p,i)),t.length>80*i){for(var d=n=t[0],c=r=t[1],y=i;y<l;y+=i)(o=t[y])<d&&(d=o),(s=t[y+1])<c&&(c=s),n<o&&(n=o),r<s&&(r=s);a=Math.max(n-d,r-c)}return PIXI.EarCut.earcutLinked(p,u,i,d,c,a),u},PIXI.EarCut.linkedList=function(t,e,i,n,r){for(var o,s=0,a=e,h=i-n;a<i;a+=n)s+=(t[h]-t[a])*(t[a+1]+t[h+1]),h=a;if(r===0<s)for(a=e;a<i;a+=n)o=PIXI.EarCut.insertNode(a,t[a],t[a+1],o);else for(a=i-n;e<=a;a-=n)o=PIXI.EarCut.insertNode(a,t[a],t[a+1],o);return o},PIXI.EarCut.filterPoints=function(t,e){if(!t)return t;e=e||t;var i,n=t;do{if(i=!1,n.steiner||!PIXI.EarCut.equals(n,n.next)&&0!==PIXI.EarCut.area(n.prev,n,n.next))n=n.next;else{if(PIXI.EarCut.removeNode(n),(n=e=n.prev)===n.next)return null;i=!0}}while(i||n!==e);return e},PIXI.EarCut.earcutLinked=function(t,e,i,n,r,o,s){if(t){!s&&o&&PIXI.EarCut.indexCurve(t,n,r,o);for(var a,h,l=t;t.prev!==t.next;)if(a=t.prev,h=t.next,o?PIXI.EarCut.isEarHashed(t,n,r,o):PIXI.EarCut.isEar(t))e.push(a.i/i),e.push(t.i/i),e.push(h.i/i),PIXI.EarCut.removeNode(t),t=h.next,l=h.next;else if((t=h)===l){s?1===s?(t=PIXI.EarCut.cureLocalIntersections(t,e,i),PIXI.EarCut.earcutLinked(t,e,i,n,r,o,2)):2===s&&PIXI.EarCut.splitEarcut(t,e,i,n,r,o):PIXI.EarCut.earcutLinked(PIXI.EarCut.filterPoints(t),e,i,n,r,o,1);break}}},PIXI.EarCut.isEar=function(t){var e=t.prev,i=t,n=t.next;if(0<=PIXI.EarCut.area(e,i,n))return!1;for(var r=t.next.next;r!==t.prev;){if(PIXI.EarCut.pointInTriangle(e.x,e.y,i.x,i.y,n.x,n.y,r.x,r.y)&&0<=PIXI.EarCut.area(r.prev,r,r.next))return!1;r=r.next}return!0},PIXI.EarCut.isEarHashed=function(t,e,i,n){var r=t.prev,o=t,s=t.next;if(0<=PIXI.EarCut.area(r,o,s))return!1;for(var a=(r.x<o.x?r.x<s.x?r:s:o.x<s.x?o:s).x,h=(r.y<o.y?r.y<s.y?r:s:o.y<s.y?o:s).y,l=(r.x>o.x?r.x>s.x?r:s:o.x>s.x?o:s).x,p=(r.y>o.y?r.y>s.y?r:s:o.y>s.y?o:s).y,u=PIXI.EarCut.zOrder(a,h,e,i,n),d=PIXI.EarCut.zOrder(l,p,e,i,n),c=t.nextZ;c&&c.z<=d;){if(c!==t.prev&&c!==t.next&&PIXI.EarCut.pointInTriangle(r.x,r.y,o.x,o.y,s.x,s.y,c.x,c.y)&&0<=PIXI.EarCut.area(c.prev,c,c.next))return!1;c=c.nextZ}for(c=t.prevZ;c&&c.z>=u;){if(c!==t.prev&&c!==t.next&&PIXI.EarCut.pointInTriangle(r.x,r.y,o.x,o.y,s.x,s.y,c.x,c.y)&&0<=PIXI.EarCut.area(c.prev,c,c.next))return!1;c=c.prevZ}return!0},PIXI.EarCut.cureLocalIntersections=function(t,e,i){var n=t;do{var r=n.prev,o=n.next.next}while(PIXI.EarCut.intersects(r,n,n.next,o)&&PIXI.EarCut.locallyInside(r,o)&&PIXI.EarCut.locallyInside(o,r)&&(e.push(r.i/i),e.push(n.i/i),e.push(o.i/i),PIXI.EarCut.removeNode(n),PIXI.EarCut.removeNode(n.next),n=t=o),(n=n.next)!==t);return n},PIXI.EarCut.splitEarcut=function(t,e,i,n,r,o){var s=t;do{for(var a=s.next.next;a!==s.prev;){if(s.i!==a.i&&PIXI.EarCut.isValidDiagonal(s,a)){var h=PIXI.EarCut.splitPolygon(s,a),s=PIXI.EarCut.filterPoints(s,s.next),h=PIXI.EarCut.filterPoints(h,h.next);return PIXI.EarCut.earcutLinked(s,e,i,n,r,o),void PIXI.EarCut.earcutLinked(h,e,i,n,r,o)}a=a.next}}while((s=s.next)!==t)},PIXI.EarCut.eliminateHoles=function(t,e,i,n){for(var r,o,s=[],a=0,h=e.length;a<h;a++)r=e[a]*n,o=a<h-1?e[a+1]*n:t.length,(o=PIXI.EarCut.linkedList(t,r,o,n,!1))===o.next&&(o.steiner=!0),s.push(PIXI.EarCut.getLeftmost(o));for(s.sort(compareX),a=0;a<s.length;a++)PIXI.EarCut.eliminateHole(s[a],i),i=PIXI.EarCut.filterPoints(i,i.next);return i},PIXI.EarCut.compareX=function(t,e){return t.x-e.x},PIXI.EarCut.eliminateHole=function(t,e){(e=PIXI.EarCut.findHoleBridge(t,e))&&(t=PIXI.EarCut.splitPolygon(e,t),PIXI.EarCut.filterPoints(t,t.next))},PIXI.EarCut.findHoleBridge=function(t,e){var i,n,r=e,o=t.x,s=t.y,a=-1/0;do{}while(s<=r.y&&s>=r.next.y&&((n=r.x+(s-r.y)*(r.next.x-r.x)/(r.next.y-r.y))<=o&&a<n&&(a=n,i=r.x<r.next.x?r:r.next)),(r=r.next)!==e);if(!i)return null;if(t.x===i.x)return i.prev;for(var h,l=i,p=1/0,r=i.next;r!==l;)o>=r.x&&r.x>=i.x&&PIXI.EarCut.pointInTriangle(s<i.y?o:a,s,i.x,i.y,s<i.y?a:o,s,r.x,r.y)&&((h=Math.abs(s-r.y)/(o-r.x))<p||h===p&&r.x>i.x)&&PIXI.EarCut.locallyInside(r,t)&&(i=r,p=h),r=r.next;return i},PIXI.EarCut.indexCurve=function(t,e,i,n){for(var r=t;null===r.z&&(r.z=PIXI.EarCut.zOrder(r.x,r.y,e,i,n)),r.prevZ=r.prev,r.nextZ=r.next,(r=r.next)!==t;);r.prevZ.nextZ=null,r.prevZ=null,PIXI.EarCut.sortLinked(r)},PIXI.EarCut.sortLinked=function(t){var e,i,n,r,o,s,a,h,l=1;do{for(i=t,o=t=null,s=0;i;){for(s++,n=i,e=a=0;e<l&&(a++,n=n.nextZ);e++);for(h=l;0<a||0<h&&n;)0!==a&&(0===h||!n||i.z<=n.z)?(i=(r=i).nextZ,a--):(n=(r=n).nextZ,h--),o?o.nextZ=r:t=r,r.prevZ=o,o=r;i=n}}while(o.nextZ=null,l*=2,1<s);return t},PIXI.EarCut.zOrder=function(t,e,i,n,r){return(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=32767*(t-i)/r)|t<<8))|t<<4))|t<<2))|t<<1))|(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=32767*(e-n)/r)|e<<8))|e<<4))|e<<2))|e<<1))<<1},PIXI.EarCut.getLeftmost=function(t){for(var e=t,i=t;e.x<i.x&&(i=e),(e=e.next)!==t;);return i},PIXI.EarCut.pointInTriangle=function(t,e,i,n,r,o,s,a){return 0<=(r-s)*(e-a)-(t-s)*(o-a)&&0<=(t-s)*(n-a)-(i-s)*(e-a)&&0<=(i-s)*(o-a)-(r-s)*(n-a)},PIXI.EarCut.isValidDiagonal=function(t,e){return PIXI.EarCut.equals(t,e)||t.next.i!==e.i&&t.prev.i!==e.i&&!PIXI.EarCut.intersectsPolygon(t,e)&&PIXI.EarCut.locallyInside(t,e)&&PIXI.EarCut.locallyInside(e,t)&&PIXI.EarCut.middleInside(t,e)},PIXI.EarCut.area=function(t,e,i){return(e.y-t.y)*(i.x-e.x)-(e.x-t.x)*(i.y-e.y)},PIXI.EarCut.equals=function(t,e){return t.x===e.x&&t.y===e.y},PIXI.EarCut.intersects=function(t,e,i,n){return 0<PIXI.EarCut.area(t,e,i)!=0<PIXI.EarCut.area(t,e,n)&&0<PIXI.EarCut.area(i,n,t)!=0<PIXI.EarCut.area(i,n,e)},PIXI.EarCut.intersectsPolygon=function(t,e){var i=t;do{if(i.i!==t.i&&i.next.i!==t.i&&i.i!==e.i&&i.next.i!==e.i&&PIXI.EarCut.intersects(i,i.next,t,e))return!0}while((i=i.next)!==t);return!1},PIXI.EarCut.locallyInside=function(t,e){return PIXI.EarCut.area(t.prev,t,t.next)<0?0<=PIXI.EarCut.area(t,e,t.next)&&0<=PIXI.EarCut.area(t,t.prev,e):PIXI.EarCut.area(t,e,t.prev)<0||PIXI.EarCut.area(t,t.next,e)<0},PIXI.EarCut.middleInside=function(t,e){for(var i=t,n=!1,r=(t.x+e.x)/2,o=(t.y+e.y)/2;i.y>o!=i.next.y>o&&r<(i.next.x-i.x)*(o-i.y)/(i.next.y-i.y)+i.x&&(n=!n),(i=i.next)!==t;);return n},PIXI.EarCut.splitPolygon=function(t,e){var i=new PIXI.EarCut.Node(t.i,t.x,t.y),n=new PIXI.EarCut.Node(e.i,e.x,e.y),r=t.next,o=e.prev;return(t.next=e).prev=t,(i.next=r).prev=i,(n.next=i).prev=n,(o.next=n).prev=o,n},PIXI.EarCut.insertNode=function(t,e,i,n){i=new PIXI.EarCut.Node(t,e,i);return n?(i.next=n.next,(i.prev=n).next.prev=i,n.next=i):(i.prev=i).next=i,i},PIXI.EarCut.removeNode=function(t){t.next.prev=t.prev,t.prev.next=t.next,t.prevZ&&(t.prevZ.nextZ=t.nextZ),t.nextZ&&(t.nextZ.prevZ=t.prevZ)},PIXI.EarCut.Node=function(t,e,i){this.i=t,this.x=e,this.y=i,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1},PIXI.WebGLGraphics=function(){},PIXI.WebGLGraphics.stencilBufferLimit=6,PIXI.WebGLGraphics.renderGraphics=function(t,e){var i,n=e.gl,r=e.projection,o=e.offset,s=e.shaderManager.primitiveShader;t.dirty&&PIXI.WebGLGraphics.updateGraphics(t,n);for(var a=t._webGL[n.id],h=0;h<a.data.length;h++)1===a.data[h].mode?(i=a.data[h],e.stencilManager.pushStencil(t,i,e),n.drawElements(n.TRIANGLE_FAN,4,n.UNSIGNED_SHORT,2*(i.indices.length-4)),e.stencilManager.popStencil(t,i,e)):(i=a.data[h],e.shaderManager.setShader(s),s=e.shaderManager.primitiveShader,n.uniformMatrix3fv(s.translationMatrix,!1,t.worldTransform.toArray(!0)),n.uniform1f(s.flipY,1),n.uniform2f(s.projectionVector,r.x,-r.y),n.uniform2f(s.offsetVector,-o.x,-o.y),n.uniform3fv(s.tintColor,PIXI.hex2rgb(t.tint)),n.uniform1f(s.alpha,t.worldAlpha),n.bindBuffer(n.ARRAY_BUFFER,i.buffer),n.vertexAttribPointer(s.aVertexPosition,2,n.FLOAT,!1,24,0),n.vertexAttribPointer(s.colorAttribute,4,n.FLOAT,!1,24,8),n.bindBuffer(n.ELEMENT_ARRAY_BUFFER,i.indexBuffer),n.drawElements(n.TRIANGLE_STRIP,i.indices.length,n.UNSIGNED_SHORT,0))},PIXI.WebGLGraphics.updateGraphics=function(t,e){var i,n=(n=t._webGL[e.id])||(t._webGL[e.id]={lastIndex:0,data:[],gl:e});if(t.dirty=!1,t.clearDirty){for(t.clearDirty=!1,i=0;i<n.data.length;i++){var r=n.data[i];r.reset(),PIXI.WebGLGraphics.graphicsDataPool.push(r)}n.data=[],n.lastIndex=0}for(i=n.lastIndex;i<t.graphicsData.length;i++){var o,s=t.graphicsData[i];s.type===PIXI.Graphics.POLY?(s.points=s.shape.points.slice(),s.shape.closed&&(s.points[0]===s.points[s.points.length-2]&&s.points[1]===s.points[s.points.length-1]||s.points.push(s.points[0],s.points[1])),s.fill&&s.points.length>=PIXI.WebGLGraphics.stencilBufferLimit&&(s.points.length<2*PIXI.WebGLGraphics.stencilBufferLimit?(o=PIXI.WebGLGraphics.switchMode(n,0),PIXI.WebGLGraphics.buildPoly(s,o)||(o=PIXI.WebGLGraphics.switchMode(n,1),PIXI.WebGLGraphics.buildComplexPoly(s,o))):(o=PIXI.WebGLGraphics.switchMode(n,1),PIXI.WebGLGraphics.buildComplexPoly(s,o))),0<s.lineWidth&&(o=PIXI.WebGLGraphics.switchMode(n,0),PIXI.WebGLGraphics.buildLine(s,o))):(o=PIXI.WebGLGraphics.switchMode(n,0),s.type===PIXI.Graphics.RECT?PIXI.WebGLGraphics.buildRectangle(s,o):s.type===PIXI.Graphics.CIRC||s.type===PIXI.Graphics.ELIP?PIXI.WebGLGraphics.buildCircle(s,o):s.type===PIXI.Graphics.RREC&&PIXI.WebGLGraphics.buildRoundedRectangle(s,o)),n.lastIndex++}for(i=0;i<n.data.length;i++)(o=n.data[i]).dirty&&o.upload()},PIXI.WebGLGraphics.switchMode=function(t,e){var i;return t.data.length?(i=t.data[t.data.length-1]).mode===e&&1!==e||((i=PIXI.WebGLGraphics.graphicsDataPool.pop()||new PIXI.WebGLGraphicsData(t.gl)).mode=e,t.data.push(i)):((i=PIXI.WebGLGraphics.graphicsDataPool.pop()||new PIXI.WebGLGraphicsData(t.gl)).mode=e,t.data.push(i)),i.dirty=!0,i},PIXI.WebGLGraphics.buildRectangle=function(t,e){var i,n,r,o,s,a,h=t.shape,l=h.x,p=h.y,u=h.width,d=h.height;t.fill&&(a=PIXI.hex2rgb(t.fillColor),i=t.fillAlpha,n=a[0]*i,r=a[1]*i,o=a[2]*i,s=e.points,h=e.indices,a=s.length/6,s.push(l,p),s.push(n,r,o,i),s.push(l+u,p),s.push(n,r,o,i),s.push(l,p+d),s.push(n,r,o,i),s.push(l+u,p+d),s.push(n,r,o,i),h.push(a,a,1+a,2+a,3+a,3+a)),t.lineWidth&&(a=t.points,t.points=[l,p,l+u,p,l+u,p+d,l,p+d,l,p],PIXI.WebGLGraphics.buildLine(t,e),t.points=a)},PIXI.WebGLGraphics.buildRoundedRectangle=function(t,e){var i=t.shape,n=i.x,r=i.y,o=i.width,s=i.height,i=i.radius,a=[];if(a.push(n,r+i),a=(a=(a=(a=a.concat(PIXI.WebGLGraphics.quadraticBezierCurve(n,r+s-i,n,r+s,n+i,r+s))).concat(PIXI.WebGLGraphics.quadraticBezierCurve(n+o-i,r+s,n+o,r+s,n+o,r+s-i))).concat(PIXI.WebGLGraphics.quadraticBezierCurve(n+o,r+i,n+o,r,n+o-i,r))).concat(PIXI.WebGLGraphics.quadraticBezierCurve(n+i,r,n,r,n,r+i)),t.fill){for(var h=PIXI.hex2rgb(t.fillColor),l=t.fillAlpha,p=h[0]*l,u=h[1]*l,d=h[2]*l,c=e.points,y=e.indices,_=c.length/6,m=PIXI.EarCut.Triangulate(a,null,2),g=0,g=0;g<m.length;g+=3)y.push(m[g]+_),y.push(m[g]+_),y.push(m[g+1]+_),y.push(m[g+2]+_),y.push(m[g+2]+_);for(g=0;g<a.length;g++)c.push(a[g],a[++g],p,u,d,l)}t.lineWidth&&(h=t.points,t.points=a,PIXI.WebGLGraphics.buildLine(t,e),t.points=h)},PIXI.WebGLGraphics.quadraticBezierCurve=function(t,e,i,n,r,o){function s(t,e,i){return t+(e-t)*i}for(var a,h,l,p,u,d=[],c=0;c<=20;c++)a=s(t,i,u=c/20),h=s(e,n,u),p=s(i,r,u),l=s(n,o,u),p=s(a,p,u),u=s(h,l,u),d.push(p,u);return d},PIXI.WebGLGraphics.buildCircle=function(t,e){var i,n=t.shape,r=n.x,o=n.y,s=t.type===PIXI.Graphics.CIRC?(i=n.radius,n.radius):(i=n.width,n.height),a=2*Math.PI/40,h=0;if(t.fill){var l=PIXI.hex2rgb(t.fillColor),p=t.fillAlpha,u=l[0]*p,d=l[1]*p,c=l[2]*p,y=e.points,_=e.indices,m=y.length/6;for(_.push(m),h=0;h<41;h++)y.push(r,o,u,d,c,p),y.push(r+Math.sin(a*h)*i,o+Math.cos(a*h)*s,u,d,c,p),_.push(m++,m++);_.push(m-1)}if(t.lineWidth){l=t.points;for(t.points=[],h=0;h<41;h++)t.points.push(r+Math.sin(a*h)*i,o+Math.cos(a*h)*s);PIXI.WebGLGraphics.buildLine(t,e),t.points=l}},PIXI.WebGLGraphics.buildLine=function(t,e){var i=0,n=t.points;if(0!==n.length){if(t.lineWidth%2)for(i=0;i<n.length;i++)n[i]+=.5;var r,o=new PIXI.Point(n[0],n[1]),s=new PIXI.Point(n[n.length-2],n[n.length-1]);o.x===s.x&&o.y===s.y&&((n=n.slice()).pop(),n.pop(),r=(s=new PIXI.Point(n[n.length-2],n[n.length-1])).x+.5*(o.x-s.x),s=s.y+.5*(o.y-s.y),n.unshift(r,s),n.push(r,s));var a,h,l,p,u,d,c,y,_,m=e.points,g=e.indices,f=n.length/2,x=n.length,v=m.length/6,w=t.lineWidth/2,e=PIXI.hex2rgb(t.lineColor),z=t.lineAlpha,b=e[0]*z,S=e[1]*z,C=e[2]*z,P=n[0],M=n[1],T=n[2],A=n[3],k=-(M-A),O=P-T,E=Math.sqrt(k*k+O*O);for(k/=E,O/=E,m.push(P-(k*=w),M-(O*=w),b,S,C,z),m.push(P+k,M+O,b,S,C,z),i=1;i<f-1;i++)P=n[2*(i-1)],M=n[2*(i-1)+1],T=n[2*i],A=n[2*i+1],p=n[2*(i+1)],_=n[2*(i+1)+1],k=-(M-A),O=P-T,k/=E=Math.sqrt(k*k+O*O),O/=E,k*=w,O*=w,a=-(A-_),h=T-p,a/=E=Math.sqrt(a*a+h*h),h/=E,u=(-k+P)*(-O+A)-(-k+T)*(-O+M),y=(-(a*=w)+p)*(-(h*=w)+A)-(-a+T)*(-h+_),_=(l=-O+M-(-O+A))*(c=-a+T-(-a+p))-(d=-h+_-(-h+A))*(p=-k+T-(-k+P)),Math.abs(_)<.1?(_+=10.1,m.push(T-k,A-O,b,S,C,z),m.push(T+k,A+O,b,S,C,z)):19600<((c=(p*y-c*u)/_)-T)*(c-T)+((_=(d*u-l*y)/_)-A)+(_-A)?(a=k-a,h=O-h,a/=E=Math.sqrt(a*a+h*h),h/=E,m.push(T-(a*=w),A-(h*=w)),m.push(b,S,C,z),m.push(T+a,A+h),m.push(b,S,C,z),m.push(T-a,A-h),m.push(b,S,C,z),x++):(m.push(c,_),m.push(b,S,C,z),m.push(T-(c-T),A-(_-A)),m.push(b,S,C,z));for(P=n[2*(f-2)],M=n[2*(f-2)+1],T=n[2*(f-1)],k=-(M-(A=n[2*(f-1)+1])),O=P-T,k/=E=Math.sqrt(k*k+O*O),O/=E,m.push(T-(k*=w),A-(O*=w)),m.push(b,S,C,z),m.push(T+k,A+O),m.push(b,S,C,z),g.push(v),i=0;i<x;i++)g.push(v++);g.push(v-1)}},PIXI.WebGLGraphics.buildComplexPoly=function(t,e){var i=t.points.slice();if(!(i.length<6)){var n=e.indices;e.points=i,e.alpha=t.fillAlpha,e.color=PIXI.hex2rgb(t.fillColor);for(var r,o=1/0,s=-1/0,a=1/0,h=-1/0,l=0;l<i.length;l+=2)o=(r=i[l])<o?r:o,s=s<r?r:s,a=(r=i[l+1])<a?r:a,h=h<r?r:h;i.push(o,a,s,a,s,h,o,h);for(var p=i.length/2,l=0;l<p;l++)n.push(l)}},PIXI.WebGLGraphics.buildPoly=function(t,e){var i=t.points;if(!(i.length<6)){var n=e.points,r=e.indices,o=i.length/2,e=PIXI.hex2rgb(t.fillColor),s=t.fillAlpha,a=e[0]*s,h=e[1]*s,l=e[2]*s,p=PIXI.EarCut.Triangulate(i,null,2);if(!p)return!1;for(var u=n.length/6,d=0,d=0;d<p.length;d+=3)r.push(p[d]+u),r.push(p[d]+u),r.push(p[d+1]+u),r.push(p[d+2]+u),r.push(p[d+2]+u);for(d=0;d<o;d++)n.push(i[2*d],i[2*d+1],a,h,l,s);return!0}},PIXI.WebGLGraphics.graphicsDataPool=[],PIXI.WebGLGraphicsData=function(t){this.gl=t,this.color=[0,0,0],this.points=[],this.indices=[],this.buffer=t.createBuffer(),this.indexBuffer=t.createBuffer(),this.mode=1,this.alpha=1,this.dirty=!0},PIXI.WebGLGraphicsData.prototype.reset=function(){this.points=[],this.indices=[]},PIXI.WebGLGraphicsData.prototype.upload=function(){var t=this.gl;this.glPoints=new PIXI.Float32Array(this.points),t.bindBuffer(t.ARRAY_BUFFER,this.buffer),t.bufferData(t.ARRAY_BUFFER,this.glPoints,t.STATIC_DRAW),this.glIndicies=new PIXI.Uint16Array(this.indices),t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,this.indexBuffer),t.bufferData(t.ELEMENT_ARRAY_BUFFER,this.glIndicies,t.STATIC_DRAW),this.dirty=!1},PIXI.CanvasGraphics=function(){},PIXI.CanvasGraphics.renderGraphics=function(t,e){var i=t.worldAlpha;t.dirty&&(this.updateGraphicsTint(t),t.dirty=!1);for(var n=0;n<t.graphicsData.length;n++){var r,o,s,a,h,l,p,u,d=t.graphicsData[n],c=d.shape,y=d._fillTint,_=d._lineTint;if(e.lineWidth=d.lineWidth,d.type===PIXI.Graphics.POLY){e.beginPath();var m=c.points;e.moveTo(m[0],m[1]);for(var g=1;g<m.length/2;g++)e.lineTo(m[2*g],m[2*g+1]);c.closed&&e.lineTo(m[0],m[1]),m[0]===m[m.length-2]&&m[1]===m[m.length-1]&&e.closePath(),d.fill&&(e.globalAlpha=d.fillAlpha*i,e.fillStyle="#"+("00000"+(0|y).toString(16)).substr(-6),e.fill()),d.lineWidth&&(e.globalAlpha=d.lineAlpha*i,e.strokeStyle="#"+("00000"+(0|_).toString(16)).substr(-6),e.stroke())}else d.type===PIXI.Graphics.RECT?(!d.fillColor&&0!==d.fillColor||(e.globalAlpha=d.fillAlpha*i,e.fillStyle="#"+("00000"+(0|y).toString(16)).substr(-6),e.fillRect(c.x,c.y,c.width,c.height)),d.lineWidth&&(e.globalAlpha=d.lineAlpha*i,e.strokeStyle="#"+("00000"+(0|_).toString(16)).substr(-6),e.strokeRect(c.x,c.y,c.width,c.height))):d.type===PIXI.Graphics.CIRC?(e.beginPath(),e.arc(c.x,c.y,c.radius,0,2*Math.PI),e.closePath(),d.fill&&(e.globalAlpha=d.fillAlpha*i,e.fillStyle="#"+("00000"+(0|y).toString(16)).substr(-6),e.fill()),d.lineWidth&&(e.globalAlpha=d.lineAlpha*i,e.strokeStyle="#"+("00000"+(0|_).toString(16)).substr(-6),e.stroke())):d.type===PIXI.Graphics.ELIP?(s=2*c.width,u=2*c.height,p=c.x-s/2,r=c.y-u/2,e.beginPath(),a=s/2*.5522848,l=u/2*.5522848,o=p+s,h=r+u,s=p+s/2,e.moveTo(p,u=r+u/2),e.bezierCurveTo(p,u-l,s-a,r,s,r),e.bezierCurveTo(s+a,r,o,u-l,o,u),e.bezierCurveTo(o,u+l,s+a,h,s,h),e.bezierCurveTo(s-a,h,p,u+l,p,u),e.closePath(),d.fill&&(e.globalAlpha=d.fillAlpha*i,e.fillStyle="#"+("00000"+(0|y).toString(16)).substr(-6),e.fill()),d.lineWidth&&(e.globalAlpha=d.lineAlpha*i,e.strokeStyle="#"+("00000"+(0|_).toString(16)).substr(-6),e.stroke())):d.type===PIXI.Graphics.RREC&&(a=c.x,h=c.y,l=c.width,p=c.height,u=c.radius,u=(c=Math.min(l,p)/2|0)<u?c:u,e.beginPath(),e.moveTo(a,h+u),e.lineTo(a,h+p-u),e.quadraticCurveTo(a,h+p,a+u,h+p),e.lineTo(a+l-u,h+p),e.quadraticCurveTo(a+l,h+p,a+l,h+p-u),e.lineTo(a+l,h+u),e.quadraticCurveTo(a+l,h,a+l-u,h),e.lineTo(a+u,h),e.quadraticCurveTo(a,h,a,h+u),e.closePath(),!d.fillColor&&0!==d.fillColor||(e.globalAlpha=d.fillAlpha*i,e.fillStyle="#"+("00000"+(0|y).toString(16)).substr(-6),e.fill()),d.lineWidth&&(e.globalAlpha=d.lineAlpha*i,e.strokeStyle="#"+("00000"+(0|_).toString(16)).substr(-6),e.stroke()))}},PIXI.CanvasGraphics.renderGraphicsMask=function(t,e){var i=t.graphicsData.length;if(0!==i){e.beginPath();for(var n=0;n<i;n++){var r,o,s,a,h,l,p,u,d=t.graphicsData[n],c=d.shape;if(d.type===PIXI.Graphics.POLY){var y=c.points;e.moveTo(y[0],y[1]);for(var _=1;_<y.length/2;_++)e.lineTo(y[2*_],y[2*_+1]);y[0]===y[y.length-2]&&y[1]===y[y.length-1]&&e.closePath()}else d.type===PIXI.Graphics.RECT?(e.rect(c.x,c.y,c.width,c.height),e.closePath()):d.type===PIXI.Graphics.CIRC?(e.arc(c.x,c.y,c.radius,0,2*Math.PI),e.closePath()):d.type===PIXI.Graphics.ELIP?(o=(a=2*c.width)/2*.5522848,l=(u=2*c.height)/2*.5522848,s=(p=c.x-a/2)+a,h=(r=c.y-u/2)+u,a=p+a/2,e.moveTo(p,u=r+u/2),e.bezierCurveTo(p,u-l,a-o,r,a,r),e.bezierCurveTo(a+o,r,s,u-l,s,u),e.bezierCurveTo(s,u+l,a+o,h,a,h),e.bezierCurveTo(a-o,h,p,u+l,p,u),e.closePath()):d.type===PIXI.Graphics.RREC&&(h=c.x,l=c.y,p=c.width,u=c.height,d=c.radius,c=Math.min(p,u)/2|0,e.moveTo(h,l+(d=c<d?c:d)),e.lineTo(h,l+u-d),e.quadraticCurveTo(h,l+u,h+d,l+u),e.lineTo(h+p-d,l+u),e.quadraticCurveTo(h+p,l+u,h+p,l+u-d),e.lineTo(h+p,l+d),e.quadraticCurveTo(h+p,l,h+p-d,l),e.lineTo(h+d,l),e.quadraticCurveTo(h,l,h,l+d),e.closePath())}}},PIXI.CanvasGraphics.updateGraphicsTint=function(t){if(16777215!==t.tint)for(var e=(t.tint>>16&255)/255,i=(t.tint>>8&255)/255,n=(255&t.tint)/255,r=0;r<t.graphicsData.length;r++){var o=t.graphicsData[r],s=0|o.fillColor,a=0|o.lineColor;o._fillTint=((s>>16&255)/255*e*255<<16)+((s>>8&255)/255*i*255<<8)+(255&s)/255*n*255,o._lineTint=((a>>16&255)/255*e*255<<16)+((a>>8&255)/255*i*255<<8)+(255&a)/255*n*255}},U.Graphics=function(t,e,i){void 0===e&&(e=0),void 0===i&&(i=0),this.type=U.GRAPHICS,this.physicsType=U.SPRITE,this.anchor=new U.Point,PIXI.Graphics.call(this),U.Component.Core.init.call(this,t,e,i,"",null)},U.Graphics.prototype=Object.create(PIXI.Graphics.prototype),U.Graphics.prototype.constructor=U.Graphics,U.Component.Core.install.call(U.Graphics.prototype,["Angle","AutoCull","Bounds","Destroy","FixedToCamera","InputEnabled","InWorld","LifeSpan","PhysicsBody","Reset"]),U.Graphics.prototype.preUpdatePhysics=U.Component.PhysicsBody.preUpdate,U.Graphics.prototype.preUpdateLifeSpan=U.Component.LifeSpan.preUpdate,U.Graphics.prototype.preUpdateInWorld=U.Component.InWorld.preUpdate,U.Graphics.prototype.preUpdateCore=U.Component.Core.preUpdate,U.Graphics.prototype.preUpdate=function(){return!!(this.preUpdatePhysics()&&this.preUpdateLifeSpan()&&this.preUpdateInWorld())&&this.preUpdateCore()},U.Graphics.prototype.postUpdate=function(){U.Component.PhysicsBody.postUpdate.call(this),U.Component.FixedToCamera.postUpdate.call(this),this._boundsDirty&&(this.updateLocalBounds(),this._boundsDirty=!1);for(var t=0;t<this.children.length;t++)this.children[t].postUpdate()},U.Graphics.prototype.destroy=function(t){this.clear(),U.Component.Destroy.prototype.destroy.call(this,t)},U.Graphics.prototype.drawTriangle=function(t,e){void 0===e&&(e=!1);var i,n=new U.Polygon(t);e?(i=new U.Point(this.game.camera.x-t[0].x,this.game.camera.y-t[0].y),e=new U.Point(t[1].x-t[0].x,t[1].y-t[0].y),e=new U.Point(t[1].x-t[2].x,t[1].y-t[2].y).cross(e),0<i.dot(e)&&this.drawPolygon(n)):this.drawPolygon(n)},U.Graphics.prototype.drawTriangles=function(t,e,i){void 0===i&&(i=!1);var n,r=new U.Point,o=new U.Point,s=new U.Point,a=[];if(e)if(t[0]instanceof U.Point)for(n=0;n<e.length/3;n++)a.push(t[e[3*n]]),a.push(t[e[3*n+1]]),a.push(t[e[3*n+2]]),3===a.length&&(this.drawTriangle(a,i),a=[]);else for(n=0;n<e.length;n++)r.x=t[2*e[n]],r.y=t[2*e[n]+1],a.push(r.copyTo({})),3===a.length&&(this.drawTriangle(a,i),a=[]);else if(t[0]instanceof U.Point)for(n=0;n<t.length/3;n++)this.drawTriangle([t[3*n],t[3*n+1],t[3*n+2]],i);else for(n=0;n<t.length/6;n++)r.x=t[6*n+0],r.y=t[6*n+1],o.x=t[6*n+2],o.y=t[6*n+3],s.x=t[6*n+4],s.y=t[6*n+5],this.drawTriangle([r,o,s],i)},U.RenderTexture=function(t,e,i,n,r,o){void 0===n&&(n=""),void 0===r&&(r=U.scaleModes.DEFAULT),void 0===o&&(o=1),this.game=t,this.key=n,this.type=U.RENDERTEXTURE,this._tempMatrix=new PIXI.Matrix,PIXI.RenderTexture.call(this,e,i,this.game.renderer,r,o),this.render=U.RenderTexture.prototype.render},U.RenderTexture.prototype=Object.create(PIXI.RenderTexture.prototype),U.RenderTexture.prototype.constructor=U.RenderTexture,U.RenderTexture.prototype.renderXY=function(t,e,i,n){t.updateTransform(),this._tempMatrix.copyFrom(t.worldTransform),this._tempMatrix.tx=e,this._tempMatrix.ty=i,this.renderer.type===PIXI.WEBGL_RENDERER?this.renderWebGL(t,this._tempMatrix,n):this.renderCanvas(t,this._tempMatrix,n)},U.RenderTexture.prototype.renderRawXY=function(t,e,i,n){this._tempMatrix.identity().translate(e,i),this.renderer.type===PIXI.WEBGL_RENDERER?this.renderWebGL(t,this._tempMatrix,n):this.renderCanvas(t,this._tempMatrix,n)},U.RenderTexture.prototype.render=function(t,e,i){null==e?this._tempMatrix.copyFrom(t.worldTransform):this._tempMatrix.copyFrom(e),this.renderer.type===PIXI.WEBGL_RENDERER?this.renderWebGL(t,this._tempMatrix,i):this.renderCanvas(t,this._tempMatrix,i)},U.Text=function(t,e,i,n,r){e=e||0,i=i||0,n=null==n?"":n.toString(),r=U.Utils.extend({},r),this.type=U.TEXT,this.physicsType=U.SPRITE,this.padding=new U.Point,this.textBounds=null,this.canvas=PIXI.CanvasPool.create(this),this.context=this.canvas.getContext("2d"),this.colors=[],this.strokeColors=[],this.fontStyles=[],this.fontWeights=[],this.autoRound=!1,this.useAdvancedWrap=!1,this._res=t.renderer.resolution,this._text=n,this._fontComponents=null,this._lineSpacing=0,this._charCount=0,this._width=0,this._height=0,U.Sprite.call(this,t,e,i,PIXI.Texture.fromCanvas(this.canvas)),this.setStyle(r),""!==n&&this.updateText()},U.Text.prototype=Object.create(U.Sprite.prototype),U.Text.prototype.constructor=U.Text,U.Text.prototype.preUpdate=function(){return!!(this.preUpdatePhysics()&&this.preUpdateLifeSpan()&&this.preUpdateInWorld())&&this.preUpdateCore()},U.Text.prototype.update=function(){},U.Text.prototype.destroy=function(t){this.texture.destroy(!0),U.Component.Destroy.prototype.destroy.call(this,t)},U.Text.prototype.setShadow=function(t,e,i,n,r,o){return void 0===e&&(e=0),void 0===i&&(i="rgba(0, 0, 0, 1)"),void 0===n&&(n=0),void 0===r&&(r=!0),void 0===o&&(o=!0),this.style.shadowOffsetX=t=void 0===t?0:t,this.style.shadowOffsetY=e,this.style.shadowColor=i,this.style.shadowBlur=n,this.style.shadowStroke=r,this.style.shadowFill=o,this.dirty=!0,this},U.Text.prototype.setStyle=function(t,e){void 0===e&&(e=!1),(t=t||{}).font=t.font||"bold 20pt Arial",t.backgroundColor=t.backgroundColor||null,t.fill=t.fill||"black",t.align=t.align||"left",t.boundsAlignH=t.boundsAlignH||"left",t.boundsAlignV=t.boundsAlignV||"top",t.stroke=t.stroke||"black",t.strokeThickness=t.strokeThickness||0,t.wordWrap=t.wordWrap||!1,t.wordWrapWidth=t.wordWrapWidth||100,t.maxLines=t.maxLines||0,t.shadowOffsetX=t.shadowOffsetX||0,t.shadowOffsetY=t.shadowOffsetY||0,t.shadowColor=t.shadowColor||"rgba(0,0,0,0)",t.shadowBlur=t.shadowBlur||0,t.tabs=t.tabs||0;var i=this.fontToComponents(t.font);return t.fontStyle&&(i.fontStyle=t.fontStyle),t.fontVariant&&(i.fontVariant=t.fontVariant),t.fontWeight&&(i.fontWeight=t.fontWeight),t.fontSize&&("number"==typeof t.fontSize&&(t.fontSize=t.fontSize+"px"),i.fontSize=t.fontSize),this._fontComponents=i,t.font=this.componentsToFont(this._fontComponents),this.style=t,this.dirty=!0,e&&this.updateText(),this},U.Text.prototype.updateText=function(){this.texture.baseTexture.resolution=this._res,this.context.font=this.style.font;var t=this.text,e=(t=this.style.wordWrap?this.runWordWrap(this.text):t).split(/(?:\r\n|\r|\n)/),i=this.style.tabs,n=[],r=0,o=this.determineFontProperties(this.style.font),s=e.length;0<this.style.maxLines&&this.style.maxLines<e.length&&(s=this.style.maxLines);for(var a=this._charCount=0;a<s;a++){if(0===i){var h=this.style.strokeThickness+this.padding.x;0<this.colors.length||0<this.strokeColors.length||0<this.fontWeights.length||0<this.fontStyles.length?h+=this.measureLine(e[a]):h+=this.context.measureText(e[a]).width,this.style.wordWrap&&(h-=this.context.measureText(" ").width)}else{var l=e[a].split(/(?:\t)/),h=this.padding.x+this.style.strokeThickness;if(Array.isArray(i))for(var p=0,u=0;u<l.length;u++){var d=0<this.colors.length||0<this.strokeColors.length||0<this.fontWeights.length||0<this.fontStyles.length?this.measureLine(l[u]):Math.ceil(this.context.measureText(l[u]).width);0<u&&(p+=i[u-1]),h=p+d}else for(u=0;u<l.length;u++)0<this.colors.length||0<this.strokeColors.length||0<this.fontWeights.length||0<this.fontStyles.length?h+=this.measureLine(l[u]):h+=Math.ceil(this.context.measureText(l[u]).width),h+=this.game.math.snapToCeil(h,i)-h}n[a]=Math.ceil(h),r=Math.max(r,n[a])}this.canvas.width=r*this._res;var c,y,_=o.fontSize+this.style.strokeThickness+this.padding.y,t=_*s,m=this._lineSpacing;for(0!==(m=m<0&&Math.abs(m)>_?-_:m)&&(t+=0<m?m*e.length:m*(e.length-1)),this.canvas.height=t*this._res,this.context.scale(this._res,this._res),navigator.isCocoonJS&&this.context.clearRect(0,0,this.canvas.width,this.canvas.height),this.style.backgroundColor&&(this.context.fillStyle=this.style.backgroundColor,this.context.fillRect(0,0,this.canvas.width,this.canvas.height)),this.context.fillStyle=this.style.fill,this.context.font=this.style.font,this.context.strokeStyle=this.style.stroke,this.context.textBaseline="alphabetic",this.context.lineWidth=this.style.strokeThickness,this.context.lineCap="round",this.context.lineJoin="round",a=this._charCount=0;a<s;a++)c=this.style.strokeThickness/2,y=this.style.strokeThickness/2+a*_+o.ascent,0<a&&(y+=m*a),"right"===this.style.align?c+=r-n[a]:"center"===this.style.align&&(c+=(r-n[a])/2),this.autoRound&&(c=Math.round(c),y=Math.round(y)),0<this.colors.length||0<this.strokeColors.length||0<this.fontWeights.length||0<this.fontStyles.length?this.updateLine(e[a],c,y):(this.style.stroke&&this.style.strokeThickness&&(this.updateShadow(this.style.shadowStroke),0===i?this.context.strokeText(e[a],c,y):this.renderTabLine(e[a],c,y,!1)),this.style.fill&&(this.updateShadow(this.style.shadowFill),0===i?this.context.fillText(e[a],c,y):this.renderTabLine(e[a],c,y,!0)));this.updateTexture(),this.dirty=!1},U.Text.prototype.renderTabLine=function(t,e,i,n){var r=t.split(/(?:\t)/),o=this.style.tabs,s=0;if(Array.isArray(o))for(var a=0,h=0;h<r.length;h++)0<h&&(a+=o[h-1]),s=e+a,n?this.context.fillText(r[h],s,i):this.context.strokeText(r[h],s,i);else for(h=0;h<r.length;h++){var l=Math.ceil(this.context.measureText(r[h]).width),s=this.game.math.snapToCeil(e,o);n?this.context.fillText(r[h],s,i):this.context.strokeText(r[h],s,i),e=s+l}},U.Text.prototype.updateShadow=function(t){t?(this.context.shadowOffsetX=this.style.shadowOffsetX,this.context.shadowOffsetY=this.style.shadowOffsetY,this.context.shadowColor=this.style.shadowColor,this.context.shadowBlur=this.style.shadowBlur):(this.context.shadowOffsetX=0,this.context.shadowOffsetY=0,this.context.shadowColor=0,this.context.shadowBlur=0)},U.Text.prototype.measureLine=function(t){for(var e=0,i=0;i<t.length;i++){var n,r=t[i];(0<this.fontWeights.length||0<this.fontStyles.length)&&(n=this.fontToComponents(this.context.font),this.fontStyles[this._charCount]&&(n.fontStyle=this.fontStyles[this._charCount]),this.fontWeights[this._charCount]&&(n.fontWeight=this.fontWeights[this._charCount]),this.context.font=this.componentsToFont(n)),this.style.stroke&&this.style.strokeThickness&&(this.strokeColors[this._charCount]&&(this.context.strokeStyle=this.strokeColors[this._charCount]),this.updateShadow(this.style.shadowStroke)),this.style.fill&&(this.colors[this._charCount]&&(this.context.fillStyle=this.colors[this._charCount]),this.updateShadow(this.style.shadowFill)),e+=this.context.measureText(r).width,this._charCount++}return Math.ceil(e)},U.Text.prototype.updateLine=function(t,e,i){for(var n=0;n<t.length;n++){var r,o=t[n];(0<this.fontWeights.length||0<this.fontStyles.length)&&(r=this.fontToComponents(this.context.font),this.fontStyles[this._charCount]&&(r.fontStyle=this.fontStyles[this._charCount]),this.fontWeights[this._charCount]&&(r.fontWeight=this.fontWeights[this._charCount]),this.context.font=this.componentsToFont(r)),this.style.stroke&&this.style.strokeThickness&&(this.strokeColors[this._charCount]&&(this.context.strokeStyle=this.strokeColors[this._charCount]),this.updateShadow(this.style.shadowStroke),this.context.strokeText(o,e,i)),this.style.fill&&(this.colors[this._charCount]&&(this.context.fillStyle=this.colors[this._charCount]),this.updateShadow(this.style.shadowFill),this.context.fillText(o,e,i)),e+=this.context.measureText(o).width,this._charCount++}},U.Text.prototype.clearColors=function(){return this.colors=[],this.strokeColors=[],this.dirty=!0,this},U.Text.prototype.clearFontValues=function(){return this.fontStyles=[],this.fontWeights=[],this.dirty=!0,this},U.Text.prototype.addColor=function(t,e){return this.colors[e]=t,this.dirty=!0,this},U.Text.prototype.addStrokeColor=function(t,e){return this.strokeColors[e]=t,this.dirty=!0,this},U.Text.prototype.addFontStyle=function(t,e){return this.fontStyles[e]=t,this.dirty=!0,this},U.Text.prototype.addFontWeight=function(t,e){return this.fontWeights[e]=t,this.dirty=!0,this},U.Text.prototype.precalculateWordWrap=function(t){return this.texture.baseTexture.resolution=this._res,this.context.font=this.style.font,this.runWordWrap(t).split(/(?:\r\n|\r|\n)/)},U.Text.prototype.runWordWrap=function(t){return this.useAdvancedWrap?this.advancedWordWrap(t):this.basicWordWrap(t)},U.Text.prototype.advancedWordWrap=function(t){for(var e=this.context,i=this.style.wordWrapWidth,n="",r=t.replace(/ +/gi," ").split(/\r?\n/gi),o=r.length,s=0;s<o;s++){var a="",h=(h=r[s]).replace(/^ *|\s*$/gi,"");if(e.measureText(h).width<i)n+=h+"\n";else{for(var l=i,p=h.split(" "),u=0;u<p.length;u++){var d=p[u],c=d+" ",y=e.measureText(c).width;if(l<y){if(0===u){for(var _=c;_.length&&(_=_.slice(0,-1),!((y=e.measureText(_).width)<=l)););if(!_.length)throw new Error("This text's wordWrapWidth setting is less than a single character!");var m=d.substr(_.length);p[u]=m,a+=_}m=p[u].length?u:u+1,m=p.slice(m).join(" ").replace(/[ \n]*$/gi,"");r[s+1]=m+" "+(r[s+1]||""),o=r.length;break}a+=c,l-=y}n+=a.replace(/[ \n]*$/gi,"")+"\n"}}return n.replace(/[\s|\n]*$/gi,"")},U.Text.prototype.basicWordWrap=function(t){for(var e="",i=t.split("\n"),n=0;n<i.length;n++){for(var r=this.style.wordWrapWidth,o=i[n].split(" "),s=0;s<o.length;s++){var a=this.context.measureText(o[s]).width,h=a+this.context.measureText(" ").width;r<h?(0<s&&(e+="\n"),e+=o[s]+" ",r=this.style.wordWrapWidth-a):(r-=h,e+=o[s]+" ")}n<i.length-1&&(e+="\n")}return e},U.Text.prototype.updateFont=function(t){t=this.componentsToFont(t);this.style.font!==t&&(this.style.font=t,this.dirty=!0,this.parent&&this.updateTransform())},U.Text.prototype.fontToComponents=function(t){var e=t.match(/^\s*(?:\b(normal|italic|oblique|inherit)?\b)\s*(?:\b(normal|small-caps|inherit)?\b)\s*(?:\b(normal|bold|bolder|lighter|100|200|300|400|500|600|700|800|900|inherit)?\b)\s*(?:\b(xx-small|x-small|small|medium|large|x-large|xx-large|larger|smaller|0|\d*(?:[.]\d*)?(?:%|[a-z]{2,5}))?\b)\s*(.*)\s*$/);if(e){var i=e[5].trim();return/^(?:inherit|serif|sans-serif|cursive|fantasy|monospace)$/.exec(i)||/['",]/.exec(i)||(i="'"+i+"'"),{font:t,fontStyle:e[1]||"normal",fontVariant:e[2]||"normal",fontWeight:e[3]||"normal",fontSize:e[4]||"medium",fontFamily:i}}return{font:t}},U.Text.prototype.componentsToFont=function(t){var e=[],i=t.fontStyle;return i&&"normal"!==i&&e.push(i),(i=t.fontVariant)&&"normal"!==i&&e.push(i),(i=t.fontWeight)&&"normal"!==i&&e.push(i),(i=t.fontSize)&&"medium"!==i&&e.push(i),(i=t.fontFamily)&&e.push(i),e.length||e.push(t.font),e.join(" ")},U.Text.prototype.setText=function(t,e){return void 0===e&&(e=!1),this.text=t.toString()||"",e?this.updateText():this.dirty=!0,this},U.Text.prototype.parseList=function(t){if(!Array.isArray(t))return this;for(var e="",i=0;i<t.length;i++)Array.isArray(t[i])?(e+=t[i].join("\t"),i<t.length-1&&(e+="\n")):(e+=t[i],i<t.length-1&&(e+="\t"));return this.text=e,this.dirty=!0,this},U.Text.prototype.setTextBounds=function(t,e,i,n){return void 0===t?this.textBounds=null:(this.textBounds?this.textBounds.setTo(t,e,i,n):this.textBounds=new U.Rectangle(t,e,i,n),this.style.wordWrapWidth>i&&(this.style.wordWrapWidth=i)),this.updateTexture(),this},U.Text.prototype.updateTexture=function(){var t=this.texture.baseTexture,e=this.texture.crop,i=this.texture.frame,n=this.canvas.width,r=this.canvas.height;t.width=n,t.height=r,e.width=n,e.height=r,i.width=n,i.height=r,this.texture.width=n,this.texture.height=r,this._width=n,this._height=r,this.textBounds&&(e=this.textBounds.x,i=this.textBounds.y,"right"===this.style.boundsAlignH?e+=this.textBounds.width-this.canvas.width/this.resolution:"center"===this.style.boundsAlignH&&(e+=this.textBounds.halfWidth-this.canvas.width/this.resolution/2),"bottom"===this.style.boundsAlignV?i+=this.textBounds.height-this.canvas.height/this.resolution:"middle"===this.style.boundsAlignV&&(i+=this.textBounds.halfHeight-this.canvas.height/this.resolution/2),this.pivot.x=-e,this.pivot.y=-i),this.renderable=0!==n&&0!==r,this.texture.requiresReTint=!0,this.texture.baseTexture.dirty()},U.Text.prototype._renderWebGL=function(t){this.dirty&&(this.updateText(),this.dirty=!1),PIXI.Sprite.prototype._renderWebGL.call(this,t)},U.Text.prototype._renderCanvas=function(t){this.dirty&&(this.updateText(),this.dirty=!1),PIXI.Sprite.prototype._renderCanvas.call(this,t)},U.Text.prototype.determineFontProperties=function(t){if(!(e=U.Text.fontPropertiesCache[t])){var e={},i=U.Text.fontPropertiesCanvas,n=U.Text.fontPropertiesContext;n.font=t;var r=Math.ceil(n.measureText("|Mq").width),o=2*(s=Math.ceil(n.measureText("|Mq").width)),s=1.4*s|0;if(i.width=r,i.height=o,n.fillStyle="#f00",n.fillRect(0,0,r,o),n.font=t,n.textBaseline="alphabetic",n.fillStyle="#000",n.fillText("|Mq",0,s),!n.getImageData(0,0,r,o))return e.ascent=s,e.descent=6+s,e.fontSize=e.ascent+e.descent,U.Text.fontPropertiesCache[t]=e;for(var a,h=n.getImageData(0,0,r,o).data,n=h.length,l=4*r,p=0,u=!1,d=0;d<s;d++){for(a=0;a<l;a+=4)if(255!==h[p+a]){u=!0;break}if(u)break;p+=l}for(e.ascent=s-d,p=n-l,u=!1,d=o;s<d;d--){for(a=0;a<l;a+=4)if(255!==h[p+a]){u=!0;break}if(u)break;p-=l}e.descent=d-s,e.descent+=6,e.fontSize=e.ascent+e.descent,U.Text.fontPropertiesCache[t]=e}return e},U.Text.prototype.getBounds=function(t){return this.dirty&&(this.updateText(),this.dirty=!1),PIXI.Sprite.prototype.getBounds.call(this,t)},Object.defineProperty(U.Text.prototype,"text",{get:function(){return this._text},set:function(t){t!==this._text&&(this._text=t.toString()||"",this.dirty=!0,this.parent&&this.updateTransform())}}),Object.defineProperty(U.Text.prototype,"cssFont",{get:function(){return this.componentsToFont(this._fontComponents)},set:function(t){this._fontComponents=this.fontToComponents(t=t||"bold 20pt Arial"),this.updateFont(this._fontComponents)}}),Object.defineProperty(U.Text.prototype,"font",{get:function(){return this._fontComponents.fontFamily},set:function(t){t=(t=t||"Arial").trim(),/^(?:inherit|serif|sans-serif|cursive|fantasy|monospace)$/.exec(t)||/['",]/.exec(t)||(t="'"+t+"'"),this._fontComponents.fontFamily=t,this.updateFont(this._fontComponents)}}),Object.defineProperty(U.Text.prototype,"fontSize",{get:function(){var t=this._fontComponents.fontSize;return t&&/(?:^0$|px$)/.exec(t)?parseInt(t,10):t},set:function(t){"number"==typeof(t=t||"0")&&(t+="px"),this._fontComponents.fontSize=t,this.updateFont(this._fontComponents)}}),Object.defineProperty(U.Text.prototype,"fontWeight",{get:function(){return this._fontComponents.fontWeight||"normal"},set:function(t){this._fontComponents.fontWeight=t=t||"normal",this.updateFont(this._fontComponents)}}),Object.defineProperty(U.Text.prototype,"fontStyle",{get:function(){return this._fontComponents.fontStyle||"normal"},set:function(t){this._fontComponents.fontStyle=t=t||"normal",this.updateFont(this._fontComponents)}}),Object.defineProperty(U.Text.prototype,"fontVariant",{get:function(){return this._fontComponents.fontVariant||"normal"},set:function(t){this._fontComponents.fontVariant=t=t||"normal",this.updateFont(this._fontComponents)}}),Object.defineProperty(U.Text.prototype,"fill",{get:function(){return this.style.fill},set:function(t){t!==this.style.fill&&(this.style.fill=t,this.dirty=!0)}}),Object.defineProperty(U.Text.prototype,"align",{get:function(){return this.style.align},set:function(t){t!==this.style.align&&(this.style.align=t,this.dirty=!0)}}),Object.defineProperty(U.Text.prototype,"resolution",{get:function(){return this._res},set:function(t){t!==this._res&&(this._res=t,this.dirty=!0)}}),Object.defineProperty(U.Text.prototype,"tabs",{get:function(){return this.style.tabs},set:function(t){t!==this.style.tabs&&(this.style.tabs=t,this.dirty=!0)}}),Object.defineProperty(U.Text.prototype,"boundsAlignH",{get:function(){return this.style.boundsAlignH},set:function(t){t!==this.style.boundsAlignH&&(this.style.boundsAlignH=t,this.dirty=!0)}}),Object.defineProperty(U.Text.prototype,"boundsAlignV",{get:function(){return this.style.boundsAlignV},set:function(t){t!==this.style.boundsAlignV&&(this.style.boundsAlignV=t,this.dirty=!0)}}),Object.defineProperty(U.Text.prototype,"stroke",{get:function(){return this.style.stroke},set:function(t){t!==this.style.stroke&&(this.style.stroke=t,this.dirty=!0)}}),Object.defineProperty(U.Text.prototype,"strokeThickness",{get:function(){return this.style.strokeThickness},set:function(t){t!==this.style.strokeThickness&&(this.style.strokeThickness=t,this.dirty=!0)}}),Object.defineProperty(U.Text.prototype,"wordWrap",{get:function(){return this.style.wordWrap},set:function(t){t!==this.style.wordWrap&&(this.style.wordWrap=t,this.dirty=!0)}}),Object.defineProperty(U.Text.prototype,"wordWrapWidth",{get:function(){return this.style.wordWrapWidth},set:function(t){t!==this.style.wordWrapWidth&&(this.style.wordWrapWidth=t,this.dirty=!0)}}),Object.defineProperty(U.Text.prototype,"lineSpacing",{get:function(){return this._lineSpacing},set:function(t){t!==this._lineSpacing&&(this._lineSpacing=parseFloat(t),this.dirty=!0,this.parent&&this.updateTransform())}}),Object.defineProperty(U.Text.prototype,"shadowOffsetX",{get:function(){return this.style.shadowOffsetX},set:function(t){t!==this.style.shadowOffsetX&&(this.style.shadowOffsetX=t,this.dirty=!0)}}),Object.defineProperty(U.Text.prototype,"shadowOffsetY",{get:function(){return this.style.shadowOffsetY},set:function(t){t!==this.style.shadowOffsetY&&(this.style.shadowOffsetY=t,this.dirty=!0)}}),Object.defineProperty(U.Text.prototype,"shadowColor",{get:function(){return this.style.shadowColor},set:function(t){t!==this.style.shadowColor&&(this.style.shadowColor=t,this.dirty=!0)}}),Object.defineProperty(U.Text.prototype,"shadowBlur",{get:function(){return this.style.shadowBlur},set:function(t){t!==this.style.shadowBlur&&(this.style.shadowBlur=t,this.dirty=!0)}}),Object.defineProperty(U.Text.prototype,"shadowStroke",{get:function(){return this.style.shadowStroke},set:function(t){t!==this.style.shadowStroke&&(this.style.shadowStroke=t,this.dirty=!0)}}),Object.defineProperty(U.Text.prototype,"shadowFill",{get:function(){return this.style.shadowFill},set:function(t){t!==this.style.shadowFill&&(this.style.shadowFill=t,this.dirty=!0)}}),Object.defineProperty(U.Text.prototype,"width",{get:function(){return this.dirty&&(this.updateText(),this.dirty=!1),this.scale.x*this.texture.frame.width},set:function(t){this.scale.x=t/this.texture.frame.width,this._width=t}}),Object.defineProperty(U.Text.prototype,"height",{get:function(){return this.dirty&&(this.updateText(),this.dirty=!1),this.scale.y*this.texture.frame.height},set:function(t){this.scale.y=t/this.texture.frame.height,this._height=t}}),U.Text.fontPropertiesCache={},U.Text.fontPropertiesCanvas=document.createElement("canvas"),U.Text.fontPropertiesContext=U.Text.fontPropertiesCanvas.getContext("2d"),U.BitmapText=function(t,e,i,n,r,o,s){e=e||0,i=i||0,n=n||"",r=r||"",o=o||32,s=s||"left",PIXI.DisplayObjectContainer.call(this),this.type=U.BITMAPTEXT,this.physicsType=U.SPRITE,this.textWidth=0,this.textHeight=0,this.anchor=new U.Point,this._prevAnchor=new U.Point,this._glyphs=[],this._maxWidth=0,this._text=r.toString()||"",this._data=t.cache.getBitmapFont(n),this._font=n,this._fontSize=o,this._align=s,this._tint=16777215,this.updateText(),this.dirty=!1,U.Component.Core.init.call(this,t,e,i,"",null)},U.BitmapText.prototype=Object.create(PIXI.DisplayObjectContainer.prototype),U.BitmapText.prototype.constructor=U.BitmapText,U.Component.Core.install.call(U.BitmapText.prototype,["Angle","AutoCull","Bounds","Destroy","FixedToCamera","InputEnabled","InWorld","LifeSpan","PhysicsBody","Reset"]),U.BitmapText.prototype.preUpdatePhysics=U.Component.PhysicsBody.preUpdate,U.BitmapText.prototype.preUpdateLifeSpan=U.Component.LifeSpan.preUpdate,U.BitmapText.prototype.preUpdateInWorld=U.Component.InWorld.preUpdate,U.BitmapText.prototype.preUpdateCore=U.Component.Core.preUpdate,U.BitmapText.prototype.preUpdate=function(){return!!(this.preUpdatePhysics()&&this.preUpdateLifeSpan()&&this.preUpdateInWorld())&&this.preUpdateCore()},U.BitmapText.prototype.postUpdate=function(){U.Component.PhysicsBody.postUpdate.call(this),U.Component.FixedToCamera.postUpdate.call(this),this.body&&this.body.type===U.Physics.ARCADE&&(this.textWidth===this.body.sourceWidth&&this.textHeight===this.body.sourceHeight||this.body.setSize(this.textWidth,this.textHeight))},U.BitmapText.prototype.setText=function(t){this.text=t},U.BitmapText.prototype.scanLine=function(t,e,i){for(var n=0,r=0,o=-1,s=0,a=null,h=0<this._maxWidth?this._maxWidth:null,l=[],p=0;p<i.length;p++){var u=p===i.length-1;if(/(?:\r\n|\r|\n)/.test(i.charAt(p)))return{width:r,text:i.substr(0,p),end:u,chars:l};var d,c=i.charCodeAt(p),y=t.chars[c];void 0===y&&(y=t.chars[c=32]);var _=a&&y.kerning[a]?y.kerning[a]:0;if(/(\s)/.test(i.charAt(p))&&(o=p,s=r),d=(_+y.texture.width+y.xOffset)*e,h&&h<=r+d&&-1<o)return{width:s||r,text:i.substr(0,p-(p-o)),end:u,chars:l};r+=(y.xAdvance+_)*e,l.push(n+(y.xOffset+_)*e),n+=(y.xAdvance+_)*e,a=c}return{width:r,text:i,end:u,chars:l}},U.BitmapText.prototype.cleanText=function(t,e){void 0===e&&(e="");var i=this._data.font;if(!i)return"";for(var n=t.replace(/\r\n|\n\r|\n|\r/g,"\n").split("\n"),r=0;r<n.length;r++){for(var o="",s=n[r],a=0;a<s.length;a++)o=i.chars[s.charCodeAt(a)]?o.concat(s[a]):o.concat(e);n[r]=o}return n.join("\n")},U.BitmapText.prototype.updateText=function(){var t=this._data.font;if(t){var e=this.text,i=this._fontSize/t.size,n=[],r=0;this.textWidth=0;do{}while((p=this.scanLine(t,i,e)).y=r,n.push(p),p.width>this.textWidth&&(this.textWidth=p.width),r+=t.lineHeight*i,e=e.substr(p.text.length+1),!1===p.end);this.textHeight=r;for(var o=0,s=0,a=this.textWidth*this.anchor.x,h=this.textHeight*this.anchor.y,l=0;l<n.length;l++){var p=n[l];"right"===this._align?s=this.textWidth-p.width:"center"===this._align&&(s=(this.textWidth-p.width)/2);for(var u=0;u<p.text.length;u++){var d=p.text.charCodeAt(u),c=t.chars[d];void 0===c&&(c=t.chars[32]);d=this._glyphs[o];d?d.texture=c.texture:((d=new PIXI.Sprite(c.texture)).name=p.text[u],this._glyphs.push(d)),d.position.x=p.chars[u]+s-a,d.position.y=p.y+c.yOffset*i-h,d.scale.set(i),d.tint=this.tint,d.texture.requiresReTint=!0,d.parent||this.addChild(d),o++}}for(l=o;l<this._glyphs.length;l++)this.removeChild(this._glyphs[l])}},U.BitmapText.prototype.purgeGlyphs=function(){for(var t=this._glyphs.length,e=[],i=0;i<this._glyphs.length;i++)this._glyphs[i].parent!==this?this._glyphs[i].destroy():e.push(this._glyphs[i]);return this._glyphs=[],this._glyphs=e,this.updateText(),t-e.length},U.BitmapText.prototype.updateTransform=function(){!this.dirty&&this.anchor.equals(this._prevAnchor)||(this.updateText(),this.dirty=!1,this._prevAnchor.copyFrom(this.anchor)),PIXI.DisplayObjectContainer.prototype.updateTransform.call(this)},Object.defineProperty(U.BitmapText.prototype,"align",{get:function(){return this._align},set:function(t){t===this._align||"left"!==t&&"center"!==t&&"right"!==t||(this._align=t,this.updateText())}}),Object.defineProperty(U.BitmapText.prototype,"tint",{get:function(){return this._tint},set:function(t){t!==this._tint&&(this._tint=t,this.updateText())}}),Object.defineProperty(U.BitmapText.prototype,"font",{get:function(){return this._font},set:function(t){t!==this._font&&(this._font=t.trim(),this._data=this.game.cache.getBitmapFont(this._font),this.updateText())}}),Object.defineProperty(U.BitmapText.prototype,"fontSize",{get:function(){return this._fontSize},set:function(t){(t=parseInt(t,10))!==this._fontSize&&0<t&&(this._fontSize=t,this.updateText())}}),Object.defineProperty(U.BitmapText.prototype,"text",{get:function(){return this._text},set:function(t){t!==this._text&&(this._text=t.toString()||"",this.updateText())}}),Object.defineProperty(U.BitmapText.prototype,"maxWidth",{get:function(){return this._maxWidth},set:function(t){t!==this._maxWidth&&(this._maxWidth=t,this.updateText())}}),Object.defineProperty(U.BitmapText.prototype,"smoothed",{get:function(){return!this._data.base.scaleMode},set:function(t){this._data.base.scaleMode=t?0:1}}),U.RetroFont=function(t,e,i,n,r,o,s,a,h,l){if(!t.cache.checkImageKey(e))return!1;null!=o||(o=t.cache.getImage(e).width/i),this.characterWidth=i,this.characterHeight=n,this.characterSpacingX=s||0,this.characterSpacingY=a||0,this.characterPerRow=o,this.offsetX=h||0,this.offsetY=l||0,this.align="left",this.multiLine=!1,this.autoUpperCase=!0,this.customSpacingX=0,this.customSpacingY=0,this.fixedWidth=0,this.fontSet=t.cache.getImage(e),this._text="",this.grabData=[],this.frameData=new U.FrameData;for(var p=this.offsetX,u=this.offsetY,d=0,c=0;c<r.length;c++){var y=this.frameData.addFrame(new U.Frame(c,p,u,this.characterWidth,this.characterHeight));this.grabData[r.charCodeAt(c)]=y.index,++d===this.characterPerRow?(d=0,p=this.offsetX,u+=this.characterHeight+this.characterSpacingY):p+=this.characterWidth+this.characterSpacingX}t.cache.updateFrameData(e,this.frameData),this.stamp=new U.Image(t,0,0,e,0),U.RenderTexture.call(this,t,100,100,"",U.scaleModes.NEAREST),this.type=U.RETROFONT},U.RetroFont.prototype=Object.create(U.RenderTexture.prototype),U.RetroFont.prototype.constructor=U.RetroFont,U.RetroFont.ALIGN_LEFT="left",U.RetroFont.ALIGN_RIGHT="right",U.RetroFont.ALIGN_CENTER="center",U.RetroFont.TEXT_SET1=" !\"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_`abcdefghijklmnopqrstuvwxyz{|}~",U.RetroFont.TEXT_SET2=" !\"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ",U.RetroFont.TEXT_SET3="ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789 ",U.RetroFont.TEXT_SET4="ABCDEFGHIJKLMNOPQRSTUVWXYZ 0123456789",U.RetroFont.TEXT_SET5="ABCDEFGHIJKLMNOPQRSTUVWXYZ.,/() '!?-*:0123456789",U.RetroFont.TEXT_SET6="ABCDEFGHIJKLMNOPQRSTUVWXYZ!?:;0123456789\"(),-.' ",U.RetroFont.TEXT_SET7="AGMSY+:4BHNTZ!;5CIOU.?06DJPV,(17EKQW\")28FLRX-'39",U.RetroFont.TEXT_SET8="0123456789 .ABCDEFGHIJKLMNOPQRSTUVWXYZ",U.RetroFont.TEXT_SET9="ABCDEFGHIJKLMNOPQRSTUVWXYZ()-0123456789.:,'\"?!",U.RetroFont.TEXT_SET10="ABCDEFGHIJKLMNOPQRSTUVWXYZ",U.RetroFont.TEXT_SET11="ABCDEFGHIJKLMNOPQRSTUVWXYZ.,\"-+!?()':;0123456789",U.RetroFont.prototype.setFixedWidth=function(t,e){void 0===e&&(e="left"),this.fixedWidth=t,this.align=e},U.RetroFont.prototype.setText=function(t,e,i,n,r,o){this.multiLine=e||!1,this.customSpacingX=i||0,this.customSpacingY=n||0,this.align=r||"left",this.autoUpperCase=!o,0<t.length&&(this.text=t)},U.RetroFont.prototype.buildRetroFontText=function(){var t=0,e=0;if(this.clear(),this.multiLine){var i=this._text.split("\n");0<this.fixedWidth?this.resize(this.fixedWidth,i.length*(this.characterHeight+this.customSpacingY)-this.customSpacingY,!0):this.resize(this.getLongestLine()*(this.characterWidth+this.customSpacingX),i.length*(this.characterHeight+this.customSpacingY)-this.customSpacingY,!0);for(var n=0;n<i.length;n++)t=0,this.align===U.RetroFont.ALIGN_RIGHT?t=this.width-i[n].length*(this.characterWidth+this.customSpacingX):this.align===U.RetroFont.ALIGN_CENTER&&(t=this.width/2-i[n].length*(this.characterWidth+this.customSpacingX)/2,t+=this.customSpacingX/2),this.pasteLine(i[n],t=t<0?0:t,e,this.customSpacingX),e+=this.characterHeight+this.customSpacingY}else 0<this.fixedWidth?this.resize(this.fixedWidth,this.characterHeight,!0):this.resize(this._text.length*(this.characterWidth+this.customSpacingX),this.characterHeight,!0),t=0,this.align===U.RetroFont.ALIGN_RIGHT?t=this.width-this._text.length*(this.characterWidth+this.customSpacingX):this.align===U.RetroFont.ALIGN_CENTER&&(t=this.width/2-this._text.length*(this.characterWidth+this.customSpacingX)/2,t+=this.customSpacingX/2),this.pasteLine(this._text,t=t<0?0:t,0,this.customSpacingX);this.requiresReTint=!0},U.RetroFont.prototype.pasteLine=function(t,e,i,n){for(var r=0;r<t.length;r++)if(" "===t.charAt(r))e+=this.characterWidth+n;else if(0<=this.grabData[t.charCodeAt(r)]&&(this.stamp.frame=this.grabData[t.charCodeAt(r)],this.renderXY(this.stamp,e,i,!1),(e+=this.characterWidth+n)>this.width))break},U.RetroFont.prototype.getLongestLine=function(){var t=0;if(0<this._text.length)for(var e=this._text.split("\n"),i=0;i<e.length;i++)e[i].length>t&&(t=e[i].length);return t},U.RetroFont.prototype.removeUnsupportedCharacters=function(t){for(var e="",i=0;i<this._text.length;i++){var n=this._text[i],r=n.charCodeAt(0);(0<=this.grabData[r]||!t&&"\n"===n)&&(e=e.concat(n))}return e},U.RetroFont.prototype.updateOffset=function(t,e){if(this.offsetX!==t||this.offsetY!==e){for(var i=t-this.offsetX,n=e-this.offsetY,r=this.game.cache.getFrameData(this.stamp.key).getFrames(),o=r.length;o--;)r[o].x+=i,r[o].y+=n;this.buildRetroFontText()}},Object.defineProperty(U.RetroFont.prototype,"text",{get:function(){return this._text},set:function(t){(t=this.autoUpperCase?t.toUpperCase():t)!==this._text&&(this._text=t,this.removeUnsupportedCharacters(this.multiLine),this.buildRetroFontText())}}),Object.defineProperty(U.RetroFont.prototype,"smoothed",{get:function(){return this.stamp.smoothed},set:function(t){this.stamp.smoothed=t,this.buildRetroFontText()}}),U.Rope=function(t,e,i,n,r,o){this.points=[],this.points=o,this._hasUpdateAnimation=!1,this._updateAnimationCallback=null,e=e||0,i=i||0,n=n||null,r=r||null,this.type=U.ROPE,PIXI.Rope.call(this,U.Cache.DEFAULT,this.points),U.Component.Core.init.call(this,t,e,i,n,r)},U.Rope.prototype=Object.create(PIXI.Rope.prototype),U.Rope.prototype.constructor=U.Rope,U.Component.Core.install.call(U.Rope.prototype,["Angle","Animation","AutoCull","Bounds","BringToTop","Crop","Delta","Destroy","FixedToCamera","InWorld","LifeSpan","LoadTexture","Overlap","PhysicsBody","Reset","ScaleMinMax","Smoothed"]),U.Rope.prototype.preUpdatePhysics=U.Component.PhysicsBody.preUpdate,U.Rope.prototype.preUpdateLifeSpan=U.Component.LifeSpan.preUpdate,U.Rope.prototype.preUpdateInWorld=U.Component.InWorld.preUpdate,U.Rope.prototype.preUpdateCore=U.Component.Core.preUpdate,U.Rope.prototype.preUpdate=function(){return!!(this.preUpdatePhysics()&&this.preUpdateLifeSpan()&&this.preUpdateInWorld())&&this.preUpdateCore()},U.Rope.prototype.update=function(){this._hasUpdateAnimation&&this.updateAnimation.call(this)},U.Rope.prototype.reset=function(t,e){return U.Component.Reset.prototype.reset.call(this,t,e),this},Object.defineProperty(U.Rope.prototype,"updateAnimation",{get:function(){return this._updateAnimation},set:function(t){t&&"function"==typeof t?(this._hasUpdateAnimation=!0,this._updateAnimation=t):(this._hasUpdateAnimation=!1,this._updateAnimation=null)}}),Object.defineProperty(U.Rope.prototype,"segments",{get:function(){for(var t,e,i,n,r=[],o=0;o<this.points.length;o++)t=this.vertices[n=4*o]*this.scale.x,e=this.vertices[1+n]*this.scale.y,i=this.vertices[4+n]*this.scale.x,n=this.vertices[3+n]*this.scale.y,i=U.Math.difference(t,i),n=U.Math.difference(e,n),t+=this.world.x,e+=this.world.y,n=new U.Rectangle(t,e,i,n),r.push(n);return r}}),U.TileSprite=function(t,e,i,n,r,o,s){e=e||0,i=i||0,n=n||256,r=r||256,o=o||null,s=s||null,this.type=U.TILESPRITE,this.physicsType=U.SPRITE,this._scroll=new U.Point;var a=t.cache.getImage("__default",!0);PIXI.TilingSprite.call(this,new PIXI.Texture(a.base),n,r),U.Component.Core.init.call(this,t,e,i,o,s)},U.TileSprite.prototype=Object.create(PIXI.TilingSprite.prototype),U.TileSprite.prototype.constructor=U.TileSprite,U.Component.Core.install.call(U.TileSprite.prototype,["Angle","Animation","AutoCull","Bounds","BringToTop","Destroy","FixedToCamera","Health","InCamera","InputEnabled","InWorld","LifeSpan","LoadTexture","Overlap","PhysicsBody","Reset","Smoothed"]),U.TileSprite.prototype.preUpdatePhysics=U.Component.PhysicsBody.preUpdate,U.TileSprite.prototype.preUpdateLifeSpan=U.Component.LifeSpan.preUpdate,U.TileSprite.prototype.preUpdateInWorld=U.Component.InWorld.preUpdate,U.TileSprite.prototype.preUpdateCore=U.Component.Core.preUpdate,U.TileSprite.prototype.preUpdate=function(){return 0!==this._scroll.x&&(this.tilePosition.x+=this._scroll.x*this.game.time.physicsElapsed),0!==this._scroll.y&&(this.tilePosition.y+=this._scroll.y*this.game.time.physicsElapsed),!!(this.preUpdatePhysics()&&this.preUpdateLifeSpan()&&this.preUpdateInWorld())&&this.preUpdateCore()},U.TileSprite.prototype.autoScroll=function(t,e){this._scroll.set(t,e)},U.TileSprite.prototype.stopScroll=function(){this._scroll.set(0,0)},U.TileSprite.prototype.destroy=function(t){U.Component.Destroy.prototype.destroy.call(this,t),PIXI.TilingSprite.prototype.destroy.call(this)},U.TileSprite.prototype.reset=function(t,e){return U.Component.Reset.prototype.reset.call(this,t,e),this.tilePosition.x=0,this.tilePosition.y=0,this},U.Device=function(){this.deviceReadyAt=0,this.initialized=!1,this.desktop=!1,this.iOS=!1,this.iOSVersion=0,this.cocoonJS=!1,this.cocoonJSApp=!1,this.wechatMinigame=!1,this.cordova=!1,this.node=!1,this.nodeWebkit=!1,this.electron=!1,this.ejecta=!1,this.crosswalk=!1,this.android=!1,this.chromeOS=!1,this.linux=!1,this.macOS=!1,this.windows=!1,this.windowsPhone=!1,this.canvas=!1,this.canvasBitBltShift=null,this.webGL=!1,this.file=!1,this.fileSystem=!1,this.localStorage=!1,this.worker=!1,this.css3D=!1,this.pointerLock=!1,this.typedArray=!1,this.vibration=!1,this.getUserMedia=!0,this.quirksMode=!1,this.touch=!1,this.mspointer=!1,this.wheelEvent=null,this.arora=!1,this.chrome=!1,this.chromeVersion=0,this.epiphany=!1,this.firefox=!1,this.firefoxVersion=0,this.ie=!1,this.ieVersion=0,this.trident=!1,this.tridentVersion=0,this.edge=!1,this.mobileSafari=!1,this.midori=!1,this.opera=!1,this.safari=!1,this.safariVersion=0,this.webApp=!1,this.silk=!1,this.audioData=!1,this.webAudio=!1,this.ogg=!1,this.opus=!1,this.mp3=!1,this.wav=!1,this.m4a=!1,this.webm=!1,this.dolby=!1,this.oggVideo=!1,this.h264Video=!1,this.mp4Video=!1,this.webmVideo=!1,this.vp9Video=!1,this.hlsVideo=!1,this.iPhone=!1,this.iPhone4=!1,this.iPad=!1,this.pixelRatio=0,this.littleEndian=!1,this.LITTLE_ENDIAN=!1,this.support32bit=!1,this.fullscreen=!1,this.requestFullscreen="",this.cancelFullscreen="",this.fullscreenKeyboard=!1},U.Device=new U.Device,U.Device.onInitialized=new U.Signal,U.Device.whenReady=function(t,e,i){var n=this._readyCheck;this.deviceReadyAt||!n?t.call(e,this):n._monitor||i?(n._queue=n._queue||[],n._queue.push([t,e])):(n._monitor=n.bind(this),n._queue=n._queue||[],n._queue.push([t,e]),t=void 0!==window.cordova,e=navigator.isCocoonJS,"complete"===document.readyState||"interactive"===document.readyState?window.setTimeout(n._monitor,0):t&&!e?document.addEventListener("deviceready",n._monitor,!1):(document.addEventListener("DOMContentLoaded",n._monitor,!1),window.addEventListener("load",n._monitor,!1)))},U.Device._readyCheck=function(){var t=this._readyCheck;if(document.body){if(!this.deviceReadyAt){this.deviceReadyAt=Date.now(),document.removeEventListener("deviceready",t._monitor),document.removeEventListener("DOMContentLoaded",t._monitor),window.removeEventListener("load",t._monitor),this._initialize(),this.initialized=!0,this.onInitialized.dispatch(this);for(;i=t._queue.shift();){var e=i[0],i=i[1];e.call(i,this)}this._readyCheck=null,this._initialize=null,this.onInitialized=null}}else window.setTimeout(t._monitor,20)},U.Device._initialize=function(){var t,e,r=this;(function(){var t=navigator.userAgent;/Playstation Vita/.test(t)?r.vita=!0:/Kindle/.test(t)||/\bKF[A-Z][A-Z]+/.test(t)||/Silk.*Mobile Safari/.test(t)?r.kindle=!0:/Android/.test(t)?r.android=!0:/CrOS/.test(t)?r.chromeOS=!0:/iP[ao]d|iPhone/i.test(t)?(r.iOS=!0,navigator.appVersion.match(/OS (\d+)/),r.iOSVersion=parseInt(RegExp.$1,10)):/Linux/.test(t)?r.linux=!0:/Mac OS/.test(t)?r.macOS=!0:/Windows/.test(t)&&(r.windows=!0),(/Windows Phone/i.test(t)||/IEMobile/i.test(t))&&(r.android=!1,r.iOS=!1,r.macOS=!1,r.windows=!0,r.windowsPhone=!0);var e=/Silk/.test(t);(r.windows||r.macOS||r.linux&&!e||r.chromeOS)&&(r.desktop=!0),(r.windowsPhone||/Windows NT/i.test(t)&&/Touch/i.test(t))&&(r.desktop=!1)})(),function(){var t=navigator.userAgent;if(/Arora/.test(t)?r.arora=!0:/Edge\/\d+/.test(t)?r.edge=!0:/Chrome\/(\d+)/.test(t)&&!r.windowsPhone?(r.chrome=!0,r.chromeVersion=parseInt(RegExp.$1,10)):/Epiphany/.test(t)?r.epiphany=!0:/Firefox\D+(\d+)/.test(t)?(r.firefox=!0,r.firefoxVersion=parseInt(RegExp.$1,10)):/AppleWebKit/.test(t)&&r.iOS?r.mobileSafari=!0:/MSIE (\d+\.\d+);/.test(t)?(r.ie=!0,r.ieVersion=parseInt(RegExp.$1,10)):/Midori/.test(t)?r.midori=!0:/Opera/.test(t)?r.opera=!0:/Safari\/(\d+)/.test(t)&&!r.windowsPhone?(r.safari=!0,/Version\/(\d+)\./.test(t)&&(r.safariVersion=parseInt(RegExp.$1,10))):/Trident\/(\d+\.\d+)(.*)rv:(\d+\.\d+)/.test(t)&&(r.ie=!0,r.trident=!0,r.tridentVersion=parseInt(RegExp.$1,10),r.ieVersion=parseInt(RegExp.$3,10)),/Silk/.test(t)&&(r.silk=!0),navigator.standalone&&(r.webApp=!0),void 0!==window.cordova&&(r.cordova=!0),"undefined"!=typeof process&&"undefined"!=typeof require&&(r.node=!0),r.node&&"object"==typeof process.versions&&(r.nodeWebkit=!!process.versions["node-webkit"],r.electron=!!process.versions.electron),navigator.isCocoonJS&&(r.cocoonJS=!0),void 0!==window.wx&&(r.wechatMinigame=!0),r.cocoonJS)try{r.cocoonJSApp="undefined"!=typeof CocoonJS}catch(t){r.cocoonJSApp=!1}void 0!==window.ejecta&&(r.ejecta=!0),/Crosswalk/.test(t)&&(r.crosswalk=!0)}(),function(){r.audioData=!!window.Audio,r.webAudio=!(!window.AudioContext&&!window.webkitAudioContext);var t,e,i=document.createElement("audio");try{i.canPlayType&&(i.canPlayType('audio/ogg; codecs="vorbis"').replace(/^no$/,"")&&(r.ogg=!0),(i.canPlayType('audio/ogg; codecs="opus"').replace(/^no$/,"")||i.canPlayType("audio/opus;").replace(/^no$/,""))&&(r.opus=!0),i.canPlayType("audio/mpeg;").replace(/^no$/,"")&&(r.mp3=!0),i.canPlayType('audio/wav; codecs="1"').replace(/^no$/,"")&&(r.wav=!0),(i.canPlayType("audio/x-m4a;")||i.canPlayType("audio/aac;").replace(/^no$/,""))&&(r.m4a=!0),i.canPlayType('audio/webm; codecs="vorbis"').replace(/^no$/,"")&&(r.webm=!0),""!==i.canPlayType('audio/mp4;codecs="ec-3"'))&&(r.edge?r.dolby=!0:r.safari&&9<=r.safariVersion&&/Mac OS X (\d+)_(\d+)/.test(navigator.userAgent)&&(t=parseInt(RegExp.$1,10),e=parseInt(RegExp.$2,10),(10===t&&11<=e||10<t)&&(r.dolby=!0)))}catch(i){}}(),function(){var t=document.createElement("video");try{t.canPlayType&&(t.canPlayType('video/ogg; codecs="theora"').replace(/^no$/,"")&&(r.oggVideo=!0),t.canPlayType('video/mp4; codecs="avc1.42E01E"').replace(/^no$/,"")&&(r.h264Video=!0,r.mp4Video=!0),t.canPlayType('video/webm; codecs="vp8, vorbis"').replace(/^no$/,"")&&(r.webmVideo=!0),t.canPlayType('video/webm; codecs="vp9"').replace(/^no$/,"")&&(r.vp9Video=!0),t.canPlayType('application/x-mpegURL; codecs="avc1.42E01E"').replace(/^no$/,"")&&(r.hlsVideo=!0))}catch(t){}}(),function(){var t,e,i=document.createElement("p"),n={webkitTransform:"-webkit-transform",OTransform:"-o-transform",msTransform:"-ms-transform",MozTransform:"-moz-transform",transform:"transform"};for(e in document.body.insertBefore(i,null),n)void 0!==i.style[e]&&(i.style[e]="translate3d(1px,1px,1px)",t=window.getComputedStyle(i).getPropertyValue(n[e]));document.body.removeChild(i),r.css3D=void 0!==t&&0<t.length&&"none"!==t}(),r.pixelRatio=window.devicePixelRatio||1,r.iPhone=-1!==navigator.userAgent.toLowerCase().indexOf("iphone"),r.iPhone4=2===r.pixelRatio&&r.iPhone,r.iPad=!!(!(e=-1!==navigator.userAgent.toLowerCase().indexOf("ipad"))&&navigator.userAgent.match(/Mac/)&&navigator.maxTouchPoints&&2<navigator.maxTouchPoints)||e,"undefined"!=typeof Int8Array?r.typedArray=!0:r.typedArray=!1,"undefined"!=typeof ArrayBuffer&&"undefined"!=typeof Uint8Array&&"undefined"!=typeof Uint32Array&&(r.littleEndian=(t=new ArrayBuffer(4),e=new Uint8Array(t),t=new Uint32Array(t),e[0]=161,e[1]=178,e[2]=195,e[3]=212,3569595041===t[0]||2712847316!==t[0]&&null),r.LITTLE_ENDIAN=r.littleEndian),r.support32bit="undefined"!=typeof ArrayBuffer&&"undefined"!=typeof Uint8ClampedArray&&"undefined"!=typeof Int32Array&&null!==r.littleEndian&&function(){if(void 0===Uint8ClampedArray)return!1;var t=PIXI.CanvasPool.create(this,1,1).getContext("2d");return!!t&&(t=t.createImageData(1,1),PIXI.CanvasPool.remove(this),t.data instanceof Uint8ClampedArray)}(),navigator.vibrate=navigator.vibrate||navigator.webkitVibrate||navigator.mozVibrate||navigator.msVibrate,navigator.vibrate&&(r.vibration=!0),function(){r.canvas=!!window.CanvasRenderingContext2D||r.cocoonJS;try{r.localStorage=!!localStorage.getItem}catch(e){r.localStorage=!1}r.file=!!(window.File&&window.FileReader&&window.FileList&&window.Blob),r.fileSystem=!!window.requestFileSystem;var e={stencil:!0};r.webGL=function(){try{var t=document.createElement("canvas");return t.screencanvas=!1,!!window.WebGLRenderingContext&&(t.getContext("webgl",e)||t.getContext("experimental-webgl",e))}catch(t){return!1}}(),r.webGL=!!r.webGL,r.worker=!!window.Worker,r.pointerLock="pointerLockElement"in document||"mozPointerLockElement"in document||"webkitPointerLockElement"in document,r.quirksMode="CSS1Compat"!==document.compatMode,navigator.getUserMedia=navigator.getUserMedia||navigator.webkitGetUserMedia||navigator.mozGetUserMedia||navigator.msGetUserMedia||navigator.oGetUserMedia,window.URL=window.URL||window.webkitURL||window.mozURL||window.msURL,r.getUserMedia=r.getUserMedia&&!!navigator.getUserMedia&&!!window.URL,r.firefox&&r.firefoxVersion<21&&(r.getUserMedia=!1),!r.iOS&&(r.ie||r.firefox||r.chrome)&&(r.canvasBitBltShift=!0),(r.safari||r.mobileSafari)&&(r.canvasBitBltShift=!1)}(),function(){for(var t=["requestFullscreen","requestFullScreen","webkitRequestFullscreen","webkitRequestFullScreen","msRequestFullscreen","msRequestFullScreen","mozRequestFullScreen","mozRequestFullscreen"],e=document.createElement("div"),i=0;i<t.length;i++)if(e[t[i]]){r.fullscreen=!0,r.requestFullscreen=t[i];break}var n=["cancelFullScreen","exitFullscreen","webkitCancelFullScreen","webkitExitFullscreen","msCancelFullScreen","msExitFullscreen","mozCancelFullScreen","mozExitFullscreen"];if(r.fullscreen)for(i=0;i<n.length;i++)if(document[n[i]]){r.cancelFullscreen=n[i];break}window.Element&&Element.ALLOW_KEYBOARD_INPUT&&(r.fullscreenKeyboard=!0)}(),("ontouchstart"in document.documentElement||window.navigator.maxTouchPoints&&1<=window.navigator.maxTouchPoints)&&(r.touch=!0),(window.PointerEvent||window.MSPointerEvent||window.navigator.msPointerEnabled||window.navigator.pointerEnabled)&&(r.mspointer=!0),r.cocoonJS||("onwheel"in window||r.ie&&"WheelEvent"in window?r.wheelEvent="wheel":"onmousewheel"in window?r.wheelEvent="mousewheel":r.firefox&&"MouseScrollEvent"in window&&(r.wheelEvent="DOMMouseScroll"))},U.Device.canPlayAudio=function(t){return!!("mp3"===t&&this.mp3||"ogg"===t&&(this.ogg||this.opus)||"m4a"===t&&this.m4a||"opus"===t&&this.opus||"wav"===t&&this.wav||"webm"===t&&this.webm||"mp4"===t&&this.dolby)},U.Device.canPlayVideo=function(t){return!!("webm"===t&&(this.webmVideo||this.vp9Video)||"mp4"===t&&(this.mp4Video||this.h264Video)||("ogg"===t||"ogv"===t)&&this.oggVideo||"mpeg"===t&&this.hlsVideo)},U.Device.isConsoleOpen=function(){return!(!window.console||!window.console.firebug)||!(!window.console||(console.clear,!console.profiles))&&0<console.profiles.length},U.Device.isAndroidStockBrowser=function(){var t=window.navigator.userAgent.match(/Android.*AppleWebKit\/([\d.]+)/);return t&&t[1]<537},U.Canvas={create:function(t,e,i,n,r){e=e||256,i=i||256;t=r?document.createElement("canvas"):PIXI.CanvasPool.create(t,e,i);return"string"==typeof n&&""!==n&&(t.id=n),t.width=e,t.height=i,t.style.display="block",t},setBackgroundColor:function(t,e){return t.style.backgroundColor=e=e||"rgb(0,0,0)",t},setTouchAction:function(t,e){return t.style.msTouchAction=e=e||"none",t.style["ms-touch-action"]=e,t.style["touch-action"]=e,t},setUserSelect:function(t,e){return t.style["-webkit-touch-callout"]=e=e||"none",t.style["-webkit-user-select"]=e,t.style["-khtml-user-select"]=e,t.style["-moz-user-select"]=e,t.style["-ms-user-select"]=e,t.style["user-select"]=e,t.style["-webkit-tap-highlight-color"]="rgba(0, 0, 0, 0)",t},addToDOM:function(t,e,i){var n;return void 0===i&&(i=!0),e&&("string"==typeof e?n=document.getElementById(e):"object"==typeof e&&1===e.nodeType&&(n=e)),n=n||document.body,i&&n.style&&(n.style.overflow="hidden"),n.appendChild(t),t},removeFromDOM:function(t){t.parentNode&&t.parentNode.removeChild(t)},setTransform:function(t,e,i,n,r,o,s){return t.setTransform(n,o,s,r,e,i),t},setSmoothingEnabled:function(t,e){var i=U.Canvas.getSmoothingPrefix(t);return i&&(t[i]=e),t},getSmoothingPrefix:function(t){var e,i=["i","webkitI","msI","mozI","oI"];for(e in i){var n=i[e]+"mageSmoothingEnabled";if(n in t)return n}return null},getSmoothingEnabled:function(t){var e=U.Canvas.getSmoothingPrefix(t);if(e)return t[e]},setImageRenderingCrisp:function(t){for(var e=["optimizeSpeed","crisp-edges","-moz-crisp-edges","-webkit-optimize-contrast","optimize-contrast","pixelated"],i=0;i<e.length;i++)t.style["image-rendering"]=e[i];return t.style.msInterpolationMode="nearest-neighbor",t},setImageRenderingBicubic:function(t){return t.style["image-rendering"]="auto",t.style.msInterpolationMode="bicubic",t}},U.RequestAnimationFrame=function(t,e){void 0===e&&(e=!1),this.game=t,this.isRunning=!1,this.forceSetTimeOut=e;for(var i=["ms","moz","webkit","o"],n=0;n<i.length&&!window.requestAnimationFrame;n++)window.requestAnimationFrame=window[i[n]+"RequestAnimationFrame"],window.cancelAnimationFrame=window[i[n]+"CancelAnimationFrame"];this._isSetTimeOut=!1,this._onLoop=null,this._timeOutID=null},U.RequestAnimationFrame.prototype={start:function(){this.isRunning=!0;var e=this;!window.requestAnimationFrame||this.forceSetTimeOut?(this._isSetTimeOut=!0,this._onLoop=function(){return e.updateSetTimeout()},this._timeOutID=window.setTimeout(this._onLoop,0)):(this._isSetTimeOut=!1,this._onLoop=function(t){return e.updateRAF(t)},this._timeOutID=window.requestAnimationFrame(this._onLoop))},updateRAF:function(t){this.isRunning&&(this.game.update(Math.floor(t)),this._timeOutID=window.requestAnimationFrame(this._onLoop))},updateSetTimeout:function(){this.isRunning&&(this.game.update(Date.now()),this._timeOutID=window.setTimeout(this._onLoop,this.game.time.timeToCall))},stop:function(){this._isSetTimeOut?clearTimeout(this._timeOutID):window.cancelAnimationFrame(this._timeOutID),this.isRunning=!1},isSetTimeOut:function(){return this._isSetTimeOut},isRAF:function(){return!1===this._isSetTimeOut}},U.RequestAnimationFrame.prototype.constructor=U.RequestAnimationFrame,U.Math={PI2:2*Math.PI,between:function(t,e){return Math.floor(Math.random()*(e-t+1)+t)},fuzzyEqual:function(t,e,i){return void 0===i&&(i=1e-4),Math.abs(t-e)<i},fuzzyLessThan:function(t,e,i){return t<e+(i=void 0===i?1e-4:i)},fuzzyGreaterThan:function(t,e,i){return e-(i=void 0===i?1e-4:i)<t},fuzzyCeil:function(t,e){return void 0===e&&(e=1e-4),Math.ceil(t-e)},fuzzyFloor:function(t,e){return void 0===e&&(e=1e-4),Math.floor(t+e)},average:function(){for(var t=0,e=arguments.length,i=0;i<e;i++)t+=+arguments[i];return t/e},shear:function(t){return t%1},snapTo:function(t,e,i){return void 0===i&&(i=0),0===e?t:(t-=i,i+(t=e*Math.round(t/e)))},snapToFloor:function(t,e,i){return void 0===i&&(i=0),0===e?t:(t-=i,i+(t=e*Math.floor(t/e)))},snapToCeil:function(t,e,i){return void 0===i&&(i=0),0===e?t:(t-=i,i+(t=e*Math.ceil(t/e)))},roundTo:function(t,e,i){void 0===e&&(e=0),void 0===i&&(i=10);e=Math.pow(i,-e);return Math.round(t*e)/e},floorTo:function(t,e,i){void 0===e&&(e=0),void 0===i&&(i=10);e=Math.pow(i,-e);return Math.floor(t*e)/e},ceilTo:function(t,e,i){void 0===e&&(e=0),void 0===i&&(i=10);e=Math.pow(i,-e);return Math.ceil(t*e)/e},rotateToAngle:function(t,e,i){return void 0===i&&(i=.05),t===e||(Math.abs(e-t)<=i||Math.abs(e-t)>=U.Math.PI2-i?t=e:(Math.abs(e-t)>Math.PI&&(e<t?e+=U.Math.PI2:e-=U.Math.PI2),t<e?t+=i:e<t&&(t-=i))),t},getShortestAngle:function(t,e){t=e-t;return 0==t?0:t-360*Math.floor((t+180)/360)},angleBetween:function(t,e,i,n){return Math.atan2(n-e,i-t)},angleBetweenY:function(t,e,i,n){return Math.atan2(i-t,n-e)},angleBetweenPoints:function(t,e){return Math.atan2(e.y-t.y,e.x-t.x)},angleBetweenPointsY:function(t,e){return Math.atan2(e.x-t.x,e.y-t.y)},reverseAngle:function(t){return this.normalizeAngle(t+Math.PI,!0)},normalizeAngle:function(t){return 0<=(t%=2*Math.PI)?t:t+2*Math.PI},maxAdd:function(t,e,i){return Math.min(t+e,i)},minSub:function(t,e,i){return Math.max(t-e,i)},wrap:function(t,e,i){i-=e;if(i<=0)return 0;t=(t-e)%i;return t<0&&(t+=i),t+e},wrapValue:function(t,e,i){return((t=Math.abs(t))+(e=Math.abs(e)))%(i=Math.abs(i))},isOdd:function(t){return!!(1&t)},isEven:function(t){return!(1&t)},min:function(){for(var t,e=1,i=0,n=(t=1===arguments.length&&"object"==typeof arguments[0]?arguments[0]:arguments).length;e<n;e++)t[e]<t[i]&&(i=e);return t[i]},max:function(){for(var t,e=1,i=0,n=(t=1===arguments.length&&"object"==typeof arguments[0]?arguments[0]:arguments).length;e<n;e++)t[e]>t[i]&&(i=e);return t[i]},minProperty:function(t){for(var e,i=1,n=0,r=(e=2===arguments.length&&"object"==typeof arguments[1]?arguments[1]:arguments.slice(1)).length;i<r;i++)e[i][t]<e[n][t]&&(n=i);return e[n][t]},maxProperty:function(t){for(var e,i=1,n=0,r=(e=2===arguments.length&&"object"==typeof arguments[1]?arguments[1]:arguments.slice(1)).length;i<r;i++)e[i][t]>e[n][t]&&(n=i);return e[n][t]},wrapAngle:function(t,e){return e?this.wrap(t,-Math.PI,Math.PI):this.wrap(t,-180,180)},linearInterpolation:function(t,e){var i=t.length-1,n=i*e,r=Math.floor(n);return e<0?this.linear(t[0],t[1],n):1<e?this.linear(t[i],t[i-1],i-n):this.linear(t[r],t[i<r+1?i:r+1],n-r)},bezierInterpolation:function(t,e){for(var i=0,n=t.length-1,r=0;r<=n;r++)i+=Math.pow(1-e,n-r)*Math.pow(e,r)*t[r]*this.bernstein(n,r);return i},catmullRomInterpolation:function(t,e){var i=t.length-1,n=i*e,r=Math.floor(n);return t[0]===t[i]?(e<0&&(r=Math.floor(n=i*(1+e))),this.catmullRom(t[(r-1+i)%i],t[r],t[(r+1)%i],t[(r+2)%i],n-r)):e<0?t[0]-(this.catmullRom(t[0],t[0],t[1],t[1],-n)-t[0]):1<e?t[i]-(this.catmullRom(t[i],t[i],t[i-1],t[i-1],n-i)-t[i]):this.catmullRom(t[r?r-1:0],t[r],t[i<r+1?i:r+1],t[i<r+2?i:r+2],n-r)},linear:function(t,e,i){return(e-t)*i+t},bernstein:function(t,e){return this.factorial(t)/this.factorial(e)/this.factorial(t-e)},factorial:function(t){if(0===t)return 1;for(var e=t;--t;)e*=t;return e},catmullRom:function(t,e,i,n,r){var o=.5*(i-t),t=.5*(n-e),n=r*r;return r*n*(2*e-2*i+o+t)+(-3*e+3*i-2*o-t)*n+o*r+e},difference:function(t,e){return Math.abs(t-e)},roundAwayFromZero:function(t){return 0<t?Math.ceil(t):Math.floor(t)},sinCosGenerator:function(t,e,i,n){for(var r=e=void 0===e?1:e,o=i=void 0===i?1:i,s=(n=void 0===n?1:n)*Math.PI/t,a=[],h=[],l=0;l<t;l++)r+=(o-=r*s)*s,a[l]=o,h[l]=r;return{sin:h,cos:a,length:t}},distance:function(t,e,i,n){i=t-i,n=e-n;return Math.sqrt(i*i+n*n)},distanceSq:function(t,e,i,n){i=t-i,n=e-n;return i*i+n*n},distancePow:function(t,e,i,n,r){return void 0===r&&(r=2),Math.sqrt(Math.pow(i-t,r)+Math.pow(n-e,r))},clamp:function(t,e,i){return t<e?e:i<t?i:t},clampBottom:function(t,e){return t<e?e:t},within:function(t,e,i){return Math.abs(t-e)<=i},mapLinear:function(t,e,i,n,r){return n+(t-e)*(r-n)/(i-e)},smoothstep:function(t,e,i){return(t=Math.max(0,Math.min(1,(t-e)/(i-e))))*t*(3-2*t)},smootherstep:function(t,e,i){return(t=Math.max(0,Math.min(1,(t-e)/(i-e))))*t*t*(t*(6*t-15)+10)},sign:function(t){return t<0?-1:0<t?1:0},percent:function(t,e,i){return void 0===i&&(i=0),e<t||e<i?1:t<i?0:(t-i)/e}};var s=Math.PI/180,a=180/Math.PI;return U.Math.degToRad=function(t){return t*s},U.Math.radToDeg=function(t){return t*a},U.RandomDataGenerator=function(t){void 0===t&&(t=[]),this.c=1,this.s0=0,this.s1=0,this.s2=0,"string"==typeof t?this.state(t):this.sow(t)},U.RandomDataGenerator.prototype={rnd:function(){var t=2091639*this.s0+2.3283064365386963e-10*this.c;return this.c=0|t,this.s0=this.s1,this.s1=this.s2,this.s2=t-this.c,this.s2},sow:function(t){if(this.s0=this.hash(" "),this.s1=this.hash(this.s0),this.s2=this.hash(this.s1),this.c=1,t)for(var e=0;e<t.length&&null!=t[e];e++){var i=t[e];this.s0-=this.hash(i),this.s0+=~~(this.s0<0),this.s1-=this.hash(i),this.s1+=~~(this.s1<0),this.s2-=this.hash(i),this.s2+=~~(this.s2<0)}},hash:function(t){var e,i,n=4022871197;for(t=t.toString(),i=0;i<t.length;i++)e=.02519603282416938*(n+=t.charCodeAt(i)),e-=n=e>>>0,n=(e*=n)>>>0,n+=4294967296*(e-=n);return 2.3283064365386963e-10*(n>>>0)},integer:function(){return 4294967296*this.rnd.apply(this)},frac:function(){return this.rnd.apply(this)+11102230246251565e-32*(2097152*this.rnd.apply(this)|0)},real:function(){return this.integer()+this.frac()},integerInRange:function(t,e){return Math.floor(this.realInRange(0,e-t+1)+t)},between:function(t,e){return this.integerInRange(t,e)},realInRange:function(t,e){return this.frac()*(e-t)+t},normal:function(){return 1-2*this.frac()},uuid:function(){for(var t="",e="",e=t="";t++<36;e+=~t%5|3*t&4?(15^t?8^this.frac()*(20^t?16:4):4).toString(16):"-");return e},pick:function(t){return t[this.integerInRange(0,t.length-1)]},sign:function(){return this.pick([-1,1])},weightedPick:function(t){return t[~~(Math.pow(this.frac(),2)*(t.length-1)+.5)]},timestamp:function(t,e){return this.realInRange(t||9466848e5,e||1577862e6)},angle:function(){return this.integerInRange(-180,180)},state:function(t){return"string"==typeof t&&t.match(/^!rnd/)&&(t=t.split(","),this.c=parseFloat(t[1]),this.s0=parseFloat(t[2]),this.s1=parseFloat(t[3]),this.s2=parseFloat(t[4])),["!rnd",this.c,this.s0,this.s1,this.s2].join(",")}},U.RandomDataGenerator.prototype.constructor=U.RandomDataGenerator,U.QuadTree=function(t,e,i,n,r,o,s){this.maxObjects=10,this.maxLevels=4,this.level=0,this.bounds={},this.objects=[],this.nodes=[],this._empty=[],this.reset(t,e,i,n,r,o,s)},U.QuadTree.prototype={reset:function(t,e,i,n,r,o,s){this.maxObjects=r||10,this.maxLevels=o||4,this.level=s||0,this.bounds={x:Math.round(t),y:Math.round(e),width:i,height:n,subWidth:Math.floor(i/2),subHeight:Math.floor(n/2),right:Math.round(t)+Math.floor(i/2),bottom:Math.round(e)+Math.floor(n/2)},this.objects.length=0,this.nodes.length=0},populate:function(t){t.forEach(this.populateHandler,this,!0)},populateHandler:function(t){t.body&&t.exists&&this.insert(t.body)},split:function(){this.nodes[0]=new U.QuadTree(this.bounds.right,this.bounds.y,this.bounds.subWidth,this.bounds.subHeight,this.maxObjects,this.maxLevels,this.level+1),this.nodes[1]=new U.QuadTree(this.bounds.x,this.bounds.y,this.bounds.subWidth,this.bounds.subHeight,this.maxObjects,this.maxLevels,this.level+1),this.nodes[2]=new U.QuadTree(this.bounds.x,this.bounds.bottom,this.bounds.subWidth,this.bounds.subHeight,this.maxObjects,this.maxLevels,this.level+1),this.nodes[3]=new U.QuadTree(this.bounds.right,this.bounds.bottom,this.bounds.subWidth,this.bounds.subHeight,this.maxObjects,this.maxLevels,this.level+1)},insert:function(t){var e,i=0;if(null==this.nodes[0]||-1===(e=this.getIndex(t))){if(this.objects.push(t),this.objects.length>this.maxObjects&&this.level<this.maxLevels)for(null==this.nodes[0]&&this.split();i<this.objects.length;)-1!==(e=this.getIndex(this.objects[i]))?this.nodes[e].insert(this.objects.splice(i,1)[0]):i++}else this.nodes[e].insert(t)},getIndex:function(t){var e=-1;return t.x<this.bounds.right&&t.right<this.bounds.right?t.y<this.bounds.bottom&&t.bottom<this.bounds.bottom?e=1:t.y>this.bounds.bottom&&(e=2):t.x>this.bounds.right&&(t.y<this.bounds.bottom&&t.bottom<this.bounds.bottom?e=0:t.y>this.bounds.bottom&&(e=3)),e},retrieve:function(t){if(t instanceof U.Rectangle)var e=this.objects,i=this.getIndex(t);else{if(!t.body)return this._empty;e=this.objects,i=this.getIndex(t.body)}return e=this.nodes[0]?-1!==i?e.concat(this.nodes[i].retrieve(t)):(e=(e=(e=e.concat(this.nodes[0].retrieve(t))).concat(this.nodes[1].retrieve(t))).concat(this.nodes[2].retrieve(t))).concat(this.nodes[3].retrieve(t)):e},clear:function(){this.objects.length=0;for(var t=this.nodes.length;t--;)this.nodes[t].clear(),this.nodes.splice(t,1);this.nodes.length=0}},U.QuadTree.prototype.constructor=U.QuadTree,U.Net=function(t){this.game=t},U.Net.prototype={getHostName:function(){return window.location&&window.location.hostname?window.location.hostname:null},checkDomainName:function(t){return-1!==window.location.hostname.indexOf(t)},updateQueryString:function(t,e,i,n){void 0===i&&(i=!1),void 0!==n&&""!==n||(n=window.location.href);var r,o="",s=new RegExp("([?|&])"+t+"=.*?(&|#|$)(.*)","gi"),o=s.test(n)?null!=e?n.replace(s,"$1"+t+"="+e+"$2$3"):n.replace(s,"$1$3").replace(/(&|\?)$/,""):(null!=e&&(r=-1!==n.indexOf("?")?"&":"?",n=(s=n.split("#"))[0]+r+t+"="+e,s[1]&&(n+="#"+s[1])),n);if(!i)return o;window.location.href=o},getQueryString:function(t){void 0===t&&(t="");var e,i={},n=location.search.substring(1).split("&");for(e in n){var r=n[e].split("=");if(1<r.length){if(t&&t===this.decodeURI(r[0]))return this.decodeURI(r[1]);i[this.decodeURI(r[0])]=this.decodeURI(r[1])}}return i},decodeURI:function(t){return decodeURIComponent(t.replace(/\+/g," "))}},U.Net.prototype.constructor=U.Net,U.TweenManager=function(t){this.game=t,this.frameBased=!1,this._tweens=[],this._add=[],this.easeMap={Power0:U.Easing.Power0,Power1:U.Easing.Power1,Power2:U.Easing.Power2,Power3:U.Easing.Power3,Power4:U.Easing.Power4,Linear:U.Easing.Linear.None,Quad:U.Easing.Quadratic.Out,Cubic:U.Easing.Cubic.Out,Quart:U.Easing.Quartic.Out,Quint:U.Easing.Quintic.Out,Sine:U.Easing.Sinusoidal.Out,Expo:U.Easing.Exponential.Out,Circ:U.Easing.Circular.Out,Elastic:U.Easing.Elastic.Out,Back:U.Easing.Back.Out,Bounce:U.Easing.Bounce.Out,"Quad.easeIn":U.Easing.Quadratic.In,"Cubic.easeIn":U.Easing.Cubic.In,"Quart.easeIn":U.Easing.Quartic.In,"Quint.easeIn":U.Easing.Quintic.In,"Sine.easeIn":U.Easing.Sinusoidal.In,"Expo.easeIn":U.Easing.Exponential.In,"Circ.easeIn":U.Easing.Circular.In,"Elastic.easeIn":U.Easing.Elastic.In,"Back.easeIn":U.Easing.Back.In,"Bounce.easeIn":U.Easing.Bounce.In,"Quad.easeOut":U.Easing.Quadratic.Out,"Cubic.easeOut":U.Easing.Cubic.Out,"Quart.easeOut":U.Easing.Quartic.Out,"Quint.easeOut":U.Easing.Quintic.Out,"Sine.easeOut":U.Easing.Sinusoidal.Out,"Expo.easeOut":U.Easing.Exponential.Out,"Circ.easeOut":U.Easing.Circular.Out,"Elastic.easeOut":U.Easing.Elastic.Out,"Back.easeOut":U.Easing.Back.Out,"Bounce.easeOut":U.Easing.Bounce.Out,"Quad.easeInOut":U.Easing.Quadratic.InOut,"Cubic.easeInOut":U.Easing.Cubic.InOut,"Quart.easeInOut":U.Easing.Quartic.InOut,"Quint.easeInOut":U.Easing.Quintic.InOut,"Sine.easeInOut":U.Easing.Sinusoidal.InOut,"Expo.easeInOut":U.Easing.Exponential.InOut,"Circ.easeInOut":U.Easing.Circular.InOut,"Elastic.easeInOut":U.Easing.Elastic.InOut,"Back.easeInOut":U.Easing.Back.InOut,"Bounce.easeInOut":U.Easing.Bounce.InOut},this.game.onPause.add(this._pauseAll,this),this.game.onResume.add(this._resumeAll,this)},U.TweenManager.prototype={getAll:function(){return this._tweens},removeAll:function(){for(var t=0;t<this._tweens.length;t++)this._tweens[t].pendingDelete=!0;this._add=[]},removeFrom:function(t,e){if(void 0===e&&(e=!0),Array.isArray(t))for(i=0,n=t.length;i<n;i++)this.removeFrom(t[i]);else if(t.type===U.GROUP&&e)for(var i=0,n=t.children.length;i<n;i++)this.removeFrom(t.children[i]);else{for(i=0,n=this._tweens.length;i<n;i++)t===this._tweens[i].target&&this.remove(this._tweens[i]);for(i=0,n=this._add.length;i<n;i++)t===this._add[i].target&&this.remove(this._add[i])}},add:function(t){(t._manager=this)._add.push(t)},create:function(t){return new U.Tween(t,this.game,this)},remove:function(t){var e=this._tweens.indexOf(t);-1!==e?this._tweens[e].pendingDelete=!0:-1!==(e=this._add.indexOf(t))&&(this._add[e].pendingDelete=!0)},update:function(){var t=this._add.length,e=this._tweens.length;if(0===e&&0===t)return!1;for(var i=0;i<e;)this._tweens[i].update(this.game.time.time)?i++:(this._tweens.splice(i,1),e--);return 0<t&&(this._tweens=this._tweens.concat(this._add),this._add.length=0),!0},isTweening:function(e){return this._tweens.some(function(t){return t.target===e})},_pauseAll:function(){for(var t=this._tweens.length-1;0<=t;t--)this._tweens[t]._pause()},_resumeAll:function(){for(var t=this._tweens.length-1;0<=t;t--)this._tweens[t]._resume()},pauseAll:function(){for(var t=this._tweens.length-1;0<=t;t--)this._tweens[t].pause()},resumeAll:function(){for(var t=this._tweens.length-1;0<=t;t--)this._tweens[t].resume(!0)}},U.TweenManager.prototype.constructor=U.TweenManager,U.Tween=function(t,e,i){this.game=e,this.target=t,this.manager=i,this.timeline=[],this.reverse=!1,this.timeScale=1,this.repeatCounter=0,this.pendingDelete=!1,this.onStart=new U.Signal,this.onLoop=new U.Signal,this.onRepeat=new U.Signal,this.onChildComplete=new U.Signal,this.onComplete=new U.Signal,this.isRunning=!1,this.current=0,this.properties={},this.chainedTween=null,this.isPaused=!1,this.frameBased=i.frameBased,this._onUpdateCallback=null,this._onUpdateCallbackContext=null,this._pausedTime=0,this._codePaused=!1,this._hasStarted=!1},U.Tween.prototype={to:function(t,e,i,n,r,o,s){return(void 0===e||e<=0)&&(e=1e3),void 0===n&&(n=!1),void 0===r&&(r=0),void 0===o&&(o=0),void 0===s&&(s=!1),"string"==typeof(i=null==i?U.Easing.Default:i)&&this.manager.easeMap[i]&&(i=this.manager.easeMap[i]),this.isRunning||(this.timeline.push(new U.TweenData(this).to(t,e,i,r,o,s)),n&&this.start()),this},from:function(t,e,i,n,r,o,s){return void 0===e&&(e=1e3),void 0===n&&(n=!1),void 0===r&&(r=0),void 0===o&&(o=0),void 0===s&&(s=!1),"string"==typeof(i=null==i?U.Easing.Default:i)&&this.manager.easeMap[i]&&(i=this.manager.easeMap[i]),this.isRunning||(this.timeline.push(new U.TweenData(this).from(t,e,i,r,o,s)),n&&this.start()),this},start:function(t){if(void 0===t&&(t=0),null===this.game||null===this.target||0===this.timeline.length||this.isRunning)return this;for(var e=0;e<this.timeline.length;e++)for(var i in this.timeline[e].vEnd)this.properties[i]=this.target[i]||0,Array.isArray(this.properties[i])||(this.properties[i]*=1);for(e=0;e<this.timeline.length;e++)this.timeline[e].loadValues();return this.manager.add(this),this.isRunning=!0,(t<0||t>this.timeline.length-1)&&(t=0),this.current=t,this.timeline[this.current].start(),this},stop:function(t){return void 0===t&&(t=!1),this.isRunning=!1,this._onUpdateCallback=null,this._onUpdateCallbackContext=null,t&&(this.onComplete.dispatch(this.target,this),this._hasStarted=!1,this.chainedTween&&this.chainedTween.start()),this.manager.remove(this),this},updateTweenData:function(t,e,i){if(0===this.timeline.length)return this;if(-1===(i=void 0===i?0:i))for(var n=0;n<this.timeline.length;n++)this.timeline[n][t]=e;else this.timeline[i][t]=e;return this},delay:function(t,e){return this.updateTweenData("delay",t,e)},repeat:function(t,e,i){return void 0===e&&(e=0),this.updateTweenData("repeatCounter",t,i),this.updateTweenData("repeatDelay",e,i)},repeatDelay:function(t,e){return this.updateTweenData("repeatDelay",t,e)},yoyo:function(t,e,i){return void 0===e&&(e=0),this.updateTweenData("yoyo",t,i),this.updateTweenData("yoyoDelay",e,i)},yoyoDelay:function(t,e){return this.updateTweenData("yoyoDelay",t,e)},easing:function(t,e){return"string"==typeof t&&this.manager.easeMap[t]&&(t=this.manager.easeMap[t]),this.updateTweenData("easingFunction",t,e)},interpolation:function(t,e,i){return void 0===e&&(e=U.Math),this.updateTweenData("interpolationFunction",t,i),this.updateTweenData("interpolationContext",e,i)},repeatAll:function(t){return this.repeatCounter=t=void 0===t?0:t,this},chain:function(){for(var t=arguments.length;t--;)0<t?arguments[t-1].chainedTween=arguments[t]:this.chainedTween=arguments[t];return this},loop:function(t){return this.repeatCounter=(t=void 0===t?!0:t)?-1:0,this},onUpdateCallback:function(t,e){return this._onUpdateCallback=t,this._onUpdateCallbackContext=e,this},pause:function(){this.isPaused=!0,this._codePaused=!0,this._pausedTime=this.game.time.time},_pause:function(){this._codePaused||(this.isPaused=!0,this._pausedTime=this.game.time.time)},resume:function(){if(this.isPaused){this.isPaused=!1,this._codePaused=!1;for(var t=0;t<this.timeline.length;t++)this.timeline[t].isRunning||(this.timeline[t].startTime+=this.game.time.time-this._pausedTime)}},_resume:function(){this._codePaused||this.resume()},update:function(t){if(this.pendingDelete||!this.target)return!1;if(this.isPaused)return!0;t=this.timeline[this.current].update(t);if(t===U.TweenData.PENDING)return!0;if(t===U.TweenData.RUNNING)return this._hasStarted||(this.onStart.dispatch(this.target,this),this._hasStarted=!0),null!==this._onUpdateCallback&&this._onUpdateCallback.call(this._onUpdateCallbackContext,this,this.timeline[this.current].value,this.timeline[this.current]),this.isRunning;if(t===U.TweenData.LOOPED)return(-1===this.timeline[this.current].repeatCounter?this.onLoop:this.onRepeat).dispatch(this.target,this),!0;if(t===U.TweenData.COMPLETE){t=!1;return this.reverse?--this.current<0&&(this.current=this.timeline.length-1,t=!0):++this.current===this.timeline.length&&(t=!(this.current=0)),t?-1===this.repeatCounter?(this.timeline[this.current].start(),this.onLoop.dispatch(this.target,this),!0):0<this.repeatCounter?(this.repeatCounter--,this.timeline[this.current].start(),this.onRepeat.dispatch(this.target,this),!0):(this.isRunning=!1,this.onComplete.dispatch(this.target,this),this._hasStarted=!1,this.chainedTween&&this.chainedTween.start(),!1):(this.onChildComplete.dispatch(this.target,this),this.timeline[this.current].start(),!0)}},generateData:function(t,e){if(null===this.game||null===this.target)return null;void 0===t&&(t=60),void 0===e&&(e=[]);for(var i=0;i<this.timeline.length;i++)for(var n in this.timeline[i].vEnd)this.properties[n]=this.target[n]||0,Array.isArray(this.properties[n])||(this.properties[n]*=1);for(i=0;i<this.timeline.length;i++)this.timeline[i].loadValues();for(i=0;i<this.timeline.length;i++)e=e.concat(this.timeline[i].generateData(t));return e}},Object.defineProperty(U.Tween.prototype,"totalDuration",{get:function(){for(var t=0,e=0;e<this.timeline.length;e++)t+=this.timeline[e].duration;return t}}),U.Tween.prototype.constructor=U.Tween,U.TweenData=function(t){this.parent=t,this.game=t.game,this.vStart={},this.vStartCache={},this.vEnd={},this.vEndCache={},this.duration=1e3,this.percent=0,this.value=0,this.repeatCounter=0,this.repeatDelay=0,this.repeatTotal=0,this.interpolate=!1,this.yoyo=!1,this.yoyoDelay=0,this.inReverse=!1,this.delay=0,this.dt=0,this.startTime=null,this.easingFunction=U.Easing.Default,this.interpolationFunction=U.Math.linearInterpolation,this.interpolationContext=U.Math,this.isRunning=!1,this.isFrom=!1},U.TweenData.PENDING=0,U.TweenData.RUNNING=1,U.TweenData.LOOPED=2,U.TweenData.COMPLETE=3,U.TweenData.prototype={to:function(t,e,i,n,r,o){return this.vEnd=t,this.duration=e,this.easingFunction=i,this.delay=n,this.repeatTotal=r,this.yoyo=o,this.isFrom=!1,this},from:function(t,e,i,n,r,o){return this.vEnd=t,this.duration=e,this.easingFunction=i,this.delay=n,this.repeatTotal=r,this.yoyo=o,this.isFrom=!0,this},start:function(){if(this.startTime=this.game.time.time+this.delay,this.parent.reverse?this.dt=this.duration:this.dt=0,0<this.delay?this.isRunning=!1:this.isRunning=!0,this.isFrom)for(var t in this.vStartCache)this.vStart[t]=this.vEndCache[t],this.vEnd[t]=this.vStartCache[t],this.parent.target[t]=this.vStart[t];return this.value=0,this.yoyoCounter=0,this.repeatCounter=this.repeatTotal,this},loadValues:function(){for(var t in this.parent.properties){if(this.vStart[t]=this.parent.properties[t],Array.isArray(this.vEnd[t])){if(0===this.vEnd[t].length)continue;0===this.percent&&(this.vEnd[t]=[this.vStart[t]].concat(this.vEnd[t]))}void 0!==this.vEnd[t]?("string"==typeof this.vEnd[t]&&(this.vEnd[t]=this.vStart[t]+parseFloat(this.vEnd[t],10)),this.parent.properties[t]=this.vEnd[t]):this.vEnd[t]=this.vStart[t],this.vStartCache[t]=this.vStart[t],this.vEndCache[t]=this.vEnd[t]}return this},update:function(t){if(this.isRunning){if(t<this.startTime)return U.TweenData.RUNNING}else{if(!(t>=this.startTime))return U.TweenData.PENDING;this.isRunning=!0}var e,t=this.parent.frameBased?this.game.time.physicsElapsedMS:this.game.time.elapsedMS;for(e in this.parent.reverse?(this.dt-=t*this.parent.timeScale,this.dt=Math.max(this.dt,0)):(this.dt+=t*this.parent.timeScale,this.dt=Math.min(this.dt,this.duration)),this.percent=this.dt/this.duration,this.value=this.easingFunction(this.percent),this.vEnd){var i=this.vStart[e],n=this.vEnd[e];Array.isArray(n)?this.parent.target[e]=this.interpolationFunction.call(this.interpolationContext,n,this.value):this.parent.target[e]=i+(n-i)*this.value}return!this.parent.reverse&&1===this.percent||this.parent.reverse&&0===this.percent?this.repeat():U.TweenData.RUNNING},generateData:function(t){this.parent.reverse?this.dt=this.duration:this.dt=0;var e=[],i=!1,n=1/t*1e3;do{this.parent.reverse?(this.dt-=n,this.dt=Math.max(this.dt,0)):(this.dt+=n,this.dt=Math.min(this.dt,this.duration)),this.percent=this.dt/this.duration,this.value=this.easingFunction(this.percent);var r,o={};for(r in this.vEnd){var s=this.vStart[r],a=this.vEnd[r];Array.isArray(a)?o[r]=this.interpolationFunction(a,this.value):o[r]=s+(a-s)*this.value}}while(e.push(o),!(i=!this.parent.reverse&&1===this.percent||this.parent.reverse&&0===this.percent?!0:i));return this.yoyo&&((t=e.slice()).reverse(),e=e.concat(t)),e},repeat:function(){if(this.yoyo){if(this.inReverse&&0===this.repeatCounter){for(var t in this.vStartCache)this.vStart[t]=this.vStartCache[t],this.vEnd[t]=this.vEndCache[t];return this.inReverse=!1,U.TweenData.COMPLETE}this.inReverse=!this.inReverse}else if(0===this.repeatCounter)return U.TweenData.COMPLETE;if(this.inReverse)for(var t in this.vStartCache)this.vStart[t]=this.vEndCache[t],this.vEnd[t]=this.vStartCache[t];else{for(var t in this.vStartCache)this.vStart[t]=this.vStartCache[t],this.vEnd[t]=this.vEndCache[t];0<this.repeatCounter&&this.repeatCounter--}return this.startTime=this.game.time.time,this.yoyo&&this.inReverse?this.startTime+=this.yoyoDelay:this.inReverse||(this.startTime+=this.repeatDelay),this.parent.reverse?this.dt=this.duration:this.dt=0,U.TweenData.LOOPED}},U.TweenData.prototype.constructor=U.TweenData,U.Easing={Linear:{None:function(t){return t}},Quadratic:{In:function(t){return t*t},Out:function(t){return t*(2-t)},InOut:function(t){return(t*=2)<1?.5*t*t:-.5*(--t*(t-2)-1)}},Cubic:{In:function(t){return t*t*t},Out:function(t){return--t*t*t+1},InOut:function(t){return(t*=2)<1?.5*t*t*t:.5*((t-=2)*t*t+2)}},Quartic:{In:function(t){return t*t*t*t},Out:function(t){return 1- --t*t*t*t},InOut:function(t){return(t*=2)<1?.5*t*t*t*t:-.5*((t-=2)*t*t*t-2)}},Quintic:{In:function(t){return t*t*t*t*t},Out:function(t){return--t*t*t*t*t+1},InOut:function(t){return(t*=2)<1?.5*t*t*t*t*t:.5*((t-=2)*t*t*t*t+2)}},Sinusoidal:{In:function(t){return 0===t?0:1===t?1:1-Math.cos(t*Math.PI/2)},Out:function(t){return 0===t?0:1===t?1:Math.sin(t*Math.PI/2)},InOut:function(t){return 0===t?0:1===t?1:.5*(1-Math.cos(Math.PI*t))}},Exponential:{In:function(t){return 0===t?0:Math.pow(1024,t-1)},Out:function(t){return 1===t?1:1-Math.pow(2,-10*t)},InOut:function(t){return 0===t?0:1===t?1:(t*=2)<1?.5*Math.pow(1024,t-1):.5*(2-Math.pow(2,-10*(t-1)))}},Circular:{In:function(t){return 1-Math.sqrt(1-t*t)},Out:function(t){return Math.sqrt(1- --t*t)},InOut:function(t){return(t*=2)<1?-.5*(Math.sqrt(1-t*t)-1):.5*(Math.sqrt(1-(t-=2)*t)+1)}},Elastic:{In:function(t){var e,i=.1;return 0===t?0:1===t?1:(e=!i||i<1?(i=1,.1):.4*Math.asin(1/i)/(2*Math.PI),-i*Math.pow(2,10*--t)*Math.sin((t-e)*(2*Math.PI)/.4))},Out:function(t){var e,i=.1;return 0===t?0:1===t?1:(e=!i||i<1?(i=1,.1):.4*Math.asin(1/i)/(2*Math.PI),i*Math.pow(2,-10*t)*Math.sin((t-e)*(2*Math.PI)/.4)+1)},InOut:function(t){var e,i=.1;return 0===t?0:1===t?1:(e=!i||i<1?(i=1,.1):.4*Math.asin(1/i)/(2*Math.PI),(t*=2)<1?i*Math.pow(2,10*--t)*Math.sin((t-e)*(2*Math.PI)/.4)*-.5:i*Math.pow(2,-10*--t)*Math.sin((t-e)*(2*Math.PI)/.4)*.5+1)}},Back:{In:function(t){return t*t*(2.70158*t-1.70158)},Out:function(t){return--t*t*(2.70158*t+1.70158)+1},InOut:function(t){var e=2.5949095;return(t*=2)<1?t*t*((1+e)*t-e)*.5:.5*((t-=2)*t*((1+e)*t+e)+2)}},Bounce:{In:function(t){return 1-U.Easing.Bounce.Out(1-t)},Out:function(t){return t<1/2.75?7.5625*t*t:t<2/2.75?7.5625*(t-=1.5/2.75)*t+.75:t<2.5/2.75?7.5625*(t-=2.25/2.75)*t+.9375:7.5625*(t-=2.625/2.75)*t+.984375},InOut:function(t){return t<.5?.5*U.Easing.Bounce.In(2*t):.5*U.Easing.Bounce.Out(2*t-1)+.5}}},U.Easing.Default=U.Easing.Linear.None,U.Easing.Power0=U.Easing.Linear.None,U.Easing.Power1=U.Easing.Quadratic.Out,U.Easing.Power2=U.Easing.Cubic.Out,U.Easing.Power3=U.Easing.Quartic.Out,U.Easing.Power4=U.Easing.Quintic.Out,U.Time=function(t){this.game=t,this.time=0,this.prevTime=0,this.now=0,this.elapsed=0,this.elapsedMS=0,this.physicsElapsed=1/60,this.physicsElapsedMS=1/60*1e3,this.desiredFpsMult=1/60,this._desiredFps=60,this.suggestedFps=this.desiredFps,this.slowMotion=1,this.advancedTiming=!1,this.frames=0,this.fps=0,this.fpsMin=1e3,this.fpsMax=0,this.msMin=1e3,this.msMax=0,this.pauseDuration=0,this.timeToCall=0,this.timeExpected=0,this.events=new U.Timer(this.game,!1),this._frameCount=0,this._elapsedAccumulator=0,this._started=0,this._timeLastSecond=0,this._pauseStarted=0,this._justResumed=!1,this._timers=[]},U.Time.prototype={boot:function(){this._started=Date.now(),this.time=Date.now(),this.events.start(),this.timeExpected=this.time},add:function(t){return this._timers.push(t),t},create:function(t){t=new U.Timer(this.game,t=void 0===t?!0:t);return this._timers.push(t),t},removeAll:function(){for(var t=0;t<this._timers.length;t++)this._timers[t].destroy();this._timers=[],this.events.removeAll()},refresh:function(){var t=this.time;this.time=Date.now(),this.elapsedMS=this.time-t},update:function(t){var e=this.time;this.time=Date.now(),this.elapsedMS=this.time-e,this.prevTime=this.now,this.now=t,this.elapsed=this.now-this.prevTime,this.game.raf._isSetTimeOut&&(this.timeToCall=Math.floor(Math.max(0,1e3/this._desiredFps-(this.timeExpected-t))),this.timeExpected=t+this.timeToCall),this.advancedTiming&&this.updateAdvancedTiming(),this.game.paused||(this.events.update(this.time),this._timers.length&&this.updateTimers())},updateTimers:function(){for(var t=0,e=this._timers.length;t<e;)this._timers[t].update(this.time)?t++:(this._timers.splice(t,1),e--)},updateAdvancedTiming:function(){this._frameCount++,this._elapsedAccumulator+=this.elapsed,this._frameCount>=2*this._desiredFps&&(this.suggestedFps=5*Math.floor(200/(this._elapsedAccumulator/this._frameCount)),this._frameCount=0,this._elapsedAccumulator=0),this.msMin=Math.min(this.msMin,this.elapsed),this.msMax=Math.max(this.msMax,this.elapsed),this.frames++,this.now>this._timeLastSecond+1e3&&(this.fps=Math.round(1e3*this.frames/(this.now-this._timeLastSecond)),this.fpsMin=Math.min(this.fpsMin,this.fps),this.fpsMax=Math.max(this.fpsMax,this.fps),this._timeLastSecond=this.now,this.frames=0)},gamePaused:function(){this._pauseStarted=Date.now(),this.events.pause();for(var t=this._timers.length;t--;)this._timers[t]._pause()},gameResumed:function(){this.time=Date.now(),this.pauseDuration=this.time-this._pauseStarted,this.events.resume();for(var t=this._timers.length;t--;)this._timers[t]._resume()},totalElapsedSeconds:function(){return.001*(this.time-this._started)},elapsedSince:function(t){return this.time-t},elapsedSecondsSince:function(t){return.001*(this.time-t)},reset:function(){this._started=this.time,this.removeAll()}},Object.defineProperty(U.Time.prototype,"desiredFps",{get:function(){return this._desiredFps},set:function(t){this._desiredFps=t,this.physicsElapsed=1/t,this.physicsElapsedMS=1e3*this.physicsElapsed,this.desiredFpsMult=1/t}}),U.Time.prototype.constructor=U.Time,U.Timer=function(t,e){void 0===e&&(e=!0),this.game=t,this.running=!1,this.autoDestroy=e,this.expired=!1,this.elapsed=0,this.events=[],this.onComplete=new U.Signal,this.nextTick=0,this.timeCap=1e3,this.paused=!1,this._codePaused=!1,this._started=0,this._pauseStarted=0,this._pauseTotal=0,this._now=Date.now(),this._len=0,this._marked=0,this._i=0,this._diff=0,this._newTick=0},U.Timer.MINUTE=6e4,U.Timer.SECOND=1e3,U.Timer.HALF=500,U.Timer.QUARTER=250,U.Timer.prototype={create:function(t,e,i,n,r,o){var s=t=Math.round(t);0===this._now?s+=this.game.time.time:s+=this._now;o=new U.TimerEvent(this,t,s,i,e,n,r,o);return this.events.push(o),this.order(),this.expired=!1,o},add:function(t,e,i){return this.create(t,!1,0,e,i,Array.prototype.slice.call(arguments,3))},repeat:function(t,e,i,n){return this.create(t,!1,e,i,n,Array.prototype.slice.call(arguments,4))},loop:function(t,e,i){return this.create(t,!0,0,e,i,Array.prototype.slice.call(arguments,3))},start:function(t){if(!this.running){this._started=this.game.time.time+(t||0),this.running=!0;for(var e=0;e<this.events.length;e++)this.events[e].tick=this.events[e].delay+this._started}},stop:function(t){this.running=!1,(t=void 0===t?!0:t)&&(this.events.length=0)},remove:function(t){for(var e=0;e<this.events.length;e++)if(this.events[e]===t)return this.events[e].pendingDelete=!0;return!1},order:function(){0<this.events.length&&(this.events.sort(this.sortHandler),this.nextTick=this.events[0].tick)},sortHandler:function(t,e){return t.tick<e.tick?-1:t.tick>e.tick?1:0},clearPendingEvents:function(){for(this._i=this.events.length;this._i--;)this.events[this._i].pendingDelete&&this.events.splice(this._i,1);this._len=this.events.length,this._i=0},update:function(t){if(this.paused)return!0;if(this.elapsed=t-this._now,this._now=t,this.elapsed>this.timeCap&&this.adjustEvents(t-this.elapsed),this._marked=0,this.clearPendingEvents(),this.running&&this._now>=this.nextTick&&0<this._len){for(;this._i<this._len&&this.running&&this._now>=this.events[this._i].tick&&!this.events[this._i].pendingDelete;)this._newTick=this._now+this.events[this._i].delay-(this._now-this.events[this._i].tick),this._newTick<0&&(this._newTick=this._now+this.events[this._i].delay),!0===this.events[this._i].loop?this.events[this._i].tick=this._newTick:0<this.events[this._i].repeatCount?(this.events[this._i].repeatCount--,this.events[this._i].tick=this._newTick):(this._marked++,this.events[this._i].pendingDelete=!0),this.events[this._i].callback.apply(this.events[this._i].callbackContext,this.events[this._i].args),this._i++;this.events.length>this._marked?this.order():(this.expired=!0,this.onComplete.dispatch(this))}return!this.expired||!this.autoDestroy},pause:function(){this.running&&(this._codePaused=!0,this.paused||(this._pauseStarted=this.game.time.time,this.paused=!0))},_pause:function(){!this.paused&&this.running&&(this._pauseStarted=this.game.time.time,this.paused=!0)},adjustEvents:function(t){for(var e,i=0;i<this.events.length;i++)this.events[i].pendingDelete||((e=this.events[i].tick-t)<0&&(e=0),this.events[i].tick=this._now+e);var n=this.nextTick-t;this.nextTick=n<0?this._now:this._now+n},resume:function(){var t;this.paused&&(t=this.game.time.time,this._pauseTotal+=t-this._now,this._now=t,this.adjustEvents(this._pauseStarted),this.paused=!1,this._codePaused=!1)},_resume:function(){this._codePaused||this.resume()},removeAll:function(){this.onComplete.removeAll(),this.events.length=0,this._len=0,this._i=0},destroy:function(){this.onComplete.removeAll(),this.running=!1,this.events=[],this._len=0,this._i=0}},Object.defineProperty(U.Timer.prototype,"next",{get:function(){return this.nextTick}}),Object.defineProperty(U.Timer.prototype,"duration",{get:function(){return this.running&&this.nextTick>this._now?this.nextTick-this._now:0}}),Object.defineProperty(U.Timer.prototype,"length",{get:function(){return this.events.length}}),Object.defineProperty(U.Timer.prototype,"ms",{get:function(){return this.running?this._now-this._started-this._pauseTotal:0}}),Object.defineProperty(U.Timer.prototype,"seconds",{get:function(){return this.running?.001*this.ms:0}}),U.Timer.prototype.constructor=U.Timer,U.TimerEvent=function(t,e,i,n,r,o,s,a){this.timer=t,this.delay=e,this.tick=i,this.repeatCount=n-1,this.loop=r,this.callback=o,this.callbackContext=s,this.args=a,this.pendingDelete=!1},U.TimerEvent.prototype.constructor=U.TimerEvent,U.AnimationManager=function(t){this.sprite=t,this.game=t.game,this.currentFrame=null,this.currentAnim=null,this.updateIfVisible=!0,this.isLoaded=!1,this._frameData=null,this._anims={},this._outputFrames=[]},U.AnimationManager.prototype={loadFrameData:function(t,e){if(void 0===t)return!1;if(this.isLoaded)for(var i in this._anims)this._anims[i].updateFrameData(t);return this._frameData=t,null==e?this.frame=0:"string"==typeof e?this.frameName=e:this.frame=e,this.isLoaded=!0},copyFrameData:function(t,e){if(this._frameData=t.clone(),this.isLoaded)for(var i in this._anims)this._anims[i].updateFrameData(this._frameData);return null==e?this.frame=0:"string"==typeof e?this.frameName=e:this.frame=e,this.isLoaded=!0},add:function(t,e,i,n,r){return e=e||[],i=i||60,void 0===n&&(n=!1),void 0===r&&(r=!(!e||"number"!=typeof e[0])),this._outputFrames=[],this._frameData.getFrameIndexes(e,r,this._outputFrames),this._anims[t]=new U.Animation(this.game,this.sprite,t,this._frameData,this._outputFrames,i,n),this.currentAnim=this._anims[t],this.sprite.tilingTexture&&(this.sprite.refreshTexture=!0),this._anims[t]},validateFrames:function(t,e){void 0===e&&(e=!0);for(var i=0;i<t.length;i++)if(!0===e){if(t[i]>this._frameData.total)return!1}else if(!1===this._frameData.checkFrameName(t[i]))return!1;return!0},play:function(t,e,i,n){if(this._anims[t])return this.currentAnim===this._anims[t]?!1===this.currentAnim.isPlaying?(this.currentAnim.paused=!1,this.currentAnim.play(e,i,n)):this.currentAnim:(this.currentAnim&&this.currentAnim.isPlaying&&this.currentAnim.stop(),this.currentAnim=this._anims[t],this.currentAnim.paused=!1,this.currentFrame=this.currentAnim.currentFrame,this.currentAnim.play(e,i,n))},stop:function(t,e){void 0===e&&(e=!1),!this.currentAnim||"string"==typeof t&&t!==this.currentAnim.name||this.currentAnim.stop(e)},update:function(){return!(this.updateIfVisible&&!this.sprite.visible||!this.currentAnim||!this.currentAnim.update()||(this.currentFrame=this.currentAnim.currentFrame,0))},next:function(t){this.currentAnim&&(this.currentAnim.next(t),this.currentFrame=this.currentAnim.currentFrame)},previous:function(t){this.currentAnim&&(this.currentAnim.previous(t),this.currentFrame=this.currentAnim.currentFrame)},getAnimation:function(t){return"string"==typeof t&&this._anims[t]?this._anims[t]:null},refreshFrame:function(){},destroy:function(){var t=null;for(t in this._anims)this._anims.hasOwnProperty(t)&&this._anims[t].destroy();this._anims={},this._outputFrames=[],this._frameData=null,this.currentAnim=null,this.currentFrame=null,this.sprite=null,this.game=null}},U.AnimationManager.prototype.constructor=U.AnimationManager,Object.defineProperty(U.AnimationManager.prototype,"frameData",{get:function(){return this._frameData}}),Object.defineProperty(U.AnimationManager.prototype,"frameTotal",{get:function(){return this._frameData.total}}),Object.defineProperty(U.AnimationManager.prototype,"paused",{get:function(){return this.currentAnim.isPaused},set:function(t){this.currentAnim.paused=t}}),Object.defineProperty(U.AnimationManager.prototype,"name",{get:function(){if(this.currentAnim)return this.currentAnim.name}}),Object.defineProperty(U.AnimationManager.prototype,"frame",{get:function(){if(this.currentFrame)return this.currentFrame.index},set:function(t){"number"==typeof t&&this._frameData&&null!==this._frameData.getFrame(t)&&(this.currentFrame=this._frameData.getFrame(t),this.currentFrame&&this.sprite.setFrame(this.currentFrame))}}),Object.defineProperty(U.AnimationManager.prototype,"frameName",{get:function(){if(this.currentFrame)return this.currentFrame.name},set:function(t){"string"==typeof t&&this._frameData&&null!==this._frameData.getFrameByName(t)&&(this.currentFrame=this._frameData.getFrameByName(t),this.currentFrame&&(this._frameIndex=this.currentFrame.index,this.sprite.setFrame(this.currentFrame)))}}),U.Animation=function(t,e,i,n,r,o,s){void 0===s&&(s=!1),this.game=t,this._parent=e,this._frameData=n,this.name=i,this._frames=[],this._frames=this._frames.concat(r),this.delay=1e3/o,this.loop=s,this.loopCount=0,this.killOnComplete=!1,this.isFinished=!1,this.isPlaying=!1,this.isPaused=!1,this._pauseStartTime=0,this._frameIndex=0,this._frameDiff=0,this._frameSkip=1,this.currentFrame=this._frameData.getFrame(this._frames[this._frameIndex]),this.onStart=new U.Signal,this.onUpdate=null,this.onComplete=new U.Signal,this.onLoop=new U.Signal,this.isReversed=!1,this.game.onPause.add(this.onPause,this),this.game.onResume.add(this.onResume,this)},U.Animation.prototype={play:function(t,e,i){return"number"==typeof t&&(this.delay=1e3/t),"boolean"==typeof e&&(this.loop=e),void 0!==i&&(this.killOnComplete=i),this.isPlaying=!0,this.isFinished=!1,this.paused=!1,this.loopCount=0,this._timeLastFrame=this.game.time.time,this._timeNextFrame=this.game.time.time+this.delay,this._frameIndex=this.isReversed?this._frames.length-1:0,this.updateCurrentFrame(!1,!0),this._parent.events.onAnimationStart$dispatch(this._parent,this),this.onStart.dispatch(this._parent,this),(this._parent.animations.currentAnim=this)._parent.animations.currentFrame=this.currentFrame,this},restart:function(){this.isPlaying=!0,this.isFinished=!1,this.paused=!1,this.loopCount=0,this._timeLastFrame=this.game.time.time,this._timeNextFrame=this.game.time.time+this.delay,this._frameIndex=0,this.currentFrame=this._frameData.getFrame(this._frames[this._frameIndex]),this._parent.setFrame(this.currentFrame),(this._parent.animations.currentAnim=this)._parent.animations.currentFrame=this.currentFrame,this.onStart.dispatch(this._parent,this)},reverse:function(){return this.reversed=!this.reversed,this},reverseOnce:function(){return this.onComplete.addOnce(this.reverse,this),this.reverse()},setFrame:function(t,e){var i;if(void 0===e&&(e=!1),"string"==typeof t)for(var n=0;n<this._frames.length;n++)this._frameData.getFrame(this._frames[n]).name===t&&(i=n);else if("number"==typeof t)if(e)i=t;else for(n=0;n<this._frames.length;n++)this._frames[n]===t&&(i=n);i&&(this._frameIndex=i-1,this._timeNextFrame=this.game.time.time,this.update())},stop:function(t,e){void 0===t&&(t=!1),void 0===e&&(e=!1),this.isPlaying=!1,this.isFinished=!0,this.paused=!1,t&&(this.currentFrame=this._frameData.getFrame(this._frames[0]),this._parent.setFrame(this.currentFrame)),e&&(this._parent.events.onAnimationComplete$dispatch(this._parent,this),this.onComplete.dispatch(this._parent,this))},onPause:function(){this.isPlaying&&(this._frameDiff=this._timeNextFrame-this.game.time.time)},onResume:function(){this.isPlaying&&(this._timeNextFrame=this.game.time.time+this._frameDiff)},update:function(){return!this.isPaused&&!!(this.isPlaying&&this.game.time.time>=this._timeNextFrame)&&(this._frameSkip=1,this._frameDiff=this.game.time.time-this._timeNextFrame,this._timeLastFrame=this.game.time.time,this._frameDiff>this.delay&&(this._frameSkip=Math.floor(this._frameDiff/this.delay),this._frameDiff-=this._frameSkip*this.delay),this._timeNextFrame=this.game.time.time+(this.delay-this._frameDiff),this.isReversed?this._frameIndex-=this._frameSkip:this._frameIndex+=this._frameSkip,!this.isReversed&&this._frameIndex>=this._frames.length||this.isReversed&&this._frameIndex<=-1?this.loop?(this._frameIndex=Math.abs(this._frameIndex)%this._frames.length,this.isReversed&&(this._frameIndex=this._frames.length-1-this._frameIndex),this.currentFrame=this._frameData.getFrame(this._frames[this._frameIndex]),this.currentFrame&&this._parent.setFrame(this.currentFrame),this.loopCount++,this._parent.events.onAnimationLoop$dispatch(this._parent,this),this.onLoop.dispatch(this._parent,this),!this.onUpdate||(this.onUpdate.dispatch(this,this.currentFrame),!!this._frameData)):(this.complete(),!1):this.updateCurrentFrame(!0))},updateCurrentFrame:function(t,e){if(void 0===e&&(e=!1),!this._frameData)return!1;var i=this.currentFrame.index;return this.currentFrame=this._frameData.getFrame(this._frames[this._frameIndex]),this.currentFrame&&(e||!e&&i!==this.currentFrame.index)&&this._parent.setFrame(this.currentFrame),!this.onUpdate||!t||(this.onUpdate.dispatch(this,this.currentFrame),!!this._frameData)},next:function(t){t=this._frameIndex+(t=void 0===t?1:t);t>=this._frames.length&&(this.loop?t%=this._frames.length:t=this._frames.length-1),t!==this._frameIndex&&(this._frameIndex=t,this.updateCurrentFrame(!0))},previous:function(t){t=this._frameIndex-(t=void 0===t?1:t);t<0&&(this.loop?t=this._frames.length+t:t++),t!==this._frameIndex&&(this._frameIndex=t,this.updateCurrentFrame(!0))},updateFrameData:function(t){this._frameData=t,this.currentFrame=this._frameData?this._frameData.getFrame(this._frames[this._frameIndex%this._frames.length]):null},destroy:function(){this._frameData&&(this.game.onPause.remove(this.onPause,this),this.game.onResume.remove(this.onResume,this),this.game=null,this._parent=null,this._frames=null,this._frameData=null,this.currentFrame=null,this.isPlaying=!1,this.onStart.dispose(),this.onLoop.dispose(),this.onComplete.dispose(),this.onUpdate&&this.onUpdate.dispose())},complete:function(){this._frameIndex=this._frames.length-1,this.currentFrame=this._frameData.getFrame(this._frames[this._frameIndex]),this.isPlaying=!1,this.isFinished=!0,this.paused=!1,this._parent.events.onAnimationComplete$dispatch(this._parent,this),this.onComplete.dispatch(this._parent,this),this.killOnComplete&&this._parent.kill()}},U.Animation.prototype.constructor=U.Animation,Object.defineProperty(U.Animation.prototype,"paused",{get:function(){return this.isPaused},set:function(t){(this.isPaused=t)?this._pauseStartTime=this.game.time.time:this.isPlaying&&(this._timeNextFrame=this.game.time.time+this.delay)}}),Object.defineProperty(U.Animation.prototype,"reversed",{get:function(){return this.isReversed},set:function(t){this.isReversed=t}}),Object.defineProperty(U.Animation.prototype,"frameTotal",{get:function(){return this._frames.length}}),Object.defineProperty(U.Animation.prototype,"frame",{get:function(){return null!==this.currentFrame?this.currentFrame.index:this._frameIndex},set:function(t){this.currentFrame=this._frameData.getFrame(this._frames[t]),null!==this.currentFrame&&(this._frameIndex=t,this._parent.setFrame(this.currentFrame),this.onUpdate&&this.onUpdate.dispatch(this,this.currentFrame))}}),Object.defineProperty(U.Animation.prototype,"speed",{get:function(){return 1e3/this.delay},set:function(t){0<t&&(this.delay=1e3/t)}}),Object.defineProperty(U.Animation.prototype,"enableUpdate",{get:function(){return null!==this.onUpdate},set:function(t){t&&null===this.onUpdate?this.onUpdate=new U.Signal:t||null===this.onUpdate||(this.onUpdate.dispose(),this.onUpdate=null)}}),U.Animation.generateFrameNames=function(t,e,i,n,r){void 0===n&&(n="");var o=[],s="";if(e<i)for(var a=e;a<=i;a++)s="number"==typeof r?U.Utils.pad(a.toString(),r,"0",1):a.toString(),o.push(s=t+s+n);else for(a=e;i<=a;a--)s="number"==typeof r?U.Utils.pad(a.toString(),r,"0",1):a.toString(),o.push(s=t+s+n);return o},U.Frame=function(t,e,i,n,r,o){this.index=t,this.x=e,this.y=i,this.width=n,this.height=r,this.name=o,this.centerX=Math.floor(n/2),this.centerY=Math.floor(r/2),this.distance=U.Math.distance(0,0,n,r),this.rotated=!1,this.rotationDirection="cw",this.trimmed=!1,this.sourceSizeW=n,this.sourceSizeH=r,this.spriteSourceSizeX=0,this.spriteSourceSizeY=0,this.spriteSourceSizeW=0,this.spriteSourceSizeH=0,this.right=this.x+this.width,this.bottom=this.y+this.height},U.Frame.prototype={resize:function(t,e){this.width=t,this.height=e,this.centerX=Math.floor(t/2),this.centerY=Math.floor(e/2),this.distance=U.Math.distance(0,0,t,e),this.sourceSizeW=t,this.sourceSizeH=e,this.right=this.x+t,this.bottom=this.y+e},setTrim:function(t,e,i,n,r,o,s){(this.trimmed=t)&&(this.sourceSizeW=e,this.sourceSizeH=i,this.centerX=Math.floor(e/2),this.centerY=Math.floor(i/2),this.spriteSourceSizeX=n,this.spriteSourceSizeY=r,this.spriteSourceSizeW=o,this.spriteSourceSizeH=s)},clone:function(){var t,e=new U.Frame(this.index,this.x,this.y,this.width,this.height,this.name);for(t in this)this.hasOwnProperty(t)&&(e[t]=this[t]);return e},getRect:function(t){return void 0===t?t=new U.Rectangle(this.x,this.y,this.width,this.height):t.setTo(this.x,this.y,this.width,this.height),t}},U.Frame.prototype.constructor=U.Frame,U.FrameData=function(){this._frames=[],this._frameNames=[]},U.FrameData.prototype={addFrame:function(t){return t.index=this._frames.length,this._frames.push(t),""!==t.name&&(this._frameNames[t.name]=t.index),t},getFrame:function(t){return t>=this._frames.length&&(t=0),this._frames[t]},getFrameByName:function(t){return"number"==typeof this._frameNames[t]?this._frames[this._frameNames[t]]:null},checkFrameName:function(t){return null!=this._frameNames[t]},clone:function(){for(var t,e=new U.FrameData,i=0;i<this._frames.length;i++)e._frames.push(this._frames[i].clone());for(t in this._frameNames)this._frameNames.hasOwnProperty(t)&&e._frameNames.push(this._frameNames[t]);return e},getFrameRange:function(t,e,i){void 0===i&&(i=[]);for(var n=t;n<=e;n++)i.push(this._frames[n]);return i},getFrames:function(t,e,i){if(void 0===e&&(e=!0),void 0===i&&(i=[]),void 0===t||0===t.length)for(var n=0;n<this._frames.length;n++)i.push(this._frames[n]);else for(n=0;n<t.length;n++)e?i.push(this.getFrame(t[n])):i.push(this.getFrameByName(t[n]));return i},getFrameIndexes:function(t,e,i){if(void 0===e&&(e=!0),void 0===i&&(i=[]),void 0===t||0===t.length)for(var n=0;n<this._frames.length;n++)i.push(this._frames[n].index);else for(n=0;n<t.length;n++)e&&this._frames[t[n]]?i.push(this._frames[t[n]].index):this.getFrameByName(t[n])&&i.push(this.getFrameByName(t[n]).index);return i},destroy:function(){this._frames=null,this._frameNames=null}},U.FrameData.prototype.constructor=U.FrameData,Object.defineProperty(U.FrameData.prototype,"total",{get:function(){return this._frames.length}}),U.AnimationParser={spriteSheet:function(t,e,i,n,r,o,s){var a=e;if(null===(a="string"==typeof e?t.cache.getImage(e):a))return null;var h=a.width,t=a.height;i<=0&&(i=Math.floor(-h/Math.min(-1,i))),n<=0&&(n=Math.floor(-t/Math.min(-1,n)));var e=Math.floor((h-o)/(i+s)),a=Math.floor((t-o)/(n+s)),l=-1!==r?r:e*a;if(0===h||0===t||h<i||t<n||0===l)return null;for(var p=new U.FrameData,u=o,d=o,c=0;c<l;c++)p.addFrame(new U.Frame(c,u,d,i,n,"")),(u+=i+s)+i>h&&(u=o,d+=n+s);return p},JSONData:function(t,e){if(e.frames){for(var i,n=new U.FrameData,r=e.frames,o=0;o<r.length;o++)i=n.addFrame(new U.Frame(o,r[o].frame.x,r[o].frame.y,r[o].frame.w,r[o].frame.h,r[o].filename)),r[o].trimmed&&i.setTrim(r[o].trimmed,r[o].sourceSize.w,r[o].sourceSize.h,r[o].spriteSourceSize.x,r[o].spriteSourceSize.y,r[o].spriteSourceSize.w,r[o].spriteSourceSize.h);return n}},JSONDataPyxel:function(t,e){if(["layers","tilewidth","tileheight","tileswide","tileshigh"].forEach(function(t){e[t]}),1===e.layers.length){for(var i=new U.FrameData,n=e.tileheight,r=e.tilewidth,o=e.layers[0].tiles,s=0;s<o.length;s++)i.addFrame(new U.Frame(s,o[s].x,o[s].y,r,n,"frame_"+s)).setTrim(!1);return i}},JSONDataHash:function(t,e){if(e.frames){var i,n,r=new U.FrameData,o=e.frames,s=0;for(n in o)i=r.addFrame(new U.Frame(s,o[n].frame.x,o[n].frame.y,o[n].frame.w,o[n].frame.h,n)),o[n].trimmed&&i.setTrim(o[n].trimmed,o[n].sourceSize.w,o[n].sourceSize.h,o[n].spriteSourceSize.x,o[n].spriteSourceSize.y,o[n].spriteSourceSize.w,o[n].spriteSourceSize.h),s++;return r}},XMLData:function(t,e){if(e.getElementsByTagName("TextureAtlas")){for(var i,n,r,o,s,a,h,l,p,u,d=new U.FrameData,c=e.getElementsByTagName("SubTexture"),y=0;y<c.length;y++)i=(n=c[y].attributes).name.value,r=parseInt(n.x.value,10),o=parseInt(n.y.value,10),s=parseInt(n.width.value,10),a=parseInt(n.height.value,10),l=h=null,n.frameX&&(h=Math.abs(parseInt(n.frameX.value,10)),l=Math.abs(parseInt(n.frameY.value,10)),p=parseInt(n.frameWidth.value,10),u=parseInt(n.frameHeight.value,10)),i=d.addFrame(new U.Frame(y,r,o,s,a,i)),null===h&&null===l||i.setTrim(!0,s,a,h,l,p,u);return d}}},U.Cache=function(t){this.game=t,this.autoResolveURL=!1,this._cache={canvas:{},image:{},texture:{},sound:{},video:{},text:{},json:{},xml:{},physics:{},tilemap:{},binary:{},bitmapData:{},bitmapFont:{},shader:{},renderTexture:{}},this._urlMap={},this._urlResolver=new Image,this._urlTemp=null,this.onSoundUnlock=new U.Signal,this._cacheMap=[],this._cacheMap[U.Cache.CANVAS]=this._cache.canvas,this._cacheMap[U.Cache.IMAGE]=this._cache.image,this._cacheMap[U.Cache.TEXTURE]=this._cache.texture,this._cacheMap[U.Cache.SOUND]=this._cache.sound,this._cacheMap[U.Cache.TEXT]=this._cache.text,this._cacheMap[U.Cache.PHYSICS]=this._cache.physics,this._cacheMap[U.Cache.TILEMAP]=this._cache.tilemap,this._cacheMap[U.Cache.BINARY]=this._cache.binary,this._cacheMap[U.Cache.BITMAPDATA]=this._cache.bitmapData,this._cacheMap[U.Cache.BITMAPFONT]=this._cache.bitmapFont,this._cacheMap[U.Cache.JSON]=this._cache.json,this._cacheMap[U.Cache.XML]=this._cache.xml,this._cacheMap[U.Cache.VIDEO]=this._cache.video,this._cacheMap[U.Cache.SHADER]=this._cache.shader,this._cacheMap[U.Cache.RENDER_TEXTURE]=this._cache.renderTexture,this.addDefaultImage(),this.addMissingImage()},U.Cache.CANVAS=1,U.Cache.IMAGE=2,U.Cache.TEXTURE=3,U.Cache.SOUND=4,U.Cache.TEXT=5,U.Cache.PHYSICS=6,U.Cache.TILEMAP=7,U.Cache.BINARY=8,U.Cache.BITMAPDATA=9,U.Cache.BITMAPFONT=10,U.Cache.JSON=11,U.Cache.XML=12,U.Cache.VIDEO=13,U.Cache.SHADER=14,U.Cache.RENDER_TEXTURE=15,U.Cache.DEFAULT=null,U.Cache.MISSING=null,U.Cache.prototype={addCanvas:function(t,e,i){void 0===i&&(i=e.getContext("2d")),this._cache.canvas[t]={canvas:e,context:i}},addImage:function(t,e,i){this.checkImageKey(t)&&this.removeImage(t);var n={key:t,url:e,data:i,base:new PIXI.BaseTexture(i),frame:new U.Frame(0,0,0,i.width,i.height,t),frameData:new U.FrameData};return n.frameData.addFrame(new U.Frame(0,0,0,i.width,i.height,e)),this._cache.image[t]=n,this._resolveURL(e,n),"__default"===t?U.Cache.DEFAULT=new PIXI.Texture(n.base):"__missing"===t&&(U.Cache.MISSING=new PIXI.Texture(n.base)),n},addDefaultImage:function(){var t=new Image;t.src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgAQMAAABJtOi3AAAAA1BMVEX///+nxBvIAAAAAXRSTlMAQObYZgAAABVJREFUeF7NwIEAAAAAgKD9qdeocAMAoAABm3DkcAAAAABJRU5ErkJggg==";t=this.addImage("__default",null,t);t.base.skipRender=!0,U.Cache.DEFAULT=new PIXI.Texture(t.base)},addMissingImage:function(){var t=new Image;t.src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAIAAAD8GO2jAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAJ9JREFUeNq01ssOwyAMRFG46v//Mt1ESmgh+DFmE2GPOBARKb2NVjo+17PXLD8a1+pl5+A+wSgFygymWYHBb0FtsKhJDdZlncG2IzJ4ayoMDv20wTmSMzClEgbWYNTAkQ0Z+OJ+A/eWnAaR9+oxCF4Os0H8htsMUp+pwcgBBiMNnAwF8GqIgL2hAzaGFFgZauDPKABmowZ4GL369/0rwACp2yA/ttmvsQAAAABJRU5ErkJggg==";t=this.addImage("__missing",null,t);U.Cache.MISSING=new PIXI.Texture(t.base)},addSound:function(t,e,i,n,r){var o=(r=void 0===(r=void 0===n?!(n=!0):r)?!(n=!1):r)?!0:!1;this._cache.sound[t]={url:e,data:i,isDecoding:!1,decoded:o,webAudio:n,audioTag:r,locked:this.game.sound.touchLocked},this._resolveURL(e,this._cache.sound[t])},addText:function(t,e,i){this._cache.text[t]={url:e,data:i},this._resolveURL(e,this._cache.text[t])},addPhysicsData:function(t,e,i,n){this._cache.physics[t]={url:e,data:i,format:n},this._resolveURL(e,this._cache.physics[t])},addTilemap:function(t,e,i,n){this._cache.tilemap[t]={url:e,data:i,format:n},this._resolveURL(e,this._cache.tilemap[t])},addBinary:function(t,e){this._cache.binary[t]=e},addBitmapData:function(t,e,i){return e.key=t,void 0===i&&(i=new U.FrameData).addFrame(e.textureFrame),this._cache.bitmapData[t]={data:e,frameData:i},e},addBitmapFont:function(t,e,i,n,r,o,s){i={url:e,data:i,font:null,base:new PIXI.BaseTexture(i)};void 0===o&&(o=0),void 0===s&&(s=0),i.font="json"===r?U.LoaderParser.jsonBitmapFont(n,i.base,o,s):U.LoaderParser.xmlBitmapFont(n,i.base,o,s),this._cache.bitmapFont[t]=i,this._resolveURL(e,i)},addJSON:function(t,e,i){this._cache.json[t]={url:e,data:i},this._resolveURL(e,this._cache.json[t])},addXML:function(t,e,i){this._cache.xml[t]={url:e,data:i},this._resolveURL(e,this._cache.xml[t])},addVideo:function(t,e,i,n){this._cache.video[t]={url:e,data:i,isBlob:n,locked:!0},this._resolveURL(e,this._cache.video[t])},addShader:function(t,e,i){this._cache.shader[t]={url:e,data:i},this._resolveURL(e,this._cache.shader[t])},addRenderTexture:function(t,e){this._cache.renderTexture[t]={texture:e,frame:new U.Frame(0,0,0,e.width,e.height,"","")}},addSpriteSheet:function(t,e,i,n,r,o,s,a){void 0===o&&(o=-1);a={key:t,url:e,data:i,frameWidth:n,frameHeight:r,margin:s=void 0===s?0:s,spacing:a=void 0===a?0:a,base:new PIXI.BaseTexture(i),frameData:U.AnimationParser.spriteSheet(this.game,i,n,r,o,s,a)};this._cache.image[t]=a,this._resolveURL(e,a)},addTextureAtlas:function(t,e,i,n,r){i={key:t,url:e,data:i,base:new PIXI.BaseTexture(i)};r===U.Loader.TEXTURE_ATLAS_XML_STARLING?i.frameData=U.AnimationParser.XMLData(this.game,n,t):r===U.Loader.TEXTURE_ATLAS_JSON_PYXEL?i.frameData=U.AnimationParser.JSONDataPyxel(this.game,n,t):Array.isArray(n.frames)?i.frameData=U.AnimationParser.JSONData(this.game,n,t):i.frameData=U.AnimationParser.JSONDataHash(this.game,n,t),this._cache.image[t]=i,this._resolveURL(e,i)},reloadSound:function(t){var e=this,i=this.getSound(t);i&&(i.data.src=i.url,i.data.addEventListener("canplaythrough",function(){return e.reloadSoundComplete(t)},!1),i.data.load())},reloadSoundComplete:function(t){var e=this.getSound(t);e&&(e.locked=!1,this.onSoundUnlock.dispatch(t))},updateSound:function(t,e,i){t=this.getSound(t);t&&(t[e]=i)},decodedSound:function(t,e){t=this.getSound(t);t.data=e,t.decoded=!0,t.isDecoding=!1},isSoundDecoded:function(t){t=this.getItem(t,U.Cache.SOUND,"isSoundDecoded");if(t)return t.decoded},isSoundReady:function(t){t=this.getItem(t,U.Cache.SOUND,"isSoundDecoded");if(t)return t.decoded&&!this.game.sound.touchLocked},checkKey:function(t,e){return!!this._cacheMap[t][e]},checkURL:function(t){return!!this._urlMap[this._resolveURL(t)]},checkCanvasKey:function(t){return this.checkKey(U.Cache.CANVAS,t)},checkImageKey:function(t){return this.checkKey(U.Cache.IMAGE,t)},checkTextureKey:function(t){return this.checkKey(U.Cache.TEXTURE,t)},checkSoundKey:function(t){return this.checkKey(U.Cache.SOUND,t)},checkTextKey:function(t){return this.checkKey(U.Cache.TEXT,t)},checkPhysicsKey:function(t){return this.checkKey(U.Cache.PHYSICS,t)},checkTilemapKey:function(t){return this.checkKey(U.Cache.TILEMAP,t)},checkBinaryKey:function(t){return this.checkKey(U.Cache.BINARY,t)},checkBitmapDataKey:function(t){return this.checkKey(U.Cache.BITMAPDATA,t)},checkBitmapFontKey:function(t){return this.checkKey(U.Cache.BITMAPFONT,t)},checkJSONKey:function(t){return this.checkKey(U.Cache.JSON,t)},checkXMLKey:function(t){return this.checkKey(U.Cache.XML,t)},checkVideoKey:function(t){return this.checkKey(U.Cache.VIDEO,t)},checkShaderKey:function(t){return this.checkKey(U.Cache.SHADER,t)},checkRenderTextureKey:function(t){return this.checkKey(U.Cache.RENDER_TEXTURE,t)},getItem:function(t,e,i,n){return this.checkKey(e,t)?void 0===n?this._cacheMap[e][t]:this._cacheMap[e][t][n]:null},getCanvas:function(t){return this.getItem(t,U.Cache.CANVAS,"getCanvas","canvas")},getImage:function(t,e){void 0===e&&(e=!1);t=this.getItem(t=null==t?"__default":t,U.Cache.IMAGE,"getImage");return null===t&&(t=this.getItem("__missing",U.Cache.IMAGE,"getImage")),e?t:t.data},getTextureFrame:function(t){return this.getItem(t,U.Cache.TEXTURE,"getTextureFrame","frame")},getSound:function(t){return this.getItem(t,U.Cache.SOUND,"getSound")},getSoundData:function(t){return this.getItem(t,U.Cache.SOUND,"getSoundData","data")},getText:function(t){return this.getItem(t,U.Cache.TEXT,"getText","data")},getPhysicsData:function(t,e,i){t=this.getItem(t,U.Cache.PHYSICS,"getPhysicsData","data");if(null===t||null==e)return t;if(t[e]){var n,r=t[e];if(!r||!i)return r;for(n in r)if(n=r[n],n.fixtureKey===i)return n}return null},getTilemapData:function(t){return this.getItem(t,U.Cache.TILEMAP,"getTilemapData")},getBinary:function(t){return this.getItem(t,U.Cache.BINARY,"getBinary")},getBitmapData:function(t){return this.getItem(t,U.Cache.BITMAPDATA,"getBitmapData","data")},getBitmapFont:function(t){return this.getItem(t,U.Cache.BITMAPFONT,"getBitmapFont")},getJSON:function(t,e){t=this.getItem(t,U.Cache.JSON,"getJSON","data");return t?e?U.Utils.extend(!0,Array.isArray(t)?[]:{},t):t:null},getXML:function(t){return this.getItem(t,U.Cache.XML,"getXML","data")},getVideo:function(t){return this.getItem(t,U.Cache.VIDEO,"getVideo")},getShader:function(t){return this.getItem(t,U.Cache.SHADER,"getShader","data")},getRenderTexture:function(t){return this.getItem(t,U.Cache.RENDER_TEXTURE,"getRenderTexture")},getBaseTexture:function(t,e){return void 0===e&&(e=U.Cache.IMAGE),this.getItem(t,e,"getBaseTexture","base")},getFrame:function(t,e){return void 0===e&&(e=U.Cache.IMAGE),this.getItem(t,e,"getFrame","frame")},getFrameCount:function(t,e){e=this.getFrameData(t,e);return e?e.total:0},getFrameData:function(t,e){return void 0===e&&(e=U.Cache.IMAGE),this.getItem(t,e,"getFrameData","frameData")},hasFrameData:function(t,e){return void 0===e&&(e=U.Cache.IMAGE),null!==this.getItem(t,e,"","frameData")},updateFrameData:function(t,e,i){void 0===i&&(i=U.Cache.IMAGE),this._cacheMap[i][t]&&(this._cacheMap[i][t].frameData=e)},getFrameByIndex:function(t,e,i){i=this.getFrameData(t,i);return i?i.getFrame(e):null},getFrameByName:function(t,e,i){i=this.getFrameData(t,i);return i?i.getFrameByName(e):null},getURL:function(t){return(t=this._resolveURL(t))?this._urlMap[t]:null},getKeys:function(t){void 0===t&&(t=U.Cache.IMAGE);var e=[];if(this._cacheMap[t])for(var i in this._cacheMap[t])"__default"!==i&&"__missing"!==i&&e.push(i);return e},removeCanvas:function(t){delete this._cache.canvas[t]},removeImage:function(t,e){void 0===e&&(e=!0);var i=this.getImage(t,!0);e&&i.base&&i.base.destroy(),delete this._cache.image[t]},removeSound:function(t){delete this._cache.sound[t]},removeText:function(t){delete this._cache.text[t]},removePhysics:function(t){delete this._cache.physics[t]},removeTilemap:function(t){delete this._cache.tilemap[t]},removeBinary:function(t){delete this._cache.binary[t]},removeBitmapData:function(t){delete this._cache.bitmapData[t]},removeBitmapFont:function(t){delete this._cache.bitmapFont[t]},removeJSON:function(t){delete this._cache.json[t]},removeXML:function(t){delete this._cache.xml[t]},removeVideo:function(t){delete this._cache.video[t]},removeShader:function(t){delete this._cache.shader[t]},removeRenderTexture:function(t){delete this._cache.renderTexture[t]},removeSpriteSheet:function(t){delete this._cache.spriteSheet[t]},removeTextureAtlas:function(t){delete this._cache.atlas[t]},clearGLTextures:function(){for(var t in this._cache.image)this._cache.image[t].base._glTextures=[]},_resolveURL:function(t,e){return this.autoResolveURL?(this._urlResolver.src=this.game.load.baseURL+t,this._urlTemp=this._urlResolver.src,this._urlResolver.src="",e&&(this._urlMap[this._urlTemp]=e),this._urlTemp):null},destroy:function(){for(var t=0;t<this._cacheMap.length;t++){var e,i=this._cacheMap[t];for(e in i)"__default"!==e&&"__missing"!==e&&(i[e].destroy&&i[e].destroy(),delete i[e])}this._urlMap=null,this._urlResolver=null,this._urlTemp=null}},U.Cache.prototype.constructor=U.Cache,U.Loader=function(t){this.game=t,this.cache=t.cache,this.resetLocked=!1,this.isLoading=!1,this.hasLoaded=!1,this.preloadSprite=null,this.crossOrigin=!1,this.baseURL="",this.path="",this.headers={requestedWith:!1,json:"application/json",xml:"application/xml"},this.onLoadStart=new U.Signal,this.onLoadComplete=new U.Signal,this.onPackComplete=new U.Signal,this.onFileStart=new U.Signal,this.onFileComplete=new U.Signal,this.onFileError=new U.Signal,this.useXDomainRequest=!1,this._warnedAboutXDomainRequest=!1,this.enableParallel=!0,this.maxParallelDownloads=4,this._withSyncPointDepth=0,this._fileList=[],this._flightQueue=[],this._processingHead=0,this._fileLoadStarted=!1,this._totalPackCount=0,this._totalFileCount=0,this._loadedPackCount=0,this._loadedFileCount=0},U.Loader.TEXTURE_ATLAS_JSON_ARRAY=0,U.Loader.TEXTURE_ATLAS_JSON_HASH=1,U.Loader.TEXTURE_ATLAS_XML_STARLING=2,U.Loader.PHYSICS_LIME_CORONA_JSON=3,U.Loader.PHYSICS_PHASER_JSON=4,U.Loader.TEXTURE_ATLAS_JSON_PYXEL=5,U.Loader.prototype={setPreloadSprite:function(t,e){this.preloadSprite={sprite:t,direction:e=e||0,width:t.width,height:t.height,rect:null},this.preloadSprite.rect=0===e?new U.Rectangle(0,0,1,t.height):new U.Rectangle(0,0,t.width,1),t.crop(this.preloadSprite.rect),t.visible=!0},resize:function(){this.preloadSprite&&this.preloadSprite.height!==this.preloadSprite.sprite.height&&(this.preloadSprite.rect.height=this.preloadSprite.sprite.height)},checkKeyExists:function(t,e){return-1<this.getAssetIndex(t,e)},getAssetIndex:function(t,e){for(var i=-1,n=0;n<this._fileList.length;n++){var r=this._fileList[n];if(r.type===t&&r.key===e&&(i=n,!r.loaded&&!r.loading))break}return i},getAsset:function(t,e){e=this.getAssetIndex(t,e);return-1<e&&{index:e,file:this._fileList[e]}},reset:function(t,e){void 0===e&&(e=!1),this.resetLocked||(t&&(this.preloadSprite=null),this.isLoading=!1,this._processingHead=0,this._fileList.length=0,this._flightQueue.length=0,this._fileLoadStarted=!1,this._totalFileCount=0,this._totalPackCount=0,this._loadedPackCount=0,this._loadedFileCount=0,e&&(this.onLoadStart.removeAll(),this.onLoadComplete.removeAll(),this.onPackComplete.removeAll(),this.onFileStart.removeAll(),this.onFileComplete.removeAll(),this.onFileError.removeAll()))},addToFileList:function(t,e,i,n,r,o){if(void 0===r&&(r=!1),void 0===e||""===e)return this;if(null==i){if(!o)return this;i=e+o}var s={type:t,key:e,path:this.path,url:i,syncPoint:0<this._withSyncPointDepth,data:null,loading:!1,loaded:!1,error:!1};if(n)for(var a in n)s[a]=n[a];e=this.getAssetIndex(t,e);return r&&-1<e?(r=this._fileList[e]).loading||r.loaded?(this._fileList.push(s),this._totalFileCount++):this._fileList[e]=s:-1===e&&(this._fileList.push(s),this._totalFileCount++),this},replaceInFileList:function(t,e,i,n){return this.addToFileList(t,e,i,n,!0)},pack:function(t,e,i,n){if(void 0===i&&(i=null),!(e=void 0===e?null:e)&&!i)return this;var r={type:"packfile",key:t,url:e,path:this.path,syncPoint:!0,data:null,loading:!1,loaded:!1,error:!1,callbackContext:n=void 0===n?null:n};i&&("string"==typeof i&&(i=JSON.parse(i)),r.data=i||{},r.loaded=!0);for(var o=0;o<this._fileList.length+1;o++){var s=this._fileList[o];if(!s||!s.loaded&&!s.loading&&"packfile"!==s.type){this._fileList.splice(o,0,r),this._totalPackCount++;break}}return this},image:function(t,e,i){return this.addToFileList("image",t,e,void 0,i,".png")},images:function(t,e){if(Array.isArray(e))for(var i=0;i<t.length;i++)this.image(t[i],e[i]);else for(i=0;i<t.length;i++)this.image(t[i]);return this},text:function(t,e,i){return this.addToFileList("text",t,e,void 0,i,".txt")},json:function(t,e,i){return this.addToFileList("json",t,e,void 0,i,".json")},shader:function(t,e,i){return this.addToFileList("shader",t,e,void 0,i,".frag")},xml:function(t,e,i){return this.addToFileList("xml",t,e,void 0,i,".xml")},script:function(t,e,i,n){return this.addToFileList("script",t,e,{syncPoint:!0,callback:i=void 0===i?!1:i,callbackContext:n=!1!==i&&void 0===n?this:n},!1,".js")},binary:function(t,e,i,n){return!1!==(i=void 0===i?!1:i)&&void 0===n&&(n=i),this.addToFileList("binary",t,e,{callback:i,callbackContext:n},!1,".bin")},spritesheet:function(t,e,i,n,r,o,s){return this.addToFileList("spritesheet",t,e,{frameWidth:i,frameHeight:n,frameMax:r=void 0===r?-1:r,margin:o=void 0===o?0:o,spacing:s=void 0===s?0:s},!1,".png")},audio:function(t,e,i){return this.game.sound.noAudio?this:this.addToFileList("audio",t,e="string"==typeof e?[e]:e,{buffer:null,autoDecode:i=void 0===i?!0:i})},audioSprite:function(t,e,i,n,r){return this.game.sound.noAudio||(void 0===i&&(i=null),void 0===n&&(n=null),this.audio(t,e,r=void 0===r?!0:r),i?this.json(t+"-audioatlas",i):n&&("string"==typeof n&&(n=JSON.parse(n)),this.cache.addJSON(t+"-audioatlas","",n))),this},audiosprite:function(t,e,i,n,r){return this.audioSprite(t,e,i,n,r)},video:function(t,e,i,n){return void 0===i&&(i=this.game.device.firefox?"loadeddata":"canplaythrough"),this.addToFileList("video",t,e="string"==typeof e?[e]:e,{buffer:null,asBlob:n=void 0===n?!1:n,loadEvent:i})},tilemap:function(t,e,i,n){if(void 0===i&&(i=null),void 0===n&&(n=U.Tilemap.CSV),(e=void 0===e?null:e)||i||(e=n===U.Tilemap.CSV?t+".csv":t+".json"),i){switch(n){case U.Tilemap.CSV:break;case U.Tilemap.TILED_JSON:"string"==typeof i&&(i=JSON.parse(i))}this.cache.addTilemap(t,null,i,n)}else this.addToFileList("tilemap",t,e,{format:n});return this},physics:function(t,e,i,n){return void 0===i&&(i=null),void 0===n&&(n=U.Physics.LIME_CORONA_JSON),(e=void 0===e?null:e)||i||(e=t+".json"),i?("string"==typeof i&&(i=JSON.parse(i)),this.cache.addPhysicsData(t,null,i,n)):this.addToFileList("physics",t,e,{format:n}),this},bitmapFont:function(t,e,i,n,r,o){if(null!=e||(e=t+".png"),void 0===n&&(n=null),void 0===r&&(r=0),void 0===o&&(o=0),i=null===(i=void 0===i?null:i)&&null===n?t+".xml":i)this.addToFileList("bitmapfont",t,e,{atlasURL:i,xSpacing:r,ySpacing:o});else if("string"==typeof n){var s,a;try{s=JSON.parse(n)}catch(t){a=this.parseXml(n)}if(!a&&!s)throw new Error("Phaser.Loader. Invalid Bitmap Font atlas given");this.addToFileList("bitmapfont",t,e,{atlasURL:null,atlasData:s||a,atlasType:s?"json":"xml",xSpacing:r,ySpacing:o})}return this},atlasJSONArray:function(t,e,i,n){return this.atlas(t,e,i,n,U.Loader.TEXTURE_ATLAS_JSON_ARRAY)},atlasJSONHash:function(t,e,i,n){return this.atlas(t,e,i,n,U.Loader.TEXTURE_ATLAS_JSON_HASH)},atlasXML:function(t,e,i,n){return void 0===n&&(n=null),this.atlas(t,e,i=!(i=void 0===i?null:i)&&!n?t+".xml":i,n,U.Loader.TEXTURE_ATLAS_XML_STARLING)},atlas:function(t,e,i,n,r){if(null!=e||(e=t+".png"),void 0===n&&(n=null),void 0===r&&(r=U.Loader.TEXTURE_ATLAS_JSON_ARRAY),i=!(i=void 0===i?null:i)&&!n?r===U.Loader.TEXTURE_ATLAS_XML_STARLING?t+".xml":t+".json":i)this.addToFileList("textureatlas",t,e,{atlasURL:i,format:r});else{switch(r){case U.Loader.TEXTURE_ATLAS_JSON_ARRAY:"string"==typeof n&&(n=JSON.parse(n));break;case U.Loader.TEXTURE_ATLAS_XML_STARLING:if("string"==typeof n){var o=this.parseXml(n);if(!o)throw new Error("Phaser.Loader. Invalid Texture Atlas XML given");n=o}}this.addToFileList("textureatlas",t,e,{atlasURL:null,atlasData:n,format:r})}return this},withSyncPoint:function(t,e){this._withSyncPointDepth++;try{t.call(e||this,this)}finally{this._withSyncPointDepth--}return this},addSyncPoint:function(t,e){e=this.getAsset(t,e);return e&&(e.file.syncPoint=!0),this},removeFile:function(t,e){e=this.getAsset(t,e);e&&(e.loaded||e.loading||this._fileList.splice(e.index,1))},removeAll:function(){this._fileList.length=0,this._flightQueue.length=0},start:function(){this.isLoading||(this.hasLoaded=!1,this.isLoading=!0,this.updateProgress(),this.processLoadQueue())},processLoadQueue:function(){if(this.isLoading){for(var t=0;t<this._flightQueue.length;t++)((e=this._flightQueue[t]).loaded||e.error)&&(this._flightQueue.splice(t,1),t--,e.loading=!1,e.requestUrl=null,e.requestObject=null,e.error&&this.onFileError.dispatch(e.key,e),"packfile"!==e.type?(this._loadedFileCount++,this.onFileComplete.dispatch(this.progress,e.key,!e.error,this._loadedFileCount,this._totalFileCount)):"packfile"===e.type&&e.error&&(this._loadedPackCount++,this.onPackComplete.dispatch(e.key,!e.error,this._loadedPackCount,this._totalPackCount)));for(var e,i,n=!1,r=this.enableParallel?U.Math.clamp(this.maxParallelDownloads,1,12):1,t=this._processingHead;t<this._fileList.length;t++)if("packfile"===(e=this._fileList[t]).type&&!e.error&&e.loaded&&t===this._processingHead&&(this.processPack(e),this._loadedPackCount++,this.onPackComplete.dispatch(e.key,!e.error,this._loadedPackCount,this._totalPackCount)),e.loaded||e.error?t===this._processingHead&&(this._processingHead=t+1):!e.loading&&this._flightQueue.length<r&&("packfile"!==e.type||e.data?n||(this._fileLoadStarted||(this._fileLoadStarted=!0,this.onLoadStart.dispatch()),this._flightQueue.push(e),e.loading=!0,this.onFileStart.dispatch(this.progress,e.key,e.url),this.loadFile(e)):(this._flightQueue.push(e),e.loading=!0,this.loadFile(e))),!e.loaded&&e.syncPoint&&(n=!0),this._flightQueue.length>=r||n&&this._loadedPackCount===this._totalPackCount)break;this.updateProgress(),this._processingHead>=this._fileList.length?this.finishedLoading():this._flightQueue.length||(i=this,setTimeout(function(){i.finishedLoading(!0)},2e3))}else this.finishedLoading(!0)},finishedLoading:function(t){this.hasLoaded||(this.hasLoaded=!0,this.isLoading=!1,t||this._fileLoadStarted||(this._fileLoadStarted=!0,this.onLoadStart.dispatch()),this.onLoadComplete.dispatch(),this.game.state.loadComplete(),this.reset())},asyncComplete:function(t,e){void 0===e&&(e=""),t.loaded=!0,t.error=!!e,e&&(t.errorMessage=e),this.processLoadQueue()},processPack:function(t){var e=t.data[t.key];if(e)for(var i=0;i<e.length;i++){var n=e[i];switch(n.type){case"image":this.image(n.key,n.url,n.overwrite);break;case"text":this.text(n.key,n.url,n.overwrite);break;case"json":this.json(n.key,n.url,n.overwrite);break;case"xml":this.xml(n.key,n.url,n.overwrite);break;case"script":this.script(n.key,n.url,n.callback,t.callbackContext||this);break;case"binary":this.binary(n.key,n.url,n.callback,t.callbackContext||this);break;case"spritesheet":this.spritesheet(n.key,n.url,n.frameWidth,n.frameHeight,n.frameMax,n.margin,n.spacing);break;case"video":this.video(n.key,n.urls);break;case"audio":this.audio(n.key,n.urls,n.autoDecode);break;case"audiosprite":this.audiosprite(n.key,n.urls,n.jsonURL,n.jsonData,n.autoDecode);break;case"tilemap":this.tilemap(n.key,n.url,n.data,U.Tilemap[n.format]);break;case"physics":this.physics(n.key,n.url,n.data,U.Loader[n.format]);break;case"bitmapFont":this.bitmapFont(n.key,n.textureURL,n.atlasURL,n.atlasData,n.xSpacing,n.ySpacing);break;case"atlasJSONArray":this.atlasJSONArray(n.key,n.textureURL,n.atlasURL,n.atlasData);break;case"atlasJSONHash":this.atlasJSONHash(n.key,n.textureURL,n.atlasURL,n.atlasData);break;case"atlasXML":this.atlasXML(n.key,n.textureURL,n.atlasURL,n.atlasData);break;case"atlas":this.atlas(n.key,n.textureURL,n.atlasURL,n.atlasData,U.Loader[n.format]);break;case"shader":this.shader(n.key,n.url,n.overwrite)}}},transformUrl:function(t,e){return!!t&&(t.match(/^(?:blob:|data:|http:\/\/|https:\/\/|\/\/)/)?t:this.baseURL+e.path+t)},loadFile:function(t){switch(t.type){case"packfile":this.xhrLoad(t,this.transformUrl(t.url,t),"text",this.fileComplete);break;case"image":case"spritesheet":case"textureatlas":case"bitmapfont":this.loadImageTag(t);break;case"audio":t.url=this.getAudioURL(t.url),t.url?this.game.sound.usingWebAudio?this.xhrLoad(t,this.transformUrl(t.url,t),"arraybuffer",this.fileComplete):this.game.sound.usingAudioTag&&this.loadAudioTag(t):this.fileError(t,null,"No supported audio URL specified or device does not have audio playback support");break;case"video":t.url=this.getVideoURL(t.url),t.url?t.asBlob?this.xhrLoad(t,this.transformUrl(t.url,t),"blob",this.fileComplete):this.loadVideoTag(t):this.fileError(t,null,"No supported video URL specified or device does not have video playback support");break;case"json":this.xhrLoad(t,this.transformUrl(t.url,t),"text",this.jsonLoadComplete);break;case"xml":this.xhrLoad(t,this.transformUrl(t.url,t),"text",this.xmlLoadComplete);break;case"tilemap":t.format===U.Tilemap.TILED_JSON?this.xhrLoad(t,this.transformUrl(t.url,t),"text",this.jsonLoadComplete):t.format===U.Tilemap.CSV?this.xhrLoad(t,this.transformUrl(t.url,t),"text",this.csvLoadComplete):this.asyncComplete(t,"invalid Tilemap format: "+t.format);break;case"text":case"script":case"shader":case"physics":this.xhrLoad(t,this.transformUrl(t.url,t),"text",this.fileComplete);break;case"binary":this.xhrLoad(t,this.transformUrl(t.url,t),"arraybuffer",this.fileComplete)}},loadImageTag:function(t){var e=this;t.data=new Image,t.data.name=t.key,this.crossOrigin&&(t.data.crossOrigin=this.crossOrigin),t.data.onload=function(){t.data.onload&&(t.data.onload=null,t.data.onerror=null,e.fileComplete(t))},t.data.onerror=function(){t.data.onload&&(t.data.onload=null,t.data.onerror=null,e.fileError(t))},t.data.src=this.transformUrl(t.url,t),t.data.complete&&t.data.width&&t.data.height&&(t.data.onload=null,t.data.onerror=null,this.fileComplete(t))},loadVideoTag:function(t){var e=this;t.data=document.createElement("video"),t.data.name=t.key,t.data.controls=!1,t.data.autoplay=!1;var i=function(){t.data.removeEventListener(t.loadEvent,i,!1),t.data.onerror=null,t.data.canplay=!0,U.GAMES[e.game.id].load.fileComplete(t)};t.data.onerror=function(){t.data.removeEventListener(t.loadEvent,i,!1),t.data.onerror=null,t.data.canplay=!1,e.fileError(t)},t.data.addEventListener(t.loadEvent,i,!1),t.data.src=this.transformUrl(t.url,t),t.data.load()},loadAudioTag:function(t){var e,i=this;this.game.sound.touchLocked?(t.data=new Audio,t.data.name=t.key,t.data.preload="auto",t.data.src=this.transformUrl(t.url,t),this.fileComplete(t)):(t.data=new Audio,t.data.name=t.key,e=function(){t.data.removeEventListener("canplaythrough",e,!1),t.data.onerror=null,i.fileComplete(t)},t.data.onerror=function(){t.data.removeEventListener("canplaythrough",e,!1),t.data.onerror=null,i.fileError(t)},t.data.preload="auto",t.data.src=this.transformUrl(t.url,t),t.data.addEventListener("canplaythrough",e,!1),t.data.load())},xhrLoad:function(e,t,i,n,r){var o,s;this.useXDomainRequest&&window.XDomainRequest?this.xhrLoadWithXDR(e,t,i,n,r):((o=new XMLHttpRequest).open("GET",t,!0),o.responseType=i,!1!==this.headers.requestedWith&&o.setRequestHeader("X-Requested-With",this.headers.requestedWith),this.headers[e.type]&&o.setRequestHeader("Accept",this.headers[e.type]),r=r||this.fileError,s=this,o.onload=function(){try{return(4===o.readyState&&400<=o.status&&o.status<=599?r:n).call(s,e,o)}catch(t){s.hasLoaded?window.console:s.asyncComplete(e,t.message||"Exception")}},o.onerror=function(){try{return r.call(s,e,o)}catch(t){s.hasLoaded?window.console:s.asyncComplete(e,t.message||"Exception")}},e.requestObject=o,e.requestUrl=t,o.send())},xhrLoadWithXDR:function(e,t,i,n,r){this._warnedAboutXDomainRequest||this.game.device.ie&&!(10<=this.game.device.ieVersion)||(this._warnedAboutXDomainRequest=!0);var o=new window.XDomainRequest;o.open("GET",t,!0),o.responseType=i,o.timeout=3e3,r=r||this.fileError;var s=this;o.onerror=function(){try{return r.call(s,e,o)}catch(t){s.asyncComplete(e,t.message||"Exception")}},o.ontimeout=function(){try{return r.call(s,e,o)}catch(t){s.asyncComplete(e,t.message||"Exception")}},o.onprogress=function(){},o.onload=function(){try{return(4===o.readyState&&400<=o.status&&o.status<=599?r:n).call(s,e,o)}catch(t){s.asyncComplete(e,t.message||"Exception")}},e.requestObject=o,e.requestUrl=t,setTimeout(function(){o.send()},0)},getVideoURL:function(t){for(var e=0;e<t.length;e++){var i,n=t[e];if(n.uri){if(i=n.type,n=n.uri,this.game.device.canPlayVideo(i))return n}else{if(0===n.indexOf("blob:")||0===n.indexOf("data:"))return n;if(i=(n=0<=n.indexOf("?")?n.substr(0,n.indexOf("?")):n).substr((Math.max(0,n.lastIndexOf("."))||1/0)+1).toLowerCase(),this.game.device.canPlayVideo(i))return t[e]}}return null},getAudioURL:function(t){if(this.game.sound.noAudio)return null;for(var e=0;e<t.length;e++){var i,n=t[e];if(n.uri){if(i=n.type,n=n.uri,this.game.device.canPlayAudio(i))return n}else{if(0===n.indexOf("blob:")||0===n.indexOf("data:"))return n;if(i=(n=0<=n.indexOf("?")?n.substr(0,n.indexOf("?")):n).substr((Math.max(0,n.lastIndexOf("."))||1/0)+1).toLowerCase(),this.game.device.canPlayAudio(i))return t[e]}}return null},fileError:function(t,e,i){var n="error loading asset from URL "+(t.requestUrl||this.transformUrl(t.url,t));!i&&e&&(i=e.status),this.asyncComplete(t,n=i?n+" ("+i+")":n)},fileComplete:function(t,e){var i=!0;switch(t.type){case"packfile":var n=JSON.parse(e.responseText);t.data=n||{};break;case"image":this.cache.addImage(t.key,t.url,t.data);break;case"spritesheet":this.cache.addSpriteSheet(t.key,t.url,t.data,t.frameWidth,t.frameHeight,t.frameMax,t.margin,t.spacing);break;case"textureatlas":if(null==t.atlasURL)this.cache.addTextureAtlas(t.key,t.url,t.data,t.atlasData,t.format);else if(i=!1,t.format===U.Loader.TEXTURE_ATLAS_JSON_ARRAY||t.format===U.Loader.TEXTURE_ATLAS_JSON_HASH||t.format===U.Loader.TEXTURE_ATLAS_JSON_PYXEL)this.xhrLoad(t,this.transformUrl(t.atlasURL,t),"text",this.jsonLoadComplete);else{if(t.format!==U.Loader.TEXTURE_ATLAS_XML_STARLING)throw new Error("Phaser.Loader. Invalid Texture Atlas format: "+t.format);this.xhrLoad(t,this.transformUrl(t.atlasURL,t),"text",this.xmlLoadComplete)}break;case"bitmapfont":t.atlasURL?(i=!1,this.xhrLoad(t,this.transformUrl(t.atlasURL,t),"text",function(t,e){var i;try{i=JSON.parse(e.responseText)}catch(t){}i?(t.atlasType="json",this.jsonLoadComplete(t,e)):(t.atlasType="xml",this.xmlLoadComplete(t,e))})):this.cache.addBitmapFont(t.key,t.url,t.data,t.atlasData,t.atlasType,t.xSpacing,t.ySpacing);break;case"video":if(t.asBlob)try{t.data=e.response}catch(e){throw new Error("Phaser.Loader. Unable to parse video file as Blob: "+t.key)}this.cache.addVideo(t.key,t.url,t.data,t.asBlob);break;case"audio":this.game.sound.usingWebAudio?(t.data=e.response,this.cache.addSound(t.key,t.url,t.data,!0,!1),t.autoDecode&&this.game.sound.decode(t.key)):this.cache.addSound(t.key,t.url,t.data,!1,!0);break;case"text":t.data=e.responseText,this.cache.addText(t.key,t.url,t.data);break;case"shader":t.data=e.responseText,this.cache.addShader(t.key,t.url,t.data);break;case"physics":n=JSON.parse(e.responseText);this.cache.addPhysicsData(t.key,t.url,n,t.format);break;case"script":t.data=document.createElement("script"),t.data.language="javascript",t.data.type="text/javascript",t.data.defer=!1,t.data.text=e.responseText,document.head.appendChild(t.data),t.callback&&(t.data=t.callback.call(t.callbackContext,t.key,e.responseText));break;case"binary":t.callback?t.data=t.callback.call(t.callbackContext,t.key,e.response):t.data=e.response,this.cache.addBinary(t.key,t.data)}i&&this.asyncComplete(t)},jsonLoadComplete:function(t,e){e=JSON.parse(e.responseText);"tilemap"===t.type?this.cache.addTilemap(t.key,t.url,e,t.format):"bitmapfont"===t.type?this.cache.addBitmapFont(t.key,t.url,t.data,e,t.atlasType,t.xSpacing,t.ySpacing):"json"===t.type?this.cache.addJSON(t.key,t.url,e):this.cache.addTextureAtlas(t.key,t.url,t.data,e,t.format),this.asyncComplete(t)},csvLoadComplete:function(t,e){e=e.responseText;this.cache.addTilemap(t.key,t.url,e,t.format),this.asyncComplete(t)},xmlLoadComplete:function(t,e){var i=e.responseText,i=this.parseXml(i);i?("bitmapfont"===t.type?this.cache.addBitmapFont(t.key,t.url,t.data,i,t.atlasType,t.xSpacing,t.ySpacing):"textureatlas"===t.type?this.cache.addTextureAtlas(t.key,t.url,t.data,i,t.format):"xml"===t.type&&this.cache.addXML(t.key,t.url,i),this.asyncComplete(t)):(e.responseType||e.contentType,this.asyncComplete(t,"invalid XML"))},parseXml:function(t){var e;try{window.DOMParser?e=(new DOMParser).parseFromString(t,"text/xml"):((e=new ActiveXObject("Microsoft.XMLDOM")).async="false",e.loadXML(t))}catch(t){e=null}return e&&e.documentElement&&!e.getElementsByTagName("parsererror").length?e:null},updateProgress:function(){this.preloadSprite&&(0===this.preloadSprite.direction?this.preloadSprite.rect.width=Math.floor(this.preloadSprite.width/100*this.progress):this.preloadSprite.rect.height=Math.floor(this.preloadSprite.height/100*this.progress),this.preloadSprite.sprite?this.preloadSprite.sprite.updateCrop():this.preloadSprite=null)},totalLoadedFiles:function(){return this._loadedFileCount},totalQueuedFiles:function(){return this._totalFileCount-this._loadedFileCount},totalLoadedPacks:function(){return this._totalPackCount},totalQueuedPacks:function(){return this._totalPackCount-this._loadedPackCount}},Object.defineProperty(U.Loader.prototype,"progressFloat",{get:function(){var t=this._loadedFileCount/this._totalFileCount*100;return U.Math.clamp(t||0,0,100)}}),Object.defineProperty(U.Loader.prototype,"progress",{get:function(){return Math.round(this.progressFloat)}}),U.Loader.prototype.constructor=U.Loader,U.LoaderParser={bitmapFont:function(t,e,i,n){return this.xmlBitmapFont(t,e,i,n)},xmlBitmapFont:function(t,e,i,n){var r={},o=t.getElementsByTagName("info")[0],s=t.getElementsByTagName("common")[0];r.font=o.getAttribute("face"),r.size=parseInt(o.getAttribute("size"),10),r.lineHeight=parseInt(s.getAttribute("lineHeight"),10)+n,r.chars={};for(var a=t.getElementsByTagName("char"),h=0;h<a.length;h++){var l=parseInt(a[h].getAttribute("id"),10);r.chars[l]={x:parseInt(a[h].getAttribute("x"),10),y:parseInt(a[h].getAttribute("y"),10),width:parseInt(a[h].getAttribute("width"),10),height:parseInt(a[h].getAttribute("height"),10),xOffset:parseInt(a[h].getAttribute("xoffset"),10),yOffset:parseInt(a[h].getAttribute("yoffset"),10),xAdvance:parseInt(a[h].getAttribute("xadvance"),10)+i,kerning:{}}}for(var p=t.getElementsByTagName("kerning"),h=0;h<p.length;h++){var u=parseInt(p[h].getAttribute("first"),10),d=parseInt(p[h].getAttribute("second"),10),c=parseInt(p[h].getAttribute("amount"),10);r.chars[d].kerning[u]=c}return this.finalizeBitmapFont(e,r)},jsonBitmapFont:function(t,e,i,n){var r={font:t.font.info._face,size:parseInt(t.font.info._size,10),lineHeight:parseInt(t.font.common._lineHeight,10)+n,chars:{}};return t.font.chars.char.forEach(function(t){var e=parseInt(t._id,10);r.chars[e]={x:parseInt(t._x,10),y:parseInt(t._y,10),width:parseInt(t._width,10),height:parseInt(t._height,10),xOffset:parseInt(t._xoffset,10),yOffset:parseInt(t._yoffset,10),xAdvance:parseInt(t._xadvance,10)+i,kerning:{}}}),t.font.kernings&&t.font.kernings.kerning&&t.font.kernings.kerning.forEach(function(t){r.chars[t._second].kerning[t._first]=parseInt(t._amount,10)}),this.finalizeBitmapFont(e,r)},finalizeBitmapFont:function(e,i){return Object.keys(i.chars).forEach(function(t){t=i.chars[t];t.texture=new PIXI.Texture(e,new U.Rectangle(t.x,t.y,t.width,t.height))}),i}},U.AudioSprite=function(t,e){for(var i in this.game=t,this.key=e,this.config=this.game.cache.getJSON(e+"-audioatlas"),this.autoplayKey=null,this.autoplay=!1,this.sounds={},this.config.spritemap){var n=this.config.spritemap[i],r=this.game.add.sound(this.key);r.addMarker(i,n.start,n.end-n.start,null,n.loop),this.sounds[i]=r}this.config.autoplay&&(this.autoplayKey=this.config.autoplay,this.play(this.autoplayKey),this.autoplay=this.sounds[this.autoplayKey])},U.AudioSprite.prototype={play:function(t,e){return this.sounds[t].play(t,null,e=void 0===e?1:e)},stop:function(t){if(t)this.sounds[t].stop();else for(var e in this.sounds)this.sounds[e].stop()},get:function(t){return this.sounds[t]}},U.AudioSprite.prototype.constructor=U.AudioSprite,U.Sound=function(t,e,i,n,r){void 0===i&&(i=1),void 0===n&&(n=!1),void 0===r&&(r=t.sound.connectToMaster),this.game=t,this.name=e,this.key=e,this.loop=n,this.markers={},this.context=null,this.autoplay=!1,this.totalDuration=0,this.startTime=0,this.currentTime=0,this.duration=0,this.durationMS=0,this.position=0,this.stopTime=0,this.paused=!1,this.pausedPosition=0,this.pausedTime=0,this.isPlaying=!1,this.currentMarker="",this.fadeTween=null,this.pendingPlayback=!1,this.override=!1,this.allowMultiple=!1,this.usingWebAudio=this.game.sound.usingWebAudio,this.usingAudioTag=this.game.sound.usingAudioTag,this.externalNode=null,this.masterGainNode=null,this.gainNode=null,this._sound=null,this.usingWebAudio?(this.context=this.game.sound.context,this.masterGainNode=this.game.sound.masterGain,void 0===this.context.createGain?this.gainNode=this.context.createGainNode():this.gainNode=this.context.createGain(),this.gainNode.gain.value=i*this.game.sound.volume,r&&this.gainNode.connect(this.masterGainNode)):this.usingAudioTag&&(this.game.cache.getSound(e)&&this.game.cache.isSoundReady(e)?(this._sound=this.game.cache.getSoundData(e),this.totalDuration=0,this._sound.duration&&(this.totalDuration=this._sound.duration)):this.game.cache.onSoundUnlock.add(this.soundHasUnlocked,this)),this.onDecoded=new U.Signal,this.onPlay=new U.Signal,this.onPause=new U.Signal,this.onResume=new U.Signal,this.onLoop=new U.Signal,this.onStop=new U.Signal,this.onMute=new U.Signal,this.onMarkerComplete=new U.Signal,this.onFadeComplete=new U.Signal,this._volume=i,this._buffer=null,this._muted=!1,this._tempMarker=0,this._tempPosition=0,this._tempVolume=0,this._tempPause=0,this._muteVolume=0,this._tempLoop=0,this._paused=!1,this._onDecodedEventDispatched=!1},U.Sound.prototype={soundHasUnlocked:function(t){t===this.key&&(this._sound=this.game.cache.getSoundData(this.key),this.totalDuration=this._sound.duration)},addMarker:function(t,e,i,n,r){this.markers[t]={name:t,start:e,stop:e+(i=null==i?1:i),volume:n=null==n?1:n,duration:i,durationMS:1e3*i,loop:r=void 0===r?!1:r}},removeMarker:function(t){delete this.markers[t]},onEndedHandler:function(){this._sound.onended=null,this.isPlaying=!1,this.currentTime=this.durationMS,this.stop()},update:function(){this.game.cache.checkSoundKey(this.key)?(this.isDecoded&&!this._onDecodedEventDispatched&&(this.onDecoded.dispatch(this),this._onDecodedEventDispatched=!0),this.pendingPlayback&&this.game.cache.isSoundReady(this.key)&&(this.pendingPlayback=!1,this.play(this._tempMarker,this._tempPosition,this._tempVolume,this._tempLoop)),this.isPlaying&&(this.currentTime=this.game.time.time-this.startTime,this.currentTime>=this.durationMS&&(this.usingWebAudio?this.loop?(this.onLoop.dispatch(this),this.isPlaying=!1,""===this.currentMarker?(this.currentTime=0,this.startTime=this.game.time.time,this.isPlaying=!0):(this.onMarkerComplete.dispatch(this.currentMarker,this),this.play(this.currentMarker,0,this.volume,!0,!0))):""!==this.currentMarker&&this.stop():this.loop?(this.onLoop.dispatch(this),""===this.currentMarker&&(this.currentTime=0,this.startTime=this.game.time.time),this.isPlaying=!1,this.play(this.currentMarker,0,this.volume,!0,!0)):this.stop()))):this.destroy()},loopFull:function(t){return this.play(null,0,t,!0)},play:function(t,e,i,n,r){if(void 0!==t&&!1!==t&&null!==t||(t=""),void 0===r&&(r=!0),this.isPlaying&&!this.allowMultiple&&!r&&!this.override)return this;if(this._sound&&this.isPlaying&&!this.allowMultiple&&(this.override||r)){if(this.usingWebAudio){if(void 0===this._sound.stop)this._sound.noteOff(0);else try{this._sound.stop(0)}catch(t){}this.externalNode?this._sound.disconnect(this.externalNode):this.gainNode&&this._sound.disconnect(this.gainNode)}else this.usingAudioTag&&(this._sound.pause(),this._sound.currentTime=0);this.isPlaying=!1}r=Object.keys(this.markers);if(""===(t=""===t&&1===r.length?r[0]:t)&&0<r.length)return this;if(""!==t){if(!this.markers[t])return this;this.currentMarker=t,this.position=this.markers[t].start,this.volume=this.markers[t].volume,this.loop=this.markers[t].loop,this.duration=this.markers[t].duration,this.durationMS=this.markers[t].durationMS,void 0!==i&&(this.volume=i),void 0!==n&&(this.loop=n),this._tempMarker=t,this._tempPosition=this.position,this._tempVolume=this.volume,this._tempLoop=this.loop}else e=e||0,void 0===i&&(i=this._volume),void 0===n&&(n=this.loop),this.position=Math.max(0,e),this.volume=i,this.loop=n,this.duration=0,this.durationMS=0,this._tempMarker=t,this._tempPosition=e,this._tempVolume=i,this._tempLoop=n;return this.usingWebAudio?this.game.cache.isSoundDecoded(this.key)?(this._sound=this.context.createBufferSource(),this.externalNode?this._sound.connect(this.externalNode):this._sound.connect(this.gainNode),this._buffer=this.game.cache.getSoundData(this.key),this._sound.buffer=this._buffer,this.loop&&""===t&&(this._sound.loop=!0),this.loop||""!==t||(this._sound.onended=this.onEndedHandler.bind(this)),this.totalDuration=this._sound.buffer.duration,0===this.duration&&(this.duration=this.totalDuration,this.durationMS=Math.ceil(1e3*this.totalDuration)),void 0===this._sound.start?this._sound.noteGrainOn(0,this.position,this.duration):this.loop&&""===t?this._sound.start(0,0):this._sound.start(0,this.position,this.duration),this.isPlaying=!0,this.startTime=this.game.time.time,this.currentTime=0,this.stopTime=this.startTime+this.durationMS,this.onPlay.dispatch(this)):(this.pendingPlayback=!0,this.game.cache.getSound(this.key)&&!1===this.game.cache.getSound(this.key).isDecoding&&this.game.sound.decode(this.key,this)):this.game.cache.getSound(this.key)&&this.game.cache.getSound(this.key).locked?(this.game.cache.reloadSound(this.key),this.pendingPlayback=!0):this._sound&&(this.game.device.wechatMinigame||this.game.device.cocoonJS||4===this._sound.readyState)?(this.loop&&(this._sound.loop=!0),!this.loop&&""===t&&this.game.device.wechatMinigame&&this._sound.addEventListener("ended",this.onEndedHandler.bind(this)),this._sound.play(),this.totalDuration=this._sound.duration,0===this.duration&&(this.duration=this.totalDuration,this.durationMS=1e3*this.totalDuration),this._sound.currentTime=this.position,this._sound.muted=this._muted,this._muted||this.game.sound.mute?this._sound.volume=0:this._sound.volume=this._volume,this.isPlaying=!0,this.startTime=this.game.time.time,this.currentTime=0,this.stopTime=this.startTime+this.durationMS,this.onPlay.dispatch(this)):this.pendingPlayback=!0,this},restart:function(t,e,i,n){this.play(t=t||"",e=e||0,i=i||1,n=void 0===n?!1:n,!0)},pause:function(){this.isPlaying&&this._sound&&(this.paused=!0,this.pausedPosition=this.currentTime,this.pausedTime=this.game.time.time,this._tempPause=this._sound.currentTime,this.onPause.dispatch(this),this.stop())},resume:function(){var t,e;this.paused&&this._sound&&(this.usingWebAudio?(t=Math.max(0,this.position+this.pausedPosition/1e3),this._sound=this.context.createBufferSource(),this._sound.buffer=this._buffer,this.externalNode?this._sound.connect(this.externalNode):this._sound.connect(this.gainNode),this.loop&&(this._sound.loop=!0),this.loop||""!==this.currentMarker||(this._sound.onended=this.onEndedHandler.bind(this)),e=this.duration-this.pausedPosition/1e3,void 0===this._sound.start?this._sound.noteGrainOn(0,t,e):this.loop&&this.game.device.chrome?42===this.game.device.chromeVersion?this._sound.start(0):this._sound.start(0,t):this._sound.start(0,t,e)):(this._sound.currentTime=this._tempPause,this._sound.play()),this.isPlaying=!0,this.paused=!1,this.startTime+=this.game.time.time-this.pausedTime,this.onResume.dispatch(this))},stop:function(){if(this.isPlaying&&this._sound)if(this.usingWebAudio){if(void 0===this._sound.stop)this._sound.noteOff(0);else try{this._sound.stop(0)}catch(t){}this.externalNode?this._sound.disconnect(this.externalNode):this.gainNode&&this._sound.disconnect(this.gainNode)}else this.usingAudioTag&&(this._sound.pause(),this._sound.currentTime=0);var t;this.pendingPlayback=!1,this.isPlaying=!1,this.paused||(t=this.currentMarker,""!==this.currentMarker&&this.onMarkerComplete.dispatch(this.currentMarker,this),this.currentMarker="",null!==this.fadeTween&&this.fadeTween.stop(),this.onStop.dispatch(this,t))},fadeIn:function(t,e,i){void 0===e&&(e=!1),void 0===i&&(i=this.currentMarker),this.paused||(this.play(i,0,0,e),this.fadeTo(t,1))},fadeOut:function(t){this.fadeTo(t,0)},fadeTo:function(t,e){this.isPlaying&&!this.paused&&e!==this.volume&&(void 0===t&&(t=1e3),void 0!==e&&(this.fadeTween=this.game.add.tween(this).to({volume:e},t,U.Easing.Linear.None,!0),this.fadeTween.onComplete.add(this.fadeComplete,this)))},fadeComplete:function(){this.onFadeComplete.dispatch(this,this.volume),0===this.volume&&this.stop()},updateGlobalVolume:function(t){this.usingAudioTag&&this._sound&&(this._sound.volume=t*this._volume)},destroy:function(t){void 0===t&&(t=!0),this.stop(),t?this.game.sound.remove(this):(this.markers={},this.context=null,this._buffer=null,this.externalNode=null,this.onDecoded.dispose(),this.onPlay.dispose(),this.onPause.dispose(),this.onResume.dispose(),this.onLoop.dispose(),this.onStop.dispose(),this.onMute.dispose(),this.onMarkerComplete.dispose())}},U.Sound.prototype.constructor=U.Sound,Object.defineProperty(U.Sound.prototype,"isDecoding",{get:function(){return this.game.cache.getSound(this.key).isDecoding}}),Object.defineProperty(U.Sound.prototype,"isDecoded",{get:function(){return this.game.cache.isSoundDecoded(this.key)}}),Object.defineProperty(U.Sound.prototype,"mute",{get:function(){return this._muted||this.game.sound.mute},set:function(t){(t=t||!1)!==this._muted&&(t?(this._muted=!0,this._muteVolume=this._tempVolume,this.game.device.wechatMinigame?this._sound.pause():this.usingWebAudio?this.gainNode.gain.value=0:this.usingAudioTag&&this._sound&&(this._sound.volume=0)):(this._muted=!1,this.game.device.wechatMinigame&&this.isPlaying?this._sound.play():this.usingWebAudio?this.gainNode.gain.value=this._muteVolume:this.usingAudioTag&&this._sound&&(this._sound.volume=this._muteVolume)),this.onMute.dispatch(this))}}),Object.defineProperty(U.Sound.prototype,"volume",{get:function(){return this._volume},set:function(t){this.game.device.firefox&&this.usingAudioTag&&(t=this.game.math.clamp(t,0,1)),this._muted?this._muteVolume=t:(this._tempVolume=t,this._volume=t,this.usingWebAudio?this.gainNode.gain.value=t:this.usingAudioTag&&this._sound&&(this._sound.volume=t))}}),U.SoundManager=function(t){this.game=t,this.onSoundDecode=new U.Signal,this.onVolumeChange=new U.Signal,this.onMute=new U.Signal,this.onUnMute=new U.Signal,this.context=null,this.usingWebAudio=!1,this.usingAudioTag=!1,this.noAudio=!1,this.connectToMaster=!0,this.touchLocked=!1,this.channels=32,this.muteOnPause=!0,this._codeMuted=!1,this._muted=!1,this._unlockSource=null,this._volume=1,this._sounds=[],this._watchList=new U.ArraySet,this._watching=!1,this._watchCallback=null,this._watchContext=null},U.SoundManager.prototype={boot:function(){if(this.game.device.iOS&&!1===this.game.device.webAudio&&(this.channels=1),window.PhaserGlobal){if(!0===window.PhaserGlobal.disableAudio)return this.noAudio=!0,void(this.touchLocked=!1);if(!0===window.PhaserGlobal.disableWebAudio)return this.usingAudioTag=!0,void(this.touchLocked=!1)}if(window.PhaserGlobal&&window.PhaserGlobal.audioContext)this.context=window.PhaserGlobal.audioContext;else if(window.AudioContext)try{this.context=new window.AudioContext}catch(t){this.context=null,this.usingWebAudio=!1,this.touchLocked=!1}else if(window.webkitAudioContext)try{this.context=new window.webkitAudioContext}catch(t){this.context=null,this.usingWebAudio=!1,this.touchLocked=!1}if(null===this.context){if(void 0===window.Audio)return void(this.noAudio=!0);this.usingAudioTag=!0}else this.usingWebAudio=!0,void 0===this.context.createGain?this.masterGain=this.context.createGainNode():this.masterGain=this.context.createGain(),this.masterGain.gain.value=1,this.masterGain.connect(this.context.destination);this.noAudio||!this.game.device.cocoonJS&&(this.game.device.chrome||this.game.device.iOS||window.PhaserGlobal&&window.PhaserGlobal.fakeiOSTouchLock)&&this.setTouchLock()},setTouchLock:function(){this.noAudio||window.PhaserGlobal&&!0===window.PhaserGlobal.disableAudio||(8<this.game.device.iOSVersion||55<=this.game.device.chromeVersion?this.game.input.touch.addTouchLockCallback(this.unlock,this,!0):this.game.input.touch.addTouchLockCallback(this.unlock,this),this.touchLocked=!0)},unlock:function(){return this.noAudio||!this.touchLocked||null!==this._unlockSource||(this.usingAudioTag?(this.touchLocked=!1,this._unlockSource=null):this.usingWebAudio&&(t=this.context.createBuffer(1,1,22050),this._unlockSource=this.context.createBufferSource(),this._unlockSource.buffer=t,this._unlockSource.connect(this.context.destination),void 0===this._unlockSource.start?this._unlockSource.noteOn(0):this._unlockSource.start(0),"suspended"===this._unlockSource.context.state&&this._unlockSource.context.resume())),!0;var t},stopAll:function(){if(!this.noAudio)for(var t=0;t<this._sounds.length;t++)this._sounds[t]&&this._sounds[t].stop()},pauseAll:function(){if(!this.noAudio)for(var t=0;t<this._sounds.length;t++)this._sounds[t]&&this._sounds[t].pause()},resumeAll:function(){if(!this.noAudio)for(var t=0;t<this._sounds.length;t++)this._sounds[t]&&this._sounds[t].resume()},decode:function(e,i){i=i||null;var t=this.game.cache.getSoundData(e);if(t&&!1===this.game.cache.isSoundDecoded(e)){this.game.cache.updateSound(e,"isDecoding",!0);var n=this;try{this.context.decodeAudioData(t,function(t){t&&(n.game.cache.decodedSound(e,t),n.onSoundDecode.dispatch(e,i))})}catch(e){}}},setDecodedCallback:function(t,e,i){"string"==typeof t&&(t=[t]),this._watchList.reset();for(var n=0;n<t.length;n++)t[n]instanceof U.Sound?this.game.cache.isSoundDecoded(t[n].key)||this._watchList.add(t[n].key):this.game.cache.isSoundDecoded(t[n])||this._watchList.add(t[n]);0===this._watchList.total?(this._watching=!1,e.call(i)):(this._watching=!0,this._watchCallback=e,this._watchContext=i)},update:function(){if(!this.noAudio){!this.touchLocked||null===this._unlockSource||this._unlockSource.playbackState!==this._unlockSource.PLAYING_STATE&&this._unlockSource.playbackState!==this._unlockSource.FINISHED_STATE||(this.touchLocked=!1,this._unlockSource=null);for(var t=0;t<this._sounds.length;t++)this._sounds[t].update();if(this._watching){for(var e=this._watchList.first;e;)this.game.cache.isSoundDecoded(e)&&this._watchList.remove(e),e=this._watchList.next;0===this._watchList.total&&(this._watching=!1,this._watchCallback.call(this._watchContext))}}},add:function(t,e,i,n){void 0===n&&(n=this.connectToMaster);n=new U.Sound(this.game,t,e=void 0===e?1:e,i=void 0===i?!1:i,n);return this._sounds.push(n),n},addSprite:function(t){return new U.AudioSprite(this.game,t)},remove:function(t){for(var e=this._sounds.length;e--;)if(this._sounds[e]===t)return this._sounds[e].destroy(!1),this._sounds.splice(e,1),!0;return!1},removeByKey:function(t){for(var e=this._sounds.length,i=0;e--;)this._sounds[e].key===t&&(this._sounds[e].destroy(!1),this._sounds.splice(e,1),i++);return i},play:function(t,e,i){if(!this.noAudio){i=this.add(t,e,i);return i.play(),i}},setMute:function(){if(!this._muted){this._muted=!0,this.usingWebAudio&&(this._muteVolume=this.masterGain.gain.value,this.masterGain.gain.value=0);for(var t=0;t<this._sounds.length;t++)this._sounds[t].usingAudioTag&&(this._sounds[t].mute=!0);this.onMute.dispatch()}},unsetMute:function(){if(this._muted&&!this._codeMuted){this._muted=!1,this.usingWebAudio&&(this.masterGain.gain.value=this._muteVolume);for(var t=0;t<this._sounds.length;t++)this._sounds[t].usingAudioTag&&(this._sounds[t].mute=!1);this.onUnMute.dispatch()}},destroy:function(){this.stopAll();for(var t=0;t<this._sounds.length;t++)this._sounds[t]&&this._sounds[t].destroy();this._sounds=[],this.onSoundDecode.dispose(),this.context&&(window.PhaserGlobal?window.PhaserGlobal.audioContext=this.context:this.context.close&&this.context.close())}},U.SoundManager.prototype.constructor=U.SoundManager,Object.defineProperty(U.SoundManager.prototype,"mute",{get:function(){return this._muted},set:function(t){(t=t||!1)?this._muted||(this._codeMuted=!0,this.setMute()):this._muted&&(this._codeMuted=!1,this.unsetMute())}}),Object.defineProperty(U.SoundManager.prototype,"volume",{get:function(){return this._volume},set:function(t){if(t<0?t=0:1<t&&(t=1),this._volume!==t){if(this._volume=t,this.usingWebAudio)this.masterGain.gain.value=t;else for(var e=0;e<this._sounds.length;e++)this._sounds[e].usingAudioTag&&this._sounds[e].updateGlobalVolume(t);this.onVolumeChange.dispatch(t)}}}),U.ScaleManager=function(t,e,i){this.game=t,this.dom=U.DOM,this.grid=null,this.width=0,this.height=0,this.minWidth=null,this.maxWidth=null,this.minHeight=null,this.maxHeight=null,this.offset=new U.Point,this.forceLandscape=!1,this.forcePortrait=!1,this.incorrectOrientation=!1,this._pageAlignHorizontally=!1,this._pageAlignVertically=!1,this.onOrientationChange=new U.Signal,this.enterIncorrectOrientation=new U.Signal,this.leaveIncorrectOrientation=new U.Signal,this.hasPhaserSetFullScreen=!1,this.fullScreenTarget=null,this._createdFullScreenTarget=null,this.onFullScreenInit=new U.Signal,this.onFullScreenChange=new U.Signal,this.onFullScreenError=new U.Signal,this.screenOrientation=this.dom.getScreenOrientation(),this.scaleFactor=new U.Point(1,1),this.scaleFactorInversed=new U.Point(1,1),this.margin={left:0,top:0,right:0,bottom:0,x:0,y:0},this.bounds=new U.Rectangle,this.aspectRatio=0,this.sourceAspectRatio=0,this.event=null,this.windowConstraints={right:"layout",bottom:""},this.compatibility={supportsFullScreen:!1,orientationFallback:null,noMargins:!1,scrollTo:null,forceMinimumDocumentHeight:!1,canExpandParent:!0,clickTrampoline:""},this._scaleMode=U.ScaleManager.NO_SCALE,this._fullScreenScaleMode=U.ScaleManager.NO_SCALE,this.parentIsWindow=!1,this.parentNode=null,this.parentScaleFactor=new U.Point(1,1),this.trackParentInterval=2e3,this.onSizeChange=new U.Signal,this.onResize=null,this.onResizeContext=null,this._pendingScaleMode=null,this._fullScreenRestore=null,this._gameSize=new U.Rectangle,this._userScaleFactor=new U.Point(1,1),this._userScaleTrim=new U.Point(0,0),this._lastUpdate=0,this._updateThrottle=0,this._updateThrottleReset=100,this._parentBounds=new U.Rectangle,this._tempBounds=new U.Rectangle,this._lastReportedCanvasSize=new U.Rectangle,this._lastReportedGameSize=new U.Rectangle,this._booted=!1,t.config&&this.parseConfig(t.config),this.setupScale(e,i)},U.ScaleManager.EXACT_FIT=0,U.ScaleManager.NO_SCALE=1,U.ScaleManager.SHOW_ALL=2,U.ScaleManager.RESIZE=3,U.ScaleManager.USER_SCALE=4,U.ScaleManager.prototype={boot:function(){var t=this.compatibility;t.supportsFullScreen=this.game.device.fullscreen&&!this.game.device.cocoonJS,this.game.device.iPad||this.game.device.webApp||this.game.device.desktop||(this.game.device.android&&!this.game.device.chrome?t.scrollTo=new U.Point(0,1):t.scrollTo=new U.Point(0,0)),this.game.device.desktop?(t.orientationFallback="screen",t.clickTrampoline="when-not-mouse"):(t.orientationFallback="",t.clickTrampoline="");var e=this;this._orientationChange=function(t){return e.orientationChange(t)},this._windowResize=function(t){return e.windowResize(t)},window.addEventListener("orientationchange",this._orientationChange,!1),window.addEventListener("resize",this._windowResize,!1),this.compatibility.supportsFullScreen&&(this._fullScreenChange=function(t){return e.fullScreenChange(t)},this._fullScreenError=function(t){return e.fullScreenError(t)},document.addEventListener("webkitfullscreenchange",this._fullScreenChange,!1),document.addEventListener("mozfullscreenchange",this._fullScreenChange,!1),document.addEventListener("MSFullscreenChange",this._fullScreenChange,!1),document.addEventListener("fullscreenchange",this._fullScreenChange,!1),document.addEventListener("webkitfullscreenerror",this._fullScreenError,!1),document.addEventListener("mozfullscreenerror",this._fullScreenError,!1),document.addEventListener("MSFullscreenError",this._fullScreenError,!1),document.addEventListener("fullscreenerror",this._fullScreenError,!1)),this.game.onResume.add(this._gameResumed,this),this.dom.getOffset(this.game.canvas,this.offset),this.bounds.setTo(this.offset.x,this.offset.y,this.width,this.height),this.setGameSize(this.game.width,this.game.height),this.screenOrientation=this.dom.getScreenOrientation(this.compatibility.orientationFallback),U.FlexGrid&&(this.grid=new U.FlexGrid(this,this.width,this.height)),this._booted=!0,null!==this._pendingScaleMode&&(this.scaleMode=this._pendingScaleMode,this._pendingScaleMode=null)},parseConfig:function(t){void 0!==t.scaleMode&&(this._booted?this.scaleMode=t.scaleMode:this._pendingScaleMode=t.scaleMode),void 0!==t.fullScreenScaleMode&&(this.fullScreenScaleMode=t.fullScreenScaleMode),t.fullScreenTarget&&(this.fullScreenTarget=t.fullScreenTarget)},setupScale:function(t,e){var i=new U.Rectangle;""!==this.game.parent&&("string"==typeof this.game.parent?r=document.getElementById(this.game.parent):this.game.parent&&1===this.game.parent.nodeType&&(r=this.game.parent)),r?(this.parentNode=r,this.parentIsWindow=!1,this.getParentBounds(this._parentBounds),i.width=this._parentBounds.width,i.height=this._parentBounds.height,this.offset.set(this._parentBounds.x,this._parentBounds.y)):(this.parentNode=null,this.parentIsWindow=!0,i.width=this.dom.visualBounds.width,i.height=this.dom.visualBounds.height,this.offset.set(0,0));var n=0,r=0,n="number"==typeof t?t:(this.parentScaleFactor.x=parseInt(t,10)/100,i.width*this.parentScaleFactor.x),r="number"==typeof e?e:(this.parentScaleFactor.y=parseInt(e,10)/100,i.height*this.parentScaleFactor.y);n=Math.floor(n),r=Math.floor(r),this._gameSize.setTo(0,0,n,r),this.updateDimensions(n,r,!1)},_gameResumed:function(){this.queueUpdate(!0)},setGameSize:function(t,e){this._gameSize.setTo(0,0,t,e),this.currentScaleMode!==U.ScaleManager.RESIZE&&this.updateDimensions(t,e,!0),this.queueUpdate(!0)},setUserScale:function(t,e,i,n){this._userScaleFactor.setTo(t,e),this._userScaleTrim.setTo(0|i,0|n),this.queueUpdate(!0)},setResizeCallback:function(t,e){this.onResize=t,this.onResizeContext=e},signalSizeChange:function(){var t,e;U.Rectangle.sameDimensions(this,this._lastReportedCanvasSize)&&U.Rectangle.sameDimensions(this.game,this._lastReportedGameSize)||(t=this.width,e=this.height,this._lastReportedCanvasSize.setTo(0,0,t,e),this._lastReportedGameSize.setTo(0,0,this.game.width,this.game.height),this.grid&&this.grid.onResize(t,e),this.onSizeChange.dispatch(this,t,e),this.currentScaleMode===U.ScaleManager.RESIZE&&(this.game.state.resize(t,e),this.game.load.resize(t,e)))},setMinMax:function(t,e,i,n){this.minWidth=t,this.minHeight=e,void 0!==i&&(this.maxWidth=i),void 0!==n&&(this.maxHeight=n)},preUpdate:function(){var t,e,i,n;this.game.time.time<this._lastUpdate+this._updateThrottle||(t=this._updateThrottle,this._updateThrottleReset=400<=t?0:100,this.dom.getOffset(this.game.canvas,this.offset),e=this._parentBounds.width,i=this._parentBounds.height,e=(n=this.getParentBounds(this._parentBounds)).width!==e||n.height!==i,i=this.updateOrientationState(),(e||i)&&(this.onResize&&this.onResize.call(this.onResizeContext,this,n),this.updateLayout(),this.signalSizeChange()),n=2*this._updateThrottle,this._updateThrottle<t&&(n=Math.min(t,this._updateThrottleReset)),this._updateThrottle=U.Math.clamp(n,25,this.trackParentInterval),this._lastUpdate=this.game.time.time)},pauseUpdate:function(){this.preUpdate(),this._updateThrottle=this.trackParentInterval},updateDimensions:function(t,e,i){this.width=t*this.parentScaleFactor.x,this.height=e*this.parentScaleFactor.y,this.game.width=this.width,this.game.height=this.height,this.sourceAspectRatio=this.width/this.height,this.updateScalingAndBounds(),i&&(this.game.renderer.resize(this.width,this.height),this.game.camera.setSize(this.width,this.height),this.game.world.resize(this.width,this.height))},updateScalingAndBounds:function(){this.scaleFactor.x=this.game.width/this.width,this.scaleFactor.y=this.game.height/this.height,this.scaleFactorInversed.x=this.width/this.game.width,this.scaleFactorInversed.y=this.height/this.game.height,this.aspectRatio=this.width/this.height,this.game.canvas&&this.dom.getOffset(this.game.canvas,this.offset),this.bounds.setTo(this.offset.x,this.offset.y,this.width,this.height),this.game.input&&this.game.input.scale&&this.game.input.scale.setTo(this.scaleFactor.x,this.scaleFactor.y)},forceOrientation:function(t,e){void 0===e&&(e=!1),this.forceLandscape=t,this.forcePortrait=e,this.queueUpdate(!0)},classifyOrientation:function(t){return"portrait-primary"===t||"portrait-secondary"===t?"portrait":"landscape-primary"===t||"landscape-secondary"===t?"landscape":null},updateOrientationState:function(){var t=this.screenOrientation,e=this.incorrectOrientation;this.screenOrientation=this.dom.getScreenOrientation(this.compatibility.orientationFallback),this.incorrectOrientation=this.forceLandscape&&!this.isLandscape||this.forcePortrait&&!this.isPortrait;var i=t!==this.screenOrientation,n=e!==this.incorrectOrientation;return n&&(this.incorrectOrientation?this.enterIncorrectOrientation:this.leaveIncorrectOrientation).dispatch(),(i||n)&&this.onOrientationChange.dispatch(this,t,e),i||n},orientationChange:function(t){this.event=t,this.queueUpdate(!0)},windowResize:function(t){this.event=t,this.queueUpdate(!0)},scrollTop:function(){var t=this.compatibility.scrollTo;t&&window.scrollTo(t.x,t.y)},refresh:function(){this.scrollTop(),this.queueUpdate(!0)},updateLayout:function(){var t=this.currentScaleMode;t!==U.ScaleManager.RESIZE?(this.scrollTop(),this.compatibility.forceMinimumDocumentHeight&&(document.documentElement.style.minHeight=window.innerHeight+"px"),this.incorrectOrientation?this.setMaximum():t===U.ScaleManager.EXACT_FIT?this.setExactFit():t===U.ScaleManager.SHOW_ALL?(this.setShowAll(!0),this.resetCanvas(),this.setShowAll()):t===U.ScaleManager.NO_SCALE?(this.width=this.game.width,this.height=this.game.height):t===U.ScaleManager.USER_SCALE&&(this.width=this.game.width*this._userScaleFactor.x-this._userScaleTrim.x,this.height=this.game.height*this._userScaleFactor.y-this._userScaleTrim.y),this.compatibility.canExpandParent||t!==U.ScaleManager.SHOW_ALL&&t!==U.ScaleManager.USER_SCALE||(t=this.getParentBounds(this._tempBounds),this.width=Math.min(this.width,t.width),this.height=Math.min(this.height,t.height)),this.width=0|this.width,this.height=0|this.height,this.reflowCanvas()):this.reflowGame()},getParentBounds:function(t){var e,i=t||new U.Rectangle,n=this.boundingParent,r=this.dom.visualBounds,o=this.dom.layoutBounds;return n?(t=n.getBoundingClientRect(),n=(n.offsetParent||n).getBoundingClientRect(),i.setTo(t.left-n.left,t.top-n.top,t.width,t.height),(t=this.windowConstraints).right&&(e="layout"===t.right?o:r,i.right=Math.min(i.right,e.width)),t.bottom&&(e="layout"===t.bottom?o:r,i.bottom=Math.min(i.bottom,e.height))):i.setTo(0,0,r.width,r.height),i.setTo(Math.round(i.x),Math.round(i.y),Math.round(i.width),Math.round(i.height)),i},alignCanvas:function(t,e){var i,n,r,o,s=this.getParentBounds(this._tempBounds),a=this.game.canvas,h=this.margin;t&&(h.left=h.right=0,i=a.getBoundingClientRect(),this.width<s.width&&!this.incorrectOrientation&&(n=i.left-s.x,r=s.width/2-this.width/2,o=(r=Math.max(r,0))-n,h.left=Math.round(o)),a.style.marginLeft=h.left+"px",0!==h.left&&(h.right=-(s.width-i.width-h.left),a.style.marginRight=h.right+"px")),e&&(h.top=h.bottom=0,i=a.getBoundingClientRect(),this.height<s.height&&!this.incorrectOrientation&&(n=i.top-s.y,r=s.height/2-this.height/2,o=(r=Math.max(r,0))-n,h.top=Math.round(o)),a.style.marginTop=h.top+"px",0!==h.top&&(h.bottom=-(s.height-i.height-h.top),a.style.marginBottom=h.bottom+"px")),h.x=h.left,h.y=h.top},reflowGame:function(){this.resetCanvas("","");var t=this.getParentBounds(this._tempBounds);this.updateDimensions(t.width,t.height,!0)},reflowCanvas:function(){this.incorrectOrientation||(this.width=U.Math.clamp(this.width,this.minWidth||0,this.maxWidth||this.width),this.height=U.Math.clamp(this.height,this.minHeight||0,this.maxHeight||this.height)),this.resetCanvas(),this.compatibility.noMargins||(this.isFullScreen&&this._createdFullScreenTarget?this.alignCanvas(!0,!0):this.alignCanvas(this.pageAlignHorizontally,this.pageAlignVertically)),this.updateScalingAndBounds()},resetCanvas:function(t,e){void 0===t&&(t=this.width+"px"),void 0===e&&(e=this.height+"px");var i=this.game.canvas;this.compatibility.noMargins||(i.style.marginLeft="",i.style.marginTop="",i.style.marginRight="",i.style.marginBottom=""),i.style.width=t,i.style.height=e},queueUpdate:function(t){t&&(this._parentBounds.width=0,this._parentBounds.height=0),this._updateThrottle=this._updateThrottleReset},reset:function(t){t&&this.grid&&this.grid.reset()},setMaximum:function(){this.width=this.dom.visualBounds.width,this.height=this.dom.visualBounds.height},setShowAll:function(t){var e=this.getParentBounds(this._tempBounds),i=e.width,e=e.height,i=t?Math.max(e/this.game.height,i/this.game.width):Math.min(e/this.game.height,i/this.game.width);this.width=Math.round(this.game.width*i),this.height=Math.round(this.game.height*i)},setExactFit:function(){var t=this.getParentBounds(this._tempBounds);this.width=t.width,this.height=t.height,this.isFullScreen||(this.maxWidth&&(this.width=Math.min(this.width,this.maxWidth)),this.maxHeight&&(this.height=Math.min(this.height,this.maxHeight)))},createFullScreenTarget:function(){var t=document.createElement("div");return t.style.margin="0",t.style.padding="0",t.style.background="#000",t},startFullScreen:function(t,e){if(this.isFullScreen)return!1;if(this.compatibility.supportsFullScreen){if("when-not-mouse"===this.compatibility.clickTrampoline){var i=this.game.input;if(i.activePointer&&i.activePointer!==i.mousePointer&&(e||!1!==e))return void i.activePointer.addClickTrampoline("startFullScreen",this.startFullScreen,this,[t,!1])}void 0!==t&&this.game.renderType===U.CANVAS&&(this.game.stage.smoothed=t);i=this.fullScreenTarget;i||(this.cleanupCreatedTarget(),this._createdFullScreenTarget=this.createFullScreenTarget(),i=this._createdFullScreenTarget);var t={targetElement:i};return this.hasPhaserSetFullScreen=!0,this.onFullScreenInit.dispatch(this,t),this._createdFullScreenTarget&&((t=this.game.canvas).parentNode.insertBefore(i,t),i.appendChild(t)),this.game.device.fullscreenKeyboard?i[this.game.device.requestFullscreen](Element.ALLOW_KEYBOARD_INPUT):i[this.game.device.requestFullscreen](),!0}var n=this;setTimeout(function(){n.fullScreenError()},10)},stopFullScreen:function(){return!(!this.isFullScreen||!this.compatibility.supportsFullScreen||(this.hasPhaserSetFullScreen=!1,document[this.game.device.cancelFullscreen](),0))},cleanupCreatedTarget:function(){var t,e=this._createdFullScreenTarget;e&&e.parentNode&&((t=e.parentNode).insertBefore(this.game.canvas,e),t.removeChild(e)),this._createdFullScreenTarget=null},prepScreenMode:function(t){var e=!!this._createdFullScreenTarget,i=this._createdFullScreenTarget||this.fullScreenTarget;t?!e&&this.fullScreenScaleMode!==U.ScaleManager.EXACT_FIT||i===this.game.canvas||(this._fullScreenRestore={targetWidth:i.style.width,targetHeight:i.style.height},i.style.width="100%",i.style.height="100%"):(this._fullScreenRestore&&(i.style.width=this._fullScreenRestore.targetWidth,i.style.height=this._fullScreenRestore.targetHeight,this._fullScreenRestore=null),this.updateDimensions(this._gameSize.width,this._gameSize.height,!0),this.resetCanvas())},fullScreenChange:function(t){this.event=t,this.isFullScreen?this.prepScreenMode(!0):(this.prepScreenMode(!1),this.cleanupCreatedTarget()),this.updateLayout(),this.queueUpdate(!0),this.onFullScreenChange.dispatch(this,this.width,this.height)},fullScreenError:function(t){this.event=t,this.cleanupCreatedTarget(),this.onFullScreenError.dispatch(this)},scaleSprite:function(t,e,i,n){if(void 0===e&&(e=this.width),void 0===i&&(i=this.height),void 0===n&&(n=!1),!t||!t.scale)return t;if(t.scale.x=1,t.scale.y=1,t.width<=0||t.height<=0||e<=0||i<=0)return t;var r=e,o=t.height*e/t.width,s=t.width*i/t.height,i=i;return(e<s?n:!n)?(t.width=Math.floor(r),t.height=Math.floor(o)):(t.width=Math.floor(s),t.height=Math.floor(i)),t},destroy:function(){this.game.onResume.remove(this._gameResumed,this),window.removeEventListener("orientationchange",this._orientationChange,!1),window.removeEventListener("resize",this._windowResize,!1),this.compatibility.supportsFullScreen&&(document.removeEventListener("webkitfullscreenchange",this._fullScreenChange,!1),document.removeEventListener("mozfullscreenchange",this._fullScreenChange,!1),document.removeEventListener("MSFullscreenChange",this._fullScreenChange,!1),document.removeEventListener("fullscreenchange",this._fullScreenChange,!1),document.removeEventListener("webkitfullscreenerror",this._fullScreenError,!1),document.removeEventListener("mozfullscreenerror",this._fullScreenError,!1),document.removeEventListener("MSFullscreenError",this._fullScreenError,!1),document.removeEventListener("fullscreenerror",this._fullScreenError,!1))}},U.ScaleManager.prototype.constructor=U.ScaleManager,Object.defineProperty(U.ScaleManager.prototype,"boundingParent",{get:function(){return!(this.parentIsWindow||this.isFullScreen&&this.hasPhaserSetFullScreen&&!this._createdFullScreenTarget)&&this.game.canvas&&this.game.canvas.parentNode||null}}),Object.defineProperty(U.ScaleManager.prototype,"scaleMode",{get:function(){return this._scaleMode},set:function(t){return t!==this._scaleMode&&(this.isFullScreen||(this.updateDimensions(this._gameSize.width,this._gameSize.height,!0),this.queueUpdate(!0)),this._scaleMode=t),this._scaleMode}}),Object.defineProperty(U.ScaleManager.prototype,"fullScreenScaleMode",{get:function(){return this._fullScreenScaleMode},set:function(t){return t!==this._fullScreenScaleMode&&(this.isFullScreen?(this.prepScreenMode(!1),this._fullScreenScaleMode=t,this.prepScreenMode(!0),this.queueUpdate(!0)):this._fullScreenScaleMode=t),this._fullScreenScaleMode}}),Object.defineProperty(U.ScaleManager.prototype,"currentScaleMode",{get:function(){return this.isFullScreen?this._fullScreenScaleMode:this._scaleMode}}),Object.defineProperty(U.ScaleManager.prototype,"pageAlignHorizontally",{get:function(){return this._pageAlignHorizontally},set:function(t){t!==this._pageAlignHorizontally&&(this._pageAlignHorizontally=t,this.queueUpdate(!0))}}),Object.defineProperty(U.ScaleManager.prototype,"pageAlignVertically",{get:function(){return this._pageAlignVertically},set:function(t){t!==this._pageAlignVertically&&(this._pageAlignVertically=t,this.queueUpdate(!0))}}),Object.defineProperty(U.ScaleManager.prototype,"isFullScreen",{get:function(){return!!(document.fullscreenElement||document.webkitFullscreenElement||document.mozFullScreenElement||document.msFullscreenElement)}}),Object.defineProperty(U.ScaleManager.prototype,"isPortrait",{get:function(){return"portrait"===this.classifyOrientation(this.screenOrientation)}}),Object.defineProperty(U.ScaleManager.prototype,"isLandscape",{get:function(){return"landscape"===this.classifyOrientation(this.screenOrientation)}}),Object.defineProperty(U.ScaleManager.prototype,"isGamePortrait",{get:function(){return this.height>this.width}}),Object.defineProperty(U.ScaleManager.prototype,"isGameLandscape",{get:function(){return this.width>this.height}}),U.Utils.Debug=function(t){this.game=t,this.sprite=null,this.bmd=null,this.canvas=null,this.context=null,this.font="14px Courier",this.columnWidth=100,this.lineHeight=16,this.renderShadow=!0,this.currentX=0,this.currentY=0,this.currentAlpha=1,this.dirty=!1},U.Utils.Debug.prototype={boot:function(){this.game.renderType===U.CANVAS?this.context=this.game.context:(this.bmd=new U.BitmapData(this.game,"__DEBUG",this.game.width,this.game.height,!0),this.sprite=this.game.make.image(0,0,this.bmd),this.game.stage.addChild(this.sprite),this.game.scale.onSizeChange.add(this.resize,this),this.canvas=PIXI.CanvasPool.create(this,this.game.width,this.game.height),this.context=this.canvas.getContext("2d"))},resize:function(t,e,i){this.bmd.resize(e,i),this.canvas.width=e,this.canvas.height=i},preUpdate:function(){this.dirty&&this.sprite&&(this.bmd.clear(),this.bmd.draw(this.canvas,0,0),this.context.clearRect(0,0,this.game.width,this.game.height),this.dirty=!1)},reset:function(){this.context&&this.context.clearRect(0,0,this.game.width,this.game.height),this.sprite&&this.bmd.clear()},start:function(t,e,i,n){"number"!=typeof e&&(e=0),i=i||"rgb(255,255,255)",void 0===n&&(n=0),this.currentX=t="number"!=typeof t?0:t,this.currentY=e,this.currentColor=i,this.columnWidth=n,this.dirty=!0,this.context.save(),this.context.setTransform(1,0,0,1,0,0),this.context.strokeStyle=i,this.context.fillStyle=i,this.context.font=this.font,this.context.globalAlpha=this.currentAlpha},stop:function(){this.context.restore()},line:function(){for(var t=this.currentX,e=0;e<arguments.length;e++)this.renderShadow&&(this.context.fillStyle="rgb(0,0,0)",this.context.fillText(arguments[e],t+1,this.currentY+1),this.context.fillStyle=this.currentColor),this.context.fillText(arguments[e],t,this.currentY),t+=this.columnWidth;this.currentY+=this.lineHeight},soundInfo:function(t,e,i,n){this.start(e,i,n),this.line("Sound: "+t.key+" Locked: "+t.game.sound.touchLocked),this.line("Is Ready?: "+this.game.cache.isSoundReady(t.key)+" Pending Playback: "+t.pendingPlayback),this.line("Decoded: "+t.isDecoded+" Decoding: "+t.isDecoding),this.line("Total Duration: "+t.totalDuration+" Playing: "+t.isPlaying),this.line("Time: "+t.currentTime),this.line("Volume: "+t.volume+" Muted: "+t.mute),this.line("WebAudio: "+t.usingWebAudio+" Audio: "+t.usingAudioTag),""!==t.currentMarker&&(this.line("Marker: "+t.currentMarker+" Duration: "+t.duration+" (ms: "+t.durationMS+")"),this.line("Start: "+t.markers[t.currentMarker].start+" Stop: "+t.markers[t.currentMarker].stop),this.line("Position: "+t.position)),this.stop()},cameraInfo:function(t,e,i,n){this.start(e,i,n),this.line("Camera ("+t.width+" x "+t.height+")"),this.line("X: "+t.x+" Y: "+t.y),t.bounds&&this.line("Bounds x: "+t.bounds.x+" Y: "+t.bounds.y+" w: "+t.bounds.width+" h: "+t.bounds.height),this.line("View x: "+t.view.x+" Y: "+t.view.y+" w: "+t.view.width+" h: "+t.view.height),this.line("Total in view: "+t.totalInView),this.stop()},timer:function(t,e,i,n){this.start(e,i,n),this.line("Timer (running: "+t.running+" expired: "+t.expired+")"),this.line("Next Tick: "+t.next+" Duration: "+t.duration),this.line("Paused: "+t.paused+" Length: "+t.length),this.stop()},pointer:function(t,e,i,n,r){null!=t&&(i=i||"rgba(0,255,0,0.5)",n=n||"rgba(255,0,0,0.5)",!0===(e=void 0===e?!1:e)&&!0===t.isUp||(this.start(t.x,t.y-100,r),this.context.beginPath(),this.context.arc(t.x,t.y,t.circle.radius,0,2*Math.PI),t.active?this.context.fillStyle=i:this.context.fillStyle=n,this.context.fill(),this.context.closePath(),this.context.beginPath(),this.context.moveTo(t.positionDown.x,t.positionDown.y),this.context.lineTo(t.position.x,t.position.y),this.context.lineWidth=2,this.context.stroke(),this.context.closePath(),this.line("ID: "+t.id+" Active: "+t.active),this.line("World X: "+t.worldX+" World Y: "+t.worldY),this.line("Screen X: "+t.x+" Screen Y: "+t.y+" In: "+t.withinGame),this.line("Duration: "+t.duration+" ms"),this.line("is Down: "+t.isDown+" is Up: "+t.isUp),this.stop()))},spriteInputInfo:function(t,e,i,n){this.start(e,i,n),this.line("Sprite Input: ("+t.width+" x "+t.height+")"),this.line("x: "+t.input.pointerX().toFixed(1)+" y: "+t.input.pointerY().toFixed(1)),this.line("over: "+t.input.pointerOver()+" duration: "+t.input.overDuration().toFixed(0)),this.line("down: "+t.input.pointerDown()+" duration: "+t.input.downDuration().toFixed(0)),this.line("just over: "+t.input.justOver()+" just out: "+t.input.justOut()),this.stop()},key:function(t,e,i,n){this.start(e,i,n,150),this.line("Key:",t.keyCode,"isDown:",t.isDown),this.line("justDown:",t.justDown,"justUp:",t.justUp),this.line("Time Down:",t.timeDown.toFixed(0),"duration:",t.duration.toFixed(0)),this.stop()},inputInfo:function(t,e,i){this.start(t,e,i),this.line("Input"),this.line("X: "+this.game.input.x+" Y: "+this.game.input.y),this.line("World X: "+this.game.input.worldX+" World Y: "+this.game.input.worldY),this.line("Scale X: "+this.game.input.scale.x.toFixed(1)+" Scale Y: "+this.game.input.scale.x.toFixed(1)),this.line("Screen X: "+this.game.input.activePointer.screenX+" Screen Y: "+this.game.input.activePointer.screenY),this.stop()},spriteBounds:function(t,e,i){t=t.getBounds();t.x+=this.game.camera.x,t.y+=this.game.camera.y,this.rectangle(t,e,i)},ropeSegments:function(t,e,i){var n=this;t.segments.forEach(function(t){n.rectangle(t,e,i)},this)},spriteInfo:function(t,e,i,n){this.start(e,i,n),this.line("Sprite:  ("+t.width+" x "+t.height+") anchor: "+t.anchor.x+" x "+t.anchor.y),this.line("x: "+t.x.toFixed(1)+" y: "+t.y.toFixed(1)),this.line("angle: "+t.angle.toFixed(1)+" rotation: "+t.rotation.toFixed(1)),this.line("visible: "+t.visible+" in camera: "+t.inCamera),this.line("bounds x: "+t._bounds.x.toFixed(1)+" y: "+t._bounds.y.toFixed(1)+" w: "+t._bounds.width.toFixed(1)+" h: "+t._bounds.height.toFixed(1)),this.stop()},spriteCoords:function(t,e,i,n){this.start(e,i,n,100),t.name&&this.line(t.name),this.line("x:",t.x.toFixed(2),"y:",t.y.toFixed(2)),this.line("pos x:",t.position.x.toFixed(2),"pos y:",t.position.y.toFixed(2)),this.line("world x:",t.world.x.toFixed(2),"world y:",t.world.y.toFixed(2)),this.stop()},lineInfo:function(t,e,i,n){this.start(e,i,n,80),this.line("start.x:",t.start.x.toFixed(2),"start.y:",t.start.y.toFixed(2)),this.line("end.x:",t.end.x.toFixed(2),"end.y:",t.end.y.toFixed(2)),this.line("length:",t.length.toFixed(2),"angle:",t.angle),this.stop()},pixel:function(t,e,i,n){n=n||2,this.start(),this.context.fillStyle=i,this.context.fillRect(t,e,n,n),this.stop()},geom:function(t,e,i,n){void 0===i&&(i=!0),void 0===n&&(n=0),e=e||"rgba(0,255,0,0.4)",this.start(),this.context.fillStyle=e,this.context.strokeStyle=e,t instanceof U.Rectangle||1===n?i?this.context.fillRect(t.x-this.game.camera.x,t.y-this.game.camera.y,t.width,t.height):this.context.strokeRect(t.x-this.game.camera.x,t.y-this.game.camera.y,t.width,t.height):t instanceof U.Circle||2===n?(this.context.beginPath(),this.context.arc(t.x-this.game.camera.x,t.y-this.game.camera.y,t.radius,0,2*Math.PI,!1),this.context.closePath(),i?this.context.fill():this.context.stroke()):t instanceof U.Point||3===n?this.context.fillRect(t.x-this.game.camera.x,t.y-this.game.camera.y,4,4):(t instanceof U.Line||4===n)&&(this.context.lineWidth=1,this.context.beginPath(),this.context.moveTo(t.start.x+.5-this.game.camera.x,t.start.y+.5-this.game.camera.y),this.context.lineTo(t.end.x+.5-this.game.camera.x,t.end.y+.5-this.game.camera.y),this.context.closePath(),this.context.stroke()),this.stop()},rectangle:function(t,e,i){void 0===i&&(i=!0),e=e||"rgba(0, 255, 0, 0.4)",this.start(),i?(this.context.fillStyle=e,this.context.fillRect(t.x-this.game.camera.x,t.y-this.game.camera.y,t.width,t.height)):(this.context.strokeStyle=e,this.context.strokeRect(t.x-this.game.camera.x,t.y-this.game.camera.y,t.width,t.height)),this.stop()},text:function(t,e,i,n,r){n=n||"rgb(255,255,255)",r=r||"16px Courier",this.start(),this.context.font=r,this.renderShadow&&(this.context.fillStyle="rgb(0,0,0)",this.context.fillText(t,e+1,i+1)),this.context.fillStyle=n,this.context.fillText(t,e,i),this.stop()},quadTree:function(t,e){e=e||"rgba(255,0,0,0.3)",this.start();var i=t.bounds;if(0===t.nodes.length){this.context.strokeStyle=e,this.context.strokeRect(i.x,i.y,i.width,i.height),this.text("size: "+t.objects.length,i.x+4,i.y+16,"rgb(0,200,0)","12px Courier"),this.context.strokeStyle="rgb(0,255,0)";for(var n=0;n<t.objects.length;n++)this.context.strokeRect(t.objects[n].x,t.objects[n].y,t.objects[n].width,t.objects[n].height)}else for(n=0;n<t.nodes.length;n++)this.quadTree(t.nodes[n]);this.stop()},body:function(t,e,i){t.body&&(this.start(),t.body.type===U.Physics.ARCADE?U.Physics.Arcade.Body.render(this.context,t.body,e,i):t.body.type===U.Physics.NINJA?U.Physics.Ninja.Body.render(this.context,t.body,e,i):t.body.type===U.Physics.BOX2D&&U.Physics.Box2D.renderBody(this.context,t.body,e),this.stop())},bodyInfo:function(t,e,i,n){t.body&&(this.start(e,i,n,210),t.body.type===U.Physics.ARCADE?U.Physics.Arcade.Body.renderBodyInfo(this,t.body):t.body.type===U.Physics.BOX2D&&this.game.physics.box2d.renderBodyInfo(this,t.body),this.stop())},box2dWorld:function(){this.start(),this.context.translate(-this.game.camera.view.x,-this.game.camera.view.y,0),this.game.physics.box2d.renderDebugDraw(this.context),this.stop()},box2dBody:function(t,e){this.start(),U.Physics.Box2D.renderBody(this.context,t,e),this.stop()},displayList:function(t){if((t=void 0===t?this.game.world:t).hasOwnProperty("renderOrderID"),t.children&&0<t.children.length)for(var e=0;e<t.children.length;e++)this.game.debug.displayList(t.children[e])},destroy:function(){PIXI.CanvasPool.remove(this)}},U.Utils.Debug.prototype.constructor=U.Utils.Debug,U.DOM={getOffset:function(t,e){e=e||new U.Point;var i=t.getBoundingClientRect(),n=U.DOM.scrollY,r=U.DOM.scrollX,o=document.documentElement.clientTop,t=document.documentElement.clientLeft;return e.x=i.left+r-t,e.y=i.top+n-o,e},getBounds:function(t,e){return void 0===e&&(e=0),!(!(t=t&&!t.nodeType?t[0]:t)||1!==t.nodeType)&&this.calibrate(t.getBoundingClientRect(),e)},calibrate:function(t,e){var i={width:0,height:0,left:0,right:0,top:0,bottom:0};return i.width=(i.right=t.right+(e=+e||0))-(i.left=t.left-e),i.height=(i.bottom=t.bottom+e)-(i.top=t.top-e),i},getAspectRatio:function(t){var e=(t=null==t?this.visualBounds:1===t.nodeType?this.getBounds(t):t).width,i=t.height;return(e="function"==typeof e?e.call(t):e)/(i="function"==typeof i?i.call(t):i)},inLayoutViewport:function(t,e){e=this.getBounds(t,e);return!!e&&0<=e.bottom&&0<=e.right&&e.top<=this.layoutBounds.width&&e.left<=this.layoutBounds.height},getScreenOrientation:function(t){var e=window.screen,i=e.orientation||e.mozOrientation||e.msOrientation;if(i&&"string"==typeof i.type)return i.type;if("string"==typeof i)return i;var n="portrait-primary",i="landscape-primary";if("screen"===t)return e.height>e.width?n:i;if("viewport"===t)return this.visualBounds.height>this.visualBounds.width?n:i;if("window.orientation"===t&&"number"==typeof window.orientation)return 0===window.orientation||180===window.orientation?n:i;if(window.matchMedia){if(window.matchMedia("(orientation: portrait)").matches)return n;if(window.matchMedia("(orientation: landscape)").matches)return i}return this.visualBounds.height>this.visualBounds.width?n:i},visualBounds:new U.Rectangle,layoutBounds:new U.Rectangle,documentBounds:new U.Rectangle},U.Device.whenReady(function(t){var e=window&&"pageXOffset"in window?function(){return window.pageXOffset}:function(){return document.documentElement.scrollLeft},i=window&&"pageYOffset"in window?function(){return window.pageYOffset}:function(){return document.documentElement.scrollTop};Object.defineProperty(U.DOM,"scrollX",{get:e}),Object.defineProperty(U.DOM,"scrollY",{get:i}),Object.defineProperty(U.DOM.visualBounds,"x",{get:e}),Object.defineProperty(U.DOM.visualBounds,"y",{get:i}),Object.defineProperty(U.DOM.layoutBounds,"x",{value:0}),Object.defineProperty(U.DOM.layoutBounds,"y",{value:0}),t.desktop&&document.documentElement.clientWidth<=window.innerWidth&&document.documentElement.clientHeight<=window.innerHeight?(i=function(){return Math.max(window.innerWidth,document.documentElement.clientWidth)},t=function(){return Math.max(window.innerHeight,document.documentElement.clientHeight)},Object.defineProperty(U.DOM.visualBounds,"width",{get:i}),Object.defineProperty(U.DOM.visualBounds,"height",{get:t}),Object.defineProperty(U.DOM.layoutBounds,"width",{get:i}),Object.defineProperty(U.DOM.layoutBounds,"height",{get:t})):(Object.defineProperty(U.DOM.visualBounds,"width",{get:function(){return window.innerWidth}}),Object.defineProperty(U.DOM.visualBounds,"height",{get:function(){return window.innerHeight}}),Object.defineProperty(U.DOM.layoutBounds,"width",{get:function(){var t=document.documentElement.clientWidth,e=window.innerWidth;return t<e?e:t}}),Object.defineProperty(U.DOM.layoutBounds,"height",{get:function(){var t=document.documentElement.clientHeight,e=window.innerHeight;return t<e?e:t}})),Object.defineProperty(U.DOM.documentBounds,"x",{value:0}),Object.defineProperty(U.DOM.documentBounds,"y",{value:0}),Object.defineProperty(U.DOM.documentBounds,"width",{get:function(){var t=document.documentElement;return Math.max(t.clientWidth,t.offsetWidth,t.scrollWidth)}}),Object.defineProperty(U.DOM.documentBounds,"height",{get:function(){var t=document.documentElement;return Math.max(t.clientHeight,t.offsetHeight,t.scrollHeight)}})},null,!0),U.ArraySet=function(t){this.position=0,this.list=t||[]},U.ArraySet.prototype={add:function(t){return this.exists(t)||this.list.push(t),t},getIndex:function(t){return this.list.indexOf(t)},getByKey:function(t,e){for(var i=this.list.length;i--;)if(this.list[i][t]===e)return this.list[i];return null},exists:function(t){return-1<this.list.indexOf(t)},reset:function(){this.list.length=0},remove:function(t){var e=this.list.indexOf(t);if(-1<e)return this.list.splice(e,1),t},setAll:function(t,e){for(var i=this.list.length;i--;)this.list[i]&&(this.list[i][t]=e)},callAll:function(t){for(var e=Array.prototype.slice.call(arguments,1),i=this.list.length;i--;)this.list[i]&&this.list[i][t]&&this.list[i][t].apply(this.list[i],e)},removeAll:function(t){void 0===t&&(t=!1);for(var e,i=this.list.length;i--;)this.list[i]&&(e=this.remove(this.list[i]),t&&e.destroy());this.position=0,this.list=[]}},Object.defineProperty(U.ArraySet.prototype,"total",{get:function(){return this.list.length}}),Object.defineProperty(U.ArraySet.prototype,"first",{get:function(){return(this.position=0)<this.list.length?this.list[0]:null}}),Object.defineProperty(U.ArraySet.prototype,"next",{get:function(){return this.position<this.list.length?(this.position++,this.list[this.position]):null}}),U.ArraySet.prototype.constructor=U.ArraySet,U.ArrayUtils={getRandomItem:function(t,e,i){if(null===t)return null;void 0===i&&(i=t.length);i=(e=void 0===e?0:e)+Math.floor(Math.random()*i);return void 0===t[i]?null:t[i]},removeRandomItem:function(t,e,i){if(null==t)return null;void 0===i&&(i=t.length);i=(e=void 0===e?0:e)+Math.floor(Math.random()*i);if(i<t.length){i=t.splice(i,1);return void 0===i[0]?null:i[0]}return null},shuffle:function(t){for(var e=t.length-1;0<e;e--){var i=Math.floor(Math.random()*(e+1)),n=t[e];t[e]=t[i],t[i]=n}return t},transposeMatrix:function(t){for(var e=t.length,i=t[0].length,n=new Array(i),r=0;r<i;r++){n[r]=new Array(e);for(var o=e-1;-1<o;o--)n[r][o]=t[o][r]}return n},rotateMatrix:function(t,e){if(90===(e="string"!=typeof e?(e%360+360)%360:e)||-270===e||"rotateLeft"===e)t=(t=U.ArrayUtils.transposeMatrix(t)).reverse();else if(-90===e||270===e||"rotateRight"===e)t=t.reverse(),t=U.ArrayUtils.transposeMatrix(t);else if(180===Math.abs(e)||"rotate180"===e){for(var i=0;i<t.length;i++)t[i].reverse();t=t.reverse()}return t},findClosest:function(t,e){if(!e.length)return NaN;if(1===e.length||t<e[0])return e[0];for(var i=1;e[i]<t;)i++;var n=e[i-1],r=i<e.length?e[i]:Number.POSITIVE_INFINITY;return r-t<=t-n?r:n},rotateRight:function(t){var e=t.pop();return t.unshift(e),e},rotateLeft:function(t){var e=t.shift();return t.push(e),e},rotate:function(t){var e=t.shift();return t.push(e),e},numberArray:function(t,e){for(var i=[],n=t;n<=e;n++)i.push(n);return i},numberArrayStep:function(t,e,i){null!=t||(t=0),null!=e||(e=t,t=0),void 0===i&&(i=1);for(var n=[],r=Math.max(U.Math.roundAwayFromZero((e-t)/(i||1)),0),o=0;o<r;o++)n.push(t),t+=i;return n}},U.LinkedList=function(){this.next=null,this.prev=null,this.first=null,this.last=null,this.total=0},U.LinkedList.prototype={add:function(t){return 0===this.total&&null===this.first&&null===this.last?(this.first=t,this.last=t,(this.next=t).prev=this):((this.last.next=t).prev=this.last,this.last=t),this.total++,t},reset:function(){this.first=null,this.last=null,this.next=null,this.prev=null,this.total=0},remove:function(t){if(1===this.total)return this.reset(),void(t.next=t.prev=null);t===this.first?this.first=this.first.next:t===this.last&&(this.last=this.last.prev),t.prev&&(t.prev.next=t.next),t.next&&(t.next.prev=t.prev),(t.next=t.prev=null)===this.first&&(this.last=null),this.total--},callAll:function(t){if(this.first&&this.last)for(var e=this.first;e&&e[t]&&e[t].call(e),(e=e.next)!==this.last.next;);}},U.LinkedList.prototype.constructor=U.LinkedList,U.Create=function(t){this.game=t,this.bmd=null,this.canvas=null,this.ctx=null,this.palettes=[{0:"#000",1:"#9D9D9D",2:"#FFF",3:"#BE2633",4:"#E06F8B",5:"#493C2B",6:"#A46422",7:"#EB8931",8:"#F7E26B",9:"#2F484E",A:"#44891A",B:"#A3CE27",C:"#1B2632",D:"#005784",E:"#31A2F2",F:"#B2DCEF"},{0:"#000",1:"#191028",2:"#46af45",3:"#a1d685",4:"#453e78",5:"#7664fe",6:"#833129",7:"#9ec2e8",8:"#dc534b",9:"#e18d79",A:"#d6b97b",B:"#e9d8a1",C:"#216c4b",D:"#d365c8",E:"#afaab9",F:"#f5f4eb"},{0:"#000",1:"#2234d1",2:"#0c7e45",3:"#44aacc",4:"#8a3622",5:"#5c2e78",6:"#aa5c3d",7:"#b5b5b5",8:"#5e606e",9:"#4c81fb",A:"#6cd947",B:"#7be2f9",C:"#eb8a60",D:"#e23d69",E:"#ffd93f",F:"#fff"},{0:"#000",1:"#fff",2:"#8b4131",3:"#7bbdc5",4:"#8b41ac",5:"#6aac41",6:"#3931a4",7:"#d5de73",8:"#945a20",9:"#5a4100",A:"#bd736a",B:"#525252",C:"#838383",D:"#acee8b",E:"#7b73de",F:"#acacac"},{0:"#000",1:"#191028",2:"#46af45",3:"#a1d685",4:"#453e78",5:"#7664fe",6:"#833129",7:"#9ec2e8",8:"#dc534b",9:"#e18d79",A:"#d6b97b",B:"#e9d8a1",C:"#216c4b",D:"#d365c8",E:"#afaab9",F:"#fff"}]},U.Create.PALETTE_ARNE=0,U.Create.PALETTE_JMP=1,U.Create.PALETTE_CGA=2,U.Create.PALETTE_C64=3,U.Create.PALETTE_JAPANESE_MACHINE=4,U.Create.prototype={texture:function(t,e,i,n,r){void 0===i&&(i=8),void 0===n&&(n=i),void 0===r&&(r=0);var o=e[0].length*i,s=e.length*n;null===this.bmd&&(this.bmd=this.game.make.bitmapData(),this.canvas=this.bmd.canvas,this.ctx=this.bmd.context),this.bmd.resize(o,s),this.bmd.clear();for(var a=0;a<e.length;a++)for(var h=e[a],l=0;l<h.length;l++){var p=h[l];"."!==p&&" "!==p&&(this.ctx.fillStyle=this.palettes[r][p],this.ctx.fillRect(l*i,a*n,i,n))}return this.bmd.generateTexture(t)},grid:function(t,e,i,n,r,o){null===this.bmd&&(this.bmd=this.game.make.bitmapData(),this.canvas=this.bmd.canvas,this.ctx=this.bmd.context),this.bmd.resize(e,i),this.ctx.fillStyle=o;for(var s=0;s<i;s+=r)this.ctx.fillRect(0,s,e,1);for(var a=0;a<e;a+=n)this.ctx.fillRect(a,0,1,i);return this.bmd.generateTexture(t)}},U.Create.prototype.constructor=U.Create,U.FlexGrid=function(t,e,i){this.game=t.game,this.manager=t,this.width=e,this.height=i,this.boundsCustom=new U.Rectangle(0,0,e,i),this.boundsFluid=new U.Rectangle(0,0,e,i),this.boundsFull=new U.Rectangle(0,0,e,i),this.boundsNone=new U.Rectangle(0,0,e,i),this.positionCustom=new U.Point(0,0),this.positionFluid=new U.Point(0,0),this.positionFull=new U.Point(0,0),this.positionNone=new U.Point(0,0),this.scaleCustom=new U.Point(1,1),this.scaleFluid=new U.Point(1,1),this.scaleFluidInversed=new U.Point(1,1),this.scaleFull=new U.Point(1,1),this.scaleNone=new U.Point(1,1),this.customWidth=0,this.customHeight=0,this.customOffsetX=0,this.customOffsetY=0,this.ratioH=e/i,this.ratioV=i/e,this.multiplier=0,this.layers=[]},U.FlexGrid.prototype={setSize:function(t,e){this.width=t,this.height=e,this.ratioH=t/e,this.ratioV=e/t,this.scaleNone=new U.Point(1,1),this.boundsNone.width=this.width,this.boundsNone.height=this.height,this.refresh()},createCustomLayer:function(t,e,i,n){void 0===n&&(n=!0),this.customWidth=t,this.customHeight=e,this.boundsCustom.width=t,this.boundsCustom.height=e;e=new U.FlexLayer(this,this.positionCustom,this.boundsCustom,this.scaleCustom);return n&&this.game.world.add(e),this.layers.push(e),void 0!==i&&null!==typeof i&&e.addMultiple(i),e},createFluidLayer:function(t,e){void 0===e&&(e=!0);var i=new U.FlexLayer(this,this.positionFluid,this.boundsFluid,this.scaleFluid);return e&&this.game.world.add(i),this.layers.push(i),void 0!==t&&null!==typeof t&&i.addMultiple(t),i},createFullLayer:function(t){var e=new U.FlexLayer(this,this.positionFull,this.boundsFull,this.scaleFluid);return this.game.world.add(e),this.layers.push(e),void 0!==t&&e.addMultiple(t),e},createFixedLayer:function(t){var e=new U.FlexLayer(this,this.positionNone,this.boundsNone,this.scaleNone);return this.game.world.add(e),this.layers.push(e),void 0!==t&&e.addMultiple(t),e},reset:function(){for(var t=this.layers.length;t--;)this.layers[t].persist||(this.layers[t].position=null,this.layers[t].scale=null,this.layers.slice(t,1))},onResize:function(t,e){this.ratioH=t/e,this.ratioV=e/t,this.refresh(t,e)},refresh:function(){this.multiplier=Math.min(this.manager.height/this.height,this.manager.width/this.width),this.boundsFluid.width=Math.round(this.width*this.multiplier),this.boundsFluid.height=Math.round(this.height*this.multiplier),this.scaleFluid.set(this.boundsFluid.width/this.width,this.boundsFluid.height/this.height),this.scaleFluidInversed.set(this.width/this.boundsFluid.width,this.height/this.boundsFluid.height),this.scaleFull.set(this.boundsFull.width/this.width,this.boundsFull.height/this.height),this.boundsFull.width=Math.round(this.manager.width*this.scaleFluidInversed.x),this.boundsFull.height=Math.round(this.manager.height*this.scaleFluidInversed.y),this.boundsFluid.centerOn(this.manager.bounds.centerX,this.manager.bounds.centerY),this.boundsNone.centerOn(this.manager.bounds.centerX,this.manager.bounds.centerY),this.positionFluid.set(this.boundsFluid.x,this.boundsFluid.y),this.positionNone.set(this.boundsNone.x,this.boundsNone.y)},fitSprite:function(t){this.manager.scaleSprite(t),t.x=this.manager.bounds.centerX,t.y=this.manager.bounds.centerY},debug:function(){this.game.debug.text(this.boundsFluid.width+" x "+this.boundsFluid.height,this.boundsFluid.x+4,this.boundsFluid.y+16),this.game.debug.geom(this.boundsFluid,"rgba(255,0,0,0.9",!1)}},U.FlexGrid.prototype.constructor=U.FlexGrid,U.FlexLayer=function(t,e,i,n){U.Group.call(this,t.game,null,"__flexLayer"+t.game.rnd.uuid(),!1),this.manager=t.manager,this.grid=t,this.persist=!1,this.position=e,this.bounds=i,this.scale=n,this.topLeft=i.topLeft,this.topMiddle=new U.Point(i.halfWidth,0),this.topRight=i.topRight,this.bottomLeft=i.bottomLeft,this.bottomMiddle=new U.Point(i.halfWidth,i.bottom),this.bottomRight=i.bottomRight},U.FlexLayer.prototype=Object.create(U.Group.prototype),U.FlexLayer.prototype.constructor=U.FlexLayer,U.FlexLayer.prototype.resize=function(){},U.FlexLayer.prototype.debug=function(){this.game.debug.text(this.bounds.width+" x "+this.bounds.height,this.bounds.x+4,this.bounds.y+16),this.game.debug.geom(this.bounds,"rgba(0,0,255,0.9",!1),this.game.debug.geom(this.topLeft,"rgba(255,255,255,0.9"),this.game.debug.geom(this.topMiddle,"rgba(255,255,255,0.9"),this.game.debug.geom(this.topRight,"rgba(255,255,255,0.9")},U.Color={packPixel:function(t,e,i,n){return U.Device.LITTLE_ENDIAN?(n<<24|i<<16|e<<8|t)>>>0:(t<<24|e<<16|i<<8|n)>>>0},unpackPixel:function(t,e,i,n){return null!=e||(e=U.Color.createColor()),null!=i||(i=!1),null!=n||(n=!1),U.Device.LITTLE_ENDIAN?(e.a=(4278190080&t)>>>24,e.b=(16711680&t)>>>16,e.g=(65280&t)>>>8,e.r=255&t):(e.r=(4278190080&t)>>>24,e.g=(16711680&t)>>>16,e.b=(65280&t)>>>8,e.a=255&t),e.color=t,e.rgba="rgba("+e.r+","+e.g+","+e.b+","+e.a/255+")",i&&U.Color.RGBtoHSL(e.r,e.g,e.b,e),n&&U.Color.RGBtoHSV(e.r,e.g,e.b,e),e},fromRGBA:function(t,e){return(e=e||U.Color.createColor()).r=(4278190080&t)>>>24,e.g=(16711680&t)>>>16,e.b=(65280&t)>>>8,e.a=255&t,e.rgba="rgba("+e.r+","+e.g+","+e.b+","+e.a+")",e},toRGBA:function(t,e,i,n){return t<<24|e<<16|i<<8|n},toABGR:function(t,e,i,n){return(n<<24|i<<16|e<<8|t)>>>0},RGBtoHSL:function(t,e,i,n){n=n||U.Color.createColor(t,e,i,1),t/=255,e/=255,i/=255;var r,o=Math.min(t,e,i),s=Math.max(t,e,i);return n.h=0,n.s=0,n.l=(s+o)/2,s!==o&&(r=s-o,n.s=.5<n.l?r/(2-s-o):r/(s+o),s===t?n.h=(e-i)/r+(e<i?6:0):s===e?n.h=(i-t)/r+2:s===i&&(n.h=(t-e)/r+4),n.h/=6),n},HSLtoRGB:function(t,e,i,n){return n?(n.r=i,n.g=i,n.b=i):n=U.Color.createColor(i,i,i),0!==e&&(n.r=U.Color.hueToColor(e=2*i-(i=i<.5?i*(1+e):i+e-i*e),i,t+1/3),n.g=U.Color.hueToColor(e,i,t),n.b=U.Color.hueToColor(e,i,t-1/3)),n.r=Math.floor(255*n.r|0),n.g=Math.floor(255*n.g|0),n.b=Math.floor(255*n.b|0),U.Color.updateColor(n),n},RGBtoHSV:function(t,e,i,n){n=n||U.Color.createColor(t,e,i,255),t/=255,e/=255,i/=255;var r=Math.min(t,e,i),o=Math.max(t,e,i),s=o-r;return n.h=0,n.s=0===o?0:s/o,(n.v=o)!==r&&(o===t?n.h=(e-i)/s+(e<i?6:0):o===e?n.h=(i-t)/s+2:o===i&&(n.h=(t-e)/s+4),n.h/=6),n},HSVtoRGB:function(t,e,i,n){void 0===n&&(n=U.Color.createColor(0,0,0,1,t,e,0,i));var r,o,s,a=Math.floor(6*t),t=6*t-a,h=i*(1-e),l=i*(1-t*e),p=i*(1-(1-t)*e);switch(a%6){case 0:r=i,o=p,s=h;break;case 1:r=l,o=i,s=h;break;case 2:r=h,o=i,s=p;break;case 3:r=h,o=l,s=i;break;case 4:r=p,o=h,s=i;break;case 5:r=i,o=h,s=l}return n.r=Math.floor(255*r),n.g=Math.floor(255*o),n.b=Math.floor(255*s),U.Color.updateColor(n),n},hueToColor:function(t,e,i){return i<0&&(i+=1),1<i&&--i,i<1/6?t+6*(e-t)*i:i<.5?e:i<2/3?t+(e-t)*(2/3-i)*6:t},createColor:function(t,e,i,n,r,o,s,a){return U.Color.updateColor({r:t||0,g:e||0,b:i||0,a:n||1,h:r||0,s:o||0,l:s||0,v:a||0,color:0,color32:0,rgba:""})},updateColor:function(t){return t.rgba="rgba("+t.r.toString()+","+t.g.toString()+","+t.b.toString()+","+t.a.toString()+")",t.color=U.Color.getColor(t.r,t.g,t.b),t.color32=U.Color.getColor32(255*t.a,t.r,t.g,t.b),t},getColor32:function(t,e,i,n){return t<<24|e<<16|i<<8|n},getColor:function(t,e,i){return t<<16|e<<8|i},RGBtoString:function(t,e,i,n,r){return void 0===n&&(n=255),"#"===(r=void 0===r?"#":r)?"#"+((1<<24)+(t<<16)+(e<<8)+i).toString(16).slice(1):"0x"+U.Color.componentToHex(n)+U.Color.componentToHex(t)+U.Color.componentToHex(e)+U.Color.componentToHex(i)},hexToRGB:function(t){t=U.Color.hexToColor(t);if(t)return U.Color.getColor32(t.a,t.r,t.g,t.b)},hexToColor:function(t,e){t=t.replace(/^(?:#|0x)?([a-f\d])([a-f\d])([a-f\d])$/i,function(t,e,i,n){return e+e+i+i+n+n});var i,n=/^(?:#|0x)?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(t);return n&&(i=parseInt(n[1],16),t=parseInt(n[2],16),n=parseInt(n[3],16),e?(e.r=i,e.g=t,e.b=n):e=U.Color.createColor(i,t,n)),e},webToColor:function(t,e){e=e||U.Color.createColor();t=/^rgba?\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d+(?:\.\d+)?))?\s*\)$/.exec(t);return t&&(e.r=parseInt(t[1],10),e.g=parseInt(t[2],10),e.b=parseInt(t[3],10),e.a=void 0!==t[4]?parseFloat(t[4]):1,U.Color.updateColor(e)),e},valueToColor:function(t,e){if(e=e||U.Color.createColor(),"string"==typeof t)return 0===t.indexOf("rgb")?U.Color.webToColor(t,e):(e.a=1,U.Color.hexToColor(t,e));if("number"!=typeof t)return e;t=U.Color.getRGB(t);return e.r=t.r,e.g=t.g,e.b=t.b,e.a=t.a/255,e},componentToHex:function(t){t=t.toString(16);return 1===t.length?"0"+t:t},HSVColorWheel:function(t,e){void 0===t&&(t=1),void 0===e&&(e=1);for(var i=[],n=0;n<=359;n++)i.push(U.Color.HSVtoRGB(n/359,t,e));return i},HSLColorWheel:function(t,e){void 0===t&&(t=.5),void 0===e&&(e=.5);for(var i=[],n=0;n<=359;n++)i.push(U.Color.HSLtoRGB(n/359,t,e));return i},interpolateColor:function(t,e,i,n,r){void 0===r&&(r=255);var o=U.Color.getRGB(t),s=U.Color.getRGB(e),t=(s.red-o.red)*n/i+o.red,e=(s.green-o.green)*n/i+o.green,o=(s.blue-o.blue)*n/i+o.blue;return U.Color.getColor32(r,t,e,o)},interpolateColorWithRGB:function(t,e,i,n,r,o){t=U.Color.getRGB(t),e=(e-t.red)*o/r+t.red,i=(i-t.green)*o/r+t.green,t=(n-t.blue)*o/r+t.blue;return U.Color.getColor(e,i,t)},interpolateRGB:function(t,e,i,n,r,o,s,a){return U.Color.getColor((n-t)*a/s+t,(r-e)*a/s+e,(o-i)*a/s+i)},getRandomColor:function(t,e,i){if(void 0===t&&(t=0),void 0===i&&(i=255),255<(e=void 0===e?255:e)||e<t)return U.Color.getColor(255,255,255);var n=t+Math.round(Math.random()*(e-t)),r=t+Math.round(Math.random()*(e-t)),t=t+Math.round(Math.random()*(e-t));return U.Color.getColor32(i,n,r,t)},getRGB:function(t){return 16777215<t?{alpha:t>>>24,red:t>>16&255,green:t>>8&255,blue:255&t,a:t>>>24,r:t>>16&255,g:t>>8&255,b:255&t}:{alpha:255,red:t>>16&255,green:t>>8&255,blue:255&t,a:255,r:t>>16&255,g:t>>8&255,b:255&t}},getWebRGB:function(t){if("object"==typeof t)return"rgba("+t.r.toString()+","+t.g.toString()+","+t.b.toString()+","+(t.a/255).toString()+")";t=U.Color.getRGB(t);return"rgba("+t.r.toString()+","+t.g.toString()+","+t.b.toString()+","+(t.a/255).toString()+")"},getAlpha:function(t){return t>>>24},getAlphaFloat:function(t){return(t>>>24)/255},getRed:function(t){return t>>16&255},getGreen:function(t){return t>>8&255},getBlue:function(t){return 255&t},blendNormal:function(t){return t},blendLighten:function(t,e){return t<e?e:t},blendDarken:function(t,e){return t<e?t:e},blendMultiply:function(t,e){return t*e/255},blendAverage:function(t,e){return(t+e)/2},blendAdd:function(t,e){return Math.min(255,t+e)},blendSubtract:function(t,e){return Math.max(0,t+e-255)},blendDifference:function(t,e){return Math.abs(t-e)},blendNegation:function(t,e){return 255-Math.abs(255-t-e)},blendScreen:function(t,e){return 255-((255-t)*(255-e)>>8)},blendExclusion:function(t,e){return t+e-2*t*e/255},blendOverlay:function(t,e){return e<128?2*t*e/255:255-2*(255-t)*(255-e)/255},blendSoftLight:function(t,e){return e<128?2*(64+(t>>1))*(e/255):255-2*(255-(64+(t>>1)))*(255-e)/255},blendHardLight:function(t,e){return U.Color.blendOverlay(e,t)},blendColorDodge:function(t,e){return 255===e?e:Math.min(255,(t<<8)/(255-e))},blendColorBurn:function(t,e){return 0===e?e:Math.max(0,255-(255-t<<8)/e)},blendLinearDodge:function(t,e){return U.Color.blendAdd(t,e)},blendLinearBurn:function(t,e){return U.Color.blendSubtract(t,e)},blendLinearLight:function(t,e){return e<128?U.Color.blendLinearBurn(t,2*e):U.Color.blendLinearDodge(t,2*(e-128))},blendVividLight:function(t,e){return e<128?U.Color.blendColorBurn(t,2*e):U.Color.blendColorDodge(t,2*(e-128))},blendPinLight:function(t,e){return e<128?U.Color.blendDarken(t,2*e):U.Color.blendLighten(t,2*(e-128))},blendHardMix:function(t,e){return U.Color.blendVividLight(t,e)<128?0:255},blendReflect:function(t,e){return 255===e?e:Math.min(255,t*t/(255-e))},blendGlow:function(t,e){return U.Color.blendReflect(e,t)},blendPhoenix:function(t,e){return Math.min(t,e)-Math.max(t,e)+255}},U.Physics=function(t,e){e=e||{},this.game=t,this.config=e,this.arcade=null,this.p2=null,this.ninja=null,this.box2d=null,this.chipmunk=null,this.matter=null,this.parseConfig()},U.Physics.ARCADE=0,U.Physics.P2JS=1,U.Physics.NINJA=2,U.Physics.BOX2D=3,U.Physics.CHIPMUNK=4,U.Physics.MATTERJS=5,U.Physics.prototype={parseConfig:function(){this.config.hasOwnProperty("arcade")&&!0!==this.config.arcade||!U.Physics.hasOwnProperty("Arcade")||(this.arcade=new U.Physics.Arcade(this.game)),this.config.hasOwnProperty("ninja")&&!0===this.config.ninja&&U.Physics.hasOwnProperty("Ninja")&&(this.ninja=new U.Physics.Ninja(this.game)),this.config.hasOwnProperty("p2")&&!0===this.config.p2&&U.Physics.hasOwnProperty("P2")&&(this.p2=new U.Physics.P2(this.game,this.config)),this.config.hasOwnProperty("box2d")&&!0===this.config.box2d&&U.Physics.hasOwnProperty("BOX2D")&&(this.box2d=new U.Physics.BOX2D(this.game,this.config)),this.config.hasOwnProperty("matter")&&!0===this.config.matter&&U.Physics.hasOwnProperty("Matter")&&(this.matter=new U.Physics.Matter(this.game,this.config))},startSystem:function(t){t===U.Physics.ARCADE?this.arcade=new U.Physics.Arcade(this.game):t===U.Physics.P2JS?null===this.p2?this.p2=new U.Physics.P2(this.game,this.config):this.p2.reset():t===U.Physics.NINJA?this.ninja=new U.Physics.Ninja(this.game):t===U.Physics.BOX2D?null===this.box2d?this.box2d=new U.Physics.Box2D(this.game,this.config):this.box2d.reset():t===U.Physics.MATTERJS&&(null===this.matter?this.matter=new U.Physics.Matter(this.game,this.config):this.matter.reset())},enable:function(t,e,i){void 0===i&&(i=!1),(e=void 0===e?U.Physics.ARCADE:e)===U.Physics.ARCADE?this.arcade.enable(t):e===U.Physics.P2JS&&this.p2?this.p2.enable(t,i):e===U.Physics.NINJA&&this.ninja?this.ninja.enableAABB(t):e===U.Physics.BOX2D&&this.box2d?this.box2d.enable(t):e===U.Physics.MATTERJS&&this.matter&&this.matter.enable(t)},preUpdate:function(){this.p2&&this.p2.preUpdate(),this.box2d&&this.box2d.preUpdate(),this.matter&&this.matter.preUpdate()},update:function(){this.p2&&this.p2.update(),this.box2d&&this.box2d.update(),this.matter&&this.matter.update()},setBoundsToWorld:function(){this.arcade&&this.arcade.setBoundsToWorld(),this.ninja&&this.ninja.setBoundsToWorld(),this.p2&&this.p2.setBoundsToWorld(),this.box2d&&this.box2d.setBoundsToWorld(),this.matter&&this.matter.setBoundsToWorld()},clear:function(){this.p2&&this.p2.clear(),this.box2d&&this.box2d.clear(),this.matter&&this.matter.clear()},reset:function(){this.p2&&this.p2.reset(),this.box2d&&this.box2d.reset(),this.matter&&this.matter.reset()},destroy:function(){this.p2&&this.p2.destroy(),this.box2d&&this.box2d.destroy(),this.matter&&this.matter.destroy(),this.arcade=null,this.ninja=null,this.p2=null,this.box2d=null,this.matter=null}},U.Physics.prototype.constructor=U.Physics,U.Physics.Arcade=function(t){this.game=t,this.gravity=new U.Point,this.bounds=new U.Rectangle(0,0,t.world.width,t.world.height),this.checkCollision={up:!0,down:!0,left:!0,right:!0},this.maxObjects=10,this.maxLevels=4,this.OVERLAP_BIAS=4,this.forceX=!1,this.sortDirection=U.Physics.Arcade.LEFT_RIGHT,this.skipQuadTree=!0,this.isPaused=!1,this.quadTree=new U.QuadTree(this.game.world.bounds.x,this.game.world.bounds.y,this.game.world.bounds.width,this.game.world.bounds.height,this.maxObjects,this.maxLevels),this._total=0,this.setBoundsToWorld()},U.Physics.Arcade.prototype.constructor=U.Physics.Arcade,U.Physics.Arcade.SORT_NONE=0,U.Physics.Arcade.LEFT_RIGHT=1,U.Physics.Arcade.RIGHT_LEFT=2,U.Physics.Arcade.TOP_BOTTOM=3,U.Physics.Arcade.BOTTOM_TOP=4,U.Physics.Arcade.prototype={setBounds:function(t,e,i,n){this.bounds.setTo(t,e,i,n)},setBoundsToWorld:function(){this.bounds.copyFrom(this.game.world.bounds)},enable:function(t,e){void 0===e&&(e=!0);var i=1;if(Array.isArray(t))for(i=t.length;i--;)t[i]instanceof U.Group?this.enable(t[i].children,e):(this.enableBody(t[i]),e&&t[i].hasOwnProperty("children")&&0<t[i].children.length&&this.enable(t[i],!0));else t instanceof U.Group?this.enable(t.children,e):(this.enableBody(t),e&&t.hasOwnProperty("children")&&0<t.children.length&&this.enable(t.children,!0))},enableBody:function(t){t.hasOwnProperty("body")&&null===t.body&&(t.body=new U.Physics.Arcade.Body(t),t.parent&&t.parent instanceof U.Group&&t.parent.addToHash(t))},updateMotion:function(t){var e=this.computeVelocity(0,t,t.angularVelocity,t.angularAcceleration,t.angularDrag,t.maxAngular)-t.angularVelocity;t.angularVelocity+=e,t.rotation+=t.angularVelocity*this.game.time.physicsElapsed,t.velocity.x=this.computeVelocity(1,t,t.velocity.x,t.acceleration.x,t.drag.x,t.maxVelocity.x),t.velocity.y=this.computeVelocity(2,t,t.velocity.y,t.acceleration.y,t.drag.y,t.maxVelocity.y)},computeVelocity:function(t,e,i,n,r,o){return 1===t&&e.allowGravity?i+=(this.gravity.x+e.gravity.x)*this.game.time.physicsElapsed:2===t&&e.allowGravity&&(i+=(this.gravity.y+e.gravity.y)*this.game.time.physicsElapsed),n?i+=n*this.game.time.physicsElapsed:r&&(0<i-(r*=this.game.time.physicsElapsed)?i-=r:i+r<0?i+=r:i=0),(o=void 0===o?1e4:o)<i?i=o:i<-o&&(i=-o),i},overlap:function(t,e,i,n,r){if(i=i||null,n=n||null,r=r||i,this._total=0,!Array.isArray(t)&&Array.isArray(e))for(var o=0;o<e.length;o++)this.collideHandler(t,e[o],i,n,r,!0);else if(Array.isArray(t)&&!Array.isArray(e))for(o=0;o<t.length;o++)this.collideHandler(t[o],e,i,n,r,!0);else if(Array.isArray(t)&&Array.isArray(e))for(o=0;o<t.length;o++)for(var s=0;s<e.length;s++)this.collideHandler(t[o],e[s],i,n,r,!0);else this.collideHandler(t,e,i,n,r,!0);return 0<this._total},collide:function(t,e,i,n,r){if(i=i||null,n=n||null,r=r||i,this._total=0,!Array.isArray(t)&&Array.isArray(e))for(var o=0;o<e.length;o++)this.collideHandler(t,e[o],i,n,r,!1);else if(Array.isArray(t)&&!Array.isArray(e))for(o=0;o<t.length;o++)this.collideHandler(t[o],e,i,n,r,!1);else if(Array.isArray(t)&&Array.isArray(e))for(o=0;o<t.length;o++)for(var s=0;s<e.length;s++)this.collideHandler(t[o],e[s],i,n,r,!1);else this.collideHandler(t,e,i,n,r,!1);return 0<this._total},sortLeftRight:function(t,e){return t.body&&e.body?t.body.x-e.body.x:0},sortRightLeft:function(t,e){return t.body&&e.body?e.body.x-t.body.x:0},sortTopBottom:function(t,e){return t.body&&e.body?t.body.y-e.body.y:0},sortBottomTop:function(t,e){return t.body&&e.body?e.body.y-t.body.y:0},sort:function(t,e){null!==t.physicsSortDirection?e=t.physicsSortDirection:void 0===e&&(e=this.sortDirection),e===U.Physics.Arcade.LEFT_RIGHT?t.hash.sort(this.sortLeftRight):e===U.Physics.Arcade.RIGHT_LEFT?t.hash.sort(this.sortRightLeft):e===U.Physics.Arcade.TOP_BOTTOM?t.hash.sort(this.sortTopBottom):e===U.Physics.Arcade.BOTTOM_TOP&&t.hash.sort(this.sortBottomTop)},collideHandler:function(t,e,i,n,r,o){if(void 0===e&&t.physicsType===U.GROUP)return this.sort(t),void this.collideGroupVsSelf(t,i,n,r,o);t&&e&&t.exists&&e.exists&&(this.sortDirection!==U.Physics.Arcade.SORT_NONE&&(t.physicsType===U.GROUP&&this.sort(t),e.physicsType===U.GROUP&&this.sort(e)),t.physicsType===U.SPRITE?e.physicsType===U.SPRITE?this.collideSpriteVsSprite(t,e,i,n,r,o):e.physicsType===U.GROUP?this.collideSpriteVsGroup(t,e,i,n,r,o):e.physicsType===U.TILEMAPLAYER&&this.collideSpriteVsTilemapLayer(t,e,i,n,r,o):t.physicsType===U.GROUP?e.physicsType===U.SPRITE?this.collideSpriteVsGroup(e,t,i,n,r,o):e.physicsType===U.GROUP?this.collideGroupVsGroup(t,e,i,n,r,o):e.physicsType===U.TILEMAPLAYER&&this.collideGroupVsTilemapLayer(t,e,i,n,r,o):t.physicsType===U.TILEMAPLAYER&&(e.physicsType===U.SPRITE?this.collideSpriteVsTilemapLayer(e,t,i,n,r,o):e.physicsType===U.GROUP&&this.collideGroupVsTilemapLayer(e,t,i,n,r,o)))},collideSpriteVsSprite:function(t,e,i,n,r,o){return!(!t.body||!e.body||(this.separate(t.body,e.body,n,r,o)&&(i&&i.call(r,t,e),this._total++),0))},collideSpriteVsGroup:function(t,e,i,n,r,o){if(0!==e.length&&t.body)if(this.skipQuadTree||t.body.skipQuadTree)for(var s={},a=0;a<e.hash.length;a++){var h=e.hash[a];if(h&&h.exists&&h.body){if(s=h.body.getBounds(s),this.sortDirection===U.Physics.Arcade.LEFT_RIGHT){if(t.body.right<s.x)break;if(s.right<t.body.x)continue}else if(this.sortDirection===U.Physics.Arcade.RIGHT_LEFT){if(t.body.x>s.right)break;if(s.x>t.body.right)continue}else if(this.sortDirection===U.Physics.Arcade.TOP_BOTTOM){if(t.body.bottom<s.y)break;if(s.bottom<t.body.y)continue}else if(this.sortDirection===U.Physics.Arcade.BOTTOM_TOP){if(t.body.y>s.bottom)break;if(s.y>t.body.bottom)continue}this.collideSpriteVsSprite(t,h,i,n,r,o)}}else{this.quadTree.clear(),this.quadTree.reset(this.game.world.bounds.x,this.game.world.bounds.y,this.game.world.bounds.width,this.game.world.bounds.height,this.maxObjects,this.maxLevels),this.quadTree.populate(e);for(var l=this.quadTree.retrieve(t),a=0;a<l.length;a++)this.separate(t.body,l[a],n,r,o)&&(i&&i.call(r,t,l[a].sprite),this._total++)}},collideGroupVsSelf:function(t,e,i,n,r){if(0!==t.length)for(var o=0;o<t.hash.length;o++){var s={},a=t.hash[o];if(a&&a.exists&&a.body)for(var s=a.body.getBounds(s),h=o+1;h<t.hash.length;h++){var l={},p=t.hash[h];if(p&&p.exists&&p.body){if(l=p.body.getBounds(l),this.sortDirection===U.Physics.Arcade.LEFT_RIGHT){if(s.right<l.x)break;if(l.right<s.x)continue}else if(this.sortDirection===U.Physics.Arcade.RIGHT_LEFT){if(s.x>l.right)continue;if(l.x>s.right)break}else if(this.sortDirection===U.Physics.Arcade.TOP_BOTTOM){if(s.bottom<l.y)continue;if(l.bottom<s.y)break}else if(this.sortDirection===U.Physics.Arcade.BOTTOM_TOP){if(s.y>l.bottom)continue;if(l.y>a.body.bottom)break}this.collideSpriteVsSprite(a,p,e,i,n,r)}}}},collideGroupVsGroup:function(t,e,i,n,r,o){if(0!==t.length&&0!==e.length)for(var s=0;s<t.children.length;s++)t.children[s].exists&&(t.children[s].physicsType===U.GROUP?this.collideGroupVsGroup(t.children[s],e,i,n,r,o):this.collideSpriteVsGroup(t.children[s],e,i,n,r,o))},separate:function(t,e,i,n,r){if(!t.enable||!e.enable||t.checkCollision.none||e.checkCollision.none||!this.intersects(t,e))return!1;if(i&&!1===i.call(n,t.sprite,e.sprite))return!1;if(t.isCircle&&e.isCircle)return this.separateCircle(t,e,r);if(t.isCircle!==e.isCircle){var o=t.isCircle?e:t,s=t.isCircle?t:e,a=o.x,i=o.y,h=o.right,n=o.bottom,o=s.x+s.radius,s=s.y+s.radius;if((s<i||n<s)&&(o<a||h<o))return this.separateCircle(t,e,r)}h=!1,o=!1;this.forceX||Math.abs(this.gravity.y+t.gravity.y)<Math.abs(this.gravity.x+t.gravity.x)?(h=this.separateX(t,e,r),this.intersects(t,e)&&(o=this.separateY(t,e,r))):(o=this.separateY(t,e,r),this.intersects(t,e)&&(h=this.separateX(t,e,r)));o=h||o;return o&&(r?(t.onOverlap&&t.onOverlap.dispatch(t.sprite,e.sprite),e.onOverlap&&e.onOverlap.dispatch(e.sprite,t.sprite)):(t.onCollide&&t.onCollide.dispatch(t.sprite,e.sprite),e.onCollide&&e.onCollide.dispatch(e.sprite,t.sprite))),o},intersects:function(t,e){return t!==e&&(t.isCircle?e.isCircle?U.Math.distance(t.center.x,t.center.y,e.center.x,e.center.y)<=t.radius+e.radius:this.circleBodyIntersects(t,e):e.isCircle?this.circleBodyIntersects(e,t):!(t.right<=e.position.x||t.bottom<=e.position.y||t.position.x>=e.right||t.position.y>=e.bottom))},circleBodyIntersects:function(t,e){var i=U.Math.clamp(t.center.x,e.left,e.right),e=U.Math.clamp(t.center.y,e.top,e.bottom);return(t.center.x-i)*(t.center.x-i)+(t.center.y-e)*(t.center.y-e)<=t.radius*t.radius},separateCircle:function(t,e,i){this.getOverlapX(t,e),this.getOverlapY(t,e);var n=e.center.x-t.center.x,r=e.center.y-t.center.y,o=Math.atan2(r,n),s=0;if(t.isCircle!==e.isCircle?(a={x:(e.isCircle?t:e).position.x,y:(e.isCircle?t:e).position.y,right:(e.isCircle?t:e).right,bottom:(e.isCircle?t:e).bottom},(h={x:t.isCircle?t.position.x+t.radius:e.position.x+e.radius,y:t.isCircle?t.position.y+t.radius:e.position.y+e.radius,radius:(t.isCircle?t:e).radius}).y<a.y?h.x<a.x?s=U.Math.distance(h.x,h.y,a.x,a.y)-h.radius:a.right<h.x&&(s=U.Math.distance(h.x,h.y,a.right,a.y)-h.radius):a.bottom<h.y&&(h.x<a.x?s=U.Math.distance(h.x,h.y,a.x,a.bottom)-h.radius:a.right<h.x&&(s=U.Math.distance(h.x,h.y,a.right,a.bottom)-h.radius)),s*=-1):s=t.radius+e.radius-U.Math.distance(t.center.x,t.center.y,e.center.x,e.center.y),i||0===s||t.immovable&&e.immovable||t.customSeparateX||e.customSeparateX)return 0!==s&&(t.onOverlap&&t.onOverlap.dispatch(t.sprite,e.sprite),e.onOverlap&&e.onOverlap.dispatch(e.sprite,t.sprite)),0!==s;var r=t.velocity.x*Math.cos(o)+t.velocity.y*Math.sin(o),n=t.velocity.x*Math.sin(o)-t.velocity.y*Math.cos(o),a=e.velocity.x*Math.cos(o)+e.velocity.y*Math.sin(o),h=e.velocity.x*Math.sin(o)-e.velocity.y*Math.cos(o),i=((t.mass-e.mass)*r+2*e.mass*a)/(t.mass+e.mass),a=(2*t.mass*r+(e.mass-t.mass)*a)/(t.mass+e.mass);return t.immovable||(t.velocity.x=(i*Math.cos(o)-n*Math.sin(o))*t.bounce.x,t.velocity.y=(n*Math.cos(o)+i*Math.sin(o))*t.bounce.y),e.immovable||(e.velocity.x=(a*Math.cos(o)-h*Math.sin(o))*e.bounce.x,e.velocity.y=(h*Math.cos(o)+a*Math.sin(o))*e.bounce.y),Math.abs(o)<Math.PI/2?0<t.velocity.x&&!t.immovable&&e.velocity.x>t.velocity.x?t.velocity.x*=-1:e.velocity.x<0&&!e.immovable&&t.velocity.x<e.velocity.x?e.velocity.x*=-1:0<t.velocity.y&&!t.immovable&&e.velocity.y>t.velocity.y?t.velocity.y*=-1:e.velocity.y<0&&!e.immovable&&t.velocity.y<e.velocity.y&&(e.velocity.y*=-1):Math.abs(o)>Math.PI/2&&(t.velocity.x<0&&!t.immovable&&e.velocity.x<t.velocity.x?t.velocity.x*=-1:0<e.velocity.x&&!e.immovable&&t.velocity.x>e.velocity.x?e.velocity.x*=-1:t.velocity.y<0&&!t.immovable&&e.velocity.y<t.velocity.y?t.velocity.y*=-1:0<e.velocity.y&&!e.immovable&&t.velocity.x>e.velocity.y&&(e.velocity.y*=-1)),t.immovable||(t.x+=t.velocity.x*this.game.time.physicsElapsed-s*Math.cos(o),t.y+=t.velocity.y*this.game.time.physicsElapsed-s*Math.sin(o)),e.immovable||(e.x+=e.velocity.x*this.game.time.physicsElapsed+s*Math.cos(o),e.y+=e.velocity.y*this.game.time.physicsElapsed+s*Math.sin(o)),t.onCollide&&t.onCollide.dispatch(t.sprite,e.sprite),e.onCollide&&e.onCollide.dispatch(e.sprite,t.sprite),!0},getOverlapX:function(t,e,i){var n=0,r=t.deltaAbsX()+e.deltaAbsX()+this.OVERLAP_BIAS;return 0===t.deltaX()&&0===e.deltaX()?(t.embedded=!0,e.embedded=!0):t.deltaX()>e.deltaX()?r<(n=t.right-e.x)&&!i||!1===t.checkCollision.right||!1===e.checkCollision.left?n=0:(t.touching.none=!1,t.touching.right=!0,e.touching.none=!1,e.touching.left=!0):t.deltaX()<e.deltaX()&&(r<-(n=t.x-e.width-e.x)&&!i||!1===t.checkCollision.left||!1===e.checkCollision.right?n=0:(t.touching.none=!1,t.touching.left=!0,e.touching.none=!1,e.touching.right=!0)),t.overlapX=n,e.overlapX=n},getOverlapY:function(t,e,i){var n=0,r=t.deltaAbsY()+e.deltaAbsY()+this.OVERLAP_BIAS;return 0===t.deltaY()&&0===e.deltaY()?(t.embedded=!0,e.embedded=!0):t.deltaY()>e.deltaY()?r<(n=t.bottom-e.y)&&!i||!1===t.checkCollision.down||!1===e.checkCollision.up?n=0:(t.touching.none=!1,t.touching.down=!0,e.touching.none=!1,e.touching.up=!0):t.deltaY()<e.deltaY()&&(r<-(n=t.y-e.bottom)&&!i||!1===t.checkCollision.up||!1===e.checkCollision.down?n=0:(t.touching.none=!1,t.touching.up=!0,e.touching.none=!1,e.touching.down=!0)),t.overlapY=n,e.overlapY=n},separateX:function(t,e,i){var n=this.getOverlapX(t,e,i);if(i||0===n||t.immovable&&e.immovable||t.customSeparateX||e.customSeparateX)return 0!==n||t.embedded&&e.embedded;var r=t.velocity.x,i=e.velocity.x;return t.immovable||e.immovable?t.immovable?(e.x+=n,e.velocity.x=r-i*e.bounce.x,t.moves&&(e.y+=(t.y-t.prev.y)*t.friction.y)):(t.x-=n,t.velocity.x=i-r*t.bounce.x,e.moves&&(t.y+=(e.y-e.prev.y)*e.friction.y)):(t.x-=n*=.5,e.x+=n,n=Math.sqrt(i*i*e.mass/t.mass)*(0<i?1:-1),i=Math.sqrt(r*r*t.mass/e.mass)*(0<r?1:-1),i-=r=.5*(n+i),t.velocity.x=r+(n-=r)*t.bounce.x,e.velocity.x=r+i*e.bounce.x),!0},separateY:function(t,e,i){var n=this.getOverlapY(t,e,i);if(i||0===n||t.immovable&&e.immovable||t.customSeparateY||e.customSeparateY)return 0!==n||t.embedded&&e.embedded;var r=t.velocity.y,i=e.velocity.y;return t.immovable||e.immovable?t.immovable?(e.y+=n,e.velocity.y=r-i*e.bounce.y,t.moves&&(e.x+=(t.x-t.prev.x)*t.friction.x)):(t.y-=n,t.velocity.y=i-r*t.bounce.y,e.moves&&(t.x+=(e.x-e.prev.x)*e.friction.x)):(t.y-=n*=.5,e.y+=n,n=Math.sqrt(i*i*e.mass/t.mass)*(0<i?1:-1),i=Math.sqrt(r*r*t.mass/e.mass)*(0<r?1:-1),i-=r=.5*(n+i),t.velocity.y=r+(n-=r)*t.bounce.y,e.velocity.y=r+i*e.bounce.y),!0},getObjectsUnderPointer:function(t,e,i,n){if(0!==e.length&&t.exists)return this.getObjectsAtLocation(t.x,t.y,e,i,n,t)},getObjectsAtLocation:function(t,e,i,n,r,o){this.quadTree.clear(),this.quadTree.reset(this.game.world.bounds.x,this.game.world.bounds.y,this.game.world.bounds.width,this.game.world.bounds.height,this.maxObjects,this.maxLevels),this.quadTree.populate(i);for(var i=new U.Rectangle(t,e,1,1),s=[],a=this.quadTree.retrieve(i),h=0;h<a.length;h++)a[h].hitTest(t,e)&&(n&&n.call(r,o,a[h].sprite),s.push(a[h].sprite));return s},moveToObject:function(t,e,i,n){void 0===i&&(i=60),void 0===n&&(n=0);var r=Math.atan2(e.y-t.y,e.x-t.x);return 0<n&&(i=this.distanceBetween(t,e)/(n/1e3)),t.body.velocity.x=Math.cos(r)*i,t.body.velocity.y=Math.sin(r)*i,r},moveToPointer:function(t,e,i,n){void 0===e&&(e=60),i=i||this.game.input.activePointer,void 0===n&&(n=0);var r=this.angleToPointer(t,i);return 0<n&&(e=this.distanceToPointer(t,i)/(n/1e3)),t.body.velocity.x=Math.cos(r)*e,t.body.velocity.y=Math.sin(r)*e,r},moveToXY:function(t,e,i,n,r){void 0===n&&(n=60),void 0===r&&(r=0);var o=Math.atan2(i-t.y,e-t.x);return 0<r&&(n=this.distanceToXY(t,e,i)/(r/1e3)),t.body.velocity.x=Math.cos(o)*n,t.body.velocity.y=Math.sin(o)*n,o},velocityFromAngle:function(t,e,i){return void 0===e&&(e=60),(i=i||new U.Point).setTo(Math.cos(this.game.math.degToRad(t))*e,Math.sin(this.game.math.degToRad(t))*e)},velocityFromRotation:function(t,e,i){return void 0===e&&(e=60),(i=i||new U.Point).setTo(Math.cos(t)*e,Math.sin(t)*e)},accelerationFromRotation:function(t,e,i){return void 0===e&&(e=60),(i=i||new U.Point).setTo(Math.cos(t)*e,Math.sin(t)*e)},accelerateToObject:function(t,e,i,n,r){void 0===i&&(i=60),void 0===n&&(n=1e3),void 0===r&&(r=1e3);e=this.angleBetween(t,e);return t.body.acceleration.setTo(Math.cos(e)*i,Math.sin(e)*i),t.body.maxVelocity.setTo(n,r),e},accelerateToPointer:function(t,e,i,n,r){void 0===i&&(i=60),void 0===e&&(e=this.game.input.activePointer),void 0===n&&(n=1e3),void 0===r&&(r=1e3);e=this.angleToPointer(t,e);return t.body.acceleration.setTo(Math.cos(e)*i,Math.sin(e)*i),t.body.maxVelocity.setTo(n,r),e},accelerateToXY:function(t,e,i,n,r,o){void 0===n&&(n=60),void 0===r&&(r=1e3),void 0===o&&(o=1e3);i=this.angleToXY(t,e,i);return t.body.acceleration.setTo(Math.cos(i)*n,Math.sin(i)*n),t.body.maxVelocity.setTo(r,o),i},distanceBetween:function(t,e,i){var n=(i=void 0===i?!1:i)?t.world.x-e.world.x:t.x-e.x,e=i?t.world.y-e.world.y:t.y-e.y;return Math.sqrt(n*n+e*e)},distanceToXY:function(t,e,i,n){e=(n=void 0===n?!1:n)?t.world.x-e:t.x-e,i=n?t.world.y-i:t.y-i;return Math.sqrt(e*e+i*i)},distanceToPointer:function(t,e,i){void 0===e&&(e=this.game.input.activePointer);var n=(i=void 0===i?!1:i)?t.world.x-e.worldX:t.x-e.worldX,e=i?t.world.y-e.worldY:t.y-e.worldY;return Math.sqrt(n*n+e*e)},angleBetween:function(t,e,i){return(i=void 0===i?!1:i)?Math.atan2(e.world.y-t.world.y,e.world.x-t.world.x):Math.atan2(e.y-t.y,e.x-t.x)},angleBetweenCenters:function(t,e){var i=e.centerX-t.centerX,t=e.centerY-t.centerY;return Math.atan2(t,i)},angleToXY:function(t,e,i,n){return(n=void 0===n?!1:n)?Math.atan2(i-t.world.y,e-t.world.x):Math.atan2(i-t.y,e-t.x)},angleToPointer:function(t,e,i){return void 0===e&&(e=this.game.input.activePointer),(i=void 0===i?!1:i)?Math.atan2(e.worldY-t.world.y,e.worldX-t.world.x):Math.atan2(e.worldY-t.y,e.worldX-t.x)},worldAngleToPointer:function(t,e){return this.angleToPointer(t,e,!0)}},U.Physics.Arcade.Body=function(t){this.sprite=t,this.game=t.game,this.type=U.Physics.ARCADE,this.enable=!0,this.isCircle=!1,this.radius=0,this.offset=new U.Point,this.position=new U.Point(t.x,t.y),this.prev=new U.Point(this.position.x,this.position.y),this.allowRotation=!0,this.rotation=t.angle,this.preRotation=t.angle,this.width=t.width,this.height=t.height,this.sourceWidth=t.width,this.sourceHeight=t.height,t.texture&&(this.sourceWidth=t.texture.frame.width,this.sourceHeight=t.texture.frame.height),this.halfWidth=Math.abs(t.width/2),this.halfHeight=Math.abs(t.height/2),this.center=new U.Point(t.x+this.halfWidth,t.y+this.halfHeight),this.velocity=new U.Point,this.newVelocity=new U.Point,this.deltaMax=new U.Point,this.acceleration=new U.Point,this.drag=new U.Point,this.allowGravity=!0,this.gravity=new U.Point,this.bounce=new U.Point,this.worldBounce=null,this.onWorldBounds=null,this.onCollide=null,this.onOverlap=null,this.maxVelocity=new U.Point(1e4,1e4),this.friction=new U.Point(1,0),this.angularVelocity=0,this.angularAcceleration=0,this.angularDrag=0,this.maxAngular=1e3,this.mass=1,this.angle=0,this.speed=0,this.facing=U.NONE,this.immovable=!1,this.moves=!0,this.customSeparateX=!1,this.customSeparateY=!1,this.overlapX=0,this.overlapY=0,this.overlapR=0,this.embedded=!1,this.collideWorldBounds=!1,this.checkCollision={none:!1,any:!0,up:!0,down:!0,left:!0,right:!0},this.touching={none:!0,up:!1,down:!1,left:!1,right:!1},this.wasTouching={none:!0,up:!1,down:!1,left:!1,right:!1},this.blocked={up:!1,down:!1,left:!1,right:!1},this.tilePadding=new U.Point,this.dirty=!1,this.skipQuadTree=!1,this.syncBounds=!1,this.isMoving=!1,this.stopVelocityOnCollide=!0,this.moveTimer=0,this.moveDistance=0,this.moveDuration=0,this.moveTarget=null,this.moveEnd=null,this.onMoveComplete=new U.Signal,this.movementCallback=null,this.movementCallbackContext=null,this._reset=!0,this._sx=t.scale.x,this._sy=t.scale.y,this._dx=0,this._dy=0},U.Physics.Arcade.Body.prototype={updateBounds:function(){var t,e;this.syncBounds?((e=this.sprite.getBounds()).ceilAll(),e.width===this.width&&e.height===this.height||(this.width=e.width,this.height=e.height,this._reset=!0)):(t=Math.abs(this.sprite.scale.x),e=Math.abs(this.sprite.scale.y),t===this._sx&&e===this._sy||(this.width=this.sourceWidth*t,this.height=this.sourceHeight*e,this._sx=t,this._sy=e,this._reset=!0)),this._reset&&(this.halfWidth=Math.floor(this.width/2),this.halfHeight=Math.floor(this.height/2),this.center.setTo(this.position.x+this.halfWidth,this.position.y+this.halfHeight))},preUpdate:function(){this.enable&&!this.game.physics.arcade.isPaused&&(this.dirty=!0,this.wasTouching.none=this.touching.none,this.wasTouching.up=this.touching.up,this.wasTouching.down=this.touching.down,this.wasTouching.left=this.touching.left,this.wasTouching.right=this.touching.right,this.touching.none=!0,this.touching.up=!1,this.touching.down=!1,this.touching.left=!1,this.touching.right=!1,this.blocked.up=!1,this.blocked.down=!1,this.blocked.left=!1,this.blocked.right=!1,this.embedded=!1,this.updateBounds(),this.position.x=this.sprite.world.x-this.sprite.anchor.x*this.sprite.width+this.sprite.scale.x*this.offset.x,this.position.x-=this.sprite.scale.x<0?this.width:0,this.position.y=this.sprite.world.y-this.sprite.anchor.y*this.sprite.height+this.sprite.scale.y*this.offset.y,this.position.y-=this.sprite.scale.y<0?this.height:0,this.rotation=this.sprite.angle,this.preRotation=this.rotation,(this._reset||this.sprite.fresh)&&(this.prev.x=this.position.x,this.prev.y=this.position.y),this.moves&&(this.game.physics.arcade.updateMotion(this),this.newVelocity.set(this.velocity.x*this.game.time.physicsElapsed,this.velocity.y*this.game.time.physicsElapsed),this.position.x+=this.newVelocity.x,this.position.y+=this.newVelocity.y,this.position.x===this.prev.x&&this.position.y===this.prev.y||(this.angle=Math.atan2(this.velocity.y,this.velocity.x)),this.speed=Math.sqrt(this.velocity.x*this.velocity.x+this.velocity.y*this.velocity.y),this.collideWorldBounds&&this.checkWorldBounds()&&this.onWorldBounds&&this.onWorldBounds.dispatch(this.sprite,this.blocked.up,this.blocked.down,this.blocked.left,this.blocked.right)),this._dx=this.deltaX(),this._dy=this.deltaY(),this._reset=!1)},updateMovement:function(){var t,e=0,i=0!==this.overlapX||0!==this.overlapY,e=0<this.moveDuration?(this.moveTimer+=this.game.time.elapsedMS,this.moveTimer/this.moveDuration):(this.moveTarget.end.set(this.position.x,this.position.y),this.moveTarget.length/this.moveDistance);return this.movementCallback&&(t=this.movementCallback.call(this.movementCallbackContext,this,this.velocity,e)),!(i||1<=e||void 0!==t&&!0!==t)||(this.stopMovement(1<=e||this.stopVelocityOnCollide&&i),!1)},stopMovement:function(t){this.isMoving&&(this.isMoving=!1,t&&this.velocity.set(0),this.onMoveComplete.dispatch(this.sprite,0!==this.overlapX||0!==this.overlapY))},postUpdate:function(){this.enable&&this.dirty&&(this.isMoving&&this.updateMovement(),this.dirty=!1,this.deltaX()<0?this.facing=U.LEFT:0<this.deltaX()&&(this.facing=U.RIGHT),this.deltaY()<0?this.facing=U.UP:0<this.deltaY()&&(this.facing=U.DOWN),this.moves&&(this._dx=this.deltaX(),this._dy=this.deltaY(),0!==this.deltaMax.x&&0!==this._dx&&(this._dx<0&&this._dx<-this.deltaMax.x?this._dx=-this.deltaMax.x:0<this._dx&&this._dx>this.deltaMax.x&&(this._dx=this.deltaMax.x)),0!==this.deltaMax.y&&0!==this._dy&&(this._dy<0&&this._dy<-this.deltaMax.y?this._dy=-this.deltaMax.y:0<this._dy&&this._dy>this.deltaMax.y&&(this._dy=this.deltaMax.y)),this.sprite.position.x+=this._dx,this.sprite.position.y+=this._dy,this._reset=!0),this.center.setTo(this.position.x+this.halfWidth,this.position.y+this.halfHeight),this.allowRotation&&(this.sprite.angle+=this.deltaZ()),this.prev.x=this.position.x,this.prev.y=this.position.y)},checkWorldBounds:function(){var t,e,i,n,r=this.position,o=this.game.physics.arcade.bounds,s=this.game.physics.arcade.checkCollision,a=this.worldBounce?-this.worldBounce.x:-this.bounce.x,h=this.worldBounce?-this.worldBounce.y:-this.bounce.y;return this.isCircle?(t=this.center.x-this.radius,e=this.center.y-this.radius,i=this.center.x+this.radius,n=this.center.y+this.radius,t<o.x&&s.left?(r.x=o.x-this.halfWidth+this.radius,this.velocity.x*=a,this.blocked.left=!0):i>o.right&&s.right&&(r.x=o.right-this.halfWidth-this.radius,this.velocity.x*=a,this.blocked.right=!0),e<o.y&&s.up?(r.y=o.y-this.halfHeight+this.radius,this.velocity.y*=h,this.blocked.up=!0):n>o.bottom&&s.down&&(r.y=o.bottom-this.halfHeight-this.radius,this.velocity.y*=h,this.blocked.down=!0)):(r.x<o.x&&s.left?(r.x=o.x,this.velocity.x*=a,this.blocked.left=!0):this.right>o.right&&s.right&&(r.x=o.right-this.width,this.velocity.x*=a,this.blocked.right=!0),r.y<o.y&&s.up?(r.y=o.y,this.velocity.y*=h,this.blocked.up=!0):this.bottom>o.bottom&&s.down&&(r.y=o.bottom-this.height,this.velocity.y*=h,this.blocked.down=!0)),this.blocked.up||this.blocked.down||this.blocked.left||this.blocked.right},moveFrom:function(t,e,i){return 0!==(e=void 0===e?this.speed:e)&&(void 0===i?(n=this.angle,i=this.game.math.radToDeg(n)):n=this.game.math.degToRad(i),this.moveTimer=0,this.moveDuration=t,0===i||180===i?this.velocity.set(Math.cos(n)*e,0):90===i||270===i?this.velocity.set(0,Math.sin(n)*e):this.velocity.set(Math.cos(n)*e,Math.sin(n)*e),this.isMoving=!0);var n},moveTo:function(t,e,i){var n,t=e/(t/1e3);return 0!=t&&(void 0===i?(n=this.angle,i=this.game.math.radToDeg(n)):n=this.game.math.degToRad(i),e=Math.abs(e),this.moveDuration=0,this.moveDistance=e,null===this.moveTarget&&(this.moveTarget=new U.Line,this.moveEnd=new U.Point),this.moveTarget.fromAngle(this.x,this.y,n,e),this.moveEnd.set(this.moveTarget.end.x,this.moveTarget.end.y),this.moveTarget.setTo(this.x,this.y,this.x,this.y),0===i||180===i?this.velocity.set(Math.cos(n)*t,0):90===i||270===i?this.velocity.set(0,Math.sin(n)*t):this.velocity.set(Math.cos(n)*t,Math.sin(n)*t),this.isMoving=!0)},setSize:function(t,e,i,n){void 0===i&&(i=this.offset.x),void 0===n&&(n=this.offset.y),this.sourceWidth=t,this.sourceHeight=e,this.width=this.sourceWidth*this._sx,this.height=this.sourceHeight*this._sy,this.halfWidth=Math.floor(this.width/2),this.halfHeight=Math.floor(this.height/2),this.offset.setTo(i,n),this.center.setTo(this.position.x+this.halfWidth,this.position.y+this.halfHeight),this.isCircle=!1,this.radius=0},setCircle:function(t,e,i){void 0===e&&(e=this.offset.x),void 0===i&&(i=this.offset.y),0<t?(this.isCircle=!0,this.radius=t,this.sourceWidth=2*t,this.sourceHeight=2*t,this.width=this.sourceWidth*this._sx,this.height=this.sourceHeight*this._sy,this.halfWidth=Math.floor(this.width/2),this.halfHeight=Math.floor(this.height/2),this.offset.setTo(e,i),this.center.setTo(this.position.x+this.halfWidth,this.position.y+this.halfHeight)):this.isCircle=!1},reset:function(t,e){this.velocity.set(0),this.acceleration.set(0),this.speed=0,this.angularVelocity=0,this.angularAcceleration=0,this.position.x=t-this.sprite.anchor.x*this.sprite.width+this.sprite.scale.x*this.offset.x,this.position.x-=this.sprite.scale.x<0?this.width:0,this.position.y=e-this.sprite.anchor.y*this.sprite.height+this.sprite.scale.y*this.offset.y,this.position.y-=this.sprite.scale.y<0?this.height:0,this.prev.x=this.position.x,this.prev.y=this.position.y,this.rotation=this.sprite.angle,this.preRotation=this.rotation,this._sx=this.sprite.scale.x,this._sy=this.sprite.scale.y,this.center.setTo(this.position.x+this.halfWidth,this.position.y+this.halfHeight)},getBounds:function(t){return this.isCircle?(t.x=this.center.x-this.radius,t.y=this.center.y-this.radius,t.right=this.center.x+this.radius,t.bottom=this.center.y+this.radius):(t.x=this.x,t.y=this.y,t.right=this.right,t.bottom=this.bottom),t},hitTest:function(t,e){return(this.isCircle?U.Circle:U.Rectangle).contains(this,t,e)},onFloor:function(){return this.blocked.down},onCeiling:function(){return this.blocked.up},onWall:function(){return this.blocked.left||this.blocked.right},deltaAbsX:function(){return 0<this.deltaX()?this.deltaX():-this.deltaX()},deltaAbsY:function(){return 0<this.deltaY()?this.deltaY():-this.deltaY()},deltaX:function(){return this.position.x-this.prev.x},deltaY:function(){return this.position.y-this.prev.y},deltaZ:function(){return this.rotation-this.preRotation},destroy:function(){this.sprite.parent&&this.sprite.parent instanceof U.Group&&this.sprite.parent.removeFromHash(this.sprite),this.sprite.body=null,this.sprite=null}},Object.defineProperty(U.Physics.Arcade.Body.prototype,"left",{get:function(){return this.position.x}}),Object.defineProperty(U.Physics.Arcade.Body.prototype,"right",{get:function(){return this.position.x+this.width}}),Object.defineProperty(U.Physics.Arcade.Body.prototype,"top",{get:function(){return this.position.y}}),Object.defineProperty(U.Physics.Arcade.Body.prototype,"bottom",{get:function(){return this.position.y+this.height}}),Object.defineProperty(U.Physics.Arcade.Body.prototype,"x",{get:function(){return this.position.x},set:function(t){this.position.x=t}}),Object.defineProperty(U.Physics.Arcade.Body.prototype,"y",{get:function(){return this.position.y},set:function(t){this.position.y=t}}),U.Physics.Arcade.Body.render=function(t,e,i,n){void 0===n&&(n=!0),t.fillStyle=i=i||"rgba(0,255,0,0.4)",t.strokeStyle=i,e.isCircle?(t.beginPath(),t.arc(e.center.x-e.game.camera.x,e.center.y-e.game.camera.y,e.radius,0,2*Math.PI),n?t.fill():t.stroke()):n?t.fillRect(e.position.x-e.game.camera.x,e.position.y-e.game.camera.y,e.width,e.height):t.strokeRect(e.position.x-e.game.camera.x,e.position.y-e.game.camera.y,e.width,e.height)},U.Physics.Arcade.Body.renderBodyInfo=function(t,e){t.line("x: "+e.x.toFixed(2),"y: "+e.y.toFixed(2),"width: "+e.width,"height: "+e.height),t.line("velocity x: "+e.velocity.x.toFixed(2),"y: "+e.velocity.y.toFixed(2),"deltaX: "+e._dx.toFixed(2),"deltaY: "+e._dy.toFixed(2)),t.line("acceleration x: "+e.acceleration.x.toFixed(2),"y: "+e.acceleration.y.toFixed(2),"speed: "+e.speed.toFixed(2),"angle: "+e.angle.toFixed(2)),t.line("gravity x: "+e.gravity.x,"y: "+e.gravity.y,"bounce x: "+e.bounce.x.toFixed(2),"y: "+e.bounce.y.toFixed(2)),t.line("touching left: "+e.touching.left,"right: "+e.touching.right,"up: "+e.touching.up,"down: "+e.touching.down),t.line("blocked left: "+e.blocked.left,"right: "+e.blocked.right,"up: "+e.blocked.up,"down: "+e.blocked.down)},U.Physics.Arcade.Body.prototype.constructor=U.Physics.Arcade.Body,U.Physics.Arcade.TilemapCollision=function(){},U.Physics.Arcade.TilemapCollision.prototype={TILE_BIAS:16,collideSpriteVsTilemapLayer:function(t,e,i,n,r,o){if(t.body){var s=e.getTiles(t.body.position.x-t.body.tilePadding.x,t.body.position.y-t.body.tilePadding.y,t.body.width+t.body.tilePadding.x,t.body.height+t.body.tilePadding.y,!1,!1);if(0!==s.length)for(var a=0;a<s.length;a++)n?n.call(r,t,s[a])&&this.separateTile(a,t.body,s[a],e,o)&&(this._total++,i&&i.call(r,t,s[a])):this.separateTile(a,t.body,s[a],e,o)&&(this._total++,i&&i.call(r,t,s[a]))}},collideGroupVsTilemapLayer:function(t,e,i,n,r,o){if(0!==t.length)for(var s=0;s<t.children.length;s++)t.children[s].exists&&this.collideSpriteVsTilemapLayer(t.children[s],e,i,n,r,o)},separateTile:function(t,e,i,n,r){if(!e.enable)return!1;var o=n.fixedToCamera?0:n.position.x,s=n.fixedToCamera?0:n.position.y;if(!i.intersects(e.position.x-o,e.position.y-s,e.right-o,e.bottom-s))return!1;if(r)return!0;if(i.collisionCallback&&!i.collisionCallback.call(i.collisionCallbackContext,e.sprite,i))return!1;if(void 0!==i.layer.callbacks&&i.layer.callbacks[i.index]&&!i.layer.callbacks[i.index].callback.call(i.layer.callbacks[i.index].callbackContext,e.sprite,i))return!1;if(!(i.faceLeft||i.faceRight||i.faceTop||i.faceBottom))return!1;var a=0,h=0,l=0,r=1;if(e.deltaAbsX()>e.deltaAbsY()?l=-1:e.deltaAbsX()<e.deltaAbsY()&&(r=-1),0!==e.deltaX()&&0!==e.deltaY()&&(i.faceLeft||i.faceRight)&&(i.faceTop||i.faceBottom)&&(l=Math.min(Math.abs(e.position.x-o-i.right),Math.abs(e.right-o-i.left)),r=Math.min(Math.abs(e.position.y-s-i.bottom),Math.abs(e.bottom-s-i.top))),l<r){if((i.faceLeft||i.faceRight)&&0!==(a=this.tileCheckX(e,i,n))&&!i.intersects(e.position.x-o,e.position.y-s,e.right-o,e.bottom-s))return!0;(i.faceTop||i.faceBottom)&&(h=this.tileCheckY(e,i,n))}else{if((i.faceTop||i.faceBottom)&&0!==(h=this.tileCheckY(e,i,n))&&!i.intersects(e.position.x-o,e.position.y-s,e.right-o,e.bottom-s))return!0;(i.faceLeft||i.faceRight)&&(a=this.tileCheckX(e,i,n))}return 0!==a||0!==h},tileCheckX:function(t,e,i){var n=0,i=i.fixedToCamera?0:i.position.x;return t.deltaX()<0&&!t.blocked.left&&e.collideRight&&t.checkCollision.left?e.faceRight&&t.x-i<e.right&&(n=t.x-i-e.right)<-this.TILE_BIAS&&(n=0):0<t.deltaX()&&!t.blocked.right&&e.collideLeft&&t.checkCollision.right&&e.faceLeft&&t.right-i>e.left&&(n=t.right-i-e.left)>this.TILE_BIAS&&(n=0),0!==n&&(t.customSeparateX?t.overlapX=n:this.processTileSeparationX(t,n)),n},tileCheckY:function(t,e,i){var n=0,i=i.fixedToCamera?0:i.position.y;return t.deltaY()<0&&!t.blocked.up&&e.collideDown&&t.checkCollision.up?e.faceBottom&&t.y-i<e.bottom&&(n=t.y-i-e.bottom)<-this.TILE_BIAS&&(n=0):0<t.deltaY()&&!t.blocked.down&&e.collideUp&&t.checkCollision.down&&e.faceTop&&t.bottom-i>e.top&&(n=t.bottom-i-e.top)>this.TILE_BIAS&&(n=0),0!==n&&(t.customSeparateY?t.overlapY=n:this.processTileSeparationY(t,n)),n},processTileSeparationX:function(t,e){e<0?t.blocked.left=!0:0<e&&(t.blocked.right=!0),t.position.x-=e,0===t.bounce.x?t.velocity.x=0:t.velocity.x=-t.velocity.x*t.bounce.x},processTileSeparationY:function(t,e){e<0?t.blocked.up=!0:0<e&&(t.blocked.down=!0),t.position.y-=e,0===t.bounce.y?t.velocity.y=0:t.velocity.y=-t.velocity.y*t.bounce.y}},U.Utils.mixinPrototype(U.Physics.Arcade.prototype,U.Physics.Arcade.TilemapCollision.prototype),p2.Body.prototype.parent=null,p2.Spring.prototype.parent=null,U.Physics.P2=function(t,e){this.game=t,void 0===e?e={gravity:[0,0],broadphase:new p2.SAPBroadphase}:(e.hasOwnProperty("gravity")||(e.gravity=[0,0]),e.hasOwnProperty("broadphase")||(e.broadphase=new p2.SAPBroadphase)),this.config=e,this.world=new p2.World(this.config),this.frameRate=1/60,this.useElapsedTime=!1,this.paused=!1,this.materials=[],this.gravity=new U.Physics.P2.InversePointProxy(this,this.world.gravity),this.walls={left:null,right:null,top:null,bottom:null},this.onBodyAdded=new U.Signal,this.onBodyRemoved=new U.Signal,this.onSpringAdded=new U.Signal,this.onSpringRemoved=new U.Signal,this.onConstraintAdded=new U.Signal,this.onConstraintRemoved=new U.Signal,this.onContactMaterialAdded=new U.Signal,this.onContactMaterialRemoved=new U.Signal,this.postBroadphaseCallback=null,this.callbackContext=null,this.onBeginContact=new U.Signal,this.onEndContact=new U.Signal,e.hasOwnProperty("mpx")&&e.hasOwnProperty("pxm")&&e.hasOwnProperty("mpxi")&&e.hasOwnProperty("pxmi")&&(this.mpx=e.mpx,this.mpxi=e.mpxi,this.pxm=e.pxm,this.pxmi=e.pxmi),this.world.on("beginContact",this.beginContactHandler,this),this.world.on("endContact",this.endContactHandler,this),this.collisionGroups=[],this.nothingCollisionGroup=new U.Physics.P2.CollisionGroup(1),this.boundsCollisionGroup=new U.Physics.P2.CollisionGroup(2),this.everythingCollisionGroup=new U.Physics.P2.CollisionGroup(2147483648),this.boundsCollidesWith=[],this._toRemove=[],this._collisionGroupID=2,this._boundsLeft=!0,this._boundsRight=!0,this._boundsTop=!0,this._boundsBottom=!0,this._boundsOwnGroup=!1,this.setBoundsToWorld(!0,!0,!0,!0,!1)},U.Physics.P2.prototype={removeBodyNextStep:function(t){this._toRemove.push(t)},preUpdate:function(){for(var t=this._toRemove.length;t--;)this.removeBody(this._toRemove[t]);this._toRemove.length=0},enable:function(t,e,i){void 0===e&&(e=!1),void 0===i&&(i=!0);var n=1;if(Array.isArray(t))for(n=t.length;n--;)t[n]instanceof U.Group?this.enable(t[n].children,e,i):(this.enableBody(t[n],e),i&&t[n].hasOwnProperty("children")&&0<t[n].children.length&&this.enable(t[n],e,!0));else t instanceof U.Group?this.enable(t.children,e,i):(this.enableBody(t,e),i&&t.hasOwnProperty("children")&&0<t.children.length&&this.enable(t.children,e,!0))},enableBody:function(t,e){t.hasOwnProperty("body")&&null===t.body&&(t.body=new U.Physics.P2.Body(this.game,t,t.x,t.y,1),t.body.debug=e,void 0!==t.anchor&&t.anchor.set(.5))},setImpactEvents:function(t){t?this.world.on("impact",this.impactHandler,this):this.world.off("impact",this.impactHandler,this)},setPostBroadphaseCallback:function(t,e){this.postBroadphaseCallback=t,this.callbackContext=e,null!==t?this.world.on("postBroadphase",this.postBroadphaseHandler,this):this.world.off("postBroadphase",this.postBroadphaseHandler,this)},postBroadphaseHandler:function(t){if(this.postBroadphaseCallback&&0!==t.pairs.length)for(var e=t.pairs.length-2;0<=e;e-=2)t.pairs[e].parent&&t.pairs[e+1].parent&&!this.postBroadphaseCallback.call(this.callbackContext,t.pairs[e].parent,t.pairs[e+1].parent)&&t.pairs.splice(e,2)},impactHandler:function(t){var e,i;t.bodyA.parent&&t.bodyB.parent&&(e=t.bodyA.parent,i=t.bodyB.parent,e._bodyCallbacks[t.bodyB.id]&&e._bodyCallbacks[t.bodyB.id].call(e._bodyCallbackContext[t.bodyB.id],e,i,t.shapeA,t.shapeB),i._bodyCallbacks[t.bodyA.id]&&i._bodyCallbacks[t.bodyA.id].call(i._bodyCallbackContext[t.bodyA.id],i,e,t.shapeB,t.shapeA),e._groupCallbacks[t.shapeB.collisionGroup]&&e._groupCallbacks[t.shapeB.collisionGroup].call(e._groupCallbackContext[t.shapeB.collisionGroup],e,i,t.shapeA,t.shapeB),i._groupCallbacks[t.shapeA.collisionGroup]&&i._groupCallbacks[t.shapeA.collisionGroup].call(i._groupCallbackContext[t.shapeA.collisionGroup],i,e,t.shapeB,t.shapeA))},beginContactHandler:function(t){t.bodyA&&t.bodyB&&(this.onBeginContact.dispatch(t.bodyA,t.bodyB,t.shapeA,t.shapeB,t.contactEquations),t.bodyA.parent&&t.bodyA.parent.onBeginContact.dispatch(t.bodyB.parent,t.bodyB,t.shapeA,t.shapeB,t.contactEquations),t.bodyB.parent&&t.bodyB.parent.onBeginContact.dispatch(t.bodyA.parent,t.bodyA,t.shapeB,t.shapeA,t.contactEquations))},endContactHandler:function(t){t.bodyA&&t.bodyB&&(this.onEndContact.dispatch(t.bodyA,t.bodyB,t.shapeA,t.shapeB),t.bodyA.parent&&t.bodyA.parent.onEndContact.dispatch(t.bodyB.parent,t.bodyB,t.shapeA,t.shapeB),t.bodyB.parent&&t.bodyB.parent.onEndContact.dispatch(t.bodyA.parent,t.bodyA,t.shapeB,t.shapeA))},setBoundsToWorld:function(t,e,i,n,r){this.setBounds(this.game.world.bounds.x,this.game.world.bounds.y,this.game.world.bounds.width,this.game.world.bounds.height,t,e,i,n,r)},setWorldMaterial:function(t,e,i,n,r){void 0===i&&(i=!0),void 0===n&&(n=!0),void 0===r&&(r=!0),(e=void 0===e?!0:e)&&this.walls.left&&(this.walls.left.shapes[0].material=t),i&&this.walls.right&&(this.walls.right.shapes[0].material=t),n&&this.walls.top&&(this.walls.top.shapes[0].material=t),r&&this.walls.bottom&&(this.walls.bottom.shapes[0].material=t)},updateBoundsCollisionGroup:function(t){var e=((t=void 0===t?!0:t)?this.boundsCollisionGroup:this.everythingCollisionGroup).mask;this.walls.left&&(this.walls.left.shapes[0].collisionGroup=e),this.walls.right&&(this.walls.right.shapes[0].collisionGroup=e),this.walls.top&&(this.walls.top.shapes[0].collisionGroup=e),this.walls.bottom&&(this.walls.bottom.shapes[0].collisionGroup=e),this._boundsOwnGroup=t},setBounds:function(t,e,i,n,r,o,s,a,h){void 0===r&&(r=this._boundsLeft),void 0===o&&(o=this._boundsRight),void 0===s&&(s=this._boundsTop),void 0===a&&(a=this._boundsBottom),void 0===h&&(h=this._boundsOwnGroup),this.setupWall(r,"left",t,e,1.5707963267948966,h),this.setupWall(o,"right",t+i,e,-1.5707963267948966,h),this.setupWall(s,"top",t,e,-3.141592653589793,h),this.setupWall(a,"bottom",t,e+n,0,h),this._boundsLeft=r,this._boundsRight=o,this._boundsTop=s,this._boundsBottom=a,this._boundsOwnGroup=h},setupWall:function(t,e,i,n,r,o){t?(this.walls[e]?this.walls[e].position=[this.pxmi(i),this.pxmi(n)]:(this.walls[e]=new p2.Body({mass:0,position:[this.pxmi(i),this.pxmi(n)],angle:r}),this.walls[e].addShape(new p2.Plane),this.world.addBody(this.walls[e])),o&&(this.walls[e].shapes[0].collisionGroup=this.boundsCollisionGroup.mask)):this.walls[e]&&(this.world.removeBody(this.walls[e]),this.walls[e]=null)},pause:function(){this.paused=!0},resume:function(){this.paused=!1},update:function(){this.paused||(this.useElapsedTime?this.world.step(this.game.time.physicsElapsed):this.world.step(this.frameRate))},reset:function(){this.world.on("beginContact",this.beginContactHandler,this),this.world.on("endContact",this.endContactHandler,this),this.nothingCollisionGroup=new U.Physics.P2.CollisionGroup(1),this.boundsCollisionGroup=new U.Physics.P2.CollisionGroup(2),this.everythingCollisionGroup=new U.Physics.P2.CollisionGroup(2147483648),this._collisionGroupID=2,this.setBoundsToWorld(!0,!0,!0,!0,!1)},clear:function(){this.world.time=0,this.world.fixedStepTime=0,this.world.solver&&this.world.solver.equations.length&&this.world.solver.removeAllEquations();for(var t=this.world.constraints,e=t.length-1;0<=e;e--)this.world.removeConstraint(t[e]);for(var i=this.world.bodies,e=i.length-1;0<=e;e--)this.world.removeBody(i[e]);for(var n=this.world.springs,e=n.length-1;0<=e;e--)this.world.removeSpring(n[e]);for(var r=this.world.contactMaterials,e=r.length-1;0<=e;e--)this.world.removeContactMaterial(r[e]);this.world.off("beginContact",this.beginContactHandler,this),this.world.off("endContact",this.endContactHandler,this),this.postBroadphaseCallback=null,this.callbackContext=null,this.impactCallback=null,this.collisionGroups=[],this._toRemove=[],this.boundsCollidesWith=[],this.walls={left:null,right:null,top:null,bottom:null}},destroy:function(){this.clear(),this.game=null},addBody:function(t){return!t.data.world&&(this.world.addBody(t.data),this.onBodyAdded.dispatch(t),!0)},removeBody:function(t){return t.data.world===this.world&&(this.world.removeBody(t.data),this.onBodyRemoved.dispatch(t)),t},addSpring:function(t){return t instanceof U.Physics.P2.Spring||t instanceof U.Physics.P2.RotationalSpring?this.world.addSpring(t.data):this.world.addSpring(t),this.onSpringAdded.dispatch(t),t},removeSpring:function(t){return t instanceof U.Physics.P2.Spring||t instanceof U.Physics.P2.RotationalSpring?this.world.removeSpring(t.data):this.world.removeSpring(t),this.onSpringRemoved.dispatch(t),t},createDistanceConstraint:function(t,e,i,n,r,o){if(t=this.getBody(t),e=this.getBody(e),t&&e)return this.addConstraint(new U.Physics.P2.DistanceConstraint(this,t,e,i,n,r,o))},createGearConstraint:function(t,e,i,n){if(t=this.getBody(t),e=this.getBody(e),t&&e)return this.addConstraint(new U.Physics.P2.GearConstraint(this,t,e,i,n))},createRevoluteConstraint:function(t,e,i,n,r,o){if(t=this.getBody(t),i=this.getBody(i),t&&i)return this.addConstraint(new U.Physics.P2.RevoluteConstraint(this,t,e,i,n,r,o))},createLockConstraint:function(t,e,i,n,r){if(t=this.getBody(t),e=this.getBody(e),t&&e)return this.addConstraint(new U.Physics.P2.LockConstraint(this,t,e,i,n,r))},createPrismaticConstraint:function(t,e,i,n,r,o,s){if(t=this.getBody(t),e=this.getBody(e),t&&e)return this.addConstraint(new U.Physics.P2.PrismaticConstraint(this,t,e,i,n,r,o,s))},addConstraint:function(t){return this.world.addConstraint(t),this.onConstraintAdded.dispatch(t),t},removeConstraint:function(t){return this.world.removeConstraint(t),this.onConstraintRemoved.dispatch(t),t},addContactMaterial:function(t){return this.world.addContactMaterial(t),this.onContactMaterialAdded.dispatch(t),t},removeContactMaterial:function(t){return this.world.removeContactMaterial(t),this.onContactMaterialRemoved.dispatch(t),t},getContactMaterial:function(t,e){return this.world.getContactMaterial(t,e)},setMaterial:function(t,e){for(var i=e.length;i--;)e[i].setMaterial(t)},createMaterial:function(t,e){t=new U.Physics.P2.Material(t=t||"");return this.materials.push(t),void 0!==e&&e.setMaterial(t),t},createContactMaterial:function(t,e,i){void 0===t&&(t=this.createMaterial()),void 0===e&&(e=this.createMaterial());i=new U.Physics.P2.ContactMaterial(t,e,i);return this.addContactMaterial(i)},getBodies:function(){for(var t=[],e=this.world.bodies.length;e--;)t.push(this.world.bodies[e].parent);return t},getBody:function(t){return t instanceof p2.Body?t:t instanceof U.Physics.P2.Body?t.data:t.body&&t.body.type===U.Physics.P2JS?t.body.data:null},getSprings:function(){for(var t=[],e=this.world.springs.length;e--;)t.push(this.world.springs[e].parent);return t},getConstraints:function(){for(var t=[],e=this.world.constraints.length;e--;)t.push(this.world.constraints[e]);return t},hitTest:function(t,e,i,n){void 0===e&&(e=this.world.bodies),void 0===i&&(i=5),void 0===n&&(n=!1);for(var t=[this.pxmi(t.x),this.pxmi(t.y)],r=[],o=e.length;o--;)e[o]instanceof U.Physics.P2.Body&&(!n||e[o].data.type!==p2.Body.STATIC)?r.push(e[o].data):e[o]instanceof p2.Body&&e[o].parent&&(!n||e[o].type!==p2.Body.STATIC)?r.push(e[o]):e[o]instanceof U.Sprite&&e[o].hasOwnProperty("body")&&(!n||e[o].body.data.type!==p2.Body.STATIC)&&r.push(e[o].body.data);return this.world.hitTest(t,r,i)},toJSON:function(){return this.world.toJSON()},createCollisionGroup:function(t){var e=Math.pow(2,this._collisionGroupID);this.walls.left&&(this.walls.left.shapes[0].collisionMask=this.walls.left.shapes[0].collisionMask|e),this.walls.right&&(this.walls.right.shapes[0].collisionMask=this.walls.right.shapes[0].collisionMask|e),this.walls.top&&(this.walls.top.shapes[0].collisionMask=this.walls.top.shapes[0].collisionMask|e),this.walls.bottom&&(this.walls.bottom.shapes[0].collisionMask=this.walls.bottom.shapes[0].collisionMask|e),this._collisionGroupID++;e=new U.Physics.P2.CollisionGroup(e);return this.collisionGroups.push(e),t&&this.setCollisionGroup(t,e),e},setCollisionGroup:function(t,e){if(t instanceof U.Group)for(var i=0;i<t.total;i++)t.children[i].body&&t.children[i].body.type===U.Physics.P2JS&&t.children[i].body.setCollisionGroup(e);else t.body.setCollisionGroup(e)},createSpring:function(t,e,i,n,r,o,s,a,h){if(t=this.getBody(t),e=this.getBody(e),t&&e)return this.addSpring(new U.Physics.P2.Spring(this,t,e,i,n,r,o,s,a,h))},createRotationalSpring:function(t,e,i,n,r){if(t=this.getBody(t),e=this.getBody(e),t&&e)return this.addSpring(new U.Physics.P2.RotationalSpring(this,t,e,i,n,r))},createBody:function(t,e,i,n,r,o){void 0===n&&(n=!1);i=new U.Physics.P2.Body(this.game,null,t,e,i);return!(o&&!i.addPolygon(r,o))&&(n&&this.world.addBody(i.data),i)},createParticle:function(t,e,i,n,r,o){void 0===n&&(n=!1);i=new U.Physics.P2.Body(this.game,null,t,e,i);return!(o&&!i.addPolygon(r,o))&&(n&&this.world.addBody(i.data),i)},convertCollisionObjects:function(t,e,i){void 0===i&&(i=!0);for(var n=[],r=0,o=t.collision[e].length;r<o;r++){var s=t.collision[e][r],s=this.createBody(s.x,s.y,0,i,{},s.polyline);s&&n.push(s)}return n},clearTilemapLayerBodies:function(t,e){e=t.getLayer(e);for(var i=t.layers[e].bodies.length;i--;)t.layers[e].bodies[i].destroy();t.layers[e].bodies.length=0},convertTilemap:function(t,e,i,n){e=t.getLayer(e),void 0===i&&(i=!0),void 0===n&&(n=!0),this.clearTilemapLayerBodies(t,e);for(var r=0,o=0,s=0,a=0,h=t.layers[e].height;a<h;a++)for(var r=0,l=0,p=t.layers[e].width;l<p;l++){var u,d,c=t.layers[e].data[a][l];c&&-1<c.index&&c.collides&&(n?(u=t.getTileRight(e,l,a),0===r&&(o=c.x*c.width,s=c.y*c.height,r=c.width),u&&u.collides?r+=c.width:((d=this.createBody(o,s,0,!1)).addRectangle(r,c.height,r/2,c.height/2,0),i&&this.addBody(d),t.layers[e].bodies.push(d),r=0)):((d=this.createBody(c.x*c.width,c.y*c.height,0,!1)).addRectangle(c.width,c.height,c.width/2,c.height/2,0),i&&this.addBody(d),t.layers[e].bodies.push(d)))}return t.layers[e].bodies},mpx:function(t){return 20*t},pxm:function(t){return.05*t},mpxi:function(t){return-20*t},pxmi:function(t){return-.05*t}},Object.defineProperty(U.Physics.P2.prototype,"friction",{get:function(){return this.world.defaultContactMaterial.friction},set:function(t){this.world.defaultContactMaterial.friction=t}}),Object.defineProperty(U.Physics.P2.prototype,"restitution",{get:function(){return this.world.defaultContactMaterial.restitution},set:function(t){this.world.defaultContactMaterial.restitution=t}}),Object.defineProperty(U.Physics.P2.prototype,"contactMaterial",{get:function(){return this.world.defaultContactMaterial},set:function(t){this.world.defaultContactMaterial=t}}),Object.defineProperty(U.Physics.P2.prototype,"applySpringForces",{get:function(){return this.world.applySpringForces},set:function(t){this.world.applySpringForces=t}}),Object.defineProperty(U.Physics.P2.prototype,"applyDamping",{get:function(){return this.world.applyDamping},set:function(t){this.world.applyDamping=t}}),Object.defineProperty(U.Physics.P2.prototype,"applyGravity",{get:function(){return this.world.applyGravity},set:function(t){this.world.applyGravity=t}}),Object.defineProperty(U.Physics.P2.prototype,"solveConstraints",{get:function(){return this.world.solveConstraints},set:function(t){this.world.solveConstraints=t}}),Object.defineProperty(U.Physics.P2.prototype,"time",{get:function(){return this.world.time}}),Object.defineProperty(U.Physics.P2.prototype,"emitImpactEvent",{get:function(){return this.world.emitImpactEvent},set:function(t){this.world.emitImpactEvent=t}}),Object.defineProperty(U.Physics.P2.prototype,"sleepMode",{get:function(){return this.world.sleepMode},set:function(t){this.world.sleepMode=t}}),Object.defineProperty(U.Physics.P2.prototype,"total",{get:function(){return this.world.bodies.length}}),U.Physics.P2.FixtureList=function(t){Array.isArray(t)||(t=[t]),this.rawList=t,this.init(),this.parse(this.rawList)},U.Physics.P2.FixtureList.prototype={init:function(){this.namedFixtures={},this.groupedFixtures=[],this.allFixtures=[]},setCategory:function(e,t){this.getFixtures(t).forEach(function(t){t.collisionGroup=e})},setMask:function(e,t){this.getFixtures(t).forEach(function(t){t.collisionMask=e})},setSensor:function(e,t){this.getFixtures(t).forEach(function(t){t.sensor=e})},setMaterial:function(e,t){this.getFixtures(t).forEach(function(t){t.material=e})},getFixtures:function(t){var e=[];if(t){t instanceof Array||(t=[t]);var i=this;return t.forEach(function(t){i.namedFixtures[t]&&e.push(i.namedFixtures[t])}),this.flatten(e)}return this.allFixtures},getFixtureByKey:function(t){return this.namedFixtures[t]},getGroup:function(t){return this.groupedFixtures[t]},parse:function(){var t,e,i=this.rawList,n=[];for(t in i)e=i[t],isNaN(+t)?this.namedFixtures[t]=this.flatten(e):(this.groupedFixtures[t]=this.groupedFixtures[t]||[],this.groupedFixtures[t]=this.groupedFixtures[t].concat(e)),n.push(this.allFixtures=this.flatten(this.groupedFixtures))},flatten:function(t){var e=[],i=arguments.callee;return t.forEach(function(t){return Array.prototype.push.apply(e,Array.isArray(t)?i(t):[t])}),e}},U.Physics.P2.PointProxy=function(t,e){this.world=t,this.destination=e},U.Physics.P2.PointProxy.prototype.constructor=U.Physics.P2.PointProxy,Object.defineProperty(U.Physics.P2.PointProxy.prototype,"x",{get:function(){return this.world.mpx(this.destination[0])},set:function(t){this.destination[0]=this.world.pxm(t)}}),Object.defineProperty(U.Physics.P2.PointProxy.prototype,"y",{get:function(){return this.world.mpx(this.destination[1])},set:function(t){this.destination[1]=this.world.pxm(t)}}),Object.defineProperty(U.Physics.P2.PointProxy.prototype,"mx",{get:function(){return this.destination[0]},set:function(t){this.destination[0]=t}}),Object.defineProperty(U.Physics.P2.PointProxy.prototype,"my",{get:function(){return this.destination[1]},set:function(t){this.destination[1]=t}}),U.Physics.P2.InversePointProxy=function(t,e){this.world=t,this.destination=e},U.Physics.P2.InversePointProxy.prototype.constructor=U.Physics.P2.InversePointProxy,Object.defineProperty(U.Physics.P2.InversePointProxy.prototype,"x",{get:function(){return this.world.mpxi(this.destination[0])},set:function(t){this.destination[0]=this.world.pxmi(t)}}),Object.defineProperty(U.Physics.P2.InversePointProxy.prototype,"y",{get:function(){return this.world.mpxi(this.destination[1])},set:function(t){this.destination[1]=this.world.pxmi(t)}}),Object.defineProperty(U.Physics.P2.InversePointProxy.prototype,"mx",{get:function(){return this.destination[0]},set:function(t){this.destination[0]=-t}}),Object.defineProperty(U.Physics.P2.InversePointProxy.prototype,"my",{get:function(){return this.destination[1]},set:function(t){this.destination[1]=-t}}),U.Physics.P2.Body=function(t,e,i,n,r){e=e||null,i=i||0,n=n||0,void 0===r&&(r=1),this.game=t,this.world=t.physics.p2,this.sprite=e,this.type=U.Physics.P2JS,this.offset=new U.Point,this.data=new p2.Body({position:[this.world.pxmi(i),this.world.pxmi(n)],mass:r}),(this.data.parent=this).velocity=new U.Physics.P2.InversePointProxy(this.world,this.data.velocity),this.force=new U.Physics.P2.InversePointProxy(this.world,this.data.force),this.gravity=new U.Point,this.onBeginContact=new U.Signal,this.onEndContact=new U.Signal,this.collidesWith=[],this.removeNextStep=!1,this.debugBody=null,this.dirty=!1,this._collideWorldBounds=!0,this._bodyCallbacks={},this._bodyCallbackContext={},this._groupCallbacks={},this._groupCallbackContext={},this._reset=!1,e&&(this.setRectangleFromSprite(e),e.exists&&this.game.physics.p2.addBody(this))},U.Physics.P2.Body.prototype={createBodyCallback:function(t,e,i){var n=-1;t.id?n=t.id:t.body&&(n=t.body.id),-1<n&&(null===e?(delete this._bodyCallbacks[n],delete this._bodyCallbackContext[n]):(this._bodyCallbacks[n]=e,this._bodyCallbackContext[n]=i))},createGroupCallback:function(t,e,i){null===e?(delete this._groupCallbacks[t.mask],delete this._groupCallbackContext[t.mask]):(this._groupCallbacks[t.mask]=e,this._groupCallbackContext[t.mask]=i)},getCollisionMask:function(){var t=0;this._collideWorldBounds&&(t=this.game.physics.p2.boundsCollisionGroup.mask);for(var e=0;e<this.collidesWith.length;e++)t|=this.collidesWith[e].mask;return t},updateCollisionMask:function(t){var e=this.getCollisionMask();if(void 0===t)for(var i=this.data.shapes.length-1;0<=i;i--)this.data.shapes[i].collisionMask=e;else t.collisionMask=e},setCollisionGroup:function(t,e){var i=this.getCollisionMask();if(void 0===e)for(var n=this.data.shapes.length-1;0<=n;n--)this.data.shapes[n].collisionGroup=t.mask,this.data.shapes[n].collisionMask=i;else e.collisionGroup=t.mask,e.collisionMask=i},clearCollision:function(t,e,i){if(void 0===t&&(t=!0),void 0===e&&(e=!0),void 0===i)for(var n=this.data.shapes.length-1;0<=n;n--)t&&(this.data.shapes[n].collisionGroup=null),e&&(this.data.shapes[n].collisionMask=null);else t&&(i.collisionGroup=null),e&&(i.collisionMask=null);t&&(this.collidesWith.length=0)},removeCollisionGroup:function(t,e,i){var n;if(void 0===e&&(e=!0),Array.isArray(t))for(var r=0;r<t.length;r++)-1<(n=this.collidesWith.indexOf(t[r]))&&(this.collidesWith.splice(n,1),e&&(delete this._groupCallbacks[t.mask],delete this._groupCallbackContext[t.mask]));else-1<(n=this.collidesWith.indexOf(t))&&(this.collidesWith.splice(n,1),e&&(delete this._groupCallbacks[t.mask],delete this._groupCallbackContext[t.mask]));var o=this.getCollisionMask();if(void 0===i)for(r=this.data.shapes.length-1;0<=r;r--)this.data.shapes[r].collisionMask=o;else i.collisionMask=o},collides:function(t,e,i,n){if(Array.isArray(t))for(var r=0;r<t.length;r++)-1===this.collidesWith.indexOf(t[r])&&(this.collidesWith.push(t[r]),e&&this.createGroupCallback(t[r],e,i));else-1===this.collidesWith.indexOf(t)&&(this.collidesWith.push(t),e&&this.createGroupCallback(t,e,i));var o=this.getCollisionMask();if(void 0===n)for(r=this.data.shapes.length-1;0<=r;r--)this.data.shapes[r].collisionMask=o;else n.collisionMask=o},adjustCenterOfMass:function(){this.data.adjustCenterOfMass(),this.shapeChanged()},getVelocityAtPoint:function(t,e){return this.data.getVelocityAtPoint(t,e)},applyDamping:function(t){this.data.applyDamping(t)},applyImpulse:function(t,e,i){this.data.applyImpulse(t,[this.world.pxmi(e),this.world.pxmi(i)])},applyImpulseLocal:function(t,e,i){this.data.applyImpulseLocal(t,[this.world.pxmi(e),this.world.pxmi(i)])},applyForce:function(t,e,i){this.data.applyForce(t,[this.world.pxmi(e),this.world.pxmi(i)])},setZeroForce:function(){this.data.setZeroForce()},setZeroRotation:function(){this.data.angularVelocity=0},setZeroVelocity:function(){this.data.velocity[0]=0,this.data.velocity[1]=0},setZeroDamping:function(){this.data.damping=0,this.data.angularDamping=0},toLocalFrame:function(t,e){return this.data.toLocalFrame(t,e)},toWorldFrame:function(t,e){return this.data.toWorldFrame(t,e)},rotateLeft:function(t){this.data.angularVelocity=this.world.pxm(-t)},rotateRight:function(t){this.data.angularVelocity=this.world.pxm(t)},moveForward:function(t){var e=this.world.pxmi(-t),t=this.data.angle+Math.PI/2;this.data.velocity[0]=e*Math.cos(t),this.data.velocity[1]=e*Math.sin(t)},moveBackward:function(t){var e=this.world.pxmi(-t),t=this.data.angle+Math.PI/2;this.data.velocity[0]=-e*Math.cos(t),this.data.velocity[1]=-e*Math.sin(t)},thrust:function(t){var e=this.world.pxmi(-t),t=this.data.angle+Math.PI/2;this.data.force[0]+=e*Math.cos(t),this.data.force[1]+=e*Math.sin(t)},thrustLeft:function(t){var e=this.world.pxmi(-t),t=this.data.angle;this.data.force[0]+=e*Math.cos(t),this.data.force[1]+=e*Math.sin(t)},thrustRight:function(t){var e=this.world.pxmi(-t),t=this.data.angle;this.data.force[0]-=e*Math.cos(t),this.data.force[1]-=e*Math.sin(t)},reverse:function(t){var e=this.world.pxmi(-t),t=this.data.angle+Math.PI/2;this.data.force[0]-=e*Math.cos(t),this.data.force[1]-=e*Math.sin(t)},moveLeft:function(t){this.data.velocity[0]=this.world.pxmi(-t)},moveRight:function(t){this.data.velocity[0]=this.world.pxmi(t)},moveUp:function(t){this.data.velocity[1]=this.world.pxmi(-t)},moveDown:function(t){this.data.velocity[1]=this.world.pxmi(t)},preUpdate:function(){this.dirty=!0,this.removeNextStep&&(this.removeFromWorld(),this.removeNextStep=!1)},postUpdate:function(){this.sprite.x=this.world.mpxi(this.data.position[0])+this.offset.x,this.sprite.y=this.world.mpxi(this.data.position[1])+this.offset.y,this.fixedRotation||(this.sprite.rotation=this.data.angle),this.debugBody&&this.debugBody.updateSpriteTransform(),this.dirty=!1},reset:function(t,e,i,n){void 0===i&&(i=!1),void 0===n&&(n=!1),this.setZeroForce(),this.setZeroVelocity(),this.setZeroRotation(),i&&this.setZeroDamping(),n&&(this.mass=1),this.x=t,this.y=e},addToWorld:function(){if(this.game.physics.p2._toRemove)for(var t=0;t<this.game.physics.p2._toRemove.length;t++)this.game.physics.p2._toRemove[t]===this&&this.game.physics.p2._toRemove.splice(t,1);this.data.world!==this.game.physics.p2.world&&this.game.physics.p2.addBody(this)},removeFromWorld:function(){this.data.world===this.game.physics.p2.world&&this.game.physics.p2.removeBodyNextStep(this)},destroy:function(){this.removeFromWorld(),this.clearShapes(),this._bodyCallbacks={},this._bodyCallbackContext={},this._groupCallbacks={},this._groupCallbackContext={},this.debugBody&&this.debugBody.destroy(!0,!0),this.debugBody=null,this.sprite&&(this.sprite.body=null,this.sprite=null)},clearShapes:function(){for(var t=this.data.shapes.length;t--;)this.data.removeShape(this.data.shapes[t]);this.shapeChanged()},addShape:function(t,e,i,n){return void 0===i&&(i=0),void 0===n&&(n=0),this.data.addShape(t,[this.world.pxmi(e=void 0===e?0:e),this.world.pxmi(i)],n),this.shapeChanged(),t},addCircle:function(t,e,i,n){t=new p2.Circle({radius:this.world.pxm(t)});return this.addShape(t,e,i,n)},addRectangle:function(t,e,i,n,r){e=new p2.Box({width:this.world.pxm(t),height:this.world.pxm(e)});return this.addShape(e,i,n,r)},addPlane:function(t,e,i){var n=new p2.Plane;return this.addShape(n,t,e,i)},addParticle:function(t,e,i){var n=new p2.Particle;return this.addShape(n,t,e,i)},addLine:function(t,e,i,n){t=new p2.Line({length:this.world.pxm(t)});return this.addShape(t,e,i,n)},addCapsule:function(t,e,i,n,r){e=new p2.Capsule({length:this.world.pxm(t),radius:this.world.pxm(e)});return this.addShape(e,i,n,r)},addPolygon:function(t,e){t=t||{};var i=[];if(1===(e=!Array.isArray(e)?Array.prototype.slice.call(arguments,1):e).length&&Array.isArray(e[0]))i=e[0].slice(0);else if(Array.isArray(e[0]))i=e.slice();else if("number"==typeof e[0])for(var n=0,r=e.length;n<r;n+=2)i.push([e[n],e[n+1]]);var o=i.length-1;i[o][0]===i[0][0]&&i[o][1]===i[0][1]&&i.pop();for(var s=0;s<i.length;s++)i[s][0]=this.world.pxmi(i[s][0]),i[s][1]=this.world.pxmi(i[s][1]);o=this.data.fromPolygon(i,t);return this.shapeChanged(),o},removeShape:function(t){t=this.data.removeShape(t);return this.shapeChanged(),t},setCircle:function(t,e,i,n){return this.clearShapes(),this.addCircle(t,e,i,n)},setRectangle:function(t,e,i,n,r){return void 0===t&&(t=16),void 0===e&&(e=16),this.clearShapes(),this.addRectangle(t,e,i,n,r)},setRectangleFromSprite:function(t){return void 0===t&&(t=this.sprite),this.clearShapes(),this.addRectangle(t.width,t.height,0,0,t.rotation)},setMaterial:function(t,e){if(void 0===e)for(var i=this.data.shapes.length-1;0<=i;i--)this.data.shapes[i].material=t;else e.material=t},shapeChanged:function(){this.debugBody&&this.debugBody.draw()},addPhaserPolygon:function(t,e){for(var i=this.game.cache.getPhysicsData(t,e),n=[],r=0;r<i.length;r++){var o=i[r],s=this.addFixture(o);n[o.filter.group]=n[o.filter.group]||[],n[o.filter.group]=n[o.filter.group].concat(s),o.fixtureKey&&(n[o.fixtureKey]=s)}return this.data.aabbNeedsUpdate=!0,this.shapeChanged(),n},addFixture:function(t){var e=[];if(t.circle){(l=new p2.Circle({radius:this.world.pxm(t.circle.radius)})).collisionGroup=t.filter.categoryBits,l.collisionMask=t.filter.maskBits,l.sensor=t.isSensor;var i=p2.vec2.create();i[0]=this.world.pxmi(t.circle.position[0]-this.sprite.width/2),i[1]=this.world.pxmi(t.circle.position[1]-this.sprite.height/2),this.data.addShape(l,i),e.push(l)}else for(var n=t.polygons,r=p2.vec2.create(),o=0;o<n.length;o++){for(var s=n[o],a=[],h=0;h<s.length;h+=2)a.push([this.world.pxmi(s[h]),this.world.pxmi(s[h+1])]);for(var l=new p2.Convex({vertices:a}),p=0;p!==l.vertices.length;p++){var u=l.vertices[p];p2.vec2.sub(u,u,l.centerOfMass)}p2.vec2.scale(r,l.centerOfMass,1),r[0]-=this.world.pxmi(this.sprite.width/2),r[1]-=this.world.pxmi(this.sprite.height/2),l.updateTriangles(),l.updateCenterOfMass(),l.updateBoundingRadius(),l.collisionGroup=t.filter.categoryBits,l.collisionMask=t.filter.maskBits,l.sensor=t.isSensor,this.data.addShape(l,r),e.push(l)}return e},loadPolygon:function(t,e){var i;i=null===t?e:this.game.cache.getPhysicsData(t,e);for(var n=p2.vec2.create(),r=0;r<i.length;r++){for(var o=[],s=0;s<i[r].shape.length;s+=2)o.push([this.world.pxmi(i[r].shape[s]),this.world.pxmi(i[r].shape[s+1])]);for(var a=new p2.Convex({vertices:o}),h=0;h!==a.vertices.length;h++){var l=a.vertices[h];p2.vec2.sub(l,l,a.centerOfMass)}p2.vec2.scale(n,a.centerOfMass,1),n[0]-=this.world.pxmi(this.sprite.width/2),n[1]-=this.world.pxmi(this.sprite.height/2),a.updateTriangles(),a.updateCenterOfMass(),a.updateBoundingRadius(),this.data.addShape(a,n)}return this.data.aabbNeedsUpdate=!0,this.shapeChanged(),!0}},U.Physics.P2.Body.prototype.constructor=U.Physics.P2.Body,U.Physics.P2.Body.DYNAMIC=1,U.Physics.P2.Body.STATIC=2,U.Physics.P2.Body.KINEMATIC=4,Object.defineProperty(U.Physics.P2.Body.prototype,"static",{get:function(){return this.data.type===U.Physics.P2.Body.STATIC},set:function(t){t&&this.data.type!==U.Physics.P2.Body.STATIC?(this.data.type=U.Physics.P2.Body.STATIC,this.mass=0):t||this.data.type!==U.Physics.P2.Body.STATIC||(this.data.type=U.Physics.P2.Body.DYNAMIC,this.mass=1)}}),Object.defineProperty(U.Physics.P2.Body.prototype,"dynamic",{get:function(){return this.data.type===U.Physics.P2.Body.DYNAMIC},set:function(t){t&&this.data.type!==U.Physics.P2.Body.DYNAMIC?(this.data.type=U.Physics.P2.Body.DYNAMIC,this.mass=1):t||this.data.type!==U.Physics.P2.Body.DYNAMIC||(this.data.type=U.Physics.P2.Body.STATIC,this.mass=0)}}),Object.defineProperty(U.Physics.P2.Body.prototype,"kinematic",{get:function(){return this.data.type===U.Physics.P2.Body.KINEMATIC},set:function(t){t&&this.data.type!==U.Physics.P2.Body.KINEMATIC?(this.data.type=U.Physics.P2.Body.KINEMATIC,this.mass=4):t||this.data.type!==U.Physics.P2.Body.KINEMATIC||(this.data.type=U.Physics.P2.Body.STATIC,this.mass=0)}}),Object.defineProperty(U.Physics.P2.Body.prototype,"allowSleep",{get:function(){return this.data.allowSleep},set:function(t){t!==this.data.allowSleep&&(this.data.allowSleep=t)}}),Object.defineProperty(U.Physics.P2.Body.prototype,"angle",{get:function(){return U.Math.wrapAngle(U.Math.radToDeg(this.data.angle))},set:function(t){this.data.angle=U.Math.degToRad(U.Math.wrapAngle(t))}}),Object.defineProperty(U.Physics.P2.Body.prototype,"angularDamping",{get:function(){return this.data.angularDamping},set:function(t){this.data.angularDamping=t}}),Object.defineProperty(U.Physics.P2.Body.prototype,"angularForce",{get:function(){return this.data.angularForce},set:function(t){this.data.angularForce=t}}),Object.defineProperty(U.Physics.P2.Body.prototype,"angularVelocity",{get:function(){return this.data.angularVelocity},set:function(t){this.data.angularVelocity=t}}),Object.defineProperty(U.Physics.P2.Body.prototype,"damping",{get:function(){return this.data.damping},set:function(t){this.data.damping=t}}),Object.defineProperty(U.Physics.P2.Body.prototype,"fixedRotation",{get:function(){return this.data.fixedRotation},set:function(t){t!==this.data.fixedRotation&&(this.data.fixedRotation=t)}}),Object.defineProperty(U.Physics.P2.Body.prototype,"inertia",{get:function(){return this.data.inertia},set:function(t){this.data.inertia=t}}),Object.defineProperty(U.Physics.P2.Body.prototype,"mass",{get:function(){return this.data.mass},set:function(t){t!==this.data.mass&&(this.data.mass=t,this.data.updateMassProperties())}}),Object.defineProperty(U.Physics.P2.Body.prototype,"motionState",{get:function(){return this.data.type},set:function(t){t!==this.data.type&&(this.data.type=t)}}),Object.defineProperty(U.Physics.P2.Body.prototype,"rotation",{get:function(){return this.data.angle},set:function(t){this.data.angle=t}}),Object.defineProperty(U.Physics.P2.Body.prototype,"sleepSpeedLimit",{get:function(){return this.data.sleepSpeedLimit},set:function(t){this.data.sleepSpeedLimit=t}}),Object.defineProperty(U.Physics.P2.Body.prototype,"x",{get:function(){return this.world.mpxi(this.data.position[0])},set:function(t){this.data.position[0]=this.world.pxmi(t)}}),Object.defineProperty(U.Physics.P2.Body.prototype,"y",{get:function(){return this.world.mpxi(this.data.position[1])},set:function(t){this.data.position[1]=this.world.pxmi(t)}}),Object.defineProperty(U.Physics.P2.Body.prototype,"id",{get:function(){return this.data.id}}),Object.defineProperty(U.Physics.P2.Body.prototype,"debug",{get:function(){return null!==this.debugBody},set:function(t){t&&!this.debugBody?this.debugBody=new U.Physics.P2.BodyDebug(this.game,this.data):!t&&this.debugBody&&(this.debugBody.destroy(),this.debugBody=null)}}),Object.defineProperty(U.Physics.P2.Body.prototype,"collideWorldBounds",{get:function(){return this._collideWorldBounds},set:function(t){t&&!this._collideWorldBounds?(this._collideWorldBounds=!0,this.updateCollisionMask()):!t&&this._collideWorldBounds&&(this._collideWorldBounds=!1,this.updateCollisionMask())}}),U.Physics.P2.BodyDebug=function(t,e,i){U.Group.call(this,t);var n={pixelsPerLengthUnit:t.physics.p2.mpx(1),debugPolygons:!1,lineWidth:1,alpha:.5};this.settings=U.Utils.extend(n,i),this.ppu=this.settings.pixelsPerLengthUnit,this.ppu=-1*this.ppu,this.body=e,this.canvas=new U.Graphics(t),this.canvas.alpha=this.settings.alpha,this.add(this.canvas),this.draw(),this.updateSpriteTransform()},U.Physics.P2.BodyDebug.prototype=Object.create(U.Group.prototype),U.Physics.P2.BodyDebug.prototype.constructor=U.Physics.P2.BodyDebug,U.Utils.extend(U.Physics.P2.BodyDebug.prototype,{updateSpriteTransform:function(){this.position.x=this.body.position[0]*this.ppu,this.position.y=this.body.position[1]*this.ppu,this.rotation=this.body.angle},draw:function(){var t,e,i,n,r,o,s,a,h,l,p,u,d=this.body,c=this.canvas;if(c.clear(),i=parseInt(this.randomPastelHex(),16),r=16711680,o=this.lineWidth,d instanceof p2.Body&&d.shapes.length)for(var y=d.shapes.length,_=0;_!==y;){if(s=(e=d.shapes[_]).position||0,t=e.angle||0,e instanceof p2.Circle)this.drawCircle(c,s[0]*this.ppu,s[1]*this.ppu,t,e.radius*this.ppu,i,o);else if(e instanceof p2.Capsule)this.drawCapsule(c,s[0]*this.ppu,s[1]*this.ppu,t,e.length*this.ppu,e.radius*this.ppu,r,i,o);else if(e instanceof p2.Plane)this.drawPlane(c,s[0]*this.ppu,-s[1]*this.ppu,i,r,5*o,10*o,10*o,100*this.ppu,t);else if(e instanceof p2.Line)this.drawLine(c,e.length*this.ppu,r,o);else if(e instanceof p2.Box)this.drawRectangle(c,s[0]*this.ppu,s[1]*this.ppu,t,e.width*this.ppu,e.height*this.ppu,r,i,o);else if(e instanceof p2.Convex){for(h=[],l=p2.vec2.create(),n=p=0,u=e.vertices.length;0<=u?p<u:u<p;n=0<=u?++p:--p)a=e.vertices[n],p2.vec2.rotate(l,a,t),h.push([(l[0]+s[0])*this.ppu,-(l[1]+s[1])*this.ppu]);this.drawConvex(c,h,e.triangles,r,i,o,this.settings.debugPolygons,[s[0]*this.ppu,-s[1]*this.ppu])}_++}},drawRectangle:function(t,e,i,n,r,o,s,a,h){t.lineStyle(h=void 0===h?1:h,s=void 0===s?0:s,1),t.beginFill(a),t.drawRect(e-r/2,i-o/2,r,o)},drawCircle:function(t,e,i,n,r,o,s){void 0===o&&(o=16777215),t.lineStyle(s=void 0===s?1:s,0,1),t.beginFill(o,1),t.drawCircle(e,i,2*-r),t.endFill(),t.moveTo(e,i),t.lineTo(e+r*Math.cos(-n),i+r*Math.sin(-n))},drawLine:function(t,e,i,n){t.lineStyle(5*(n=void 0===n?1:n),i=void 0===i?0:i,1),t.moveTo(-e/2,0),t.lineTo(e/2,0)},drawConvex:function(t,e,i,n,r,o,s,a){var h,l,p,u,d,c,y,_;if(void 0===o&&(o=1),void 0===n&&(n=0),s){for(h=[16711680,65280,255],l=0;l!==e.length+1;)d=e[l%e.length],_=e[(l+1)%e.length],u=d[0],y=d[1],d=_[0],_=_[1],t.lineStyle(o,h[l%h.length],1),t.moveTo(u,-y),t.lineTo(d,-_),t.drawCircle(u,-y,2*o),l++;return t.lineStyle(o,0,1),t.drawCircle(a[0],a[1],2*o)}for(t.lineStyle(o,n,1),t.beginFill(r),l=0;l!==e.length;)p=(c=e[l])[0],c=c[1],0===l?t.moveTo(p,-c):t.lineTo(p,-c),l++;if(t.endFill(),2<e.length)return t.moveTo(e[e.length-1][0],-e[e.length-1][1]),t.lineTo(e[0][0],-e[0][1])},drawPath:function(t,e,i,n,r){var o,s,a,h,l,p,u,d;for(t.lineStyle(r=void 0===r?1:r,i=void 0===i?0:i,1),"number"==typeof n&&t.beginFill(n),a=s=null,o=0;o<e.length;)u=(p=e[o])[0],d=p[1],u===s&&d===a||(0===o?t.moveTo(u,d):(h=s,l=a,p=e[(o+1)%e.length][0],0!=(u-h)*(e[(o+1)%e.length][1]-l)-(p-h)*(d-l)&&t.lineTo(u,d)),s=u,a=d),o++;"number"==typeof n&&t.endFill(),2<e.length&&"number"==typeof n&&(t.moveTo(e[e.length-1][0],e[e.length-1][1]),t.lineTo(e[0][0],e[0][1]))},drawPlane:function(t,e,i,n,r,o,s,a,h,l){void 0===n&&(n=16777215),t.lineStyle(o=void 0===o?1:o,r,11),t.beginFill(n),t.moveTo(e,-i),r=e+Math.cos(l)*this.game.width,n=i+Math.sin(l)*this.game.height,t.lineTo(r,-n),t.moveTo(e,-i),r=e+Math.cos(l)*-this.game.width,n=i+Math.sin(l)*-this.game.height,t.lineTo(r,-n)},drawCapsule:function(t,e,i,n,r,o,s,a,h){t.lineStyle(h=void 0===h?1:h,s=void 0===s?0:s,1);var l=Math.cos(n),n=Math.sin(n);t.beginFill(a,1),t.drawCircle(-r/2*l+e,-r/2*n+i,2*-o),t.drawCircle(r/2*l+e,r/2*n+i,2*-o),t.endFill(),t.lineStyle(h,s,0),t.beginFill(a,1),t.moveTo(-r/2*l+o*n+e,-r/2*n+o*l+i),t.lineTo(r/2*l+o*n+e,r/2*n+o*l+i),t.lineTo(r/2*l-o*n+e,r/2*n-o*l+i),t.lineTo(-r/2*l-o*n+e,-r/2*n-o*l+i),t.endFill(),t.lineStyle(h,s,1),t.moveTo(-r/2*l+o*n+e,-r/2*n+o*l+i),t.lineTo(r/2*l+o*n+e,r/2*n+o*l+i),t.moveTo(-r/2*l-o*n+e,-r/2*n-o*l+i),t.lineTo(r/2*l-o*n+e,r/2*n-o*l+i)},randomPastelHex:function(){var t=[255,255,255],e=Math.floor(256*Math.random()),i=Math.floor(256*Math.random()),n=Math.floor(256*Math.random());return e=Math.floor((e+3*t[0])/4),i=Math.floor((i+3*t[1])/4),n=Math.floor((n+3*t[2])/4),this.rgbToHex(e,i,n)},rgbToHex:function(t,e,i){return this.componentToHex(t)+this.componentToHex(e)+this.componentToHex(i)},componentToHex:function(t){t=t.toString(16);return 2===t.length?t:t+"0"}}),U.Physics.P2.Spring=function(t,e,i,n,r,o,s,a,h,l){this.game=t.game,void 0===r&&(r=100),void 0===o&&(o=1);o={restLength:n=(this.world=t).pxm(n=void 0===n?1:n),stiffness:r,damping:o};null!=s&&(o.worldAnchorA=[t.pxm(s[0]),t.pxm(s[1])]),null!=a&&(o.worldAnchorB=[t.pxm(a[0]),t.pxm(a[1])]),null!=h&&(o.localAnchorA=[t.pxm(h[0]),t.pxm(h[1])]),null!=l&&(o.localAnchorB=[t.pxm(l[0]),t.pxm(l[1])]),this.data=new p2.LinearSpring(e,i,o),this.data.parent=this},U.Physics.P2.Spring.prototype.constructor=U.Physics.P2.Spring,U.Physics.P2.RotationalSpring=function(t,e,i,n,r,o){this.game=t.game,this.world=t,void 0===r&&(r=100),void 0===o&&(o=1),n=(n=void 0===n?null:n)&&t.pxm(n),this.data=new p2.RotationalSpring(e,i,{restAngle:n,stiffness:r,damping:o}),this.data.parent=this},U.Physics.P2.Spring.prototype.constructor=U.Physics.P2.Spring,U.Physics.P2.Material=function(t){this.name=t,p2.Material.call(this)},U.Physics.P2.Material.prototype=Object.create(p2.Material.prototype),U.Physics.P2.Material.prototype.constructor=U.Physics.P2.Material,U.Physics.P2.ContactMaterial=function(t,e,i){p2.ContactMaterial.call(this,t,e,i)},U.Physics.P2.ContactMaterial.prototype=Object.create(p2.ContactMaterial.prototype),U.Physics.P2.ContactMaterial.prototype.constructor=U.Physics.P2.ContactMaterial,U.Physics.P2.CollisionGroup=function(t){this.mask=t},U.Physics.P2.DistanceConstraint=function(t,e,i,n,r,o,s){void 0===n&&(n=100),void 0===r&&(r=[0,0]),void 0===o&&(o=[0,0]),void 0===s&&(s=Number.MAX_VALUE),this.game=t.game,n=(this.world=t).pxm(n),r=[t.pxmi(r[0]),t.pxmi(r[1])],o=[t.pxmi(o[0]),t.pxmi(o[1])],p2.DistanceConstraint.call(this,e,i,{distance:n,localAnchorA:r,localAnchorB:o,maxForce:s})},U.Physics.P2.DistanceConstraint.prototype=Object.create(p2.DistanceConstraint.prototype),U.Physics.P2.DistanceConstraint.prototype.constructor=U.Physics.P2.DistanceConstraint,U.Physics.P2.GearConstraint=function(t,e,i,n,r){void 0===n&&(n=0),void 0===r&&(r=1),this.game=t.game,this.world=t,p2.GearConstraint.call(this,e,i,{angle:n,ratio:r})},U.Physics.P2.GearConstraint.prototype=Object.create(p2.GearConstraint.prototype),U.Physics.P2.GearConstraint.prototype.constructor=U.Physics.P2.GearConstraint,U.Physics.P2.LockConstraint=function(t,e,i,n,r,o){void 0===n&&(n=[0,0]),void 0===r&&(r=0),void 0===o&&(o=Number.MAX_VALUE),this.game=t.game,n=[(this.world=t).pxm(n[0]),t.pxm(n[1])],p2.LockConstraint.call(this,e,i,{localOffsetB:n,localAngleB:r,maxForce:o})},U.Physics.P2.LockConstraint.prototype=Object.create(p2.LockConstraint.prototype),U.Physics.P2.LockConstraint.prototype.constructor=U.Physics.P2.LockConstraint,U.Physics.P2.PrismaticConstraint=function(t,e,i,n,r,o,s,a){void 0===n&&(n=!0),void 0===r&&(r=[0,0]),void 0===o&&(o=[0,0]),void 0===s&&(s=[0,0]),void 0===a&&(a=Number.MAX_VALUE),this.game=t.game,r=[(this.world=t).pxmi(r[0]),t.pxmi(r[1])],o=[t.pxmi(o[0]),t.pxmi(o[1])],p2.PrismaticConstraint.call(this,e,i,{localAnchorA:r,localAnchorB:o,localAxisA:s,maxForce:a,disableRotationalLock:!n})},U.Physics.P2.PrismaticConstraint.prototype=Object.create(p2.PrismaticConstraint.prototype),U.Physics.P2.PrismaticConstraint.prototype.constructor=U.Physics.P2.PrismaticConstraint,U.Physics.P2.RevoluteConstraint=function(t,e,i,n,r,o,s){void 0===o&&(o=Number.MAX_VALUE),void 0===s&&(s=null),this.game=t.game,i=[(this.world=t).pxmi(i[0]),t.pxmi(i[1])],r=[t.pxmi(r[0]),t.pxmi(r[1])],s=s&&[t.pxmi(s[0]),t.pxmi(s[1])],p2.RevoluteConstraint.call(this,e,n,{worldPivot:s,localPivotA:i,localPivotB:r,maxForce:o})},U.Physics.P2.RevoluteConstraint.prototype=Object.create(p2.RevoluteConstraint.prototype),U.Physics.P2.RevoluteConstraint.prototype.constructor=U.Physics.P2.RevoluteConstraint,U.ImageCollection=function(t,e,i,n,r,o,s){(void 0===i||i<=0)&&(i=32),(void 0===n||n<=0)&&(n=32),void 0===r&&(r=0),void 0===o&&(o=0),this.name=t,this.firstgid=0|e,this.imageWidth=0|i,this.imageHeight=0|n,this.imageMargin=0|r,this.imageSpacing=0|o,this.properties=s||{},this.images=[],this.total=0},U.ImageCollection.prototype={containsImageIndex:function(t){return t>=this.firstgid&&t<this.firstgid+this.total},addImage:function(t,e){this.images.push({gid:t,image:e}),this.total++}},U.ImageCollection.prototype.constructor=U.ImageCollection,U.Tile=function(t,e,i,n,r,o){this.layer=t,this.index=e,this.x=i,this.y=n,this.rotation=0,this.flipped=!1,this.worldX=i*r,this.worldY=n*o,this.width=r,this.height=o,this.centerX=Math.abs(r/2),this.centerY=Math.abs(o/2),this.alpha=1,this.properties={},this.scanned=!1,this.faceTop=!1,this.faceBottom=!1,this.faceLeft=!1,this.faceRight=!1,this.collideLeft=!1,this.collideRight=!1,this.collideUp=!1,this.collideDown=!1,this.collisionCallback=null,this.collisionCallbackContext=this},U.Tile.prototype={containsPoint:function(t,e){return!(t<this.worldX||e<this.worldY||t>this.right||e>this.bottom)},intersects:function(t,e,i,n){return!(i<=this.worldX||n<=this.worldY||t>=this.worldX+this.width||e>=this.worldY+this.height)},setCollisionCallback:function(t,e){this.collisionCallback=t,this.collisionCallbackContext=e},destroy:function(){this.collisionCallback=null,this.collisionCallbackContext=null,this.properties=null},setCollision:function(t,e,i,n){this.collideLeft=t,this.collideRight=e,this.collideUp=i,this.collideDown=n,this.faceLeft=t,this.faceRight=e,this.faceTop=i,this.faceBottom=n},resetCollision:function(){this.collideLeft=!1,this.collideRight=!1,this.collideUp=!1,this.collideDown=!1,this.faceTop=!1,this.faceBottom=!1,this.faceLeft=!1,this.faceRight=!1},isInteresting:function(t,e){return t&&e?this.collideLeft||this.collideRight||this.collideUp||this.collideDown||this.faceTop||this.faceBottom||this.faceLeft||this.faceRight||this.collisionCallback:t?this.collideLeft||this.collideRight||this.collideUp||this.collideDown:!!e&&(this.faceTop||this.faceBottom||this.faceLeft||this.faceRight)},copy:function(t){this.index=t.index,this.alpha=t.alpha,this.properties=t.properties,this.collideUp=t.collideUp,this.collideDown=t.collideDown,this.collideLeft=t.collideLeft,this.collideRight=t.collideRight,this.collisionCallback=t.collisionCallback,this.collisionCallbackContext=t.collisionCallbackContext}},U.Tile.prototype.constructor=U.Tile,Object.defineProperty(U.Tile.prototype,"collides",{get:function(){return this.collideLeft||this.collideRight||this.collideUp||this.collideDown}}),Object.defineProperty(U.Tile.prototype,"canCollide",{get:function(){return this.collideLeft||this.collideRight||this.collideUp||this.collideDown||this.collisionCallback}}),Object.defineProperty(U.Tile.prototype,"left",{get:function(){return this.worldX}}),Object.defineProperty(U.Tile.prototype,"right",{get:function(){return this.worldX+this.width}}),Object.defineProperty(U.Tile.prototype,"top",{get:function(){return this.worldY}}),Object.defineProperty(U.Tile.prototype,"bottom",{get:function(){return this.worldY+this.height}}),U.Tilemap=function(t,e,i,n,r,o){this.game=t,this.key=e;o=U.TilemapParser.parse(this.game,e,i,n,r,o);null!==o&&(this.width=o.width,this.height=o.height,this.tileWidth=o.tileWidth,this.tileHeight=o.tileHeight,this.orientation=o.orientation,this.format=o.format,this.version=o.version,this.properties=o.properties,this.widthInPixels=o.widthInPixels,this.heightInPixels=o.heightInPixels,this.layers=o.layers,this.tilesets=o.tilesets,this.imagecollections=o.imagecollections,this.tiles=o.tiles,this.objects=o.objects,this.collideIndexes=[],this.collision=o.collision,this.images=o.images,this.enableDebug=!1,this.currentLayer=0,this.debugMap=[],this._results=[],this._tempA=0,this._tempB=0)},U.Tilemap.CSV=0,U.Tilemap.TILED_JSON=1,U.Tilemap.NORTH=0,U.Tilemap.EAST=1,U.Tilemap.SOUTH=2,U.Tilemap.WEST=3,U.Tilemap.prototype={create:function(t,e,i,n,r,o){return void 0===o&&(o=this.game.world),this.width=e,this.height=i,this.setTileSize(n,r),this.layers.length=0,this.createBlankLayer(t,e,i,n,r,o)},setTileSize:function(t,e){this.tileWidth=t,this.tileHeight=e,this.widthInPixels=this.width*t,this.heightInPixels=this.height*e},addTilesetImage:function(t,e,i,n,r,o,s){if(void 0===t)return null;void 0===r&&(r=0),void 0===o&&(o=0),void 0===s&&(s=0),0===(i=void 0===i?this.tileWidth:i)&&(i=32),0===(n=void 0===n?this.tileHeight:n)&&(n=32);var a=null;if((e=null==e?t:e)instanceof U.BitmapData)a=e.canvas;else{if(!this.game.cache.checkImageKey(e))return null;a=this.game.cache.getImage(e)}e=this.getTilesetIndex(t);if(null===e&&this.format===U.Tilemap.TILED_JSON)return null;if(this.tilesets[e])return this.tilesets[e].setImage(a),this.tilesets[e];var h=new U.Tileset(t,s,i,n,r,o,{});h.setImage(a),this.tilesets.push(h);for(var l=this.tilesets.length-1,p=r,u=r,d=0,c=0,y=0,_=s;_<s+h.total&&(this.tiles[_]=[p,u,l],p+=i+o,++d!==h.total)&&(++c!==h.columns||(p=r,u+=n+o,c=0,++y!==h.rows));_++);return h},createFromObjects:function(t,e,i,n,r,o,s,a,h){if(void 0===r&&(r=!0),void 0===o&&(o=!1),void 0===s&&(s=this.game.world),void 0===a&&(a=U.Sprite),void 0===h&&(h=!0),this.objects[t])for(var l=0;l<this.objects[t].length;l++){var p=!1,u=this.objects[t][l];if(p=void 0!==u.gid&&"number"==typeof e&&u.gid===e||void 0!==u.id&&"number"==typeof e&&u.id===e||void 0!==u.name&&"string"==typeof e&&u.name===e?!0:p){var d,c=new a(this.game,parseFloat(u.x,10),parseFloat(u.y,10),i,n);for(d in c.name=u.name,c.visible=u.visible,c.autoCull=o,c.exists=r,u.width&&(c.width=u.width),u.height&&(c.height=u.height),u.rotation&&(c.angle=u.rotation),h&&(c.y-=c.height),s.add(c),u.properties)s.set(c,d,u.properties[d],!1,!1,0,!0)}}},createFromTiles:function(t,e,i,n,r,o){"number"==typeof t&&(t=[t]),null==e?e=[]:"number"==typeof e&&(e=[e]),n=this.getLayer(n),void 0===r&&(r=this.game.world),void 0===(o=void 0===o?{}:o).customClass&&(o.customClass=U.Sprite),void 0===o.adjustY&&(o.adjustY=!0);var s=this.layers[n].width,a=this.layers[n].height;if(this.copy(0,0,s,a,n),this._results.length<2)return 0;for(var h,l=0,p=1,u=this._results.length;p<u;p++)if(-1!==t.indexOf(this._results[p].index)){for(var d in h=new o.customClass(this.game,this._results[p].worldX,this._results[p].worldY,i),o)h[d]=o[d];r.add(h),l++}if(1===e.length)for(p=0;p<t.length;p++)this.replace(t[p],e[0],0,0,s,a,n);else if(1<e.length)for(p=0;p<t.length;p++)this.replace(t[p],e[p],0,0,s,a,n);return l},createLayer:function(t,e,i,n){void 0===e&&(e=this.game.width),void 0===i&&(i=this.game.height),void 0===n&&(n=this.game.world);var r=t;if(!(null===(r="string"==typeof t?this.getLayerIndex(t):r)||r>this.layers.length)){void 0===e||e<=0?e=Math.min(this.game.width,this.layers[r].widthInPixels):e>this.game.width&&(e=this.game.width),void 0===i||i<=0?i=Math.min(this.game.height,this.layers[r].heightInPixels):i>this.game.height&&(i=this.game.height),this.enableDebug;i=n.add(new U.TilemapLayer(this.game,this,r,e,i));return this.enableDebug,i}},createBlankLayer:function(t,e,i,n,r,o){if(void 0===o&&(o=this.game.world),null===this.getLayerIndex(t)){for(var s={name:t,x:0,y:0,width:e,height:i,widthInPixels:e*n,heightInPixels:i*r,alpha:1,visible:!0,properties:{},indexes:[],callbacks:[],bodies:[],data:null},a=[],h=0;h<i;h++){for(var l=[],p=0;p<e;p++)l.push(new U.Tile(s,-1,p,h,n,r));a.push(l)}s.data=a,this.layers.push(s),this.currentLayer=this.layers.length-1;var u=s.widthInPixels,d=s.heightInPixels;return u>this.game.width&&(u=this.game.width),d>this.game.height&&(d=this.game.height),(a=new U.TilemapLayer(this.game,this,this.layers.length-1,u,d)).name=t,o.add(a)}},getIndex:function(t,e){for(var i=0;i<t.length;i++)if(t[i].name===e)return i;return null},getLayerIndex:function(t){return this.getIndex(this.layers,t)},getTilesetIndex:function(t){return this.getIndex(this.tilesets,t)},getImageIndex:function(t){return this.getIndex(this.images,t)},setTileIndexCallback:function(t,e,i,n){if(n=this.getLayer(n),"number"==typeof t)this.layers[n].callbacks[t]={callback:e,callbackContext:i};else for(var r=0,o=t.length;r<o;r++)this.layers[n].callbacks[t[r]]={callback:e,callbackContext:i}},setTileLocationCallback:function(t,e,i,n,r,o,s){if(s=this.getLayer(s),this.copy(t,e,i,n,s),!(this._results.length<2))for(var a=1;a<this._results.length;a++)this._results[a].setCollisionCallback(r,o)},setCollision:function(t,e,i,n){if(void 0===e&&(e=!0),void 0===n&&(n=!0),i=this.getLayer(i),"number"==typeof t)return this.setCollisionByIndex(t,e,i,!0);if(Array.isArray(t)){for(var r=0;r<t.length;r++)this.setCollisionByIndex(t[r],e,i,!1);n&&this.calculateFaces(i)}},setCollisionBetween:function(t,e,i,n,r){if(void 0===i&&(i=!0),void 0===r&&(r=!0),n=this.getLayer(n),!(e<t)){for(var o=t;o<=e;o++)this.setCollisionByIndex(o,i,n,!1);r&&this.calculateFaces(n)}},setCollisionByExclusion:function(t,e,i,n){void 0===e&&(e=!0),void 0===n&&(n=!0),i=this.getLayer(i);for(var r=0,o=this.tiles.length;r<o;r++)-1===t.indexOf(r)&&this.setCollisionByIndex(r,e,i,!1);n&&this.calculateFaces(i)},setCollisionByIndex:function(t,e,i,n){var r;void 0===i&&(i=this.currentLayer),void 0===n&&(n=!0),(e=void 0===e||e)?this.collideIndexes.push(t):-1<(r=this.collideIndexes.indexOf(t))&&this.collideIndexes.splice(r,1);for(var o=0;o<this.layers[i].height;o++)for(var s=0;s<this.layers[i].width;s++){var a=this.layers[i].data[o][s];a&&a.index===t&&(e?a.setCollision(!0,!0,!0,!0):a.resetCollision(),a.faceTop=e,a.faceBottom=e,a.faceLeft=e,a.faceRight=e)}return n&&this.calculateFaces(i),i},getLayer:function(t){return void 0===t?t=this.currentLayer:"string"==typeof t?t=this.getLayerIndex(t):t instanceof U.TilemapLayer&&(t=t.index),t},setPreventRecalculate:function(t){if(!0===t&&!0!==this.preventingRecalculate&&(this.preventingRecalculate=!0,this.needToRecalculate={}),!1===t&&!0===this.preventingRecalculate){for(var e in this.preventingRecalculate=!1,this.needToRecalculate)this.calculateFaces(e);this.needToRecalculate=!1}},calculateFaces:function(t){if(this.preventingRecalculate)this.needToRecalculate[t]=!0;else for(var e,i,n,r,o=0,s=this.layers[t].height;o<s;o++)for(var a=0,h=this.layers[t].width;a<h;a++){var l=this.layers[t].data[o][a];l&&(e=this.getTileAbove(t,a,o),i=this.getTileBelow(t,a,o),n=this.getTileLeft(t,a,o),r=this.getTileRight(t,a,o),l.collides&&(l.faceTop=!0,l.faceBottom=!0,l.faceLeft=!0,l.faceRight=!0),e&&e.collides&&(l.faceTop=!1),i&&i.collides&&(l.faceBottom=!1),n&&n.collides&&(l.faceLeft=!1),r&&r.collides&&(l.faceRight=!1))}},getTileAbove:function(t,e,i){return 0<i?this.layers[t].data[i-1][e]:null},getTileBelow:function(t,e,i){return i<this.layers[t].height-1?this.layers[t].data[i+1][e]:null},getTileLeft:function(t,e,i){return 0<e?this.layers[t].data[i][e-1]:null},getTileRight:function(t,e,i){return e<this.layers[t].width-1?this.layers[t].data[i][e+1]:null},setLayer:function(t){t=this.getLayer(t),this.layers[t]&&(this.currentLayer=t)},hasTile:function(t,e,i){return i=this.getLayer(i),void 0!==this.layers[i].data[e]&&void 0!==this.layers[i].data[e][t]&&-1<this.layers[i].data[e][t].index},removeTile:function(t,e,i){if(i=this.getLayer(i),0<=t&&t<this.layers[i].width&&0<=e&&e<this.layers[i].height&&this.hasTile(t,e,i)){var n=this.layers[i].data[e][t];return this.layers[i].data[e][t]=new U.Tile(this.layers[i],-1,t,e,this.tileWidth,this.tileHeight),this.layers[i].dirty=!0,this.calculateFaces(i),n}},removeTileWorldXY:function(t,e,i,n,r){return r=this.getLayer(r),t=this.game.math.snapToFloor(t,i)/i,e=this.game.math.snapToFloor(e,n)/n,this.removeTile(t,e,r)},putTile:function(t,e,i,n){return null===t?this.removeTile(e,i,n):(n=this.getLayer(n),0<=e&&e<this.layers[n].width&&0<=i&&i<this.layers[n].height?(t instanceof U.Tile?(r=t.index,this.hasTile(e,i,n)?this.layers[n].data[i][e].copy(t):this.layers[n].data[i][e]=new U.Tile(n,r,e,i,t.width,t.height)):(r=t,this.hasTile(e,i,n)?this.layers[n].data[i][e].index=r:this.layers[n].data[i][e]=new U.Tile(this.layers[n],r,e,i,this.tileWidth,this.tileHeight)),-1<this.collideIndexes.indexOf(r)?this.layers[n].data[i][e].setCollision(!0,!0,!0,!0):this.layers[n].data[i][e].resetCollision(),this.layers[n].dirty=!0,this.calculateFaces(n),this.layers[n].data[i][e]):null);var r},putTileWorldXY:function(t,e,i,n,r,o){return o=this.getLayer(o),e=this.game.math.snapToFloor(e,n)/n,i=this.game.math.snapToFloor(i,r)/r,this.putTile(t,e,i,o)},searchTileIndex:function(t,e,i,n){void 0===e&&(e=0),void 0===i&&(i=!1),n=this.getLayer(n);var r=0;if(i){for(var o=this.layers[n].height-1;0<=o;o--)for(var s=this.layers[n].width-1;0<=s;s--)if(this.layers[n].data[o][s].index===t){if(r===e)return this.layers[n].data[o][s];r++}}else for(o=0;o<this.layers[n].height;o++)for(s=0;s<this.layers[n].width;s++)if(this.layers[n].data[o][s].index===t){if(r===e)return this.layers[n].data[o][s];r++}return null},getTile:function(t,e,i,n){return void 0===n&&(n=!1),i=this.getLayer(i),0<=t&&t<this.layers[i].width&&0<=e&&e<this.layers[i].height&&(-1!==this.layers[i].data[e][t].index||n)?this.layers[i].data[e][t]:null},getTileWorldXY:function(t,e,i,n,r,o){return void 0===i&&(i=this.tileWidth),void 0===n&&(n=this.tileHeight),r=this.getLayer(r),t=this.game.math.snapToFloor(t,i)/i,e=this.game.math.snapToFloor(e,n)/n,this.getTile(t,e,r,o)},copy:function(t,e,i,n,r){if(r=this.getLayer(r),this.layers[r]){void 0===i&&(i=this.layers[r].width),void 0===n&&(n=this.layers[r].height),(t=void 0===t?0:t)<0&&(t=0),(e=void 0===e?0:e)<0&&(e=0),i>this.layers[r].width&&(i=this.layers[r].width),n>this.layers[r].height&&(n=this.layers[r].height),this._results.length=0,this._results.push({x:t,y:e,width:i,height:n,layer:r});for(var o=e;o<e+n;o++)for(var s=t;s<t+i;s++)this._results.push(this.layers[r].data[o][s]);return this._results}this._results.length=0},paste:function(t,e,i,n){if(void 0===t&&(t=0),void 0===e&&(e=0),n=this.getLayer(n),i&&!(i.length<2)){for(var r=t-i[1].x,o=e-i[1].y,s=1;s<i.length;s++)this.layers[n].data[o+i[s].y][r+i[s].x].copy(i[s]);this.layers[n].dirty=!0,this.calculateFaces(n)}},swap:function(t,e,i,n,r,o,s){s=this.getLayer(s),this.copy(i,n,r,o,s),this._results.length<2||(this._tempA=t,this._tempB=e,this._results.forEach(this.swapHandler,this),this.paste(i,n,this._results,s))},swapHandler:function(t){t.index===this._tempA?t.index=this._tempB:t.index===this._tempB&&(t.index=this._tempA)},forEach:function(t,e,i,n,r,o,s){s=this.getLayer(s),this.copy(i,n,r,o,s),this._results.length<2||(this._results.forEach(t,e),this.paste(i,n,this._results,s))},replace:function(t,e,i,n,r,o,s){if(s=this.getLayer(s),this.copy(i,n,r,o,s),!(this._results.length<2)){for(var a=1;a<this._results.length;a++)this._results[a].index===t&&(this._results[a].index=e);this.paste(i,n,this._results,s)}},random:function(t,e,i,n,r){if(r=this.getLayer(r),this.copy(t,e,i,n,r),!(this._results.length<2)){for(var o,s=[],a=1;a<this._results.length;a++)this._results[a].index&&(o=this._results[a].index,-1===s.indexOf(o)&&s.push(o));for(var h=1;h<this._results.length;h++)this._results[h].index=this.game.rnd.pick(s);this.paste(t,e,this._results,r)}},shuffle:function(t,e,i,n,r){if(r=this.getLayer(r),this.copy(t,e,i,n,r),!(this._results.length<2)){for(var o=[],s=1;s<this._results.length;s++)this._results[s].index&&o.push(this._results[s].index);U.ArrayUtils.shuffle(o);for(var a=1;a<this._results.length;a++)this._results[a].index=o[a-1];this.paste(t,e,this._results,r)}},fill:function(t,e,i,n,r,o){if(o=this.getLayer(o),this.copy(e,i,n,r,o),!(this._results.length<2)){for(var s=1;s<this._results.length;s++)this._results[s].index=t;this.paste(e,i,this._results,o)}},removeAllLayers:function(){this.layers.length=0,this.currentLayer=0},dump:function(){for(var t="",e=[""],i=0;i<this.layers[this.currentLayer].height;i++){for(var n=0;n<this.layers[this.currentLayer].width;n++)t+="%c  ",1<this.layers[this.currentLayer].data[i][n]?this.debugMap[this.layers[this.currentLayer].data[i][n]]?e.push("background: "+this.debugMap[this.layers[this.currentLayer].data[i][n]]):e.push("background: #ffffff"):e.push("background: rgb(0, 0, 0)");t+="\n"}e[0]=t},destroy:function(){this.removeAllLayers(),this.data=[],this.game=null}},U.Tilemap.prototype.constructor=U.Tilemap,Object.defineProperty(U.Tilemap.prototype,"layer",{get:function(){return this.layers[this.currentLayer]},set:function(t){t!==this.currentLayer&&this.setLayer(t)}}),U.TilemapLayer=function(t,e,i,n,r){n|=0,r|=0,U.Sprite.call(this,t,0,0),this.map=e,this.index=i,this.layer=e.layers[i],this.canvas=PIXI.CanvasPool.create(this,n,r),this.context=this.canvas.getContext("2d"),this.setTexture(new PIXI.Texture(new PIXI.BaseTexture(this.canvas))),this.type=U.TILEMAPLAYER,this.physicsType=U.TILEMAPLAYER,this.renderSettings={enableScrollDelta:!1,overdrawRatio:.2,copyCanvas:null},this.debug=!1,this.exists=!0,this.debugSettings={missingImageFill:"rgb(255,255,255)",debuggedTileOverfill:"rgba(0,255,0,0.4)",forceFullRedraw:!0,debugAlpha:.5,facingEdgeStroke:"rgba(0,255,0,1)",collidingTileOverfill:"rgba(0,255,0,0.2)"},this.scrollFactorX=1,this.scrollFactorY=1,this.dirty=!0,this.rayStepRate=4,this._wrap=!1,this._mc={scrollX:0,scrollY:0,renderWidth:0,renderHeight:0,tileWidth:e.tileWidth,tileHeight:e.tileHeight,cw:e.tileWidth,ch:e.tileHeight,tilesets:[]},this._scrollX=0,this._scrollY=0,this._results=[],t.device.canvasBitBltShift||(this.renderSettings.copyCanvas=U.TilemapLayer.ensureSharedCopyCanvas()),this.fixedToCamera=!0},U.TilemapLayer.prototype=Object.create(U.Sprite.prototype),U.TilemapLayer.prototype.constructor=U.TilemapLayer,U.TilemapLayer.prototype.preUpdateCore=U.Component.Core.preUpdate,U.TilemapLayer.sharedCopyCanvas=null,U.TilemapLayer.ensureSharedCopyCanvas=function(){return this.sharedCopyCanvas||(this.sharedCopyCanvas=PIXI.CanvasPool.create(this,2,2)),this.sharedCopyCanvas},U.TilemapLayer.prototype.preUpdate=function(){return this.preUpdateCore()},U.TilemapLayer.prototype.postUpdate=function(){this.fixedToCamera&&(this.position.x=(this.game.camera.view.x+this.cameraOffset.x)/this.game.camera.scale.x,this.position.y=(this.game.camera.view.y+this.cameraOffset.y)/this.game.camera.scale.y),this._scrollX=this.game.camera.view.x*this.scrollFactorX/this.scale.x,this._scrollY=this.game.camera.view.y*this.scrollFactorY/this.scale.y},U.TilemapLayer.prototype._renderCanvas=function(t){this.fixedToCamera&&(this.position.x=(this.game.camera.view.x+this.cameraOffset.x)/this.game.camera.scale.x,this.position.y=(this.game.camera.view.y+this.cameraOffset.y)/this.game.camera.scale.y),this._scrollX=this.game.camera.view.x*this.scrollFactorX/this.scale.x,this._scrollY=this.game.camera.view.y*this.scrollFactorY/this.scale.y,this.render(),PIXI.Sprite.prototype._renderCanvas.call(this,t)},U.TilemapLayer.prototype._renderWebGL=function(t){this.fixedToCamera&&(this.position.x=(this.game.camera.view.x+this.cameraOffset.x)/this.game.camera.scale.x,this.position.y=(this.game.camera.view.y+this.cameraOffset.y)/this.game.camera.scale.y),this._scrollX=this.game.camera.view.x*this.scrollFactorX/this.scale.x,this._scrollY=this.game.camera.view.y*this.scrollFactorY/this.scale.y,this.render(),PIXI.Sprite.prototype._renderWebGL.call(this,t)},U.TilemapLayer.prototype.destroy=function(){PIXI.CanvasPool.remove(this),U.Component.Destroy.prototype.destroy.call(this)},U.TilemapLayer.prototype.resize=function(t,e){this.canvas.width=t,this.canvas.height=e,this.texture.frame.resize(t,e),this.texture.width=t,this.texture.height=e,this.texture.crop.width=t,this.texture.crop.height=e,this.texture.baseTexture.width=t,this.texture.baseTexture.height=e,this.texture.baseTexture.dirty(),this.texture.requiresUpdate=!0,this.texture._updateUvs(),this.dirty=!0},U.TilemapLayer.prototype.resizeWorld=function(){this.game.world.setBounds(0,0,this.layer.widthInPixels*this.scale.x,this.layer.heightInPixels*this.scale.y)},U.TilemapLayer.prototype._fixX=function(t){return 1===this.scrollFactorX||0===this.scrollFactorX&&0===this.position.x?t:0===this.scrollFactorX&&0!==this.position.x?t-this.position.x:this._scrollX+(t-this._scrollX/this.scrollFactorX)},U.TilemapLayer.prototype._unfixX=function(t){return 1===this.scrollFactorX?t:this._scrollX/this.scrollFactorX+(t-this._scrollX)},U.TilemapLayer.prototype._fixY=function(t){return 1===this.scrollFactorY||0===this.scrollFactorY&&0===this.position.y?t:0===this.scrollFactorY&&0!==this.position.y?t-this.position.y:this._scrollY+(t-this._scrollY/this.scrollFactorY)},U.TilemapLayer.prototype._unfixY=function(t){return 1===this.scrollFactorY?t:this._scrollY/this.scrollFactorY+(t-this._scrollY)},U.TilemapLayer.prototype.getTileX=function(t){return Math.floor(this._fixX(t)/this._mc.tileWidth)},U.TilemapLayer.prototype.getTileY=function(t){return Math.floor(this._fixY(t)/this._mc.tileHeight)},U.TilemapLayer.prototype.getTileXY=function(t,e,i){return i.x=this.getTileX(t),i.y=this.getTileY(e),i},U.TilemapLayer.prototype.getRayCastTiles=function(t,e,i,n){e=e||this.rayStepRate;var r=this.getTiles(t.x,t.y,t.width,t.height,i=void 0===i?!1:i,n=void 0===n?!1:n);if(0===r.length)return[];for(var o=t.coordinatesOnLine(e),s=[],a=0;a<r.length;a++)for(var h=0;h<o.length;h++){var l=r[a],p=o[h];if(l.containsPoint(p[0],p[1])){s.push(l);break}}return s},U.TilemapLayer.prototype.getTiles=function(t,e,i,n,r,o){void 0===o&&(o=!1);var s=!((r=void 0===r?!1:r)||o);t=this._fixX(t),e=this._fixY(e);for(var a=Math.floor(t/(this._mc.cw*this.scale.x)),h=Math.floor(e/(this._mc.ch*this.scale.y)),l=Math.ceil((t+i)/(this._mc.cw*this.scale.x))-a,p=Math.ceil((e+n)/(this._mc.ch*this.scale.y))-h;this._results.length;)this._results.pop();for(var u=h;u<h+p;u++)for(var d=a;d<a+l;d++){var c=this.layer.data[u];c&&c[d]&&(s||c[d].isInteresting(r,o))&&this._results.push(c[d])}return this._results.slice()},U.TilemapLayer.prototype.resolveTileset=function(t){var e=this._mc.tilesets;if(t<2e3)for(;e.length<t;)e.push(void 0);var i=this.map.tiles[t]&&this.map.tiles[t][2];if(null!==i){i=this.map.tilesets[i];if(i&&i.containsTileIndex(t))return e[t]=i}return e[t]=null},U.TilemapLayer.prototype.resetTilesetCache=function(){for(var t=this._mc.tilesets;t.length;)t.pop()},U.TilemapLayer.prototype.setScale=function(t,e){t=t||1,e=e||t;for(var i=0;i<this.layer.data.length;i++)for(var n=this.layer.data[i],r=0;r<n.length;r++){var o=n[r];o.width=this.map.tileWidth*t,o.height=this.map.tileHeight*e,o.worldX=o.x*o.width,o.worldY=o.y*o.height}this.scale.setTo(t,e)},U.TilemapLayer.prototype.shiftCanvas=function(t,e,i){var n=t.canvas,r=n.width-Math.abs(e),o=n.height-Math.abs(i),s=0,a=0,h=e,l=i;e<0&&(s=-e,h=0),i<0&&(a=-i,l=0);e=this.renderSettings.copyCanvas;e?((e.width<r||e.height<o)&&(e.width=r,e.height=o),(i=e.getContext("2d")).clearRect(0,0,r,o),i.drawImage(n,s,a,r,o,0,0,r,o),t.clearRect(h,l,r,o),t.drawImage(e,0,0,r,o,h,l,r,o)):(t.save(),t.globalCompositeOperation="copy",t.drawImage(n,s,a,r,o,h,l,r,o),t.restore())},U.TilemapLayer.prototype.renderRegion=function(t,e,i,n,r,o){var s=this.context,a=this.layer.width,h=this.layer.height,l=this._mc.tileWidth,p=this._mc.tileHeight,u=this._mc.tilesets,d=NaN;this._wrap||(i<=r&&(i=Math.max(0,i),r=Math.min(a-1,r)),n<=o&&(n=Math.max(0,n),o=Math.min(h-1,o)));for(var c=i*l-t,y=(i+(1<<20)*a)%a,_=(n+(1<<20)*h)%h,m=o-n,g=n*p-e;0<=m;_++,m--,g+=p){h<=_&&(_-=h);for(var f=this.layer.data[_],x=y,v=r-i,w=c;0<=v;x++,v--,w+=l){a<=x&&(x-=a);var z,b,S=f[x];!S||S.index<0||(void 0===(b=u[z=S.index])&&(b=this.resolveTileset(z)),S.alpha===d||this.debug||(s.globalAlpha=S.alpha,d=S.alpha),b?S.rotation||S.flipped?(s.save(),s.translate(w+S.centerX,g+S.centerY),s.rotate(S.rotation),S.flipped&&s.scale(-1,1),b.draw(s,-S.centerX,-S.centerY,z),s.restore()):b.draw(s,w,g,z):this.debugSettings.missingImageFill&&(s.fillStyle=this.debugSettings.missingImageFill,s.fillRect(w,g,l,p)),S.debug&&this.debugSettings.debuggedTileOverfill&&(s.fillStyle=this.debugSettings.debuggedTileOverfill,s.fillRect(w,g,l,p)))}}},U.TilemapLayer.prototype.renderDeltaScroll=function(t,e){var i=this._mc.scrollX,n=this._mc.scrollY,r=this.canvas.width,o=this.canvas.height,s=this._mc.tileWidth,a=this._mc.tileHeight,h=0,l=-s,p=0,u=-a;t<0?(h=r+t,l=r-1):0<t&&(l=t),e<0?(p=o+e,u=o-1):0<e&&(u=e),this.shiftCanvas(this.context,t,e),h=Math.floor((h+i)/s),l=Math.floor((l+i)/s),p=Math.floor((p+n)/a),u=Math.floor((u+n)/a),h<=l&&(this.context.clearRect(h*s-i,0,(l-h+1)*s,o),e=Math.floor((0+n)/a),o=Math.floor((o-1+n)/a),this.renderRegion(i,n,h,e,l,o)),p<=u&&(this.context.clearRect(0,p*a-n,r,(u-p+1)*a),a=Math.floor((0+i)/s),s=Math.floor((r-1+i)/s),this.renderRegion(i,n,a,p,s,u))},U.TilemapLayer.prototype.renderFull=function(){var t=this._mc.scrollX,e=this._mc.scrollY,i=this.canvas.width,n=this.canvas.height,r=this._mc.tileWidth,o=this._mc.tileHeight,s=Math.floor(t/r),a=Math.floor((i-1+t)/r),r=Math.floor(e/o),o=Math.floor((n-1+e)/o);this.context.clearRect(0,0,i,n),this.renderRegion(t,e,s,r,a,o)},U.TilemapLayer.prototype.render=function(){var t=!1;if(this.visible){(this.dirty||this.layer.dirty)&&(t=!(this.layer.dirty=!1));var e=this.canvas.width,i=this.canvas.height,n=0|this._scrollX,r=0|this._scrollY,o=this._mc,s=o.scrollX-n,a=o.scrollY-r;if(t||0!=s||0!=a||o.renderWidth!==e||o.renderHeight!==i)return this.context.save(),o.scrollX=n,o.scrollY=r,o.renderWidth===e&&o.renderHeight===i||(o.renderWidth=e,o.renderHeight=i),this.debug&&(this.context.globalAlpha=this.debugSettings.debugAlpha,this.debugSettings.forceFullRedraw&&(t=!0)),!t&&this.renderSettings.enableScrollDelta&&Math.abs(s)+Math.abs(a)<Math.min(e,i)?this.renderDeltaScroll(s,a):this.renderFull(),this.debug&&(this.context.globalAlpha=1,this.renderDebug()),this.texture.baseTexture.dirty(),this.dirty=!1,this.context.restore(),!0}},U.TilemapLayer.prototype.renderDebug=function(){var t,e,i,n=this._mc.scrollX,r=this._mc.scrollY,o=this.context,s=this.canvas.width,a=this.canvas.height,h=this.layer.width,l=this.layer.height,p=this._mc.tileWidth,u=this._mc.tileHeight,d=Math.floor(n/p),c=Math.floor((s-1+n)/p),s=Math.floor(r/u),a=Math.floor((a-1+r)/u),y=d*p-n,n=s*u-r,_=(d+(1<<20)*h)%h,r=(s+(1<<20)*l)%l;for(o.strokeStyle=this.debugSettings.facingEdgeStroke,e=r,i=a-s,t=n;0<=i;e++,i--,t+=u){l<=e&&(e-=l);for(var m=this.layer.data[e],g=_,f=c-d,x=y;0<=f;g++,f--,x+=p){h<=g&&(g-=h);var v=m[g];!v||v.index<0||!v.collides||(this.debugSettings.collidingTileOverfill&&(o.fillStyle=this.debugSettings.collidingTileOverfill,o.fillRect(x,t,this._mc.cw,this._mc.ch)),this.debugSettings.facingEdgeStroke&&(o.beginPath(),v.faceTop&&(o.moveTo(x,t),o.lineTo(x+this._mc.cw,t)),v.faceBottom&&(o.moveTo(x,t+this._mc.ch),o.lineTo(x+this._mc.cw,t+this._mc.ch)),v.faceLeft&&(o.moveTo(x,t),o.lineTo(x,t+this._mc.ch)),v.faceRight&&(o.moveTo(x+this._mc.cw,t),o.lineTo(x+this._mc.cw,t+this._mc.ch)),o.closePath(),o.stroke()))}}},Object.defineProperty(U.TilemapLayer.prototype,"wrap",{get:function(){return this._wrap},set:function(t){this._wrap=t,this.dirty=!0}}),Object.defineProperty(U.TilemapLayer.prototype,"scrollX",{get:function(){return this._scrollX},set:function(t){this._scrollX=t}}),Object.defineProperty(U.TilemapLayer.prototype,"scrollY",{get:function(){return this._scrollY},set:function(t){this._scrollY=t}}),Object.defineProperty(U.TilemapLayer.prototype,"collisionWidth",{get:function(){return this._mc.cw},set:function(t){this._mc.cw=0|t,this.dirty=!0}}),Object.defineProperty(U.TilemapLayer.prototype,"collisionHeight",{get:function(){return this._mc.ch},set:function(t){this._mc.ch=0|t,this.dirty=!0}}),U.TilemapParser={INSERT_NULL:!1,parse:function(t,e,i,n,r,o){if(void 0===i&&(i=32),void 0===n&&(n=32),void 0===r&&(r=10),void 0===o&&(o=10),void 0===e)return this.getEmptyData();if(null===e)return this.getEmptyData(i,n,r,o);t=t.cache.getTilemapData(e);return t?t.format===U.Tilemap.CSV?this.parseCSV(e,t.data,i,n):t.format&&t.format!==U.Tilemap.TILED_JSON?void 0:this.parseTiledJSON(t.data):void 0},parseCSV:function(t,e,i,n){for(var r=this.getEmptyData(),o=[],s=(e=e.trim()).split("\n"),e=s.length,a=0,h=0;h<s.length;h++){o[h]=[];for(var l=s[h].split(","),p=0;p<l.length;p++)o[h][p]=new U.Tile(r.layers[0],parseInt(l[p],10),p,h,i,n);0===a&&(a=l.length)}return r.format=U.Tilemap.CSV,r.name=t,r.width=a,r.height=e,r.tileWidth=i,r.tileHeight=n,r.widthInPixels=a*i,r.heightInPixels=e*n,r.layers[0].width=a,r.layers[0].height=e,r.layers[0].widthInPixels=r.widthInPixels,r.layers[0].heightInPixels=r.heightInPixels,r.layers[0].data=o,r},getEmptyData:function(t,e,i,n){return{width:null!=i?i:0,height:null!=n?n:0,tileWidth:null!=t?t:0,tileHeight:null!=e?e:0,orientation:"orthogonal",version:"1",properties:{},widthInPixels:0,heightInPixels:0,layers:[{name:"layer",x:0,y:0,width:0,height:0,widthInPixels:0,heightInPixels:0,alpha:1,visible:!0,properties:{},indexes:[],callbacks:[],bodies:[],data:[]}],images:[],objects:{},collision:{},tilesets:[],tiles:[]}},parseTiledJSON:function(t){function e(t,e){var i,n={};for(i in e){var r=e[i];void 0!==t[r]&&(n[r]=t[r])}return n}if("orthogonal"!==t.orientation)return null;for(var i={width:t.width,height:t.height,tileWidth:t.tilewidth,tileHeight:t.tileheight,orientation:t.orientation,format:U.Tilemap.TILED_JSON,version:t.version,properties:t.properties,widthInPixels:t.width*t.tilewidth,heightInPixels:t.height*t.tileheight},n=[],r=0;r<t.layers.length;r++)if("tilelayer"===t.layers[r].type){var o=t.layers[r];if(!o.compression&&o.encoding&&"base64"===o.encoding){for(var s=window.atob(o.data),a=s.length,h=new Array(a),l=0;l<a;l+=4)h[l/4]=(s.charCodeAt(l)|s.charCodeAt(l+1)<<8|s.charCodeAt(l+2)<<16|s.charCodeAt(l+3)<<24)>>>0;o.data=h,delete o.encoding}else if(o.compression)continue;var p={name:o.name,x:o.x,y:o.y,width:o.width,height:o.height,widthInPixels:o.width*t.tilewidth,heightInPixels:o.height*t.tileheight,alpha:o.opacity,visible:o.visible,properties:{},indexes:[],callbacks:[],bodies:[]};o.properties&&(p.properties=o.properties);for(var u,d,c,y=0,_=[],m=[],g=0,a=o.data.length;g<a;g++){if(d=!1,c=u=0,536870912<(M=o.data[g]))switch(2147483648<M&&(M-=2147483648,c+=4),1073741824<M&&(M-=1073741824,c+=2),536870912<M&&(M-=536870912,c+=1),c){case 5:u=Math.PI/2;break;case 6:u=Math.PI;break;case 3:u=3*Math.PI/2;break;case 4:d=!(u=0);break;case 7:u=Math.PI/2,d=!0;break;case 2:u=Math.PI,d=!0;break;case 1:u=3*Math.PI/2,d=!0}0<M?((R=new U.Tile(p,M,y,m.length,t.tilewidth,t.tileheight)).rotation=u,R.flipped=d,0!==c&&(R.flippedVal=c),_.push(R)):U.TilemapParser.INSERT_NULL?_.push(null):_.push(new U.Tile(p,-1,y,m.length,t.tilewidth,t.tileheight)),++y===o.width&&(m.push(_),y=0,_=[])}p.data=m,n.push(p)}i.layers=n;for(var f,x=[],r=0;r<t.layers.length;r++)"imagelayer"===t.layers[r].type&&(P={name:(f=t.layers[r]).name,image:f.image,x:f.x,y:f.y,alpha:f.opacity,visible:f.visible,properties:{}},f.properties&&(P.properties=f.properties),x.push(P));i.images=x;for(var v=[],w=[],z=null,r=0;r<t.tilesets.length;r++){if((N=t.tilesets[r]).image){var b=new U.Tileset(N.name,N.firstgid,N.tilewidth,N.tileheight,N.margin,N.spacing,N.properties);N.tileproperties&&(b.tileProperties=N.tileproperties),b.updateTileData(N.imagewidth,N.imageheight),v.push(b)}else{var S,C=new U.ImageCollection(N.name,N.firstgid,N.tilewidth,N.tileheight,N.margin,N.spacing,N.properties);for(S in N.tiles){var P=N.tiles[S].image,M=N.firstgid+parseInt(S,10);C.addImage(M,P)}w.push(C)}z&&(z.lastgid=N.firstgid-1),z=N}i.tilesets=v,i.imagecollections=w;for(var T={},A={},r=0;r<t.layers.length;r++)if("objectgroup"===t.layers[r].type){var k=t.layers[r];T[k.name]=[],A[k.name]=[];for(var O=0,a=k.objects.length;O<a;O++)if(k.objects[O].gid){var E={gid:k.objects[O].gid,name:k.objects[O].name,type:k.objects[O].hasOwnProperty("type")?k.objects[O].type:"",x:k.objects[O].x,y:k.objects[O].y,visible:k.objects[O].visible,properties:k.objects[O].properties};k.objects[O].rotation&&(E.rotation=k.objects[O].rotation),T[k.name].push(E)}else if(k.objects[O].polyline){var E={name:k.objects[O].name,type:k.objects[O].type,x:k.objects[O].x,y:k.objects[O].y,width:k.objects[O].width,height:k.objects[O].height,visible:k.objects[O].visible,properties:k.objects[O].properties};k.objects[O].rotation&&(E.rotation=k.objects[O].rotation),E.polyline=[];for(var I=0;I<k.objects[O].polyline.length;I++)E.polyline.push([k.objects[O].polyline[I].x,k.objects[O].polyline[I].y]);A[k.name].push(E),T[k.name].push(E)}else if(k.objects[O].polygon){(E=e(k.objects[O],["name","type","x","y","visible","rotation","properties"])).polygon=[];for(I=0;I<k.objects[O].polygon.length;I++)E.polygon.push([k.objects[O].polygon[I].x,k.objects[O].polygon[I].y]);T[k.name].push(E)}else k.objects[O].ellipse?E=e(k.objects[O],["name","type","ellipse","x","y","width","height","visible","rotation","properties"]):(E=e(k.objects[O],["name","type","x","y","width","height","visible","rotation","properties"])).rectangle=!0,T[k.name].push(E)}i.objects=T,i.collision=A,i.tiles=[];for(r=0;r<i.tilesets.length;r++)for(var y=(N=i.tilesets[r]).tileMargin,G=N.tileMargin,D=0,L=0,B=0,g=N.firstgid;g<N.firstgid+N.total&&(i.tiles[g]=[y,G,r],y+=N.tileWidth+N.tileSpacing,++D!==N.total)&&(++L!==N.columns||(y=N.tileMargin,G+=N.tileHeight+N.tileSpacing,L=0,++B!==N.rows));g++);for(var R,F,N,r=0;r<i.layers.length;r++){p=i.layers[r],N=null;for(l=0;l<p.data.length;l++)for(var _=p.data[l],j=0;j<_.length;j++)null===(R=_[j])||R.index<0||(F=i.tiles[R.index][2],(N=i.tilesets[F]).tileProperties&&N.tileProperties[R.index-N.firstgid]&&(R.properties=U.Utils.mixin(N.tileProperties[R.index-N.firstgid],R.properties)))}return i}},U.Tileset=function(t,e,i,n,r,o,s){(void 0===i||i<=0)&&(i=32),(void 0===n||n<=0)&&(n=32),void 0===r&&(r=0),void 0===o&&(o=0),this.name=t,this.firstgid=0|e,this.tileWidth=0|i,this.tileHeight=0|n,this.tileMargin=0|r,this.tileSpacing=0|o,this.properties=s||{},this.image=null,this.rows=0,this.columns=0,this.total=0,this.drawCoords=[]},U.Tileset.prototype={draw:function(t,e,i,n){n=n-this.firstgid<<1;0<=n&&1+n<this.drawCoords.length&&t.drawImage(this.image,this.drawCoords[n],this.drawCoords[1+n],this.tileWidth,this.tileHeight,e,i,this.tileWidth,this.tileHeight)},containsTileIndex:function(t){return t>=this.firstgid&&t<this.firstgid+this.total},setImage:function(t){this.image=t,this.updateTileData(t.width,t.height)},setSpacing:function(t,e){this.tileMargin=0|t,this.tileSpacing=0|e,this.image&&this.updateTileData(this.image.width,this.image.height)},updateTileData:function(t,e){e=(e-2*this.tileMargin+this.tileSpacing)/(this.tileHeight+this.tileSpacing),t=(t-2*this.tileMargin+this.tileSpacing)/(this.tileWidth+this.tileSpacing),e=Math.floor(e),t=Math.floor(t);this.rows&&this.rows!==e||this.columns&&this.columns,this.rows=e,this.columns=t,this.total=e*t,this.drawCoords.length=0;for(var i=this.tileMargin,n=this.tileMargin,r=0;r<this.rows;r++){for(var o=0;o<this.columns;o++)this.drawCoords.push(i),this.drawCoords.push(n),i+=this.tileWidth+this.tileSpacing;i=this.tileMargin,n+=this.tileHeight+this.tileSpacing}}},U.Tileset.prototype.constructor=U.Tileset,U.Particle=function(t,e,i,n,r){U.Sprite.call(this,t,e,i,n,r),this.autoScale=!1,this.scaleData=null,this._s=0,this.autoAlpha=!1,this.alphaData=null,this._a=0},U.Particle.prototype=Object.create(U.Sprite.prototype),U.Particle.prototype.constructor=U.Particle,U.Particle.prototype.update=function(){this.autoScale&&(this._s--,this._s?this.scale.set(this.scaleData[this._s].x,this.scaleData[this._s].y):this.autoScale=!1),this.autoAlpha&&(this._a--,this._a?this.alpha=this.alphaData[this._a].v:this.autoAlpha=!1)},U.Particle.prototype.onEmit=function(){},U.Particle.prototype.setAlphaData=function(t){this.alphaData=t,this._a=t.length-1,this.alpha=this.alphaData[this._a].v,this.autoAlpha=!0},U.Particle.prototype.setScaleData=function(t){this.scaleData=t,this._s=t.length-1,this.scale.set(this.scaleData[this._s].x,this.scaleData[this._s].y),this.autoScale=!0},U.Particle.prototype.reset=function(t,e,i){return U.Component.Reset.prototype.reset.call(this,t,e,i),this.alpha=1,this.scale.set(1),this.autoScale=!1,this.autoAlpha=!1,this},U.Particles=function(t){this.game=t,this.emitters={},this.ID=0},U.Particles.prototype={add:function(t){return this.emitters[t.name]=t},remove:function(t){delete this.emitters[t.name]},update:function(){for(var t in this.emitters)this.emitters[t].exists&&this.emitters[t].update()}},U.Particles.prototype.constructor=U.Particles,U.Particles.Arcade={},U.Particles.Arcade.Emitter=function(t,e,i,n){this.maxParticles=n||50,U.Group.call(this,t),this.name="emitter"+this.game.particles.ID++,this.type=U.EMITTER,this.physicsType=U.GROUP,this.area=new U.Rectangle(e,i,1,1),this.minParticleSpeed=new U.Point(-100,-100),this.maxParticleSpeed=new U.Point(100,100),this.minParticleScale=1,this.maxParticleScale=1,this.scaleData=null,this.minRotation=-360,this.maxRotation=360,this.minParticleAlpha=1,this.maxParticleAlpha=1,this.alphaData=null,this.gravity=100,this.particleClass=U.Particle,this.particleDrag=new U.Point,this.angularDrag=0,this.frequency=100,this.lifespan=2e3,this.bounce=new U.Point,this.on=!1,this.particleAnchor=new U.Point(.5,.5),this.blendMode=U.blendModes.NORMAL,this.emitX=e,this.emitY=i,this.autoScale=!1,this.autoAlpha=!1,this.particleBringToTop=!1,this.particleSendToBack=!1,this._minParticleScale=new U.Point(1,1),this._maxParticleScale=new U.Point(1,1),this._quantity=0,this._timer=0,this._counter=0,this._flowQuantity=0,this._flowTotal=0,this._explode=!0,this._frames=null},U.Particles.Arcade.Emitter.prototype=Object.create(U.Group.prototype),U.Particles.Arcade.Emitter.prototype.constructor=U.Particles.Arcade.Emitter,U.Particles.Arcade.Emitter.prototype.update=function(){if(this.on&&this.game.time.time>=this._timer)if(this._timer=this.game.time.time+this.frequency*this.game.time.slowMotion,0!==this._flowTotal)if(0<this._flowQuantity){for(var t=0;t<this._flowQuantity;t++)if(this.emitParticle()&&(this._counter++,-1!==this._flowTotal&&this._counter>=this._flowTotal)){this.on=!1;break}}else this.emitParticle()&&(this._counter++,-1!==this._flowTotal&&this._counter>=this._flowTotal&&(this.on=!1));else this.emitParticle()&&(this._counter++,0<this._quantity&&this._counter>=this._quantity&&(this.on=!1));for(t=this.children.length;t--;)this.children[t].exists&&this.children[t].update()},U.Particles.Arcade.Emitter.prototype.makeParticles=function(t,e,i,n,r){void 0===i&&(i=this.maxParticles),void 0===n&&(n=!1),void 0===r&&(r=!1);var o,s=0,a=t,h=e=void 0===e?0:e;for(this._frames=e,i>this.maxParticles&&(this.maxParticles=i);s<i;)Array.isArray(t)&&(a=this.game.rnd.pick(t)),Array.isArray(e)&&(h=this.game.rnd.pick(e)),o=new this.particleClass(this.game,0,0,a,h),this.game.physics.arcade.enable(o,!1),n?(o.body.checkCollision.any=!0,o.body.checkCollision.none=!1):o.body.checkCollision.none=!0,o.body.collideWorldBounds=r,o.body.skipQuadTree=!0,o.exists=!1,o.visible=!1,o.anchor.copyFrom(this.particleAnchor),this.add(o),s++;return this},U.Particles.Arcade.Emitter.prototype.kill=function(){return this.on=!1,this.alive=!1,this.exists=!1,this},U.Particles.Arcade.Emitter.prototype.revive=function(){return this.alive=!0,this.exists=!0,this},U.Particles.Arcade.Emitter.prototype.explode=function(t,e){return this._flowTotal=0,this.start(!0,t,0,e,!1),this},U.Particles.Arcade.Emitter.prototype.flow=function(t,e,i,n,r){return void 0===n&&(n=-1),void 0===r&&(r=!0),(i=void 0===i||0===i?1:i)>this.maxParticles&&(i=this.maxParticles),this._counter=0,this._flowQuantity=i,this._flowTotal=n,r?(this.start(!0,t,e,i),this._counter+=i,this.on=!0,this._timer=this.game.time.time+e*this.game.time.slowMotion):this.start(!1,t,e,i),this},U.Particles.Arcade.Emitter.prototype.start=function(t,e,i,n,r){if(void 0===t&&(t=!0),void 0===e&&(e=0),null!=i||(i=250),void 0===r&&(r=!1),(n=void 0===n?0:n)>this.maxParticles&&(n=this.maxParticles),this.revive(),this.visible=!0,this.lifespan=e,this.frequency=i,t||r)for(var o=0;o<n;o++)this.emitParticle();else this.on=!0,this._quantity=n,this._counter=0,this._timer=this.game.time.time+i*this.game.time.slowMotion;return this},U.Particles.Arcade.Emitter.prototype.emitParticle=function(t,e,i,n){void 0===t&&(t=null),void 0===e&&(e=null);var r=this.getFirstExists(!1);if(null===r)return!1;var o=this.game.rnd;void 0!==i&&void 0!==n?r.loadTexture(i,n):void 0!==i&&r.loadTexture(i);var s=this.emitX,i=this.emitY;null!==t?s=t:1<this.width&&(s=o.between(this.left,this.right)),null!==e?i=e:1<this.height&&(i=o.between(this.top,this.bottom)),r.reset(s,i),r.angle=0,r.lifespan=this.lifespan,this.particleBringToTop?this.bringToTop(r):this.particleSendToBack&&this.sendToBack(r),this.autoScale?r.setScaleData(this.scaleData):1!==this.minParticleScale||1!==this.maxParticleScale?r.scale.set(o.realInRange(this.minParticleScale,this.maxParticleScale)):this._minParticleScale.x===this._maxParticleScale.x&&this._minParticleScale.y===this._maxParticleScale.y||r.scale.set(o.realInRange(this._minParticleScale.x,this._maxParticleScale.x),o.realInRange(this._minParticleScale.y,this._maxParticleScale.y)),void 0===n&&(Array.isArray(this._frames)?r.frame=this.game.rnd.pick(this._frames):r.frame=this._frames),this.autoAlpha?r.setAlphaData(this.alphaData):r.alpha=o.realInRange(this.minParticleAlpha,this.maxParticleAlpha),r.blendMode=this.blendMode;n=r.body;return n.updateBounds(),n.bounce.copyFrom(this.bounce),n.drag.copyFrom(this.particleDrag),n.velocity.x=o.between(this.minParticleSpeed.x,this.maxParticleSpeed.x),n.velocity.y=o.between(this.minParticleSpeed.y,this.maxParticleSpeed.y),n.angularVelocity=o.between(this.minRotation,this.maxRotation),n.gravity.y=this.gravity,n.angularDrag=this.angularDrag,r.onEmit(),!0},U.Particles.Arcade.Emitter.prototype.destroy=function(){this.game.particles.remove(this),U.Group.prototype.destroy.call(this,!0,!1)},U.Particles.Arcade.Emitter.prototype.setSize=function(t,e){return this.area.width=t,this.area.height=e,this},U.Particles.Arcade.Emitter.prototype.setXSpeed=function(t,e){return e=e||0,this.minParticleSpeed.x=t=t||0,this.maxParticleSpeed.x=e,this},U.Particles.Arcade.Emitter.prototype.setYSpeed=function(t,e){return e=e||0,this.minParticleSpeed.y=t=t||0,this.maxParticleSpeed.y=e,this},U.Particles.Arcade.Emitter.prototype.setRotation=function(t,e){return e=e||0,this.minRotation=t=t||0,this.maxRotation=e,this},U.Particles.Arcade.Emitter.prototype.setAlpha=function(t,e,i,n,r){return void 0===e&&(e=1),void 0===i&&(i=0),void 0===n&&(n=U.Easing.Linear.None),void 0===r&&(r=!1),this.minParticleAlpha=t=void 0===t?1:t,this.maxParticleAlpha=e,this.autoAlpha=!1,0<i&&t!==e&&((n=this.game.make.tween({v:t}).to({v:e},i,n)).yoyo(r),this.alphaData=n.generateData(60),this.alphaData.reverse(),this.autoAlpha=!0),this},U.Particles.Arcade.Emitter.prototype.setScale=function(t,e,i,n,r,o,s){return void 0===t&&(t=1),void 0===e&&(e=1),void 0===i&&(i=1),void 0===n&&(n=1),void 0===r&&(r=0),void 0===o&&(o=U.Easing.Linear.None),void 0===s&&(s=!1),this.minParticleScale=1,this.maxParticleScale=1,this._minParticleScale.set(t,i),this._maxParticleScale.set(e,n),this.autoScale=!1,0<r&&(t!==e||i!==n)&&((o=this.game.make.tween({x:t,y:i}).to({x:e,y:n},r,o)).yoyo(s),this.scaleData=o.generateData(60),this.scaleData.reverse(),this.autoScale=!0),this},U.Particles.Arcade.Emitter.prototype.at=function(t){return t.center?(this.emitX=t.center.x,this.emitY=t.center.y):(this.emitX=t.world.x+t.anchor.x*t.width,this.emitY=t.world.y+t.anchor.y*t.height),this},Object.defineProperty(U.Particles.Arcade.Emitter.prototype,"width",{get:function(){return this.area.width},set:function(t){this.area.width=t}}),Object.defineProperty(U.Particles.Arcade.Emitter.prototype,"height",{get:function(){return this.area.height},set:function(t){this.area.height=t}}),Object.defineProperty(U.Particles.Arcade.Emitter.prototype,"x",{get:function(){return this.emitX},set:function(t){this.emitX=t}}),Object.defineProperty(U.Particles.Arcade.Emitter.prototype,"y",{get:function(){return this.emitY},set:function(t){this.emitY=t}}),Object.defineProperty(U.Particles.Arcade.Emitter.prototype,"left",{get:function(){return Math.floor(this.x-this.area.width/2)}}),Object.defineProperty(U.Particles.Arcade.Emitter.prototype,"right",{get:function(){return Math.floor(this.x+this.area.width/2)}}),Object.defineProperty(U.Particles.Arcade.Emitter.prototype,"top",{get:function(){return Math.floor(this.y-this.area.height/2)}}),Object.defineProperty(U.Particles.Arcade.Emitter.prototype,"bottom",{get:function(){return Math.floor(this.y+this.area.height/2)}}),U.Weapon=function(t,e){U.Plugin.call(this,t,e),this.bullets=null,this.autoExpandBulletsGroup=!1,this.autofire=!1,this.shots=0,this.fireLimit=0,this.fireRate=100,this.fireRateVariance=0,this.fireFrom=new U.Rectangle(0,0,1,1),this.fireAngle=U.ANGLE_UP,this.bulletInheritSpriteSpeed=!1,this.bulletAnimation="",this.bulletFrameRandom=!1,this.bulletFrameCycle=!1,this.bulletWorldWrap=!1,this.bulletWorldWrapPadding=0,this.bulletAngleOffset=0,this.bulletAngleVariance=0,this.bulletSpeed=200,this.bulletSpeedVariance=0,this.bulletLifespan=0,this.bulletKillDistance=0,this.bulletGravity=new U.Point(0,0),this.bulletRotateToVelocity=!1,this.bulletKey="",this.bulletFrame="",this._bulletClass=U.Bullet,this._bulletCollideWorldBounds=!1,this._bulletKillType=U.Weapon.KILL_WORLD_BOUNDS,this._data={customBody:!1,width:0,height:0,offsetX:0,offsetY:0},this.bounds=new U.Rectangle,this.bulletBounds=t.world.bounds,this.bulletFrames=[],this.bulletFrameIndex=0,this.anims={},this.onFire=new U.Signal,this.onKill=new U.Signal,this.onFireLimit=new U.Signal,this.trackedSprite=null,this.trackedPointer=null,this.trackRotation=!1,this.trackOffset=new U.Point,this._nextFire=0,this._rotatedPoint=new U.Point},U.Weapon.prototype=Object.create(U.Plugin.prototype),U.Weapon.prototype.constructor=U.Weapon,U.Weapon.KILL_NEVER=0,U.Weapon.KILL_LIFESPAN=1,U.Weapon.KILL_DISTANCE=2,U.Weapon.KILL_WEAPON_BOUNDS=3,U.Weapon.KILL_CAMERA_BOUNDS=4,U.Weapon.KILL_WORLD_BOUNDS=5,U.Weapon.KILL_STATIC_BOUNDS=6,U.Weapon.prototype.createBullets=function(t,e,i,n){return void 0===t&&(t=1),void 0===n&&(n=this.game.world),this.bullets||(this.bullets=this.game.add.physicsGroup(U.Physics.ARCADE,n),this.bullets.classType=this._bulletClass),0!==t&&(-1===t&&(this.autoExpandBulletsGroup=!0,t=1),this.bullets.createMultiple(t,e,i),this.bullets.setAll("data.bulletManager",this),this.bulletKey=e,this.bulletFrame=i),this},U.Weapon.prototype.forEach=function(t,e){return this.bullets.forEachExists(t,e,arguments),this},U.Weapon.prototype.pauseAll=function(){return this.bullets.setAll("body.enable",!1),this},U.Weapon.prototype.resumeAll=function(){return this.bullets.setAll("body.enable",!0),this},U.Weapon.prototype.killAll=function(){return this.bullets.callAllExists("kill",!0),this.bullets.setAll("body.enable",!0),this},U.Weapon.prototype.resetShots=function(t){return void(this.shots=0)!==t&&(this.fireLimit=t),this},U.Weapon.prototype.destroy=function(){this.parent.remove(this,!1),this.bullets.destroy(),this.game=null,this.parent=null,this.active=!1,this.visible=!1},U.Weapon.prototype.update=function(){this._bulletKillType===U.Weapon.KILL_WEAPON_BOUNDS&&(this.trackedSprite?(this.trackedSprite.updateTransform(),this.bounds.centerOn(this.trackedSprite.worldPosition.x,this.trackedSprite.worldPosition.y)):this.trackedPointer&&this.bounds.centerOn(this.trackedPointer.worldX,this.trackedPointer.worldY)),this.autofire&&this.fire()},U.Weapon.prototype.trackSprite=function(t,e,i,n){return void 0===e&&(e=0),void 0===i&&(i=0),void 0===n&&(n=!1),this.trackedPointer=null,this.trackedSprite=t,this.trackRotation=n,this.trackOffset.set(e,i),this},U.Weapon.prototype.trackPointer=function(t,e,i){return void 0===t&&(t=this.game.input.activePointer),void 0===e&&(e=0),void 0===i&&(i=0),this.trackedPointer=t,this.trackedSprite=null,this.trackRotation=!1,this.trackOffset.set(e,i),this},U.Weapon.prototype.fire=function(t,e,i){if(this.game.time.now<this._nextFire||0<this.fireLimit&&this.shots===this.fireLimit)return!1;var n=this.bulletSpeed;0!==this.bulletSpeedVariance&&(n+=U.Math.between(-this.bulletSpeedVariance,this.bulletSpeedVariance)),t?1<this.fireFrom.width?this.fireFrom.centerOn(t.x,t.y):(this.fireFrom.x=t.x,this.fireFrom.y=t.y):this.trackedSprite?(this.trackRotation?(this._rotatedPoint.set(this.trackedSprite.world.x+this.trackOffset.x,this.trackedSprite.world.y+this.trackOffset.y),this._rotatedPoint.rotate(this.trackedSprite.world.x,this.trackedSprite.world.y,this.trackedSprite.rotation),1<this.fireFrom.width?this.fireFrom.centerOn(this._rotatedPoint.x,this._rotatedPoint.y):(this.fireFrom.x=this._rotatedPoint.x,this.fireFrom.y=this._rotatedPoint.y)):1<this.fireFrom.width?this.fireFrom.centerOn(this.trackedSprite.world.x+this.trackOffset.x,this.trackedSprite.world.y+this.trackOffset.y):(this.fireFrom.x=this.trackedSprite.world.x+this.trackOffset.x,this.fireFrom.y=this.trackedSprite.world.y+this.trackOffset.y),this.bulletInheritSpriteSpeed&&(n+=this.trackedSprite.body.speed)):this.trackedPointer&&(1<this.fireFrom.width?this.fireFrom.centerOn(this.trackedPointer.world.x+this.trackOffset.x,this.trackedPointer.world.y+this.trackOffset.y):(this.fireFrom.x=this.trackedPointer.world.x+this.trackOffset.x,this.fireFrom.y=this.trackedPointer.world.y+this.trackOffset.y));var r=1<this.fireFrom.width?this.fireFrom.randomX:this.fireFrom.x,o=1<this.fireFrom.height?this.fireFrom.randomY:this.fireFrom.y,s=this.trackRotation?this.trackedSprite.angle:this.fireAngle;void 0!==e&&void 0!==i&&(s=this.game.math.radToDeg(Math.atan2(i-o,e-r))),0!==this.bulletAngleVariance&&(s+=U.Math.between(-this.bulletAngleVariance,this.bulletAngleVariance));t=0,i=0;0===s||180===s?t=Math.cos(this.game.math.degToRad(s))*n:i=(90===s||270===s||(t=Math.cos(this.game.math.degToRad(s))*n),Math.sin(this.game.math.degToRad(s))*n);e=null;return this.autoExpandBulletsGroup?(e=this.bullets.getFirstExists(!1,!0,r,o,this.bulletKey,this.bulletFrame)).data.bulletManager=this:e=this.bullets.getFirstExists(!1),e&&(e.reset(r,o),e.data.fromX=r,e.data.fromY=o,e.data.killType=this.bulletKillType,e.data.killDistance=this.bulletKillDistance,e.data.rotateToVelocity=this.bulletRotateToVelocity,this.bulletKillType===U.Weapon.KILL_LIFESPAN&&(e.lifespan=this.bulletLifespan),e.angle=s+this.bulletAngleOffset,""!==this.bulletAnimation?(null===e.animations.getAnimation(this.bulletAnimation)&&(s=this.anims[this.bulletAnimation],e.animations.add(s.name,s.frames,s.frameRate,s.loop,s.useNumericIndex)),e.animations.play(this.bulletAnimation)):this.bulletFrameCycle?(e.frame=this.bulletFrames[this.bulletFrameIndex],++this.bulletFrameIndex>=this.bulletFrames.length&&(this.bulletFrameIndex=0)):this.bulletFrameRandom&&(e.frame=this.bulletFrames[Math.floor(Math.random()*this.bulletFrames.length)]),e.data.bodyDirty&&(this._data.customBody&&e.body.setSize(this._data.width,this._data.height,this._data.offsetX,this._data.offsetY),e.body.collideWorldBounds=this.bulletCollideWorldBounds,e.data.bodyDirty=!1),e.body.velocity.set(t,i),e.body.gravity.set(this.bulletGravity.x,this.bulletGravity.y),0!==this.bulletSpeedVariance?(i=this.fireRate,i+=U.Math.between(-this.fireRateVariance,this.fireRateVariance),this._nextFire=this.game.time.now+(i=i<0?0:i)):this._nextFire=this.game.time.now+this.fireRate,this.shots++,this.onFire.dispatch(e,this,n),0<this.fireLimit&&this.shots===this.fireLimit&&this.onFireLimit.dispatch(this,this.fireLimit)),e},U.Weapon.prototype.fireAtPointer=function(t){return void 0===t&&(t=this.game.input.activePointer),this.fire(null,t.worldX,t.worldY)},U.Weapon.prototype.fireAtSprite=function(t){return this.fire(null,t.world.x,t.world.y)},U.Weapon.prototype.fireAtXY=function(t,e){return this.fire(null,t,e)},U.Weapon.prototype.setBulletBodyOffset=function(t,e,i,n){return void 0===i&&(i=0),void 0===n&&(n=0),this._data.customBody=!0,this._data.width=t,this._data.height=e,this._data.offsetX=i,this._data.offsetY=n,this.bullets.callAll("body.setSize","body",t,e,i,n),this.bullets.setAll("data.bodyDirty",!1),this},U.Weapon.prototype.setBulletFrames=function(t,e,i,n){return void 0===i&&(i=!0),void 0===n&&(n=!1),this.bulletFrames=U.ArrayUtils.numberArray(t,e),this.bulletFrameIndex=0,this.bulletFrameCycle=i,this.bulletFrameRandom=n,this},U.Weapon.prototype.addBulletAnimation=function(t,e,i,n,r){return this.anims[t]={name:t,frames:e,frameRate:i,loop:n,useNumericIndex:r},this.bullets.callAll("animations.add","animations",t,e,i,n,r),this.bulletAnimation=t,this},U.Weapon.prototype.debug=function(t,e,i){void 0===i&&(i=!1),this.game.debug.text("Weapon Plugin",t=void 0===t?16:t,e=void 0===e?32:e),this.game.debug.text("Bullets Alive: "+this.bullets.total+" - Total: "+this.bullets.length,t,e+24),i&&this.bullets.forEachExists(this.game.debug.body,this.game.debug,"rgba(255, 0, 255, 0.8)")},Object.defineProperty(U.Weapon.prototype,"bulletClass",{get:function(){return this._bulletClass},set:function(t){this._bulletClass=t,this.bullets.classType=this._bulletClass}}),Object.defineProperty(U.Weapon.prototype,"bulletKillType",{get:function(){return this._bulletKillType},set:function(t){switch(t){case U.Weapon.KILL_STATIC_BOUNDS:case U.Weapon.KILL_WEAPON_BOUNDS:this.bulletBounds=this.bounds;break;case U.Weapon.KILL_CAMERA_BOUNDS:this.bulletBounds=this.game.camera.view;break;case U.Weapon.KILL_WORLD_BOUNDS:this.bulletBounds=this.game.world.bounds}this._bulletKillType=t}}),Object.defineProperty(U.Weapon.prototype,"bulletCollideWorldBounds",{get:function(){return this._bulletCollideWorldBounds},set:function(t){this._bulletCollideWorldBounds=t,this.bullets.setAll("body.collideWorldBounds",t),this.bullets.setAll("data.bodyDirty",!1)}}),Object.defineProperty(U.Weapon.prototype,"x",{get:function(){return this.fireFrom.x},set:function(t){this.fireFrom.x=t}}),Object.defineProperty(U.Weapon.prototype,"y",{get:function(){return this.fireFrom.y},set:function(t){this.fireFrom.y=t}}),U.Bullet=function(t,e,i,n,r){U.Sprite.call(this,t,e,i,n,r),this.anchor.set(.5),this.data={bulletManager:null,fromX:0,fromY:0,bodyDirty:!0,rotateToVelocity:!1,killType:0,killDistance:0}},U.Bullet.prototype=Object.create(U.Sprite.prototype),U.Bullet.prototype.constructor=U.Bullet,U.Bullet.prototype.kill=function(){return this.alive=!1,this.exists=!1,this.visible=!1,this.data.bulletManager.onKill.dispatch(this),this},U.Bullet.prototype.update=function(){this.exists&&(this.data.killType>U.Weapon.KILL_LIFESPAN&&(this.data.killType===U.Weapon.KILL_DISTANCE?this.game.physics.arcade.distanceToXY(this,this.data.fromX,this.data.fromY,!0)>this.data.killDistance&&this.kill():this.data.bulletManager.bulletBounds.intersects(this)||this.kill()),this.data.rotateToVelocity&&(this.rotation=Math.atan2(this.body.velocity.y,this.body.velocity.x)),this.data.bulletManager.bulletWorldWrap&&this.game.world.wrap(this,this.data.bulletManager.bulletWorldWrapPadding))},U.Video=function(t,e,i){var n;void 0===e&&(e=null),void 0===i&&(i=null),this.game=t,this.key=e,this.width=0,this.height=0,this.type=U.VIDEO,this.disableTextureUpload=!1,this.touchLocked=!1,this.onPlay=new U.Signal,this.onChangeSource=new U.Signal,this.onComplete=new U.Signal,this.onAccess=new U.Signal,this.onError=new U.Signal,this.onTimeout=new U.Signal,this.timeout=15e3,this._timeOutID=null,this.video=null,this.videoStream=null,this.isStreaming=!1,this.retryLimit=20,this.retry=0,this.retryInterval=500,this._retryID=null,this._codeMuted=!1,this._muted=!1,this._codePaused=!1,this._paused=!1,this._pending=!1,this._autoplay=!1,this._endCallback=null,this._playCallback=null,e&&this.game.cache.checkVideoKey(e)?((n=this.game.cache.getVideo(e)).isBlob?this.createVideoFromBlob(n.data):this.video=n.data,this.width=this.video.videoWidth,this.height=this.video.videoHeight):i&&this.createVideoFromURL(i,!1),this.video&&!i?this.baseTexture=new PIXI.BaseTexture(this.video):this.baseTexture=new PIXI.BaseTexture(U.Cache.DEFAULT.baseTexture.source),this.baseTexture.forceLoaded(this.width,this.height),this.texture=new PIXI.Texture(this.baseTexture),this.textureFrame=new U.Frame(0,0,0,this.width,this.height,"video"),this.texture.setFrame(this.textureFrame),this.texture.valid=!1,null!==e&&this.video&&(this.texture.valid=this.video.canplay),this.snapshot=null,U.BitmapData&&(this.snapshot=new U.BitmapData(this.game,"",this.width,this.height)),!this.game.device.cocoonJS&&(this.game.device.iOS||this.game.device.chrome)||window.PhaserGlobal&&window.PhaserGlobal.fakeiOSTouchLock?this.setTouchLock():n&&(n.locked=!1)},U.Video.prototype={connectToMediaStream:function(t,e){return t&&e&&(this.video=t,this.videoStream=e,this.isStreaming=!0,this.baseTexture.source=this.video,this.updateTexture(null,this.video.videoWidth,this.video.videoHeight),this.onAccess.dispatch(this)),this},startMediaStream:function(t,e,i){if(void 0===t&&(t=!1),void 0===e&&(e=null),void 0===i&&(i=null),!this.game.device.getUserMedia)return this.onError.dispatch(this,"No getUserMedia"),!1;null!==this.videoStream&&(this.videoStream.active?this.videoStream.active=!1:this.videoStream.stop()),this.removeVideoElement(),this.video=document.createElement("video"),this.video.setAttribute("autoplay","autoplay"),null!==e&&(this.video.width=e),null!==i&&(this.video.height=i),this._timeOutID=window.setTimeout(this.getUserMediaTimeout.bind(this),this.timeout);try{navigator.getUserMedia({audio:t,video:!0},this.getUserMediaSuccess.bind(this),this.getUserMediaError.bind(this))}catch(t){this.getUserMediaError(t)}return this},getUserMediaTimeout:function(){clearTimeout(this._timeOutID),this.onTimeout.dispatch(this)},getUserMediaError:function(t){clearTimeout(this._timeOutID),this.onError.dispatch(this,t)},getUserMediaSuccess:function(t){clearTimeout(this._timeOutID),this.videoStream=t,void 0!==this.video.mozSrcObject?this.video.mozSrcObject=t:this.video.src=window.URL&&window.URL.createObjectURL(t)||t;var r=this;this.video.onloadeddata=function(){var n=10;!function t(){var e,i;0<n&&(0<r.video.videoWidth?(e=r.video.videoWidth,i=r.video.videoHeight,isNaN(r.video.videoHeight)&&(i=e/(4/3)),r.video.play(),r.isStreaming=!0,r.baseTexture.source=r.video,r.updateTexture(null,e,i),r.onAccess.dispatch(r)):window.setTimeout(t,500)),n--}()}},createVideoFromBlob:function(t){var e=this;return this.video=document.createElement("video"),this.video.controls=!1,this.video.setAttribute("autoplay","autoplay"),this.video.addEventListener("loadeddata",function(t){e.updateTexture(t)},!0),this.video.src=window.URL.createObjectURL(t),this.video.canplay=!0,this},createVideoFromURL:function(t,e){return void 0===e&&(e=!1),this.texture&&(this.texture.valid=!1),this.video=document.createElement("video"),this.video.controls=!1,e&&this.video.setAttribute("autoplay","autoplay"),this.video.src=t,this.video.canplay=!0,this.video.load(),this.retry=this.retryLimit,this._retryID=window.setTimeout(this.checkVideoProgress.bind(this),this.retryInterval),this.key=t,this},updateTexture:function(t,e,i){var n=!1;null!=e||(e=this.video.videoWidth,n=!0),null!=i||(i=this.video.videoHeight),this.width=e,this.height=i,this.baseTexture.source!==this.video&&(this.baseTexture.source=this.video),this.baseTexture.forceLoaded(e,i),this.texture.frame.resize(e,i),this.texture.width=e,this.texture.height=i,this.texture.valid=!0,this.snapshot&&this.snapshot.resize(e,i),n&&null!==this.key&&(this.onChangeSource.dispatch(this,e,i),this._autoplay&&(this.video.play(),this.onPlay.dispatch(this,this.loop,this.playbackRate)))},complete:function(){this.onComplete.dispatch(this)},play:function(t,e){return void 0===t&&(t=!1),void 0===e&&(e=1),this.game.sound.onMute&&(this.game.sound.onMute.add(this.setMute,this),this.game.sound.onUnMute.add(this.unsetMute,this),this.game.sound.mute&&this.setMute()),this.game.onPause.add(this.setPause,this),this.game.onResume.add(this.setResume,this),this._endCallback=this.complete.bind(this),this.video.addEventListener("ended",this._endCallback,!0),this.video.addEventListener("webkitendfullscreen",this._endCallback,!0),this.video.loop=t?"loop":"",this.video.playbackRate=e,this.touchLocked?this._pending=!0:(this._pending=!1,null!==this.key&&(4!==this.video.readyState?(this.retry=this.retryLimit,this._retryID=window.setTimeout(this.checkVideoProgress.bind(this),this.retryInterval)):(this._playCallback=this.playHandler.bind(this),this.video.addEventListener("playing",this._playCallback,!0))),this.video.play(),this.onPlay.dispatch(this,t,e)),this},playHandler:function(){this.video.removeEventListener("playing",this._playCallback,!0),this.updateTexture()},stop:function(){return this.game.sound.onMute&&(this.game.sound.onMute.remove(this.setMute,this),this.game.sound.onUnMute.remove(this.unsetMute,this)),this.game.onPause.remove(this.setPause,this),this.game.onResume.remove(this.setResume,this),this.isStreaming?(this.video.mozSrcObject?(this.video.mozSrcObject.stop(),this.video.src=null):(this.video.src="",this.videoStream.active?this.videoStream.active=!1:this.videoStream.getTracks?this.videoStream.getTracks().forEach(function(t){t.stop()}):this.videoStream.stop()),this.videoStream=null,this.isStreaming=!1):(this.video.removeEventListener("ended",this._endCallback,!0),this.video.removeEventListener("webkitendfullscreen",this._endCallback,!0),this.video.removeEventListener("playing",this._playCallback,!0),this.touchLocked?this._pending=!1:this.video.pause()),this},add:function(t){if(Array.isArray(t))for(var e=0;e<t.length;e++)t[e].loadTexture&&t[e].loadTexture(this);else t.loadTexture(this);return this},addToWorld:function(t,e,i,n,r,o){r=r||1,o=o||1;e=this.game.add.image(t,e,this);return e.anchor.set(i,n),e.scale.set(r,o),e},render:function(){!this.disableTextureUpload&&this.playing&&this.baseTexture.dirty()},setMute:function(){this._muted||(this._muted=!0,this.video.muted=!0)},unsetMute:function(){this._muted&&!this._codeMuted&&(this._muted=!1,this.video.muted=!1)},setPause:function(){this._paused||this.touchLocked||(this._paused=!0,this.video.pause())},setResume:function(){!this._paused||this._codePaused||this.touchLocked||(this._paused=!1,this.video.ended||this.video.play())},changeSource:function(t,e){return void 0===e&&(e=!0),this.texture.valid=!1,this.video.pause(),this.retry=this.retryLimit,this._retryID=window.setTimeout(this.checkVideoProgress.bind(this),this.retryInterval),this.video.src=t,this.video.load(),(this._autoplay=e)||(this.paused=!0),this},checkVideoProgress:function(){4===this.video.readyState?this.updateTexture():(this.retry--,0<this.retry&&(this._retryID=window.setTimeout(this.checkVideoProgress.bind(this),this.retryInterval)))},setTouchLock:function(){this.game.input.touch.addTouchLockCallback(this.unlock,this),this.touchLocked=!0},unlock:function(){var t;return this.touchLocked=!1,this.video.play(),this.onPlay.dispatch(this,this.loop,this.playbackRate),this.key&&(t=this.game.cache.getVideo(this.key))&&!t.isBlob&&(t.locked=!1),!0},grab:function(t,e,i){return void 0===t&&(t=!1),void 0===e&&(e=1),void 0===i&&(i=null),null===this.snapshot?void 0:(t&&this.snapshot.cls(),this.snapshot.copy(this.video,0,0,this.width,this.height,0,0,this.width,this.height,0,0,0,1,1,e,i),this.snapshot)},removeVideoElement:function(){if(this.video){for(this.video.parentNode&&this.video.parentNode.removeChild(this.video);this.video.hasChildNodes();)this.video.removeChild(this.video.firstChild);this.video.removeAttribute("autoplay"),this.video.removeAttribute("src"),this.video=null}},destroy:function(){this.stop(),this.removeVideoElement(),this.touchLocked&&this.game.input.touch.removeTouchLockCallback(this.unlock,this),this._retryID&&window.clearTimeout(this._retryID)}},Object.defineProperty(U.Video.prototype,"currentTime",{get:function(){return this.video?this.video.currentTime:0},set:function(t){this.video.currentTime=t}}),Object.defineProperty(U.Video.prototype,"duration",{get:function(){return this.video?this.video.duration:0}}),Object.defineProperty(U.Video.prototype,"progress",{get:function(){return this.video?this.video.currentTime/this.video.duration:0}}),Object.defineProperty(U.Video.prototype,"mute",{get:function(){return this._muted},set:function(t){(t=t||null)?this._muted||(this._codeMuted=!0,this.setMute()):this._muted&&(this._codeMuted=!1,this.unsetMute())}}),Object.defineProperty(U.Video.prototype,"paused",{get:function(){return this._paused},set:function(t){t=t||null,this.touchLocked||(t?this._paused||(this._codePaused=!0,this.setPause()):this._paused&&(this._codePaused=!1,this.setResume()))}}),Object.defineProperty(U.Video.prototype,"volume",{get:function(){return this.video?this.video.volume:1},set:function(t){t<0?t=0:1<t&&(t=1),this.video&&(this.video.volume=t)}}),Object.defineProperty(U.Video.prototype,"playbackRate",{get:function(){return this.video?this.video.playbackRate:1},set:function(t){this.video&&(this.video.playbackRate=t)}}),Object.defineProperty(U.Video.prototype,"loop",{get:function(){return!!this.video&&this.video.loop},set:function(t){t&&this.video?this.video.loop="loop":this.video&&(this.video.loop="")}}),Object.defineProperty(U.Video.prototype,"playing",{get:function(){return!(this.video.paused&&this.video.ended)}}),U.Video.prototype.constructor=U.Video,void 0===PIXI.blendModes&&(PIXI.blendModes=U.blendModes),void 0===PIXI.scaleModes&&(PIXI.scaleModes=U.scaleModes),void 0===PIXI.Texture.emptyTexture&&(PIXI.Texture.emptyTexture=new PIXI.Texture(new PIXI.BaseTexture)),void 0===PIXI.DisplayObject._tempMatrix&&(PIXI.DisplayObject._tempMatrix=new PIXI.Matrix),void 0===PIXI.RenderTexture.tempMatrix&&(PIXI.RenderTexture.tempMatrix=new PIXI.Matrix),PIXI.Graphics&&void 0===PIXI.Graphics.POLY&&(PIXI.Graphics.POLY=U.POLYGON,PIXI.Graphics.RECT=U.RECTANGLE,PIXI.Graphics.CIRC=U.CIRCLE,PIXI.Graphics.ELIP=U.ELLIPSE,PIXI.Graphics.RREC=U.ROUNDEDRECTANGLE),PIXI.TextureSilentFail=!0,"undefined"!=typeof exports?(exports="undefined"!=typeof module&&module.exports?module.exports=U:exports).Phaser=U:"undefined"!=typeof define&&define.amd?define("Phaser",r.Phaser=U):r.Phaser=U,U}.call(this),function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports):"function"==typeof define&&define.amd?define(["exports"],e):e((t="undefined"!=typeof globalThis?globalThis:t||self).h5branding=t.h5branding||{})}(this,function(o){"use strict";var r,nt="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function rt(){throw new Error("Dynamic requires are not currently supported by rollup-plugin-commonjs")}function t(t,e){return t(e={exports:{}},e.exports),e.exports}t(function(t,e){t.exports=function(){function n(t){var e=typeof t;return t!==null&&(e==="object"||e==="function")}function h(t){return typeof t==="function"}var t=void 0;if(Array.isArray)t=Array.isArray;else t=function(t){return Object.prototype.toString.call(t)==="[object Array]"};var i=t,r=0,e=void 0,o=void 0,s=function t(e,i){v[r]=e;v[r+1]=i;r+=2;if(r===2)if(o)o(w);else b()};function a(t){o=t}function l(t){s=t}var p=typeof window!=="undefined"?window:undefined,u=p||{},d=u.MutationObserver||u.WebKitMutationObserver,c=typeof self==="undefined"&&typeof process!=="undefined"&&{}.toString.call(process)==="[object process]",y=typeof Uint8ClampedArray!=="undefined"&&typeof importScripts!=="undefined"&&typeof MessageChannel!=="undefined";function _(){return function(){return process.nextTick(w)}}function m(){if(typeof e!=="undefined")return function(){e(w)};return x()}function g(){var t=0;var e=new d(w);var i=document.createTextNode("");e.observe(i,{characterData:true});return function(){i.data=t=++t%2}}function f(){var t=new MessageChannel;t.port1.onmessage=w;return function(){return t.port2.postMessage(0)}}function x(){var t=setTimeout;return function(){return t(w,1)}}var v=new Array(1e3);function w(){for(var t=0;t<r;t+=2){var e=v[t];var i=v[t+1];e(i);v[t]=undefined;v[t+1]=undefined}r=0}function z(){try{var t=Function("return this")().require("vertx");e=t.runOnLoop||t.runOnContext;return m()}catch(t){return x()}}var b=void 0;if(c)b=_();else if(d)b=g();else if(y)b=f();else if(p===undefined&&typeof rt==="function")b=z();else b=x();function S(t,e){var i=this;var n=new this.constructor(M);if(n[P]===undefined)q(n);var r=i._state;if(r){var o=arguments[r-1];s(function(){return V(r,n,o,i._result)})}else j(i,n,t,e);return n}function C(t){var e=this;if(t&&typeof t==="object"&&t.constructor===e)return t;var i=new e(M);B(i,t);return i}var P=Math.random().toString(36).substring(2);function M(){}var T=void 0,A=1,k=2;function O(){return new TypeError("You cannot resolve a promise with itself")}function E(){return new TypeError("A promises callback cannot return that same promise.")}function I(t,e,i,n){try{t.call(e,i,n)}catch(t){return t}}function G(t,n,r){s(function(e){var i=false;var t=I(r,n,function(t){if(i)return;i=true;if(n!==t)B(e,t);else F(e,t)},function(t){if(i)return;i=true;N(e,t)},"Settle: "+(e._label||" unknown promise"));if(!i&&t){i=true;N(e,t)}},t)}function D(e,t){if(t._state===A)F(e,t._result);else if(t._state===k)N(e,t._result);else j(t,undefined,function(t){return B(e,t)},function(t){return N(e,t)})}function L(t,e,i){if(e.constructor===t.constructor&&i===S&&e.constructor.resolve===C)D(t,e);else if(i===undefined)F(t,e);else if(h(i))G(t,e,i);else F(t,e)}function B(e,t){if(e===t)N(e,O());else if(n(t)){var i=void 0;try{i=t.then}catch(t){N(e,t);return}L(e,t,i)}else F(e,t)}function R(t){if(t._onerror)t._onerror(t._result);U(t)}function F(t,e){if(t._state!==T)return;t._result=e;t._state=A;if(t._subscribers.length!==0)s(U,t)}function N(t,e){if(t._state!==T)return;t._state=k;t._result=e;s(R,t)}function j(t,e,i,n){var r=t._subscribers;var o=r.length;t._onerror=null;r[o]=e;r[o+A]=i;r[o+k]=n;if(o===0&&t._state)s(U,t)}function U(t){var e=t._subscribers;var i=t._state;if(e.length===0)return;var n=void 0,r=void 0,o=t._result;for(var s=0;s<e.length;s+=3){n=e[s];r=e[s+i];if(n)V(i,n,r,o);else r(o)}t._subscribers.length=0}function V(t,e,i,n){var r=h(i),o=void 0,s=void 0,a=true;if(r){try{o=i(n)}catch(t){a=false;s=t}if(e===o){N(e,E());return}}else o=n;if(e._state!==T);else if(r&&a)B(e,o);else if(a===false)N(e,s);else if(t===A)F(e,o);else if(t===k)N(e,o)}function W(i,t){try{t(function t(e){B(i,e)},function t(e){N(i,e)})}catch(t){N(i,t)}}var X=0;function H(){return X++}function q(t){t[P]=X++;t._state=undefined;t._result=undefined;t._subscribers=[]}function Y(){return new Error("Array Methods must be provided an Array")}var K=function(){function t(t,e){this._instanceConstructor=t;this.promise=new t(M);if(!this.promise[P])q(this.promise);if(i(e)){this.length=e.length;this._remaining=e.length;this._result=new Array(this.length);if(this.length===0)F(this.promise,this._result);else{this.length=this.length||0;this._enumerate(e);if(this._remaining===0)F(this.promise,this._result)}}else N(this.promise,Y())}t.prototype._enumerate=function t(e){for(var i=0;this._state===T&&i<e.length;i++)this._eachEntry(e[i],i)};t.prototype._eachEntry=function t(e,i){var n=this._instanceConstructor;var r=n.resolve;if(r===C){var o=void 0;var s=void 0;var a=false;try{o=e.then}catch(t){a=true;s=t}if(o===S&&e._state!==T)this._settledAt(e._state,i,e._result);else if(typeof o!=="function"){this._remaining--;this._result[i]=e}else if(n===et){var h=new n(M);if(a)N(h,s);else L(h,e,o);this._willSettleAt(h,i)}else this._willSettleAt(new n(function(t){return t(e)}),i)}else this._willSettleAt(r(e),i)};t.prototype._settledAt=function t(e,i,n){var r=this.promise;if(r._state===T){this._remaining--;if(e===k)N(r,n);else this._result[i]=n}if(this._remaining===0)F(r,this._result)};t.prototype._willSettleAt=function t(e,i){var n=this;j(e,undefined,function(t){return n._settledAt(A,i,t)},function(t){return n._settledAt(k,i,t)})};return t}();function Z(t){return new K(this,t).promise}function J(r){var o=this;if(!i(r))return new o(function(t,e){return e(new TypeError("You must pass an array to race."))});else return new o(function(t,e){var i=r.length;for(var n=0;n<i;n++)o.resolve(r[n]).then(t,e)})}function Q(t){var e=this;var i=new e(M);N(i,t);return i}function $(){throw new TypeError("You must pass a resolver function as the first argument to the promise constructor")}function tt(){throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.")}var et=function(){function e(t){this[P]=H();this._result=this._state=undefined;this._subscribers=[];if(M!==t){typeof t!=="function"&&$();this instanceof e?W(this,t):tt()}}e.prototype.catch=function t(e){return this.then(null,e)};e.prototype.finally=function t(e){var i=this;var n=i.constructor;if(h(e))return i.then(function(t){return n.resolve(e()).then(function(){return t})},function(t){return n.resolve(e()).then(function(){throw t})});return i.then(e,e)};return e}();function it(){var t=void 0;if(typeof nt!=="undefined")t=nt;else if(typeof self!=="undefined")t=self;else try{t=Function("return this")()}catch(t){throw new Error("polyfill failed because global object is unavailable in this environment")}var e=t.Promise;if(e){var i=null;try{i=Object.prototype.toString.call(e.resolve())}catch(t){}if(i==="[object Promise]"&&!e.cast)return}t.Promise=et}return et.prototype.then=S,et.all=Z,et.race=J,et.resolve=C,et.reject=Q,et._setScheduler=a,et._setAsap=l,et._asap=s,et.polyfill=it,et.Promise=et}()}).polyfill();var i=(e.has=function(t){var e=t.lastIndexOf(".");if(e<=0||e>=t.length-1)return!1;var i=t.lastIndexOf(".",e-1);if(i<=0||e-1<=i)return!1;var n=r[t.slice(e+1)];return!!n&&0<=n.indexOf(" "+t.slice(i+1,e)+" ")},e.is=function(t){var e=t.lastIndexOf(".");if(e<=0||e>=t.length-1)return!1;if(0<=t.lastIndexOf(".",e-1))return!1;var i=r[t.slice(e+1)];return!!i&&0<=i.indexOf(" "+t.slice(0,e)+" ")},e.get=function(t){var e=t.lastIndexOf(".");if(e<=0||e>=t.length-1)return null;var i=t.lastIndexOf(".",e-1);if(i<=0||e-1<=i)return null;var n=r[t.slice(e+1)];return!n||n.indexOf(" "+t.slice(i+1,e)+" ")<0?null:t.slice(i+1)},e);function e(){}var n=(s.setList=function(t){r=t||{}},s.getDomain=function(t){if(!r)return null;var e=t.match(/\./g);if(e&&e.length<2)return t;e=this.getTld(t);if(!e)return null;e=t.length-e.length-1,e=t.lastIndexOf(".",e-1)+1;return t.substring(e)||""},s.getTld=function(t){if(!r)return"";var e=t.lastIndexOf("."),e=t.substring(e+1);return r[e.toLowerCase()]&&i.get(t)||e},s.KEY="Domains",s);function s(){}var a=(Object.defineProperty(h,"instance",{get:function(){return h.classInstance=void 0===h.classInstance?new h:h.classInstance},enumerable:!1,configurable:!0}),h.prototype.load=function(e,t,i){var n=this;return this.contains(e)?Promise.reject("Already in cache."):(this.cache[e]={url:t,data:null},this.requestXhr(t,i).then(function(t){return n.loadComplete(e,t)}).catch(function(t){return n.remove(e),Promise.reject(t)}))},h.prototype.loadComplete=function(t,e){if(!this.contains(t))return Promise.reject("Item was removed from cache before loading was complete.");try{var i=JSON.parse(e);return this.cache[t].data=i,Promise.resolve(i)}catch(t){return Promise.reject("There was an error parsing JSON file.")}},h.prototype.remove=function(t){this.contains(t)&&delete this.cache[t]},h.prototype.get=function(t){return this.contains(t)?this.cache[t].data:null},h.prototype.contains=function(t){return this.cache.hasOwnProperty(t)},h.prototype.isLoading=function(t){return this.contains(t)&&null===this.cache[t].data},h.prototype.isLoaded=function(t){return this.contains(t)&&null!==this.cache[t].data},h.prototype.loadScript=function(n,t,r){return new Promise(function(t,e){var i=document.createElement("script");i.src=n,i.async=!1,i.onload=function(){"function"==typeof r&&r(),t()},document.head.appendChild(i)})},h.prototype.requestXhr=function(i,n){var r;return void 0===n&&(n="application/json"),window.XMLHttpRequest?(r=new XMLHttpRequest,new Promise(function(t,e){r.onreadystatechange=function(){4===r.readyState&&(200===r.status?(t(r.responseText),r.onreadystatechange=null):0<r.status&&(e("There was a problem with the request: status ".concat(r.status)),r.onreadystatechange=null))};try{r.open("GET",i,!0),r.setRequestHeader("Content-Type",n),r.send()}catch(t){e("Error: Unable to send request, CORS not allowed.")}})):Promise.reject("Unable to send request, XMLHttpRequest not supported.")},h);function h(){this.cache={}}function l(o,s,a,h){return new(a=a||Promise)(function(t,e){function i(t){try{r(h.next(t))}catch(t){e(t)}}function n(t){try{r(h.throw(t))}catch(t){e(t)}}function r(e){e.done?t(e.value):new a(function(t){t(e.value)}).then(i,n)}r((h=h.apply(o,s||[])).next())})}function p(i,n){var r,o,s,a={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]},t={next:e(0),throw:e(1),return:e(2)};return"function"==typeof Symbol&&(t[Symbol.iterator]=function(){return this}),t;function e(e){return function(t){return function(e){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,o&&(s=2&e[0]?o.return:e[0]?o.throw||((s=o.return)&&s.call(o),0):o.next)&&!(s=s.call(o,e[1])).done)return s;switch(o=0,(e=s?[2&e[0],s.value]:e)[0]){case 0:case 1:s=e;break;case 4:return a.label++,{value:e[1],done:!1};case 5:a.label++,o=e[1],e=[0];continue;case 7:e=a.ops.pop(),a.trys.pop();continue;default:if(!(s=0<(s=a.trys).length&&s[s.length-1])&&(6===e[0]||2===e[0])){a=0;continue}if(3===e[0]&&(!s||e[1]>s[0]&&e[1]<s[3])){a.label=e[1];break}if(6===e[0]&&a.label<s[1]){a.label=s[1],s=e;break}if(s&&a.label<s[2]){a.label=s[2],a.ops.push(e);break}s[2]&&a.ops.pop(),a.trys.pop();continue}e=n.call(i,a)}catch(t){e=[6,t],o=0}finally{r=s=0}if(5&e[0])throw e[1];return{value:e[0]?e[1]:void 0,done:!0}}([e,t])}}}o.BrandingDomain=void 0,(b=o.BrandingDomain||(o.BrandingDomain={}))[b.Neutral=0]="Neutral",b[b.Yepi=1]="Yepi",b[b.Spele=2]="Spele",b[b.Funnygames=3]="Funnygames",b[b.Kizi=4]="Kizi",b[b.PlayCell=5]="PlayCell",b[b.GameCell=6]="GameCell",b[b.Bild=7]="Bild",b[b.AGame=8]="AGame",b[b.Admeen=9]="Admeen",b[b.PlayTime=10]="PlayTime",b[b.Zigiz=11]="Zigiz";var u=(d.isBip=function(){return-1!==window.location.search.indexOf("bipgaming")||"bip.fbrq.io"===window.location.host},d.isPlaycellApp=function(){return-1!==window.location.search.indexOf("playcellApp")},d.isAGame=function(){return-1!==window.location.search.indexOf("agame")},d.isAirfi=function(){return!!window.hasOwnProperty("airfi")&&window.airfi},d.isPlaytime=function(){return-1!==window.location.host.indexOf("playtime.nl")},d.isBild=function(){return"bild.fbrq.io"===window.location.host||-1!==window.location.host.indexOf("contentfleet.com")},d.isYandex=function(){return window.hasOwnProperty("_YaSDK")||window.hasOwnProperty("YaGames")},d.getYandexBaseURL=function(){var t;if(null!==(t=null===(t=window.YandexGamesSDKEnvironment)||void 0===t?void 0:t.browser)&&void 0!==t&&t.lang&&"en"===window.YandexGamesSDKEnvironment.browser.lang)return"yandex.com";return"yandex.ru"},d);function d(){}o.UtmTargets=void 0,(b=o.UtmTargets||(o.UtmTargets={}))[b.splashscreen=0]="splashscreen",b[b.logo=1]="logo",b[b.facebook=2]="facebook",b[b.twitter=3]="twitter",b[b.playstore=4]="playstore",b[b.appstore=5]="appstore",b[b.more_games=6]="more_games",b[b.download_game=7]="download_game",b[b.walkthrough=8]="walkthrough",b[b.disclaimer=9]="disclaimer",b[b.highscores=10]="highscores";var c=(y.getProtocol=function(t){return t?"https://":"//"},y.getUtmContent=function(t){return"string"==typeof t?t:o.UtmTargets[t]},y.getDomainURL=function(t,e){var i;switch(t){case o.BrandingDomain.Spele:i=e+"www.spele.nl";break;case o.BrandingDomain.Yepi:i=e+"www.yepi.com";break;case o.BrandingDomain.Admeen:i="https://media.admeen.com/branding/link.php";break;case o.BrandingDomain.PlayCell:i=e+"www.playcell.com";break;case o.BrandingDomain.GameCell:i=e+"www.gamecell.com";break;case o.BrandingDomain.Kizi:i=e+"www.kizi.com";break;case o.BrandingDomain.Bild:i=e+"www.bildspielt.de";break;case o.BrandingDomain.Funnygames:i=e+"www.funnygames.nu";break;case o.BrandingDomain.PlayTime:i=e+"playtime.nl";break;default:case o.BrandingDomain.AGame:i=e+"www.agame.com";break;case o.BrandingDomain.Zigiz:i=e+"m.zigiz.com"}return i},y.getPromoURL=function(t,e,i,n,r){return window.hasOwnProperty("_YaSDK")||window.hasOwnProperty("YaGames")?"https://".concat(u.getYandexBaseURL(),"/games/developer?name=Azerion"):t===o.BrandingDomain.Admeen?"https://media.admeen.com/branding/link.php":t===o.BrandingDomain.Bild?e:e+"/?utm_source="+i+"&utm_medium=html5&utm_term="+n+"&utm_content="+r+"&utm_campaign=Gamedistribution"},y);function y(){}function _(t,e,i){var n=document.createElement("script");n.setAttribute("src",t+"?v="+e),"function"==typeof i&&(n.onload=i),document.body.appendChild(n)}var m=(g.loadPortalScript=function(t){t&&t.hasOwnProperty("minijuegos")&&-1!==t.minijuegos.indexOf(v.getSourceSite())&&(void 0!==window.mpConfig?window.mpConfig.partner="orange-games":window.mpConfig={partner:"orange-games"},_("https://ext.minijuegosgratis.com/external-host/main.js",Date.now()/1e3)),t&&t.hasOwnProperty("kongregate")&&-1!==t.kongregate.indexOf(v.getSourceSite())&&_("https://cdn1.kongregate.com/javascripts/kongregate_api.js",Date.now()/1e3,function(){"undefined"!=typeof kongregateAPI&&kongregateAPI.loadAPI(function(){window.kongregate=kongregateAPI.getAPI()})}),t&&t.hasOwnProperty("newgrounds")&&-1!==t.newgrounds.indexOf(v.getSourceSite())&&_("https://cdn.fbrq.io/@azerion/splash/assets/scripts/newgroundsio.min.js",Date.now()/1e3)},g);function g(){}var f=(x.preload=function(t){return false;var e=Promise.all([a.instance.load(n.KEY,"".concat(v.ASSET_LOCATION,"json/domains.json?v=").concat(t),"text/plain"),a.instance.load(x.SITELOCK_PORTALS,"".concat(v.ASSET_LOCATION,"json/sitelock.json?v=").concat(t),"text/plain")]);return Promise.all([a.instance.load(x.INTERNAL_PORTALS_KEY,"".concat(v.ASSET_LOCATION,"json/internal.json?v=").concat(t),"text/plain"),a.instance.load(x.CONTRACTED_PORTALS_KEY,"".concat(v.ASSET_LOCATION,"json/contracted.json?v=").concat(t),"text/plain"),a.instance.load(x.SPECIAL_PORTALS_KEY,"".concat(v.ASSET_LOCATION,"json/special.json?v=").concat(t),"text/plain")]),e.then(function(t){var e=t[0],t=t[1];n.setList(e),m.loadPortalScript(t),x.setSiteLock(t)}).catch(function(){})},x.setSiteLock=function(t){x.siteLocks=t},Object.defineProperty(x,"brandingLogoUrl",{get:function(){return "patch/images/games235-banner.png";var t;switch(v.isOnDevice()||u.isAirfi()?v.ASSET_LOCATION="assets/":"fbrq.io"===v.getSourceSite(!0)&&(v.ASSET_LOCATION="https://"+window.location.host+"/@azerion/splash/assets/"),v.getBrandingDomain()){case o.BrandingDomain.Spele:t="spele";break;case o.BrandingDomain.PlayCell:t="playcell";break;case o.BrandingDomain.GameCell:t="gamecell";break;case o.BrandingDomain.Yepi:t="yepi";break;case o.BrandingDomain.Admeen:t="admeen";break;case o.BrandingDomain.Bild:t="bild";break;case o.BrandingDomain.Kizi:t="kizi";break;case o.BrandingDomain.Funnygames:t="funnygames";break;case o.BrandingDomain.PlayTime:t="playtime";break;default:case o.BrandingDomain.AGame:t="agame";break;case o.BrandingDomain.Zigiz:t="zigiz"}return v.ASSET_LOCATION+"images/branding_logo_"+t+"_small.png"},enumerable:!1,configurable:!0}),Object.defineProperty(x,"brandingBackgroundColor",{get:function(){var t;switch(v.getBrandingDomain()){case o.BrandingDomain.Spele:t="#4a72ad";break;case o.BrandingDomain.PlayCell:t="#52a1e1";break;case o.BrandingDomain.GameCell:t="#c600b2";break;case o.BrandingDomain.Yepi:t="#0573a7";break;case o.BrandingDomain.AGame:t="#0C486C";break;case o.BrandingDomain.Admeen:t="#4267B2";break;case o.BrandingDomain.Bild:t="#de0000";break;default:case o.BrandingDomain.Kizi:t="#012f50";break;case o.BrandingDomain.Funnygames:t="#33b0ff";break;case o.BrandingDomain.PlayTime:case o.BrandingDomain.Zigiz:t="#023a63"}return t},enumerable:!1,configurable:!0}),x.blockedDomain=function(){return v.isOnDevice()||x.isSpecial()},x.createCampaignURL=function(t,e){var i=v.getSourceSite(),n=v.getBrandingDomain(),r=c.getProtocol(v.isOnDevice()),r=c.getDomainURL(n,r),e=c.getUtmContent(e);return c.getPromoURL(n,r,i,t,e)},x.openCampaignLink=function(t,e){var e=x.createCampaignURL(t,e);x.blockedDomain()||(e=window.op3n(e))&&e.focus&&e.focus()},x.isInternal=function(){return x.hostMatchesList(a.instance.get(x.INTERNAL_PORTALS_KEY))},x.isContracted=function(){return x.hostMatchesList(a.instance.get(x.CONTRACTED_PORTALS_KEY))},x.isSpecial=function(){return x.hostMatchesList(a.instance.get(x.SPECIAL_PORTALS_KEY))},x.isAdmeen=function(){if(!x.siteLocks||!x.siteLocks.hasOwnProperty("admeen"))return!1;var t=x.siteLocks.admeen;return x.hostMatchesList(t)},x.isKongregate=function(){if(!x.siteLocks||!x.siteLocks.hasOwnProperty("kongregate"))return!1;var t=x.siteLocks.kongregate;return x.hostMatchesList(t)},x.isNewgrounds=function(){if(!x.siteLocks||!x.siteLocks.hasOwnProperty("newgrounds"))return!1;var t=x.siteLocks.newgrounds;return x.hostMatchesList(t)},x.crossPromoAllowed=function(){var t=x.siteLocks.yandex;return x.hostMatchesList(t)},x.outGoingLinksAllowed=function(){return!(u.isAirfi()||x.isSpecial()||x.isContracted())&&(!window.hasOwnProperty("fbrqLA")||window.fbrqLA)},x.hostMatchesList=function(t){t=t||[];for(var e=v.getSourceSite(),i=0;i<t.length;i++)if(e===t[i])return!0;return!1},x.LOGO_KEY="branding_logo",x.INTERNAL_PORTALS_KEY="branding_portals",x.CONTRACTED_PORTALS_KEY="branding_contracted",x.SPECIAL_PORTALS_KEY="branding_special",x.SITELOCK_PORTALS="sitelock_portals",x.DOMAIN_OVERWRITE=null,x.analyticsEnabled=!0,x);function x(){}var v=(w.loadHost=function(){return l(this,void 0,void 0,function(){var e,i;return p(this,function(t){switch(t.label){case 0:if(e=document.referrer||window.location.host,!window.hasOwnProperty("gdsdk"))return[3,4];t.label=1;case 1:return t.trys.push([1,3,,4]),[4,window.gdsdk.getSession()];case 2:return i=t.sent(),e=i.location.parentDomain,[3,4];case 3:return t.sent(),[3,4];case 4:return w.HOST=e,[2]}})})},w.getSourceSite=function(t){var e=w.HOST;if(-1!==(e=(t=void 0===t?!1:t)?window.location.host:e).indexOf("embed.gamedistribution.com")&&-1!==window.location.search.indexOf("gd_sdk_referrer_url")&&(e=w.getUrlParameter("gd_sdk_referrer_url")||e),e=decodeURIComponent(e),u.isBild())return"bildspielt.de";if(u.isBip())return"bipgaming.com";e=(e=-1<e.indexOf("://")?e.split("/")[2]:e.split("/")[0]).split(":")[0],t=n.getDomain(e);return null!==t?t:3===e.split(".").length?e.substr(e.indexOf(".")+1):e},w.getBrandingDomain=function(){if(window.hasOwnProperty("fbrqBD")&&window.fbrqBD in o.BrandingDomain)return window.fbrqBD;if(f.DOMAIN_OVERWRITE)return f.DOMAIN_OVERWRITE;var t=w.getSourceSite();if(f.isAdmeen())return o.BrandingDomain.Admeen;if(u.isPlaycellApp()||u.isBip())return o.BrandingDomain.PlayCell;switch(t){case"spele.nl":return o.BrandingDomain.Spele;case"yepi.com":return o.BrandingDomain.Yepi;case"oyunskor.com":case"barbioyunu.com.tr":case"bebekoyunu.com.tr":case"oyunkolu.com":case"oyungemisi.com":case"oyunlar1.com":case"oyunkuzusu.com":case"kraloyun.com":case"rekoroyun.com":case"oyundedem.com":case"oyunoyna.com":case"pastaoyunu.com.tr":case"playcell.com":return o.BrandingDomain.PlayCell;case"gamecell.com":return o.BrandingDomain.GameCell;case"playxl.com":return o.BrandingDomain.Admeen;case"kizi.com":return o.BrandingDomain.Kizi;case"bildspielt.de":return o.BrandingDomain.Bild;case"funnygames.nl":return o.BrandingDomain.Funnygames;case"playtime.nl":return o.BrandingDomain.PlayTime;default:case"agame.com":return o.BrandingDomain.AGame;case"gmbl.nl":case"zigiz.com":return o.BrandingDomain.Zigiz;case"coolmathgames.com":return o.BrandingDomain.Neutral}},w.getReferrer=function(t){return-1!==t.indexOf("?ref=")?t.substr(t.indexOf("?ref=")+5):t},w.inIframe=function(){try{return window.self!==window.top}catch(t){return!0}},w.inGDGameZone=function(){return-1!==document.referrer.indexOf("html5.gamedistribution.com")},w.getDomain=function(t){var e=document.createElement("a");return e.href=t,e.origin},w.isOnDevice=function(){return void 0!==window.cordova&&!/(gamedistribution\.com)/.test(window.location.hostname)},w.isTc=function(){return/(teamcity\.azerdev\.com)/.test(window.location.host)},w.getRandomRange=function(t,e){return Math.random()*(e-t)+t|0},w.getUrlParameter=function(t){t=t.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");t=new RegExp("[\\?&]"+t+"=([^&#]*)").exec(location.search);return null===t?"":decodeURIComponent(t[1].replace(/\+/g," "))},w.intTimeToString=function(t){var e=Math.floor(t/3600),i=Math.floor(t%3600/60),t=t%60;return(e<10?"0"+e:e.toString())+":"+(i<10?"0"+i:i.toString())+":"+(t<10?"0"+t:t.toString())},w.LANGUAGE="en",w.HOST=document.referrer||window.location.host,w.ASSET_LOCATION=window.hasOwnProperty("fbrqSA")&&!0===window.fbrqSA?"assets/":"https://cdn.fbrq.io/@azerion/splash/assets/",w);function w(){}var z=t(function(t,e){t.exports=function n(r,o,s){function a(i,t){if(!o[i]){if(!r[i]){if(!t&&rt)return rt();if(h)return h(i,!0);var e=new Error("Cannot find module '"+i+"'");throw e.code="MODULE_NOT_FOUND",e}e=o[i]={exports:{}};r[i][0].call(e.exports,function(t){var e=r[i][1][t];return a(e||t)},e,e.exports,n,r,o,s)}return o[i].exports}for(var h=rt,t=0;t<s.length;t++)a(s[t]);return a}({1:[function(t,N,j){!function(){var p,i,u,d,c,t,y,a,l,s,h,o,r,_,n,m,e,g,f=this||Function("return this")(),x=(t=Date.now||function(){return+new Date},y="undefined"!=typeof SHIFTY_DEBUG_NOW?SHIFTY_DEBUG_NOW:t,i="undefined"!=typeof window&&(window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||window.mozCancelRequestAnimationFrame&&window.mozRequestAnimationFrame)||setTimeout,A.prototype.tween=function(t){return this._isTweening?this:(void 0===t&&this._configured||this.setConfig(t),this._timestamp=y(),this._start(this.get(),this._attachment),this.resume())},A.prototype.setConfig=function(t){t=t||{},this._configured=!0,this._attachment=t.attachment,this._pausedAtTime=null,this._scheduleId=null,this._delay=t.delay||0,this._start=t.start||v,this._step=t.step||v,this._finish=t.finish||v,this._duration=t.duration||500,this._currentState=z({},t.from||this.get()),this._originalState=this.get(),this._targetState=z({},t.to||this.get());var e=this;this._timeoutHandler=function(){M(e,e._timestamp,e._delay,e._duration,e._currentState,e._originalState,e._targetState,e._easing,e._step,e._scheduleFunction)};var i=this._currentState,n=this._targetState;return b(n,i),this._easing=T(i,t.easing||"linear"),this._filterArgs=[i,this._originalState,n,this._easing],P(this,"tweenCreated"),this},A.prototype.get=function(){return z({},this._currentState)},A.prototype.set=function(t){this._currentState=t},A.prototype.pause=function(){return this._pausedAtTime=y(),this._isPaused=!0,this},A.prototype.resume=function(){return this._isPaused&&(this._timestamp+=y()-this._pausedAtTime),this._isPaused=!1,this._isTweening=!0,this._timeoutHandler(),this},A.prototype.seek=function(t){t=Math.max(t,0);var e=y();return this._timestamp+t===0||(this._timestamp=e-t,this.isPlaying()||(this._isTweening=!0,this._isPaused=!1,M(this,this._timestamp,this._delay,this._duration,this._currentState,this._originalState,this._targetState,this._easing,this._step,this._scheduleFunction,e),this.pause())),this},A.prototype.stop=function(t){return this._isTweening=!1,this._isPaused=!1,this._timeoutHandler=v,(f.cancelAnimationFrame||f.webkitCancelAnimationFrame||f.oCancelAnimationFrame||f.msCancelAnimationFrame||f.mozCancelRequestAnimationFrame||f.clearTimeout)(this._scheduleId),t&&(P(this,"beforeTween"),S(1,this._currentState,this._originalState,this._targetState,1,0,this._easing),P(this,"afterTween"),P(this,"afterTweenEnd"),this._finish.call(this,this._currentState,this._attachment)),this},A.prototype.isPlaying=function(){return this._isTweening&&!this._isPaused},A.prototype.setScheduleFunction=function(t){this._scheduleFunction=t},A.prototype.dispose=function(){for(var t in this)this.hasOwnProperty(t)&&delete this[t]},A.prototype.filter={},p=A.prototype.formula={linear:function(t){return t}},z(A,{now:y,each:w,tweenProps:S,tweenProp:C,applyFilter:P,shallowCopy:z,defaults:b,composeEasingObject:T}),"function"==typeof SHIFTY_DEBUG_NOW&&(f.timeoutHandler=M),"object"==typeof j?N.exports=A:void 0===f.Tweenable&&(f.Tweenable=A),A);function v(){}function w(t,e){for(var i in t)Object.hasOwnProperty.call(t,i)&&e(i)}function z(e,i){return w(i,function(t){e[t]=i[t]}),e}function b(e,i){w(i,function(t){void 0===e[t]&&(e[t]=i[t])})}function S(t,e,i,n,r,o,s){var a,h,l=t<o?0:(t-o)/r;for(a in e)e.hasOwnProperty(a)&&(h="function"==typeof(h=s[a])?h:p[h],e[a]=C(i[a],n[a],h,l));return e}function C(t,e,i,n){return t+(e-t)*i(n)}function P(e,i){var n=A.prototype.filter,r=e._filterArgs;w(n,function(t){void 0!==n[t][i]&&n[t][i].apply(e,r)})}function M(t,e,i,n,r,o,s,a,h,l,p){c=e+i+n,u=Math.min(p||y(),c),d=c<=u,c=n-(c-u),t.isPlaying()&&(d?(h(s,t._attachment,c),t.stop(!0)):(t._scheduleId=l(t._timeoutHandler,1e3/60),P(t,"beforeTween"),u<e+i?S(1,r,o,s,1,1,a):S(u,r,o,s,n,e+i,a),P(t,"afterTween"),h(r,t._attachment,c)))}function T(t,e){var i={},n=typeof e;return w(t,"string"==n||"function"==n?function(t){i[t]=e}:function(t){i[t]||(i[t]=e[t]||"linear")}),i}function A(t,e){this._currentState=t||{},this._configured=!1,this._scheduleFunction=i,void 0!==e&&this.setConfig(e)}function k(t,e,i,n,r,o){var h=0,l=0,p=0,s=0,a=0,u=0;function d(t){return((h*t+l)*t+p)*t}function c(t){return 0<=t?t:0-t}return h=1-(p=3*e)-(l=3*(n-e)-p),s=1-(u=3*i)-(a=3*(r-i)-u),o=function(t,e){var i,n,r,o,s,a;for(r=t,a=0;a<8;a++){if(c(o=d(r)-t)<e)return r;if(c(s=function(t){return(3*h*t+2*l)*t+p}(r))<1e-6)break;r-=o/s}if(n=1,(r=t)<(i=0))return i;if(n<r)return n;for(;i<n;){if(c((o=d(r))-t)<e)return r;o<t?i=r:n=r,r=.5*(n-i)+i}return r}(t,o=1/(200*o)),((s*o+a)*o+u)*o}function O(i){l.each(i,function(t){var e=i[t];"string"==typeof e&&e.match(n)&&(i[t]=G(n,e,E))})}function E(t){t=function(t){3===(t=t.replace(/#/,"")).length&&(t=(t=t.split(""))[0]+t[0]+t[1]+t[1]+t[2]+t[2]);return e[0]=I(t.substr(0,2)),e[1]=I(t.substr(2,2)),e[2]=I(t.substr(4,2)),e}(t);return"rgb("+t[0]+","+t[1]+","+t[2]+")"}function I(t){return parseInt(t,16)}function G(t,e,i){var n=e.match(t),r=e.replace(t,m);if(n)for(var o,s=n.length,a=0;a<s;a++)o=n.shift(),r=r.replace(m,i(o));return r}function D(t){for(var e=t.match(o),i=e.length,n=t.match(_)[0],r=0;r<i;r++)n+=parseInt(e[r],10)+",";return n=n.slice(0,-1)+")"}function L(r){var o={};return l.each(r,function(t){var e,i,n=r[t];"string"==typeof n&&(e=F(n),o[t]={formatString:((n=(i=n).match(h))?1!==n.length&&!i.charAt(0).match(s)||n.unshift(""):n=["",""],n.join(m)),chunkNames:function(t,e){for(var i=[],n=t.length,r=0;r<n;r++)i.push("_"+e+"_"+r);return i}(e,t)})}),o}function B(r,o){l.each(o,function(t){for(var e=F(r[t]),i=e.length,n=0;n<i;n++)r[o[t].chunkNames[n]]=+e[n];delete r[t]})}function R(i,n){l.each(n,function(t){i[t];var e=function(t,e){g.length=0;for(var i=e.length,n=0;n<i;n++)g.push(t[e[n]]);return g}(function(t,e){for(var i,n={},r=e.length,o=0;o<r;o++)i=e[o],n[i]=t[i],delete t[i];return n}(i,n[t].chunkNames),n[t].chunkNames),e=function(t,e){for(var i=t,n=e.length,r=0;r<n;r++)i=i.replace(m,+e[r].toFixed(4));return i}(n[t].formatString,e);i[t]=G(r,e,D)})}function F(t){return t.match(o)}x.shallowCopy(x.prototype.formula,{easeInQuad:function(t){return Math.pow(t,2)},easeOutQuad:function(t){return-(Math.pow(t-1,2)-1)},easeInOutQuad:function(t){return(t/=.5)<1?.5*Math.pow(t,2):-.5*((t-=2)*t-2)},easeInCubic:function(t){return Math.pow(t,3)},easeOutCubic:function(t){return Math.pow(t-1,3)+1},easeInOutCubic:function(t){return(t/=.5)<1?.5*Math.pow(t,3):.5*(Math.pow(t-2,3)+2)},easeInQuart:function(t){return Math.pow(t,4)},easeOutQuart:function(t){return-(Math.pow(t-1,4)-1)},easeInOutQuart:function(t){return(t/=.5)<1?.5*Math.pow(t,4):-.5*((t-=2)*Math.pow(t,3)-2)},easeInQuint:function(t){return Math.pow(t,5)},easeOutQuint:function(t){return Math.pow(t-1,5)+1},easeInOutQuint:function(t){return(t/=.5)<1?.5*Math.pow(t,5):.5*(Math.pow(t-2,5)+2)},easeInSine:function(t){return 1-Math.cos(t*(Math.PI/2))},easeOutSine:function(t){return Math.sin(t*(Math.PI/2))},easeInOutSine:function(t){return-.5*(Math.cos(Math.PI*t)-1)},easeInExpo:function(t){return 0===t?0:Math.pow(2,10*(t-1))},easeOutExpo:function(t){return 1===t?1:1-Math.pow(2,-10*t)},easeInOutExpo:function(t){return 0===t?0:1===t?1:(t/=.5)<1?.5*Math.pow(2,10*(t-1)):.5*(2-Math.pow(2,-10*--t))},easeInCirc:function(t){return-(Math.sqrt(1-t*t)-1)},easeOutCirc:function(t){return Math.sqrt(1-Math.pow(t-1,2))},easeInOutCirc:function(t){return(t/=.5)<1?-.5*(Math.sqrt(1-t*t)-1):.5*(Math.sqrt(1-(t-=2)*t)+1)},easeOutBounce:function(t){return t<1/2.75?7.5625*t*t:t<2/2.75?7.5625*(t-=1.5/2.75)*t+.75:t<2.5/2.75?7.5625*(t-=2.25/2.75)*t+.9375:7.5625*(t-=2.625/2.75)*t+.984375},easeInBack:function(t){return t*t*(2.70158*t-1.70158)},easeOutBack:function(t){return(t-=1)*t*(2.70158*t+1.70158)+1},easeInOutBack:function(t){var e=1.70158;return(t/=.5)<1?t*t*((1+(e*=1.525))*t-e)*.5:.5*((t-=2)*t*((1+(e*=1.525))*t+e)+2)},elastic:function(t){return-1*Math.pow(4,-8*t)*Math.sin((6*t-1)*(2*Math.PI)/2)+1},swingFromTo:function(t){var e=1.70158;return(t/=.5)<1?t*t*((1+(e*=1.525))*t-e)*.5:.5*((t-=2)*t*((1+(e*=1.525))*t+e)+2)},swingFrom:function(t){return t*t*(2.70158*t-1.70158)},swingTo:function(t){return--t*t*(2.70158*t+1.70158)+1},bounce:function(t){return t<1/2.75?7.5625*t*t:t<2/2.75?7.5625*(t-=1.5/2.75)*t+.75:t<2.5/2.75?7.5625*(t-=2.25/2.75)*t+.9375:7.5625*(t-=2.625/2.75)*t+.984375},bouncePast:function(t){return t<1/2.75?7.5625*t*t:t<2/2.75?2-(7.5625*(t-=1.5/2.75)*t+.75):t<2.5/2.75?2-(7.5625*(t-=2.25/2.75)*t+.9375):2-(7.5625*(t-=2.625/2.75)*t+.984375)},easeFromTo:function(t){return(t/=.5)<1?.5*Math.pow(t,4):-.5*((t-=2)*Math.pow(t,3)-2)},easeFrom:function(t){return Math.pow(t,4)},easeTo:function(t){return Math.pow(t,.25)}}),x.setBezierFunction=function(t,e,i,n,r){var o,s,a,h,l=(o=e,s=i,a=n,h=r,function(t){return k(t,o,s,a,h,1)});return l.displayName=t,l.x1=e,l.y1=i,l.x2=n,l.y2=r,x.prototype.formula[t]=l},x.unsetBezierFunction=function(t){delete x.prototype.formula[t]},(a=new x)._filterArgs=[],x.interpolate=function(t,e,i,n,r){var o=x.shallowCopy({},t),s=r||0,r=x.composeEasingObject(t,n||"linear");a.set({});n=a._filterArgs;n.length=0,n[0]=o,n[1]=t,n[2]=e,n[3]=r,x.applyFilter(a,"tweenCreated"),x.applyFilter(a,"beforeTween");r=x.tweenProps(i,o,t,e,1,s,r);return x.applyFilter(a,"afterTween"),r},l=x,s=/(\d|\-|\.)/,h=/([^\-0-9\.]+)/g,o=/[0-9.\-]+/g,r=new RegExp("rgb\\("+o.source+/,\s*/.source+o.source+/,\s*/.source+o.source+"\\)","g"),_=/^.*\(/,n=/#([0-9]|[a-f]){3,6}/gi,m="VAL",e=[],g=[],l.prototype.filter.token={tweenCreated:function(t,e,i,n){O(t),O(e),O(i),this._tokenData=L(t)},beforeTween:function(t,e,i,n){var a,h;a=n,h=this._tokenData,l.each(h,function(t){var e=h[t].chunkNames,i=e.length,n=a[t];if("string"==typeof n)for(var r=n.split(" "),o=r[r.length-1],s=0;s<i;s++)a[e[s]]=r[s]||o;else for(s=0;s<i;s++)a[e[s]]=n;delete a[t]}),B(t,this._tokenData),B(e,this._tokenData),B(i,this._tokenData)},afterTween:function(t,e,i,n){var s,a;R(t,this._tokenData),R(e,this._tokenData),R(i,this._tokenData),s=n,a=this._tokenData,l.each(a,function(t){var e=a[t].chunkNames,i=e.length,n=s[e[0]];if("string"==typeof n){for(var r="",o=0;o<i;o++)r+=" "+s[e[o]],delete s[e[o]];s[t]=r.substr(1)}else s[t]=n})}}}.call(null)},{}],2:[function(t,e,i){function n(t,e){this._pathTemplate="M 50,50 m 0,-{radius} a {radius},{radius} 0 1 1 0,{2radius} a {radius},{radius} 0 1 1 0,-{2radius}",this.containerAspectRatio=1,r.apply(this,arguments)}var r=t("./shape"),o=t("./utils");((n.prototype=new r).constructor=n).prototype._pathString=function(t){var e=t.strokeWidth,e=50-(e=t.trailWidth&&t.trailWidth>t.strokeWidth?t.trailWidth:e)/2;return o.render(this._pathTemplate,{radius:e,"2radius":2*e})},n.prototype._trailString=function(t){return this._pathString(t)},e.exports=n},{"./shape":7,"./utils":9}],3:[function(t,e,i){function n(t,e){this._pathTemplate="M 0,{center} L 100,{center}",r.apply(this,arguments)}var r=t("./shape"),o=t("./utils");((n.prototype=new r).constructor=n).prototype._initializeSvg=function(t,e){t.setAttribute("viewBox","0 0 100 "+e.strokeWidth),t.setAttribute("preserveAspectRatio","none")},n.prototype._pathString=function(t){return o.render(this._pathTemplate,{center:t.strokeWidth/2})},n.prototype._trailString=function(t){return this._pathString(t)},e.exports=n},{"./shape":7,"./utils":9}],4:[function(t,e,i){e.exports={Line:t("./line"),Circle:t("./circle"),SemiCircle:t("./semicircle"),Square:t("./square"),Path:t("./path"),Shape:t("./shape"),utils:t("./utils")}},{"./circle":2,"./line":3,"./path":5,"./semicircle":6,"./shape":7,"./square":8,"./utils":9}],5:[function(t,e,i){function n(t,e){if(!(this instanceof n))throw new Error("Constructor was called without new keyword");e=h.extend({duration:800,easing:"linear",from:{},to:{},step:function(){}},e),t=h.isString(t)?document.querySelector(t):t,this.path=t,this._opts=e,this._tweenable=null,e=this.path.getTotalLength(),this.path.style.strokeDasharray=e+" "+e,this.set(0)}var a=t("shifty"),h=t("./utils"),r={easeIn:"easeInCubic",easeOut:"easeOutCubic",easeInOut:"easeInOutCubic"};n.prototype.value=function(){var t=this._getComputedDashOffset(),e=this.path.getTotalLength();return parseFloat((1-t/e).toFixed(6),10)},n.prototype.set=function(t){this.stop(),this.path.style.strokeDashoffset=this._progressToOffset(t);var e,i=this._opts.step;h.isFunction(i)&&(e=this._easing(this._opts.easing),i(this._calculateTo(t,e),this._opts.shape||this,this._opts.attachment))},n.prototype.stop=function(){this._stopTween(),this.path.style.strokeDashoffset=this._getComputedDashOffset()},n.prototype.animate=function(t,i,e){i=i||{},h.isFunction(i)&&(e=i,i={});var n=h.extend({},i),r=h.extend({},this._opts);i=h.extend(r,i);var o=this._easing(i.easing),r=this._resolveFromAndTo(t,o,n);this.stop(),this.path.getBoundingClientRect();var n=this._getComputedDashOffset(),t=this._progressToOffset(t),s=this;this._tweenable=new a,this._tweenable.tween({from:h.extend({offset:n},r.from),to:h.extend({offset:t},r.to),duration:i.duration,easing:o,step:function(t){s.path.style.strokeDashoffset=t.offset;var e=i.shape||s;i.step(t,e,i.attachment)},finish:function(t){h.isFunction(e)&&e()}})},n.prototype._getComputedDashOffset=function(){var t=window.getComputedStyle(this.path,null);return parseFloat(t.getPropertyValue("stroke-dashoffset"),10)},n.prototype._progressToOffset=function(t){var e=this.path.getTotalLength();return e-t*e},n.prototype._resolveFromAndTo=function(t,e,i){return i.from&&i.to?{from:i.from,to:i.to}:{from:this._calculateFrom(e),to:this._calculateTo(t,e)}},n.prototype._calculateFrom=function(t){return a.interpolate(this._opts.from,this._opts.to,this.value(),t)},n.prototype._calculateTo=function(t,e){return a.interpolate(this._opts.from,this._opts.to,t,e)},n.prototype._stopTween=function(){null!==this._tweenable&&(this._tweenable.stop(),this._tweenable=null)},n.prototype._easing=function(t){return r.hasOwnProperty(t)?r[t]:t},e.exports=n},{"./utils":9,shifty:1}],6:[function(t,e,i){function n(t,e){this._pathTemplate="M 50,50 m -{radius},0 a {radius},{radius} 0 1 1 {2radius},0",this.containerAspectRatio=2,r.apply(this,arguments)}var r=t("./shape"),o=t("./circle"),s=t("./utils");((n.prototype=new r).constructor=n).prototype._initializeSvg=function(t,e){t.setAttribute("viewBox","0 0 100 50")},n.prototype._initializeTextContainer=function(t,e,i){t.text.style&&(i.style.top="auto",i.style.bottom="0",t.text.alignToBottom?s.setStyle(i,"transform","translate(-50%, 0)"):s.setStyle(i,"transform","translate(-50%, 50%)"))},n.prototype._pathString=o.prototype._pathString,n.prototype._trailString=o.prototype._trailString,e.exports=n},{"./circle":2,"./shape":7,"./utils":9}],7:[function(t,e,i){function n(t,e){if(!(this instanceof n))throw new Error("Constructor was called without new keyword");if(0!==arguments.length){this._opts=o.extend({color:"#555",strokeWidth:1,trailColor:null,trailWidth:null,fill:null,text:{style:{color:null,position:"absolute",left:"50%",top:"50%",padding:0,margin:0,transform:{prefix:!0,value:"translate(-50%, -50%)"}},autoStyleContainer:!0,alignToBottom:!0,value:null,className:"progressbar-text"},svgStyle:{display:"block",width:"100%"},warnings:!1},e,!0),o.isObject(e)&&void 0!==e.svgStyle&&(this._opts.svgStyle=e.svgStyle),o.isObject(e)&&o.isObject(e.text)&&void 0!==e.text.style&&(this._opts.text.style=e.text.style);var i=this._createSvgView(this._opts),e=o.isString(t)?document.querySelector(t):t;if(!e)throw new Error("Container does not exist: "+t);this._container=e,this._container.appendChild(i.svg),this._opts.warnings&&this._warnContainerAspectRatio(this._container),this._opts.svgStyle&&o.setStyles(i.svg,this._opts.svgStyle),this.svg=i.svg,this.path=i.path,this.trail=i.trail,this.text=null;e=o.extend({attachment:void 0,shape:this},this._opts);this._progressPath=new r(i.path,e),o.isObject(this._opts.text)&&null!==this._opts.text.value&&this.setText(this._opts.text.value)}}var r=t("./path"),o=t("./utils"),s="Object is destroyed";n.prototype.animate=function(t,e,i){if(null===this._progressPath)throw new Error(s);this._progressPath.animate(t,e,i)},n.prototype.stop=function(){if(null===this._progressPath)throw new Error(s);void 0!==this._progressPath&&this._progressPath.stop()},n.prototype.destroy=function(){if(null===this._progressPath)throw new Error(s);this.stop(),this.svg.parentNode.removeChild(this.svg),this.svg=null,this.path=null,this.trail=null,(this._progressPath=null)!==this.text&&(this.text.parentNode.removeChild(this.text),this.text=null)},n.prototype.set=function(t){if(null===this._progressPath)throw new Error(s);this._progressPath.set(t)},n.prototype.value=function(){if(null===this._progressPath)throw new Error(s);return void 0===this._progressPath?0:this._progressPath.value()},n.prototype.setText=function(t){if(null===this._progressPath)throw new Error(s);null===this.text&&(this.text=this._createTextContainer(this._opts,this._container),this._container.appendChild(this.text)),o.isObject(t)?(o.removeChildren(this.text),this.text.appendChild(t)):this.text.innerHTML=t},n.prototype._createSvgView=function(t){var e=document.createElementNS("http://www.w3.org/2000/svg","svg");this._initializeSvg(e,t);var i=null;(t.trailColor||t.trailWidth)&&(i=this._createTrail(t),e.appendChild(i));t=this._createPath(t);return e.appendChild(t),{svg:e,path:t,trail:i}},n.prototype._initializeSvg=function(t,e){t.setAttribute("viewBox","0 0 100 100")},n.prototype._createPath=function(t){var e=this._pathString(t);return this._createPathElement(e,t)},n.prototype._createTrail=function(t){var e=this._trailString(t),t=o.extend({},t);return t.trailColor||(t.trailColor="#eee"),t.trailWidth||(t.trailWidth=t.strokeWidth),t.color=t.trailColor,t.strokeWidth=t.trailWidth,t.fill=null,this._createPathElement(e,t)},n.prototype._createPathElement=function(t,e){var i=document.createElementNS("http://www.w3.org/2000/svg","path");return i.setAttribute("d",t),i.setAttribute("stroke",e.color),i.setAttribute("stroke-width",e.strokeWidth),e.fill?i.setAttribute("fill",e.fill):i.setAttribute("fill-opacity","0"),i},n.prototype._createTextContainer=function(t,e){var i=document.createElement("div");i.className=t.text.className;var n=t.text.style;return n&&(t.text.autoStyleContainer&&(e.style.position="relative"),o.setStyles(i,n),n.color||(i.style.color=t.color)),this._initializeTextContainer(t,e,i),i},n.prototype._initializeTextContainer=function(t,e,i){},n.prototype._pathString=function(t){throw new Error("Override this function for each progress bar")},n.prototype._trailString=function(t){throw new Error("Override this function for each progress bar")},n.prototype._warnContainerAspectRatio=function(t){var e;this.containerAspectRatio&&(e=window.getComputedStyle(t,null),t=parseFloat(e.getPropertyValue("width"),10),e=parseFloat(e.getPropertyValue("height"),10),o.floatEquals(this.containerAspectRatio,t/e))},e.exports=n},{"./path":5,"./utils":9}],8:[function(t,e,i){function n(t,e){this._pathTemplate="M 0,{halfOfStrokeWidth} L {width},{halfOfStrokeWidth} L {width},{width} L {halfOfStrokeWidth},{width} L {halfOfStrokeWidth},{strokeWidth}",this._trailTemplate="M {startMargin},{halfOfStrokeWidth} L {width},{halfOfStrokeWidth} L {width},{width} L {halfOfStrokeWidth},{width} L {halfOfStrokeWidth},{halfOfStrokeWidth}",r.apply(this,arguments)}var r=t("./shape"),o=t("./utils");((n.prototype=new r).constructor=n).prototype._pathString=function(t){var e=100-t.strokeWidth/2;return o.render(this._pathTemplate,{width:e,strokeWidth:t.strokeWidth,halfOfStrokeWidth:t.strokeWidth/2})},n.prototype._trailString=function(t){var e=100-t.strokeWidth/2;return o.render(this._trailTemplate,{width:e,strokeWidth:t.strokeWidth,halfOfStrokeWidth:t.strokeWidth/2,startMargin:t.strokeWidth/2-t.trailWidth/2})},e.exports=n},{"./shape":7,"./utils":9}],9:[function(t,e,i){var o="Webkit Moz O ms".split(" ");function n(t,e,i){for(var n=t.style,r=0;r<o.length;++r)n[o[r]+s(e)]=i;n[e]=i}function s(t){return t.charAt(0).toUpperCase()+t.slice(1)}function a(t){return"[object Array]"!==Object.prototype.toString.call(t)&&("object"==typeof t&&!!t)}function r(t,e){for(var i in t)t.hasOwnProperty(i)&&e(t[i],i)}e.exports={extend:function t(e,i,n){for(var r in e=e||{},n=n||!1,i=i||{}){var o,s;i.hasOwnProperty(r)&&(o=e[r],s=i[r],n&&a(o)&&a(s)?e[r]=t(o,s,n):e[r]=s)}return e},render:function(t,e){var i,n,r,o=t;for(i in e)e.hasOwnProperty(i)&&(n=e[i],r=new RegExp("\\{"+i+"\\}","g"),o=o.replace(r,n));return o},setStyle:n,setStyles:function(i,t){r(t,function(t,e){null!=t&&(a(t)&&!0===t.prefix?n(i,e,t.value):i.style[e]=t)})},capitalize:s,isString:function(t){return"string"==typeof t||t instanceof String},isFunction:function(t){return"function"==typeof t},isObject:a,forEachObject:r,floatEquals:function(t,e){return Math.abs(t-e)<.001},removeChildren:function(t){for(;t.firstChild;)t.removeChild(t.firstChild)}}},{}]},{},[4])(4)});var b=(S.getInstance=function(t){if(!S.instance){if(!t)throw new Error("Can not create new SplashLoader instance without options!");S.instance=new S(t)}return S.instance},S.prototype.create=function(){return l(this,void 0,void 0,function(){var n,r,o,s;return p(this,function(t){switch(t.label){case 0:return n="\n        #h5branding-center {\n            position: absolute;\n            top: 45%;\n            left: 50%;\n            transform: translate(-50%, -20%);\n            text-align: center;\n            width: 100%;\n        }\n        #h5branding-wrapper {\n            position: relative;\n            z-index: 665;\n            width: 150px;\n            height: 150px;\n            display:inline-block;\n            margin: 35px 40px 96px 40px;\n        }\n\n        #h5branding-version {\n            position: absolute;\n            right: 10px;\n            font-family: Helvetica, Arial, sans-serif;\n            color: #ffffff;\n            font-size: 0.8em;\n            top: 10px;\n            display: none;\n        }\n\n        #h5branding-wrapper > #h5branding-bar, #h5branding-wrapper > img {\n            box-shadow: inset 10px 10px 20px 5px rgba(0, 0, 0, 0.5);\n            border-radius: 50%;\n            position: absolute;\n            top: 0;\n            left: 0;\n            width: 100%;\n            height: 100%;\n        }\n\n        #h5branding-ad {\n            position: relative;\n            z-index: 667;\n            border-radius: 5px;\n            border: 3px solid white;\n            background: rgba(256, 256, 256, 0.2);\n            width: 336px;\n            height: 280px;\n            display: none;\n            margin: 0px 10px 0px 10px;\n        }\n\n        #h5branding-wrapper > img {\n            /* Needs appropriate vendor prefixes */\n            box-sizing: border-box;\n\n            /* This needs to be equal to strokeWidth */\n            padding: 4%;\n        }\n\n        #h5branding-wrapper > img {\n            border-radius: 50%;\n            box-shadow: inset 0 5px 5px rgba(0, 0, 0, 0.5), 5px 5px 7px rgba(0, 0, 0, 0.3);\n        }\n\n        #h5branding-container {\n            box-sizing: border-box;\n            position: absolute;\n            z-index: 664;\n            top: 0;\n            left: 0;\n            width: 100%;\n            height: 100%;\n            background-color: #000;\n            overflow: hidden;\n        }\n\n        #h5branding-background {\n            position: absolute;\n            top: -25%;\n            left: -25%;\n            width: 150%;\n            height: 150%;\n            background-blend-mode: multiply;\n            background-size: cover;\n            filter: blur(40px) brightness(1.5);\n        }\n\n        @media all and (-ms-high-contrast: none), (-ms-high-contrast: active) {\n             /* IE10+ CSS styles go here */\n             #h5branding-background {\n                background-image: none !important;\n             }\n        }\n\n        #h5branding-logo {\n            position: absolute;\n            margin: 0 auto;\n            left: 0;\n            right: 0;\n            text-align: center;\n            top: 10%;\n        }\n\n        #h5branding-logo > img {\n            height: 150px;\n        }\n\n        #h5branding-title {\n            position: absolute;\n            width: 100%;\n            background: linear-gradient(90deg, transparent, rgba(0, 0, 0, 0.5) 50%, transparent);\n            color: #fff;\n            text-shadow: 0 0 1px rgba(0, 0, 0, 0.7);\n            bottom:10%;\n            padding: 15px 0;\n            text-align: center;\n            font-size: 18px;\n            font-family: Helvetica, Arial, sans-serif;\n            font-weight: bold;\n            line-height: 100%;\n        }\n\n        #h5branding-button {\n            /* border: 0; */\n            padding: 10px 22px;\n            border-radius: 5px;\n            border: 3px solid white;\n            background: linear-gradient(0deg, #dddddd, #ffffff);\n            color: #222;\n            text-transform: uppercase;\n            text-shadow: 0 0 1px #fff;\n            font-family: Helvetica, Arial, sans-serif;\n            font-weight: bold;\n            font-size: 18px;\n            cursor: pointer;\n            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.3);\n            display: none;\n            width: 150px;\n            position: absolute;\n            top: 170px;\n            margin: 0 auto;\n            left: 0;\n            right: 0;\n        }\n\n        @media (orientation: portrait) and (max-width: 1080px) {\n            #h5branding-logo > img {\n                height: initial;\n                width:100%;\n            }\n        }\n\n        @media (orientation: landscape) and (max-height: 640px) {\n            #h5branding-title {\n                display: none;\n            }\n\n            #h5branding-logo > img {\n                height: 100px;\n            }\n        }\n\n        @media (orientation: landscape) and (max-height: 460px) {\n            #h5branding-title {\n                display: none;\n            }\n\n            #h5branding-wrapper {\n                width: 110px;\n                height: 110px;\n                margin: 0;\n            }\n\n            #h5branding-logo {\n                top: 0;\n                transform: scale(0.7, 0.7);\n            }\n\n            #h5branding-button {\n                top: initial;\n                width: 110px;\n                font-size: 14px;\n                position: absolute;\n                top: 140px;\n                left: 0;\n                right: 0;\n            }\n\n            #h5branding-ad {\n               display: none !important;\n            }\n        }\n\n        @media (orientation: portrait) and (max-width: 250px) {\n            #h5branding-logo {\n                top: 2%;\n            }\n        }\n\n        @media (orientation: landscape) and (max-width: 330px) {\n             #h5branding-button {\n                top: 120px;\n            }\n\n            #h5branding-logo > img {\n                height: 70px;\n            }\n        }\n\n        @media (max-width: 600px) and (max-height: 850px) {\n            #h5branding-ad {\n               display: none !important;\n            }\n        }\n\n        @media (max-width: 600px) and (max-height: 1100px) {\n            #h5branding-center {\n                top: 40%;\n            }\n\n            #h5branding-title {\n               bottom: 5%\n            }\n        }\n\n        @media (max-width: 600px) and (max-height: 900px) {\n            #h5branding-title {\n               display: none\n            }\n        }\n\n        @media (orientation: landscape) and (min-width: 800px) {\n            #h5branding-wrapper {\n                margin-left: 120px;\n                margin-right: 120px;\n            }\n        }\n\n        ",e=this.getGameLogoUrl(),i=this.options.gameTitle,s='\n        <div id="h5branding-background"></div>\n        <div id="h5branding-version"></div>\n        <div id="h5branding-logo"></div>\n        <div id="h5branding-center">\n            <div id="h5branding-ad"></div>\n            <div id="h5branding-wrapper">\n                <img src="'.concat(e,'" />\n                <div id="h5branding-bar"></div>\n                <button id="h5branding-button" onclick="h5branding.SplashLoader.getInstance().onPlayButtonClick();">Play</button>\n            </div>\n        </div>\n        <div id="h5branding-title">').concat(i,"</div>\n    "),r=document.head||document.getElementsByTagName("head")[0],(o=document.createElement("style")).type="text/css",o.styleSheet?o.styleSheet.cssText=n:o.appendChild(document.createTextNode(n)),r.appendChild(o),(o=document.createElement("div")).innerHTML=s,o.id="h5branding-container",(s=document.body||document.getElementsByTagName("body")[0]).insertBefore(o,s.firstChild),this.circleLoader=new z.Circle("#h5branding-bar",{strokeWidth:3,color:this.options.barColor}),(s=document.getElementById("h5branding-version"))&&(s.innerHTML=this.options.version),[4,this.loadLibs()];case 1:return t.sent(),[4,v.loadHost()];case 2:return t.sent(),[4,this.loadBranding()];case 3:return t.sent(),this.loaded=!0,[2]}var e,i})})},S.prototype.loadBranding=function(){return l(this,void 0,void 0,function(){var e,i;return p(this,function(t){switch(t.label){case 0:return[4,f.preload(Date.now().toString())];case 1:return t.sent(),(i=document.getElementById("h5branding-background"))&&(i.style.backgroundColor=f.brandingBackgroundColor),(e=document.getElementById("h5branding-logo"))&&v.getBrandingDomain()!==o.BrandingDomain.Neutral&&((i=document.createElement("img")).src=f.brandingLogoUrl.replace("_small",""),e.appendChild(i)),[2]}})})},S.prototype.loadLibs=function(){var i=this,n=this.options.libs.map(function(t,e){return a.instance.loadScript(t,!0,function(){i.setScriptloadProgress(n.length,e+1)})});return Promise.all(n)},Object.defineProperty(S.prototype,"bannerAllowed",{get:function(){var t=document.body.clientWidth,e=document.body.clientHeight;return this.progress<100&&!(e<t&&e<=460)&&!(t<600&&e<850)},enumerable:!1,configurable:!0}),S.prototype.showBanner=function(){if(!this.bannerAllowed)return null;var t=document.getElementById("h5branding-ad");return t?(t.style.display="inline-flex",t):null},S.prototype.setScriptloadProgress=function(t,e){this.circleLoader.animate(.3*e/t,null,function(){})},S.prototype.setLoadProgress=function(t){var e,i=this;this.loaded&&(100===(this.progress=t=30+.7*t)?(e=document.querySelector("#h5branding-button"),this.circleLoader.animate(1,null,function(){h5branding.SplashLoader.getInstance().onPlayButtonClick();!v.inGDGameZone()&&e&&!0===i.showPlayButton?e.style.display="block":!v.inGDGameZone()&&!1!==i.showPlayButton||i.onPlayButtonClick()})):this.circleLoader.animate(t/100,null,function(){}))},S.prototype.setButtonCallback=function(t){this.buttonCallback=t},S.prototype.onPlayButtonClick=function(){this.buttonCallback&&this.buttonCallback()},S.prototype.destroy=function(){var t=document.querySelector("#h5branding-container");null!==t&&null!==t.parentNode&&t.parentNode.removeChild(t)},S.prototype.getGameLogoUrl=function(){return"assets/icon.jpeg"},S);function S(t){this.circleLoader=null,this.loaded=!1,this.showPlayButton="undefined"==typeof playBtn||playBtn,this.progress=0,this.options={gameId:"12346",gameTitle:"Place Holder",gameName:"place-holder",libs:[],version:"dev",barColor:"white",gaMeasurementId:"none"},this.options.gameId=t.gameId,this.options.gameTitle=t.gameTitle,this.options.version=t.version,this.options.barColor=t.barColor||this.options.barColor,this.options.libs=t.libs,this.options.gaMeasurementId=t.gaMeasurementId}o.Branding=f,o.Domain=n,o.Hosts=u,o.SplashLoader=b,o.Utils=v,Object.defineProperty(o,"__esModule",{value:!0})}),function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports):"function"==typeof define&&define.amd?define(["exports"],e):e(t.h5ads=t.h5ads||{})}(this,function(r){"use strict";var i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};var n,t=(function(t){var n=Object.prototype.hasOwnProperty,c="~";function i(){}function o(t,e,i){this.fn=t,this.context=e,this.once=i||!1}function r(t,e,i,n,r){if("function"!=typeof i)throw new TypeError("The listener must be a function");r=new o(i,n||t,r),e=c?c+e:e;return t._events[e]?t._events[e].fn?t._events[e]=[t._events[e],r]:t._events[e].push(r):(t._events[e]=r,t._eventsCount++),t}function h(t,e){0==--t._eventsCount?t._events=new i:delete t._events[e]}function e(){this._events=new i,this._eventsCount=0}Object.create&&(i.prototype=Object.create(null),(new i).__proto__||(c=!1)),e.prototype.eventNames=function(){var t,e,i=[];if(0===this._eventsCount)return i;for(e in t=this._events)n.call(t,e)&&i.push(c?e.slice(1):e);return Object.getOwnPropertySymbols?i.concat(Object.getOwnPropertySymbols(t)):i},e.prototype.listeners=function(t){var t=c?c+t:t,e=this._events[t];if(!e)return[];if(e.fn)return[e.fn];for(var i=0,n=e.length,r=new Array(n);i<n;i++)r[i]=e[i].fn;return r},e.prototype.listenerCount=function(t){t=c?c+t:t,t=this._events[t];return t?t.fn?1:t.length:0},e.prototype.emit=function(t,e,i,n,r,o){var s=c?c+t:t;if(!this._events[s])return!1;var a,h=this._events[s],l=arguments.length;if(h.fn){switch(h.once&&this.removeListener(t,h.fn,void 0,!0),l){case 1:return h.fn.call(h.context),!0;case 2:return h.fn.call(h.context,e),!0;case 3:return h.fn.call(h.context,e,i),!0;case 4:return h.fn.call(h.context,e,i,n),!0;case 5:return h.fn.call(h.context,e,i,n,r),!0;case 6:return h.fn.call(h.context,e,i,n,r,o),!0}for(d=1,a=new Array(l-1);d<l;d++)a[d-1]=arguments[d];h.fn.apply(h.context,a)}else for(var p,u=h.length,d=0;d<u;d++)switch(h[d].once&&this.removeListener(t,h[d].fn,void 0,!0),l){case 1:h[d].fn.call(h[d].context);break;case 2:h[d].fn.call(h[d].context,e);break;case 3:h[d].fn.call(h[d].context,e,i);break;case 4:h[d].fn.call(h[d].context,e,i,n);break;default:if(!a)for(p=1,a=new Array(l-1);p<l;p++)a[p-1]=arguments[p];h[d].fn.apply(h[d].context,a)}return!0},e.prototype.on=function(t,e,i){return r(this,t,e,i,!1)},e.prototype.once=function(t,e,i){return r(this,t,e,i,!0)},e.prototype.removeListener=function(t,e,i,n){t=c?c+t:t;if(!this._events[t])return this;if(!e)return h(this,t),this;var r=this._events[t];if(r.fn)r.fn!==e||n&&!r.once||i&&r.context!==i||h(this,t);else{for(var o=0,s=[],a=r.length;o<a;o++)(r[o].fn!==e||n&&!r[o].once||i&&r[o].context!==i)&&s.push(r[o]);s.length?this._events[t]=1===s.length?s[0]:s:h(this,t)}return this},e.prototype.removeAllListeners=function(t){return t?(t=c?c+t:t,this._events[t]&&h(this,t)):(this._events=new i,this._eventsCount=0),this},e.prototype.off=e.prototype.removeListener,e.prototype.addListener=e.prototype.on,e.prefixed=c,t.exports=e.EventEmitter=e}(P={exports:{}}),P.exports);(v=n=n||{})[v.AdMob=0]="AdMob",v[v.MoPub=1]="MoPub",v[v.Chartboost=2]="Chartboost",v[v.Heyzap=3]="Heyzap";var e=(o.prototype.setManager=function(t){this.adManager=t,this.adManager.emit(r.AdEvents.AD_PROVIDER_LOADED)},o.prototype.showAd=function(t){if(this.adsEnabled){if(t===r.AdType.banner){if(!this.bannerShowable||null===this.banner)return;this.adManager.emit(r.AdEvents.BANNER_SHOWN,this.banner.width,this.banner.height),this.adManager.bannerActive=!0,this.banner.show()}if(t===r.AdType.interstitial){if(!this.interstitialShowable||null===this.interstitial)return void this.adManager.emit(r.AdEvents.CONTENT_RESUMED,r.AdType.interstitial);this.interstitial.show()}t===r.AdType.rewarded&&(this.insentiveShowable&&null!==this.insentive?this.insentive.show():this.adManager.emit(r.AdEvents.CONTENT_RESUMED,r.AdType.rewarded))}else t!==r.AdType.banner&&this.adManager.emit(r.AdEvents.CONTENT_RESUMED)},o.prototype.adAvailable=function(t){return!0},o.prototype.preloadAd=function(t,e,i){var n=this;this.adsEnabled&&(this.destroyAd(t),t===r.AdType.banner&&(this.banner=this.cocoonProvider.createBanner(e),i&&this.banner.setLayout(i),this.banner.on("load",function(){n.bannerShowable=!0}),this.banner.on("fail",function(){n.bannerShowable=!1,n.banner=null}),this.banner.on("click",function(){n.adManager.emit(r.AdEvents.AD_CLICKED,r.AdType.banner)}),this.banner.on("show",function(){}),this.banner.on("dismiss",function(){}),this.banner.load()),t===r.AdType.interstitial&&(this.interstitial=this.cocoonProvider.createInterstitial(e),this.interstitial.on("load",function(){n.interstitialShowable=!0}),this.interstitial.on("fail",function(){n.interstitialShowable=!1,n.interstitial=null}),this.interstitial.on("click",function(){n.adManager.emit(r.AdEvents.AD_CLICKED,r.AdType.interstitial)}),this.interstitial.on("show",function(){n.adManager.emit(r.AdEvents.CONTENT_PAUSED,r.AdType.interstitial)}),this.interstitial.on("dismiss",function(){n.adManager.emit(r.AdEvents.CONTENT_RESUMED,r.AdType.interstitial),n.interstitialShowable=!1,n.interstitial=null}),this.interstitial.load()),t===r.AdType.rewarded&&(this.insentive=this.cocoonProvider.createRewardedVideo(e),this.insentive.on("load",function(){n.insentiveShowable=!0}),this.insentive.on("fail",function(){n.insentiveShowable=!1,n.insentive=null}),this.insentive.on("click",function(){n.adManager.emit(r.AdEvents.AD_CLICKED,r.AdType.rewarded)}),this.insentive.on("show",function(){n.adManager.emit(r.AdEvents.CONTENT_PAUSED,r.AdType.rewarded)}),this.insentive.on("dismiss",function(){n.adManager.emit(r.AdEvents.CONTENT_RESUMED,r.AdType.rewarded),n.insentiveShowable=!1,n.insentive=null}),this.insentive.on("reward",function(){n.adManager.emit(r.AdEvents.AD_REWARDED,r.AdType.rewarded),n.insentiveShowable=!1,n.insentive=null}),this.insentive.load()))},o.prototype.destroyAd=function(t){if(this.adsEnabled){if(t===r.AdType.banner&&null!==this.banner){try{this.cocoonProvider.releaseBanner(this.banner)}catch(t){}this.banner=null,this.bannerShowable=!1}t===r.AdType.interstitial&&null!==this.interstitial&&(this.cocoonProvider.releaseInterstitial(this.interstitial),this.interstitial=null,this.interstitialShowable=!1)}},o.prototype.hideAd=function(t){this.adsEnabled&&(t===r.AdType.interstitial&&null!==this.interstitial&&this.interstitial.hide(),t===r.AdType.banner&&null!==this.banner&&(this.adManager.bannerActive&&(this.adManager.bannerActive=!1,this.adManager.emit(r.AdEvents.BANNER_HIDDEN,this.banner.width,this.banner.height)),this.banner.hide()),t===r.AdType.rewarded&&null!==this.insentive&&this.insentive.hide())},o);function o(t,e){if(this.adsEnabled=!1,this.bannerShowable=!1,this.interstitialShowable=!1,this.insentiveShowable=!1,Cocoon&&Cocoon.Ad){switch(this.adsEnabled=!0,t){default:case n.AdMob:this.cocoonProvider=Cocoon.Ad.AdMob;break;case n.Chartboost:this.cocoonProvider=Cocoon.Ad.Chartboost;break;case n.Heyzap:this.cocoonProvider=Cocoon.Ad.Heyzap;break;case n.MoPub:this.cocoonProvider=Cocoon.Ad.MoPub}this.cocoonProvider.configure(e)}}var s=(a.prototype.setAdListeners=function(){var e=this;cordova.plugins.gdApi.setAdListener(function(t){switch(t.event){case"BANNER_STARTED":e.adManager.emit(r.AdEvents.CONTENT_PAUSED);break;case"API_IS_READY":e.adsEnabled=!0;break;case"API_ALREADY_INITIALIZED":break;case"BANNER_CLOSED":case"API_NOT_READY":case"BANNER_FAILED":e.adManager.emit(r.AdEvents.CONTENT_RESUMED)}},function(t){e.adsEnabled=!1})},a.prototype.setManager=function(t){this.adManager=t,this.adManager.emit(r.AdEvents.AD_PROVIDER_LOADED)},a.prototype.showAd=function(t){var e=this;this.adsEnabled?cordova.plugins.gdApi.showBanner(function(t){},function(t){e.adManager.emit(r.AdEvents.CONTENT_RESUMED)}):this.adManager.emit(r.AdEvents.CONTENT_RESUMED)},a.prototype.adAvailable=function(t){return!0},a.prototype.preloadAd=function(t){},a.prototype.destroyAd=function(t){},a.prototype.hideAd=function(t){},a);function a(t,e,i){void 0===i&&(i=!1),this.adsEnabled=!1,void 0===cordova.plugins||void 0!==cordova.plugins&&void 0===cordova.plugins.gdApi||(i&&cordova.plugins.gdApi.enableTestAds(),this.setAdListeners(),cordova.plugins.gdApi.init([t,e],function(t){},function(t){}))}var h=(l.prototype.setManager=function(t){this.adManager=t},l.prototype.showAd=function(t){if(void 0===t&&(t=r.AdType.interstitial),"undefined"!=typeof gamedockSDK)switch(t){case r.AdType.interstitial:this.adManager.emit(r.AdEvents.CONTENT_PAUSED),gamedockSDK.requestInterstitial();break;case r.AdType.rewarded:if(!this.adAvailable(r.AdType.rewarded)){this.resumeGameplay();break}this.adManager.emit(r.AdEvents.CONTENT_PAUSED),this.rewardedChanged(!1),gamedockSDK.playRewardVideo();break;default:this.resumeGameplay()}},l.prototype.interstitalAvailable=function(){"undefined"!=typeof gamedockSDK&&gamedockSDK.playInterstitial()},l.prototype.rewardVideoFinished=function(t){switch(t){case"dismiss":this.resumeGameplay();break;case"close":this.adManager.emit(r.AdEvents.AD_REWARDED)}},l.prototype.resumeGameplay=function(){this.adManager.emit(r.AdEvents.CONTENT_RESUMED)},l.prototype.preloadAd=function(t){if(void 0===t&&(t=r.AdType.interstitial),"undefined"!=typeof gamedockSDK&&t===r.AdType.rewarded)this.rewardedLoaded||gamedockSDK.requestRewardVideo()},l.prototype.destroyAd=function(){},l.prototype.hideAd=function(){},l.prototype.adAvailable=function(t){return t===r.AdType.rewarded&&this.rewardedLoaded},l.prototype.rewardedChanged=function(t){this.rewardedLoaded=t},l);function l(){var e=this;this.adsEnabled=!1,this.rewardedLoaded=!1,"undefined"!=typeof gamedockSDK&&(gamedockSDK.on("PrivacyPolicyStatus",function(t){e.adManager.emit(r.AdEvents.AD_PROVIDER_LOADED)}),gamedockSDK.initialise(!1,{shouldBlock:!0,requiredAge:12},!0,"PRODUCTION",[]),gamedockSDK.on("AdAvailable",function(t){switch(t.type){case"interstitial":e.interstitalAvailable();break;case"rewardVideo":e.rewardedChanged(!0);break;case"banner":throw new Error("Not yet implemented.")}}),gamedockSDK.on("AdNotAvailable",function(t){switch(t.type){case"interstitial":case"rewardVideo":e.resumeGameplay();break;case"banner":throw new Error("Not yet implemented.")}}),gamedockSDK.on("AdFinished",function(t){switch(t.type){case"interstitial":e.resumeGameplay();break;case"rewardVideo":e.rewardVideoFinished(t.reason);break;case"banner":throw new Error("Not yet implemented.")}}))}var p=(u.prototype.setManager=function(t){this.adManager=t,this.adManager.emit(r.AdEvents.AD_PROVIDER_LOADED)},u.prototype.showAd=function(t,e){var i=this;switch(this.adsEnabled||this.adManager.emit(r.AdEvents.CONTENT_RESUMED),t){case r.AdType.interstitial:HeyzapAds.InterstitialAd.addEventListener(HeyzapAds.InterstitialAd.Events.HIDE,function(){i.adManager.emit(r.AdEvents.CONTENT_RESUMED,HeyzapAds.InterstitialAd.Events.HIDE)}),HeyzapAds.InterstitialAd.addEventListener(HeyzapAds.InterstitialAd.Events.SHOW_FAILED,function(){i.adManager.emit(r.AdEvents.CONTENT_RESUMED,HeyzapAds.InterstitialAd.Events.SHOW_FAILED)}),HeyzapAds.InterstitialAd.addEventListener(HeyzapAds.InterstitialAd.Events.CLICKED,function(){i.adManager.emit(r.AdEvents.AD_CLICKED,HeyzapAds.InterstitialAd.Events.CLICKED)}),HeyzapAds.InterstitialAd.show().then(function(){i.adManager.emit(r.AdEvents.CONTENT_PAUSED)},function(t){i.adManager.emit(r.AdEvents.CONTENT_RESUMED)});break;case r.AdType.interstitial:HeyzapAds.VideoAd.addEventListener(HeyzapAds.VideoAd.Events.HIDE,function(){i.adManager.emit(r.AdEvents.CONTENT_RESUMED,HeyzapAds.VideoAd.Events.HIDE)}),HeyzapAds.VideoAd.addEventListener(HeyzapAds.VideoAd.Events.SHOW_FAILED,function(){i.adManager.emit(r.AdEvents.CONTENT_RESUMED,HeyzapAds.VideoAd.Events.SHOW_FAILED)}),HeyzapAds.VideoAd.addEventListener(HeyzapAds.VideoAd.Events.CLICKED,function(){i.adManager.emit(r.AdEvents.AD_CLICKED,HeyzapAds.VideoAd.Events.CLICKED)}),HeyzapAds.VideoAd.show().then(function(){i.adManager.emit(r.AdEvents.CONTENT_PAUSED)},function(t){i.adManager.emit(r.AdEvents.CONTENT_RESUMED)});break;case r.AdType.rewarded:HeyzapAds.IncentivizedAd.addEventListener(HeyzapAds.IncentivizedAd.Events.HIDE,function(){i.adManager.emit(r.AdEvents.CONTENT_RESUMED,HeyzapAds.IncentivizedAd.Events.HIDE)}),HeyzapAds.IncentivizedAd.addEventListener(HeyzapAds.IncentivizedAd.Events.SHOW_FAILED,function(){i.adManager.emit(r.AdEvents.CONTENT_RESUMED,HeyzapAds.IncentivizedAd.Events.SHOW_FAILED)}),HeyzapAds.IncentivizedAd.addEventListener(HeyzapAds.IncentivizedAd.Events.CLICKED,function(){i.adManager.emit(r.AdEvents.AD_CLICKED,HeyzapAds.IncentivizedAd.Events.CLICKED)}),HeyzapAds.IncentivizedAd.show().then(function(){i.adManager.emit(r.AdEvents.CONTENT_PAUSED)},function(t){i.adManager.emit(r.AdEvents.CONTENT_RESUMED)});break;case r.AdType.banner:if(void 0===e)return;HeyzapAds.BannerAd.show(e).then(function(){},function(t){})}},u.prototype.adAvailable=function(t){return!0},u.prototype.preloadAd=function(t){this.adsEnabled&&t===r.AdType.rewarded&&HeyzapAds.IncentivizedAd.fetch().then(function(){},function(t){})},u.prototype.destroyAd=function(t){this.adsEnabled&&t===r.AdType.banner&&HeyzapAds.BannerAd.destroy().then(function(){},function(t){})},u.prototype.hideAd=function(t){this.adsEnabled&&t===r.AdType.banner&&HeyzapAds.BannerAd.hide().then(function(){},function(t){})},u);function u(t){var e=this;this.adsEnabled=!1,this.adsEnabled=!0,HeyzapAds.start(t).then(function(){},function(t){e.adsEnabled=!1})}var d,c=(y.prototype.setManager=function(t){this.adManager=t,this.adManager.emit(r.AdEvents.AD_PROVIDER_LOADED)},y.prototype.showAd=function(t){switch(t=void 0===t?r.AdType.interstitial:t){case r.AdType.interstitial:if(!this.interstitialLoaded){this.resumeGameplay();break}this.interstitialChanged(!1),this.adManager.emit(r.AdEvents.CONTENT_PAUSED),IronSourceAds.showInterstitial();break;case r.AdType.rewarded:if(!this.rewardedLoaded){this.resumeGameplay();break}this.adManager.emit(r.AdEvents.CONTENT_PAUSED),IronSourceAds.showRewardedVideo();break;default:this.resumeGameplay()}},y.prototype.resumeGameplay=function(){this.adManager.emit(r.AdEvents.CONTENT_RESUMED)},y.prototype.preloadAd=function(t){(t=void 0===t?r.AdType.interstitial:t)===r.AdType.interstitial&&IronSourceAds.loadInterstitial()},y.prototype.destroyAd=function(){},y.prototype.hideAd=function(){},y.prototype.adAvailable=function(t){switch(t){case r.AdType.interstitial:return this.interstitialLoaded;case r.AdType.rewarded:return this.rewardedLoaded}return!1},y.prototype.interstitialChanged=function(t){this.interstitialLoaded=t},y.prototype.rewardedChanged=function(t){this.rewardedLoaded=t},y);function y(t){var e=this;this.adsEnabled=!1,this.interstitialLoaded=!1,this.rewardedLoaded=!1,"undefined"!=typeof IronSourceAds&&(IronSourceAds.init({appKey:t}),t=function(){return e.resumeGameplay()},window.addEventListener("interstitialClosed",t),window.addEventListener("interstitialShowFailed",t),window.addEventListener("interstitialLoaded",function(){return e.interstitialChanged(!0)}),window.addEventListener("rewardedVideoClosed",t),window.addEventListener("rewardedVideoFailed",t),IronSourceAds.hasRewardedVideo({onSuccess:this.rewardedChanged.bind(this)}),window.addEventListener("rewardedVideoAvailabilityChanged",function(t){return e.rewardedChanged(t.available)}))}(f=d=d||{}).interstitial="interstitial",f.rewarded="rewarded",f.display="display",(P=r.GameDistributionBannerSize||(r.GameDistributionBannerSize={}))[P.LargeRectangle=0]="LargeRectangle",P[P.MediumRectangle=1]="MediumRectangle",P[P.Billboard=2]="Billboard",P[P.Leaderboard=3]="Leaderboard",P[P.Skyscraper=4]="Skyscraper",P[P.WideSkyscraper=5]="WideSkyscraper",(v=r.GameDistributionAlignment||(r.GameDistributionAlignment={}))[v.TopLeft=0]="TopLeft",v[v.TopCenter=1]="TopCenter",v[v.TopRight=2]="TopRight",v[v.CenterLeft=3]="CenterLeft",v[v.Center=4]="Center",v[v.CenterRight=5]="CenterRight",v[v.BottomLeft=6]="BottomLeft",v[v.BottomCenter=7]="BottomCenter",v[v.BottomRight=8]="BottomRight";var _=(m.prototype.loadBanner=function(){return"undefined"==typeof gdsdk?Promise.reject("GD Sdk not available, probably due to adblocker"):gdsdk.showAd(d.display,{containerId:this.element.id})},m.prototype.destroy=function(){document.body.removeChild(this.element),this.resizeListener&&window.removeEventListener("resize",this.resizeListener),delete this.element,delete this.parent,delete this.alignment},m.prototype.alignIn=function(t,e){var i=this;this.parent||(this.parent=t,this.alignment=e,this.resizeListener=function(){return i.resize()},window.addEventListener("resize",this.resizeListener),this.resize())},m.prototype.setOffset=function(t,e){void 0===e&&(e=0),this.offsetX=t=void 0===t?0:t,this.offsetY=e,this.resize()},m.prototype.resize=function(){if(this.parent){var t=this.parent.getBoundingClientRect();switch(this.alignment){case r.GameDistributionAlignment.TopLeft:this.position(t.left,t.top);break;case r.GameDistributionAlignment.TopCenter:this.position(t.left+t.width/2-this.width*this.scaleFactor/2,t.top);break;case r.GameDistributionAlignment.TopRight:this.position(t.left+t.width-this.width*this.scaleFactor,t.top);break;case r.GameDistributionAlignment.CenterLeft:this.position(t.left,t.top+t.height/2-this.height*this.scaleFactor/2);break;case r.GameDistributionAlignment.Center:this.position(t.left+t.width/2-this.width*this.scaleFactor/2,t.top+t.height/2-this.height*this.scaleFactor/2);break;case r.GameDistributionAlignment.CenterRight:this.position(t.left+t.width-this.width*this.scaleFactor,t.top+t.height/2-this.height*this.scaleFactor/2);break;case r.GameDistributionAlignment.BottomLeft:this.position(t.left,t.top+t.height-this.height*this.scaleFactor);break;case r.GameDistributionAlignment.BottomCenter:this.position(t.left+t.width/2-this.width*this.scaleFactor/2,t.top+t.height-this.height*this.scaleFactor);break;case r.GameDistributionAlignment.BottomRight:this.position(t.left+t.width-this.width*this.scaleFactor,t.top+t.height-this.height*this.scaleFactor)}}},m.prototype.setSize=function(t){var e,i;switch(t){default:case r.GameDistributionBannerSize.LargeRectangle:e=336,i=280;break;case r.GameDistributionBannerSize.MediumRectangle:e=300,i=250;break;case r.GameDistributionBannerSize.Billboard:e=970,i=250;break;case r.GameDistributionBannerSize.Leaderboard:e=728,i=90;break;case r.GameDistributionBannerSize.Skyscraper:e=120,i=600;break;case r.GameDistributionBannerSize.WideSkyscraper:e=160,i=600}this.width=e,this.height=i,this.element.style.width=e+"px",this.element.style.height=i+"px"},m.prototype.position=function(t,e){this.element.style.left=t+this.offsetX+"px",this.element.style.top=e+this.offsetY+"px"},m.prototype.scale=function(t){this.element.style.transformOrigin="left top",this.scaleFactor=t,this.element.style.transform="scale("+t+")"},m);function m(){this.scaleFactor=1,this.offsetX=0,this.offsetY=0,this.element=document.createElement("div"),this.element.style.position="absolute",this.element.style.top="0px",this.element.style.left="0px",this.element.id="banner-"+Date.now()+(1e7*Math.random()|0),document.body.appendChild(this.element)}var g,f=(x.prototype.setManager=function(t){this.adManager=t,this.adManager.emit(r.AdEvents.AD_PROVIDER_LOADED)},x.prototype.sdkLoaded=function(){this.adsEnabled=!0},x.prototype.showAd=function(t){var e=this;if(this.adsEnabled){if("undefined"==typeof gdsdk||gdsdk&&void 0===gdsdk.showAd)return this.adsEnabled=!1,void this.adManager.emit(r.AdEvents.CONTENT_RESUMED);gdsdk.showAd(t===r.AdType.rewarded?d.rewarded:d.interstitial).then(function(){t===r.AdType.rewarded&&(e.adManager.emit(r.AdEvents.AD_REWARDED),e.hasRewarded=!1),e.adManager.emit(r.AdEvents.CONTENT_RESUMED)}).catch(function(){t===r.AdType.rewarded&&e.hasRewarded&&(e.hasRewarded=!1),e.adManager.emit(r.AdEvents.CONTENT_RESUMED)})}else this.adManager.emit(r.AdEvents.CONTENT_RESUMED)},x.prototype.createBanner=function(t){if(this.adsEnabled){var e=new _;return e.setSize(t),e}},x.prototype.loadBanner=function(t){if(this.adsEnabled){var e=new _;return e.setSize(t),e.loadBanner(),e}},x.prototype.preloadAd=function(t){var e=this;!this.hasRewarded&&this.adsEnabled&&t===r.AdType.rewarded&&gdsdk.preloadAd(d.rewarded).then(function(){e.hasRewarded=!0,e.adManager.emit(r.AdEvents.AD_LOADED,t)})},x.prototype.adAvailable=function(t){return t!==r.AdType.rewarded||this.hasRewarded},x.prototype.destroyAd=function(){},x.prototype.hideAd=function(){},x.prototype.areAdsEnabled=function(){var t=document.createElement("script");t.id="debug-test-ad",t.src="patch/js/null.js?storage.googleapis.com/cdn.fbrq.io/anyad.js",document.body.appendChild(t);return new Promise(function(t){window.setTimeout(function(){t(function(){var t=!0;if(document.getElementById("az-test-ad")||(t=!1),document.getElementById("debug-test-ad")){var e=document.getElementById("debug-test-ad");try{e.parentNode.removeChild(e)}catch(t){}}if(document.getElementById("az-test-ad")){e=document.getElementById("az-test-ad");try{e.parentNode.removeChild(e)}catch(t){}}return t}())},100)})},x);function x(t){var e,i,n=this;this.adsEnabled=!1,this.hasRewarded=!1,this.adShowing=!1,window.GD_OPTIONS={gameId:t,advertisementSettings:{autoplay:!1},onEvent:function(t){switch(t.name){case"SDK_GAME_PAUSE":n.adManager.emit(r.AdEvents.CONTENT_PAUSED);break;case"SDK_READY":n.sdkLoaded()}}},e=document,i="gamedistribution-jssdk",t=e.getElementsByTagName("script")[0],e.getElementById(i)||((e=e.createElement("script")).id=i,e.src="patch/js/gd-sdk.js?html5.api.gamedistribution.com/main.min.js",t.parentNode&&t.parentNode.insertBefore(e,t))}(P=g=g||{})[P.start=0]="start",P[P.firstQuartile=1]="firstQuartile",P[P.midPoint=2]="midPoint",P[P.thirdQuartile=3]="thirdQuartile",P[P.complete=4]="complete";var v=(w.prototype.setManager=function(t){this.adManager=t,this.adManager.emit(r.AdEvents.AD_PROVIDER_LOADED)},w.prototype.showAd=function(t,e){if(!this.adRequested)if(this.adsEnabled||this.adManager.emit(r.AdEvents.AD_DISABLED,!0),this.googleEnabled){this.adDisplay.initialize();var i=new google.ima.AdsRequest;i.adTagUrl=this.adTagUrl+this.parseCustomParams(e);var n=window.innerWidth,e=window.innerHeight;document.body.clientHeight<window.innerHeight&&(e=document.body.clientHeight,n=document.body.clientWidth),i.linearAdSlotWidth=n,i.linearAdSlotHeight=e,i.nonLinearAdSlotWidth=n,i.nonLinearAdSlotHeight=e,i.forceNonLinearFullSlot=!0;try{this.adRequested=!0,this.adLoader.requestAds(i)}catch(t){this.onContentResumeRequested()}}else this.onContentResumeRequested()},w.prototype.adAvailable=function(t){return!0},w.prototype.preloadAd=function(){},w.prototype.destroyAd=function(){},w.prototype.hideAd=function(){},w.prototype.onAdManagerLoader=function(t){var e=this,i=new google.ima.AdsRenderingSettings;i.restoreCustomPlaybackStateOnAdBreakComplete=!0;var n=t.getAdsManager(this.gameContent,i);(this.adsManager=n).addEventListener(google.ima.AdEvent.Type.CONTENT_PAUSE_REQUESTED,this.onContentPauseRequested,!1,this),n.addEventListener(google.ima.AdEvent.Type.CONTENT_RESUME_REQUESTED,this.onContentResumeRequested,!1,this),n.addEventListener(google.ima.AdErrorEvent.Type.AD_ERROR,this.onAdError,!1,this),[google.ima.AdEvent.Type.ALL_ADS_COMPLETED,google.ima.AdEvent.Type.CLICK,google.ima.AdEvent.Type.COMPLETE,google.ima.AdEvent.Type.FIRST_QUARTILE,google.ima.AdEvent.Type.LOADED,google.ima.AdEvent.Type.MIDPOINT,google.ima.AdEvent.Type.PAUSED,google.ima.AdEvent.Type.STARTED,google.ima.AdEvent.Type.THIRD_QUARTILE].forEach(function(t){n.addEventListener(t,e.onAdEvent,!1,e)});try{this.adContent.style.display="block";var r=window.innerWidth,o=window.innerHeight;this.adsManager.init(r,o,google.ima.ViewMode.NORMAL),this.adsManager.start(),this.resizeListener=function(){null!==e.adsManager&&e.adsManager.resize(window.innerWidth,window.innerHeight,google.ima.ViewMode.NORMAL)},window.addEventListener("resize",this.resizeListener)}catch(t){this.onAdError(t)}},w.prototype.onAdEvent=function(t){switch(t.type){case google.ima.AdEvent.Type.CLICK:this.adManager.emit(r.AdEvents.AD_CLICKED);break;case google.ima.AdEvent.Type.LOADED:this.adRequested=!1;var e=t.getAd();e.isLinear()||this.onContentResumeRequested();break;case google.ima.AdEvent.Type.STARTED:this.adManager.emit(r.AdEvents.AD_PROGRESSION,g.start);break;case google.ima.AdEvent.Type.FIRST_QUARTILE:this.adManager.emit(r.AdEvents.AD_PROGRESSION,g.firstQuartile);break;case google.ima.AdEvent.Type.MIDPOINT:this.adManager.emit(r.AdEvents.AD_PROGRESSION,g.midPoint);break;case google.ima.AdEvent.Type.THIRD_QUARTILE:this.adManager.emit(r.AdEvents.AD_PROGRESSION,g.thirdQuartile);break;case google.ima.AdEvent.Type.COMPLETE:this.adManager.emit(r.AdEvents.AD_PROGRESSION,g.complete);break;case google.ima.AdEvent.Type.ALL_ADS_COMPLETED:this.onContentResumeRequested()}},w.prototype.onAdError=function(t){null!==this.adsManager&&(this.adsManager.destroy(),null!==this.resizeListener&&window.removeEventListener("resize",this.resizeListener)),this.adRequested&&(this.adRequested=!1),this.onContentResumeRequested()},w.prototype.onContentPauseRequested=function(){this.adManager.emit(r.AdEvents.CONTENT_PAUSED)},w.prototype.onContentResumeRequested=function(){"undefined"!=typeof google&&(this.adContent.style.display="none"),this.adManager.emit(r.AdEvents.CONTENT_RESUMED)},w.prototype.parseCustomParams=function(t){if(void 0===t)return"";var e,i="";for(e in t)t.hasOwnProperty(e)&&(0<i.length&&(i+="&"),i+=e+"="+(Array.isArray(t[e])?t[e].join(","):t[e]));return"&cust_params="+encodeURIComponent(i)},w.prototype.areAdsEnabled=function(){var e=this,i=document.createElement("div");i.innerHTML="&nbsp;",i.className="adsbox",i.style.position="absolute",i.style.fontSize="10px",document.body.appendChild(i);window.setTimeout(function(){var t;e.adsEnabled=(t=!0,0===i.offsetHeight&&(t=!1),i.parentNode&&i.parentNode.removeChild(i),t)},100)},w);function w(t,e){this.googleEnabled=!1,this.adsEnabled=!0,this.adTagUrl="",this.adRequested=!1,this.areAdsEnabled(),"undefined"!=typeof google&&(this.googleEnabled=!0,this.gameContent="string"==typeof t.parentElement?document.getElementById(t.parentElement):t.parentElement,this.gameContent.style.position="absolute",this.gameContent.style.width="100%",this.adContent=this.gameContent.parentNode.appendChild(document.createElement("div")),this.adContent.id="phaser-ad-container",this.adContent.style.position="absolute",this.adContent.style.zIndex="9999",this.adContent.style.display="none",this.adContent.style.top="0",this.adContent.style.left="0",this.adContent.style.width="100%",this.adContent.style.height="100%",this.adContent.style.overflow="hidden",this.adTagUrl=e,this.adDisplay=new google.ima.AdDisplayContainer(this.adContent),google.ima.settings.setVpaidMode(google.ima.ImaSdkSettings.VpaidMode.ENABLED),google.ima.settings.setLocale("nl"),this.adLoader=new google.ima.AdsLoader(this.adDisplay),this.adLoader.addEventListener(google.ima.AdsManagerLoadedEvent.Type.ADS_MANAGER_LOADED,this.onAdManagerLoader,!1,this),this.adLoader.addEventListener(google.ima.AdErrorEvent.Type.AD_ERROR,this.onAdError,!1,this))}(P=r.AdEvents||(r.AdEvents={})).CONTENT_PAUSED="onContentPaused",P.CONTENT_RESUMED="onContentResumed",P.AD_PROGRESSION="onAdProgression",P.AD_DISABLED="onAdsDisabled",P.AD_CLICKED="onAdClicked",P.AD_REWARDED="onAdRewardGranted",P.BANNER_SHOWN="onBannerShown",P.BANNER_HIDDEN="onBannerHidden",P.AD_LOADED="onAdLoaded",P.AD_PROVIDER_LOADED="onAdProviderLoaded",(P=r.AdType||(r.AdType={}))[P.interstitial=0]="interstitial",P[P.rewarded=1]="rewarded",P[P.banner=2]="banner";var z,b,t=(i(b=C,P=z=t),b.prototype=null===P?Object.create(P):(S.prototype=P.prototype,new S),C.prototype.setAdProvider=function(t){this.provider=t,this.provider.setManager(this)},C.prototype.showAd=function(t){for(var e=[],i=1;i<arguments.length;i++)e[i-1]=arguments[i];if(null===this.provider)throw new Error("Can not request an ad without an provider, please attach an ad provider!");e.unshift(t),this.provider.showAd.apply(this.provider,e)},C.prototype.createBanner=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return this.provider.loadBanner.apply(this.provider,t)},C.prototype.loadBanner=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return"function"==typeof this.provider.loadBanner?this.provider.loadBanner.apply(this.provider,t):null},C.prototype.preloadAd=function(t){for(var e=[],i=1;i<arguments.length;i++)e[i-1]=arguments[i];if(null===this.provider)throw new Error("Can not preload an ad without an provider, please attach an ad provider!");e.unshift(t),this.provider.preloadAd.apply(this.provider,e)},C.prototype.destroyAd=function(t){for(var e=[],i=1;i<arguments.length;i++)e[i-1]=arguments[i];if(null===this.provider)throw new Error("Can not destroy an ad without an provider, please attach an ad provider!");e.unshift(t),this.provider.destroyAd.apply(this.provider,e)},C.prototype.hideAd=function(t){for(var e=[],i=1;i<arguments.length;i++)e[i-1]=arguments[i];if(null===this.provider)throw new Error("Can not hide an ad without an provider, please attach an ad provider!");e.unshift(t),this.provider.hideAd.apply(this.provider,e)},C.prototype.adsEnabled=function(){if(null===this.provider)throw new Error("Can not hide an ad without an provider, please attach an ad provider!");return this.provider.adsEnabled},C.prototype.adAvailable=function(t){for(var e=[],i=1;i<arguments.length;i++)e[i-1]=arguments[i];if(null===this.provider)throw new Error("Can not hide an ad without an provider, please attach an ad provider!");return e.unshift(t),this.provider.adAvailable.apply(this.provider,e)},C);function S(){this.constructor=b}function C(){var t=null!==z&&z.apply(this,arguments)||this;return t.bannerActive=!1,t.provider=null,t}var P=new t;r.H5AdWrapper=t,r.adWrapper=P,r.CocoonAds=e,r.CordovaGamedistribution=s,r.CordovaGamedock=h,r.CordovaHeyzap=p,r.CordovaIronSource=c,r.GameDistribution=f,r.GameDistributionBanner=_,r.Ima3=v,Object.defineProperty(r,"__esModule",{value:!0})}),function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):(t="undefined"!=typeof globalThis?globalThis:t||self).i18next=e()}(this,function(){"use strict";function A(t){return(A="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function k(n){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?Object(arguments[t]):{},e=Object.keys(r);(e="function"==typeof Object.getOwnPropertySymbols?e.concat(Object.getOwnPropertySymbols(r).filter(function(t){return Object.getOwnPropertyDescriptor(r,t).enumerable})):e).forEach(function(t){var e,i;e=n,t=r[i=t],i in e?Object.defineProperty(e,i,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[i]=t})}return n}function s(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function n(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function t(t,e,i){return e&&n(t.prototype,e),i&&n(t,i),t}function a(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function h(t,e){return!e||"object"!==A(e)&&"function"!=typeof e?a(t):e}function l(t){return(l=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function i(t,e){return(i=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function e(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&i(t,e)}var r={type:"logger",log:function(t){this.output("log",t)},warn:function(t){this.output("warn",t)},error:function(t){this.output("error",t)},output:function(t,e){console&&console[t]}},p=(t(d,[{key:"init",value:function(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};this.prefix=e.prefix||"i18next:",this.logger=t||r,this.options=e,this.debug=e.debug}},{key:"setDebug",value:function(t){this.debug=t}},{key:"log",value:function(){for(var t=arguments.length,e=new Array(t),i=0;i<t;i++)e[i]=arguments[i];return this.forward(e,"log","",!0)}},{key:"warn",value:function(){for(var t=arguments.length,e=new Array(t),i=0;i<t;i++)e[i]=arguments[i];return this.forward(e,"warn","",!0)}},{key:"error",value:function(){for(var t=arguments.length,e=new Array(t),i=0;i<t;i++)e[i]=arguments[i];return this.forward(e,"error","")}},{key:"deprecate",value:function(){for(var t=arguments.length,e=new Array(t),i=0;i<t;i++)e[i]=arguments[i];return this.forward(e,"warn","WARNING DEPRECATED: ",!0)}},{key:"forward",value:function(t,e,i,n){return n&&!this.debug?null:("string"==typeof t[0]&&(t[0]="".concat(i).concat(this.prefix," ").concat(t[0])),this.logger[e](t))}},{key:"create",value:function(t){return new d(this.logger,k({},{prefix:"".concat(this.prefix,":").concat(t,":")},this.options))}}]),new d),u=(t(o,[{key:"on",value:function(t,e){var i=this;return t.split(" ").forEach(function(t){i.observers[t]=i.observers[t]||[],i.observers[t].push(e)}),this}},{key:"off",value:function(t,e){this.observers[t]&&(e?this.observers[t]=this.observers[t].filter(function(t){return t!==e}):delete this.observers[t])}},{key:"emit",value:function(e){for(var t=arguments.length,i=new Array(1<t?t-1:0),n=1;n<t;n++)i[n-1]=arguments[n];this.observers[e]&&[].concat(this.observers[e]).forEach(function(t){t.apply(void 0,i)}),this.observers["*"]&&[].concat(this.observers["*"]).forEach(function(t){t.apply(t,[e].concat(i))})}}]),o);function o(){s(this,o),this.observers={}}function d(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};s(this,d),this.init(t,e)}function c(){var i,n,t=new Promise(function(t,e){i=t,n=e});return t.resolve=i,t.reject=n,t}function y(t){return null==t?"":""+t}function _(t,e,i){function n(t){return t&&-1<t.indexOf("###")?t.replace(/###/g,"."):t}function r(){return!t||"string"==typeof t}for(var o="string"!=typeof e?[].concat(e):e.split(".");1<o.length;){if(r())return{};var s=n(o.shift());!t[s]&&i&&(t[s]=new i),t=Object.prototype.hasOwnProperty.call(t,s)?t[s]:{}}return r()?{}:{obj:t,k:n(o.shift())}}function m(t,e,i){e=_(t,e,Object);e.obj[e.k]=i}function g(t,e){t=_(t,e),e=t.obj,t=t.k;if(e)return e[t]}function f(t,e,i){t=g(t,i);return void 0!==t?t:g(e,i)}function x(t){return t.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&")}var v={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#x2F;"};function w(t){return"string"==typeof t?t.replace(/[&<>"'\/]/g,function(t){return v[t]}):t}var z="undefined"!=typeof window&&window.navigator&&window.navigator.userAgent&&-1<window.navigator.userAgent.indexOf("MSIE"),b=(e(M,u),t(M,[{key:"addNamespaces",value:function(t){this.options.ns.indexOf(t)<0&&this.options.ns.push(t)}},{key:"removeNamespaces",value:function(t){t=this.options.ns.indexOf(t);-1<t&&this.options.ns.splice(t,1)}},{key:"getResource",value:function(t,e,i){var n=3<arguments.length&&void 0!==arguments[3]?arguments[3]:{},r=(void 0!==n.keySeparator?n:this.options).keySeparator,o=(void 0!==n.ignoreJSONStructure?n:this.options).ignoreJSONStructure,n=[t,e];i&&"string"!=typeof i&&(n=n.concat(i)),i&&"string"==typeof i&&(n=n.concat(r?i.split(r):i)),-1<t.indexOf(".")&&(n=t.split("."));n=g(this.data,n);return n||!o||"string"!=typeof i?n:function t(e,i){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:".";if(e){if(e[i])return e[i];for(var r=i.split(n),o=e,s=0;s<r.length;++s){if(!o)return;if("string"==typeof o[r[s]]&&s+1<r.length)return;if(void 0===o[r[s]]){for(var a=2,h=r.slice(s,s+a).join(n),l=o[h];void 0===l&&r.length>s+a;)a++,l=o[h=r.slice(s,s+a).join(n)];if(void 0===l)return;if("string"==typeof l)return l;if(h&&"string"==typeof l[h])return l[h];var p=r.slice(s+a).join(n);return p?t(l,p,n):void 0}o=o[r[s]]}return o}}(this.data&&this.data[t]&&this.data[t][e],i,r)}},{key:"addResource",value:function(t,e,i,n){var r=4<arguments.length&&void 0!==arguments[4]?arguments[4]:{silent:!1},o=this.options.keySeparator;void 0===o&&(o=".");var s=[t,e];i&&(s=s.concat(o?i.split(o):i)),-1<t.indexOf(".")&&(n=e,e=(s=t.split("."))[1]),this.addNamespaces(e),m(this.data,s,n),r.silent||this.emit("added",t,e,i,n)}},{key:"addResources",value:function(t,e,i){var n,r=3<arguments.length&&void 0!==arguments[3]?arguments[3]:{silent:!1};for(n in i)"string"!=typeof i[n]&&"[object Array]"!==Object.prototype.toString.apply(i[n])||this.addResource(t,e,n,i[n],{silent:!0});r.silent||this.emit("added",t,e,i)}},{key:"addResourceBundle",value:function(t,e,i,n,r){var o=5<arguments.length&&void 0!==arguments[5]?arguments[5]:{silent:!1},s=[t,e];-1<t.indexOf(".")&&(n=i,i=e,e=(s=t.split("."))[1]),this.addNamespaces(e);var a=g(this.data,s)||{};n?function t(e,i,n){for(var r in i)"__proto__"!==r&&"constructor"!==r&&(r in e?"string"==typeof e[r]||e[r]instanceof String||"string"==typeof i[r]||i[r]instanceof String?n&&(e[r]=i[r]):t(e[r],i[r],n):e[r]=i[r]);return e}(a,i,r):a=k({},a,i),m(this.data,s,a),o.silent||this.emit("added",t,e,i)}},{key:"removeResourceBundle",value:function(t,e){this.hasResourceBundle(t,e)&&delete this.data[t][e],this.removeNamespaces(e),this.emit("removed",t,e)}},{key:"hasResourceBundle",value:function(t,e){return void 0!==this.getResource(t,e)}},{key:"getResourceBundle",value:function(t,e){return e=e||this.options.defaultNS,"v1"===this.options.compatibilityAPI?k({},{},this.getResource(t,e)):this.getResource(t,e)}},{key:"getDataByLanguage",value:function(t){return this.data[t]}},{key:"toJSON",value:function(){return this.data}}]),M),S={processors:{},addPostProcessor:function(t){this.processors[t.name]=t},handle:function(t,e,i,n,r){var o=this;return t.forEach(function(t){o.processors[t]&&(e=o.processors[t].process(e,i,n,r))}),e}},C={},P=(e(O,u),t(O,[{key:"changeLanguage",value:function(t){t&&(this.language=t)}},{key:"exists",value:function(t){if(null==t)return!1;t=this.resolve(t,1<arguments.length&&void 0!==arguments[1]?arguments[1]:{interpolation:{}});return t&&void 0!==t.res}},{key:"extractFromKey",value:function(t,e){var i=(void 0!==e.nsSeparator?e:this.options).nsSeparator,n=(void 0!==e.keySeparator?e:this.options).keySeparator,r=e.ns||this.options.defaultNS;if((i=void 0===i?":":i)&&-1<t.indexOf(i)){e=t.match(this.interpolator.nestingRegexp);if(e&&0<e.length)return{key:t,namespaces:r};e=t.split(i);(i!==n||i===n&&-1<this.options.ns.indexOf(e[0]))&&(r=e.shift()),t=e.join(n)}return{key:t,namespaces:r="string"==typeof r?[r]:r}}},{key:"translate",value:function(t,n,e){var r=this;if(n=(n="object"!==A(n)&&this.options.overloadTranslationOptionHandler?this.options.overloadTranslationOptionHandler(arguments):n)||{},null==t)return"";Array.isArray(t)||(t=[String(t)]);var i=(void 0!==n.keySeparator?n:this.options).keySeparator,o=this.extractFromKey(t[t.length-1],n),s=o.key,a=o.namespaces,h=a[a.length-1],l=n.lng||this.language,p=n.appendNamespaceToCIMode||this.options.appendNamespaceToCIMode;if(l&&"cimode"===l.toLowerCase()){if(p){var u=n.nsSeparator||this.options.nsSeparator;return h+u+s}return s}var d=this.resolve(t,n),c=d&&d.res,y=d&&d.usedKey||s,_=d&&d.exactUsedKey||s,m=Object.prototype.toString.apply(c),o=(void 0!==n.joinArrays?n:this.options).joinArrays,p=!this.i18nFormat||this.i18nFormat.handleAsObject;if(p&&c&&"string"!=typeof c&&"boolean"!=typeof c&&"number"!=typeof c&&["[object Number]","[object Function]","[object RegExp]"].indexOf(m)<0&&("string"!=typeof o||"[object Array]"!==m)){if(!n.returnObjects&&!this.options.returnObjects)return this.options.returnedObjectHandler||this.logger.warn("accessing an object - but returnObjects options is not enabled!"),this.options.returnedObjectHandler?this.options.returnedObjectHandler(y,c,k({},n,{ns:a})):"key '".concat(s," (").concat(this.language,")' returned an object instead of string.");if(i){var g,f,u="[object Array]"===m,x=u?[]:{},v=u?_:y;for(g in c)Object.prototype.hasOwnProperty.call(c,g)&&(f="".concat(v).concat(i).concat(g),x[g]=this.translate(f,k({},n,{joinArrays:!1,ns:a})),x[g]===f&&(x[g]=c[g]));c=x}}else if(p&&"string"==typeof o&&"[object Array]"===m)(c=c.join(o))&&(c=this.extendTranslation(c,t,n,e));else{var _=!1,y=!1,p=void 0!==n.count&&"string"!=typeof n.count,m=O.hasDefaultValue(n),o=p?this.pluralResolver.getSuffix(l,n.count):"",w=n["defaultValue".concat(o)]||n.defaultValue;!this.isValidLookup(c)&&m&&(_=!0,c=w),this.isValidLookup(c)||(y=!0,c=s);var z,b=(n.missingKeyNoValueFallbackToKey||this.options.missingKeyNoValueFallbackToKey)&&y?void 0:c,S=m&&w!==c&&this.options.updateMissing;if(y||_||S){this.logger.log(S?"updateKey":"missingKey",l,h,s,S?w:c),i&&(z=this.resolve(s,k({},n,{keySeparator:!1})))&&z.res&&this.logger.warn("Seems the loaded translations were in flat JSON format instead of nested. Either set keySeparator: false on init or make sure your translations are published in nested format.");var C=[],P=this.languageUtils.getFallbackCodes(this.options.fallbackLng,n.lng||this.language);if("fallback"===this.options.saveMissingTo&&P&&P[0])for(var M=0;M<P.length;M++)C.push(P[M]);else"all"===this.options.saveMissingTo?C=this.languageUtils.toResolveHierarchy(n.lng||this.language):C.push(n.lng||this.language);var T=function(t,e,i){r.options.missingKeyHandler?r.options.missingKeyHandler(t,h,e,S?i:b,S,n):r.backendConnector&&r.backendConnector.saveMissing&&r.backendConnector.saveMissing(t,h,e,S?i:b,S,n),r.emit("missingKey",t,h,e,c)};this.options.saveMissing&&(this.options.saveMissingPlurals&&p?C.forEach(function(e){r.pluralResolver.getSuffixes(e).forEach(function(t){T([e],s+t,n["defaultValue".concat(t)]||w)})}):T(C,s,w))}c=this.extendTranslation(c,t,n,d,e),y&&c===s&&this.options.appendNamespaceToMissingKey&&(c="".concat(h,":").concat(s)),(y||_)&&this.options.parseMissingKeyHandler&&(c=this.options.parseMissingKeyHandler(c))}return c}},{key:"extendTranslation",value:function(t,n,r,e,o){var i,s,a,h=this;this.i18nFormat&&this.i18nFormat.parse?t=this.i18nFormat.parse(t,r,e.usedLng,e.usedNS,e.usedKey,{resolved:e}):r.skipInterpolation||(r.interpolation&&this.interpolator.init(k({},r,{interpolation:k({},this.options.interpolation,r.interpolation)})),(i=r.interpolation&&r.interpolation.skipOnVariables||this.options.interpolation.skipOnVariables)&&(s=(a=t.match(this.interpolator.nestingRegexp))&&a.length),a=r.replace&&"string"!=typeof r.replace?r.replace:r,this.options.interpolation.defaultVariables&&(a=k({},this.options.interpolation.defaultVariables,a)),t=this.interpolator.interpolate(t,a,r.lng||this.language,r),i&&s<((l=t.match(this.interpolator.nestingRegexp))&&l.length)&&(r.nest=!1),!1!==r.nest&&(t=this.interpolator.nest(t,function(){for(var t=arguments.length,e=new Array(t),i=0;i<t;i++)e[i]=arguments[i];return o&&o[0]===e[0]&&!r.context?(h.logger.warn("It seems you are nesting recursively key: ".concat(e[0]," in key: ").concat(n[0])),null):h.translate.apply(h,e.concat([n]))},r)),r.interpolation&&this.interpolator.reset());var l=r.postProcess||this.options.postProcess,l="string"==typeof l?[l]:l;return t=null!=t&&l&&l.length&&!1!==r.applyPostProcessor?S.handle(l,t,n,this.options&&this.options.postProcessPassResolved?k({i18nResolved:e},r):r,this):t}},{key:"resolve",value:function(t){var l,i,p,u,n,d=this,c=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};return(t="string"==typeof t?[t]:t).forEach(function(t){var s,a,h,e;d.isValidLookup(l)||(t=d.extractFromKey(t,c),s=t.key,i=s,t=t.namespaces,d.options.fallbackNS&&(t=t.concat(d.options.fallbackNS)),a=void 0!==c.count&&"string"!=typeof c.count,h=void 0!==c.context&&("string"==typeof c.context||"number"==typeof c.context)&&""!==c.context,e=c.lngs||d.languageUtils.toResolveHierarchy(c.lng||d.language,c.fallbackLng),t.forEach(function(o){d.isValidLookup(l)||(n=o,!C["".concat(e[0],"-").concat(o)]&&d.utils&&d.utils.hasLoadedNamespace&&!d.utils.hasLoadedNamespace(n)&&(C["".concat(e[0],"-").concat(o)]=!0,d.logger.warn('key "'.concat(i,'" for languages "').concat(e.join(", "),'" won\'t get resolved as namespace "').concat(n,'" was not yet loaded'),"This means something IS WRONG in your setup. You access the t function before i18next.init / i18next.loadNamespace / i18next.changeLanguage was done. Wait for the callback or Promise to resolve before accessing it!!!")),e.forEach(function(t){if(!d.isValidLookup(l)){u=t;var e,i,n=s,r=[n];for(d.i18nFormat&&d.i18nFormat.addLookupKeys?d.i18nFormat.addLookupKeys(r,s,t,o,c):(a&&(e=d.pluralResolver.getSuffix(t,c.count)),a&&h&&r.push(n+e),h&&r.push(n+="".concat(d.options.contextSeparator).concat(c.context)),a&&r.push(n+=e));i=r.pop();)d.isValidLookup(l)||(p=i,l=d.getResource(t,o,i,c))}}))}))}),{res:l,usedKey:i,exactUsedKey:p,usedLng:u,usedNS:n}}},{key:"isValidLookup",value:function(t){return!(void 0===t||!this.options.returnNull&&null===t||!this.options.returnEmptyString&&""===t)}},{key:"getResource",value:function(t,e,i){var n=3<arguments.length&&void 0!==arguments[3]?arguments[3]:{};return(this.i18nFormat&&this.i18nFormat.getResource?this.i18nFormat:this.resourceStore).getResource(t,e,i,n)}}],[{key:"hasDefaultValue",value:function(t){for(var e in t)if(Object.prototype.hasOwnProperty.call(t,e)&&"defaultValue"===e.substring(0,"defaultValue".length)&&void 0!==t[e])return!0;return!1}}]),O);function O(t){var e,i,n,r,o=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};return s(this,O),e=h(this,l(O).call(this)),z&&u.call(a(e)),i=["resourceStore","languageUtils","pluralResolver","interpolator","backendConnector","i18nFormat","utils"],n=t,r=a(e),i.forEach(function(t){n[t]&&(r[t]=n[t])}),e.options=o,void 0===e.options.keySeparator&&(e.options.keySeparator="."),e.logger=p.create("translator"),e}function M(t){var e,i=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{ns:["translation"],defaultNS:"translation"};return s(this,M),e=h(this,l(M).call(this)),z&&u.call(a(e)),e.data=t||{},e.options=i,void 0===e.options.keySeparator&&(e.options.keySeparator="."),void 0===e.options.ignoreJSONStructure&&(e.options.ignoreJSONStructure=!0),e}function T(t){return t.charAt(0).toUpperCase()+t.slice(1)}var E=(t(D,[{key:"getScriptPartFromCode",value:function(t){if(!t||t.indexOf("-")<0)return null;t=t.split("-");return 2===t.length?null:(t.pop(),"x"===t[t.length-1].toLowerCase()?null:this.formatLanguageCode(t.join("-")))}},{key:"getLanguagePartFromCode",value:function(t){if(!t||t.indexOf("-")<0)return t;t=t.split("-");return this.formatLanguageCode(t[0])}},{key:"formatLanguageCode",value:function(t){if("string"==typeof t&&-1<t.indexOf("-")){var e=["hans","hant","latn","cyrl","cans","mong","arab"],i=t.split("-");return this.options.lowerCaseLng?i=i.map(function(t){return t.toLowerCase()}):2===i.length?(i[0]=i[0].toLowerCase(),i[1]=i[1].toUpperCase(),-1<e.indexOf(i[1].toLowerCase())&&(i[1]=T(i[1].toLowerCase()))):3===i.length&&(i[0]=i[0].toLowerCase(),2===i[1].length&&(i[1]=i[1].toUpperCase()),"sgn"!==i[0]&&2===i[2].length&&(i[2]=i[2].toUpperCase()),-1<e.indexOf(i[1].toLowerCase())&&(i[1]=T(i[1].toLowerCase())),-1<e.indexOf(i[2].toLowerCase())&&(i[2]=T(i[2].toLowerCase()))),i.join("-")}return this.options.cleanCode||this.options.lowerCaseLng?t.toLowerCase():t}},{key:"isWhitelisted",value:function(t){return this.logger.deprecate("languageUtils.isWhitelisted",'function "isWhitelisted" will be renamed to "isSupportedCode" in the next major - please make sure to rename it\'s usage asap.'),this.isSupportedCode(t)}},{key:"isSupportedCode",value:function(t){return"languageOnly"!==this.options.load&&!this.options.nonExplicitSupportedLngs||(t=this.getLanguagePartFromCode(t)),!this.supportedLngs||!this.supportedLngs.length||-1<this.supportedLngs.indexOf(t)}},{key:"getBestMatchFromCodes",value:function(t){var i,n=this;return t?(t.forEach(function(t){i||(t=n.formatLanguageCode(t),n.options.supportedLngs&&!n.isSupportedCode(t)||(i=t))}),!i&&this.options.supportedLngs&&t.forEach(function(t){if(!i){var e=n.getLanguagePartFromCode(t);if(n.isSupportedCode(e))return i=e;i=n.options.supportedLngs.find(function(t){if(0===t.indexOf(e))return t})}}),i=i||this.getFallbackCodes(this.options.fallbackLng)[0]):null}},{key:"getFallbackCodes",value:function(t,e){if(!t)return[];if("string"==typeof(t="function"==typeof t?t(e):t)&&(t=[t]),"[object Array]"===Object.prototype.toString.apply(t))return t;if(!e)return t.default||[];var i=t[e];return(i=(i=(i=(i=i||t[this.getScriptPartFromCode(e)])||t[this.formatLanguageCode(e)])||t[this.getLanguagePartFromCode(e)])||t.default)||[]}},{key:"toResolveHierarchy",value:function(t,e){function i(t){t&&(n.isSupportedCode(t)?r.push(t):n.logger.warn("rejecting language code not found in supportedLngs: ".concat(t)))}var n=this,e=this.getFallbackCodes(e||this.options.fallbackLng||[],t),r=[];return"string"==typeof t&&-1<t.indexOf("-")?("languageOnly"!==this.options.load&&i(this.formatLanguageCode(t)),"languageOnly"!==this.options.load&&"currentOnly"!==this.options.load&&i(this.getScriptPartFromCode(t)),"currentOnly"!==this.options.load&&i(this.getLanguagePartFromCode(t))):"string"==typeof t&&i(this.formatLanguageCode(t)),e.forEach(function(t){r.indexOf(t)<0&&i(n.formatLanguageCode(t))}),r}}]),D),I=[{lngs:["ach","ak","am","arn","br","fil","gun","ln","mfe","mg","mi","oc","pt","pt-BR","tg","tl","ti","tr","uz","wa"],nr:[1,2],fc:1},{lngs:["af","an","ast","az","bg","bn","ca","da","de","dev","el","en","eo","es","et","eu","fi","fo","fur","fy","gl","gu","ha","hi","hu","hy","ia","it","kk","kn","ku","lb","mai","ml","mn","mr","nah","nap","nb","ne","nl","nn","no","nso","pa","pap","pms","ps","pt-PT","rm","sco","se","si","so","son","sq","sv","sw","ta","te","tk","ur","yo"],nr:[1,2],fc:2},{lngs:["ay","bo","cgg","fa","ht","id","ja","jbo","ka","km","ko","ky","lo","ms","sah","su","th","tt","ug","vi","wo","zh"],nr:[1],fc:3},{lngs:["be","bs","cnr","dz","hr","ru","sr","uk"],nr:[1,2,5],fc:4},{lngs:["ar"],nr:[0,1,2,3,11,100],fc:5},{lngs:["cs","sk"],nr:[1,2,5],fc:6},{lngs:["csb","pl"],nr:[1,2,5],fc:7},{lngs:["cy"],nr:[1,2,3,8],fc:8},{lngs:["fr"],nr:[1,2],fc:9},{lngs:["ga"],nr:[1,2,3,7,11],fc:10},{lngs:["gd"],nr:[1,2,3,20],fc:11},{lngs:["is"],nr:[1,2],fc:12},{lngs:["jv"],nr:[0,1],fc:13},{lngs:["kw"],nr:[1,2,3,4],fc:14},{lngs:["lt"],nr:[1,2,10],fc:15},{lngs:["lv"],nr:[1,2,0],fc:16},{lngs:["mk"],nr:[1,2],fc:17},{lngs:["mnk"],nr:[0,1,2],fc:18},{lngs:["mt"],nr:[1,2,11,20],fc:19},{lngs:["or"],nr:[2,1],fc:2},{lngs:["ro"],nr:[1,2,20],fc:20},{lngs:["sl"],nr:[5,1,2,3],fc:21},{lngs:["he","iw"],nr:[1,2,20,21],fc:22}],G={1:function(t){return Number(1<t)},2:function(t){return Number(1!=t)},3:function(t){return 0},4:function(t){return Number(t%10==1&&t%100!=11?0:2<=t%10&&t%10<=4&&(t%100<10||20<=t%100)?1:2)},5:function(t){return Number(0==t?0:1==t?1:2==t?2:3<=t%100&&t%100<=10?3:11<=t%100?4:5)},6:function(t){return Number(1==t?0:2<=t&&t<=4?1:2)},7:function(t){return Number(1==t?0:2<=t%10&&t%10<=4&&(t%100<10||20<=t%100)?1:2)},8:function(t){return Number(1==t?0:2==t?1:8!=t&&11!=t?2:3)},9:function(t){return Number(2<=t)},10:function(t){return Number(1==t?0:2==t?1:t<7?2:t<11?3:4)},11:function(t){return Number(1==t||11==t?0:2==t||12==t?1:2<t&&t<20?2:3)},12:function(t){return Number(t%10!=1||t%100==11)},13:function(t){return Number(0!==t)},14:function(t){return Number(1==t?0:2==t?1:3==t?2:3)},15:function(t){return Number(t%10==1&&t%100!=11?0:2<=t%10&&(t%100<10||20<=t%100)?1:2)},16:function(t){return Number(t%10==1&&t%100!=11?0:0!==t?1:2)},17:function(t){return Number(1==t||t%10==1&&t%100!=11?0:1)},18:function(t){return Number(0==t?0:1==t?1:2)},19:function(t){return Number(1==t?0:0==t||1<t%100&&t%100<11?1:10<t%100&&t%100<20?2:3)},20:function(t){return Number(1==t?0:0==t||0<t%100&&t%100<20?1:2)},21:function(t){return Number(t%100==1?1:t%100==2?2:t%100==3||t%100==4?3:0)},22:function(t){return Number(1==t?0:2==t?1:(t<0||10<t)&&t%10==0?2:3)}};function D(t){s(this,D),this.options=t,this.whitelist=this.options.supportedLngs||!1,this.supportedLngs=this.options.supportedLngs||!1,this.logger=p.create("languageUtils")}var L=(t(F,[{key:"addRule",value:function(t,e){this.rules[t]=e}},{key:"getRule",value:function(t){return this.rules[t]||this.rules[this.languageUtils.getLanguagePartFromCode(t)]}},{key:"needsPlural",value:function(t){t=this.getRule(t);return t&&1<t.numbers.length}},{key:"getPluralFormsOfKey",value:function(t,e){return this.getSuffixes(t).map(function(t){return e+t})}},{key:"getSuffixes",value:function(e){var i=this,t=this.getRule(e);return t?t.numbers.map(function(t){return i.getSuffix(e,t)}):[]}},{key:"getSuffix",value:function(t,e){var i=this,n=this.getRule(t);if(n){var r=n.noAbs?n.plurals(e):n.plurals(Math.abs(e)),o=n.numbers[r];this.options.simplifyPluralSuffix&&2===n.numbers.length&&1===n.numbers[0]&&(2===o?o="plural":1===o&&(o=""));e=function(){return i.options.prepend&&o.toString()?i.options.prepend+o.toString():o.toString()};return"v1"===this.options.compatibilityJSON?1===o?"":"number"==typeof o?"_plural_".concat(o.toString()):e():"v2"===this.options.compatibilityJSON||this.options.simplifyPluralSuffix&&2===n.numbers.length&&1===n.numbers[0]?e():this.options.prepend&&r.toString()?this.options.prepend+r.toString():r.toString()}return this.logger.warn("no plural rule found for: ".concat(t)),""}}]),F),B=(t(R,[{key:"init",value:function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};t.interpolation||(t.interpolation={escapeValue:!0});t=t.interpolation;this.escape=void 0!==t.escape?t.escape:w,this.escapeValue=void 0===t.escapeValue||t.escapeValue,this.useRawValueToEscape=void 0!==t.useRawValueToEscape&&t.useRawValueToEscape,this.prefix=t.prefix?x(t.prefix):t.prefixEscaped||"{{",this.suffix=t.suffix?x(t.suffix):t.suffixEscaped||"}}",this.formatSeparator=t.formatSeparator||t.formatSeparator||",",this.unescapePrefix=t.unescapeSuffix?"":t.unescapePrefix||"-",this.unescapeSuffix=!this.unescapePrefix&&t.unescapeSuffix||"",this.nestingPrefix=t.nestingPrefix?x(t.nestingPrefix):t.nestingPrefixEscaped||x("$t("),this.nestingSuffix=t.nestingSuffix?x(t.nestingSuffix):t.nestingSuffixEscaped||x(")"),this.nestingOptionsSeparator=t.nestingOptionsSeparator||t.nestingOptionsSeparator||",",this.maxReplaces=t.maxReplaces||1e3,this.alwaysFormat=void 0!==t.alwaysFormat&&t.alwaysFormat,this.resetRegExp()}},{key:"reset",value:function(){this.options&&this.init(this.options)}},{key:"resetRegExp",value:function(){var t="".concat(this.prefix,"(.+?)").concat(this.suffix);this.regexp=new RegExp(t,"g");t="".concat(this.prefix).concat(this.unescapePrefix,"(.+?)").concat(this.unescapeSuffix).concat(this.suffix);this.regexpUnescape=new RegExp(t,"g");t="".concat(this.nestingPrefix,"(.+?)").concat(this.nestingSuffix);this.nestingRegexp=new RegExp(t,"g")}},{key:"interpolate",value:function(i,n,r,o){var s,a,h,l=this,p=this.options&&this.options.interpolation&&this.options.interpolation.defaultVariables||{};function e(t){return t.replace(/\$/g,"$$$$")}this.resetRegExp();var u=o&&o.missingInterpolationHandler||this.options.missingInterpolationHandler,d=o&&o.interpolation&&o.interpolation.skipOnVariables||this.options.interpolation.skipOnVariables;return[{regex:this.regexpUnescape,safeValue:e},{regex:this.regexp,safeValue:function(t){return l.escapeValue?e(l.escape(t)):e(t)}}].forEach(function(t){for(h=0;s=t.regex.exec(i);){if(void 0===(a=function(t){if(t.indexOf(l.formatSeparator)<0){var e=f(n,p,t);return l.alwaysFormat?l.format(e,void 0,r,k({},o,n,{interpolationkey:t})):e}e=t.split(l.formatSeparator),t=e.shift().trim(),e=e.join(l.formatSeparator).trim();return l.format(f(n,p,t),e,r,k({},o,n,{interpolationkey:t}))}(s[1].trim())))if("function"==typeof u){var e=u(i,s,o);a="string"==typeof e?e:""}else{if(d){a=s[0];continue}l.logger.warn("missed to pass in variable ".concat(s[1]," for interpolating ").concat(i)),a=""}else"string"==typeof a||l.useRawValueToEscape||(a=y(a));e=t.safeValue(a);if(i=i.replace(s[0],e),d?(t.regex.lastIndex+=e.length,t.regex.lastIndex-=s[0].length):t.regex.lastIndex=0,++h>=l.maxReplaces)break}}),i}},{key:"nest",value:function(t,e){var i,n=this,r=2<arguments.length&&void 0!==arguments[2]?arguments[2]:{},o=k({},r);function s(t,e){var i=this.nestingOptionsSeparator;if(t.indexOf(i)<0)return t;var n=t.split(new RegExp("".concat(i,"[ ]*{"))),r="{".concat(n[1]);t=n[0],r=(r=this.interpolate(r,o)).replace(/'/g,'"');try{o=JSON.parse(r),e&&(o=k({},e,o))}catch(e){return this.logger.warn("failed parsing options string in nesting for key ".concat(t),e),"".concat(t).concat(i).concat(r)}return delete o.defaultValue,t}for(o.applyPostProcessor=!1,delete o.defaultValue;i=this.nestingRegexp.exec(t);){var a,h=[],l=!1;if(-1===i[0].indexOf(this.formatSeparator)||/{.*}/.test(i[1])||(a=i[1].split(this.formatSeparator).map(function(t){return t.trim()}),i[1]=a.shift(),h=a,l=!0),(a=e(s.call(this,i[1].trim(),o),o))&&i[0]===t&&"string"!=typeof a)return a;(a="string"!=typeof a?y(a):a)||(this.logger.warn("missed to resolve ".concat(i[1]," for nesting ").concat(t)),a=""),l&&(a=h.reduce(function(t,e){return n.format(t,e,r.lng,k({},r,{interpolationkey:i[1].trim()}))},a.trim())),t=t.replace(i[0],a),this.regexp.lastIndex=0}return t}}]),R);function R(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};s(this,R),this.logger=p.create("interpolator"),this.options=t,this.format=t.interpolation&&t.interpolation.format||function(t){return t},this.init(t)}function F(t){var i,e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};s(this,F),this.languageUtils=t,this.options=e,this.logger=p.create("pluralResolver"),this.rules=(i={},I.forEach(function(e){e.lngs.forEach(function(t){i[t]={numbers:e.nr,plurals:G[e.fc]}})}),i)}var N=(e(j,u),t(j,[{key:"queueLoad",value:function(t,e,r,i){var o=this,s=[],a=[],h=[],l=[];return t.forEach(function(i){var n=!0;e.forEach(function(t){var e="".concat(i,"|").concat(t);!r.reload&&o.store.hasResourceBundle(i,t)?o.state[e]=2:o.state[e]<0||(1===o.state[e]?a.indexOf(e)<0&&a.push(e):(o.state[e]=1,n=!1,a.indexOf(e)<0&&a.push(e),s.indexOf(e)<0&&s.push(e),l.indexOf(t)<0&&l.push(t)))}),n||h.push(i)}),(s.length||a.length)&&this.queue.push({pending:a,loaded:{},errors:[],callback:i}),{toLoad:s,pending:a,toLoadLanguages:h,toLoadNamespaces:l}}},{key:"loaded",value:function(r,o,t){var e=r.split("|"),s=e[0],a=e[1];o&&this.emit("failedLoading",s,a,o),t&&this.store.addResourceBundle(s,a,t),this.state[r]=o?-1:2;var h={};this.queue.forEach(function(t){var e=t.loaded,i=a,n=_(e,[s],Object),e=n.obj,n=n.k;e[n]=e[n]||[],e[n].push(i),function(t,e){for(var i=t.indexOf(e);-1!==i;)t.splice(i,1),i=t.indexOf(e)}(t.pending,r),o&&t.errors.push(o),0!==t.pending.length||t.done||(Object.keys(t.loaded).forEach(function(e){h[e]||(h[e]=[]),t.loaded[e].length&&t.loaded[e].forEach(function(t){h[e].indexOf(t)<0&&h[e].push(t)})}),t.done=!0,t.errors.length?t.callback(t.errors):t.callback())}),this.emit("loaded",h),this.queue=this.queue.filter(function(t){return!t.done})}},{key:"read",value:function(i,n,r){var o=this,s=3<arguments.length&&void 0!==arguments[3]?arguments[3]:0,a=4<arguments.length&&void 0!==arguments[4]?arguments[4]:350,h=5<arguments.length?arguments[5]:void 0;return i.length?this.backend[r](i,n,function(t,e){t&&e&&s<5?setTimeout(function(){o.read.call(o,i,n,r,s+1,2*a,h)},a):h(t,e)}):h(null,{})}},{key:"prepareLoading",value:function(t,e){var i=this,n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:{},r=3<arguments.length?arguments[3]:void 0;if(!this.backend)return this.logger.warn("No backend was added via i18next.use. Will not load resources."),r&&r();"string"==typeof t&&(t=this.languageUtils.toResolveHierarchy(t));n=this.queueLoad(t,e="string"==typeof e?[e]:e,n,r);if(!n.toLoad.length)return n.pending.length||r(),null;n.toLoad.forEach(function(t){i.loadOne(t)})}},{key:"load",value:function(t,e,i){this.prepareLoading(t,e,{},i)}},{key:"reload",value:function(t,e,i){this.prepareLoading(t,e,{reload:!0},i)}},{key:"loadOne",value:function(i){var n=this,r=1<arguments.length&&void 0!==arguments[1]?arguments[1]:"",t=i.split("|"),o=t[0],s=t[1];this.read(o,s,"read",void 0,void 0,function(t,e){t&&n.logger.warn("".concat(r,"loading namespace ").concat(s," for language ").concat(o," failed"),t),!t&&e&&n.logger.log("".concat(r,"loaded namespace ").concat(s," for language ").concat(o),e),n.loaded(i,t,e)})}},{key:"saveMissing",value:function(t,e,i,n,r){var o=5<arguments.length&&void 0!==arguments[5]?arguments[5]:{};this.services.utils&&this.services.utils.hasLoadedNamespace&&!this.services.utils.hasLoadedNamespace(e)?this.logger.warn('did not save key "'.concat(i,'" as the namespace "').concat(e,'" was not yet loaded'),"This means something IS WRONG in your setup. You access the t function before i18next.init / i18next.loadNamespace / i18next.changeLanguage was done. Wait for the callback or Promise to resolve before accessing it!!!"):null!=i&&""!==i&&(this.backend&&this.backend.create&&this.backend.create(t,e,i,n,null,k({},o,{isUpdate:r})),t&&t[0]&&this.store.addResource(t[0],e,i,n))}}]),j);function j(t,e,i){var n,r=3<arguments.length&&void 0!==arguments[3]?arguments[3]:{};return s(this,j),n=h(this,l(j).call(this)),z&&u.call(a(n)),n.backend=t,n.store=e,n.services=i,n.languageUtils=i.languageUtils,n.options=r,n.logger=p.create("backendConnector"),n.state={},n.queue=[],n.backend&&n.backend.init&&n.backend.init(i,r.backend,r),n}function U(t){return"string"==typeof t.ns&&(t.ns=[t.ns]),"string"==typeof t.fallbackLng&&(t.fallbackLng=[t.fallbackLng]),"string"==typeof t.fallbackNS&&(t.fallbackNS=[t.fallbackNS]),t.whitelist&&(t.whitelist&&t.whitelist.indexOf("cimode")<0&&(t.whitelist=t.whitelist.concat(["cimode"])),t.supportedLngs=t.whitelist),t.nonExplicitWhitelist&&(t.nonExplicitSupportedLngs=t.nonExplicitWhitelist),t.supportedLngs&&t.supportedLngs.indexOf("cimode")<0&&(t.supportedLngs=t.supportedLngs.concat(["cimode"])),t}function V(){}return e(W,u),t(W,[{key:"init",value:function(){var t,r=this,e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},i=1<arguments.length?arguments[1]:void 0;function n(t){return t?"function"==typeof t?new t:t:null}"function"==typeof e&&(i=e,e={}),e.whitelist&&!e.supportedLngs&&this.logger.deprecate("whitelist",'option "whitelist" will be renamed to "supportedLngs" in the next major - please make sure to rename this option asap.'),e.nonExplicitWhitelist&&!e.nonExplicitSupportedLngs&&this.logger.deprecate("whitelist",'options "nonExplicitWhitelist" will be renamed to "nonExplicitSupportedLngs" in the next major - please make sure to rename this option asap.'),this.options=k({},{debug:!1,initImmediate:!0,ns:["translation"],defaultNS:["translation"],fallbackLng:["dev"],fallbackNS:!1,whitelist:!1,nonExplicitWhitelist:!1,supportedLngs:!1,nonExplicitSupportedLngs:!1,load:"all",preload:!1,simplifyPluralSuffix:!0,keySeparator:".",nsSeparator:":",pluralSeparator:"_",contextSeparator:"_",partialBundledLanguages:!1,saveMissing:!1,updateMissing:!1,saveMissingTo:"fallback",saveMissingPlurals:!0,missingKeyHandler:!1,missingInterpolationHandler:!1,postProcess:!1,postProcessPassResolved:!1,returnNull:!0,returnEmptyString:!0,returnObjects:!1,joinArrays:!1,returnedObjectHandler:!1,parseMissingKeyHandler:!1,appendNamespaceToMissingKey:!1,appendNamespaceToCIMode:!1,overloadTranslationOptionHandler:function(t){var e,i={};return"object"===A(t[1])&&(i=t[1]),"string"==typeof t[1]&&(i.defaultValue=t[1]),"string"==typeof t[2]&&(i.tDescription=t[2]),"object"!==A(t[2])&&"object"!==A(t[3])||(e=t[3]||t[2],Object.keys(e).forEach(function(t){i[t]=e[t]})),i},interpolation:{escapeValue:!0,format:function(t,e,i,n){return t},prefix:"{{",suffix:"}}",formatSeparator:",",unescapePrefix:"-",nestingPrefix:"$t(",nestingSuffix:")",nestingOptionsSeparator:",",maxReplaces:1e3,skipOnVariables:!1}},this.options,U(e)),this.format=this.options.interpolation.format,i=i||V,this.options.isClone||(this.modules.logger?p.init(n(this.modules.logger),this.options):p.init(null,this.options),e=new E(this.options),this.store=new b(this.options.resources,this.options),(t=this.services).logger=p,t.resourceStore=this.store,t.languageUtils=e,t.pluralResolver=new L(e,{prepend:this.options.pluralSeparator,compatibilityJSON:this.options.compatibilityJSON,simplifyPluralSuffix:this.options.simplifyPluralSuffix}),t.interpolator=new B(this.options),t.utils={hasLoadedNamespace:this.hasLoadedNamespace.bind(this)},t.backendConnector=new N(n(this.modules.backend),t.resourceStore,t,this.options),t.backendConnector.on("*",function(t){for(var e=arguments.length,i=new Array(1<e?e-1:0),n=1;n<e;n++)i[n-1]=arguments[n];r.emit.apply(r,[t].concat(i))}),this.modules.languageDetector&&(t.languageDetector=n(this.modules.languageDetector),t.languageDetector.init(t,this.options.detection,this.options)),this.modules.i18nFormat&&(t.i18nFormat=n(this.modules.i18nFormat),t.i18nFormat.init&&t.i18nFormat.init(this)),this.translator=new P(this.services,this.options),this.translator.on("*",function(t){for(var e=arguments.length,i=new Array(1<e?e-1:0),n=1;n<e;n++)i[n-1]=arguments[n];r.emit.apply(r,[t].concat(i))}),this.modules.external.forEach(function(t){t.init&&t.init(r)})),!this.options.fallbackLng||this.services.languageDetector||this.options.lng||0<(t=this.services.languageUtils.getFallbackCodes(this.options.fallbackLng)).length&&"dev"!==t[0]&&(this.options.lng=t[0]),this.services.languageDetector||this.options.lng||this.logger.warn("init: no languageDetector is used and no lng is defined"),["getResource","hasResourceBundle","getResourceBundle","getDataByLanguage"].forEach(function(e){r[e]=function(){var t;return(t=r.store)[e].apply(t,arguments)}}),["addResource","addResources","addResourceBundle","removeResourceBundle"].forEach(function(e){r[e]=function(){var t;return(t=r.store)[e].apply(t,arguments),r}});function o(){function t(t,e){r.isInitialized&&!r.initializedStoreOnce&&r.logger.warn("init: i18next is already initialized. You should call init just once!"),r.isInitialized=!0,r.options.isClone||r.logger.log("initialized",r.options),r.emit("initialized",r.options),s.resolve(e),i(t,e)}if(r.languages&&"v1"!==r.options.compatibilityAPI&&!r.isInitialized)return t(null,r.t.bind(r));r.changeLanguage(r.options.lng,t)}var s=c();return this.options.resources||!this.options.initImmediate?o():setTimeout(o,0),s}},{key:"loadResources",value:function(t){var e=this,i=1<arguments.length&&void 0!==arguments[1]?arguments[1]:V,n="string"==typeof t?t:this.language;if("function"==typeof t&&(i=t),!this.options.resources||this.options.partialBundledLanguages){if(n&&"cimode"===n.toLowerCase())return i();var r=[],t=function(t){t&&e.services.languageUtils.toResolveHierarchy(t).forEach(function(t){r.indexOf(t)<0&&r.push(t)})};n?t(n):this.services.languageUtils.getFallbackCodes(this.options.fallbackLng).forEach(t),this.options.preload&&this.options.preload.forEach(t),this.services.backendConnector.load(r,this.options.ns,i)}else i(null)}},{key:"reloadResources",value:function(t,e,i){var n=c();return t=t||this.languages,e=e||this.options.ns,i=i||V,this.services.backendConnector.reload(t,e,function(t){n.resolve(),i(t)}),n}},{key:"use",value:function(t){if(!t)throw new Error("You are passing an undefined module! Please check the object you are passing to i18next.use()");if(!t.type)throw new Error("You are passing a wrong module! Please check the object you are passing to i18next.use()");return"backend"===t.type&&(this.modules.backend=t),("logger"===t.type||t.log&&t.warn&&t.error)&&(this.modules.logger=t),"languageDetector"===t.type&&(this.modules.languageDetector=t),"i18nFormat"===t.type&&(this.modules.i18nFormat=t),"postProcessor"===t.type&&S.addPostProcessor(t),"3rdParty"===t.type&&this.modules.external.push(t),this}},{key:"changeLanguage",value:function(e,n){var r=this;this.isLanguageChangingTo=e;var o=c();this.emit("languageChanging",e);function t(t){var i="string"==typeof(t=!e&&!t&&r.services.languageDetector?[]:t)?t:r.services.languageUtils.getBestMatchFromCodes(t);i&&(r.language||(r.language=i,r.languages=r.services.languageUtils.toResolveHierarchy(i)),r.translator.language||r.translator.changeLanguage(i),r.services.languageDetector&&r.services.languageDetector.cacheUserLanguage(i)),r.loadResources(i,function(t){var e;e=t,(t=i)?(r.language=t,r.languages=r.services.languageUtils.toResolveHierarchy(t),r.translator.changeLanguage(t),r.isLanguageChangingTo=void 0,r.emit("languageChanged",t),r.logger.log("languageChanged",t)):r.isLanguageChangingTo=void 0,o.resolve(function(){return r.t.apply(r,arguments)}),n&&n(e,function(){return r.t.apply(r,arguments)})})}return e||!this.services.languageDetector||this.services.languageDetector.async?!e&&this.services.languageDetector&&this.services.languageDetector.async?this.services.languageDetector.detect(t):t(e):t(this.services.languageDetector.detect()),o}},{key:"getFixedT",value:function(t,e,s){function a(t,e){var i;if("object"!==A(e)){for(var n=arguments.length,r=new Array(2<n?n-2:0),o=2;o<n;o++)r[o-2]=arguments[o];i=h.options.overloadTranslationOptionHandler([t,e].concat(r))}else i=k({},e);return i.lng=i.lng||a.lng,i.lngs=i.lngs||a.lngs,i.ns=i.ns||a.ns,e=h.options.keySeparator||".",t=s?"".concat(s).concat(e).concat(t):t,h.t(t,i)}var h=this;return"string"==typeof t?a.lng=t:a.lngs=t,a.ns=e,a.keyPrefix=s,a}},{key:"t",value:function(){var t;return this.translator&&(t=this.translator).translate.apply(t,arguments)}},{key:"exists",value:function(){var t;return this.translator&&(t=this.translator).exists.apply(t,arguments)}},{key:"setDefaultNamespace",value:function(t){this.options.defaultNS=t}},{key:"hasLoadedNamespace",value:function(t){var i=this,e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};if(!this.isInitialized)return this.logger.warn("hasLoadedNamespace: i18next was not initialized",this.languages),!1;if(!this.languages||!this.languages.length)return this.logger.warn("hasLoadedNamespace: i18n.languages were undefined or empty",this.languages),!1;var n=this.languages[0],r=!!this.options&&this.options.fallbackLng,o=this.languages[this.languages.length-1];if("cimode"===n.toLowerCase())return!0;function s(t,e){return-1===(e=i.services.backendConnector.state["".concat(t,"|").concat(e)])||2===e}if(e.precheck){e=e.precheck(this,s);if(void 0!==e)return e}return!!this.hasResourceBundle(n,t)||!this.services.backendConnector.backend||!(!s(n,t)||r&&!s(o,t))}},{key:"loadNamespaces",value:function(t,e){var i=this,n=c();return this.options.ns?((t="string"==typeof t?[t]:t).forEach(function(t){i.options.ns.indexOf(t)<0&&i.options.ns.push(t)}),this.loadResources(function(t){n.resolve(),e&&e(t)}),n):(e&&e(),Promise.resolve())}},{key:"loadLanguages",value:function(t,e){var i=c(),n=this.options.preload||[],t=(t="string"==typeof t?[t]:t).filter(function(t){return n.indexOf(t)<0});return t.length?(this.options.preload=n.concat(t),this.loadResources(function(t){i.resolve(),e&&e(t)}),i):(e&&e(),Promise.resolve())}},{key:"dir",value:function(t){return!(t=t||(this.languages&&0<this.languages.length?this.languages[0]:this.language))||0<=["ar","shu","sqr","ssh","xaa","yhd","yud","aao","abh","abv","acm","acq","acw","acx","acy","adf","ads","aeb","aec","afb","ajp","apc","apd","arb","arq","ars","ary","arz","auz","avl","ayh","ayl","ayn","ayp","bbz","pga","he","iw","ps","pbt","pbu","pst","prp","prd","ug","ur","ydd","yds","yih","ji","yi","hbo","men","xmn","fa","jpr","peo","pes","prs","dv","sam"].indexOf(this.services.languageUtils.getLanguagePartFromCode(t))?"rtl":"ltr"}},{key:"createInstance",value:function(){return new W(0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},1<arguments.length?arguments[1]:void 0)}},{key:"cloneInstance",value:function(){var e=this,t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},i=1<arguments.length&&void 0!==arguments[1]?arguments[1]:V,t=k({},this.options,t,{isClone:!0}),r=new W(t);return["store","services","language"].forEach(function(t){r[t]=e[t]}),r.services=k({},this.services),r.services.utils={hasLoadedNamespace:r.hasLoadedNamespace.bind(r)},r.translator=new P(r.services,r.options),r.translator.on("*",function(t){for(var e=arguments.length,i=new Array(1<e?e-1:0),n=1;n<e;n++)i[n-1]=arguments[n];r.emit.apply(r,[t].concat(i))}),r.init(t,i),r.translator.options=r.options,r.translator.backendConnector.services.utils={hasLoadedNamespace:r.hasLoadedNamespace.bind(r)},r}},{key:"toJSON",value:function(){return{options:this.options,store:this.store,language:this.language,languages:this.languages}}}]),new W;function W(){var t,e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},i=1<arguments.length?arguments[1]:void 0;if(s(this,W),t=h(this,l(W).call(this)),z&&u.call(a(t)),t.options=U(e),t.services={},t.logger=p,t.modules={external:[]},i&&!t.isInitialized&&!e.isClone){if(!t.options.initImmediate)return t.init(e,i),h(t,a(t));setTimeout(function(){t.init(e,i)},0)}return t}}),function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):(t="undefined"!=typeof globalThis?globalThis:t||self).i18nextBrowserLanguageDetector=e()}(this,function(){"use strict";function r(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var t=[],o=t.forEach,s=t.slice;function i(){if(null!==e)return e;try{e="undefined"!==window&&null!==window.localStorage;var t="i18next.translate.boo";window.localStorage.setItem(t,"foo"),window.localStorage.removeItem(t)}catch(t){e=!1}return e}function n(){if(null!==c)return c;try{c="undefined"!==window&&null!==window.sessionStorage;var t="i18next.translate.boo";window.sessionStorage.setItem(t,"foo"),window.sessionStorage.removeItem(t)}catch(t){c=!1}return c}var a=/^[\u0009\u0020-\u007e\u0080-\u00ff]+$/,h=function(t,e,i,n){var r=4<arguments.length&&void 0!==arguments[4]?arguments[4]:{path:"/",sameSite:"strict"};i&&(r.expires=new Date,r.expires.setTime(r.expires.getTime()+60*i*1e3)),n&&(r.domain=n),document.cookie=function(t,e,i){i=i||{};i.path=i.path||"/";var n=t+"="+encodeURIComponent(e);if(0<i.maxAge){e=+i.maxAge;if(isNaN(e))throw new Error("maxAge should be a Number");n+="; Max-Age="+Math.floor(e)}if(i.domain){if(!a.test(i.domain))throw new TypeError("option domain is invalid");n+="; Domain="+i.domain}if(i.path){if(!a.test(i.path))throw new TypeError("option path is invalid");n+="; Path="+i.path}if(i.expires){if("function"!=typeof i.expires.toUTCString)throw new TypeError("option expires is invalid");n+="; Expires="+i.expires.toUTCString()}if(i.httpOnly&&(n+="; HttpOnly"),i.secure&&(n+="; Secure"),i.sameSite)switch("string"==typeof i.sameSite?i.sameSite.toLowerCase():i.sameSite){case!0:n+="; SameSite=Strict";break;case"lax":n+="; SameSite=Lax";break;case"strict":n+="; SameSite=Strict";break;case"none":n+="; SameSite=None";break;default:throw new TypeError("option sameSite is invalid")}return n}(t,encodeURIComponent(e),r)},l=function(t){for(var e=t+"=",i=document.cookie.split(";"),n=0;n<i.length;n++){for(var r=i[n];" "===r.charAt(0);)r=r.substring(1,r.length);if(0===r.indexOf(e))return r.substring(e.length,r.length)}return null},p={name:"cookie",lookup:function(t){var e;return!t.lookupCookie||"undefined"==typeof document||(t=l(t.lookupCookie))&&(e=t),e},cacheUserLanguage:function(t,e){e.lookupCookie&&"undefined"!=typeof document&&h(e.lookupCookie,t,e.cookieMinutes,e.cookieDomain,e.cookieOptions)}},u={name:"querystring",lookup:function(t){var e;if("undefined"!=typeof window)for(var i=window.location.search.substring(1).split("&"),n=0;n<i.length;n++){var r=i[n].indexOf("=");0<r&&i[n].substring(0,r)===t.lookupQuerystring&&(e=i[n].substring(r+1))}return e}},e=null,d={name:"localStorage",lookup:function(t){var e;return t.lookupLocalStorage&&i()&&((t=window.localStorage.getItem(t.lookupLocalStorage))&&(e=t)),e},cacheUserLanguage:function(t,e){e.lookupLocalStorage&&i()&&window.localStorage.setItem(e.lookupLocalStorage,t)}},c=null,y={name:"sessionStorage",lookup:function(t){var e;return t.lookupSessionStorage&&n()&&((t=window.sessionStorage.getItem(t.lookupSessionStorage))&&(e=t)),e},cacheUserLanguage:function(t,e){e.lookupSessionStorage&&n()&&window.sessionStorage.setItem(e.lookupSessionStorage,t)}},_={name:"navigator",lookup:function(t){var e=[];if("undefined"!=typeof navigator){if(navigator.languages)for(var i=0;i<navigator.languages.length;i++)e.push(navigator.languages[i]);navigator.userLanguage&&e.push(navigator.userLanguage),navigator.language&&e.push(navigator.language)}return 0<e.length?e:void 0}},m={name:"htmlTag",lookup:function(t){var e,t=t.htmlTag||("undefined"!=typeof document?document.documentElement:null);return e=t&&"function"==typeof t.getAttribute?t.getAttribute("lang"):e}},g={name:"path",lookup:function(t){var e;if("undefined"!=typeof window){var i=window.location.pathname.match(/\/([a-zA-Z-]*)/g);if(i instanceof Array)if("number"==typeof t.lookupFromPathIndex){if("string"!=typeof i[t.lookupFromPathIndex])return;e=i[t.lookupFromPathIndex].replace("/","")}else e=i[0].replace("/","")}return e}},f={name:"subdomain",lookup:function(t){var e,i;return"undefined"==typeof window||(i=window.location.href.match(/(?:http[s]*\:\/\/)*(.*?)\.(?=[^\/]*\..{2,5})/gi))instanceof Array&&(e=("number"==typeof t.lookupFromSubdomainIndex?i[t.lookupFromSubdomainIndex]:i[0]).replace("http://","").replace("https://","").replace(".","")),e}};t=function(){function i(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,i),this.type="languageDetector",this.detectors={},this.init(t,e)}var t,e,n;return t=i,(e=[{key:"init",value:function(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},i=2<arguments.length&&void 0!==arguments[2]?arguments[2]:{};this.services=t,this.options=function(i){return o.call(s.call(arguments,1),function(t){if(t)for(var e in t)void 0===i[e]&&(i[e]=t[e])}),i}(e,this.options||{},{order:["querystring","cookie","localStorage","sessionStorage","navigator","htmlTag"],lookupQuerystring:"lng",lookupCookie:"i18next",lookupLocalStorage:"i18nextLng",lookupSessionStorage:"i18nextLng",caches:["localStorage"],excludeCacheFor:["cimode"]}),this.options.lookupFromUrlIndex&&(this.options.lookupFromPathIndex=this.options.lookupFromUrlIndex),this.i18nOptions=i,this.addDetector(p),this.addDetector(u),this.addDetector(d),this.addDetector(y),this.addDetector(_),this.addDetector(m),this.addDetector(g),this.addDetector(f)}},{key:"addDetector",value:function(t){this.detectors[t.name]=t}},{key:"detect",value:function(t){var e=this;t=t||this.options.order;var i=[];return t.forEach(function(t){!e.detectors[t]||(t=(t=e.detectors[t].lookup(e.options))&&"string"==typeof t?[t]:t)&&(i=i.concat(t))}),this.services.languageUtils.getBestMatchFromCodes?i:0<i.length?i[0]:null}},{key:"cacheUserLanguage",value:function(e,t){var i=this;(t=t||this.options.caches)&&(this.options.excludeCacheFor&&-1<this.options.excludeCacheFor.indexOf(e)||t.forEach(function(t){i.detectors[t]&&i.detectors[t].cacheUserLanguage(e,i.options)}))}}])&&r(t.prototype,e),n&&r(t,n),i}();return t.type="languageDetector",t}),(()=>{var n={729:(t,e,i)=>{var i=[i,e,i(972)],i=function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Manager=void 0,Object.defineProperty(e,"Manager",{enumerable:!0,get:function(){return i.Manager}})}.apply(e,i);void 0===i||(t.exports=i)},972:(t,e,i)=>{e=function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Manager=void 0;var i=(n.getConsent=function(){return this.hasConsent},n.setConsent=function(t){this.hasConsent=t},n.setConfirmCallback=function(t){this.onConfirmCallback=t},n.setCancelCallback=function(t){this.onCancelCallback=t},n.init=function(t){var e=this,i=t.loginText,n=t.confirmText,r=t.cancelText;try{var o=document.createElement("link");o.rel="stylesheet",o.href="assets/css/lpt.css",document.head.appendChild(o)}catch(t){}var s=document.createElement("div");s.id="lgn-container",document.body.appendChild(s);o=document.createElement("div");o.id="lgn-pop-up",s.appendChild(o);s=document.createElement("div");s.id="lgn-txt",s.innerText=i,o.appendChild(s);s=document.createElement("div");s.id="lgn-btn-container",o.appendChild(s);o=document.createElement("div");o.className="lgn-btn",o.id="confirm",o.innerText=n,s.appendChild(o),o.onclick=function(){e.setConsent(!0),e.hidePopUp(),e.onConfirmCallback&&e.onConfirmCallback()};o=document.createElement("div");o.id="cancel",o.className="lgn-btn",o.innerText=r,s.appendChild(o),o.onclick=function(){e.setConsent(!1),e.hidePopUp(),e.onCancelCallback&&e.onCancelCallback()}},n.updateLoginText=function(t){document.getElementById("lgn-txt").innerText=t},n.showPopUp=function(){document.getElementById("lgn-container").style.display="block",document.getElementById("lgn-pop-up").className="lgn-container-anim-in"},n.hidePopUp=function(){document.getElementById("lgn-container").style.display="none"},n.sendToBack=function(){document.getElementById("lgn-container").style.zIndex="-1"},n.bringToFront=function(){document.getElementById("lgn-container").style.zIndex="1"},n.hasConsent=!1,n);function n(){}e.Manager=i}.apply(e,[i,e]);void 0===e||(t.exports=e)}},r={},t=function t(e){var i=r[e];if(void 0!==i)return i.exports;i=r[e]={exports:{}};return n[e](i,i.exports,t),i.exports}(729);self.azIntLoginPrompt=t})(),(()=>{var n={729:(t,e,i)=>{var i=[i,e,i(794)],i=function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Wrapper=void 0,Object.defineProperty(e,"Wrapper",{enumerable:!0,get:function(){return i.Wrapper}})}.apply(e,i);void 0===i||(t.exports=i)},128:(t,e,i)=>{var i=[i,e,i(338)],i=function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.DummyRatingsManager=void 0;var n=(r.prototype.getReviewed=function(){return this.reviewed},r.prototype.setReviewed=function(t){this.reviewed=!0},r.prototype.canReview=function(){return new Promise(function(t){t({value:!1,reason:i.RejectedReason.UNKNOWN})})},r.prototype.requestReview=function(){return new Promise(function(t){t({feedbackSent:!0})})},r);function r(){this.reviewed=!0}e.DummyRatingsManager=n}.apply(e,i);void 0===i||(t.exports=i)},47:function(t,e,i){var r=this&&this.__awaiter||function(t,s,a,h){return new(a=a||Promise)(function(i,e){function n(t){try{o(h.next(t))}catch(t){e(t)}}function r(t){try{o(h.throw(t))}catch(t){e(t)}}function o(t){var e;t.done?i(t.value):((e=t.value)instanceof a?e:new a(function(t){t(e)})).then(n,r)}o((h=h.apply(t,s||[])).next())})},o=this&&this.__generator||function(i,n){var r,o,s,a={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]},t={next:e(0),throw:e(1),return:e(2)};return"function"==typeof Symbol&&(t[Symbol.iterator]=function(){return this}),t;function e(e){return function(t){return function(e){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,o&&(s=2&e[0]?o.return:e[0]?o.throw||((s=o.return)&&s.call(o),0):o.next)&&!(s=s.call(o,e[1])).done)return s;switch(o=0,(e=s?[2&e[0],s.value]:e)[0]){case 0:case 1:s=e;break;case 4:return a.label++,{value:e[1],done:!1};case 5:a.label++,o=e[1],e=[0];continue;case 7:e=a.ops.pop(),a.trys.pop();continue;default:if(!((s=0<(s=a.trys).length&&s[s.length-1])||6!==e[0]&&2!==e[0])){a=0;continue}if(3===e[0]&&(!s||e[1]>s[0]&&e[1]<s[3])){a.label=e[1];break}if(6===e[0]&&a.label<s[1]){a.label=s[1],s=e;break}if(s&&a.label<s[2]){a.label=s[2],a.ops.push(e);break}s[2]&&a.ops.pop(),a.trys.pop();continue}e=n.call(i,a)}catch(t){e=[6,t],o=0}finally{r=s=0}if(5&e[0])throw e[1];return{value:e[0]?e[1]:void 0,done:!0}}([e,t])}}},e=function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.YandexRatingsManager=void 0;var i=(n.prototype.getReviewed=function(){return this.reviewed},n.prototype.setReviewed=function(t){this.reviewed=t},n.prototype.canReview=function(){var e;return r(this,void 0,void 0,function(){return o(this,function(t){return[2,null===(e=window._YaSDK)||void 0===e?void 0:e.feedback.canReview()]})})},n.prototype.requestReview=function(){var e;return r(this,void 0,void 0,function(){return o(this,function(t){return[2,null===(e=window._YaSDK)||void 0===e?void 0:e.feedback.requestReview()]})})},n);function n(){this.reviewed=!1}e.YandexRatingsManager=i}.apply(e,[i,e]);void 0===e||(t.exports=e)},707:(t,e,i)=>{e=function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.ManagerTypes=void 0,(e=e.ManagerTypes||(e.ManagerTypes={})).Yandex="yx",e.None="none"}.apply(e,[i,e]);void 0===e||(t.exports=e)},338:(t,e,i)=>{e=function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.RejectedReason=void 0,(e=e.RejectedReason||(e.RejectedReason={})).NO_AUTH="NO_AUTH",e.GAME_RATED="GAME_RATED",e.REVIEW_ALREADY_REQUESTED="REVIEW_ALREADY_REQUESTED",e.REVIEW_WAS_REQUESTED="REVIEW_WAS_REQUESTED",e.UNKNOWN="UNKNOWN"}.apply(e,[i,e]);void 0===e||(t.exports=e)},794:(t,e,i)=>{var i=[i,e,i(47),i(128),i(707)],i=function(t,e,i,n,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Wrapper=void 0;var o=(s.create=function(t){switch(t){case r.ManagerTypes.Yandex:this.manager=new i.YandexRatingsManager;break;default:case r.ManagerTypes.None:this.manager=new n.DummyRatingsManager}},s.getReviewed=function(){return this.manager.getReviewed()},s.setReviewed=function(t){this.manager.setReviewed(t)},s.canReview=function(){return this.manager.canReview()},s.requestReview=function(){return this.manager.requestReview()},s);function s(){}e.Wrapper=o}.apply(e,i);void 0===i||(t.exports=i)}},r={},t=function t(e){var i=r[e];if(void 0!==i)return i.exports;i=r[e]={exports:{}};return n[e].call(i.exports,i,i.exports,t),i.exports}(729);self.azIntRatings=t})(),function(t){function i(){for(var t=0;t<b.length;t++)b[t][0](b[t][1]);g=!(b=[])}function n(t,e){b.push([t,e]),g||(g=!0,z(i,0))}function e(t,e){function i(t){h(e,t)}try{t(function(t){s(e,t)},i)}catch(t){i(t)}}function r(e){var t=(i=e.owner).state_,i=i.data_,n=e[t];if(e=e.then,"function"==typeof n){t=v;try{i=n(i)}catch(t){h(e,t)}}o(e,i)||(t===v&&s(e,i),t===w&&h(e,i))}function o(e,i){var n;try{if(e===i)throw new TypeError("A promises callback cannot return that same promise.");if(i&&("function"==typeof i||"object"==typeof i)){var t=i.then;if("function"==typeof t)return t.call(i,function(t){n||(n=!0,(i!==t?s:a)(e,t))},function(t){n||(n=!0,h(e,t))}),1}}catch(t){return n||h(e,t),1}}function s(t,e){t!==e&&o(t,e)||a(t,e)}function a(t,e){t.state_===f&&(t.state_=x,t.data_=e,n(p,t))}function h(t,e){t.state_===f&&(t.state_=x,t.data_=e,n(u,t))}function l(t){var e=t.then_;for(t.then_=void 0,t=0;t<e.length;t++)r(e[t])}function p(t){t.state_=v,l(t)}function u(t){t.state_=w,l(t)}function d(t){if("function"!=typeof t)throw new TypeError("Promise constructor takes a function argument");if(!1==this instanceof d)throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.");this.then_=[],e(t,this)}var c,y=t.Promise,_=y&&"resolve"in y&&"reject"in y&&"all"in y&&"race"in y&&(new y(function(t){c=t}),"function"==typeof c);"undefined"!=typeof exports&&exports?(exports.Promise=_?y:d,exports.Polyfill=d):"function"==typeof define&&define.amd?define(function(){return _?y:d}):_||(t.Promise=d);function m(){}var g,f="pending",x="sealed",v="fulfilled",w="rejected",z="undefined"!=typeof setImmediate?setImmediate:setTimeout,b=[];d.prototype={constructor:d,state_:f,then_:null,data_:void 0,then:function(t,e){e={owner:this,then:new this.constructor(m),fulfilled:t,rejected:e};return this.state_===v||this.state_===w?n(r,e):this.then_.push(e),e.then},catch:function(t){return this.then(null,t)}},d.all=function(s){if("[object Array]"!==Object.prototype.toString.call(s))throw new TypeError("You must pass an array to Promise.all().");return new this(function(i,t){for(var e,n=[],r=0,o=0;o<s.length;o++)(e=s[o])&&"function"==typeof e.then?e.then(function(e){return r++,function(t){n[e]=t,--r||i(n)}}(o),t):n[o]=e;r||i(n)})},d.race=function(r){if("[object Array]"!==Object.prototype.toString.call(r))throw new TypeError("You must pass an array to Promise.race().");return new this(function(t,e){for(var i,n=0;n<r.length;n++)(i=r[n])&&"function"==typeof i.then?i.then(t,e):t(i)})},d.resolve=function(e){return e&&"object"==typeof e&&e.constructor===this?e:new this(function(t){t(e)})},d.reject=function(i){return new this(function(t,e){e(i)})}}("undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this),function(t){var e;"object"==typeof exports?module.exports=t():("undefined"!=typeof window?e=window:"undefined"!=typeof global?e=global:"undefined"!=typeof self&&(e=self),e.p2=t())}(function(){return function n(r,o,s){function a(i,t){if(!o[i]){if(!r[i]){var e="function"==typeof require&&require;if(!t&&e)return e(i,!0);if(h)return h(i,!0);throw new Error("Cannot find module '"+i+"'")}e=o[i]={exports:{}};r[i][0].call(e.exports,function(t){var e=r[i][1][t];return a(e||t)},e,e.exports,n,r,o,s)}return o[i].exports}for(var h="function"==typeof require&&require,t=0;t<s.length;t++)a(s[t]);return a}({1:[function(t,e,i){var l=t("./Scalar");function n(){}(e.exports=n).lineInt=function(t,e,i){var n=[0,0],r=t[1][1]-t[0][1],o=t[0][0]-t[1][0],s=r*t[0][0]+o*t[0][1],a=e[1][1]-e[0][1],h=e[0][0]-e[1][0],t=a*e[0][0]+h*e[0][1],e=r*h-a*o;return l.eq(e,0,i=i||0)||(n[0]=(h*s-o*t)/e,n[1]=(r*t-a*s)/e),n},n.segmentsIntersect=function(t,e,i,n){var r=e[0]-t[0],o=e[1]-t[1],s=n[0]-i[0],e=n[1]-i[1];if(s*o-e*r==0)return!1;n=(r*(i[1]-t[1])+o*(t[0]-i[0]))/(s*o-e*r),o=(s*(t[1]-i[1])+e*(i[0]-t[0]))/(e*r-s*o);return 0<=n&&n<=1&&0<=o&&o<=1}},{"./Scalar":4}],2:[function(t,e,i){function a(){}(e.exports=a).area=function(t,e,i){return(e[0]-t[0])*(i[1]-t[1])-(i[0]-t[0])*(e[1]-t[1])},a.left=function(t,e,i){return 0<a.area(t,e,i)},a.leftOn=function(t,e,i){return 0<=a.area(t,e,i)},a.right=function(t,e,i){return a.area(t,e,i)<0},a.rightOn=function(t,e,i){return a.area(t,e,i)<=0};var h=[],l=[];a.collinear=function(t,e,i,n){if(n){var r=h,o=l;r[0]=e[0]-t[0],r[1]=e[1]-t[1],o[0]=i[0]-e[0],o[1]=i[1]-e[1];var s=r[0]*o[0]+r[1]*o[1],r=Math.sqrt(r[0]*r[0]+r[1]*r[1]),o=Math.sqrt(o[0]*o[0]+o[1]*o[1]);return Math.acos(s/(r*o))<n}return 0==a.area(t,e,i)},a.sqdist=function(t,e){var i=e[0]-t[0],t=e[1]-t[1];return i*i+t*t}},{}],3:[function(t,e,i){var a=t("./Line"),z=t("./Point"),h=t("./Scalar");function b(){this.vertices=[]}(e.exports=b).prototype.at=function(t){var e=this.vertices,i=e.length;return e[t<0?t%i+i:t%i]},b.prototype.first=function(){return this.vertices[0]},b.prototype.last=function(){return this.vertices[this.vertices.length-1]},b.prototype.clear=function(){this.vertices.length=0},b.prototype.append=function(t,e,i){if(void 0===e)throw new Error("From is not given!");if(void 0===i)throw new Error("To is not given!");if(i-1<e)throw new Error("lol1");if(i>t.vertices.length)throw new Error("lol2");if(e<0)throw new Error("lol3");for(var n=e;n<i;n++)this.vertices.push(t.vertices[n])},b.prototype.makeCCW=function(){for(var t=0,e=this.vertices,i=1;i<this.vertices.length;++i)(e[i][1]<e[t][1]||e[i][1]==e[t][1]&&e[i][0]>e[t][0])&&(t=i);z.left(this.at(t-1),this.at(t),this.at(t+1))||this.reverse()},b.prototype.reverse=function(){for(var t=[],e=0,i=this.vertices.length;e!==i;e++)t.push(this.vertices.pop());this.vertices=t},b.prototype.isReflex=function(t){return z.right(this.at(t-1),this.at(t),this.at(t+1))};var l=[],p=[];function S(t,e,i,n,r){var o=e[1]-t[1],s=t[0]-e[0],a=o*t[0]+s*t[1],e=n[1]-i[1],t=i[0]-n[0],n=e*i[0]+t*i[1],i=o*t-e*s;return h.eq(i,0,r=r||0)?[0,0]:[(t*a-s*n)/i,(o*n-e*a)/i]}b.prototype.canSee=function(t,e){var i,n=l,r=p;if(z.leftOn(this.at(t+1),this.at(t),this.at(e))&&z.rightOn(this.at(t-1),this.at(t),this.at(e)))return!1;for(var o=z.sqdist(this.at(t),this.at(e)),s=0;s!==this.vertices.length;++s)if((s+1)%this.vertices.length!==t&&s!==t&&z.leftOn(this.at(t),this.at(e),this.at(s+1))&&z.rightOn(this.at(t),this.at(e),this.at(s))&&(n[0]=this.at(t),n[1]=this.at(e),r[0]=this.at(s),r[1]=this.at(s+1),i=a.lineInt(n,r),z.sqdist(this.at(t),i)<o))return!1;return!0},b.prototype.copy=function(t,e,i){var n=i||new b;if(n.clear(),t<e)for(var r=t;r<=e;r++)n.vertices.push(this.vertices[r]);else{for(r=0;r<=e;r++)n.vertices.push(this.vertices[r]);for(r=t;r<this.vertices.length;r++)n.vertices.push(this.vertices[r])}return n},b.prototype.getCutEdges=function(){for(var t=[],e=[],i=new b,n=Number.MAX_VALUE,r=0;r<this.vertices.length;++r)if(this.isReflex(r))for(var o=0;o<this.vertices.length;++o)if(this.canSee(r,o)){for(var e=this.copy(r,o,i).getCutEdges(),s=this.copy(o,r,i).getCutEdges(),a=0;a<s.length;a++)e.push(s[a]);e.length<n&&(n=(t=e).length,t.push([this.at(r),this.at(o)]))}return t},b.prototype.decomp=function(){var t=this.getCutEdges();return 0<t.length?this.slice(t):[this]},b.prototype.slice=function(t){if(0==t.length)return[this];if(t instanceof Array&&t.length&&t[0]instanceof Array&&2==t[0].length&&t[0][0]instanceof Array){for(var e=[this],i=0;i<t.length;i++)for(var n=t[i],r=0;r<e.length;r++){var o=e[r].slice(n);if(o){e.splice(r,1),e.push(o[0],o[1]);break}}return e}n=t,i=this.vertices.indexOf(n[0]),r=this.vertices.indexOf(n[1]);return-1!=i&&-1!=r&&[this.copy(i,r),this.copy(r,i)]},b.prototype.isSimple=function(){for(var t=this.vertices,e=0;e<t.length-1;e++)for(var i=0;i<e-1;i++)if(a.segmentsIntersect(t[e],t[e+1],t[i],t[i+1]))return!1;for(e=1;e<t.length-2;e++)if(a.segmentsIntersect(t[0],t[t.length-1],t[e],t[e+1]))return!1;return!0},b.prototype.quickDecomp=function(t,e,i,n,r,o){r=r||100,o=o||0,n=n||25,t=void 0!==t?t:[],e=e||[],i=i||[];var s=[0,0],a=[0,0],h=[0,0],l=0,p=0,u=0,d=0,c=0,y=0,_=0,m=new b,g=new b,f=this,x=this.vertices;if(x.length<3)return t;if(r<++o)return t;for(var v=0;v<this.vertices.length;++v)if(f.isReflex(v)){e.push(f.vertices[v]);for(var l=p=Number.MAX_VALUE,w=0;w<this.vertices.length;++w)z.left(f.at(v-1),f.at(v),f.at(w))&&z.rightOn(f.at(v-1),f.at(v),f.at(w-1))&&(h=S(f.at(v-1),f.at(v),f.at(w),f.at(w-1)),z.right(f.at(v+1),f.at(v),h)&&(u=z.sqdist(f.vertices[v],h))<p&&(p=u,a=h,y=w)),z.left(f.at(v+1),f.at(v),f.at(w+1))&&z.rightOn(f.at(v+1),f.at(v),f.at(w))&&(h=S(f.at(v+1),f.at(v),f.at(w),f.at(w+1)),z.left(f.at(v-1),f.at(v),h)&&(u=z.sqdist(f.vertices[v],h))<l&&(l=u,s=h,c=w));if(y==(c+1)%this.vertices.length)h[0]=(a[0]+s[0])/2,h[1]=(a[1]+s[1])/2,i.push(h),v<c?(m.append(f,v,c+1),m.vertices.push(h),g.vertices.push(h),0!=y&&g.append(f,y,f.vertices.length),g.append(f,0,v+1)):(0!=v&&m.append(f,v,f.vertices.length),m.append(f,0,c+1),m.vertices.push(h),g.vertices.push(h),g.append(f,y,v+1));else{if(c<y&&(c+=this.vertices.length),d=Number.MAX_VALUE,c<y)return t;for(w=y;w<=c;++w)z.leftOn(f.at(v-1),f.at(v),f.at(w))&&z.rightOn(f.at(v+1),f.at(v),f.at(w))&&(u=z.sqdist(f.at(v),f.at(w)))<d&&(d=u,_=w%this.vertices.length);v<_?(m.append(f,v,_+1),0!=_&&g.append(f,_,x.length),g.append(f,0,v+1)):(0!=v&&m.append(f,v,x.length),m.append(f,0,_+1),g.append(f,_,v+1))}return m.vertices.length<g.vertices.length?(m.quickDecomp(t,e,i,n,r,o),g.quickDecomp(t,e,i,n,r,o)):(g.quickDecomp(t,e,i,n,r,o),m.quickDecomp(t,e,i,n,r,o)),t}return t.push(this),t},b.prototype.removeCollinearPoints=function(t){for(var e=0,i=this.vertices.length-1;3<this.vertices.length&&0<=i;--i)z.collinear(this.at(i-1),this.at(i),this.at(i+1),t)&&(this.vertices.splice(i%this.vertices.length,1),i--,e++);return e}},{"./Line":1,"./Point":2,"./Scalar":4}],4:[function(t,e,i){function n(){}(e.exports=n).eq=function(t,e,i){return i=i||0,Math.abs(t-e)<i}},{}],5:[function(t,e,i){e.exports={Polygon:t("./Polygon"),Point:t("./Point")}},{"./Point":2,"./Polygon":3}],6:[function(t,e,i){e.exports={name:"p2",version:"0.7.0",description:"A JavaScript 2D physics engine.",author:"Stefan Hedman <schteppe@gmail.com> (http://steffe.se)",keywords:["p2.js","p2","physics","engine","2d"],main:"./src/p2.js",engines:{node:"*"},repository:{type:"git",url:"https://github.com/schteppe/p2.js.git"},bugs:{url:"https://github.com/schteppe/p2.js/issues"},licenses:[{type:"MIT"}],devDependencies:{grunt:"^0.4.5","grunt-contrib-jshint":"^0.11.2","grunt-contrib-nodeunit":"^0.4.1","grunt-contrib-uglify":"~0.4.0","grunt-contrib-watch":"~0.5.0","grunt-browserify":"~2.0.1","grunt-contrib-concat":"^0.4.0"},dependencies:{"poly-decomp":"0.1.0"}}},{}],7:[function(t,e,i){var c=t("../math/vec2");t("../utils/Utils");function n(t){this.lowerBound=c.create(),t&&t.lowerBound&&c.copy(this.lowerBound,t.lowerBound),this.upperBound=c.create(),t&&t.upperBound&&c.copy(this.upperBound,t.upperBound)}e.exports=n;var y=c.create();n.prototype.setFromPoints=function(t,e,i,n){var r=this.lowerBound,o=this.upperBound;0!==(i="number"!=typeof i?0:i)?c.rotate(r,t[0],i):c.copy(r,t[0]),c.copy(o,r);for(var s=Math.cos(i),a=Math.sin(i),h=1;h<t.length;h++){var l,p,u=t[h];0!==i&&(l=u[0],p=u[1],y[0]=s*l-a*p,y[1]=a*l+s*p,u=y);for(var d=0;d<2;d++)u[d]>o[d]&&(o[d]=u[d]),u[d]<r[d]&&(r[d]=u[d])}e&&(c.add(this.lowerBound,this.lowerBound,e),c.add(this.upperBound,this.upperBound,e)),n&&(this.lowerBound[0]-=n,this.lowerBound[1]-=n,this.upperBound[0]+=n,this.upperBound[1]+=n)},n.prototype.copy=function(t){c.copy(this.lowerBound,t.lowerBound),c.copy(this.upperBound,t.upperBound)},n.prototype.extend=function(t){for(var e=2;e--;){var i=t.lowerBound[e];this.lowerBound[e]>i&&(this.lowerBound[e]=i);i=t.upperBound[e];this.upperBound[e]<i&&(this.upperBound[e]=i)}},n.prototype.overlaps=function(t){var e=this.lowerBound,i=this.upperBound,n=t.lowerBound,t=t.upperBound;return(n[0]<=i[0]&&i[0]<=t[0]||e[0]<=t[0]&&t[0]<=i[0])&&(n[1]<=i[1]&&i[1]<=t[1]||e[1]<=t[1]&&t[1]<=i[1])},n.prototype.containsPoint=function(t){var e=this.lowerBound,i=this.upperBound;return e[0]<=t[0]&&t[0]<=i[0]&&e[1]<=t[1]&&t[1]<=i[1]},n.prototype.overlapsRay=function(t){var e=1/t.direction[0],i=1/t.direction[1],n=(this.lowerBound[0]-t.from[0])*e,r=(this.upperBound[0]-t.from[0])*e,e=(this.lowerBound[1]-t.from[1])*i,t=(this.upperBound[1]-t.from[1])*i,i=Math.max(Math.max(Math.min(n,r),Math.min(e,t))),t=Math.min(Math.min(Math.max(n,r),Math.max(e,t)));return t<0||t<i?-1:i}},{"../math/vec2":30,"../utils/Utils":57}],8:[function(t,e,i){var n=t("../math/vec2"),r=t("../objects/Body");function o(t){this.type=t,this.result=[],this.world=null,this.boundingVolumeType=o.AABB}(e.exports=o).AABB=1,o.BOUNDING_CIRCLE=2,o.prototype.setWorld=function(t){this.world=t},o.prototype.getCollisionPairs=function(t){};var s=n.create();o.boundingRadiusCheck=function(t,e){n.sub(s,t.position,e.position);var i=n.squaredLength(s),e=t.boundingRadius+e.boundingRadius;return i<=e*e},o.aabbCheck=function(t,e){return t.getAABB().overlaps(e.getAABB())},o.prototype.boundingVolumeCheck=function(t,e){var i;switch(this.boundingVolumeType){case o.BOUNDING_CIRCLE:i=o.boundingRadiusCheck(t,e);break;case o.AABB:i=o.aabbCheck(t,e);break;default:throw new Error("Bounding volume type not recognized: "+this.boundingVolumeType)}return i},o.canCollide=function(t,e){var i=r.KINEMATIC,n=r.STATIC;return(t.type!==n||e.type!==n)&&(!(t.type===i&&e.type===n||t.type===n&&e.type===i)&&((t.type!==i||e.type!==i)&&((t.sleepState!==r.SLEEPING||e.sleepState!==r.SLEEPING)&&!(t.sleepState===r.SLEEPING&&e.type===n||e.sleepState===r.SLEEPING&&t.type===n))))},o.NAIVE=1,o.SAP=2},{"../math/vec2":30,"../objects/Body":31}],9:[function(t,e,i){t("../shapes/Circle"),t("../shapes/Plane"),t("../shapes/Shape"),t("../shapes/Particle");var h=t("../collision/Broadphase");t("../math/vec2");function n(){h.call(this,h.NAIVE)}(((e.exports=n).prototype=new h).constructor=n).prototype.getCollisionPairs=function(t){for(var e=t.bodies,i=this.result,n=i.length=0,r=e.length;n!==r;n++)for(var o=e[n],s=0;s<n;s++){var a=e[s];h.canCollide(o,a)&&this.boundingVolumeCheck(o,a)&&i.push(o,a)}return i},n.prototype.aabbQuery=function(t,e,i){i=i||[];for(var n=t.bodies,r=0;r<n.length;r++){var o=n[r];o.aabbNeedsUpdate&&o.updateAABB(),o.aabb.overlaps(e)&&i.push(o)}return i}},{"../collision/Broadphase":8,"../math/vec2":30,"../shapes/Circle":39,"../shapes/Particle":43,"../shapes/Plane":44,"../shapes/Shape":45}],10:[function(t,e,i){var N=t("../math/vec2"),j=N.sub,U=N.add,V=N.dot,n=(t("../utils/Utils"),t("../utils/ContactEquationPool")),r=t("../utils/FrictionEquationPool"),o=t("../utils/TupleDictionary"),s=t("../equations/Equation"),a=(t("../equations/ContactEquation"),t("../equations/FrictionEquation"),t("../shapes/Circle")),h=t("../shapes/Convex"),l=t("../shapes/Shape"),b=(t("../objects/Body"),t("../shapes/Box"));e.exports=Q;var S=N.fromValues(0,1),W=N.fromValues(0,0),X=N.fromValues(0,0),H=N.fromValues(0,0),q=N.fromValues(0,0),Y=N.fromValues(0,0),k=N.fromValues(0,0),K=N.fromValues(0,0),Z=N.fromValues(0,0),J=N.fromValues(0,0),O=N.fromValues(0,0),E=N.fromValues(0,0),I=N.fromValues(0,0),G=N.fromValues(0,0),D=N.fromValues(0,0),A=N.fromValues(0,0),L=N.fromValues(0,0),P=N.fromValues(0,0),M=N.fromValues(0,0),B=[];function Q(){this.contactEquations=[],this.frictionEquations=[],this.enableFriction=!0,this.enabledEquations=!0,this.slipForce=10,this.frictionCoefficient=.3,this.surfaceVelocity=0,this.contactEquationPool=new n({size:32}),this.frictionEquationPool=new r({size:64}),this.restitution=0,this.stiffness=s.DEFAULT_STIFFNESS,this.relaxation=s.DEFAULT_RELAXATION,this.frictionStiffness=s.DEFAULT_STIFFNESS,this.frictionRelaxation=s.DEFAULT_RELAXATION,this.enableFrictionReduction=!0,this.collidingBodiesLastStep=new o,this.contactSkinSize=.01}var p=N.create(),u=N.create();function f(t,e){N.set(t.vertices[0],.5*-e.length,-e.radius),N.set(t.vertices[1],.5*e.length,-e.radius),N.set(t.vertices[2],.5*e.length,e.radius),N.set(t.vertices[3],.5*-e.length,e.radius)}Q.prototype.bodiesOverlap=function(t,e){for(var i=p,n=u,r=0,o=t.shapes.length;r!==o;r++){var s=t.shapes[r];t.toWorldFrame(i,s.position);for(var a=0,h=e.shapes.length;a!==h;a++){var l=e.shapes[a];if(e.toWorldFrame(n,l.position),this[s.type|l.type](t,s,i,s.angle+t.angle,e,l,n,l.angle+e.angle,!0))return!0}}return!1},Q.prototype.collidedLastStep=function(t,e){t=0|t.id,e=0|e.id;return!!this.collidingBodiesLastStep.get(t,e)},Q.prototype.reset=function(){this.collidingBodiesLastStep.reset();for(var t=this.contactEquations,e=t.length;e--;){var i=t[e],n=i.bodyA.id,i=i.bodyB.id;this.collidingBodiesLastStep.set(n,i,!0)}for(var r=this.contactEquations,o=this.frictionEquations,s=0;s<r.length;s++)this.contactEquationPool.release(r[s]);for(s=0;s<o.length;s++)this.frictionEquationPool.release(o[s]);this.contactEquations.length=this.frictionEquations.length=0},Q.prototype.createContactEquation=function(t,e,i,n){var r=this.contactEquationPool.get();return r.bodyA=t,r.bodyB=e,r.shapeA=i,r.shapeB=n,r.restitution=this.restitution,r.firstImpact=!this.collidedLastStep(t,e),r.stiffness=this.stiffness,r.relaxation=this.relaxation,r.needsUpdate=!0,r.enabled=this.enabledEquations,r.offset=this.contactSkinSize,r},Q.prototype.createFrictionEquation=function(t,e,i,n){var r=this.frictionEquationPool.get();return r.bodyA=t,r.bodyB=e,r.shapeA=i,r.shapeB=n,r.setSlipForce(this.slipForce),r.frictionCoefficient=this.frictionCoefficient,r.relativeVelocity=this.surfaceVelocity,r.enabled=this.enabledEquations,r.needsUpdate=!0,r.stiffness=this.frictionStiffness,r.relaxation=this.frictionRelaxation,r.contactEquations.length=0,r},Q.prototype.createFrictionFromContact=function(t){var e=this.createFrictionEquation(t.bodyA,t.bodyB,t.shapeA,t.shapeB);return N.copy(e.contactPointA,t.contactPointA),N.copy(e.contactPointB,t.contactPointB),N.rotate90cw(e.t,t.normalA),e.contactEquations.push(t),e},Q.prototype.createFrictionFromAverage=function(t){var e=this.contactEquations[this.contactEquations.length-1],i=this.createFrictionEquation(e.bodyA,e.bodyB,e.shapeA,e.shapeB),n=e.bodyA;e.bodyB;N.set(i.contactPointA,0,0),N.set(i.contactPointB,0,0),N.set(i.t,0,0);for(var r=0;r!==t;r++)(e=this.contactEquations[this.contactEquations.length-1-r]).bodyA===n?(N.add(i.t,i.t,e.normalA),N.add(i.contactPointA,i.contactPointA,e.contactPointA),N.add(i.contactPointB,i.contactPointB,e.contactPointB)):(N.sub(i.t,i.t,e.normalA),N.add(i.contactPointA,i.contactPointA,e.contactPointB),N.add(i.contactPointB,i.contactPointB,e.contactPointA)),i.contactEquations.push(e);var o=1/t;return N.scale(i.contactPointA,i.contactPointA,o),N.scale(i.contactPointB,i.contactPointB,o),N.normalize(i.t,i.t),N.rotate90cw(i.t,i.t),i},Q.prototype[l.LINE|l.CONVEX]=Q.prototype.convexLine=function(t,e,i,n,r,o,s,a,h){return!h&&0},Q.prototype[l.LINE|l.BOX]=Q.prototype.lineBox=function(t,e,i,n,r,o,s,a,h){return!h&&0};var d=new b({width:1,height:1}),c=N.create();Q.prototype[l.CAPSULE|l.CONVEX]=Q.prototype[l.CAPSULE|l.BOX]=Q.prototype.convexCapsule=function(t,e,i,n,r,o,s,a,h){var l=c;N.set(l,o.length/2,0),N.rotate(l,l,a),N.add(l,l,s);var p=this.circleConvex(r,o,l,a,t,e,i,n,h,o.radius);N.set(l,-o.length/2,0),N.rotate(l,l,a),N.add(l,l,s);var u=this.circleConvex(r,o,l,a,t,e,i,n,h,o.radius);if(h&&(p||u))return!0;l=d;return f(l,o),this.convexConvex(t,e,i,n,r,l,s,a,h)+p+u},Q.prototype[l.CAPSULE|l.LINE]=Q.prototype.lineCapsule=function(t,e,i,n,r,o,s,a,h){return!h&&0};var x=N.create(),v=N.create(),w=new b({width:1,height:1});Q.prototype[l.CAPSULE|l.CAPSULE]=Q.prototype.capsuleCapsule=function(t,e,i,n,r,o,s,a,h){for(var l=x,p=v,u=0,d=0;d<2;d++){N.set(l,(0===d?-1:1)*e.length/2,0),N.rotate(l,l,n),N.add(l,l,i);for(var c=0;c<2;c++){N.set(p,(0===c?-1:1)*o.length/2,0),N.rotate(p,p,a),N.add(p,p,s),this.enableFrictionReduction&&(m=this.enableFriction,this.enableFriction=!1);var y=this.circleCircle(t,e,l,n,r,o,p,a,h,e.radius,o.radius);if(this.enableFrictionReduction&&(this.enableFriction=m),h&&y)return!0;u+=y}}this.enableFrictionReduction&&(m=this.enableFriction,this.enableFriction=!1);var _=w;f(_,e);var m,g=this.convexCapsule(t,_,i,n,r,o,s,a,h);if(this.enableFrictionReduction&&(this.enableFriction=m),h&&g)return!0;u+=g,this.enableFrictionReduction&&(m=this.enableFriction,this.enableFriction=!1),f(_,o);_=this.convexCapsule(r,_,s,a,t,e,i,n,h);return this.enableFrictionReduction&&(this.enableFriction=m),!(!h||!_)||(u+=_,this.enableFrictionReduction&&u&&this.enableFriction&&this.frictionEquations.push(this.createFrictionFromAverage(u)),u)},Q.prototype[l.LINE|l.LINE]=Q.prototype.lineLine=function(t,e,i,n,r,o,s,a,h){return!h&&0},Q.prototype[l.PLANE|l.LINE]=Q.prototype.planeLine=function(t,e,i,n,r,o,s,a,h){var l=W,p=X,u=H,d=q,c=Y,y=k,_=K,m=Z,g=J,f=B,x=0;N.set(l,-o.length/2,0),N.set(p,o.length/2,0),N.rotate(u,l,a),N.rotate(d,p,a),U(u,u,s),U(d,d,s),N.copy(l,u),N.copy(p,d),j(c,p,l),N.normalize(y,c),N.rotate90cw(g,y),N.rotate(m,S,n),f[0]=l,f[1]=p;for(var v=0;v<f.length;v++){var w=f[v];j(_,w,i);var z=V(_,m);if(z<0){if(h)return!0;var b=this.createContactEquation(t,r,e,o);x++,N.copy(b.normalA,m),N.normalize(b.normalA,b.normalA),N.scale(_,m,z),j(b.contactPointA,w,_),j(b.contactPointA,b.contactPointA,t.position),j(b.contactPointB,w,s),U(b.contactPointB,b.contactPointB,s),j(b.contactPointB,b.contactPointB,r.position),this.contactEquations.push(b),this.enableFrictionReduction||this.enableFriction&&this.frictionEquations.push(this.createFrictionFromContact(b))}}return!h&&(this.enableFrictionReduction||x&&this.enableFriction&&this.frictionEquations.push(this.createFrictionFromAverage(x)),x)},Q.prototype[l.PARTICLE|l.CAPSULE]=Q.prototype.particleCapsule=function(t,e,i,n,r,o,s,a,h){return this.circleLine(t,e,i,n,r,o,s,a,h,o.radius,0)},Q.prototype[l.CIRCLE|l.LINE]=Q.prototype.circleLine=function(t,e,i,n,r,o,s,a,h,l,p){var l=l||0,p=void 0!==p?p:e.radius,u=W,d=X,c=H,y=q,_=Y,m=k,g=K,f=Z,x=J,v=O,w=E,z=I,b=G,S=D,C=B;N.set(f,-o.length/2,0),N.set(x,o.length/2,0),N.rotate(v,f,a),N.rotate(w,x,a),U(v,v,s),U(w,w,s),N.copy(f,v),N.copy(x,w),j(m,x,f),N.normalize(g,m),N.rotate90cw(_,g),j(z,i,f);m=V(z,_);j(y,f,s),j(b,i,s);var P=p+l;if(Math.abs(m)<P){N.scale(u,_,m),j(c,i,u),N.scale(d,_,V(_,b)),N.normalize(d,d),N.scale(d,d,l),U(c,c,d);b=V(g,c),d=V(g,f),g=V(g,x);if(d<b&&b<g){if(h)return!0;var M=this.createContactEquation(t,r,e,o);return N.scale(M.normalA,u,-1),N.normalize(M.normalA,M.normalA),N.scale(M.contactPointA,M.normalA,p),U(M.contactPointA,M.contactPointA,i),j(M.contactPointA,M.contactPointA,t.position),j(M.contactPointB,c,s),U(M.contactPointB,M.contactPointB,s),j(M.contactPointB,M.contactPointB,r.position),this.contactEquations.push(M),this.enableFriction&&this.frictionEquations.push(this.createFrictionFromContact(M)),1}}C[0]=f,C[1]=x;for(var T=0;T<C.length;T++){var A=C[T];if(j(z,A,i),N.squaredLength(z)<Math.pow(P,2)){if(h)return!0;M=this.createContactEquation(t,r,e,o);return N.copy(M.normalA,z),N.normalize(M.normalA,M.normalA),N.scale(M.contactPointA,M.normalA,p),U(M.contactPointA,M.contactPointA,i),j(M.contactPointA,M.contactPointA,t.position),j(M.contactPointB,A,s),N.scale(S,M.normalA,-l),U(M.contactPointB,M.contactPointB,S),U(M.contactPointB,M.contactPointB,s),j(M.contactPointB,M.contactPointB,r.position),this.contactEquations.push(M),this.enableFriction&&this.frictionEquations.push(this.createFrictionFromContact(M)),1}}return 0},Q.prototype[l.CIRCLE|l.CAPSULE]=Q.prototype.circleCapsule=function(t,e,i,n,r,o,s,a,h){return this.circleLine(t,e,i,n,r,o,s,a,h,o.radius)},Q.prototype[l.CIRCLE|l.CONVEX]=Q.prototype[l.CIRCLE|l.BOX]=Q.prototype.circleConvex=function(t,e,i,n,r,o,s,a,h,l){for(var l="number"==typeof l?l:e.radius,p=W,u=X,d=H,c=q,y=Y,_=O,m=E,g=G,f=D,x=A,v=L,w=!1,z=Number.MAX_VALUE,b=o.vertices,S=0;S!==b.length+1;S++){var C=b[S%b.length],P=b[(S+1)%b.length];N.rotate(p,C,a),N.rotate(u,P,a),U(p,p,s),U(u,u,s),j(d,u,p),N.normalize(c,d),N.rotate90cw(y,c),N.scale(f,y,-e.radius),U(f,f,i),R(f,o,s,a)&&(N.sub(x,p,f),(P=Math.abs(N.dot(x,y)))<z&&(N.copy(v,f),N.scale(g,y,z=P),N.add(g,g,f),w=!0))}if(w){if(h)return!0;var M=this.createContactEquation(t,r,e,o);return N.sub(M.normalA,v,i),N.normalize(M.normalA,M.normalA),N.scale(M.contactPointA,M.normalA,l),U(M.contactPointA,M.contactPointA,i),j(M.contactPointA,M.contactPointA,t.position),j(M.contactPointB,g,s),U(M.contactPointB,M.contactPointB,s),j(M.contactPointB,M.contactPointB,r.position),this.contactEquations.push(M),this.enableFriction&&this.frictionEquations.push(this.createFrictionFromContact(M)),1}if(0<l)for(S=0;S<b.length;S++){var T=b[S];if(N.rotate(m,T,a),U(m,m,s),j(_,m,i),N.squaredLength(_)<Math.pow(l,2)){if(h)return!0;M=this.createContactEquation(t,r,e,o);return N.copy(M.normalA,_),N.normalize(M.normalA,M.normalA),N.scale(M.contactPointA,M.normalA,l),U(M.contactPointA,M.contactPointA,i),j(M.contactPointA,M.contactPointA,t.position),j(M.contactPointB,m,s),U(M.contactPointB,M.contactPointB,s),j(M.contactPointB,M.contactPointB,r.position),this.contactEquations.push(M),this.enableFriction&&this.frictionEquations.push(this.createFrictionFromContact(M)),1}}return 0};var y=N.create(),_=N.create(),m=N.create(),g=N.create();function R(t,e,i,n){for(var r=y,o=_,s=m,a=g,h=t,l=e.vertices,p=null,u=0;u!==l.length+1;u++){var d=l[u%l.length],c=l[(u+1)%l.length];N.rotate(r,d,n),N.rotate(o,c,n),U(r,r,i),U(o,o,i),j(s,r,h),j(a,o,h);c=N.crossLength(s,a);if(c*(p=null===p?c:p)<=0)return;p=c}return 1}Q.prototype[l.PARTICLE|l.CONVEX]=Q.prototype[l.PARTICLE|l.BOX]=Q.prototype.particleConvex=function(t,e,i,n,r,o,s,a,h){var l=W,p=X,u=H,d=q,c=Y,y=k,_=K,m=O,g=G,f=P,x=M,v=Number.MAX_VALUE,w=!1,z=o.vertices;if(!R(i,o,s,a))return 0;if(h)return!0;for(var b=0;b!==z.length+1;b++){var S=z[b%z.length],C=z[(b+1)%z.length];N.rotate(l,S,a),N.rotate(p,C,a),U(l,l,s),U(p,p,s),j(u,p,l),N.normalize(d,u),N.rotate90cw(c,d),j(m,i,l);V(m,c);j(y,l,s),j(_,i,s),N.sub(f,l,i);C=Math.abs(N.dot(f,c));C<v&&(N.scale(g,c,v=C),N.add(g,g,i),N.copy(x,c),w=!0)}if(w){o=this.createContactEquation(t,r,e,o);return N.scale(o.normalA,x,-1),N.normalize(o.normalA,o.normalA),N.set(o.contactPointA,0,0),U(o.contactPointA,o.contactPointA,i),j(o.contactPointA,o.contactPointA,t.position),j(o.contactPointB,g,s),U(o.contactPointB,o.contactPointB,s),j(o.contactPointB,o.contactPointB,r.position),this.contactEquations.push(o),this.enableFriction&&this.frictionEquations.push(this.createFrictionFromContact(o)),1}return 0},Q.prototype[l.CIRCLE]=Q.prototype.circleCircle=function(t,e,i,n,r,o,s,a,h,l,p){var u=W,l=l||e.radius,p=p||o.radius;j(u,i,s);var d=l+p;if(N.squaredLength(u)>Math.pow(d,2))return 0;if(h)return!0;o=this.createContactEquation(t,r,e,o);return j(o.normalA,s,i),N.normalize(o.normalA,o.normalA),N.scale(o.contactPointA,o.normalA,l),N.scale(o.contactPointB,o.normalA,-p),U(o.contactPointA,o.contactPointA,i),j(o.contactPointA,o.contactPointA,t.position),U(o.contactPointB,o.contactPointB,s),j(o.contactPointB,o.contactPointB,r.position),this.contactEquations.push(o),this.enableFriction&&this.frictionEquations.push(this.createFrictionFromContact(o)),1},Q.prototype[l.PLANE|l.CONVEX]=Q.prototype[l.PLANE|l.BOX]=Q.prototype.planeConvex=function(t,e,i,n,r,o,s,a,h){var l=W,p=X,u=H,d=0;N.rotate(p,S,n);for(var c=0;c!==o.vertices.length;c++){var y=o.vertices[c];if(N.rotate(l,y,a),U(l,l,s),j(u,l,i),V(u,p)<=0){if(h)return!0;d++;var _=this.createContactEquation(t,r,e,o);j(u,l,i),N.copy(_.normalA,p);y=V(u,_.normalA);N.scale(u,_.normalA,y),j(_.contactPointB,l,r.position),j(_.contactPointA,l,u),j(_.contactPointA,_.contactPointA,t.position),this.contactEquations.push(_),this.enableFrictionReduction||this.enableFriction&&this.frictionEquations.push(this.createFrictionFromContact(_))}}return this.enableFrictionReduction&&this.enableFriction&&d&&this.frictionEquations.push(this.createFrictionFromAverage(d)),d},Q.prototype[l.PARTICLE|l.PLANE]=Q.prototype.particlePlane=function(t,e,i,n,r,o,s,a,h){var l=W,p=X;a=a||0,j(l,i,s),N.rotate(p,S,a);a=V(l,p);if(0<a)return 0;if(h)return!0;e=this.createContactEquation(r,t,o,e);return N.copy(e.normalA,p),N.scale(l,e.normalA,a),j(e.contactPointA,i,l),j(e.contactPointA,e.contactPointA,r.position),j(e.contactPointB,i,t.position),this.contactEquations.push(e),this.enableFriction&&this.frictionEquations.push(this.createFrictionFromContact(e)),1},Q.prototype[l.CIRCLE|l.PARTICLE]=Q.prototype.circleParticle=function(t,e,i,n,r,o,s,a,h){var l=W;if(j(l,s,i),N.squaredLength(l)>Math.pow(e.radius,2))return 0;if(h)return!0;o=this.createContactEquation(t,r,e,o);return N.copy(o.normalA,l),N.normalize(o.normalA,o.normalA),N.scale(o.contactPointA,o.normalA,e.radius),U(o.contactPointA,o.contactPointA,i),j(o.contactPointA,o.contactPointA,t.position),j(o.contactPointB,s,r.position),this.contactEquations.push(o),this.enableFriction&&this.frictionEquations.push(this.createFrictionFromContact(o)),1};var z=new a({radius:1}),C=N.create(),T=N.create();N.create();Q.prototype[l.PLANE|l.CAPSULE]=Q.prototype.planeCapsule=function(t,e,i,n,r,o,s,a,h){var l,p=C,u=T,d=z;N.set(p,-o.length/2,0),N.rotate(p,p,a),U(p,p,s),N.set(u,o.length/2,0),N.rotate(u,u,a),U(u,u,s),d.radius=o.radius,this.enableFrictionReduction&&(l=this.enableFriction,this.enableFriction=!1);p=this.circlePlane(r,d,p,0,t,e,i,n,h),n=this.circlePlane(r,d,u,0,t,e,i,n,h);if(this.enableFrictionReduction&&(this.enableFriction=l),h)return p||n;n=p+n;return this.enableFrictionReduction&&n&&this.frictionEquations.push(this.createFrictionFromAverage(n)),n},Q.prototype[l.CIRCLE|l.PLANE]=Q.prototype.circlePlane=function(t,e,i,n,r,o,s,a,h){var l=t,p=e,u=i,d=r,t=s,i=a||0,r=W,s=X,a=H;j(r,u,t),N.rotate(s,S,i);i=V(s,r);if(i>p.radius)return 0;if(h)return!0;e=this.createContactEquation(d,l,o,e);return N.copy(e.normalA,s),N.scale(e.contactPointB,e.normalA,-p.radius),U(e.contactPointB,e.contactPointB,u),j(e.contactPointB,e.contactPointB,l.position),N.scale(a,e.normalA,i),j(e.contactPointA,r,a),U(e.contactPointA,e.contactPointA,t),j(e.contactPointA,e.contactPointA,d.position),this.contactEquations.push(e),this.enableFriction&&this.frictionEquations.push(this.createFrictionFromContact(e)),1},Q.prototype[l.CONVEX]=Q.prototype[l.CONVEX|l.BOX]=Q.prototype[l.BOX]=Q.prototype.convexConvex=function(t,e,i,n,r,o,s,a,h,l){var p=W,u=X,d=H,c=q,y=Y,_=K,m=Z,g=J,f=0,l="number"==typeof l?l:0;if(!Q.findSeparatingAxis(e,i,n,o,s,a,p))return 0;j(m,s,i),0<V(p,m)&&N.scale(p,p,-1);var x=Q.getClosestEdge(e,n,p,!0),v=Q.getClosestEdge(o,a,p);if(-1===x||-1===v)return 0;for(var w=0;w<2;w++){var z,b=x,S=v,C=e,P=o,M=i,T=s,A=n,k=a,O=t,E=r;0===w&&(z=b,b=S,S=z,z=C,C=P,P=z,z=M,M=T,T=z,z=A,A=a,k=z,z=O,O=E,E=z);for(var I=S;I<S+2;I++){var G=P.vertices[(I+P.vertices.length)%P.vertices.length];N.rotate(u,G,k),U(u,u,T);for(var D=0,L=b-1;L<b+2;L++){var B=C.vertices[(L+C.vertices.length)%C.vertices.length],R=C.vertices[(L+1+C.vertices.length)%C.vertices.length];N.rotate(d,B,A),N.rotate(c,R,A),U(d,d,M),U(c,c,M),j(y,c,d),N.rotate90cw(g,y),N.normalize(g,g),j(m,u,d);var F=V(g,m);(L===b&&F<=l||L!==b&&F<=0)&&D++}if(3<=D){if(h)return!0;G=this.createContactEquation(O,E,C,P);f++;B=C.vertices[b%C.vertices.length],R=C.vertices[(b+1)%C.vertices.length];N.rotate(d,B,A),N.rotate(c,R,A),U(d,d,M),U(c,c,M),j(y,c,d),N.rotate90cw(G.normalA,y),N.normalize(G.normalA,G.normalA),j(m,u,d);F=V(G.normalA,m);N.scale(_,G.normalA,F),j(G.contactPointA,u,M),j(G.contactPointA,G.contactPointA,_),U(G.contactPointA,G.contactPointA,M),j(G.contactPointA,G.contactPointA,O.position),j(G.contactPointB,u,T),U(G.contactPointB,G.contactPointB,T),j(G.contactPointB,G.contactPointB,E.position),this.contactEquations.push(G),this.enableFrictionReduction||this.enableFriction&&this.frictionEquations.push(this.createFrictionFromContact(G))}}}return this.enableFrictionReduction&&this.enableFriction&&f&&this.frictionEquations.push(this.createFrictionFromAverage(f)),f};var F=N.fromValues(0,0);Q.projectConvexOntoAxis=function(t,e,i,n,r){var o,s=null,a=null,h=F;N.rotate(h,n,-i);for(var l=0;l<t.vertices.length;l++)o=t.vertices[l],o=V(o,h),(null===s||s<o)&&(s=o),(null===a||o<a)&&(a=o);s<a&&(i=a,a=s,s=i);n=V(e,n);N.set(r,a+n,s+n)};var $=N.fromValues(0,0),tt=N.fromValues(0,0),et=N.fromValues(0,0),it=N.fromValues(0,0),nt=N.fromValues(0,0),rt=N.fromValues(0,0);Q.findSeparatingAxis=function(t,e,i,n,r,o,s){var a=null,h=!1,l=!1,p=$,u=tt,d=et,c=it,y=nt,_=rt;if(t instanceof b&&n instanceof b)for(var m=0;2!==m;m++){var g=t,f=i;1===m&&(g=n,f=o);for(var x=0;2!==x;x++){0===x?N.set(c,0,1):1===x&&N.set(c,1,0),0!==f&&N.rotate(c,c,f),Q.projectConvexOntoAxis(t,e,i,c,y),Q.projectConvexOntoAxis(n,r,o,c,_);var v=y,w=_;y[0]>_[0]&&(w=y,v=_,0);h=(z=w[0]-v[1])<=0;(null===a||a<z)&&(N.copy(s,c),a=z,l=h)}}else for(m=0;2!==m;m++){g=t,f=i;1===m&&(g=n,f=o);for(x=0;x!==g.vertices.length;x++){N.rotate(u,g.vertices[x],f),N.rotate(d,g.vertices[(x+1)%g.vertices.length],f),j(p,d,u),N.rotate90cw(c,p),N.normalize(c,c),Q.projectConvexOntoAxis(t,e,i,c,y),Q.projectConvexOntoAxis(n,r,o,c,_);var z,v=y,w=_;y[0]>_[0]&&(w=y,v=_,0),h=(z=w[0]-v[1])<=0,(null===a||a<z)&&(N.copy(s,c),a=z,l=h)}}return l};var ot=N.fromValues(0,0),st=N.fromValues(0,0),at=N.fromValues(0,0);Q.getClosestEdge=function(t,e,i,n){var r=ot,o=st,s=at;N.rotate(r,i,-e),n&&N.scale(r,r,-1);for(var a=-1,h=t.vertices.length,l=-1,p=0;p!==h;p++){j(o,t.vertices[(p+1)%h],t.vertices[p%h]),N.rotate90cw(s,o),N.normalize(s,s);var u=V(s,r);(-1===a||l<u)&&(a=p%h,l=u)}return a};var ht=N.create(),lt=N.create(),pt=N.create(),ut=N.create(),dt=N.create(),ct=N.create(),yt=N.create();Q.prototype[l.CIRCLE|l.HEIGHTFIELD]=Q.prototype.circleHeightfield=function(t,e,i,n,r,o,s,a,h,l){var p=o.heights,l=l||e.radius,u=o.elementWidth,d=lt,c=ht,y=dt,_=yt,m=ct,g=pt,f=ut,x=Math.floor((i[0]-l-s[0])/u),v=Math.ceil((i[0]+l-s[0])/u);v>=p.length&&(v=p.length-1);for(var w=p[x=x<0?0:x],z=p[v],b=x;b<v;b++)p[b]<z&&(z=p[b]),p[b]>w&&(w=p[b]);if(i[1]-l>w)return!h&&0;for(var S=!1,b=x;b<v;b++){N.set(g,b*u,p[b]),N.set(f,(b+1)*u,p[b+1]),N.add(g,g,s),N.add(f,f,s),N.sub(m,f,g),N.rotate(m,m,Math.PI/2),N.normalize(m,m),N.scale(c,m,-l),N.add(c,c,i),N.sub(d,c,g);var C=N.dot(d,m);if(c[0]>=g[0]&&c[0]<f[0]&&C<=0){if(h)return!0;S=!0,N.scale(d,m,-C),N.add(y,c,d),N.copy(_,m);var P=this.createContactEquation(r,t,o,e);N.copy(P.normalA,_),N.scale(P.contactPointB,P.normalA,-l),U(P.contactPointB,P.contactPointB,i),j(P.contactPointB,P.contactPointB,t.position),N.copy(P.contactPointA,y),N.sub(P.contactPointA,P.contactPointA,r.position),this.contactEquations.push(P),this.enableFriction&&this.frictionEquations.push(this.createFrictionFromContact(P))}}if(S=!1,0<l)for(b=x;b<=v;b++)if(N.set(g,b*u,p[b]),N.add(g,g,s),N.sub(d,i,g),N.squaredLength(d)<Math.pow(l,2)){if(h)return!0;S=!0,P=this.createContactEquation(r,t,o,e);N.copy(P.normalA,d),N.normalize(P.normalA,P.normalA),N.scale(P.contactPointB,P.normalA,-l),U(P.contactPointB,P.contactPointB,i),j(P.contactPointB,P.contactPointB,t.position),j(P.contactPointA,g,s),U(P.contactPointA,P.contactPointA,s),j(P.contactPointA,P.contactPointA,r.position),this.contactEquations.push(P),this.enableFriction&&this.frictionEquations.push(this.createFrictionFromContact(P))}return S?1:0};var _t=N.create(),mt=N.create(),gt=N.create(),ft=new h({vertices:[N.create(),N.create(),N.create(),N.create()]});Q.prototype[l.BOX|l.HEIGHTFIELD]=Q.prototype[l.CONVEX|l.HEIGHTFIELD]=Q.prototype.convexHeightfield=function(t,e,i,n,r,o,s,a,h){var l=o.heights,p=o.elementWidth,u=_t,d=mt,c=gt,y=ft,o=Math.floor((t.aabb.lowerBound[0]-s[0])/p),_=Math.ceil((t.aabb.upperBound[0]-s[0])/p);_>=l.length&&(_=l.length-1);for(var m=l[o=o<0?0:o],g=l[_],f=o;f<_;f++)l[f]<g&&(g=l[f]),l[f]>m&&(m=l[f]);if(t.aabb.lowerBound[1]>m)return!h&&0;for(var x=0,f=o;f<_;f++){N.set(u,f*p,l[f]),N.set(d,(f+1)*p,l[f+1]),N.add(u,u,s),N.add(d,d,s);N.set(c,.5*(d[0]+u[0]),.5*(d[1]+u[1]-100)),N.sub(y.vertices[0],d,c),N.sub(y.vertices[1],u,c),N.copy(y.vertices[2],y.vertices[1]),N.copy(y.vertices[3],y.vertices[0]),y.vertices[2][1]-=100,y.vertices[3][1]-=100,x+=this.convexConvex(t,e,i,n,r,y,c,0,h)}return x}},{"../equations/ContactEquation":21,"../equations/Equation":22,"../equations/FrictionEquation":23,"../math/vec2":30,"../objects/Body":31,"../shapes/Box":37,"../shapes/Circle":39,"../shapes/Convex":40,"../shapes/Shape":45,"../utils/ContactEquationPool":48,"../utils/FrictionEquationPool":49,"../utils/TupleDictionary":56,"../utils/Utils":57}],11:[function(t,e,i){e.exports=s;var h=t("../math/vec2");t("../collision/RaycastResult"),t("../shapes/Shape"),t("../collision/AABB");function s(t){this.from=(t=t||{}).from?h.fromValues(t.from[0],t.from[1]):h.create(),this.to=t.to?h.fromValues(t.to[0],t.to[1]):h.create(),this.checkCollisionResponse=void 0===t.checkCollisionResponse||t.checkCollisionResponse,this.skipBackfaces=!!t.skipBackfaces,this.collisionMask=void 0!==t.collisionMask?t.collisionMask:-1,this.collisionGroup=void 0!==t.collisionGroup?t.collisionGroup:-1,this.mode=void 0!==t.mode?t.mode:s.ANY,this.callback=t.callback||function(t){},this.direction=h.create(),this.length=1,this.update()}(s.prototype.constructor=s).CLOSEST=1,s.ANY=2,s.ALL=4,s.prototype.update=function(){var t=this.direction;h.sub(t,this.to,this.from),this.length=h.length(t),h.normalize(t,t)},s.prototype.intersectBodies=function(t,e){for(var i=0,n=e.length;!t.shouldStop(this)&&i<n;i++){var r=e[i],o=r.getAABB();(0<=o.overlapsRay(this)||o.containsPoint(this.from))&&this.intersectBody(t,r)}};var l=h.create();s.prototype.intersectBody=function(t,e){var i=this.checkCollisionResponse;if(!i||e.collisionResponse)for(var n=l,r=0,o=e.shapes.length;r<o;r++){var s=e.shapes[r];if((!i||s.collisionResponse)&&(0!=(this.collisionGroup&s.collisionMask)&&0!=(s.collisionGroup&this.collisionMask))){h.rotate(n,s.position,e.angle),h.add(n,n,e.position);var a=s.angle+e.angle;if(this.intersectShape(t,s,a,n,e),t.shouldStop(this))break}}},s.prototype.intersectShape=function(t,e,i,n,r){(function(t,e,i){h.sub(o,i,t);var n=h.dot(o,e);return h.scale(a,e,n),h.add(a,a,t),h.squaredDistance(i,a)})(this.from,this.direction,n)>e.boundingRadius*e.boundingRadius||(this._currentBody=r,(this._currentShape=e).raycast(t,this,n,i),this._currentBody=this._currentShape=null)},s.prototype.getAABB=function(t){var e=this.to,i=this.from;h.set(t.lowerBound,Math.min(e[0],i[0]),Math.min(e[1],i[1])),h.set(t.upperBound,Math.max(e[0],i[0]),Math.max(e[1],i[1]))};h.create();s.prototype.reportIntersection=function(t,e,i,n){this.from,this.to;var r=this._currentShape,o=this._currentBody;if(!(this.skipBackfaces&&0<h.dot(i,this.direction)))switch(this.mode){case s.ALL:t.set(i,r,o,e,n),this.callback(t);break;case s.CLOSEST:(e<t.fraction||!t.hasHit())&&t.set(i,r,o,e,n);break;case s.ANY:t.set(i,r,o,e,n)}};var o=h.create(),a=h.create()},{"../collision/AABB":7,"../collision/RaycastResult":12,"../math/vec2":30,"../shapes/Shape":45}],12:[function(t,e,i){var o=t("../math/vec2"),n=t("../collision/Ray");function r(){this.normal=o.create(),this.shape=null,this.body=null,this.faceIndex=-1,this.fraction=-1,this.isStopped=!1}(e.exports=r).prototype.reset=function(){o.set(this.normal,0,0),this.shape=null,this.body=null,this.faceIndex=-1,this.fraction=-1,this.isStopped=!1},r.prototype.getHitDistance=function(t){return o.distance(t.from,t.to)*this.fraction},r.prototype.hasHit=function(){return-1!==this.fraction},r.prototype.getHitPoint=function(t,e){o.lerp(t,e.from,e.to,this.fraction)},r.prototype.stop=function(){this.isStopped=!0},r.prototype.shouldStop=function(t){return this.isStopped||-1!==this.fraction&&t.mode===n.ANY},r.prototype.set=function(t,e,i,n,r){o.copy(this.normal,t),this.shape=e,this.body=i,this.fraction=n,this.faceIndex=r}},{"../collision/Ray":11,"../math/vec2":30}],13:[function(t,e,i){var n=t("../utils/Utils"),u=t("../collision/Broadphase");function r(){u.call(this,u.SAP),this.axisList=[],this.axisIndex=0;var e=this;this._addBodyHandler=function(t){e.axisList.push(t.body)},this._removeBodyHandler=function(t){t=e.axisList.indexOf(t.body);-1!==t&&e.axisList.splice(t,1)}}(((e.exports=r).prototype=new u).constructor=r).prototype.setWorld=function(t){this.axisList.length=0,n.appendArray(this.axisList,t.bodies),t.off("addBody",this._addBodyHandler).off("removeBody",this._removeBodyHandler),t.on("addBody",this._addBodyHandler).on("removeBody",this._removeBodyHandler),this.world=t},r.sortAxisList=function(t,e){e|=0;for(var i=1,n=t.length;i<n;i++){for(var r=t[i],o=i-1;0<=o&&!(t[o].aabb.lowerBound[e]<=r.aabb.lowerBound[e]);o--)t[o+1]=t[o];t[o+1]=r}return t},r.prototype.sortList=function(){var t=this.axisList,e=this.axisIndex;r.sortAxisList(t,e)},r.prototype.getCollisionPairs=function(t){var e=this.axisList,i=this.result,n=this.axisIndex;i.length=0;for(var r=e.length;r--;){var o=e[r];o.aabbNeedsUpdate&&o.updateAABB()}this.sortList();for(var s=0,a=0|e.length;s!==a;s++)for(var h=e[s],l=s+1;l<a;l++){var p=e[l];if(!(p.aabb.lowerBound[n]<=h.aabb.upperBound[n]))break;u.canCollide(h,p)&&this.boundingVolumeCheck(h,p)&&i.push(h,p)}return i},r.prototype.aabbQuery=function(t,e,i){i=i||[],this.sortList();for(var n=this.axisIndex,n=2===n?"z":1===n?"y":"x",r=this.axisList,o=(e.lowerBound[n],e.upperBound[n],0);o<r.length;o++){var s=r[o];s.aabbNeedsUpdate&&s.updateAABB(),s.aabb.overlaps(e)&&i.push(s)}return i}},{"../collision/Broadphase":8,"../utils/Utils":57}],14:[function(t,e,i){e.exports=n;var r=t("../utils/Utils");function n(t,e,i,n){this.type=i,n=r.defaults(n,{collideConnected:!0,wakeUpBodies:!0}),this.equations=[],this.bodyA=t,this.bodyB=e,this.collideConnected=n.collideConnected,n.wakeUpBodies&&(t&&t.wakeUp(),e&&e.wakeUp())}n.prototype.update=function(){throw new Error("method update() not implmemented in this Constraint subclass!")},n.DISTANCE=1,n.GEAR=2,n.LOCK=3,n.PRISMATIC=4,n.REVOLUTE=5,n.prototype.setStiffness=function(t){for(var e=this.equations,i=0;i!==e.length;i++){var n=e[i];n.stiffness=t,n.needsUpdate=!0}},n.prototype.setRelaxation=function(t){for(var e=this.equations,i=0;i!==e.length;i++){var n=e[i];n.relaxation=t,n.needsUpdate=!0}}},{"../utils/Utils":57}],15:[function(t,e,i){var u=t("./Constraint"),d=t("../equations/Equation"),c=t("../math/vec2"),y=t("../utils/Utils");function n(t,e,i){i=y.defaults(i,{localAnchorA:[0,0],localAnchorB:[0,0]}),u.call(this,t,e,u.DISTANCE,i),this.localAnchorA=c.fromValues(i.localAnchorA[0],i.localAnchorA[1]),this.localAnchorB=c.fromValues(i.localAnchorB[0],i.localAnchorB[1]);var n,r,o=this.localAnchorA,s=this.localAnchorB;this.distance=0,"number"==typeof i.distance?this.distance=i.distance:(n=c.create(),r=c.create(),a=c.create(),c.rotate(n,o,t.angle),c.rotate(r,s,e.angle),c.add(a,e.position,r),c.sub(a,a,n),c.sub(a,a,t.position),this.distance=c.length(a));i=void 0===i.maxForce?Number.MAX_VALUE:i.maxForce,e=new d(t,e,-i,i);this.equations=[e],this.maxForce=i;var a=c.create(),h=c.create(),l=c.create(),p=this;e.computeGq=function(){var t=this.bodyA,e=this.bodyB,i=t.position,n=e.position;return c.rotate(h,o,t.angle),c.rotate(l,s,e.angle),c.add(a,n,l),c.sub(a,a,h),c.sub(a,a,i),c.length(a)-p.distance},this.setMaxForce(i),this.upperLimitEnabled=!1,this.upperLimit=1,this.lowerLimitEnabled=!1,this.lowerLimit=0,this.position=0}((e.exports=n).prototype=new u).constructor=n;var s=c.create(),a=c.create(),h=c.create();n.prototype.update=function(){var t=this.equations[0],e=this.bodyA,i=this.bodyB,n=(this.distance,e.position),r=i.position,o=this.equations[0],t=t.G;c.rotate(a,this.localAnchorA,e.angle),c.rotate(h,this.localAnchorB,i.angle),c.add(s,r,h),c.sub(s,s,a),c.sub(s,s,n),this.position=c.length(s);var r=!1;this.upperLimitEnabled&&this.position>this.upperLimit&&(o.maxForce=0,o.minForce=-this.maxForce,this.distance=this.upperLimit,r=!0),this.lowerLimitEnabled&&this.position<this.lowerLimit&&(o.maxForce=this.maxForce,o.minForce=0,this.distance=this.lowerLimit,r=!0),!this.lowerLimitEnabled&&!this.upperLimitEnabled||r?(o.enabled=!0,c.normalize(s,s),n=c.crossLength(a,s),r=c.crossLength(h,s),t[0]=-s[0],t[1]=-s[1],t[2]=-n,t[3]=s[0],t[4]=s[1],t[5]=r):o.enabled=!1},n.prototype.setMaxForce=function(t){var e=this.equations[0];e.minForce=-t,e.maxForce=t},n.prototype.getMaxForce=function(){return this.equations[0].maxForce}},{"../equations/Equation":22,"../math/vec2":30,"../utils/Utils":57,"./Constraint":14}],16:[function(t,e,i){var n=t("./Constraint"),r=(t("../equations/Equation"),t("../equations/AngleLockEquation"));t("../math/vec2");function o(t,e,i){n.call(this,t,e,n.GEAR,i=i||{}),this.ratio=void 0!==i.ratio?i.ratio:1,this.angle=void 0!==i.angle?i.angle:e.angle-this.ratio*t.angle,i.angle=this.angle,i.ratio=this.ratio,this.equations=[new r(t,e,i)],void 0!==i.maxTorque&&this.setMaxTorque(i.maxTorque)}(((e.exports=o).prototype=new n).constructor=o).prototype.update=function(){var t=this.equations[0];t.ratio!==this.ratio&&t.setRatio(this.ratio),t.angle=this.angle},o.prototype.setMaxTorque=function(t){this.equations[0].setMaxTorque(t)},o.prototype.getMaxTorque=function(t){return this.equations[0].maxForce}},{"../equations/AngleLockEquation":20,"../equations/Equation":22,"../math/vec2":30,"./Constraint":14}],17:[function(t,e,i){var d=t("./Constraint"),c=t("../math/vec2"),y=t("../equations/Equation");function n(t,e,i){d.call(this,t,e,d.LOCK,i=i||{});var n=void 0===i.maxForce?Number.MAX_VALUE:i.maxForce,r=(i.localAngleB,new y(t,e,-n,n)),o=new y(t,e,-n,n),s=new y(t,e,-n,n),a=c.create(),h=c.create(),l=this;r.computeGq=function(){return c.rotate(a,l.localOffsetB,t.angle),c.sub(h,e.position,t.position),c.sub(h,h,a),h[0]},o.computeGq=function(){return c.rotate(a,l.localOffsetB,t.angle),c.sub(h,e.position,t.position),c.sub(h,h,a),h[1]};var p=c.create(),u=c.create();s.computeGq=function(){return c.rotate(p,l.localOffsetB,e.angle-l.localAngleB),c.scale(p,p,-1),c.sub(h,t.position,e.position),c.add(h,h,p),c.rotate(u,p,-Math.PI/2),c.normalize(u,u),c.dot(h,u)},this.localOffsetB=c.create(),i.localOffsetB?c.copy(this.localOffsetB,i.localOffsetB):(c.sub(this.localOffsetB,e.position,t.position),c.rotate(this.localOffsetB,this.localOffsetB,-t.angle)),this.localAngleB=0,"number"==typeof i.localAngleB?this.localAngleB=i.localAngleB:this.localAngleB=e.angle-t.angle,this.equations.push(r,o,s),this.setMaxForce(n)}(((e.exports=n).prototype=new d).constructor=n).prototype.setMaxForce=function(t){for(var e=this.equations,i=0;i<this.equations.length;i++)e[i].maxForce=t,e[i].minForce=-t},n.prototype.getMaxForce=function(){return this.equations[0].maxForce};var o=c.create(),s=c.create(),a=c.create(),h=c.fromValues(1,0),l=c.fromValues(0,1);n.prototype.update=function(){var t=this.equations[0],e=this.equations[1],i=this.equations[2],n=this.bodyA,r=this.bodyB;c.rotate(o,this.localOffsetB,n.angle),c.rotate(s,this.localOffsetB,r.angle-this.localAngleB),c.scale(s,s,-1),c.rotate(a,s,Math.PI/2),c.normalize(a,a),t.G[0]=-1,t.G[1]=0,t.G[2]=-c.crossLength(o,h),t.G[3]=1,e.G[0]=0,e.G[1]=-1,e.G[2]=-c.crossLength(o,l),e.G[4]=1,i.G[0]=-a[0],i.G[1]=-a[1],i.G[3]=a[0],i.G[4]=a[1],i.G[5]=c.crossLength(s,a)}},{"../equations/Equation":22,"../math/vec2":30,"./Constraint":14}],18:[function(t,e,i){var c=t("./Constraint"),y=t("../equations/ContactEquation"),_=t("../equations/Equation"),m=t("../math/vec2"),g=t("../equations/RotationalLockEquation");function n(n,r,t){c.call(this,n,r,c.PRISMATIC,t=t||{});var o=m.fromValues(0,0),s=m.fromValues(1,0),a=m.fromValues(0,0);t.localAnchorA&&m.copy(o,t.localAnchorA),t.localAxisA&&m.copy(s,t.localAxisA),t.localAnchorB&&m.copy(a,t.localAnchorB),this.localAnchorA=o,this.localAnchorB=a,this.localAxisA=s;var e=this.maxForce=void 0!==t.maxForce?t.maxForce:Number.MAX_VALUE,i=new _(n,r,-e,e),h=new m.create,l=new m.create,p=new m.create,u=new m.create;i.computeGq=function(){return m.dot(p,u)},i.updateJacobian=function(){var t=this.G,e=n.position,i=r.position;m.rotate(h,o,n.angle),m.rotate(l,a,r.angle),m.add(p,i,l),m.sub(p,p,e),m.sub(p,p,h),m.rotate(u,s,n.angle+Math.PI/2),t[0]=-u[0],t[1]=-u[1],t[2]=-m.crossLength(h,u)+m.crossLength(u,p),t[3]=u[0],t[4]=u[1],t[5]=m.crossLength(l,u)},this.equations.push(i),t.disableRotationalLock||(i=new g(n,r,-e,e),this.equations.push(i)),this.position=0,this.velocity=0,this.lowerLimitEnabled=void 0!==t.lowerLimit,this.upperLimitEnabled=void 0!==t.upperLimit,this.lowerLimit=void 0!==t.lowerLimit?t.lowerLimit:0,this.upperLimit=void 0!==t.upperLimit?t.upperLimit:1,this.upperLimitEquation=new y(n,r),this.lowerLimitEquation=new y(n,r),this.upperLimitEquation.minForce=this.lowerLimitEquation.minForce=0,this.upperLimitEquation.maxForce=this.lowerLimitEquation.maxForce=e,this.motorEquation=new _(n,r),this.motorEnabled=!1,this.motorSpeed=0;var d=this,e=this.motorEquation;e.computeGW;e.computeGq=function(){return 0},e.computeGW=function(){var t=this.G,e=this.bodyA,i=this.bodyB,n=e.velocity,r=i.velocity,e=e.angularVelocity,i=i.angularVelocity;return this.gmult(t,n,e,r,i)+d.motorSpeed}}((e.exports=n).prototype=new c).constructor=n;var d=m.create(),f=m.create(),x=m.create(),v=m.create(),w=m.create(),z=m.create();n.prototype.update=function(){var t=this.equations,e=t[0],i=this.upperLimit,n=this.lowerLimit,r=this.upperLimitEquation,o=this.lowerLimitEquation,s=this.bodyA,a=this.bodyB,h=this.localAxisA,l=this.localAnchorA,p=this.localAnchorB;e.updateJacobian(),m.rotate(d,h,s.angle),m.rotate(v,l,s.angle),m.add(f,v,s.position),m.rotate(w,p,a.angle),m.add(x,w,a.position);var u,l=this.position=m.dot(x,d)-m.dot(f,d);this.motorEnabled&&((p=this.motorEquation.G)[0]=d[0],p[1]=d[1],p[2]=m.crossLength(d,w),p[3]=-d[0],p[4]=-d[1],p[5]=-m.crossLength(d,v)),this.upperLimitEnabled&&i<l?(m.scale(r.normalA,d,-1),m.sub(r.contactPointA,f,s.position),m.sub(r.contactPointB,x,a.position),m.scale(z,d,i),m.add(r.contactPointA,r.contactPointA,z),-1===t.indexOf(r)&&t.push(r)):-1!==(u=t.indexOf(r))&&t.splice(u,1),this.lowerLimitEnabled&&l<n?(m.scale(o.normalA,d,1),m.sub(o.contactPointA,f,s.position),m.sub(o.contactPointB,x,a.position),m.scale(z,d,n),m.sub(o.contactPointB,o.contactPointB,z),-1===t.indexOf(o)&&t.push(o)):-1!==(u=t.indexOf(o))&&t.splice(u,1)},n.prototype.enableMotor=function(){this.motorEnabled||(this.equations.push(this.motorEquation),this.motorEnabled=!0)},n.prototype.disableMotor=function(){var t;this.motorEnabled&&(t=this.equations.indexOf(this.motorEquation),this.equations.splice(t,1),this.motorEnabled=!1)},n.prototype.setLimits=function(t,e){"number"==typeof t?(this.lowerLimit=t,this.lowerLimitEnabled=!0):(this.lowerLimit=t,this.lowerLimitEnabled=!1),"number"==typeof e?(this.upperLimit=e,this.upperLimitEnabled=!0):(this.upperLimit=e,this.upperLimitEnabled=!1)}},{"../equations/ContactEquation":21,"../equations/Equation":22,"../equations/RotationalLockEquation":24,"../math/vec2":30,"./Constraint":14}],19:[function(t,e,i){var s=t("./Constraint"),a=t("../equations/Equation"),h=t("../equations/RotationalVelocityEquation"),l=t("../equations/RotationalLockEquation"),c=t("../math/vec2");e.exports=n;var y=c.create(),_=c.create(),m=c.fromValues(1,0),g=c.fromValues(0,1),p=c.create();function n(t,e,i){s.call(this,t,e,s.REVOLUTE,i=i||{});var n=this.maxForce=void 0!==i.maxForce?i.maxForce:Number.MAX_VALUE;this.pivotA=c.create(),this.pivotB=c.create(),i.worldPivot?(c.sub(this.pivotA,i.worldPivot,t.position),c.sub(this.pivotB,i.worldPivot,e.position),c.rotate(this.pivotA,this.pivotA,-t.angle),c.rotate(this.pivotB,this.pivotB,-e.angle)):(c.copy(this.pivotA,i.localPivotA),c.copy(this.pivotB,i.localPivotB));var r=this.equations=[new a(t,e,-n,n),new a(t,e,-n,n)],i=r[0],r=r[1],o=this;i.computeGq=function(){return c.rotate(y,o.pivotA,t.angle),c.rotate(_,o.pivotB,e.angle),c.add(p,e.position,_),c.sub(p,p,t.position),c.sub(p,p,y),c.dot(p,m)},r.computeGq=function(){return c.rotate(y,o.pivotA,t.angle),c.rotate(_,o.pivotB,e.angle),c.add(p,e.position,_),c.sub(p,p,t.position),c.sub(p,p,y),c.dot(p,g)},r.minForce=i.minForce=-n,r.maxForce=i.maxForce=n,this.motorEquation=new h(t,e),this.motorEnabled=!1,this.angle=0,this.lowerLimitEnabled=!1,this.upperLimitEnabled=!1,this.lowerLimit=0,this.upperLimit=0,this.upperLimitEquation=new l(t,e),this.lowerLimitEquation=new l(t,e),this.upperLimitEquation.minForce=0,this.lowerLimitEquation.maxForce=0}((n.prototype=new s).constructor=n).prototype.setLimits=function(t,e){"number"==typeof t?(this.lowerLimit=t,this.lowerLimitEnabled=!0):(this.lowerLimit=t,this.lowerLimitEnabled=!1),"number"==typeof e?(this.upperLimit=e,this.upperLimitEnabled=!0):(this.upperLimit=e,this.upperLimitEnabled=!1)},n.prototype.update=function(){var t,e=this.bodyA,i=this.bodyB,n=this.pivotA,r=this.pivotB,o=this.equations,s=(o[0],o[1],o[0]),a=o[1],h=this.upperLimit,l=this.lowerLimit,p=this.upperLimitEquation,u=this.lowerLimitEquation,d=this.angle=i.angle-e.angle;this.upperLimitEnabled&&h<d?(p.angle=h,-1===o.indexOf(p)&&o.push(p)):-1!==(t=o.indexOf(p))&&o.splice(t,1),this.lowerLimitEnabled&&d<l?(u.angle=l,-1===o.indexOf(u)&&o.push(u)):-1!==(t=o.indexOf(u))&&o.splice(t,1),c.rotate(y,n,e.angle),c.rotate(_,r,i.angle),s.G[0]=-1,s.G[1]=0,s.G[2]=-c.crossLength(y,m),s.G[3]=1,s.G[4]=0,s.G[5]=c.crossLength(_,m),a.G[0]=0,a.G[1]=-1,a.G[2]=-c.crossLength(y,g),a.G[3]=0,a.G[4]=1,a.G[5]=c.crossLength(_,g)},n.prototype.enableMotor=function(){this.motorEnabled||(this.equations.push(this.motorEquation),this.motorEnabled=!0)},n.prototype.disableMotor=function(){var t;this.motorEnabled&&(t=this.equations.indexOf(this.motorEquation),this.equations.splice(t,1),this.motorEnabled=!1)},n.prototype.motorIsEnabled=function(){return!!this.motorEnabled},n.prototype.setMotorSpeed=function(t){var e;this.motorEnabled&&(e=this.equations.indexOf(this.motorEquation),this.equations[e].relativeVelocity=t)},n.prototype.getMotorSpeed=function(){return!!this.motorEnabled&&this.motorEquation.relativeVelocity}},{"../equations/Equation":22,"../equations/RotationalLockEquation":24,"../equations/RotationalVelocityEquation":25,"../math/vec2":30,"./Constraint":14}],20:[function(t,e,i){var n=t("./Equation");t("../math/vec2");function r(t,e,i){i=i||{},n.call(this,t,e,-Number.MAX_VALUE,Number.MAX_VALUE),this.angle=i.angle||0,this.ratio="number"==typeof i.ratio?i.ratio:1,this.setRatio(this.ratio)}(((e.exports=r).prototype=new n).constructor=r).prototype.computeGq=function(){return this.ratio*this.bodyA.angle-this.bodyB.angle+this.angle},r.prototype.setRatio=function(t){var e=this.G;e[2]=t,e[5]=-1,this.ratio=t},r.prototype.setMaxTorque=function(t){this.maxForce=t,this.minForce=-t}},{"../math/vec2":30,"./Equation":22}],21:[function(t,e,i){var n=t("./Equation"),c=t("../math/vec2");function r(t,e){n.call(this,t,e,0,Number.MAX_VALUE),this.contactPointA=c.create(),this.penetrationVec=c.create(),this.contactPointB=c.create(),this.normalA=c.create(),this.restitution=0,this.firstImpact=!1,this.shapeA=null,this.shapeB=null}(((e.exports=r).prototype=new n).constructor=r).prototype.computeB=function(t,e,i){var n,r=this.bodyA,o=this.bodyB,s=this.contactPointA,a=this.contactPointB,h=r.position,l=o.position,p=this.penetrationVec,u=this.normalA,d=this.G,r=c.crossLength(s,u),o=c.crossLength(a,u);d[0]=-u[0],d[1]=-u[1],d[2]=-r,d[3]=u[0],d[4]=u[1],d[5]=o,c.add(p,l,a),c.sub(p,p,h),c.sub(p,p,s);p=this.firstImpact&&0!==this.restitution?(n=0,1/e*(1+this.restitution)*this.computeGW()):(n=c.dot(u,p)+this.offset,this.computeGW());return-n*t-p*e-i*this.computeGiMf()}},{"../math/vec2":30,"./Equation":22}],22:[function(t,e,i){e.exports=s;var u=t("../math/vec2"),o=t("../utils/Utils");t("../objects/Body");function s(t,e,i,n){this.minForce=void 0===i?-Number.MAX_VALUE:i,this.maxForce=void 0===n?Number.MAX_VALUE:n,this.bodyA=t,this.bodyB=e,this.stiffness=s.DEFAULT_STIFFNESS,this.relaxation=s.DEFAULT_RELAXATION,this.G=new o.ARRAY_TYPE(6);for(var r=0;r<6;r++)this.G[r]=0;this.offset=0,this.a=0,this.b=0,this.epsilon=0,this.timeStep=1/60,this.needsUpdate=!0,this.multiplier=0,this.relativeVelocity=0,this.enabled=!0}(s.prototype.constructor=s).DEFAULT_STIFFNESS=1e6,s.DEFAULT_RELAXATION=4,s.prototype.update=function(){var t=this.stiffness,e=this.relaxation,i=this.timeStep;this.a=4/(i*(1+4*e)),this.b=4*e/(1+4*e),this.epsilon=4/(i*i*t*(1+4*e)),this.needsUpdate=!1},s.prototype.gmult=function(t,e,i,n,r){return t[0]*e[0]+t[1]*e[1]+t[2]*i+t[3]*n[0]+t[4]*n[1]+t[5]*r},s.prototype.computeB=function(t,e,i){var n=this.computeGW();return-this.computeGq()*t-n*e-this.computeGiMf()*i};var n=u.create(),r=u.create();s.prototype.computeGq=function(){var t=this.G,e=this.bodyA,i=this.bodyB,e=(e.position,i.position,e.angle),i=i.angle;return this.gmult(t,n,e,r,i)+this.offset},s.prototype.computeGW=function(){var t=this.G,e=this.bodyA,i=this.bodyB,n=e.velocity,r=i.velocity,e=e.angularVelocity,i=i.angularVelocity;return this.gmult(t,n,e,r,i)+this.relativeVelocity},s.prototype.computeGWlambda=function(){var t=this.G,e=this.bodyA,i=this.bodyB,n=e.vlambda,r=i.vlambda,e=e.wlambda,i=i.wlambda;return this.gmult(t,n,e,r,i)};var d=u.create(),c=u.create();s.prototype.computeGiMf=function(){var t=this.bodyA,e=this.bodyB,i=t.force,n=t.angularForce,r=e.force,o=e.angularForce,s=t.invMassSolve,a=e.invMassSolve,h=t.invInertiaSolve,l=e.invInertiaSolve,p=this.G;return u.scale(d,i,s),u.multiply(d,t.massMultiplier,d),u.scale(c,r,a),u.multiply(c,e.massMultiplier,c),this.gmult(p,d,n*h,c,o*l)},s.prototype.computeGiMGt=function(){var t=this.bodyA,e=this.bodyB,i=t.invMassSolve,n=e.invMassSolve,r=t.invInertiaSolve,o=e.invInertiaSolve,s=this.G;return s[0]*s[0]*i*t.massMultiplier[0]+s[1]*s[1]*i*t.massMultiplier[1]+s[2]*s[2]*r+s[3]*s[3]*n*e.massMultiplier[0]+s[4]*s[4]*n*e.massMultiplier[1]+s[5]*s[5]*o};var y=u.create(),_=u.create(),m=u.create();u.create(),u.create(),u.create();s.prototype.addToWlambda=function(t){var e=this.bodyA,i=this.bodyB,n=y,r=_,o=m,s=e.invMassSolve,a=i.invMassSolve,h=e.invInertiaSolve,l=i.invInertiaSolve,p=this.G;r[0]=p[0],r[1]=p[1],o[0]=p[3],o[1]=p[4],u.scale(n,r,s*t),u.multiply(n,n,e.massMultiplier),u.add(e.vlambda,e.vlambda,n),e.wlambda+=h*p[2]*t,u.scale(n,o,a*t),u.multiply(n,n,i.massMultiplier),u.add(i.vlambda,i.vlambda,n),i.wlambda+=l*p[5]*t},s.prototype.computeInvC=function(t){return 1/(this.computeGiMGt()+t)}},{"../math/vec2":30,"../objects/Body":31,"../utils/Utils":57}],23:[function(t,e,i){var a=t("../math/vec2"),n=t("./Equation");t("../utils/Utils");function r(t,e,i){n.call(this,t,e,-i,i),this.contactPointA=a.create(),this.contactPointB=a.create(),this.t=a.create(),this.contactEquations=[],this.shapeA=null,this.shapeB=null,this.frictionCoefficient=.3}(((e.exports=r).prototype=new n).constructor=r).prototype.setSlipForce=function(t){this.maxForce=t,this.minForce=-t},r.prototype.getSlipForce=function(){return this.maxForce},r.prototype.computeB=function(t,e,i){this.bodyA,this.bodyB;var n=this.contactPointA,r=this.contactPointB,o=this.t,s=this.G;return s[0]=-o[0],s[1]=-o[1],s[2]=-a.crossLength(n,o),s[3]=o[0],s[4]=o[1],s[5]=a.crossLength(r,o),-this.computeGW()*e-i*this.computeGiMf()}},{"../math/vec2":30,"../utils/Utils":57,"./Equation":22}],24:[function(t,e,i){var n=t("./Equation"),r=t("../math/vec2");function o(t,e,i){i=i||{},n.call(this,t,e,-Number.MAX_VALUE,Number.MAX_VALUE),this.angle=i.angle||0;i=this.G;i[2]=1,i[5]=-1}((e.exports=o).prototype=new n).constructor=o;var s=r.create(),a=r.create(),h=r.fromValues(1,0),l=r.fromValues(0,1);o.prototype.computeGq=function(){return r.rotate(s,h,this.bodyA.angle+this.angle),r.rotate(a,l,this.bodyB.angle),r.dot(s,a)}},{"../math/vec2":30,"./Equation":22}],25:[function(t,e,i){var n=t("./Equation");t("../math/vec2");function r(t,e){n.call(this,t,e,-Number.MAX_VALUE,Number.MAX_VALUE),this.relativeVelocity=1,this.ratio=1}(((e.exports=r).prototype=new n).constructor=r).prototype.computeB=function(t,e,i){var n=this.G;n[2]=-1,n[5]=this.ratio;n=this.computeGiMf();return-this.computeGW()*e-i*n}},{"../math/vec2":30,"./Equation":22}],26:[function(t,e,i){function n(){}(e.exports=n).prototype={constructor:n,on:function(t,e,i){e.context=i||this,void 0===this._listeners&&(this._listeners={});i=this._listeners;return void 0===i[t]&&(i[t]=[]),-1===i[t].indexOf(e)&&i[t].push(e),this},has:function(t,e){if(void 0===this._listeners)return!1;var i=this._listeners;if(e){if(void 0!==i[t]&&-1!==i[t].indexOf(e))return!0}else if(void 0!==i[t])return!0;return!1},off:function(t,e){if(void 0===this._listeners)return this;var i=this._listeners,e=i[t].indexOf(e);return-1!==e&&i[t].splice(e,1),this},emit:function(t){if(void 0===this._listeners)return this;var e=this._listeners[t.type];if(void 0!==e){t.target=this;for(var i=0,n=e.length;i<n;i++){var r=e[i];r.call(r.context,t)}}return this}}},{}],27:[function(t,e,i){var n=t("./Material"),r=t("../equations/Equation");function o(t,e,i){if(i=i||{},!(t instanceof n&&e instanceof n))throw new Error("First two arguments must be Material instances.");this.id=o.idCounter++,this.materialA=t,this.materialB=e,this.friction=void 0!==i.friction?Number(i.friction):.3,this.restitution=void 0!==i.restitution?Number(i.restitution):0,this.stiffness=void 0!==i.stiffness?Number(i.stiffness):r.DEFAULT_STIFFNESS,this.relaxation=void 0!==i.relaxation?Number(i.relaxation):r.DEFAULT_RELAXATION,this.frictionStiffness=void 0!==i.frictionStiffness?Number(i.frictionStiffness):r.DEFAULT_STIFFNESS,this.frictionRelaxation=void 0!==i.frictionRelaxation?Number(i.frictionRelaxation):r.DEFAULT_RELAXATION,this.surfaceVelocity=void 0!==i.surfaceVelocity?Number(i.surfaceVelocity):0,this.contactSkinSize=.005}(e.exports=o).idCounter=0},{"../equations/Equation":22,"./Material":28}],28:[function(t,e,i){function n(t){this.id=t||n.idCounter++}(e.exports=n).idCounter=0},{}],29:[function(t,e,i){var f={GetArea:function(t){if(t.length<6)return 0;for(var e=t.length-2,i=0,n=0;n<e;n+=2)i+=(t[n+2]-t[n])*(t[n+1]+t[n+3]);return.5*-(i+=(t[0]-t[e])*(t[1+e]+t[1]))},Triangulate:function(t){var e=t.length>>1;if(e<3)return[];for(var i=[],n=[],r=0;r<e;r++)n.push(r);for(var r=0,o=e;3<o;){var s=n[(r+0)%o],a=n[(r+1)%o],h=n[(r+2)%o],l=t[2*s],p=t[2*s+1],u=t[2*a],d=t[2*a+1],c=t[2*h],y=t[2*h+1],_=!1;if(f._convex(l,p,u,d,c,y))for(var _=!0,m=0;m<o;m++){var g=n[m];if(g!=s&&g!=a&&g!=h&&f._PointInTriangle(t[2*g],t[2*g+1],l,p,u,d,c,y)){_=!1;break}}if(_)i.push(s,a,h),n.splice((r+1)%o,1),o--,r=0;else if(r++>3*o)break}return i.push(n[0],n[1],n[2]),i},_PointInTriangle:function(t,e,i,n,r,o,s,a){s-=i,a-=n,r-=i,o-=n,t-=i,i=e-n,e=s*s+a*a,n=s*r+a*o,s=s*t+a*i,a=r*r+o*o,o=r*t+o*i,i=1/(e*a-n*n),a=(a*s-n*o)*i,i*=e*o-n*s;return 0<=a&&0<=i&&a+i<1},_convex:function(t,e,i,n,r,o){return 0<=(e-n)*(r-i)+(i-t)*(o-n)}};e.exports=f},{}],30:[function(t,e,i){var o=e.exports={},n=t("../utils/Utils");o.crossLength=function(t,e){return t[0]*e[1]-t[1]*e[0]},o.crossVZ=function(t,e,i){return o.rotate(t,e,-Math.PI/2),o.scale(t,t,i),t},o.crossZV=function(t,e,i){return o.rotate(t,i,Math.PI/2),o.scale(t,t,e),t},o.rotate=function(t,e,i){var n,r,o;0!==i?(n=Math.cos(i),r=Math.sin(i),o=e[0],i=e[1],t[0]=n*o-r*i,t[1]=r*o+n*i):(t[0]=e[0],t[1]=e[1])},o.rotate90cw=function(t,e){var i=e[0],e=e[1];t[0]=e,t[1]=-i},o.toLocalFrame=function(t,e,i,n){o.copy(t,e),o.sub(t,t,i),o.rotate(t,t,-n)},o.toGlobalFrame=function(t,e,i,n){o.copy(t,e),o.rotate(t,t,n),o.add(t,t,i)},o.vectorToLocalFrame=function(t,e,i){o.rotate(t,e,-i)},o.vectorToGlobalFrame=function(t,e,i){o.rotate(t,e,i)},o.centroid=function(t,e,i,n){return o.add(t,e,i),o.add(t,t,n),o.scale(t,t,1/3),t},o.create=function(){var t=new n.ARRAY_TYPE(2);return t[0]=0,t[1]=0,t},o.clone=function(t){var e=new n.ARRAY_TYPE(2);return e[0]=t[0],e[1]=t[1],e},o.fromValues=function(t,e){var i=new n.ARRAY_TYPE(2);return i[0]=t,i[1]=e,i},o.copy=function(t,e){return t[0]=e[0],t[1]=e[1],t},o.set=function(t,e,i){return t[0]=e,t[1]=i,t},o.add=function(t,e,i){return t[0]=e[0]+i[0],t[1]=e[1]+i[1],t},o.subtract=function(t,e,i){return t[0]=e[0]-i[0],t[1]=e[1]-i[1],t},o.sub=o.subtract,o.multiply=function(t,e,i){return t[0]=e[0]*i[0],t[1]=e[1]*i[1],t},o.mul=o.multiply,o.divide=function(t,e,i){return t[0]=e[0]/i[0],t[1]=e[1]/i[1],t},o.div=o.divide,o.scale=function(t,e,i){return t[0]=e[0]*i,t[1]=e[1]*i,t},o.distance=function(t,e){var i=e[0]-t[0],t=e[1]-t[1];return Math.sqrt(i*i+t*t)},o.dist=o.distance,o.squaredDistance=function(t,e){var i=e[0]-t[0],t=e[1]-t[1];return i*i+t*t},o.sqrDist=o.squaredDistance,o.length=function(t){var e=t[0],t=t[1];return Math.sqrt(e*e+t*t)},o.len=o.length,o.squaredLength=function(t){var e=t[0],t=t[1];return e*e+t*t},o.sqrLen=o.squaredLength,o.negate=function(t,e){return t[0]=-e[0],t[1]=-e[1],t},o.normalize=function(t,e){var i=e[0],n=e[1],n=i*i+n*n;return 0<n&&(n=1/Math.sqrt(n),t[0]=e[0]*n,t[1]=e[1]*n),t},o.dot=function(t,e){return t[0]*e[0]+t[1]*e[1]},o.str=function(t){return"vec2("+t[0]+", "+t[1]+")"},o.lerp=function(t,e,i,n){var r=e[0],e=e[1];return t[0]=r+n*(i[0]-r),t[1]=e+n*(i[1]-e),t},o.reflect=function(t,e,i){var n=e[0]*i[0]+e[1]*i[1];t[0]=e[0]-2*i[0]*n,t[1]=e[1]-2*i[1]*n},o.getLineSegmentsIntersection=function(t,e,i,n,r){r=o.getLineSegmentsIntersectionFraction(e,i,n,r);return!(r<0)&&(t[0]=e[0]+r*(i[0]-e[0]),t[1]=e[1]+r*(i[1]-e[1]),!0)},o.getLineSegmentsIntersectionFraction=function(t,e,i,n){var r=e[0]-t[0],o=e[1]-t[1],s=n[0]-i[0],e=n[1]-i[1],n=(-o*(t[0]-i[0])+r*(t[1]-i[1]))/(-s*o+r*e),e=(s*(t[1]-i[1])-e*(t[0]-i[0]))/(-s*o+r*e);return 0<=n&&n<=1&&0<=e&&e<=1?e:-1}},{"../utils/Utils":57}],31:[function(t,e,i){var u=t("../math/vec2"),l=t("poly-decomp"),p=t("../shapes/Convex"),n=t("../collision/RaycastResult"),r=t("../collision/Ray"),o=t("../collision/AABB"),s=t("../events/EventEmitter");function a(t){t=t||{},s.call(this),this.id=t.id||++a._idCounter,this.world=null,this.shapes=[],this.mass=t.mass||0,this.invMass=0,this.inertia=0,this.invInertia=0,this.invMassSolve=0,this.invInertiaSolve=0,this.fixedRotation=!!t.fixedRotation,this.fixedX=!!t.fixedX,this.fixedY=!!t.fixedY,this.massMultiplier=u.create(),this.position=u.fromValues(0,0),t.position&&u.copy(this.position,t.position),this.interpolatedPosition=u.fromValues(0,0),this.interpolatedAngle=0,this.previousPosition=u.fromValues(0,0),this.previousAngle=0,this.velocity=u.fromValues(0,0),t.velocity&&u.copy(this.velocity,t.velocity),this.vlambda=u.fromValues(0,0),this.wlambda=0,this.angle=t.angle||0,this.angularVelocity=t.angularVelocity||0,this.force=u.create(),t.force&&u.copy(this.force,t.force),this.angularForce=t.angularForce||0,this.damping="number"==typeof t.damping?t.damping:.1,this.angularDamping="number"==typeof t.angularDamping?t.angularDamping:.1,this.type=a.STATIC,void 0!==t.type?this.type=t.type:t.mass?this.type=a.DYNAMIC:this.type=a.STATIC,this.boundingRadius=0,this.aabb=new o,this.aabbNeedsUpdate=!0,this.allowSleep=void 0===t.allowSleep||t.allowSleep,this.wantsToSleep=!1,this.sleepState=a.AWAKE,this.sleepSpeedLimit=void 0!==t.sleepSpeedLimit?t.sleepSpeedLimit:.2,this.sleepTimeLimit=void 0!==t.sleepTimeLimit?t.sleepTimeLimit:1,this.gravityScale=void 0!==t.gravityScale?t.gravityScale:1,this.collisionResponse=void 0===t.collisionResponse||t.collisionResponse,this.idleTime=0,this.timeLastSleepy=0,this.ccdSpeedThreshold=void 0!==t.ccdSpeedThreshold?t.ccdSpeedThreshold:-1,this.ccdIterations=void 0!==t.ccdIterations?t.ccdIterations:10,this.concavePath=null,this._wakeUpAfterNarrowphase=!1,this.updateMassProperties()}(((e.exports=a).prototype=new s).constructor=a)._idCounter=0,a.prototype.updateSolveMassProperties=function(){this.sleepState===a.SLEEPING||this.type===a.KINEMATIC?(this.invMassSolve=0,this.invInertiaSolve=0):(this.invMassSolve=this.invMass,this.invInertiaSolve=this.invInertia)},a.prototype.setDensity=function(t){var e=this.getArea();this.mass=e*t,this.updateMassProperties()},a.prototype.getArea=function(){for(var t=0,e=0;e<this.shapes.length;e++)t+=this.shapes[e].area;return t},a.prototype.getAABB=function(){return this.aabbNeedsUpdate&&this.updateAABB(),this.aabb};var h=new o,d=u.create();a.prototype.updateAABB=function(){for(var t=this.shapes,e=t.length,i=d,n=this.angle,r=0;r!==e;r++){var o=t[r],s=o.angle+n;u.rotate(i,o.position,n),u.add(i,i,this.position),o.computeAABB(h,i,s),0===r?this.aabb.copy(h):this.aabb.extend(h)}this.aabbNeedsUpdate=!1},a.prototype.updateBoundingRadius=function(){for(var t=this.shapes,e=t.length,i=0,n=0;n!==e;n++){var r=t[n],o=u.length(r.position),r=r.boundingRadius;i<o+r&&(i=o+r)}this.boundingRadius=i},a.prototype.addShape=function(t,e,i){if(t.body)throw new Error("A shape can only be added to one body.");t.body=this,e?u.copy(t.position,e):u.set(t.position,0,0),t.angle=i||0,this.shapes.push(t),this.updateMassProperties(),this.updateBoundingRadius(),this.aabbNeedsUpdate=!0},a.prototype.removeShape=function(t){var e=this.shapes.indexOf(t);return-1!==e&&(this.shapes.splice(e,1),this.aabbNeedsUpdate=!0,!(t.body=null))},a.prototype.updateMassProperties=function(){if(this.type===a.STATIC||this.type===a.KINEMATIC)this.mass=Number.MAX_VALUE,this.invMass=0,this.inertia=Number.MAX_VALUE,this.invInertia=0;else{var t=this.shapes,e=t.length,i=this.mass/e,n=0;if(this.fixedRotation)this.inertia=Number.MAX_VALUE,this.invInertia=0;else{for(var r=0;r<e;r++){var o=t[r],s=u.squaredLength(o.position);n+=o.computeMomentOfInertia(i)+i*s}this.inertia=n,this.invInertia=0<n?1/n:0}this.invMass=1/this.mass,u.set(this.massMultiplier,this.fixedX?0:1,this.fixedY?0:1)}};u.create();a.prototype.applyForce=function(t,e){u.add(this.force,this.force,t),e&&(t=u.crossLength(e,t),this.angularForce+=t)};var c=u.create(),y=u.create(),_=u.create();a.prototype.applyForceLocal=function(t,e){e=e||_;var i=c,n=y;this.vectorToWorldFrame(i,t),this.vectorToWorldFrame(n,e),this.applyForce(i,n)};var m=u.create();a.prototype.applyImpulse=function(t,e){var i;this.type===a.DYNAMIC&&(u.scale(i=m,t,this.invMass),u.multiply(i,this.massMultiplier,i),u.add(this.velocity,i,this.velocity),e&&(t=u.crossLength(e,t),t*=this.invInertia,this.angularVelocity+=t))};var g=u.create(),f=u.create(),x=u.create();a.prototype.applyImpulseLocal=function(t,e){e=e||x;var i=g,n=f;this.vectorToWorldFrame(i,t),this.vectorToWorldFrame(n,e),this.applyImpulse(i,n)},a.prototype.toLocalFrame=function(t,e){u.toLocalFrame(t,e,this.position,this.angle)},a.prototype.toWorldFrame=function(t,e){u.toGlobalFrame(t,e,this.position,this.angle)},a.prototype.vectorToLocalFrame=function(t,e){u.vectorToLocalFrame(t,e,this.angle)},a.prototype.vectorToWorldFrame=function(t,e){u.vectorToGlobalFrame(t,e,this.angle)},a.prototype.fromPolygon=function(t,e){e=e||{};for(var i=this.shapes.length;0<=i;--i)this.removeShape(this.shapes[i]);var n=new l.Polygon;if(n.vertices=t,n.makeCCW(),"number"==typeof e.removeCollinearPoints&&n.removeCollinearPoints(e.removeCollinearPoints),void 0===e.skipSimpleCheck&&!n.isSimple())return!1;this.concavePath=n.vertices.slice(0);for(i=0;i<this.concavePath.length;i++){var r=[0,0];u.copy(r,this.concavePath[i]),this.concavePath[i]=r}for(var o=e.optimalDecomp?n.decomp():n.quickDecomp(),s=u.create(),i=0;i!==o.length;i++){for(var a=new p({vertices:o[i].vertices}),h=0;h!==a.vertices.length;h++){r=a.vertices[h];u.sub(r,r,a.centerOfMass)}u.scale(s,a.centerOfMass,1),a.updateTriangles(),a.updateCenterOfMass(),a.updateBoundingRadius(),this.addShape(a,s)}return this.adjustCenterOfMass(),this.aabbNeedsUpdate=!0};u.fromValues(0,0);var v=u.fromValues(0,0),w=u.fromValues(0,0),z=u.fromValues(0,0);a.prototype.adjustCenterOfMass=function(){var t=v,e=w,i=z,n=0;u.set(e,0,0);for(var r=0;r!==this.shapes.length;r++){var o=this.shapes[r];u.scale(t,o.position,o.area),u.add(e,e,t),n+=o.area}u.scale(i,e,1/n);for(r=0;r!==this.shapes.length;r++){o=this.shapes[r];u.sub(o.position,o.position,i)}u.add(this.position,this.position,i);for(r=0;this.concavePath&&r<this.concavePath.length;r++)u.sub(this.concavePath[r],this.concavePath[r],i);this.updateMassProperties(),this.updateBoundingRadius()},a.prototype.setZeroForce=function(){u.set(this.force,0,0),this.angularForce=0},a.prototype.resetConstraintVelocity=function(){var t=this.vlambda;u.set(t,0,0),this.wlambda=0},a.prototype.addConstraintVelocity=function(){var t=this.velocity;u.add(t,t,this.vlambda),this.angularVelocity+=this.wlambda},a.prototype.applyDamping=function(t){var e;this.type===a.DYNAMIC&&(e=this.velocity,u.scale(e,e,Math.pow(1-this.damping,t)),this.angularVelocity*=Math.pow(1-this.angularDamping,t))},a.prototype.wakeUp=function(){var t=this.sleepState;this.sleepState=a.AWAKE,this.idleTime=0,t!==a.AWAKE&&this.emit(a.wakeUpEvent)},a.prototype.sleep=function(){this.sleepState=a.SLEEPING,this.angularVelocity=0,this.angularForce=0,u.set(this.velocity,0,0),u.set(this.force,0,0),this.emit(a.sleepEvent)},a.prototype.sleepTick=function(t,e,i){var n;this.allowSleep&&this.type!==a.SLEEPING&&(this.wantsToSleep=!1,this.sleepState,n=u.squaredLength(this.velocity)+Math.pow(this.angularVelocity,2),Math.pow(this.sleepSpeedLimit,2)<=n?(this.idleTime=0,this.sleepState=a.AWAKE):(this.idleTime+=i,this.sleepState=a.SLEEPY),this.idleTime>this.sleepTimeLimit&&(e?this.wantsToSleep=!0:this.sleep()))},a.prototype.overlaps=function(t){return this.world.overlapKeeper.bodiesAreOverlapping(this,t)};var b=u.create(),S=u.create();a.prototype.integrate=function(t){var e=this.invMass,i=this.force,n=this.position,r=this.velocity;u.copy(this.previousPosition,this.position),this.previousAngle=this.angle,this.fixedRotation||(this.angularVelocity+=this.angularForce*this.invInertia*t),u.scale(b,i,t*e),u.multiply(b,this.massMultiplier,b),u.add(r,b,r),this.integrateToTimeOfImpact(t)||(u.scale(S,r,t),u.add(n,n,S),this.fixedRotation||(this.angle+=this.angularVelocity*t)),this.aabbNeedsUpdate=!0};var C=new n,P=new r({mode:r.ALL}),M=u.create(),T=u.create(),A=u.create(),k=u.create();a.prototype.integrateToTimeOfImpact=function(t){if(this.ccdSpeedThreshold<0||u.squaredLength(this.velocity)<Math.pow(this.ccdSpeedThreshold,2))return!1;u.normalize(M,this.velocity),u.scale(T,this.velocity,t),u.add(T,T,this.position),u.sub(A,T,this.position);var e,i=this.angularVelocity*t,n=u.length(A),r=1,o=this;if(C.reset(),P.callback=function(t){t.body!==o&&(e=t.body,t.getHitPoint(T,P),u.sub(A,T,o.position),r=u.length(A)/n,t.stop())},u.copy(P.from,this.position),u.copy(P.to,T),P.update(),this.world.raycast(C,P),!e)return!1;var s=this.angle;u.copy(k,this.position);for(var a=0,h=0,l=0,p=r;h<=p&&a<this.ccdIterations;)a++,l=(p-h)/2,u.scale(S,A,r),u.add(this.position,k,S),this.angle=s+i*r,this.updateAABB(),this.aabb.overlaps(e.aabb)&&this.world.narrowphase.bodiesOverlap(this,e)?h=l:p=l;return r=l,u.copy(this.position,k),this.angle=s,u.scale(S,A,r),u.add(this.position,this.position,S),this.fixedRotation||(this.angle+=i*r),!0},a.prototype.getVelocityAtPoint=function(t,e){return u.crossVZ(t,e,this.angularVelocity),u.subtract(t,this.velocity,t),t},a.sleepyEvent={type:"sleepy"},a.sleepEvent={type:"sleep"},a.wakeUpEvent={type:"wakeup"},a.DYNAMIC=1,a.STATIC=2,a.KINEMATIC=4,a.AWAKE=0,a.SLEEPY=1,a.SLEEPING=2},{"../collision/AABB":7,"../collision/Ray":11,"../collision/RaycastResult":12,"../events/EventEmitter":26,"../math/vec2":30,"../shapes/Convex":40,"poly-decomp":5}],32:[function(t,e,i){var y=t("../math/vec2"),n=t("./Spring");t("../utils/Utils");function r(t,e,i){n.call(this,t,e,i=i||{}),this.localAnchorA=y.fromValues(0,0),this.localAnchorB=y.fromValues(0,0),i.localAnchorA&&y.copy(this.localAnchorA,i.localAnchorA),i.localAnchorB&&y.copy(this.localAnchorB,i.localAnchorB),i.worldAnchorA&&this.setWorldAnchorA(i.worldAnchorA),i.worldAnchorB&&this.setWorldAnchorB(i.worldAnchorB);t=y.create(),e=y.create();this.getWorldAnchorA(t),this.getWorldAnchorB(e);e=y.distance(t,e);this.restLength="number"==typeof i.restLength?i.restLength:e}(((e.exports=r).prototype=new n).constructor=r).prototype.setWorldAnchorA=function(t){this.bodyA.toLocalFrame(this.localAnchorA,t)},r.prototype.setWorldAnchorB=function(t){this.bodyB.toLocalFrame(this.localAnchorB,t)},r.prototype.getWorldAnchorA=function(t){this.bodyA.toWorldFrame(t,this.localAnchorA)},r.prototype.getWorldAnchorB=function(t){this.bodyB.toWorldFrame(t,this.localAnchorB)};var _=y.create(),m=y.create(),g=y.create(),f=y.create(),x=y.create(),v=y.create(),w=y.create(),z=y.create(),b=y.create();r.prototype.applyForce=function(){var t=this.stiffness,e=this.damping,i=this.restLength,n=this.bodyA,r=this.bodyB,o=_,s=m,a=g,h=f,l=b,p=x,u=v,d=w,c=z;this.getWorldAnchorA(p),this.getWorldAnchorB(u),y.sub(d,p,n.position),y.sub(c,u,r.position),y.sub(o,u,p);p=y.len(o);y.normalize(s,o),y.sub(a,r.velocity,n.velocity),y.crossZV(l,r.angularVelocity,c),y.add(a,a,l),y.crossZV(l,n.angularVelocity,d),y.sub(a,a,l),y.scale(h,s,-t*(p-i)-e*y.dot(a,s)),y.sub(n.force,n.force,h),y.add(r.force,r.force,h);d=y.crossLength(d,h),h=y.crossLength(c,h);n.angularForce-=d,r.angularForce+=h}},{"../math/vec2":30,"../utils/Utils":57,"./Spring":34}],33:[function(t,e,i){t("../math/vec2");var n=t("./Spring");function r(t,e,i){n.call(this,t,e,i=i||{}),this.restAngle="number"==typeof i.restAngle?i.restAngle:e.angle-t.angle}(((e.exports=r).prototype=new n).constructor=r).prototype.applyForce=function(){var t=this.stiffness,e=this.damping,i=this.restAngle,n=this.bodyA,r=this.bodyB,e=-t*(r.angle-n.angle-i)-e*(r.angularVelocity-n.angularVelocity)*0;n.angularForce-=e,r.angularForce+=e}},{"../math/vec2":30,"./Spring":34}],34:[function(t,e,i){t("../math/vec2");var n=t("../utils/Utils");function r(t,e,i){i=n.defaults(i,{stiffness:100,damping:1}),this.stiffness=i.stiffness,this.damping=i.damping,this.bodyA=t,this.bodyB=e}(e.exports=r).prototype.applyForce=function(){}},{"../math/vec2":30,"../utils/Utils":57}],35:[function(t,e,i){var n=t("../math/vec2"),r=(t("../utils/Utils"),t("../constraints/Constraint")),o=t("../equations/FrictionEquation"),s=t("../objects/Body");function a(t,e){this.chassisBody=t,this.wheels=[],this.groundBody=new s({mass:0}),this.world=null;var i=this;this.preStepCallback=function(){i.update()}}function h(t,e){e=e||{},this.vehicle=t,this.forwardEquation=new o(t.chassisBody,t.groundBody),this.sideEquation=new o(t.chassisBody,t.groundBody),this.steerValue=0,this.engineForce=0,this.setSideFriction(void 0!==e.sideFriction?e.sideFriction:5),this.localForwardVector=n.fromValues(0,1),e.localForwardVector&&n.copy(this.localForwardVector,e.localForwardVector),this.localPosition=n.fromValues(0,0),e.localPosition&&n.copy(this.localPosition,e.localPosition),r.apply(this,t.chassisBody,t.groundBody),this.equations.push(this.forwardEquation,this.sideEquation),this.setBrakeForce(0)}(e.exports=a).prototype.addToWorld=function(t){(this.world=t).addBody(this.groundBody),t.on("preStep",this.preStepCallback);for(var e=0;e<this.wheels.length;e++){var i=this.wheels[e];t.addConstraint(i)}},a.prototype.removeFromWorld=function(){var t=this.world;t.removeBody(this.groundBody),t.off("preStep",this.preStepCallback);for(var e=0;e<this.wheels.length;e++){var i=this.wheels[e];t.removeConstraint(i)}this.world=null},a.prototype.addWheel=function(t){t=new h(this,t);return this.wheels.push(t),t},a.prototype.update=function(){for(var t=0;t<this.wheels.length;t++)this.wheels[t].update()},(h.prototype=new r).setBrakeForce=function(t){this.forwardEquation.setSlipForce(t)},h.prototype.setSideFriction=function(t){this.sideEquation.setSlipForce(t)};var l=n.create(),p=n.create();h.prototype.getSpeed=function(){return this.vehicle.chassisBody.vectorToWorldFrame(p,this.localForwardVector),this.vehicle.chassisBody.getVelocityAtPoint(l,p),n.dot(l,p)};var u=n.create();h.prototype.update=function(){this.vehicle.chassisBody.vectorToWorldFrame(this.forwardEquation.t,this.localForwardVector),n.rotate(this.sideEquation.t,this.localForwardVector,Math.PI/2),this.vehicle.chassisBody.vectorToWorldFrame(this.sideEquation.t,this.sideEquation.t),n.rotate(this.forwardEquation.t,this.forwardEquation.t,this.steerValue),n.rotate(this.sideEquation.t,this.sideEquation.t,this.steerValue),this.vehicle.chassisBody.toWorldFrame(this.forwardEquation.contactPointB,this.localPosition),n.copy(this.sideEquation.contactPointB,this.forwardEquation.contactPointB),this.vehicle.chassisBody.vectorToWorldFrame(this.forwardEquation.contactPointA,this.localPosition),n.copy(this.sideEquation.contactPointA,this.forwardEquation.contactPointA),n.normalize(u,this.forwardEquation.t),n.scale(u,u,this.engineForce),this.vehicle.chassisBody.applyForce(u,this.forwardEquation.contactPointA)}},{"../constraints/Constraint":14,"../equations/FrictionEquation":23,"../math/vec2":30,"../objects/Body":31,"../utils/Utils":57}],36:[function(t,e,i){t=e.exports={AABB:t("./collision/AABB"),AngleLockEquation:t("./equations/AngleLockEquation"),Body:t("./objects/Body"),Broadphase:t("./collision/Broadphase"),Capsule:t("./shapes/Capsule"),Circle:t("./shapes/Circle"),Constraint:t("./constraints/Constraint"),ContactEquation:t("./equations/ContactEquation"),ContactEquationPool:t("./utils/ContactEquationPool"),ContactMaterial:t("./material/ContactMaterial"),Convex:t("./shapes/Convex"),DistanceConstraint:t("./constraints/DistanceConstraint"),Equation:t("./equations/Equation"),EventEmitter:t("./events/EventEmitter"),FrictionEquation:t("./equations/FrictionEquation"),FrictionEquationPool:t("./utils/FrictionEquationPool"),GearConstraint:t("./constraints/GearConstraint"),GSSolver:t("./solver/GSSolver"),Heightfield:t("./shapes/Heightfield"),Line:t("./shapes/Line"),LockConstraint:t("./constraints/LockConstraint"),Material:t("./material/Material"),Narrowphase:t("./collision/Narrowphase"),NaiveBroadphase:t("./collision/NaiveBroadphase"),Particle:t("./shapes/Particle"),Plane:t("./shapes/Plane"),Pool:t("./utils/Pool"),RevoluteConstraint:t("./constraints/RevoluteConstraint"),PrismaticConstraint:t("./constraints/PrismaticConstraint"),Ray:t("./collision/Ray"),RaycastResult:t("./collision/RaycastResult"),Box:t("./shapes/Box"),RotationalVelocityEquation:t("./equations/RotationalVelocityEquation"),SAPBroadphase:t("./collision/SAPBroadphase"),Shape:t("./shapes/Shape"),Solver:t("./solver/Solver"),Spring:t("./objects/Spring"),TopDownVehicle:t("./objects/TopDownVehicle"),LinearSpring:t("./objects/LinearSpring"),RotationalSpring:t("./objects/RotationalSpring"),Utils:t("./utils/Utils"),World:t("./world/World"),vec2:t("./math/vec2"),version:t("../package.json").version};Object.defineProperty(t,"Rectangle",{get:function(){return this.Box}})},{"../package.json":6,"./collision/AABB":7,"./collision/Broadphase":8,"./collision/NaiveBroadphase":9,"./collision/Narrowphase":10,"./collision/Ray":11,"./collision/RaycastResult":12,"./collision/SAPBroadphase":13,"./constraints/Constraint":14,"./constraints/DistanceConstraint":15,"./constraints/GearConstraint":16,"./constraints/LockConstraint":17,"./constraints/PrismaticConstraint":18,"./constraints/RevoluteConstraint":19,"./equations/AngleLockEquation":20,"./equations/ContactEquation":21,"./equations/Equation":22,"./equations/FrictionEquation":23,"./equations/RotationalVelocityEquation":25,"./events/EventEmitter":26,"./material/ContactMaterial":27,"./material/Material":28,"./math/vec2":30,"./objects/Body":31,"./objects/LinearSpring":32,"./objects/RotationalSpring":33,"./objects/Spring":34,"./objects/TopDownVehicle":35,"./shapes/Box":37,"./shapes/Capsule":38,"./shapes/Circle":39,"./shapes/Convex":40,"./shapes/Heightfield":41,"./shapes/Line":42,"./shapes/Particle":43,"./shapes/Plane":44,"./shapes/Shape":45,"./solver/GSSolver":46,"./solver/Solver":47,"./utils/ContactEquationPool":48,"./utils/FrictionEquationPool":49,"./utils/Pool":55,"./utils/Utils":57,"./world/World":61}],37:[function(t,e,i){var n=t("../math/vec2"),r=t("./Shape"),o=t("./Convex");function s(t){"number"==typeof arguments[0]&&"number"==typeof arguments[1]&&(t={width:arguments[0],height:arguments[1]});var e=this.width=(t=t||{}).width||1,i=this.height=t.height||1,e=[n.fromValues(-e/2,-i/2),n.fromValues(e/2,-i/2),n.fromValues(e/2,i/2),n.fromValues(-e/2,i/2)],i=[n.fromValues(1,0),n.fromValues(0,1)];t.vertices=e,t.axes=i,t.type=r.BOX,o.call(this,t)}(((e.exports=s).prototype=new o).constructor=s).prototype.computeMomentOfInertia=function(t){var e=this.width,i=this.height;return t*(i*i+e*e)/12},s.prototype.updateBoundingRadius=function(){var t=this.width,e=this.height;this.boundingRadius=Math.sqrt(t*t+e*e)/2};n.create(),n.create(),n.create(),n.create();s.prototype.computeAABB=function(t,e,i){t.setFromPoints(this.vertices,e,i,0)},s.prototype.updateArea=function(){this.area=this.width*this.height}},{"../math/vec2":30,"./Convex":40,"./Shape":45}],38:[function(t,e,i){var n=t("./Shape"),x=t("../math/vec2");function r(t){"number"==typeof arguments[0]&&"number"==typeof arguments[1]&&(t={length:arguments[0],radius:arguments[1]}),this.length=(t=t||{}).length||1,this.radius=t.radius||1,t.type=n.CAPSULE,n.call(this,t)}(((e.exports=r).prototype=new n).constructor=r).prototype.computeMomentOfInertia=function(t){var e=this.radius,i=this.length+e,e=2*e;return t*(e*e+i*i)/12},r.prototype.updateBoundingRadius=function(){this.boundingRadius=this.radius+this.length/2},r.prototype.updateArea=function(){this.area=Math.PI*this.radius*this.radius+2*this.radius*this.length};var o=x.create();r.prototype.computeAABB=function(t,e,i){var n=this.radius;x.set(o,this.length/2,0),0!==i&&x.rotate(o,o,i),x.set(t.upperBound,Math.max(o[0]+n,-o[0]+n),Math.max(o[1]+n,-o[1]+n)),x.set(t.lowerBound,Math.min(o[0]-n,-o[0]-n),Math.min(o[1]-n,-o[1]-n)),x.add(t.lowerBound,t.lowerBound,e),x.add(t.upperBound,t.upperBound,e)};var v=x.create(),w=x.create(),z=x.create(),b=x.create(),S=x.fromValues(0,1);r.prototype.raycast=function(t,e,i,n){for(var r=e.from,o=e.to,s=(e.direction,v),a=w,h=z,l=b,p=this.length/2,u=0;u<2;u++){var d=this.radius*(2*u-1);x.set(h,-p,d),x.set(l,p,d),x.toGlobalFrame(h,h,i,n),x.toGlobalFrame(l,l,i,n);var c=x.getLineSegmentsIntersectionFraction(r,o,h,l);if(0<=c&&(x.rotate(a,S,n),x.scale(a,a,2*u-1),e.reportIntersection(t,c,a,-1),t.shouldStop(e)))return}for(var y=Math.pow(this.radius,2)+Math.pow(p,2),u=0;u<2;u++){x.set(h,p*(2*u-1),0),x.toGlobalFrame(h,h,i,n);var _=Math.pow(o[0]-r[0],2)+Math.pow(o[1]-r[1],2),m=2*((o[0]-r[0])*(r[0]-h[0])+(o[1]-r[1])*(r[1]-h[1])),g=Math.pow(r[0]-h[0],2)+Math.pow(r[1]-h[1],2)-Math.pow(this.radius,2);if(!((c=Math.pow(m,2)-4*_*g)<0))if(0===c){if(x.lerp(s,r,o,c),x.squaredDistance(s,i)>y&&(x.sub(a,s,h),x.normalize(a,a),e.reportIntersection(t,c,a,-1),t.shouldStop(e)))return}else{var f=Math.sqrt(c),g=1/(2*_),_=(-m-f)*g,g=(-m+f)*g;if(0<=_&&_<=1&&(x.lerp(s,r,o,_),x.squaredDistance(s,i)>y&&(x.sub(a,s,h),x.normalize(a,a),e.reportIntersection(t,_,a,-1),t.shouldStop(e))))return;if(0<=g&&g<=1&&(x.lerp(s,r,o,g),x.squaredDistance(s,i)>y&&(x.sub(a,s,h),x.normalize(a,a),e.reportIntersection(t,g,a,-1),t.shouldStop(e))))return}}}},{"../math/vec2":30,"./Shape":45}],39:[function(t,e,i){var n=t("./Shape"),d=t("../math/vec2");function r(t){"number"==typeof arguments[0]&&(t={radius:arguments[0]}),this.radius=(t=t||{}).radius||1,t.type=n.CIRCLE,n.call(this,t)}(((e.exports=r).prototype=new n).constructor=r).prototype.computeMomentOfInertia=function(t){var e=this.radius;return t*e*e/2},r.prototype.updateBoundingRadius=function(){this.boundingRadius=this.radius},r.prototype.updateArea=function(){this.area=Math.PI*this.radius*this.radius},r.prototype.computeAABB=function(t,e,i){var n=this.radius;d.set(t.upperBound,n,n),d.set(t.lowerBound,-n,-n),e&&(d.add(t.lowerBound,t.lowerBound,e),d.add(t.upperBound,t.upperBound,e))};var c=d.create(),y=d.create();r.prototype.raycast=function(t,e,i,n){var r=e.from,o=e.to,s=this.radius,a=Math.pow(o[0]-r[0],2)+Math.pow(o[1]-r[1],2),h=2*((o[0]-r[0])*(r[0]-i[0])+(o[1]-r[1])*(r[1]-i[1])),l=Math.pow(r[0]-i[0],2)+Math.pow(r[1]-i[1],2)-Math.pow(s,2),p=Math.pow(h,2)-4*a*l,u=c,s=y;p<0||(0==p?(d.lerp(u,r,o,p),d.sub(s,u,i),d.normalize(s,s),e.reportIntersection(t,p,s,-1)):(a=(-h+(l=Math.sqrt(p)))*(p=1/(2*a)),0<=(p=(-h-l)*p)&&p<=1&&(d.lerp(u,r,o,p),d.sub(s,u,i),d.normalize(s,s),e.reportIntersection(t,p,s,-1),t.shouldStop(e))||0<=a&&a<=1&&(d.lerp(u,r,o,a),d.sub(s,u,i),d.normalize(s,s),e.reportIntersection(t,a,s,-1))))}},{"../math/vec2":30,"./Shape":45}],40:[function(t,e,i){var h=t("./Shape"),c=t("../math/vec2"),a=t("../math/polyk");t("poly-decomp");function p(t){t=(t=Array.isArray(arguments[0])?{vertices:arguments[0],axes:arguments[1]}:t)||{},this.vertices=[];for(var e=void 0!==t.vertices?t.vertices:[],i=0;i<e.length;i++){var n=c.create();c.copy(n,e[i]),this.vertices.push(n)}if(this.axes=[],t.axes)for(i=0;i<t.axes.length;i++){var r=c.create();c.copy(r,t.axes[i]),this.axes.push(r)}else for(i=0;i<this.vertices.length;i++){var o=this.vertices[i],s=this.vertices[(i+1)%this.vertices.length],a=c.create();c.sub(a,s,o),c.rotate90cw(a,a),c.normalize(a,a),this.axes.push(a)}if(this.centerOfMass=c.fromValues(0,0),this.triangles=[],this.vertices.length&&(this.updateTriangles(),this.updateCenterOfMass()),this.boundingRadius=0,t.type=h.CONVEX,h.call(this,t),this.updateBoundingRadius(),this.updateArea(),this.area<0)throw new Error("Convex vertices must be given in conter-clockwise winding.")}((e.exports=p).prototype=new h).constructor=p;var l=c.create(),o=c.create();p.prototype.projectOntoLocalAxis=function(t,e){for(var i,n,r=null,o=null,t=l,s=0;s<this.vertices.length;s++)i=this.vertices[s],i=c.dot(i,t),(null===r||r<i)&&(r=i),(null===o||i<o)&&(o=i);r<o&&(n=o,o=r,r=n),c.set(e,o,r)},p.prototype.projectOntoWorldAxis=function(t,e,i,n){var r=o;this.projectOntoLocalAxis(t,n),0!==i?c.rotate(r,t,i):r=t;r=c.dot(e,r);c.set(n,n[0]+r,n[1]+r)},p.prototype.updateTriangles=function(){for(var t=[],e=this.triangles.length=0;e<this.vertices.length;e++){var i=this.vertices[e];t.push(i[0],i[1])}for(var n=a.Triangulate(t),e=0;e<n.length;e+=3){var r=n[e],o=n[e+1],s=n[e+2];this.triangles.push([r,o,s])}};var u=c.create(),d=c.create();c.create(),c.create(),c.create(),c.create(),c.create(),c.create(),c.create();p.prototype.updateCenterOfMass=function(){var t=this.triangles,e=this.vertices,i=this.centerOfMass,n=u,r=d;c.set(i,0,0);for(var o=0,s=0;s!==t.length;s++){var a=t[s],h=e[a[0]],l=e[a[1]],a=e[a[2]];c.centroid(n,h,l,a);a=p.triangleArea(h,l,a);o+=a,c.scale(r,n,a),c.add(i,i,r)}c.scale(i,i,1/o)},p.prototype.computeMomentOfInertia=function(t){for(var e=0,i=0,n=this.vertices.length,r=n-1,o=0;o<n;r=o,o++){var s=this.vertices[r],a=this.vertices[o],h=Math.abs(c.crossLength(s,a));e+=h*(c.dot(a,a)+c.dot(a,s)+c.dot(s,s)),i+=h}return t/6*(e/i)},p.prototype.updateBoundingRadius=function(){for(var t=this.vertices,e=0,i=0;i!==t.length;i++){var n=c.squaredLength(t[i]);e<n&&(e=n)}this.boundingRadius=Math.sqrt(e)},p.triangleArea=function(t,e,i){return.5*((e[0]-t[0])*(i[1]-t[1])-(i[0]-t[0])*(e[1]-t[1]))},p.prototype.updateArea=function(){this.updateTriangles(),this.area=0;for(var t=this.triangles,e=this.vertices,i=0;i!==t.length;i++){var n=t[i],r=e[n[0]],o=e[n[1]],n=e[n[2]],n=p.triangleArea(r,o,n);this.area+=n}},p.prototype.computeAABB=function(t,e,i){t.setFromPoints(this.vertices,e,i,0)};var y=c.create(),_=c.create(),m=c.create();p.prototype.raycast=function(t,e,i,n){var r=y,o=_,s=m,a=this.vertices;c.toLocalFrame(r,e.from,i,n),c.toLocalFrame(o,e.to,i,n);for(var h=a.length,l=0;l<h&&!t.shouldStop(e);l++){var p=a[l],u=a[(l+1)%h],d=c.getLineSegmentsIntersectionFraction(r,o,p,u);0<=d&&(c.sub(s,u,p),c.rotate(s,s,-Math.PI/2+n),c.normalize(s,s),e.reportIntersection(t,d,s,l))}}},{"../math/polyk":29,"../math/vec2":30,"./Shape":45,"poly-decomp":5}],41:[function(t,e,i){var n=t("./Shape"),c=t("../math/vec2");t("../utils/Utils");function r(t){if(Array.isArray(arguments[0])&&(t={heights:arguments[0]},"object"==typeof arguments[1]))for(var e in arguments[1])t[e]=arguments[1][e];this.heights=(t=t||{}).heights?t.heights.slice(0):[],this.maxValue=t.maxValue||null,this.minValue=t.minValue||null,this.elementWidth=t.elementWidth||.1,void 0!==t.maxValue&&void 0!==t.minValue||this.updateMaxMinValues(),t.type=n.HEIGHTFIELD,n.call(this,t)}(((e.exports=r).prototype=new n).constructor=r).prototype.updateMaxMinValues=function(){for(var t=this.heights,e=t[0],i=t[0],n=0;n!==t.length;n++){var r=t[n];e<r&&(e=r),r<i&&(i=r)}this.maxValue=e,this.minValue=i},r.prototype.computeMomentOfInertia=function(t){return Number.MAX_VALUE},r.prototype.updateBoundingRadius=function(){this.boundingRadius=Number.MAX_VALUE},r.prototype.updateArea=function(){for(var t=this.heights,e=0,i=0;i<t.length-1;i++)e+=(t[i]+t[i+1])/2*this.elementWidth;this.area=e};var o=[c.create(),c.create(),c.create(),c.create()];r.prototype.computeAABB=function(t,e,i){c.set(o[0],0,this.maxValue),c.set(o[1],this.elementWidth*this.heights.length,this.maxValue),c.set(o[2],this.elementWidth*this.heights.length,this.minValue),c.set(o[3],0,this.minValue),t.setFromPoints(o,e,i)},r.prototype.getLineSegment=function(t,e,i){var n=this.heights,r=this.elementWidth;c.set(t,i*r,n[i]),c.set(e,(i+1)*r,n[i+1])},r.prototype.getSegmentIndex=function(t){return Math.floor(t[0]/this.elementWidth)},r.prototype.getClampedSegmentIndex=function(t){var t=this.getSegmentIndex(t);return t=Math.min(this.heights.length,Math.max(t,0))};c.create();var y=c.create(),_=c.create(),m=c.create(),g=c.create(),f=c.create();c.fromValues(0,1);r.prototype.raycast=function(t,e,i,n){var r=e.from,o=e.to,s=(e.direction,y),a=_,h=m,l=g,p=f;c.toLocalFrame(l,r,i,n),c.toLocalFrame(p,o,i,n);var r=this.getClampedSegmentIndex(l),o=this.getClampedSegmentIndex(p);o<r&&(i=r,r=o,o=i);for(var u=0;u<this.heights.length-1;u++){this.getLineSegment(a,h,u);var d=c.getLineSegmentsIntersectionFraction(l,p,a,h);if(0<=d&&(c.sub(s,h,a),c.rotate(s,s,n+Math.PI/2),c.normalize(s,s),e.reportIntersection(t,d,s,-1),t.shouldStop(e)))return}}},{"../math/vec2":30,"../utils/Utils":57,"./Shape":45}],42:[function(t,e,i){var n=t("./Shape"),l=t("../math/vec2");function r(t){"number"==typeof arguments[0]&&(t={length:arguments[0]}),this.length=(t=t||{}).length||1,t.type=n.LINE,n.call(this,t)}(((e.exports=r).prototype=new n).constructor=r).prototype.computeMomentOfInertia=function(t){return t*Math.pow(this.length,2)/12},r.prototype.updateBoundingRadius=function(){this.boundingRadius=this.length/2};var o=[l.create(),l.create()];r.prototype.computeAABB=function(t,e,i){var n=this.length/2;l.set(o[0],-n,0),l.set(o[1],n,0),t.setFromPoints(o,e,i,0)};l.create();var p=l.create(),u=l.create(),d=l.create(),c=l.fromValues(0,1);r.prototype.raycast=function(t,e,i,n){var r=e.from,o=e.to,s=u,a=d,h=this.length/2;l.set(s,-h,0),l.set(a,h,0),l.toGlobalFrame(s,s,i,n),l.toGlobalFrame(a,a,i,n);r=l.getLineSegmentsIntersectionFraction(s,a,r,o);0<=r&&(l.rotate(o=p,c,n),e.reportIntersection(t,r,o,-1))}},{"../math/vec2":30,"./Shape":45}],43:[function(t,e,i){var n=t("./Shape"),r=t("../math/vec2");function o(t){(t=t||{}).type=n.PARTICLE,n.call(this,t)}(((e.exports=o).prototype=new n).constructor=o).prototype.computeMomentOfInertia=function(t){return 0},o.prototype.updateBoundingRadius=function(){this.boundingRadius=0},o.prototype.computeAABB=function(t,e,i){r.copy(t.lowerBound,e),r.copy(t.upperBound,e)}},{"../math/vec2":30,"./Shape":45}],44:[function(t,e,i){var n=t("./Shape"),p=t("../math/vec2");t("../utils/Utils");function r(t){(t=t||{}).type=n.PLANE,n.call(this,t)}(((e.exports=r).prototype=new n).constructor=r).prototype.computeMomentOfInertia=function(t){return 0},r.prototype.updateBoundingRadius=function(){this.boundingRadius=Number.MAX_VALUE},r.prototype.computeAABB=function(t,e,i){var n=i%(2*Math.PI),r=p.set,o=Number.MAX_VALUE,i=t.lowerBound,t=t.upperBound;0==n?(r(i,-o,-o),r(t,o,0)):n==Math.PI/2?(r(i,0,-o),r(t,o,o)):n===Math.PI?(r(i,-o,0),r(t,o,o)):n==3*Math.PI/2?(r(i,-o,-o),r(t,0,o)):(r(i,-o,-o),r(t,o,o)),p.add(i,i,e),p.add(t,t,e)},r.prototype.updateArea=function(){this.area=Number.MAX_VALUE};var u=p.create(),d=(p.create(),p.create(),p.create()),c=p.create();r.prototype.raycast=function(t,e,i,n){var r=e.from,o=e.to,s=e.direction,a=u,h=d,l=c;p.set(h,0,1),p.rotate(h,h,n),p.sub(l,r,i);n=p.dot(l,h);p.sub(l,o,i),0<n*p.dot(l,h)||p.squaredDistance(r,o)<n*n||(s=p.dot(h,s),p.sub(a,r,i),s=-p.dot(h,a)/s/e.length,e.reportIntersection(t,s,h,-1))}},{"../math/vec2":30,"../utils/Utils":57,"./Shape":45}],45:[function(t,e,i){e.exports=r;var n=t("../math/vec2");function r(t){t=t||{},this.body=null,this.position=n.fromValues(0,0),t.position&&n.copy(this.position,t.position),this.angle=t.angle||0,this.type=t.type||0,this.id=r.idCounter++,this.boundingRadius=0,this.collisionGroup=void 0!==t.collisionGroup?t.collisionGroup:1,this.collisionResponse=void 0===t.collisionResponse||t.collisionResponse,this.collisionMask=void 0!==t.collisionMask?t.collisionMask:1,this.material=t.material||null,this.area=0,this.sensor=void 0!==t.sensor&&t.sensor,this.type&&this.updateBoundingRadius(),this.updateArea()}r.idCounter=0,r.CIRCLE=1,r.PARTICLE=2,r.PLANE=4,r.CONVEX=8,r.LINE=16,r.BOX=32,Object.defineProperty(r,"RECTANGLE",{get:function(){return r.BOX}}),r.CAPSULE=64,r.HEIGHTFIELD=128,r.prototype.computeMomentOfInertia=function(t){},r.prototype.updateBoundingRadius=function(){},r.prototype.updateArea=function(){},r.prototype.computeAABB=function(t,e,i){},r.prototype.raycast=function(t,e,i,n){}},{"../math/vec2":30}],46:[function(t,e,i){var z=t("../math/vec2"),n=t("./Solver"),b=t("../utils/Utils"),S=t("../equations/FrictionEquation");function C(t){n.call(this,t,n.GS),this.iterations=(t=t||{}).iterations||10,this.tolerance=t.tolerance||1e-7,this.arrayStep=30,this.lambda=new b.ARRAY_TYPE(this.arrayStep),this.Bs=new b.ARRAY_TYPE(this.arrayStep),this.invCs=new b.ARRAY_TYPE(this.arrayStep),this.useZeroRHS=!1,this.frictionIterations=0,this.usedIterations=0}(((e.exports=C).prototype=new n).constructor=C).prototype.solve=function(t,e){this.sortEquations();var i=0,n=this.iterations,r=this.frictionIterations,o=this.equations,s=o.length,a=Math.pow(this.tolerance*s,2),h=e.bodies,l=e.bodies.length,p=(z.add,z.set,this.useZeroRHS),u=this.lambda;if(this.usedIterations=0,s)for(var d=0;d!==l;d++)h[d].updateSolveMassProperties();u.length<s&&(u=this.lambda=new b.ARRAY_TYPE(s+this.arrayStep),this.Bs=new b.ARRAY_TYPE(s+this.arrayStep),this.invCs=new b.ARRAY_TYPE(s+this.arrayStep)),function(t){for(var e=t.length;e--;)t[e]=0}(u);for(var c,y,_,m=this.invCs,g=this.Bs,u=this.lambda,d=0;d!==o.length;d++)(c=o[d]).timeStep===t&&!c.needsUpdate||(c.timeStep=t,c.update()),g[d]=c.computeB(c.a,c.b,t),m[d]=c.computeInvC(c.epsilon);if(0!==s){for(d=0;d!==l;d++)h[d].resetConstraintVelocity();if(r){for(i=0;i!==r;i++){for(_=y=0;_!==s;_++){c=o[_];var f=C.iterateEquation(_,c,c.epsilon,g,m,u,p,t,i);y+=Math.abs(f)}if(this.usedIterations++,y*y<=a)break}for(C.updateMultipliers(o,u,1/t),_=0;_!==s;_++){var x=o[_];if(x instanceof S){for(var v=0,w=0;w!==x.contactEquations.length;w++)v+=x.contactEquations[w].multiplier;v*=x.frictionCoefficient/x.contactEquations.length,x.maxForce=v,x.minForce=-v}}}for(i=0;i!==n;i++){for(_=y=0;_!==s;_++){c=o[_];f=C.iterateEquation(_,c,c.epsilon,g,m,u,p,t,i);y+=Math.abs(f)}if(this.usedIterations++,y*y<=a)break}for(d=0;d!==l;d++)h[d].addConstraintVelocity();C.updateMultipliers(o,u,1/t)}},C.updateMultipliers=function(t,e,i){for(var n=t.length;n--;)t[n].multiplier=e[n]*i},C.iterateEquation=function(t,e,i,n,r,o,s,a,h){var l=n[t],p=r[t],u=o[t],d=e.computeGWlambda(),n=e.maxForce,r=e.minForce,d=p*((l=s?0:l)-d-i*u),i=u+d;return i<r*a?d=r*a-u:n*a<i&&(d=n*a-u),o[t]+=d,e.addToWlambda(d),d}},{"../equations/FrictionEquation":23,"../math/vec2":30,"../utils/Utils":57,"./Solver":47}],47:[function(t,e,i){t("../utils/Utils");var n=t("../events/EventEmitter");function r(t,e){t=t||{},n.call(this),this.type=e,this.equations=[],this.equationSortFunction=t.equationSortFunction||!1}(((e.exports=r).prototype=new n).constructor=r).prototype.solve=function(t,e){throw new Error("Solver.solve should be implemented by subclasses!")};var o={bodies:[]};r.prototype.solveIsland=function(t,e){this.removeAllEquations(),e.equations.length&&(this.addEquations(e.equations),o.bodies.length=0,e.getBodies(o.bodies),o.bodies.length&&this.solve(t,o))},r.prototype.sortEquations=function(){this.equationSortFunction&&this.equations.sort(this.equationSortFunction)},r.prototype.addEquation=function(t){t.enabled&&this.equations.push(t)},r.prototype.addEquations=function(t){for(var e=0,i=t.length;e!==i;e++){var n=t[e];n.enabled&&this.equations.push(n)}},r.prototype.removeEquation=function(t){t=this.equations.indexOf(t);-1!==t&&this.equations.splice(t,1)},r.prototype.removeAllEquations=function(){this.equations.length=0},r.GS=1,r.ISLAND=2},{"../events/EventEmitter":26,"../utils/Utils":57}],48:[function(t,e,i){var n=t("../equations/ContactEquation"),r=t("./Pool");function o(){r.apply(this,arguments)}(((e.exports=o).prototype=new r).constructor=o).prototype.create=function(){return new n},o.prototype.destroy=function(t){return t.bodyA=t.bodyB=null,this}},{"../equations/ContactEquation":21,"./Pool":55}],49:[function(t,e,i){var n=t("../equations/FrictionEquation"),r=t("./Pool");function o(){r.apply(this,arguments)}(((e.exports=o).prototype=new r).constructor=o).prototype.create=function(){return new n},o.prototype.destroy=function(t){return t.bodyA=t.bodyB=null,this}},{"../equations/FrictionEquation":23,"./Pool":55}],50:[function(t,e,i){var n=t("../world/IslandNode"),r=t("./Pool");function o(){r.apply(this,arguments)}(((e.exports=o).prototype=new r).constructor=o).prototype.create=function(){return new n},o.prototype.destroy=function(t){return t.reset(),this}},{"../world/IslandNode":60,"./Pool":55}],51:[function(t,e,i){var n=t("../world/Island"),r=t("./Pool");function o(){r.apply(this,arguments)}(((e.exports=o).prototype=new r).constructor=o).prototype.create=function(){return new n},o.prototype.destroy=function(t){return t.reset(),this}},{"../world/Island":58,"./Pool":55}],52:[function(t,e,i){var n=t("./TupleDictionary"),r=(t("./OverlapKeeperRecord"),t("./OverlapKeeperRecordPool"));t("./Utils");function o(){this.overlappingShapesLastState=new n,this.overlappingShapesCurrentState=new n,this.recordPool=new r({size:16}),this.tmpDict=new n,this.tmpArray1=[]}(e.exports=o).prototype.tick=function(){for(var t=this.overlappingShapesLastState,e=this.overlappingShapesCurrentState,i=t.keys.length;i--;){var n=t.keys[i],r=t.getByKey(n);e.getByKey(n);r&&this.recordPool.release(r)}t.reset(),t.copy(e),e.reset()},o.prototype.setOverlapping=function(t,e,i,n){this.overlappingShapesLastState;var r,o=this.overlappingShapesCurrentState;o.get(e.id,n.id)||((r=this.recordPool.get()).set(t,e,i,n),o.set(e.id,n.id,r))},o.prototype.getNewOverlaps=function(t){return this.getDiff(this.overlappingShapesLastState,this.overlappingShapesCurrentState,t)},o.prototype.getEndOverlaps=function(t){return this.getDiff(this.overlappingShapesCurrentState,this.overlappingShapesLastState,t)},o.prototype.bodiesAreOverlapping=function(t,e){for(var i=this.overlappingShapesCurrentState,n=i.keys.length;n--;){var r=i.keys[n],r=i.data[r];if(r.bodyA===t&&r.bodyB===e||r.bodyA===e&&r.bodyB===t)return!0}return!1},o.prototype.getDiff=function(t,e,i){var n=t,r=e;(i=i||[]).length=0;for(var o=r.keys.length;o--;){var s=r.keys[o],a=r.data[s];if(!a)throw new Error("Key "+s+" had no data!");n.data[s]||i.push(a)}return i},o.prototype.isNewOverlap=function(t,e){var i=0|t.id,n=0|e.id,t=this.overlappingShapesLastState,e=this.overlappingShapesCurrentState;return!t.get(i,n)&&!!e.get(i,n)},o.prototype.getNewBodyOverlaps=function(t){this.tmpArray1.length=0;var e=this.getNewOverlaps(this.tmpArray1);return this.getBodyDiff(e,t)},o.prototype.getEndBodyOverlaps=function(t){this.tmpArray1.length=0;var e=this.getEndOverlaps(this.tmpArray1);return this.getBodyDiff(e,t)},o.prototype.getBodyDiff=function(t,e){e=e||[];for(var i=this.tmpDict,n=t.length;n--;){var r=t[n];i.set(0|r.bodyA.id,0|r.bodyB.id,r)}for(n=i.keys.length;n--;)(r=i.getByKey(i.keys[n]))&&e.push(r.bodyA,r.bodyB);return i.reset(),e}},{"./OverlapKeeperRecord":53,"./OverlapKeeperRecordPool":54,"./TupleDictionary":56,"./Utils":57}],53:[function(t,e,i){function r(t,e,i,n){this.shapeA=e,this.shapeB=n,this.bodyA=t,this.bodyB=i}(e.exports=r).prototype.set=function(t,e,i,n){r.call(this,t,e,i,n)}},{}],54:[function(t,e,i){var n=t("./OverlapKeeperRecord"),r=t("./Pool");function o(){r.apply(this,arguments)}(((e.exports=o).prototype=new r).constructor=o).prototype.create=function(){return new n},o.prototype.destroy=function(t){return t.bodyA=t.bodyB=t.shapeA=t.shapeB=null,this}},{"./OverlapKeeperRecord":53,"./Pool":55}],55:[function(t,e,i){function n(t){t=t||{},this.objects=[],void 0!==t.size&&this.resize(t.size)}(e.exports=n).prototype.resize=function(t){for(var e=this.objects;e.length>t;)e.pop();for(;e.length<t;)e.push(this.create());return this},n.prototype.get=function(){var t=this.objects;return t.length?t.pop():this.create()},n.prototype.release=function(t){return this.destroy(t),this.objects.push(t),this}},{}],56:[function(t,e,i){var n=t("./Utils");function r(){this.data={},this.keys=[]}(e.exports=r).prototype.getKey=function(t,e){return(0|(t|=0))==(0|(e|=0))?-1:0|((0|e)<(0|t)?t<<16|65535&e:e<<16|65535&t)},r.prototype.getByKey=function(t){return this.data[t|=0]},r.prototype.get=function(t,e){return this.data[this.getKey(t,e)]},r.prototype.set=function(t,e,i){if(!i)throw new Error("No data!");e=this.getKey(t,e);return this.data[e]||this.keys.push(e),this.data[e]=i,e},r.prototype.reset=function(){for(var t=this.data,e=this.keys,i=e.length;i--;)delete t[e[i]];e.length=0},r.prototype.copy=function(t){this.reset(),n.appendArray(this.keys,t.keys);for(var e=t.keys.length;e--;){var i=t.keys[e];this.data[i]=t.data[i]}}},{"./Utils":57}],57:[function(t,e,i){function n(){}(e.exports=n).appendArray=function(t,e){if(e.length<15e4)t.push.apply(t,e);else for(var i=0,n=e.length;i!==n;++i)t.push(e[i])},n.splice=function(t,e,i){for(var n=e,r=t.length-(i=i||1);n<r;n++)t[n]=t[n+i];t.length=r},"undefined"!=typeof P2_ARRAY_TYPE?n.ARRAY_TYPE=P2_ARRAY_TYPE:"undefined"!=typeof Float32Array?n.ARRAY_TYPE=Float32Array:n.ARRAY_TYPE=Array,n.extend=function(t,e){for(var i in e)t[i]=e[i]},n.defaults=function(t,e){for(var i in t=t||{},e)i in t||(t[i]=e[i]);return t}},{}],58:[function(t,e,i){var n=t("../objects/Body");function r(){this.equations=[],this.bodies=[]}(e.exports=r).prototype.reset=function(){this.equations.length=this.bodies.length=0};var o=[];r.prototype.getBodies=function(t){for(var e=t||[],i=this.equations,n=o.length=0;n!==i.length;n++){var r=i[n];-1===o.indexOf(r.bodyA.id)&&(e.push(r.bodyA),o.push(r.bodyA.id)),-1===o.indexOf(r.bodyB.id)&&(e.push(r.bodyB),o.push(r.bodyB.id))}return e},r.prototype.wantsToSleep=function(){for(var t=0;t<this.bodies.length;t++){var e=this.bodies[t];if(e.type===n.DYNAMIC&&!e.wantsToSleep)return!1}return!0},r.prototype.sleep=function(){for(var t=0;t<this.bodies.length;t++)this.bodies[t].sleep();return!0}},{"../objects/Body":31}],59:[function(t,e,i){t("../math/vec2"),t("./Island"),t("./IslandNode");var n=t("./../utils/IslandNodePool"),r=t("./../utils/IslandPool"),s=t("../objects/Body");function c(t){this.nodePool=new n({size:16}),this.islandPool=new r({size:8}),this.equations=[],this.islands=[],this.nodes=[],this.queue=[]}(e.exports=c).getUnvisitedNode=function(t){for(var e=t.length,i=0;i!==e;i++){var n=t[i];if(!n.visited&&n.body.type===s.DYNAMIC)return n}return!1},c.prototype.visit=function(t,e,i){e.push(t.body);for(var n=t.equations.length,r=0;r!==n;r++){var o=t.equations[r];-1===i.indexOf(o)&&i.push(o)}},c.prototype.bfs=function(t,e,i){var n=this.queue;for(n.length=0,n.push(t),t.visited=!0,this.visit(t,e,i);n.length;)for(var r,o=n.pop();r=c.getUnvisitedNode(o.neighbors);)r.visited=!0,this.visit(r,e,i),r.body.type===s.DYNAMIC&&n.push(r)},c.prototype.split=function(t){for(var e=t.bodies,i=this.nodes,n=this.equations;i.length;)this.nodePool.release(i.pop());for(var r=0;r!==e.length;r++){var o=this.nodePool.get();o.body=e[r],i.push(o)}for(var s=0;s!==n.length;s++){var a=n[s],r=e.indexOf(a.bodyA),h=e.indexOf(a.bodyB),l=i[r],h=i[h];l.neighbors.push(h),h.neighbors.push(l),l.equations.push(a),h.equations.push(a)}for(var p,u=this.islands,r=0;r<u.length;r++)this.islandPool.release(u[r]);for(u.length=0;p=c.getUnvisitedNode(i);){var d=this.islandPool.get();this.bfs(p,d.bodies,d.equations),u.push(d)}return u}},{"../math/vec2":30,"../objects/Body":31,"./../utils/IslandNodePool":50,"./../utils/IslandPool":51,"./Island":58,"./IslandNode":60}],60:[function(t,e,i){function n(t){this.body=t,this.neighbors=[],this.equations=[],this.visited=!1}(e.exports=n).prototype.reset=function(){this.equations.length=0,this.neighbors.length=0,this.visited=!1,this.body=null}},{}],61:[function(t,e,i){var n=t("../solver/GSSolver"),W=(t("../solver/Solver"),t("../collision/Ray"),t("../math/vec2")),g=t("../shapes/Circle"),f=t("../shapes/Convex"),x=(t("../shapes/Line"),t("../shapes/Plane")),v=t("../shapes/Capsule"),w=t("../shapes/Particle"),r=t("../events/EventEmitter"),X=t("../objects/Body"),o=(t("../shapes/Shape"),t("../objects/LinearSpring"),t("../material/Material")),s=t("../material/ContactMaterial"),a=(t("../constraints/DistanceConstraint"),t("../constraints/Constraint"),t("../constraints/LockConstraint"),t("../constraints/RevoluteConstraint"),t("../constraints/PrismaticConstraint"),t("../constraints/GearConstraint"),t("../../package.json"),t("../collision/Broadphase"),t("../collision/AABB")),h=t("../collision/SAPBroadphase"),l=t("../collision/Narrowphase"),H=t("../utils/Utils"),p=t("../utils/OverlapKeeper"),u=t("./IslandManager");t("../objects/RotationalSpring");function q(t){r.apply(this),t=t||{},this.springs=[],this.bodies=[],this.disabledBodyCollisionPairs=[],this.solver=t.solver||new n,this.narrowphase=new l(this),this.islandManager=new u,this.gravity=W.fromValues(0,-9.78),t.gravity&&W.copy(this.gravity,t.gravity),this.frictionGravity=W.length(this.gravity)||10,this.useWorldGravityAsFrictionGravity=!0,this.useFrictionGravityOnZeroGravity=!0,this.broadphase=t.broadphase||new h,this.broadphase.setWorld(this),this.constraints=[],this.defaultMaterial=new o,this.defaultContactMaterial=new s(this.defaultMaterial,this.defaultMaterial),this.lastTimeStep=1/60,this.applySpringForces=!0,this.applyDamping=!0,this.applyGravity=!0,this.solveConstraints=!0,this.contactMaterials=[],this.time=0,this.accumulator=0,this.stepping=!1,this.bodiesToBeRemoved=[],this.islandSplit=void 0===t.islandSplit||!!t.islandSplit,this.emitImpactEvent=!0,this._constraintIdCounter=0,this._bodyIdCounter=0,this.postStepEvent={type:"postStep"},this.addBodyEvent={type:"addBody",body:null},this.removeBodyEvent={type:"removeBody",body:null},this.addSpringEvent={type:"addSpring",spring:null},this.impactEvent={type:"impact",bodyA:null,bodyB:null,shapeA:null,shapeB:null,contactEquation:null},this.postBroadphaseEvent={type:"postBroadphase",pairs:null},this.sleepMode=q.NO_SLEEPING,this.beginContactEvent={type:"beginContact",shapeA:null,shapeB:null,bodyA:null,bodyB:null,contactEquations:[]},this.endContactEvent={type:"endContact",shapeA:null,shapeB:null,bodyA:null,bodyB:null},this.preSolveEvent={type:"preSolve",contactEquations:null,frictionEquations:null},this.overlappingShapesLastState={keys:[]},this.overlappingShapesCurrentState={keys:[]},this.overlapKeeper=new p}(((e.exports=q).prototype=new Object(r.prototype)).constructor=q).NO_SLEEPING=1,q.BODY_SLEEPING=2,q.ISLAND_SLEEPING=4,q.prototype.addConstraint=function(t){this.constraints.push(t)},q.prototype.addContactMaterial=function(t){this.contactMaterials.push(t)},q.prototype.removeContactMaterial=function(t){t=this.contactMaterials.indexOf(t);-1!==t&&H.splice(this.contactMaterials,t,1)},q.prototype.getContactMaterial=function(t,e){for(var i=this.contactMaterials,n=0,r=i.length;n!==r;n++){var o=i[n];if(o.materialA.id===t.id&&o.materialB.id===e.id||o.materialA.id===e.id&&o.materialB.id===t.id)return o}return!1},q.prototype.removeConstraint=function(t){t=this.constraints.indexOf(t);-1!==t&&H.splice(this.constraints,t,1)};W.create(),W.create(),W.create(),W.create(),W.create(),W.create();var Y=W.create(),m=W.fromValues(0,0),z=W.fromValues(0,0);W.fromValues(0,0),W.fromValues(0,0);q.prototype.step=function(t,e,i){if(i=i||10,0===(e=e||0))this.internalStep(t),this.time+=t;else{this.accumulator+=e;for(var n=0;this.accumulator>=t&&n<i;)this.internalStep(t),this.time+=t,this.accumulator-=t,n++;for(var r=this.accumulator%t/t,o=0;o!==this.bodies.length;o++){var s=this.bodies[o];W.lerp(s.interpolatedPosition,s.previousPosition,s.position,r),s.interpolatedAngle=s.previousAngle+r*(s.angle-s.previousAngle)}}};var K=[];q.prototype.internalStep=function(t){this.stepping=!0;var e,i=this.springs.length,n=this.springs,r=this.bodies,o=this.gravity,s=this.solver,a=this.bodies.length,h=this.broadphase,l=this.narrowphase,p=this.constraints,u=Y,d=(W.scale,W.add),c=(W.rotate,this.islandManager);if(this.overlapKeeper.tick(),this.lastTimeStep=t,this.useWorldGravityAsFrictionGravity&&(0===(e=W.length(this.gravity))&&this.useFrictionGravityOnZeroGravity||(this.frictionGravity=e)),this.applyGravity)for(var y=0;y!==a;y++){var _=(m=r[y]).force;m.type===X.DYNAMIC&&m.sleepState!==X.SLEEPING&&(W.scale(u,o,m.mass*m.gravityScale),d(_,_,u))}if(this.applySpringForces)for(y=0;y!==i;y++)n[y].applyForce();if(this.applyDamping)for(var m,y=0;y!==a;y++)(m=r[y]).type===X.DYNAMIC&&m.applyDamping(t);for(var g=h.getCollisionPairs(this),f=this.disabledBodyCollisionPairs,y=f.length-2;0<=y;y-=2)for(var x=g.length-2;0<=x;x-=2)(f[y]===g[x]&&f[y+1]===g[x+1]||f[y+1]===g[x]&&f[y]===g[x+1])&&g.splice(x,2);var v=p.length;for(y=0;y!==v;y++){var w=p[y];if(!w.collideConnected)for(x=g.length-2;0<=x;x-=2)(w.bodyA===g[x]&&w.bodyB===g[x+1]||w.bodyB===g[x]&&w.bodyA===g[x+1])&&g.splice(x,2)}this.postBroadphaseEvent.pairs=g,this.emit(this.postBroadphaseEvent),this.postBroadphaseEvent.pairs=null,l.reset(this);for(var y=0,z=g.length;y!==z;y+=2)for(var b=g[y],S=g[y+1],C=0,P=b.shapes.length;C!==P;C++)for(var M=b.shapes[C],T=M.position,A=M.angle,k=0,O=S.shapes.length;k!==O;k++){var E,I=S.shapes[k],G=I.position,D=I.angle,L=this.defaultContactMaterial;M.material&&I.material&&((E=this.getContactMaterial(M.material,I.material))&&(L=E)),this.runNarrowphase(l,b,M,T,A,S,I,G,D,L,this.frictionGravity)}for(y=0;y!==a;y++)(F=r[y])._wakeUpAfterNarrowphase&&(F.wakeUp(),F._wakeUpAfterNarrowphase=!1);if(this.has("endContact")){this.overlapKeeper.getEndOverlaps(K);for(var B=this.endContactEvent,k=K.length;k--;){var R=K[k];B.shapeA=R.shapeA,B.shapeB=R.shapeB,B.bodyA=R.bodyA,B.bodyB=R.bodyB,this.emit(B)}K.length=0}h=this.preSolveEvent;h.contactEquations=l.contactEquations,h.frictionEquations=l.frictionEquations,this.emit(h),h.contactEquations=h.frictionEquations=null;v=p.length;for(y=0;y!==v;y++)p[y].update();if(l.contactEquations.length||l.frictionEquations.length||v)if(this.islandSplit){for(c.equations.length=0,H.appendArray(c.equations,l.contactEquations),H.appendArray(c.equations,l.frictionEquations),y=0;y!==v;y++)H.appendArray(c.equations,p[y].equations);c.split(this);for(y=0;y!==c.islands.length;y++)(U=c.islands[y]).equations.length&&s.solveIsland(t,U)}else{for(s.addEquations(l.contactEquations),s.addEquations(l.frictionEquations),y=0;y!==v;y++)s.addEquations(p[y].equations);this.solveConstraints&&s.solve(t,this),s.removeAllEquations()}for(var F,y=0;y!==a;y++)(F=r[y]).integrate(t);for(y=0;y!==a;y++)r[y].setZeroForce();if(this.emitImpactEvent&&this.has("impact"))for(var N=this.impactEvent,y=0;y!==l.contactEquations.length;y++){var j=l.contactEquations[y];j.firstImpact&&(N.bodyA=j.bodyA,N.bodyB=j.bodyB,N.shapeA=j.shapeA,N.shapeB=j.shapeB,N.contactEquation=j,this.emit(N))}if(this.sleepMode===q.BODY_SLEEPING)for(y=0;y!==a;y++)r[y].sleepTick(this.time,!1,t);else if(this.sleepMode===q.ISLAND_SLEEPING&&this.islandSplit){for(y=0;y!==a;y++)r[y].sleepTick(this.time,!0,t);for(var U,y=0;y<this.islandManager.islands.length;y++)(U=this.islandManager.islands[y]).wantsToSleep()&&U.sleep()}this.stepping=!1;for(var V=this.bodiesToBeRemoved,y=0;y!==V.length;y++)this.removeBody(V[y]);V.length=0,this.emit(this.postStepEvent)},q.prototype.runNarrowphase=function(t,e,i,n,r,o,s,a,h,l,p){if(0!=(i.collisionGroup&s.collisionMask)&&0!=(s.collisionGroup&i.collisionMask)){W.rotate(m,n,e.angle),W.rotate(z,a,o.angle),W.add(m,m,e.position),W.add(z,z,o.position);n=r+e.angle,a=h+o.angle;t.enableFriction=0<l.friction,t.frictionCoefficient=l.friction,r=e.type===X.STATIC||e.type===X.KINEMATIC?o.mass:o.type===X.STATIC||o.type===X.KINEMATIC?e.mass:e.mass*o.mass/(e.mass+o.mass),t.slipForce=l.friction*p*r,t.restitution=l.restitution,t.surfaceVelocity=l.surfaceVelocity,t.frictionStiffness=l.frictionStiffness,t.frictionRelaxation=l.frictionRelaxation,t.stiffness=l.stiffness,t.relaxation=l.relaxation,t.contactSkinSize=l.contactSkinSize,t.enabledEquations=e.collisionResponse&&o.collisionResponse&&i.collisionResponse&&s.collisionResponse;h=t[i.type|s.type],p=0;if(h){var u,r=i.sensor||s.sensor,l=t.frictionEquations.length,p=i.type<s.type?h.call(t,e,i,m,n,o,s,z,a,r):h.call(t,o,s,z,a,e,i,m,n,r),d=t.frictionEquations.length-l;if(p){if(e.allowSleep&&e.type===X.DYNAMIC&&e.sleepState===X.SLEEPING&&o.sleepState===X.AWAKE&&o.type!==X.STATIC&&(u=W.squaredLength(o.velocity)+Math.pow(o.angularVelocity,2),2*Math.pow(o.sleepSpeedLimit,2)<=u&&(e._wakeUpAfterNarrowphase=!0)),o.allowSleep&&o.type===X.DYNAMIC&&o.sleepState===X.SLEEPING&&e.sleepState===X.AWAKE&&e.type!==X.STATIC&&(u=W.squaredLength(e.velocity)+Math.pow(e.angularVelocity,2),2*Math.pow(e.sleepSpeedLimit,2)<=u&&(o._wakeUpAfterNarrowphase=!0)),this.overlapKeeper.setOverlapping(e,i,o,s),this.has("beginContact")&&this.overlapKeeper.isNewOverlap(i,s)){var c=this.beginContactEvent;if(c.shapeA=i,c.shapeB=s,c.bodyA=e,c.bodyB=o,c.contactEquations.length=0,"number"==typeof p)for(var y=t.contactEquations.length-p;y<t.contactEquations.length;y++)c.contactEquations.push(t.contactEquations[y]);this.emit(c)}if("number"==typeof p&&1<d)for(y=t.frictionEquations.length-d;y<t.frictionEquations.length;y++){var _=t.frictionEquations[y];_.setSlipForce(_.getSlipForce()/d)}}}}},q.prototype.addSpring=function(t){this.springs.push(t);var e=this.addSpringEvent;e.spring=t,this.emit(e),e.spring=null},q.prototype.removeSpring=function(t){t=this.springs.indexOf(t);-1!==t&&H.splice(this.springs,t,1)},q.prototype.addBody=function(t){var e;-1===this.bodies.indexOf(t)&&(this.bodies.push(t),(e=(t.world=this).addBodyEvent).body=t,this.emit(e),e.body=null)},q.prototype.removeBody=function(t){var e;this.stepping?this.bodiesToBeRemoved.push(t):(t.world=null,-1!==(e=this.bodies.indexOf(t))&&(H.splice(this.bodies,e,1),(this.removeBodyEvent.body=t).resetConstraintVelocity(),this.emit(this.removeBodyEvent),this.removeBodyEvent.body=null))},q.prototype.getBodyById=function(t){for(var e=this.bodies,i=0;i<e.length;i++){var n=e[i];if(n.id===t)return n}return!1},q.prototype.disableBodyCollision=function(t,e){this.disabledBodyCollisionPairs.push(t,e)},q.prototype.enableBodyCollision=function(t,e){for(var i=this.disabledBodyCollisionPairs,n=0;n<i.length;n+=2)if(i[n]===t&&i[n+1]===e||i[n+1]===t&&i[n]===e)return void i.splice(n,2)},q.prototype.clear=function(){this.time=0,this.solver&&this.solver.equations.length&&this.solver.removeAllEquations();for(var t=this.constraints,e=t.length-1;0<=e;e--)this.removeConstraint(t[e]);for(var i=this.bodies,e=i.length-1;0<=e;e--)this.removeBody(i[e]);for(var n=this.springs,e=n.length-1;0<=e;e--)this.removeSpring(n[e]);for(var r=this.contactMaterials,e=r.length-1;0<=e;e--)this.removeContactMaterial(r[e]);q.apply(this)};var b=W.create(),S=(W.fromValues(0,0),W.fromValues(0,0));q.prototype.hitTest=function(t,e,i){i=i||0;var n=new X({position:t}),r=new w,o=t,s=b,a=S;n.addShape(r);for(var h=this.narrowphase,l=[],p=0,u=e.length;p!==u;p++)for(var d=e[p],c=0,y=d.shapes.length;c!==y;c++){var _=d.shapes[c];W.rotate(s,_.position,d.angle),W.add(s,s,d.position);var m=_.angle+d.angle;(_ instanceof g&&h.circleParticle(d,_,s,m,n,r,o,0,!0)||_ instanceof f&&h.particleConvex(n,r,o,0,d,_,s,m,!0)||_ instanceof x&&h.particlePlane(n,r,o,0,d,_,s,m,!0)||_ instanceof v&&h.particleCapsule(n,r,o,0,d,_,s,m,!0)||_ instanceof w&&W.squaredLength(W.sub(a,s,t))<i*i)&&l.push(d)}return l},q.prototype.setGlobalStiffness=function(t){for(var e=this.constraints,i=0;i!==e.length;i++)for(var n=e[i],r=0;r!==n.equations.length;r++){var o=n.equations[r];o.stiffness=t,o.needsUpdate=!0}for(var s=this.contactMaterials,i=0;i!==s.length;i++)(n=s[i]).stiffness=n.frictionStiffness=t;(n=this.defaultContactMaterial).stiffness=n.frictionStiffness=t},q.prototype.setGlobalRelaxation=function(t){for(var e=0;e!==this.constraints.length;e++)for(var i=this.constraints[e],n=0;n!==i.equations.length;n++){var r=i.equations[n];r.relaxation=t,r.needsUpdate=!0}for(e=0;e!==this.contactMaterials.length;e++)(i=this.contactMaterials[e]).relaxation=i.frictionRelaxation=t;(i=this.defaultContactMaterial).relaxation=i.frictionRelaxation=t};var d=new a,c=[];q.prototype.raycast=function(t,e){return e.getAABB(d),this.broadphase.aabbQuery(this,d,c),e.intersectBodies(t,c),c.length=0,t.hasHit()}},{"../../package.json":6,"../collision/AABB":7,"../collision/Broadphase":8,"../collision/Narrowphase":10,"../collision/Ray":11,"../collision/SAPBroadphase":13,"../constraints/Constraint":14,"../constraints/DistanceConstraint":15,"../constraints/GearConstraint":16,"../constraints/LockConstraint":17,"../constraints/PrismaticConstraint":18,"../constraints/RevoluteConstraint":19,"../events/EventEmitter":26,"../material/ContactMaterial":27,"../material/Material":28,"../math/vec2":30,"../objects/Body":31,"../objects/LinearSpring":32,"../objects/RotationalSpring":33,"../shapes/Capsule":38,"../shapes/Circle":39,"../shapes/Convex":40,"../shapes/Line":42,"../shapes/Particle":43,"../shapes/Plane":44,"../shapes/Shape":45,"../solver/GSSolver":46,"../solver/Solver":47,"../utils/OverlapKeeper":52,"../utils/Utils":57,"./IslandManager":59}]},{},[36])(36)}),function(){var t=this,P={game:null,WEBGL_RENDERER:0,CANVAS_RENDERER:1,VERSION:"v2.2.9",_UID:0};return"undefined"!=typeof Float32Array?(P.Float32Array=Float32Array,P.Uint16Array=Uint16Array,P.Uint32Array=Uint32Array,P.ArrayBuffer=ArrayBuffer):(P.Float32Array=Array,P.Uint16Array=Array),P.PI_2=2*Math.PI,P.RAD_TO_DEG=180/Math.PI,P.DEG_TO_RAD=Math.PI/180,P.RETINA_PREFIX="@2x",P.DisplayObject=function(){this.position=new P.Point(0,0),this.scale=new P.Point(1,1),this.pivot=new P.Point(0,0),this.rotation=0,this.alpha=1,this.visible=!0,this.hitArea=null,this.renderable=!1,this.parent=null,this.worldAlpha=1,this.worldTransform=new P.Matrix,this.worldPosition=new P.Point(0,0),this.worldScale=new P.Point(1,1),this.worldRotation=0,this.filterArea=null,this._sr=0,this._cr=1,this._bounds=new P.Rectangle(0,0,0,0),this._currentBounds=null,this._mask=null,this._cacheAsBitmap=!1,this._cacheIsDirty=!1},P.DisplayObject.prototype.constructor=P.DisplayObject,P.DisplayObject.prototype={destroy:function(){if(this.children){for(var t=this.children.length;t--;)this.children[t].destroy();this.children=[]}this.hitArea=null,this.parent=null,this.worldTransform=null,this.filterArea=null,this.renderable=!1,this._bounds=null,this._currentBounds=null,this._mask=null,this._destroyCachedSprite()},updateTransform:function(t){if(!t&&!this.parent&&!this.game)return this;var e=this.parent;t?e=t:this.parent||(e=this.game.world);var i,n,r,o,s,a=e.worldTransform,h=this.worldTransform;return this.rotation%P.PI_2?(this.rotation!==this.rotationCache&&(this.rotationCache=this.rotation,this._sr=Math.sin(this.rotation),this._cr=Math.cos(this.rotation)),i=this._cr*this.scale.x,n=this._sr*this.scale.x,t=-this._sr*this.scale.y,r=this._cr*this.scale.y,o=this.position.x,s=this.position.y,(this.pivot.x||this.pivot.y)&&(o-=this.pivot.x*i+this.pivot.y*t,s-=this.pivot.x*n+this.pivot.y*r),h.a=i*a.a+n*a.c,h.b=i*a.b+n*a.d,h.c=t*a.a+r*a.c,h.d=t*a.b+r*a.d):(i=this.scale.x,r=this.scale.y,o=this.position.x-this.pivot.x*i,s=this.position.y-this.pivot.y*r,h.a=i*a.a,h.b=i*a.b,h.c=r*a.c,h.d=r*a.d),h.tx=o*a.a+s*a.c+a.tx,h.ty=o*a.b+s*a.d+a.ty,this.worldAlpha=this.alpha*e.worldAlpha,this.worldPosition.set(h.tx,h.ty),this.worldScale.set(this.scale.x*Math.sqrt(h.a*h.a+h.c*h.c),this.scale.y*Math.sqrt(h.b*h.b+h.d*h.d)),this.worldRotation=Math.atan2(-h.c,h.d),this._currentBounds=null,this.transformCallback&&this.transformCallback.call(this.transformCallbackContext,h,a),this},preUpdate:function(){},generateTexture:function(t,e,i){var n=this.getLocalBounds(),t=new P.RenderTexture(0|n.width,0|n.height,i,e,t);return P.DisplayObject._tempMatrix.tx=-n.x,P.DisplayObject._tempMatrix.ty=-n.y,t.render(this,P.DisplayObject._tempMatrix),t},updateCache:function(){return this._generateCachedSprite(),this},toGlobal:function(t){return this.updateTransform(),this.worldTransform.apply(t)},toLocal:function(t,e){return e&&(t=e.toGlobal(t)),this.updateTransform(),this.worldTransform.applyInverse(t)},_renderCachedSprite:function(t){this._cachedSprite.worldAlpha=this.worldAlpha,(t.gl?P.Sprite.prototype._renderWebGL:P.Sprite.prototype._renderCanvas).call(this._cachedSprite,t)},_generateCachedSprite:function(){this._cacheAsBitmap=!1;var t=this.getLocalBounds();t.width=Math.max(1,Math.ceil(t.width)),t.height=Math.max(1,Math.ceil(t.height)),this.updateTransform(),this._cachedSprite?this._cachedSprite.texture.resize(t.width,t.height):(e=new P.RenderTexture(t.width,t.height),this._cachedSprite=new P.Sprite(e),this._cachedSprite.worldTransform=this.worldTransform);var e=this._filters;this._filters=null,this._cachedSprite.filters=e,P.DisplayObject._tempMatrix.tx=-t.x,P.DisplayObject._tempMatrix.ty=-t.y,this._cachedSprite.texture.render(this,P.DisplayObject._tempMatrix,!0),this._cachedSprite.anchor.x=-(t.x/t.width),this._cachedSprite.anchor.y=-(t.y/t.height),this._filters=e,this._cacheAsBitmap=!0},_destroyCachedSprite:function(){this._cachedSprite&&(this._cachedSprite.texture.destroy(!0),this._cachedSprite=null)}},P.DisplayObject.prototype.displayObjectUpdateTransform=P.DisplayObject.prototype.updateTransform,Object.defineProperties(P.DisplayObject.prototype,{x:{get:function(){return this.position.x},set:function(t){this.position.x=t}},y:{get:function(){return this.position.y},set:function(t){this.position.y=t}},worldVisible:{get:function(){if(this.visible){var t=this.parent;if(!t)return this.visible;do{if(!t.visible)return!1}while(t=t.parent);return!0}return!1}},mask:{get:function(){return this._mask},set:function(t){this._mask&&(this._mask.isMask=!1),(this._mask=t)&&(this._mask.isMask=!0)}},filters:{get:function(){return this._filters},set:function(t){if(Array.isArray(t)){for(var e=[],i=0;i<t.length;i++)for(var n=t[i].passes,r=0;r<n.length;r++)e.push(n[r]);this._filterBlock={target:this,filterPasses:e}}this._filters=t,this.blendMode&&this.blendMode===P.blendModes.MULTIPLY&&(this.blendMode=P.blendModes.NORMAL)}},cacheAsBitmap:{get:function(){return this._cacheAsBitmap},set:function(t){this._cacheAsBitmap!==t&&(t?this._generateCachedSprite():this._destroyCachedSprite(),this._cacheAsBitmap=t)}}}),P.DisplayObjectContainer=function(){P.DisplayObject.call(this),this.children=[],this.ignoreChildInput=!1},P.DisplayObjectContainer.prototype=Object.create(P.DisplayObject.prototype),P.DisplayObjectContainer.prototype.constructor=P.DisplayObjectContainer,P.DisplayObjectContainer.prototype.addChild=function(t){return this.addChildAt(t,this.children.length)},P.DisplayObjectContainer.prototype.addChildAt=function(t,e){if(0<=e&&e<=this.children.length)return t.parent&&t.parent.removeChild(t),(t.parent=this).children.splice(e,0,t),t;throw new Error(t+"addChildAt: The index "+e+" supplied is out of bounds "+this.children.length)},P.DisplayObjectContainer.prototype.swapChildren=function(t,e){if(t!==e){var i=this.getChildIndex(t),n=this.getChildIndex(e);if(i<0||n<0)throw new Error("swapChildren: Both the supplied DisplayObjects must be a child of the caller.");this.children[i]=e,this.children[n]=t}},P.DisplayObjectContainer.prototype.getChildIndex=function(t){t=this.children.indexOf(t);if(-1===t)throw new Error("The supplied DisplayObject must be a child of the caller");return t},P.DisplayObjectContainer.prototype.setChildIndex=function(t,e){if(e<0||e>=this.children.length)throw new Error("The supplied index is out of bounds");var i=this.getChildIndex(t);this.children.splice(i,1),this.children.splice(e,0,t)},P.DisplayObjectContainer.prototype.getChildAt=function(t){if(t<0||t>=this.children.length)throw new Error("getChildAt: Supplied index "+t+" does not exist in the child list, or the supplied DisplayObject must be a child of the caller");return this.children[t]},P.DisplayObjectContainer.prototype.removeChild=function(t){t=this.children.indexOf(t);if(-1!==t)return this.removeChildAt(t)},P.DisplayObjectContainer.prototype.removeChildAt=function(t){var e=this.getChildAt(t);return e&&(e.parent=void 0,this.children.splice(t,1)),e},P.DisplayObjectContainer.prototype.removeChildren=function(t,e){t=(e=void 0===e?this.children.length:e)-(t=void 0===t?0:t);if(0<t&&t<=e){for(var i=this.children.splice(begin,t),n=0;n<i.length;n++)i[n].parent=void 0;return i}if(0==t&&0===this.children.length)return[];throw new Error("removeChildren: Range Error, numeric values are outside the acceptable range")},P.DisplayObjectContainer.prototype.updateTransform=function(){if(this.visible&&(this.displayObjectUpdateTransform(),!this._cacheAsBitmap))for(var t=0;t<this.children.length;t++)this.children[t].updateTransform()},P.DisplayObjectContainer.prototype.displayObjectContainerUpdateTransform=P.DisplayObjectContainer.prototype.updateTransform,P.DisplayObjectContainer.prototype.getBounds=function(t){var e=t&&t instanceof P.DisplayObject,i=!0;if(e?i=t instanceof P.DisplayObjectContainer&&t.contains(this):t=this,e){var n=t.worldTransform;for(t.worldTransform=P.identityMatrix,u=0;u<t.children.length;u++)t.children[u].updateTransform()}for(var r,o,s=1/0,a=1/0,h=-1/0,l=-1/0,p=!1,u=0;u<this.children.length;u++)this.children[u].visible&&(p=!0,s=s<(o=this.children[u].getBounds()).x?s:o.x,a=a<o.y?a:o.y,h=(r=o.width+o.x)<h?h:r,l=(o=o.height+o.y)<l?l:o);var d,c,y,_,m,g,f,x,v,w,z,b,S,C=this._bounds;if(p||(v=(C=new P.Rectangle).x,d=C.width+C.x,z=C.y,c=C.height+C.y,y=(S=this.worldTransform).a,_=S.b,g=S.c,m=S.d,s=(b=y*d+g*z+(f=S.tx))<(s=(w=y*v+g*z+f)<(s=(x=y*v+g*c+f)<(s=g=y*d+g*c+f)?x:s)?w:s)?b:s,a=(S=m*z+_*d+(f=S.ty))<(a=(z=m*z+_*v+f)<(a=(v=m*c+_*v+f)<(a=f=m*c+_*d+f)?v:a)?z:a)?S:a,h=(h=(h=(h=g)<x?x:h)<w?w:h)<b?b:h,l=(l=(l=(l=f)<v?v:l)<z?z:l)<S?S:l),C.x=s,C.y=a,C.width=h-s,C.height=l-a,e)for(t.worldTransform=n,u=0;u<t.children.length;u++)t.children[u].updateTransform();return i||(i=t.getBounds(),C.x-=i.x,C.y-=i.y),C},P.DisplayObjectContainer.prototype.getLocalBounds=function(){return this.getBounds(this)},P.DisplayObjectContainer.prototype.contains=function(t){return!!t&&(t===this||this.contains(t.parent))},P.DisplayObjectContainer.prototype._renderWebGL=function(t){var e;if(this.visible&&!(this.alpha<=0))if(this._cacheAsBitmap)this._renderCachedSprite(t);else if(this._mask||this._filters){for(this._filters&&(t.spriteBatch.flush(),t.filterManager.pushFilter(this._filterBlock)),this._mask&&(t.spriteBatch.stop(),t.maskManager.pushMask(this.mask,t),t.spriteBatch.start()),e=0;e<this.children.length;e++)this.children[e]._renderWebGL(t);t.spriteBatch.stop(),this._mask&&t.maskManager.popMask(this._mask,t),this._filters&&t.filterManager.popFilter(),t.spriteBatch.start()}else for(e=0;e<this.children.length;e++)this.children[e]._renderWebGL(t)},P.DisplayObjectContainer.prototype._renderCanvas=function(t){if(!1!==this.visible&&0!==this.alpha)if(this._cacheAsBitmap)this._renderCachedSprite(t);else{this._mask&&t.maskManager.pushMask(this._mask,t);for(var e=0;e<this.children.length;e++)this.children[e]._renderCanvas(t);this._mask&&t.maskManager.popMask(t)}},Object.defineProperty(P.DisplayObjectContainer.prototype,"width",{get:function(){return this.getLocalBounds().width*this.scale.x},set:function(t){var e=this.getLocalBounds().width;this.scale.x=0!==e?t/e:1,this._width=t}}),Object.defineProperty(P.DisplayObjectContainer.prototype,"height",{get:function(){return this.getLocalBounds().height*this.scale.y},set:function(t){var e=this.getLocalBounds().height;this.scale.y=0!==e?t/e:1,this._height=t}}),P.Sprite=function(t){P.DisplayObjectContainer.call(this),this.anchor=new P.Point,this.texture=t||P.Texture.emptyTexture,this._width=0,this._height=0,this.tint=16777215,this.cachedTint=-1,this.tintedTexture=null,this.blendMode=P.blendModes.NORMAL,this.shader=null,this.exists=!0,this.texture.baseTexture.hasLoaded&&this.onTextureUpdate(),this.renderable=!0},P.Sprite.prototype=Object.create(P.DisplayObjectContainer.prototype),P.Sprite.prototype.constructor=P.Sprite,Object.defineProperty(P.Sprite.prototype,"width",{get:function(){return this.scale.x*this.texture.frame.width},set:function(t){this.scale.x=t/this.texture.frame.width,this._width=t}}),Object.defineProperty(P.Sprite.prototype,"height",{get:function(){return this.scale.y*this.texture.frame.height},set:function(t){this.scale.y=t/this.texture.frame.height,this._height=t}}),P.Sprite.prototype.setTexture=function(t,e){void 0!==e&&this.texture.baseTexture.destroy(),this.texture.baseTexture.skipRender=!1,this.texture=t,this.texture.valid=!0,this.cachedTint=-1},P.Sprite.prototype.onTextureUpdate=function(){this._width&&(this.scale.x=this._width/this.texture.frame.width),this._height&&(this.scale.y=this._height/this.texture.frame.height)},P.Sprite.prototype.getBounds=function(t){var e,i=this.texture.frame.width,n=this.texture.frame.height,r=i*(1-this.anchor.x),o=i*-this.anchor.x,s=n*(1-this.anchor.y),a=n*-this.anchor.y,h=t||this.worldTransform,l=h.a,p=h.b,u=h.c,d=h.d,c=h.tx,y=h.ty,_=-1/0,m=-1/0,i=1/0,n=1/0,m=0===p&&0===u?(l<0&&(l*=-1,e=r,r=-o,o=-e),d<0&&(d*=-1,e=s,s=-a,a=-e),i=l*o+c,_=l*r+c,n=d*a+y,d*s+y):(i=(t=l*o+u*s+c)<(i=(h=l*r+u*s+c)<(i=(e=l*r+u*a+c)<(i=(c=l*o+u*a+c)<i?c:i)?e:i)?h:i)?t:i,n=(g=d*s+p*o+y)<(n=(s=d*s+p*r+y)<(n=(r=d*a+p*r+y)<(n=(y=d*a+p*o+y)<n?y:n)?r:n)?s:n)?g:n,_=(_=(_=(_=_<c?c:_)<e?e:_)<h?h:_)<t?t:_,(m=(m=(m=m<y?y:m)<r?r:m)<s?s:m)<g?g:m),g=this._bounds;return g.x=i,g.width=_-i,g.y=n,g.height=m-n,this._currentBounds=g},P.Sprite.prototype.getLocalBounds=function(){var t=this.worldTransform;this.worldTransform=P.identityMatrix;for(var e=0;e<this.children.length;e++)this.children[e].updateTransform();var i=this.getBounds();for(this.worldTransform=t,e=0;e<this.children.length;e++)this.children[e].updateTransform();return i},P.Sprite.prototype._renderWebGL=function(t,e){if(this.visible&&!(this.alpha<=0)&&this.renderable){var i=this.worldTransform;if(e&&(i=e),this._mask||this._filters){e=t.spriteBatch;this._filters&&(e.flush(),t.filterManager.pushFilter(this._filterBlock)),this._mask&&(e.stop(),t.maskManager.pushMask(this.mask,t),e.start()),e.render(this);for(var n=0;n<this.children.length;n++)this.children[n]._renderWebGL(t);e.stop(),this._mask&&t.maskManager.popMask(this._mask,t),this._filters&&t.filterManager.popFilter(),e.start()}else{t.spriteBatch.render(this);for(n=0;n<this.children.length;n++)this.children[n]._renderWebGL(t,i)}}},P.Sprite.prototype._renderCanvas=function(t,e){if(!(!this.visible||0===this.alpha||!this.renderable||this.texture.crop.width<=0||this.texture.crop.height<=0)){var i,n,r,o,s,a=this.worldTransform;e&&(a=e),this.blendMode!==t.currentBlendMode&&(t.currentBlendMode=this.blendMode,t.context.globalCompositeOperation=P.blendModesCanvas[t.currentBlendMode]),this._mask&&t.maskManager.pushMask(this._mask,t),this.texture.valid&&(i=this.texture.baseTexture.resolution/t.resolution,t.context.globalAlpha=this.worldAlpha,t.smoothProperty&&t.scaleMode!==this.texture.baseTexture.scaleMode&&(t.scaleMode=this.texture.baseTexture.scaleMode,t.context[t.smoothProperty]=t.scaleMode===P.scaleModes.LINEAR),n=this.texture.trim?this.texture.trim.x-this.anchor.x*this.texture.trim.width:this.anchor.x*-this.texture.frame.width,r=this.texture.trim?this.texture.trim.y-this.anchor.y*this.texture.trim.height:this.anchor.y*-this.texture.frame.height,o=a.tx*t.resolution+t.shakeX,s=a.ty*t.resolution+t.shakeY,t.roundPixels?(t.context.setTransform(a.a,a.b,a.c,a.d,0|o,0|s),n|=0,r|=0):t.context.setTransform(a.a,a.b,a.c,a.d,o,s),e=this.texture.crop.width,a=this.texture.crop.height,n/=i,r/=i,16777215!==this.tint?(!this.texture.requiresReTint&&this.cachedTint===this.tint||(this.tintedTexture=P.CanvasTinter.getTintedTexture(this,this.tint),this.cachedTint=this.tint,this.texture.requiresReTint=!1),t.context.drawImage(this.tintedTexture,0,0,e,a,n,r,e/i,a/i)):(o=this.texture.crop.x,s=this.texture.crop.y,t.context.drawImage(this.texture.baseTexture.source,o,s,e,a,n,r,e/i,a/i)));for(var h=0;h<this.children.length;h++)this.children[h]._renderCanvas(t);this._mask&&t.maskManager.popMask(t)}},P.SpriteBatch=function(t){P.DisplayObjectContainer.call(this),this.textureThing=t,this.ready=!1},P.SpriteBatch.prototype=Object.create(P.DisplayObjectContainer.prototype),P.SpriteBatch.prototype.constructor=P.SpriteBatch,P.SpriteBatch.prototype.initWebGL=function(t){this.fastSpriteBatch=new P.WebGLFastSpriteBatch(t),this.ready=!0},P.SpriteBatch.prototype.updateTransform=function(){this.displayObjectUpdateTransform()},P.SpriteBatch.prototype._renderWebGL=function(t){!this.visible||this.alpha<=0||!this.children.length||(this.ready||this.initWebGL(t.gl),this.fastSpriteBatch.gl!==t.gl&&this.fastSpriteBatch.setContext(t.gl),t.spriteBatch.stop(),t.shaderManager.setShader(t.shaderManager.fastShader),this.fastSpriteBatch.begin(this,t),this.fastSpriteBatch.render(this),t.spriteBatch.start())},P.SpriteBatch.prototype._renderCanvas=function(t){if(this.visible&&!(this.alpha<=0)&&this.children.length){var e=t.context;e.globalAlpha=this.worldAlpha,this.displayObjectUpdateTransform();for(var i=this.worldTransform,n=!0,r=0;r<this.children.length;r++){var o,s,a,h,l,p=this.children[r];p.visible&&(s=(o=p.texture).frame,e.globalAlpha=this.worldAlpha*p.alpha,p.rotation%(2*Math.PI)==0?(n&&(e.setTransform(i.a,i.b,i.c,i.d,i.tx,i.ty),n=!1),e.drawImage(o.baseTexture.source,s.x,s.y,s.width,s.height,p.anchor.x*(-s.width*p.scale.x)+p.position.x+.5+t.shakeX|0,p.anchor.y*(-s.height*p.scale.y)+p.position.y+.5+t.shakeY|0,s.width*p.scale.x,s.height*p.scale.y)):(n=n||!0,p.displayObjectUpdateTransform(),h=(a=p.worldTransform).tx*t.resolution+t.shakeX,l=a.ty*t.resolution+t.shakeY,t.roundPixels?e.setTransform(a.a,a.b,a.c,a.d,0|h,0|l):e.setTransform(a.a,a.b,a.c,a.d,h,l),e.drawImage(o.baseTexture.source,s.x,s.y,s.width,s.height,p.anchor.x*-s.width+.5|0,p.anchor.y*-s.height+.5|0,s.width,s.height)))}}},P.hex2rgb=function(t){return[(t>>16&255)/255,(t>>8&255)/255,(255&t)/255]},P.rgb2hex=function(t){return(255*t[0]<<16)+(255*t[1]<<8)+255*t[2]},P.canUseNewCanvasBlendModes=function(){if(void 0===document)return!1;var t="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAQAAAABAQMAAADD8p2OAAAAA1BMVEX/",e="AAAACklEQVQI12NgAAAAAgAB4iG8MwAAAABJRU5ErkJggg==",i=new Image;i.src=t+"AP804Oa6"+e;var n=new Image;n.src=t+"/wCKxvRF"+e;e=P.CanvasPool.create(this,6,1).getContext("2d");if(e.globalCompositeOperation="multiply",e.drawImage(i,0,0),e.drawImage(n,2,0),!e.getImageData(2,0,1,1))return!1;e=e.getImageData(2,0,1,1).data;return P.CanvasPool.remove(this),255===e[0]&&0===e[1]&&0===e[2]},P.getNextPowerOfTwo=function(t){if(0<t&&0==(t&t-1))return t;for(var e=1;e<t;)e<<=1;return e},P.isPowerOfTwo=function(t,e){return 0<t&&0==(t&t-1)&&0<e&&0==(e&e-1)},P.CanvasPool={create:function(t,e,i){var n,r=P.CanvasPool.getFirst(),r=-1===r?(n={parent:t,canvas:document.createElement("canvas")},P.CanvasPool.pool.push(n),n.canvas):(P.CanvasPool.pool[r].parent=t,P.CanvasPool.pool[r].canvas);return void 0!==e&&(r.width=e,r.height=i),r},getFirst:function(){for(var t=P.CanvasPool.pool,e=0;e<t.length;e++)if(!t[e].parent)return e;return-1},remove:function(t){for(var e=P.CanvasPool.pool,i=0;i<e.length;i++)e[i].parent===t&&(e[i].parent=null,e[i].canvas.width=1,e[i].canvas.height=1)},removeByCanvas:function(t){for(var e=P.CanvasPool.pool,i=0;i<e.length;i++)e[i].canvas===t&&(e[i].parent=null,e[i].canvas.width=1,e[i].canvas.height=1)},getTotal:function(){for(var t=P.CanvasPool.pool,e=0,i=0;i<t.length;i++)t[i].parent&&e++;return e},getFree:function(){for(var t=P.CanvasPool.pool,e=0,i=0;i<t.length;i++)t[i].parent||e++;return e}},P.CanvasPool.pool=[],P.initDefaultShaders=function(){},P.CompileVertexShader=function(t,e){return P._CompileShader(t,e,t.VERTEX_SHADER)},P.CompileFragmentShader=function(t,e){return P._CompileShader(t,e,t.FRAGMENT_SHADER)},P._CompileShader=function(t,e,i){var n=e;Array.isArray(e)&&(n=e.join("\n"));i=t.createShader(i);return t.shaderSource(i,n),t.compileShader(i),t.getShaderParameter(i,t.COMPILE_STATUS)?i:(window.console.log(t.getShaderInfoLog(i)),null)},P.compileProgram=function(t,e,i){var n=P.CompileFragmentShader(t,i),i=P.CompileVertexShader(t,e),e=t.createProgram();return t.attachShader(e,i),t.attachShader(e,n),t.linkProgram(e),t.getProgramParameter(e,t.LINK_STATUS)||(window.console.log(t.getProgramInfoLog(e)),window.console.log("Could not initialise shaders")),e},P.PixiShader=function(t){this._UID=P._UID++,this.gl=t,this.program=null,this.fragmentSrc=["precision lowp float;","varying vec2 vTextureCoord;","varying vec4 vColor;","uniform sampler2D uSampler;","void main(void) {","   gl_FragColor = texture2D(uSampler, vTextureCoord) * vColor ;","}"],this.textureCount=0,this.firstRun=!0,this.dirty=!0,this.attributes=[],this.init()},P.PixiShader.prototype.constructor=P.PixiShader,P.PixiShader.prototype.init=function(){var t,e=this.gl,i=P.compileProgram(e,this.vertexSrc||P.PixiShader.defaultVertexSrc,this.fragmentSrc);for(t in e.useProgram(i),this.uSampler=e.getUniformLocation(i,"uSampler"),this.projectionVector=e.getUniformLocation(i,"projectionVector"),this.offsetVector=e.getUniformLocation(i,"offsetVector"),this.dimensions=e.getUniformLocation(i,"dimensions"),this.aVertexPosition=e.getAttribLocation(i,"aVertexPosition"),this.aTextureCoord=e.getAttribLocation(i,"aTextureCoord"),this.colorAttribute=e.getAttribLocation(i,"aColor"),-1===this.colorAttribute&&(this.colorAttribute=2),this.attributes=[this.aVertexPosition,this.aTextureCoord,this.colorAttribute],this.uniforms)this.uniforms[t].uniformLocation=e.getUniformLocation(i,t);this.initUniforms(),this.program=i},P.PixiShader.prototype.initUniforms=function(){this.textureCount=1;var t,e=this.gl;for(t in this.uniforms){var i,n=(i=this.uniforms[t]).type;"sampler2D"===n?(i._init=!1,null!==i.value&&this.initSampler2D(i)):"mat2"===n||"mat3"===n||"mat4"===n?(i.glMatrix=!0,i.glValueLength=1,"mat2"===n?i.glFunc=e.uniformMatrix2fv:"mat3"===n?i.glFunc=e.uniformMatrix3fv:"mat4"===n&&(i.glFunc=e.uniformMatrix4fv)):(i.glFunc=e["uniform"+n],i.glValueLength="2f"===n||"2i"===n?2:"3f"===n||"3i"===n?3:"4f"===n||"4i"===n?4:1)}},P.PixiShader.prototype.initSampler2D=function(t){var e,i,n,r,o,s,a,h,l;t.value&&t.value.baseTexture&&t.value.baseTexture.hasLoaded&&((e=this.gl).activeTexture(e["TEXTURE"+this.textureCount]),e.bindTexture(e.TEXTURE_2D,t.value.baseTexture._glTextures[e.id]),t.textureData&&(i=(l=t.textureData).magFilter||e.LINEAR,n=l.minFilter||e.LINEAR,r=l.wrapS||e.CLAMP_TO_EDGE,o=l.wrapT||e.CLAMP_TO_EDGE,s=l.luminance?e.LUMINANCE:e.RGBA,l.repeat&&(r=e.REPEAT,o=e.REPEAT),e.pixelStorei(e.UNPACK_FLIP_Y_WEBGL,!!l.flipY),l.width?(a=l.width||512,h=l.height||2,l=l.border||0,e.texImage2D(e.TEXTURE_2D,0,s,a,h,l,s,e.UNSIGNED_BYTE,null)):e.texImage2D(e.TEXTURE_2D,0,s,e.RGBA,e.UNSIGNED_BYTE,t.value.baseTexture.source),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,i),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,n),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,r),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,o)),e.uniform1i(t.uniformLocation,this.textureCount),t._init=!0,this.textureCount++)},P.PixiShader.prototype.syncUniforms=function(){var t;this.textureCount=1;var e,i=this.gl;for(e in this.uniforms)1===(t=this.uniforms[e]).glValueLength?!0===t.glMatrix?t.glFunc.call(i,t.uniformLocation,t.transpose,t.value):t.glFunc.call(i,t.uniformLocation,t.value):2===t.glValueLength?t.glFunc.call(i,t.uniformLocation,t.value.x,t.value.y):3===t.glValueLength?t.glFunc.call(i,t.uniformLocation,t.value.x,t.value.y,t.value.z):4===t.glValueLength?t.glFunc.call(i,t.uniformLocation,t.value.x,t.value.y,t.value.z,t.value.w):"sampler2D"===t.type&&(t._init?(i.activeTexture(i["TEXTURE"+this.textureCount]),t.value.baseTexture._dirty[i.id]?P.instances[i.id].updateTexture(t.value.baseTexture):i.bindTexture(i.TEXTURE_2D,t.value.baseTexture._glTextures[i.id]),i.uniform1i(t.uniformLocation,this.textureCount),this.textureCount++):this.initSampler2D(t))},P.PixiShader.prototype.destroy=function(){this.gl.deleteProgram(this.program),this.uniforms=null,this.gl=null,this.attributes=null},P.PixiShader.defaultVertexSrc=["attribute vec2 aVertexPosition;","attribute vec2 aTextureCoord;","attribute vec4 aColor;","uniform vec2 projectionVector;","uniform vec2 offsetVector;","varying vec2 vTextureCoord;","varying vec4 vColor;","const vec2 center = vec2(-1.0, 1.0);","void main(void) {","   gl_Position = vec4( ((aVertexPosition + offsetVector) / projectionVector) + center , 0.0, 1.0);","   vTextureCoord = aTextureCoord;","   vColor = vec4(aColor.rgb * aColor.a, aColor.a);","}"],P.PixiFastShader=function(t){this._UID=P._UID++,this.gl=t,this.program=null,this.fragmentSrc=["precision lowp float;","varying vec2 vTextureCoord;","varying float vColor;","uniform sampler2D uSampler;","void main(void) {","   gl_FragColor = texture2D(uSampler, vTextureCoord) * vColor ;","}"],this.vertexSrc=["attribute vec2 aVertexPosition;","attribute vec2 aPositionCoord;","attribute vec2 aScale;","attribute float aRotation;","attribute vec2 aTextureCoord;","attribute float aColor;","uniform vec2 projectionVector;","uniform vec2 offsetVector;","uniform mat3 uMatrix;","varying vec2 vTextureCoord;","varying float vColor;","const vec2 center = vec2(-1.0, 1.0);","void main(void) {","   vec2 v;","   vec2 sv = aVertexPosition * aScale;","   v.x = (sv.x) * cos(aRotation) - (sv.y) * sin(aRotation);","   v.y = (sv.x) * sin(aRotation) + (sv.y) * cos(aRotation);","   v = ( uMatrix * vec3(v + aPositionCoord , 1.0) ).xy ;","   gl_Position = vec4( ( v / projectionVector) + center , 0.0, 1.0);","   vTextureCoord = aTextureCoord;","   vColor = aColor;","}"],this.textureCount=0,this.init()},P.PixiFastShader.prototype.constructor=P.PixiFastShader,P.PixiFastShader.prototype.init=function(){var t=this.gl,e=P.compileProgram(t,this.vertexSrc,this.fragmentSrc);t.useProgram(e),this.uSampler=t.getUniformLocation(e,"uSampler"),this.projectionVector=t.getUniformLocation(e,"projectionVector"),this.offsetVector=t.getUniformLocation(e,"offsetVector"),this.dimensions=t.getUniformLocation(e,"dimensions"),this.uMatrix=t.getUniformLocation(e,"uMatrix"),this.aVertexPosition=t.getAttribLocation(e,"aVertexPosition"),this.aPositionCoord=t.getAttribLocation(e,"aPositionCoord"),this.aScale=t.getAttribLocation(e,"aScale"),this.aRotation=t.getAttribLocation(e,"aRotation"),this.aTextureCoord=t.getAttribLocation(e,"aTextureCoord"),this.colorAttribute=t.getAttribLocation(e,"aColor"),-1===this.colorAttribute&&(this.colorAttribute=2),this.attributes=[this.aVertexPosition,this.aPositionCoord,this.aScale,this.aRotation,this.aTextureCoord,this.colorAttribute],this.program=e},P.PixiFastShader.prototype.destroy=function(){this.gl.deleteProgram(this.program),this.uniforms=null,this.gl=null,this.attributes=null},P.StripShader=function(t){this._UID=P._UID++,this.gl=t,this.program=null,this.fragmentSrc=["precision mediump float;","varying vec2 vTextureCoord;","uniform float alpha;","uniform sampler2D uSampler;","void main(void) {","   gl_FragColor = texture2D(uSampler, vec2(vTextureCoord.x, vTextureCoord.y)) * alpha;","}"],this.vertexSrc=["attribute vec2 aVertexPosition;","attribute vec2 aTextureCoord;","uniform mat3 translationMatrix;","uniform vec2 projectionVector;","uniform vec2 offsetVector;","varying vec2 vTextureCoord;","void main(void) {","   vec3 v = translationMatrix * vec3(aVertexPosition , 1.0);","   v -= offsetVector.xyx;","   gl_Position = vec4( v.x / projectionVector.x -1.0, v.y / -projectionVector.y + 1.0 , 0.0, 1.0);","   vTextureCoord = aTextureCoord;","}"],this.init()},P.StripShader.prototype.constructor=P.StripShader,P.StripShader.prototype.init=function(){var t=this.gl,e=P.compileProgram(t,this.vertexSrc,this.fragmentSrc);t.useProgram(e),this.uSampler=t.getUniformLocation(e,"uSampler"),this.projectionVector=t.getUniformLocation(e,"projectionVector"),this.offsetVector=t.getUniformLocation(e,"offsetVector"),this.colorAttribute=t.getAttribLocation(e,"aColor"),this.aVertexPosition=t.getAttribLocation(e,"aVertexPosition"),this.aTextureCoord=t.getAttribLocation(e,"aTextureCoord"),this.attributes=[this.aVertexPosition,this.aTextureCoord],this.translationMatrix=t.getUniformLocation(e,"translationMatrix"),this.alpha=t.getUniformLocation(e,"alpha"),this.program=e},P.StripShader.prototype.destroy=function(){this.gl.deleteProgram(this.program),this.uniforms=null,this.gl=null,this.attribute=null},P.PrimitiveShader=function(t){this._UID=P._UID++,this.gl=t,this.program=null,this.fragmentSrc=["precision mediump float;","varying vec4 vColor;","void main(void) {","   gl_FragColor = vColor;","}"],this.vertexSrc=["attribute vec2 aVertexPosition;","attribute vec4 aColor;","uniform mat3 translationMatrix;","uniform vec2 projectionVector;","uniform vec2 offsetVector;","uniform float alpha;","uniform float flipY;","uniform vec3 tint;","varying vec4 vColor;","void main(void) {","   vec3 v = translationMatrix * vec3(aVertexPosition , 1.0);","   v -= offsetVector.xyx;","   gl_Position = vec4( v.x / projectionVector.x -1.0, (v.y / projectionVector.y * -flipY) + flipY , 0.0, 1.0);","   vColor = aColor * vec4(tint * alpha, alpha);","}"],this.init()},P.PrimitiveShader.prototype.constructor=P.PrimitiveShader,P.PrimitiveShader.prototype.init=function(){var t=this.gl,e=P.compileProgram(t,this.vertexSrc,this.fragmentSrc);t.useProgram(e),this.projectionVector=t.getUniformLocation(e,"projectionVector"),this.offsetVector=t.getUniformLocation(e,"offsetVector"),this.tintColor=t.getUniformLocation(e,"tint"),this.flipY=t.getUniformLocation(e,"flipY"),this.aVertexPosition=t.getAttribLocation(e,"aVertexPosition"),this.colorAttribute=t.getAttribLocation(e,"aColor"),this.attributes=[this.aVertexPosition,this.colorAttribute],this.translationMatrix=t.getUniformLocation(e,"translationMatrix"),this.alpha=t.getUniformLocation(e,"alpha"),this.program=e},P.PrimitiveShader.prototype.destroy=function(){this.gl.deleteProgram(this.program),this.uniforms=null,this.gl=null,this.attributes=null},P.ComplexPrimitiveShader=function(t){this._UID=P._UID++,this.gl=t,this.program=null,this.fragmentSrc=["precision mediump float;","varying vec4 vColor;","void main(void) {","   gl_FragColor = vColor;","}"],this.vertexSrc=["attribute vec2 aVertexPosition;","uniform mat3 translationMatrix;","uniform vec2 projectionVector;","uniform vec2 offsetVector;","uniform vec3 tint;","uniform float alpha;","uniform vec3 color;","uniform float flipY;","varying vec4 vColor;","void main(void) {","   vec3 v = translationMatrix * vec3(aVertexPosition , 1.0);","   v -= offsetVector.xyx;","   gl_Position = vec4( v.x / projectionVector.x -1.0, (v.y / projectionVector.y * -flipY) + flipY , 0.0, 1.0);","   vColor = vec4(color * alpha * tint, alpha);","}"],this.init()},P.ComplexPrimitiveShader.prototype.constructor=P.ComplexPrimitiveShader,P.ComplexPrimitiveShader.prototype.init=function(){var t=this.gl,e=P.compileProgram(t,this.vertexSrc,this.fragmentSrc);t.useProgram(e),this.projectionVector=t.getUniformLocation(e,"projectionVector"),this.offsetVector=t.getUniformLocation(e,"offsetVector"),this.tintColor=t.getUniformLocation(e,"tint"),this.color=t.getUniformLocation(e,"color"),this.flipY=t.getUniformLocation(e,"flipY"),this.aVertexPosition=t.getAttribLocation(e,"aVertexPosition"),this.attributes=[this.aVertexPosition,this.colorAttribute],this.translationMatrix=t.getUniformLocation(e,"translationMatrix"),this.alpha=t.getUniformLocation(e,"alpha"),this.program=e},P.ComplexPrimitiveShader.prototype.destroy=function(){this.gl.deleteProgram(this.program),this.uniforms=null,this.gl=null,this.attribute=null},P.glContexts=[],P.instances=[],P.WebGLRenderer=function(t){this.game=t,P.defaultRenderer||(P.defaultRenderer=this),this.type=P.WEBGL_RENDERER,this.resolution=t.resolution,this.transparent=t.transparent,this.autoResize=!1,this.preserveDrawingBuffer=t.preserveDrawingBuffer,this.clearBeforeRender=t.clearBeforeRender,this.width=t.width,this.height=t.height,this.view=t.canvas,this._contextOptions={alpha:this.transparent,antialias:t.antialias,premultipliedAlpha:this.transparent&&"notMultiplied"!==this.transparent,stencil:!0,preserveDrawingBuffer:this.preserveDrawingBuffer},this.projection=new P.Point,this.offset=new P.Point,this.shaderManager=new P.WebGLShaderManager,this.spriteBatch=new P.WebGLSpriteBatch,this.maskManager=new P.WebGLMaskManager,this.filterManager=new P.WebGLFilterManager,this.stencilManager=new P.WebGLStencilManager,this.blendModeManager=new P.WebGLBlendModeManager,this.renderSession={},this.renderSession.game=this.game,this.renderSession.gl=this.gl,this.renderSession.drawCount=0,this.renderSession.shaderManager=this.shaderManager,this.renderSession.maskManager=this.maskManager,this.renderSession.filterManager=this.filterManager,this.renderSession.blendModeManager=this.blendModeManager,this.renderSession.spriteBatch=this.spriteBatch,this.renderSession.stencilManager=this.stencilManager,(this.renderSession.renderer=this).renderSession.resolution=this.resolution,this.initContext(),this.mapBlendModes()},P.WebGLRenderer.prototype.constructor=P.WebGLRenderer,P.WebGLRenderer.prototype.initContext=function(){var t=this.view.getContext("webgl",this._contextOptions)||this.view.getContext("experimental-webgl",this._contextOptions);if(!(this.gl=t))throw new Error("This browser does not support webGL. Try using the canvas renderer");this.glContextId=t.id=P.WebGLRenderer.glContextId++,P.glContexts[this.glContextId]=t,P.instances[this.glContextId]=this,t.disable(t.DEPTH_TEST),t.disable(t.CULL_FACE),t.enable(t.BLEND),this.shaderManager.setContext(t),this.spriteBatch.setContext(t),this.maskManager.setContext(t),this.filterManager.setContext(t),this.blendModeManager.setContext(t),this.stencilManager.setContext(t),this.renderSession.gl=this.gl,this.resize(this.width,this.height)},P.WebGLRenderer.prototype.render=function(t){var e;this.contextLost||((e=this.gl).viewport(0,0,this.width,this.height),e.bindFramebuffer(e.FRAMEBUFFER,null),this.game.clearBeforeRender&&(e.clearColor(t._bgColor.r,t._bgColor.g,t._bgColor.b,t._bgColor.a),e.clear(e.COLOR_BUFFER_BIT)),this.offset.x=this.game.camera._shake.x,this.offset.y=this.game.camera._shake.y,this.renderDisplayObject(t,this.projection))},P.WebGLRenderer.prototype.renderDisplayObject=function(t,e,i,n){this.renderSession.blendModeManager.setBlendMode(P.blendModes.NORMAL),this.renderSession.drawCount=0,this.renderSession.flipY=i?-1:1,this.renderSession.projection=e,this.renderSession.offset=this.offset,this.spriteBatch.begin(this.renderSession),this.filterManager.begin(this.renderSession,i),t._renderWebGL(this.renderSession,n),this.spriteBatch.end()},P.WebGLRenderer.prototype.resize=function(t,e){this.width=t*this.resolution,this.height=e*this.resolution,this.view.width=this.width,this.view.height=this.height,this.autoResize&&(this.view.style.width=this.width/this.resolution+"px",this.view.style.height=this.height/this.resolution+"px"),this.gl.viewport(0,0,this.width,this.height),this.projection.x=this.width/2/this.resolution,this.projection.y=-this.height/2/this.resolution},P.WebGLRenderer.prototype.updateTexture=function(t){if(!t.hasLoaded)return!1;var e=this.gl;return t._glTextures[e.id]||(t._glTextures[e.id]=e.createTexture()),e.bindTexture(e.TEXTURE_2D,t._glTextures[e.id]),e.pixelStorei(e.UNPACK_PREMULTIPLY_ALPHA_WEBGL,t.premultipliedAlpha),e.texImage2D(e.TEXTURE_2D,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,t.source),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,t.scaleMode===P.scaleModes.LINEAR?e.LINEAR:e.NEAREST),t.mipmap&&P.isPowerOfTwo(t.width,t.height)?(e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,t.scaleMode===P.scaleModes.LINEAR?e.LINEAR_MIPMAP_LINEAR:e.NEAREST_MIPMAP_NEAREST),e.generateMipmap(e.TEXTURE_2D)):e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,t.scaleMode===P.scaleModes.LINEAR?e.LINEAR:e.NEAREST),t._powerOf2?(e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.REPEAT),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.REPEAT)):(e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE)),!(t._dirty[e.id]=!1)},P.WebGLRenderer.prototype.destroy=function(){P.glContexts[this.glContextId]=null,this.projection=null,this.offset=null,this.shaderManager.destroy(),this.spriteBatch.destroy(),this.maskManager.destroy(),this.filterManager.destroy(),this.shaderManager=null,this.spriteBatch=null,this.maskManager=null,this.filterManager=null,this.gl=null,this.renderSession=null,P.CanvasPool.remove(this),P.instances[this.glContextId]=null,P.WebGLRenderer.glContextId--},P.WebGLRenderer.prototype.mapBlendModes=function(){var t,e,i=this.gl;P.blendModesWebGL||((t=[])[(e=P.blendModes).NORMAL]=[i.ONE,i.ONE_MINUS_SRC_ALPHA],t[e.ADD]=[i.SRC_ALPHA,i.DST_ALPHA],t[e.MULTIPLY]=[i.DST_COLOR,i.ONE_MINUS_SRC_ALPHA],t[e.SCREEN]=[i.SRC_ALPHA,i.ONE],t[e.OVERLAY]=[i.ONE,i.ONE_MINUS_SRC_ALPHA],t[e.DARKEN]=[i.ONE,i.ONE_MINUS_SRC_ALPHA],t[e.LIGHTEN]=[i.ONE,i.ONE_MINUS_SRC_ALPHA],t[e.COLOR_DODGE]=[i.ONE,i.ONE_MINUS_SRC_ALPHA],t[e.COLOR_BURN]=[i.ONE,i.ONE_MINUS_SRC_ALPHA],t[e.HARD_LIGHT]=[i.ONE,i.ONE_MINUS_SRC_ALPHA],t[e.SOFT_LIGHT]=[i.ONE,i.ONE_MINUS_SRC_ALPHA],t[e.DIFFERENCE]=[i.ONE,i.ONE_MINUS_SRC_ALPHA],t[e.EXCLUSION]=[i.ONE,i.ONE_MINUS_SRC_ALPHA],t[e.HUE]=[i.ONE,i.ONE_MINUS_SRC_ALPHA],t[e.SATURATION]=[i.ONE,i.ONE_MINUS_SRC_ALPHA],t[e.COLOR]=[i.ONE,i.ONE_MINUS_SRC_ALPHA],t[e.LUMINOSITY]=[i.ONE,i.ONE_MINUS_SRC_ALPHA],P.blendModesWebGL=t)},P.WebGLRenderer.glContextId=0,P.WebGLBlendModeManager=function(){this.currentBlendMode=99999},P.WebGLBlendModeManager.prototype.constructor=P.WebGLBlendModeManager,P.WebGLBlendModeManager.prototype.setContext=function(t){this.gl=t},P.WebGLBlendModeManager.prototype.setBlendMode=function(t){if(this.currentBlendMode===t)return!1;this.currentBlendMode=t;t=P.blendModesWebGL[this.currentBlendMode];return t&&this.gl.blendFunc(t[0],t[1]),!0},P.WebGLBlendModeManager.prototype.destroy=function(){this.gl=null},P.WebGLMaskManager=function(){},P.WebGLMaskManager.prototype.constructor=P.WebGLMaskManager,P.WebGLMaskManager.prototype.setContext=function(t){this.gl=t},P.WebGLMaskManager.prototype.pushMask=function(t,e){var i=e.gl;t.dirty&&P.WebGLGraphics.updateGraphics(t,i),void 0!==t._webGL[i.id]&&void 0!==t._webGL[i.id].data&&0!==t._webGL[i.id].data.length&&e.stencilManager.pushStencil(t,t._webGL[i.id].data[0],e)},P.WebGLMaskManager.prototype.popMask=function(t,e){var i=this.gl;void 0!==t._webGL[i.id]&&void 0!==t._webGL[i.id].data&&0!==t._webGL[i.id].data.length&&e.stencilManager.popStencil(t,t._webGL[i.id].data[0],e)},P.WebGLMaskManager.prototype.destroy=function(){this.gl=null},P.WebGLStencilManager=function(){this.stencilStack=[],this.reverse=!0,this.count=0},P.WebGLStencilManager.prototype.setContext=function(t){this.gl=t},P.WebGLStencilManager.prototype.pushStencil=function(t,e,i){var n=this.gl;this.bindGraphics(t,e,i),0===this.stencilStack.length&&(n.enable(n.STENCIL_TEST),n.clear(n.STENCIL_BUFFER_BIT),this.reverse=!0,this.count=0),this.stencilStack.push(e);i=this.count;n.colorMask(!1,!1,!1,!1),n.stencilFunc(n.ALWAYS,0,255),n.stencilOp(n.KEEP,n.KEEP,n.INVERT),1===e.mode?(n.drawElements(n.TRIANGLE_FAN,e.indices.length-4,n.UNSIGNED_SHORT,0),this.reverse?(n.stencilFunc(n.EQUAL,255-i,255),n.stencilOp(n.KEEP,n.KEEP,n.DECR)):(n.stencilFunc(n.EQUAL,i,255),n.stencilOp(n.KEEP,n.KEEP,n.INCR)),n.drawElements(n.TRIANGLE_FAN,4,n.UNSIGNED_SHORT,2*(e.indices.length-4)),this.reverse?n.stencilFunc(n.EQUAL,255-(i+1),255):n.stencilFunc(n.EQUAL,i+1,255),this.reverse=!this.reverse):(this.reverse?(n.stencilFunc(n.EQUAL,i,255),n.stencilOp(n.KEEP,n.KEEP,n.INCR)):(n.stencilFunc(n.EQUAL,255-i,255),n.stencilOp(n.KEEP,n.KEEP,n.DECR)),n.drawElements(n.TRIANGLE_STRIP,e.indices.length,n.UNSIGNED_SHORT,0),this.reverse?n.stencilFunc(n.EQUAL,i+1,255):n.stencilFunc(n.EQUAL,255-(i+1),255)),n.colorMask(!0,!0,!0,!0),n.stencilOp(n.KEEP,n.KEEP,n.KEEP),this.count++},P.WebGLStencilManager.prototype.bindGraphics=function(t,e,i){this._currentGraphics=t;var n,r=this.gl,o=i.projection,s=i.offset;1===e.mode?(n=i.shaderManager.complexPrimitiveShader,i.shaderManager.setShader(n),r.uniform1f(n.flipY,i.flipY),r.uniformMatrix3fv(n.translationMatrix,!1,t.worldTransform.toArray(!0)),r.uniform2f(n.projectionVector,o.x,-o.y),r.uniform2f(n.offsetVector,-s.x,-s.y),r.uniform3fv(n.tintColor,P.hex2rgb(t.tint)),r.uniform3fv(n.color,e.color),r.uniform1f(n.alpha,t.worldAlpha*e.alpha),r.bindBuffer(r.ARRAY_BUFFER,e.buffer),r.vertexAttribPointer(n.aVertexPosition,2,r.FLOAT,!1,8,0)):(n=i.shaderManager.primitiveShader,i.shaderManager.setShader(n),r.uniformMatrix3fv(n.translationMatrix,!1,t.worldTransform.toArray(!0)),r.uniform1f(n.flipY,i.flipY),r.uniform2f(n.projectionVector,o.x,-o.y),r.uniform2f(n.offsetVector,-s.x,-s.y),r.uniform3fv(n.tintColor,P.hex2rgb(t.tint)),r.uniform1f(n.alpha,t.worldAlpha),r.bindBuffer(r.ARRAY_BUFFER,e.buffer),r.vertexAttribPointer(n.aVertexPosition,2,r.FLOAT,!1,24,0),r.vertexAttribPointer(n.colorAttribute,4,r.FLOAT,!1,24,8)),r.bindBuffer(r.ELEMENT_ARRAY_BUFFER,e.indexBuffer)},P.WebGLStencilManager.prototype.popStencil=function(t,e,i){var n,r=this.gl;this.stencilStack.pop(),this.count--,0===this.stencilStack.length?r.disable(r.STENCIL_TEST):(n=this.count,this.bindGraphics(t,e,i),r.colorMask(!1,!1,!1,!1),1===e.mode?(this.reverse=!this.reverse,this.reverse?(r.stencilFunc(r.EQUAL,255-(n+1),255),r.stencilOp(r.KEEP,r.KEEP,r.INCR)):(r.stencilFunc(r.EQUAL,n+1,255),r.stencilOp(r.KEEP,r.KEEP,r.DECR)),r.drawElements(r.TRIANGLE_FAN,4,r.UNSIGNED_SHORT,2*(e.indices.length-4)),r.stencilFunc(r.ALWAYS,0,255),r.stencilOp(r.KEEP,r.KEEP,r.INVERT),r.drawElements(r.TRIANGLE_FAN,e.indices.length-4,r.UNSIGNED_SHORT,0)):(this.reverse?(r.stencilFunc(r.EQUAL,n+1,255),r.stencilOp(r.KEEP,r.KEEP,r.DECR)):(r.stencilFunc(r.EQUAL,255-(n+1),255),r.stencilOp(r.KEEP,r.KEEP,r.INCR)),r.drawElements(r.TRIANGLE_STRIP,e.indices.length,r.UNSIGNED_SHORT,0)),this.reverse?r.stencilFunc(r.EQUAL,n,255):r.stencilFunc(r.EQUAL,255-n,255),r.colorMask(!0,!0,!0,!0),r.stencilOp(r.KEEP,r.KEEP,r.KEEP))},P.WebGLStencilManager.prototype.destroy=function(){this.stencilStack=null,this.gl=null},P.WebGLShaderManager=function(){this.maxAttibs=10,this.attribState=[],this.tempAttribState=[];for(var t=0;t<this.maxAttibs;t++)this.attribState[t]=!1;this.stack=[]},P.WebGLShaderManager.prototype.constructor=P.WebGLShaderManager,P.WebGLShaderManager.prototype.setContext=function(t){this.gl=t,this.primitiveShader=new P.PrimitiveShader(t),this.complexPrimitiveShader=new P.ComplexPrimitiveShader(t),this.defaultShader=new P.PixiShader(t),this.fastShader=new P.PixiFastShader(t),this.stripShader=new P.StripShader(t),this.setShader(this.defaultShader)},P.WebGLShaderManager.prototype.setAttribs=function(t){for(var e=0;e<this.tempAttribState.length;e++)this.tempAttribState[e]=!1;for(e=0;e<t.length;e++){var i=t[e];this.tempAttribState[i]=!0}var n=this.gl;for(e=0;e<this.attribState.length;e++)this.attribState[e]!==this.tempAttribState[e]&&(this.attribState[e]=this.tempAttribState[e],this.tempAttribState[e]?n.enableVertexAttribArray(e):n.disableVertexAttribArray(e))},P.WebGLShaderManager.prototype.setShader=function(t){return this._currentId!==t._UID&&(this._currentId=t._UID,this.currentShader=t,this.gl.useProgram(t.program),this.setAttribs(t.attributes),!0)},P.WebGLShaderManager.prototype.destroy=function(){this.attribState=null,this.tempAttribState=null,this.primitiveShader.destroy(),this.complexPrimitiveShader.destroy(),this.defaultShader.destroy(),this.fastShader.destroy(),this.stripShader.destroy(),this.gl=null},P.WebGLSpriteBatch=function(){this.vertSize=5,this.size=2e3;var t=4*this.size*4*this.vertSize,e=6*this.size;this.vertices=new P.ArrayBuffer(t),this.positions=new P.Float32Array(this.vertices),this.colors=new P.Uint32Array(this.vertices),this.indices=new P.Uint16Array(e);for(var i=this.lastIndexCount=0,n=0;i<e;i+=6,n+=4)this.indices[i+0]=n+0,this.indices[i+1]=n+1,this.indices[i+2]=n+2,this.indices[i+3]=n+0,this.indices[i+4]=n+2,this.indices[i+5]=n+3;this.drawing=!1,this.currentBatchSize=0,this.currentBaseTexture=null,this.dirty=!0,this.textures=[],this.blendModes=[],this.shaders=[],this.sprites=[],this.defaultShader=new P.AbstractFilter(["precision lowp float;","varying vec2 vTextureCoord;","varying vec4 vColor;","uniform sampler2D uSampler;","void main(void) {","   gl_FragColor = texture2D(uSampler, vTextureCoord) * vColor ;","}"])},P.WebGLSpriteBatch.prototype.setContext=function(t){this.gl=t,this.vertexBuffer=t.createBuffer(),this.indexBuffer=t.createBuffer(),t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,this.indexBuffer),t.bufferData(t.ELEMENT_ARRAY_BUFFER,this.indices,t.STATIC_DRAW),t.bindBuffer(t.ARRAY_BUFFER,this.vertexBuffer),t.bufferData(t.ARRAY_BUFFER,this.vertices,t.DYNAMIC_DRAW),this.currentBlendMode=99999;var e=new P.PixiShader(t);e.fragmentSrc=this.defaultShader.fragmentSrc,e.uniforms={},e.init(),this.defaultShader.shaders[t.id]=e},P.WebGLSpriteBatch.prototype.begin=function(t){this.renderSession=t,this.shader=this.renderSession.shaderManager.defaultShader,this.start()},P.WebGLSpriteBatch.prototype.end=function(){this.flush()},P.WebGLSpriteBatch.prototype.render=function(t,e){var i=t.texture,n=t.worldTransform;e&&(n=e),this.currentBatchSize>=this.size&&(this.flush(),this.currentBaseTexture=i.baseTexture);var r,o,s,a,h,l,p,u,d,c,y=i._uvs;y&&(u=t.anchor.x,d=t.anchor.y,i.trim?(o=(r=(p=i.trim).x-u*p.width)+i.crop.width,a=(s=p.y-d*p.height)+i.crop.height):(o=i.frame.width*(1-u),r=i.frame.width*-u,a=i.frame.height*(1-d),s=i.frame.height*-d),h=4*this.currentBatchSize*this.vertSize,c=i.baseTexture.resolution,l=n.a/c,e=n.b/c,p=n.c/c,u=n.d/c,d=n.tx,i=n.ty,c=this.colors,n=this.positions,this.renderSession.roundPixels?(n[h]=l*r+p*s+d|0,n[1+h]=u*s+e*r+i|0,n[5+h]=l*o+p*s+d|0,n[6+h]=u*s+e*o+i|0,n[10+h]=l*o+p*a+d|0,n[11+h]=u*a+e*o+i|0,n[15+h]=l*r+p*a+d|0,n[16+h]=u*a+e*r+i|0):(n[h]=l*r+p*s+d,n[1+h]=u*s+e*r+i,n[5+h]=l*o+p*s+d,n[6+h]=u*s+e*o+i,n[10+h]=l*o+p*a+d,n[11+h]=u*a+e*o+i,n[15+h]=l*r+p*a+d,n[16+h]=u*a+e*r+i),n[2+h]=y.x0,n[3+h]=y.y0,n[7+h]=y.x1,n[8+h]=y.y1,n[12+h]=y.x2,n[13+h]=y.y2,n[17+h]=y.x3,n[18+h]=y.y3,y=t.tint,c[4+h]=c[9+h]=c[14+h]=c[19+h]=(y>>16)+(65280&y)+((255&y)<<16)+(255*t.worldAlpha<<24),this.sprites[this.currentBatchSize++]=t)},P.WebGLSpriteBatch.prototype.renderTilingSprite=function(t){var e=t.tilingTexture;this.currentBatchSize>=this.size&&(this.flush(),this.currentBaseTexture=e.baseTexture),t._uvs||(t._uvs=new P.TextureUvs);var i=t._uvs,n=e.baseTexture.width,r=e.baseTexture.height;t.tilePosition.x%=n*t.tileScaleOffset.x,t.tilePosition.y%=r*t.tileScaleOffset.y;var o=t.tilePosition.x/(n*t.tileScaleOffset.x),s=t.tilePosition.y/(r*t.tileScaleOffset.y),a=t.width/n/(t.tileScale.x*t.tileScaleOffset.x),h=t.height/r/(t.tileScale.y*t.tileScaleOffset.y);i.x0=0-o,i.y0=0-s,i.x1=a-o,i.y1=0-s,i.x2=a-o,i.y2=h-s,i.x3=0-o,i.y3=h-s;var l=t.tint,p=(l>>16)+(65280&l)+((255&l)<<16)+(255*t.worldAlpha<<24),u=this.positions,d=this.colors,c=t.width,y=t.height,_=t.anchor.x,n=t.anchor.y,r=c*(1-_),a=c*-_,o=y*(1-n),h=y*-n,s=4*this.currentBatchSize*this.vertSize,l=e.baseTexture.resolution,c=t.worldTransform,_=c.a/l,y=c.b/l,n=c.c/l,e=c.d/l,l=c.tx,c=c.ty;u[s++]=_*a+n*h+l,u[s++]=e*h+y*a+c,u[s++]=i.x0,u[s++]=i.y0,d[s++]=p,u[s++]=_*r+n*h+l,u[s++]=e*h+y*r+c,u[s++]=i.x1,u[s++]=i.y1,d[s++]=p,u[s++]=_*r+n*o+l,u[s++]=e*o+y*r+c,u[s++]=i.x2,u[s++]=i.y2,d[s++]=p,u[s++]=_*a+n*o+l,u[s++]=e*o+y*a+c,u[s++]=i.x3,u[s++]=i.y3,d[+s]=p,this.sprites[this.currentBatchSize++]=t},P.WebGLSpriteBatch.prototype.flush=function(){if(0!==this.currentBatchSize){var t,e,i=this.gl;this.dirty&&(this.dirty=!1,i.activeTexture(i.TEXTURE0),i.bindBuffer(i.ARRAY_BUFFER,this.vertexBuffer),i.bindBuffer(i.ELEMENT_ARRAY_BUFFER,this.indexBuffer),t=this.defaultShader.shaders[i.id],e=4*this.vertSize,i.vertexAttribPointer(t.aVertexPosition,2,i.FLOAT,!1,e,0),i.vertexAttribPointer(t.aTextureCoord,2,i.FLOAT,!1,e,8),i.vertexAttribPointer(t.colorAttribute,4,i.UNSIGNED_BYTE,!0,e,16)),this.currentBatchSize>.5*this.size?i.bufferSubData(i.ARRAY_BUFFER,0,this.vertices):(e=this.positions.subarray(0,4*this.currentBatchSize*this.vertSize),i.bufferSubData(i.ARRAY_BUFFER,0,e));for(var n=0,r=0,o=null,s=this.renderSession.blendModeManager.currentBlendMode,a=null,h=0,l=this.currentBatchSize;h<l;h++){var p,u,d,c=((p=this.sprites[h]).tilingTexture||p.texture).baseTexture,y=s!==(u=p.blendMode),_=a!==(d=p.shader||this.defaultShader),m=c.skipRender;m&&0<p.children.length&&(m=!1),(o!==c&&!m||y||_)&&(this.renderBatch(o,n,r),r=h,n=0,o=c,y&&this.renderSession.blendModeManager.setBlendMode(s=u),_&&((t=(a=d).shaders[i.id])||((t=new P.PixiShader(i)).fragmentSrc=a.fragmentSrc,t.uniforms=a.uniforms,t.init(),a.shaders[i.id]=t),this.renderSession.shaderManager.setShader(t),t.dirty&&t.syncUniforms(),d=this.renderSession.projection,i.uniform2f(t.projectionVector,d.x,d.y),d=this.renderSession.offset,i.uniform2f(t.offsetVector,d.x,d.y))),n++}this.renderBatch(o,n,r),this.currentBatchSize=0}},P.WebGLSpriteBatch.prototype.renderBatch=function(t,e,i){if(0!==e){var n=this.gl;if(t._dirty[n.id]){if(!this.renderSession.renderer.updateTexture(t))return}else n.bindTexture(n.TEXTURE_2D,t._glTextures[n.id]);n.drawElements(n.TRIANGLES,6*e,n.UNSIGNED_SHORT,6*i*2),this.renderSession.drawCount++}},P.WebGLSpriteBatch.prototype.stop=function(){this.flush(),this.dirty=!0},P.WebGLSpriteBatch.prototype.start=function(){this.dirty=!0},P.WebGLSpriteBatch.prototype.destroy=function(){this.vertices=null,this.indices=null,this.gl.deleteBuffer(this.vertexBuffer),this.gl.deleteBuffer(this.indexBuffer),this.currentBaseTexture=null,this.gl=null},P.WebGLFastSpriteBatch=function(t){this.vertSize=10,this.maxSize=6e3,this.size=this.maxSize;var e=4*this.size*this.vertSize,i=6*this.maxSize;this.vertices=new P.Float32Array(e),this.indices=new P.Uint16Array(i),this.vertexBuffer=null,this.indexBuffer=null;for(var n=this.lastIndexCount=0,r=0;n<i;n+=6,r+=4)this.indices[n+0]=r+0,this.indices[n+1]=r+1,this.indices[n+2]=r+2,this.indices[n+3]=r+0,this.indices[n+4]=r+2,this.indices[n+5]=r+3;this.drawing=!1,this.currentBatchSize=0,this.currentBaseTexture=null,this.currentBlendMode=0,this.renderSession=null,this.shader=null,this.matrix=null,this.setContext(t)},P.WebGLFastSpriteBatch.prototype.constructor=P.WebGLFastSpriteBatch,P.WebGLFastSpriteBatch.prototype.setContext=function(t){this.gl=t,this.vertexBuffer=t.createBuffer(),this.indexBuffer=t.createBuffer(),t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,this.indexBuffer),t.bufferData(t.ELEMENT_ARRAY_BUFFER,this.indices,t.STATIC_DRAW),t.bindBuffer(t.ARRAY_BUFFER,this.vertexBuffer),t.bufferData(t.ARRAY_BUFFER,this.vertices,t.DYNAMIC_DRAW)},P.WebGLFastSpriteBatch.prototype.begin=function(t,e){this.renderSession=e,this.shader=this.renderSession.shaderManager.fastShader,this.matrix=t.worldTransform.toArray(!0),this.start()},P.WebGLFastSpriteBatch.prototype.end=function(){this.flush()},P.WebGLFastSpriteBatch.prototype.render=function(t){var e=t.children,t=e[0];if(t.texture._uvs){this.currentBaseTexture=t.texture.baseTexture,t.blendMode!==this.renderSession.blendModeManager.currentBlendMode&&(this.flush(),this.renderSession.blendModeManager.setBlendMode(t.blendMode));for(var i=0,n=e.length;i<n;i++)this.renderSprite(e[i]);this.flush()}},P.WebGLFastSpriteBatch.prototype.renderSprite=function(t){var e,i,n,r,o,s,a;t.visible&&(t.texture.baseTexture===this.currentBaseTexture||t.texture.baseTexture.skipRender||(this.flush(),this.currentBaseTexture=t.texture.baseTexture,t.texture._uvs))&&(e=this.vertices,a=t.texture._uvs,t.texture.frame.width,t.texture.frame.height,t.texture.trim?(r=(n=(i=t.texture.trim).x-t.anchor.x*i.width)+t.texture.crop.width,s=(o=i.y-t.anchor.y*i.height)+t.texture.crop.height):(r=t.texture.frame.width*(1-t.anchor.x),n=t.texture.frame.width*-t.anchor.x,s=t.texture.frame.height*(1-t.anchor.y),o=t.texture.frame.height*-t.anchor.y),i=4*this.currentBatchSize*this.vertSize,e[i++]=n,e[i++]=o,e[i++]=t.position.x,e[i++]=t.position.y,e[i++]=t.scale.x,e[i++]=t.scale.y,e[i++]=t.rotation,e[i++]=a.x0,e[i++]=a.y1,e[i++]=t.alpha,e[i++]=r,e[i++]=o,e[i++]=t.position.x,e[i++]=t.position.y,e[i++]=t.scale.x,e[i++]=t.scale.y,e[i++]=t.rotation,e[i++]=a.x1,e[i++]=a.y1,e[i++]=t.alpha,e[i++]=r,e[i++]=s,e[i++]=t.position.x,e[i++]=t.position.y,e[i++]=t.scale.x,e[i++]=t.scale.y,e[i++]=t.rotation,e[i++]=a.x2,e[i++]=a.y2,e[i++]=t.alpha,e[i++]=n,e[i++]=s,e[i++]=t.position.x,e[i++]=t.position.y,e[i++]=t.scale.x,e[i++]=t.scale.y,e[i++]=t.rotation,e[i++]=a.x3,e[i++]=a.y3,e[+i]=t.alpha,this.currentBatchSize++,this.currentBatchSize>=this.size&&this.flush())},P.WebGLFastSpriteBatch.prototype.flush=function(){var t,e;0!==this.currentBatchSize&&(t=this.gl,this.currentBaseTexture._glTextures[t.id]||this.renderSession.renderer.updateTexture(this.currentBaseTexture,t),t.bindTexture(t.TEXTURE_2D,this.currentBaseTexture._glTextures[t.id]),this.currentBatchSize>.5*this.size?t.bufferSubData(t.ARRAY_BUFFER,0,this.vertices):(e=this.vertices.subarray(0,4*this.currentBatchSize*this.vertSize),t.bufferSubData(t.ARRAY_BUFFER,0,e)),t.drawElements(t.TRIANGLES,6*this.currentBatchSize,t.UNSIGNED_SHORT,0),this.currentBatchSize=0,this.renderSession.drawCount++)},P.WebGLFastSpriteBatch.prototype.stop=function(){this.flush()},P.WebGLFastSpriteBatch.prototype.start=function(){var t=this.gl;t.activeTexture(t.TEXTURE0),t.bindBuffer(t.ARRAY_BUFFER,this.vertexBuffer),t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,this.indexBuffer);var e=this.renderSession.projection;t.uniform2f(this.shader.projectionVector,e.x,e.y),t.uniformMatrix3fv(this.shader.uMatrix,!1,this.matrix);e=4*this.vertSize;t.vertexAttribPointer(this.shader.aVertexPosition,2,t.FLOAT,!1,e,0),t.vertexAttribPointer(this.shader.aPositionCoord,2,t.FLOAT,!1,e,8),t.vertexAttribPointer(this.shader.aScale,2,t.FLOAT,!1,e,16),t.vertexAttribPointer(this.shader.aRotation,1,t.FLOAT,!1,e,24),t.vertexAttribPointer(this.shader.aTextureCoord,2,t.FLOAT,!1,e,28),t.vertexAttribPointer(this.shader.colorAttribute,1,t.FLOAT,!1,e,36)},P.WebGLFilterManager=function(){this.filterStack=[],this.offsetX=0,this.offsetY=0},P.WebGLFilterManager.prototype.constructor=P.WebGLFilterManager,P.WebGLFilterManager.prototype.setContext=function(t){this.gl=t,this.texturePool=[],this.initShaderBuffers()},P.WebGLFilterManager.prototype.begin=function(t,e){this.renderSession=t,this.defaultShader=t.shaderManager.defaultShader;t=this.renderSession.projection;this.width=2*t.x,this.height=2*-t.y,this.buffer=e},P.WebGLFilterManager.prototype.pushFilter=function(t){var e=this.gl,i=this.renderSession.projection,n=this.renderSession.offset;t._filterArea=t.target.filterArea||t.target.getBounds(),t._previous_stencil_mgr=this.renderSession.stencilManager,this.renderSession.stencilManager=new P.WebGLStencilManager,this.renderSession.stencilManager.setContext(e),e.disable(e.STENCIL_TEST),this.filterStack.push(t);var r=t.filterPasses[0];this.offsetX+=t._filterArea.x,this.offsetY+=t._filterArea.y;var o=this.texturePool.pop();o?o.resize(this.width*this.renderSession.resolution,this.height*this.renderSession.resolution):o=new P.FilterTexture(this.gl,this.width*this.renderSession.resolution,this.height*this.renderSession.resolution),e.bindTexture(e.TEXTURE_2D,o.texture);var s=t._filterArea,r=r.padding;s.x-=r,s.y-=r,s.width+=2*r,s.height+=2*r,s.x<0&&(s.x=0),s.width>this.width&&(s.width=this.width),s.y<0&&(s.y=0),s.height>this.height&&(s.height=this.height),e.bindFramebuffer(e.FRAMEBUFFER,o.frameBuffer),e.viewport(0,0,s.width*this.renderSession.resolution,s.height*this.renderSession.resolution),i.x=s.width/2,i.y=-s.height/2,n.x=-s.x,n.y=-s.y,e.colorMask(!0,!0,!0,!0),e.clearColor(0,0,0,0),e.clear(e.COLOR_BUFFER_BIT),t._glFilterTexture=o},P.WebGLFilterManager.prototype.popFilter=function(){var t=this.gl,e=this.filterStack.pop(),i=e._filterArea,n=e._glFilterTexture,r=this.renderSession.projection,o=this.renderSession.offset;if(1<e.filterPasses.length){t.viewport(0,0,i.width*this.renderSession.resolution,i.height*this.renderSession.resolution),t.bindBuffer(t.ARRAY_BUFFER,this.vertexBuffer),this.vertexArray[0]=0,this.vertexArray[1]=i.height,this.vertexArray[2]=i.width,this.vertexArray[3]=i.height,this.vertexArray[4]=0,this.vertexArray[5]=0,this.vertexArray[6]=i.width,this.vertexArray[7]=0,t.bufferSubData(t.ARRAY_BUFFER,0,this.vertexArray),t.bindBuffer(t.ARRAY_BUFFER,this.uvBuffer),this.uvArray[2]=i.width/this.width,this.uvArray[5]=i.height/this.height,this.uvArray[6]=i.width/this.width,this.uvArray[7]=i.height/this.height,t.bufferSubData(t.ARRAY_BUFFER,0,this.uvArray);var s=n;(l=(l=this.texturePool.pop())||new P.FilterTexture(this.gl,this.width*this.renderSession.resolution,this.height*this.renderSession.resolution)).resize(this.width*this.renderSession.resolution,this.height*this.renderSession.resolution),t.bindFramebuffer(t.FRAMEBUFFER,l.frameBuffer),t.clear(t.COLOR_BUFFER_BIT),t.disable(t.BLEND);for(var a=0;a<e.filterPasses.length-1;a++){var h=e.filterPasses[a];t.bindFramebuffer(t.FRAMEBUFFER,l.frameBuffer),t.activeTexture(t.TEXTURE0),t.bindTexture(t.TEXTURE_2D,s.texture),this.applyFilterPass(h,i,i.width,i.height);var h=s,s=l,l=h}t.enable(t.BLEND),n=s,this.texturePool.push(l)}var p=e.filterPasses[e.filterPasses.length-1];this.offsetX-=i.x,this.offsetY-=i.y;var u,d=this.width,c=this.height,y=0,_=0,m=this.buffer;0===this.filterStack.length?t.colorMask(!0,!0,!0,!0):(d=(i=(u=this.filterStack[this.filterStack.length-1])._filterArea).width,c=i.height,y=i.x,_=i.y,m=u._glFilterTexture.frameBuffer),r.x=d/2,r.y=-c/2,o.x=y,o.y=_;y=(i=e._filterArea).x-y,_=i.y-_;t.bindBuffer(t.ARRAY_BUFFER,this.vertexBuffer),this.vertexArray[0]=y,this.vertexArray[1]=_+i.height,this.vertexArray[2]=y+i.width,this.vertexArray[3]=_+i.height,this.vertexArray[4]=y,this.vertexArray[5]=_,this.vertexArray[6]=y+i.width,this.vertexArray[7]=_,t.bufferSubData(t.ARRAY_BUFFER,0,this.vertexArray),t.bindBuffer(t.ARRAY_BUFFER,this.uvBuffer),this.uvArray[2]=i.width/this.width,this.uvArray[5]=i.height/this.height,this.uvArray[6]=i.width/this.width,this.uvArray[7]=i.height/this.height,t.bufferSubData(t.ARRAY_BUFFER,0,this.uvArray),t.viewport(0,0,d*this.renderSession.resolution,c*this.renderSession.resolution),t.bindFramebuffer(t.FRAMEBUFFER,m),t.activeTexture(t.TEXTURE0),t.bindTexture(t.TEXTURE_2D,n.texture),this.renderSession.stencilManager&&this.renderSession.stencilManager.destroy(),this.renderSession.stencilManager=e._previous_stencil_mgr,e._previous_stencil_mgr=null,0<this.renderSession.stencilManager.count?t.enable(t.STENCIL_TEST):t.disable(t.STENCIL_TEST),this.applyFilterPass(p,i,d,c),this.texturePool.push(n),e._glFilterTexture=null},P.WebGLFilterManager.prototype.applyFilterPass=function(t,e,i,n){var r=this.gl,o=t.shaders[r.id];o||((o=new P.PixiShader(r)).fragmentSrc=t.fragmentSrc,o.uniforms=t.uniforms,o.init(),t.shaders[r.id]=o),this.renderSession.shaderManager.setShader(o),r.uniform2f(o.projectionVector,i/2,-n/2),r.uniform2f(o.offsetVector,0,0),t.uniforms.dimensions&&(t.uniforms.dimensions.value[0]=this.width,t.uniforms.dimensions.value[1]=this.height,t.uniforms.dimensions.value[2]=this.vertexArray[0],t.uniforms.dimensions.value[3]=this.vertexArray[5]),o.syncUniforms(),r.bindBuffer(r.ARRAY_BUFFER,this.vertexBuffer),r.vertexAttribPointer(o.aVertexPosition,2,r.FLOAT,!1,0,0),r.bindBuffer(r.ARRAY_BUFFER,this.uvBuffer),r.vertexAttribPointer(o.aTextureCoord,2,r.FLOAT,!1,0,0),r.bindBuffer(r.ARRAY_BUFFER,this.colorBuffer),r.vertexAttribPointer(o.colorAttribute,2,r.FLOAT,!1,0,0),r.bindBuffer(r.ELEMENT_ARRAY_BUFFER,this.indexBuffer),r.drawElements(r.TRIANGLES,6,r.UNSIGNED_SHORT,0),this.renderSession.drawCount++},P.WebGLFilterManager.prototype.initShaderBuffers=function(){var t=this.gl;this.vertexBuffer=t.createBuffer(),this.uvBuffer=t.createBuffer(),this.colorBuffer=t.createBuffer(),this.indexBuffer=t.createBuffer(),this.vertexArray=new P.Float32Array([0,0,1,0,0,1,1,1]),t.bindBuffer(t.ARRAY_BUFFER,this.vertexBuffer),t.bufferData(t.ARRAY_BUFFER,this.vertexArray,t.STATIC_DRAW),this.uvArray=new P.Float32Array([0,0,1,0,0,1,1,1]),t.bindBuffer(t.ARRAY_BUFFER,this.uvBuffer),t.bufferData(t.ARRAY_BUFFER,this.uvArray,t.STATIC_DRAW),this.colorArray=new P.Float32Array([1,16777215,1,16777215,1,16777215,1,16777215]),t.bindBuffer(t.ARRAY_BUFFER,this.colorBuffer),t.bufferData(t.ARRAY_BUFFER,this.colorArray,t.STATIC_DRAW),t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,this.indexBuffer),t.bufferData(t.ELEMENT_ARRAY_BUFFER,new Uint16Array([0,1,2,1,3,2]),t.STATIC_DRAW)},P.WebGLFilterManager.prototype.destroy=function(){var t=this.gl;this.filterStack=null,this.offsetX=0;for(var e=this.offsetY=0;e<this.texturePool.length;e++)this.texturePool[e].destroy();this.texturePool=null,t.deleteBuffer(this.vertexBuffer),t.deleteBuffer(this.uvBuffer),t.deleteBuffer(this.colorBuffer),t.deleteBuffer(this.indexBuffer)},P.FilterTexture=function(t,e,i,n){this.gl=t,this.frameBuffer=t.createFramebuffer(),this.texture=t.createTexture(),n=n||P.scaleModes.DEFAULT,t.bindTexture(t.TEXTURE_2D,this.texture),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,n===P.scaleModes.LINEAR?t.LINEAR:t.NEAREST),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,n===P.scaleModes.LINEAR?t.LINEAR:t.NEAREST),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE),t.bindFramebuffer(t.FRAMEBUFFER,this.frameBuffer),t.bindFramebuffer(t.FRAMEBUFFER,this.frameBuffer),t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,this.texture,0),this.renderBuffer=t.createRenderbuffer(),t.bindRenderbuffer(t.RENDERBUFFER,this.renderBuffer),t.framebufferRenderbuffer(t.FRAMEBUFFER,t.DEPTH_STENCIL_ATTACHMENT,t.RENDERBUFFER,this.renderBuffer),this.resize(e,i)},P.FilterTexture.prototype.constructor=P.FilterTexture,P.FilterTexture.prototype.clear=function(){var t=this.gl;t.clearColor(0,0,0,0),t.clear(t.COLOR_BUFFER_BIT)},P.FilterTexture.prototype.resize=function(t,e){var i;this.width===t&&this.height===e||(this.width=t,this.height=e,(i=this.gl).bindTexture(i.TEXTURE_2D,this.texture),i.texImage2D(i.TEXTURE_2D,0,i.RGBA,t,e,0,i.RGBA,i.UNSIGNED_BYTE,null),i.bindRenderbuffer(i.RENDERBUFFER,this.renderBuffer),i.renderbufferStorage(i.RENDERBUFFER,i.DEPTH_STENCIL,t,e))},P.FilterTexture.prototype.destroy=function(){var t=this.gl;t.deleteFramebuffer(this.frameBuffer),t.deleteTexture(this.texture),this.frameBuffer=null,this.texture=null},P.CanvasBuffer=function(t,e){this.width=t,this.height=e,this.canvas=P.CanvasPool.create(this,this.width,this.height),this.context=this.canvas.getContext("2d"),this.canvas.width=t,this.canvas.height=e},P.CanvasBuffer.prototype.constructor=P.CanvasBuffer,P.CanvasBuffer.prototype.clear=function(){this.context.setTransform(1,0,0,1,0,0),this.context.clearRect(0,0,this.width,this.height)},P.CanvasBuffer.prototype.resize=function(t,e){this.width=this.canvas.width=t,this.height=this.canvas.height=e},P.CanvasBuffer.prototype.destroy=function(){P.CanvasPool.remove(this)},P.CanvasMaskManager=function(){},P.CanvasMaskManager.prototype.constructor=P.CanvasMaskManager,P.CanvasMaskManager.prototype.pushMask=function(t,e){var i=e.context;i.save();var n=t.alpha,r=t.worldTransform,e=e.resolution;i.setTransform(r.a*e,r.b*e,r.c*e,r.d*e,r.tx*e,r.ty*e),P.CanvasGraphics.renderGraphicsMask(t,i),i.clip(),t.worldAlpha=n},P.CanvasMaskManager.prototype.popMask=function(t){t.context.restore()},P.CanvasTinter=function(){},P.CanvasTinter.getTintedTexture=function(t,e){var i=t.tintedTexture||P.CanvasPool.create(this);return P.CanvasTinter.tintMethod(t.texture,e,i),i},P.CanvasTinter.tintWithMultiply=function(t,e,i){var n=i.getContext("2d"),r=t.crop;i.width===r.width&&i.height===r.height||(i.width=r.width,i.height=r.height),n.clearRect(0,0,r.width,r.height),n.fillStyle="#"+("00000"+(0|e).toString(16)).substr(-6),n.fillRect(0,0,r.width,r.height),n.globalCompositeOperation="multiply",n.drawImage(t.baseTexture.source,r.x,r.y,r.width,r.height,0,0,r.width,r.height),n.globalCompositeOperation="destination-atop",n.drawImage(t.baseTexture.source,r.x,r.y,r.width,r.height,0,0,r.width,r.height)},P.CanvasTinter.tintWithPerPixel=function(t,e,i){var n=i.getContext("2d"),r=t.crop;i.width=r.width,i.height=r.height,n.globalCompositeOperation="copy",n.drawImage(t.baseTexture.source,r.x,r.y,r.width,r.height,0,0,r.width,r.height);for(var o,e=P.hex2rgb(e),s=e[0],a=e[1],h=e[2],r=n.getImageData(0,0,r.width,r.height),l=r.data,p=0;p<l.length;p+=4)l[p+0]*=s,l[p+1]*=a,l[p+2]*=h,P.CanvasTinter.canHandleAlpha||(o=l[p+3],l[p+0]/=255/o,l[p+1]/=255/o,l[p+2]/=255/o);n.putImageData(r,0,0)},P.CanvasTinter.checkInverseAlpha=function(){var t=new P.CanvasBuffer(2,1);t.context.fillStyle="rgba(10, 20, 30, 0.5)",t.context.fillRect(0,0,1,1);var e=t.context.getImageData(0,0,1,1);if(null===e)return!1;t.context.putImageData(e,1,0);t=t.context.getImageData(1,0,1,1);return t.data[0]===e.data[0]&&t.data[1]===e.data[1]&&t.data[2]===e.data[2]&&t.data[3]===e.data[3]},P.CanvasTinter.canHandleAlpha=P.CanvasTinter.checkInverseAlpha(),P.CanvasTinter.canUseMultiply=P.canUseNewCanvasBlendModes(),P.CanvasTinter.tintMethod=P.CanvasTinter.canUseMultiply?P.CanvasTinter.tintWithMultiply:P.CanvasTinter.tintWithPerPixel,P.CanvasRenderer=function(t){this.game=t,P.defaultRenderer||(P.defaultRenderer=this),this.type=P.CANVAS_RENDERER,this.resolution=t.resolution,this.clearBeforeRender=t.clearBeforeRender,this.transparent=t.transparent,this.autoResize=!1,this.width=t.width*this.resolution,this.height=t.height*this.resolution,this.view=t.canvas,this.context=this.view.getContext("2d",{alpha:this.transparent}),this.refresh=!0,this.count=0,this.maskManager=new P.CanvasMaskManager,this.renderSession={context:this.context,maskManager:this.maskManager,scaleMode:null,smoothProperty:Phaser.Canvas.getSmoothingPrefix(this.context),roundPixels:!1},this.mapBlendModes(),this.resize(this.width,this.height)},P.CanvasRenderer.prototype.constructor=P.CanvasRenderer,P.CanvasRenderer.prototype.render=function(t){this.context.setTransform(1,0,0,1,0,0),this.context.globalAlpha=1,this.renderSession.currentBlendMode=0,this.renderSession.shakeX=this.game.camera._shake.x,this.renderSession.shakeY=this.game.camera._shake.y,this.context.globalCompositeOperation="source-over",navigator.isCocoonJS&&this.view.screencanvas&&(this.context.fillStyle="black",this.context.clear()),this.clearBeforeRender&&(this.transparent?this.context.clearRect(0,0,this.width,this.height):t._bgColor&&(this.context.fillStyle=t._bgColor.rgba,this.context.fillRect(0,0,this.width,this.height))),this.renderDisplayObject(t)},P.CanvasRenderer.prototype.destroy=function(t){(t=void 0===t?!0:t)&&this.view.parent&&this.view.parent.removeChild(this.view),this.view=null,this.context=null,this.maskManager=null,this.renderSession=null},P.CanvasRenderer.prototype.resize=function(t,e){this.width=t*this.resolution,this.height=e*this.resolution,this.view.width=this.width,this.view.height=this.height,this.autoResize&&(this.view.style.width=this.width/this.resolution+"px",this.view.style.height=this.height/this.resolution+"px"),this.renderSession.smoothProperty&&(this.context[this.renderSession.smoothProperty]=this.renderSession.scaleMode===P.scaleModes.LINEAR)},P.CanvasRenderer.prototype.renderDisplayObject=function(t,e,i){this.renderSession.context=e||this.context,this.renderSession.resolution=this.resolution,t._renderCanvas(this.renderSession,i)},P.CanvasRenderer.prototype.mapBlendModes=function(){var t,e,i;P.blendModesCanvas||(t=[],e=P.blendModes,i=P.canUseNewCanvasBlendModes(),t[e.NORMAL]="source-over",t[e.ADD]="lighter",t[e.MULTIPLY]=i?"multiply":"source-over",t[e.SCREEN]=i?"screen":"source-over",t[e.OVERLAY]=i?"overlay":"source-over",t[e.DARKEN]=i?"darken":"source-over",t[e.LIGHTEN]=i?"lighten":"source-over",t[e.COLOR_DODGE]=i?"color-dodge":"source-over",t[e.COLOR_BURN]=i?"color-burn":"source-over",t[e.HARD_LIGHT]=i?"hard-light":"source-over",t[e.SOFT_LIGHT]=i?"soft-light":"source-over",t[e.DIFFERENCE]=i?"difference":"source-over",t[e.EXCLUSION]=i?"exclusion":"source-over",t[e.HUE]=i?"hue":"source-over",t[e.SATURATION]=i?"saturation":"source-over",t[e.COLOR]=i?"color":"source-over",t[e.LUMINOSITY]=i?"luminosity":"source-over",P.blendModesCanvas=t)},P.BaseTexture=function(t,e){this.resolution=1,this.width=100,this.height=100,this.scaleMode=e||P.scaleModes.DEFAULT,this.hasLoaded=!1,this.source=t,this.premultipliedAlpha=!0,this._glTextures=[],this.mipmap=!1,this._dirty=[!0,!0,!0,!0],t&&((this.source.complete||this.source.getContext)&&this.source.width&&this.source.height&&(this.hasLoaded=!0,this.width=this.source.naturalWidth||this.source.width,this.height=this.source.naturalHeight||this.source.height,this.dirty()),this.skipRender=!1,this._powerOf2=!1)},P.BaseTexture.prototype.constructor=P.BaseTexture,P.BaseTexture.prototype.forceLoaded=function(t,e){this.hasLoaded=!0,this.width=t,this.height=e,this.dirty()},P.BaseTexture.prototype.destroy=function(){this.source&&P.CanvasPool.removeByCanvas(this.source),this.source=null,this.unloadFromGPU()},P.BaseTexture.prototype.updateSourceImage=function(t){},P.BaseTexture.prototype.dirty=function(){for(var t=0;t<this._glTextures.length;t++)this._dirty[t]=!0},P.BaseTexture.prototype.unloadFromGPU=function(){this.dirty();for(var t=this._glTextures.length-1;0<=t;t--){var e=this._glTextures[t],i=P.glContexts[t];i&&e&&i.deleteTexture(e)}this._glTextures.length=0,this.dirty()},P.BaseTexture.fromCanvas=function(t,e){return 0===t.width&&(t.width=1),0===t.height&&(t.height=1),new P.BaseTexture(t,e)},P.TextureSilentFail=!1,P.Texture=function(t,e,i,n){this.noFrame=!1,e||(this.noFrame=!0,e=new P.Rectangle(0,0,1,1)),t instanceof P.Texture&&(t=t.baseTexture),this.baseTexture=t,this.frame=e,this.trim=n,this.valid=!1,this.isTiling=!1,this.requiresUpdate=!1,this.requiresReTint=!1,this._uvs=null,this.width=0,this.height=0,this.crop=i||new P.Rectangle(0,0,1,1),t.hasLoaded&&(this.noFrame&&(e=new P.Rectangle(0,0,t.width,t.height)),this.setFrame(e))},P.Texture.prototype.constructor=P.Texture,P.Texture.prototype.onBaseTextureLoaded=function(){var t=this.baseTexture;this.noFrame&&(this.frame=new P.Rectangle(0,0,t.width,t.height)),this.setFrame(this.frame)},P.Texture.prototype.destroy=function(t){t&&this.baseTexture.destroy(),this.valid=!1},P.Texture.prototype.setFrame=function(t){if(this.noFrame=!1,this.frame=t,this.width=t.width,this.height=t.height,this.crop.x=t.x,this.crop.y=t.y,this.crop.width=t.width,this.crop.height=t.height,this.trim||!(t.x+t.width>this.baseTexture.width||t.y+t.height>this.baseTexture.height))this.valid=t&&t.width&&t.height&&this.baseTexture.source&&this.baseTexture.hasLoaded,this.trim&&(this.width=this.trim.width,this.height=this.trim.height,this.frame.width=this.trim.width,this.frame.height=this.trim.height),this.valid&&this._updateUvs();else{if(!P.TextureSilentFail)throw new Error("Texture Error: frame does not fit inside the base Texture dimensions "+this);this.valid=!1}},P.Texture.prototype._updateUvs=function(){this._uvs||(this._uvs=new P.TextureUvs);var t=this.crop,e=this.baseTexture.width,i=this.baseTexture.height;this._uvs.x0=t.x/e,this._uvs.y0=t.y/i,this._uvs.x1=(t.x+t.width)/e,this._uvs.y1=t.y/i,this._uvs.x2=(t.x+t.width)/e,this._uvs.y2=(t.y+t.height)/i,this._uvs.x3=t.x/e,this._uvs.y3=(t.y+t.height)/i},P.Texture.fromCanvas=function(t,e){e=P.BaseTexture.fromCanvas(t,e);return new P.Texture(e)},P.TextureUvs=function(){this.x0=0,this.y0=0,this.x1=0,this.y1=0,this.x2=0,this.y2=0,this.x3=0,this.y3=0},P.RenderTexture=function(t,e,i,n,r){this.width=t||100,this.height=e||100,this.resolution=r||1,this.frame=new P.Rectangle(0,0,this.width*this.resolution,this.height*this.resolution),this.crop=new P.Rectangle(0,0,this.width*this.resolution,this.height*this.resolution),this.baseTexture=new P.BaseTexture,this.baseTexture.width=this.width*this.resolution,this.baseTexture.height=this.height*this.resolution,this.baseTexture._glTextures=[],this.baseTexture.resolution=this.resolution,this.baseTexture.scaleMode=n||P.scaleModes.DEFAULT,this.baseTexture.hasLoaded=!0,P.Texture.call(this,this.baseTexture,new P.Rectangle(0,0,this.width*this.resolution,this.height*this.resolution)),this.renderer=i||P.defaultRenderer,this.renderer.type===P.WEBGL_RENDERER?(i=this.renderer.gl,this.baseTexture._dirty[i.id]=!1,this.textureBuffer=new P.FilterTexture(i,this.width,this.height,this.baseTexture.scaleMode),this.baseTexture._glTextures[i.id]=this.textureBuffer.texture,this.render=this.renderWebGL,this.projection=new P.Point(.5*this.width,.5*-this.height)):(this.render=this.renderCanvas,this.textureBuffer=new P.CanvasBuffer(this.width*this.resolution,this.height*this.resolution),this.baseTexture.source=this.textureBuffer.canvas),this.valid=!0,this.tempMatrix=new Phaser.Matrix,this._updateUvs()},P.RenderTexture.prototype=Object.create(P.Texture.prototype),P.RenderTexture.prototype.constructor=P.RenderTexture,P.RenderTexture.prototype.resize=function(t,e,i){t===this.width&&e===this.height||(this.valid=0<t&&0<e,this.width=t,this.height=e,this.frame.width=this.crop.width=t*this.resolution,this.frame.height=this.crop.height=e*this.resolution,i&&(this.baseTexture.width=this.width*this.resolution,this.baseTexture.height=this.height*this.resolution),this.renderer.type===P.WEBGL_RENDERER&&(this.projection.x=this.width/2,this.projection.y=-this.height/2),this.valid&&this.textureBuffer.resize(this.width,this.height))},P.RenderTexture.prototype.clear=function(){this.valid&&(this.renderer.type===P.WEBGL_RENDERER&&this.renderer.gl.bindFramebuffer(this.renderer.gl.FRAMEBUFFER,this.textureBuffer.frameBuffer),this.textureBuffer.clear())},P.RenderTexture.prototype.renderWebGL=function(t,e,i){if(this.valid&&0!==t.alpha){var n=t.worldTransform;n.identity(),n.translate(0,2*this.projection.y),e&&n.append(e),n.scale(1,-1);for(var r=0;r<t.children.length;r++)t.children[r].updateTransform();n=this.renderer.gl;n.viewport(0,0,this.width*this.resolution,this.height*this.resolution),n.bindFramebuffer(n.FRAMEBUFFER,this.textureBuffer.frameBuffer),i&&this.textureBuffer.clear(),this.renderer.spriteBatch.dirty=!0,this.renderer.renderDisplayObject(t,this.projection,this.textureBuffer.frameBuffer,e),this.renderer.spriteBatch.dirty=!0}},P.RenderTexture.prototype.renderCanvas=function(t,e,i){if(this.valid&&0!==t.alpha){var n=t.worldTransform;n.identity(),e&&n.append(e);for(var r=0;r<t.children.length;r++)t.children[r].updateTransform();i&&this.textureBuffer.clear();i=this.renderer.resolution;this.renderer.resolution=this.resolution,this.renderer.renderDisplayObject(t,this.textureBuffer.context,e),this.renderer.resolution=i}},P.RenderTexture.prototype.getImage=function(){var t=new Image;return t.src=this.getBase64(),t},P.RenderTexture.prototype.getBase64=function(){return this.getCanvas().toDataURL()},P.RenderTexture.prototype.getCanvas=function(){if(this.renderer.type!==P.WEBGL_RENDERER)return this.textureBuffer.canvas;var t=this.renderer.gl,e=this.textureBuffer.width,i=this.textureBuffer.height,n=new Uint8Array(4*e*i);t.bindFramebuffer(t.FRAMEBUFFER,this.textureBuffer.frameBuffer),t.readPixels(0,0,e,i,t.RGBA,t.UNSIGNED_BYTE,n),t.bindFramebuffer(t.FRAMEBUFFER,null);t=new P.CanvasBuffer(e,i),i=t.context.getImageData(0,0,e,i);return i.data.set(n),t.context.putImageData(i,0,0),t.canvas},P.AbstractFilter=function(t,e){this.passes=[this],this.shaders=[],this.dirty=!0,this.padding=0,this.uniforms=e||{},this.fragmentSrc=t||[]},P.AbstractFilter.prototype.constructor=P.AbstractFilter,P.AbstractFilter.prototype.syncUniforms=function(){for(var t=0,e=this.shaders.length;t<e;t++)this.shaders[t].dirty=!0},P.Strip=function(t){P.DisplayObjectContainer.call(this),this.texture=t,this.uvs=new P.Float32Array([0,1,1,1,1,0,0,1]),this.vertices=new P.Float32Array([0,0,100,0,100,100,0,100]),this.colors=new P.Float32Array([1,1,1,1]),this.indices=new P.Uint16Array([0,1,2,3]),this.dirty=!0,this.blendMode=P.blendModes.NORMAL,this.canvasPadding=0,this.drawMode=P.Strip.DrawModes.TRIANGLE_STRIP},P.Strip.prototype=Object.create(P.DisplayObjectContainer.prototype),P.Strip.prototype.constructor=P.Strip,P.Strip.prototype._renderWebGL=function(t){!this.visible||this.alpha<=0||(t.spriteBatch.stop(),this._vertexBuffer||this._initWebGL(t),t.shaderManager.setShader(t.shaderManager.stripShader),this._renderStrip(t),t.spriteBatch.start())},P.Strip.prototype._initWebGL=function(t){t=t.gl;this._vertexBuffer=t.createBuffer(),this._indexBuffer=t.createBuffer(),this._uvBuffer=t.createBuffer(),this._colorBuffer=t.createBuffer(),t.bindBuffer(t.ARRAY_BUFFER,this._vertexBuffer),t.bufferData(t.ARRAY_BUFFER,this.vertices,t.DYNAMIC_DRAW),t.bindBuffer(t.ARRAY_BUFFER,this._uvBuffer),t.bufferData(t.ARRAY_BUFFER,this.uvs,t.STATIC_DRAW),t.bindBuffer(t.ARRAY_BUFFER,this._colorBuffer),t.bufferData(t.ARRAY_BUFFER,this.colors,t.STATIC_DRAW),t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,this._indexBuffer),t.bufferData(t.ELEMENT_ARRAY_BUFFER,this.indices,t.STATIC_DRAW)},P.Strip.prototype._renderStrip=function(t){var e=t.gl,i=t.projection,n=t.offset,r=t.shaderManager.stripShader,o=this.drawMode===P.Strip.DrawModes.TRIANGLE_STRIP?e.TRIANGLE_STRIP:e.TRIANGLES;t.blendModeManager.setBlendMode(this.blendMode),e.uniformMatrix3fv(r.translationMatrix,!1,this.worldTransform.toArray(!0)),e.uniform2f(r.projectionVector,i.x,-i.y),e.uniform2f(r.offsetVector,-n.x,-n.y),e.uniform1f(r.alpha,this.worldAlpha),this.dirty?(this.dirty=!1,e.bindBuffer(e.ARRAY_BUFFER,this._vertexBuffer),e.bufferData(e.ARRAY_BUFFER,this.vertices,e.STATIC_DRAW),e.vertexAttribPointer(r.aVertexPosition,2,e.FLOAT,!1,0,0),e.bindBuffer(e.ARRAY_BUFFER,this._uvBuffer),e.bufferData(e.ARRAY_BUFFER,this.uvs,e.STATIC_DRAW),e.vertexAttribPointer(r.aTextureCoord,2,e.FLOAT,!1,0,0),e.activeTexture(e.TEXTURE0),this.texture.baseTexture._dirty[e.id]?t.renderer.updateTexture(this.texture.baseTexture):e.bindTexture(e.TEXTURE_2D,this.texture.baseTexture._glTextures[e.id]),e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,this._indexBuffer),e.bufferData(e.ELEMENT_ARRAY_BUFFER,this.indices,e.STATIC_DRAW)):(e.bindBuffer(e.ARRAY_BUFFER,this._vertexBuffer),e.bufferSubData(e.ARRAY_BUFFER,0,this.vertices),e.vertexAttribPointer(r.aVertexPosition,2,e.FLOAT,!1,0,0),e.bindBuffer(e.ARRAY_BUFFER,this._uvBuffer),e.vertexAttribPointer(r.aTextureCoord,2,e.FLOAT,!1,0,0),e.activeTexture(e.TEXTURE0),this.texture.baseTexture._dirty[e.id]?t.renderer.updateTexture(this.texture.baseTexture):e.bindTexture(e.TEXTURE_2D,this.texture.baseTexture._glTextures[e.id]),e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,this._indexBuffer)),e.drawElements(o,this.indices.length,e.UNSIGNED_SHORT,0)},P.Strip.prototype._renderCanvas=function(t){var e=t.context,i=this.worldTransform,n=i.tx*t.resolution+t.shakeX,r=i.ty*t.resolution+t.shakeY;t.roundPixels?e.setTransform(i.a,i.b,i.c,i.d,0|n,0|r):e.setTransform(i.a,i.b,i.c,i.d,n,r),this.drawMode===P.Strip.DrawModes.TRIANGLE_STRIP?this._renderCanvasTriangleStrip(e):this._renderCanvasTriangles(e)},P.Strip.prototype._renderCanvasTriangleStrip=function(t){var e=this.vertices,i=this.uvs,n=e.length/2;this.count++;for(var r=0;r<n-2;r++){var o=2*r;this._renderCanvasDrawTriangle(t,e,i,o,2+o,4+o)}},P.Strip.prototype._renderCanvasTriangles=function(t){var e=this.vertices,i=this.uvs,n=this.indices,r=n.length;this.count++;for(var o=0;o<r;o+=3){var s=2*n[o],a=2*n[o+1],h=2*n[o+2];this._renderCanvasDrawTriangle(t,e,i,s,a,h)}},P.Strip.prototype._renderCanvasDrawTriangle=function(t,e,i,n,r,o){var s=this.texture.baseTexture.source,a=this.texture.width,h=this.texture.height,l=e[n],p=e[r],u=e[o],d=e[n+1],c=e[r+1],y=e[o+1],_=i[n]*a,m=i[r]*a,g=i[o]*a,f=i[n+1]*h,x=i[r+1]*h,e=i[o+1]*h;0<this.canvasPadding&&(a=this.canvasPadding/this.worldTransform.a,v=this.canvasPadding/this.worldTransform.d,r=d-(n=(d+c+y)/3),l=(i=(l+p+u)/3)+(o=l-i)/(h=Math.sqrt(o*o+r*r))*(h+a),d=n+r/h*(h+v),r=c-n,p=i+(o=p-i)/(h=Math.sqrt(o*o+r*r))*(h+a),c=n+r/h*(h+v),r=y-n,u=i+(o=u-i)/(h=Math.sqrt(o*o+r*r))*(h+a),y=n+r/h*(h+v)),t.save(),t.beginPath(),t.moveTo(l,d),t.lineTo(p,c),t.lineTo(u,y),t.closePath(),t.clip();var v=_*x+f*g+m*e-x*g-f*m-_*e;t.transform((l*x+f*u+p*e-x*u-f*p-l*e)/v,(d*x+f*y+c*e-x*y-f*c-d*e)/v,(_*p+l*g+m*u-p*g-l*m-_*u)/v,(_*c+d*g+m*y-c*g-d*m-_*y)/v,(_*x*u+f*p*g+l*m*e-l*x*g-f*m*u-_*p*e)/v,(_*x*y+f*c*g+d*m*e-d*x*g-f*m*y-_*c*e)/v),t.drawImage(s,0,0),t.restore()},P.Strip.prototype.renderStripFlat=function(t){var e=this.context,i=t.vertices,n=i.length/2;this.count++,e.beginPath();for(var r=1;r<n-2;r++){var o=2*r,s=i[o],a=i[2+o],h=i[4+o],l=i[1+o],p=i[3+o],o=i[5+o];e.moveTo(s,l),e.lineTo(a,p),e.lineTo(h,o)}e.fillStyle="#FF0000",e.fill(),e.closePath()},P.Strip.prototype.onTextureUpdate=function(){this.updateFrame=!0},P.Strip.prototype.getBounds=function(t){for(var t=t||this.worldTransform,e=t.a,i=t.b,n=t.c,r=t.d,o=t.tx,s=t.ty,a=-1/0,h=-1/0,l=1/0,p=1/0,u=this.vertices,d=0,c=u.length;d<c;d+=2)var y=u[d],_=u[d+1],m=e*y+n*_+o,y=r*_+i*y+s,l=m<l?m:l,p=y<p?y:p,a=a<m?m:a,h=h<y?y:h;if(l===-1/0||h===1/0)return P.EmptyRectangle;t=this._bounds;return t.x=l,t.width=a-l,t.y=p,t.height=h-p,this._currentBounds=t},P.Strip.DrawModes={TRIANGLE_STRIP:0,TRIANGLES:1},P.Rope=function(t,e){P.Strip.call(this,t),this.points=e,this.vertices=new P.Float32Array(4*e.length),this.uvs=new P.Float32Array(4*e.length),this.colors=new P.Float32Array(2*e.length),this.indices=new P.Uint16Array(2*e.length),this.refresh()},P.Rope.prototype=Object.create(P.Strip.prototype),P.Rope.prototype.constructor=P.Rope,P.Rope.prototype.refresh=function(){var t=this.points;if(!(t.length<1)){var e=this.uvs,i=(t[0],this.indices),n=this.colors;this.count-=.2,e[0]=0,e[1]=0,e[2]=0,e[3]=1,n[0]=1,n[1]=1,i[0]=0,i[1]=1;for(var r,o,s=t.length,a=1;a<s;a++)t[a],e[r=4*a]=o=a/(s-1),e[r+1]=0,e[r+2]=o,e[r+3]=1,n[r=2*a]=1,n[r+1]=1,i[r=2*a]=r,i[r+1]=r+1,0}},P.Rope.prototype.updateTransform=function(){var t=this.points;if(!(t.length<1)){var e=t[0],i={x:0,y:0};this.count-=.2;for(var n,r,o,s,a=this.vertices,h=t.length,l=0;l<h;l++)n=t[l],r=4*l,s=l<t.length-1?t[l+1]:n,i.y=-(s.x-e.x),i.x=s.y-e.y,o=Math.sqrt(i.x*i.x+i.y*i.y),s=this.texture.height/2,i.x/=o,i.y/=o,i.x*=s,i.y*=s,a[r]=n.x+i.x,a[1+r]=n.y+i.y,a[2+r]=n.x-i.x,a[3+r]=n.y-i.y,e=n;P.DisplayObjectContainer.prototype.updateTransform.call(this)}},P.Rope.prototype.setTexture=function(t){this.texture=t},P.TilingSprite=function(t,e,i){P.Sprite.call(this,t),this._width=e||128,this._height=i||128,this.tileScale=new P.Point(1,1),this.tileScaleOffset=new P.Point(1,1),this.tilePosition=new P.Point,this.renderable=!0,this.tint=16777215,this.textureDebug=!1,this.blendMode=P.blendModes.NORMAL,this.canvasBuffer=null,this.tilingTexture=null,this.tilePattern=null,this.refreshTexture=!0,this.frameWidth=0,this.frameHeight=0},P.TilingSprite.prototype=Object.create(P.Sprite.prototype),P.TilingSprite.prototype.constructor=P.TilingSprite,P.TilingSprite.prototype.setTexture=function(t){this.texture!==t&&(this.texture=t,this.refreshTexture=!0,this.cachedTint=16777215)},P.TilingSprite.prototype._renderWebGL=function(t){if(this.visible&&this.renderable&&0!==this.alpha){if(this._mask&&(t.spriteBatch.stop(),t.maskManager.pushMask(this.mask,t),t.spriteBatch.start()),this._filters&&(t.spriteBatch.flush(),t.filterManager.pushFilter(this._filterBlock)),this.refreshTexture){if(this.generateTilingTexture(!0,t),!this.tilingTexture)return;this.tilingTexture.needsUpdate&&(t.renderer.updateTexture(this.tilingTexture.baseTexture),this.tilingTexture.needsUpdate=!1)}t.spriteBatch.renderTilingSprite(this);for(var e=0;e<this.children.length;e++)this.children[e]._renderWebGL(t);t.spriteBatch.stop(),this._filters&&t.filterManager.popFilter(),this._mask&&t.maskManager.popMask(this._mask,t),t.spriteBatch.start()}},P.TilingSprite.prototype._renderCanvas=function(t){if(this.visible&&this.renderable&&0!==this.alpha){var e=t.context;this._mask&&t.maskManager.pushMask(this._mask,t),e.globalAlpha=this.worldAlpha;var i=this.worldTransform,n=t.resolution,r=i.tx*n+t.shakeX,o=i.ty*n+t.shakeY;if(e.setTransform(i.a*n,i.b*n,i.c*n,i.d*n,r,o),this.refreshTexture){if(this.generateTilingTexture(!1,t),!this.tilingTexture)return;this.tilePattern=e.createPattern(this.tilingTexture.baseTexture.source,"repeat")}var s=t.currentBlendMode;this.blendMode!==t.currentBlendMode&&(t.currentBlendMode=this.blendMode,e.globalCompositeOperation=P.blendModesCanvas[t.currentBlendMode]);var a=this.tilePosition,h=this.tileScale;a.x%=this.tilingTexture.baseTexture.width,a.y%=this.tilingTexture.baseTexture.height,e.scale(h.x,h.y),e.translate(a.x+this.anchor.x*-this._width,a.y+this.anchor.y*-this._height),e.fillStyle=this.tilePattern;r=-a.x,o=-a.y,i=this._width/h.x,n=this._height/h.y;t.roundPixels&&(r|=0,o|=0,i|=0,n|=0),e.fillRect(r,o,i,n),e.scale(1/h.x,1/h.y),e.translate(-a.x+this.anchor.x*this._width,-a.y+this.anchor.y*this._height),this._mask&&t.maskManager.popMask(t);for(var l=0;l<this.children.length;l++)this.children[l]._renderCanvas(t);s!==this.blendMode&&(t.currentBlendMode=s,e.globalCompositeOperation=P.blendModesCanvas[s])}},P.TilingSprite.prototype.onTextureUpdate=function(){},P.TilingSprite.prototype.generateTilingTexture=function(t,e){var i,n,r,o,s,a,h;this.texture.baseTexture.hasLoaded&&(n=(i=this.texture).frame,r=this._frame.sourceSizeW||this._frame.width,o=this._frame.sourceSizeH||this._frame.height,a=s=0,this._frame.trimmed&&(s=this._frame.spriteSourceSizeX,a=this._frame.spriteSourceSizeY),t&&(r=P.getNextPowerOfTwo(r),o=P.getNextPowerOfTwo(o)),this.canvasBuffer?(this.canvasBuffer.resize(r,o),this.tilingTexture.baseTexture.width=r,this.tilingTexture.baseTexture.height=o):(this.canvasBuffer=new P.CanvasBuffer(r,o),this.tilingTexture=P.Texture.fromCanvas(this.canvasBuffer.canvas),this.tilingTexture.isTiling=!0),this.tilingTexture.needsUpdate=!0,this.textureDebug&&(this.canvasBuffer.context.strokeStyle="#00ff00",this.canvasBuffer.context.strokeRect(0,0,r,o)),h=i.crop.width,t=i.crop.height,h===r&&t===o||(h=r,t=o),this.canvasBuffer.context.drawImage(i.baseTexture.source,i.crop.x,i.crop.y,i.crop.width,i.crop.height,s,a,h,t),this.tileScaleOffset.x=n.width/r,this.tileScaleOffset.y=n.height/o,this.refreshTexture=!1,this.tilingTexture.baseTexture._powerOf2=!0)},P.TilingSprite.prototype.getBounds=function(){var t=this._width,e=this._height,i=t*(1-this.anchor.x),n=t*-this.anchor.x,r=e*(1-this.anchor.y),o=e*-this.anchor.y,s=this.worldTransform,a=s.a,h=s.b,l=s.c,p=s.d,u=s.tx,d=s.ty,c=a*n+l*o+u,t=p*o+h*n+d,e=a*i+l*o+u,s=p*o+h*i+d,o=a*i+l*r+u,i=p*r+h*i+d,u=a*n+l*r+u,r=p*r+h*n+d,h=c<(h=1/0)?c:h,n=r<(n=i<(n=s<(n=t<(n=1/0)?t:n)?s:n)?i:n)?r:n,d=(d=(d=(d=(d=-1/0)<c?c:d)<e?e:d)<o?o:d)<u?u:d,c=(c=(c=(c=(c=-1/0)<t?t:c)<s?s:c)<i?i:c)<r?r:c,r=this._bounds;return r.x=h=u<(h=o<(h=e<h?e:h)?o:h)?u:h,r.width=d-h,r.y=n,r.height=c-n,this._currentBounds=r},P.TilingSprite.prototype.destroy=function(){P.Sprite.prototype.destroy.call(this),this.canvasBuffer&&(this.canvasBuffer.destroy(),this.canvasBuffer=null),this.tileScale=null,this.tileScaleOffset=null,this.tilePosition=null,this.tilingTexture&&(this.tilingTexture.destroy(!0),this.tilingTexture=null)},Object.defineProperty(P.TilingSprite.prototype,"width",{get:function(){return this._width},set:function(t){this._width=t}}),Object.defineProperty(P.TilingSprite.prototype,"height",{get:function(){return this._height},set:function(t){this._height=t}}),"undefined"!=typeof exports?(exports="undefined"!=typeof module&&module.exports?module.exports=P:exports).PIXI=P:"undefined"!=typeof define&&define.amd?define("PIXI",t.PIXI=P):t.PIXI=P,P}.call(this),function(){var o,t,e,i,n=this,U={VERSION:"2.6.2",GAMES:[],AUTO:0,CANVAS:1,WEBGL:2,HEADLESS:3,NONE:0,LEFT:1,RIGHT:2,UP:3,DOWN:4,SPRITE:0,BUTTON:1,IMAGE:2,GRAPHICS:3,TEXT:4,TILESPRITE:5,BITMAPTEXT:6,GROUP:7,RENDERTEXTURE:8,TILEMAP:9,TILEMAPLAYER:10,EMITTER:11,POLYGON:12,BITMAPDATA:13,CANVAS_FILTER:14,WEBGL_FILTER:15,ELLIPSE:16,SPRITEBATCH:17,RETROFONT:18,POINTER:19,ROPE:20,CIRCLE:21,RECTANGLE:22,LINE:23,MATRIX:24,POINT:25,ROUNDEDRECTANGLE:26,CREATURE:27,VIDEO:28,PENDING_ATLAS:-1,HORIZONTAL:0,VERTICAL:1,LANDSCAPE:0,PORTRAIT:1,ANGLE_UP:270,ANGLE_DOWN:90,ANGLE_LEFT:180,ANGLE_RIGHT:0,ANGLE_NORTH_EAST:315,ANGLE_NORTH_WEST:225,ANGLE_SOUTH_EAST:45,ANGLE_SOUTH_WEST:135,TOP_LEFT:0,TOP_CENTER:1,TOP_RIGHT:2,LEFT_TOP:3,LEFT_CENTER:4,LEFT_BOTTOM:5,CENTER:6,RIGHT_TOP:7,RIGHT_CENTER:8,RIGHT_BOTTOM:9,BOTTOM_LEFT:10,BOTTOM_CENTER:11,BOTTOM_RIGHT:12,blendModes:{NORMAL:0,ADD:1,MULTIPLY:2,SCREEN:3,OVERLAY:4,DARKEN:5,LIGHTEN:6,COLOR_DODGE:7,COLOR_BURN:8,HARD_LIGHT:9,SOFT_LIGHT:10,DIFFERENCE:11,EXCLUSION:12,HUE:13,SATURATION:14,COLOR:15,LUMINOSITY:16},scaleModes:{DEFAULT:0,LINEAR:0,NEAREST:1},PIXI:PIXI||{}};function r(t,e){this._scaleFactor=t,this._deltaMode=e,this.originalEvent=null}for(e in Math.trunc||(Math.trunc=function(t){return t<0?Math.ceil(t):Math.floor(t)}),Function.prototype.bind||(Function.prototype.bind=(o=Array.prototype.slice,function(e){var i=this,n=o.call(arguments,1);if("function"!=typeof i)throw new TypeError;function r(){var t=n.concat(o.call(arguments));i.apply(this instanceof r?this:e,t)}return r.prototype=function t(e){if(e&&(t.prototype=e),!(this instanceof t))return new t}(i.prototype),r})),Array.isArray||(Array.isArray=function(t){return"[object Array]"===Object.prototype.toString.call(t)}),Array.prototype.forEach||(Array.prototype.forEach=function(t){"use strict";if(null==this)throw new TypeError;var e=Object(this),i=e.length>>>0;if("function"!=typeof t)throw new TypeError;for(var n=2<=arguments.length?arguments[1]:void 0,r=0;r<i;r++)r in e&&t.call(n,e[r],r,e)}),"function"!=typeof window.Uint32Array&&"object"!=typeof window.Uint32Array&&((t=function(t){var e=new Array;window[t]=function(t){if("number"==typeof t){Array.call(this,t),this.length=t;for(var e=0;e<this.length;e++)this[e]=0}else{Array.call(this,t.length),this.length=t.length;for(e=0;e<this.length;e++)this[e]=t[e]}},window[t].prototype=e,window[t].constructor=window[t]})("Uint32Array"),t("Int16Array")),window.console||(window.console={},window.console.log=window.console.assert=function(){},window.console.warn=window.console.assert=function(){}),U.Utils={reverseString:function(t){return t.split("").reverse().join("")},getProperty:function(t,e){for(var i=e.split("."),e=i.pop(),n=i.length,r=1,o=i[0];r<n&&(t=t[o]);)o=i[r],r++;return t?t[e]:null},setProperty:function(t,e,i){for(var n=e.split("."),e=n.pop(),r=n.length,o=1,s=n[0];o<r&&(t=t[s]);)s=n[o],o++;return t&&(t[e]=i),t},chanceRoll:function(t){return 0<(t=void 0===t?50:t)&&100*Math.random()<=t},randomChoice:function(t,e){return Math.random()<.5?t:e},parseDimension:function(t,e){var i;return"string"==typeof t?"%"===t.substr(-1)?(i=parseInt(t,10)/100,0===e?window.innerWidth*i:window.innerHeight*i):parseInt(t,10):t},pad:function(t,e,i,n){void 0===i&&(i=" "),void 0===n&&(n=3);var r;if((e=void 0===e?0:e)+1>=(t=t.toString()).length)switch(n){case 1:t=new Array(e+1-t.length).join(i)+t;break;case 3:var o=Math.ceil((r=e-t.length)/2);t=new Array(1+(r-o)).join(i)+t+new Array(o+1).join(i);break;default:t+=new Array(e+1-t.length).join(i)}return t},isPlainObject:function(t){if("object"!=typeof t||t.nodeType||t===t.window)return!1;try{if(t.constructor&&!{}.hasOwnProperty.call(t.constructor.prototype,"isPrototypeOf"))return!1}catch(t){return!1}return!0},extend:function(){var t,e,i,n,r,o=arguments[0]||{},s=1,a=arguments.length,h=!1;for("boolean"==typeof o&&(h=o,o=arguments[1]||{},s=2),a===s&&(o=this,--s);s<a;s++)if(null!=(t=arguments[s]))for(e in t)r=o[e],o!==(i=t[e])&&(h&&i&&(U.Utils.isPlainObject(i)||(n=Array.isArray(i)))?(r=n?(n=!1,r&&Array.isArray(r)?r:[]):r&&U.Utils.isPlainObject(r)?r:{},o[e]=U.Utils.extend(h,r,i)):void 0!==i&&(o[e]=i));return o},mixinPrototype:function(t,e,i){void 0===i&&(i=!1);for(var n=Object.keys(e),r=0;r<n.length;r++){var o=n[r],s=e[o];!i&&o in t||(!s||"function"!=typeof s.get&&"function"!=typeof s.set?t[o]=s:"function"==typeof s.clone?t[o]=s.clone():Object.defineProperty(t,o,s))}},mixin:function(t,e){if(!t||"object"!=typeof t)return e;for(var i in t){var n,r=t[i];r.childNodes||r.cloneNode||(n=typeof t[i],t[i]&&"object"==n?typeof e[i]==n?e[i]=U.Utils.mixin(t[i],e[i]):e[i]=U.Utils.mixin(t[i],new r.constructor):e[i]=t[i])}return e}},U.Circle=function(t,e,i){e=e||0,i=i||0,this.x=t=t||0,this.y=e,this._diameter=i,(this._radius=0)<i&&(this._radius=.5*i),this.type=U.CIRCLE},U.Circle.prototype={circumference:function(){return Math.PI*this._radius*2},random:function(t){void 0===t&&(t=new U.Point);var e=2*Math.PI*Math.random(),i=Math.random()+Math.random(),n=1<i?2-i:i,i=n*Math.cos(e),e=n*Math.sin(e);return t.x=this.x+i*this.radius,t.y=this.y+e*this.radius,t},getBounds:function(){return new U.Rectangle(this.x-this.radius,this.y-this.radius,this.diameter,this.diameter)},setTo:function(t,e,i){return this.x=t,this.y=e,this._diameter=i,this._radius=.5*i,this},copyFrom:function(t){return this.setTo(t.x,t.y,t.diameter)},copyTo:function(t){return t.x=this.x,t.y=this.y,t.diameter=this._diameter,t},distance:function(t,e){t=U.Math.distance(this.x,this.y,t.x,t.y);return e?Math.round(t):t},clone:function(t){return null==t?t=new U.Circle(this.x,this.y,this.diameter):t.setTo(this.x,this.y,this.diameter),t},contains:function(t,e){return U.Circle.contains(this,t,e)},circumferencePoint:function(t,e,i){return U.Circle.circumferencePoint(this,t,e,i)},offset:function(t,e){return this.x+=t,this.y+=e,this},offsetPoint:function(t){return this.offset(t.x,t.y)},toString:function(){return"[{Phaser.Circle (x="+this.x+" y="+this.y+" diameter="+this.diameter+" radius="+this.radius+")}]"}},U.Circle.prototype.constructor=U.Circle,Object.defineProperty(U.Circle.prototype,"diameter",{get:function(){return this._diameter},set:function(t){0<t&&(this._diameter=t,this._radius=.5*t)}}),Object.defineProperty(U.Circle.prototype,"radius",{get:function(){return this._radius},set:function(t){0<t&&(this._radius=t,this._diameter=2*t)}}),Object.defineProperty(U.Circle.prototype,"left",{get:function(){return this.x-this._radius},set:function(t){t>this.x?(this._radius=0,this._diameter=0):this.radius=this.x-t}}),Object.defineProperty(U.Circle.prototype,"right",{get:function(){return this.x+this._radius},set:function(t){t<this.x?(this._radius=0,this._diameter=0):this.radius=t-this.x}}),Object.defineProperty(U.Circle.prototype,"top",{get:function(){return this.y-this._radius},set:function(t){t>this.y?(this._radius=0,this._diameter=0):this.radius=this.y-t}}),Object.defineProperty(U.Circle.prototype,"bottom",{get:function(){return this.y+this._radius},set:function(t){t<this.y?(this._radius=0,this._diameter=0):this.radius=t-this.y}}),Object.defineProperty(U.Circle.prototype,"area",{get:function(){return 0<this._radius?Math.PI*this._radius*this._radius:0}}),Object.defineProperty(U.Circle.prototype,"empty",{get:function(){return 0===this._diameter},set:function(t){!0===t&&this.setTo(0,0,0)}}),U.Circle.contains=function(t,e,i){return 0<t.radius&&e>=t.left&&e<=t.right&&i>=t.top&&i<=t.bottom&&(t.x-e)*(t.x-e)+(t.y-i)*(t.y-i)<=t.radius*t.radius},U.Circle.equals=function(t,e){return t.x===e.x&&t.y===e.y&&t.diameter===e.diameter},U.Circle.intersects=function(t,e){return U.Math.distance(t.x,t.y,e.x,e.y)<=t.radius+e.radius},U.Circle.circumferencePoint=function(t,e,i,n){return void 0===i&&(i=!1),void 0===n&&(n=new U.Point),!0===i&&(e=U.Math.degToRad(e)),n.x=t.x+t.radius*Math.cos(e),n.y=t.y+t.radius*Math.sin(e),n},U.Circle.intersectsRectangle=function(t,e){var i=Math.abs(t.x-e.x-e.halfWidth);if(e.halfWidth+t.radius<i)return!1;var n=Math.abs(t.y-e.y-e.halfHeight);if(e.halfHeight+t.radius<n)return!1;if(i<=e.halfWidth||n<=e.halfHeight)return!0;i-=e.halfWidth,e=n-e.halfHeight;return i*i+e*e<=t.radius*t.radius},PIXI.Circle=U.Circle,U.Ellipse=function(t,e,i,n){e=e||0,i=i||0,n=n||0,this.x=t=t||0,this.y=e,this.width=i,this.height=n,this.type=U.ELLIPSE},U.Ellipse.prototype={setTo:function(t,e,i,n){return this.x=t,this.y=e,this.width=i,this.height=n,this},getBounds:function(){return new U.Rectangle(this.x-this.width,this.y-this.height,this.width,this.height)},copyFrom:function(t){return this.setTo(t.x,t.y,t.width,t.height)},copyTo:function(t){return t.x=this.x,t.y=this.y,t.width=this.width,t.height=this.height,t},clone:function(t){return null==t?t=new U.Ellipse(this.x,this.y,this.width,this.height):t.setTo(this.x,this.y,this.width,this.height),t},contains:function(t,e){return U.Ellipse.contains(this,t,e)},random:function(t){void 0===t&&(t=new U.Point);var e=Math.random()*Math.PI*2,i=Math.random();return t.x=Math.sqrt(i)*Math.cos(e),t.y=Math.sqrt(i)*Math.sin(e),t.x=this.x+t.x*this.width/2,t.y=this.y+t.y*this.height/2,t},toString:function(){return"[{Phaser.Ellipse (x="+this.x+" y="+this.y+" width="+this.width+" height="+this.height+")}]"}},U.Ellipse.prototype.constructor=U.Ellipse,Object.defineProperty(U.Ellipse.prototype,"left",{get:function(){return this.x},set:function(t){this.x=t}}),Object.defineProperty(U.Ellipse.prototype,"right",{get:function(){return this.x+this.width},set:function(t){t<this.x?this.width=0:this.width=t-this.x}}),Object.defineProperty(U.Ellipse.prototype,"top",{get:function(){return this.y},set:function(t){this.y=t}}),Object.defineProperty(U.Ellipse.prototype,"bottom",{get:function(){return this.y+this.height},set:function(t){t<this.y?this.height=0:this.height=t-this.y}}),Object.defineProperty(U.Ellipse.prototype,"empty",{get:function(){return 0===this.width||0===this.height},set:function(t){!0===t&&this.setTo(0,0,0,0)}}),U.Ellipse.contains=function(t,e,i){if(t.width<=0||t.height<=0)return!1;e=(e-t.x)/t.width-.5,t=(i-t.y)/t.height-.5;return(e*=e)+(t*=t)<.25},PIXI.Ellipse=U.Ellipse,U.Line=function(t,e,i,n){i=i||0,n=n||0,this.start=new U.Point(t=t||0,e=e||0),this.end=new U.Point(i,n),this.type=U.LINE},U.Line.prototype={setTo:function(t,e,i,n){return this.start.setTo(t,e),this.end.setTo(i,n),this},fromSprite:function(t,e,i){return(i=void 0!==i&&i)?this.setTo(t.center.x,t.center.y,e.center.x,e.center.y):this.setTo(t.x,t.y,e.x,e.y)},fromAngle:function(t,e,i,n){return this.start.setTo(t,e),this.end.setTo(t+Math.cos(i)*n,e+Math.sin(i)*n),this},rotate:function(t,e){var i=(this.start.x+this.end.x)/2,n=(this.start.y+this.end.y)/2;return this.start.rotate(i,n,t,e),this.end.rotate(i,n,t,e),this},rotateAround:function(t,e,i,n){return this.start.rotate(t,e,i,n),this.end.rotate(t,e,i,n),this},intersects:function(t,e,i){return U.Line.intersectsPoints(this.start,this.end,t.start,t.end,e,i)},reflect:function(t){return U.Line.reflect(this,t)},midPoint:function(t){return(t=void 0===t?new U.Point:t).x=(this.start.x+this.end.x)/2,t.y=(this.start.y+this.end.y)/2,t},centerOn:function(t,e){t-=(this.start.x+this.end.x)/2,e-=(this.start.y+this.end.y)/2;this.start.add(t,e),this.end.add(t,e)},pointOnLine:function(t,e){return(t-this.start.x)*(this.end.y-this.start.y)==(this.end.x-this.start.x)*(e-this.start.y)},pointOnSegment:function(t,e){var i=Math.min(this.start.x,this.end.x),n=Math.max(this.start.x,this.end.x),r=Math.min(this.start.y,this.end.y),o=Math.max(this.start.y,this.end.y);return this.pointOnLine(t,e)&&i<=t&&t<=n&&r<=e&&e<=o},random:function(t){void 0===t&&(t=new U.Point);var e=Math.random();return t.x=this.start.x+e*(this.end.x-this.start.x),t.y=this.start.y+e*(this.end.y-this.start.y),t},coordinatesOnLine:function(t,e){void 0===t&&(t=1),void 0===e&&(e=[]);var i=Math.round(this.start.x),n=Math.round(this.start.y),r=Math.round(this.end.x),o=Math.round(this.end.y),s=Math.abs(r-i),a=Math.abs(o-n),h=i<r?1:-1,l=n<o?1:-1,p=s-a;e.push([i,n]);for(var u=1;i!==r||n!==o;){var d=p<<1;-a<d&&(p-=a,i+=h),d<s&&(p+=s,n+=l),u%t==0&&e.push([i,n]),u++}return e},clone:function(t){return null==t?t=new U.Line(this.start.x,this.start.y,this.end.x,this.end.y):t.setTo(this.start.x,this.start.y,this.end.x,this.end.y),t}},Object.defineProperty(U.Line.prototype,"length",{get:function(){return Math.sqrt((this.end.x-this.start.x)*(this.end.x-this.start.x)+(this.end.y-this.start.y)*(this.end.y-this.start.y))}}),Object.defineProperty(U.Line.prototype,"angle",{get:function(){return Math.atan2(this.end.y-this.start.y,this.end.x-this.start.x)}}),Object.defineProperty(U.Line.prototype,"slope",{get:function(){return(this.end.y-this.start.y)/(this.end.x-this.start.x)}}),Object.defineProperty(U.Line.prototype,"perpSlope",{get:function(){return-((this.end.x-this.start.x)/(this.end.y-this.start.y))}}),Object.defineProperty(U.Line.prototype,"x",{get:function(){return Math.min(this.start.x,this.end.x)}}),Object.defineProperty(U.Line.prototype,"y",{get:function(){return Math.min(this.start.y,this.end.y)}}),Object.defineProperty(U.Line.prototype,"left",{get:function(){return Math.min(this.start.x,this.end.x)}}),Object.defineProperty(U.Line.prototype,"right",{get:function(){return Math.max(this.start.x,this.end.x)}}),Object.defineProperty(U.Line.prototype,"top",{get:function(){return Math.min(this.start.y,this.end.y)}}),Object.defineProperty(U.Line.prototype,"bottom",{get:function(){return Math.max(this.start.y,this.end.y)}}),Object.defineProperty(U.Line.prototype,"width",{get:function(){return Math.abs(this.start.x-this.end.x)}}),Object.defineProperty(U.Line.prototype,"height",{get:function(){return Math.abs(this.start.y-this.end.y)}}),Object.defineProperty(U.Line.prototype,"normalX",{get:function(){return Math.cos(this.angle-1.5707963267948966)}}),Object.defineProperty(U.Line.prototype,"normalY",{get:function(){return Math.sin(this.angle-1.5707963267948966)}}),Object.defineProperty(U.Line.prototype,"normalAngle",{get:function(){return U.Math.wrap(this.angle-1.5707963267948966,-Math.PI,Math.PI)}}),U.Line.intersectsPoints=function(t,e,i,n,r,o){void 0===r&&(r=!0),void 0===o&&(o=new U.Point);var s=e.y-t.y,a=n.y-i.y,h=t.x-e.x,l=i.x-n.x,p=e.x*t.y-t.x*e.y,u=n.x*i.y-i.x*n.y,d=s*l-a*h;if(0==d)return null;if(o.x=(h*u-l*p)/d,o.y=(a*p-s*u)/d,r){r=(n.y-i.y)*(e.x-t.x)-(n.x-i.x)*(e.y-t.y),n=((n.x-i.x)*(t.y-i.y)-(n.y-i.y)*(t.x-i.x))/r,r=((e.x-t.x)*(t.y-i.y)-(e.y-t.y)*(t.x-i.x))/r;return 0<=n&&n<=1&&0<=r&&r<=1?o:null}return o},U.Line.intersects=function(t,e,i,n){return U.Line.intersectsPoints(t.start,t.end,e.start,e.end,i,n)},U.Line.intersectsRectangle=function(t,e){if(!U.Rectangle.intersects(t,e))return!1;var i=t.start.x,n=t.start.y,r=t.end.x,o=t.end.y,s=e.x,a=e.y,h=e.right,t=e.bottom,e=0;if(s<=i&&i<=h&&a<=n&&n<=t||s<=r&&r<=h&&a<=o&&o<=t)return!0;if(i<s&&s<=r){if(a<(e=n+(o-n)*(s-i)/(r-i))&&e<=t)return!0}else if(h<i&&r<=h&&a<=(e=n+(o-n)*(h-i)/(r-i))&&e<=t)return!0;if(n<a&&a<=o){if(s<=(e=i+(r-i)*(a-n)/(o-n))&&e<=h)return!0}else if(t<n&&o<=t&&s<=(e=i+(r-i)*(t-n)/(o-n))&&e<=h)return!0;return!1},U.Line.reflect=function(t,e){return 2*e.normalAngle-3.141592653589793-t.angle},U.Matrix=function(t,e,i,n,r,o){null==e&&(e=0),null==i&&(i=0),null==n&&(n=1),null==r&&(r=0),null==o&&(o=0),this.a=t=null==t?1:t,this.b=e,this.c=i,this.d=n,this.tx=r,this.ty=o,this.type=U.MATRIX},U.Matrix.prototype={fromArray:function(t){return this.setTo(t[0],t[1],t[3],t[4],t[2],t[5])},setTo:function(t,e,i,n,r,o){return this.a=t,this.b=e,this.c=i,this.d=n,this.tx=r,this.ty=o,this},clone:function(t){return null==t?t=new U.Matrix(this.a,this.b,this.c,this.d,this.tx,this.ty):(t.a=this.a,t.b=this.b,t.c=this.c,t.d=this.d,t.tx=this.tx,t.ty=this.ty),t},copyTo:function(t){return t.copyFrom(this),t},copyFrom:function(t){return this.a=t.a,this.b=t.b,this.c=t.c,this.d=t.d,this.tx=t.tx,this.ty=t.ty,this},toArray:function(t,e){return void 0===e&&(e=new PIXI.Float32Array(9)),t?(e[0]=this.a,e[1]=this.b,e[2]=0,e[3]=this.c,e[4]=this.d,e[5]=0,e[6]=this.tx,e[7]=this.ty):(e[0]=this.a,e[1]=this.c,e[2]=this.tx,e[3]=this.b,e[4]=this.d,e[5]=this.ty,e[6]=0,e[7]=0),e[8]=1,e},apply:function(t,e){return(e=void 0===e?new U.Point:e).x=this.a*t.x+this.c*t.y+this.tx,e.y=this.b*t.x+this.d*t.y+this.ty,e},applyInverse:function(t,e){void 0===e&&(e=new U.Point);var i=1/(this.a*this.d+this.c*-this.b),n=t.x,t=t.y;return e.x=this.d*i*n+-this.c*i*t+(this.ty*this.c-this.tx*this.d)*i,e.y=this.a*i*t+-this.b*i*n+(-this.ty*this.a+this.tx*this.b)*i,e},translate:function(t,e){return this.tx+=t,this.ty+=e,this},scale:function(t,e){return this.a*=t,this.d*=e,this.c*=t,this.b*=e,this.tx*=t,this.ty*=e,this},rotate:function(t){var e=Math.cos(t),i=Math.sin(t),n=this.a,r=this.c,t=this.tx;return this.a=n*e-this.b*i,this.b=n*i+this.b*e,this.c=r*e-this.d*i,this.d=r*i+this.d*e,this.tx=t*e-this.ty*i,this.ty=t*i+this.ty*e,this},append:function(t){var e=this.a,i=this.b,n=this.c,r=this.d;return this.a=t.a*e+t.b*n,this.b=t.a*i+t.b*r,this.c=t.c*e+t.d*n,this.d=t.c*i+t.d*r,this.tx=t.tx*e+t.ty*n+this.tx,this.ty=t.tx*i+t.ty*r+this.ty,this},identity:function(){return this.setTo(1,0,0,1,0,0)}},U.identityMatrix=new U.Matrix,PIXI.Matrix=U.Matrix,PIXI.identityMatrix=U.identityMatrix,U.Point=function(t,e){e=e||0,this.x=t=t||0,this.y=e,this.type=U.POINT},U.Point.prototype={copyFrom:function(t){return this.setTo(t.x,t.y)},invert:function(){return this.setTo(this.y,this.x)},setTo:function(t,e){return this.x=t||0,this.y=e||(0!==e?this.x:0),this},set:function(t,e){return this.x=t||0,this.y=e||(0!==e?this.x:0),this},add:function(t,e){return this.x+=t,this.y+=e,this},subtract:function(t,e){return this.x-=t,this.y-=e,this},multiply:function(t,e){return this.x*=t,this.y*=e,this},divide:function(t,e){return this.x/=t,this.y/=e,this},clampX:function(t,e){return this.x=U.Math.clamp(this.x,t,e),this},clampY:function(t,e){return this.y=U.Math.clamp(this.y,t,e),this},clamp:function(t,e){return this.x=U.Math.clamp(this.x,t,e),this.y=U.Math.clamp(this.y,t,e),this},clone:function(t){return null==t?t=new U.Point(this.x,this.y):t.setTo(this.x,this.y),t},copyTo:function(t){return t.x=this.x,t.y=this.y,t},distance:function(t,e){return U.Point.distance(this,t,e)},equals:function(t){return t.x===this.x&&t.y===this.y},angle:function(t,e){return(e=void 0===e?!1:e)?U.Math.radToDeg(Math.atan2(t.y-this.y,t.x-this.x)):Math.atan2(t.y-this.y,t.x-this.x)},rotate:function(t,e,i,n,r){return U.Point.rotate(this,t,e,i,n,r)},getMagnitude:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},getMagnitudeSq:function(){return this.x*this.x+this.y*this.y},setMagnitude:function(t){return this.normalize().multiply(t,t)},normalize:function(){var t;return this.isZero()||(t=this.getMagnitude(),this.x/=t,this.y/=t),this},isZero:function(){return 0===this.x&&0===this.y},dot:function(t){return this.x*t.x+this.y*t.y},cross:function(t){return this.x*t.y-this.y*t.x},perp:function(){return this.setTo(-this.y,this.x)},rperp:function(){return this.setTo(this.y,-this.x)},normalRightHand:function(){return this.setTo(-1*this.y,this.x)},floor:function(){return this.setTo(Math.floor(this.x),Math.floor(this.y))},ceil:function(){return this.setTo(Math.ceil(this.x),Math.ceil(this.y))},toString:function(){return"[{Point (x="+this.x+" y="+this.y+")}]"}},U.Point.prototype.constructor=U.Point,U.Point.add=function(t,e,i){return(i=void 0===i?new U.Point:i).x=t.x+e.x,i.y=t.y+e.y,i},U.Point.subtract=function(t,e,i){return(i=void 0===i?new U.Point:i).x=t.x-e.x,i.y=t.y-e.y,i},U.Point.multiply=function(t,e,i){return(i=void 0===i?new U.Point:i).x=t.x*e.x,i.y=t.y*e.y,i},U.Point.divide=function(t,e,i){return(i=void 0===i?new U.Point:i).x=t.x/e.x,i.y=t.y/e.y,i},U.Point.equals=function(t,e){return t.x===e.x&&t.y===e.y},U.Point.angle=function(t,e){return Math.atan2(t.y-e.y,t.x-e.x)},U.Point.negative=function(t,e){return(e=void 0===e?new U.Point:e).setTo(-t.x,-t.y)},U.Point.multiplyAdd=function(t,e,i,n){return(n=void 0===n?new U.Point:n).setTo(t.x+e.x*i,t.y+e.y*i)},U.Point.interpolate=function(t,e,i,n){return(n=void 0===n?new U.Point:n).setTo(t.x+(e.x-t.x)*i,t.y+(e.y-t.y)*i)},U.Point.perp=function(t,e){return(e=void 0===e?new U.Point:e).setTo(-t.y,t.x)},U.Point.rperp=function(t,e){return(e=void 0===e?new U.Point:e).setTo(t.y,-t.x)},U.Point.distance=function(t,e,i){e=U.Math.distance(t.x,t.y,e.x,e.y);return i?Math.round(e):e},U.Point.project=function(t,e,i){void 0===i&&(i=new U.Point);t=t.dot(e)/e.getMagnitudeSq();return 0!=t&&i.setTo(t*e.x,t*e.y),i},U.Point.projectUnit=function(t,e,i){void 0===i&&(i=new U.Point);t=t.dot(e);return 0!==t&&i.setTo(t*e.x,t*e.y),i},U.Point.normalRightHand=function(t,e){return(e=void 0===e?new U.Point:e).setTo(-1*t.y,t.x)},U.Point.normalize=function(t,e){void 0===e&&(e=new U.Point);var i=t.getMagnitude();return 0!==i&&e.setTo(t.x/i,t.y/i),e},U.Point.rotate=function(t,e,i,n,r,o){var s,a;return r&&(n=U.Math.degToRad(n)),void 0===o?(t.subtract(e,i),s=Math.sin(n),r=(a=Math.cos(n))*t.x-s*t.y,a=s*t.x+a*t.y,t.x=r+e,t.y=a+i):(n=n+Math.atan2(t.y-i,t.x-e),t.x=e+o*Math.cos(n),t.y=i+o*Math.sin(n)),t},U.Point.centroid=function(t,e){if(void 0===e&&(e=new U.Point),"[object Array]"!==Object.prototype.toString.call(t))throw new Error("Phaser.Point. Parameter 'points' must be an array");var i=t.length;if(i<1)throw new Error("Phaser.Point. Parameter 'points' array must not be empty");if(1===i)return e.copyFrom(t[0]),e;for(var n=0;n<i;n++)U.Point.add(e,t[n],e);return e.divide(i,i),e},U.Point.parse=function(t,e,i){e=e||"x",i=i||"y";var n=new U.Point;return t[e]&&(n.x=parseInt(t[e],10)),t[i]&&(n.y=parseInt(t[i],10)),n},PIXI.Point=U.Point,U.Polygon=function(){this.area=0,this._points=[],0<arguments.length&&this.setTo.apply(this,arguments),this.closed=!0,this.flattened=!1,this.type=U.POLYGON},U.Polygon.prototype={toNumberArray:function(t){void 0===t&&(t=[]);for(var e=0;e<this._points.length;e++)"number"==typeof this._points[e]?(t.push(this._points[e]),t.push(this._points[e+1]),e++):(t.push(this._points[e].x),t.push(this._points[e].y));return t},flatten:function(){return this._points=this.toNumberArray(),this.flattened=!0,this},clone:function(t){var e=this._points.slice();return null==t?t=new U.Polygon(e):t.setTo(e),t},contains:function(t,e){var i=!1;if(this.flattened)for(var n=-2,r=this._points.length-2;(n+=2)<this._points.length;r=n){var o=this._points[n],s=this._points[n+1],a=this._points[r],h=this._points[r+1];(s<=e&&e<h||h<=e&&e<s)&&t<(a-o)*(e-s)/(h-s)+o&&(i=!i)}else for(n=-1,r=this._points.length-1;++n<this._points.length;r=n){o=this._points[n].x,s=this._points[n].y,a=this._points[r].x,h=this._points[r].y;(s<=e&&e<h||h<=e&&e<s)&&t<(a-o)*(e-s)/(h-s)+o&&(i=!i)}return i},setTo:function(t){if(this.area=0,this._points=[],0<arguments.length){Array.isArray(t)||(t=Array.prototype.slice.call(arguments));for(var e,i=Number.MAX_VALUE,n=0,r=t.length;n<r;n++)"number"==typeof t[n]?(e=new PIXI.Point(t[n],t[n+1]),n++):e=Array.isArray(t[n])?new PIXI.Point(t[n][0],t[n][1]):new PIXI.Point(t[n].x,t[n].y),this._points.push(e),e.y<i&&(i=e.y);this.calculateArea(i)}return this},calculateArea:function(t){for(var e,i,n,r=0,o=this._points.length;r<o;r++)e=this._points[r],n=r===o-1?this._points[0]:this._points[r+1],i=(e.y-t+(n.y-t))/2,n=e.x-n.x,this.area+=i*n;return this.area}},U.Polygon.prototype.constructor=U.Polygon,Object.defineProperty(U.Polygon.prototype,"points",{get:function(){return this._points},set:function(t){null!=t?this.setTo(t):this.setTo()}}),PIXI.Polygon=U.Polygon,U.Rectangle=function(t,e,i,n){e=e||0,i=i||0,n=n||0,this.x=t=t||0,this.y=e,this.width=i,this.height=n,this.type=U.RECTANGLE},U.Rectangle.prototype={offset:function(t,e){return this.x+=t,this.y+=e,this},offsetPoint:function(t){return this.offset(t.x,t.y)},setTo:function(t,e,i,n){return this.x=t,this.y=e,this.width=i,this.height=n,this},scale:function(t,e){return void 0===e&&(e=t),this.width*=t,this.height*=e,this},centerOn:function(t,e){return this.centerX=t,this.centerY=e,this},floor:function(){this.x=Math.floor(this.x),this.y=Math.floor(this.y)},floorAll:function(){this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.width=Math.floor(this.width),this.height=Math.floor(this.height)},ceil:function(){this.x=Math.ceil(this.x),this.y=Math.ceil(this.y)},ceilAll:function(){this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.width=Math.ceil(this.width),this.height=Math.ceil(this.height)},copyFrom:function(t){return this.setTo(t.x,t.y,t.width,t.height)},copyTo:function(t){return t.x=this.x,t.y=this.y,t.width=this.width,t.height=this.height,t},inflate:function(t,e){return U.Rectangle.inflate(this,t,e)},size:function(t){return U.Rectangle.size(this,t)},resize:function(t,e){return this.width=t,this.height=e,this},clone:function(t){return U.Rectangle.clone(this,t)},contains:function(t,e){return U.Rectangle.contains(this,t,e)},containsRect:function(t){return U.Rectangle.containsRect(t,this)},equals:function(t){return U.Rectangle.equals(this,t)},intersection:function(t,e){return U.Rectangle.intersection(this,t,e)},intersects:function(t){return U.Rectangle.intersects(this,t)},intersectsRaw:function(t,e,i,n,r){return U.Rectangle.intersectsRaw(this,t,e,i,n,r)},union:function(t,e){return U.Rectangle.union(this,t,e)},random:function(t){return(t=void 0===t?new U.Point:t).x=this.randomX,t.y=this.randomY,t},getPoint:function(t,e){switch(void 0===e&&(e=new U.Point),t){default:case U.TOP_LEFT:return e.set(this.x,this.y);case U.TOP_CENTER:return e.set(this.centerX,this.y);case U.TOP_RIGHT:return e.set(this.right,this.y);case U.LEFT_CENTER:return e.set(this.x,this.centerY);case U.CENTER:return e.set(this.centerX,this.centerY);case U.RIGHT_CENTER:return e.set(this.right,this.centerY);case U.BOTTOM_LEFT:return e.set(this.x,this.bottom);case U.BOTTOM_CENTER:return e.set(this.centerX,this.bottom);case U.BOTTOM_RIGHT:return e.set(this.right,this.bottom)}},toString:function(){return"[{Rectangle (x="+this.x+" y="+this.y+" width="+this.width+" height="+this.height+" empty="+this.empty+")}]"}},Object.defineProperty(U.Rectangle.prototype,"halfWidth",{get:function(){return Math.round(this.width/2)}}),Object.defineProperty(U.Rectangle.prototype,"halfHeight",{get:function(){return Math.round(this.height/2)}}),Object.defineProperty(U.Rectangle.prototype,"bottom",{get:function(){return this.y+this.height},set:function(t){t<=this.y?this.height=0:this.height=t-this.y}}),Object.defineProperty(U.Rectangle.prototype,"bottomLeft",{get:function(){return new U.Point(this.x,this.bottom)},set:function(t){this.x=t.x,this.bottom=t.y}}),Object.defineProperty(U.Rectangle.prototype,"bottomRight",{get:function(){return new U.Point(this.right,this.bottom)},set:function(t){this.right=t.x,this.bottom=t.y}}),Object.defineProperty(U.Rectangle.prototype,"left",{get:function(){return this.x},set:function(t){t>=this.right?this.width=0:this.width=this.right-t,this.x=t}}),Object.defineProperty(U.Rectangle.prototype,"right",{get:function(){return this.x+this.width},set:function(t){t<=this.x?this.width=0:this.width=t-this.x}}),Object.defineProperty(U.Rectangle.prototype,"volume",{get:function(){return this.width*this.height}}),Object.defineProperty(U.Rectangle.prototype,"perimeter",{get:function(){return 2*this.width+2*this.height}}),Object.defineProperty(U.Rectangle.prototype,"centerX",{get:function(){return this.x+this.halfWidth},set:function(t){this.x=t-this.halfWidth}}),Object.defineProperty(U.Rectangle.prototype,"centerY",{get:function(){return this.y+this.halfHeight},set:function(t){this.y=t-this.halfHeight}}),Object.defineProperty(U.Rectangle.prototype,"randomX",{get:function(){return this.x+Math.random()*this.width}}),Object.defineProperty(U.Rectangle.prototype,"randomY",{get:function(){return this.y+Math.random()*this.height}}),Object.defineProperty(U.Rectangle.prototype,"top",{get:function(){return this.y},set:function(t){t>=this.bottom?(this.height=0,this.y=t):this.height=this.bottom-t}}),Object.defineProperty(U.Rectangle.prototype,"topLeft",{get:function(){return new U.Point(this.x,this.y)},set:function(t){this.x=t.x,this.y=t.y}}),Object.defineProperty(U.Rectangle.prototype,"topRight",{get:function(){return new U.Point(this.x+this.width,this.y)},set:function(t){this.right=t.x,this.y=t.y}}),Object.defineProperty(U.Rectangle.prototype,"empty",{get:function(){return!this.width||!this.height},set:function(t){!0===t&&this.setTo(0,0,0,0)}}),U.Rectangle.prototype.constructor=U.Rectangle,U.Rectangle.inflate=function(t,e,i){return t.x-=e,t.width+=2*e,t.y-=i,t.height+=2*i,t},U.Rectangle.inflatePoint=function(t,e){return U.Rectangle.inflate(t,e.x,e.y)},U.Rectangle.size=function(t,e){return null==e?e=new U.Point(t.width,t.height):e.setTo(t.width,t.height),e},U.Rectangle.clone=function(t,e){return null==e?e=new U.Rectangle(t.x,t.y,t.width,t.height):e.setTo(t.x,t.y,t.width,t.height),e},U.Rectangle.contains=function(t,e,i){return!(t.width<=0||t.height<=0)&&(e>=t.x&&e<t.right&&i>=t.y&&i<t.bottom)},U.Rectangle.containsRaw=function(t,e,i,n,r,o){return t<=r&&r<t+i&&e<=o&&o<e+n},U.Rectangle.containsPoint=function(t,e){return U.Rectangle.contains(t,e.x,e.y)},U.Rectangle.containsRect=function(t,e){return!(t.volume>e.volume)&&(t.x>=e.x&&t.y>=e.y&&t.right<e.right&&t.bottom<e.bottom)},U.Rectangle.equals=function(t,e){return t.x===e.x&&t.y===e.y&&t.width===e.width&&t.height===e.height},U.Rectangle.sameDimensions=function(t,e){return t.width===e.width&&t.height===e.height},U.Rectangle.intersection=function(t,e,i){return void 0===i&&(i=new U.Rectangle),U.Rectangle.intersects(t,e)&&(i.x=Math.max(t.x,e.x),i.y=Math.max(t.y,e.y),i.width=Math.min(t.right,e.right)-i.x,i.height=Math.min(t.bottom,e.bottom)-i.y),i},U.Rectangle.intersects=function(t,e){return!(t.width<=0||t.height<=0||e.width<=0||e.height<=0)&&!(t.right<e.x||t.bottom<e.y||t.x>e.right||t.y>e.bottom)},U.Rectangle.intersectsRaw=function(t,e,i,n,r,o){return!(e>t.right+(o=void 0===o?0:o)||i<t.left-o||n>t.bottom+o||r<t.top-o)},U.Rectangle.union=function(t,e,i){return(i=void 0===i?new U.Rectangle:i).setTo(Math.min(t.x,e.x),Math.min(t.y,e.y),Math.max(t.right,e.right)-Math.min(t.left,e.left),Math.max(t.bottom,e.bottom)-Math.min(t.top,e.top))},U.Rectangle.aabb=function(t,e){void 0===e&&(e=new U.Rectangle);var i=Number.NEGATIVE_INFINITY,n=Number.POSITIVE_INFINITY,r=Number.NEGATIVE_INFINITY,o=Number.POSITIVE_INFINITY;return t.forEach(function(t){t.x>i&&(i=t.x),t.x<n&&(n=t.x),t.y>r&&(r=t.y),t.y<o&&(o=t.y)}),e.setTo(n,o,i-n,r-o),e},PIXI.Rectangle=U.Rectangle,PIXI.EmptyRectangle=new U.Rectangle(0,0,0,0),U.RoundedRectangle=function(t,e,i,n,r){void 0===e&&(e=0),void 0===i&&(i=0),void 0===n&&(n=0),void 0===r&&(r=20),this.x=t=void 0===t?0:t,this.y=e,this.width=i,this.height=n,this.radius=r||20,this.type=U.ROUNDEDRECTANGLE},U.RoundedRectangle.prototype={clone:function(){return new U.RoundedRectangle(this.x,this.y,this.width,this.height,this.radius)},contains:function(t,e){if(this.width<=0||this.height<=0)return!1;var i=this.x;if(i<=t&&t<=i+this.width){i=this.y;if(i<=e&&e<=i+this.height)return!0}return!1}},U.RoundedRectangle.prototype.constructor=U.RoundedRectangle,PIXI.RoundedRectangle=U.RoundedRectangle,U.Camera=function(t,e,i,n,r,o){this.game=t,this.world=t.world,this.id=0,this.view=new U.Rectangle(i,n,r,o),this.bounds=new U.Rectangle(i,n,r,o),this.deadzone=null,this.visible=!0,this.roundPx=!0,this.atLimit={x:!1,y:!1},this.target=null,this.displayObject=null,this.scale=null,this.totalInView=0,this.lerp=new U.Point(1,1),this.onShakeComplete=new U.Signal,this.onFlashComplete=new U.Signal,this.onFadeComplete=new U.Signal,this.fx=null,this._targetPosition=new U.Point,this._edge=0,this._position=new U.Point,this._shake={intensity:0,duration:0,horizontal:!1,vertical:!1,shakeBounds:!0,x:0,y:0},this._fxDuration=0,this._fxType=0},U.Camera.FOLLOW_LOCKON=0,U.Camera.FOLLOW_PLATFORMER=1,U.Camera.FOLLOW_TOPDOWN=2,U.Camera.FOLLOW_TOPDOWN_TIGHT=3,U.Camera.SHAKE_BOTH=4,U.Camera.SHAKE_HORIZONTAL=5,U.Camera.SHAKE_VERTICAL=6,U.Camera.ENABLE_FX=!0,U.Camera.prototype={boot:function(){this.displayObject=this.game.world,this.scale=this.game.world.scale,this.game.camera=this,U.Graphics&&U.Camera.ENABLE_FX&&(this.fx=new U.Graphics(this.game),this.game.stage.addChild(this.fx))},preUpdate:function(){this.totalInView=0},follow:function(t,e,i,n){var r;switch(void 0===e&&(e=U.Camera.FOLLOW_LOCKON),void 0===i&&(i=1),void 0===n&&(n=1),this.target=t,this.lerp.set(i,n),e){case U.Camera.FOLLOW_PLATFORMER:var o=this.width/8,s=this.height/3;this.deadzone=new U.Rectangle((this.width-o)/2,(this.height-s)/2-.25*s,o,s);break;case U.Camera.FOLLOW_TOPDOWN:r=Math.max(this.width,this.height)/4,this.deadzone=new U.Rectangle((this.width-r)/2,(this.height-r)/2,r,r);break;case U.Camera.FOLLOW_TOPDOWN_TIGHT:r=Math.max(this.width,this.height)/8,this.deadzone=new U.Rectangle((this.width-r)/2,(this.height-r)/2,r,r);break;default:U.Camera.FOLLOW_LOCKON;this.deadzone=null}},unfollow:function(){this.target=null},focusOn:function(t){this.setPosition(Math.round(t.x-this.view.halfWidth),Math.round(t.y-this.view.halfHeight))},focusOnXY:function(t,e){this.setPosition(Math.round(t-this.view.halfWidth),Math.round(e-this.view.halfHeight))},shake:function(t,e,i,n,r){return void 0===e&&(e=500),void 0===n&&(n=U.Camera.SHAKE_BOTH),void 0===r&&(r=!0),!(!(i=void 0===i||i)&&0<this._shake.duration)&&(this._shake.intensity=t=void 0===t?.05:t,this._shake.duration=e,this._shake.shakeBounds=r,this._shake.x=0,this._shake.y=0,this._shake.horizontal=n===U.Camera.SHAKE_BOTH||n===U.Camera.SHAKE_HORIZONTAL,this._shake.vertical=n===U.Camera.SHAKE_BOTH||n===U.Camera.SHAKE_VERTICAL,!0)},flash:function(t,e,i){return void 0===t&&(t=16777215),void 0===e&&(e=500),void 0===i&&(i=!1),!(!this.fx||!i&&0<this._fxDuration)&&(this.fx.clear(),this.fx.beginFill(t),this.fx.drawRect(0,0,this.width,this.height),this.fx.endFill(),this.fx.alpha=1,this._fxDuration=e,!(this._fxType=0))},fade:function(t,e,i){return void 0===t&&(t=0),void 0===e&&(e=500),void 0===i&&(i=!1),!(!this.fx||!i&&0<this._fxDuration)&&(this.fx.clear(),this.fx.beginFill(t),this.fx.drawRect(0,0,this.width,this.height),this.fx.endFill(),this.fx.alpha=0,this._fxDuration=e,this._fxType=1,!0)},update:function(){0<this._fxDuration&&this.updateFX(),0<this._shake.duration&&this.updateShake(),this.bounds&&this.checkBounds(),this.roundPx&&(this.view.floor(),this._shake.x=Math.floor(this._shake.x),this._shake.y=Math.floor(this._shake.y)),this.displayObject.position.x=-this.view.x,this.displayObject.position.y=-this.view.y},updateFX:function(){0===this._fxType?(this.fx.alpha-=this.game.time.elapsedMS/this._fxDuration,this.fx.alpha<=0&&(this._fxDuration=0,this.fx.alpha=0,this.onFlashComplete.dispatch())):(this.fx.alpha+=this.game.time.elapsedMS/this._fxDuration,1<=this.fx.alpha&&(this._fxDuration=0,this.fx.alpha=1,this.onFadeComplete.dispatch()))},updateShake:function(){this._shake.duration-=this.game.time.elapsedMS,this._shake.duration<=0?(this.onShakeComplete.dispatch(),this._shake.x=0,this._shake.y=0):(this._shake.horizontal&&(this._shake.x=this.game.rnd.frac()*this._shake.intensity*this.view.width*2-this._shake.intensity*this.view.width),this._shake.vertical&&(this._shake.y=this.game.rnd.frac()*this._shake.intensity*this.view.height*2-this._shake.intensity*this.view.height))},updateTarget:function(){this._targetPosition.x=this.view.x+this.target.worldPosition.x,this._targetPosition.y=this.view.y+this.target.worldPosition.y,this.deadzone?(this._edge=this._targetPosition.x-this.view.x,this._edge<this.deadzone.left?this.view.x=this.game.math.linear(this.view.x,this._targetPosition.x-this.deadzone.left,this.lerp.x):this._edge>this.deadzone.right&&(this.view.x=this.game.math.linear(this.view.x,this._targetPosition.x-this.deadzone.right,this.lerp.x)),this._edge=this._targetPosition.y-this.view.y,this._edge<this.deadzone.top?this.view.y=this.game.math.linear(this.view.y,this._targetPosition.y-this.deadzone.top,this.lerp.y):this._edge>this.deadzone.bottom&&(this.view.y=this.game.math.linear(this.view.y,this._targetPosition.y-this.deadzone.bottom,this.lerp.y))):(this.view.x=this.game.math.linear(this.view.x,this._targetPosition.x-this.view.halfWidth,this.lerp.x),this.view.y=this.game.math.linear(this.view.y,this._targetPosition.y-this.view.halfHeight,this.lerp.y)),this.bounds&&this.checkBounds(),this.roundPx&&this.view.floor(),this.displayObject.position.x=-this.view.x,this.displayObject.position.y=-this.view.y},setBoundsToWorld:function(){this.bounds&&this.bounds.copyFrom(this.game.world.bounds)},checkBounds:function(){this.atLimit.x=!1,this.atLimit.y=!1;var t=this.view.x+this._shake.x,e=this.view.right+this._shake.x,i=this.view.y+this._shake.y,n=this.view.bottom+this._shake.y;t<=this.bounds.x*this.scale.x&&(this.atLimit.x=!0,this.view.x=this.bounds.x*this.scale.x,this._shake.shakeBounds||(this._shake.x=0)),e>=this.bounds.right*this.scale.x&&(this.atLimit.x=!0,this.view.x=this.bounds.right*this.scale.x-this.width,this._shake.shakeBounds||(this._shake.x=0)),i<=this.bounds.top*this.scale.y&&(this.atLimit.y=!0,this.view.y=this.bounds.top*this.scale.y,this._shake.shakeBounds||(this._shake.y=0)),n>=this.bounds.bottom*this.scale.y&&(this.atLimit.y=!0,this.view.y=this.bounds.bottom*this.scale.y-this.height,this._shake.shakeBounds||(this._shake.y=0))},setPosition:function(t,e){this.view.x=t,this.view.y=e,this.bounds&&this.checkBounds()},setSize:function(t,e){this.view.width=t,this.view.height=e},reset:function(){this.target=null,this.view.x=0,this.view.y=0,this._shake.duration=0,this.resetFX()},resetFX:function(){this.fx.clear(),this.fx.alpha=0,this._fxDuration=0}},U.Camera.prototype.constructor=U.Camera,Object.defineProperty(U.Camera.prototype,"x",{get:function(){return this.view.x},set:function(t){this.view.x=t,this.bounds&&this.checkBounds()}}),Object.defineProperty(U.Camera.prototype,"y",{get:function(){return this.view.y},set:function(t){this.view.y=t,this.bounds&&this.checkBounds()}}),Object.defineProperty(U.Camera.prototype,"position",{get:function(){return this._position.set(this.view.x,this.view.y),this._position},set:function(t){void 0!==t.x&&(this.view.x=t.x),void 0!==t.y&&(this.view.y=t.y),this.bounds&&this.checkBounds()}}),Object.defineProperty(U.Camera.prototype,"width",{get:function(){return this.view.width},set:function(t){this.view.width=t}}),Object.defineProperty(U.Camera.prototype,"height",{get:function(){return this.view.height},set:function(t){this.view.height=t}}),Object.defineProperty(U.Camera.prototype,"shakeIntensity",{get:function(){return this._shake.intensity},set:function(t){this._shake.intensity=t}}),U.State=function(){this.game=null,this.key="",this.add=null,this.make=null,this.camera=null,this.cache=null,this.input=null,this.load=null,this.math=null,this.sound=null,this.scale=null,this.stage=null,this.state=null,this.time=null,this.tweens=null,this.world=null,this.particles=null,this.physics=null,this.rnd=null},U.State.prototype={init:function(){},preload:function(){},loadUpdate:function(){},loadRender:function(){},create:function(){},update:function(){},preRender:function(){},render:function(){},resize:function(){},paused:function(){},resumed:function(){},pauseUpdate:function(){},shutdown:function(){}},U.State.prototype.constructor=U.State,U.StateManager=function(t,e){this.game=t,this.states={},(this._pendingState=null)!=e&&(this._pendingState=e),this._clearWorld=!1,this._clearCache=!1,this._created=!1,this._args=[],this.current="",this.onStateChange=new U.Signal,this.onInitCallback=null,this.onPreloadCallback=null,this.onCreateCallback=null,this.onUpdateCallback=null,this.onRenderCallback=null,this.onResizeCallback=null,this.onPreRenderCallback=null,this.onLoadUpdateCallback=null,this.onLoadRenderCallback=null,this.onPausedCallback=null,this.onResumedCallback=null,this.onPauseUpdateCallback=null,this.onShutDownCallback=null},U.StateManager.prototype={boot:function(){this.game.onPause.add(this.pause,this),this.game.onResume.add(this.resume,this),null!==this._pendingState&&"string"!=typeof this._pendingState&&this.add("default",this._pendingState,!0)},add:function(t,e,i){var n;return void 0===i&&(i=!1),e instanceof U.State?n=e:"object"==typeof e?(n=e).game=this.game:"function"==typeof e&&(n=new e(this.game)),this.states[t]=n,i&&(this.game.isBooted?this.start(t):this._pendingState=t),n},remove:function(t){this.current===t&&(this.callbackContext=null,this.onInitCallback=null,this.onShutDownCallback=null,this.onPreloadCallback=null,this.onLoadRenderCallback=null,this.onLoadUpdateCallback=null,this.onCreateCallback=null,this.onUpdateCallback=null,this.onPreRenderCallback=null,this.onRenderCallback=null,this.onResizeCallback=null,this.onPausedCallback=null,this.onResumedCallback=null,this.onPauseUpdateCallback=null),delete this.states[t]},start:function(t,e,i){void 0===e&&(e=!0),void 0===i&&(i=!1),this.checkState(t)&&(this._pendingState=t,this._clearWorld=e,this._clearCache=i,3<arguments.length&&(this._args=Array.prototype.splice.call(arguments,3)))},restart:function(t,e){void 0===t&&(t=!0),void 0===e&&(e=!1),this._pendingState=this.current,this._clearWorld=t,this._clearCache=e,2<arguments.length&&(this._args=Array.prototype.slice.call(arguments,2))},dummy:function(){},preUpdate:function(){var t;this._pendingState&&this.game.isBooted&&(t=this.current,this.clearCurrentState(),this.setCurrentState(this._pendingState),this.onStateChange.dispatch(this.current,t),this.current===this._pendingState&&(this._pendingState=null,this.onPreloadCallback?(this.game.load.reset(!0),this.onPreloadCallback.call(this.callbackContext,this.game),0===this.game.load.totalQueuedFiles()&&0===this.game.load.totalQueuedPacks()?this.loadComplete():this.game.load.start()):this.loadComplete()))},clearCurrentState:function(){this.current&&(this.onShutDownCallback&&this.onShutDownCallback.call(this.callbackContext,this.game),this.game.tweens.removeAll(),this.game.camera.reset(),this.game.input.reset(!0),this.game.physics.clear(),this.game.time.removeAll(),this.game.scale.reset(this._clearWorld),this.game.debug&&this.game.debug.reset(),this._clearWorld&&(this.game.world.shutdown(),this._clearCache&&this.game.cache.destroy()))},checkState:function(t){return!!this.states[t]&&!!(this.states[t].preload||this.states[t].create||this.states[t].update||this.states[t].render)},link:function(t){this.states[t].game=this.game,this.states[t].add=this.game.add,this.states[t].make=this.game.make,this.states[t].camera=this.game.camera,this.states[t].cache=this.game.cache,this.states[t].input=this.game.input,this.states[t].load=this.game.load,this.states[t].math=this.game.math,this.states[t].sound=this.game.sound,this.states[t].scale=this.game.scale,(this.states[t].state=this).states[t].stage=this.game.stage,this.states[t].time=this.game.time,this.states[t].tweens=this.game.tweens,this.states[t].world=this.game.world,this.states[t].particles=this.game.particles,this.states[t].rnd=this.game.rnd,this.states[t].physics=this.game.physics,this.states[t].key=t},unlink:function(t){this.states[t]&&(this.states[t].game=null,this.states[t].add=null,this.states[t].make=null,this.states[t].camera=null,this.states[t].cache=null,this.states[t].input=null,this.states[t].load=null,this.states[t].math=null,this.states[t].sound=null,this.states[t].scale=null,this.states[t].state=null,this.states[t].stage=null,this.states[t].time=null,this.states[t].tweens=null,this.states[t].world=null,this.states[t].particles=null,this.states[t].rnd=null,this.states[t].physics=null)},setCurrentState:function(t){this.callbackContext=this.states[t],this.link(t),this.onInitCallback=this.states[t].init||this.dummy,this.onPreloadCallback=this.states[t].preload||null,this.onLoadRenderCallback=this.states[t].loadRender||null,this.onLoadUpdateCallback=this.states[t].loadUpdate||null,this.onCreateCallback=this.states[t].create||null,this.onUpdateCallback=this.states[t].update||null,this.onPreRenderCallback=this.states[t].preRender||null,this.onRenderCallback=this.states[t].render||null,this.onResizeCallback=this.states[t].resize||null,this.onPausedCallback=this.states[t].paused||null,this.onResumedCallback=this.states[t].resumed||null,this.onPauseUpdateCallback=this.states[t].pauseUpdate||null,this.onShutDownCallback=this.states[t].shutdown||this.dummy,""!==this.current&&this.game.physics.reset(),this.current=t,this._created=!1,this.onInitCallback.apply(this.callbackContext,this._args),t===this._pendingState&&(this._args=[]),this.game._kickstart=!0},getCurrentState:function(){return this.states[this.current]},loadComplete:function(){!1===this._created&&this.onLoadUpdateCallback&&this.onLoadUpdateCallback.call(this.callbackContext,this.game),!1===this._created&&this.onCreateCallback?(this._created=!0,this.onCreateCallback.call(this.callbackContext,this.game)):this._created=!0},pause:function(){this._created&&this.onPausedCallback&&this.onPausedCallback.call(this.callbackContext,this.game)},resume:function(){this._created&&this.onResumedCallback&&this.onResumedCallback.call(this.callbackContext,this.game)},update:function(){this._created?this.onUpdateCallback&&this.onUpdateCallback.call(this.callbackContext,this.game):this.onLoadUpdateCallback&&this.onLoadUpdateCallback.call(this.callbackContext,this.game)},pauseUpdate:function(){this._created?this.onPauseUpdateCallback&&this.onPauseUpdateCallback.call(this.callbackContext,this.game):this.onLoadUpdateCallback&&this.onLoadUpdateCallback.call(this.callbackContext,this.game)},preRender:function(t){this._created&&this.onPreRenderCallback&&this.onPreRenderCallback.call(this.callbackContext,this.game,t)},resize:function(t,e){this.onResizeCallback&&this.onResizeCallback.call(this.callbackContext,t,e)},render:function(){this._created?this.onRenderCallback&&(this.game.renderType===U.CANVAS?(this.game.context.save(),this.game.context.setTransform(1,0,0,1,0,0),this.onRenderCallback.call(this.callbackContext,this.game),this.game.context.restore()):this.onRenderCallback.call(this.callbackContext,this.game)):this.onLoadRenderCallback&&this.onLoadRenderCallback.call(this.callbackContext,this.game)},destroy:function(){this._clearWorld=!0,this._clearCache=!0,this.clearCurrentState(),this.callbackContext=null,this.onInitCallback=null,this.onShutDownCallback=null,this.onPreloadCallback=null,this.onLoadRenderCallback=null,this.onLoadUpdateCallback=null,this.onCreateCallback=null,this.onUpdateCallback=null,this.onRenderCallback=null,this.onPausedCallback=null,this.onResumedCallback=null,this.onPauseUpdateCallback=null,this.game=null,this.states={},this._pendingState=null,this.current=""}},U.StateManager.prototype.constructor=U.StateManager,Object.defineProperty(U.StateManager.prototype,"created",{get:function(){return this._created}}),U.Signal=function(){},U.Signal.prototype={_bindings:null,_prevParams:null,memorize:!1,_shouldPropagate:!0,active:!0,_boundDispatch:!1,validateListener:function(t,e){if("function"!=typeof t)throw new Error("Phaser.Signal: listener is a required param of {fn}() and should be a Function.".replace("{fn}",e))},_registerListener:function(t,e,i,n,r){var o,s=this._indexOfListener(t,i);if(-1!==s){if((o=this._bindings[s]).isOnce()!==e)throw new Error("You cannot add"+(e?"":"Once")+"() then add"+(e?"Once":"")+"() the same listener without removing the relationship first.")}else o=new U.SignalBinding(this,t,e,i,n,r),this._addBinding(o);return this.memorize&&this._prevParams&&o.execute(this._prevParams),o},_addBinding:function(t){this._bindings||(this._bindings=[]);for(var e=this._bindings.length;this._bindings[--e]&&t._priority<=this._bindings[e]._priority;);this._bindings.splice(e+1,0,t)},_indexOfListener:function(t,e){if(!this._bindings)return-1;void 0===e&&(e=null);for(var i,n=this._bindings.length;n--;)if((i=this._bindings[n])._listener===t&&i.context===e)return n;return-1},has:function(t,e){return-1!==this._indexOfListener(t,e)},add:function(t,e,i){this.validateListener(t,"add");var n=[];if(3<arguments.length)for(var r=3;r<arguments.length;r++)n.push(arguments[r]);return this._registerListener(t,!1,e,i,n)},addOnce:function(t,e,i){this.validateListener(t,"addOnce");var n=[];if(3<arguments.length)for(var r=3;r<arguments.length;r++)n.push(arguments[r]);return this._registerListener(t,!0,e,i,n)},remove:function(t,e){this.validateListener(t,"remove");e=this._indexOfListener(t,e);return-1!==e&&(this._bindings[e]._destroy(),this._bindings.splice(e,1)),t},removeAll:function(t){if(void 0===t&&(t=null),this._bindings){for(var e=this._bindings.length;e--;)t?this._bindings[e].context===t&&(this._bindings[e]._destroy(),this._bindings.splice(e,1)):this._bindings[e]._destroy();t||(this._bindings.length=0)}},getNumListeners:function(){return this._bindings?this._bindings.length:0},halt:function(){this._shouldPropagate=!1},dispatch:function(){if(this.active&&this._bindings){var t,e=Array.prototype.slice.call(arguments),i=this._bindings.length;if(this.memorize&&(this._prevParams=e),i)for(t=this._bindings.slice(),this._shouldPropagate=!0;t[--i]&&this._shouldPropagate&&!1!==t[i].execute(e););}},forget:function(){this._prevParams&&(this._prevParams=null)},dispose:function(){this.removeAll(),this._bindings=null,this._prevParams&&(this._prevParams=null)},toString:function(){return"[Phaser.Signal active:"+this.active+" numListeners:"+this.getNumListeners()+"]"}},Object.defineProperty(U.Signal.prototype,"boundDispatch",{get:function(){var t=this;return this._boundDispatch||(this._boundDispatch=function(){return t.dispatch.apply(t,arguments)})}}),U.Signal.prototype.constructor=U.Signal,U.SignalBinding=function(t,e,i,n,r,o){this._listener=e,i&&(this._isOnce=!0),null!=n&&(this.context=n),this._signal=t,r&&(this._priority=r),o&&o.length&&(this._args=o)},U.SignalBinding.prototype={context:null,_isOnce:!1,_priority:0,_args:null,callCount:0,active:!0,params:null,execute:function(t){var e;return this.active&&this._listener&&(e=this.params?this.params.concat(t):t,this._args&&(e=e.concat(this._args)),e=this._listener.apply(this.context,e),this.callCount++,this._isOnce&&this.detach()),e},detach:function(){return this.isBound()?this._signal.remove(this._listener,this.context):null},isBound:function(){return!!this._signal&&!!this._listener},isOnce:function(){return this._isOnce},getListener:function(){return this._listener},getSignal:function(){return this._signal},_destroy:function(){delete this._signal,delete this._listener,delete this.context},toString:function(){return"[Phaser.SignalBinding isOnce:"+this._isOnce+", isBound:"+this.isBound()+", active:"+this.active+"]"}},U.SignalBinding.prototype.constructor=U.SignalBinding,U.Filter=function(t,e,i){this.game=t,this.type=U.WEBGL_FILTER,this.passes=[this],this.shaders=[],this.dirty=!0,this.padding=0,this.prevPoint=new U.Point;t=new Date;if(this.uniforms={resolution:{type:"2f",value:{x:256,y:256}},time:{type:"1f",value:0},mouse:{type:"2f",value:{x:0,y:0}},date:{type:"4fv",value:[t.getFullYear(),t.getMonth(),t.getDate(),60*t.getHours()*60+60*t.getMinutes()+t.getSeconds()]},sampleRate:{type:"1f",value:44100},iChannel0:{type:"sampler2D",value:null,textureData:{repeat:!0}},iChannel1:{type:"sampler2D",value:null,textureData:{repeat:!0}},iChannel2:{type:"sampler2D",value:null,textureData:{repeat:!0}},iChannel3:{type:"sampler2D",value:null,textureData:{repeat:!0}}},e)for(var n in e)this.uniforms[n]=e[n];this.fragmentSrc=i||""},U.Filter.prototype={init:function(){},setResolution:function(t,e){this.uniforms.resolution.value.x=t,this.uniforms.resolution.value.y=e},update:function(t){var e;void 0!==t&&(e=t.x/this.game.width,t=1-t.y/this.game.height,e===this.prevPoint.x&&t===this.prevPoint.y||(this.uniforms.mouse.value.x=e.toFixed(2),this.uniforms.mouse.value.y=t.toFixed(2),this.prevPoint.set(e,t))),this.uniforms.time.value=this.game.time.totalElapsedSeconds()},addToWorld:function(t,e,i,n,r,o){void 0===r&&(r=0),void 0===o&&(o=0),null!=i?this.width=i:i=this.width,null!=n?this.height=n:n=this.height;e=this.game.add.image(t,e,"__default");return e.width=i,e.height=n,e.anchor.set(r,o),e.filters=[this],e},destroy:function(){this.game=null}},U.Filter.prototype.constructor=U.Filter,Object.defineProperty(U.Filter.prototype,"width",{get:function(){return this.uniforms.resolution.value.x},set:function(t){this.uniforms.resolution.value.x=t}}),Object.defineProperty(U.Filter.prototype,"height",{get:function(){return this.uniforms.resolution.value.y},set:function(t){this.uniforms.resolution.value.y=t}}),U.Plugin=function(t,e){void 0===e&&(e=null),this.game=t,this.parent=e,this.active=!1,this.visible=!1,this.hasPreUpdate=!1,this.hasUpdate=!1,this.hasPostUpdate=!1,this.hasRender=!1,this.hasPostRender=!1},U.Plugin.prototype={preUpdate:function(){},update:function(){},render:function(){},postRender:function(){},destroy:function(){this.game=null,this.parent=null,this.active=!1,this.visible=!1}},U.Plugin.prototype.constructor=U.Plugin,U.PluginManager=function(t){this.game=t,this.plugins=[],this._len=0,this._i=0},U.PluginManager.prototype={add:function(t){var e=Array.prototype.slice.call(arguments,1),i=!1;return"function"==typeof t?t=new t(this.game,this):(t.game=this.game,t.parent=this),"function"==typeof t.preUpdate&&(i=t.hasPreUpdate=!0),"function"==typeof t.update&&(i=t.hasUpdate=!0),"function"==typeof t.postUpdate&&(i=t.hasPostUpdate=!0),"function"==typeof t.render&&(i=t.hasRender=!0),(i="function"==typeof t.postRender?t.hasPostRender=!0:i)?((t.hasPreUpdate||t.hasUpdate||t.hasPostUpdate)&&(t.active=!0),(t.hasRender||t.hasPostRender)&&(t.visible=!0),this._len=this.plugins.push(t),"function"==typeof t.init&&t.init.apply(t,e),t):null},remove:function(t,e){for(void 0===e&&(e=!0),this._i=this._len;this._i--;)if(this.plugins[this._i]===t)return e&&t.destroy(),this.plugins.splice(this._i,1),void this._len--},removeAll:function(){for(this._i=this._len;this._i--;)this.plugins[this._i].destroy();this.plugins.length=0,this._len=0},preUpdate:function(){for(this._i=this._len;this._i--;)this.plugins[this._i].active&&this.plugins[this._i].hasPreUpdate&&this.plugins[this._i].preUpdate()},update:function(){for(this._i=this._len;this._i--;)this.plugins[this._i].active&&this.plugins[this._i].hasUpdate&&this.plugins[this._i].update()},postUpdate:function(){for(this._i=this._len;this._i--;)this.plugins[this._i].active&&this.plugins[this._i].hasPostUpdate&&this.plugins[this._i].postUpdate()},render:function(){for(this._i=this._len;this._i--;)this.plugins[this._i].visible&&this.plugins[this._i].hasRender&&this.plugins[this._i].render()},postRender:function(){for(this._i=this._len;this._i--;)this.plugins[this._i].visible&&this.plugins[this._i].hasPostRender&&this.plugins[this._i].postRender()},destroy:function(){this.removeAll(),this.game=null}},U.PluginManager.prototype.constructor=U.PluginManager,U.Stage=function(t){this.game=t,PIXI.DisplayObjectContainer.call(this),this.name="_stage_root",this.disableVisibilityChange=!1,this.exists=!0,this.worldTransform=new PIXI.Matrix,(this.stage=this).currentRenderOrderID=0,this._hiddenVar="hidden",this._onChange=null,this._bgColor={r:0,g:0,b:0,a:0,color:0,rgba:"#000000"},this.game.transparent||(this._bgColor.a=1),t.config&&this.parseConfig(t.config)},U.Stage.prototype=Object.create(PIXI.DisplayObjectContainer.prototype),U.Stage.prototype.constructor=U.Stage,U.Stage.prototype.parseConfig=function(t){t.disableVisibilityChange&&(this.disableVisibilityChange=t.disableVisibilityChange),t.backgroundColor&&this.setBackgroundColor(t.backgroundColor)},U.Stage.prototype.boot=function(){U.DOM.getOffset(this.game.canvas,this.offset),U.Canvas.setUserSelect(this.game.canvas,"none"),U.Canvas.setTouchAction(this.game.canvas,"none"),this.checkVisibility()},U.Stage.prototype.preUpdate=function(){for(var t=this.currentRenderOrderID=0;t<this.children.length;t++)this.children[t].preUpdate()},U.Stage.prototype.update=function(){for(var t=this.children.length;t--;)this.children[t].update()},U.Stage.prototype.postUpdate=function(){this.game.camera.update(),this.game.camera.target&&(this.game.camera.target.postUpdate(),this.updateTransform(),this.game.camera.updateTarget());for(var t=0;t<this.children.length;t++)this.children[t].postUpdate();this.updateTransform()},U.Stage.prototype.updateTransform=function(){this.worldAlpha=1;for(var t=0;t<this.children.length;t++)this.children[t].updateTransform()},U.Stage.prototype.checkVisibility=function(){void 0!==document.hidden?this._hiddenVar="visibilitychange":void 0!==document.webkitHidden?this._hiddenVar="webkitvisibilitychange":void 0!==document.mozHidden?this._hiddenVar="mozvisibilitychange":void 0!==document.msHidden?this._hiddenVar="msvisibilitychange":this._hiddenVar=null;var e=this;this._onChange=function(t){return e.visibilityChange(t)},this._hiddenVar&&document.addEventListener(this._hiddenVar,this._onChange,!1),window.onblur=this._onChange,window.onfocus=this._onChange,window.onpagehide=this._onChange,window.onpageshow=this._onChange,this.game.device.cocoonJSApp&&(CocoonJS.App.onSuspended.addEventListener(function(){U.Stage.prototype.visibilityChange.call(e,{type:"pause"})}),CocoonJS.App.onActivated.addEventListener(function(){U.Stage.prototype.visibilityChange.call(e,{type:"resume"})}))},U.Stage.prototype.visibilityChange=function(t){"pagehide"!==t.type&&"blur"!==t.type&&"pageshow"!==t.type&&"focus"!==t.type?this.disableVisibilityChange||(document.hidden||document.mozHidden||document.msHidden||document.webkitHidden||"pause"===t.type?this.game.gamePaused(t):this.game.gameResumed(t)):"pagehide"===t.type||"blur"===t.type?this.game.focusLoss(t):"pageshow"!==t.type&&"focus"!==t.type||this.game.focusGain(t)},U.Stage.prototype.setBackgroundColor=function(t){this.game.transparent||(U.Color.valueToColor(t,this._bgColor),U.Color.updateColor(this._bgColor),this._bgColor.r/=255,this._bgColor.g/=255,this._bgColor.b/=255,this._bgColor.a=1)},U.Stage.prototype.destroy=function(){this._hiddenVar&&document.removeEventListener(this._hiddenVar,this._onChange,!1),window.onpagehide=null,window.onpageshow=null,window.onblur=null,window.onfocus=null},Object.defineProperty(U.Stage.prototype,"backgroundColor",{get:function(){return this._bgColor.color},set:function(t){this.setBackgroundColor(t)}}),Object.defineProperty(U.Stage.prototype,"smoothed",{get:function(){return PIXI.scaleModes.DEFAULT===PIXI.scaleModes.LINEAR},set:function(t){PIXI.scaleModes.DEFAULT=t?PIXI.scaleModes.LINEAR:PIXI.scaleModes.NEAREST}}),U.Group=function(t,e,i,n,r,o){void 0===n&&(n=!1),void 0===r&&(r=!1),void 0===o&&(o=U.Physics.ARCADE),this.game=t,void 0===e&&(e=t.world),this.name=i||"group",this.z=0,PIXI.DisplayObjectContainer.call(this),n?(this.game.stage.addChild(this),this.z=this.game.stage.children.length):e&&(e.addChild(this),this.z=e.children.length),this.type=U.GROUP,this.physicsType=U.GROUP,this.alive=!0,this.exists=!0,this.ignoreDestroy=!1,this.pendingDestroy=!1,this.classType=U.Sprite,this.cursor=null,this.inputEnableChildren=!1,this.onChildInputDown=new U.Signal,this.onChildInputUp=new U.Signal,this.onChildInputOver=new U.Signal,this.onChildInputOut=new U.Signal,this.enableBody=r,this.enableBodyDebug=!1,this.physicsBodyType=o,this.physicsSortDirection=null,this.onDestroy=new U.Signal,this.cursorIndex=0,this.fixedToCamera=!1,this.cameraOffset=new U.Point,this.hash=[],this._sortProperty="z"},U.Group.prototype=Object.create(PIXI.DisplayObjectContainer.prototype),U.Group.prototype.constructor=U.Group,U.Group.RETURN_NONE=0,U.Group.RETURN_TOTAL=1,U.Group.RETURN_CHILD=2,U.Group.RETURN_ALL=3,U.Group.SORT_ASCENDING=-1,U.Group.SORT_DESCENDING=1,U.Group.prototype.add=function(t,e,i){return void 0===e&&(e=!1),t.parent===this||(t.body&&t.parent&&t.parent.hash&&t.parent.removeFromHash(t),void 0===i?(t.z=this.children.length,this.addChild(t)):(this.addChildAt(t,i),this.updateZ()),this.enableBody&&t.hasOwnProperty("body")&&null===t.body?this.game.physics.enable(t,this.physicsBodyType):t.body&&this.addToHash(t),!this.inputEnableChildren||t.input&&!t.inputEnabled||(t.inputEnabled=!0),!e&&t.events&&t.events.onAddedToGroup$dispatch(t,this),null===this.cursor&&(this.cursor=t)),t},U.Group.prototype.addAt=function(t,e,i){this.add(t,i,e)},U.Group.prototype.addToHash=function(t){if(t.parent===this&&-1===this.hash.indexOf(t))return this.hash.push(t),!0;return!1},U.Group.prototype.removeFromHash=function(t){if(t){t=this.hash.indexOf(t);if(-1!==t)return this.hash.splice(t,1),!0}return!1},U.Group.prototype.addMultiple=function(t,e){if(t instanceof U.Group)t.moveAll(this,e);else if(Array.isArray(t))for(var i=0;i<t.length;i++)this.add(t[i],e);return t},U.Group.prototype.getAt=function(t){return t<0||t>=this.children.length?-1:this.getChildAt(t)},U.Group.prototype.create=function(t,e,i,n,r,o){void 0===r&&(r=!0);n=new this.classType(this.game,t,e,i,n);return n.exists=r,n.visible=r,n.alive=r,this.add(n,!1,o)},U.Group.prototype.createMultiple=function(n,t,e,r){void 0===e&&(e=0),void 0===r&&(r=!1),Array.isArray(t)||(t=[t]),Array.isArray(e)||(e=[e]);var o=this,s=[];return t.forEach(function(i){e.forEach(function(t){for(var e=0;e<n;e++)s.push(o.create(0,0,i,t,r))})}),s},U.Group.prototype.updateZ=function(){for(var t=this.children.length;t--;)this.children[t].z=t},U.Group.prototype.align=function(t,e,i,n,r,o){if(void 0===r&&(r=U.TOP_LEFT),void 0===o&&(o=0),0===this.children.length||o>this.children.length||-1===t&&-1===e)return!1;for(var s=new U.Rectangle(0,0,i,n),a=t*i,h=e*n,l=o;l<this.children.length;l++){var p=this.children[l];if(p.alignIn)if(p.alignIn(s,r),-1===t)s.y+=n,s.y===h&&(s.x+=i,s.y=0);else if(-1===e)s.x+=i,s.x===a&&(s.x=0,s.y+=n);else if(s.x+=i,s.x===a&&(s.x=0,s.y+=n,s.y===h))return!0}return!0},U.Group.prototype.resetCursor=function(t){if((t=void 0===t?0:t)>this.children.length-1&&(t=0),this.cursor)return this.cursorIndex=t,this.cursor=this.children[this.cursorIndex],this.cursor},U.Group.prototype.next=function(){if(this.cursor)return this.cursorIndex>=this.children.length-1?this.cursorIndex=0:this.cursorIndex++,this.cursor=this.children[this.cursorIndex],this.cursor},U.Group.prototype.previous=function(){if(this.cursor)return 0===this.cursorIndex?this.cursorIndex=this.children.length-1:this.cursorIndex--,this.cursor=this.children[this.cursorIndex],this.cursor},U.Group.prototype.swap=function(t,e){this.swapChildren(t,e),this.updateZ()},U.Group.prototype.bringToTop=function(t){return t.parent===this&&this.getIndex(t)<this.children.length&&(this.remove(t,!1,!0),this.add(t,!0)),t},U.Group.prototype.sendToBack=function(t){return t.parent===this&&0<this.getIndex(t)&&(this.remove(t,!1,!0),this.addAt(t,0,!0)),t},U.Group.prototype.moveUp=function(t){var e;return t.parent===this&&this.getIndex(t)<this.children.length-1&&(e=this.getIndex(t),(e=this.getAt(e+1))&&this.swap(t,e)),t},U.Group.prototype.moveDown=function(t){var e;return t.parent===this&&0<this.getIndex(t)&&(e=this.getIndex(t),(e=this.getAt(e-1))&&this.swap(t,e)),t},U.Group.prototype.xy=function(t,e,i){if(t<0||t>this.children.length)return-1;this.getChildAt(t).x=e,this.getChildAt(t).y=i},U.Group.prototype.reverse=function(){this.children.reverse(),this.updateZ()},U.Group.prototype.getIndex=function(t){return this.children.indexOf(t)},U.Group.prototype.getByName=function(t){for(var e=0;e<this.children.length;e++)if(this.children[e].name===t)return this.children[e];return null},U.Group.prototype.replace=function(t,e){var i=this.getIndex(t);if(-1!==i)return e.parent&&(e.parent instanceof U.Group?e.parent.remove(e):e.parent.removeChild(e)),this.remove(t),this.addAt(e,i),t},U.Group.prototype.hasProperty=function(t,e){var i=e.length;return 1===i&&e[0]in t||(2===i&&e[0]in t&&e[1]in t[e[0]]||(3===i&&e[0]in t&&e[1]in t[e[0]]&&e[2]in t[e[0]][e[1]]||4===i&&e[0]in t&&e[1]in t[e[0]]&&e[2]in t[e[0]][e[1]]&&e[3]in t[e[0]][e[1]][e[2]]))},U.Group.prototype.setProperty=function(t,e,i,n,r){if(void 0===r&&(r=!1),n=n||0,!this.hasProperty(t,e)&&(!r||0<n))return!1;r=e.length;return 1===r?0===n?t[e[0]]=i:1===n?t[e[0]]+=i:2===n?t[e[0]]-=i:3===n?t[e[0]]*=i:4===n&&(t[e[0]]/=i):2===r?0===n?t[e[0]][e[1]]=i:1===n?t[e[0]][e[1]]+=i:2===n?t[e[0]][e[1]]-=i:3===n?t[e[0]][e[1]]*=i:4===n&&(t[e[0]][e[1]]/=i):3===r?0===n?t[e[0]][e[1]][e[2]]=i:1===n?t[e[0]][e[1]][e[2]]+=i:2===n?t[e[0]][e[1]][e[2]]-=i:3===n?t[e[0]][e[1]][e[2]]*=i:4===n&&(t[e[0]][e[1]][e[2]]/=i):4===r&&(0===n?t[e[0]][e[1]][e[2]][e[3]]=i:1===n?t[e[0]][e[1]][e[2]][e[3]]+=i:2===n?t[e[0]][e[1]][e[2]][e[3]]-=i:3===n?t[e[0]][e[1]][e[2]][e[3]]*=i:4===n&&(t[e[0]][e[1]][e[2]][e[3]]/=i)),!0},U.Group.prototype.checkProperty=function(t,e,i,n){return void 0===n&&(n=!1),!(!U.Utils.getProperty(t,e)&&n)&&U.Utils.getProperty(t,e)===i},U.Group.prototype.set=function(t,e,i,n,r,o,s){if(void 0===s&&(s=!1),e=e.split("."),void 0===r&&(r=!1),(!1===(n=void 0===n?!1:n)||n&&t.alive)&&(!1===r||r&&t.visible))return this.setProperty(t,e,i,o,s)},U.Group.prototype.setAll=function(t,e,i,n,r,o){void 0===i&&(i=!1),void 0===n&&(n=!1),void 0===o&&(o=!1),t=t.split("."),r=r||0;for(var s=0;s<this.children.length;s++)i&&!this.children[s].alive||n&&!this.children[s].visible||this.setProperty(this.children[s],t,e,r,o)},U.Group.prototype.setAllChildren=function(t,e,i,n,r,o){void 0===i&&(i=!1),void 0===n&&(n=!1),void 0===o&&(o=!1),r=r||0;for(var s=0;s<this.children.length;s++)i&&!this.children[s].alive||n&&!this.children[s].visible||(this.children[s]instanceof U.Group?this.children[s].setAllChildren(t,e,i,n,r,o):this.setProperty(this.children[s],t.split("."),e,r,o))},U.Group.prototype.checkAll=function(t,e,i,n,r){void 0===i&&(i=!1),void 0===n&&(n=!1),void 0===r&&(r=!1);for(var o=0;o<this.children.length;o++)if((!i||this.children[o].alive)&&(!n||this.children[o].visible)&&!this.checkProperty(this.children[o],t,e,r))return!1;return!0},U.Group.prototype.addAll=function(t,e,i,n){this.setAll(t,e,i,n,1)},U.Group.prototype.subAll=function(t,e,i,n){this.setAll(t,e,i,n,2)},U.Group.prototype.multiplyAll=function(t,e,i,n){this.setAll(t,e,i,n,3)},U.Group.prototype.divideAll=function(t,e,i,n){this.setAll(t,e,i,n,4)},U.Group.prototype.callAllExists=function(t,e){if(2<arguments.length)for(var i=[],n=2;n<arguments.length;n++)i.push(arguments[n]);for(n=0;n<this.children.length;n++)this.children[n].exists===e&&this.children[n][t]&&this.children[n][t].apply(this.children[n],i)},U.Group.prototype.callbackFromArray=function(t,e,i){if(1===i){if(t[e[0]])return t[e[0]]}else if(2===i){if(t[e[0]][e[1]])return t[e[0]][e[1]]}else if(3===i){if(t[e[0]][e[1]][e[2]])return t[e[0]][e[1]][e[2]]}else if(4===i){if(t[e[0]][e[1]][e[2]][e[3]])return t[e[0]][e[1]][e[2]][e[3]]}else if(t[e])return t[e];return!1},U.Group.prototype.callAll=function(t,e){if(void 0!==t){var i,n=(t=t.split(".")).length;if(null==e||""===e?e=null:"string"==typeof e&&(i=(e=e.split(".")).length),2<arguments.length)for(var r=[],o=2;o<arguments.length;o++)r.push(arguments[o]);for(var s,a=null,o=0;o<this.children.length;o++)a=this.callbackFromArray(this.children[o],t,n),e&&a?(s=this.callbackFromArray(this.children[o],e,i),a&&a.apply(s,r)):a&&a.apply(this.children[o],r)}},U.Group.prototype.preUpdate=function(){if(this.pendingDestroy)return this.destroy(),!1;if(!this.exists||!this.parent.exists)return!(this.renderOrderID=-1);for(var t=0;t<this.children.length;t++)this.children[t].preUpdate();return!0},U.Group.prototype.update=function(){for(var t=this.children.length;t--;)this.children[t].update()},U.Group.prototype.postUpdate=function(){this.fixedToCamera&&(this.x=this.game.camera.view.x+this.cameraOffset.x,this.y=this.game.camera.view.y+this.cameraOffset.y);for(var t=0;t<this.children.length;t++)this.children[t].postUpdate()},U.Group.prototype.filter=function(t,e){for(var i=-1,n=this.children.length,r=[];++i<n;){var o=this.children[i];e&&!o.exists||t(o,i,this.children)&&r.push(o)}return new U.ArraySet(r)},U.Group.prototype.forEach=function(t,e,i){if(void 0===i&&(i=!1),arguments.length<=3)for(var n=0;n<this.children.length;n++)i&&!this.children[n].exists||t.call(e,this.children[n]);else{for(var r=[null],n=3;n<arguments.length;n++)r.push(arguments[n]);for(n=0;n<this.children.length;n++)i&&!this.children[n].exists||(r[0]=this.children[n],t.apply(e,r))}},U.Group.prototype.forEachExists=function(t,e){if(2<arguments.length)for(var i=[null],n=2;n<arguments.length;n++)i.push(arguments[n]);this.iterate("exists",!0,U.Group.RETURN_TOTAL,t,e,i)},U.Group.prototype.forEachAlive=function(t,e){if(2<arguments.length)for(var i=[null],n=2;n<arguments.length;n++)i.push(arguments[n]);this.iterate("alive",!0,U.Group.RETURN_TOTAL,t,e,i)},U.Group.prototype.forEachDead=function(t,e){if(2<arguments.length)for(var i=[null],n=2;n<arguments.length;n++)i.push(arguments[n]);this.iterate("alive",!1,U.Group.RETURN_TOTAL,t,e,i)},U.Group.prototype.sort=function(t,e){this.children.length<2||(void 0===e&&(e=U.Group.SORT_ASCENDING),this._sortProperty=t=void 0===t?"z":t,e===U.Group.SORT_ASCENDING?this.children.sort(this.ascendingSortHandler.bind(this)):this.children.sort(this.descendingSortHandler.bind(this)),this.updateZ())},U.Group.prototype.customSort=function(t,e){this.children.length<2||(this.children.sort(t.bind(e)),this.updateZ())},U.Group.prototype.ascendingSortHandler=function(t,e){return t[this._sortProperty]<e[this._sortProperty]||!(t[this._sortProperty]>e[this._sortProperty])&&t.z<e.z?-1:1},U.Group.prototype.descendingSortHandler=function(t,e){return t[this._sortProperty]<e[this._sortProperty]?1:t[this._sortProperty]>e[this._sortProperty]?-1:0},U.Group.prototype.iterate=function(t,e,i,n,r,o){if(0===this.children.length){if(i===U.Group.RETURN_TOTAL)return 0;if(i===U.Group.RETURN_ALL)return[]}var s,a=0;i===U.Group.RETURN_ALL&&(s=[]);for(var h=0;h<this.children.length;h++)if(this.children[h][t]===e){if(a++,n&&(o?(o[0]=this.children[h],n.apply(r,o)):n.call(r,this.children[h])),i===U.Group.RETURN_CHILD)return this.children[h];i===U.Group.RETURN_ALL&&s.push(this.children[h])}return i===U.Group.RETURN_TOTAL?a:i===U.Group.RETURN_ALL?s:null},U.Group.prototype.getFirstExists=function(t,e,i,n,r,o){void 0===e&&(e=!1);t=this.iterate("exists",t="boolean"!=typeof t?!0:t,U.Group.RETURN_CHILD);return null===t&&e?this.create(i,n,r,o):this.resetChild(t,i,n,r,o)},U.Group.prototype.getFirstAlive=function(t,e,i,n,r){void 0===t&&(t=!1);var o=this.iterate("alive",!0,U.Group.RETURN_CHILD);return null===o&&t?this.create(e,i,n,r):this.resetChild(o,e,i,n,r)},U.Group.prototype.getFirstDead=function(t,e,i,n,r){void 0===t&&(t=!1);var o=this.iterate("alive",!1,U.Group.RETURN_CHILD);return null===o&&t?this.create(e,i,n,r):this.resetChild(o,e,i,n,r)},U.Group.prototype.resetChild=function(t,e,i,n,r){return null===t?null:(void 0===i&&(i=null),null!==(e=void 0===e?null:e)&&null!==i&&t.reset(e,i),void 0!==n&&t.loadTexture(n,r),t)},U.Group.prototype.getTop=function(){if(0<this.children.length)return this.children[this.children.length-1]},U.Group.prototype.getBottom=function(){if(0<this.children.length)return this.children[0]},U.Group.prototype.getClosestTo=function(t,e,i){for(var n,r=Number.MAX_VALUE,o=null,s=0;s<this.children.length;s++){var a=this.children[s];a.exists&&(n=Math.abs(U.Point.distance(t,a)))<r&&(!e||e.call(i,a,n))&&(r=n,o=a)}return o},U.Group.prototype.getFurthestFrom=function(t,e,i){for(var n,r=0,o=null,s=0;s<this.children.length;s++){var a=this.children[s];a.exists&&r<(n=Math.abs(U.Point.distance(t,a)))&&(!e||e.call(i,a,n))&&(r=n,o=a)}return o},U.Group.prototype.countLiving=function(){return this.iterate("alive",!0,U.Group.RETURN_TOTAL)},U.Group.prototype.countDead=function(){return this.iterate("alive",!1,U.Group.RETURN_TOTAL)},U.Group.prototype.getRandom=function(t,e){return void 0===t&&(t=0),0===(e=void 0===e?this.children.length:e)?null:U.ArrayUtils.getRandomItem(this.children,t,e)},U.Group.prototype.getRandomExists=function(t,e){e=this.getAll("exists",!0,t,e);return this.game.rnd.pick(e)},U.Group.prototype.getAll=function(t,e,i,n){void 0===n&&(n=this.children.length);for(var r=[],o=i=void 0===i?0:i;o<n;o++){var s=this.children[o];t&&s[t]===e&&r.push(s)}return r},U.Group.prototype.remove=function(t,e,i){if(void 0===e&&(e=!1),void 0===i&&(i=!1),0===this.children.length||-1===this.children.indexOf(t))return!1;i||!t.events||t.destroyPhase||t.events.onRemovedFromGroup$dispatch(t,this);i=this.removeChild(t);return this.removeFromHash(t),this.updateZ(),this.cursor===t&&this.next(),e&&i&&i.destroy(!0),!0},U.Group.prototype.moveAll=function(t,e){if(void 0===e&&(e=!1),0<this.children.length&&t instanceof U.Group){for(;t.add(this.children[0],e),0<this.children.length;);this.hash=[],this.cursor=null}return t},U.Group.prototype.removeAll=function(t,e,i){if(void 0===t&&(t=!1),void 0===e&&(e=!1),void 0===i&&(i=!1),0!==this.children.length){do{!e&&this.children[0].events&&this.children[0].events.onRemovedFromGroup$dispatch(this.children[0],this);var n=this.removeChild(this.children[0])}while(this.removeFromHash(n),t&&n&&n.destroy(!0,i),0<this.children.length);this.hash=[],this.cursor=null}},U.Group.prototype.removeBetween=function(t,e,i,n){if(void 0===e&&(e=this.children.length-1),void 0===i&&(i=!1),void 0===n&&(n=!1),0!==this.children.length){if(e<t||t<0||e>this.children.length)return!1;for(var r=e;t<=r;){!n&&this.children[r].events&&this.children[r].events.onRemovedFromGroup$dispatch(this.children[r],this);var o=this.removeChild(this.children[r]);this.removeFromHash(o),i&&o&&o.destroy(!0),this.cursor===this.children[r]&&(this.cursor=null),r--}this.updateZ()}},U.Group.prototype.destroy=function(t,e){null===this.game||this.ignoreDestroy||(this.onDestroy.dispatch(this,t=void 0===t?!0:t,e=void 0===e?!1:e),this.removeAll(t),this.cursor=null,this.filters=null,this.pendingDestroy=!1,e||(this.parent&&this.parent.removeChild(this),this.game=null,this.exists=!1))},Object.defineProperty(U.Group.prototype,"total",{get:function(){return this.iterate("exists",!0,U.Group.RETURN_TOTAL)}}),Object.defineProperty(U.Group.prototype,"length",{get:function(){return this.children.length}}),Object.defineProperty(U.Group.prototype,"angle",{get:function(){return U.Math.radToDeg(this.rotation)},set:function(t){this.rotation=U.Math.degToRad(t)}}),Object.defineProperty(U.Group.prototype,"centerX",{get:function(){return this.getBounds(this.parent).centerX},set:function(t){var e=this.getBounds(this.parent),i=this.x-e.x;this.x=t+i-e.halfWidth}}),Object.defineProperty(U.Group.prototype,"centerY",{get:function(){return this.getBounds(this.parent).centerY},set:function(t){var e=this.getBounds(this.parent),i=this.y-e.y;this.y=t+i-e.halfHeight}}),Object.defineProperty(U.Group.prototype,"left",{get:function(){return this.getBounds(this.parent).left},set:function(t){var e=this.getBounds(this.parent),e=this.x-e.x;this.x=t+e}}),Object.defineProperty(U.Group.prototype,"right",{get:function(){return this.getBounds(this.parent).right},set:function(t){var e=this.getBounds(this.parent),i=this.x-e.x;this.x=t+i-e.width}}),Object.defineProperty(U.Group.prototype,"top",{get:function(){return this.getBounds(this.parent).top},set:function(t){var e=this.getBounds(this.parent),e=this.y-e.y;this.y=t+e}}),Object.defineProperty(U.Group.prototype,"bottom",{get:function(){return this.getBounds(this.parent).bottom},set:function(t){var e=this.getBounds(this.parent),i=this.y-e.y;this.y=t+i-e.height}}),U.World=function(t){U.Group.call(this,t,null,"__world",!1),this.bounds=new U.Rectangle(0,0,t.width,t.height),this.camera=null,this._definedSize=!1,this._width=t.width,this._height=t.height,this.game.state.onStateChange.add(this.stateChange,this)},U.World.prototype=Object.create(U.Group.prototype),U.World.prototype.constructor=U.World,U.World.prototype.boot=function(){this.camera=new U.Camera(this.game,0,0,0,this.game.width,this.game.height),this.game.stage.addChild(this),this.camera.boot()},U.World.prototype.stateChange=function(){this.x=0,this.y=0,this.camera.reset()},U.World.prototype.setBounds=function(t,e,i,n){this._definedSize=!0,this._width=i,this._height=n,this.bounds.setTo(t,e,i,n),this.x=t,this.y=e,this.camera.bounds&&this.camera.bounds.setTo(t,e,Math.max(i,this.game.width),Math.max(n,this.game.height)),this.game.physics.setBoundsToWorld()},U.World.prototype.resize=function(t,e){this._definedSize&&(t<this._width&&(t=this._width),e<this._height&&(e=this._height)),this.bounds.width=t,this.bounds.height=e,this.game.camera.setBoundsToWorld(),this.game.physics.setBoundsToWorld()},U.World.prototype.shutdown=function(){this.destroy(!0,!0)},U.World.prototype.wrap=function(t,e,i,n,r){void 0===e&&(e=0),void 0===n&&(n=!0),void 0===r&&(r=!0),(i=void 0===i?!1:i)?(t.getBounds(),n&&(t.x+t._currentBounds.width<this.bounds.x?t.x=this.bounds.right:t.x>this.bounds.right&&(t.x=this.bounds.left)),r&&(t.y+t._currentBounds.height<this.bounds.top?t.y=this.bounds.bottom:t.y>this.bounds.bottom&&(t.y=this.bounds.top))):(n&&t.x+e<this.bounds.x?t.x=this.bounds.right+e:n&&t.x-e>this.bounds.right&&(t.x=this.bounds.left-e),r&&t.y+e<this.bounds.top?t.y=this.bounds.bottom+e:r&&t.y-e>this.bounds.bottom&&(t.y=this.bounds.top-e))},Object.defineProperty(U.World.prototype,"width",{get:function(){return this.bounds.width},set:function(t){t<this.game.width&&(t=this.game.width),this.bounds.width=t,this._width=t,this._definedSize=!0}}),Object.defineProperty(U.World.prototype,"height",{get:function(){return this.bounds.height},set:function(t){t<this.game.height&&(t=this.game.height),this.bounds.height=t,this._height=t,this._definedSize=!0}}),Object.defineProperty(U.World.prototype,"centerX",{get:function(){return this.bounds.halfWidth+this.bounds.x}}),Object.defineProperty(U.World.prototype,"centerY",{get:function(){return this.bounds.halfHeight+this.bounds.y}}),Object.defineProperty(U.World.prototype,"randomX",{get:function(){return this.bounds.x<0?this.game.rnd.between(this.bounds.x,this.bounds.width-Math.abs(this.bounds.x)):this.game.rnd.between(this.bounds.x,this.bounds.width)}}),Object.defineProperty(U.World.prototype,"randomY",{get:function(){return this.bounds.y<0?this.game.rnd.between(this.bounds.y,this.bounds.height-Math.abs(this.bounds.y)):this.game.rnd.between(this.bounds.y,this.bounds.height)}}),U.Game=function(t,e,i,n,r,o,s,a){return this.id=U.GAMES.push(this)-1,this.config=null,this.physicsConfig=a,this.parent="",this.width=800,this.height=600,this.resolution=1,this._width=800,this._height=600,this.transparent=!1,this.antialias=!0,this.preserveDrawingBuffer=!1,this.clearBeforeRender=!0,this.renderer=null,this.renderType=U.AUTO,this.state=null,this.isBooted=!1,this.isRunning=!1,this.raf=null,this.add=null,this.make=null,this.cache=null,this.input=null,this.load=null,this.math=null,this.net=null,this.scale=null,this.sound=null,this.stage=null,this.time=null,this.tweens=null,this.world=null,this.physics=null,this.plugins=null,this.rnd=null,this.device=U.Device,this.camera=null,this.canvas=null,this.context=null,this.debug=null,this.particles=null,this.create=null,this.lockRender=!1,this.stepping=!1,this.pendingStep=!1,this.stepCount=0,this.onPause=null,this.onResume=null,this.onBlur=null,this.onFocus=null,this._paused=!1,this._codePaused=!1,this.currentUpdateID=0,this.updatesThisFrame=1,this._deltaTime=0,this._lastCount=0,this._spiraling=0,this._kickstart=!0,this.fpsProblemNotifier=new U.Signal,this.forceSingleUpdate=!0,this._nextFpsNotification=0,1===arguments.length&&"object"==typeof t?this.parseConfig(t):(this.config={enableDebug:!0},void 0!==t&&(this._width=t),void 0!==e&&(this._height=e),void 0!==i&&(this.renderType=i),void 0!==n&&(this.parent=n),void 0!==o&&(this.transparent=o),void 0!==s&&(this.antialias=s),this.rnd=new U.RandomDataGenerator([(Date.now()*Math.random()).toString()]),this.state=new U.StateManager(this,r)),this.device.whenReady(this.boot,this),this},U.Game.prototype={parseConfig:function(t){void 0===(this.config=t).enableDebug&&(this.config.enableDebug=!0),t.width&&(this._width=t.width),t.height&&(this._height=t.height),t.renderer&&(this.renderType=t.renderer),t.parent&&(this.parent=t.parent),void 0!==t.transparent&&(this.transparent=t.transparent),void 0!==t.antialias&&(this.antialias=t.antialias),t.resolution&&(this.resolution=t.resolution),void 0!==t.preserveDrawingBuffer&&(this.preserveDrawingBuffer=t.preserveDrawingBuffer),t.physicsConfig&&(this.physicsConfig=t.physicsConfig);var e=[(Date.now()*Math.random()).toString()];t.seed&&(e=t.seed),this.rnd=new U.RandomDataGenerator(e);e=null;t.state&&(e=t.state),this.state=new U.StateManager(this,e)},boot:function(){this.isBooted||(this.onPause=new U.Signal,this.onResume=new U.Signal,this.onBlur=new U.Signal,this.onFocus=new U.Signal,this.isBooted=!0,(PIXI.game=this).math=U.Math,this.scale=new U.ScaleManager(this,this._width,this._height),this.stage=new U.Stage(this),this.setUpRenderer(),this.world=new U.World(this),this.add=new U.GameObjectFactory(this),this.make=new U.GameObjectCreator(this),this.cache=new U.Cache(this),this.load=new U.Loader(this),this.time=new U.Time(this),this.tweens=new U.TweenManager(this),this.input=new U.Input(this),this.sound=new U.SoundManager(this),this.physics=new U.Physics(this,this.physicsConfig),this.particles=new U.Particles(this),this.create=new U.Create(this),this.plugins=new U.PluginManager(this),this.net=new U.Net(this),this.time.boot(),this.stage.boot(),this.world.boot(),this.scale.boot(),this.input.boot(),this.sound.boot(),this.state.boot(),this.config.enableDebug?(this.debug=new U.Utils.Debug(this),this.debug.boot()):this.debug={preUpdate:function(){},update:function(){},reset:function(){}},this.showDebugHeader(),this.isRunning=!0,this.config&&this.config.forceSetTimeOut?this.raf=new U.RequestAnimationFrame(this,this.config.forceSetTimeOut):this.raf=new U.RequestAnimationFrame(this,!1),this._kickstart=!0,window.focus&&(window.PhaserGlobal&&(!window.PhaserGlobal||window.PhaserGlobal.stopFocus)||window.focus()),this.raf.start())},showDebugHeader:function(){if(!window.PhaserGlobal||!window.PhaserGlobal.hideBanner){var t=U.VERSION,e="Canvas",i="HTML Audio",n=1;if(this.renderType===U.WEBGL?(e="WebGL",n++):this.renderType===U.HEADLESS&&(e="Headless"),this.device.webAudio&&(i="WebAudio",n++),this.device.chrome)for(var r=["%c %c %c Phaser v"+t+" | Pixi.js | "+e+" | "+i+"  %c %c %c http://phaser.io %c%c%c","background: #fb8cb3","background: #d44a52","color: #ffffff; background: #871905;","background: #d44a52","background: #fb8cb3","background: #ffffff"],o=0;o<3;o++)o<n?r.push("color: #ff2424; background: #fff"):r.push("color: #959595; background: #fff");else window.console}},setUpRenderer:function(){if(this.config.canvas?this.canvas=this.config.canvas:this.canvas=U.Canvas.create(this,this.width,this.height,this.config.canvasID,!0),this.config.canvasStyle?this.canvas.style=this.config.canvasStyle:this.canvas.style["-webkit-full-screen"]="width: 100%; height: 100%",this.renderType===U.HEADLESS||this.renderType===U.CANVAS||this.renderType===U.AUTO&&!this.device.webGL){if(!this.device.canvas)throw new Error("Phaser.Game - Cannot create Canvas or WebGL context, aborting.");this.renderType=U.CANVAS,this.renderer=new PIXI.CanvasRenderer(this),this.context=this.renderer.context}else this.renderType=U.WEBGL,this.renderer=new PIXI.WebGLRenderer(this),this.context=null,this.canvas.addEventListener("webglcontextlost",this.contextLost.bind(this),!1),this.canvas.addEventListener("webglcontextrestored",this.contextRestored.bind(this),!1);this.device.cocoonJS&&(this.canvas.screencanvas=this.renderType===U.CANVAS),this.renderType!==U.HEADLESS&&(this.stage.smoothed=this.antialias,U.Canvas.addToDOM(this.canvas,this.parent,!1),U.Canvas.setTouchAction(this.canvas))},contextLost:function(t){t.preventDefault(),this.renderer.contextLost=!0},contextRestored:function(){this.renderer.initContext(),this.cache.clearGLTextures(),this.renderer.contextLost=!1},update:function(t){if(this.time.update(t),this._kickstart)return this.updateLogic(this.time.desiredFpsMult),this.updateRender(this.time.slowMotion*this.time.desiredFps),void(this._kickstart=!1);if(1<this._spiraling&&!this.forceSingleUpdate)this.time.time>this._nextFpsNotification&&(this._nextFpsNotification=this.time.time+1e4,this.fpsProblemNotifier.dispatch()),this._deltaTime=0,this._spiraling=0,this.updateRender(this.time.slowMotion*this.time.desiredFps);else{var e=1e3*this.time.slowMotion/this.time.desiredFps;this._deltaTime+=Math.max(Math.min(3*e,this.time.elapsed),0);var i=0;for(this.updatesThisFrame=Math.floor(this._deltaTime/e),this.forceSingleUpdate&&(this.updatesThisFrame=Math.min(1,this.updatesThisFrame));this._deltaTime>=e&&(this._deltaTime-=e,this.currentUpdateID=i,this.updateLogic(this.time.desiredFpsMult),i++,!this.forceSingleUpdate||1!==i);)this.time.refresh();i>this._lastCount?this._spiraling++:i<this._lastCount&&(this._spiraling=0),this._lastCount=i,this.updateRender(this._deltaTime/e)}},updateLogic:function(t){this._paused||this.pendingStep?(this.scale.pauseUpdate(),this.state.pauseUpdate(),this.debug.preUpdate()):(this.stepping&&(this.pendingStep=!0),this.scale.preUpdate(),this.debug.preUpdate(),this.camera.preUpdate(),this.physics.preUpdate(),this.state.preUpdate(t),this.plugins.preUpdate(t),this.stage.preUpdate(),this.state.update(),this.stage.update(),this.tweens.update(),this.sound.update(),this.input.update(),this.physics.update(),this.particles.update(),this.plugins.update(),this.stage.postUpdate(),this.plugins.postUpdate()),this.stage.updateTransform()},updateRender:function(t){this.lockRender||(this.state.preRender(t),this.renderType!==U.HEADLESS&&(this.renderer.render(this.stage),this.plugins.render(t),this.state.render(t)),this.plugins.postRender(t))},enableStep:function(){this.stepping=!0,this.pendingStep=!1,this.stepCount=0},disableStep:function(){this.stepping=!1,this.pendingStep=!1},step:function(){this.pendingStep=!1,this.stepCount++},destroy:function(){this.raf.stop(),this.state.destroy(),this.sound.destroy(),this.scale.destroy(),this.stage.destroy(),this.input.destroy(),this.physics.destroy(),this.plugins.destroy(),this.state=null,this.sound=null,this.scale=null,this.stage=null,this.input=null,this.physics=null,this.plugins=null,this.cache=null,this.load=null,this.time=null,this.world=null,this.isBooted=!1,this.renderer.destroy(!1),U.Canvas.removeFromDOM(this.canvas),PIXI.defaultRenderer=null,U.GAMES[this.id]=null},gamePaused:function(t){this._paused||(this._paused=!0,this.time.gamePaused(),this.sound.muteOnPause&&this.sound.setMute(),this.onPause.dispatch(t),this.device.cordova&&this.device.iOS&&(this.lockRender=!0))},gameResumed:function(t){this._paused&&!this._codePaused&&(this._paused=!1,this.time.gameResumed(),this.input.reset(),this.sound.muteOnPause&&this.sound.unsetMute(),this.onResume.dispatch(t),this.device.cordova&&this.device.iOS&&(this.lockRender=!1))},focusLoss:function(t){this.onBlur.dispatch(t),this.stage.disableVisibilityChange||this.gamePaused(t)},focusGain:function(t){this.onFocus.dispatch(t),this.stage.disableVisibilityChange||this.gameResumed(t)}},U.Game.prototype.constructor=U.Game,Object.defineProperty(U.Game.prototype,"paused",{get:function(){return this._paused},set:function(t){!0===t?(!1===this._paused&&(this._paused=!0,this.sound.setMute(),this.time.gamePaused(),this.onPause.dispatch(this)),this._codePaused=!0):(this._paused&&(this._paused=!1,this.input.reset(),this.sound.unsetMute(),this.time.gameResumed(),this.onResume.dispatch(this)),this._codePaused=!1)}}),U.Input=function(t){this.game=t,this.hitCanvas=null,this.hitContext=null,this.moveCallbacks=[],this.customCandidateHandler=null,this.customCandidateHandlerContext=null,this.pollRate=0,this.enabled=!0,this.multiInputOverride=U.Input.MOUSE_TOUCH_COMBINE,this.position=null,this.speed=null,this.circle=null,this.scale=null,this.maxPointers=-1,this.tapRate=200,this.doubleTapRate=300,this.holdRate=2e3,this.justPressedRate=200,this.justReleasedRate=200,this.recordPointerHistory=!1,this.recordRate=100,this.recordLimit=100,this.pointer1=null,this.pointer2=null,this.pointer3=null,this.pointer4=null,this.pointer5=null,this.pointer6=null,this.pointer7=null,this.pointer8=null,this.pointer9=null,this.pointer10=null,this.pointers=[],this.activePointer=null,this.mousePointer=null,this.mouse=null,this.keyboard=null,this.touch=null,this.mspointer=null,this.gamepad=null,this.resetLocked=!1,this.onDown=null,this.onUp=null,this.onTap=null,this.onHold=null,this.minPriorityID=0,this.interactiveItems=new U.ArraySet,this._localPoint=new U.Point,this._pollCounter=0,this._oldPosition=null,this._x=0,this._y=0},U.Input.MOUSE_OVERRIDES_TOUCH=0,U.Input.TOUCH_OVERRIDES_MOUSE=1,U.Input.MOUSE_TOUCH_COMBINE=2,U.Input.MAX_POINTERS=10,U.Input.prototype={boot:function(){this.mousePointer=new U.Pointer(this.game,0,U.PointerMode.CURSOR),this.addPointer(),this.addPointer(),this.mouse=new U.Mouse(this.game),this.touch=new U.Touch(this.game),this.mspointer=new U.MSPointer(this.game),U.Keyboard&&(this.keyboard=new U.Keyboard(this.game)),U.Gamepad&&(this.gamepad=new U.Gamepad(this.game)),this.onDown=new U.Signal,this.onUp=new U.Signal,this.onTap=new U.Signal,this.onHold=new U.Signal,this.scale=new U.Point(1,1),this.speed=new U.Point,this.position=new U.Point,this._oldPosition=new U.Point,this.circle=new U.Circle(0,0,44),this.activePointer=this.mousePointer,this.hitCanvas=PIXI.CanvasPool.create(this,1,1),this.hitContext=this.hitCanvas.getContext("2d"),this.mouse.start(),this.touch.start(),this.mspointer.start(),this.mousePointer.active=!0,this.keyboard&&this.keyboard.start();var e=this;this._onClickTrampoline=function(t){e.onClickTrampoline(t)},this.game.canvas.addEventListener("click",this._onClickTrampoline,!1)},destroy:function(){this.mouse.stop(),this.touch.stop(),this.mspointer.stop(),this.keyboard&&this.keyboard.stop(),this.gamepad&&this.gamepad.stop(),this.moveCallbacks=[],PIXI.CanvasPool.remove(this),this.game.canvas.removeEventListener("click",this._onClickTrampoline)},setInteractiveCandidateHandler:function(t,e){this.customCandidateHandler=t,this.customCandidateHandlerContext=e},addMoveCallback:function(t,e){this.moveCallbacks.push({callback:t,context:e})},deleteMoveCallback:function(t,e){for(var i=this.moveCallbacks.length;i--;)if(this.moveCallbacks[i].callback===t&&this.moveCallbacks[i].context===e)return void this.moveCallbacks.splice(i,1)},addPointer:function(){if(this.pointers.length>=U.Input.MAX_POINTERS)return null;var t=this.pointers.length+1,e=new U.Pointer(this.game,t,U.PointerMode.TOUCH);return this.pointers.push(e),this["pointer"+t]=e},update:function(){if(this.keyboard&&this.keyboard.update(),0<this.pollRate&&this._pollCounter<this.pollRate)this._pollCounter++;else{this.speed.x=this.position.x-this._oldPosition.x,this.speed.y=this.position.y-this._oldPosition.y,this._oldPosition.copyFrom(this.position),this.mousePointer.update(),this.gamepad&&this.gamepad.active&&this.gamepad.update();for(var t=0;t<this.pointers.length;t++)this.pointers[t].update();this._pollCounter=0}},reset:function(t){if(this.game.isBooted&&!this.resetLocked){void 0===t&&(t=!1),this.mousePointer.reset(),this.keyboard&&this.keyboard.reset(t),this.gamepad&&this.gamepad.reset();for(var e=0;e<this.pointers.length;e++)this.pointers[e].reset();"none"!==this.game.canvas.style.cursor&&(this.game.canvas.style.cursor="inherit"),t&&(this.onDown.dispose(),this.onUp.dispose(),this.onTap.dispose(),this.onHold.dispose(),this.onDown=new U.Signal,this.onUp=new U.Signal,this.onTap=new U.Signal,this.onHold=new U.Signal,this.moveCallbacks=[]),this._pollCounter=0}},resetSpeed:function(t,e){this._oldPosition.setTo(t,e),this.speed.setTo(0,0)},startPointer:function(t){if(0<=this.maxPointers&&this.countActivePointers(this.maxPointers)>=this.maxPointers)return null;if(!this.pointer1.active)return this.pointer1.start(t);if(!this.pointer2.active)return this.pointer2.start(t);for(var e=2;e<this.pointers.length;e++){var i=this.pointers[e];if(!i.active)return i.start(t)}return null},updatePointer:function(t){if(this.pointer1.active&&this.pointer1.identifier===t.identifier)return this.pointer1.move(t);if(this.pointer2.active&&this.pointer2.identifier===t.identifier)return this.pointer2.move(t);for(var e=2;e<this.pointers.length;e++){var i=this.pointers[e];if(i.active&&i.identifier===t.identifier)return i.move(t)}return null},stopPointer:function(t){if(this.pointer1.active&&this.pointer1.identifier===t.identifier)return this.pointer1.stop(t);if(this.pointer2.active&&this.pointer2.identifier===t.identifier)return this.pointer2.stop(t);for(var e=2;e<this.pointers.length;e++){var i=this.pointers[e];if(i.active&&i.identifier===t.identifier)return i.stop(t)}return null},countActivePointers:function(t){for(var e=t=void 0===t?this.pointers.length:t,i=0;i<this.pointers.length&&0<e;i++)this.pointers[i].active&&e--;return t-e},getPointer:function(t){void 0===t&&(t=!1);for(var e=0;e<this.pointers.length;e++){var i=this.pointers[e];if(i.active===t)return i}return null},getPointerFromIdentifier:function(t){for(var e=0;e<this.pointers.length;e++){var i=this.pointers[e];if(i.identifier===t)return i}return null},getPointerFromId:function(t){for(var e=0;e<this.pointers.length;e++){var i=this.pointers[e];if(i.pointerId===t)return i}return null},getLocalPosition:function(t,e,i){void 0===i&&(i=new U.Point);var n=t.worldTransform,t=1/(n.a*n.d+n.c*-n.b);return i.setTo(n.d*t*e.x+-n.c*t*e.y+(n.ty*n.c-n.tx*n.d)*t,n.a*t*e.y+-n.b*t*e.x+(-n.ty*n.a+n.tx*n.b)*t)},hitTest:function(t,e,i){if(!t.worldVisible)return!1;if(this.getLocalPosition(t,e,this._localPoint),i.copyFrom(this._localPoint),t.hitArea&&t.hitArea.contains)return t.hitArea.contains(this._localPoint.x,this._localPoint.y);if(t instanceof U.TileSprite){var n=t.width,r=t.height,o=-n*t.anchor.x;if(this._localPoint.x>=o&&this._localPoint.x<o+n){var s=-r*t.anchor.y;if(this._localPoint.y>=s&&this._localPoint.y<s+r)return!0}}else if(t instanceof PIXI.Sprite){n=t.texture.frame.width,r=t.texture.frame.height,o=-n*t.anchor.x;if(this._localPoint.x>=o&&this._localPoint.x<o+n){s=-r*t.anchor.y;if(this._localPoint.y>=s&&this._localPoint.y<s+r)return!0}}else if(t instanceof U.Graphics)for(var a=0;a<t.graphicsData.length;a++){var h=t.graphicsData[a];if(h.fill&&(h.shape&&h.shape.contains(this._localPoint.x,this._localPoint.y)))return!0}for(a=0;a<t.children.length;a++)if(this.hitTest(t.children[a],e,i))return!0;return!1},onClickTrampoline:function(){this.activePointer.processClickTrampolines()}},U.Input.prototype.constructor=U.Input,Object.defineProperty(U.Input.prototype,"x",{get:function(){return this._x},set:function(t){this._x=Math.floor(t)}}),Object.defineProperty(U.Input.prototype,"y",{get:function(){return this._y},set:function(t){this._y=Math.floor(t)}}),Object.defineProperty(U.Input.prototype,"pollLocked",{get:function(){return 0<this.pollRate&&this._pollCounter<this.pollRate}}),Object.defineProperty(U.Input.prototype,"totalInactivePointers",{get:function(){return this.pointers.length-this.countActivePointers()}}),Object.defineProperty(U.Input.prototype,"totalActivePointers",{get:function(){return this.countActivePointers()}}),Object.defineProperty(U.Input.prototype,"worldX",{get:function(){return this.game.camera.view.x+this.x}}),Object.defineProperty(U.Input.prototype,"worldY",{get:function(){return this.game.camera.view.y+this.y}}),U.Mouse=function(t){this.game=t,this.input=t.input,this.callbackContext=this.game,this.mouseDownCallback=null,this.mouseUpCallback=null,this.mouseOutCallback=null,this.mouseOverCallback=null,this.mouseWheelCallback=null,this.capture=!1,this.button=-1,this.wheelDelta=0,this.enabled=!0,this.locked=!1,this.stopOnGameOut=!1,this.pointerLock=new U.Signal,this.event=null,this._onMouseDown=null,this._onMouseMove=null,this._onMouseUp=null,this._onMouseOut=null,this._onMouseOver=null,this._onMouseWheel=null,this._wheelEvent=null},U.Mouse.NO_BUTTON=-1,U.Mouse.LEFT_BUTTON=0,U.Mouse.MIDDLE_BUTTON=1,U.Mouse.RIGHT_BUTTON=2,U.Mouse.BACK_BUTTON=3,U.Mouse.FORWARD_BUTTON=4,U.Mouse.WHEEL_UP=1,U.Mouse.WHEEL_DOWN=-1,U.Mouse.prototype={start:function(){var e,t,i;this.game.device.android&&!1===this.game.device.chrome||null===this._onMouseDown&&((e=this)._onMouseDown=function(t){return e.onMouseDown(t)},this._onMouseMove=function(t){return e.onMouseMove(t)},this._onMouseUp=function(t){return e.onMouseUp(t)},this._onMouseUpGlobal=function(t){return e.onMouseUpGlobal(t)},this._onMouseOutGlobal=function(t){return e.onMouseOutGlobal(t)},this._onMouseOut=function(t){return e.onMouseOut(t)},this._onMouseOver=function(t){return e.onMouseOver(t)},this._onMouseWheel=function(t){return e.onMouseWheel(t)},(t=this.game.canvas).addEventListener("mousedown",this._onMouseDown,!0),t.addEventListener("mousemove",this._onMouseMove,!0),t.addEventListener("mouseup",this._onMouseUp,!0),this.game.device.cocoonJS||(window.addEventListener("mouseup",this._onMouseUpGlobal,!0),window.addEventListener("mouseout",this._onMouseOutGlobal,!0),t.addEventListener("mouseover",this._onMouseOver,!0),t.addEventListener("mouseout",this._onMouseOut,!0)),(i=this.game.device.wheelEvent)&&(t.addEventListener(i,this._onMouseWheel,!0),"mousewheel"===i?this._wheelEvent=new r(-.025,1):"DOMMouseScroll"===i&&(this._wheelEvent=new r(1,1))))},onMouseDown:function(t){this.event=t,this.capture&&t.preventDefault(),this.mouseDownCallback&&this.mouseDownCallback.call(this.callbackContext,t),this.input.enabled&&this.enabled&&(t.identifier=0,this.input.mousePointer.start(t))},onMouseMove:function(t){this.event=t,this.capture&&t.preventDefault(),this.mouseMoveCallback&&this.mouseMoveCallback.call(this.callbackContext,t),this.input.enabled&&this.enabled&&(t.identifier=0,this.input.mousePointer.move(t))},onMouseUp:function(t){this.event=t,this.capture&&t.preventDefault(),this.mouseUpCallback&&this.mouseUpCallback.call(this.callbackContext,t),this.input.enabled&&this.enabled&&(t.identifier=0,this.input.mousePointer.stop(t))},onMouseUpGlobal:function(t){this.input.mousePointer.withinGame||(this.mouseUpCallback&&this.mouseUpCallback.call(this.callbackContext,t),t.identifier=0,this.input.mousePointer.stop(t))},onMouseOutGlobal:function(t){this.event=t,this.capture&&t.preventDefault(),this.input.mousePointer.withinGame=!1,this.input.enabled&&this.enabled&&(this.input.mousePointer.stop(t),this.input.mousePointer.leftButton.stop(t),this.input.mousePointer.rightButton.stop(t))},onMouseOut:function(t){this.event=t,this.capture&&t.preventDefault(),this.input.mousePointer.withinGame=!1,this.mouseOutCallback&&this.mouseOutCallback.call(this.callbackContext,t),this.input.enabled&&this.enabled&&this.stopOnGameOut&&(t.identifier=0,this.input.mousePointer.stop(t))},onMouseOver:function(t){this.event=t,this.capture&&t.preventDefault(),this.input.mousePointer.withinGame=!0,this.mouseOverCallback&&this.mouseOverCallback.call(this.callbackContext,t)},onMouseWheel:function(t){this._wheelEvent&&(t=this._wheelEvent.bindEvent(t)),this.event=t,this.capture&&t.preventDefault(),this.wheelDelta=U.Math.clamp(-t.deltaY,-1,1),this.mouseWheelCallback&&this.mouseWheelCallback.call(this.callbackContext,t)},requestPointerLock:function(){var t,e;this.game.device.pointerLock&&((t=this.game.canvas).requestPointerLock=t.requestPointerLock||t.mozRequestPointerLock||t.webkitRequestPointerLock,t.requestPointerLock(),(e=this)._pointerLockChange=function(t){return e.pointerLockChange(t)},document.addEventListener("pointerlockchange",this._pointerLockChange,!0),document.addEventListener("mozpointerlockchange",this._pointerLockChange,!0),document.addEventListener("webkitpointerlockchange",this._pointerLockChange,!0))},pointerLockChange:function(t){var e=this.game.canvas;document.pointerLockElement===e||document.mozPointerLockElement===e||document.webkitPointerLockElement===e?(this.locked=!0,this.pointerLock.dispatch(!0,t)):(this.locked=!1,this.pointerLock.dispatch(!1,t))},releasePointerLock:function(){document.exitPointerLock=document.exitPointerLock||document.mozExitPointerLock||document.webkitExitPointerLock,document.exitPointerLock(),document.removeEventListener("pointerlockchange",this._pointerLockChange,!0),document.removeEventListener("mozpointerlockchange",this._pointerLockChange,!0),document.removeEventListener("webkitpointerlockchange",this._pointerLockChange,!0)},stop:function(){var t=this.game.canvas;t.removeEventListener("mousedown",this._onMouseDown,!0),t.removeEventListener("mousemove",this._onMouseMove,!0),t.removeEventListener("mouseup",this._onMouseUp,!0),t.removeEventListener("mouseover",this._onMouseOver,!0),t.removeEventListener("mouseout",this._onMouseOut,!0);var e=this.game.device.wheelEvent;e&&t.removeEventListener(e,this._onMouseWheel,!0),window.removeEventListener("mouseup",this._onMouseUpGlobal,!0),window.removeEventListener("mouseout",this._onMouseOutGlobal,!0),document.removeEventListener("pointerlockchange",this._pointerLockChange,!0),document.removeEventListener("mozpointerlockchange",this._pointerLockChange,!0),document.removeEventListener("webkitpointerlockchange",this._pointerLockChange,!0)}},U.Mouse.prototype.constructor=U.Mouse,((r.prototype={}).constructor=r).prototype.bindEvent=function(t){if(!r._stubsGenerated&&t){for(var e in t)e in r.prototype||Object.defineProperty(r.prototype,e,{get:function(e){return function(){var t=this.originalEvent[e];return"function"!=typeof t?t:t.bind(this.originalEvent)}}(e)});r._stubsGenerated=!0}return this.originalEvent=t,this},Object.defineProperties(r.prototype,{type:{value:"wheel"},deltaMode:{get:function(){return this._deltaMode}},deltaY:{get:function(){return this._scaleFactor*(this.originalEvent.wheelDelta||this.originalEvent.detail)||0}},deltaX:{get:function(){return this._scaleFactor*this.originalEvent.wheelDeltaX||0}},deltaZ:{value:0}}),U.MSPointer=function(t){this.game=t,this.input=t.input,this.callbackContext=this.game,this.pointerDownCallback=null,this.pointerMoveCallback=null,this.pointerUpCallback=null,this.capture=!0,this.button=-1,this.event=null,this.enabled=!0,this._onMSPointerDown=null,this._onMSPointerMove=null,this._onMSPointerUp=null,this._onMSPointerUpGlobal=null,this._onMSPointerOut=null,this._onMSPointerOver=null},U.MSPointer.prototype={start:function(){var e,t;null!==this._onMSPointerDown||(e=this).game.device.mspointer&&(this._onMSPointerDown=function(t){return e.onPointerDown(t)},this._onMSPointerMove=function(t){return e.onPointerMove(t)},this._onMSPointerUp=function(t){return e.onPointerUp(t)},this._onMSPointerUpGlobal=function(t){return e.onPointerUpGlobal(t)},this._onMSPointerOut=function(t){return e.onPointerOut(t)},this._onMSPointerOver=function(t){return e.onPointerOver(t)},(t=this.game.canvas).addEventListener("MSPointerDown",this._onMSPointerDown,!1),t.addEventListener("MSPointerMove",this._onMSPointerMove,!1),t.addEventListener("MSPointerUp",this._onMSPointerUp,!1),t.addEventListener("pointerdown",this._onMSPointerDown,!1),t.addEventListener("pointermove",this._onMSPointerMove,!1),t.addEventListener("pointerup",this._onMSPointerUp,!1),t.style["-ms-content-zooming"]="none",t.style["-ms-touch-action"]="none",this.game.device.cocoonJS||(window.addEventListener("MSPointerUp",this._onMSPointerUpGlobal,!0),t.addEventListener("MSPointerOver",this._onMSPointerOver,!0),t.addEventListener("MSPointerOut",this._onMSPointerOut,!0),window.addEventListener("pointerup",this._onMSPointerUpGlobal,!0),t.addEventListener("pointerover",this._onMSPointerOver,!0),t.addEventListener("pointerout",this._onMSPointerOut,!0)))},onPointerDown:function(t){this.event=t,this.capture&&t.preventDefault(),this.pointerDownCallback&&this.pointerDownCallback.call(this.callbackContext,t),this.input.enabled&&this.enabled&&(t.identifier=t.pointerId,"mouse"===t.pointerType||4===t.pointerType?this.input.mousePointer.start(t):this.input.startPointer(t))},onPointerMove:function(t){this.event=t,this.capture&&t.preventDefault(),this.pointerMoveCallback&&this.pointerMoveCallback.call(this.callbackContext,t),this.input.enabled&&this.enabled&&(t.identifier=t.pointerId,"mouse"===t.pointerType||4===t.pointerType?this.input.mousePointer.move(t):this.input.updatePointer(t))},onPointerUp:function(t){this.event=t,this.capture&&t.preventDefault(),this.pointerUpCallback&&this.pointerUpCallback.call(this.callbackContext,t),this.input.enabled&&this.enabled&&(t.identifier=t.pointerId,"mouse"===t.pointerType||4===t.pointerType?this.input.mousePointer.stop(t):this.input.stopPointer(t))},onPointerUpGlobal:function(t){var e;(!("mouse"!==t.pointerType&&4!==t.pointerType||this.input.mousePointer.withinGame)||(e=this.input.getPointerFromIdentifier(t.identifier))&&e.withinGame)&&this.onPointerUp(t)},onPointerOut:function(t){var e;this.event=t,this.capture&&t.preventDefault(),"mouse"===t.pointerType||4===t.pointerType?this.input.mousePointer.withinGame=!1:(e=this.input.getPointerFromIdentifier(t.identifier))&&(e.withinGame=!1),this.input.mouse.mouseOutCallback&&this.input.mouse.mouseOutCallback.call(this.input.mouse.callbackContext,t),this.input.enabled&&this.enabled&&this.input.mouse.stopOnGameOut&&(t.identifier=0,(e||this.input.mousePointer).stop(t))},onPointerOver:function(t){var e;this.event=t,this.capture&&t.preventDefault(),"mouse"===t.pointerType||4===t.pointerType?this.input.mousePointer.withinGame=!0:(e=this.input.getPointerFromIdentifier(t.identifier))&&(e.withinGame=!0),this.input.mouse.mouseOverCallback&&this.input.mouse.mouseOverCallback.call(this.input.mouse.callbackContext,t)},stop:function(){var t=this.game.canvas;t.removeEventListener("MSPointerDown",this._onMSPointerDown,!1),t.removeEventListener("MSPointerMove",this._onMSPointerMove,!1),t.removeEventListener("MSPointerUp",this._onMSPointerUp,!1),t.removeEventListener("pointerdown",this._onMSPointerDown,!1),t.removeEventListener("pointermove",this._onMSPointerMove,!1),t.removeEventListener("pointerup",this._onMSPointerUp,!1),window.removeEventListener("MSPointerUp",this._onMSPointerUpGlobal,!0),t.removeEventListener("MSPointerOver",this._onMSPointerOver,!0),t.removeEventListener("MSPointerOut",this._onMSPointerOut,!0),window.removeEventListener("pointerup",this._onMSPointerUpGlobal,!0),t.removeEventListener("pointerover",this._onMSPointerOver,!0),t.removeEventListener("pointerout",this._onMSPointerOut,!0)}},U.MSPointer.prototype.constructor=U.MSPointer,U.DeviceButton=function(t,e){this.parent=t,this.game=t.game,this.event=null,this.isDown=!1,this.isUp=!0,this.timeDown=0,this.timeUp=0,this.repeats=0,this.altKey=!1,this.shiftKey=!1,this.ctrlKey=!1,this.value=0,this.buttonCode=e,this.onDown=new U.Signal,this.onUp=new U.Signal,this.onFloat=new U.Signal},U.DeviceButton.prototype={start:function(t,e){this.isDown||(this.isDown=!0,this.isUp=!1,this.timeDown=this.game.time.time,this.repeats=0,this.event=t,this.value=e,t&&(this.altKey=t.altKey,this.shiftKey=t.shiftKey,this.ctrlKey=t.ctrlKey),this.onDown.dispatch(this,e))},stop:function(t,e){this.isUp||(this.isDown=!1,this.isUp=!0,this.timeUp=this.game.time.time,this.event=t,this.value=e,t&&(this.altKey=t.altKey,this.shiftKey=t.shiftKey,this.ctrlKey=t.ctrlKey),this.onUp.dispatch(this,e))},padFloat:function(t){this.value=t,this.onFloat.dispatch(this,t)},justPressed:function(t){return t=t||250,this.isDown&&this.timeDown+t>this.game.time.time},justReleased:function(t){return t=t||250,this.isUp&&this.timeUp+t>this.game.time.time},reset:function(){this.isDown=!1,this.isUp=!0,this.timeDown=this.game.time.time,this.repeats=0,this.altKey=!1,this.shiftKey=!1,this.ctrlKey=!1},destroy:function(){this.onDown.dispose(),this.onUp.dispose(),this.onFloat.dispose(),this.parent=null,this.game=null}},U.DeviceButton.prototype.constructor=U.DeviceButton,Object.defineProperty(U.DeviceButton.prototype,"duration",{get:function(){return this.isUp?-1:this.game.time.time-this.timeDown}}),U.Pointer=function(t,e,i){this.game=t,this.id=e,this.type=U.POINTER,this.exists=!0,this.identifier=0,this.pointerId=null,this.pointerMode=i||U.PointerMode.CURSOR|U.PointerMode.CONTACT,this.target=null,this.button=null,this.leftButton=new U.DeviceButton(this,U.Pointer.LEFT_BUTTON),this.middleButton=new U.DeviceButton(this,U.Pointer.MIDDLE_BUTTON),this.rightButton=new U.DeviceButton(this,U.Pointer.RIGHT_BUTTON),this.backButton=new U.DeviceButton(this,U.Pointer.BACK_BUTTON),this.forwardButton=new U.DeviceButton(this,U.Pointer.FORWARD_BUTTON),this.eraserButton=new U.DeviceButton(this,U.Pointer.ERASER_BUTTON),this._holdSent=!1,this._history=[],this._nextDrop=0,this._stateReset=!1,this.withinGame=!1,this.clientX=-1,this.clientY=-1,this.pageX=-1,this.pageY=-1,this.screenX=-1,this.screenY=-1,this.rawMovementX=0,this.rawMovementY=0,this.movementX=0,this.movementY=0,this.x=-1,this.y=-1,this.isMouse=0===e,this.isDown=!1,this.isUp=!0,this.timeDown=0,this.timeUp=0,this.previousTapTime=0,this.totalTouches=0,this.msSinceLastClick=Number.MAX_VALUE,this.targetObject=null,this.interactiveCandidates=[],this.active=!1,this.dirty=!1,this.position=new U.Point,this.positionDown=new U.Point,this.positionUp=new U.Point,this.circle=new U.Circle(0,0,44),this._clickTrampolines=null,this._trampolineTargetObject=null},U.Pointer.NO_BUTTON=0,U.Pointer.LEFT_BUTTON=1,U.Pointer.RIGHT_BUTTON=2,U.Pointer.MIDDLE_BUTTON=4,U.Pointer.BACK_BUTTON=8,U.Pointer.FORWARD_BUTTON=16,U.Pointer.ERASER_BUTTON=32,U.Pointer.prototype={resetButtons:function(){this.isDown=!1,this.isUp=!0,this.isMouse&&(this.leftButton.reset(),this.middleButton.reset(),this.rightButton.reset(),this.backButton.reset(),this.forwardButton.reset(),this.eraserButton.reset())},processButtonsDown:function(t,e){U.Pointer.LEFT_BUTTON&t&&this.leftButton.start(e),U.Pointer.RIGHT_BUTTON&t&&this.rightButton.start(e),U.Pointer.MIDDLE_BUTTON&t&&this.middleButton.start(e),U.Pointer.BACK_BUTTON&t&&this.backButton.start(e),U.Pointer.FORWARD_BUTTON&t&&this.forwardButton.start(e),U.Pointer.ERASER_BUTTON&t&&this.eraserButton.start(e)},processButtonsUp:function(t,e){t===U.Mouse.LEFT_BUTTON&&this.leftButton.stop(e),t===U.Mouse.RIGHT_BUTTON&&this.rightButton.stop(e),t===U.Mouse.MIDDLE_BUTTON&&this.middleButton.stop(e),t===U.Mouse.BACK_BUTTON&&this.backButton.stop(e),t===U.Mouse.FORWARD_BUTTON&&this.forwardButton.stop(e),5===t&&this.eraserButton.stop(e)},updateButtons:function(t){this.button=t.button;var e="down"===t.type.toLowerCase().substr(-4);void 0!==t.buttons?e?this.processButtonsDown(t.buttons,t):this.processButtonsUp(t.button,t):e?this.leftButton.start(t):(this.leftButton.stop(t),this.rightButton.stop(t)),1===t.buttons&&t.ctrlKey&&this.leftButton.isDown&&(this.leftButton.stop(t),this.rightButton.start(t)),this.isUp=!0,this.isDown=!1,(this.leftButton.isDown||this.rightButton.isDown||this.middleButton.isDown||this.backButton.isDown||this.forwardButton.isDown||this.eraserButton.isDown)&&(this.isUp=!1,this.isDown=!0)},start:function(t){var e=this.game.input;return t.pointerId&&(this.pointerId=t.pointerId),this.identifier=t.identifier,this.target=t.target,this.isMouse?this.updateButtons(t):(this.isDown=!0,this.isUp=!1),this.active=!0,this.withinGame=!0,this.dirty=!1,this._history=[],this._clickTrampolines=null,this._trampolineTargetObject=null,this.msSinceLastClick=this.game.time.time-this.timeDown,this.timeDown=this.game.time.time,this._holdSent=!1,this.move(t,!0),this.positionDown.setTo(this.x,this.y),(e.multiInputOverride===U.Input.MOUSE_OVERRIDES_TOUCH||e.multiInputOverride===U.Input.MOUSE_TOUCH_COMBINE||e.multiInputOverride===U.Input.TOUCH_OVERRIDES_MOUSE&&0===e.totalActivePointers)&&(e.x=this.x,e.y=this.y,e.position.setTo(this.x,this.y),e.onDown.dispatch(this,t),e.resetSpeed(this.x,this.y)),this._stateReset=!1,this.totalTouches++,null!==this.targetObject&&this.targetObject._touchedHandler(this),this},update:function(){var t=this.game.input;this.active&&(this.dirty&&(0<t.interactiveItems.total&&this.processInteractiveObjects(!1),this.dirty=!1),!1===this._holdSent&&this.duration>=t.holdRate&&((t.multiInputOverride===U.Input.MOUSE_OVERRIDES_TOUCH||t.multiInputOverride===U.Input.MOUSE_TOUCH_COMBINE||t.multiInputOverride===U.Input.TOUCH_OVERRIDES_MOUSE&&0===t.totalActivePointers)&&t.onHold.dispatch(this),this._holdSent=!0),t.recordPointerHistory&&this.game.time.time>=this._nextDrop&&(this._nextDrop=this.game.time.time+t.recordRate,this._history.push({x:this.position.x,y:this.position.y}),this._history.length>t.recordLimit&&this._history.shift()))},move:function(t,e){var i=this.game.input;if(!i.pollLocked){if(void 0===e&&(e=!1),void 0!==t.button&&(this.button=t.button),e&&this.isMouse&&this.updateButtons(t),this.clientX=t.clientX,this.clientY=t.clientY,this.pageX=t.pageX,this.pageY=t.pageY,this.screenX=t.screenX,this.screenY=t.screenY,this.isMouse&&i.mouse.locked&&!e&&(this.rawMovementX=t.movementX||t.mozMovementX||t.webkitMovementX||0,this.rawMovementY=t.movementY||t.mozMovementY||t.webkitMovementY||0,this.movementX+=this.rawMovementX,this.movementY+=this.rawMovementY),this.x=(this.pageX-this.game.scale.offset.x)*i.scale.x,this.y=(this.pageY-this.game.scale.offset.y)*i.scale.y,this.position.setTo(this.x,this.y),this.circle.x=this.x,this.circle.y=this.y,(i.multiInputOverride===U.Input.MOUSE_OVERRIDES_TOUCH||i.multiInputOverride===U.Input.MOUSE_TOUCH_COMBINE||i.multiInputOverride===U.Input.TOUCH_OVERRIDES_MOUSE&&0===i.totalActivePointers)&&(i.activePointer=this,i.x=this.x,i.y=this.y,i.position.setTo(i.x,i.y),i.circle.x=i.x,i.circle.y=i.y),this.withinGame=this.game.scale.bounds.contains(this.pageX,this.pageY),this.game.paused)return this;for(var n=i.moveCallbacks.length;n--;)i.moveCallbacks[n].callback.call(i.moveCallbacks[n].context,this,this.x,this.y,e);return null!==this.targetObject&&!0===this.targetObject.isDragged?!1===this.targetObject.update(this)&&(this.targetObject=null):0<i.interactiveItems.total&&this.processInteractiveObjects(e),this}},processInteractiveObjects:function(t){var e=0,i=-1,n=null,r=this.game.input.interactiveItems.first;for(this.interactiveCandidates=[];r;)r.checked=!1,r.validForInput(i,e,!1)&&(r.checked=!0,(t&&r.checkPointerDown(this,!0)||!t&&r.checkPointerOver(this,!0))&&(e=r.sprite.renderOrderID,i=r.priorityID,n=r,this.interactiveCandidates.push(r))),r=this.game.input.interactiveItems.next;for(r=this.game.input.interactiveItems.first;r;)!r.checked&&r.validForInput(i,e,!0)&&(t&&r.checkPointerDown(this,!1)||!t&&r.checkPointerOver(this,!1))&&(e=r.sprite.renderOrderID,i=r.priorityID,n=r,this.interactiveCandidates.push(r)),r=this.game.input.interactiveItems.next;return this.game.input.customCandidateHandler&&(n=this.game.input.customCandidateHandler.call(this.game.input.customCandidateHandlerContext,this,this.interactiveCandidates,n)),this.swapTarget(n,!1),null!==this.targetObject},swapTarget:function(t,e){void 0===e&&(e=!1),null===t?this.targetObject&&(this.targetObject._pointerOutHandler(this,e),this.targetObject=null):null===this.targetObject?(this.targetObject=t)._pointerOverHandler(this,e):this.targetObject===t?!1===t.update(this)&&(this.targetObject=null):(this.targetObject._pointerOutHandler(this,e),this.targetObject=t,this.targetObject._pointerOverHandler(this,e))},leave:function(t){this.withinGame=!1,this.move(t,!1)},stop:function(t){var e=this.game.input;if(!this._stateReset||!this.withinGame)return this.timeUp=this.game.time.time,(e.multiInputOverride===U.Input.MOUSE_OVERRIDES_TOUCH||e.multiInputOverride===U.Input.MOUSE_TOUCH_COMBINE||e.multiInputOverride===U.Input.TOUCH_OVERRIDES_MOUSE&&0===e.totalActivePointers)&&(e.onUp.dispatch(this,t),0<=this.duration&&this.duration<=e.tapRate&&(this.timeUp-this.previousTapTime<e.doubleTapRate?e.onTap.dispatch(this,!0):e.onTap.dispatch(this,!1),this.previousTapTime=this.timeUp)),this.isMouse?this.updateButtons(t):(this.isDown=!1,this.isUp=!0),0<this.id&&(this.active=!1),this.withinGame=this.game.scale.bounds.contains(t.pageX,t.pageY),this.pointerId=null,this.identifier=null,this.positionUp.setTo(this.x,this.y),!1===this.isMouse&&e.currentPointers--,e.interactiveItems.callAll("_releasedHandler",this),this._clickTrampolines&&(this._trampolineTargetObject=this.targetObject),this.targetObject=null,this;t.preventDefault()},justPressed:function(t){return t=t||this.game.input.justPressedRate,!0===this.isDown&&this.timeDown+t>this.game.time.time},justReleased:function(t){return t=t||this.game.input.justReleasedRate,this.isUp&&this.timeUp+t>this.game.time.time},addClickTrampoline:function(t,e,i,n){if(this.isDown){for(var r=this._clickTrampolines=this._clickTrampolines||[],o=0;o<r.length;o++)if(r[o].name===t){r.splice(o,1);break}r.push({name:t,targetObject:this.targetObject,callback:e,callbackContext:i,callbackArgs:n})}},processClickTrampolines:function(){var t=this._clickTrampolines;if(t){for(var e=0;e<t.length;e++){var i=t[e];i.targetObject===this._trampolineTargetObject&&i.callback.apply(i.callbackContext,i.callbackArgs)}this._clickTrampolines=null,this._trampolineTargetObject=null}},reset:function(){!1===this.isMouse&&(this.active=!1),this.pointerId=null,this.identifier=null,this.dirty=!1,this.totalTouches=0,this._holdSent=!1,this._history.length=0,this._stateReset=!0,this.resetButtons(),this.targetObject&&this.targetObject._releasedHandler(this),this.targetObject=null},resetMovement:function(){this.movementX=0,this.movementY=0}},U.Pointer.prototype.constructor=U.Pointer,Object.defineProperty(U.Pointer.prototype,"duration",{get:function(){return this.isUp?-1:this.game.time.time-this.timeDown}}),Object.defineProperty(U.Pointer.prototype,"worldX",{get:function(){return this.game.world.camera.x+this.x}}),Object.defineProperty(U.Pointer.prototype,"worldY",{get:function(){return this.game.world.camera.y+this.y}}),U.PointerMode={CURSOR:1,CONTACT:2},U.Touch=function(t){this.game=t,this.enabled=!0,this.touchLockCallbacks=[],this.callbackContext=this.game,this.touchStartCallback=null,this.touchMoveCallback=null,this.touchEndCallback=null,this.touchEnterCallback=null,this.touchLeaveCallback=null,this.touchCancelCallback=null,this.preventDefault=!0,this.event=null,this._onTouchStart=null,this._onTouchMove=null,this._onTouchEnd=null,this._onTouchEnter=null,this._onTouchLeave=null,this._onTouchCancel=null,this._onTouchMove=null},U.Touch.prototype={start:function(){var e;null!==this._onTouchStart||(e=this).game.device.touch&&(this._onTouchStart=function(t){return e.onTouchStart(t)},this._onTouchMove=function(t){return e.onTouchMove(t)},this._onTouchEnd=function(t){return e.onTouchEnd(t)},this._onTouchEnter=function(t){return e.onTouchEnter(t)},this._onTouchLeave=function(t){return e.onTouchLeave(t)},this._onTouchCancel=function(t){return e.onTouchCancel(t)},this.game.canvas.addEventListener("touchstart",this._onTouchStart,!1),this.game.canvas.addEventListener("touchmove",this._onTouchMove,!1),this.game.canvas.addEventListener("touchend",this._onTouchEnd,!1),this.game.canvas.addEventListener("touchcancel",this._onTouchCancel,!1),this.game.device.cocoonJS||(this.game.canvas.addEventListener("touchenter",this._onTouchEnter,!1),this.game.canvas.addEventListener("touchleave",this._onTouchLeave,!1)))},consumeDocumentTouches:function(){this._documentTouchMove=function(t){t.preventDefault()},document.addEventListener("touchmove",this._documentTouchMove,!1)},addTouchLockCallback:function(t,e,i){this.touchLockCallbacks.push({callback:t,context:e,onEnd:i=void 0===i?!1:i})},removeTouchLockCallback:function(t,e){for(var i=this.touchLockCallbacks.length;i--;)if(this.touchLockCallbacks[i].callback===t&&this.touchLockCallbacks[i].context===e)return this.touchLockCallbacks.splice(i,1),!0;return!1},onTouchStart:function(t){for(var e=this.touchLockCallbacks.length;e--;){var i=this.touchLockCallbacks[e];!i.onEnd&&i.callback.call(i.context,this,t)&&this.touchLockCallbacks.splice(e,1)}if(this.event=t,this.game.input.enabled&&this.enabled){this.touchStartCallback&&this.touchStartCallback.call(this.callbackContext,t),this.preventDefault&&t.preventDefault();for(e=0;e<t.changedTouches.length;e++)this.game.input.startPointer(t.changedTouches[e])}},onTouchCancel:function(t){if(this.event=t,this.touchCancelCallback&&this.touchCancelCallback.call(this.callbackContext,t),this.game.input.enabled&&this.enabled){this.preventDefault&&t.preventDefault();for(var e=0;e<t.changedTouches.length;e++)this.game.input.stopPointer(t.changedTouches[e])}},onTouchEnter:function(t){this.event=t,this.touchEnterCallback&&this.touchEnterCallback.call(this.callbackContext,t),this.game.input.enabled&&this.enabled&&this.preventDefault&&t.preventDefault()},onTouchLeave:function(t){this.event=t,this.touchLeaveCallback&&this.touchLeaveCallback.call(this.callbackContext,t),this.preventDefault&&t.preventDefault()},onTouchMove:function(t){this.event=t,this.touchMoveCallback&&this.touchMoveCallback.call(this.callbackContext,t),this.preventDefault&&t.preventDefault();for(var e=0;e<t.changedTouches.length;e++)this.game.input.updatePointer(t.changedTouches[e])},onTouchEnd:function(t){for(var e=this.touchLockCallbacks.length;e--;){var i=this.touchLockCallbacks[e];i.onEnd&&i.callback.call(i.context,this,t)&&this.touchLockCallbacks.splice(e,1)}this.event=t,this.touchEndCallback&&this.touchEndCallback.call(this.callbackContext,t),this.preventDefault&&t.preventDefault();for(e=0;e<t.changedTouches.length;e++)this.game.input.stopPointer(t.changedTouches[e])},stop:function(){this.game.device.touch&&(this.game.canvas.removeEventListener("touchstart",this._onTouchStart),this.game.canvas.removeEventListener("touchmove",this._onTouchMove),this.game.canvas.removeEventListener("touchend",this._onTouchEnd),this.game.canvas.removeEventListener("touchenter",this._onTouchEnter),this.game.canvas.removeEventListener("touchleave",this._onTouchLeave),this.game.canvas.removeEventListener("touchcancel",this._onTouchCancel))}},U.Touch.prototype.constructor=U.Touch,U.InputHandler=function(t){this.sprite=t,this.game=t.game,this.enabled=!1,this.checked=!1,this.priorityID=0,this.useHandCursor=!1,this._setHandCursor=!1,this.isDragged=!1,this.allowHorizontalDrag=!0,this.allowVerticalDrag=!0,this.bringToTop=!1,this.snapOffset=null,this.snapOnDrag=!1,this.snapOnRelease=!1,this.snapX=0,this.snapY=0,this.snapOffsetX=0,this.snapOffsetY=0,this.pixelPerfectOver=!1,this.pixelPerfectClick=!1,this.pixelPerfectAlpha=255,this.draggable=!1,this.boundsRect=null,this.boundsSprite=null,this.scaleLayer=!1,this.dragOffset=new U.Point,this.dragFromCenter=!1,this.dragStopBlocksInputUp=!1,this.dragStartPoint=new U.Point,this.dragDistanceThreshold=0,this.dragTimeThreshold=0,this.downPoint=new U.Point,this.snapPoint=new U.Point,this._dragPoint=new U.Point,this._dragPhase=!1,this._pendingDrag=!1,this._dragTimePass=!1,this._dragDistancePass=!1,this._wasEnabled=!1,this._tempPoint=new U.Point,this._pointerData=[],this._pointerData.push({id:0,x:0,y:0,camX:0,camY:0,isDown:!1,isUp:!1,isOver:!1,isOut:!1,timeOver:0,timeOut:0,timeDown:0,timeUp:0,downDuration:0,isDragged:!1})},U.InputHandler.prototype={start:function(t,e){if(t=t||0,void 0===e&&(e=!1),!1===this.enabled){this.game.input.interactiveItems.add(this),this.useHandCursor=e,this.priorityID=t;for(var i=0;i<10;i++)this._pointerData[i]={id:i,x:0,y:0,isDown:!1,isUp:!1,isOver:!1,isOut:!1,timeOver:0,timeOut:0,timeDown:0,timeUp:0,downDuration:0,isDragged:!1};this.snapOffset=new U.Point,this.enabled=!0,this._wasEnabled=!0}return this.sprite.events.onAddedToGroup.add(this.addedToGroup,this),this.sprite.events.onRemovedFromGroup.add(this.removedFromGroup,this),this.sprite},addedToGroup:function(){this._dragPhase||this._wasEnabled&&!this.enabled&&this.start()},removedFromGroup:function(){this._dragPhase||(this.enabled?(this._wasEnabled=!0,this.stop()):this._wasEnabled=!1)},reset:function(){this.enabled=!1;for(var t=0;t<10;t++)this._pointerData[t]={id:t,x:0,y:0,isDown:!1,isUp:!1,isOver:!1,isOut:!1,timeOver:0,timeOut:0,timeDown:0,timeUp:0,downDuration:0,isDragged:!1}},stop:function(){!1===this.enabled||(this.enabled=!1,this.game.input.interactiveItems.remove(this))},destroy:function(){this.sprite&&(this._setHandCursor&&(this.game.canvas.style.cursor="default",this._setHandCursor=!1),this.enabled=!1,this.game.input.interactiveItems.remove(this),this._pointerData.length=0,this.boundsRect=null,this.boundsSprite=null,this.sprite=null)},validForInput:function(t,e,i){return void 0===i&&(i=!0),!(!this.enabled||0===this.sprite.scale.x||0===this.sprite.scale.y||this.priorityID<this.game.input.minPriorityID||this.sprite.parent&&this.sprite.parent.ignoreChildInput)&&(!(!i&&(this.pixelPerfectClick||this.pixelPerfectOver))&&(this.priorityID>t||this.priorityID===t&&this.sprite.renderOrderID>e))},isPixelPerfect:function(){return this.pixelPerfectClick||this.pixelPerfectOver},pointerX:function(t){return this._pointerData[t=t||0].x},pointerY:function(t){return this._pointerData[t=t||0].y},pointerDown:function(t){return this._pointerData[t=t||0].isDown},pointerUp:function(t){return this._pointerData[t=t||0].isUp},pointerTimeDown:function(t){return this._pointerData[t=t||0].timeDown},pointerTimeUp:function(t){return this._pointerData[t=t||0].timeUp},pointerOver:function(t){if(!this.enabled)return!1;if(void 0!==t)return this._pointerData[t].isOver;for(var e=0;e<10;e++)if(this._pointerData[e].isOver)return!0;return!1},pointerOut:function(t){if(!this.enabled)return!1;if(void 0!==t)return this._pointerData[t].isOut;for(var e=0;e<10;e++)if(this._pointerData[e].isOut)return!0},pointerTimeOver:function(t){return this._pointerData[t=t||0].timeOver},pointerTimeOut:function(t){return this._pointerData[t=t||0].timeOut},pointerDragged:function(t){return this._pointerData[t=t||0].isDragged},checkPointerDown:function(t,e){return!!(t.isDown&&this.enabled&&this.sprite&&this.sprite.parent&&this.sprite.visible&&this.sprite.parent.visible&&0!==this.sprite.worldScale.x&&0!==this.sprite.worldScale.y)&&(!!this.game.input.hitTest(this.sprite,t,this._tempPoint)&&(!(!(e=void 0===e?!1:e)&&this.pixelPerfectClick)||this.checkPixel(this._tempPoint.x,this._tempPoint.y)))},checkPointerOver:function(t,e){return!!(this.enabled&&this.sprite&&this.sprite.parent&&this.sprite.visible&&this.sprite.parent.visible&&0!==this.sprite.worldScale.x&&0!==this.sprite.worldScale.y)&&(!!this.game.input.hitTest(this.sprite,t,this._tempPoint)&&(!(!(e=void 0===e?!1:e)&&this.pixelPerfectOver)||this.checkPixel(this._tempPoint.x,this._tempPoint.y)))},checkPixel:function(t,e,i){if(this.sprite.texture.baseTexture.source){if(null===t&&null===e&&(this.game.input.getLocalPosition(this.sprite,i,this._tempPoint),t=this._tempPoint.x,e=this._tempPoint.y),0!==this.sprite.anchor.x&&(t-=-this.sprite.texture.frame.width*this.sprite.anchor.x),0!==this.sprite.anchor.y&&(e-=-this.sprite.texture.frame.height*this.sprite.anchor.y),t+=this.sprite.texture.frame.x,e+=this.sprite.texture.frame.y,this.sprite.texture.trim&&(t-=this.sprite.texture.trim.x,e-=this.sprite.texture.trim.y,t<this.sprite.texture.crop.x||t>this.sprite.texture.crop.right||e<this.sprite.texture.crop.y||e>this.sprite.texture.crop.bottom))return this._dx=t,this._dy=e,!1;if(this._dx=t,this._dy=e,this.game.input.hitContext.clearRect(0,0,1,1),this.game.input.hitContext.drawImage(this.sprite.texture.baseTexture.source,t,e,1,1,0,0,1,1),this.game.input.hitContext.getImageData(0,0,1,1).data[3]>=this.pixelPerfectAlpha)return!0}return!1},update:function(t){if(null!==this.sprite&&void 0!==this.sprite.parent)return this.enabled&&this.sprite.visible&&this.sprite.parent.visible?this._pendingDrag?(this._dragDistancePass||(this._dragDistancePass=U.Math.distance(t.x,t.y,this.downPoint.x,this.downPoint.y)>=this.dragDistanceThreshold),this._dragDistancePass&&this._dragTimePass&&this.startDrag(t),!0):this.draggable&&this._draggedPointerID===t.id?this.updateDrag(t,!1):this._pointerData[t.id].isOver?this.checkPointerOver(t)?(this._pointerData[t.id].x=t.x-this.sprite.x,this._pointerData[t.id].y=t.y-this.sprite.y,!0):(this._pointerOutHandler(t),!1):void 0:(this._pointerOutHandler(t),!1)},_pointerOverHandler:function(t,e){var i,n;null!==this.sprite&&(!1!==(i=this._pointerData[t.id]).isOver&&!t.dirty||(n=!1===i.isOver,i.isOver=!0,i.isOut=!1,i.timeOver=this.game.time.time,i.x=t.x-this.sprite.x,i.y=t.y-this.sprite.y,this.useHandCursor&&!1===i.isDragged&&(this.game.canvas.style.cursor="pointer",this._setHandCursor=!0),!e&&n&&this.sprite&&this.sprite.events&&this.sprite.events.onInputOver$dispatch(this.sprite,t),this.sprite.parent&&this.sprite.parent.type===U.GROUP&&this.sprite.parent.onChildInputOver.dispatch(this.sprite,t)))},_pointerOutHandler:function(t,e){var i;null!==this.sprite&&((i=this._pointerData[t.id]).isOver=!1,i.isOut=!0,i.timeOut=this.game.time.time,this.useHandCursor&&!1===i.isDragged&&(this.game.canvas.style.cursor="default",this._setHandCursor=!1),!e&&this.sprite&&this.sprite.events&&(this.sprite.events.onInputOut$dispatch(this.sprite,t),this.sprite&&this.sprite.parent&&this.sprite.parent.type===U.GROUP&&this.sprite.parent.onChildInputOut.dispatch(this.sprite,t)))},_touchedHandler:function(t){var e;null===this.sprite||!(e=this._pointerData[t.id]).isDown&&e.isOver&&(this.pixelPerfectClick&&!this.checkPixel(null,null,t)||(e.isDown=!0,e.isUp=!1,e.timeDown=this.game.time.time,this.downPoint.set(t.x,t.y),t.dirty=!0,this.sprite&&this.sprite.events&&(this.sprite.events.onInputDown$dispatch(this.sprite,t),this.sprite&&this.sprite.parent&&this.sprite.parent.type===U.GROUP&&this.sprite.parent.onChildInputDown.dispatch(this.sprite,t),null===this.sprite)||(this.draggable&&!1===this.isDragged&&(0===this.dragTimeThreshold&&0===this.dragDistanceThreshold?this.startDrag(t):(this._pendingDrag=!0,this._dragDistancePass=0===this.dragDistanceThreshold,0<this.dragTimeThreshold?(this._dragTimePass=!1,this.game.time.events.add(this.dragTimeThreshold,this.dragTimeElapsed,this,t)):this._dragTimePass=!0)),this.bringToTop&&this.sprite.bringToTop())))},dragTimeElapsed:function(t){this._dragTimePass=!0,this._pendingDrag&&this.sprite&&this._dragDistancePass&&this.startDrag(t)},_releasedHandler:function(t){var e,i;null===this.sprite||(e=this._pointerData[t.id]).isDown&&t.isUp&&(e.isDown=!1,e.isUp=!0,e.timeUp=this.game.time.time,e.downDuration=e.timeUp-e.timeDown,i=this.checkPointerOver(t),this.sprite&&this.sprite.events&&(this.dragStopBlocksInputUp&&(!this.dragStopBlocksInputUp||this.draggable&&this.isDragged&&this._draggedPointerID===t.id)||this.sprite.events.onInputUp$dispatch(this.sprite,t,i),this.sprite&&this.sprite.parent&&this.sprite.parent.type===U.GROUP&&this.sprite.parent.onChildInputUp.dispatch(this.sprite,t,i),i=i&&this.checkPointerOver(t)),!(e.isOver=i)&&this.useHandCursor&&(this.game.canvas.style.cursor="default",this._setHandCursor=!1),t.dirty=!0,this._pendingDrag=!1,this.draggable&&this.isDragged&&this._draggedPointerID===t.id&&this.stopDrag(t))},updateDrag:function(t,e){if(void 0===e&&(e=!1),t.isUp)return this.stopDrag(t),!1;var i,n,r=this.globalToLocalX(t.x)+this._dragPoint.x+this.dragOffset.x,o=this.globalToLocalY(t.y)+this._dragPoint.y+this.dragOffset.y;return this.sprite.fixedToCamera?(this.allowHorizontalDrag&&(this.sprite.cameraOffset.x=r),this.allowVerticalDrag&&(this.sprite.cameraOffset.y=o),this.boundsRect&&this.checkBoundsRect(),this.boundsSprite&&this.checkBoundsSprite(),this.snapOnDrag&&(this.sprite.cameraOffset.x=Math.round((this.sprite.cameraOffset.x-this.snapOffsetX%this.snapX)/this.snapX)*this.snapX+this.snapOffsetX%this.snapX,this.sprite.cameraOffset.y=Math.round((this.sprite.cameraOffset.y-this.snapOffsetY%this.snapY)/this.snapY)*this.snapY+this.snapOffsetY%this.snapY,this.snapPoint.set(this.sprite.cameraOffset.x,this.sprite.cameraOffset.y))):(i=this.game.camera.x-this._pointerData[t.id].camX,n=this.game.camera.y-this._pointerData[t.id].camY,this.allowHorizontalDrag&&(this.sprite.x=r+i),this.allowVerticalDrag&&(this.sprite.y=o+n),this.boundsRect&&this.checkBoundsRect(),this.boundsSprite&&this.checkBoundsSprite(),this.snapOnDrag&&(this.sprite.x=Math.round((this.sprite.x-this.snapOffsetX%this.snapX)/this.snapX)*this.snapX+this.snapOffsetX%this.snapX,this.sprite.y=Math.round((this.sprite.y-this.snapOffsetY%this.snapY)/this.snapY)*this.snapY+this.snapOffsetY%this.snapY,this.snapPoint.set(this.sprite.x,this.sprite.y))),this.sprite.events.onDragUpdate.dispatch(this.sprite,t,r,o,this.snapPoint,e),!0},justOver:function(t,e){return e=e||500,this._pointerData[t=t||0].isOver&&this.overDuration(t)<e},justOut:function(t,e){return e=e||500,this._pointerData[t=t||0].isOut&&this.game.time.time-this._pointerData[t].timeOut<e},justPressed:function(t,e){return e=e||500,this._pointerData[t=t||0].isDown&&this.downDuration(t)<e},justReleased:function(t,e){return e=e||500,this._pointerData[t=t||0].isUp&&this.game.time.time-this._pointerData[t].timeUp<e},overDuration:function(t){return this._pointerData[t=t||0].isOver?this.game.time.time-this._pointerData[t].timeOver:-1},downDuration:function(t){return this._pointerData[t=t||0].isDown?this.game.time.time-this._pointerData[t].timeDown:-1},enableDrag:function(t,e,i,n,r,o){void 0===t&&(t=!1),void 0===e&&(e=!1),void 0===i&&(i=!1),void 0===n&&(n=255),void 0===r&&(r=null),void 0===o&&(o=null),this._dragPoint=new U.Point,this.draggable=!0,this.bringToTop=e,this.dragOffset=new U.Point,this.dragFromCenter=t,this.pixelPerfectClick=i,this.pixelPerfectAlpha=n,r&&(this.boundsRect=r),o&&(this.boundsSprite=o)},disableDrag:function(){if(this._pointerData)for(var t=0;t<10;t++)this._pointerData[t].isDragged=!1;this.draggable=!1,this.isDragged=!1,this._draggedPointerID=-1,this._pendingDrag=!1},startDrag:function(t){var e,i=this.sprite.x,n=this.sprite.y;this.isDragged=!0,this._draggedPointerID=t.id,this._pointerData[t.id].camX=this.game.camera.x,this._pointerData[t.id].camY=this.game.camera.y,this._pointerData[t.id].isDragged=!0,this.sprite.fixedToCamera?(this.dragFromCenter&&(e=this.sprite.getBounds(),this.sprite.cameraOffset.x=this.globalToLocalX(t.x)+(this.sprite.cameraOffset.x-e.centerX),this.sprite.cameraOffset.y=this.globalToLocalY(t.y)+(this.sprite.cameraOffset.y-e.centerY)),this._dragPoint.setTo(this.sprite.cameraOffset.x-t.x,this.sprite.cameraOffset.y-t.y)):(this.dragFromCenter&&(e=this.sprite.getBounds(),this.sprite.x=this.globalToLocalX(t.x)+(this.sprite.x-e.centerX),this.sprite.y=this.globalToLocalY(t.y)+(this.sprite.y-e.centerY)),this._dragPoint.setTo(this.sprite.x-this.globalToLocalX(t.x),this.sprite.y-this.globalToLocalY(t.y))),this.updateDrag(t,!0),this.bringToTop&&(this._dragPhase=!0,this.sprite.bringToTop()),this.dragStartPoint.set(i,n),this.sprite.events.onDragStart$dispatch(this.sprite,t,i,n),this._pendingDrag=!1},globalToLocalX:function(t){return this.scaleLayer&&(t-=this.game.scale.grid.boundsFluid.x,t*=this.game.scale.grid.scaleFluidInversed.x),t},globalToLocalY:function(t){return this.scaleLayer&&(t-=this.game.scale.grid.boundsFluid.y,t*=this.game.scale.grid.scaleFluidInversed.y),t},stopDrag:function(t){this.isDragged=!1,this._draggedPointerID=-1,this._pointerData[t.id].isDragged=!1,this._dragPhase=!1,this._pendingDrag=!1,this.snapOnRelease&&(this.sprite.fixedToCamera?(this.sprite.cameraOffset.x=Math.round((this.sprite.cameraOffset.x-this.snapOffsetX%this.snapX)/this.snapX)*this.snapX+this.snapOffsetX%this.snapX,this.sprite.cameraOffset.y=Math.round((this.sprite.cameraOffset.y-this.snapOffsetY%this.snapY)/this.snapY)*this.snapY+this.snapOffsetY%this.snapY):(this.sprite.x=Math.round((this.sprite.x-this.snapOffsetX%this.snapX)/this.snapX)*this.snapX+this.snapOffsetX%this.snapX,this.sprite.y=Math.round((this.sprite.y-this.snapOffsetY%this.snapY)/this.snapY)*this.snapY+this.snapOffsetY%this.snapY)),this.sprite.events.onDragStop$dispatch(this.sprite,t),!1===this.checkPointerOver(t)&&this._pointerOutHandler(t)},setDragLock:function(t,e){void 0===e&&(e=!0),this.allowHorizontalDrag=t=void 0===t?!0:t,this.allowVerticalDrag=e},enableSnap:function(t,e,i,n,r,o){void 0===i&&(i=!0),void 0===n&&(n=!1),void 0===r&&(r=0),void 0===o&&(o=0),this.snapX=t,this.snapY=e,this.snapOffsetX=r,this.snapOffsetY=o,this.snapOnDrag=i,this.snapOnRelease=n},disableSnap:function(){this.snapOnDrag=!1,this.snapOnRelease=!1},checkBoundsRect:function(){this.sprite.fixedToCamera?(this.sprite.cameraOffset.x<this.boundsRect.left?this.sprite.cameraOffset.x=this.boundsRect.left:this.sprite.cameraOffset.x+this.sprite.width>this.boundsRect.right&&(this.sprite.cameraOffset.x=this.boundsRect.right-this.sprite.width),this.sprite.cameraOffset.y<this.boundsRect.top?this.sprite.cameraOffset.y=this.boundsRect.top:this.sprite.cameraOffset.y+this.sprite.height>this.boundsRect.bottom&&(this.sprite.cameraOffset.y=this.boundsRect.bottom-this.sprite.height)):(this.sprite.left<this.boundsRect.left?this.sprite.x=this.boundsRect.x+this.sprite.offsetX:this.sprite.right>this.boundsRect.right&&(this.sprite.x=this.boundsRect.right-(this.sprite.width-this.sprite.offsetX)),this.sprite.top<this.boundsRect.top?this.sprite.y=this.boundsRect.top+this.sprite.offsetY:this.sprite.bottom>this.boundsRect.bottom&&(this.sprite.y=this.boundsRect.bottom-(this.sprite.height-this.sprite.offsetY)))},checkBoundsSprite:function(){this.sprite.fixedToCamera&&this.boundsSprite.fixedToCamera?(this.sprite.cameraOffset.x<this.boundsSprite.cameraOffset.x?this.sprite.cameraOffset.x=this.boundsSprite.cameraOffset.x:this.sprite.cameraOffset.x+this.sprite.width>this.boundsSprite.cameraOffset.x+this.boundsSprite.width&&(this.sprite.cameraOffset.x=this.boundsSprite.cameraOffset.x+this.boundsSprite.width-this.sprite.width),this.sprite.cameraOffset.y<this.boundsSprite.cameraOffset.y?this.sprite.cameraOffset.y=this.boundsSprite.cameraOffset.y:this.sprite.cameraOffset.y+this.sprite.height>this.boundsSprite.cameraOffset.y+this.boundsSprite.height&&(this.sprite.cameraOffset.y=this.boundsSprite.cameraOffset.y+this.boundsSprite.height-this.sprite.height)):(this.sprite.left<this.boundsSprite.left?this.sprite.x=this.boundsSprite.left+this.sprite.offsetX:this.sprite.right>this.boundsSprite.right&&(this.sprite.x=this.boundsSprite.right-(this.sprite.width-this.sprite.offsetX)),this.sprite.top<this.boundsSprite.top?this.sprite.y=this.boundsSprite.top+this.sprite.offsetY:this.sprite.bottom>this.boundsSprite.bottom&&(this.sprite.y=this.boundsSprite.bottom-(this.sprite.height-this.sprite.offsetY)))}},U.InputHandler.prototype.constructor=U.InputHandler,U.Gamepad=function(t){this.game=t,this._gamepadIndexMap={},this._rawPads=[],this._active=!1,this.enabled=!0,this._gamepadSupportAvailable=!!navigator.webkitGetGamepads||!!navigator.webkitGamepads||-1!==navigator.userAgent.indexOf("Firefox/")||!!navigator.getGamepads,this._prevRawGamepadTypes=[],this._prevTimestamps=[],(this.callbackContext=this).onConnectCallback=null,this.onDisconnectCallback=null,this.onDownCallback=null,this.onUpCallback=null,this.onAxisCallback=null,this.onFloatCallback=null,this._ongamepadconnected=null,this._gamepaddisconnected=null,this._gamepads=[new U.SinglePad(t,this),new U.SinglePad(t,this),new U.SinglePad(t,this),new U.SinglePad(t,this)]},U.Gamepad.prototype={addCallbacks:function(t,e){void 0!==e&&(this.onConnectCallback="function"==typeof e.onConnect?e.onConnect:this.onConnectCallback,this.onDisconnectCallback="function"==typeof e.onDisconnect?e.onDisconnect:this.onDisconnectCallback,this.onDownCallback="function"==typeof e.onDown?e.onDown:this.onDownCallback,this.onUpCallback="function"==typeof e.onUp?e.onUp:this.onUpCallback,this.onAxisCallback="function"==typeof e.onAxis?e.onAxis:this.onAxisCallback,this.onFloatCallback="function"==typeof e.onFloat?e.onFloat:this.onFloatCallback,this.callbackContext=t)},start:function(){var e;this._active||(this._active=!0,(e=this)._onGamepadConnected=function(t){return e.onGamepadConnected(t)},this._onGamepadDisconnected=function(t){return e.onGamepadDisconnected(t)},window.addEventListener("gamepadconnected",this._onGamepadConnected,!1),window.addEventListener("gamepaddisconnected",this._onGamepadDisconnected,!1))},onGamepadConnected:function(t){t=t.gamepad;this._rawPads.push(t),this._gamepads[t.index].connect(t)},onGamepadDisconnected:function(t){var e,i=t.gamepad;for(e in this._rawPads)this._rawPads[e].index===i.index&&this._rawPads.splice(e,1);this._gamepads[i.index].disconnect()},update:function(){this._pollGamepads(),this.pad1.pollStatus(),this.pad2.pollStatus(),this.pad3.pollStatus(),this.pad4.pollStatus()},_pollGamepads:function(){var t;if(this._active&&(navigator.getGamepads?t=navigator.getGamepads():navigator.webkitGetGamepads?t=navigator.webkitGetGamepads():navigator.webkitGamepads&&(t=navigator.webkitGamepads()),t)){for(var e=!(this._rawPads=[]),i=0;i<t.length&&(typeof t[i]!==this._prevRawGamepadTypes[i]&&(e=!0,this._prevRawGamepadTypes[i]=typeof t[i]),t[i]&&this._rawPads.push(t[i]),3!==i);i++);for(var n=0;n<this._gamepads.length;n++)this._gamepads[n]._rawPad=this._rawPads[n];if(e){for(var r,o={rawIndices:{},padIndices:{}},s=0;s<this._gamepads.length;s++)if((r=this._gamepads[s]).connected)for(var a=0;a<this._rawPads.length;a++)this._rawPads[a].index===r.index&&(o.rawIndices[r.index]=!0,o.padIndices[s]=!0);for(var h=0;h<this._gamepads.length;h++)if(r=this._gamepads[h],!o.padIndices[h]){this._rawPads.length<1&&r.disconnect();for(var l=0;l<this._rawPads.length&&!o.padIndices[h];l++){var p=this._rawPads[l];!p||o.rawIndices[p.index]?r.disconnect():(r.connect(p),o.rawIndices[p.index]=!0,o.padIndices[h]=!0)}}}}},setDeadZones:function(t){for(var e=0;e<this._gamepads.length;e++)this._gamepads[e].deadZone=t},stop:function(){this._active=!1,window.removeEventListener("gamepadconnected",this._onGamepadConnected),window.removeEventListener("gamepaddisconnected",this._onGamepadDisconnected)},reset:function(){this.update();for(var t=0;t<this._gamepads.length;t++)this._gamepads[t].reset()},justPressed:function(t,e){for(var i=0;i<this._gamepads.length;i++)if(!0===this._gamepads[i].justPressed(t,e))return!0;return!1},justReleased:function(t,e){for(var i=0;i<this._gamepads.length;i++)if(!0===this._gamepads[i].justReleased(t,e))return!0;return!1},isDown:function(t){for(var e=0;e<this._gamepads.length;e++)if(!0===this._gamepads[e].isDown(t))return!0;return!1},destroy:function(){this.stop();for(var t=0;t<this._gamepads.length;t++)this._gamepads[t].destroy()}},U.Gamepad.prototype.constructor=U.Gamepad,Object.defineProperty(U.Gamepad.prototype,"active",{get:function(){return this._active}}),Object.defineProperty(U.Gamepad.prototype,"supported",{get:function(){return this._gamepadSupportAvailable}}),Object.defineProperty(U.Gamepad.prototype,"padsConnected",{get:function(){return this._rawPads.length}}),Object.defineProperty(U.Gamepad.prototype,"pad1",{get:function(){return this._gamepads[0]}}),Object.defineProperty(U.Gamepad.prototype,"pad2",{get:function(){return this._gamepads[1]}}),Object.defineProperty(U.Gamepad.prototype,"pad3",{get:function(){return this._gamepads[2]}}),Object.defineProperty(U.Gamepad.prototype,"pad4",{get:function(){return this._gamepads[3]}}),U.Gamepad.BUTTON_0=0,U.Gamepad.BUTTON_1=1,U.Gamepad.BUTTON_2=2,U.Gamepad.BUTTON_3=3,U.Gamepad.BUTTON_4=4,U.Gamepad.BUTTON_5=5,U.Gamepad.BUTTON_6=6,U.Gamepad.BUTTON_7=7,U.Gamepad.BUTTON_8=8,U.Gamepad.BUTTON_9=9,U.Gamepad.BUTTON_10=10,U.Gamepad.BUTTON_11=11,U.Gamepad.BUTTON_12=12,U.Gamepad.BUTTON_13=13,U.Gamepad.BUTTON_14=14,U.Gamepad.BUTTON_15=15,U.Gamepad.AXIS_0=0,U.Gamepad.AXIS_1=1,U.Gamepad.AXIS_2=2,U.Gamepad.AXIS_3=3,U.Gamepad.AXIS_4=4,U.Gamepad.AXIS_5=5,U.Gamepad.AXIS_6=6,U.Gamepad.AXIS_7=7,U.Gamepad.AXIS_8=8,U.Gamepad.AXIS_9=9,U.Gamepad.XBOX360_A=0,U.Gamepad.XBOX360_B=1,U.Gamepad.XBOX360_X=2,U.Gamepad.XBOX360_Y=3,U.Gamepad.XBOX360_LEFT_BUMPER=4,U.Gamepad.XBOX360_RIGHT_BUMPER=5,U.Gamepad.XBOX360_LEFT_TRIGGER=6,U.Gamepad.XBOX360_RIGHT_TRIGGER=7,U.Gamepad.XBOX360_BACK=8,U.Gamepad.XBOX360_START=9,U.Gamepad.XBOX360_STICK_LEFT_BUTTON=10,U.Gamepad.XBOX360_STICK_RIGHT_BUTTON=11,U.Gamepad.XBOX360_DPAD_LEFT=14,U.Gamepad.XBOX360_DPAD_RIGHT=15,U.Gamepad.XBOX360_DPAD_UP=12,U.Gamepad.XBOX360_DPAD_DOWN=13,U.Gamepad.XBOX360_STICK_LEFT_X=0,U.Gamepad.XBOX360_STICK_LEFT_Y=1,U.Gamepad.XBOX360_STICK_RIGHT_X=2,U.Gamepad.XBOX360_STICK_RIGHT_Y=3,U.Gamepad.PS3XC_X=0,U.Gamepad.PS3XC_CIRCLE=1,U.Gamepad.PS3XC_SQUARE=2,U.Gamepad.PS3XC_TRIANGLE=3,U.Gamepad.PS3XC_L1=4,U.Gamepad.PS3XC_R1=5,U.Gamepad.PS3XC_L2=6,U.Gamepad.PS3XC_R2=7,U.Gamepad.PS3XC_SELECT=8,U.Gamepad.PS3XC_START=9,U.Gamepad.PS3XC_STICK_LEFT_BUTTON=10,U.Gamepad.PS3XC_STICK_RIGHT_BUTTON=11,U.Gamepad.PS3XC_DPAD_UP=12,U.Gamepad.PS3XC_DPAD_DOWN=13,U.Gamepad.PS3XC_DPAD_LEFT=14,U.Gamepad.PS3XC_DPAD_RIGHT=15,U.Gamepad.PS3XC_STICK_LEFT_X=0,U.Gamepad.PS3XC_STICK_LEFT_Y=1,U.Gamepad.PS3XC_STICK_RIGHT_X=2,U.Gamepad.PS3XC_STICK_RIGHT_Y=3,U.SinglePad=function(t,e){this.game=t,this.index=null,this.connected=!1,(this.callbackContext=this).onConnectCallback=null,this.onDisconnectCallback=null,this.onDownCallback=null,this.onUpCallback=null,this.onAxisCallback=null,this.onFloatCallback=null,this.deadZone=.26,this._padParent=e,this._rawPad=null,this._prevTimestamp=null,this._buttons=[],this._buttonsLen=0,this._axes=[],this._axesLen=0},U.SinglePad.prototype={addCallbacks:function(t,e){void 0!==e&&(this.onConnectCallback="function"==typeof e.onConnect?e.onConnect:this.onConnectCallback,this.onDisconnectCallback="function"==typeof e.onDisconnect?e.onDisconnect:this.onDisconnectCallback,this.onDownCallback="function"==typeof e.onDown?e.onDown:this.onDownCallback,this.onUpCallback="function"==typeof e.onUp?e.onUp:this.onUpCallback,this.onAxisCallback="function"==typeof e.onAxis?e.onAxis:this.onAxisCallback,this.onFloatCallback="function"==typeof e.onFloat?e.onFloat:this.onFloatCallback,this.callbackContext=t)},getButton:function(t){return this._buttons[t]||null},pollStatus:function(){if(this.connected&&this.game.input.enabled&&this.game.input.gamepad.enabled&&(!this._rawPad.timestamp||this._rawPad.timestamp!==this._prevTimestamp)){for(var t=0;t<this._buttonsLen;t++){var e=isNaN(this._rawPad.buttons[t])?this._rawPad.buttons[t].value:this._rawPad.buttons[t];e!==this._buttons[t].value&&(1===e?this.processButtonDown(t,e):0===e?this.processButtonUp(t,e):this.processButtonFloat(t,e))}for(var i=0;i<this._axesLen;i++){var n=this._rawPad.axes[i];0<n&&n>this.deadZone||n<0&&n<-this.deadZone?this.processAxisChange(i,n):this.processAxisChange(i,0)}this._prevTimestamp=this._rawPad.timestamp}},connect:function(t){var e=!this.connected;this.connected=!0,this.index=t.index,this._rawPad=t,this._buttons=[],this._buttonsLen=t.buttons.length,this._axes=[],this._axesLen=t.axes.length;for(var i,n=0;n<this._axesLen;n++)this._axes[n]=t.axes[n];for(i in t.buttons)i=parseInt(i,10),this._buttons[i]=new U.DeviceButton(this,i);e&&this._padParent.onConnectCallback&&this._padParent.onConnectCallback.call(this._padParent.callbackContext,this.index),e&&this.onConnectCallback&&this.onConnectCallback.call(this.callbackContext)},disconnect:function(){var t=this.connected,e=this.index;this.connected=!1,this.index=null,this._rawPad=void 0;for(var i=0;i<this._buttonsLen;i++)this._buttons[i].destroy();this._buttons=[],this._buttonsLen=0,this._axes=[],this._axesLen=0,t&&this._padParent.onDisconnectCallback&&this._padParent.onDisconnectCallback.call(this._padParent.callbackContext,e),t&&this.onDisconnectCallback&&this.onDisconnectCallback.call(this.callbackContext)},destroy:function(){this._rawPad=void 0;for(var t=0;t<this._buttonsLen;t++)this._buttons[t].destroy();this._buttons=[],this._buttonsLen=0,this._axes=[],this._axesLen=0,this.onConnectCallback=null,this.onDisconnectCallback=null,this.onDownCallback=null,this.onUpCallback=null,this.onAxisCallback=null,this.onFloatCallback=null},processAxisChange:function(t,e){this._axes[t]!==e&&(this._axes[t]=e,this._padParent.onAxisCallback&&this._padParent.onAxisCallback.call(this._padParent.callbackContext,this,t,e),this.onAxisCallback&&this.onAxisCallback.call(this.callbackContext,this,t,e))},processButtonDown:function(t,e){this._buttons[t]&&this._buttons[t].start(null,e),this._padParent.onDownCallback&&this._padParent.onDownCallback.call(this._padParent.callbackContext,t,e,this.index),this.onDownCallback&&this.onDownCallback.call(this.callbackContext,t,e)},processButtonUp:function(t,e){this._padParent.onUpCallback&&this._padParent.onUpCallback.call(this._padParent.callbackContext,t,e,this.index),this.onUpCallback&&this.onUpCallback.call(this.callbackContext,t,e),this._buttons[t]&&this._buttons[t].stop(null,e)},processButtonFloat:function(t,e){this._padParent.onFloatCallback&&this._padParent.onFloatCallback.call(this._padParent.callbackContext,t,e,this.index),this.onFloatCallback&&this.onFloatCallback.call(this.callbackContext,t,e),this._buttons[t]&&this._buttons[t].padFloat(e)},axis:function(t){return this._axes[t]||!1},isDown:function(t){return!!this._buttons[t]&&this._buttons[t].isDown},isUp:function(t){return!!this._buttons[t]&&this._buttons[t].isUp},justReleased:function(t,e){if(this._buttons[t])return this._buttons[t].justReleased(e)},justPressed:function(t,e){if(this._buttons[t])return this._buttons[t].justPressed(e)},buttonValue:function(t){return this._buttons[t]?this._buttons[t].value:null},reset:function(){for(var t=0;t<this._axes.length;t++)this._axes[t]=0}},U.SinglePad.prototype.constructor=U.SinglePad,U.Key=function(t,e){this.game=t,this._enabled=!0,this.event=null,this.isDown=!1,this.isUp=!0,this.altKey=!1,this.ctrlKey=!1,this.shiftKey=!1,this.timeDown=0,this.duration=0,this.timeUp=-2500,this.repeats=0,this.keyCode=e,this.onDown=new U.Signal,this.onHoldCallback=null,this.onHoldContext=null,this.onUp=new U.Signal,this._justDown=!1,this._justUp=!1},U.Key.prototype={update:function(){this._enabled&&this.isDown&&(this.duration=this.game.time.time-this.timeDown,this.repeats++,this.onHoldCallback&&this.onHoldCallback.call(this.onHoldContext,this))},processKeyDown:function(t){this._enabled&&(this.event=t,this.isDown||(this.altKey=t.altKey,this.ctrlKey=t.ctrlKey,this.shiftKey=t.shiftKey,this.isDown=!0,this.isUp=!1,this.timeDown=this.game.time.time,this.duration=0,this.repeats=0,this._justDown=!0,this.onDown.dispatch(this)))},processKeyUp:function(t){this._enabled&&(this.event=t,this.isUp||(this.isDown=!1,this.isUp=!0,this.timeUp=this.game.time.time,this.duration=this.game.time.time-this.timeDown,this._justUp=!0,this.onUp.dispatch(this)))},reset:function(t){void 0===t&&(t=!0),this.isDown=!1,this.isUp=!0,this.timeUp=this.game.time.time,this.duration=0,this._enabled=!0,this._justDown=!1,this._justUp=!1,t&&(this.onDown.removeAll(),this.onUp.removeAll(),this.onHoldCallback=null,this.onHoldContext=null)},downDuration:function(t){return void 0===t&&(t=50),this.isDown&&this.duration<t},upDuration:function(t){return void 0===t&&(t=50),!this.isDown&&this.game.time.time-this.timeUp<t}},Object.defineProperty(U.Key.prototype,"justDown",{get:function(){var t=this._justDown;return this._justDown=!1,t}}),Object.defineProperty(U.Key.prototype,"justUp",{get:function(){var t=this._justUp;return this._justUp=!1,t}}),Object.defineProperty(U.Key.prototype,"enabled",{get:function(){return this._enabled},set:function(t){(t=!!t)!==this._enabled&&(t||this.reset(!1),this._enabled=t)}}),U.Key.prototype.constructor=U.Key,U.Keyboard=function(t){this.game=t,this.enabled=!0,this.event=null,this.pressEvent=null,(this.callbackContext=this).onDownCallback=null,this.onPressCallback=null,this.onUpCallback=null,this._keys=[],this._capture=[],this._onKeyDown=null,this._onKeyPress=null,this._onKeyUp=null,this._i=0,this._k=0},U.Keyboard.prototype={addCallbacks:function(t,e,i,n){this.callbackContext=t,null!=e&&(this.onDownCallback=e),null!=i&&(this.onUpCallback=i),null!=n&&(this.onPressCallback=n)},addKey:function(t){return this._keys[t]||(this._keys[t]=new U.Key(this.game,t),this.addKeyCapture(t)),this._keys[t]},addKeys:function(t){var e,i={};for(e in t)i[e]=this.addKey(t[e]);return i},removeKey:function(t){this._keys[t]&&(this._keys[t]=null,this.removeKeyCapture(t))},createCursorKeys:function(){return this.addKeys({up:U.KeyCode.UP,down:U.KeyCode.DOWN,left:U.KeyCode.LEFT,right:U.KeyCode.RIGHT})},start:function(){var e;this.game.device.cocoonJS||null===this._onKeyDown&&((e=this)._onKeyDown=function(t){return e.processKeyDown(t)},this._onKeyUp=function(t){return e.processKeyUp(t)},this._onKeyPress=function(t){return e.processKeyPress(t)},window.addEventListener("keydown",this._onKeyDown,!1),window.addEventListener("keyup",this._onKeyUp,!1),window.addEventListener("keypress",this._onKeyPress,!1))},stop:function(){window.removeEventListener("keydown",this._onKeyDown),window.removeEventListener("keyup",this._onKeyUp),window.removeEventListener("keypress",this._onKeyPress),this._onKeyDown=null,this._onKeyUp=null,this._onKeyPress=null},destroy:function(){this.stop(),this.clearCaptures(),this._keys.length=0,this._i=0},addKeyCapture:function(t){if("object"==typeof t)for(var e in t)this._capture[t[e]]=!0;else this._capture[t]=!0},removeKeyCapture:function(t){delete this._capture[t]},clearCaptures:function(){this._capture={}},update:function(){for(this._i=this._keys.length;this._i--;)this._keys[this._i]&&this._keys[this._i].update()},processKeyDown:function(t){var e;this.event=t,this.game.input.enabled&&this.enabled&&(e=t.keyCode,this._capture[e]&&t.preventDefault(),this._keys[e]||(this._keys[e]=new U.Key(this.game,e)),this._keys[e].processKeyDown(t),this._k=e,this.onDownCallback&&this.onDownCallback.call(this.callbackContext,t))},processKeyPress:function(t){this.pressEvent=t,this.game.input.enabled&&this.enabled&&this.onPressCallback&&this.onPressCallback.call(this.callbackContext,String.fromCharCode(t.charCode),t)},processKeyUp:function(t){var e;this.event=t,this.game.input.enabled&&this.enabled&&(e=t.keyCode,this._capture[e]&&t.preventDefault(),this._keys[e]||(this._keys[e]=new U.Key(this.game,e)),this._keys[e].processKeyUp(t),this.onUpCallback&&this.onUpCallback.call(this.callbackContext,t))},reset:function(t){void 0===t&&(t=!0),this.event=null;for(var e=this._keys.length;e--;)this._keys[e]&&this._keys[e].reset(t)},downDuration:function(t,e){return this._keys[t]?this._keys[t].downDuration(e):null},upDuration:function(t,e){return this._keys[t]?this._keys[t].upDuration(e):null},isDown:function(t){return this._keys[t]?this._keys[t].isDown:null}},Object.defineProperty(U.Keyboard.prototype,"lastChar",{get:function(){return 32===this.event.charCode?"":String.fromCharCode(this.pressEvent.charCode)}}),Object.defineProperty(U.Keyboard.prototype,"lastKey",{get:function(){return this._keys[this._k]}}),U.Keyboard.prototype.constructor=U.Keyboard,U.KeyCode={A:"A".charCodeAt(0),B:"B".charCodeAt(0),C:"C".charCodeAt(0),D:"D".charCodeAt(0),E:"E".charCodeAt(0),F:"F".charCodeAt(0),G:"G".charCodeAt(0),H:"H".charCodeAt(0),I:"I".charCodeAt(0),J:"J".charCodeAt(0),K:"K".charCodeAt(0),L:"L".charCodeAt(0),M:"M".charCodeAt(0),N:"N".charCodeAt(0),O:"O".charCodeAt(0),P:"P".charCodeAt(0),Q:"Q".charCodeAt(0),R:"R".charCodeAt(0),S:"S".charCodeAt(0),T:"T".charCodeAt(0),U:"U".charCodeAt(0),V:"V".charCodeAt(0),W:"W".charCodeAt(0),X:"X".charCodeAt(0),Y:"Y".charCodeAt(0),Z:"Z".charCodeAt(0),ZERO:"0".charCodeAt(0),ONE:"1".charCodeAt(0),TWO:"2".charCodeAt(0),THREE:"3".charCodeAt(0),FOUR:"4".charCodeAt(0),FIVE:"5".charCodeAt(0),SIX:"6".charCodeAt(0),SEVEN:"7".charCodeAt(0),EIGHT:"8".charCodeAt(0),NINE:"9".charCodeAt(0),NUMPAD_0:96,NUMPAD_1:97,NUMPAD_2:98,NUMPAD_3:99,NUMPAD_4:100,NUMPAD_5:101,NUMPAD_6:102,NUMPAD_7:103,NUMPAD_8:104,NUMPAD_9:105,NUMPAD_MULTIPLY:106,NUMPAD_ADD:107,NUMPAD_ENTER:108,NUMPAD_SUBTRACT:109,NUMPAD_DECIMAL:110,NUMPAD_DIVIDE:111,F1:112,F2:113,F3:114,F4:115,F5:116,F6:117,F7:118,F8:119,F9:120,F10:121,F11:122,F12:123,F13:124,F14:125,F15:126,COLON:186,EQUALS:187,COMMA:188,UNDERSCORE:189,PERIOD:190,QUESTION_MARK:191,TILDE:192,OPEN_BRACKET:219,BACKWARD_SLASH:220,CLOSED_BRACKET:221,QUOTES:222,BACKSPACE:8,TAB:9,CLEAR:12,ENTER:13,SHIFT:16,CONTROL:17,ALT:18,CAPS_LOCK:20,ESC:27,SPACEBAR:32,PAGE_UP:33,PAGE_DOWN:34,END:35,HOME:36,LEFT:37,UP:38,RIGHT:39,DOWN:40,PLUS:43,MINUS:44,INSERT:45,DELETE:46,HELP:47,NUM_LOCK:144},U.KeyCode)U.KeyCode.hasOwnProperty(e)&&!e.match(/[a-z]/)&&(U.Keyboard[e]=U.KeyCode[e]);for(i in U.Component=function(){},U.Component.Angle=function(){},U.Component.Angle.prototype={angle:{get:function(){return U.Math.wrapAngle(U.Math.radToDeg(this.rotation))},set:function(t){this.rotation=U.Math.degToRad(U.Math.wrapAngle(t))}}},U.Component.Animation=function(){},U.Component.Animation.prototype={play:function(t,e,i,n){if(this.animations)return this.animations.play(t,e,i,n)}},U.Component.AutoCull=function(){},U.Component.AutoCull.prototype={autoCull:!1,inCamera:{get:function(){return this.autoCull||this.checkWorldBounds||(this._bounds.copyFrom(this.getBounds()),this._bounds.x+=this.game.camera.view.x,this._bounds.y+=this.game.camera.view.y),this.game.world.camera.view.intersects(this._bounds)}}},U.Component.Bounds=function(){},U.Component.Bounds.prototype={offsetX:{get:function(){return this.anchor.x*this.width}},offsetY:{get:function(){return this.anchor.y*this.height}},centerX:{get:function(){return this.x-this.offsetX+.5*this.width},set:function(t){this.x=t+this.offsetX-.5*this.width}},centerY:{get:function(){return this.y-this.offsetY+.5*this.height},set:function(t){this.y=t+this.offsetY-.5*this.height}},left:{get:function(){return this.x-this.offsetX},set:function(t){this.x=t+this.offsetX}},right:{get:function(){return this.x+this.width-this.offsetX},set:function(t){this.x=t-this.width+this.offsetX}},top:{get:function(){return this.y-this.offsetY},set:function(t){this.y=t+this.offsetY}},bottom:{get:function(){return this.y+this.height-this.offsetY},set:function(t){this.y=t-this.height+this.offsetY}},alignIn:function(t,e,i,n){switch(void 0===i&&(i=0),void 0===n&&(n=0),e){default:case U.TOP_LEFT:this.left=t.left-i,this.top=t.top-n;break;case U.TOP_CENTER:this.centerX=t.centerX+i,this.top=t.top-n;break;case U.TOP_RIGHT:this.right=t.right+i,this.top=t.top-n;break;case U.LEFT_CENTER:this.left=t.left-i,this.centerY=t.centerY+n;break;case U.CENTER:this.centerX=t.centerX+i,this.centerY=t.centerY+n;break;case U.RIGHT_CENTER:this.right=t.right+i,this.centerY=t.centerY+n;break;case U.BOTTOM_LEFT:this.left=t.left-i,this.bottom=t.bottom+n;break;case U.BOTTOM_CENTER:this.centerX=t.centerX+i,this.bottom=t.bottom+n;break;case U.BOTTOM_RIGHT:this.right=t.right+i,this.bottom=t.bottom+n}return this},alignTo:function(t,e,i,n){switch(void 0===i&&(i=0),void 0===n&&(n=0),e){default:case U.TOP_LEFT:this.left=t.left-i,this.bottom=t.top-n;break;case U.TOP_CENTER:this.centerX=t.centerX+i,this.bottom=t.top-n;break;case U.TOP_RIGHT:this.right=t.right+i,this.bottom=t.top-n;break;case U.LEFT_TOP:this.right=t.left-i,this.top=t.top-n;break;case U.LEFT_CENTER:this.right=t.left-i,this.centerY=t.centerY+n;break;case U.LEFT_BOTTOM:this.right=t.left-i,this.bottom=t.bottom+n;break;case U.RIGHT_TOP:this.left=t.right+i,this.top=t.top-n;break;case U.RIGHT_CENTER:this.left=t.right+i,this.centerY=t.centerY+n;break;case U.RIGHT_BOTTOM:this.left=t.right+i,this.bottom=t.bottom+n;break;case U.BOTTOM_LEFT:this.left=t.left-i,this.top=t.bottom+n;break;case U.BOTTOM_CENTER:this.centerX=t.centerX+i,this.top=t.bottom+n;break;case U.BOTTOM_RIGHT:this.right=t.right+i,this.top=t.bottom+n}return this}},U.Group.prototype.alignIn=U.Component.Bounds.prototype.alignIn,U.Group.prototype.alignTo=U.Component.Bounds.prototype.alignTo,U.Component.BringToTop=function(){},U.Component.BringToTop.prototype.bringToTop=function(){return this.parent&&this.parent.bringToTop(this),this},U.Component.BringToTop.prototype.sendToBack=function(){return this.parent&&this.parent.sendToBack(this),this},U.Component.BringToTop.prototype.moveUp=function(){return this.parent&&this.parent.moveUp(this),this},U.Component.BringToTop.prototype.moveDown=function(){return this.parent&&this.parent.moveDown(this),this},U.Component.Core=function(){},U.Component.Core.install=function(t){U.Utils.mixinPrototype(this,U.Component.Core.prototype),this.components={};for(var e=0;e<t.length;e++){var i=t[e],n="Destroy"===i?!0:!1;U.Utils.mixinPrototype(this,U.Component[i].prototype,n),this.components[i]=!0}},U.Component.Core.init=function(t,e,i,n,r){this.game=t,this.key=n,this.data={},this.position.set(e,i),this.world=new U.Point(e,i),this.previousPosition=new U.Point(e,i),this.events=new U.Events(this),this._bounds=new U.Rectangle,this.components.PhysicsBody&&(this.body=this.body),this.components.Animation&&(this.animations=new U.AnimationManager(this)),this.components.LoadTexture&&null!==n&&this.loadTexture(n,r),this.components.FixedToCamera&&(this.cameraOffset=new U.Point(e,i))},U.Component.Core.preUpdate=function(){if(!this.pendingDestroy){if(this.previousPosition.set(this.world.x,this.world.y),this.previousRotation=this.rotation,!this.exists||!this.parent.exists)return!(this.renderOrderID=-1);this.world.setTo(this.game.camera.x+this.worldTransform.tx,this.game.camera.y+this.worldTransform.ty),this.visible&&(this.renderOrderID=this.game.stage.currentRenderOrderID++),this.animations&&this.animations.update(),this.body&&this.body.preUpdate();for(var t=0;t<this.children.length;t++)this.children[t].preUpdate();return!0}this.destroy()},U.Component.Core.prototype={game:null,name:"",data:{},components:{},z:0,events:void 0,animations:void 0,key:"",world:null,debug:!1,previousPosition:null,previousRotation:0,renderOrderID:0,fresh:!0,pendingDestroy:!1,_bounds:null,_exists:!0,exists:{get:function(){return this._exists},set:function(t){t?(this._exists=!0,this.body&&this.body.type===U.Physics.P2JS&&this.body.addToWorld(),this.visible=!0):(this._exists=!1,this.body&&this.body.type===U.Physics.P2JS&&this.body.removeFromWorld(),this.visible=!1)}},update:function(){},postUpdate:function(){this.customRender&&this.key.render(),this.components.PhysicsBody&&U.Component.PhysicsBody.postUpdate.call(this),this.components.FixedToCamera&&U.Component.FixedToCamera.postUpdate.call(this);for(var t=0;t<this.children.length;t++)this.children[t].postUpdate()}},U.Component.Crop=function(){},U.Component.Crop.prototype={cropRect:null,_crop:null,crop:function(t,e){void 0===e&&(e=!1),t?(e&&null!==this.cropRect?this.cropRect.setTo(t.x,t.y,t.width,t.height):e&&null===this.cropRect?this.cropRect=new U.Rectangle(t.x,t.y,t.width,t.height):this.cropRect=t,this.updateCrop()):(this._crop=null,this.cropRect=null,this.resetFrame())},updateCrop:function(){var t,e,i,n,r,o,s,a;this.cropRect&&(t=this.texture.crop.x,e=this.texture.crop.y,i=this.texture.crop.width,n=this.texture.crop.height,this._crop=U.Rectangle.clone(this.cropRect,this._crop),this._crop.x+=this._frame.x,this._crop.y+=this._frame.y,r=Math.max(this._frame.x,this._crop.x),o=Math.max(this._frame.y,this._crop.y),s=Math.min(this._frame.right,this._crop.right)-r,a=Math.min(this._frame.bottom,this._crop.bottom)-o,this.texture.crop.x=r,this.texture.crop.y=o,this.texture.crop.width=s,this.texture.crop.height=a,this.texture.frame.width=Math.min(s,this.cropRect.width),this.texture.frame.height=Math.min(a,this.cropRect.height),this.texture.width=this.texture.frame.width,this.texture.height=this.texture.frame.height,this.texture._updateUvs(),16777215===this.tint||t===r&&e===o&&i===s&&n===a||(this.texture.requiresReTint=!0))}},U.Component.Delta=function(){},U.Component.Delta.prototype={deltaX:{get:function(){return this.world.x-this.previousPosition.x}},deltaY:{get:function(){return this.world.y-this.previousPosition.y}},deltaZ:{get:function(){return this.rotation-this.previousRotation}}},U.Component.Destroy=function(){},U.Component.Destroy.prototype={destroyPhase:!1,destroy:function(t,e){if(null!==this.game&&!this.destroyPhase){void 0===t&&(t=!0),void 0===e&&(e=!1),this.destroyPhase=!0,this.events&&this.events.onDestroy$dispatch(this),this.parent&&(this.parent instanceof U.Group?this.parent.remove(this):this.parent.removeChild(this)),this.input&&this.input.destroy(),this.animations&&this.animations.destroy(),this.body&&this.body.destroy(),this.events&&this.events.destroy(),this.game.tweens.removeFrom(this);var i=this.children.length;if(t)for(;i--;)this.children[i].destroy(t);else for(;i--;)this.removeChild(this.children[i]);this._crop&&(this._crop=null,this.cropRect=null),this._frame&&(this._frame=null),U.Video&&this.key instanceof U.Video&&this.key.onChangeSource.remove(this.resizeFrame,this),U.BitmapText&&this._glyphs&&(this._glyphs=[]),this.alive=!1,this.exists=!1,this.visible=!1,this.filters=null,this.mask=null,this.game=null,this.data={},this.renderable=!1,this.transformCallback&&(this.transformCallback=null,this.transformCallbackContext=null),this.hitArea=null,this.parent=null,this.stage=null,this.worldTransform=null,this.filterArea=null,this._bounds=null,this._currentBounds=null,this._mask=null,this._destroyCachedSprite(),e&&this.texture.destroy(!0),this.destroyPhase=!1,this.pendingDestroy=!1}}},U.Events=function(t){this.parent=t},U.Events.prototype={destroy:function(){this._parent=null,this._onDestroy&&this._onDestroy.dispose(),this._onAddedToGroup&&this._onAddedToGroup.dispose(),this._onRemovedFromGroup&&this._onRemovedFromGroup.dispose(),this._onRemovedFromWorld&&this._onRemovedFromWorld.dispose(),this._onKilled&&this._onKilled.dispose(),this._onRevived&&this._onRevived.dispose(),this._onEnterBounds&&this._onEnterBounds.dispose(),this._onOutOfBounds&&this._onOutOfBounds.dispose(),this._onInputOver&&this._onInputOver.dispose(),this._onInputOut&&this._onInputOut.dispose(),this._onInputDown&&this._onInputDown.dispose(),this._onInputUp&&this._onInputUp.dispose(),this._onDragStart&&this._onDragStart.dispose(),this._onDragUpdate&&this._onDragUpdate.dispose(),this._onDragStop&&this._onDragStop.dispose(),this._onAnimationStart&&this._onAnimationStart.dispose(),this._onAnimationComplete&&this._onAnimationComplete.dispose(),this._onAnimationLoop&&this._onAnimationLoop.dispose()},onAddedToGroup:null,onRemovedFromGroup:null,onRemovedFromWorld:null,onDestroy:null,onKilled:null,onRevived:null,onOutOfBounds:null,onEnterBounds:null,onInputOver:null,onInputOut:null,onInputDown:null,onInputUp:null,onDragStart:null,onDragUpdate:null,onDragStop:null,onAnimationStart:null,onAnimationComplete:null,onAnimationLoop:null},U.Events.prototype.constructor=U.Events,U.Events.prototype)U.Events.prototype.hasOwnProperty(i)&&0===i.indexOf("on")&&null===U.Events.prototype[i]&&function(t,e){"use strict";Object.defineProperty(U.Events.prototype,t,{get:function(){return this[e]||(this[e]=new U.Signal)}}),U.Events.prototype[t+"$dispatch"]=function(){return this[e]?this[e].dispatch.apply(this[e],arguments):null}}(i,"_"+i);U.Component.FixedToCamera=function(){},U.Component.FixedToCamera.postUpdate=function(){this.fixedToCamera&&(this.position.x=(this.game.camera.view.x+this.cameraOffset.x)/this.game.camera.scale.x,this.position.y=(this.game.camera.view.y+this.cameraOffset.y)/this.game.camera.scale.y)},U.Component.FixedToCamera.prototype={_fixedToCamera:!1,fixedToCamera:{get:function(){return this._fixedToCamera},set:function(t){t?(this._fixedToCamera=!0,this.cameraOffset.set(this.x,this.y)):this._fixedToCamera=!1}},cameraOffset:new U.Point},U.Component.Health=function(){},U.Component.Health.prototype={health:1,maxHealth:100,damage:function(t){return this.alive&&(this.health-=t,this.health<=0&&this.kill()),this},setHealth:function(t){return this.health=t,this.health>this.maxHealth&&(this.health=this.maxHealth),this},heal:function(t){return this.alive&&(this.health+=t,this.health>this.maxHealth&&(this.health=this.maxHealth)),this}},U.Component.InCamera=function(){},U.Component.InCamera.prototype={inCamera:{get:function(){return this.game.world.camera.view.intersects(this._bounds)}}},U.Component.InputEnabled=function(){},U.Component.InputEnabled.prototype={input:null,inputEnabled:{get:function(){return this.input&&this.input.enabled},set:function(t){t?null===this.input?(this.input=new U.InputHandler(this),this.input.start()):this.input&&!this.input.enabled&&this.input.start():this.input&&this.input.enabled&&this.input.stop()}}},U.Component.InWorld=function(){},U.Component.InWorld.preUpdate=function(){if(this.autoCull||this.checkWorldBounds){if(this._bounds.copyFrom(this.getBounds()),this._bounds.x+=this.game.camera.view.x,this._bounds.y+=this.game.camera.view.y,this.autoCull)if(this.game.world.camera.view.intersects(this._bounds))this.renderable=!0,this.game.world.camera.totalInView++;else if(this.renderable=!1,this.outOfCameraBoundsKill)return this.kill(),!1;if(this.checkWorldBounds)if(this._outOfBoundsFired&&this.game.world.bounds.intersects(this._bounds))this._outOfBoundsFired=!1,this.events.onEnterBounds$dispatch(this);else if(!this._outOfBoundsFired&&!this.game.world.bounds.intersects(this._bounds)&&(this._outOfBoundsFired=!0,this.events.onOutOfBounds$dispatch(this),this.outOfBoundsKill))return this.kill(),!1}return!0},U.Component.InWorld.prototype={checkWorldBounds:!1,outOfBoundsKill:!1,outOfCameraBoundsKill:!1,_outOfBoundsFired:!1,inWorld:{get:function(){return this.game.world.bounds.intersects(this.getBounds())}}},U.Component.LifeSpan=function(){},U.Component.LifeSpan.preUpdate=function(){return!(0<this.lifespan&&(this.lifespan-=this.game.time.physicsElapsedMS,this.lifespan<=0))||(this.kill(),!1)},U.Component.LifeSpan.prototype={alive:!0,lifespan:0,revive:function(t){return void 0===t&&(t=100),this.alive=!0,this.exists=!0,this.visible=!0,"function"==typeof this.setHealth&&this.setHealth(t),this.events&&this.events.onRevived$dispatch(this),this},kill:function(){return this.alive=!1,this.exists=!1,this.visible=!1,this.events&&this.events.onKilled$dispatch(this),this}},U.Component.LoadTexture=function(){},U.Component.LoadTexture.prototype={customRender:!1,_frame:null,loadTexture:function(t,e,i){e=t===U.PENDING_ATLAS?(t=e,0):e||0,(i||void 0===i)&&this.animations&&this.animations.stop(),this.key=t,this.customRender=!1;var n=this.game.cache,r=!0,o=!this.texture.baseTexture.scaleMode;U.RenderTexture&&t instanceof U.RenderTexture?(this.key=t.key,this.setTexture(t)):U.BitmapData&&t instanceof U.BitmapData?(this.customRender=!0,this.setTexture(t.texture),r=n.hasFrameData(t.key,U.Cache.BITMAPDATA)?!this.animations.loadFrameData(n.getFrameData(t.key,U.Cache.BITMAPDATA),e):!this.animations.loadFrameData(t.frameData,0)):U.Video&&t instanceof U.Video?(this.customRender=!0,i=t.texture.valid,this.setTexture(t.texture),this.setFrame(t.texture.frame.clone()),t.onChangeSource.add(this.resizeFrame,this),this.texture.valid=i):U.Tilemap&&t instanceof U.TilemapLayer?this.setTexture(PIXI.Texture.fromCanvas(t.canvas)):t instanceof PIXI.Texture?this.setTexture(t):(n=n.getImage(t,!0),this.key=n.key,this.setTexture(new PIXI.Texture(n.base)),this.texture.baseTexture.skipRender="__default"===t,r=!this.animations.loadFrameData(n.frameData,e)),r&&(this._frame=U.Rectangle.clone(this.texture.frame)),o||(this.texture.baseTexture.scaleMode=1)},setFrame:function(t){this._frame=t,this.texture.frame.x=t.x,this.texture.frame.y=t.y,this.texture.frame.width=t.width,this.texture.frame.height=t.height,this.texture.crop.x=t.x,this.texture.crop.y=t.y,this.texture.crop.width=t.width,this.texture.crop.height=t.height,t.trimmed?(this.texture.trim?(this.texture.trim.x=t.spriteSourceSizeX,this.texture.trim.y=t.spriteSourceSizeY,this.texture.trim.width=t.sourceSizeW,this.texture.trim.height=t.sourceSizeH):this.texture.trim={x:t.spriteSourceSizeX,y:t.spriteSourceSizeY,width:t.sourceSizeW,height:t.sourceSizeH},this.texture.width=t.sourceSizeW,this.texture.height=t.sourceSizeH,this.texture.frame.width=t.sourceSizeW,this.texture.frame.height=t.sourceSizeH):!t.trimmed&&this.texture.trim&&(this.texture.trim=null),this.cropRect&&this.updateCrop(),this.texture.requiresReTint=!0,this.texture._updateUvs(),this.tilingTexture&&(this.refreshTexture=!0)},resizeFrame:function(t,e,i){this.texture.frame.resize(e,i),this.texture.setFrame(this.texture.frame)},resetFrame:function(){this._frame&&this.setFrame(this._frame)},frame:{get:function(){return this.animations.frame},set:function(t){this.animations.frame=t}},frameName:{get:function(){return this.animations.frameName},set:function(t){this.animations.frameName=t}}},U.Component.Overlap=function(){},U.Component.Overlap.prototype={overlap:function(t){return U.Rectangle.intersects(this.getBounds(),t.getBounds())}},U.Component.PhysicsBody=function(){},U.Component.PhysicsBody.preUpdate=function(){return this.fresh&&this.exists?(this.world.setTo(this.parent.position.x+this.position.x,this.parent.position.y+this.position.y),this.worldTransform.tx=this.world.x,this.worldTransform.ty=this.world.y,this.previousPosition.set(this.world.x,this.world.y),this.previousRotation=this.rotation,this.body&&this.body.preUpdate(),this.fresh=!1):(this.previousPosition.set(this.world.x,this.world.y),this.previousRotation=this.rotation,!(!this._exists||!this.parent.exists)||!(this.renderOrderID=-1))},U.Component.PhysicsBody.postUpdate=function(){this.exists&&this.body&&this.body.postUpdate()},U.Component.PhysicsBody.prototype={body:null,x:{get:function(){return this.position.x},set:function(t){this.position.x=t,this.body&&!this.body.dirty&&(this.body._reset=!0)}},y:{get:function(){return this.position.y},set:function(t){this.position.y=t,this.body&&!this.body.dirty&&(this.body._reset=!0)}}},U.Component.Reset=function(){},U.Component.Reset.prototype.reset=function(t,e,i){return void 0===i&&(i=1),this.world.set(t,e),this.position.set(t,e),this.fresh=!0,this.exists=!0,this.visible=!0,this.renderable=!0,this.components.InWorld&&(this._outOfBoundsFired=!1),this.components.LifeSpan&&(this.alive=!0,this.health=i),this.components.PhysicsBody&&this.body&&this.body.reset(t,e,!1,!1),this},U.Component.ScaleMinMax=function(){},U.Component.ScaleMinMax.prototype={transformCallback:null,transformCallbackContext:this,scaleMin:null,scaleMax:null,checkTransform:function(t){this.scaleMin&&(t.a<this.scaleMin.x&&(t.a=this.scaleMin.x),t.d<this.scaleMin.y&&(t.d=this.scaleMin.y)),this.scaleMax&&(t.a>this.scaleMax.x&&(t.a=this.scaleMax.x),t.d>this.scaleMax.y&&(t.d=this.scaleMax.y))},setScaleMinMax:function(t,e,i,n){void 0===e?e=i=n=t:void 0===i&&(i=n=e,e=t),null===t?this.scaleMin=null:this.scaleMin?this.scaleMin.set(t,e):this.scaleMin=new U.Point(t,e),null===i?this.scaleMax=null:this.scaleMax?this.scaleMax.set(i,n):this.scaleMax=new U.Point(i,n),null===this.scaleMin?this.transformCallback=null:(this.transformCallback=this.checkTransform,this.transformCallbackContext=this)}},U.Component.Smoothed=function(){},U.Component.Smoothed.prototype={smoothed:{get:function(){return!this.texture.baseTexture.scaleMode},set:function(t){t?this.texture&&(this.texture.baseTexture.scaleMode=0):this.texture&&(this.texture.baseTexture.scaleMode=1)}}},U.GameObjectFactory=function(t){this.game=t,this.world=this.game.world},U.GameObjectFactory.prototype={existing:function(t){return this.world.add(t)},weapon:function(t,e,i,n){var r=this.game.plugins.add(U.Weapon);return r.createBullets(t,e,i,n),r},image:function(t,e,i,n,r){return(r=void 0===r?this.world:r).add(new U.Image(this.game,t,e,i,n))},sprite:function(t,e,i,n,r){return(r=void 0===r?this.world:r).create(t,e,i,n)},creature:function(t,e,i,n,r){void 0===r&&(r=this.world);n=new U.Creature(this.game,t,e,i,n);return r.add(n),n},tween:function(t){return this.game.tweens.create(t)},group:function(t,e,i,n,r){return new U.Group(this.game,t,e,i,n,r)},physicsGroup:function(t,e,i,n){return new U.Group(this.game,e,i,n,!0,t)},spriteBatch:function(t,e,i){return new U.SpriteBatch(this.game,t=void 0===t?null:t,e=void 0===e?"group":e,i=void 0===i?!1:i)},audio:function(t,e,i,n){return this.game.sound.add(t,e,i,n)},sound:function(t,e,i,n){return this.game.sound.add(t,e,i,n)},audioSprite:function(t){return this.game.sound.addSprite(t)},tileSprite:function(t,e,i,n,r,o,s){return(s=void 0===s?this.world:s).add(new U.TileSprite(this.game,t,e,i,n,r,o))},rope:function(t,e,i,n,r,o){return(o=void 0===o?this.world:o).add(new U.Rope(this.game,t,e,i,n,r))},text:function(t,e,i,n,r){return(r=void 0===r?this.world:r).add(new U.Text(this.game,t,e,i,n))},button:function(t,e,i,n,r,o,s,a,h,l){return(l=void 0===l?this.world:l).add(new U.Button(this.game,t,e,i,n,r,o,s,a,h))},graphics:function(t,e,i){return(i=void 0===i?this.world:i).add(new U.Graphics(this.game,t,e))},emitter:function(t,e,i){return this.game.particles.add(new U.Particles.Arcade.Emitter(this.game,t,e,i))},retroFont:function(t,e,i,n,r,o,s,a,h){return new U.RetroFont(this.game,t,e,i,n,r,o,s,a,h)},bitmapText:function(t,e,i,n,r,o){return(o=void 0===o?this.world:o).add(new U.BitmapText(this.game,t,e,i,n,r))},tilemap:function(t,e,i,n,r){return new U.Tilemap(this.game,t,e,i,n,r)},renderTexture:function(t,e,i,n){void 0!==i&&""!==i||(i=this.game.rnd.uuid()),void 0===n&&(n=!1);e=new U.RenderTexture(this.game,t,e,i);return n&&this.game.cache.addRenderTexture(i,e),e},video:function(t,e){return new U.Video(this.game,t,e)},bitmapData:function(t,e,i,n){void 0===n&&(n=!1),void 0!==i&&""!==i||(i=this.game.rnd.uuid());e=new U.BitmapData(this.game,i,t,e);return n&&this.game.cache.addBitmapData(i,e),e},filter:function(t){var e=Array.prototype.slice.call(arguments,1),t=new U.Filter[t](this.game);return t.init.apply(t,e),t},plugin:function(t){return this.game.plugins.add(t)}},U.GameObjectFactory.prototype.constructor=U.GameObjectFactory,U.GameObjectCreator=function(t){this.game=t,this.world=this.game.world},U.GameObjectCreator.prototype={image:function(t,e,i,n){return new U.Image(this.game,t,e,i,n)},sprite:function(t,e,i,n){return new U.Sprite(this.game,t,e,i,n)},tween:function(t){return new U.Tween(t,this.game,this.game.tweens)},group:function(t,e,i,n,r){return new U.Group(this.game,t,e,i,n,r)},spriteBatch:function(t,e,i){return new U.SpriteBatch(this.game,t,e=void 0===e?"group":e,i=void 0===i?!1:i)},audio:function(t,e,i,n){return this.game.sound.add(t,e,i,n)},audioSprite:function(t){return this.game.sound.addSprite(t)},sound:function(t,e,i,n){return this.game.sound.add(t,e,i,n)},tileSprite:function(t,e,i,n,r,o){return new U.TileSprite(this.game,t,e,i,n,r,o)},rope:function(t,e,i,n,r){return new U.Rope(this.game,t,e,i,n,r)},text:function(t,e,i,n){return new U.Text(this.game,t,e,i,n)},button:function(t,e,i,n,r,o,s,a,h){return new U.Button(this.game,t,e,i,n,r,o,s,a,h)},graphics:function(t,e){return new U.Graphics(this.game,t,e)},emitter:function(t,e,i){return new U.Particles.Arcade.Emitter(this.game,t,e,i)},retroFont:function(t,e,i,n,r,o,s,a,h){return new U.RetroFont(this.game,t,e,i,n,r,o,s,a,h)},bitmapText:function(t,e,i,n,r,o){return new U.BitmapText(this.game,t,e,i,n,r,o)},tilemap:function(t,e,i,n,r){return new U.Tilemap(this.game,t,e,i,n,r)},renderTexture:function(t,e,i,n){void 0!==i&&""!==i||(i=this.game.rnd.uuid()),void 0===n&&(n=!1);e=new U.RenderTexture(this.game,t,e,i);return n&&this.game.cache.addRenderTexture(i,e),e},bitmapData:function(t,e,i,n){void 0===n&&(n=!1),void 0!==i&&""!==i||(i=this.game.rnd.uuid());e=new U.BitmapData(this.game,i,t,e);return n&&this.game.cache.addBitmapData(i,e),e},filter:function(t){var e=Array.prototype.slice.call(arguments,1),t=new U.Filter[t](this.game);return t.init.apply(t,e),t}},U.GameObjectCreator.prototype.constructor=U.GameObjectCreator,U.Sprite=function(t,e,i,n,r){e=e||0,i=i||0,n=n||null,r=r||null,this.type=U.SPRITE,this.physicsType=U.SPRITE,PIXI.Sprite.call(this,U.Cache.DEFAULT),U.Component.Core.init.call(this,t,e,i,n,r)},U.Sprite.prototype=Object.create(PIXI.Sprite.prototype),U.Sprite.prototype.constructor=U.Sprite,U.Component.Core.install.call(U.Sprite.prototype,["Angle","Animation","AutoCull","Bounds","BringToTop","Crop","Delta","Destroy","FixedToCamera","Health","InCamera","InputEnabled","InWorld","LifeSpan","LoadTexture","Overlap","PhysicsBody","Reset","ScaleMinMax","Smoothed"]),U.Sprite.prototype.preUpdatePhysics=U.Component.PhysicsBody.preUpdate,U.Sprite.prototype.preUpdateLifeSpan=U.Component.LifeSpan.preUpdate,U.Sprite.prototype.preUpdateInWorld=U.Component.InWorld.preUpdate,U.Sprite.prototype.preUpdateCore=U.Component.Core.preUpdate,U.Sprite.prototype.preUpdate=function(){return!!(this.preUpdatePhysics()&&this.preUpdateLifeSpan()&&this.preUpdateInWorld())&&this.preUpdateCore()},U.Image=function(t,e,i,n,r){e=e||0,i=i||0,n=n||null,r=r||null,this.type=U.IMAGE,PIXI.Sprite.call(this,U.Cache.DEFAULT),U.Component.Core.init.call(this,t,e,i,n,r)},U.Image.prototype=Object.create(PIXI.Sprite.prototype),U.Image.prototype.constructor=U.Image,U.Component.Core.install.call(U.Image.prototype,["Angle","Animation","AutoCull","Bounds","BringToTop","Crop","Destroy","FixedToCamera","InputEnabled","LifeSpan","LoadTexture","Overlap","Reset","ScaleMinMax","Smoothed"]),U.Image.prototype.preUpdateInWorld=U.Component.InWorld.preUpdate,U.Image.prototype.preUpdateCore=U.Component.Core.preUpdate,U.Image.prototype.preUpdate=function(){return!!this.preUpdateInWorld()&&this.preUpdateCore()},U.Button=function(t,e,i,n,r,o,s,a,h,l){r=r||null,o=o||this,U.Image.call(this,t,e=e||0,i=i||0,n=n||null,a),this.type=U.BUTTON,this.physicsType=U.SPRITE,this._onOverFrame=null,this._onOutFrame=null,this._onDownFrame=null,this._onUpFrame=null,this.onOverSound=null,this.onOutSound=null,this.onDownSound=null,this.onUpSound=null,this.onOverSoundMarker="",this.onOutSoundMarker="",this.onDownSoundMarker="",this.onUpSoundMarker="",this.onInputOver=new U.Signal,this.onInputOut=new U.Signal,this.onInputDown=new U.Signal,this.onInputUp=new U.Signal,this.onOverMouseOnly=!0,this.justReleasedPreventsOver=U.PointerMode.TOUCH,this.freezeFrames=!1,this.forceOut=!1,this.inputEnabled=!0,this.input.start(0,!0),this.input.useHandCursor=!0,this.setFrames(s,a,h,l),null!==r&&this.onInputUp.add(r,o),this.events.onInputOver.add(this.onInputOverHandler,this),this.events.onInputOut.add(this.onInputOutHandler,this),this.events.onInputDown.add(this.onInputDownHandler,this),this.events.onInputUp.add(this.onInputUpHandler,this),this.events.onRemovedFromWorld.add(this.removedFromWorld,this)},U.Button.prototype=Object.create(U.Image.prototype),U.Button.prototype.constructor=U.Button;var h="Over",l="Out",p="Down";U.Button.prototype.clearFrames=function(){this.setFrames(null,null,null,null)},U.Button.prototype.removedFromWorld=function(){this.inputEnabled=!1},U.Button.prototype.setStateFrame=function(t,e,i){var n="_on"+t+"Frame";null!==e?(this[n]=e,i&&this.changeStateFrame(t)):this[n]=null},U.Button.prototype.changeStateFrame=function(t){if(this.freezeFrames)return!1;t=this["_on"+t+"Frame"];return"string"==typeof t?(this.frameName=t,!0):"number"==typeof t&&(this.frame=t,!0)},U.Button.prototype.setFrames=function(t,e,i,n){this.setStateFrame(h,t,this.input.pointerOver()),this.setStateFrame(l,e,!this.input.pointerOver()),this.setStateFrame(p,i,this.input.pointerDown()),this.setStateFrame("Up",n,this.input.pointerUp())},U.Button.prototype.setStateSound=function(t,e,i){var n="on"+t+"Sound",t="on"+t+"SoundMarker";e instanceof U.Sound||e instanceof U.AudioSprite?(this[n]=e,this[t]="string"==typeof i?i:""):(this[n]=null,this[t]="")},U.Button.prototype.playStateSound=function(t){var e=this["on"+t+"Sound"];if(e){t=this["on"+t+"SoundMarker"];return e.play(t),!0}return!1},U.Button.prototype.setSounds=function(t,e,i,n,r,o,s,a){this.setStateSound(h,t,e),this.setStateSound(l,r,o),this.setStateSound(p,i,n),this.setStateSound("Up",s,a)},U.Button.prototype.setOverSound=function(t,e){this.setStateSound(h,t,e)},U.Button.prototype.setOutSound=function(t,e){this.setStateSound(l,t,e)},U.Button.prototype.setDownSound=function(t,e){this.setStateSound(p,t,e)},U.Button.prototype.setUpSound=function(t,e){this.setStateSound("Up",t,e)},U.Button.prototype.onInputOverHandler=function(t,e){e.justReleased()&&(this.justReleasedPreventsOver&e.pointerMode)===e.pointerMode||(this.changeStateFrame(h),this.onOverMouseOnly&&!e.isMouse||(this.playStateSound(h),this.onInputOver&&this.onInputOver.dispatch(this,e)))},U.Button.prototype.onInputOutHandler=function(t,e){this.changeStateFrame(l),this.playStateSound(l),this.onInputOut&&this.onInputOut.dispatch(this,e)},U.Button.prototype.onInputDownHandler=function(t,e){this.changeStateFrame(p),this.playStateSound(p),this.onInputDown&&this.onInputDown.dispatch(this,e)},U.Button.prototype.onInputUpHandler=function(t,e,i){this.playStateSound("Up"),this.onInputUp&&this.onInputUp.dispatch(this,e,i),this.freezeFrames||(!0===this.forceOut||(this.forceOut&e.pointerMode)===e.pointerMode?this.changeStateFrame(l):this.changeStateFrame("Up")||(i?this.changeStateFrame(h):this.changeStateFrame(l)))},U.SpriteBatch=function(t,e,i,n){null==e&&(e=t.world),PIXI.SpriteBatch.call(this),U.Group.call(this,t,e,i,n),this.type=U.SPRITEBATCH},U.SpriteBatch.prototype=U.Utils.extend(!0,U.SpriteBatch.prototype,PIXI.SpriteBatch.prototype,U.Group.prototype),U.SpriteBatch.prototype.constructor=U.SpriteBatch,U.BitmapData=function(t,e,i,n,r){void 0!==i&&0!==i||(i=256),void 0!==n&&0!==n||(n=256),void 0===r&&(r=!1),this.game=t,this.key=e,this.width=i,this.height=n,this.canvas=U.Canvas.create(this,i,n,null,r),this.context=this.canvas.getContext("2d",{alpha:!0}),this.ctx=this.context,this.smoothProperty=t.renderType===U.CANVAS?t.renderer.renderSession.smoothProperty:U.Canvas.getSmoothingPrefix(this.context),this.imageData=this.context.getImageData(0,0,i,n),this.data=null,this.imageData&&(this.data=this.imageData.data),this.pixels=null,this.data&&(this.imageData.data.buffer?(this.buffer=this.imageData.data.buffer,this.pixels=new Uint32Array(this.buffer)):window.ArrayBuffer?(this.buffer=new ArrayBuffer(this.imageData.data.length),this.pixels=new Uint32Array(this.buffer)):this.pixels=this.imageData.data),this.baseTexture=new PIXI.BaseTexture(this.canvas),this.texture=new PIXI.Texture(this.baseTexture),this.frameData=new U.FrameData,this.textureFrame=this.frameData.addFrame(new U.Frame(0,0,0,i,n,"bitmapData")),this.texture.frame=this.textureFrame,this.type=U.BITMAPDATA,this.disableTextureUpload=!1,this.dirty=!1,this.cls=this.clear,this._image=null,this._pos=new U.Point,this._size=new U.Point,this._scale=new U.Point,this._rotate=0,this._alpha={prev:1,current:1},this._anchor=new U.Point,this._tempR=0,this._tempG=0,this._tempB=0,this._circle=new U.Circle,this._swapCanvas=void 0},U.BitmapData.prototype={move:function(t,e,i){return 0!==t&&this.moveH(t,i),0!==e&&this.moveV(e,i),this},moveH:function(t,e){void 0===e&&(e=!0),void 0===this._swapCanvas&&(this._swapCanvas=PIXI.CanvasPool.create(this,this.width,this.height));var i,n=this._swapCanvas.getContext("2d"),r=this.height,o=this.canvas;return n.clearRect(0,0,this.width,this.height),t<0?(t=Math.abs(t),i=this.width-t,e&&n.drawImage(o,0,0,t,r,i,0,t,r),n.drawImage(o,t,0,i,r,0,0,i,r)):(i=this.width-t,e&&n.drawImage(o,i,0,t,r,0,0,t,r),n.drawImage(o,0,0,i,r,t,0,i,r)),this.clear(),this.copy(this._swapCanvas)},moveV:function(t,e){void 0===e&&(e=!0),void 0===this._swapCanvas&&(this._swapCanvas=PIXI.CanvasPool.create(this,this.width,this.height));var i,n=this._swapCanvas.getContext("2d"),r=this.width,o=this.canvas;return n.clearRect(0,0,this.width,this.height),t<0?(t=Math.abs(t),i=this.height-t,e&&n.drawImage(o,0,0,r,t,0,i,r,t),n.drawImage(o,0,t,r,i,0,0,r,i)):(i=this.height-t,e&&n.drawImage(o,0,i,r,t,0,0,r,t),n.drawImage(o,0,0,r,i,0,t,r,i)),this.clear(),this.copy(this._swapCanvas)},add:function(t){if(Array.isArray(t))for(var e=0;e<t.length;e++)t[e].loadTexture&&t[e].loadTexture(this);else t.loadTexture(this);return this},load:function(t){if(t="string"==typeof t?this.game.cache.getImage(t):t)return this.resize(t.width,t.height),this.cls(),this.draw(t),this.update(),this},clear:function(t,e,i,n){return void 0===i&&(i=this.width),void 0===n&&(n=this.height),this.context.clearRect(t=void 0===t?0:t,e=void 0===e?0:e,i,n),this.dirty=!0,this},fill:function(t,e,i,n){return this.context.fillStyle="rgba("+t+","+e+","+i+","+(n=void 0===n?1:n)+")",this.context.fillRect(0,0,this.width,this.height),this.dirty=!0,this},generateTexture:function(t){var e=new Image;e.src=this.canvas.toDataURL("image/png");e=this.game.cache.addImage(t,"",e);return new PIXI.Texture(e.base)},resize:function(t,e){return t===this.width&&e===this.height||(this.width=t,this.height=e,this.canvas.width=t,this.canvas.height=e,void 0!==this._swapCanvas&&(this._swapCanvas.width=t,this._swapCanvas.height=e),this.baseTexture.width=t,this.baseTexture.height=e,this.textureFrame.width=t,this.textureFrame.height=e,this.texture.width=t,this.texture.height=e,this.texture.crop.width=t,this.texture.crop.height=e,this.update(),this.dirty=!0),this},update:function(t,e,i,n){return void 0===t&&(t=0),void 0===e&&(e=0),void 0===i&&(i=Math.max(1,this.width)),void 0===n&&(n=Math.max(1,this.height)),this.imageData=this.context.getImageData(t,e,i,n),this.data=this.imageData.data,this.imageData.data.buffer?(this.buffer=this.imageData.data.buffer,this.pixels=new Uint32Array(this.buffer)):window.ArrayBuffer?(this.buffer=new ArrayBuffer(this.imageData.data.length),this.pixels=new Uint32Array(this.buffer)):this.pixels=this.imageData.data,this},processPixelRGB:function(t,e,i,n,r,o){for(var s,a=(i=void 0===i?0:i)+(r=void 0===r?this.width:r),h=(n=void 0===n?0:n)+(o=void 0===o?this.height:o),l=U.Color.createColor(),p=!1,u=n;u<h;u++)for(var d=i;d<a;d++)U.Color.unpackPixel(this.getPixel32(d,u),l),!1!==(s=t.call(e,l,d,u))&&null!=s&&(this.setPixel32(d,u,s.r,s.g,s.b,s.a,!1),p=!0);return p&&(this.context.putImageData(this.imageData,0,0),this.dirty=!0),this},processPixel:function(t,e,i,n,r,o){for(var s,a,h=(i=void 0===i?0:i)+(r=void 0===r?this.width:r),l=(n=void 0===n?0:n)+(o=void 0===o?this.height:o),p=!1,u=n;u<l;u++)for(var d=i;d<h;d++)s=this.getPixel32(d,u),(a=t.call(e,s,d,u))!==s&&(this.pixels[u*this.width+d]=a,p=!0);return p&&(this.context.putImageData(this.imageData,0,0),this.dirty=!0),this},replaceRGB:function(t,e,i,n,r,o,s,a,h){var l=0,p=0,u=this.width,d=this.height,c=U.Color.packPixel(t,e,i,n);void 0!==h&&h instanceof U.Rectangle&&(l=h.x,p=h.y,u=h.width,d=h.height);for(var y=0;y<d;y++)for(var _=0;_<u;_++)this.getPixel32(l+_,p+y)===c&&this.setPixel32(l+_,p+y,r,o,s,a,!1);return this.context.putImageData(this.imageData,0,0),this.dirty=!0,this},setHSL:function(t,e,i,n){var r=t||0===t,o=e||0===e,s=i||0===i;if(r||o||s){void 0===n&&(n=new U.Rectangle(0,0,this.width,this.height));for(var a=U.Color.createColor(),h=n.y;h<n.bottom;h++)for(var l=n.x;l<n.right;l++)U.Color.unpackPixel(this.getPixel32(l,h),a,!0),r&&(a.h=t),o&&(a.s=e),s&&(a.l=i),U.Color.HSLtoRGB(a.h,a.s,a.l,a),this.setPixel32(l,h,a.r,a.g,a.b,a.a,!1);return this.context.putImageData(this.imageData,0,0),this.dirty=!0,this}},shiftHSL:function(t,e,i,n){if(null==e&&(e=!1),null==i&&(i=!1),(t=null==t?!1:t)||e||i){void 0===n&&(n=new U.Rectangle(0,0,this.width,this.height));for(var r=U.Color.createColor(),o=n.y;o<n.bottom;o++)for(var s=n.x;s<n.right;s++)U.Color.unpackPixel(this.getPixel32(s,o),r,!0),t&&(r.h=this.game.math.wrap(r.h+t,0,1)),e&&(r.s=this.game.math.clamp(r.s+e,0,1)),i&&(r.l=this.game.math.clamp(r.l+i,0,1)),U.Color.HSLtoRGB(r.h,r.s,r.l,r),this.setPixel32(s,o,r.r,r.g,r.b,r.a,!1);return this.context.putImageData(this.imageData,0,0),this.dirty=!0,this}},setPixel32:function(t,e,i,n,r,o,s){return void 0===s&&(s=!0),0<=t&&t<=this.width&&0<=e&&e<=this.height&&(U.Device.LITTLE_ENDIAN?this.pixels[e*this.width+t]=o<<24|r<<16|n<<8|i:this.pixels[e*this.width+t]=i<<24|n<<16|r<<8|o,s&&(this.context.putImageData(this.imageData,0,0),this.dirty=!0)),this},setPixel:function(t,e,i,n,r,o){return this.setPixel32(t,e,i,n,r,255,o)},getPixel:function(t,e,i){i=i||U.Color.createColor();e=~~(t+e*this.width);return i.r=this.data[e*=4],i.g=this.data[++e],i.b=this.data[++e],i.a=this.data[++e],i},getPixel32:function(t,e){if(0<=t&&t<=this.width&&0<=e&&e<=this.height)return this.pixels[e*this.width+t]},getPixelRGB:function(t,e,i,n,r){return U.Color.unpackPixel(this.getPixel32(t,e),i,n,r)},getPixels:function(t){return this.context.getImageData(t.x,t.y,t.width,t.height)},getFirstPixel:function(t){void 0===t&&(t=0);var e=U.Color.createColor(),i=0,n=0,r=1,o=!1;for(1===t?(r=-1,n=this.height):3===t&&(r=-1,i=this.width);U.Color.unpackPixel(this.getPixel32(i,n),e),0===t||1===t?++i===this.width&&(i=0,((n+=r)>=this.height||n<=0)&&(o=!0)):2!==t&&3!==t||++n===this.height&&(n=0,((i+=r)>=this.width||i<=0)&&(o=!0)),0===e.a&&!o;);return e.x=i,e.y=n,e},getBounds:function(t){return(t=void 0===t?new U.Rectangle:t).x=this.getFirstPixel(2).x,t.x===this.width?t.setTo(0,0,0,0):(t.y=this.getFirstPixel(0).y,t.width=this.getFirstPixel(3).x-t.x+1,t.height=this.getFirstPixel(1).y-t.y+1,t)},addToWorld:function(t,e,i,n,r,o){r=r||1,o=o||1;e=this.game.add.image(t,e,this);return e.anchor.set(i,n),e.scale.set(r,o),e},copy:function(t,e,i,n,r,o,s,a,h,l,p,u,d,c,y,_,m){if(((t=null==t?this:t)instanceof U.RenderTexture||t instanceof PIXI.RenderTexture)&&(t=t.getCanvas()),(this._image=t)instanceof U.Sprite||t instanceof U.Image||t instanceof U.Text||t instanceof PIXI.Sprite)this._pos.set(t.texture.crop.x,t.texture.crop.y),this._size.set(t.texture.crop.width,t.texture.crop.height),this._scale.set(t.scale.x,t.scale.y),this._anchor.set(t.anchor.x,t.anchor.y),this._rotate=t.rotation,this._alpha.current=t.alpha,t.texture instanceof U.RenderTexture||t.texture instanceof PIXI.RenderTexture?this._image=t.texture.getCanvas():this._image=t.texture.baseTexture.source,null==o&&(o=t.x),null==s&&(s=t.y),t.texture.trim&&(o+=t.texture.trim.x-t.anchor.x*t.texture.trim.width,s+=t.texture.trim.y-t.anchor.y*t.texture.trim.height),16777215!==t.tint&&(t.cachedTint!==t.tint&&(t.cachedTint=t.tint,t.tintedTexture=PIXI.CanvasTinter.getTintedTexture(t,t.tint)),this._image=t.tintedTexture,this._pos.set(0));else{if(this._pos.set(0),this._scale.set(1),this._anchor.set(0),this._rotate=0,this._alpha.current=1,t instanceof U.BitmapData)this._image=t.canvas;else if("string"==typeof t){if(null===(t=this.game.cache.getImage(t)))return;this._image=t}this._size.set(this._image.width,this._image.height)}if(null==e&&(e=0),null==i&&(i=0),n&&(this._size.x=n),r&&(this._size.y=r),null==o&&(o=e),null==s&&(s=i),null==a&&(a=this._size.x),null==h&&(h=this._size.y),"number"==typeof l&&(this._rotate=l),"number"==typeof p&&(this._anchor.x=p),"number"==typeof u&&(this._anchor.y=u),"number"==typeof d&&(this._scale.x=d),"number"==typeof c&&(this._scale.y=c),"number"==typeof y&&(this._alpha.current=y),void 0===_&&(_=null),void 0===m&&(m=!1),!(this._alpha.current<=0||0===this._scale.x||0===this._scale.y||0===this._size.x||0===this._size.y)){y=this.context;return this._alpha.prev=y.globalAlpha,y.save(),y.globalAlpha=this._alpha.current,_&&(this.op=_),m&&(o|=0,s|=0),y.translate(o,s),y.scale(this._scale.x,this._scale.y),y.rotate(this._rotate),y.drawImage(this._image,this._pos.x+e,this._pos.y+i,this._size.x,this._size.y,-a*this._anchor.x,-h*this._anchor.y,a,h),y.restore(),y.globalAlpha=this._alpha.prev,this.dirty=!0,this}},copyTransform:function(t,e,i){if(void 0===e&&(e=null),void 0===i&&(i=!1),!t.hasOwnProperty("worldTransform")||!t.worldVisible||0===t.worldAlpha)return this;var n=t.worldTransform;if(this._pos.set(t.texture.crop.x,t.texture.crop.y),this._size.set(t.texture.crop.width,t.texture.crop.height),0===n.a||0===n.d||0===this._size.x||0===this._size.y)return this;t.texture instanceof U.RenderTexture||t.texture instanceof PIXI.RenderTexture?this._image=t.texture.getCanvas():this._image=t.texture.baseTexture.source;var r=n.tx,o=n.ty;t.texture.trim&&(r+=t.texture.trim.x-t.anchor.x*t.texture.trim.width,o+=t.texture.trim.y-t.anchor.y*t.texture.trim.height),16777215!==t.tint&&(t.cachedTint!==t.tint&&(t.cachedTint=t.tint,t.tintedTexture=PIXI.CanvasTinter.getTintedTexture(t,t.tint)),this._image=t.tintedTexture,this._pos.set(0)),i&&(r|=0,o|=0);i=this.context;return this._alpha.prev=i.globalAlpha,i.save(),i.globalAlpha=this._alpha.current,e&&(this.op=e),i[this.smoothProperty]=t.texture.baseTexture.scaleMode===PIXI.scaleModes.LINEAR,i.setTransform(n.a,n.b,n.c,n.d,r,o),i.drawImage(this._image,this._pos.x,this._pos.y,this._size.x,this._size.y,-this._size.x*t.anchor.x,-this._size.y*t.anchor.y,this._size.x,this._size.y),i.restore(),i.globalAlpha=this._alpha.prev,this.dirty=!0,this},copyRect:function(t,e,i,n,r,o,s){return this.copy(t,e.x,e.y,e.width,e.height,i,n,e.width,e.height,0,0,0,1,1,r,o,s)},draw:function(t,e,i,n,r,o,s){return this.copy(t,null,null,null,null,e,i,n,r,null,null,null,null,null,null,o,s)},drawGroup:function(t,e,i){return 0<t.total&&t.forEachExists(this.drawGroupProxy,this,e,i),this},drawGroupProxy:function(t,e,i){if(t.hasOwnProperty("texture")&&this.copyTransform(t,e,i),t.type===U.GROUP&&t.exists)this.drawGroup(t,e,i);else if(t.hasOwnProperty("children")&&0<t.children.length)for(var n=0;n<t.children.length;n++)t.children[n].exists&&this.copyTransform(t.children[n],e,i)},drawFull:function(t,e,i){if(!1===t.worldVisible||0===t.worldAlpha||t.hasOwnProperty("exists")&&!1===t.exists)return this;var n;if(t.type!==U.GROUP&&t.type!==U.EMITTER&&t.type!==U.BITMAPTEXT&&(t.type===U.GRAPHICS?(n=t.getBounds(),this.ctx.save(),this.ctx.translate(n.x,n.y),PIXI.CanvasGraphics.renderGraphics(t,this.ctx),this.ctx.restore()):this.copy(t,null,null,null,null,t.worldPosition.x,t.worldPosition.y,null,null,t.worldRotation,null,null,t.worldScale.x,t.worldScale.y,t.worldAlpha,e,i)),t.children)for(var r=0;r<t.children.length;r++)this.drawFull(t.children[r],e,i);return this},shadow:function(t,e,i,n){var r=this.context;return null==t?r.shadowColor="rgba(0,0,0,0)":(r.shadowColor=t,r.shadowBlur=e||5,r.shadowOffsetX=i||10,r.shadowOffsetY=n||10),this},alphaMask:function(t,e,i,n){return(null==n?this.draw(e):this.draw(e,n.x,n.y,n.width,n.height)).blendSourceAtop(),(null==i?this.draw(t):this.draw(t,i.x,i.y,i.width,i.height)).blendReset(),this},extract:function(n,r,o,s,a,t,h,l,p){return void 0===a&&(a=255),void 0===h&&(h=r),void 0===l&&(l=o),void 0===p&&(p=s),(t=void 0===t?!1:t)&&n.resize(this.width,this.height),this.processPixelRGB(function(t,e,i){return t.r===r&&t.g===o&&t.b===s&&n.setPixel32(e,i,h,l,p,a,!1),!1},this),n.context.putImageData(n.imageData,0,0),n.dirty=!0,n},rect:function(t,e,i,n,r){return void 0!==r&&(this.context.fillStyle=r),this.context.fillRect(t,e,i,n),this},text:function(t,e,i,n,r,o){void 0===e&&(e=0),void 0===i&&(i=0),void 0===r&&(r="rgb(255,255,255)"),void 0===o&&(o=!0);var s=this.context,a=s.font;return s.font=n=void 0===n?"14px Courier":n,o&&(s.fillStyle="rgb(0,0,0)",s.fillText(t,e+1,i+1)),s.fillStyle=r,s.fillText(t,e,i),s.font=a,this},circle:function(t,e,i,n){var r=this.context;return void 0!==n&&(r.fillStyle=n),r.beginPath(),r.arc(t,e,i,0,2*Math.PI,!1),r.closePath(),r.fill(),this},line:function(t,e,i,n,r,o){void 0===r&&(r="#fff"),void 0===o&&(o=1);var s=this.context;return s.beginPath(),s.moveTo(t,e),s.lineTo(i,n),s.lineWidth=o,s.strokeStyle=r,s.stroke(),s.closePath(),this},textureLine:function(t,e,i){if(void 0===i&&(i="repeat-x"),"string"!=typeof e||(e=this.game.cache.getImage(e))){var n=t.length;"no-repeat"===i&&n>e.width&&(n=e.width);var r=this.context;return r.fillStyle=r.createPattern(e,i),this._circle=new U.Circle(t.start.x,t.start.y,e.height),this._circle.circumferencePoint(t.angle-1.5707963267948966,!1,this._pos),r.save(),r.translate(this._pos.x,this._pos.y),r.rotate(t.angle),r.fillRect(0,0,n,e.height),r.restore(),this.dirty=!0,this}},render:function(){return!this.disableTextureUpload&&this.dirty&&(this.baseTexture.dirty(),this.dirty=!1),this},destroy:function(){this.frameData.destroy(),this.texture.destroy(!0),PIXI.CanvasPool.remove(this)},blendReset:function(){return this.op="source-over",this},blendSourceOver:function(){return this.op="source-over",this},blendSourceIn:function(){return this.op="source-in",this},blendSourceOut:function(){return this.op="source-out",this},blendSourceAtop:function(){return this.op="source-atop",this},blendDestinationOver:function(){return this.op="destination-over",this},blendDestinationIn:function(){return this.op="destination-in",this},blendDestinationOut:function(){return this.op="destination-out",this},blendDestinationAtop:function(){return this.op="destination-atop",this},blendXor:function(){return this.op="xor",this},blendAdd:function(){return this.op="lighter",this},blendMultiply:function(){return this.op="multiply",this},blendScreen:function(){return this.op="screen",this},blendOverlay:function(){return this.op="overlay",this},blendDarken:function(){return this.op="darken",this},blendLighten:function(){return this.op="lighten",this},blendColorDodge:function(){return this.op="color-dodge",this},blendColorBurn:function(){return this.op="color-burn",this},blendHardLight:function(){return this.op="hard-light",this},blendSoftLight:function(){return this.op="soft-light",this},blendDifference:function(){return this.op="difference",this},blendExclusion:function(){return this.op="exclusion",this},blendHue:function(){return this.op="hue",this},blendSaturation:function(){return this.op="saturation",this},blendColor:function(){return this.op="color",this},blendLuminosity:function(){return this.op="luminosity",this}},Object.defineProperty(U.BitmapData.prototype,"smoothed",{get:function(){U.Canvas.getSmoothingEnabled(this.context)},set:function(t){U.Canvas.setSmoothingEnabled(this.context,t)}}),Object.defineProperty(U.BitmapData.prototype,"op",{get:function(){return this.context.globalCompositeOperation},set:function(t){this.context.globalCompositeOperation=t}}),U.BitmapData.getTransform=function(t,e,i,n,r,o){return{sx:i="number"!=typeof i?1:i,sy:n="number"!=typeof n?1:n,scaleX:i,scaleY:n,skewX:r="number"!=typeof r?0:r,skewY:o="number"!=typeof o?0:o,translateX:t="number"!=typeof t?0:t,translateY:e="number"!=typeof e?0:e,tx:t,ty:e}},U.BitmapData.prototype.constructor=U.BitmapData,PIXI.Graphics=function(){PIXI.DisplayObjectContainer.call(this),this.renderable=!0,this.fillAlpha=1,this.lineWidth=0,this.lineColor=0,this.graphicsData=[],this.tint=16777215,this.blendMode=PIXI.blendModes.NORMAL,this.currentPath=null,this._webGL=[],this.isMask=!1,this.boundsPadding=0,this._localBounds=new PIXI.Rectangle(0,0,1,1),this.dirty=!0,this._boundsDirty=!1,this.webGLDirty=!1,this.cachedSpriteDirty=!1},PIXI.Graphics.prototype=Object.create(PIXI.DisplayObjectContainer.prototype),PIXI.Graphics.prototype.constructor=PIXI.Graphics,PIXI.Graphics.prototype.lineStyle=function(t,e,i){return this.lineWidth=t||0,this.lineColor=e||0,this.lineAlpha=void 0===i?1:i,this.currentPath&&(this.currentPath.shape.points.length?this.drawShape(new PIXI.Polygon(this.currentPath.shape.points.slice(-2))):(this.currentPath.lineWidth=this.lineWidth,this.currentPath.lineColor=this.lineColor,this.currentPath.lineAlpha=this.lineAlpha)),this},PIXI.Graphics.prototype.moveTo=function(t,e){return this.drawShape(new PIXI.Polygon([t,e])),this},PIXI.Graphics.prototype.lineTo=function(t,e){return this.currentPath||this.moveTo(0,0),this.currentPath.shape.points.push(t,e),this.dirty=!0,this._boundsDirty=!0,this},PIXI.Graphics.prototype.quadraticCurveTo=function(t,e,i,n){this.currentPath?0===this.currentPath.shape.points.length&&(this.currentPath.shape.points=[0,0]):this.moveTo(0,0);var r,o=this.currentPath.shape.points;0===o.length&&this.moveTo(0,0);for(var s,a=o[o.length-2],h=o[o.length-1],l=1;l<=20;++l)o.push((r=a+(t-a)*(s=l/20))+(t+(i-t)*s-r)*s,(r=h+(e-h)*s)+(e+(n-e)*s-r)*s);return this.dirty=!0,this._boundsDirty=!0,this},PIXI.Graphics.prototype.bezierCurveTo=function(t,e,i,n,r,o){this.currentPath?0===this.currentPath.shape.points.length&&(this.currentPath.shape.points=[0,0]):this.moveTo(0,0);for(var s,a,h,l,p,u,d=this.currentPath.shape.points,c=d[d.length-2],y=d[d.length-1],_=1;_<=20;++_)d.push((h=(a=(s=1-(u=_/20))*s)*s)*c+3*a*u*t+3*s*(l=u*u)*i+(p=l*u)*r,h*y+3*a*u*e+3*s*l*n+p*o);return this.dirty=!0,this._boundsDirty=!0,this},PIXI.Graphics.prototype.arcTo=function(t,e,i,n,r){this.currentPath?0===this.currentPath.shape.points.length&&this.currentPath.shape.points.push(t,e):this.moveTo(t,e);var o,s,a=this.currentPath.shape.points,h=a[a.length-2],l=a[a.length-1]-e,p=h-t,u=n-e,d=i-t,c=Math.abs(l*d-p*u);return c<1e-8||0===r?a[a.length-2]===t&&a[a.length-1]===e||a.push(t,e):(o=l*l+p*p,s=u*u+d*d,h=l*u+p*d,i=(n=r*Math.sqrt(o)/c)*h/o,o=n*d+(a=r*Math.sqrt(s)/c)*p,c=n*u+a*l,s=d*(n+(h=a*h/s)),h=u*(n+h),i=Math.atan2(l*(a+i)-c,p*(a+i)-o),s=Math.atan2(h-c,s-o),this.arc(o+t,c+e,r,i,s,d*l<p*u)),this.dirty=!0,this._boundsDirty=!0,this},PIXI.Graphics.prototype.arc=function(t,e,i,n,r,o,s){if(n===r)return this;void 0===s&&(s=40),!(o=void 0===o?!1:o)&&r<=n?r+=2*Math.PI:o&&n<=r&&(n+=2*Math.PI);var a=o?-1*(n-r):r-n,h=Math.ceil(Math.abs(a)/(2*Math.PI))*s;if(0==a)return this;r=t+Math.cos(n)*i,s=e+Math.sin(n)*i;o&&this.filling?this.moveTo(t,e):this.moveTo(r,s);for(var l=this.currentPath.shape.points,p=a/(2*h),u=2*p,d=Math.cos(p),c=Math.sin(p),y=h-1,_=y%1/y,m=0;m<=y;m++){var g=p+n+u*(m+_*m),f=Math.cos(g),g=-Math.sin(g);l.push((d*f+c*g)*i+t,(d*-g+c*f)*i+e)}return this.dirty=!0,this._boundsDirty=!0,this},PIXI.Graphics.prototype.beginFill=function(t,e){return this.filling=!0,this.fillColor=t||0,this.fillAlpha=void 0===e?1:e,this.currentPath&&this.currentPath.shape.points.length<=2&&(this.currentPath.fill=this.filling,this.currentPath.fillColor=this.fillColor,this.currentPath.fillAlpha=this.fillAlpha),this},PIXI.Graphics.prototype.endFill=function(){return this.filling=!1,this.fillColor=null,this.fillAlpha=1,this},PIXI.Graphics.prototype.drawRect=function(t,e,i,n){return this.drawShape(new PIXI.Rectangle(t,e,i,n)),this},PIXI.Graphics.prototype.drawRoundedRect=function(t,e,i,n,r){return this.drawShape(new PIXI.RoundedRectangle(t,e,i,n,r)),this},PIXI.Graphics.prototype.drawCircle=function(t,e,i){return this.drawShape(new PIXI.Circle(t,e,i)),this},PIXI.Graphics.prototype.drawEllipse=function(t,e,i,n){return this.drawShape(new PIXI.Ellipse(t,e,i,n)),this},PIXI.Graphics.prototype.drawPolygon=function(t){var e=t=t instanceof U.Polygon||t instanceof PIXI.Polygon?t.points:t;if(!Array.isArray(e))for(var e=new Array(arguments.length),i=0;i<e.length;++i)e[i]=arguments[i];return this.drawShape(new U.Polygon(e)),this},PIXI.Graphics.prototype.clear=function(){return this.lineWidth=0,this.filling=!1,this.dirty=!0,this._boundsDirty=!0,this.clearDirty=!0,this.graphicsData=[],this.updateLocalBounds(),this},PIXI.Graphics.prototype.generateTexture=function(t,e,i){void 0===t&&(t=1),void 0===e&&(e=PIXI.scaleModes.DEFAULT),void 0===i&&(i=0);var n=this.getBounds();n.width+=i,n.height+=i;i=new PIXI.CanvasBuffer(n.width*t,n.height*t),e=PIXI.Texture.fromCanvas(i.canvas,e);return e.baseTexture.resolution=t,i.context.scale(t,t),i.context.translate(-n.x,-n.y),PIXI.CanvasGraphics.renderGraphics(this,i.context),e},PIXI.Graphics.prototype._renderWebGL=function(t){if(!1!==this.visible&&0!==this.alpha&&!0!==this.isMask)if(this._cacheAsBitmap)(this.dirty||this.cachedSpriteDirty)&&(this._generateCachedSprite(),this.updateCachedSpriteTexture(),this.cachedSpriteDirty=!1,this.dirty=!1),this._cachedSprite.worldAlpha=this.worldAlpha,PIXI.Sprite.prototype._renderWebGL.call(this._cachedSprite,t);else{var e;if(t.spriteBatch.stop(),t.blendModeManager.setBlendMode(this.blendMode),this._mask&&t.maskManager.pushMask(this._mask,t),this._filters&&t.filterManager.pushFilter(this._filterBlock),this.blendMode!==t.spriteBatch.currentBlendMode&&(t.spriteBatch.currentBlendMode=this.blendMode,e=PIXI.blendModesWebGL[t.spriteBatch.currentBlendMode],t.spriteBatch.gl.blendFunc(e[0],e[1])),this.webGLDirty&&(this.dirty=!0,this.webGLDirty=!1),PIXI.WebGLGraphics.renderGraphics(this,t),this.children.length){t.spriteBatch.start();for(var i=0;i<this.children.length;i++)this.children[i]._renderWebGL(t);t.spriteBatch.stop()}this._filters&&t.filterManager.popFilter(),this._mask&&t.maskManager.popMask(this.mask,t),t.drawCount++,t.spriteBatch.start()}},PIXI.Graphics.prototype._renderCanvas=function(t){if(!1!==this.visible&&0!==this.alpha&&!0!==this.isMask)if(this._prevTint!==this.tint&&(this.dirty=!0,this._prevTint=this.tint),this._cacheAsBitmap)(this.dirty||this.cachedSpriteDirty)&&(this._generateCachedSprite(),this.updateCachedSpriteTexture(),this.cachedSpriteDirty=!1,this.dirty=!1),this._cachedSprite.alpha=this.alpha,PIXI.Sprite.prototype._renderCanvas.call(this._cachedSprite,t);else{var e=t.context,i=this.worldTransform;this.blendMode!==t.currentBlendMode&&(t.currentBlendMode=this.blendMode,e.globalCompositeOperation=PIXI.blendModesCanvas[t.currentBlendMode]),this._mask&&t.maskManager.pushMask(this._mask,t);var n=t.resolution,r=i.tx*t.resolution+t.shakeX,o=i.ty*t.resolution+t.shakeY;e.setTransform(i.a*n,i.b*n,i.c*n,i.d*n,r,o),PIXI.CanvasGraphics.renderGraphics(this,e);for(var s=0;s<this.children.length;s++)this.children[s]._renderCanvas(t);this._mask&&t.maskManager.popMask(t)}},PIXI.Graphics.prototype.getBounds=function(t){if(!this._currentBounds){if(!this.renderable)return PIXI.EmptyRectangle;this.dirty&&(this.updateLocalBounds(),this.webGLDirty=!0,this.cachedSpriteDirty=!0,this.dirty=!1);var e=this._localBounds,i=e.x,n=e.width+e.x,r=e.y,o=e.height+e.y,s=t||this.worldTransform,a=s.a,h=s.b,l=s.c,p=s.d,u=s.tx,d=s.ty,c=a*n+l*o+u,e=p*o+h*n+d,t=a*i+l*o+u,s=p*o+h*i+d,o=a*i+l*r+u,i=p*r+h*i+d,u=a*n+l*r+u,h=p*r+h*n+d,n=t<(n=c)?t:n,d=h<(d=i<(d=s<(d=e)?s:d)?i:d)?h:d,c=(c=(c=(c=c)<t?t:c)<o?o:c)<u?u:c,e=(e=(e=(e=e)<s?s:e)<i?i:e)<h?h:e;this._bounds.x=n=u<(n=o<n?o:n)?u:n,this._bounds.width=c-n,this._bounds.y=d,this._bounds.height=e-d,this._currentBounds=this._bounds}return this._currentBounds},PIXI.Graphics.prototype.getLocalBounds=function(){var t=this.worldTransform;this.worldTransform=PIXI.identityMatrix;for(var e=0;e<this.children.length;e++)this.children[e].updateTransform();var i=this.getBounds();for(this.worldTransform=t,e=0;e<this.children.length;e++)this.children[e].updateTransform();return i},PIXI.Graphics.prototype.containsPoint=function(t){this.worldTransform.applyInverse(t,tempPoint);for(var e=this.graphicsData,i=0;i<e.length;i++){var n=e[i];if(n.fill&&(n.shape&&n.shape.contains(tempPoint.x,tempPoint.y)))return!0}return!1},PIXI.Graphics.prototype.updateLocalBounds=function(){var t=1/0,e=-1/0,i=1/0,n=-1/0;if(this.graphicsData.length)for(var r,o,s,a,h=0;h<this.graphicsData.length;h++){var l=this.graphicsData[h],p=l.type,u=l.lineWidth,l=l.shape;if(p===PIXI.Graphics.RECT||p===PIXI.Graphics.RREC)r=l.x-u/2,o=l.y-u/2,t=r<t?r:t,e=e<r+(s=l.width+u)?r+s:e,i=o<i?o:i,n=n<o+(a=l.height+u)?o+a:n;else if(p===PIXI.Graphics.CIRC)r=l.x,o=l.y,t=r-(s=l.radius+u/2)<t?r-s:t,e=e<r+s?r+s:e,i=o-(a=l.radius+u/2)<i?o-a:i,n=n<o+a?o+a:n;else if(p===PIXI.Graphics.ELIP)r=l.x,o=l.y,t=r-(s=l.width+u/2)<t?r-s:t,e=e<r+s?r+s:e,i=o-(a=l.height+u/2)<i?o-a:i,n=n<o+a?o+a:n;else for(var d=l.points,c=0;c<d.length;c++)d[c]instanceof U.Point?(r=d[c].x,o=d[c].y):(r=d[c],o=d[c+1],c<d.length-1&&c++),t=r-u<t?r-u:t,e=e<r+u?r+u:e,i=o-u<i?o-u:i,n=n<o+u?o+u:n}else n=i=e=t=0;var y=this.boundsPadding;this._localBounds.x=t-y,this._localBounds.width=e-t+2*y,this._localBounds.y=i-y,this._localBounds.height=n-i+2*y},PIXI.Graphics.prototype._generateCachedSprite=function(){var t,e,i=this.getLocalBounds();this._cachedSprite?this._cachedSprite.buffer.resize(i.width,i.height):(t=new PIXI.CanvasBuffer(i.width,i.height),e=PIXI.Texture.fromCanvas(t.canvas),this._cachedSprite=new PIXI.Sprite(e),this._cachedSprite.buffer=t,this._cachedSprite.worldTransform=this.worldTransform),this._cachedSprite.anchor.x=-(i.x/i.width),this._cachedSprite.anchor.y=-(i.y/i.height),this._cachedSprite.buffer.context.translate(-i.x,-i.y),this.worldAlpha=1,PIXI.CanvasGraphics.renderGraphics(this,this._cachedSprite.buffer.context),this._cachedSprite.alpha=this.alpha},PIXI.Graphics.prototype.updateCachedSpriteTexture=function(){var t=this._cachedSprite,e=t.texture,i=t.buffer.canvas;e.baseTexture.width=i.width,e.baseTexture.height=i.height,e.crop.width=e.frame.width=i.width,e.crop.height=e.frame.height=i.height,t._width=i.width,t._height=i.height,e.baseTexture.dirty()},PIXI.Graphics.prototype.destroyCachedSprite=function(){this._cachedSprite.texture.destroy(!0),this._cachedSprite=null},PIXI.Graphics.prototype.drawShape=function(t){this.currentPath&&this.currentPath.shape.points.length<=2&&this.graphicsData.pop(),this.currentPath=null,t instanceof U.Polygon&&(t=t.clone()).flatten();t=new PIXI.GraphicsData(this.lineWidth,this.lineColor,this.lineAlpha,this.fillColor,this.fillAlpha,this.filling,t);return this.graphicsData.push(t),t.type===PIXI.Graphics.POLY&&(t.shape.closed=this.filling,this.currentPath=t),this.dirty=!0,this._boundsDirty=!0,t},Object.defineProperty(PIXI.Graphics.prototype,"cacheAsBitmap",{get:function(){return this._cacheAsBitmap},set:function(t){this._cacheAsBitmap=t,this._cacheAsBitmap?this._generateCachedSprite():this.destroyCachedSprite(),this.dirty=!0,this.webGLDirty=!0}}),PIXI.GraphicsData=function(t,e,i,n,r,o,s){this.lineWidth=t,this.lineColor=e,this.lineAlpha=i,this._lineTint=e,this.fillColor=n,this.fillAlpha=r,this._fillTint=n,this.fill=o,this.shape=s,this.type=s.type},PIXI.GraphicsData.prototype.constructor=PIXI.GraphicsData,PIXI.GraphicsData.prototype.clone=function(){return new GraphicsData(this.lineWidth,this.lineColor,this.lineAlpha,this.fillColor,this.fillAlpha,this.fill,this.shape)},PIXI.EarCut={},PIXI.EarCut.Triangulate=function(t,e,i){i=i||2;var n,r,o,s,a,h=e&&e.length,l=h?e[0]*i:t.length,p=PIXI.EarCut.linkedList(t,0,l,i,!0),u=[];if(!p)return u;if(h&&(p=PIXI.EarCut.eliminateHoles(t,e,p,i)),t.length>80*i){for(var d=n=t[0],c=r=t[1],y=i;y<l;y+=i)(o=t[y])<d&&(d=o),(s=t[y+1])<c&&(c=s),n<o&&(n=o),r<s&&(r=s);a=Math.max(n-d,r-c)}return PIXI.EarCut.earcutLinked(p,u,i,d,c,a),u},PIXI.EarCut.linkedList=function(t,e,i,n,r){for(var o,s=0,a=e,h=i-n;a<i;a+=n)s+=(t[h]-t[a])*(t[a+1]+t[h+1]),h=a;if(r===0<s)for(a=e;a<i;a+=n)o=PIXI.EarCut.insertNode(a,t[a],t[a+1],o);else for(a=i-n;e<=a;a-=n)o=PIXI.EarCut.insertNode(a,t[a],t[a+1],o);return o},PIXI.EarCut.filterPoints=function(t,e){if(!t)return t;e=e||t;var i,n=t;do{if(i=!1,n.steiner||!PIXI.EarCut.equals(n,n.next)&&0!==PIXI.EarCut.area(n.prev,n,n.next))n=n.next;else{if(PIXI.EarCut.removeNode(n),(n=e=n.prev)===n.next)return null;i=!0}}while(i||n!==e);return e},PIXI.EarCut.earcutLinked=function(t,e,i,n,r,o,s){if(t){!s&&o&&PIXI.EarCut.indexCurve(t,n,r,o);for(var a,h,l=t;t.prev!==t.next;)if(a=t.prev,h=t.next,o?PIXI.EarCut.isEarHashed(t,n,r,o):PIXI.EarCut.isEar(t))e.push(a.i/i),e.push(t.i/i),e.push(h.i/i),PIXI.EarCut.removeNode(t),t=h.next,l=h.next;else if((t=h)===l){s?1===s?(t=PIXI.EarCut.cureLocalIntersections(t,e,i),PIXI.EarCut.earcutLinked(t,e,i,n,r,o,2)):2===s&&PIXI.EarCut.splitEarcut(t,e,i,n,r,o):PIXI.EarCut.earcutLinked(PIXI.EarCut.filterPoints(t),e,i,n,r,o,1);break}}},PIXI.EarCut.isEar=function(t){var e=t.prev,i=t,n=t.next;if(0<=PIXI.EarCut.area(e,i,n))return!1;for(var r=t.next.next;r!==t.prev;){if(PIXI.EarCut.pointInTriangle(e.x,e.y,i.x,i.y,n.x,n.y,r.x,r.y)&&0<=PIXI.EarCut.area(r.prev,r,r.next))return!1;r=r.next}return!0},PIXI.EarCut.isEarHashed=function(t,e,i,n){var r=t.prev,o=t,s=t.next;if(0<=PIXI.EarCut.area(r,o,s))return!1;for(var a=(r.x<o.x?r.x<s.x?r:s:o.x<s.x?o:s).x,h=(r.y<o.y?r.y<s.y?r:s:o.y<s.y?o:s).y,l=(r.x>o.x?r.x>s.x?r:s:o.x>s.x?o:s).x,p=(r.y>o.y?r.y>s.y?r:s:o.y>s.y?o:s).y,u=PIXI.EarCut.zOrder(a,h,e,i,n),d=PIXI.EarCut.zOrder(l,p,e,i,n),c=t.nextZ;c&&c.z<=d;){if(c!==t.prev&&c!==t.next&&PIXI.EarCut.pointInTriangle(r.x,r.y,o.x,o.y,s.x,s.y,c.x,c.y)&&0<=PIXI.EarCut.area(c.prev,c,c.next))return!1;c=c.nextZ}for(c=t.prevZ;c&&c.z>=u;){if(c!==t.prev&&c!==t.next&&PIXI.EarCut.pointInTriangle(r.x,r.y,o.x,o.y,s.x,s.y,c.x,c.y)&&0<=PIXI.EarCut.area(c.prev,c,c.next))return!1;c=c.prevZ}return!0},PIXI.EarCut.cureLocalIntersections=function(t,e,i){var n=t;do{var r=n.prev,o=n.next.next}while(PIXI.EarCut.intersects(r,n,n.next,o)&&PIXI.EarCut.locallyInside(r,o)&&PIXI.EarCut.locallyInside(o,r)&&(e.push(r.i/i),e.push(n.i/i),e.push(o.i/i),PIXI.EarCut.removeNode(n),PIXI.EarCut.removeNode(n.next),n=t=o),(n=n.next)!==t);return n},PIXI.EarCut.splitEarcut=function(t,e,i,n,r,o){var s=t;do{for(var a=s.next.next;a!==s.prev;){if(s.i!==a.i&&PIXI.EarCut.isValidDiagonal(s,a)){var h=PIXI.EarCut.splitPolygon(s,a),s=PIXI.EarCut.filterPoints(s,s.next),h=PIXI.EarCut.filterPoints(h,h.next);return PIXI.EarCut.earcutLinked(s,e,i,n,r,o),void PIXI.EarCut.earcutLinked(h,e,i,n,r,o)}a=a.next}}while((s=s.next)!==t)},PIXI.EarCut.eliminateHoles=function(t,e,i,n){for(var r,o,s=[],a=0,h=e.length;a<h;a++)r=e[a]*n,o=a<h-1?e[a+1]*n:t.length,(o=PIXI.EarCut.linkedList(t,r,o,n,!1))===o.next&&(o.steiner=!0),s.push(PIXI.EarCut.getLeftmost(o));for(s.sort(compareX),a=0;a<s.length;a++)PIXI.EarCut.eliminateHole(s[a],i),i=PIXI.EarCut.filterPoints(i,i.next);return i},PIXI.EarCut.compareX=function(t,e){return t.x-e.x},PIXI.EarCut.eliminateHole=function(t,e){(e=PIXI.EarCut.findHoleBridge(t,e))&&(t=PIXI.EarCut.splitPolygon(e,t),PIXI.EarCut.filterPoints(t,t.next))},PIXI.EarCut.findHoleBridge=function(t,e){var i,n,r=e,o=t.x,s=t.y,a=-1/0;do{}while(s<=r.y&&s>=r.next.y&&((n=r.x+(s-r.y)*(r.next.x-r.x)/(r.next.y-r.y))<=o&&a<n&&(a=n,i=r.x<r.next.x?r:r.next)),(r=r.next)!==e);if(!i)return null;if(t.x===i.x)return i.prev;for(var h,l=i,p=1/0,r=i.next;r!==l;)o>=r.x&&r.x>=i.x&&PIXI.EarCut.pointInTriangle(s<i.y?o:a,s,i.x,i.y,s<i.y?a:o,s,r.x,r.y)&&((h=Math.abs(s-r.y)/(o-r.x))<p||h===p&&r.x>i.x)&&PIXI.EarCut.locallyInside(r,t)&&(i=r,p=h),r=r.next;return i},PIXI.EarCut.indexCurve=function(t,e,i,n){for(var r=t;null===r.z&&(r.z=PIXI.EarCut.zOrder(r.x,r.y,e,i,n)),r.prevZ=r.prev,r.nextZ=r.next,(r=r.next)!==t;);r.prevZ.nextZ=null,r.prevZ=null,PIXI.EarCut.sortLinked(r)},PIXI.EarCut.sortLinked=function(t){var e,i,n,r,o,s,a,h,l=1;do{for(i=t,o=t=null,s=0;i;){for(s++,n=i,e=a=0;e<l&&(a++,n=n.nextZ);e++);for(h=l;0<a||0<h&&n;)0!==a&&(0===h||!n||i.z<=n.z)?(i=(r=i).nextZ,a--):(n=(r=n).nextZ,h--),o?o.nextZ=r:t=r,r.prevZ=o,o=r;i=n}}while(o.nextZ=null,l*=2,1<s);return t},PIXI.EarCut.zOrder=function(t,e,i,n,r){return(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=32767*(t-i)/r)|t<<8))|t<<4))|t<<2))|t<<1))|(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=32767*(e-n)/r)|e<<8))|e<<4))|e<<2))|e<<1))<<1},PIXI.EarCut.getLeftmost=function(t){for(var e=t,i=t;e.x<i.x&&(i=e),(e=e.next)!==t;);return i},PIXI.EarCut.pointInTriangle=function(t,e,i,n,r,o,s,a){return 0<=(r-s)*(e-a)-(t-s)*(o-a)&&0<=(t-s)*(n-a)-(i-s)*(e-a)&&0<=(i-s)*(o-a)-(r-s)*(n-a)},PIXI.EarCut.isValidDiagonal=function(t,e){return PIXI.EarCut.equals(t,e)||t.next.i!==e.i&&t.prev.i!==e.i&&!PIXI.EarCut.intersectsPolygon(t,e)&&PIXI.EarCut.locallyInside(t,e)&&PIXI.EarCut.locallyInside(e,t)&&PIXI.EarCut.middleInside(t,e)},PIXI.EarCut.area=function(t,e,i){return(e.y-t.y)*(i.x-e.x)-(e.x-t.x)*(i.y-e.y)},PIXI.EarCut.equals=function(t,e){return t.x===e.x&&t.y===e.y},PIXI.EarCut.intersects=function(t,e,i,n){return 0<PIXI.EarCut.area(t,e,i)!=0<PIXI.EarCut.area(t,e,n)&&0<PIXI.EarCut.area(i,n,t)!=0<PIXI.EarCut.area(i,n,e)},PIXI.EarCut.intersectsPolygon=function(t,e){var i=t;do{if(i.i!==t.i&&i.next.i!==t.i&&i.i!==e.i&&i.next.i!==e.i&&PIXI.EarCut.intersects(i,i.next,t,e))return!0}while((i=i.next)!==t);return!1},PIXI.EarCut.locallyInside=function(t,e){return PIXI.EarCut.area(t.prev,t,t.next)<0?0<=PIXI.EarCut.area(t,e,t.next)&&0<=PIXI.EarCut.area(t,t.prev,e):PIXI.EarCut.area(t,e,t.prev)<0||PIXI.EarCut.area(t,t.next,e)<0},PIXI.EarCut.middleInside=function(t,e){for(var i=t,n=!1,r=(t.x+e.x)/2,o=(t.y+e.y)/2;i.y>o!=i.next.y>o&&r<(i.next.x-i.x)*(o-i.y)/(i.next.y-i.y)+i.x&&(n=!n),(i=i.next)!==t;);return n},PIXI.EarCut.splitPolygon=function(t,e){var i=new PIXI.EarCut.Node(t.i,t.x,t.y),n=new PIXI.EarCut.Node(e.i,e.x,e.y),r=t.next,o=e.prev;return(t.next=e).prev=t,(i.next=r).prev=i,(n.next=i).prev=n,(o.next=n).prev=o,n},PIXI.EarCut.insertNode=function(t,e,i,n){i=new PIXI.EarCut.Node(t,e,i);return n?(i.next=n.next,(i.prev=n).next.prev=i,n.next=i):(i.prev=i).next=i,i},PIXI.EarCut.removeNode=function(t){t.next.prev=t.prev,t.prev.next=t.next,t.prevZ&&(t.prevZ.nextZ=t.nextZ),t.nextZ&&(t.nextZ.prevZ=t.prevZ)},PIXI.EarCut.Node=function(t,e,i){this.i=t,this.x=e,this.y=i,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1},PIXI.WebGLGraphics=function(){},PIXI.WebGLGraphics.stencilBufferLimit=6,PIXI.WebGLGraphics.renderGraphics=function(t,e){var i,n=e.gl,r=e.projection,o=e.offset,s=e.shaderManager.primitiveShader;t.dirty&&PIXI.WebGLGraphics.updateGraphics(t,n);for(var a=t._webGL[n.id],h=0;h<a.data.length;h++)1===a.data[h].mode?(i=a.data[h],e.stencilManager.pushStencil(t,i,e),n.drawElements(n.TRIANGLE_FAN,4,n.UNSIGNED_SHORT,2*(i.indices.length-4)),e.stencilManager.popStencil(t,i,e)):(i=a.data[h],e.shaderManager.setShader(s),s=e.shaderManager.primitiveShader,n.uniformMatrix3fv(s.translationMatrix,!1,t.worldTransform.toArray(!0)),n.uniform1f(s.flipY,1),n.uniform2f(s.projectionVector,r.x,-r.y),n.uniform2f(s.offsetVector,-o.x,-o.y),n.uniform3fv(s.tintColor,PIXI.hex2rgb(t.tint)),n.uniform1f(s.alpha,t.worldAlpha),n.bindBuffer(n.ARRAY_BUFFER,i.buffer),n.vertexAttribPointer(s.aVertexPosition,2,n.FLOAT,!1,24,0),n.vertexAttribPointer(s.colorAttribute,4,n.FLOAT,!1,24,8),n.bindBuffer(n.ELEMENT_ARRAY_BUFFER,i.indexBuffer),n.drawElements(n.TRIANGLE_STRIP,i.indices.length,n.UNSIGNED_SHORT,0))},PIXI.WebGLGraphics.updateGraphics=function(t,e){var i,n=(n=t._webGL[e.id])||(t._webGL[e.id]={lastIndex:0,data:[],gl:e});if(t.dirty=!1,t.clearDirty){for(t.clearDirty=!1,i=0;i<n.data.length;i++){var r=n.data[i];r.reset(),PIXI.WebGLGraphics.graphicsDataPool.push(r)}n.data=[],n.lastIndex=0}for(i=n.lastIndex;i<t.graphicsData.length;i++){var o,s=t.graphicsData[i];s.type===PIXI.Graphics.POLY?(s.points=s.shape.points.slice(),s.shape.closed&&(s.points[0]===s.points[s.points.length-2]&&s.points[1]===s.points[s.points.length-1]||s.points.push(s.points[0],s.points[1])),s.fill&&s.points.length>=PIXI.WebGLGraphics.stencilBufferLimit&&(s.points.length<2*PIXI.WebGLGraphics.stencilBufferLimit?(o=PIXI.WebGLGraphics.switchMode(n,0),PIXI.WebGLGraphics.buildPoly(s,o)||(o=PIXI.WebGLGraphics.switchMode(n,1),PIXI.WebGLGraphics.buildComplexPoly(s,o))):(o=PIXI.WebGLGraphics.switchMode(n,1),PIXI.WebGLGraphics.buildComplexPoly(s,o))),0<s.lineWidth&&(o=PIXI.WebGLGraphics.switchMode(n,0),PIXI.WebGLGraphics.buildLine(s,o))):(o=PIXI.WebGLGraphics.switchMode(n,0),s.type===PIXI.Graphics.RECT?PIXI.WebGLGraphics.buildRectangle(s,o):s.type===PIXI.Graphics.CIRC||s.type===PIXI.Graphics.ELIP?PIXI.WebGLGraphics.buildCircle(s,o):s.type===PIXI.Graphics.RREC&&PIXI.WebGLGraphics.buildRoundedRectangle(s,o)),n.lastIndex++}for(i=0;i<n.data.length;i++)(o=n.data[i]).dirty&&o.upload()},PIXI.WebGLGraphics.switchMode=function(t,e){var i;return t.data.length&&(i=t.data[t.data.length-1]).mode===e&&1!==e||((i=PIXI.WebGLGraphics.graphicsDataPool.pop()||new PIXI.WebGLGraphicsData(t.gl)).mode=e,t.data.push(i)),i.dirty=!0,i},PIXI.WebGLGraphics.buildRectangle=function(t,e){var i,n,r,o,s,a,h=t.shape,l=h.x,p=h.y,u=h.width,d=h.height;t.fill&&(a=PIXI.hex2rgb(t.fillColor),i=t.fillAlpha,n=a[0]*i,r=a[1]*i,o=a[2]*i,s=e.points,h=e.indices,a=s.length/6,s.push(l,p),s.push(n,r,o,i),s.push(l+u,p),s.push(n,r,o,i),s.push(l,p+d),s.push(n,r,o,i),s.push(l+u,p+d),s.push(n,r,o,i),h.push(a,a,1+a,2+a,3+a,3+a)),t.lineWidth&&(a=t.points,t.points=[l,p,l+u,p,l+u,p+d,l,p+d,l,p],PIXI.WebGLGraphics.buildLine(t,e),t.points=a)},PIXI.WebGLGraphics.buildRoundedRectangle=function(t,e){var i=t.shape,n=i.x,r=i.y,o=i.width,s=i.height,i=i.radius,a=[];if(a.push(n,r+i),a=(a=(a=(a=a.concat(PIXI.WebGLGraphics.quadraticBezierCurve(n,r+s-i,n,r+s,n+i,r+s))).concat(PIXI.WebGLGraphics.quadraticBezierCurve(n+o-i,r+s,n+o,r+s,n+o,r+s-i))).concat(PIXI.WebGLGraphics.quadraticBezierCurve(n+o,r+i,n+o,r,n+o-i,r))).concat(PIXI.WebGLGraphics.quadraticBezierCurve(n+i,r,n,r,n,r+i)),t.fill){for(var h=PIXI.hex2rgb(t.fillColor),l=t.fillAlpha,p=h[0]*l,u=h[1]*l,d=h[2]*l,c=e.points,y=e.indices,_=c.length/6,m=PIXI.EarCut.Triangulate(a,null,2),g=0,g=0;g<m.length;g+=3)y.push(m[g]+_),y.push(m[g]+_),y.push(m[g+1]+_),y.push(m[g+2]+_),y.push(m[g+2]+_);for(g=0;g<a.length;g++)c.push(a[g],a[++g],p,u,d,l)}t.lineWidth&&(h=t.points,t.points=a,PIXI.WebGLGraphics.buildLine(t,e),t.points=h)},PIXI.WebGLGraphics.quadraticBezierCurve=function(t,e,i,n,r,o){var s,a,h,l,p=[];function u(t,e,i){return t+(e-t)*i}for(var d,c=0;c<=20;c++)s=u(t,i,d=c/20),a=u(e,n,d),l=u(i,r,d),h=u(n,o,d),l=u(s,l,d),d=u(a,h,d),p.push(l,d);return p},PIXI.WebGLGraphics.buildCircle=function(t,e){var i,n=t.shape,r=n.x,o=n.y,s=t.type===PIXI.Graphics.CIRC?(i=n.radius,n.radius):(i=n.width,n.height),a=2*Math.PI/40,h=0;if(t.fill){var l=PIXI.hex2rgb(t.fillColor),p=t.fillAlpha,u=l[0]*p,d=l[1]*p,c=l[2]*p,y=e.points,_=e.indices,m=y.length/6;for(_.push(m),h=0;h<41;h++)y.push(r,o,u,d,c,p),y.push(r+Math.sin(a*h)*i,o+Math.cos(a*h)*s,u,d,c,p),_.push(m++,m++);_.push(m-1)}if(t.lineWidth){l=t.points;for(t.points=[],h=0;h<41;h++)t.points.push(r+Math.sin(a*h)*i,o+Math.cos(a*h)*s);PIXI.WebGLGraphics.buildLine(t,e),t.points=l}},PIXI.WebGLGraphics.buildLine=function(t,e){var i=0,n=t.points;if(0!==n.length){if(t.lineWidth%2)for(i=0;i<n.length;i++)n[i]+=.5;var r,o=new PIXI.Point(n[0],n[1]),s=new PIXI.Point(n[n.length-2],n[n.length-1]);o.x===s.x&&o.y===s.y&&((n=n.slice()).pop(),n.pop(),r=(s=new PIXI.Point(n[n.length-2],n[n.length-1])).x+.5*(o.x-s.x),s=s.y+.5*(o.y-s.y),n.unshift(r,s),n.push(r,s));var a,h,l,p,u,d,c,y,_,m=e.points,g=e.indices,f=n.length/2,x=n.length,v=m.length/6,w=t.lineWidth/2,e=PIXI.hex2rgb(t.lineColor),z=t.lineAlpha,b=e[0]*z,S=e[1]*z,C=e[2]*z,P=n[0],M=n[1],T=n[2],A=n[3],k=-(M-A),O=P-T,E=Math.sqrt(k*k+O*O);for(k/=E,O/=E,m.push(P-(k*=w),M-(O*=w),b,S,C,z),m.push(P+k,M+O,b,S,C,z),i=1;i<f-1;i++)P=n[2*(i-1)],M=n[2*(i-1)+1],T=n[2*i],A=n[2*i+1],p=n[2*(i+1)],_=n[2*(i+1)+1],k=-(M-A),O=P-T,k/=E=Math.sqrt(k*k+O*O),O/=E,k*=w,O*=w,a=-(A-_),h=T-p,a/=E=Math.sqrt(a*a+h*h),h/=E,u=(-k+P)*(-O+A)-(-k+T)*(-O+M),y=(-(a*=w)+p)*(-(h*=w)+A)-(-a+T)*(-h+_),_=(l=-O+M-(-O+A))*(c=-a+T-(-a+p))-(d=-h+_-(-h+A))*(p=-k+T-(-k+P)),Math.abs(_)<.1?(_+=10.1,m.push(T-k,A-O,b,S,C,z),m.push(T+k,A+O,b,S,C,z)):19600<((c=(p*y-c*u)/_)-T)*(c-T)+((_=(d*u-l*y)/_)-A)+(_-A)?(a=k-a,h=O-h,a/=E=Math.sqrt(a*a+h*h),h/=E,m.push(T-(a*=w),A-(h*=w)),m.push(b,S,C,z),m.push(T+a,A+h),m.push(b,S,C,z),m.push(T-a,A-h),m.push(b,S,C,z),x++):(m.push(c,_),m.push(b,S,C,z),m.push(T-(c-T),A-(_-A)),m.push(b,S,C,z));for(P=n[2*(f-2)],M=n[2*(f-2)+1],T=n[2*(f-1)],k=-(M-(A=n[2*(f-1)+1])),O=P-T,k/=E=Math.sqrt(k*k+O*O),O/=E,m.push(T-(k*=w),A-(O*=w)),m.push(b,S,C,z),m.push(T+k,A+O),m.push(b,S,C,z),g.push(v),i=0;i<x;i++)g.push(v++);g.push(v-1)}},PIXI.WebGLGraphics.buildComplexPoly=function(t,e){var i=t.points.slice();if(!(i.length<6)){var n=e.indices;e.points=i,e.alpha=t.fillAlpha,e.color=PIXI.hex2rgb(t.fillColor);for(var r,o=1/0,s=-1/0,a=1/0,h=-1/0,l=0;l<i.length;l+=2)o=(r=i[l])<o?r:o,s=s<r?r:s,a=(r=i[l+1])<a?r:a,h=h<r?r:h;i.push(o,a,s,a,s,h,o,h);for(var p=i.length/2,l=0;l<p;l++)n.push(l)}},PIXI.WebGLGraphics.buildPoly=function(t,e){var i=t.points;if(!(i.length<6)){var n=e.points,r=e.indices,o=i.length/2,e=PIXI.hex2rgb(t.fillColor),s=t.fillAlpha,a=e[0]*s,h=e[1]*s,l=e[2]*s,p=PIXI.EarCut.Triangulate(i,null,2);if(!p)return!1;for(var u=n.length/6,d=0,d=0;d<p.length;d+=3)r.push(p[d]+u),r.push(p[d]+u),r.push(p[d+1]+u),r.push(p[d+2]+u),r.push(p[d+2]+u);for(d=0;d<o;d++)n.push(i[2*d],i[2*d+1],a,h,l,s);return!0}},PIXI.WebGLGraphics.graphicsDataPool=[],PIXI.WebGLGraphicsData=function(t){this.gl=t,this.color=[0,0,0],this.points=[],this.indices=[],this.buffer=t.createBuffer(),this.indexBuffer=t.createBuffer(),this.mode=1,this.alpha=1,this.dirty=!0},PIXI.WebGLGraphicsData.prototype.reset=function(){this.points=[],this.indices=[]},PIXI.WebGLGraphicsData.prototype.upload=function(){var t=this.gl;this.glPoints=new PIXI.Float32Array(this.points),t.bindBuffer(t.ARRAY_BUFFER,this.buffer),t.bufferData(t.ARRAY_BUFFER,this.glPoints,t.STATIC_DRAW),this.glIndicies=new PIXI.Uint16Array(this.indices),t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,this.indexBuffer),t.bufferData(t.ELEMENT_ARRAY_BUFFER,this.glIndicies,t.STATIC_DRAW),this.dirty=!1},PIXI.CanvasGraphics=function(){},PIXI.CanvasGraphics.renderGraphics=function(t,e){var i=t.worldAlpha;t.dirty&&(this.updateGraphicsTint(t),t.dirty=!1);for(var n=0;n<t.graphicsData.length;n++){var r,o,s,a,h,l,p,u,d=t.graphicsData[n],c=d.shape,y=d._fillTint,_=d._lineTint;if(e.lineWidth=d.lineWidth,d.type===PIXI.Graphics.POLY){e.beginPath();var m=c.points;e.moveTo(m[0],m[1]);for(var g=1;g<m.length/2;g++)e.lineTo(m[2*g],m[2*g+1]);c.closed&&e.lineTo(m[0],m[1]),m[0]===m[m.length-2]&&m[1]===m[m.length-1]&&e.closePath(),d.fill&&(e.globalAlpha=d.fillAlpha*i,e.fillStyle="#"+("00000"+(0|y).toString(16)).substr(-6),e.fill()),d.lineWidth&&(e.globalAlpha=d.lineAlpha*i,e.strokeStyle="#"+("00000"+(0|_).toString(16)).substr(-6),e.stroke())}else d.type===PIXI.Graphics.RECT?(!d.fillColor&&0!==d.fillColor||(e.globalAlpha=d.fillAlpha*i,e.fillStyle="#"+("00000"+(0|y).toString(16)).substr(-6),e.fillRect(c.x,c.y,c.width,c.height)),d.lineWidth&&(e.globalAlpha=d.lineAlpha*i,e.strokeStyle="#"+("00000"+(0|_).toString(16)).substr(-6),e.strokeRect(c.x,c.y,c.width,c.height))):d.type===PIXI.Graphics.CIRC?(e.beginPath(),e.arc(c.x,c.y,c.radius,0,2*Math.PI),e.closePath(),d.fill&&(e.globalAlpha=d.fillAlpha*i,e.fillStyle="#"+("00000"+(0|y).toString(16)).substr(-6),e.fill()),d.lineWidth&&(e.globalAlpha=d.lineAlpha*i,e.strokeStyle="#"+("00000"+(0|_).toString(16)).substr(-6),e.stroke())):d.type===PIXI.Graphics.ELIP?(s=2*c.width,u=2*c.height,p=c.x-s/2,r=c.y-u/2,e.beginPath(),a=s/2*.5522848,l=u/2*.5522848,o=p+s,h=r+u,s=p+s/2,e.moveTo(p,u=r+u/2),e.bezierCurveTo(p,u-l,s-a,r,s,r),e.bezierCurveTo(s+a,r,o,u-l,o,u),e.bezierCurveTo(o,u+l,s+a,h,s,h),e.bezierCurveTo(s-a,h,p,u+l,p,u),e.closePath(),d.fill&&(e.globalAlpha=d.fillAlpha*i,e.fillStyle="#"+("00000"+(0|y).toString(16)).substr(-6),e.fill()),d.lineWidth&&(e.globalAlpha=d.lineAlpha*i,e.strokeStyle="#"+("00000"+(0|_).toString(16)).substr(-6),e.stroke())):d.type===PIXI.Graphics.RREC&&(a=c.x,h=c.y,l=c.width,p=c.height,u=c.radius,u=(c=Math.min(l,p)/2|0)<u?c:u,e.beginPath(),e.moveTo(a,h+u),e.lineTo(a,h+p-u),e.quadraticCurveTo(a,h+p,a+u,h+p),e.lineTo(a+l-u,h+p),e.quadraticCurveTo(a+l,h+p,a+l,h+p-u),e.lineTo(a+l,h+u),e.quadraticCurveTo(a+l,h,a+l-u,h),e.lineTo(a+u,h),e.quadraticCurveTo(a,h,a,h+u),e.closePath(),!d.fillColor&&0!==d.fillColor||(e.globalAlpha=d.fillAlpha*i,e.fillStyle="#"+("00000"+(0|y).toString(16)).substr(-6),e.fill()),d.lineWidth&&(e.globalAlpha=d.lineAlpha*i,e.strokeStyle="#"+("00000"+(0|_).toString(16)).substr(-6),e.stroke()))}},PIXI.CanvasGraphics.renderGraphicsMask=function(t,e){var i=t.graphicsData.length;if(0!==i){e.beginPath();for(var n=0;n<i;n++){var r,o,s,a,h,l,p,u,d=t.graphicsData[n],c=d.shape;if(d.type===PIXI.Graphics.POLY){var y=c.points;e.moveTo(y[0],y[1]);for(var _=1;_<y.length/2;_++)e.lineTo(y[2*_],y[2*_+1]);y[0]===y[y.length-2]&&y[1]===y[y.length-1]&&e.closePath()}else d.type===PIXI.Graphics.RECT?(e.rect(c.x,c.y,c.width,c.height),e.closePath()):d.type===PIXI.Graphics.CIRC?(e.arc(c.x,c.y,c.radius,0,2*Math.PI),e.closePath()):d.type===PIXI.Graphics.ELIP?(o=(a=2*c.width)/2*.5522848,l=(u=2*c.height)/2*.5522848,s=(p=c.x-a/2)+a,h=(r=c.y-u/2)+u,a=p+a/2,e.moveTo(p,u=r+u/2),e.bezierCurveTo(p,u-l,a-o,r,a,r),e.bezierCurveTo(a+o,r,s,u-l,s,u),e.bezierCurveTo(s,u+l,a+o,h,a,h),e.bezierCurveTo(a-o,h,p,u+l,p,u),e.closePath()):d.type===PIXI.Graphics.RREC&&(h=c.x,l=c.y,p=c.width,u=c.height,d=c.radius,c=Math.min(p,u)/2|0,e.moveTo(h,l+(d=c<d?c:d)),e.lineTo(h,l+u-d),e.quadraticCurveTo(h,l+u,h+d,l+u),e.lineTo(h+p-d,l+u),e.quadraticCurveTo(h+p,l+u,h+p,l+u-d),e.lineTo(h+p,l+d),e.quadraticCurveTo(h+p,l,h+p-d,l),e.lineTo(h+d,l),e.quadraticCurveTo(h,l,h,l+d),e.closePath())}}},PIXI.CanvasGraphics.updateGraphicsTint=function(t){if(16777215!==t.tint)for(var e=(t.tint>>16&255)/255,i=(t.tint>>8&255)/255,n=(255&t.tint)/255,r=0;r<t.graphicsData.length;r++){var o=t.graphicsData[r],s=0|o.fillColor,a=0|o.lineColor;o._fillTint=((s>>16&255)/255*e*255<<16)+((s>>8&255)/255*i*255<<8)+(255&s)/255*n*255,o._lineTint=((a>>16&255)/255*e*255<<16)+((a>>8&255)/255*i*255<<8)+(255&a)/255*n*255}},U.Graphics=function(t,e,i){void 0===e&&(e=0),void 0===i&&(i=0),this.type=U.GRAPHICS,this.physicsType=U.SPRITE,this.anchor=new U.Point,PIXI.Graphics.call(this),U.Component.Core.init.call(this,t,e,i,"",null)},U.Graphics.prototype=Object.create(PIXI.Graphics.prototype),U.Graphics.prototype.constructor=U.Graphics,U.Component.Core.install.call(U.Graphics.prototype,["Angle","AutoCull","Bounds","Destroy","FixedToCamera","InputEnabled","InWorld","LifeSpan","PhysicsBody","Reset"]),U.Graphics.prototype.preUpdatePhysics=U.Component.PhysicsBody.preUpdate,U.Graphics.prototype.preUpdateLifeSpan=U.Component.LifeSpan.preUpdate,U.Graphics.prototype.preUpdateInWorld=U.Component.InWorld.preUpdate,U.Graphics.prototype.preUpdateCore=U.Component.Core.preUpdate,U.Graphics.prototype.preUpdate=function(){return!!(this.preUpdatePhysics()&&this.preUpdateLifeSpan()&&this.preUpdateInWorld())&&this.preUpdateCore()},U.Graphics.prototype.postUpdate=function(){U.Component.PhysicsBody.postUpdate.call(this),U.Component.FixedToCamera.postUpdate.call(this),this._boundsDirty&&(this.updateLocalBounds(),this._boundsDirty=!1);for(var t=0;t<this.children.length;t++)this.children[t].postUpdate()},U.Graphics.prototype.destroy=function(t){this.clear(),U.Component.Destroy.prototype.destroy.call(this,t)},U.Graphics.prototype.drawTriangle=function(t,e){void 0===e&&(e=!1);var i,n=new U.Polygon(t);e?(i=new U.Point(this.game.camera.x-t[0].x,this.game.camera.y-t[0].y),e=new U.Point(t[1].x-t[0].x,t[1].y-t[0].y),e=new U.Point(t[1].x-t[2].x,t[1].y-t[2].y).cross(e),0<i.dot(e)&&this.drawPolygon(n)):this.drawPolygon(n)},U.Graphics.prototype.drawTriangles=function(t,e,i){void 0===i&&(i=!1);var n,r=new U.Point,o=new U.Point,s=new U.Point,a=[];if(e)if(t[0]instanceof U.Point)for(n=0;n<e.length/3;n++)a.push(t[e[3*n]]),a.push(t[e[3*n+1]]),a.push(t[e[3*n+2]]),3===a.length&&(this.drawTriangle(a,i),a=[]);else for(n=0;n<e.length;n++)r.x=t[2*e[n]],r.y=t[2*e[n]+1],a.push(r.copyTo({})),3===a.length&&(this.drawTriangle(a,i),a=[]);else if(t[0]instanceof U.Point)for(n=0;n<t.length/3;n++)this.drawTriangle([t[3*n],t[3*n+1],t[3*n+2]],i);else for(n=0;n<t.length/6;n++)r.x=t[6*n+0],r.y=t[6*n+1],o.x=t[6*n+2],o.y=t[6*n+3],s.x=t[6*n+4],s.y=t[6*n+5],this.drawTriangle([r,o,s],i)},U.RenderTexture=function(t,e,i,n,r,o){void 0===n&&(n=""),void 0===r&&(r=U.scaleModes.DEFAULT),void 0===o&&(o=1),this.game=t,this.key=n,this.type=U.RENDERTEXTURE,this._tempMatrix=new PIXI.Matrix,PIXI.RenderTexture.call(this,e,i,this.game.renderer,r,o),this.render=U.RenderTexture.prototype.render},U.RenderTexture.prototype=Object.create(PIXI.RenderTexture.prototype),U.RenderTexture.prototype.constructor=U.RenderTexture,U.RenderTexture.prototype.renderXY=function(t,e,i,n){t.updateTransform(),this._tempMatrix.copyFrom(t.worldTransform),this._tempMatrix.tx=e,this._tempMatrix.ty=i,this.renderer.type===PIXI.WEBGL_RENDERER?this.renderWebGL(t,this._tempMatrix,n):this.renderCanvas(t,this._tempMatrix,n)},U.RenderTexture.prototype.renderRawXY=function(t,e,i,n){this._tempMatrix.identity().translate(e,i),this.renderer.type===PIXI.WEBGL_RENDERER?this.renderWebGL(t,this._tempMatrix,n):this.renderCanvas(t,this._tempMatrix,n)},U.RenderTexture.prototype.render=function(t,e,i){null==e?this._tempMatrix.copyFrom(t.worldTransform):this._tempMatrix.copyFrom(e),this.renderer.type===PIXI.WEBGL_RENDERER?this.renderWebGL(t,this._tempMatrix,i):this.renderCanvas(t,this._tempMatrix,i)},U.Text=function(t,e,i,n,r){e=e||0,i=i||0,n=null==n?"":n.toString(),r=U.Utils.extend({},r),this.type=U.TEXT,this.physicsType=U.SPRITE,this.padding=new U.Point,this.textBounds=null,this.canvas=PIXI.CanvasPool.create(this),this.context=this.canvas.getContext("2d"),this.colors=[],this.strokeColors=[],this.fontStyles=[],this.fontWeights=[],this.autoRound=!1,this.useAdvancedWrap=!1,this._res=t.renderer.resolution,this._text=n,this._fontComponents=null,this._lineSpacing=0,this._charCount=0,this._width=0,this._height=0,U.Sprite.call(this,t,e,i,PIXI.Texture.fromCanvas(this.canvas)),this.setStyle(r),""!==n&&this.updateText()},U.Text.prototype=Object.create(U.Sprite.prototype),U.Text.prototype.constructor=U.Text,U.Text.prototype.preUpdate=function(){return!!(this.preUpdatePhysics()&&this.preUpdateLifeSpan()&&this.preUpdateInWorld())&&this.preUpdateCore()},U.Text.prototype.update=function(){},U.Text.prototype.destroy=function(t){this.texture.destroy(!0),U.Component.Destroy.prototype.destroy.call(this,t)},U.Text.prototype.setShadow=function(t,e,i,n,r,o){return void 0===e&&(e=0),void 0===i&&(i="rgba(0, 0, 0, 1)"),void 0===n&&(n=0),void 0===r&&(r=!0),void 0===o&&(o=!0),this.style.shadowOffsetX=t=void 0===t?0:t,this.style.shadowOffsetY=e,this.style.shadowColor=i,this.style.shadowBlur=n,this.style.shadowStroke=r,this.style.shadowFill=o,this.dirty=!0,this},U.Text.prototype.setStyle=function(t,e){void 0===e&&(e=!1),(t=t||{}).font=t.font||"bold 20pt Arial",t.backgroundColor=t.backgroundColor||null,t.fill=t.fill||"black",t.align=t.align||"left",t.boundsAlignH=t.boundsAlignH||"left",t.boundsAlignV=t.boundsAlignV||"top",t.stroke=t.stroke||"black",t.strokeThickness=t.strokeThickness||0,t.wordWrap=t.wordWrap||!1,t.wordWrapWidth=t.wordWrapWidth||100,t.maxLines=t.maxLines||0,t.shadowOffsetX=t.shadowOffsetX||0,t.shadowOffsetY=t.shadowOffsetY||0,t.shadowColor=t.shadowColor||"rgba(0,0,0,0)",t.shadowBlur=t.shadowBlur||0,t.tabs=t.tabs||0;var i=this.fontToComponents(t.font);return t.fontStyle&&(i.fontStyle=t.fontStyle),t.fontVariant&&(i.fontVariant=t.fontVariant),t.fontWeight&&(i.fontWeight=t.fontWeight),t.fontSize&&("number"==typeof t.fontSize&&(t.fontSize=t.fontSize+"px"),i.fontSize=t.fontSize),this._fontComponents=i,t.font=this.componentsToFont(this._fontComponents),this.style=t,this.dirty=!0,e&&this.updateText(),this},U.Text.prototype.updateText=function(){this.texture.baseTexture.resolution=this._res,this.context.font=this.style.font;var t=this.text,e=(t=this.style.wordWrap?this.runWordWrap(this.text):t).split(/(?:\r\n|\r|\n)/),i=this.style.tabs,n=[],r=0,o=this.determineFontProperties(this.style.font),s=e.length;0<this.style.maxLines&&this.style.maxLines<e.length&&(s=this.style.maxLines);for(var a=this._charCount=0;a<s;a++){if(0===i){var h=this.style.strokeThickness+this.padding.x;0<this.colors.length||0<this.strokeColors.length||0<this.fontWeights.length||0<this.fontStyles.length?h+=this.measureLine(e[a]):h+=this.context.measureText(e[a]).width,this.style.wordWrap&&(h-=this.context.measureText(" ").width)}else{var l=e[a].split(/(?:\t)/),h=this.padding.x+this.style.strokeThickness;if(Array.isArray(i))for(var p=0,u=0;u<l.length;u++){var d=0,d=0<this.colors.length||0<this.strokeColors.length||0<this.fontWeights.length||0<this.fontStyles.length?this.measureLine(l[u]):Math.ceil(this.context.measureText(l[u]).width);0<u&&(p+=i[u-1]),h=p+d}else for(u=0;u<l.length;u++)0<this.colors.length||0<this.strokeColors.length||0<this.fontWeights.length||0<this.fontStyles.length?h+=this.measureLine(l[u]):h+=Math.ceil(this.context.measureText(l[u]).width),h+=this.game.math.snapToCeil(h,i)-h}n[a]=Math.ceil(h),r=Math.max(r,n[a])}this.canvas.width=r*this._res;var c,y,_=o.fontSize+this.style.strokeThickness+this.padding.y,t=_*s,m=this._lineSpacing;for(0!==(m=m<0&&Math.abs(m)>_?-_:m)&&(t+=0<m?m*e.length:m*(e.length-1)),this.canvas.height=t*this._res,this.context.scale(this._res,this._res),navigator.isCocoonJS&&this.context.clearRect(0,0,this.canvas.width,this.canvas.height),this.style.backgroundColor&&(this.context.fillStyle=this.style.backgroundColor,this.context.fillRect(0,0,this.canvas.width,this.canvas.height)),this.context.fillStyle=this.style.fill,this.context.font=this.style.font,this.context.strokeStyle=this.style.stroke,this.context.textBaseline="alphabetic",this.context.lineWidth=this.style.strokeThickness,this.context.lineCap="round",this.context.lineJoin="round",a=this._charCount=0;a<s;a++)c=this.style.strokeThickness/2,y=this.style.strokeThickness/2+a*_+o.ascent,0<a&&(y+=m*a),"right"===this.style.align?c+=r-n[a]:"center"===this.style.align&&(c+=(r-n[a])/2),this.autoRound&&(c=Math.round(c),y=Math.round(y)),0<this.colors.length||0<this.strokeColors.length||0<this.fontWeights.length||0<this.fontStyles.length?this.updateLine(e[a],c,y):(this.style.stroke&&this.style.strokeThickness&&(this.updateShadow(this.style.shadowStroke),0===i?this.context.strokeText(e[a],c,y):this.renderTabLine(e[a],c,y,!1)),this.style.fill&&(this.updateShadow(this.style.shadowFill),0===i?this.context.fillText(e[a],c,y):this.renderTabLine(e[a],c,y,!0)));this.updateTexture(),this.dirty=!1},U.Text.prototype.renderTabLine=function(t,e,i,n){var r=t.split(/(?:\t)/),o=this.style.tabs,s=0;if(Array.isArray(o))for(var a=0,h=0;h<r.length;h++)0<h&&(a+=o[h-1]),s=e+a,n?this.context.fillText(r[h],s,i):this.context.strokeText(r[h],s,i);else for(h=0;h<r.length;h++){var l=Math.ceil(this.context.measureText(r[h]).width),s=this.game.math.snapToCeil(e,o);n?this.context.fillText(r[h],s,i):this.context.strokeText(r[h],s,i),e=s+l}},U.Text.prototype.updateShadow=function(t){t?(this.context.shadowOffsetX=this.style.shadowOffsetX,this.context.shadowOffsetY=this.style.shadowOffsetY,this.context.shadowColor=this.style.shadowColor,this.context.shadowBlur=this.style.shadowBlur):(this.context.shadowOffsetX=0,this.context.shadowOffsetY=0,this.context.shadowColor=0,this.context.shadowBlur=0)},U.Text.prototype.measureLine=function(t){for(var e=0,i=0;i<t.length;i++){var n,r=t[i];(0<this.fontWeights.length||0<this.fontStyles.length)&&(n=this.fontToComponents(this.context.font),this.fontStyles[this._charCount]&&(n.fontStyle=this.fontStyles[this._charCount]),this.fontWeights[this._charCount]&&(n.fontWeight=this.fontWeights[this._charCount]),this.context.font=this.componentsToFont(n)),this.style.stroke&&this.style.strokeThickness&&(this.strokeColors[this._charCount]&&(this.context.strokeStyle=this.strokeColors[this._charCount]),this.updateShadow(this.style.shadowStroke)),this.style.fill&&(this.colors[this._charCount]&&(this.context.fillStyle=this.colors[this._charCount]),this.updateShadow(this.style.shadowFill)),e+=this.context.measureText(r).width,this._charCount++}return Math.ceil(e)},U.Text.prototype.updateLine=function(t,e,i){for(var n=0;n<t.length;n++){var r,o=t[n];(0<this.fontWeights.length||0<this.fontStyles.length)&&(r=this.fontToComponents(this.context.font),this.fontStyles[this._charCount]&&(r.fontStyle=this.fontStyles[this._charCount]),this.fontWeights[this._charCount]&&(r.fontWeight=this.fontWeights[this._charCount]),this.context.font=this.componentsToFont(r)),this.style.stroke&&this.style.strokeThickness&&(this.strokeColors[this._charCount]&&(this.context.strokeStyle=this.strokeColors[this._charCount]),this.updateShadow(this.style.shadowStroke),this.context.strokeText(o,e,i)),this.style.fill&&(this.colors[this._charCount]&&(this.context.fillStyle=this.colors[this._charCount]),this.updateShadow(this.style.shadowFill),this.context.fillText(o,e,i)),e+=this.context.measureText(o).width,this._charCount++}},U.Text.prototype.clearColors=function(){return this.colors=[],this.strokeColors=[],this.dirty=!0,this},U.Text.prototype.clearFontValues=function(){return this.fontStyles=[],this.fontWeights=[],this.dirty=!0,this},U.Text.prototype.addColor=function(t,e){return this.colors[e]=t,this.dirty=!0,this},U.Text.prototype.addStrokeColor=function(t,e){return this.strokeColors[e]=t,this.dirty=!0,this},U.Text.prototype.addFontStyle=function(t,e){return this.fontStyles[e]=t,this.dirty=!0,this},U.Text.prototype.addFontWeight=function(t,e){return this.fontWeights[e]=t,this.dirty=!0,this},U.Text.prototype.precalculateWordWrap=function(t){return this.texture.baseTexture.resolution=this._res,this.context.font=this.style.font,this.runWordWrap(t).split(/(?:\r\n|\r|\n)/)},U.Text.prototype.runWordWrap=function(t){return this.useAdvancedWrap?this.advancedWordWrap(t):this.basicWordWrap(t)},U.Text.prototype.advancedWordWrap=function(t){for(var e=this.context,i=this.style.wordWrapWidth,n="",r=t.replace(/ +/gi," ").split(/\r?\n/gi),o=r.length,s=0;s<o;s++){var a="",h=(h=r[s]).replace(/^ *|\s*$/gi,"");if(e.measureText(h).width<i)n+=h+"\n";else{for(var l=i,p=h.split(" "),u=0;u<p.length;u++){var d=p[u],c=d+" ",y=e.measureText(c).width;if(l<y){if(0===u){for(var _=c;_.length&&(_=_.slice(0,-1),!((y=e.measureText(_).width)<=l)););if(!_.length)throw new Error("This text's wordWrapWidth setting is less than a single character!");var m=d.substr(_.length);p[u]=m,a+=_}m=p[u].length?u:u+1,m=p.slice(m).join(" ").replace(/[ \n]*$/gi,"");r[s+1]=m+" "+(r[s+1]||""),o=r.length;break}a+=c,l-=y}n+=a.replace(/[ \n]*$/gi,"")+"\n"}}return n=n.replace(/[\s|\n]*$/gi,"")},U.Text.prototype.basicWordWrap=function(t){for(var e="",i=t.split("\n"),n=0;n<i.length;n++){for(var r=this.style.wordWrapWidth,o=i[n].split(" "),s=0;s<o.length;s++){var a=this.context.measureText(o[s]).width,h=a+this.context.measureText(" ").width;r<h?(0<s&&(e+="\n"),e+=o[s]+" ",r=this.style.wordWrapWidth-a):(r-=h,e+=o[s]+" ")}n<i.length-1&&(e+="\n")}return e},U.Text.prototype.updateFont=function(t){t=this.componentsToFont(t);this.style.font!==t&&(this.style.font=t,this.dirty=!0,this.parent&&this.updateTransform())},U.Text.prototype.fontToComponents=function(t){var e=t.match(/^\s*(?:\b(normal|italic|oblique|inherit)?\b)\s*(?:\b(normal|small-caps|inherit)?\b)\s*(?:\b(normal|bold|bolder|lighter|100|200|300|400|500|600|700|800|900|inherit)?\b)\s*(?:\b(xx-small|x-small|small|medium|large|x-large|xx-large|larger|smaller|0|\d*(?:[.]\d*)?(?:%|[a-z]{2,5}))?\b)\s*(.*)\s*$/);if(e){var i=e[5].trim();return/^(?:inherit|serif|sans-serif|cursive|fantasy|monospace)$/.exec(i)||/['",]/.exec(i)||(i="'"+i+"'"),{font:t,fontStyle:e[1]||"normal",fontVariant:e[2]||"normal",fontWeight:e[3]||"normal",fontSize:e[4]||"medium",fontFamily:i}}return{font:t}},U.Text.prototype.componentsToFont=function(t){var e=[],i=t.fontStyle;return i&&"normal"!==i&&e.push(i),(i=t.fontVariant)&&"normal"!==i&&e.push(i),(i=t.fontWeight)&&"normal"!==i&&e.push(i),(i=t.fontSize)&&"medium"!==i&&e.push(i),(i=t.fontFamily)&&e.push(i),e.length||e.push(t.font),e.join(" ")},U.Text.prototype.setText=function(t,e){return void 0===e&&(e=!1),this.text=t.toString()||"",e?this.updateText():this.dirty=!0,this},U.Text.prototype.parseList=function(t){if(!Array.isArray(t))return this;for(var e="",i=0;i<t.length;i++)Array.isArray(t[i])?(e+=t[i].join("\t"),i<t.length-1&&(e+="\n")):(e+=t[i],i<t.length-1&&(e+="\t"));return this.text=e,this.dirty=!0,this},U.Text.prototype.setTextBounds=function(t,e,i,n){return void 0===t?this.textBounds=null:(this.textBounds?this.textBounds.setTo(t,e,i,n):this.textBounds=new U.Rectangle(t,e,i,n),this.style.wordWrapWidth>i&&(this.style.wordWrapWidth=i)),this.updateTexture(),this},U.Text.prototype.updateTexture=function(){var t=this.texture.baseTexture,e=this.texture.crop,i=this.texture.frame,n=this.canvas.width,r=this.canvas.height;t.width=n,t.height=r,e.width=n,e.height=r,i.width=n,i.height=r,this.texture.width=n,this.texture.height=r,this._width=n,this._height=r,this.textBounds&&(e=this.textBounds.x,i=this.textBounds.y,"right"===this.style.boundsAlignH?e+=this.textBounds.width-this.canvas.width/this.resolution:"center"===this.style.boundsAlignH&&(e+=this.textBounds.halfWidth-this.canvas.width/this.resolution/2),"bottom"===this.style.boundsAlignV?i+=this.textBounds.height-this.canvas.height/this.resolution:"middle"===this.style.boundsAlignV&&(i+=this.textBounds.halfHeight-this.canvas.height/this.resolution/2),this.pivot.x=-e,this.pivot.y=-i),this.renderable=0!==n&&0!==r,this.texture.requiresReTint=!0,this.texture.baseTexture.dirty()},U.Text.prototype._renderWebGL=function(t){this.dirty&&(this.updateText(),this.dirty=!1),PIXI.Sprite.prototype._renderWebGL.call(this,t)},U.Text.prototype._renderCanvas=function(t){this.dirty&&(this.updateText(),this.dirty=!1),PIXI.Sprite.prototype._renderCanvas.call(this,t)},U.Text.prototype.determineFontProperties=function(t){if(!(e=U.Text.fontPropertiesCache[t])){var e={},i=U.Text.fontPropertiesCanvas,n=U.Text.fontPropertiesContext;n.font=t;var r=Math.ceil(n.measureText("|Mq").width),o=2*(s=Math.ceil(n.measureText("|Mq").width)),s=1.4*s|0;if(i.width=r,i.height=o,n.fillStyle="#f00",n.fillRect(0,0,r,o),n.font=t,n.textBaseline="alphabetic",n.fillStyle="#000",n.fillText("|Mq",0,s),!n.getImageData(0,0,r,o))return e.ascent=s,e.descent=6+s,e.fontSize=e.ascent+e.descent,U.Text.fontPropertiesCache[t]=e;for(var a,h=n.getImageData(0,0,r,o).data,n=h.length,l=4*r,p=0,u=!1,d=0;d<s;d++){for(a=0;a<l;a+=4)if(255!==h[p+a]){u=!0;break}if(u)break;p+=l}for(e.ascent=s-d,p=n-l,u=!1,d=o;s<d;d--){for(a=0;a<l;a+=4)if(255!==h[p+a]){u=!0;break}if(u)break;p-=l}e.descent=d-s,e.descent+=6,e.fontSize=e.ascent+e.descent,U.Text.fontPropertiesCache[t]=e}return e},U.Text.prototype.getBounds=function(t){return this.dirty&&(this.updateText(),this.dirty=!1),PIXI.Sprite.prototype.getBounds.call(this,t)},Object.defineProperty(U.Text.prototype,"text",{get:function(){return this._text},set:function(t){t!==this._text&&(this._text=t.toString()||"",this.dirty=!0,this.parent&&this.updateTransform())}}),Object.defineProperty(U.Text.prototype,"cssFont",{get:function(){return this.componentsToFont(this._fontComponents)},set:function(t){this._fontComponents=this.fontToComponents(t=t||"bold 20pt Arial"),this.updateFont(this._fontComponents)}}),Object.defineProperty(U.Text.prototype,"font",{get:function(){return this._fontComponents.fontFamily},set:function(t){t=(t=t||"Arial").trim(),/^(?:inherit|serif|sans-serif|cursive|fantasy|monospace)$/.exec(t)||/['",]/.exec(t)||(t="'"+t+"'"),this._fontComponents.fontFamily=t,this.updateFont(this._fontComponents)}}),Object.defineProperty(U.Text.prototype,"fontSize",{get:function(){var t=this._fontComponents.fontSize;return t&&/(?:^0$|px$)/.exec(t)?parseInt(t,10):t},set:function(t){"number"==typeof(t=t||"0")&&(t+="px"),this._fontComponents.fontSize=t,this.updateFont(this._fontComponents)}}),Object.defineProperty(U.Text.prototype,"fontWeight",{get:function(){return this._fontComponents.fontWeight||"normal"},set:function(t){this._fontComponents.fontWeight=t=t||"normal",this.updateFont(this._fontComponents)}}),Object.defineProperty(U.Text.prototype,"fontStyle",{get:function(){return this._fontComponents.fontStyle||"normal"},set:function(t){this._fontComponents.fontStyle=t=t||"normal",this.updateFont(this._fontComponents)}}),Object.defineProperty(U.Text.prototype,"fontVariant",{get:function(){return this._fontComponents.fontVariant||"normal"},set:function(t){this._fontComponents.fontVariant=t=t||"normal",this.updateFont(this._fontComponents)}}),Object.defineProperty(U.Text.prototype,"fill",{get:function(){return this.style.fill},set:function(t){t!==this.style.fill&&(this.style.fill=t,this.dirty=!0)}}),Object.defineProperty(U.Text.prototype,"align",{get:function(){return this.style.align},set:function(t){t!==this.style.align&&(this.style.align=t,this.dirty=!0)}}),Object.defineProperty(U.Text.prototype,"resolution",{get:function(){return this._res},set:function(t){t!==this._res&&(this._res=t,this.dirty=!0)}}),Object.defineProperty(U.Text.prototype,"tabs",{get:function(){return this.style.tabs},set:function(t){t!==this.style.tabs&&(this.style.tabs=t,this.dirty=!0)}}),Object.defineProperty(U.Text.prototype,"boundsAlignH",{get:function(){return this.style.boundsAlignH},set:function(t){t!==this.style.boundsAlignH&&(this.style.boundsAlignH=t,this.dirty=!0)}}),Object.defineProperty(U.Text.prototype,"boundsAlignV",{get:function(){return this.style.boundsAlignV},set:function(t){t!==this.style.boundsAlignV&&(this.style.boundsAlignV=t,this.dirty=!0)}}),Object.defineProperty(U.Text.prototype,"stroke",{get:function(){return this.style.stroke},set:function(t){t!==this.style.stroke&&(this.style.stroke=t,this.dirty=!0)}}),Object.defineProperty(U.Text.prototype,"strokeThickness",{get:function(){return this.style.strokeThickness},set:function(t){t!==this.style.strokeThickness&&(this.style.strokeThickness=t,this.dirty=!0)}}),Object.defineProperty(U.Text.prototype,"wordWrap",{get:function(){return this.style.wordWrap},set:function(t){t!==this.style.wordWrap&&(this.style.wordWrap=t,this.dirty=!0)}}),Object.defineProperty(U.Text.prototype,"wordWrapWidth",{get:function(){return this.style.wordWrapWidth},set:function(t){t!==this.style.wordWrapWidth&&(this.style.wordWrapWidth=t,this.dirty=!0)}}),Object.defineProperty(U.Text.prototype,"lineSpacing",{get:function(){return this._lineSpacing},set:function(t){t!==this._lineSpacing&&(this._lineSpacing=parseFloat(t),this.dirty=!0,this.parent&&this.updateTransform())}}),Object.defineProperty(U.Text.prototype,"shadowOffsetX",{get:function(){return this.style.shadowOffsetX},set:function(t){t!==this.style.shadowOffsetX&&(this.style.shadowOffsetX=t,this.dirty=!0)}}),Object.defineProperty(U.Text.prototype,"shadowOffsetY",{get:function(){return this.style.shadowOffsetY},set:function(t){t!==this.style.shadowOffsetY&&(this.style.shadowOffsetY=t,this.dirty=!0)}}),Object.defineProperty(U.Text.prototype,"shadowColor",{get:function(){return this.style.shadowColor},set:function(t){t!==this.style.shadowColor&&(this.style.shadowColor=t,this.dirty=!0)}}),Object.defineProperty(U.Text.prototype,"shadowBlur",{get:function(){return this.style.shadowBlur},set:function(t){t!==this.style.shadowBlur&&(this.style.shadowBlur=t,this.dirty=!0)}}),Object.defineProperty(U.Text.prototype,"shadowStroke",{get:function(){return this.style.shadowStroke},set:function(t){t!==this.style.shadowStroke&&(this.style.shadowStroke=t,this.dirty=!0)}}),Object.defineProperty(U.Text.prototype,"shadowFill",{get:function(){return this.style.shadowFill},set:function(t){t!==this.style.shadowFill&&(this.style.shadowFill=t,this.dirty=!0)}}),Object.defineProperty(U.Text.prototype,"width",{get:function(){return this.dirty&&(this.updateText(),this.dirty=!1),this.scale.x*this.texture.frame.width},set:function(t){this.scale.x=t/this.texture.frame.width,this._width=t}}),Object.defineProperty(U.Text.prototype,"height",{get:function(){return this.dirty&&(this.updateText(),this.dirty=!1),this.scale.y*this.texture.frame.height},set:function(t){this.scale.y=t/this.texture.frame.height,this._height=t}}),U.Text.fontPropertiesCache={},U.Text.fontPropertiesCanvas=document.createElement("canvas"),U.Text.fontPropertiesContext=U.Text.fontPropertiesCanvas.getContext("2d"),U.BitmapText=function(t,e,i,n,r,o,s){e=e||0,i=i||0,n=n||"",r=r||"",o=o||32,s=s||"left",PIXI.DisplayObjectContainer.call(this),this.type=U.BITMAPTEXT,this.physicsType=U.SPRITE,this.textWidth=0,this.textHeight=0,this.anchor=new U.Point,this._prevAnchor=new U.Point,this._glyphs=[],this._maxWidth=0,this._text=r.toString()||"",this._data=t.cache.getBitmapFont(n),this._font=n,this._fontSize=o,this._align=s,this._tint=16777215,this.updateText(),this.dirty=!1,U.Component.Core.init.call(this,t,e,i,"",null)},U.BitmapText.prototype=Object.create(PIXI.DisplayObjectContainer.prototype),U.BitmapText.prototype.constructor=U.BitmapText,U.Component.Core.install.call(U.BitmapText.prototype,["Angle","AutoCull","Bounds","Destroy","FixedToCamera","InputEnabled","InWorld","LifeSpan","PhysicsBody","Reset"]),U.BitmapText.prototype.preUpdatePhysics=U.Component.PhysicsBody.preUpdate,U.BitmapText.prototype.preUpdateLifeSpan=U.Component.LifeSpan.preUpdate,U.BitmapText.prototype.preUpdateInWorld=U.Component.InWorld.preUpdate,U.BitmapText.prototype.preUpdateCore=U.Component.Core.preUpdate,U.BitmapText.prototype.preUpdate=function(){return!!(this.preUpdatePhysics()&&this.preUpdateLifeSpan()&&this.preUpdateInWorld())&&this.preUpdateCore()},U.BitmapText.prototype.postUpdate=function(){U.Component.PhysicsBody.postUpdate.call(this),U.Component.FixedToCamera.postUpdate.call(this),this.body&&this.body.type===U.Physics.ARCADE&&(this.textWidth===this.body.sourceWidth&&this.textHeight===this.body.sourceHeight||this.body.setSize(this.textWidth,this.textHeight))},U.BitmapText.prototype.setText=function(t){this.text=t},U.BitmapText.prototype.scanLine=function(t,e,i){for(var n=0,r=0,o=-1,s=0,a=null,h=0<this._maxWidth?this._maxWidth:null,l=[],p=0;p<i.length;p++){var u=p===i.length-1;if(/(?:\r\n|\r|\n)/.test(i.charAt(p)))return{width:r,text:i.substr(0,p),end:u,chars:l};var d,c=i.charCodeAt(p),y=t.chars[c];void 0===y&&(y=t.chars[c=32]);var _=a&&y.kerning[a]?y.kerning[a]:0;if(/(\s)/.test(i.charAt(p))&&(o=p,s=r),d=(_+y.texture.width+y.xOffset)*e,h&&h<=r+d&&-1<o)return{width:s||r,text:i.substr(0,p-(p-o)),end:u,chars:l};r+=(y.xAdvance+_)*e,l.push(n+(y.xOffset+_)*e),n+=(y.xAdvance+_)*e,a=c}return{width:r,text:i,end:u,chars:l}},U.BitmapText.prototype.cleanText=function(t,e){void 0===e&&(e="");var i=this._data.font;if(!i)return"";for(var n=t.replace(/\r\n|\n\r|\n|\r/g,"\n").split("\n"),r=0;r<n.length;r++){for(var o="",s=n[r],a=0;a<s.length;a++)o=i.chars[s.charCodeAt(a)]?o.concat(s[a]):o.concat(e);n[r]=o}return n.join("\n")},U.BitmapText.prototype.updateText=function(){var t=this._data.font;if(t){var e=this.text,i=this._fontSize/t.size,n=[],r=0;this.textWidth=0;do{}while((p=this.scanLine(t,i,e)).y=r,n.push(p),p.width>this.textWidth&&(this.textWidth=p.width),r+=t.lineHeight*i,e=e.substr(p.text.length+1),!1===p.end);this.textHeight=r;for(var o=0,s=0,a=this.textWidth*this.anchor.x,h=this.textHeight*this.anchor.y,l=0;l<n.length;l++){var p=n[l];"right"===this._align?s=this.textWidth-p.width:"center"===this._align&&(s=(this.textWidth-p.width)/2);for(var u=0;u<p.text.length;u++){var d=p.text.charCodeAt(u),c=t.chars[d];void 0===c&&(c=t.chars[32]);d=this._glyphs[o];d?d.texture=c.texture:((d=new PIXI.Sprite(c.texture)).name=p.text[u],this._glyphs.push(d)),d.position.x=p.chars[u]+s-a,d.position.y=p.y+c.yOffset*i-h,d.scale.set(i),d.tint=this.tint,d.texture.requiresReTint=!0,d.parent||this.addChild(d),o++}}for(l=o;l<this._glyphs.length;l++)this.removeChild(this._glyphs[l])}},U.BitmapText.prototype.purgeGlyphs=function(){for(var t=this._glyphs.length,e=[],i=0;i<this._glyphs.length;i++)this._glyphs[i].parent!==this?this._glyphs[i].destroy():e.push(this._glyphs[i]);return this._glyphs=[],this._glyphs=e,this.updateText(),t-e.length},U.BitmapText.prototype.updateTransform=function(){!this.dirty&&this.anchor.equals(this._prevAnchor)||(this.updateText(),this.dirty=!1,this._prevAnchor.copyFrom(this.anchor)),PIXI.DisplayObjectContainer.prototype.updateTransform.call(this)},Object.defineProperty(U.BitmapText.prototype,"align",{get:function(){return this._align},set:function(t){t===this._align||"left"!==t&&"center"!==t&&"right"!==t||(this._align=t,this.updateText())}}),Object.defineProperty(U.BitmapText.prototype,"tint",{get:function(){return this._tint},set:function(t){t!==this._tint&&(this._tint=t,this.updateText())}}),Object.defineProperty(U.BitmapText.prototype,"font",{get:function(){return this._font},set:function(t){t!==this._font&&(this._font=t.trim(),this._data=this.game.cache.getBitmapFont(this._font),this.updateText())}}),Object.defineProperty(U.BitmapText.prototype,"fontSize",{get:function(){return this._fontSize},set:function(t){(t=parseInt(t,10))!==this._fontSize&&0<t&&(this._fontSize=t,this.updateText())}}),Object.defineProperty(U.BitmapText.prototype,"text",{get:function(){return this._text},set:function(t){t!==this._text&&(this._text=t.toString()||"",this.updateText())}}),Object.defineProperty(U.BitmapText.prototype,"maxWidth",{get:function(){return this._maxWidth},set:function(t){t!==this._maxWidth&&(this._maxWidth=t,this.updateText())}}),Object.defineProperty(U.BitmapText.prototype,"smoothed",{get:function(){return!this._data.base.scaleMode},set:function(t){this._data.base.scaleMode=t?0:1}}),U.RetroFont=function(t,e,i,n,r,o,s,a,h,l){if(!t.cache.checkImageKey(e))return!1;null==o&&(o=t.cache.getImage(e).width/i),this.characterWidth=i,this.characterHeight=n,this.characterSpacingX=s||0,this.characterSpacingY=a||0,this.characterPerRow=o,this.offsetX=h||0,this.offsetY=l||0,this.align="left",this.multiLine=!1,this.autoUpperCase=!0,this.customSpacingX=0,this.customSpacingY=0,this.fixedWidth=0,this.fontSet=t.cache.getImage(e),this._text="",this.grabData=[],this.frameData=new U.FrameData;for(var p=this.offsetX,u=this.offsetY,d=0,c=0;c<r.length;c++){var y=this.frameData.addFrame(new U.Frame(c,p,u,this.characterWidth,this.characterHeight));this.grabData[r.charCodeAt(c)]=y.index,++d===this.characterPerRow?(d=0,p=this.offsetX,u+=this.characterHeight+this.characterSpacingY):p+=this.characterWidth+this.characterSpacingX}t.cache.updateFrameData(e,this.frameData),this.stamp=new U.Image(t,0,0,e,0),U.RenderTexture.call(this,t,100,100,"",U.scaleModes.NEAREST),this.type=U.RETROFONT},U.RetroFont.prototype=Object.create(U.RenderTexture.prototype),U.RetroFont.prototype.constructor=U.RetroFont,U.RetroFont.ALIGN_LEFT="left",U.RetroFont.ALIGN_RIGHT="right",U.RetroFont.ALIGN_CENTER="center",U.RetroFont.TEXT_SET1=" !\"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_`abcdefghijklmnopqrstuvwxyz{|}~",U.RetroFont.TEXT_SET2=" !\"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ",U.RetroFont.TEXT_SET3="ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789 ",U.RetroFont.TEXT_SET4="ABCDEFGHIJKLMNOPQRSTUVWXYZ 0123456789",U.RetroFont.TEXT_SET5="ABCDEFGHIJKLMNOPQRSTUVWXYZ.,/() '!?-*:0123456789",U.RetroFont.TEXT_SET6="ABCDEFGHIJKLMNOPQRSTUVWXYZ!?:;0123456789\"(),-.' ",U.RetroFont.TEXT_SET7="AGMSY+:4BHNTZ!;5CIOU.?06DJPV,(17EKQW\")28FLRX-'39",U.RetroFont.TEXT_SET8="0123456789 .ABCDEFGHIJKLMNOPQRSTUVWXYZ",U.RetroFont.TEXT_SET9="ABCDEFGHIJKLMNOPQRSTUVWXYZ()-0123456789.:,'\"?!",U.RetroFont.TEXT_SET10="ABCDEFGHIJKLMNOPQRSTUVWXYZ",U.RetroFont.TEXT_SET11="ABCDEFGHIJKLMNOPQRSTUVWXYZ.,\"-+!?()':;0123456789",U.RetroFont.prototype.setFixedWidth=function(t,e){void 0===e&&(e="left"),this.fixedWidth=t,this.align=e},U.RetroFont.prototype.setText=function(t,e,i,n,r,o){this.multiLine=e||!1,this.customSpacingX=i||0,this.customSpacingY=n||0,this.align=r||"left",this.autoUpperCase=!o,0<t.length&&(this.text=t)},U.RetroFont.prototype.buildRetroFontText=function(){var t=0,e=0;if(this.clear(),this.multiLine){var i=this._text.split("\n");0<this.fixedWidth?this.resize(this.fixedWidth,i.length*(this.characterHeight+this.customSpacingY)-this.customSpacingY,!0):this.resize(this.getLongestLine()*(this.characterWidth+this.customSpacingX),i.length*(this.characterHeight+this.customSpacingY)-this.customSpacingY,!0);for(var n=0;n<i.length;n++)t=0,this.align===U.RetroFont.ALIGN_RIGHT?t=this.width-i[n].length*(this.characterWidth+this.customSpacingX):this.align===U.RetroFont.ALIGN_CENTER&&(t=this.width/2-i[n].length*(this.characterWidth+this.customSpacingX)/2,t+=this.customSpacingX/2),this.pasteLine(i[n],t=t<0?0:t,e,this.customSpacingX),e+=this.characterHeight+this.customSpacingY}else 0<this.fixedWidth?this.resize(this.fixedWidth,this.characterHeight,!0):this.resize(this._text.length*(this.characterWidth+this.customSpacingX),this.characterHeight,!0),t=0,this.align===U.RetroFont.ALIGN_RIGHT?t=this.width-this._text.length*(this.characterWidth+this.customSpacingX):this.align===U.RetroFont.ALIGN_CENTER&&(t=this.width/2-this._text.length*(this.characterWidth+this.customSpacingX)/2,t+=this.customSpacingX/2),this.pasteLine(this._text,t=t<0?0:t,0,this.customSpacingX);this.requiresReTint=!0},U.RetroFont.prototype.pasteLine=function(t,e,i,n){for(var r=0;r<t.length;r++)if(" "===t.charAt(r))e+=this.characterWidth+n;else if(0<=this.grabData[t.charCodeAt(r)]&&(this.stamp.frame=this.grabData[t.charCodeAt(r)],this.renderXY(this.stamp,e,i,!1),(e+=this.characterWidth+n)>this.width))break},U.RetroFont.prototype.getLongestLine=function(){var t=0;if(0<this._text.length)for(var e=this._text.split("\n"),i=0;i<e.length;i++)e[i].length>t&&(t=e[i].length);return t},U.RetroFont.prototype.removeUnsupportedCharacters=function(t){for(var e="",i=0;i<this._text.length;i++){var n=this._text[i],r=n.charCodeAt(0);(0<=this.grabData[r]||!t&&"\n"===n)&&(e=e.concat(n))}return e},U.RetroFont.prototype.updateOffset=function(t,e){if(this.offsetX!==t||this.offsetY!==e){for(var i=t-this.offsetX,n=e-this.offsetY,r=this.game.cache.getFrameData(this.stamp.key).getFrames(),o=r.length;o--;)r[o].x+=i,r[o].y+=n;this.buildRetroFontText()}},Object.defineProperty(U.RetroFont.prototype,"text",{get:function(){return this._text},set:function(t){t=this.autoUpperCase?t.toUpperCase():t;t!==this._text&&(this._text=t,this.removeUnsupportedCharacters(this.multiLine),this.buildRetroFontText())}}),Object.defineProperty(U.RetroFont.prototype,"smoothed",{get:function(){return this.stamp.smoothed},set:function(t){this.stamp.smoothed=t,this.buildRetroFontText()}}),U.Rope=function(t,e,i,n,r,o){this.points=[],this.points=o,this._hasUpdateAnimation=!1,this._updateAnimationCallback=null,e=e||0,i=i||0,n=n||null,r=r||null,this.type=U.ROPE,PIXI.Rope.call(this,U.Cache.DEFAULT,this.points),U.Component.Core.init.call(this,t,e,i,n,r)},U.Rope.prototype=Object.create(PIXI.Rope.prototype),U.Rope.prototype.constructor=U.Rope,U.Component.Core.install.call(U.Rope.prototype,["Angle","Animation","AutoCull","Bounds","BringToTop","Crop","Delta","Destroy","FixedToCamera","InWorld","LifeSpan","LoadTexture","Overlap","PhysicsBody","Reset","ScaleMinMax","Smoothed"]),U.Rope.prototype.preUpdatePhysics=U.Component.PhysicsBody.preUpdate,U.Rope.prototype.preUpdateLifeSpan=U.Component.LifeSpan.preUpdate,U.Rope.prototype.preUpdateInWorld=U.Component.InWorld.preUpdate,U.Rope.prototype.preUpdateCore=U.Component.Core.preUpdate,U.Rope.prototype.preUpdate=function(){return!!(this.preUpdatePhysics()&&this.preUpdateLifeSpan()&&this.preUpdateInWorld())&&this.preUpdateCore()},U.Rope.prototype.update=function(){this._hasUpdateAnimation&&this.updateAnimation.call(this)},U.Rope.prototype.reset=function(t,e){return U.Component.Reset.prototype.reset.call(this,t,e),this},Object.defineProperty(U.Rope.prototype,"updateAnimation",{get:function(){return this._updateAnimation},set:function(t){t&&"function"==typeof t?(this._hasUpdateAnimation=!0,this._updateAnimation=t):(this._hasUpdateAnimation=!1,this._updateAnimation=null)}}),Object.defineProperty(U.Rope.prototype,"segments",{get:function(){for(var t,e,i,n,r=[],o=0;o<this.points.length;o++)t=this.vertices[n=4*o]*this.scale.x,e=this.vertices[1+n]*this.scale.y,i=this.vertices[4+n]*this.scale.x,n=this.vertices[3+n]*this.scale.y,i=U.Math.difference(t,i),n=U.Math.difference(e,n),t+=this.world.x,e+=this.world.y,n=new U.Rectangle(t,e,i,n),r.push(n);return r}}),U.TileSprite=function(t,e,i,n,r,o,s){e=e||0,i=i||0,n=n||256,r=r||256,o=o||null,s=s||null,this.type=U.TILESPRITE,this.physicsType=U.SPRITE,this._scroll=new U.Point;var a=t.cache.getImage("__default",!0);PIXI.TilingSprite.call(this,new PIXI.Texture(a.base),n,r),U.Component.Core.init.call(this,t,e,i,o,s)},U.TileSprite.prototype=Object.create(PIXI.TilingSprite.prototype),U.TileSprite.prototype.constructor=U.TileSprite,U.Component.Core.install.call(U.TileSprite.prototype,["Angle","Animation","AutoCull","Bounds","BringToTop","Destroy","FixedToCamera","Health","InCamera","InputEnabled","InWorld","LifeSpan","LoadTexture","Overlap","PhysicsBody","Reset","Smoothed"]),U.TileSprite.prototype.preUpdatePhysics=U.Component.PhysicsBody.preUpdate,U.TileSprite.prototype.preUpdateLifeSpan=U.Component.LifeSpan.preUpdate,U.TileSprite.prototype.preUpdateInWorld=U.Component.InWorld.preUpdate,U.TileSprite.prototype.preUpdateCore=U.Component.Core.preUpdate,U.TileSprite.prototype.preUpdate=function(){return 0!==this._scroll.x&&(this.tilePosition.x+=this._scroll.x*this.game.time.physicsElapsed),0!==this._scroll.y&&(this.tilePosition.y+=this._scroll.y*this.game.time.physicsElapsed),!!(this.preUpdatePhysics()&&this.preUpdateLifeSpan()&&this.preUpdateInWorld())&&this.preUpdateCore()},U.TileSprite.prototype.autoScroll=function(t,e){this._scroll.set(t,e)},U.TileSprite.prototype.stopScroll=function(){this._scroll.set(0,0)},U.TileSprite.prototype.destroy=function(t){U.Component.Destroy.prototype.destroy.call(this,t),PIXI.TilingSprite.prototype.destroy.call(this)},U.TileSprite.prototype.reset=function(t,e){return U.Component.Reset.prototype.reset.call(this,t,e),this.tilePosition.x=0,this.tilePosition.y=0,this},U.Device=function(){this.deviceReadyAt=0,this.initialized=!1,this.desktop=!1,this.iOS=!1,this.iOSVersion=0,this.cocoonJS=!1,this.cocoonJSApp=!1,this.cordova=!1,this.node=!1,this.nodeWebkit=!1,this.electron=!1,this.ejecta=!1,this.crosswalk=!1,this.android=!1,this.chromeOS=!1,this.linux=!1,this.macOS=!1,this.windows=!1,this.windowsPhone=!1,this.canvas=!1,this.canvasBitBltShift=null,this.webGL=!1,this.file=!1,this.fileSystem=!1,this.localStorage=!1,this.worker=!1,this.css3D=!1,this.pointerLock=!1,this.typedArray=!1,this.vibration=!1,this.getUserMedia=!0,this.quirksMode=!1,this.touch=!1,this.mspointer=!1,this.wheelEvent=null,this.arora=!1,this.chrome=!1,this.chromeVersion=0,this.epiphany=!1,this.firefox=!1,this.firefoxVersion=0,this.ie=!1,this.ieVersion=0,this.trident=!1,this.tridentVersion=0,this.edge=!1,this.mobileSafari=!1,this.midori=!1,this.opera=!1,this.safari=!1,this.safariVersion=0,this.webApp=!1,this.silk=!1,this.audioData=!1,this.webAudio=!1,this.ogg=!1,this.opus=!1,this.mp3=!1,this.wav=!1,this.m4a=!1,this.webm=!1,this.dolby=!1,this.oggVideo=!1,this.h264Video=!1,this.mp4Video=!1,this.webmVideo=!1,this.vp9Video=!1,this.hlsVideo=!1,this.iPhone=!1,this.iPhone4=!1,this.iPad=!1,this.pixelRatio=0,this.littleEndian=!1,this.LITTLE_ENDIAN=!1,this.support32bit=!1,this.fullscreen=!1,this.requestFullscreen="",this.cancelFullscreen="",this.fullscreenKeyboard=!1},U.Device=new U.Device,U.Device.onInitialized=new U.Signal,U.Device.whenReady=function(t,e,i){var n=this._readyCheck;this.deviceReadyAt||!n?t.call(e,this):n._monitor||i?(n._queue=n._queue||[],n._queue.push([t,e])):(n._monitor=n.bind(this),n._queue=n._queue||[],n._queue.push([t,e]),t=void 0!==window.cordova,e=navigator.isCocoonJS,"complete"===document.readyState||"interactive"===document.readyState?window.setTimeout(n._monitor,0):t&&!e?document.addEventListener("deviceready",n._monitor,!1):(document.addEventListener("DOMContentLoaded",n._monitor,!1),window.addEventListener("load",n._monitor,!1)))},U.Device._readyCheck=function(){var t=this._readyCheck;if(document.body){if(!this.deviceReadyAt){for(this.deviceReadyAt=Date.now(),document.removeEventListener("deviceready",t._monitor),document.removeEventListener("DOMContentLoaded",t._monitor),window.removeEventListener("load",t._monitor),this._initialize(),this.initialized=!0,this.onInitialized.dispatch(this);i=t._queue.shift();){var e=i[0],i=i[1];e.call(i,this)}this._readyCheck=null,this._initialize=null,this.onInitialized=null}}else window.setTimeout(t._monitor,20)},U.Device._initialize=function(){var t,e,r=this;!function(){var t=navigator.userAgent;/Playstation Vita/.test(t)?r.vita=!0:/Kindle/.test(t)||/\bKF[A-Z][A-Z]+/.test(t)||/Silk.*Mobile Safari/.test(t)?r.kindle=!0:/Android/.test(t)?r.android=!0:/CrOS/.test(t)?r.chromeOS=!0:/iP[ao]d|iPhone/i.test(t)?(r.iOS=!0,navigator.appVersion.match(/OS (\d+)/),r.iOSVersion=parseInt(RegExp.$1,10)):/Linux/.test(t)?r.linux=!0:/Mac OS/.test(t)?r.macOS=!0:/Windows/.test(t)&&(r.windows=!0),(/Windows Phone/i.test(t)||/IEMobile/i.test(t))&&(r.android=!1,r.iOS=!1,r.macOS=!1,r.windows=!0,r.windowsPhone=!0);var e=/Silk/.test(t);(r.windows||r.macOS||r.linux&&!e||r.chromeOS)&&(r.desktop=!0),(r.windowsPhone||/Windows NT/i.test(t)&&/Touch/i.test(t))&&(r.desktop=!1)}(),function(){var t=navigator.userAgent;if(/Arora/.test(t)?r.arora=!0:/Edge\/\d+/.test(t)?r.edge=!0:/Chrome\/(\d+)/.test(t)&&!r.windowsPhone?(r.chrome=!0,r.chromeVersion=parseInt(RegExp.$1,10)):/Epiphany/.test(t)?r.epiphany=!0:/Firefox\D+(\d+)/.test(t)?(r.firefox=!0,r.firefoxVersion=parseInt(RegExp.$1,10)):/AppleWebKit/.test(t)&&r.iOS?r.mobileSafari=!0:/MSIE (\d+\.\d+);/.test(t)?(r.ie=!0,r.ieVersion=parseInt(RegExp.$1,10)):/Midori/.test(t)?r.midori=!0:/Opera/.test(t)?r.opera=!0:/Safari\/(\d+)/.test(t)&&!r.windowsPhone?(r.safari=!0,/Version\/(\d+)\./.test(t)&&(r.safariVersion=parseInt(RegExp.$1,10))):/Trident\/(\d+\.\d+)(.*)rv:(\d+\.\d+)/.test(t)&&(r.ie=!0,r.trident=!0,r.tridentVersion=parseInt(RegExp.$1,10),r.ieVersion=parseInt(RegExp.$3,10)),/Silk/.test(t)&&(r.silk=!0),navigator.standalone&&(r.webApp=!0),void 0!==window.cordova&&(r.cordova=!0),"undefined"!=typeof process&&"undefined"!=typeof require&&(r.node=!0),r.node&&"object"==typeof process.versions&&(r.nodeWebkit=!!process.versions["node-webkit"],r.electron=!!process.versions.electron),navigator.isCocoonJS&&(r.cocoonJS=!0),r.cocoonJS)try{r.cocoonJSApp="undefined"!=typeof CocoonJS}catch(t){r.cocoonJSApp=!1}void 0!==window.ejecta&&(r.ejecta=!0),/Crosswalk/.test(t)&&(r.crosswalk=!0)}(),function(){r.audioData=!!window.Audio,r.webAudio=!(!window.AudioContext&&!window.webkitAudioContext);var t,e,i=document.createElement("audio");try{!!i.canPlayType&&(i.canPlayType('audio/ogg; codecs="vorbis"').replace(/^no$/,"")&&(r.ogg=!0),(i.canPlayType('audio/ogg; codecs="opus"').replace(/^no$/,"")||i.canPlayType("audio/opus;").replace(/^no$/,""))&&(r.opus=!0),i.canPlayType("audio/mpeg;").replace(/^no$/,"")&&(r.mp3=!0),i.canPlayType('audio/wav; codecs="1"').replace(/^no$/,"")&&(r.wav=!0),(i.canPlayType("audio/x-m4a;")||i.canPlayType("audio/aac;").replace(/^no$/,""))&&(r.m4a=!0),i.canPlayType('audio/webm; codecs="vorbis"').replace(/^no$/,"")&&(r.webm=!0),""!==i.canPlayType('audio/mp4;codecs="ec-3"')&&(r.edge?r.dolby=!0:r.safari&&9<=r.safariVersion&&/Mac OS X (\d+)_(\d+)/.test(navigator.userAgent)&&(t=parseInt(RegExp.$1,10),e=parseInt(RegExp.$2,10),(10===t&&11<=e||10<t)&&(r.dolby=!0))))}catch(t){}}(),function(){var t=document.createElement("video");try{!!t.canPlayType&&(t.canPlayType('video/ogg; codecs="theora"').replace(/^no$/,"")&&(r.oggVideo=!0),t.canPlayType('video/mp4; codecs="avc1.42E01E"').replace(/^no$/,"")&&(r.h264Video=!0,r.mp4Video=!0),t.canPlayType('video/webm; codecs="vp8, vorbis"').replace(/^no$/,"")&&(r.webmVideo=!0),t.canPlayType('video/webm; codecs="vp9"').replace(/^no$/,"")&&(r.vp9Video=!0),t.canPlayType('application/x-mpegURL; codecs="avc1.42E01E"').replace(/^no$/,"")&&(r.hlsVideo=!0))}catch(t){}}(),function(){var t,e,i=document.createElement("p"),n={webkitTransform:"-webkit-transform",OTransform:"-o-transform",msTransform:"-ms-transform",MozTransform:"-moz-transform",transform:"transform"};for(e in document.body.insertBefore(i,null),n)void 0!==i.style[e]&&(i.style[e]="translate3d(1px,1px,1px)",t=window.getComputedStyle(i).getPropertyValue(n[e]));document.body.removeChild(i),r.css3D=void 0!==t&&0<t.length&&"none"!==t}(),r.pixelRatio=window.devicePixelRatio||1,r.iPhone=-1!==navigator.userAgent.toLowerCase().indexOf("iphone"),r.iPhone4=2===r.pixelRatio&&r.iPhone,r.iPad=-1!==navigator.userAgent.toLowerCase().indexOf("ipad"),"undefined"!=typeof Int8Array?r.typedArray=!0:r.typedArray=!1,"undefined"!=typeof ArrayBuffer&&"undefined"!=typeof Uint8Array&&"undefined"!=typeof Uint32Array&&(r.littleEndian=(t=new ArrayBuffer(4),e=new Uint8Array(t),t=new Uint32Array(t),e[0]=161,e[1]=178,e[2]=195,e[3]=212,3569595041===t[0]||2712847316!==t[0]&&null),r.LITTLE_ENDIAN=r.littleEndian),r.support32bit="undefined"!=typeof ArrayBuffer&&"undefined"!=typeof Uint8ClampedArray&&"undefined"!=typeof Int32Array&&null!==r.littleEndian&&function(){if(void 0===Uint8ClampedArray)return!1;var t=PIXI.CanvasPool.create(this,1,1).getContext("2d");return!!t&&(t=t.createImageData(1,1),PIXI.CanvasPool.remove(this),t.data instanceof Uint8ClampedArray)}(),navigator.vibrate=navigator.vibrate||navigator.webkitVibrate||navigator.mozVibrate||navigator.msVibrate,navigator.vibrate&&(r.vibration=!0),function(){r.canvas=!!window.CanvasRenderingContext2D||r.cocoonJS;try{r.localStorage=!!localStorage.getItem}catch(t){r.localStorage=!1}r.file=!!(window.File&&window.FileReader&&window.FileList&&window.Blob),r.fileSystem=!!window.requestFileSystem,r.webGL=function(){try{var t=document.createElement("canvas");return t.screencanvas=!1,!!window.WebGLRenderingContext&&(t.getContext("webgl")||t.getContext("experimental-webgl"))}catch(t){return!1}}(),r.webGL=!!r.webGL,r.worker=!!window.Worker,r.pointerLock="pointerLockElement"in document||"mozPointerLockElement"in document||"webkitPointerLockElement"in document,r.quirksMode="CSS1Compat"!==document.compatMode,navigator.getUserMedia=navigator.getUserMedia||navigator.webkitGetUserMedia||navigator.mozGetUserMedia||navigator.msGetUserMedia||navigator.oGetUserMedia,window.URL=window.URL||window.webkitURL||window.mozURL||window.msURL,r.getUserMedia=r.getUserMedia&&!!navigator.getUserMedia&&!!window.URL,r.firefox&&r.firefoxVersion<21&&(r.getUserMedia=!1),!r.iOS&&(r.ie||r.firefox||r.chrome)&&(r.canvasBitBltShift=!0),(r.safari||r.mobileSafari)&&(r.canvasBitBltShift=!1)}(),function(){for(var t=["requestFullscreen","requestFullScreen","webkitRequestFullscreen","webkitRequestFullScreen","msRequestFullscreen","msRequestFullScreen","mozRequestFullScreen","mozRequestFullscreen"],e=document.createElement("div"),i=0;i<t.length;i++)if(e[t[i]]){r.fullscreen=!0,r.requestFullscreen=t[i];break}var n=["cancelFullScreen","exitFullscreen","webkitCancelFullScreen","webkitExitFullscreen","msCancelFullScreen","msExitFullscreen","mozCancelFullScreen","mozExitFullscreen"];if(r.fullscreen)for(i=0;i<n.length;i++)if(document[n[i]]){r.cancelFullscreen=n[i];break}window.Element&&Element.ALLOW_KEYBOARD_INPUT&&(r.fullscreenKeyboard=!0)}(),("ontouchstart"in document.documentElement||window.navigator.maxTouchPoints&&1<=window.navigator.maxTouchPoints)&&(r.touch=!0),(window.navigator.msPointerEnabled||window.navigator.pointerEnabled)&&(r.mspointer=!0),r.cocoonJS||("onwheel"in window||r.ie&&"WheelEvent"in window?r.wheelEvent="wheel":"onmousewheel"in window?r.wheelEvent="mousewheel":r.firefox&&"MouseScrollEvent"in window&&(r.wheelEvent="DOMMouseScroll"))},U.Device.canPlayAudio=function(t){return!("mp3"!==t||!this.mp3)||(!("ogg"!==t||!this.ogg&&!this.opus)||(!("m4a"!==t||!this.m4a)||(!("opus"!==t||!this.opus)||(!("wav"!==t||!this.wav)||(!("webm"!==t||!this.webm)||!("mp4"!==t||!this.dolby))))))},U.Device.canPlayVideo=function(t){return!("webm"!==t||!this.webmVideo&&!this.vp9Video)||(!("mp4"!==t||!this.mp4Video&&!this.h264Video)||(!("ogg"!==t&&"ogv"!==t||!this.oggVideo)||!("mpeg"!==t||!this.hlsVideo)))},U.Device.isConsoleOpen=function(){return!(!window.console||!window.console.firebug)||!(!window.console||(console.clear,!console.profiles))&&0<console.profiles.length},U.Device.isAndroidStockBrowser=function(){var t=window.navigator.userAgent.match(/Android.*AppleWebKit\/([\d.]+)/);return t&&t[1]<537},U.Canvas={create:function(t,e,i,n,r){e=e||256,i=i||256;t=r?document.createElement("canvas"):PIXI.CanvasPool.create(t,e,i);return"string"==typeof n&&""!==n&&(t.id=n),t.width=e,t.height=i,t.style.display="block",t},setBackgroundColor:function(t,e){return t.style.backgroundColor=e=e||"rgb(0,0,0)",t},setTouchAction:function(t,e){return t.style.msTouchAction=e=e||"none",t.style["ms-touch-action"]=e,t.style["touch-action"]=e,t},setUserSelect:function(t,e){return t.style["-webkit-touch-callout"]=e=e||"none",t.style["-webkit-user-select"]=e,t.style["-khtml-user-select"]=e,t.style["-moz-user-select"]=e,t.style["-ms-user-select"]=e,t.style["user-select"]=e,t.style["-webkit-tap-highlight-color"]="rgba(0, 0, 0, 0)",t},addToDOM:function(t,e,i){var n;return void 0===i&&(i=!0),e&&("string"==typeof e?n=document.getElementById(e):"object"==typeof e&&1===e.nodeType&&(n=e)),n=n||document.body,i&&n.style&&(n.style.overflow="hidden"),n.appendChild(t),t},removeFromDOM:function(t){t.parentNode&&t.parentNode.removeChild(t)},setTransform:function(t,e,i,n,r,o,s){return t.setTransform(n,o,s,r,e,i),t},setSmoothingEnabled:function(t,e){var i=U.Canvas.getSmoothingPrefix(t);return i&&(t[i]=e),t},getSmoothingPrefix:function(t){var e,i=["i","webkitI","msI","mozI","oI"];for(e in i){var n=i[e]+"mageSmoothingEnabled";if(n in t)return n}return null},getSmoothingEnabled:function(t){var e=U.Canvas.getSmoothingPrefix(t);if(e)return t[e]},setImageRenderingCrisp:function(t){for(var e=["optimizeSpeed","crisp-edges","-moz-crisp-edges","-webkit-optimize-contrast","optimize-contrast","pixelated"],i=0;i<e.length;i++)t.style["image-rendering"]=e[i];return t.style.msInterpolationMode="nearest-neighbor",t},setImageRenderingBicubic:function(t){return t.style["image-rendering"]="auto",t.style.msInterpolationMode="bicubic",t}},U.RequestAnimationFrame=function(t,e){void 0===e&&(e=!1),this.game=t,this.isRunning=!1,this.forceSetTimeOut=e;for(var i=["ms","moz","webkit","o"],n=0;n<i.length&&!window.requestAnimationFrame;n++)window.requestAnimationFrame=window[i[n]+"RequestAnimationFrame"],window.cancelAnimationFrame=window[i[n]+"CancelAnimationFrame"];this._isSetTimeOut=!1,this._onLoop=null,this._timeOutID=null},U.RequestAnimationFrame.prototype={start:function(){this.isRunning=!0;var e=this;!window.requestAnimationFrame||this.forceSetTimeOut?(this._isSetTimeOut=!0,this._onLoop=function(){return e.updateSetTimeout()},this._timeOutID=window.setTimeout(this._onLoop,0)):(this._isSetTimeOut=!1,this._onLoop=function(t){return e.updateRAF(t)},this._timeOutID=window.requestAnimationFrame(this._onLoop))},updateRAF:function(t){this.isRunning&&(this.game.update(Math.floor(t)),this._timeOutID=window.requestAnimationFrame(this._onLoop))},updateSetTimeout:function(){this.isRunning&&(this.game.update(Date.now()),this._timeOutID=window.setTimeout(this._onLoop,this.game.time.timeToCall))},stop:function(){this._isSetTimeOut?clearTimeout(this._timeOutID):window.cancelAnimationFrame(this._timeOutID),this.isRunning=!1},isSetTimeOut:function(){return this._isSetTimeOut},isRAF:function(){return!1===this._isSetTimeOut}},U.RequestAnimationFrame.prototype.constructor=U.RequestAnimationFrame,U.Math={PI2:2*Math.PI,between:function(t,e){return Math.floor(Math.random()*(e-t+1)+t)},fuzzyEqual:function(t,e,i){return void 0===i&&(i=1e-4),Math.abs(t-e)<i},fuzzyLessThan:function(t,e,i){return t<e+(i=void 0===i?1e-4:i)},fuzzyGreaterThan:function(t,e,i){return e-(i=void 0===i?1e-4:i)<t},fuzzyCeil:function(t,e){return void 0===e&&(e=1e-4),Math.ceil(t-e)},fuzzyFloor:function(t,e){return void 0===e&&(e=1e-4),Math.floor(t+e)},average:function(){for(var t=0,e=arguments.length,i=0;i<e;i++)t+=+arguments[i];return t/e},shear:function(t){return t%1},snapTo:function(t,e,i){return 0===e?t:(t-=i=void 0===i?0:i,i+(t=e*Math.round(t/e)))},snapToFloor:function(t,e,i){return 0===e?t:(t-=i=void 0===i?0:i,i+(t=e*Math.floor(t/e)))},snapToCeil:function(t,e,i){return 0===e?t:(t-=i=void 0===i?0:i,i+(t=e*Math.ceil(t/e)))},roundTo:function(t,e,i){void 0===e&&(e=0),void 0===i&&(i=10);e=Math.pow(i,-e);return Math.round(t*e)/e},floorTo:function(t,e,i){void 0===e&&(e=0),void 0===i&&(i=10);e=Math.pow(i,-e);return Math.floor(t*e)/e},ceilTo:function(t,e,i){void 0===e&&(e=0),void 0===i&&(i=10);e=Math.pow(i,-e);return Math.ceil(t*e)/e},rotateToAngle:function(t,e,i){return void 0===i&&(i=.05),t===e||(Math.abs(e-t)<=i||Math.abs(e-t)>=U.Math.PI2-i?t=e:(Math.abs(e-t)>Math.PI&&(e<t?e+=U.Math.PI2:e-=U.Math.PI2),t<e?t+=i:e<t&&(t-=i))),t},getShortestAngle:function(t,e){t=e-t;return 0==t?0:t-360*Math.floor((t+180)/360)},angleBetween:function(t,e,i,n){return Math.atan2(n-e,i-t)},angleBetweenY:function(t,e,i,n){return Math.atan2(i-t,n-e)},angleBetweenPoints:function(t,e){return Math.atan2(e.y-t.y,e.x-t.x)},angleBetweenPointsY:function(t,e){return Math.atan2(e.x-t.x,e.y-t.y)},reverseAngle:function(t){return this.normalizeAngle(t+Math.PI,!0)},normalizeAngle:function(t){return 0<=(t%=2*Math.PI)?t:t+2*Math.PI},maxAdd:function(t,e,i){return Math.min(t+e,i)},minSub:function(t,e,i){return Math.max(t-e,i)},wrap:function(t,e,i){i-=e;if(i<=0)return 0;t=(t-e)%i;return t<0&&(t+=i),t+e},wrapValue:function(t,e,i){return((t=Math.abs(t))+(e=Math.abs(e)))%(i=Math.abs(i))},isOdd:function(t){return!!(1&t)},isEven:function(t){return!(1&t)},min:function(){for(var t,e=1,i=0,n=(t=1===arguments.length&&"object"==typeof arguments[0]?arguments[0]:arguments).length;e<n;e++)t[e]<t[i]&&(i=e);return t[i]},max:function(){for(var t,e=1,i=0,n=(t=1===arguments.length&&"object"==typeof arguments[0]?arguments[0]:arguments).length;e<n;e++)t[e]>t[i]&&(i=e);return t[i]},minProperty:function(t){for(var e,i=1,n=0,r=(e=2===arguments.length&&"object"==typeof arguments[1]?arguments[1]:arguments.slice(1)).length;i<r;i++)e[i][t]<e[n][t]&&(n=i);return e[n][t]},maxProperty:function(t){for(var e,i=1,n=0,r=(e=2===arguments.length&&"object"==typeof arguments[1]?arguments[1]:arguments.slice(1)).length;i<r;i++)e[i][t]>e[n][t]&&(n=i);return e[n][t]},wrapAngle:function(t,e){return e?this.wrap(t,-Math.PI,Math.PI):this.wrap(t,-180,180)},linearInterpolation:function(t,e){var i=t.length-1,n=i*e,r=Math.floor(n);return e<0?this.linear(t[0],t[1],n):1<e?this.linear(t[i],t[i-1],i-n):this.linear(t[r],t[i<r+1?i:r+1],n-r)},bezierInterpolation:function(t,e){for(var i=0,n=t.length-1,r=0;r<=n;r++)i+=Math.pow(1-e,n-r)*Math.pow(e,r)*t[r]*this.bernstein(n,r);return i},catmullRomInterpolation:function(t,e){var i=t.length-1,n=i*e,r=Math.floor(n);return t[0]===t[i]?(e<0&&(r=Math.floor(n=i*(1+e))),this.catmullRom(t[(r-1+i)%i],t[r],t[(r+1)%i],t[(r+2)%i],n-r)):e<0?t[0]-(this.catmullRom(t[0],t[0],t[1],t[1],-n)-t[0]):1<e?t[i]-(this.catmullRom(t[i],t[i],t[i-1],t[i-1],n-i)-t[i]):this.catmullRom(t[r?r-1:0],t[r],t[i<r+1?i:r+1],t[i<r+2?i:r+2],n-r)},linear:function(t,e,i){return(e-t)*i+t},bernstein:function(t,e){return this.factorial(t)/this.factorial(e)/this.factorial(t-e)},factorial:function(t){if(0===t)return 1;for(var e=t;--t;)e*=t;return e},catmullRom:function(t,e,i,n,r){var o=.5*(i-t),t=.5*(n-e),n=r*r;return(2*e-2*i+o+t)*(r*n)+(-3*e+3*i-2*o-t)*n+o*r+e},difference:function(t,e){return Math.abs(t-e)},roundAwayFromZero:function(t){return 0<t?Math.ceil(t):Math.floor(t)},sinCosGenerator:function(t,e,i,n){for(var r=e=void 0===e?1:e,o=i=void 0===i?1:i,s=(n=void 0===n?1:n)*Math.PI/t,a=[],h=[],l=0;l<t;l++)r+=(o-=r*s)*s,a[l]=o,h[l]=r;return{sin:h,cos:a,length:t}},distance:function(t,e,i,n){i=t-i,n=e-n;return Math.sqrt(i*i+n*n)},distanceSq:function(t,e,i,n){i=t-i,n=e-n;return i*i+n*n},distancePow:function(t,e,i,n,r){return void 0===r&&(r=2),Math.sqrt(Math.pow(i-t,r)+Math.pow(n-e,r))},clamp:function(t,e,i){return t<e?e:i<t?i:t},clampBottom:function(t,e){return t<e?e:t},within:function(t,e,i){return Math.abs(t-e)<=i},mapLinear:function(t,e,i,n,r){return n+(t-e)*(r-n)/(i-e)},smoothstep:function(t,e,i){return(t=Math.max(0,Math.min(1,(t-e)/(i-e))))*t*(3-2*t)},smootherstep:function(t,e,i){return(t=Math.max(0,Math.min(1,(t-e)/(i-e))))*t*t*(t*(6*t-15)+10)},sign:function(t){return t<0?-1:0<t?1:0},percent:function(t,e,i){return void 0===i&&(i=0),e<t||e<i?1:t<i?0:(t-i)/e}};var s=Math.PI/180,a=180/Math.PI;return U.Math.degToRad=function(t){return t*s},U.Math.radToDeg=function(t){return t*a},U.RandomDataGenerator=function(t){void 0===t&&(t=[]),this.c=1,this.s0=0,this.s1=0,this.s2=0,"string"==typeof t?this.state(t):this.sow(t)},U.RandomDataGenerator.prototype={rnd:function(){var t=2091639*this.s0+2.3283064365386963e-10*this.c;return this.c=0|t,this.s0=this.s1,this.s1=this.s2,this.s2=t-this.c,this.s2},sow:function(t){if(this.s0=this.hash(" "),this.s1=this.hash(this.s0),this.s2=this.hash(this.s1),this.c=1,t)for(var e=0;e<t.length&&null!=t[e];e++){var i=t[e];this.s0-=this.hash(i),this.s0+=~~(this.s0<0),this.s1-=this.hash(i),this.s1+=~~(this.s1<0),this.s2-=this.hash(i),this.s2+=~~(this.s2<0)}},hash:function(t){var e,i,n=4022871197;for(t=t.toString(),i=0;i<t.length;i++)e=.02519603282416938*(n+=t.charCodeAt(i)),e-=n=e>>>0,n=(e*=n)>>>0,n+=4294967296*(e-=n);return 2.3283064365386963e-10*(n>>>0)},integer:function(){return 4294967296*this.rnd.apply(this)},frac:function(){return this.rnd.apply(this)+11102230246251565e-32*(2097152*this.rnd.apply(this)|0)},real:function(){return this.integer()+this.frac()},integerInRange:function(t,e){return Math.floor(this.realInRange(0,e-t+1)+t)},between:function(t,e){return this.integerInRange(t,e)},realInRange:function(t,e){return this.frac()*(e-t)+t},normal:function(){return 1-2*this.frac()},uuid:function(){for(var t="",e="",e=t="";t++<36;e+=~t%5|3*t&4?(15^t?8^this.frac()*(20^t?16:4):4).toString(16):"-");return e},pick:function(t){return t[this.integerInRange(0,t.length-1)]},sign:function(){return this.pick([-1,1])},weightedPick:function(t){return t[~~(Math.pow(this.frac(),2)*(t.length-1)+.5)]},timestamp:function(t,e){return this.realInRange(t||9466848e5,e||1577862e6)},angle:function(){return this.integerInRange(-180,180)},state:function(t){return"string"==typeof t&&t.match(/^!rnd/)&&(t=t.split(","),this.c=parseFloat(t[1]),this.s0=parseFloat(t[2]),this.s1=parseFloat(t[3]),this.s2=parseFloat(t[4])),["!rnd",this.c,this.s0,this.s1,this.s2].join(",")}},U.RandomDataGenerator.prototype.constructor=U.RandomDataGenerator,U.QuadTree=function(t,e,i,n,r,o,s){this.maxObjects=10,this.maxLevels=4,this.level=0,this.bounds={},this.objects=[],this.nodes=[],this._empty=[],this.reset(t,e,i,n,r,o,s)},U.QuadTree.prototype={reset:function(t,e,i,n,r,o,s){this.maxObjects=r||10,this.maxLevels=o||4,this.level=s||0,this.bounds={x:Math.round(t),y:Math.round(e),width:i,height:n,subWidth:Math.floor(i/2),subHeight:Math.floor(n/2),right:Math.round(t)+Math.floor(i/2),bottom:Math.round(e)+Math.floor(n/2)},this.objects.length=0,this.nodes.length=0},populate:function(t){t.forEach(this.populateHandler,this,!0)},populateHandler:function(t){t.body&&t.exists&&this.insert(t.body)},split:function(){this.nodes[0]=new U.QuadTree(this.bounds.right,this.bounds.y,this.bounds.subWidth,this.bounds.subHeight,this.maxObjects,this.maxLevels,this.level+1),this.nodes[1]=new U.QuadTree(this.bounds.x,this.bounds.y,this.bounds.subWidth,this.bounds.subHeight,this.maxObjects,this.maxLevels,this.level+1),this.nodes[2]=new U.QuadTree(this.bounds.x,this.bounds.bottom,this.bounds.subWidth,this.bounds.subHeight,this.maxObjects,this.maxLevels,this.level+1),this.nodes[3]=new U.QuadTree(this.bounds.right,this.bounds.bottom,this.bounds.subWidth,this.bounds.subHeight,this.maxObjects,this.maxLevels,this.level+1)},insert:function(t){var e,i=0;if(null==this.nodes[0]||-1===(e=this.getIndex(t))){if(this.objects.push(t),this.objects.length>this.maxObjects&&this.level<this.maxLevels)for(null==this.nodes[0]&&this.split();i<this.objects.length;)-1!==(e=this.getIndex(this.objects[i]))?this.nodes[e].insert(this.objects.splice(i,1)[0]):i++}else this.nodes[e].insert(t)},getIndex:function(t){var e=-1;return t.x<this.bounds.right&&t.right<this.bounds.right?t.y<this.bounds.bottom&&t.bottom<this.bounds.bottom?e=1:t.y>this.bounds.bottom&&(e=2):t.x>this.bounds.right&&(t.y<this.bounds.bottom&&t.bottom<this.bounds.bottom?e=0:t.y>this.bounds.bottom&&(e=3)),e},retrieve:function(t){if(t instanceof U.Rectangle)var e=this.objects,i=this.getIndex(t);else{if(!t.body)return this._empty;e=this.objects,i=this.getIndex(t.body)}return e=this.nodes[0]?-1!==i?e.concat(this.nodes[i].retrieve(t)):(e=(e=(e=e.concat(this.nodes[0].retrieve(t))).concat(this.nodes[1].retrieve(t))).concat(this.nodes[2].retrieve(t))).concat(this.nodes[3].retrieve(t)):e},clear:function(){this.objects.length=0;for(var t=this.nodes.length;t--;)this.nodes[t].clear(),this.nodes.splice(t,1);this.nodes.length=0}},U.QuadTree.prototype.constructor=U.QuadTree,U.Net=function(t){this.game=t},U.Net.prototype={getHostName:function(){return window.location&&window.location.hostname?window.location.hostname:null},checkDomainName:function(t){return-1!==window.location.hostname.indexOf(t)},updateQueryString:function(t,e,i,n){void 0===i&&(i=!1),void 0!==n&&""!==n||(n=window.location.href);var r,o="",s=new RegExp("([?|&])"+t+"=.*?(&|#|$)(.*)","gi");if(o=s.test(n)?null!=e?n.replace(s,"$1"+t+"="+e+"$2$3"):n.replace(s,"$1$3").replace(/(&|\?)$/,""):(null!=e&&(r=-1!==n.indexOf("?")?"&":"?",n=(s=n.split("#"))[0]+r+t+"="+e,s[1]&&(n+="#"+s[1])),n),!i)return o;window.location.href=o},getQueryString:function(t){void 0===t&&(t="");var e,i={},n=location.search.substring(1).split("&");for(e in n){var r=n[e].split("=");if(1<r.length){if(t&&t===this.decodeURI(r[0]))return this.decodeURI(r[1]);i[this.decodeURI(r[0])]=this.decodeURI(r[1])}}return i},decodeURI:function(t){return decodeURIComponent(t.replace(/\+/g," "))}},U.Net.prototype.constructor=U.Net,U.TweenManager=function(t){this.game=t,this.frameBased=!1,this._tweens=[],this._add=[],this.easeMap={Power0:U.Easing.Power0,Power1:U.Easing.Power1,Power2:U.Easing.Power2,Power3:U.Easing.Power3,Power4:U.Easing.Power4,Linear:U.Easing.Linear.None,Quad:U.Easing.Quadratic.Out,Cubic:U.Easing.Cubic.Out,Quart:U.Easing.Quartic.Out,Quint:U.Easing.Quintic.Out,Sine:U.Easing.Sinusoidal.Out,Expo:U.Easing.Exponential.Out,Circ:U.Easing.Circular.Out,Elastic:U.Easing.Elastic.Out,Back:U.Easing.Back.Out,Bounce:U.Easing.Bounce.Out,"Quad.easeIn":U.Easing.Quadratic.In,"Cubic.easeIn":U.Easing.Cubic.In,"Quart.easeIn":U.Easing.Quartic.In,"Quint.easeIn":U.Easing.Quintic.In,"Sine.easeIn":U.Easing.Sinusoidal.In,"Expo.easeIn":U.Easing.Exponential.In,"Circ.easeIn":U.Easing.Circular.In,"Elastic.easeIn":U.Easing.Elastic.In,"Back.easeIn":U.Easing.Back.In,"Bounce.easeIn":U.Easing.Bounce.In,"Quad.easeOut":U.Easing.Quadratic.Out,"Cubic.easeOut":U.Easing.Cubic.Out,"Quart.easeOut":U.Easing.Quartic.Out,"Quint.easeOut":U.Easing.Quintic.Out,"Sine.easeOut":U.Easing.Sinusoidal.Out,"Expo.easeOut":U.Easing.Exponential.Out,"Circ.easeOut":U.Easing.Circular.Out,"Elastic.easeOut":U.Easing.Elastic.Out,"Back.easeOut":U.Easing.Back.Out,"Bounce.easeOut":U.Easing.Bounce.Out,"Quad.easeInOut":U.Easing.Quadratic.InOut,"Cubic.easeInOut":U.Easing.Cubic.InOut,"Quart.easeInOut":U.Easing.Quartic.InOut,"Quint.easeInOut":U.Easing.Quintic.InOut,"Sine.easeInOut":U.Easing.Sinusoidal.InOut,"Expo.easeInOut":U.Easing.Exponential.InOut,"Circ.easeInOut":U.Easing.Circular.InOut,"Elastic.easeInOut":U.Easing.Elastic.InOut,"Back.easeInOut":U.Easing.Back.InOut,"Bounce.easeInOut":U.Easing.Bounce.InOut},this.game.onPause.add(this._pauseAll,this),this.game.onResume.add(this._resumeAll,this)},U.TweenManager.prototype={getAll:function(){return this._tweens},removeAll:function(){for(var t=0;t<this._tweens.length;t++)this._tweens[t].pendingDelete=!0;this._add=[]},removeFrom:function(t,e){if(void 0===e&&(e=!0),Array.isArray(t))for(i=0,n=t.length;i<n;i++)this.removeFrom(t[i]);else if(t.type===U.GROUP&&e)for(var i=0,n=t.children.length;i<n;i++)this.removeFrom(t.children[i]);else{for(i=0,n=this._tweens.length;i<n;i++)t===this._tweens[i].target&&this.remove(this._tweens[i]);for(i=0,n=this._add.length;i<n;i++)t===this._add[i].target&&this.remove(this._add[i])}},add:function(t){(t._manager=this)._add.push(t)},create:function(t){return new U.Tween(t,this.game,this)},remove:function(t){var e=this._tweens.indexOf(t);-1!==e?this._tweens[e].pendingDelete=!0:-1!==(e=this._add.indexOf(t))&&(this._add[e].pendingDelete=!0)},update:function(){var t=this._add.length,e=this._tweens.length;if(0===e&&0===t)return!1;for(var i=0;i<e;)this._tweens[i].update(this.game.time.time)?i++:(this._tweens.splice(i,1),e--);return 0<t&&(this._tweens=this._tweens.concat(this._add),this._add.length=0),!0},isTweening:function(e){return this._tweens.some(function(t){return t.target===e})},_pauseAll:function(){for(var t=this._tweens.length-1;0<=t;t--)this._tweens[t]._pause()},_resumeAll:function(){for(var t=this._tweens.length-1;0<=t;t--)this._tweens[t]._resume()},pauseAll:function(){for(var t=this._tweens.length-1;0<=t;t--)this._tweens[t].pause()},resumeAll:function(){for(var t=this._tweens.length-1;0<=t;t--)this._tweens[t].resume(!0)}},U.TweenManager.prototype.constructor=U.TweenManager,U.Tween=function(t,e,i){this.game=e,this.target=t,this.manager=i,this.timeline=[],this.reverse=!1,this.timeScale=1,this.repeatCounter=0,this.pendingDelete=!1,this.onStart=new U.Signal,this.onLoop=new U.Signal,this.onRepeat=new U.Signal,this.onChildComplete=new U.Signal,this.onComplete=new U.Signal,this.isRunning=!1,this.current=0,this.properties={},this.chainedTween=null,this.isPaused=!1,this.frameBased=i.frameBased,this._onUpdateCallback=null,this._onUpdateCallbackContext=null,this._pausedTime=0,this._codePaused=!1,this._hasStarted=!1},U.Tween.prototype={to:function(t,e,i,n,r,o,s){return(void 0===e||e<=0)&&(e=1e3),void 0===n&&(n=!1),void 0===r&&(r=0),void 0===o&&(o=0),void 0===s&&(s=!1),"string"==typeof(i=null==i?U.Easing.Default:i)&&this.manager.easeMap[i]&&(i=this.manager.easeMap[i]),this.isRunning||(this.timeline.push(new U.TweenData(this).to(t,e,i,r,o,s)),n&&this.start()),this},from:function(t,e,i,n,r,o,s){return void 0===e&&(e=1e3),void 0===n&&(n=!1),void 0===r&&(r=0),void 0===o&&(o=0),void 0===s&&(s=!1),"string"==typeof(i=null==i?U.Easing.Default:i)&&this.manager.easeMap[i]&&(i=this.manager.easeMap[i]),this.isRunning||(this.timeline.push(new U.TweenData(this).from(t,e,i,r,o,s)),n&&this.start()),this},start:function(t){if(void 0===t&&(t=0),null===this.game||null===this.target||0===this.timeline.length||this.isRunning)return this;for(var e=0;e<this.timeline.length;e++)for(var i in this.timeline[e].vEnd)this.properties[i]=this.target[i]||0,Array.isArray(this.properties[i])||(this.properties[i]*=1);for(e=0;e<this.timeline.length;e++)this.timeline[e].loadValues();return this.manager.add(this),this.isRunning=!0,(t<0||t>this.timeline.length-1)&&(t=0),this.current=t,this.timeline[this.current].start(),this},stop:function(t){return void 0===t&&(t=!1),this.isRunning=!1,this._onUpdateCallback=null,this._onUpdateCallbackContext=null,t&&(this.onComplete.dispatch(this.target,this),this._hasStarted=!1,this.chainedTween&&this.chainedTween.start()),this.manager.remove(this),this},updateTweenData:function(t,e,i){if(0===this.timeline.length)return this;if(-1===(i=void 0===i?0:i))for(var n=0;n<this.timeline.length;n++)this.timeline[n][t]=e;else this.timeline[i][t]=e;return this},delay:function(t,e){return this.updateTweenData("delay",t,e)},repeat:function(t,e,i){return void 0===e&&(e=0),this.updateTweenData("repeatCounter",t,i),this.updateTweenData("repeatDelay",e,i)},repeatDelay:function(t,e){return this.updateTweenData("repeatDelay",t,e)},yoyo:function(t,e,i){return void 0===e&&(e=0),this.updateTweenData("yoyo",t,i),this.updateTweenData("yoyoDelay",e,i)},yoyoDelay:function(t,e){return this.updateTweenData("yoyoDelay",t,e)},easing:function(t,e){return"string"==typeof t&&this.manager.easeMap[t]&&(t=this.manager.easeMap[t]),this.updateTweenData("easingFunction",t,e)},interpolation:function(t,e,i){return void 0===e&&(e=U.Math),this.updateTweenData("interpolationFunction",t,i),this.updateTweenData("interpolationContext",e,i)},repeatAll:function(t){return this.repeatCounter=t=void 0===t?0:t,this},chain:function(){for(var t=arguments.length;t--;)0<t?arguments[t-1].chainedTween=arguments[t]:this.chainedTween=arguments[t];return this},loop:function(t){return this.repeatCounter=(t=void 0===t?!0:t)?-1:0,this},onUpdateCallback:function(t,e){return this._onUpdateCallback=t,this._onUpdateCallbackContext=e,this},pause:function(){this.isPaused=!0,this._codePaused=!0,this._pausedTime=this.game.time.time},_pause:function(){this._codePaused||(this.isPaused=!0,this._pausedTime=this.game.time.time)},resume:function(){if(this.isPaused){this.isPaused=!1,this._codePaused=!1;for(var t=0;t<this.timeline.length;t++)this.timeline[t].isRunning||(this.timeline[t].startTime+=this.game.time.time-this._pausedTime)}},_resume:function(){this._codePaused||this.resume()},update:function(t){if(this.pendingDelete||!this.target)return!1;if(this.isPaused)return!0;t=this.timeline[this.current].update(t);if(t===U.TweenData.PENDING)return!0;if(t===U.TweenData.RUNNING)return this._hasStarted||(this.onStart.dispatch(this.target,this),this._hasStarted=!0),null!==this._onUpdateCallback&&this._onUpdateCallback.call(this._onUpdateCallbackContext,this,this.timeline[this.current].value,this.timeline[this.current]),this.isRunning;if(t===U.TweenData.LOOPED)return(-1===this.timeline[this.current].repeatCounter?this.onLoop:this.onRepeat).dispatch(this.target,this),!0;if(t===U.TweenData.COMPLETE){t=!1;return this.reverse?(this.current--,this.current<0&&(this.current=this.timeline.length-1,t=!0)):(this.current++,this.current===this.timeline.length&&(t=!(this.current=0))),t?-1===this.repeatCounter?(this.timeline[this.current].start(),this.onLoop.dispatch(this.target,this),!0):0<this.repeatCounter?(this.repeatCounter--,this.timeline[this.current].start(),this.onRepeat.dispatch(this.target,this),!0):(this.isRunning=!1,this.onComplete.dispatch(this.target,this),this._hasStarted=!1,this.chainedTween&&this.chainedTween.start(),!1):(this.onChildComplete.dispatch(this.target,this),this.timeline[this.current].start(),!0)}},generateData:function(t,e){if(null===this.game||null===this.target)return null;void 0===t&&(t=60),void 0===e&&(e=[]);for(var i=0;i<this.timeline.length;i++)for(var n in this.timeline[i].vEnd)this.properties[n]=this.target[n]||0,Array.isArray(this.properties[n])||(this.properties[n]*=1);for(i=0;i<this.timeline.length;i++)this.timeline[i].loadValues();for(i=0;i<this.timeline.length;i++)e=e.concat(this.timeline[i].generateData(t));return e}},Object.defineProperty(U.Tween.prototype,"totalDuration",{get:function(){for(var t=0,e=0;e<this.timeline.length;e++)t+=this.timeline[e].duration;return t}}),U.Tween.prototype.constructor=U.Tween,U.TweenData=function(t){this.parent=t,this.game=t.game,this.vStart={},this.vStartCache={},this.vEnd={},this.vEndCache={},this.duration=1e3,this.percent=0,this.value=0,this.repeatCounter=0,this.repeatDelay=0,this.repeatTotal=0,this.interpolate=!1,this.yoyo=!1,this.yoyoDelay=0,this.inReverse=!1,this.delay=0,this.dt=0,this.startTime=null,this.easingFunction=U.Easing.Default,this.interpolationFunction=U.Math.linearInterpolation,this.interpolationContext=U.Math,this.isRunning=!1,this.isFrom=!1},U.TweenData.PENDING=0,U.TweenData.RUNNING=1,U.TweenData.LOOPED=2,U.TweenData.COMPLETE=3,U.TweenData.prototype={to:function(t,e,i,n,r,o){return this.vEnd=t,this.duration=e,this.easingFunction=i,this.delay=n,this.repeatTotal=r,this.yoyo=o,this.isFrom=!1,this},from:function(t,e,i,n,r,o){return this.vEnd=t,this.duration=e,this.easingFunction=i,this.delay=n,this.repeatTotal=r,this.yoyo=o,this.isFrom=!0,this},start:function(){if(this.startTime=this.game.time.time+this.delay,this.parent.reverse?this.dt=this.duration:this.dt=0,0<this.delay?this.isRunning=!1:this.isRunning=!0,this.isFrom)for(var t in this.vStartCache)this.vStart[t]=this.vEndCache[t],this.vEnd[t]=this.vStartCache[t],this.parent.target[t]=this.vStart[t];return this.value=0,this.yoyoCounter=0,this.repeatCounter=this.repeatTotal,this},loadValues:function(){for(var t in this.parent.properties){if(this.vStart[t]=this.parent.properties[t],Array.isArray(this.vEnd[t])){if(0===this.vEnd[t].length)continue;0===this.percent&&(this.vEnd[t]=[this.vStart[t]].concat(this.vEnd[t]))}void 0!==this.vEnd[t]?("string"==typeof this.vEnd[t]&&(this.vEnd[t]=this.vStart[t]+parseFloat(this.vEnd[t],10)),this.parent.properties[t]=this.vEnd[t]):this.vEnd[t]=this.vStart[t],this.vStartCache[t]=this.vStart[t],this.vEndCache[t]=this.vEnd[t]}return this},update:function(t){if(this.isRunning){if(t<this.startTime)return U.TweenData.RUNNING}else{if(!(t>=this.startTime))return U.TweenData.PENDING;this.isRunning=!0}var e,t=this.parent.frameBased?this.game.time.physicsElapsedMS:this.game.time.elapsedMS;for(e in this.parent.reverse?(this.dt-=t*this.parent.timeScale,this.dt=Math.max(this.dt,0)):(this.dt+=t*this.parent.timeScale,this.dt=Math.min(this.dt,this.duration)),this.percent=this.dt/this.duration,this.value=this.easingFunction(this.percent),this.vEnd){var i=this.vStart[e],n=this.vEnd[e];Array.isArray(n)?this.parent.target[e]=this.interpolationFunction.call(this.interpolationContext,n,this.value):this.parent.target[e]=i+(n-i)*this.value}return!this.parent.reverse&&1===this.percent||this.parent.reverse&&0===this.percent?this.repeat():U.TweenData.RUNNING},generateData:function(t){this.parent.reverse?this.dt=this.duration:this.dt=0;var e=[],i=!1,n=1/t*1e3;do{this.parent.reverse?(this.dt-=n,this.dt=Math.max(this.dt,0)):(this.dt+=n,this.dt=Math.min(this.dt,this.duration)),this.percent=this.dt/this.duration,this.value=this.easingFunction(this.percent);var r,o={};for(r in this.vEnd){var s=this.vStart[r],a=this.vEnd[r];Array.isArray(a)?o[r]=this.interpolationFunction(a,this.value):o[r]=s+(a-s)*this.value}}while(e.push(o),!(i=!this.parent.reverse&&1===this.percent||this.parent.reverse&&0===this.percent?!0:i));return this.yoyo&&((t=e.slice()).reverse(),e=e.concat(t)),e},repeat:function(){if(this.yoyo){if(this.inReverse&&0===this.repeatCounter){for(var t in this.vStartCache)this.vStart[t]=this.vStartCache[t],this.vEnd[t]=this.vEndCache[t];return this.inReverse=!1,U.TweenData.COMPLETE}this.inReverse=!this.inReverse}else if(0===this.repeatCounter)return U.TweenData.COMPLETE;if(this.inReverse)for(var t in this.vStartCache)this.vStart[t]=this.vEndCache[t],this.vEnd[t]=this.vStartCache[t];else{for(var t in this.vStartCache)this.vStart[t]=this.vStartCache[t],this.vEnd[t]=this.vEndCache[t];0<this.repeatCounter&&this.repeatCounter--}return this.startTime=this.game.time.time,this.yoyo&&this.inReverse?this.startTime+=this.yoyoDelay:this.inReverse||(this.startTime+=this.repeatDelay),this.parent.reverse?this.dt=this.duration:this.dt=0,U.TweenData.LOOPED}},U.TweenData.prototype.constructor=U.TweenData,U.Easing={Linear:{None:function(t){return t}},Quadratic:{In:function(t){return t*t},Out:function(t){return t*(2-t)},InOut:function(t){return(t*=2)<1?.5*t*t:-.5*(--t*(t-2)-1)}},Cubic:{In:function(t){return t*t*t},Out:function(t){return--t*t*t+1},InOut:function(t){return(t*=2)<1?.5*t*t*t:.5*((t-=2)*t*t+2)}},Quartic:{In:function(t){return t*t*t*t},Out:function(t){return 1- --t*t*t*t},InOut:function(t){return(t*=2)<1?.5*t*t*t*t:-.5*((t-=2)*t*t*t-2)}},Quintic:{In:function(t){return t*t*t*t*t},Out:function(t){return--t*t*t*t*t+1},InOut:function(t){return(t*=2)<1?.5*t*t*t*t*t:.5*((t-=2)*t*t*t*t+2)}},Sinusoidal:{In:function(t){return 0===t?0:1===t?1:1-Math.cos(t*Math.PI/2)},Out:function(t){return 0===t?0:1===t?1:Math.sin(t*Math.PI/2)},InOut:function(t){return 0===t?0:1===t?1:.5*(1-Math.cos(Math.PI*t))}},Exponential:{In:function(t){return 0===t?0:Math.pow(1024,t-1)},Out:function(t){return 1===t?1:1-Math.pow(2,-10*t)},InOut:function(t){return 0===t?0:1===t?1:(t*=2)<1?.5*Math.pow(1024,t-1):.5*(2-Math.pow(2,-10*(t-1)))}},Circular:{In:function(t){return 1-Math.sqrt(1-t*t)},Out:function(t){return Math.sqrt(1- --t*t)},InOut:function(t){return(t*=2)<1?-.5*(Math.sqrt(1-t*t)-1):.5*(Math.sqrt(1-(t-=2)*t)+1)}},Elastic:{In:function(t){var e,i=.1;return 0===t?0:1===t?1:(e=!i||i<1?(i=1,.1):.4*Math.asin(1/i)/(2*Math.PI),-(i*Math.pow(2,10*--t)*Math.sin((t-e)*(2*Math.PI)/.4)))},Out:function(t){var e,i=.1;return 0===t?0:1===t?1:(e=!i||i<1?(i=1,.1):.4*Math.asin(1/i)/(2*Math.PI),i*Math.pow(2,-10*t)*Math.sin((t-e)*(2*Math.PI)/.4)+1)},InOut:function(t){var e,i=.1;return 0===t?0:1===t?1:(e=!i||i<1?(i=1,.1):.4*Math.asin(1/i)/(2*Math.PI),(t*=2)<1?i*Math.pow(2,10*--t)*Math.sin((t-e)*(2*Math.PI)/.4)*-.5:i*Math.pow(2,-10*--t)*Math.sin((t-e)*(2*Math.PI)/.4)*.5+1)}},Back:{In:function(t){return t*t*(2.70158*t-1.70158)},Out:function(t){return--t*t*(2.70158*t+1.70158)+1},InOut:function(t){var e=2.5949095;return(t*=2)<1?t*t*((1+e)*t-e)*.5:.5*((t-=2)*t*((1+e)*t+e)+2)}},Bounce:{In:function(t){return 1-U.Easing.Bounce.Out(1-t)},Out:function(t){return t<1/2.75?7.5625*t*t:t<2/2.75?7.5625*(t-=1.5/2.75)*t+.75:t<2.5/2.75?7.5625*(t-=2.25/2.75)*t+.9375:7.5625*(t-=2.625/2.75)*t+.984375},InOut:function(t){return t<.5?.5*U.Easing.Bounce.In(2*t):.5*U.Easing.Bounce.Out(2*t-1)+.5}}},U.Easing.Default=U.Easing.Linear.None,U.Easing.Power0=U.Easing.Linear.None,U.Easing.Power1=U.Easing.Quadratic.Out,U.Easing.Power2=U.Easing.Cubic.Out,U.Easing.Power3=U.Easing.Quartic.Out,U.Easing.Power4=U.Easing.Quintic.Out,U.Time=function(t){this.game=t,this.time=0,this.prevTime=0,this.now=0,this.elapsed=0,this.elapsedMS=0,this.physicsElapsed=1/60,this.physicsElapsedMS=1/60*1e3,this.desiredFpsMult=1/60,this._desiredFps=60,this.suggestedFps=this.desiredFps,this.slowMotion=1,this.advancedTiming=!1,this.frames=0,this.fps=0,this.fpsMin=1e3,this.fpsMax=0,this.msMin=1e3,this.msMax=0,this.pauseDuration=0,this.timeToCall=0,this.timeExpected=0,this.events=new U.Timer(this.game,!1),this._frameCount=0,this._elapsedAccumulator=0,this._started=0,this._timeLastSecond=0,this._pauseStarted=0,this._justResumed=!1,this._timers=[]},U.Time.prototype={boot:function(){this._started=Date.now(),this.time=Date.now(),this.events.start(),this.timeExpected=this.time},add:function(t){return this._timers.push(t),t},create:function(t){t=new U.Timer(this.game,t=void 0===t?!0:t);return this._timers.push(t),t},removeAll:function(){for(var t=0;t<this._timers.length;t++)this._timers[t].destroy();this._timers=[],this.events.removeAll()},refresh:function(){var t=this.time;this.time=Date.now(),this.elapsedMS=this.time-t},update:function(t){var e=this.time;this.time=Date.now(),this.elapsedMS=this.time-e,this.prevTime=this.now,this.now=t,this.elapsed=this.now-this.prevTime,this.game.raf._isSetTimeOut&&(this.timeToCall=Math.floor(Math.max(0,1e3/this._desiredFps-(this.timeExpected-t))),this.timeExpected=t+this.timeToCall),this.advancedTiming&&this.updateAdvancedTiming(),this.game.paused||(this.events.update(this.time),this._timers.length&&this.updateTimers())},updateTimers:function(){for(var t=0,e=this._timers.length;t<e;)this._timers[t].update(this.time)?t++:(this._timers.splice(t,1),e--)},updateAdvancedTiming:function(){this._frameCount++,this._elapsedAccumulator+=this.elapsed,this._frameCount>=2*this._desiredFps&&(this.suggestedFps=5*Math.floor(200/(this._elapsedAccumulator/this._frameCount)),this._frameCount=0,this._elapsedAccumulator=0),this.msMin=Math.min(this.msMin,this.elapsed),this.msMax=Math.max(this.msMax,this.elapsed),this.frames++,this.now>this._timeLastSecond+1e3&&(this.fps=Math.round(1e3*this.frames/(this.now-this._timeLastSecond)),this.fpsMin=Math.min(this.fpsMin,this.fps),this.fpsMax=Math.max(this.fpsMax,this.fps),this._timeLastSecond=this.now,this.frames=0)},gamePaused:function(){this._pauseStarted=Date.now(),this.events.pause();for(var t=this._timers.length;t--;)this._timers[t]._pause()},gameResumed:function(){this.time=Date.now(),this.pauseDuration=this.time-this._pauseStarted,this.events.resume();for(var t=this._timers.length;t--;)this._timers[t]._resume()},totalElapsedSeconds:function(){return.001*(this.time-this._started)},elapsedSince:function(t){return this.time-t},elapsedSecondsSince:function(t){return.001*(this.time-t)},reset:function(){this._started=this.time,this.removeAll()}},Object.defineProperty(U.Time.prototype,"desiredFps",{get:function(){return this._desiredFps},set:function(t){this._desiredFps=t,this.physicsElapsed=1/t,this.physicsElapsedMS=1e3*this.physicsElapsed,this.desiredFpsMult=1/t}}),U.Time.prototype.constructor=U.Time,U.Timer=function(t,e){void 0===e&&(e=!0),this.game=t,this.running=!1,this.autoDestroy=e,this.expired=!1,this.elapsed=0,this.events=[],this.onComplete=new U.Signal,this.nextTick=0,this.timeCap=1e3,this.paused=!1,this._codePaused=!1,this._started=0,this._pauseStarted=0,this._pauseTotal=0,this._now=Date.now(),this._len=0,this._marked=0,this._i=0,this._diff=0,this._newTick=0},U.Timer.MINUTE=6e4,U.Timer.SECOND=1e3,U.Timer.HALF=500,U.Timer.QUARTER=250,U.Timer.prototype={create:function(t,e,i,n,r,o){var s=t=Math.round(t);0===this._now?s+=this.game.time.time:s+=this._now;o=new U.TimerEvent(this,t,s,i,e,n,r,o);return this.events.push(o),this.order(),this.expired=!1,o},add:function(t,e,i){return this.create(t,!1,0,e,i,Array.prototype.slice.call(arguments,3))},repeat:function(t,e,i,n){return this.create(t,!1,e,i,n,Array.prototype.slice.call(arguments,4))},loop:function(t,e,i){return this.create(t,!0,0,e,i,Array.prototype.slice.call(arguments,3))},start:function(t){if(!this.running){this._started=this.game.time.time+(t||0),this.running=!0;for(var e=0;e<this.events.length;e++)this.events[e].tick=this.events[e].delay+this._started}},stop:function(t){this.running=!1,(t=void 0===t?!0:t)&&(this.events.length=0)},remove:function(t){for(var e=0;e<this.events.length;e++)if(this.events[e]===t)return this.events[e].pendingDelete=!0;return!1},order:function(){0<this.events.length&&(this.events.sort(this.sortHandler),this.nextTick=this.events[0].tick)},sortHandler:function(t,e){return t.tick<e.tick?-1:t.tick>e.tick?1:0},clearPendingEvents:function(){for(this._i=this.events.length;this._i--;)this.events[this._i].pendingDelete&&this.events.splice(this._i,1);this._len=this.events.length,this._i=0},update:function(t){if(this.paused)return!0;if(this.elapsed=t-this._now,this._now=t,this.elapsed>this.timeCap&&this.adjustEvents(t-this.elapsed),this._marked=0,this.clearPendingEvents(),this.running&&this._now>=this.nextTick&&0<this._len){for(;this._i<this._len&&this.running&&this._now>=this.events[this._i].tick&&!this.events[this._i].pendingDelete;)this._newTick=this._now+this.events[this._i].delay-(this._now-this.events[this._i].tick),this._newTick<0&&(this._newTick=this._now+this.events[this._i].delay),!0===this.events[this._i].loop?this.events[this._i].tick=this._newTick:0<this.events[this._i].repeatCount?(this.events[this._i].repeatCount--,this.events[this._i].tick=this._newTick):(this._marked++,this.events[this._i].pendingDelete=!0),this.events[this._i].callback.apply(this.events[this._i].callbackContext,this.events[this._i].args),this._i++;this.events.length>this._marked?this.order():(this.expired=!0,this.onComplete.dispatch(this))}return!this.expired||!this.autoDestroy},pause:function(){this.running&&(this._codePaused=!0,this.paused||(this._pauseStarted=this.game.time.time,this.paused=!0))},_pause:function(){!this.paused&&this.running&&(this._pauseStarted=this.game.time.time,this.paused=!0)},adjustEvents:function(t){for(var e,i=0;i<this.events.length;i++)this.events[i].pendingDelete||((e=this.events[i].tick-t)<0&&(e=0),this.events[i].tick=this._now+e);var n=this.nextTick-t;this.nextTick=n<0?this._now:this._now+n},resume:function(){var t;this.paused&&(t=this.game.time.time,this._pauseTotal+=t-this._now,this._now=t,this.adjustEvents(this._pauseStarted),this.paused=!1,this._codePaused=!1)},_resume:function(){this._codePaused||this.resume()},removeAll:function(){this.onComplete.removeAll(),this.events.length=0,this._len=0,this._i=0},destroy:function(){this.onComplete.removeAll(),this.running=!1,this.events=[],this._len=0,this._i=0}},Object.defineProperty(U.Timer.prototype,"next",{get:function(){return this.nextTick}}),Object.defineProperty(U.Timer.prototype,"duration",{get:function(){return this.running&&this.nextTick>this._now?this.nextTick-this._now:0}}),Object.defineProperty(U.Timer.prototype,"length",{get:function(){return this.events.length}}),Object.defineProperty(U.Timer.prototype,"ms",{get:function(){return this.running?this._now-this._started-this._pauseTotal:0}}),Object.defineProperty(U.Timer.prototype,"seconds",{get:function(){return this.running?.001*this.ms:0}}),U.Timer.prototype.constructor=U.Timer,U.TimerEvent=function(t,e,i,n,r,o,s,a){this.timer=t,this.delay=e,this.tick=i,this.repeatCount=n-1,this.loop=r,this.callback=o,this.callbackContext=s,this.args=a,this.pendingDelete=!1},U.TimerEvent.prototype.constructor=U.TimerEvent,U.AnimationManager=function(t){this.sprite=t,this.game=t.game,this.currentFrame=null,this.currentAnim=null,this.updateIfVisible=!0,this.isLoaded=!1,this._frameData=null,this._anims={},this._outputFrames=[]},U.AnimationManager.prototype={loadFrameData:function(t,e){if(void 0===t)return!1;if(this.isLoaded)for(var i in this._anims)this._anims[i].updateFrameData(t);return this._frameData=t,null==e?this.frame=0:"string"==typeof e?this.frameName=e:this.frame=e,this.isLoaded=!0},copyFrameData:function(t,e){if(this._frameData=t.clone(),this.isLoaded)for(var i in this._anims)this._anims[i].updateFrameData(this._frameData);return null==e?this.frame=0:"string"==typeof e?this.frameName=e:this.frame=e,this.isLoaded=!0},add:function(t,e,i,n,r){return e=e||[],i=i||60,void 0===n&&(n=!1),void 0===r&&(r=!(!e||"number"!=typeof e[0])),this._outputFrames=[],this._frameData.getFrameIndexes(e,r,this._outputFrames),this._anims[t]=new U.Animation(this.game,this.sprite,t,this._frameData,this._outputFrames,i,n),this.currentAnim=this._anims[t],this.sprite.tilingTexture&&(this.sprite.refreshTexture=!0),this._anims[t]},validateFrames:function(t,e){void 0===e&&(e=!0);for(var i=0;i<t.length;i++)if(!0===e){if(t[i]>this._frameData.total)return!1}else if(!1===this._frameData.checkFrameName(t[i]))return!1;return!0},play:function(t,e,i,n){if(this._anims[t])return this.currentAnim===this._anims[t]?!1===this.currentAnim.isPlaying?(this.currentAnim.paused=!1,this.currentAnim.play(e,i,n)):this.currentAnim:(this.currentAnim&&this.currentAnim.isPlaying&&this.currentAnim.stop(),this.currentAnim=this._anims[t],this.currentAnim.paused=!1,this.currentFrame=this.currentAnim.currentFrame,this.currentAnim.play(e,i,n))},stop:function(t,e){void 0===e&&(e=!1),!this.currentAnim||"string"==typeof t&&t!==this.currentAnim.name||this.currentAnim.stop(e)},update:function(){return!(this.updateIfVisible&&!this.sprite.visible)&&(!(!this.currentAnim||!this.currentAnim.update())&&(this.currentFrame=this.currentAnim.currentFrame,!0))},next:function(t){this.currentAnim&&(this.currentAnim.next(t),this.currentFrame=this.currentAnim.currentFrame)},previous:function(t){this.currentAnim&&(this.currentAnim.previous(t),this.currentFrame=this.currentAnim.currentFrame)},getAnimation:function(t){return"string"==typeof t&&this._anims[t]?this._anims[t]:null},refreshFrame:function(){},destroy:function(){var t=null;for(t in this._anims)this._anims.hasOwnProperty(t)&&this._anims[t].destroy();this._anims={},this._outputFrames=[],this._frameData=null,this.currentAnim=null,this.currentFrame=null,this.sprite=null,this.game=null}},U.AnimationManager.prototype.constructor=U.AnimationManager,Object.defineProperty(U.AnimationManager.prototype,"frameData",{get:function(){return this._frameData}}),Object.defineProperty(U.AnimationManager.prototype,"frameTotal",{get:function(){return this._frameData.total}}),Object.defineProperty(U.AnimationManager.prototype,"paused",{get:function(){return this.currentAnim.isPaused},set:function(t){this.currentAnim.paused=t}}),Object.defineProperty(U.AnimationManager.prototype,"name",{get:function(){if(this.currentAnim)return this.currentAnim.name}}),Object.defineProperty(U.AnimationManager.prototype,"frame",{get:function(){if(this.currentFrame)return this.currentFrame.index},set:function(t){"number"==typeof t&&this._frameData&&null!==this._frameData.getFrame(t)&&(this.currentFrame=this._frameData.getFrame(t),this.currentFrame&&this.sprite.setFrame(this.currentFrame))}}),Object.defineProperty(U.AnimationManager.prototype,"frameName",{get:function(){if(this.currentFrame)return this.currentFrame.name},set:function(t){"string"==typeof t&&this._frameData&&null!==this._frameData.getFrameByName(t)&&(this.currentFrame=this._frameData.getFrameByName(t),this.currentFrame&&(this._frameIndex=this.currentFrame.index,this.sprite.setFrame(this.currentFrame)))}}),U.Animation=function(t,e,i,n,r,o,s){void 0===s&&(s=!1),this.game=t,this._parent=e,this._frameData=n,this.name=i,this._frames=[],this._frames=this._frames.concat(r),this.delay=1e3/o,this.loop=s,this.loopCount=0,this.killOnComplete=!1,this.isFinished=!1,this.isPlaying=!1,this.isPaused=!1,this._pauseStartTime=0,this._frameIndex=0,this._frameDiff=0,this._frameSkip=1,this.currentFrame=this._frameData.getFrame(this._frames[this._frameIndex]),this.onStart=new U.Signal,this.onUpdate=null,this.onComplete=new U.Signal,this.onLoop=new U.Signal,this.isReversed=!1,this.game.onPause.add(this.onPause,this),this.game.onResume.add(this.onResume,this)},U.Animation.prototype={play:function(t,e,i){return"number"==typeof t&&(this.delay=1e3/t),"boolean"==typeof e&&(this.loop=e),void 0!==i&&(this.killOnComplete=i),this.isPlaying=!0,this.isFinished=!1,this.paused=!1,this.loopCount=0,this._timeLastFrame=this.game.time.time,this._timeNextFrame=this.game.time.time+this.delay,this._frameIndex=this.isReversed?this._frames.length-1:0,this.updateCurrentFrame(!1,!0),this._parent.events.onAnimationStart$dispatch(this._parent,this),this.onStart.dispatch(this._parent,this),(this._parent.animations.currentAnim=this)._parent.animations.currentFrame=this.currentFrame,this},restart:function(){this.isPlaying=!0,this.isFinished=!1,this.paused=!1,this.loopCount=0,this._timeLastFrame=this.game.time.time,this._timeNextFrame=this.game.time.time+this.delay,this._frameIndex=0,this.currentFrame=this._frameData.getFrame(this._frames[this._frameIndex]),this._parent.setFrame(this.currentFrame),(this._parent.animations.currentAnim=this)._parent.animations.currentFrame=this.currentFrame,this.onStart.dispatch(this._parent,this)},reverse:function(){return this.reversed=!this.reversed,this},reverseOnce:function(){return this.onComplete.addOnce(this.reverse,this),this.reverse()},setFrame:function(t,e){var i;if(void 0===e&&(e=!1),"string"==typeof t)for(var n=0;n<this._frames.length;n++)this._frameData.getFrame(this._frames[n]).name===t&&(i=n);else if("number"==typeof t)if(e)i=t;else for(n=0;n<this._frames.length;n++)this._frames[n]===t&&(i=n);i&&(this._frameIndex=i-1,this._timeNextFrame=this.game.time.time,this.update())},stop:function(t,e){void 0===t&&(t=!1),void 0===e&&(e=!1),this.isPlaying=!1,this.isFinished=!0,this.paused=!1,t&&(this.currentFrame=this._frameData.getFrame(this._frames[0]),this._parent.setFrame(this.currentFrame)),e&&(this._parent.events.onAnimationComplete$dispatch(this._parent,this),this.onComplete.dispatch(this._parent,this))},onPause:function(){this.isPlaying&&(this._frameDiff=this._timeNextFrame-this.game.time.time)},onResume:function(){this.isPlaying&&(this._timeNextFrame=this.game.time.time+this._frameDiff)},update:function(){return!this.isPaused&&(!!(this.isPlaying&&this.game.time.time>=this._timeNextFrame)&&(this._frameSkip=1,this._frameDiff=this.game.time.time-this._timeNextFrame,this._timeLastFrame=this.game.time.time,this._frameDiff>this.delay&&(this._frameSkip=Math.floor(this._frameDiff/this.delay),this._frameDiff-=this._frameSkip*this.delay),this._timeNextFrame=this.game.time.time+(this.delay-this._frameDiff),this.isReversed?this._frameIndex-=this._frameSkip:this._frameIndex+=this._frameSkip,!this.isReversed&&this._frameIndex>=this._frames.length||this.isReversed&&this._frameIndex<=-1?this.loop?(this._frameIndex=Math.abs(this._frameIndex)%this._frames.length,this.isReversed&&(this._frameIndex=this._frames.length-1-this._frameIndex),this.currentFrame=this._frameData.getFrame(this._frames[this._frameIndex]),this.currentFrame&&this._parent.setFrame(this.currentFrame),this.loopCount++,this._parent.events.onAnimationLoop$dispatch(this._parent,this),this.onLoop.dispatch(this._parent,this),!this.onUpdate||(this.onUpdate.dispatch(this,this.currentFrame),!!this._frameData)):(this.complete(),!1):this.updateCurrentFrame(!0)))},updateCurrentFrame:function(t,e){if(void 0===e&&(e=!1),!this._frameData)return!1;var i=this.currentFrame.index;return this.currentFrame=this._frameData.getFrame(this._frames[this._frameIndex]),this.currentFrame&&(e||!e&&i!==this.currentFrame.index)&&this._parent.setFrame(this.currentFrame),!this.onUpdate||!t||(this.onUpdate.dispatch(this,this.currentFrame),!!this._frameData)},next:function(t){t=this._frameIndex+(t=void 0===t?1:t);t>=this._frames.length&&(this.loop?t%=this._frames.length:t=this._frames.length-1),t!==this._frameIndex&&(this._frameIndex=t,this.updateCurrentFrame(!0))},previous:function(t){t=this._frameIndex-(t=void 0===t?1:t);t<0&&(this.loop?t=this._frames.length+t:t++),t!==this._frameIndex&&(this._frameIndex=t,this.updateCurrentFrame(!0))},updateFrameData:function(t){this._frameData=t,this.currentFrame=this._frameData?this._frameData.getFrame(this._frames[this._frameIndex%this._frames.length]):null},destroy:function(){this._frameData&&(this.game.onPause.remove(this.onPause,this),this.game.onResume.remove(this.onResume,this),this.game=null,this._parent=null,this._frames=null,this._frameData=null,this.currentFrame=null,this.isPlaying=!1,this.onStart.dispose(),this.onLoop.dispose(),this.onComplete.dispose(),this.onUpdate&&this.onUpdate.dispose())},complete:function(){this._frameIndex=this._frames.length-1,this.currentFrame=this._frameData.getFrame(this._frames[this._frameIndex]),this.isPlaying=!1,this.isFinished=!0,this.paused=!1,this._parent.events.onAnimationComplete$dispatch(this._parent,this),this.onComplete.dispatch(this._parent,this),this.killOnComplete&&this._parent.kill()}},U.Animation.prototype.constructor=U.Animation,Object.defineProperty(U.Animation.prototype,"paused",{get:function(){return this.isPaused},set:function(t){(this.isPaused=t)?this._pauseStartTime=this.game.time.time:this.isPlaying&&(this._timeNextFrame=this.game.time.time+this.delay)}}),Object.defineProperty(U.Animation.prototype,"reversed",{get:function(){return this.isReversed},set:function(t){this.isReversed=t}}),Object.defineProperty(U.Animation.prototype,"frameTotal",{get:function(){return this._frames.length}}),Object.defineProperty(U.Animation.prototype,"frame",{get:function(){return null!==this.currentFrame?this.currentFrame.index:this._frameIndex},set:function(t){this.currentFrame=this._frameData.getFrame(this._frames[t]),null!==this.currentFrame&&(this._frameIndex=t,this._parent.setFrame(this.currentFrame),this.onUpdate&&this.onUpdate.dispatch(this,this.currentFrame))}}),Object.defineProperty(U.Animation.prototype,"speed",{get:function(){return 1e3/this.delay},set:function(t){0<t&&(this.delay=1e3/t)}}),Object.defineProperty(U.Animation.prototype,"enableUpdate",{get:function(){return null!==this.onUpdate},set:function(t){t&&null===this.onUpdate?this.onUpdate=new U.Signal:t||null===this.onUpdate||(this.onUpdate.dispose(),this.onUpdate=null)}}),U.Animation.generateFrameNames=function(t,e,i,n,r){void 0===n&&(n="");var o=[],s="";if(e<i)for(var a=e;a<=i;a++)s="number"==typeof r?U.Utils.pad(a.toString(),r,"0",1):a.toString(),o.push(s=t+s+n);else for(a=e;i<=a;a--)s="number"==typeof r?U.Utils.pad(a.toString(),r,"0",1):a.toString(),o.push(s=t+s+n);return o},U.Frame=function(t,e,i,n,r,o){this.index=t,this.x=e,this.y=i,this.width=n,this.height=r,this.name=o,this.centerX=Math.floor(n/2),this.centerY=Math.floor(r/2),this.distance=U.Math.distance(0,0,n,r),this.rotated=!1,this.rotationDirection="cw",this.trimmed=!1,this.sourceSizeW=n,this.sourceSizeH=r,this.spriteSourceSizeX=0,this.spriteSourceSizeY=0,this.spriteSourceSizeW=0,this.spriteSourceSizeH=0,this.right=this.x+this.width,this.bottom=this.y+this.height},U.Frame.prototype={resize:function(t,e){this.width=t,this.height=e,this.centerX=Math.floor(t/2),this.centerY=Math.floor(e/2),this.distance=U.Math.distance(0,0,t,e),this.sourceSizeW=t,this.sourceSizeH=e,this.right=this.x+t,this.bottom=this.y+e},setTrim:function(t,e,i,n,r,o,s){(this.trimmed=t)&&(this.sourceSizeW=e,this.sourceSizeH=i,this.centerX=Math.floor(e/2),this.centerY=Math.floor(i/2),this.spriteSourceSizeX=n,this.spriteSourceSizeY=r,this.spriteSourceSizeW=o,this.spriteSourceSizeH=s)},clone:function(){var t,e=new U.Frame(this.index,this.x,this.y,this.width,this.height,this.name);for(t in this)this.hasOwnProperty(t)&&(e[t]=this[t]);return e},getRect:function(t){return void 0===t?t=new U.Rectangle(this.x,this.y,this.width,this.height):t.setTo(this.x,this.y,this.width,this.height),t}},U.Frame.prototype.constructor=U.Frame,U.FrameData=function(){this._frames=[],this._frameNames=[]},U.FrameData.prototype={addFrame:function(t){return t.index=this._frames.length,this._frames.push(t),""!==t.name&&(this._frameNames[t.name]=t.index),t},getFrame:function(t){return t>=this._frames.length&&(t=0),this._frames[t]},getFrameByName:function(t){return"number"==typeof this._frameNames[t]?this._frames[this._frameNames[t]]:null},checkFrameName:function(t){return null!=this._frameNames[t]},clone:function(){for(var t,e=new U.FrameData,i=0;i<this._frames.length;i++)e._frames.push(this._frames[i].clone());for(t in this._frameNames)this._frameNames.hasOwnProperty(t)&&e._frameNames.push(this._frameNames[t]);return e},getFrameRange:function(t,e,i){void 0===i&&(i=[]);for(var n=t;n<=e;n++)i.push(this._frames[n]);return i},getFrames:function(t,e,i){if(void 0===e&&(e=!0),void 0===i&&(i=[]),void 0===t||0===t.length)for(var n=0;n<this._frames.length;n++)i.push(this._frames[n]);else for(n=0;n<t.length;n++)e?i.push(this.getFrame(t[n])):i.push(this.getFrameByName(t[n]));return i},getFrameIndexes:function(t,e,i){if(void 0===e&&(e=!0),void 0===i&&(i=[]),void 0===t||0===t.length)for(var n=0;n<this._frames.length;n++)i.push(this._frames[n].index);else for(n=0;n<t.length;n++)e&&this._frames[t[n]]?i.push(this._frames[t[n]].index):this.getFrameByName(t[n])&&i.push(this.getFrameByName(t[n]).index);return i},destroy:function(){this._frames=null,this._frameNames=null}},U.FrameData.prototype.constructor=U.FrameData,Object.defineProperty(U.FrameData.prototype,"total",{get:function(){return this._frames.length}}),U.AnimationParser={spriteSheet:function(t,e,i,n,r,o,s){var a=e;if(null===(a="string"==typeof e?t.cache.getImage(e):a))return null;var h=a.width,t=a.height;i<=0&&(i=Math.floor(-h/Math.min(-1,i))),n<=0&&(n=Math.floor(-t/Math.min(-1,n)));var e=Math.floor((h-o)/(i+s)),a=Math.floor((t-o)/(n+s)),l=-1!==r?r:e*a;if(0===h||0===t||h<i||t<n||0===l)return null;for(var p=new U.FrameData,u=o,d=o,c=0;c<l;c++)p.addFrame(new U.Frame(c,u,d,i,n,"")),h<(u+=i+s)+i&&(u=o,d+=n+s);return p},JSONData:function(t,e){if(e.frames){for(var i,n=new U.FrameData,r=e.frames,o=0;o<r.length;o++)i=n.addFrame(new U.Frame(o,r[o].frame.x,r[o].frame.y,r[o].frame.w,r[o].frame.h,r[o].filename)),r[o].trimmed&&i.setTrim(r[o].trimmed,r[o].sourceSize.w,r[o].sourceSize.h,r[o].spriteSourceSize.x,r[o].spriteSourceSize.y,r[o].spriteSourceSize.w,r[o].spriteSourceSize.h);return n}},JSONDataPyxel:function(t,e){if(["layers","tilewidth","tileheight","tileswide","tileshigh"].forEach(function(t){e[t]}),1===e.layers.length){for(var i=new U.FrameData,n=e.tileheight,r=e.tilewidth,o=e.layers[0].tiles,s=0;s<o.length;s++)i.addFrame(new U.Frame(s,o[s].x,o[s].y,r,n,"frame_"+s)).setTrim(!1);return i}},JSONDataHash:function(t,e){if(e.frames){var i,n,r=new U.FrameData,o=e.frames,s=0;for(n in o)i=r.addFrame(new U.Frame(s,o[n].frame.x,o[n].frame.y,o[n].frame.w,o[n].frame.h,n)),o[n].trimmed&&i.setTrim(o[n].trimmed,o[n].sourceSize.w,o[n].sourceSize.h,o[n].spriteSourceSize.x,o[n].spriteSourceSize.y,o[n].spriteSourceSize.w,o[n].spriteSourceSize.h),s++;return r}},XMLData:function(t,e){if(e.getElementsByTagName("TextureAtlas")){for(var i,n,r,o,s,a,h,l,p,u,d=new U.FrameData,c=e.getElementsByTagName("SubTexture"),y=0;y<c.length;y++)i=(n=c[y].attributes).name.value,r=parseInt(n.x.value,10),o=parseInt(n.y.value,10),s=parseInt(n.width.value,10),a=parseInt(n.height.value,10),l=h=null,n.frameX&&(h=Math.abs(parseInt(n.frameX.value,10)),l=Math.abs(parseInt(n.frameY.value,10)),p=parseInt(n.frameWidth.value,10),u=parseInt(n.frameHeight.value,10)),i=d.addFrame(new U.Frame(y,r,o,s,a,i)),null===h&&null===l||i.setTrim(!0,s,a,h,l,p,u);return d}}},U.Cache=function(t){this.game=t,this.autoResolveURL=!1,this._cache={canvas:{},image:{},texture:{},sound:{},video:{},text:{},json:{},xml:{},physics:{},tilemap:{},binary:{},bitmapData:{},bitmapFont:{},shader:{},renderTexture:{}},this._urlMap={},this._urlResolver=new Image,this._urlTemp=null,this.onSoundUnlock=new U.Signal,this._cacheMap=[],this._cacheMap[U.Cache.CANVAS]=this._cache.canvas,this._cacheMap[U.Cache.IMAGE]=this._cache.image,this._cacheMap[U.Cache.TEXTURE]=this._cache.texture,this._cacheMap[U.Cache.SOUND]=this._cache.sound,this._cacheMap[U.Cache.TEXT]=this._cache.text,this._cacheMap[U.Cache.PHYSICS]=this._cache.physics,this._cacheMap[U.Cache.TILEMAP]=this._cache.tilemap,this._cacheMap[U.Cache.BINARY]=this._cache.binary,this._cacheMap[U.Cache.BITMAPDATA]=this._cache.bitmapData,this._cacheMap[U.Cache.BITMAPFONT]=this._cache.bitmapFont,this._cacheMap[U.Cache.JSON]=this._cache.json,this._cacheMap[U.Cache.XML]=this._cache.xml,this._cacheMap[U.Cache.VIDEO]=this._cache.video,this._cacheMap[U.Cache.SHADER]=this._cache.shader,this._cacheMap[U.Cache.RENDER_TEXTURE]=this._cache.renderTexture,this.addDefaultImage(),this.addMissingImage()},U.Cache.CANVAS=1,U.Cache.IMAGE=2,U.Cache.TEXTURE=3,U.Cache.SOUND=4,U.Cache.TEXT=5,U.Cache.PHYSICS=6,U.Cache.TILEMAP=7,U.Cache.BINARY=8,U.Cache.BITMAPDATA=9,U.Cache.BITMAPFONT=10,U.Cache.JSON=11,U.Cache.XML=12,U.Cache.VIDEO=13,U.Cache.SHADER=14,U.Cache.RENDER_TEXTURE=15,U.Cache.DEFAULT=null,U.Cache.MISSING=null,U.Cache.prototype={addCanvas:function(t,e,i){void 0===i&&(i=e.getContext("2d")),this._cache.canvas[t]={canvas:e,context:i}},addImage:function(t,e,i){this.checkImageKey(t)&&this.removeImage(t);var n={key:t,url:e,data:i,base:new PIXI.BaseTexture(i),frame:new U.Frame(0,0,0,i.width,i.height,t),frameData:new U.FrameData};return n.frameData.addFrame(new U.Frame(0,0,0,i.width,i.height,e)),this._cache.image[t]=n,this._resolveURL(e,n),"__default"===t?U.Cache.DEFAULT=new PIXI.Texture(n.base):"__missing"===t&&(U.Cache.MISSING=new PIXI.Texture(n.base)),n},addDefaultImage:function(){var t=new Image;t.src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgAQMAAABJtOi3AAAAA1BMVEX///+nxBvIAAAAAXRSTlMAQObYZgAAABVJREFUeF7NwIEAAAAAgKD9qdeocAMAoAABm3DkcAAAAABJRU5ErkJggg==";t=this.addImage("__default",null,t);t.base.skipRender=!0,U.Cache.DEFAULT=new PIXI.Texture(t.base)},addMissingImage:function(){var t=new Image;t.src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAIAAAD8GO2jAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAJ9JREFUeNq01ssOwyAMRFG46v//Mt1ESmgh+DFmE2GPOBARKb2NVjo+17PXLD8a1+pl5+A+wSgFygymWYHBb0FtsKhJDdZlncG2IzJ4ayoMDv20wTmSMzClEgbWYNTAkQ0Z+OJ+A/eWnAaR9+oxCF4Os0H8htsMUp+pwcgBBiMNnAwF8GqIgL2hAzaGFFgZauDPKABmowZ4GL369/0rwACp2yA/ttmvsQAAAABJRU5ErkJggg==";t=this.addImage("__missing",null,t);U.Cache.MISSING=new PIXI.Texture(t.base)},addSound:function(t,e,i,n,r){var o=(r=void 0===(r=void 0===n?!(n=!0):r)?!(n=!1):r)?!0:!1;this._cache.sound[t]={url:e,data:i,isDecoding:!1,decoded:o,webAudio:n,audioTag:r,locked:this.game.sound.touchLocked},this._resolveURL(e,this._cache.sound[t])},addText:function(t,e,i){this._cache.text[t]={url:e,data:i},this._resolveURL(e,this._cache.text[t])},addPhysicsData:function(t,e,i,n){this._cache.physics[t]={url:e,data:i,format:n},this._resolveURL(e,this._cache.physics[t])},addTilemap:function(t,e,i,n){this._cache.tilemap[t]={url:e,data:i,format:n},this._resolveURL(e,this._cache.tilemap[t])},addBinary:function(t,e){this._cache.binary[t]=e},addBitmapData:function(t,e,i){return e.key=t,void 0===i&&(i=new U.FrameData).addFrame(e.textureFrame),this._cache.bitmapData[t]={data:e,frameData:i},e},addBitmapFont:function(t,e,i,n,r,o,s){i={url:e,data:i,font:null,base:new PIXI.BaseTexture(i)};void 0===o&&(o=0),void 0===s&&(s=0),i.font="json"===r?U.LoaderParser.jsonBitmapFont(n,i.base,o,s):U.LoaderParser.xmlBitmapFont(n,i.base,o,s),this._cache.bitmapFont[t]=i,this._resolveURL(e,i)},addJSON:function(t,e,i){this._cache.json[t]={url:e,data:i},this._resolveURL(e,this._cache.json[t])},addXML:function(t,e,i){this._cache.xml[t]={url:e,data:i},this._resolveURL(e,this._cache.xml[t])},addVideo:function(t,e,i,n){this._cache.video[t]={url:e,data:i,isBlob:n,locked:!0},this._resolveURL(e,this._cache.video[t])},addShader:function(t,e,i){this._cache.shader[t]={url:e,data:i},this._resolveURL(e,this._cache.shader[t])},addRenderTexture:function(t,e){this._cache.renderTexture[t]={texture:e,frame:new U.Frame(0,0,0,e.width,e.height,"","")}},addSpriteSheet:function(t,e,i,n,r,o,s,a){void 0===o&&(o=-1);a={key:t,url:e,data:i,frameWidth:n,frameHeight:r,margin:s=void 0===s?0:s,spacing:a=void 0===a?0:a,base:new PIXI.BaseTexture(i),frameData:U.AnimationParser.spriteSheet(this.game,i,n,r,o,s,a)};this._cache.image[t]=a,this._resolveURL(e,a)},addTextureAtlas:function(t,e,i,n,r){i={key:t,url:e,data:i,base:new PIXI.BaseTexture(i)};r===U.Loader.TEXTURE_ATLAS_XML_STARLING?i.frameData=U.AnimationParser.XMLData(this.game,n,t):r===U.Loader.TEXTURE_ATLAS_JSON_PYXEL?i.frameData=U.AnimationParser.JSONDataPyxel(this.game,n,t):Array.isArray(n.frames)?i.frameData=U.AnimationParser.JSONData(this.game,n,t):i.frameData=U.AnimationParser.JSONDataHash(this.game,n,t),this._cache.image[t]=i,this._resolveURL(e,i)},reloadSound:function(t){var e=this,i=this.getSound(t);i&&(i.data.src=i.url,i.data.addEventListener("canplaythrough",function(){return e.reloadSoundComplete(t)},!1),i.data.load())},reloadSoundComplete:function(t){var e=this.getSound(t);e&&(e.locked=!1,this.onSoundUnlock.dispatch(t))},updateSound:function(t,e,i){t=this.getSound(t);t&&(t[e]=i)},decodedSound:function(t,e){t=this.getSound(t);t.data=e,t.decoded=!0,t.isDecoding=!1},isSoundDecoded:function(t){t=this.getItem(t,U.Cache.SOUND,"isSoundDecoded");if(t)return t.decoded},isSoundReady:function(t){t=this.getItem(t,U.Cache.SOUND,"isSoundDecoded");if(t)return t.decoded&&!this.game.sound.touchLocked},checkKey:function(t,e){return!!this._cacheMap[t][e]},checkURL:function(t){return!!this._urlMap[this._resolveURL(t)]},checkCanvasKey:function(t){return this.checkKey(U.Cache.CANVAS,t)},checkImageKey:function(t){return this.checkKey(U.Cache.IMAGE,t)},checkTextureKey:function(t){return this.checkKey(U.Cache.TEXTURE,t)},checkSoundKey:function(t){return this.checkKey(U.Cache.SOUND,t)},checkTextKey:function(t){return this.checkKey(U.Cache.TEXT,t)},checkPhysicsKey:function(t){return this.checkKey(U.Cache.PHYSICS,t)},checkTilemapKey:function(t){return this.checkKey(U.Cache.TILEMAP,t)},checkBinaryKey:function(t){return this.checkKey(U.Cache.BINARY,t)},checkBitmapDataKey:function(t){return this.checkKey(U.Cache.BITMAPDATA,t)},checkBitmapFontKey:function(t){return this.checkKey(U.Cache.BITMAPFONT,t)},checkJSONKey:function(t){return this.checkKey(U.Cache.JSON,t)},checkXMLKey:function(t){return this.checkKey(U.Cache.XML,t)},checkVideoKey:function(t){return this.checkKey(U.Cache.VIDEO,t)},checkShaderKey:function(t){return this.checkKey(U.Cache.SHADER,t)},checkRenderTextureKey:function(t){return this.checkKey(U.Cache.RENDER_TEXTURE,t)},getItem:function(t,e,i,n){return this.checkKey(e,t)?void 0===n?this._cacheMap[e][t]:this._cacheMap[e][t][n]:null},getCanvas:function(t){return this.getItem(t,U.Cache.CANVAS,"getCanvas","canvas")},getImage:function(t,e){void 0===e&&(e=!1);t=this.getItem(t=null==t?"__default":t,U.Cache.IMAGE,"getImage");return null===t&&(t=this.getItem("__missing",U.Cache.IMAGE,"getImage")),e?t:t.data},getTextureFrame:function(t){return this.getItem(t,U.Cache.TEXTURE,"getTextureFrame","frame")},getSound:function(t){return this.getItem(t,U.Cache.SOUND,"getSound")},getSoundData:function(t){return this.getItem(t,U.Cache.SOUND,"getSoundData","data")},getText:function(t){return this.getItem(t,U.Cache.TEXT,"getText","data")},getPhysicsData:function(t,e,i){t=this.getItem(t,U.Cache.PHYSICS,"getPhysicsData","data");if(null===t||null==e)return t;if(t[e]){var n,r=t[e];if(!r||!i)return r;for(n in r)if((n=r[n]).fixtureKey===i)return n}return null},getTilemapData:function(t){return this.getItem(t,U.Cache.TILEMAP,"getTilemapData")},getBinary:function(t){return this.getItem(t,U.Cache.BINARY,"getBinary")},getBitmapData:function(t){return this.getItem(t,U.Cache.BITMAPDATA,"getBitmapData","data")},getBitmapFont:function(t){return this.getItem(t,U.Cache.BITMAPFONT,"getBitmapFont")},getJSON:function(t,e){t=this.getItem(t,U.Cache.JSON,"getJSON","data");return t?e?U.Utils.extend(!0,Array.isArray(t)?[]:{},t):t:null},getXML:function(t){return this.getItem(t,U.Cache.XML,"getXML","data")},getVideo:function(t){return this.getItem(t,U.Cache.VIDEO,"getVideo")},getShader:function(t){return this.getItem(t,U.Cache.SHADER,"getShader","data")},getRenderTexture:function(t){return this.getItem(t,U.Cache.RENDER_TEXTURE,"getRenderTexture")},getBaseTexture:function(t,e){return void 0===e&&(e=U.Cache.IMAGE),this.getItem(t,e,"getBaseTexture","base")},getFrame:function(t,e){return void 0===e&&(e=U.Cache.IMAGE),this.getItem(t,e,"getFrame","frame")},getFrameCount:function(t,e){e=this.getFrameData(t,e);return e?e.total:0},getFrameData:function(t,e){return void 0===e&&(e=U.Cache.IMAGE),this.getItem(t,e,"getFrameData","frameData")},hasFrameData:function(t,e){return void 0===e&&(e=U.Cache.IMAGE),null!==this.getItem(t,e,"","frameData")},updateFrameData:function(t,e,i){void 0===i&&(i=U.Cache.IMAGE),this._cacheMap[i][t]&&(this._cacheMap[i][t].frameData=e)},getFrameByIndex:function(t,e,i){i=this.getFrameData(t,i);return i?i.getFrame(e):null},getFrameByName:function(t,e,i){i=this.getFrameData(t,i);return i?i.getFrameByName(e):null},getURL:function(t){return(t=this._resolveURL(t))?this._urlMap[t]:null},getKeys:function(t){void 0===t&&(t=U.Cache.IMAGE);var e=[];if(this._cacheMap[t])for(var i in this._cacheMap[t])"__default"!==i&&"__missing"!==i&&e.push(i);return e},removeCanvas:function(t){delete this._cache.canvas[t]},removeImage:function(t,e){void 0===e&&(e=!0);var i=this.getImage(t,!0);e&&i.base&&i.base.destroy(),delete this._cache.image[t]},removeSound:function(t){delete this._cache.sound[t]},removeText:function(t){delete this._cache.text[t]},removePhysics:function(t){delete this._cache.physics[t]},removeTilemap:function(t){delete this._cache.tilemap[t]},removeBinary:function(t){delete this._cache.binary[t]},removeBitmapData:function(t){delete this._cache.bitmapData[t]},removeBitmapFont:function(t){delete this._cache.bitmapFont[t]},removeJSON:function(t){delete this._cache.json[t]},removeXML:function(t){delete this._cache.xml[t]},removeVideo:function(t){delete this._cache.video[t]},removeShader:function(t){delete this._cache.shader[t]},removeRenderTexture:function(t){delete this._cache.renderTexture[t]},removeSpriteSheet:function(t){delete this._cache.spriteSheet[t]},removeTextureAtlas:function(t){delete this._cache.atlas[t]},clearGLTextures:function(){for(var t in this._cache.image)this._cache.image[t].base._glTextures=[]},_resolveURL:function(t,e){return this.autoResolveURL?(this._urlResolver.src=this.game.load.baseURL+t,this._urlTemp=this._urlResolver.src,this._urlResolver.src="",e&&(this._urlMap[this._urlTemp]=e),this._urlTemp):null},destroy:function(){for(var t=0;t<this._cacheMap.length;t++){var e,i=this._cacheMap[t];for(e in i)"__default"!==e&&"__missing"!==e&&(i[e].destroy&&i[e].destroy(),delete i[e])}this._urlMap=null,this._urlResolver=null,this._urlTemp=null}},U.Cache.prototype.constructor=U.Cache,U.Loader=function(t){this.game=t,this.cache=t.cache,this.resetLocked=!1,this.isLoading=!1,this.hasLoaded=!1,this.preloadSprite=null,this.crossOrigin=!1,this.baseURL="",this.path="",this.headers={requestedWith:!1,json:"application/json",xml:"application/xml"},this.onLoadStart=new U.Signal,this.onLoadComplete=new U.Signal,this.onPackComplete=new U.Signal,this.onFileStart=new U.Signal,this.onFileComplete=new U.Signal,this.onFileError=new U.Signal,this.useXDomainRequest=!1,this._warnedAboutXDomainRequest=!1,this.enableParallel=!0,this.maxParallelDownloads=4,this._withSyncPointDepth=0,this._fileList=[],this._flightQueue=[],this._processingHead=0,this._fileLoadStarted=!1,this._totalPackCount=0,this._totalFileCount=0,this._loadedPackCount=0,this._loadedFileCount=0},U.Loader.TEXTURE_ATLAS_JSON_ARRAY=0,U.Loader.TEXTURE_ATLAS_JSON_HASH=1,U.Loader.TEXTURE_ATLAS_XML_STARLING=2,U.Loader.PHYSICS_LIME_CORONA_JSON=3,U.Loader.PHYSICS_PHASER_JSON=4,U.Loader.TEXTURE_ATLAS_JSON_PYXEL=5,U.Loader.prototype={setPreloadSprite:function(t,e){this.preloadSprite={sprite:t,direction:e=e||0,width:t.width,height:t.height,rect:null},this.preloadSprite.rect=0===e?new U.Rectangle(0,0,1,t.height):new U.Rectangle(0,0,t.width,1),t.crop(this.preloadSprite.rect),t.visible=!0},resize:function(){this.preloadSprite&&this.preloadSprite.height!==this.preloadSprite.sprite.height&&(this.preloadSprite.rect.height=this.preloadSprite.sprite.height)},checkKeyExists:function(t,e){return-1<this.getAssetIndex(t,e)},getAssetIndex:function(t,e){for(var i=-1,n=0;n<this._fileList.length;n++){var r=this._fileList[n];if(r.type===t&&r.key===e&&(i=n,!r.loaded&&!r.loading))break}return i},getAsset:function(t,e){e=this.getAssetIndex(t,e);return-1<e&&{index:e,file:this._fileList[e]}},reset:function(t,e){void 0===e&&(e=!1),this.resetLocked||(t&&(this.preloadSprite=null),this.isLoading=!1,this._processingHead=0,this._fileList.length=0,this._flightQueue.length=0,this._fileLoadStarted=!1,this._totalFileCount=0,this._totalPackCount=0,this._loadedPackCount=0,this._loadedFileCount=0,e&&(this.onLoadStart.removeAll(),this.onLoadComplete.removeAll(),this.onPackComplete.removeAll(),this.onFileStart.removeAll(),this.onFileComplete.removeAll(),this.onFileError.removeAll()))},addToFileList:function(t,e,i,n,r,o){if(void 0===r&&(r=!1),void 0===e||""===e)return this;if(null==i){if(!o)return this;i=e+o}var s={type:t,key:e,path:this.path,url:i,syncPoint:0<this._withSyncPointDepth,data:null,loading:!1,loaded:!1,error:!1};if(n)for(var a in n)s[a]=n[a];e=this.getAssetIndex(t,e);return r&&-1<e?(r=this._fileList[e]).loading||r.loaded?(this._fileList.push(s),this._totalFileCount++):this._fileList[e]=s:-1===e&&(this._fileList.push(s),this._totalFileCount++),this},replaceInFileList:function(t,e,i,n){return this.addToFileList(t,e,i,n,!0)},pack:function(t,e,i,n){if(void 0===i&&(i=null),!(e=void 0===e?null:e)&&!i)return this;var r={type:"packfile",key:t,url:e,path:this.path,syncPoint:!0,data:null,loading:!1,loaded:!1,error:!1,callbackContext:n=void 0===n?null:n};i&&("string"==typeof i&&(i=JSON.parse(i)),r.data=i||{},r.loaded=!0);for(var o=0;o<this._fileList.length+1;o++){var s=this._fileList[o];if(!s||!s.loaded&&!s.loading&&"packfile"!==s.type){this._fileList.splice(o,0,r),this._totalPackCount++;break}}return this},image:function(t,e,i){return this.addToFileList("image",t,e,void 0,i,".png")},images:function(t,e){if(Array.isArray(e))for(var i=0;i<t.length;i++)this.image(t[i],e[i]);else for(i=0;i<t.length;i++)this.image(t[i]);return this},text:function(t,e,i){return this.addToFileList("text",t,e,void 0,i,".txt")},json:function(t,e,i){return this.addToFileList("json",t,e,void 0,i,".json")},shader:function(t,e,i){return this.addToFileList("shader",t,e,void 0,i,".frag")},xml:function(t,e,i){return this.addToFileList("xml",t,e,void 0,i,".xml")},script:function(t,e,i,n){return this.addToFileList("script",t,e,{syncPoint:!0,callback:i=void 0===i?!1:i,callbackContext:n=!1!==i&&void 0===n?this:n},!1,".js")},binary:function(t,e,i,n){return!1!==(i=void 0===i?!1:i)&&void 0===n&&(n=i),this.addToFileList("binary",t,e,{callback:i,callbackContext:n},!1,".bin")},spritesheet:function(t,e,i,n,r,o,s){return this.addToFileList("spritesheet",t,e,{frameWidth:i,frameHeight:n,frameMax:r=void 0===r?-1:r,margin:o=void 0===o?0:o,spacing:s=void 0===s?0:s},!1,".png")},audio:function(t,e,i){return this.game.sound.noAudio?this:this.addToFileList("audio",t,e="string"==typeof e?[e]:e,{buffer:null,autoDecode:i=void 0===i?!0:i})},audioSprite:function(t,e,i,n,r){return this.game.sound.noAudio||(void 0===i&&(i=null),void 0===n&&(n=null),this.audio(t,e,r=void 0===r?!0:r),i?this.json(t+"-audioatlas",i):n&&("string"==typeof n&&(n=JSON.parse(n)),this.cache.addJSON(t+"-audioatlas","",n))),this},audiosprite:function(t,e,i,n,r){return this.audioSprite(t,e,i,n,r)},video:function(t,e,i,n){return void 0===i&&(i=this.game.device.firefox?"loadeddata":"canplaythrough"),this.addToFileList("video",t,e="string"==typeof e?[e]:e,{buffer:null,asBlob:n=void 0===n?!1:n,loadEvent:i})},tilemap:function(t,e,i,n){if(void 0===i&&(i=null),void 0===n&&(n=U.Tilemap.CSV),(e=void 0===e?null:e)||i||(e=n===U.Tilemap.CSV?t+".csv":t+".json"),i){switch(n){case U.Tilemap.CSV:break;case U.Tilemap.TILED_JSON:"string"==typeof i&&(i=JSON.parse(i))}this.cache.addTilemap(t,null,i,n)}else this.addToFileList("tilemap",t,e,{format:n});return this},physics:function(t,e,i,n){return void 0===i&&(i=null),void 0===n&&(n=U.Physics.LIME_CORONA_JSON),(e=void 0===e?null:e)||i||(e=t+".json"),i?("string"==typeof i&&(i=JSON.parse(i)),this.cache.addPhysicsData(t,null,i,n)):this.addToFileList("physics",t,e,{format:n}),this},bitmapFont:function(t,e,i,n,r,o){if(null==e&&(e=t+".png"),void 0===n&&(n=null),void 0===r&&(r=0),void 0===o&&(o=0),i=null===(i=void 0===i?null:i)&&null===n?t+".xml":i)this.addToFileList("bitmapfont",t,e,{atlasURL:i,xSpacing:r,ySpacing:o});else if("string"==typeof n){var s,a;try{s=JSON.parse(n)}catch(t){a=this.parseXml(n)}if(!a&&!s)throw new Error("Phaser.Loader. Invalid Bitmap Font atlas given");this.addToFileList("bitmapfont",t,e,{atlasURL:null,atlasData:s||a,atlasType:s?"json":"xml",xSpacing:r,ySpacing:o})}return this},atlasJSONArray:function(t,e,i,n){return this.atlas(t,e,i,n,U.Loader.TEXTURE_ATLAS_JSON_ARRAY)},atlasJSONHash:function(t,e,i,n){return this.atlas(t,e,i,n,U.Loader.TEXTURE_ATLAS_JSON_HASH)},atlasXML:function(t,e,i,n){return void 0===n&&(n=null),this.atlas(t,e,i=!(i=void 0===i?null:i)&&!n?t+".xml":i,n,U.Loader.TEXTURE_ATLAS_XML_STARLING)},atlas:function(t,e,i,n,r){if(null==e&&(e=t+".png"),void 0===n&&(n=null),void 0===r&&(r=U.Loader.TEXTURE_ATLAS_JSON_ARRAY),i=!(i=void 0===i?null:i)&&!n?r===U.Loader.TEXTURE_ATLAS_XML_STARLING?t+".xml":t+".json":i)this.addToFileList("textureatlas",t,e,{atlasURL:i,format:r});else{switch(r){case U.Loader.TEXTURE_ATLAS_JSON_ARRAY:"string"==typeof n&&(n=JSON.parse(n));break;case U.Loader.TEXTURE_ATLAS_XML_STARLING:if("string"==typeof n){var o=this.parseXml(n);if(!o)throw new Error("Phaser.Loader. Invalid Texture Atlas XML given");n=o}}this.addToFileList("textureatlas",t,e,{atlasURL:null,atlasData:n,format:r})}return this},withSyncPoint:function(t,e){this._withSyncPointDepth++;try{t.call(e||this,this)}finally{this._withSyncPointDepth--}return this},addSyncPoint:function(t,e){e=this.getAsset(t,e);return e&&(e.file.syncPoint=!0),this},removeFile:function(t,e){e=this.getAsset(t,e);e&&(e.loaded||e.loading||this._fileList.splice(e.index,1))},removeAll:function(){this._fileList.length=0,this._flightQueue.length=0},start:function(){this.isLoading||(this.hasLoaded=!1,this.isLoading=!0,this.updateProgress(),this.processLoadQueue())},processLoadQueue:function(){if(this.isLoading){for(var t=0;t<this._flightQueue.length;t++)((e=this._flightQueue[t]).loaded||e.error)&&(this._flightQueue.splice(t,1),t--,e.loading=!1,e.requestUrl=null,e.requestObject=null,e.error&&this.onFileError.dispatch(e.key,e),"packfile"!==e.type?(this._loadedFileCount++,this.onFileComplete.dispatch(this.progress,e.key,!e.error,this._loadedFileCount,this._totalFileCount)):"packfile"===e.type&&e.error&&(this._loadedPackCount++,this.onPackComplete.dispatch(e.key,!e.error,this._loadedPackCount,this._totalPackCount)));for(var e,i,n=!1,r=this.enableParallel?U.Math.clamp(this.maxParallelDownloads,1,12):1,t=this._processingHead;t<this._fileList.length;t++)if("packfile"===(e=this._fileList[t]).type&&!e.error&&e.loaded&&t===this._processingHead&&(this.processPack(e),this._loadedPackCount++,this.onPackComplete.dispatch(e.key,!e.error,this._loadedPackCount,this._totalPackCount)),e.loaded||e.error?t===this._processingHead&&(this._processingHead=t+1):!e.loading&&this._flightQueue.length<r&&("packfile"!==e.type||e.data?n||(this._fileLoadStarted||(this._fileLoadStarted=!0,this.onLoadStart.dispatch()),this._flightQueue.push(e),e.loading=!0,this.onFileStart.dispatch(this.progress,e.key,e.url),this.loadFile(e)):(this._flightQueue.push(e),e.loading=!0,this.loadFile(e))),!e.loaded&&e.syncPoint&&(n=!0),this._flightQueue.length>=r||n&&this._loadedPackCount===this._totalPackCount)break;this.updateProgress(),this._processingHead>=this._fileList.length?this.finishedLoading():this._flightQueue.length||(i=this,setTimeout(function(){i.finishedLoading(!0)},2e3))}else this.finishedLoading(!0)},finishedLoading:function(t){this.hasLoaded||(this.hasLoaded=!0,this.isLoading=!1,t||this._fileLoadStarted||(this._fileLoadStarted=!0,this.onLoadStart.dispatch()),this.onLoadComplete.dispatch(),this.game.state.loadComplete(),this.reset())},asyncComplete:function(t,e){void 0===e&&(e=""),t.loaded=!0,t.error=!!e,e&&(t.errorMessage=e),this.processLoadQueue()},processPack:function(t){var e=t.data[t.key];if(e)for(var i=0;i<e.length;i++){var n=e[i];switch(n.type){case"image":this.image(n.key,n.url,n.overwrite);break;case"text":this.text(n.key,n.url,n.overwrite);break;case"json":this.json(n.key,n.url,n.overwrite);break;case"xml":this.xml(n.key,n.url,n.overwrite);break;case"script":this.script(n.key,n.url,n.callback,t.callbackContext||this);break;case"binary":this.binary(n.key,n.url,n.callback,t.callbackContext||this);break;case"spritesheet":this.spritesheet(n.key,n.url,n.frameWidth,n.frameHeight,n.frameMax,n.margin,n.spacing);break;case"video":this.video(n.key,n.urls);break;case"audio":this.audio(n.key,n.urls,n.autoDecode);break;case"audiosprite":this.audiosprite(n.key,n.urls,n.jsonURL,n.jsonData,n.autoDecode);break;case"tilemap":this.tilemap(n.key,n.url,n.data,U.Tilemap[n.format]);break;case"physics":this.physics(n.key,n.url,n.data,U.Loader[n.format]);break;case"bitmapFont":this.bitmapFont(n.key,n.textureURL,n.atlasURL,n.atlasData,n.xSpacing,n.ySpacing);break;case"atlasJSONArray":this.atlasJSONArray(n.key,n.textureURL,n.atlasURL,n.atlasData);break;case"atlasJSONHash":this.atlasJSONHash(n.key,n.textureURL,n.atlasURL,n.atlasData);break;case"atlasXML":this.atlasXML(n.key,n.textureURL,n.atlasURL,n.atlasData);break;case"atlas":this.atlas(n.key,n.textureURL,n.atlasURL,n.atlasData,U.Loader[n.format]);break;case"shader":this.shader(n.key,n.url,n.overwrite)}}},transformUrl:function(t,e){return!!t&&(t.match(/^(?:blob:|data:|http:\/\/|https:\/\/|\/\/)/)?t:this.baseURL+e.path+t)},loadFile:function(t){switch(t.type){case"packfile":this.xhrLoad(t,this.transformUrl(t.url,t),"text",this.fileComplete);break;case"image":case"spritesheet":case"textureatlas":case"bitmapfont":this.loadImageTag(t);break;case"audio":t.url=this.getAudioURL(t.url),t.url?this.game.sound.usingWebAudio?this.xhrLoad(t,this.transformUrl(t.url,t),"arraybuffer",this.fileComplete):this.game.sound.usingAudioTag&&this.loadAudioTag(t):this.fileError(t,null,"No supported audio URL specified or device does not have audio playback support");break;case"video":t.url=this.getVideoURL(t.url),t.url?t.asBlob?this.xhrLoad(t,this.transformUrl(t.url,t),"blob",this.fileComplete):this.loadVideoTag(t):this.fileError(t,null,"No supported video URL specified or device does not have video playback support");break;case"json":this.xhrLoad(t,this.transformUrl(t.url,t),"text",this.jsonLoadComplete);break;case"xml":this.xhrLoad(t,this.transformUrl(t.url,t),"text",this.xmlLoadComplete);break;case"tilemap":t.format===U.Tilemap.TILED_JSON?this.xhrLoad(t,this.transformUrl(t.url,t),"text",this.jsonLoadComplete):t.format===U.Tilemap.CSV?this.xhrLoad(t,this.transformUrl(t.url,t),"text",this.csvLoadComplete):this.asyncComplete(t,"invalid Tilemap format: "+t.format);break;case"text":case"script":case"shader":case"physics":this.xhrLoad(t,this.transformUrl(t.url,t),"text",this.fileComplete);break;case"binary":this.xhrLoad(t,this.transformUrl(t.url,t),"arraybuffer",this.fileComplete)}},loadImageTag:function(t){var e=this;t.data=new Image,t.data.name=t.key,this.crossOrigin&&(t.data.crossOrigin=this.crossOrigin),t.data.onload=function(){t.data.onload&&(t.data.onload=null,t.data.onerror=null,e.fileComplete(t))},t.data.onerror=function(){t.data.onload&&(t.data.onload=null,t.data.onerror=null,e.fileError(t))},t.data.src=this.transformUrl(t.url,t),t.data.complete&&t.data.width&&t.data.height&&(t.data.onload=null,t.data.onerror=null,this.fileComplete(t))},loadVideoTag:function(t){var e=this;t.data=document.createElement("video"),t.data.name=t.key,t.data.controls=!1,t.data.autoplay=!1;var i=function(){t.data.removeEventListener(t.loadEvent,i,!1),t.data.onerror=null,t.data.canplay=!0,U.GAMES[e.game.id].load.fileComplete(t)};t.data.onerror=function(){t.data.removeEventListener(t.loadEvent,i,!1),t.data.onerror=null,t.data.canplay=!1,e.fileError(t)},t.data.addEventListener(t.loadEvent,i,!1),t.data.src=this.transformUrl(t.url,t),t.data.load()},loadAudioTag:function(t){var e,i=this;this.game.sound.touchLocked?(t.data=new Audio,t.data.name=t.key,t.data.preload="auto",t.data.src=this.transformUrl(t.url,t),this.fileComplete(t)):(t.data=new Audio,t.data.name=t.key,e=function(){t.data.removeEventListener("canplaythrough",e,!1),t.data.onerror=null,i.fileComplete(t)},t.data.onerror=function(){t.data.removeEventListener("canplaythrough",e,!1),t.data.onerror=null,i.fileError(t)},t.data.preload="auto",t.data.src=this.transformUrl(t.url,t),t.data.addEventListener("canplaythrough",e,!1),t.data.load())},xhrLoad:function(e,t,i,n,r){var o,s;this.useXDomainRequest&&window.XDomainRequest?this.xhrLoadWithXDR(e,t,i,n,r):((o=new XMLHttpRequest).open("GET",t,!0),o.responseType=i,!1!==this.headers.requestedWith&&o.setRequestHeader("X-Requested-With",this.headers.requestedWith),this.headers[e.type]&&o.setRequestHeader("Accept",this.headers[e.type]),r=r||this.fileError,s=this,o.onload=function(){try{return(4===o.readyState&&400<=o.status&&o.status<=599?r:n).call(s,e,o)}catch(t){s.hasLoaded?window.console:s.asyncComplete(e,t.message||"Exception")}},o.onerror=function(){try{return r.call(s,e,o)}catch(t){s.hasLoaded?window.console:s.asyncComplete(e,t.message||"Exception")}},e.requestObject=o,e.requestUrl=t,o.send())},xhrLoadWithXDR:function(e,t,i,n,r){this._warnedAboutXDomainRequest||this.game.device.ie&&!(10<=this.game.device.ieVersion)||(this._warnedAboutXDomainRequest=!0);var o=new window.XDomainRequest;o.open("GET",t,!0),o.responseType=i,o.timeout=3e3,r=r||this.fileError;var s=this;o.onerror=function(){try{return r.call(s,e,o)}catch(t){s.asyncComplete(e,t.message||"Exception")}},o.ontimeout=function(){try{return r.call(s,e,o)}catch(t){s.asyncComplete(e,t.message||"Exception")}},o.onprogress=function(){},o.onload=function(){try{return(4===o.readyState&&400<=o.status&&o.status<=599?r:n).call(s,e,o)}catch(t){s.asyncComplete(e,t.message||"Exception")}},e.requestObject=o,e.requestUrl=t,setTimeout(function(){o.send()},0)},getVideoURL:function(t){for(var e=0;e<t.length;e++){var i=t[e];if(i.uri){if(n=i.type,i=i.uri,this.game.device.canPlayVideo(n))return i}else{if(0===i.indexOf("blob:")||0===i.indexOf("data:"))return i;var n=(i=0<=i.indexOf("?")?i.substr(0,i.indexOf("?")):i).substr((Math.max(0,i.lastIndexOf("."))||1/0)+1).toLowerCase();if(this.game.device.canPlayVideo(n))return t[e]}}return null},getAudioURL:function(t){if(this.game.sound.noAudio)return null;for(var e=0;e<t.length;e++){var i=t[e];if(i.uri){if(n=i.type,i=i.uri,this.game.device.canPlayAudio(n))return i}else{if(0===i.indexOf("blob:")||0===i.indexOf("data:"))return i;var n=(i=0<=i.indexOf("?")?i.substr(0,i.indexOf("?")):i).substr((Math.max(0,i.lastIndexOf("."))||1/0)+1).toLowerCase();if(this.game.device.canPlayAudio(n))return t[e]}}return null},fileError:function(t,e,i){var n="error loading asset from URL "+(t.requestUrl||this.transformUrl(t.url,t));!i&&e&&(i=e.status),this.asyncComplete(t,n=i?n+" ("+i+")":n)},fileComplete:function(e,t){var i=!0;switch(e.type){case"packfile":var n=JSON.parse(t.responseText);e.data=n||{};break;case"image":this.cache.addImage(e.key,e.url,e.data);break;case"spritesheet":this.cache.addSpriteSheet(e.key,e.url,e.data,e.frameWidth,e.frameHeight,e.frameMax,e.margin,e.spacing);break;case"textureatlas":if(null==e.atlasURL)this.cache.addTextureAtlas(e.key,e.url,e.data,e.atlasData,e.format);else if(i=!1,e.format===U.Loader.TEXTURE_ATLAS_JSON_ARRAY||e.format===U.Loader.TEXTURE_ATLAS_JSON_HASH||e.format===U.Loader.TEXTURE_ATLAS_JSON_PYXEL)this.xhrLoad(e,this.transformUrl(e.atlasURL,e),"text",this.jsonLoadComplete);else{if(e.format!==U.Loader.TEXTURE_ATLAS_XML_STARLING)throw new Error("Phaser.Loader. Invalid Texture Atlas format: "+e.format);this.xhrLoad(e,this.transformUrl(e.atlasURL,e),"text",this.xmlLoadComplete)}break;case"bitmapfont":e.atlasURL?(i=!1,this.xhrLoad(e,this.transformUrl(e.atlasURL,e),"text",function(t,e){var i;try{i=JSON.parse(e.responseText)}catch(t){}i?(t.atlasType="json",this.jsonLoadComplete(t,e)):(t.atlasType="xml",this.xmlLoadComplete(t,e))})):this.cache.addBitmapFont(e.key,e.url,e.data,e.atlasData,e.atlasType,e.xSpacing,e.ySpacing);break;case"video":if(e.asBlob)try{e.data=t.response}catch(t){throw new Error("Phaser.Loader. Unable to parse video file as Blob: "+e.key)}this.cache.addVideo(e.key,e.url,e.data,e.asBlob);break;case"audio":this.game.sound.usingWebAudio?(e.data=t.response,this.cache.addSound(e.key,e.url,e.data,!0,!1),e.autoDecode&&this.game.sound.decode(e.key)):this.cache.addSound(e.key,e.url,e.data,!1,!0);break;case"text":e.data=t.responseText,this.cache.addText(e.key,e.url,e.data);break;case"shader":e.data=t.responseText,this.cache.addShader(e.key,e.url,e.data);break;case"physics":n=JSON.parse(t.responseText);this.cache.addPhysicsData(e.key,e.url,n,e.format);break;case"script":e.data=document.createElement("script"),e.data.language="javascript",e.data.type="text/javascript",e.data.defer=!1,e.data.text=t.responseText,document.head.appendChild(e.data),e.callback&&(e.data=e.callback.call(e.callbackContext,e.key,t.responseText));break;case"binary":e.callback?e.data=e.callback.call(e.callbackContext,e.key,t.response):e.data=t.response,this.cache.addBinary(e.key,e.data)}i&&this.asyncComplete(e)},jsonLoadComplete:function(t,e){e=JSON.parse(e.responseText);"tilemap"===t.type?this.cache.addTilemap(t.key,t.url,e,t.format):"bitmapfont"===t.type?this.cache.addBitmapFont(t.key,t.url,t.data,e,t.atlasType,t.xSpacing,t.ySpacing):"json"===t.type?this.cache.addJSON(t.key,t.url,e):this.cache.addTextureAtlas(t.key,t.url,t.data,e,t.format),this.asyncComplete(t)},csvLoadComplete:function(t,e){e=e.responseText;this.cache.addTilemap(t.key,t.url,e,t.format),this.asyncComplete(t)},xmlLoadComplete:function(t,e){var i=e.responseText,i=this.parseXml(i);i?("bitmapfont"===t.type?this.cache.addBitmapFont(t.key,t.url,t.data,i,t.atlasType,t.xSpacing,t.ySpacing):"textureatlas"===t.type?this.cache.addTextureAtlas(t.key,t.url,t.data,i,t.format):"xml"===t.type&&this.cache.addXML(t.key,t.url,i),this.asyncComplete(t)):(e.responseType||e.contentType,this.asyncComplete(t,"invalid XML"))},parseXml:function(t){var e;try{window.DOMParser?e=(new DOMParser).parseFromString(t,"text/xml"):((e=new ActiveXObject("Microsoft.XMLDOM")).async="false",e.loadXML(t))}catch(t){e=null}return e&&e.documentElement&&!e.getElementsByTagName("parsererror").length?e:null},updateProgress:function(){this.preloadSprite&&(0===this.preloadSprite.direction?this.preloadSprite.rect.width=Math.floor(this.preloadSprite.width/100*this.progress):this.preloadSprite.rect.height=Math.floor(this.preloadSprite.height/100*this.progress),this.preloadSprite.sprite?this.preloadSprite.sprite.updateCrop():this.preloadSprite=null)},totalLoadedFiles:function(){return this._loadedFileCount},totalQueuedFiles:function(){return this._totalFileCount-this._loadedFileCount},totalLoadedPacks:function(){return this._totalPackCount},totalQueuedPacks:function(){return this._totalPackCount-this._loadedPackCount}},Object.defineProperty(U.Loader.prototype,"progressFloat",{get:function(){var t=this._loadedFileCount/this._totalFileCount*100;return U.Math.clamp(t||0,0,100)}}),Object.defineProperty(U.Loader.prototype,"progress",{get:function(){return Math.round(this.progressFloat)}}),U.Loader.prototype.constructor=U.Loader,U.LoaderParser={bitmapFont:function(t,e,i,n){return this.xmlBitmapFont(t,e,i,n)},xmlBitmapFont:function(t,e,i,n){var r={},o=t.getElementsByTagName("info")[0],s=t.getElementsByTagName("common")[0];r.font=o.getAttribute("face"),r.size=parseInt(o.getAttribute("size"),10),r.lineHeight=parseInt(s.getAttribute("lineHeight"),10)+n,r.chars={};for(var a=t.getElementsByTagName("char"),h=0;h<a.length;h++){var l=parseInt(a[h].getAttribute("id"),10);r.chars[l]={x:parseInt(a[h].getAttribute("x"),10),y:parseInt(a[h].getAttribute("y"),10),width:parseInt(a[h].getAttribute("width"),10),height:parseInt(a[h].getAttribute("height"),10),xOffset:parseInt(a[h].getAttribute("xoffset"),10),yOffset:parseInt(a[h].getAttribute("yoffset"),10),xAdvance:parseInt(a[h].getAttribute("xadvance"),10)+i,kerning:{}}}for(var p=t.getElementsByTagName("kerning"),h=0;h<p.length;h++){var u=parseInt(p[h].getAttribute("first"),10),d=parseInt(p[h].getAttribute("second"),10),c=parseInt(p[h].getAttribute("amount"),10);r.chars[d].kerning[u]=c}return this.finalizeBitmapFont(e,r)},jsonBitmapFont:function(t,e,i,n){var r={font:t.font.info._face,size:parseInt(t.font.info._size,10),lineHeight:parseInt(t.font.common._lineHeight,10)+n,chars:{}};return t.font.chars.char.forEach(function(t){var e=parseInt(t._id,10);r.chars[e]={x:parseInt(t._x,10),y:parseInt(t._y,10),width:parseInt(t._width,10),height:parseInt(t._height,10),xOffset:parseInt(t._xoffset,10),yOffset:parseInt(t._yoffset,10),xAdvance:parseInt(t._xadvance,10)+i,kerning:{}}}),t.font.kernings&&t.font.kernings.kerning&&t.font.kernings.kerning.forEach(function(t){r.chars[t._second].kerning[t._first]=parseInt(t._amount,10)}),this.finalizeBitmapFont(e,r)},finalizeBitmapFont:function(e,i){return Object.keys(i.chars).forEach(function(t){t=i.chars[t];t.texture=new PIXI.Texture(e,new U.Rectangle(t.x,t.y,t.width,t.height))}),i}},U.AudioSprite=function(t,e){for(var i in this.game=t,this.key=e,this.config=this.game.cache.getJSON(e+"-audioatlas"),this.autoplayKey=null,this.autoplay=!1,this.sounds={},this.config.spritemap){var n=this.config.spritemap[i],r=this.game.add.sound(this.key);r.addMarker(i,n.start,n.end-n.start,null,n.loop),this.sounds[i]=r}this.config.autoplay&&(this.autoplayKey=this.config.autoplay,this.play(this.autoplayKey),this.autoplay=this.sounds[this.autoplayKey])},U.AudioSprite.prototype={play:function(t,e){return this.sounds[t].play(t,null,e=void 0===e?1:e)},stop:function(t){if(t)this.sounds[t].stop();else for(var e in this.sounds)this.sounds[e].stop()},get:function(t){return this.sounds[t]}},U.AudioSprite.prototype.constructor=U.AudioSprite,U.Sound=function(t,e,i,n,r){void 0===i&&(i=1),void 0===n&&(n=!1),void 0===r&&(r=t.sound.connectToMaster),this.game=t,this.name=e,this.key=e,this.loop=n,this.markers={},this.context=null,this.autoplay=!1,this.totalDuration=0,this.startTime=0,this.currentTime=0,this.duration=0,this.durationMS=0,this.position=0,this.stopTime=0,this.paused=!1,this.pausedPosition=0,this.pausedTime=0,this.isPlaying=!1,this.currentMarker="",this.fadeTween=null,this.pendingPlayback=!1,this.override=!1,this.allowMultiple=!1,this.usingWebAudio=this.game.sound.usingWebAudio,this.usingAudioTag=this.game.sound.usingAudioTag,this.externalNode=null,this.masterGainNode=null,this.gainNode=null,this._sound=null,this.usingWebAudio?(this.context=this.game.sound.context,this.masterGainNode=this.game.sound.masterGain,void 0===this.context.createGain?this.gainNode=this.context.createGainNode():this.gainNode=this.context.createGain(),this.gainNode.gain.value=i*this.game.sound.volume,r&&this.gainNode.connect(this.masterGainNode)):this.usingAudioTag&&(this.game.cache.getSound(e)&&this.game.cache.isSoundReady(e)?(this._sound=this.game.cache.getSoundData(e),this.totalDuration=0,this._sound.duration&&(this.totalDuration=this._sound.duration)):this.game.cache.onSoundUnlock.add(this.soundHasUnlocked,this)),this.onDecoded=new U.Signal,this.onPlay=new U.Signal,this.onPause=new U.Signal,this.onResume=new U.Signal,this.onLoop=new U.Signal,this.onStop=new U.Signal,this.onMute=new U.Signal,this.onMarkerComplete=new U.Signal,this.onFadeComplete=new U.Signal,this._volume=i,this._buffer=null,this._muted=!1,this._tempMarker=0,this._tempPosition=0,this._tempVolume=0,this._tempPause=0,this._muteVolume=0,this._tempLoop=0,this._paused=!1,this._onDecodedEventDispatched=!1},U.Sound.prototype={soundHasUnlocked:function(t){t===this.key&&(this._sound=this.game.cache.getSoundData(this.key),this.totalDuration=this._sound.duration)},addMarker:function(t,e,i,n,r){this.markers[t]={name:t,start:e,stop:e+(i=null==i?1:i),volume:n=null==n?1:n,duration:i,durationMS:1e3*i,loop:r=void 0===r?!1:r}},removeMarker:function(t){delete this.markers[t]},onEndedHandler:function(){this._sound.onended=null,this.isPlaying=!1,this.currentTime=this.durationMS,this.stop()},update:function(){this.game.cache.checkSoundKey(this.key)?(this.isDecoded&&!this._onDecodedEventDispatched&&(this.onDecoded.dispatch(this),this._onDecodedEventDispatched=!0),this.pendingPlayback&&this.game.cache.isSoundReady(this.key)&&(this.pendingPlayback=!1,this.play(this._tempMarker,this._tempPosition,this._tempVolume,this._tempLoop)),this.isPlaying&&(this.currentTime=this.game.time.time-this.startTime,this.currentTime>=this.durationMS&&(this.usingWebAudio?this.loop?(this.onLoop.dispatch(this),this.isPlaying=!1,""===this.currentMarker?(this.currentTime=0,this.startTime=this.game.time.time,this.isPlaying=!0):(this.onMarkerComplete.dispatch(this.currentMarker,this),this.play(this.currentMarker,0,this.volume,!0,!0))):""!==this.currentMarker&&this.stop():this.loop?(this.onLoop.dispatch(this),""===this.currentMarker&&(this.currentTime=0,this.startTime=this.game.time.time),this.isPlaying=!1,this.play(this.currentMarker,0,this.volume,!0,!0)):this.stop()))):this.destroy()},loopFull:function(t){return this.play(null,0,t,!0)},play:function(t,e,i,n,r){if(void 0!==t&&!1!==t&&null!==t||(t=""),void 0===r&&(r=!0),this.isPlaying&&!this.allowMultiple&&!r&&!this.override)return this;if(this._sound&&this.isPlaying&&!this.allowMultiple&&(this.override||r)){if(this.usingWebAudio){if(void 0===this._sound.stop)this._sound.noteOff(0);else try{this._sound.stop(0)}catch(t){}this.externalNode?this._sound.disconnect(this.externalNode):this.gainNode&&this._sound.disconnect(this.gainNode)}else this.usingAudioTag&&(this._sound.pause(),this._sound.currentTime=0);this.isPlaying=!1}if(""===t&&0<Object.keys(this.markers).length)return this;if(""!==t){if(!this.markers[t])return this;this.currentMarker=t,this.position=this.markers[t].start,this.volume=this.markers[t].volume,this.loop=this.markers[t].loop,this.duration=this.markers[t].duration,this.durationMS=this.markers[t].durationMS,void 0!==i&&(this.volume=i),void 0!==n&&(this.loop=n),this._tempMarker=t,this._tempPosition=this.position,this._tempVolume=this.volume,this._tempLoop=this.loop}else e=e||0,void 0===i&&(i=this._volume),void 0===n&&(n=this.loop),this.position=Math.max(0,e),this.volume=i,this.loop=n,this.duration=0,this.durationMS=0,this._tempMarker=t,this._tempPosition=e,this._tempVolume=i,this._tempLoop=n;return this.usingWebAudio?this.game.cache.isSoundDecoded(this.key)?(this._sound=this.context.createBufferSource(),this.externalNode?this._sound.connect(this.externalNode):this._sound.connect(this.gainNode),this._buffer=this.game.cache.getSoundData(this.key),this._sound.buffer=this._buffer,this.loop&&""===t&&(this._sound.loop=!0),this.loop||""!==t||(this._sound.onended=this.onEndedHandler.bind(this)),this.totalDuration=this._sound.buffer.duration,0===this.duration&&(this.duration=this.totalDuration,this.durationMS=Math.ceil(1e3*this.totalDuration)),void 0===this._sound.start?this._sound.noteGrainOn(0,this.position,this.duration):this.loop&&""===t?this._sound.start(0,0):this._sound.start(0,this.position,this.duration),this.isPlaying=!0,this.startTime=this.game.time.time,this.currentTime=0,this.stopTime=this.startTime+this.durationMS,this.onPlay.dispatch(this)):(this.pendingPlayback=!0,this.game.cache.getSound(this.key)&&!1===this.game.cache.getSound(this.key).isDecoding&&this.game.sound.decode(this.key,this)):this.game.cache.getSound(this.key)&&this.game.cache.getSound(this.key).locked?(this.game.cache.reloadSound(this.key),this.pendingPlayback=!0):this._sound&&(this.game.device.cocoonJS||4===this._sound.readyState)?(this._sound.play(),this.totalDuration=this._sound.duration,0===this.duration&&(this.duration=this.totalDuration,this.durationMS=1e3*this.totalDuration),this._sound.currentTime=this.position,this._sound.muted=this._muted,this._muted||this.game.sound.mute?this._sound.volume=0:this._sound.volume=this._volume,this.isPlaying=!0,this.startTime=this.game.time.time,this.currentTime=0,this.stopTime=this.startTime+this.durationMS,this.onPlay.dispatch(this)):this.pendingPlayback=!0,this},restart:function(t,e,i,n){this.play(t=t||"",e=e||0,i=i||1,n=void 0===n?!1:n,!0)},pause:function(){this.isPlaying&&this._sound&&(this.paused=!0,this.pausedPosition=this.currentTime,this.pausedTime=this.game.time.time,this._tempPause=this._sound.currentTime,this.onPause.dispatch(this),this.stop())},resume:function(){var t,e;this.paused&&this._sound&&(this.usingWebAudio?(t=Math.max(0,this.position+this.pausedPosition/1e3),this._sound=this.context.createBufferSource(),this._sound.buffer=this._buffer,this.externalNode?this._sound.connect(this.externalNode):this._sound.connect(this.gainNode),this.loop&&(this._sound.loop=!0),this.loop||""!==this.currentMarker||(this._sound.onended=this.onEndedHandler.bind(this)),e=this.duration-this.pausedPosition/1e3,void 0===this._sound.start?this._sound.noteGrainOn(0,t,e):this.loop&&this.game.device.chrome?42===this.game.device.chromeVersion?this._sound.start(0):this._sound.start(0,t):this._sound.start(0,t,e)):(this._sound.currentTime=this._tempPause,this._sound.play()),this.isPlaying=!0,this.paused=!1,this.startTime+=this.game.time.time-this.pausedTime,this.onResume.dispatch(this))},stop:function(){if(this.isPlaying&&this._sound)if(this.usingWebAudio){if(void 0===this._sound.stop)this._sound.noteOff(0);else try{this._sound.stop(0)}catch(t){}this.externalNode?this._sound.disconnect(this.externalNode):this.gainNode&&this._sound.disconnect(this.gainNode)}else this.usingAudioTag&&(this._sound.pause(),this._sound.currentTime=0);var t;this.pendingPlayback=!1,this.isPlaying=!1,this.paused||(t=this.currentMarker,""!==this.currentMarker&&this.onMarkerComplete.dispatch(this.currentMarker,this),this.currentMarker="",null!==this.fadeTween&&this.fadeTween.stop(),this.onStop.dispatch(this,t))},fadeIn:function(t,e,i){void 0===e&&(e=!1),void 0===i&&(i=this.currentMarker),this.paused||(this.play(i,0,0,e),this.fadeTo(t,1))},fadeOut:function(t){this.fadeTo(t,0)},fadeTo:function(t,e){this.isPlaying&&!this.paused&&e!==this.volume&&(void 0===t&&(t=1e3),void 0!==e&&(this.fadeTween=this.game.add.tween(this).to({volume:e},t,U.Easing.Linear.None,!0),this.fadeTween.onComplete.add(this.fadeComplete,this)))},fadeComplete:function(){this.onFadeComplete.dispatch(this,this.volume),0===this.volume&&this.stop()},updateGlobalVolume:function(t){this.usingAudioTag&&this._sound&&(this._sound.volume=t*this._volume)},destroy:function(t){void 0===t&&(t=!0),this.stop(),t?this.game.sound.remove(this):(this.markers={},this.context=null,this._buffer=null,this.externalNode=null,this.onDecoded.dispose(),this.onPlay.dispose(),this.onPause.dispose(),this.onResume.dispose(),this.onLoop.dispose(),this.onStop.dispose(),this.onMute.dispose(),this.onMarkerComplete.dispose())}},U.Sound.prototype.constructor=U.Sound,Object.defineProperty(U.Sound.prototype,"isDecoding",{get:function(){return this.game.cache.getSound(this.key).isDecoding}}),Object.defineProperty(U.Sound.prototype,"isDecoded",{get:function(){return this.game.cache.isSoundDecoded(this.key)}}),Object.defineProperty(U.Sound.prototype,"mute",{get:function(){return this._muted||this.game.sound.mute},set:function(t){(t=t||!1)!==this._muted&&(t?(this._muted=!0,this._muteVolume=this._tempVolume,this.usingWebAudio?this.gainNode.gain.value=0:this.usingAudioTag&&this._sound&&(this._sound.volume=0)):(this._muted=!1,this.usingWebAudio?this.gainNode.gain.value=this._muteVolume:this.usingAudioTag&&this._sound&&(this._sound.volume=this._muteVolume)),this.onMute.dispatch(this))}}),Object.defineProperty(U.Sound.prototype,"volume",{get:function(){return this._volume},set:function(t){this.game.device.firefox&&this.usingAudioTag&&(t=this.game.math.clamp(t,0,1)),this._muted?this._muteVolume=t:(this._tempVolume=t,this._volume=t,this.usingWebAudio?this.gainNode.gain.value=t:this.usingAudioTag&&this._sound&&(this._sound.volume=t))}}),U.SoundManager=function(t){this.game=t,this.onSoundDecode=new U.Signal,this.onVolumeChange=new U.Signal,this.onMute=new U.Signal,this.onUnMute=new U.Signal,this.context=null,this.usingWebAudio=!1,this.usingAudioTag=!1,this.noAudio=!1,this.connectToMaster=!0,this.touchLocked=!1,this.channels=32,this.muteOnPause=!0,this._codeMuted=!1,this._muted=!1,this._unlockSource=null,this._volume=1,this._sounds=[],this._watchList=new U.ArraySet,this._watching=!1,this._watchCallback=null,this._watchContext=null},U.SoundManager.prototype={boot:function(){if(this.game.device.iOS&&!1===this.game.device.webAudio&&(this.channels=1),window.PhaserGlobal){if(!0===window.PhaserGlobal.disableAudio)return this.noAudio=!0,void(this.touchLocked=!1);if(!0===window.PhaserGlobal.disableWebAudio)return this.usingAudioTag=!0,void(this.touchLocked=!1)}if(window.PhaserGlobal&&window.PhaserGlobal.audioContext)this.context=window.PhaserGlobal.audioContext;else if(window.AudioContext)try{this.context=new window.AudioContext}catch(t){this.context=null,this.usingWebAudio=!1,this.touchLocked=!1}else if(window.webkitAudioContext)try{this.context=new window.webkitAudioContext}catch(t){this.context=null,this.usingWebAudio=!1,this.touchLocked=!1}if(null===this.context){if(void 0===window.Audio)return void(this.noAudio=!0);this.usingAudioTag=!0}else this.usingWebAudio=!0,void 0===this.context.createGain?this.masterGain=this.context.createGainNode():this.masterGain=this.context.createGain(),this.masterGain.gain.value=1,this.masterGain.connect(this.context.destination);this.noAudio||(!this.game.device.cocoonJS&&this.game.device.iOS||window.PhaserGlobal&&window.PhaserGlobal.fakeiOSTouchLock)&&this.setTouchLock()},setTouchLock:function(){this.noAudio||window.PhaserGlobal&&!0===window.PhaserGlobal.disableAudio||(8<this.game.device.iOSVersion?this.game.input.touch.addTouchLockCallback(this.unlock,this,!0):this.game.input.touch.addTouchLockCallback(this.unlock,this),this.touchLocked=!0)},unlock:function(){return this.noAudio||!this.touchLocked||null!==this._unlockSource||(this.usingAudioTag?(this.touchLocked=!1,this._unlockSource=null):this.usingWebAudio&&(t=this.context.createBuffer(1,1,22050),this._unlockSource=this.context.createBufferSource(),this._unlockSource.buffer=t,this._unlockSource.connect(this.context.destination),void 0===this._unlockSource.start?this._unlockSource.noteOn(0):this._unlockSource.start(0))),!0;var t},stopAll:function(){if(!this.noAudio)for(var t=0;t<this._sounds.length;t++)this._sounds[t]&&this._sounds[t].stop()},pauseAll:function(){if(!this.noAudio)for(var t=0;t<this._sounds.length;t++)this._sounds[t]&&this._sounds[t].pause()},resumeAll:function(){if(!this.noAudio)for(var t=0;t<this._sounds.length;t++)this._sounds[t]&&this._sounds[t].resume()},decode:function(e,i){i=i||null;var t=this.game.cache.getSoundData(e);if(t&&!1===this.game.cache.isSoundDecoded(e)){this.game.cache.updateSound(e,"isDecoding",!0);var n=this;try{this.context.decodeAudioData(t,function(t){t&&(n.game.cache.decodedSound(e,t),n.onSoundDecode.dispatch(e,i))})}catch(t){}}},setDecodedCallback:function(t,e,i){"string"==typeof t&&(t=[t]),this._watchList.reset();for(var n=0;n<t.length;n++)t[n]instanceof U.Sound?this.game.cache.isSoundDecoded(t[n].key)||this._watchList.add(t[n].key):this.game.cache.isSoundDecoded(t[n])||this._watchList.add(t[n]);0===this._watchList.total?(this._watching=!1,e.call(i)):(this._watching=!0,this._watchCallback=e,this._watchContext=i)},update:function(){if(!this.noAudio){!this.touchLocked||null===this._unlockSource||this._unlockSource.playbackState!==this._unlockSource.PLAYING_STATE&&this._unlockSource.playbackState!==this._unlockSource.FINISHED_STATE||(this.touchLocked=!1,this._unlockSource=null);for(var t=0;t<this._sounds.length;t++)this._sounds[t].update();if(this._watching){for(var e=this._watchList.first;e;)this.game.cache.isSoundDecoded(e)&&this._watchList.remove(e),e=this._watchList.next;0===this._watchList.total&&(this._watching=!1,this._watchCallback.call(this._watchContext))}}},add:function(t,e,i,n){void 0===n&&(n=this.connectToMaster);n=new U.Sound(this.game,t,e=void 0===e?1:e,i=void 0===i?!1:i,n);return this._sounds.push(n),n},addSprite:function(t){return new U.AudioSprite(this.game,t)},remove:function(t){for(var e=this._sounds.length;e--;)if(this._sounds[e]===t)return this._sounds[e].destroy(!1),this._sounds.splice(e,1),!0;return!1},removeByKey:function(t){for(var e=this._sounds.length,i=0;e--;)this._sounds[e].key===t&&(this._sounds[e].destroy(!1),this._sounds.splice(e,1),i++);return i},play:function(t,e,i){if(!this.noAudio){i=this.add(t,e,i);return i.play(),i}},setMute:function(){if(!this._muted){this._muted=!0,this.usingWebAudio&&(this._muteVolume=this.masterGain.gain.value,this.masterGain.gain.value=0);for(var t=0;t<this._sounds.length;t++)this._sounds[t].usingAudioTag&&(this._sounds[t].mute=!0);this.onMute.dispatch()}},unsetMute:function(){if(this._muted&&!this._codeMuted){this._muted=!1,this.usingWebAudio&&(this.masterGain.gain.value=this._muteVolume);for(var t=0;t<this._sounds.length;t++)this._sounds[t].usingAudioTag&&(this._sounds[t].mute=!1);this.onUnMute.dispatch()}},destroy:function(){this.stopAll();for(var t=0;t<this._sounds.length;t++)this._sounds[t]&&this._sounds[t].destroy();this._sounds=[],this.onSoundDecode.dispose(),this.context&&(window.PhaserGlobal?window.PhaserGlobal.audioContext=this.context:this.context.close&&this.context.close())}},U.SoundManager.prototype.constructor=U.SoundManager,Object.defineProperty(U.SoundManager.prototype,"mute",{get:function(){return this._muted},set:function(t){(t=t||!1)?this._muted||(this._codeMuted=!0,this.setMute()):this._muted&&(this._codeMuted=!1,this.unsetMute())}}),Object.defineProperty(U.SoundManager.prototype,"volume",{get:function(){return this._volume},set:function(t){if(t<0?t=0:1<t&&(t=1),this._volume!==t){if(this._volume=t,this.usingWebAudio)this.masterGain.gain.value=t;else for(var e=0;e<this._sounds.length;e++)this._sounds[e].usingAudioTag&&this._sounds[e].updateGlobalVolume(t);this.onVolumeChange.dispatch(t)}}}),U.ScaleManager=function(t,e,i){this.game=t,this.dom=U.DOM,this.grid=null,this.width=0,this.height=0,this.minWidth=null,this.maxWidth=null,this.minHeight=null,this.maxHeight=null,this.offset=new U.Point,this.forceLandscape=!1,this.forcePortrait=!1,this.incorrectOrientation=!1,this._pageAlignHorizontally=!1,this._pageAlignVertically=!1,this.onOrientationChange=new U.Signal,this.enterIncorrectOrientation=new U.Signal,this.leaveIncorrectOrientation=new U.Signal,this.hasPhaserSetFullScreen=!1,this.fullScreenTarget=null,this._createdFullScreenTarget=null,this.onFullScreenInit=new U.Signal,this.onFullScreenChange=new U.Signal,this.onFullScreenError=new U.Signal,this.screenOrientation=this.dom.getScreenOrientation(),this.scaleFactor=new U.Point(1,1),this.scaleFactorInversed=new U.Point(1,1),this.margin={left:0,top:0,right:0,bottom:0,x:0,y:0},this.bounds=new U.Rectangle,this.aspectRatio=0,this.sourceAspectRatio=0,this.event=null,this.windowConstraints={right:"layout",bottom:""},this.compatibility={supportsFullScreen:!1,orientationFallback:null,noMargins:!1,scrollTo:null,forceMinimumDocumentHeight:!1,canExpandParent:!0,clickTrampoline:""},this._scaleMode=U.ScaleManager.NO_SCALE,this._fullScreenScaleMode=U.ScaleManager.NO_SCALE,this.parentIsWindow=!1,this.parentNode=null,this.parentScaleFactor=new U.Point(1,1),this.trackParentInterval=2e3,this.onSizeChange=new U.Signal,this.onResize=null,this.onResizeContext=null,this._pendingScaleMode=null,this._fullScreenRestore=null,this._gameSize=new U.Rectangle,this._userScaleFactor=new U.Point(1,1),this._userScaleTrim=new U.Point(0,0),this._lastUpdate=0,this._updateThrottle=0,this._updateThrottleReset=100,this._parentBounds=new U.Rectangle,this._tempBounds=new U.Rectangle,this._lastReportedCanvasSize=new U.Rectangle,this._lastReportedGameSize=new U.Rectangle,this._booted=!1,t.config&&this.parseConfig(t.config),this.setupScale(e,i)},U.ScaleManager.EXACT_FIT=0,U.ScaleManager.NO_SCALE=1,U.ScaleManager.SHOW_ALL=2,U.ScaleManager.RESIZE=3,U.ScaleManager.USER_SCALE=4,U.ScaleManager.prototype={boot:function(){var t=this.compatibility;t.supportsFullScreen=this.game.device.fullscreen&&!this.game.device.cocoonJS,this.game.device.iPad||this.game.device.webApp||this.game.device.desktop||(this.game.device.android&&!this.game.device.chrome?t.scrollTo=new U.Point(0,1):t.scrollTo=new U.Point(0,0)),this.game.device.desktop?(t.orientationFallback="screen",t.clickTrampoline="when-not-mouse"):(t.orientationFallback="",t.clickTrampoline="");var e=this;this._orientationChange=function(t){return e.orientationChange(t)},this._windowResize=function(t){return e.windowResize(t)},window.addEventListener("orientationchange",this._orientationChange,!1),window.addEventListener("resize",this._windowResize,!1),this.compatibility.supportsFullScreen&&(this._fullScreenChange=function(t){return e.fullScreenChange(t)},this._fullScreenError=function(t){return e.fullScreenError(t)},document.addEventListener("webkitfullscreenchange",this._fullScreenChange,!1),document.addEventListener("mozfullscreenchange",this._fullScreenChange,!1),document.addEventListener("MSFullscreenChange",this._fullScreenChange,!1),document.addEventListener("fullscreenchange",this._fullScreenChange,!1),document.addEventListener("webkitfullscreenerror",this._fullScreenError,!1),document.addEventListener("mozfullscreenerror",this._fullScreenError,!1),document.addEventListener("MSFullscreenError",this._fullScreenError,!1),document.addEventListener("fullscreenerror",this._fullScreenError,!1)),this.game.onResume.add(this._gameResumed,this),this.dom.getOffset(this.game.canvas,this.offset),this.bounds.setTo(this.offset.x,this.offset.y,this.width,this.height),this.setGameSize(this.game.width,this.game.height),this.screenOrientation=this.dom.getScreenOrientation(this.compatibility.orientationFallback),U.FlexGrid&&(this.grid=new U.FlexGrid(this,this.width,this.height)),this._booted=!0,null!==this._pendingScaleMode&&(this.scaleMode=this._pendingScaleMode,this._pendingScaleMode=null)},parseConfig:function(t){void 0!==t.scaleMode&&(this._booted?this.scaleMode=t.scaleMode:this._pendingScaleMode=t.scaleMode),void 0!==t.fullScreenScaleMode&&(this.fullScreenScaleMode=t.fullScreenScaleMode),t.fullScreenTarget&&(this.fullScreenTarget=t.fullScreenTarget)},setupScale:function(t,e){var i=new U.Rectangle;""!==this.game.parent&&("string"==typeof this.game.parent?r=document.getElementById(this.game.parent):this.game.parent&&1===this.game.parent.nodeType&&(r=this.game.parent)),r?(this.parentNode=r,this.parentIsWindow=!1,this.getParentBounds(this._parentBounds),i.width=this._parentBounds.width,i.height=this._parentBounds.height,this.offset.set(this._parentBounds.x,this._parentBounds.y)):(this.parentNode=null,this.parentIsWindow=!0,i.width=this.dom.visualBounds.width,i.height=this.dom.visualBounds.height,this.offset.set(0,0));var n=0,r=0,n="number"==typeof t?t:(this.parentScaleFactor.x=parseInt(t,10)/100,i.width*this.parentScaleFactor.x),r="number"==typeof e?e:(this.parentScaleFactor.y=parseInt(e,10)/100,i.height*this.parentScaleFactor.y);n=Math.floor(n),r=Math.floor(r),this._gameSize.setTo(0,0,n,r),this.updateDimensions(n,r,!1)},_gameResumed:function(){this.queueUpdate(!0)},setGameSize:function(t,e){this._gameSize.setTo(0,0,t,e),this.currentScaleMode!==U.ScaleManager.RESIZE&&this.updateDimensions(t,e,!0),this.queueUpdate(!0)},setUserScale:function(t,e,i,n){this._userScaleFactor.setTo(t,e),this._userScaleTrim.setTo(0|i,0|n),this.queueUpdate(!0)},setResizeCallback:function(t,e){this.onResize=t,this.onResizeContext=e},signalSizeChange:function(){var t,e;U.Rectangle.sameDimensions(this,this._lastReportedCanvasSize)&&U.Rectangle.sameDimensions(this.game,this._lastReportedGameSize)||(t=this.width,e=this.height,this._lastReportedCanvasSize.setTo(0,0,t,e),this._lastReportedGameSize.setTo(0,0,this.game.width,this.game.height),this.grid&&this.grid.onResize(t,e),this.onSizeChange.dispatch(this,t,e),this.currentScaleMode===U.ScaleManager.RESIZE&&(this.game.state.resize(t,e),this.game.load.resize(t,e)))},setMinMax:function(t,e,i,n){this.minWidth=t,this.minHeight=e,void 0!==i&&(this.maxWidth=i),void 0!==n&&(this.maxHeight=n)},preUpdate:function(){var t,e,i,n;this.game.time.time<this._lastUpdate+this._updateThrottle||(t=this._updateThrottle,this._updateThrottleReset=400<=t?0:100,this.dom.getOffset(this.game.canvas,this.offset),e=this._parentBounds.width,i=this._parentBounds.height,e=(n=this.getParentBounds(this._parentBounds)).width!==e||n.height!==i,i=this.updateOrientationState(),(e||i)&&(this.onResize&&this.onResize.call(this.onResizeContext,this,n),this.updateLayout(),this.signalSizeChange()),n=2*this._updateThrottle,this._updateThrottle<t&&(n=Math.min(t,this._updateThrottleReset)),this._updateThrottle=U.Math.clamp(n,25,this.trackParentInterval),this._lastUpdate=this.game.time.time)},pauseUpdate:function(){this.preUpdate(),this._updateThrottle=this.trackParentInterval},updateDimensions:function(t,e,i){this.width=t*this.parentScaleFactor.x,this.height=e*this.parentScaleFactor.y,this.game.width=this.width,this.game.height=this.height,this.sourceAspectRatio=this.width/this.height,this.updateScalingAndBounds(),i&&(this.game.renderer.resize(this.width,this.height),this.game.camera.setSize(this.width,this.height),this.game.world.resize(this.width,this.height))},updateScalingAndBounds:function(){this.scaleFactor.x=this.game.width/this.width,this.scaleFactor.y=this.game.height/this.height,this.scaleFactorInversed.x=this.width/this.game.width,this.scaleFactorInversed.y=this.height/this.game.height,this.aspectRatio=this.width/this.height,this.game.canvas&&this.dom.getOffset(this.game.canvas,this.offset),this.bounds.setTo(this.offset.x,this.offset.y,this.width,this.height),this.game.input&&this.game.input.scale&&this.game.input.scale.setTo(this.scaleFactor.x,this.scaleFactor.y)},forceOrientation:function(t,e){void 0===e&&(e=!1),this.forceLandscape=t,this.forcePortrait=e,this.queueUpdate(!0)},classifyOrientation:function(t){return"portrait-primary"===t||"portrait-secondary"===t?"portrait":"landscape-primary"===t||"landscape-secondary"===t?"landscape":null},updateOrientationState:function(){var t=this.screenOrientation,e=this.incorrectOrientation;this.screenOrientation=this.dom.getScreenOrientation(this.compatibility.orientationFallback),this.incorrectOrientation=this.forceLandscape&&!this.isLandscape||this.forcePortrait&&!this.isPortrait;var i=t!==this.screenOrientation,n=e!==this.incorrectOrientation;return n&&(this.incorrectOrientation?this.enterIncorrectOrientation:this.leaveIncorrectOrientation).dispatch(),(i||n)&&this.onOrientationChange.dispatch(this,t,e),i||n},orientationChange:function(t){this.event=t,this.queueUpdate(!0)},windowResize:function(t){this.event=t,this.queueUpdate(!0)},scrollTop:function(){var t=this.compatibility.scrollTo;t&&window.scrollTo(t.x,t.y)},refresh:function(){this.scrollTop(),this.queueUpdate(!0)},updateLayout:function(){var t=this.currentScaleMode;t!==U.ScaleManager.RESIZE?(this.scrollTop(),this.compatibility.forceMinimumDocumentHeight&&(document.documentElement.style.minHeight=window.innerHeight+"px"),this.incorrectOrientation?this.setMaximum():t===U.ScaleManager.EXACT_FIT?this.setExactFit():t===U.ScaleManager.SHOW_ALL?(!this.isFullScreen&&this.boundingParent&&this.compatibility.canExpandParent&&(this.setShowAll(!0),this.resetCanvas()),this.setShowAll()):t===U.ScaleManager.NO_SCALE?(this.width=this.game.width,this.height=this.game.height):t===U.ScaleManager.USER_SCALE&&(this.width=this.game.width*this._userScaleFactor.x-this._userScaleTrim.x,this.height=this.game.height*this._userScaleFactor.y-this._userScaleTrim.y),this.compatibility.canExpandParent||t!==U.ScaleManager.SHOW_ALL&&t!==U.ScaleManager.USER_SCALE||(t=this.getParentBounds(this._tempBounds),this.width=Math.min(this.width,t.width),this.height=Math.min(this.height,t.height)),this.width=0|this.width,this.height=0|this.height,this.reflowCanvas()):this.reflowGame()},getParentBounds:function(t){var e,i=t||new U.Rectangle,n=this.boundingParent,r=this.dom.visualBounds,o=this.dom.layoutBounds;return n?(t=n.getBoundingClientRect(),n=(n.offsetParent||n).getBoundingClientRect(),i.setTo(t.left-n.left,t.top-n.top,t.width,t.height),(t=this.windowConstraints).right&&(e="layout"===t.right?o:r,i.right=Math.min(i.right,e.width)),t.bottom&&(e="layout"===t.bottom?o:r,i.bottom=Math.min(i.bottom,e.height))):i.setTo(0,0,r.width,r.height),i.setTo(Math.round(i.x),Math.round(i.y),Math.round(i.width),Math.round(i.height)),i},alignCanvas:function(t,e){var i,n,r,o,s=this.getParentBounds(this._tempBounds),a=this.game.canvas,h=this.margin;t&&(h.left=h.right=0,i=a.getBoundingClientRect(),this.width<s.width&&!this.incorrectOrientation&&(n=i.left-s.x,r=s.width/2-this.width/2,o=(r=Math.max(r,0))-n,h.left=Math.round(o)),a.style.marginLeft=h.left+"px",0!==h.left&&(h.right=-(s.width-i.width-h.left),a.style.marginRight=h.right+"px")),e&&(h.top=h.bottom=0,i=a.getBoundingClientRect(),this.height<s.height&&!this.incorrectOrientation&&(n=i.top-s.y,r=s.height/2-this.height/2,o=(r=Math.max(r,0))-n,h.top=Math.round(o)),a.style.marginTop=h.top+"px",0!==h.top&&(h.bottom=-(s.height-i.height-h.top),a.style.marginBottom=h.bottom+"px")),h.x=h.left,h.y=h.top},reflowGame:function(){this.resetCanvas("","");var t=this.getParentBounds(this._tempBounds);this.updateDimensions(t.width,t.height,!0)},reflowCanvas:function(){this.incorrectOrientation||(this.width=U.Math.clamp(this.width,this.minWidth||0,this.maxWidth||this.width),this.height=U.Math.clamp(this.height,this.minHeight||0,this.maxHeight||this.height)),this.resetCanvas(),this.compatibility.noMargins||(this.isFullScreen&&this._createdFullScreenTarget?this.alignCanvas(!0,!0):this.alignCanvas(this.pageAlignHorizontally,this.pageAlignVertically)),this.updateScalingAndBounds()},resetCanvas:function(t,e){void 0===t&&(t=this.width+"px"),void 0===e&&(e=this.height+"px");var i=this.game.canvas;this.compatibility.noMargins||(i.style.marginLeft="",i.style.marginTop="",i.style.marginRight="",i.style.marginBottom=""),i.style.width=t,i.style.height=e},queueUpdate:function(t){t&&(this._parentBounds.width=0,this._parentBounds.height=0),this._updateThrottle=this._updateThrottleReset},reset:function(t){t&&this.grid&&this.grid.reset()},setMaximum:function(){this.width=this.dom.visualBounds.width,this.height=this.dom.visualBounds.height},setShowAll:function(t){var e=this.getParentBounds(this._tempBounds),i=e.width,e=e.height,i=t?Math.max(e/this.game.height,i/this.game.width):Math.min(e/this.game.height,i/this.game.width);this.width=Math.round(this.game.width*i),this.height=Math.round(this.game.height*i)},setExactFit:function(){var t=this.getParentBounds(this._tempBounds);this.width=t.width,this.height=t.height,this.isFullScreen||(this.maxWidth&&(this.width=Math.min(this.width,this.maxWidth)),this.maxHeight&&(this.height=Math.min(this.height,this.maxHeight)))},createFullScreenTarget:function(){var t=document.createElement("div");return t.style.margin="0",t.style.padding="0",t.style.background="#000",t},startFullScreen:function(t,e){if(this.isFullScreen)return!1;if(this.compatibility.supportsFullScreen){if("when-not-mouse"===this.compatibility.clickTrampoline){var i=this.game.input;if(i.activePointer&&i.activePointer!==i.mousePointer&&(e||!1!==e))return void i.activePointer.addClickTrampoline("startFullScreen",this.startFullScreen,this,[t,!1])}void 0!==t&&this.game.renderType===U.CANVAS&&(this.game.stage.smoothed=t);i=this.fullScreenTarget;i||(this.cleanupCreatedTarget(),this._createdFullScreenTarget=this.createFullScreenTarget(),i=this._createdFullScreenTarget);var t={targetElement:i};return this.hasPhaserSetFullScreen=!0,this.onFullScreenInit.dispatch(this,t),this._createdFullScreenTarget&&((t=this.game.canvas).parentNode.insertBefore(i,t),i.appendChild(t)),this.game.device.fullscreenKeyboard?i[this.game.device.requestFullscreen](Element.ALLOW_KEYBOARD_INPUT):i[this.game.device.requestFullscreen](),!0}var n=this;setTimeout(function(){n.fullScreenError()},10)},stopFullScreen:function(){return!(!this.isFullScreen||!this.compatibility.supportsFullScreen)&&(this.hasPhaserSetFullScreen=!1,document[this.game.device.cancelFullscreen](),!0)},cleanupCreatedTarget:function(){var t,e=this._createdFullScreenTarget;e&&e.parentNode&&((t=e.parentNode).insertBefore(this.game.canvas,e),t.removeChild(e)),this._createdFullScreenTarget=null},prepScreenMode:function(t){var e=!!this._createdFullScreenTarget,i=this._createdFullScreenTarget||this.fullScreenTarget;t?!e&&this.fullScreenScaleMode!==U.ScaleManager.EXACT_FIT||i===this.game.canvas||(this._fullScreenRestore={targetWidth:i.style.width,targetHeight:i.style.height},i.style.width="100%",i.style.height="100%"):(this._fullScreenRestore&&(i.style.width=this._fullScreenRestore.targetWidth,i.style.height=this._fullScreenRestore.targetHeight,this._fullScreenRestore=null),this.updateDimensions(this._gameSize.width,this._gameSize.height,!0),this.resetCanvas())},fullScreenChange:function(t){this.event=t,this.isFullScreen?this.prepScreenMode(!0):(this.prepScreenMode(!1),this.cleanupCreatedTarget()),this.updateLayout(),this.queueUpdate(!0),this.onFullScreenChange.dispatch(this,this.width,this.height)},fullScreenError:function(t){this.event=t,this.cleanupCreatedTarget(),this.onFullScreenError.dispatch(this)},scaleSprite:function(t,e,i,n){if(void 0===e&&(e=this.width),void 0===i&&(i=this.height),void 0===n&&(n=!1),!t||!t.scale)return t;if(t.scale.x=1,t.scale.y=1,t.width<=0||t.height<=0||e<=0||i<=0)return t;var r=e,o=t.height*e/t.width,s=t.width*i/t.height,i=i,e=e<s;return(e=e?n:!n)?(t.width=Math.floor(r),t.height=Math.floor(o)):(t.width=Math.floor(s),t.height=Math.floor(i)),t},destroy:function(){this.game.onResume.remove(this._gameResumed,this),window.removeEventListener("orientationchange",this._orientationChange,!1),window.removeEventListener("resize",this._windowResize,!1),this.compatibility.supportsFullScreen&&(document.removeEventListener("webkitfullscreenchange",this._fullScreenChange,!1),document.removeEventListener("mozfullscreenchange",this._fullScreenChange,!1),document.removeEventListener("MSFullscreenChange",this._fullScreenChange,!1),document.removeEventListener("fullscreenchange",this._fullScreenChange,!1),document.removeEventListener("webkitfullscreenerror",this._fullScreenError,!1),document.removeEventListener("mozfullscreenerror",this._fullScreenError,!1),document.removeEventListener("MSFullscreenError",this._fullScreenError,!1),document.removeEventListener("fullscreenerror",this._fullScreenError,!1))}},U.ScaleManager.prototype.constructor=U.ScaleManager,Object.defineProperty(U.ScaleManager.prototype,"boundingParent",{get:function(){return!(this.parentIsWindow||this.isFullScreen&&this.hasPhaserSetFullScreen&&!this._createdFullScreenTarget)&&this.game.canvas&&this.game.canvas.parentNode||null}}),Object.defineProperty(U.ScaleManager.prototype,"scaleMode",{get:function(){return this._scaleMode},set:function(t){return t!==this._scaleMode&&(this.isFullScreen||(this.updateDimensions(this._gameSize.width,this._gameSize.height,!0),this.queueUpdate(!0)),this._scaleMode=t),this._scaleMode}}),Object.defineProperty(U.ScaleManager.prototype,"fullScreenScaleMode",{get:function(){return this._fullScreenScaleMode},set:function(t){return t!==this._fullScreenScaleMode&&(this.isFullScreen?(this.prepScreenMode(!1),this._fullScreenScaleMode=t,this.prepScreenMode(!0),this.queueUpdate(!0)):this._fullScreenScaleMode=t),this._fullScreenScaleMode}}),Object.defineProperty(U.ScaleManager.prototype,"currentScaleMode",{get:function(){return this.isFullScreen?this._fullScreenScaleMode:this._scaleMode}}),Object.defineProperty(U.ScaleManager.prototype,"pageAlignHorizontally",{get:function(){return this._pageAlignHorizontally},set:function(t){t!==this._pageAlignHorizontally&&(this._pageAlignHorizontally=t,this.queueUpdate(!0))}}),Object.defineProperty(U.ScaleManager.prototype,"pageAlignVertically",{get:function(){return this._pageAlignVertically},set:function(t){t!==this._pageAlignVertically&&(this._pageAlignVertically=t,this.queueUpdate(!0))}}),Object.defineProperty(U.ScaleManager.prototype,"isFullScreen",{get:function(){return!!(document.fullscreenElement||document.webkitFullscreenElement||document.mozFullScreenElement||document.msFullscreenElement)}}),Object.defineProperty(U.ScaleManager.prototype,"isPortrait",{get:function(){return"portrait"===this.classifyOrientation(this.screenOrientation)}}),Object.defineProperty(U.ScaleManager.prototype,"isLandscape",{get:function(){return"landscape"===this.classifyOrientation(this.screenOrientation)}}),Object.defineProperty(U.ScaleManager.prototype,"isGamePortrait",{get:function(){return this.height>this.width}}),Object.defineProperty(U.ScaleManager.prototype,"isGameLandscape",{get:function(){return this.width>this.height}}),U.Utils.Debug=function(t){this.game=t,this.sprite=null,this.bmd=null,this.canvas=null,this.context=null,this.font="14px Courier",this.columnWidth=100,this.lineHeight=16,this.renderShadow=!0,this.currentX=0,this.currentY=0,this.currentAlpha=1,this.dirty=!1},U.Utils.Debug.prototype={boot:function(){this.game.renderType===U.CANVAS?this.context=this.game.context:(this.bmd=new U.BitmapData(this.game,"__DEBUG",this.game.width,this.game.height,!0),this.sprite=this.game.make.image(0,0,this.bmd),this.game.stage.addChild(this.sprite),this.game.scale.onSizeChange.add(this.resize,this),this.canvas=PIXI.CanvasPool.create(this,this.game.width,this.game.height),this.context=this.canvas.getContext("2d"))},resize:function(t,e,i){this.bmd.resize(e,i),this.canvas.width=e,this.canvas.height=i},preUpdate:function(){this.dirty&&this.sprite&&(this.bmd.clear(),this.bmd.draw(this.canvas,0,0),this.context.clearRect(0,0,this.game.width,this.game.height),this.dirty=!1)},reset:function(){this.context&&this.context.clearRect(0,0,this.game.width,this.game.height),this.sprite&&this.bmd.clear()},start:function(t,e,i,n){"number"!=typeof e&&(e=0),i=i||"rgb(255,255,255)",void 0===n&&(n=0),this.currentX=t="number"!=typeof t?0:t,this.currentY=e,this.currentColor=i,this.columnWidth=n,this.dirty=!0,this.context.save(),this.context.setTransform(1,0,0,1,0,0),this.context.strokeStyle=i,this.context.fillStyle=i,this.context.font=this.font,this.context.globalAlpha=this.currentAlpha},stop:function(){this.context.restore()},line:function(){for(var t=this.currentX,e=0;e<arguments.length;e++)this.renderShadow&&(this.context.fillStyle="rgb(0,0,0)",this.context.fillText(arguments[e],t+1,this.currentY+1),this.context.fillStyle=this.currentColor),this.context.fillText(arguments[e],t,this.currentY),t+=this.columnWidth;this.currentY+=this.lineHeight},soundInfo:function(t,e,i,n){this.start(e,i,n),this.line("Sound: "+t.key+" Locked: "+t.game.sound.touchLocked),this.line("Is Ready?: "+this.game.cache.isSoundReady(t.key)+" Pending Playback: "+t.pendingPlayback),this.line("Decoded: "+t.isDecoded+" Decoding: "+t.isDecoding),this.line("Total Duration: "+t.totalDuration+" Playing: "+t.isPlaying),this.line("Time: "+t.currentTime),this.line("Volume: "+t.volume+" Muted: "+t.mute),this.line("WebAudio: "+t.usingWebAudio+" Audio: "+t.usingAudioTag),""!==t.currentMarker&&(this.line("Marker: "+t.currentMarker+" Duration: "+t.duration+" (ms: "+t.durationMS+")"),this.line("Start: "+t.markers[t.currentMarker].start+" Stop: "+t.markers[t.currentMarker].stop),this.line("Position: "+t.position)),this.stop()},cameraInfo:function(t,e,i,n){this.start(e,i,n),this.line("Camera ("+t.width+" x "+t.height+")"),this.line("X: "+t.x+" Y: "+t.y),t.bounds&&this.line("Bounds x: "+t.bounds.x+" Y: "+t.bounds.y+" w: "+t.bounds.width+" h: "+t.bounds.height),this.line("View x: "+t.view.x+" Y: "+t.view.y+" w: "+t.view.width+" h: "+t.view.height),this.line("Total in view: "+t.totalInView),this.stop()},timer:function(t,e,i,n){this.start(e,i,n),this.line("Timer (running: "+t.running+" expired: "+t.expired+")"),this.line("Next Tick: "+t.next+" Duration: "+t.duration),this.line("Paused: "+t.paused+" Length: "+t.length),this.stop()},pointer:function(t,e,i,n,r){null!=t&&(i=i||"rgba(0,255,0,0.5)",n=n||"rgba(255,0,0,0.5)",!0===(e=void 0===e?!1:e)&&!0===t.isUp||(this.start(t.x,t.y-100,r),this.context.beginPath(),this.context.arc(t.x,t.y,t.circle.radius,0,2*Math.PI),t.active?this.context.fillStyle=i:this.context.fillStyle=n,this.context.fill(),this.context.closePath(),this.context.beginPath(),this.context.moveTo(t.positionDown.x,t.positionDown.y),this.context.lineTo(t.position.x,t.position.y),this.context.lineWidth=2,this.context.stroke(),this.context.closePath(),this.line("ID: "+t.id+" Active: "+t.active),this.line("World X: "+t.worldX+" World Y: "+t.worldY),this.line("Screen X: "+t.x+" Screen Y: "+t.y+" In: "+t.withinGame),this.line("Duration: "+t.duration+" ms"),this.line("is Down: "+t.isDown+" is Up: "+t.isUp),this.stop()))},spriteInputInfo:function(t,e,i,n){this.start(e,i,n),this.line("Sprite Input: ("+t.width+" x "+t.height+")"),this.line("x: "+t.input.pointerX().toFixed(1)+" y: "+t.input.pointerY().toFixed(1)),this.line("over: "+t.input.pointerOver()+" duration: "+t.input.overDuration().toFixed(0)),this.line("down: "+t.input.pointerDown()+" duration: "+t.input.downDuration().toFixed(0)),this.line("just over: "+t.input.justOver()+" just out: "+t.input.justOut()),this.stop()},key:function(t,e,i,n){this.start(e,i,n,150),this.line("Key:",t.keyCode,"isDown:",t.isDown),this.line("justDown:",t.justDown,"justUp:",t.justUp),this.line("Time Down:",t.timeDown.toFixed(0),"duration:",t.duration.toFixed(0)),this.stop()},inputInfo:function(t,e,i){this.start(t,e,i),this.line("Input"),this.line("X: "+this.game.input.x+" Y: "+this.game.input.y),this.line("World X: "+this.game.input.worldX+" World Y: "+this.game.input.worldY),this.line("Scale X: "+this.game.input.scale.x.toFixed(1)+" Scale Y: "+this.game.input.scale.x.toFixed(1)),this.line("Screen X: "+this.game.input.activePointer.screenX+" Screen Y: "+this.game.input.activePointer.screenY),this.stop()},spriteBounds:function(t,e,i){t=t.getBounds();t.x+=this.game.camera.x,t.y+=this.game.camera.y,this.rectangle(t,e,i)},ropeSegments:function(t,e,i){var t=t.segments,n=this;t.forEach(function(t){n.rectangle(t,e,i)},this)},spriteInfo:function(t,e,i,n){this.start(e,i,n),this.line("Sprite:  ("+t.width+" x "+t.height+") anchor: "+t.anchor.x+" x "+t.anchor.y),this.line("x: "+t.x.toFixed(1)+" y: "+t.y.toFixed(1)),this.line("angle: "+t.angle.toFixed(1)+" rotation: "+t.rotation.toFixed(1)),this.line("visible: "+t.visible+" in camera: "+t.inCamera),this.line("bounds x: "+t._bounds.x.toFixed(1)+" y: "+t._bounds.y.toFixed(1)+" w: "+t._bounds.width.toFixed(1)+" h: "+t._bounds.height.toFixed(1)),this.stop()},spriteCoords:function(t,e,i,n){this.start(e,i,n,100),t.name&&this.line(t.name),this.line("x:",t.x.toFixed(2),"y:",t.y.toFixed(2)),this.line("pos x:",t.position.x.toFixed(2),"pos y:",t.position.y.toFixed(2)),this.line("world x:",t.world.x.toFixed(2),"world y:",t.world.y.toFixed(2)),this.stop()},lineInfo:function(t,e,i,n){this.start(e,i,n,80),this.line("start.x:",t.start.x.toFixed(2),"start.y:",t.start.y.toFixed(2)),this.line("end.x:",t.end.x.toFixed(2),"end.y:",t.end.y.toFixed(2)),this.line("length:",t.length.toFixed(2),"angle:",t.angle),this.stop()},pixel:function(t,e,i,n){n=n||2,this.start(),this.context.fillStyle=i,this.context.fillRect(t,e,n,n),this.stop()},geom:function(t,e,i,n){void 0===i&&(i=!0),void 0===n&&(n=0),e=e||"rgba(0,255,0,0.4)",this.start(),this.context.fillStyle=e,this.context.strokeStyle=e,t instanceof U.Rectangle||1===n?i?this.context.fillRect(t.x-this.game.camera.x,t.y-this.game.camera.y,t.width,t.height):this.context.strokeRect(t.x-this.game.camera.x,t.y-this.game.camera.y,t.width,t.height):t instanceof U.Circle||2===n?(this.context.beginPath(),this.context.arc(t.x-this.game.camera.x,t.y-this.game.camera.y,t.radius,0,2*Math.PI,!1),this.context.closePath(),i?this.context.fill():this.context.stroke()):t instanceof U.Point||3===n?this.context.fillRect(t.x-this.game.camera.x,t.y-this.game.camera.y,4,4):(t instanceof U.Line||4===n)&&(this.context.lineWidth=1,this.context.beginPath(),this.context.moveTo(t.start.x+.5-this.game.camera.x,t.start.y+.5-this.game.camera.y),this.context.lineTo(t.end.x+.5-this.game.camera.x,t.end.y+.5-this.game.camera.y),this.context.closePath(),this.context.stroke()),this.stop()},rectangle:function(t,e,i){void 0===i&&(i=!0),e=e||"rgba(0, 255, 0, 0.4)",this.start(),i?(this.context.fillStyle=e,this.context.fillRect(t.x-this.game.camera.x,t.y-this.game.camera.y,t.width,t.height)):(this.context.strokeStyle=e,this.context.strokeRect(t.x-this.game.camera.x,t.y-this.game.camera.y,t.width,t.height)),this.stop()},text:function(t,e,i,n,r){n=n||"rgb(255,255,255)",r=r||"16px Courier",this.start(),this.context.font=r,this.renderShadow&&(this.context.fillStyle="rgb(0,0,0)",this.context.fillText(t,e+1,i+1)),this.context.fillStyle=n,this.context.fillText(t,e,i),this.stop()},quadTree:function(t,e){e=e||"rgba(255,0,0,0.3)",this.start();var i=t.bounds;if(0===t.nodes.length){this.context.strokeStyle=e,this.context.strokeRect(i.x,i.y,i.width,i.height),this.text("size: "+t.objects.length,i.x+4,i.y+16,"rgb(0,200,0)","12px Courier"),this.context.strokeStyle="rgb(0,255,0)";for(var n=0;n<t.objects.length;n++)this.context.strokeRect(t.objects[n].x,t.objects[n].y,t.objects[n].width,t.objects[n].height)}else for(n=0;n<t.nodes.length;n++)this.quadTree(t.nodes[n]);this.stop()},body:function(t,e,i){t.body&&(this.start(),t.body.type===U.Physics.ARCADE?U.Physics.Arcade.Body.render(this.context,t.body,e,i):t.body.type===U.Physics.NINJA?U.Physics.Ninja.Body.render(this.context,t.body,e,i):t.body.type===U.Physics.BOX2D&&U.Physics.Box2D.renderBody(this.context,t.body,e),this.stop())},bodyInfo:function(t,e,i,n){t.body&&(this.start(e,i,n,210),t.body.type===U.Physics.ARCADE?U.Physics.Arcade.Body.renderBodyInfo(this,t.body):t.body.type===U.Physics.BOX2D&&this.game.physics.box2d.renderBodyInfo(this,t.body),this.stop())},box2dWorld:function(){this.start(),this.context.translate(-this.game.camera.view.x,-this.game.camera.view.y,0),this.game.physics.box2d.renderDebugDraw(this.context),this.stop()},box2dBody:function(t,e){this.start(),U.Physics.Box2D.renderBody(this.context,t,e),this.stop()},displayList:function(t){if((t=void 0===t?this.game.world:t).hasOwnProperty("renderOrderID"),t.children&&0<t.children.length)for(var e=0;e<t.children.length;e++)this.game.debug.displayList(t.children[e])},destroy:function(){PIXI.CanvasPool.remove(this)}},U.Utils.Debug.prototype.constructor=U.Utils.Debug,U.DOM={getOffset:function(t,e){e=e||new U.Point;var i=t.getBoundingClientRect(),n=U.DOM.scrollY,r=U.DOM.scrollX,o=document.documentElement.clientTop,t=document.documentElement.clientLeft;return e.x=i.left+r-t,e.y=i.top+n-o,e},getBounds:function(t,e){return void 0===e&&(e=0),!(!(t=t&&!t.nodeType?t[0]:t)||1!==t.nodeType)&&this.calibrate(t.getBoundingClientRect(),e)},calibrate:function(t,e){var i={width:0,height:0,left:0,right:0,top:0,bottom:0};return i.width=(i.right=t.right+(e=+e||0))-(i.left=t.left-e),i.height=(i.bottom=t.bottom+e)-(i.top=t.top-e),i},getAspectRatio:function(t){var e=(t=null==t?this.visualBounds:1===t.nodeType?this.getBounds(t):t).width,i=t.height;return(e="function"==typeof e?e.call(t):e)/(i="function"==typeof i?i.call(t):i)},inLayoutViewport:function(t,e){e=this.getBounds(t,e);return!!e&&0<=e.bottom&&0<=e.right&&e.top<=this.layoutBounds.width&&e.left<=this.layoutBounds.height},getScreenOrientation:function(t){var e=window.screen,i=e.orientation||e.mozOrientation||e.msOrientation;if(i&&"string"==typeof i.type)return i.type;if("string"==typeof i)return i;var n="portrait-primary",i="landscape-primary";if("screen"===t)return e.height>e.width?n:i;if("viewport"===t)return this.visualBounds.height>this.visualBounds.width?n:i;if("window.orientation"===t&&"number"==typeof window.orientation)return 0===window.orientation||180===window.orientation?n:i;if(window.matchMedia){if(window.matchMedia("(orientation: portrait)").matches)return n;if(window.matchMedia("(orientation: landscape)").matches)return i}return this.visualBounds.height>this.visualBounds.width?n:i},visualBounds:new U.Rectangle,layoutBounds:new U.Rectangle,documentBounds:new U.Rectangle},U.Device.whenReady(function(t){var e=window&&"pageXOffset"in window?function(){return window.pageXOffset}:function(){return document.documentElement.scrollLeft},i=window&&"pageYOffset"in window?function(){return window.pageYOffset}:function(){return document.documentElement.scrollTop};Object.defineProperty(U.DOM,"scrollX",{get:e}),Object.defineProperty(U.DOM,"scrollY",{get:i}),Object.defineProperty(U.DOM.visualBounds,"x",{get:e}),Object.defineProperty(U.DOM.visualBounds,"y",{get:i}),Object.defineProperty(U.DOM.layoutBounds,"x",{value:0}),Object.defineProperty(U.DOM.layoutBounds,"y",{value:0}),t.desktop&&document.documentElement.clientWidth<=window.innerWidth&&document.documentElement.clientHeight<=window.innerHeight?(i=function(){return Math.max(window.innerWidth,document.documentElement.clientWidth)},t=function(){return Math.max(window.innerHeight,document.documentElement.clientHeight)},Object.defineProperty(U.DOM.visualBounds,"width",{get:i}),Object.defineProperty(U.DOM.visualBounds,"height",{get:t}),Object.defineProperty(U.DOM.layoutBounds,"width",{get:i}),Object.defineProperty(U.DOM.layoutBounds,"height",{get:t})):(Object.defineProperty(U.DOM.visualBounds,"width",{get:function(){return window.innerWidth}}),Object.defineProperty(U.DOM.visualBounds,"height",{get:function(){return window.innerHeight}}),Object.defineProperty(U.DOM.layoutBounds,"width",{get:function(){var t=document.documentElement.clientWidth,e=window.innerWidth;return t<e?e:t}}),Object.defineProperty(U.DOM.layoutBounds,"height",{get:function(){var t=document.documentElement.clientHeight,e=window.innerHeight;return t<e?e:t}})),Object.defineProperty(U.DOM.documentBounds,"x",{value:0}),Object.defineProperty(U.DOM.documentBounds,"y",{value:0}),Object.defineProperty(U.DOM.documentBounds,"width",{get:function(){var t=document.documentElement;return Math.max(t.clientWidth,t.offsetWidth,t.scrollWidth)}}),Object.defineProperty(U.DOM.documentBounds,"height",{get:function(){var t=document.documentElement;return Math.max(t.clientHeight,t.offsetHeight,t.scrollHeight)}})},null,!0),U.ArraySet=function(t){this.position=0,this.list=t||[]},U.ArraySet.prototype={add:function(t){return this.exists(t)||this.list.push(t),t},getIndex:function(t){return this.list.indexOf(t)},getByKey:function(t,e){for(var i=this.list.length;i--;)if(this.list[i][t]===e)return this.list[i];return null},exists:function(t){return-1<this.list.indexOf(t)},reset:function(){this.list.length=0},remove:function(t){var e=this.list.indexOf(t);if(-1<e)return this.list.splice(e,1),t},setAll:function(t,e){for(var i=this.list.length;i--;)this.list[i]&&(this.list[i][t]=e)},callAll:function(t){for(var e=Array.prototype.slice.call(arguments,1),i=this.list.length;i--;)this.list[i]&&this.list[i][t]&&this.list[i][t].apply(this.list[i],e)},removeAll:function(t){void 0===t&&(t=!1);for(var e,i=this.list.length;i--;)this.list[i]&&(e=this.remove(this.list[i]),t&&e.destroy());this.position=0,this.list=[]}},Object.defineProperty(U.ArraySet.prototype,"total",{get:function(){return this.list.length}}),Object.defineProperty(U.ArraySet.prototype,"first",{get:function(){return(this.position=0)<this.list.length?this.list[0]:null}}),Object.defineProperty(U.ArraySet.prototype,"next",{get:function(){return this.position<this.list.length?(this.position++,this.list[this.position]):null}}),U.ArraySet.prototype.constructor=U.ArraySet,U.ArrayUtils={getRandomItem:function(t,e,i){if(null===t)return null;void 0===i&&(i=t.length);i=(e=void 0===e?0:e)+Math.floor(Math.random()*i);return void 0===t[i]?null:t[i]},removeRandomItem:function(t,e,i){if(null==t)return null;void 0===i&&(i=t.length);i=(e=void 0===e?0:e)+Math.floor(Math.random()*i);if(i<t.length){i=t.splice(i,1);return void 0===i[0]?null:i[0]}return null},shuffle:function(t){for(var e=t.length-1;0<e;e--){var i=Math.floor(Math.random()*(e+1)),n=t[e];t[e]=t[i],t[i]=n}return t},transposeMatrix:function(t){for(var e=t.length,i=t[0].length,n=new Array(i),r=0;r<i;r++){n[r]=new Array(e);for(var o=e-1;-1<o;o--)n[r][o]=t[o][r]}return n},rotateMatrix:function(t,e){if(90===(e="string"!=typeof e?(e%360+360)%360:e)||-270===e||"rotateLeft"===e)t=(t=U.ArrayUtils.transposeMatrix(t)).reverse();else if(-90===e||270===e||"rotateRight"===e)t=t.reverse(),t=U.ArrayUtils.transposeMatrix(t);else if(180===Math.abs(e)||"rotate180"===e){for(var i=0;i<t.length;i++)t[i].reverse();t=t.reverse()}return t},findClosest:function(t,e){if(!e.length)return NaN;if(1===e.length||t<e[0])return e[0];for(var i=1;e[i]<t;)i++;var n=e[i-1],r=i<e.length?e[i]:Number.POSITIVE_INFINITY;return r-t<=t-n?r:n},rotateRight:function(t){var e=t.pop();return t.unshift(e),e},rotateLeft:function(t){var e=t.shift();return t.push(e),e},rotate:function(t){var e=t.shift();return t.push(e),e},numberArray:function(t,e){for(var i=[],n=t;n<=e;n++)i.push(n);return i},numberArrayStep:function(t,e,i){null==t&&(t=0),null==e&&(e=t,t=0),void 0===i&&(i=1);for(var n=[],r=Math.max(U.Math.roundAwayFromZero((e-t)/(i||1)),0),o=0;o<r;o++)n.push(t),t+=i;return n}},U.LinkedList=function(){this.next=null,this.prev=null,this.first=null,this.last=null,this.total=0},U.LinkedList.prototype={add:function(t){return 0===this.total&&null===this.first&&null===this.last?(this.first=t,this.last=t,((this.next=t).prev=this).total++):((this.last.next=t).prev=this.last,this.last=t,this.total++),t},reset:function(){this.first=null,this.last=null,this.next=null,this.prev=null,this.total=0},remove:function(t){if(1===this.total)return this.reset(),void(t.next=t.prev=null);t===this.first?this.first=this.first.next:t===this.last&&(this.last=this.last.prev),t.prev&&(t.prev.next=t.next),t.next&&(t.next.prev=t.prev),(t.next=t.prev=null)===this.first&&(this.last=null),this.total--},callAll:function(t){if(this.first&&this.last)for(var e=this.first;e&&e[t]&&e[t].call(e),(e=e.next)!==this.last.next;);}},U.LinkedList.prototype.constructor=U.LinkedList,U.Create=function(t){this.game=t,this.bmd=null,this.canvas=null,this.ctx=null,this.palettes=[{0:"#000",1:"#9D9D9D",2:"#FFF",3:"#BE2633",4:"#E06F8B",5:"#493C2B",6:"#A46422",7:"#EB8931",8:"#F7E26B",9:"#2F484E",A:"#44891A",B:"#A3CE27",C:"#1B2632",D:"#005784",E:"#31A2F2",F:"#B2DCEF"},{0:"#000",1:"#191028",2:"#46af45",3:"#a1d685",4:"#453e78",5:"#7664fe",6:"#833129",7:"#9ec2e8",8:"#dc534b",9:"#e18d79",A:"#d6b97b",B:"#e9d8a1",C:"#216c4b",D:"#d365c8",E:"#afaab9",F:"#f5f4eb"},{0:"#000",1:"#2234d1",2:"#0c7e45",3:"#44aacc",4:"#8a3622",5:"#5c2e78",6:"#aa5c3d",7:"#b5b5b5",8:"#5e606e",9:"#4c81fb",A:"#6cd947",B:"#7be2f9",C:"#eb8a60",D:"#e23d69",E:"#ffd93f",F:"#fff"},{0:"#000",1:"#fff",2:"#8b4131",3:"#7bbdc5",4:"#8b41ac",5:"#6aac41",6:"#3931a4",7:"#d5de73",8:"#945a20",9:"#5a4100",A:"#bd736a",B:"#525252",C:"#838383",D:"#acee8b",E:"#7b73de",F:"#acacac"},{0:"#000",1:"#191028",2:"#46af45",3:"#a1d685",4:"#453e78",5:"#7664fe",6:"#833129",7:"#9ec2e8",8:"#dc534b",9:"#e18d79",A:"#d6b97b",B:"#e9d8a1",C:"#216c4b",D:"#d365c8",E:"#afaab9",F:"#fff"}]},U.Create.PALETTE_ARNE=0,U.Create.PALETTE_JMP=1,U.Create.PALETTE_CGA=2,U.Create.PALETTE_C64=3,U.Create.PALETTE_JAPANESE_MACHINE=4,U.Create.prototype={texture:function(t,e,i,n,r){void 0===i&&(i=8),void 0===n&&(n=i),void 0===r&&(r=0);var o=e[0].length*i,s=e.length*n;null===this.bmd&&(this.bmd=this.game.make.bitmapData(),this.canvas=this.bmd.canvas,this.ctx=this.bmd.context),this.bmd.resize(o,s),this.bmd.clear();for(var a=0;a<e.length;a++)for(var h=e[a],l=0;l<h.length;l++){var p=h[l];"."!==p&&" "!==p&&(this.ctx.fillStyle=this.palettes[r][p],this.ctx.fillRect(l*i,a*n,i,n))}return this.bmd.generateTexture(t)},grid:function(t,e,i,n,r,o){null===this.bmd&&(this.bmd=this.game.make.bitmapData(),this.canvas=this.bmd.canvas,this.ctx=this.bmd.context),this.bmd.resize(e,i),this.ctx.fillStyle=o;for(var s=0;s<i;s+=r)this.ctx.fillRect(0,s,e,1);for(var a=0;a<e;a+=n)this.ctx.fillRect(a,0,1,i);return this.bmd.generateTexture(t)}},U.Create.prototype.constructor=U.Create,U.FlexGrid=function(t,e,i){this.game=t.game,this.manager=t,this.width=e,this.height=i,this.boundsCustom=new U.Rectangle(0,0,e,i),this.boundsFluid=new U.Rectangle(0,0,e,i),this.boundsFull=new U.Rectangle(0,0,e,i),this.boundsNone=new U.Rectangle(0,0,e,i),this.positionCustom=new U.Point(0,0),this.positionFluid=new U.Point(0,0),this.positionFull=new U.Point(0,0),this.positionNone=new U.Point(0,0),this.scaleCustom=new U.Point(1,1),this.scaleFluid=new U.Point(1,1),this.scaleFluidInversed=new U.Point(1,1),this.scaleFull=new U.Point(1,1),this.scaleNone=new U.Point(1,1),this.customWidth=0,this.customHeight=0,this.customOffsetX=0,this.customOffsetY=0,this.ratioH=e/i,this.ratioV=i/e,this.multiplier=0,this.layers=[]},U.FlexGrid.prototype={setSize:function(t,e){this.width=t,this.height=e,this.ratioH=t/e,this.ratioV=e/t,this.scaleNone=new U.Point(1,1),this.boundsNone.width=this.width,this.boundsNone.height=this.height,this.refresh()},createCustomLayer:function(t,e,i,n){void 0===n&&(n=!0),this.customWidth=t,this.customHeight=e,this.boundsCustom.width=t,this.boundsCustom.height=e;e=new U.FlexLayer(this,this.positionCustom,this.boundsCustom,this.scaleCustom);return n&&this.game.world.add(e),this.layers.push(e),void 0!==i&&null!==typeof i&&e.addMultiple(i),e},createFluidLayer:function(t,e){void 0===e&&(e=!0);var i=new U.FlexLayer(this,this.positionFluid,this.boundsFluid,this.scaleFluid);return e&&this.game.world.add(i),this.layers.push(i),void 0!==t&&null!==typeof t&&i.addMultiple(t),i},createFullLayer:function(t){var e=new U.FlexLayer(this,this.positionFull,this.boundsFull,this.scaleFluid);return this.game.world.add(e),this.layers.push(e),void 0!==t&&e.addMultiple(t),e},createFixedLayer:function(t){var e=new U.FlexLayer(this,this.positionNone,this.boundsNone,this.scaleNone);return this.game.world.add(e),this.layers.push(e),void 0!==t&&e.addMultiple(t),e},reset:function(){for(var t=this.layers.length;t--;)this.layers[t].persist||(this.layers[t].position=null,this.layers[t].scale=null,this.layers.slice(t,1))},onResize:function(t,e){this.ratioH=t/e,this.ratioV=e/t,this.refresh(t,e)},refresh:function(){this.multiplier=Math.min(this.manager.height/this.height,this.manager.width/this.width),this.boundsFluid.width=Math.round(this.width*this.multiplier),this.boundsFluid.height=Math.round(this.height*this.multiplier),this.scaleFluid.set(this.boundsFluid.width/this.width,this.boundsFluid.height/this.height),this.scaleFluidInversed.set(this.width/this.boundsFluid.width,this.height/this.boundsFluid.height),this.scaleFull.set(this.boundsFull.width/this.width,this.boundsFull.height/this.height),this.boundsFull.width=Math.round(this.manager.width*this.scaleFluidInversed.x),this.boundsFull.height=Math.round(this.manager.height*this.scaleFluidInversed.y),this.boundsFluid.centerOn(this.manager.bounds.centerX,this.manager.bounds.centerY),this.boundsNone.centerOn(this.manager.bounds.centerX,this.manager.bounds.centerY),this.positionFluid.set(this.boundsFluid.x,this.boundsFluid.y),this.positionNone.set(this.boundsNone.x,this.boundsNone.y)},fitSprite:function(t){this.manager.scaleSprite(t),t.x=this.manager.bounds.centerX,t.y=this.manager.bounds.centerY},debug:function(){this.game.debug.text(this.boundsFluid.width+" x "+this.boundsFluid.height,this.boundsFluid.x+4,this.boundsFluid.y+16),this.game.debug.geom(this.boundsFluid,"rgba(255,0,0,0.9",!1)}},U.FlexGrid.prototype.constructor=U.FlexGrid,U.FlexLayer=function(t,e,i,n){U.Group.call(this,t.game,null,"__flexLayer"+t.game.rnd.uuid(),!1),this.manager=t.manager,this.grid=t,this.persist=!1,this.position=e,this.bounds=i,this.scale=n,this.topLeft=i.topLeft,this.topMiddle=new U.Point(i.halfWidth,0),this.topRight=i.topRight,this.bottomLeft=i.bottomLeft,this.bottomMiddle=new U.Point(i.halfWidth,i.bottom),this.bottomRight=i.bottomRight},U.FlexLayer.prototype=Object.create(U.Group.prototype),U.FlexLayer.prototype.constructor=U.FlexLayer,U.FlexLayer.prototype.resize=function(){},U.FlexLayer.prototype.debug=function(){this.game.debug.text(this.bounds.width+" x "+this.bounds.height,this.bounds.x+4,this.bounds.y+16),this.game.debug.geom(this.bounds,"rgba(0,0,255,0.9",!1),this.game.debug.geom(this.topLeft,"rgba(255,255,255,0.9"),this.game.debug.geom(this.topMiddle,"rgba(255,255,255,0.9"),this.game.debug.geom(this.topRight,"rgba(255,255,255,0.9")},U.Color={packPixel:function(t,e,i,n){return U.Device.LITTLE_ENDIAN?(n<<24|i<<16|e<<8|t)>>>0:(t<<24|e<<16|i<<8|n)>>>0},unpackPixel:function(t,e,i,n){return null==e&&(e=U.Color.createColor()),null==i&&(i=!1),null==n&&(n=!1),U.Device.LITTLE_ENDIAN?(e.a=(4278190080&t)>>>24,e.b=(16711680&t)>>>16,e.g=(65280&t)>>>8,e.r=255&t):(e.r=(4278190080&t)>>>24,e.g=(16711680&t)>>>16,e.b=(65280&t)>>>8,e.a=255&t),e.color=t,e.rgba="rgba("+e.r+","+e.g+","+e.b+","+e.a/255+")",i&&U.Color.RGBtoHSL(e.r,e.g,e.b,e),n&&U.Color.RGBtoHSV(e.r,e.g,e.b,e),e},fromRGBA:function(t,e){return(e=e||U.Color.createColor()).r=(4278190080&t)>>>24,e.g=(16711680&t)>>>16,e.b=(65280&t)>>>8,e.a=255&t,e.rgba="rgba("+e.r+","+e.g+","+e.b+","+e.a+")",e},toRGBA:function(t,e,i,n){return t<<24|e<<16|i<<8|n},toABGR:function(t,e,i,n){return(n<<24|i<<16|e<<8|t)>>>0},RGBtoHSL:function(t,e,i,n){n=n||U.Color.createColor(t,e,i,1),t/=255,e/=255,i/=255;var r,o=Math.min(t,e,i),s=Math.max(t,e,i);return n.h=0,n.s=0,n.l=(s+o)/2,s!==o&&(r=s-o,n.s=.5<n.l?r/(2-s-o):r/(s+o),s===t?n.h=(e-i)/r+(e<i?6:0):s===e?n.h=(i-t)/r+2:s===i&&(n.h=(t-e)/r+4),n.h/=6),n},HSLtoRGB:function(t,e,i,n){return n?(n.r=i,n.g=i,n.b=i):n=U.Color.createColor(i,i,i),0!==e&&(n.r=U.Color.hueToColor(e=2*i-(i=i<.5?i*(1+e):i+e-i*e),i,t+1/3),n.g=U.Color.hueToColor(e,i,t),n.b=U.Color.hueToColor(e,i,t-1/3)),n.r=Math.floor(255*n.r|0),n.g=Math.floor(255*n.g|0),n.b=Math.floor(255*n.b|0),U.Color.updateColor(n),n},RGBtoHSV:function(t,e,i,n){n=n||U.Color.createColor(t,e,i,255),t/=255,e/=255,i/=255;var r=Math.min(t,e,i),o=Math.max(t,e,i),s=o-r;return n.h=0,n.s=0===o?0:s/o,(n.v=o)!==r&&(o===t?n.h=(e-i)/s+(e<i?6:0):o===e?n.h=(i-t)/s+2:o===i&&(n.h=(t-e)/s+4),n.h/=6),n},HSVtoRGB:function(t,e,i,n){var r,o,s;void 0===n&&(n=U.Color.createColor(0,0,0,1,t,e,0,i));var a=Math.floor(6*t),t=6*t-a,h=i*(1-e),l=i*(1-t*e),p=i*(1-(1-t)*e);switch(a%6){case 0:r=i,o=p,s=h;break;case 1:r=l,o=i,s=h;break;case 2:r=h,o=i,s=p;break;case 3:r=h,o=l,s=i;break;case 4:r=p,o=h,s=i;break;case 5:r=i,o=h,s=l}return n.r=Math.floor(255*r),n.g=Math.floor(255*o),n.b=Math.floor(255*s),U.Color.updateColor(n),n},hueToColor:function(t,e,i){return i<0&&(i+=1),1<i&&--i,i<1/6?t+6*(e-t)*i:i<.5?e:i<2/3?t+(e-t)*(2/3-i)*6:t},createColor:function(t,e,i,n,r,o,s,a){return U.Color.updateColor({r:t||0,g:e||0,b:i||0,a:n||1,h:r||0,s:o||0,l:s||0,v:a||0,color:0,color32:0,rgba:""})},updateColor:function(t){return t.rgba="rgba("+t.r.toString()+","+t.g.toString()+","+t.b.toString()+","+t.a.toString()+")",t.color=U.Color.getColor(t.r,t.g,t.b),t.color32=U.Color.getColor32(255*t.a,t.r,t.g,t.b),t},getColor32:function(t,e,i,n){return t<<24|e<<16|i<<8|n},getColor:function(t,e,i){return t<<16|e<<8|i},RGBtoString:function(t,e,i,n,r){return void 0===n&&(n=255),"#"===(r=void 0===r?"#":r)?"#"+((1<<24)+(t<<16)+(e<<8)+i).toString(16).slice(1):"0x"+U.Color.componentToHex(n)+U.Color.componentToHex(t)+U.Color.componentToHex(e)+U.Color.componentToHex(i)},hexToRGB:function(t){t=U.Color.hexToColor(t);if(t)return U.Color.getColor32(t.a,t.r,t.g,t.b)},hexToColor:function(t,e){t=t.replace(/^(?:#|0x)?([a-f\d])([a-f\d])([a-f\d])$/i,function(t,e,i,n){return e+e+i+i+n+n});var i,n=/^(?:#|0x)?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(t);return n&&(i=parseInt(n[1],16),t=parseInt(n[2],16),n=parseInt(n[3],16),e?(e.r=i,e.g=t,e.b=n):e=U.Color.createColor(i,t,n)),e},webToColor:function(t,e){e=e||U.Color.createColor();t=/^rgba?\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d+(?:\.\d+)?))?\s*\)$/.exec(t);return t&&(e.r=parseInt(t[1],10),e.g=parseInt(t[2],10),e.b=parseInt(t[3],10),e.a=void 0!==t[4]?parseFloat(t[4]):1,U.Color.updateColor(e)),e},valueToColor:function(t,e){if(e=e||U.Color.createColor(),"string"==typeof t)return 0===t.indexOf("rgb")?U.Color.webToColor(t,e):(e.a=1,U.Color.hexToColor(t,e));if("number"!=typeof t)return e;t=U.Color.getRGB(t);return e.r=t.r,e.g=t.g,e.b=t.b,e.a=t.a/255,e},componentToHex:function(t){t=t.toString(16);return 1===t.length?"0"+t:t},HSVColorWheel:function(t,e){void 0===t&&(t=1),void 0===e&&(e=1);for(var i=[],n=0;n<=359;n++)i.push(U.Color.HSVtoRGB(n/359,t,e));return i},HSLColorWheel:function(t,e){void 0===t&&(t=.5),void 0===e&&(e=.5);for(var i=[],n=0;n<=359;n++)i.push(U.Color.HSLtoRGB(n/359,t,e));return i},interpolateColor:function(t,e,i,n,r){void 0===r&&(r=255);var o=U.Color.getRGB(t),s=U.Color.getRGB(e),t=(s.red-o.red)*n/i+o.red,e=(s.green-o.green)*n/i+o.green,o=(s.blue-o.blue)*n/i+o.blue;return U.Color.getColor32(r,t,e,o)},interpolateColorWithRGB:function(t,e,i,n,r,o){t=U.Color.getRGB(t),e=(e-t.red)*o/r+t.red,i=(i-t.green)*o/r+t.green,t=(n-t.blue)*o/r+t.blue;return U.Color.getColor(e,i,t)},interpolateRGB:function(t,e,i,n,r,o,s,a){return U.Color.getColor((n-t)*a/s+t,(r-e)*a/s+e,(o-i)*a/s+i)},getRandomColor:function(t,e,i){if(void 0===t&&(t=0),void 0===i&&(i=255),255<(e=void 0===e?255:e)||e<t)return U.Color.getColor(255,255,255);var n=t+Math.round(Math.random()*(e-t)),r=t+Math.round(Math.random()*(e-t)),t=t+Math.round(Math.random()*(e-t));return U.Color.getColor32(i,n,r,t)},getRGB:function(t){return 16777215<t?{alpha:t>>>24,red:t>>16&255,green:t>>8&255,blue:255&t,a:t>>>24,r:t>>16&255,g:t>>8&255,b:255&t}:{alpha:255,red:t>>16&255,green:t>>8&255,blue:255&t,a:255,r:t>>16&255,g:t>>8&255,b:255&t}},getWebRGB:function(t){if("object"==typeof t)return"rgba("+t.r.toString()+","+t.g.toString()+","+t.b.toString()+","+(t.a/255).toString()+")";t=U.Color.getRGB(t);return"rgba("+t.r.toString()+","+t.g.toString()+","+t.b.toString()+","+(t.a/255).toString()+")"},getAlpha:function(t){return t>>>24},getAlphaFloat:function(t){return(t>>>24)/255},getRed:function(t){return t>>16&255},getGreen:function(t){return t>>8&255},getBlue:function(t){return 255&t},blendNormal:function(t){return t},blendLighten:function(t,e){return t<e?e:t},blendDarken:function(t,e){return t<e?t:e},blendMultiply:function(t,e){return t*e/255},blendAverage:function(t,e){return(t+e)/2},blendAdd:function(t,e){return Math.min(255,t+e)},blendSubtract:function(t,e){return Math.max(0,t+e-255)},blendDifference:function(t,e){return Math.abs(t-e)},blendNegation:function(t,e){return 255-Math.abs(255-t-e)},blendScreen:function(t,e){return 255-((255-t)*(255-e)>>8)},blendExclusion:function(t,e){return t+e-2*t*e/255},blendOverlay:function(t,e){return e<128?2*t*e/255:255-2*(255-t)*(255-e)/255},blendSoftLight:function(t,e){return e<128?2*(64+(t>>1))*(e/255):255-2*(255-(64+(t>>1)))*(255-e)/255},blendHardLight:function(t,e){return U.Color.blendOverlay(e,t)},blendColorDodge:function(t,e){return 255===e?e:Math.min(255,(t<<8)/(255-e))},blendColorBurn:function(t,e){return 0===e?e:Math.max(0,255-(255-t<<8)/e)},blendLinearDodge:function(t,e){return U.Color.blendAdd(t,e)},blendLinearBurn:function(t,e){return U.Color.blendSubtract(t,e)},blendLinearLight:function(t,e){return e<128?U.Color.blendLinearBurn(t,2*e):U.Color.blendLinearDodge(t,2*(e-128))},blendVividLight:function(t,e){return e<128?U.Color.blendColorBurn(t,2*e):U.Color.blendColorDodge(t,2*(e-128))},blendPinLight:function(t,e){return e<128?U.Color.blendDarken(t,2*e):U.Color.blendLighten(t,2*(e-128))},blendHardMix:function(t,e){return U.Color.blendVividLight(t,e)<128?0:255},blendReflect:function(t,e){return 255===e?e:Math.min(255,t*t/(255-e))},blendGlow:function(t,e){return U.Color.blendReflect(e,t)},blendPhoenix:function(t,e){return Math.min(t,e)-Math.max(t,e)+255}},U.Physics=function(t,e){e=e||{},this.game=t,this.config=e,this.arcade=null,this.p2=null,this.ninja=null,this.box2d=null,this.chipmunk=null,this.matter=null,this.parseConfig()},U.Physics.ARCADE=0,U.Physics.P2JS=1,U.Physics.NINJA=2,U.Physics.BOX2D=3,U.Physics.CHIPMUNK=4,U.Physics.MATTERJS=5,U.Physics.prototype={parseConfig:function(){this.config.hasOwnProperty("arcade")&&!0!==this.config.arcade||!U.Physics.hasOwnProperty("Arcade")||(this.arcade=new U.Physics.Arcade(this.game)),this.config.hasOwnProperty("ninja")&&!0===this.config.ninja&&U.Physics.hasOwnProperty("Ninja")&&(this.ninja=new U.Physics.Ninja(this.game)),this.config.hasOwnProperty("p2")&&!0===this.config.p2&&U.Physics.hasOwnProperty("P2")&&(this.p2=new U.Physics.P2(this.game,this.config)),this.config.hasOwnProperty("box2d")&&!0===this.config.box2d&&U.Physics.hasOwnProperty("BOX2D")&&(this.box2d=new U.Physics.BOX2D(this.game,this.config)),this.config.hasOwnProperty("matter")&&!0===this.config.matter&&U.Physics.hasOwnProperty("Matter")&&(this.matter=new U.Physics.Matter(this.game,this.config))},startSystem:function(t){t===U.Physics.ARCADE?this.arcade=new U.Physics.Arcade(this.game):t===U.Physics.P2JS?null===this.p2?this.p2=new U.Physics.P2(this.game,this.config):this.p2.reset():t===U.Physics.NINJA?this.ninja=new U.Physics.Ninja(this.game):t===U.Physics.BOX2D?null===this.box2d?this.box2d=new U.Physics.Box2D(this.game,this.config):this.box2d.reset():t===U.Physics.MATTERJS&&(null===this.matter?this.matter=new U.Physics.Matter(this.game,this.config):this.matter.reset())},enable:function(t,e,i){void 0===i&&(i=!1),(e=void 0===e?U.Physics.ARCADE:e)===U.Physics.ARCADE?this.arcade.enable(t):e===U.Physics.P2JS&&this.p2?this.p2.enable(t,i):e===U.Physics.NINJA&&this.ninja?this.ninja.enableAABB(t):e===U.Physics.BOX2D&&this.box2d?this.box2d.enable(t):e===U.Physics.MATTERJS&&this.matter&&this.matter.enable(t)},preUpdate:function(){this.p2&&this.p2.preUpdate(),this.box2d&&this.box2d.preUpdate(),this.matter&&this.matter.preUpdate()},update:function(){this.p2&&this.p2.update(),this.box2d&&this.box2d.update(),this.matter&&this.matter.update()},setBoundsToWorld:function(){this.arcade&&this.arcade.setBoundsToWorld(),this.ninja&&this.ninja.setBoundsToWorld(),this.p2&&this.p2.setBoundsToWorld(),this.box2d&&this.box2d.setBoundsToWorld(),this.matter&&this.matter.setBoundsToWorld()},clear:function(){this.p2&&this.p2.clear(),this.box2d&&this.box2d.clear(),this.matter&&this.matter.clear()},reset:function(){this.p2&&this.p2.reset(),this.box2d&&this.box2d.reset(),this.matter&&this.matter.reset()},destroy:function(){this.p2&&this.p2.destroy(),this.box2d&&this.box2d.destroy(),this.matter&&this.matter.destroy(),this.arcade=null,this.ninja=null,this.p2=null,this.box2d=null,this.matter=null}},U.Physics.prototype.constructor=U.Physics,U.Physics.Arcade=function(t){this.game=t,this.gravity=new U.Point,this.bounds=new U.Rectangle(0,0,t.world.width,t.world.height),this.checkCollision={up:!0,down:!0,left:!0,right:!0},this.maxObjects=10,this.maxLevels=4,this.OVERLAP_BIAS=4,this.forceX=!1,this.sortDirection=U.Physics.Arcade.LEFT_RIGHT,this.skipQuadTree=!0,this.isPaused=!1,this.quadTree=new U.QuadTree(this.game.world.bounds.x,this.game.world.bounds.y,this.game.world.bounds.width,this.game.world.bounds.height,this.maxObjects,this.maxLevels),this._total=0,this.setBoundsToWorld()},U.Physics.Arcade.prototype.constructor=U.Physics.Arcade,U.Physics.Arcade.SORT_NONE=0,U.Physics.Arcade.LEFT_RIGHT=1,U.Physics.Arcade.RIGHT_LEFT=2,U.Physics.Arcade.TOP_BOTTOM=3,U.Physics.Arcade.BOTTOM_TOP=4,U.Physics.Arcade.prototype={setBounds:function(t,e,i,n){this.bounds.setTo(t,e,i,n)},setBoundsToWorld:function(){this.bounds.copyFrom(this.game.world.bounds)},enable:function(t,e){void 0===e&&(e=!0);var i=1;if(Array.isArray(t))for(i=t.length;i--;)t[i]instanceof U.Group?this.enable(t[i].children,e):(this.enableBody(t[i]),e&&t[i].hasOwnProperty("children")&&0<t[i].children.length&&this.enable(t[i],!0));else t instanceof U.Group?this.enable(t.children,e):(this.enableBody(t),e&&t.hasOwnProperty("children")&&0<t.children.length&&this.enable(t.children,!0))},enableBody:function(t){t.hasOwnProperty("body")&&null===t.body&&(t.body=new U.Physics.Arcade.Body(t),t.parent&&t.parent instanceof U.Group&&t.parent.addToHash(t))},updateMotion:function(t){var e=this.computeVelocity(0,t,t.angularVelocity,t.angularAcceleration,t.angularDrag,t.maxAngular)-t.angularVelocity;t.angularVelocity+=e,t.rotation+=t.angularVelocity*this.game.time.physicsElapsed,t.velocity.x=this.computeVelocity(1,t,t.velocity.x,t.acceleration.x,t.drag.x,t.maxVelocity.x),t.velocity.y=this.computeVelocity(2,t,t.velocity.y,t.acceleration.y,t.drag.y,t.maxVelocity.y)},computeVelocity:function(t,e,i,n,r,o){return 1===t&&e.allowGravity?i+=(this.gravity.x+e.gravity.x)*this.game.time.physicsElapsed:2===t&&e.allowGravity&&(i+=(this.gravity.y+e.gravity.y)*this.game.time.physicsElapsed),n?i+=n*this.game.time.physicsElapsed:r&&(0<i-(r*=this.game.time.physicsElapsed)?i-=r:i+r<0?i+=r:i=0),(o=void 0===o?1e4:o)<i?i=o:i<-o&&(i=-o),i},overlap:function(t,e,i,n,r){if(i=i||null,n=n||null,r=r||i,this._total=0,!Array.isArray(t)&&Array.isArray(e))for(var o=0;o<e.length;o++)this.collideHandler(t,e[o],i,n,r,!0);else if(Array.isArray(t)&&!Array.isArray(e))for(o=0;o<t.length;o++)this.collideHandler(t[o],e,i,n,r,!0);else if(Array.isArray(t)&&Array.isArray(e))for(o=0;o<t.length;o++)for(var s=0;s<e.length;s++)this.collideHandler(t[o],e[s],i,n,r,!0);else this.collideHandler(t,e,i,n,r,!0);return 0<this._total},collide:function(t,e,i,n,r){if(i=i||null,n=n||null,r=r||i,this._total=0,!Array.isArray(t)&&Array.isArray(e))for(var o=0;o<e.length;o++)this.collideHandler(t,e[o],i,n,r,!1);else if(Array.isArray(t)&&!Array.isArray(e))for(o=0;o<t.length;o++)this.collideHandler(t[o],e,i,n,r,!1);else if(Array.isArray(t)&&Array.isArray(e))for(o=0;o<t.length;o++)for(var s=0;s<e.length;s++)this.collideHandler(t[o],e[s],i,n,r,!1);else this.collideHandler(t,e,i,n,r,!1);return 0<this._total},sortLeftRight:function(t,e){return t.body&&e.body?t.body.x-e.body.x:0},sortRightLeft:function(t,e){return t.body&&e.body?e.body.x-t.body.x:0},sortTopBottom:function(t,e){return t.body&&e.body?t.body.y-e.body.y:0},sortBottomTop:function(t,e){return t.body&&e.body?e.body.y-t.body.y:0},sort:function(t,e){null!==t.physicsSortDirection?e=t.physicsSortDirection:void 0===e&&(e=this.sortDirection),e===U.Physics.Arcade.LEFT_RIGHT?t.hash.sort(this.sortLeftRight):e===U.Physics.Arcade.RIGHT_LEFT?t.hash.sort(this.sortRightLeft):e===U.Physics.Arcade.TOP_BOTTOM?t.hash.sort(this.sortTopBottom):e===U.Physics.Arcade.BOTTOM_TOP&&t.hash.sort(this.sortBottomTop)},collideHandler:function(t,e,i,n,r,o){if(void 0===e&&t.physicsType===U.GROUP)return this.sort(t),void this.collideGroupVsSelf(t,i,n,r,o);t&&e&&t.exists&&e.exists&&(this.sortDirection!==U.Physics.Arcade.SORT_NONE&&(t.physicsType===U.GROUP&&this.sort(t),e.physicsType===U.GROUP&&this.sort(e)),t.physicsType===U.SPRITE?e.physicsType===U.SPRITE?this.collideSpriteVsSprite(t,e,i,n,r,o):e.physicsType===U.GROUP?this.collideSpriteVsGroup(t,e,i,n,r,o):e.physicsType===U.TILEMAPLAYER&&this.collideSpriteVsTilemapLayer(t,e,i,n,r,o):t.physicsType===U.GROUP?e.physicsType===U.SPRITE?this.collideSpriteVsGroup(e,t,i,n,r,o):e.physicsType===U.GROUP?this.collideGroupVsGroup(t,e,i,n,r,o):e.physicsType===U.TILEMAPLAYER&&this.collideGroupVsTilemapLayer(t,e,i,n,r,o):t.physicsType===U.TILEMAPLAYER&&(e.physicsType===U.SPRITE?this.collideSpriteVsTilemapLayer(e,t,i,n,r,o):e.physicsType===U.GROUP&&this.collideGroupVsTilemapLayer(e,t,i,n,r,o)))},collideSpriteVsSprite:function(t,e,i,n,r,o){return!(!t.body||!e.body)&&(this.separate(t.body,e.body,n,r,o)&&(i&&i.call(r,t,e),this._total++),!0)},collideSpriteVsGroup:function(t,e,i,n,r,o){if(0!==e.length&&t.body)if(this.skipQuadTree||t.body.skipQuadTree)for(var s={},a=0;a<e.hash.length;a++){var h=e.hash[a];if(h&&h.exists&&h.body){if(s=h.body.getBounds(s),this.sortDirection===U.Physics.Arcade.LEFT_RIGHT){if(t.body.right<s.x)break;if(s.right<t.body.x)continue}else if(this.sortDirection===U.Physics.Arcade.RIGHT_LEFT){if(t.body.x>s.right)break;if(s.x>t.body.right)continue}else if(this.sortDirection===U.Physics.Arcade.TOP_BOTTOM){if(t.body.bottom<s.y)break;if(s.bottom<t.body.y)continue}else if(this.sortDirection===U.Physics.Arcade.BOTTOM_TOP){if(t.body.y>s.bottom)break;if(s.y>t.body.bottom)continue}this.collideSpriteVsSprite(t,h,i,n,r,o)}}else{this.quadTree.clear(),this.quadTree.reset(this.game.world.bounds.x,this.game.world.bounds.y,this.game.world.bounds.width,this.game.world.bounds.height,this.maxObjects,this.maxLevels),this.quadTree.populate(e);for(var l=this.quadTree.retrieve(t),a=0;a<l.length;a++)this.separate(t.body,l[a],n,r,o)&&(i&&i.call(r,t,l[a].sprite),this._total++)}},collideGroupVsSelf:function(t,e,i,n,r){if(0!==t.length)for(var o=0;o<t.hash.length;o++){var s={},a=t.hash[o];if(a&&a.exists&&a.body)for(var s=a.body.getBounds(s),h=o+1;h<t.hash.length;h++){var l={},p=t.hash[h];if(p&&p.exists&&p.body){if(l=p.body.getBounds(l),this.sortDirection===U.Physics.Arcade.LEFT_RIGHT){if(s.right<l.x)break;if(l.right<s.x)continue}else if(this.sortDirection===U.Physics.Arcade.RIGHT_LEFT){if(s.x>l.right)continue;if(l.x>s.right)break}else if(this.sortDirection===U.Physics.Arcade.TOP_BOTTOM){if(s.bottom<l.y)continue;if(l.bottom<s.y)break}else if(this.sortDirection===U.Physics.Arcade.BOTTOM_TOP){if(s.y>l.bottom)continue;if(l.y>a.body.bottom)break}this.collideSpriteVsSprite(a,p,e,i,n,r)}}}},collideGroupVsGroup:function(t,e,i,n,r,o){if(0!==t.length&&0!==e.length)for(var s=0;s<t.children.length;s++)t.children[s].exists&&(t.children[s].physicsType===U.GROUP?this.collideGroupVsGroup(t.children[s],e,i,n,r,o):this.collideSpriteVsGroup(t.children[s],e,i,n,r,o))},separate:function(t,e,i,n,r){if(!t.enable||!e.enable||t.checkCollision.none||e.checkCollision.none||!this.intersects(t,e))return!1;if(i&&!1===i.call(n,t.sprite,e.sprite))return!1;if(t.isCircle&&e.isCircle)return this.separateCircle(t,e,r);if(t.isCircle!==e.isCircle){var o=t.isCircle?e:t,s=t.isCircle?t:e,a=o.x,i=o.y,h=o.right,n=o.bottom,o=s.x+s.radius,s=s.y+s.radius;if((s<i||n<s)&&(o<a||h<o))return this.separateCircle(t,e,r)}h=!1,o=!1;this.forceX||Math.abs(this.gravity.y+t.gravity.y)<Math.abs(this.gravity.x+t.gravity.x)?(h=this.separateX(t,e,r),this.intersects(t,e)&&(o=this.separateY(t,e,r))):(o=this.separateY(t,e,r),this.intersects(t,e)&&(h=this.separateX(t,e,r)));o=h||o;return o&&(r?(t.onOverlap&&t.onOverlap.dispatch(t.sprite,e.sprite),e.onOverlap&&e.onOverlap.dispatch(e.sprite,t.sprite)):(t.onCollide&&t.onCollide.dispatch(t.sprite,e.sprite),e.onCollide&&e.onCollide.dispatch(e.sprite,t.sprite))),o},intersects:function(t,e){return t!==e&&(t.isCircle?e.isCircle?U.Math.distance(t.center.x,t.center.y,e.center.x,e.center.y)<=t.radius+e.radius:this.circleBodyIntersects(t,e):e.isCircle?this.circleBodyIntersects(e,t):!(t.right<=e.position.x)&&(!(t.bottom<=e.position.y)&&(!(t.position.x>=e.right)&&!(t.position.y>=e.bottom))))},circleBodyIntersects:function(t,e){var i=U.Math.clamp(t.center.x,e.left,e.right),e=U.Math.clamp(t.center.y,e.top,e.bottom);return(t.center.x-i)*(t.center.x-i)+(t.center.y-e)*(t.center.y-e)<=t.radius*t.radius},separateCircle:function(t,e,i){this.getOverlapX(t,e),this.getOverlapY(t,e);var n=e.center.x-t.center.x,r=e.center.y-t.center.y,o=Math.atan2(r,n),s=0;if(t.isCircle!==e.isCircle?(a={x:(e.isCircle?t:e).position.x,y:(e.isCircle?t:e).position.y,right:(e.isCircle?t:e).right,bottom:(e.isCircle?t:e).bottom},(h={x:t.isCircle?t.position.x+t.radius:e.position.x+e.radius,y:t.isCircle?t.position.y+t.radius:e.position.y+e.radius,radius:(t.isCircle?t:e).radius}).y<a.y?h.x<a.x?s=U.Math.distance(h.x,h.y,a.x,a.y)-h.radius:a.right<h.x&&(s=U.Math.distance(h.x,h.y,a.right,a.y)-h.radius):a.bottom<h.y&&(h.x<a.x?s=U.Math.distance(h.x,h.y,a.x,a.bottom)-h.radius:a.right<h.x&&(s=U.Math.distance(h.x,h.y,a.right,a.bottom)-h.radius)),s*=-1):s=t.radius+e.radius-U.Math.distance(t.center.x,t.center.y,e.center.x,e.center.y),i||0===s||t.immovable&&e.immovable||t.customSeparateX||e.customSeparateX)return 0!==s&&(t.onOverlap&&t.onOverlap.dispatch(t.sprite,e.sprite),e.onOverlap&&e.onOverlap.dispatch(e.sprite,t.sprite)),0!==s;var r=t.velocity.x*Math.cos(o)+t.velocity.y*Math.sin(o),n=t.velocity.x*Math.sin(o)-t.velocity.y*Math.cos(o),a=e.velocity.x*Math.cos(o)+e.velocity.y*Math.sin(o),h=e.velocity.x*Math.sin(o)-e.velocity.y*Math.cos(o),i=((t.mass-e.mass)*r+2*e.mass*a)/(t.mass+e.mass),a=(2*t.mass*r+(e.mass-t.mass)*a)/(t.mass+e.mass);return t.immovable||(t.velocity.x=(i*Math.cos(o)-n*Math.sin(o))*t.bounce.x,t.velocity.y=(n*Math.cos(o)+i*Math.sin(o))*t.bounce.y),e.immovable||(e.velocity.x=(a*Math.cos(o)-h*Math.sin(o))*e.bounce.x,e.velocity.y=(h*Math.cos(o)+a*Math.sin(o))*e.bounce.y),Math.abs(o)<Math.PI/2?0<t.velocity.x&&!t.immovable&&e.velocity.x>t.velocity.x?t.velocity.x*=-1:e.velocity.x<0&&!e.immovable&&t.velocity.x<e.velocity.x?e.velocity.x*=-1:0<t.velocity.y&&!t.immovable&&e.velocity.y>t.velocity.y?t.velocity.y*=-1:e.velocity.y<0&&!e.immovable&&t.velocity.y<e.velocity.y&&(e.velocity.y*=-1):Math.abs(o)>Math.PI/2&&(t.velocity.x<0&&!t.immovable&&e.velocity.x<t.velocity.x?t.velocity.x*=-1:0<e.velocity.x&&!e.immovable&&t.velocity.x>e.velocity.x?e.velocity.x*=-1:t.velocity.y<0&&!t.immovable&&e.velocity.y<t.velocity.y?t.velocity.y*=-1:0<e.velocity.y&&!e.immovable&&t.velocity.x>e.velocity.y&&(e.velocity.y*=-1)),t.immovable||(t.x+=t.velocity.x*this.game.time.physicsElapsed-s*Math.cos(o),t.y+=t.velocity.y*this.game.time.physicsElapsed-s*Math.sin(o)),e.immovable||(e.x+=e.velocity.x*this.game.time.physicsElapsed+s*Math.cos(o),e.y+=e.velocity.y*this.game.time.physicsElapsed+s*Math.sin(o)),t.onCollide&&t.onCollide.dispatch(t.sprite,e.sprite),e.onCollide&&e.onCollide.dispatch(e.sprite,t.sprite),!0},getOverlapX:function(t,e,i){var n=0,r=t.deltaAbsX()+e.deltaAbsX()+this.OVERLAP_BIAS;return 0===t.deltaX()&&0===e.deltaX()?(t.embedded=!0,e.embedded=!0):t.deltaX()>e.deltaX()?r<(n=t.right-e.x)&&!i||!1===t.checkCollision.right||!1===e.checkCollision.left?n=0:(t.touching.none=!1,t.touching.right=!0,e.touching.none=!1,e.touching.left=!0):t.deltaX()<e.deltaX()&&(r<-(n=t.x-e.width-e.x)&&!i||!1===t.checkCollision.left||!1===e.checkCollision.right?n=0:(t.touching.none=!1,t.touching.left=!0,e.touching.none=!1,e.touching.right=!0)),t.overlapX=n,e.overlapX=n},getOverlapY:function(t,e,i){var n=0,r=t.deltaAbsY()+e.deltaAbsY()+this.OVERLAP_BIAS;return 0===t.deltaY()&&0===e.deltaY()?(t.embedded=!0,e.embedded=!0):t.deltaY()>e.deltaY()?r<(n=t.bottom-e.y)&&!i||!1===t.checkCollision.down||!1===e.checkCollision.up?n=0:(t.touching.none=!1,t.touching.down=!0,e.touching.none=!1,e.touching.up=!0):t.deltaY()<e.deltaY()&&(r<-(n=t.y-e.bottom)&&!i||!1===t.checkCollision.up||!1===e.checkCollision.down?n=0:(t.touching.none=!1,t.touching.up=!0,e.touching.none=!1,e.touching.down=!0)),t.overlapY=n,e.overlapY=n},separateX:function(t,e,i){var n=this.getOverlapX(t,e,i);if(i||0===n||t.immovable&&e.immovable||t.customSeparateX||e.customSeparateX)return 0!==n||t.embedded&&e.embedded;var r=t.velocity.x,i=e.velocity.x;return t.immovable||e.immovable?t.immovable?(e.x+=n,e.velocity.x=r-i*e.bounce.x,t.moves&&(e.y+=(t.y-t.prev.y)*t.friction.y)):(t.x-=n,t.velocity.x=i-r*t.bounce.x,e.moves&&(t.y+=(e.y-e.prev.y)*e.friction.y)):(t.x-=n*=.5,e.x+=n,n=Math.sqrt(i*i*e.mass/t.mass)*(0<i?1:-1),i=Math.sqrt(r*r*t.mass/e.mass)*(0<r?1:-1),i-=r=.5*(n+i),t.velocity.x=r+(n-=r)*t.bounce.x,e.velocity.x=r+i*e.bounce.x),!0},separateY:function(t,e,i){var n=this.getOverlapY(t,e,i);if(i||0===n||t.immovable&&e.immovable||t.customSeparateY||e.customSeparateY)return 0!==n||t.embedded&&e.embedded;var r=t.velocity.y,i=e.velocity.y;return t.immovable||e.immovable?t.immovable?(e.y+=n,e.velocity.y=r-i*e.bounce.y,t.moves&&(e.x+=(t.x-t.prev.x)*t.friction.x)):(t.y-=n,t.velocity.y=i-r*t.bounce.y,e.moves&&(t.x+=(e.x-e.prev.x)*e.friction.x)):(t.y-=n*=.5,e.y+=n,n=Math.sqrt(i*i*e.mass/t.mass)*(0<i?1:-1),i=Math.sqrt(r*r*t.mass/e.mass)*(0<r?1:-1),i-=r=.5*(n+i),t.velocity.y=r+(n-=r)*t.bounce.y,e.velocity.y=r+i*e.bounce.y),!0},getObjectsUnderPointer:function(t,e,i,n){if(0!==e.length&&t.exists)return this.getObjectsAtLocation(t.x,t.y,e,i,n,t)},getObjectsAtLocation:function(t,e,i,n,r,o){this.quadTree.clear(),this.quadTree.reset(this.game.world.bounds.x,this.game.world.bounds.y,this.game.world.bounds.width,this.game.world.bounds.height,this.maxObjects,this.maxLevels),this.quadTree.populate(i);for(var i=new U.Rectangle(t,e,1,1),s=[],a=this.quadTree.retrieve(i),h=0;h<a.length;h++)a[h].hitTest(t,e)&&(n&&n.call(r,o,a[h].sprite),s.push(a[h].sprite));return s},moveToObject:function(t,e,i,n){void 0===i&&(i=60),void 0===n&&(n=0);var r=Math.atan2(e.y-t.y,e.x-t.x);return 0<n&&(i=this.distanceBetween(t,e)/(n/1e3)),t.body.velocity.x=Math.cos(r)*i,t.body.velocity.y=Math.sin(r)*i,r},moveToPointer:function(t,e,i,n){void 0===e&&(e=60),i=i||this.game.input.activePointer,void 0===n&&(n=0);var r=this.angleToPointer(t,i);return 0<n&&(e=this.distanceToPointer(t,i)/(n/1e3)),t.body.velocity.x=Math.cos(r)*e,t.body.velocity.y=Math.sin(r)*e,r},moveToXY:function(t,e,i,n,r){void 0===n&&(n=60),void 0===r&&(r=0);var o=Math.atan2(i-t.y,e-t.x);return 0<r&&(n=this.distanceToXY(t,e,i)/(r/1e3)),t.body.velocity.x=Math.cos(o)*n,t.body.velocity.y=Math.sin(o)*n,o},velocityFromAngle:function(t,e,i){return void 0===e&&(e=60),(i=i||new U.Point).setTo(Math.cos(this.game.math.degToRad(t))*e,Math.sin(this.game.math.degToRad(t))*e)},velocityFromRotation:function(t,e,i){return void 0===e&&(e=60),(i=i||new U.Point).setTo(Math.cos(t)*e,Math.sin(t)*e)},accelerationFromRotation:function(t,e,i){return void 0===e&&(e=60),(i=i||new U.Point).setTo(Math.cos(t)*e,Math.sin(t)*e)},accelerateToObject:function(t,e,i,n,r){void 0===i&&(i=60),void 0===n&&(n=1e3),void 0===r&&(r=1e3);e=this.angleBetween(t,e);return t.body.acceleration.setTo(Math.cos(e)*i,Math.sin(e)*i),t.body.maxVelocity.setTo(n,r),e},accelerateToPointer:function(t,e,i,n,r){void 0===i&&(i=60),void 0===e&&(e=this.game.input.activePointer),void 0===n&&(n=1e3),void 0===r&&(r=1e3);e=this.angleToPointer(t,e);return t.body.acceleration.setTo(Math.cos(e)*i,Math.sin(e)*i),t.body.maxVelocity.setTo(n,r),e},accelerateToXY:function(t,e,i,n,r,o){void 0===n&&(n=60),void 0===r&&(r=1e3),void 0===o&&(o=1e3);i=this.angleToXY(t,e,i);return t.body.acceleration.setTo(Math.cos(i)*n,Math.sin(i)*n),t.body.maxVelocity.setTo(r,o),i},distanceBetween:function(t,e,i){var n=(i=void 0===i?!1:i)?t.world.x-e.world.x:t.x-e.x,e=i?t.world.y-e.world.y:t.y-e.y;return Math.sqrt(n*n+e*e)},distanceToXY:function(t,e,i,n){e=(n=void 0===n?!1:n)?t.world.x-e:t.x-e,i=n?t.world.y-i:t.y-i;return Math.sqrt(e*e+i*i)},distanceToPointer:function(t,e,i){void 0===e&&(e=this.game.input.activePointer);var n=(i=void 0===i?!1:i)?t.world.x-e.worldX:t.x-e.worldX,e=i?t.world.y-e.worldY:t.y-e.worldY;return Math.sqrt(n*n+e*e)},angleBetween:function(t,e,i){return(i=void 0===i?!1:i)?Math.atan2(e.world.y-t.world.y,e.world.x-t.world.x):Math.atan2(e.y-t.y,e.x-t.x)},angleBetweenCenters:function(t,e){var i=e.centerX-t.centerX,t=e.centerY-t.centerY;return Math.atan2(t,i)},angleToXY:function(t,e,i,n){return(n=void 0===n?!1:n)?Math.atan2(i-t.world.y,e-t.world.x):Math.atan2(i-t.y,e-t.x)},angleToPointer:function(t,e,i){return void 0===e&&(e=this.game.input.activePointer),(i=void 0===i?!1:i)?Math.atan2(e.worldY-t.world.y,e.worldX-t.world.x):Math.atan2(e.worldY-t.y,e.worldX-t.x)},worldAngleToPointer:function(t,e){return this.angleToPointer(t,e,!0)}},U.Physics.Arcade.Body=function(t){this.sprite=t,this.game=t.game,this.type=U.Physics.ARCADE,this.enable=!0,this.isCircle=!1,this.radius=0,this.offset=new U.Point,this.position=new U.Point(t.x,t.y),this.prev=new U.Point(this.position.x,this.position.y),this.allowRotation=!0,this.rotation=t.angle,this.preRotation=t.angle,this.width=t.width,this.height=t.height,this.sourceWidth=t.width,this.sourceHeight=t.height,t.texture&&(this.sourceWidth=t.texture.frame.width,this.sourceHeight=t.texture.frame.height),this.halfWidth=Math.abs(t.width/2),this.halfHeight=Math.abs(t.height/2),this.center=new U.Point(t.x+this.halfWidth,t.y+this.halfHeight),this.velocity=new U.Point,this.newVelocity=new U.Point,this.deltaMax=new U.Point,this.acceleration=new U.Point,this.drag=new U.Point,this.allowGravity=!0,this.gravity=new U.Point,this.bounce=new U.Point,this.worldBounce=null,this.onWorldBounds=null,this.onCollide=null,this.onOverlap=null,this.maxVelocity=new U.Point(1e4,1e4),this.friction=new U.Point(1,0),this.angularVelocity=0,this.angularAcceleration=0,this.angularDrag=0,this.maxAngular=1e3,this.mass=1,this.angle=0,this.speed=0,this.facing=U.NONE,this.immovable=!1,this.moves=!0,this.customSeparateX=!1,this.customSeparateY=!1,this.overlapX=0,this.overlapY=0,this.overlapR=0,this.embedded=!1,this.collideWorldBounds=!1,this.checkCollision={none:!1,any:!0,up:!0,down:!0,left:!0,right:!0},this.touching={none:!0,up:!1,down:!1,left:!1,right:!1},this.wasTouching={none:!0,up:!1,down:!1,left:!1,right:!1},this.blocked={up:!1,down:!1,left:!1,right:!1},this.tilePadding=new U.Point,this.dirty=!1,this.skipQuadTree=!1,this.syncBounds=!1,this.isMoving=!1,this.stopVelocityOnCollide=!0,this.moveTimer=0,this.moveDistance=0,this.moveDuration=0,this.moveTarget=null,this.moveEnd=null,this.onMoveComplete=new U.Signal,this.movementCallback=null,this.movementCallbackContext=null,this._reset=!0,this._sx=t.scale.x,this._sy=t.scale.y,this._dx=0,this._dy=0},U.Physics.Arcade.Body.prototype={updateBounds:function(){var t,e;this.syncBounds?((e=this.sprite.getBounds()).ceilAll(),e.width===this.width&&e.height===this.height||(this.width=e.width,this.height=e.height,this._reset=!0)):(t=Math.abs(this.sprite.scale.x),e=Math.abs(this.sprite.scale.y),t===this._sx&&e===this._sy||(this.width=this.sourceWidth*t,this.height=this.sourceHeight*e,this._sx=t,this._sy=e,this._reset=!0)),this._reset&&(this.halfWidth=Math.floor(this.width/2),this.halfHeight=Math.floor(this.height/2),this.center.setTo(this.position.x+this.halfWidth,this.position.y+this.halfHeight))},preUpdate:function(){this.enable&&!this.game.physics.arcade.isPaused&&(this.dirty=!0,this.wasTouching.none=this.touching.none,this.wasTouching.up=this.touching.up,this.wasTouching.down=this.touching.down,this.wasTouching.left=this.touching.left,this.wasTouching.right=this.touching.right,this.touching.none=!0,this.touching.up=!1,this.touching.down=!1,this.touching.left=!1,this.touching.right=!1,this.blocked.up=!1,this.blocked.down=!1,this.blocked.left=!1,this.blocked.right=!1,this.embedded=!1,this.updateBounds(),this.position.x=this.sprite.world.x-this.sprite.anchor.x*this.sprite.width+this.sprite.scale.x*this.offset.x,this.position.x-=this.sprite.scale.x<0?this.width:0,this.position.y=this.sprite.world.y-this.sprite.anchor.y*this.sprite.height+this.sprite.scale.y*this.offset.y,this.position.y-=this.sprite.scale.y<0?this.height:0,this.rotation=this.sprite.angle,this.preRotation=this.rotation,(this._reset||this.sprite.fresh)&&(this.prev.x=this.position.x,this.prev.y=this.position.y),this.moves&&(this.game.physics.arcade.updateMotion(this),this.newVelocity.set(this.velocity.x*this.game.time.physicsElapsed,this.velocity.y*this.game.time.physicsElapsed),this.position.x+=this.newVelocity.x,this.position.y+=this.newVelocity.y,this.position.x===this.prev.x&&this.position.y===this.prev.y||(this.angle=Math.atan2(this.velocity.y,this.velocity.x)),this.speed=Math.sqrt(this.velocity.x*this.velocity.x+this.velocity.y*this.velocity.y),this.collideWorldBounds&&this.checkWorldBounds()&&this.onWorldBounds&&this.onWorldBounds.dispatch(this.sprite,this.blocked.up,this.blocked.down,this.blocked.left,this.blocked.right)),this._dx=this.deltaX(),this._dy=this.deltaY(),this._reset=!1)},updateMovement:function(){var t,e=0,i=0!==this.overlapX||0!==this.overlapY,e=0<this.moveDuration?(this.moveTimer+=this.game.time.elapsedMS,this.moveTimer/this.moveDuration):(this.moveTarget.end.set(this.position.x,this.position.y),this.moveTarget.length/this.moveDistance);return this.movementCallback&&(t=this.movementCallback.call(this.movementCallbackContext,this,this.velocity,e)),!(i||1<=e||void 0!==t&&!0!==t)||(this.stopMovement(1<=e||this.stopVelocityOnCollide&&i),!1)},stopMovement:function(t){this.isMoving&&(this.isMoving=!1,t&&this.velocity.set(0),this.onMoveComplete.dispatch(this.sprite,0!==this.overlapX||0!==this.overlapY))},postUpdate:function(){this.enable&&this.dirty&&(this.isMoving&&this.updateMovement(),this.dirty=!1,this.deltaX()<0?this.facing=U.LEFT:0<this.deltaX()&&(this.facing=U.RIGHT),this.deltaY()<0?this.facing=U.UP:0<this.deltaY()&&(this.facing=U.DOWN),this.moves&&(this._dx=this.deltaX(),this._dy=this.deltaY(),0!==this.deltaMax.x&&0!==this._dx&&(this._dx<0&&this._dx<-this.deltaMax.x?this._dx=-this.deltaMax.x:0<this._dx&&this._dx>this.deltaMax.x&&(this._dx=this.deltaMax.x)),0!==this.deltaMax.y&&0!==this._dy&&(this._dy<0&&this._dy<-this.deltaMax.y?this._dy=-this.deltaMax.y:0<this._dy&&this._dy>this.deltaMax.y&&(this._dy=this.deltaMax.y)),this.sprite.position.x+=this._dx,this.sprite.position.y+=this._dy,this._reset=!0),this.center.setTo(this.position.x+this.halfWidth,this.position.y+this.halfHeight),this.allowRotation&&(this.sprite.angle+=this.deltaZ()),this.prev.x=this.position.x,this.prev.y=this.position.y)},checkWorldBounds:function(){var t,e,i,n,r=this.position,o=this.game.physics.arcade.bounds,s=this.game.physics.arcade.checkCollision,a=this.worldBounce?-this.worldBounce.x:-this.bounce.x,h=this.worldBounce?-this.worldBounce.y:-this.bounce.y;return this.isCircle?(t=this.center.x-this.radius,e=this.center.y-this.radius,i=this.center.x+this.radius,n=this.center.y+this.radius,t<o.x&&s.left?(r.x=o.x-this.halfWidth+this.radius,this.velocity.x*=a,this.blocked.left=!0):i>o.right&&s.right&&(r.x=o.right-this.halfWidth-this.radius,this.velocity.x*=a,this.blocked.right=!0),e<o.y&&s.up?(r.y=o.y-this.halfHeight+this.radius,this.velocity.y*=h,this.blocked.up=!0):n>o.bottom&&s.down&&(r.y=o.bottom-this.halfHeight-this.radius,this.velocity.y*=h,this.blocked.down=!0)):(r.x<o.x&&s.left?(r.x=o.x,this.velocity.x*=a,this.blocked.left=!0):this.right>o.right&&s.right&&(r.x=o.right-this.width,this.velocity.x*=a,this.blocked.right=!0),r.y<o.y&&s.up?(r.y=o.y,this.velocity.y*=h,this.blocked.up=!0):this.bottom>o.bottom&&s.down&&(r.y=o.bottom-this.height,this.velocity.y*=h,this.blocked.down=!0)),this.blocked.up||this.blocked.down||this.blocked.left||this.blocked.right},moveFrom:function(t,e,i){return 0!==(e=void 0===e?this.speed:e)&&(void 0===i?(n=this.angle,i=this.game.math.radToDeg(n)):n=this.game.math.degToRad(i),this.moveTimer=0,this.moveDuration=t,0===i||180===i?this.velocity.set(Math.cos(n)*e,0):90===i||270===i?this.velocity.set(0,Math.sin(n)*e):this.velocity.set(Math.cos(n)*e,Math.sin(n)*e),this.isMoving=!0);var n},moveTo:function(t,e,i){var n,t=e/(t/1e3);return 0!=t&&(void 0===i?(n=this.angle,i=this.game.math.radToDeg(n)):n=this.game.math.degToRad(i),e=Math.abs(e),this.moveDuration=0,this.moveDistance=e,null===this.moveTarget&&(this.moveTarget=new U.Line,this.moveEnd=new U.Point),this.moveTarget.fromAngle(this.x,this.y,n,e),this.moveEnd.set(this.moveTarget.end.x,this.moveTarget.end.y),this.moveTarget.setTo(this.x,this.y,this.x,this.y),0===i||180===i?this.velocity.set(Math.cos(n)*t,0):90===i||270===i?this.velocity.set(0,Math.sin(n)*t):this.velocity.set(Math.cos(n)*t,Math.sin(n)*t),this.isMoving=!0)},setSize:function(t,e,i,n){void 0===i&&(i=this.offset.x),void 0===n&&(n=this.offset.y),this.sourceWidth=t,this.sourceHeight=e,this.width=this.sourceWidth*this._sx,this.height=this.sourceHeight*this._sy,this.halfWidth=Math.floor(this.width/2),this.halfHeight=Math.floor(this.height/2),this.offset.setTo(i,n),this.center.setTo(this.position.x+this.halfWidth,this.position.y+this.halfHeight),this.isCircle=!1,this.radius=0},setCircle:function(t,e,i){void 0===e&&(e=this.offset.x),void 0===i&&(i=this.offset.y),0<t?(this.isCircle=!0,this.radius=t,this.sourceWidth=2*t,this.sourceHeight=2*t,this.width=this.sourceWidth*this._sx,this.height=this.sourceHeight*this._sy,this.halfWidth=Math.floor(this.width/2),this.halfHeight=Math.floor(this.height/2),this.offset.setTo(e,i),this.center.setTo(this.position.x+this.halfWidth,this.position.y+this.halfHeight)):this.isCircle=!1},reset:function(t,e){this.velocity.set(0),this.acceleration.set(0),this.speed=0,this.angularVelocity=0,this.angularAcceleration=0,this.position.x=t-this.sprite.anchor.x*this.sprite.width+this.sprite.scale.x*this.offset.x,this.position.x-=this.sprite.scale.x<0?this.width:0,this.position.y=e-this.sprite.anchor.y*this.sprite.height+this.sprite.scale.y*this.offset.y,this.position.y-=this.sprite.scale.y<0?this.height:0,this.prev.x=this.position.x,this.prev.y=this.position.y,this.rotation=this.sprite.angle,this.preRotation=this.rotation,this._sx=this.sprite.scale.x,this._sy=this.sprite.scale.y,this.center.setTo(this.position.x+this.halfWidth,this.position.y+this.halfHeight)},getBounds:function(t){return this.isCircle?(t.x=this.center.x-this.radius,t.y=this.center.y-this.radius,t.right=this.center.x+this.radius,t.bottom=this.center.y+this.radius):(t.x=this.x,t.y=this.y,t.right=this.right,t.bottom=this.bottom),t},hitTest:function(t,e){return(this.isCircle?U.Circle:U.Rectangle).contains(this,t,e)},onFloor:function(){return this.blocked.down},onCeiling:function(){return this.blocked.up},onWall:function(){return this.blocked.left||this.blocked.right},deltaAbsX:function(){return 0<this.deltaX()?this.deltaX():-this.deltaX()},deltaAbsY:function(){return 0<this.deltaY()?this.deltaY():-this.deltaY()},deltaX:function(){return this.position.x-this.prev.x},deltaY:function(){return this.position.y-this.prev.y},deltaZ:function(){return this.rotation-this.preRotation},destroy:function(){this.sprite.parent&&this.sprite.parent instanceof U.Group&&this.sprite.parent.removeFromHash(this.sprite),this.sprite.body=null,this.sprite=null}},Object.defineProperty(U.Physics.Arcade.Body.prototype,"left",{get:function(){return this.position.x}}),Object.defineProperty(U.Physics.Arcade.Body.prototype,"right",{get:function(){return this.position.x+this.width}}),Object.defineProperty(U.Physics.Arcade.Body.prototype,"top",{get:function(){return this.position.y}}),Object.defineProperty(U.Physics.Arcade.Body.prototype,"bottom",{get:function(){return this.position.y+this.height}}),Object.defineProperty(U.Physics.Arcade.Body.prototype,"x",{get:function(){return this.position.x},set:function(t){this.position.x=t}}),Object.defineProperty(U.Physics.Arcade.Body.prototype,"y",{get:function(){return this.position.y},set:function(t){this.position.y=t}}),U.Physics.Arcade.Body.render=function(t,e,i,n){void 0===n&&(n=!0),t.fillStyle=i=i||"rgba(0,255,0,0.4)",t.strokeStyle=i,e.isCircle?(t.beginPath(),t.arc(e.center.x-e.game.camera.x,e.center.y-e.game.camera.y,e.radius,0,2*Math.PI),n?t.fill():t.stroke()):n?t.fillRect(e.position.x-e.game.camera.x,e.position.y-e.game.camera.y,e.width,e.height):t.strokeRect(e.position.x-e.game.camera.x,e.position.y-e.game.camera.y,e.width,e.height)},U.Physics.Arcade.Body.renderBodyInfo=function(t,e){t.line("x: "+e.x.toFixed(2),"y: "+e.y.toFixed(2),"width: "+e.width,"height: "+e.height),t.line("velocity x: "+e.velocity.x.toFixed(2),"y: "+e.velocity.y.toFixed(2),"deltaX: "+e._dx.toFixed(2),"deltaY: "+e._dy.toFixed(2)),t.line("acceleration x: "+e.acceleration.x.toFixed(2),"y: "+e.acceleration.y.toFixed(2),"speed: "+e.speed.toFixed(2),"angle: "+e.angle.toFixed(2)),t.line("gravity x: "+e.gravity.x,"y: "+e.gravity.y,"bounce x: "+e.bounce.x.toFixed(2),"y: "+e.bounce.y.toFixed(2)),t.line("touching left: "+e.touching.left,"right: "+e.touching.right,"up: "+e.touching.up,"down: "+e.touching.down),t.line("blocked left: "+e.blocked.left,"right: "+e.blocked.right,"up: "+e.blocked.up,"down: "+e.blocked.down)},U.Physics.Arcade.Body.prototype.constructor=U.Physics.Arcade.Body,U.Physics.Arcade.TilemapCollision=function(){},U.Physics.Arcade.TilemapCollision.prototype={TILE_BIAS:16,collideSpriteVsTilemapLayer:function(t,e,i,n,r,o){if(t.body){var s=e.getTiles(t.body.position.x-t.body.tilePadding.x,t.body.position.y-t.body.tilePadding.y,t.body.width+t.body.tilePadding.x,t.body.height+t.body.tilePadding.y,!1,!1);if(0!==s.length)for(var a=0;a<s.length;a++)n?n.call(r,t,s[a])&&this.separateTile(a,t.body,s[a],e,o)&&(this._total++,i&&i.call(r,t,s[a])):this.separateTile(a,t.body,s[a],e,o)&&(this._total++,i&&i.call(r,t,s[a]))}},collideGroupVsTilemapLayer:function(t,e,i,n,r,o){if(0!==t.length)for(var s=0;s<t.children.length;s++)t.children[s].exists&&this.collideSpriteVsTilemapLayer(t.children[s],e,i,n,r,o)},separateTile:function(t,e,i,n,r){if(!e.enable)return!1;var o=n.fixedToCamera?0:n.position.x,s=n.fixedToCamera?0:n.position.y;if(!i.intersects(e.position.x-o,e.position.y-s,e.right-o,e.bottom-s))return!1;if(r)return!0;if(i.collisionCallback&&!i.collisionCallback.call(i.collisionCallbackContext,e.sprite,i))return!1;if(void 0!==i.layer.callbacks&&i.layer.callbacks[i.index]&&!i.layer.callbacks[i.index].callback.call(i.layer.callbacks[i.index].callbackContext,e.sprite,i))return!1;if(!(i.faceLeft||i.faceRight||i.faceTop||i.faceBottom))return!1;var a=0,h=0,l=0,r=1;if(e.deltaAbsX()>e.deltaAbsY()?l=-1:e.deltaAbsX()<e.deltaAbsY()&&(r=-1),0!==e.deltaX()&&0!==e.deltaY()&&(i.faceLeft||i.faceRight)&&(i.faceTop||i.faceBottom)&&(l=Math.min(Math.abs(e.position.x-o-i.right),Math.abs(e.right-o-i.left)),r=Math.min(Math.abs(e.position.y-s-i.bottom),Math.abs(e.bottom-s-i.top))),l<r){if((i.faceLeft||i.faceRight)&&0!==(a=this.tileCheckX(e,i,n))&&!i.intersects(e.position.x-o,e.position.y-s,e.right-o,e.bottom-s))return!0;(i.faceTop||i.faceBottom)&&(h=this.tileCheckY(e,i,n))}else{if((i.faceTop||i.faceBottom)&&0!==(h=this.tileCheckY(e,i,n))&&!i.intersects(e.position.x-o,e.position.y-s,e.right-o,e.bottom-s))return!0;(i.faceLeft||i.faceRight)&&(a=this.tileCheckX(e,i,n))}return 0!==a||0!==h},tileCheckX:function(t,e,i){var n=0,i=i.fixedToCamera?0:i.position.x;return t.deltaX()<0&&!t.blocked.left&&e.collideRight&&t.checkCollision.left?e.faceRight&&t.x-i<e.right&&(n=t.x-i-e.right)<-this.TILE_BIAS&&(n=0):0<t.deltaX()&&!t.blocked.right&&e.collideLeft&&t.checkCollision.right&&e.faceLeft&&t.right-i>e.left&&(n=t.right-i-e.left)>this.TILE_BIAS&&(n=0),0!==n&&(t.customSeparateX?t.overlapX=n:this.processTileSeparationX(t,n)),n},tileCheckY:function(t,e,i){var n=0,i=i.fixedToCamera?0:i.position.y;return t.deltaY()<0&&!t.blocked.up&&e.collideDown&&t.checkCollision.up?e.faceBottom&&t.y-i<e.bottom&&(n=t.y-i-e.bottom)<-this.TILE_BIAS&&(n=0):0<t.deltaY()&&!t.blocked.down&&e.collideUp&&t.checkCollision.down&&e.faceTop&&t.bottom-i>e.top&&(n=t.bottom-i-e.top)>this.TILE_BIAS&&(n=0),0!==n&&(t.customSeparateY?t.overlapY=n:this.processTileSeparationY(t,n)),n},processTileSeparationX:function(t,e){e<0?t.blocked.left=!0:0<e&&(t.blocked.right=!0),t.position.x-=e,0===t.bounce.x?t.velocity.x=0:t.velocity.x=-t.velocity.x*t.bounce.x},processTileSeparationY:function(t,e){e<0?t.blocked.up=!0:0<e&&(t.blocked.down=!0),t.position.y-=e,0===t.bounce.y?t.velocity.y=0:t.velocity.y=-t.velocity.y*t.bounce.y}},U.Utils.mixinPrototype(U.Physics.Arcade.prototype,U.Physics.Arcade.TilemapCollision.prototype),p2.Body.prototype.parent=null,p2.Spring.prototype.parent=null,U.Physics.P2=function(t,e){this.game=t,void 0===e?e={gravity:[0,0],broadphase:new p2.SAPBroadphase}:(e.hasOwnProperty("gravity")||(e.gravity=[0,0]),e.hasOwnProperty("broadphase")||(e.broadphase=new p2.SAPBroadphase)),this.config=e,this.world=new p2.World(this.config),this.frameRate=1/60,this.useElapsedTime=!1,this.paused=!1,this.materials=[],this.gravity=new U.Physics.P2.InversePointProxy(this,this.world.gravity),this.walls={left:null,right:null,top:null,bottom:null},this.onBodyAdded=new U.Signal,this.onBodyRemoved=new U.Signal,this.onSpringAdded=new U.Signal,this.onSpringRemoved=new U.Signal,this.onConstraintAdded=new U.Signal,this.onConstraintRemoved=new U.Signal,this.onContactMaterialAdded=new U.Signal,this.onContactMaterialRemoved=new U.Signal,this.postBroadphaseCallback=null,this.callbackContext=null,this.onBeginContact=new U.Signal,this.onEndContact=new U.Signal,e.hasOwnProperty("mpx")&&e.hasOwnProperty("pxm")&&e.hasOwnProperty("mpxi")&&e.hasOwnProperty("pxmi")&&(this.mpx=e.mpx,this.mpxi=e.mpxi,this.pxm=e.pxm,this.pxmi=e.pxmi),this.world.on("beginContact",this.beginContactHandler,this),this.world.on("endContact",this.endContactHandler,this),this.collisionGroups=[],this.nothingCollisionGroup=new U.Physics.P2.CollisionGroup(1),this.boundsCollisionGroup=new U.Physics.P2.CollisionGroup(2),this.everythingCollisionGroup=new U.Physics.P2.CollisionGroup(2147483648),this.boundsCollidesWith=[],this._toRemove=[],this._collisionGroupID=2,this._boundsLeft=!0,this._boundsRight=!0,this._boundsTop=!0,this._boundsBottom=!0,this._boundsOwnGroup=!1,this.setBoundsToWorld(!0,!0,!0,!0,!1)},U.Physics.P2.prototype={removeBodyNextStep:function(t){this._toRemove.push(t)},preUpdate:function(){for(var t=this._toRemove.length;t--;)this.removeBody(this._toRemove[t]);this._toRemove.length=0},enable:function(t,e,i){void 0===e&&(e=!1),void 0===i&&(i=!0);var n=1;if(Array.isArray(t))for(n=t.length;n--;)t[n]instanceof U.Group?this.enable(t[n].children,e,i):(this.enableBody(t[n],e),i&&t[n].hasOwnProperty("children")&&0<t[n].children.length&&this.enable(t[n],e,!0));else t instanceof U.Group?this.enable(t.children,e,i):(this.enableBody(t,e),i&&t.hasOwnProperty("children")&&0<t.children.length&&this.enable(t.children,e,!0))},enableBody:function(t,e){t.hasOwnProperty("body")&&null===t.body&&(t.body=new U.Physics.P2.Body(this.game,t,t.x,t.y,1),t.body.debug=e,void 0!==t.anchor&&t.anchor.set(.5))},setImpactEvents:function(t){t?this.world.on("impact",this.impactHandler,this):this.world.off("impact",this.impactHandler,this)},setPostBroadphaseCallback:function(t,e){this.postBroadphaseCallback=t,this.callbackContext=e,null!==t?this.world.on("postBroadphase",this.postBroadphaseHandler,this):this.world.off("postBroadphase",this.postBroadphaseHandler,this)},postBroadphaseHandler:function(t){if(this.postBroadphaseCallback&&0!==t.pairs.length)for(var e=t.pairs.length-2;0<=e;e-=2)t.pairs[e].parent&&t.pairs[e+1].parent&&!this.postBroadphaseCallback.call(this.callbackContext,t.pairs[e].parent,t.pairs[e+1].parent)&&t.pairs.splice(e,2)},impactHandler:function(t){var e,i;t.bodyA.parent&&t.bodyB.parent&&(e=t.bodyA.parent,i=t.bodyB.parent,e._bodyCallbacks[t.bodyB.id]&&e._bodyCallbacks[t.bodyB.id].call(e._bodyCallbackContext[t.bodyB.id],e,i,t.shapeA,t.shapeB),i._bodyCallbacks[t.bodyA.id]&&i._bodyCallbacks[t.bodyA.id].call(i._bodyCallbackContext[t.bodyA.id],i,e,t.shapeB,t.shapeA),e._groupCallbacks[t.shapeB.collisionGroup]&&e._groupCallbacks[t.shapeB.collisionGroup].call(e._groupCallbackContext[t.shapeB.collisionGroup],e,i,t.shapeA,t.shapeB),i._groupCallbacks[t.shapeA.collisionGroup]&&i._groupCallbacks[t.shapeA.collisionGroup].call(i._groupCallbackContext[t.shapeA.collisionGroup],i,e,t.shapeB,t.shapeA))},beginContactHandler:function(t){t.bodyA&&t.bodyB&&(this.onBeginContact.dispatch(t.bodyA,t.bodyB,t.shapeA,t.shapeB,t.contactEquations),t.bodyA.parent&&t.bodyA.parent.onBeginContact.dispatch(t.bodyB.parent,t.bodyB,t.shapeA,t.shapeB,t.contactEquations),t.bodyB.parent&&t.bodyB.parent.onBeginContact.dispatch(t.bodyA.parent,t.bodyA,t.shapeB,t.shapeA,t.contactEquations))},endContactHandler:function(t){t.bodyA&&t.bodyB&&(this.onEndContact.dispatch(t.bodyA,t.bodyB,t.shapeA,t.shapeB),t.bodyA.parent&&t.bodyA.parent.onEndContact.dispatch(t.bodyB.parent,t.bodyB,t.shapeA,t.shapeB),t.bodyB.parent&&t.bodyB.parent.onEndContact.dispatch(t.bodyA.parent,t.bodyA,t.shapeB,t.shapeA))},setBoundsToWorld:function(t,e,i,n,r){this.setBounds(this.game.world.bounds.x,this.game.world.bounds.y,this.game.world.bounds.width,this.game.world.bounds.height,t,e,i,n,r)},setWorldMaterial:function(t,e,i,n,r){void 0===i&&(i=!0),void 0===n&&(n=!0),void 0===r&&(r=!0),(e=void 0===e?!0:e)&&this.walls.left&&(this.walls.left.shapes[0].material=t),i&&this.walls.right&&(this.walls.right.shapes[0].material=t),n&&this.walls.top&&(this.walls.top.shapes[0].material=t),r&&this.walls.bottom&&(this.walls.bottom.shapes[0].material=t)},updateBoundsCollisionGroup:function(t){var e=((t=void 0===t?!0:t)?this.boundsCollisionGroup:this.everythingCollisionGroup).mask;this.walls.left&&(this.walls.left.shapes[0].collisionGroup=e),this.walls.right&&(this.walls.right.shapes[0].collisionGroup=e),this.walls.top&&(this.walls.top.shapes[0].collisionGroup=e),this.walls.bottom&&(this.walls.bottom.shapes[0].collisionGroup=e),this._boundsOwnGroup=t},setBounds:function(t,e,i,n,r,o,s,a,h){void 0===r&&(r=this._boundsLeft),void 0===o&&(o=this._boundsRight),void 0===s&&(s=this._boundsTop),void 0===a&&(a=this._boundsBottom),void 0===h&&(h=this._boundsOwnGroup),this.setupWall(r,"left",t,e,1.5707963267948966,h),this.setupWall(o,"right",t+i,e,-1.5707963267948966,h),this.setupWall(s,"top",t,e,-3.141592653589793,h),this.setupWall(a,"bottom",t,e+n,0,h),this._boundsLeft=r,this._boundsRight=o,this._boundsTop=s,this._boundsBottom=a,this._boundsOwnGroup=h},setupWall:function(t,e,i,n,r,o){t?(this.walls[e]?this.walls[e].position=[this.pxmi(i),this.pxmi(n)]:(this.walls[e]=new p2.Body({mass:0,position:[this.pxmi(i),this.pxmi(n)],angle:r}),this.walls[e].addShape(new p2.Plane),this.world.addBody(this.walls[e])),o&&(this.walls[e].shapes[0].collisionGroup=this.boundsCollisionGroup.mask)):this.walls[e]&&(this.world.removeBody(this.walls[e]),this.walls[e]=null)},pause:function(){this.paused=!0},resume:function(){this.paused=!1},update:function(){this.paused||(this.useElapsedTime?this.world.step(this.game.time.physicsElapsed):this.world.step(this.frameRate))},reset:function(){this.world.on("beginContact",this.beginContactHandler,this),this.world.on("endContact",this.endContactHandler,this),this.nothingCollisionGroup=new U.Physics.P2.CollisionGroup(1),this.boundsCollisionGroup=new U.Physics.P2.CollisionGroup(2),this.everythingCollisionGroup=new U.Physics.P2.CollisionGroup(2147483648),this._collisionGroupID=2,this.setBoundsToWorld(!0,!0,!0,!0,!1)},clear:function(){this.world.time=0,this.world.fixedStepTime=0,this.world.solver&&this.world.solver.equations.length&&this.world.solver.removeAllEquations();for(var t=this.world.constraints,e=t.length-1;0<=e;e--)this.world.removeConstraint(t[e]);for(var i=this.world.bodies,e=i.length-1;0<=e;e--)this.world.removeBody(i[e]);for(var n=this.world.springs,e=n.length-1;0<=e;e--)this.world.removeSpring(n[e]);for(var r=this.world.contactMaterials,e=r.length-1;0<=e;e--)this.world.removeContactMaterial(r[e]);this.world.off("beginContact",this.beginContactHandler,this),this.world.off("endContact",this.endContactHandler,this),this.postBroadphaseCallback=null,this.callbackContext=null,this.impactCallback=null,this.collisionGroups=[],this._toRemove=[],this.boundsCollidesWith=[],this.walls={left:null,right:null,top:null,bottom:null}},destroy:function(){this.clear(),this.game=null},addBody:function(t){return!t.data.world&&(this.world.addBody(t.data),this.onBodyAdded.dispatch(t),!0)},removeBody:function(t){return t.data.world===this.world&&(this.world.removeBody(t.data),this.onBodyRemoved.dispatch(t)),t},addSpring:function(t){return t instanceof U.Physics.P2.Spring||t instanceof U.Physics.P2.RotationalSpring?this.world.addSpring(t.data):this.world.addSpring(t),this.onSpringAdded.dispatch(t),t},removeSpring:function(t){return t instanceof U.Physics.P2.Spring||t instanceof U.Physics.P2.RotationalSpring?this.world.removeSpring(t.data):this.world.removeSpring(t),this.onSpringRemoved.dispatch(t),t},createDistanceConstraint:function(t,e,i,n,r,o){if(t=this.getBody(t),e=this.getBody(e),t&&e)return this.addConstraint(new U.Physics.P2.DistanceConstraint(this,t,e,i,n,r,o))},createGearConstraint:function(t,e,i,n){if(t=this.getBody(t),e=this.getBody(e),t&&e)return this.addConstraint(new U.Physics.P2.GearConstraint(this,t,e,i,n))},createRevoluteConstraint:function(t,e,i,n,r,o){if(t=this.getBody(t),i=this.getBody(i),t&&i)return this.addConstraint(new U.Physics.P2.RevoluteConstraint(this,t,e,i,n,r,o))},createLockConstraint:function(t,e,i,n,r){if(t=this.getBody(t),e=this.getBody(e),t&&e)return this.addConstraint(new U.Physics.P2.LockConstraint(this,t,e,i,n,r))},createPrismaticConstraint:function(t,e,i,n,r,o,s){if(t=this.getBody(t),e=this.getBody(e),t&&e)return this.addConstraint(new U.Physics.P2.PrismaticConstraint(this,t,e,i,n,r,o,s))},addConstraint:function(t){return this.world.addConstraint(t),this.onConstraintAdded.dispatch(t),t},removeConstraint:function(t){return this.world.removeConstraint(t),this.onConstraintRemoved.dispatch(t),t},addContactMaterial:function(t){return this.world.addContactMaterial(t),this.onContactMaterialAdded.dispatch(t),t},removeContactMaterial:function(t){return this.world.removeContactMaterial(t),this.onContactMaterialRemoved.dispatch(t),t},getContactMaterial:function(t,e){return this.world.getContactMaterial(t,e)},setMaterial:function(t,e){for(var i=e.length;i--;)e[i].setMaterial(t)},createMaterial:function(t,e){t=new U.Physics.P2.Material(t=t||"");return this.materials.push(t),void 0!==e&&e.setMaterial(t),t},createContactMaterial:function(t,e,i){void 0===t&&(t=this.createMaterial()),void 0===e&&(e=this.createMaterial());i=new U.Physics.P2.ContactMaterial(t,e,i);return this.addContactMaterial(i)},getBodies:function(){for(var t=[],e=this.world.bodies.length;e--;)t.push(this.world.bodies[e].parent);return t},getBody:function(t){return t instanceof p2.Body?t:t instanceof U.Physics.P2.Body?t.data:t.body&&t.body.type===U.Physics.P2JS?t.body.data:null},getSprings:function(){for(var t=[],e=this.world.springs.length;e--;)t.push(this.world.springs[e].parent);return t},getConstraints:function(){for(var t=[],e=this.world.constraints.length;e--;)t.push(this.world.constraints[e]);return t},hitTest:function(t,e,i,n){void 0===e&&(e=this.world.bodies),void 0===i&&(i=5),void 0===n&&(n=!1);for(var t=[this.pxmi(t.x),this.pxmi(t.y)],r=[],o=e.length;o--;)e[o]instanceof U.Physics.P2.Body&&(!n||e[o].data.type!==p2.Body.STATIC)?r.push(e[o].data):e[o]instanceof p2.Body&&e[o].parent&&(!n||e[o].type!==p2.Body.STATIC)?r.push(e[o]):e[o]instanceof U.Sprite&&e[o].hasOwnProperty("body")&&(!n||e[o].body.data.type!==p2.Body.STATIC)&&r.push(e[o].body.data);return this.world.hitTest(t,r,i)},toJSON:function(){return this.world.toJSON()},createCollisionGroup:function(t){var e=Math.pow(2,this._collisionGroupID);this.walls.left&&(this.walls.left.shapes[0].collisionMask=this.walls.left.shapes[0].collisionMask|e),this.walls.right&&(this.walls.right.shapes[0].collisionMask=this.walls.right.shapes[0].collisionMask|e),this.walls.top&&(this.walls.top.shapes[0].collisionMask=this.walls.top.shapes[0].collisionMask|e),this.walls.bottom&&(this.walls.bottom.shapes[0].collisionMask=this.walls.bottom.shapes[0].collisionMask|e),this._collisionGroupID++;e=new U.Physics.P2.CollisionGroup(e);return this.collisionGroups.push(e),t&&this.setCollisionGroup(t,e),e},setCollisionGroup:function(t,e){if(t instanceof U.Group)for(var i=0;i<t.total;i++)t.children[i].body&&t.children[i].body.type===U.Physics.P2JS&&t.children[i].body.setCollisionGroup(e);else t.body.setCollisionGroup(e)},createSpring:function(t,e,i,n,r,o,s,a,h){if(t=this.getBody(t),e=this.getBody(e),t&&e)return this.addSpring(new U.Physics.P2.Spring(this,t,e,i,n,r,o,s,a,h))},createRotationalSpring:function(t,e,i,n,r){if(t=this.getBody(t),e=this.getBody(e),t&&e)return this.addSpring(new U.Physics.P2.RotationalSpring(this,t,e,i,n,r))},createBody:function(t,e,i,n,r,o){void 0===n&&(n=!1);i=new U.Physics.P2.Body(this.game,null,t,e,i);if(o&&!i.addPolygon(r,o))return!1;return n&&this.world.addBody(i.data),i},createParticle:function(t,e,i,n,r,o){void 0===n&&(n=!1);i=new U.Physics.P2.Body(this.game,null,t,e,i);if(o&&!i.addPolygon(r,o))return!1;return n&&this.world.addBody(i.data),i},convertCollisionObjects:function(t,e,i){void 0===i&&(i=!0);for(var n=[],r=0,o=t.collision[e].length;r<o;r++){var s=t.collision[e][r],s=this.createBody(s.x,s.y,0,i,{},s.polyline);s&&n.push(s)}return n},clearTilemapLayerBodies:function(t,e){e=t.getLayer(e);for(var i=t.layers[e].bodies.length;i--;)t.layers[e].bodies[i].destroy();t.layers[e].bodies.length=0},convertTilemap:function(t,e,i,n){e=t.getLayer(e),void 0===i&&(i=!0),void 0===n&&(n=!0),this.clearTilemapLayerBodies(t,e);for(var r=0,o=0,s=0,a=0,h=t.layers[e].height;a<h;a++)for(var r=0,l=0,p=t.layers[e].width;l<p;l++){var u,d,c=t.layers[e].data[a][l];c&&-1<c.index&&c.collides&&(n?(u=t.getTileRight(e,l,a),0===r&&(o=c.x*c.width,s=c.y*c.height,r=c.width),u&&u.collides?r+=c.width:((d=this.createBody(o,s,0,!1)).addRectangle(r,c.height,r/2,c.height/2,0),i&&this.addBody(d),t.layers[e].bodies.push(d),r=0)):((d=this.createBody(c.x*c.width,c.y*c.height,0,!1)).addRectangle(c.width,c.height,c.width/2,c.height/2,0),i&&this.addBody(d),t.layers[e].bodies.push(d)))}return t.layers[e].bodies},mpx:function(t){return 20*t},pxm:function(t){return.05*t},mpxi:function(t){return-20*t},pxmi:function(t){return-.05*t}},Object.defineProperty(U.Physics.P2.prototype,"friction",{get:function(){return this.world.defaultContactMaterial.friction},set:function(t){this.world.defaultContactMaterial.friction=t}}),Object.defineProperty(U.Physics.P2.prototype,"restitution",{get:function(){return this.world.defaultContactMaterial.restitution},set:function(t){this.world.defaultContactMaterial.restitution=t}}),Object.defineProperty(U.Physics.P2.prototype,"contactMaterial",{get:function(){return this.world.defaultContactMaterial},set:function(t){this.world.defaultContactMaterial=t}}),Object.defineProperty(U.Physics.P2.prototype,"applySpringForces",{get:function(){return this.world.applySpringForces},set:function(t){this.world.applySpringForces=t}}),Object.defineProperty(U.Physics.P2.prototype,"applyDamping",{get:function(){return this.world.applyDamping},set:function(t){this.world.applyDamping=t}}),Object.defineProperty(U.Physics.P2.prototype,"applyGravity",{get:function(){return this.world.applyGravity},set:function(t){this.world.applyGravity=t}}),Object.defineProperty(U.Physics.P2.prototype,"solveConstraints",{get:function(){return this.world.solveConstraints},set:function(t){this.world.solveConstraints=t}}),Object.defineProperty(U.Physics.P2.prototype,"time",{get:function(){return this.world.time}}),Object.defineProperty(U.Physics.P2.prototype,"emitImpactEvent",{get:function(){return this.world.emitImpactEvent},set:function(t){this.world.emitImpactEvent=t}}),Object.defineProperty(U.Physics.P2.prototype,"sleepMode",{get:function(){return this.world.sleepMode},set:function(t){this.world.sleepMode=t}}),Object.defineProperty(U.Physics.P2.prototype,"total",{get:function(){return this.world.bodies.length}}),U.Physics.P2.FixtureList=function(t){Array.isArray(t)||(t=[t]),this.rawList=t,this.init(),this.parse(this.rawList)},U.Physics.P2.FixtureList.prototype={init:function(){this.namedFixtures={},this.groupedFixtures=[],this.allFixtures=[]},setCategory:function(e,t){this.getFixtures(t).forEach(function(t){t.collisionGroup=e})},setMask:function(e,t){this.getFixtures(t).forEach(function(t){t.collisionMask=e})},setSensor:function(e,t){this.getFixtures(t).forEach(function(t){t.sensor=e})},setMaterial:function(e,t){this.getFixtures(t).forEach(function(t){t.material=e})},getFixtures:function(t){var e=[];if(t){t instanceof Array||(t=[t]);var i=this;return t.forEach(function(t){i.namedFixtures[t]&&e.push(i.namedFixtures[t])}),this.flatten(e)}return this.allFixtures},getFixtureByKey:function(t){return this.namedFixtures[t]},getGroup:function(t){return this.groupedFixtures[t]},parse:function(){var t,e,i=this.rawList,n=[];for(t in i)e=i[t],isNaN(+t)?this.namedFixtures[t]=this.flatten(e):(this.groupedFixtures[t]=this.groupedFixtures[t]||[],this.groupedFixtures[t]=this.groupedFixtures[t].concat(e)),n.push(this.allFixtures=this.flatten(this.groupedFixtures))},flatten:function(t){var e=[],i=arguments.callee;return t.forEach(function(t){return Array.prototype.push.apply(e,Array.isArray(t)?i(t):[t])}),e}},U.Physics.P2.PointProxy=function(t,e){this.world=t,this.destination=e},U.Physics.P2.PointProxy.prototype.constructor=U.Physics.P2.PointProxy,Object.defineProperty(U.Physics.P2.PointProxy.prototype,"x",{get:function(){return this.world.mpx(this.destination[0])},set:function(t){this.destination[0]=this.world.pxm(t)}}),Object.defineProperty(U.Physics.P2.PointProxy.prototype,"y",{get:function(){return this.world.mpx(this.destination[1])},set:function(t){this.destination[1]=this.world.pxm(t)}}),Object.defineProperty(U.Physics.P2.PointProxy.prototype,"mx",{get:function(){return this.destination[0]},set:function(t){this.destination[0]=t}}),Object.defineProperty(U.Physics.P2.PointProxy.prototype,"my",{get:function(){return this.destination[1]},set:function(t){this.destination[1]=t}}),U.Physics.P2.InversePointProxy=function(t,e){this.world=t,this.destination=e},U.Physics.P2.InversePointProxy.prototype.constructor=U.Physics.P2.InversePointProxy,Object.defineProperty(U.Physics.P2.InversePointProxy.prototype,"x",{get:function(){return this.world.mpxi(this.destination[0])},set:function(t){this.destination[0]=this.world.pxmi(t)}}),Object.defineProperty(U.Physics.P2.InversePointProxy.prototype,"y",{get:function(){return this.world.mpxi(this.destination[1])},set:function(t){this.destination[1]=this.world.pxmi(t)}}),Object.defineProperty(U.Physics.P2.InversePointProxy.prototype,"mx",{get:function(){return this.destination[0]},set:function(t){this.destination[0]=-t}}),Object.defineProperty(U.Physics.P2.InversePointProxy.prototype,"my",{get:function(){return this.destination[1]},set:function(t){this.destination[1]=-t}}),U.Physics.P2.Body=function(t,e,i,n,r){e=e||null,i=i||0,n=n||0,void 0===r&&(r=1),this.game=t,this.world=t.physics.p2,this.sprite=e,this.type=U.Physics.P2JS,this.offset=new U.Point,this.data=new p2.Body({position:[this.world.pxmi(i),this.world.pxmi(n)],mass:r}),(this.data.parent=this).velocity=new U.Physics.P2.InversePointProxy(this.world,this.data.velocity),this.force=new U.Physics.P2.InversePointProxy(this.world,this.data.force),this.gravity=new U.Point,this.onBeginContact=new U.Signal,this.onEndContact=new U.Signal,this.collidesWith=[],this.removeNextStep=!1,this.debugBody=null,this.dirty=!1,this._collideWorldBounds=!0,this._bodyCallbacks={},this._bodyCallbackContext={},this._groupCallbacks={},this._groupCallbackContext={},this._reset=!1,e&&(this.setRectangleFromSprite(e),e.exists&&this.game.physics.p2.addBody(this))},U.Physics.P2.Body.prototype={createBodyCallback:function(t,e,i){var n=-1;t.id?n=t.id:t.body&&(n=t.body.id),-1<n&&(null===e?(delete this._bodyCallbacks[n],delete this._bodyCallbackContext[n]):(this._bodyCallbacks[n]=e,this._bodyCallbackContext[n]=i))},createGroupCallback:function(t,e,i){null===e?(delete this._groupCallbacks[t.mask],delete this._groupCallbackContext[t.mask]):(this._groupCallbacks[t.mask]=e,this._groupCallbackContext[t.mask]=i)},getCollisionMask:function(){var t=0;this._collideWorldBounds&&(t=this.game.physics.p2.boundsCollisionGroup.mask);for(var e=0;e<this.collidesWith.length;e++)t|=this.collidesWith[e].mask;return t},updateCollisionMask:function(t){var e=this.getCollisionMask();if(void 0===t)for(var i=this.data.shapes.length-1;0<=i;i--)this.data.shapes[i].collisionMask=e;else t.collisionMask=e},setCollisionGroup:function(t,e){var i=this.getCollisionMask();if(void 0===e)for(var n=this.data.shapes.length-1;0<=n;n--)this.data.shapes[n].collisionGroup=t.mask,this.data.shapes[n].collisionMask=i;else e.collisionGroup=t.mask,e.collisionMask=i},clearCollision:function(t,e,i){if(void 0===t&&(t=!0),void 0===e&&(e=!0),void 0===i)for(var n=this.data.shapes.length-1;0<=n;n--)t&&(this.data.shapes[n].collisionGroup=null),e&&(this.data.shapes[n].collisionMask=null);else t&&(i.collisionGroup=null),e&&(i.collisionMask=null);t&&(this.collidesWith.length=0)},removeCollisionGroup:function(t,e,i){var n;if(void 0===e&&(e=!0),Array.isArray(t))for(var r=0;r<t.length;r++)-1<(n=this.collidesWith.indexOf(t[r]))&&(this.collidesWith.splice(n,1),e&&(delete this._groupCallbacks[t.mask],delete this._groupCallbackContext[t.mask]));else-1<(n=this.collidesWith.indexOf(t))&&(this.collidesWith.splice(n,1),e&&(delete this._groupCallbacks[t.mask],delete this._groupCallbackContext[t.mask]));var o=this.getCollisionMask();if(void 0===i)for(r=this.data.shapes.length-1;0<=r;r--)this.data.shapes[r].collisionMask=o;else i.collisionMask=o},collides:function(t,e,i,n){if(Array.isArray(t))for(var r=0;r<t.length;r++)-1===this.collidesWith.indexOf(t[r])&&(this.collidesWith.push(t[r]),e&&this.createGroupCallback(t[r],e,i));else-1===this.collidesWith.indexOf(t)&&(this.collidesWith.push(t),e&&this.createGroupCallback(t,e,i));var o=this.getCollisionMask();if(void 0===n)for(r=this.data.shapes.length-1;0<=r;r--)this.data.shapes[r].collisionMask=o;else n.collisionMask=o},adjustCenterOfMass:function(){this.data.adjustCenterOfMass(),this.shapeChanged()},getVelocityAtPoint:function(t,e){return this.data.getVelocityAtPoint(t,e)},applyDamping:function(t){this.data.applyDamping(t)},applyImpulse:function(t,e,i){this.data.applyImpulse(t,[this.world.pxmi(e),this.world.pxmi(i)])},applyImpulseLocal:function(t,e,i){this.data.applyImpulseLocal(t,[this.world.pxmi(e),this.world.pxmi(i)])},applyForce:function(t,e,i){this.data.applyForce(t,[this.world.pxmi(e),this.world.pxmi(i)])},setZeroForce:function(){this.data.setZeroForce()},setZeroRotation:function(){this.data.angularVelocity=0},setZeroVelocity:function(){this.data.velocity[0]=0,this.data.velocity[1]=0},setZeroDamping:function(){this.data.damping=0,this.data.angularDamping=0},toLocalFrame:function(t,e){return this.data.toLocalFrame(t,e)},toWorldFrame:function(t,e){return this.data.toWorldFrame(t,e)},rotateLeft:function(t){this.data.angularVelocity=this.world.pxm(-t)},rotateRight:function(t){this.data.angularVelocity=this.world.pxm(t)},moveForward:function(t){var e=this.world.pxmi(-t),t=this.data.angle+Math.PI/2;this.data.velocity[0]=e*Math.cos(t),this.data.velocity[1]=e*Math.sin(t)},moveBackward:function(t){var e=this.world.pxmi(-t),t=this.data.angle+Math.PI/2;this.data.velocity[0]=-(e*Math.cos(t)),this.data.velocity[1]=-(e*Math.sin(t))},thrust:function(t){var e=this.world.pxmi(-t),t=this.data.angle+Math.PI/2;this.data.force[0]+=e*Math.cos(t),this.data.force[1]+=e*Math.sin(t)},thrustLeft:function(t){var e=this.world.pxmi(-t),t=this.data.angle;this.data.force[0]+=e*Math.cos(t),this.data.force[1]+=e*Math.sin(t)},thrustRight:function(t){var e=this.world.pxmi(-t),t=this.data.angle;this.data.force[0]-=e*Math.cos(t),this.data.force[1]-=e*Math.sin(t)},reverse:function(t){var e=this.world.pxmi(-t),t=this.data.angle+Math.PI/2;this.data.force[0]-=e*Math.cos(t),this.data.force[1]-=e*Math.sin(t)},moveLeft:function(t){this.data.velocity[0]=this.world.pxmi(-t)},moveRight:function(t){this.data.velocity[0]=this.world.pxmi(t)},moveUp:function(t){this.data.velocity[1]=this.world.pxmi(-t)},moveDown:function(t){this.data.velocity[1]=this.world.pxmi(t)},preUpdate:function(){this.dirty=!0,this.removeNextStep&&(this.removeFromWorld(),this.removeNextStep=!1)},postUpdate:function(){this.sprite.x=this.world.mpxi(this.data.position[0])+this.offset.x,this.sprite.y=this.world.mpxi(this.data.position[1])+this.offset.y,this.fixedRotation||(this.sprite.rotation=this.data.angle),this.debugBody&&this.debugBody.updateSpriteTransform(),this.dirty=!1},reset:function(t,e,i,n){void 0===i&&(i=!1),void 0===n&&(n=!1),this.setZeroForce(),this.setZeroVelocity(),this.setZeroRotation(),i&&this.setZeroDamping(),n&&(this.mass=1),this.x=t,this.y=e},addToWorld:function(){if(this.game.physics.p2._toRemove)for(var t=0;t<this.game.physics.p2._toRemove.length;t++)this.game.physics.p2._toRemove[t]===this&&this.game.physics.p2._toRemove.splice(t,1);this.data.world!==this.game.physics.p2.world&&this.game.physics.p2.addBody(this)},removeFromWorld:function(){this.data.world===this.game.physics.p2.world&&this.game.physics.p2.removeBodyNextStep(this)},destroy:function(){this.removeFromWorld(),this.clearShapes(),this._bodyCallbacks={},this._bodyCallbackContext={},this._groupCallbacks={},this._groupCallbackContext={},this.debugBody&&this.debugBody.destroy(!0,!0),this.debugBody=null,this.sprite&&(this.sprite.body=null,this.sprite=null)},clearShapes:function(){for(var t=this.data.shapes.length;t--;)this.data.removeShape(this.data.shapes[t]);this.shapeChanged()},addShape:function(t,e,i,n){return void 0===i&&(i=0),void 0===n&&(n=0),this.data.addShape(t,[this.world.pxmi(e=void 0===e?0:e),this.world.pxmi(i)],n),this.shapeChanged(),t},addCircle:function(t,e,i,n){t=new p2.Circle({radius:this.world.pxm(t)});return this.addShape(t,e,i,n)},addRectangle:function(t,e,i,n,r){e=new p2.Box({width:this.world.pxm(t),height:this.world.pxm(e)});return this.addShape(e,i,n,r)},addPlane:function(t,e,i){var n=new p2.Plane;return this.addShape(n,t,e,i)},addParticle:function(t,e,i){var n=new p2.Particle;return this.addShape(n,t,e,i)},addLine:function(t,e,i,n){t=new p2.Line({length:this.world.pxm(t)});return this.addShape(t,e,i,n)},addCapsule:function(t,e,i,n,r){e=new p2.Capsule({length:this.world.pxm(t),radius:this.world.pxm(e)});return this.addShape(e,i,n,r)},addPolygon:function(t,e){t=t||{};var i=[];if(1===(e=!Array.isArray(e)?Array.prototype.slice.call(arguments,1):e).length&&Array.isArray(e[0]))i=e[0].slice(0);else if(Array.isArray(e[0]))i=e.slice();else if("number"==typeof e[0])for(var n=0,r=e.length;n<r;n+=2)i.push([e[n],e[n+1]]);var o=i.length-1;i[o][0]===i[0][0]&&i[o][1]===i[0][1]&&i.pop();for(var s=0;s<i.length;s++)i[s][0]=this.world.pxmi(i[s][0]),i[s][1]=this.world.pxmi(i[s][1]);o=this.data.fromPolygon(i,t);return this.shapeChanged(),o},removeShape:function(t){t=this.data.removeShape(t);return this.shapeChanged(),t},setCircle:function(t,e,i,n){return this.clearShapes(),this.addCircle(t,e,i,n)},setRectangle:function(t,e,i,n,r){return void 0===t&&(t=16),void 0===e&&(e=16),this.clearShapes(),this.addRectangle(t,e,i,n,r)},setRectangleFromSprite:function(t){return void 0===t&&(t=this.sprite),this.clearShapes(),this.addRectangle(t.width,t.height,0,0,t.rotation)},setMaterial:function(t,e){if(void 0===e)for(var i=this.data.shapes.length-1;0<=i;i--)this.data.shapes[i].material=t;else e.material=t},shapeChanged:function(){this.debugBody&&this.debugBody.draw()},addPhaserPolygon:function(t,e){for(var i=this.game.cache.getPhysicsData(t,e),n=[],r=0;r<i.length;r++){var o=i[r],s=this.addFixture(o);n[o.filter.group]=n[o.filter.group]||[],n[o.filter.group]=n[o.filter.group].concat(s),o.fixtureKey&&(n[o.fixtureKey]=s)}return this.data.aabbNeedsUpdate=!0,this.shapeChanged(),n},addFixture:function(t){var e=[];if(t.circle){(l=new p2.Circle({radius:this.world.pxm(t.circle.radius)})).collisionGroup=t.filter.categoryBits,l.collisionMask=t.filter.maskBits,l.sensor=t.isSensor;var i=p2.vec2.create();i[0]=this.world.pxmi(t.circle.position[0]-this.sprite.width/2),i[1]=this.world.pxmi(t.circle.position[1]-this.sprite.height/2),this.data.addShape(l,i),e.push(l)}else for(var n=t.polygons,r=p2.vec2.create(),o=0;o<n.length;o++){for(var s=n[o],a=[],h=0;h<s.length;h+=2)a.push([this.world.pxmi(s[h]),this.world.pxmi(s[h+1])]);for(var l=new p2.Convex({vertices:a}),p=0;p!==l.vertices.length;p++){var u=l.vertices[p];p2.vec2.sub(u,u,l.centerOfMass)}p2.vec2.scale(r,l.centerOfMass,1),r[0]-=this.world.pxmi(this.sprite.width/2),r[1]-=this.world.pxmi(this.sprite.height/2),l.updateTriangles(),l.updateCenterOfMass(),l.updateBoundingRadius(),l.collisionGroup=t.filter.categoryBits,l.collisionMask=t.filter.maskBits,l.sensor=t.isSensor,this.data.addShape(l,r),e.push(l)}return e},loadPolygon:function(t,e){var i;i=null===t?e:this.game.cache.getPhysicsData(t,e);for(var n=p2.vec2.create(),r=0;r<i.length;r++){for(var o=[],s=0;s<i[r].shape.length;s+=2)o.push([this.world.pxmi(i[r].shape[s]),this.world.pxmi(i[r].shape[s+1])]);for(var a=new p2.Convex({vertices:o}),h=0;h!==a.vertices.length;h++){var l=a.vertices[h];p2.vec2.sub(l,l,a.centerOfMass)}p2.vec2.scale(n,a.centerOfMass,1),n[0]-=this.world.pxmi(this.sprite.width/2),n[1]-=this.world.pxmi(this.sprite.height/2),a.updateTriangles(),a.updateCenterOfMass(),a.updateBoundingRadius(),this.data.addShape(a,n)}return this.data.aabbNeedsUpdate=!0,this.shapeChanged(),!0}},U.Physics.P2.Body.prototype.constructor=U.Physics.P2.Body,U.Physics.P2.Body.DYNAMIC=1,U.Physics.P2.Body.STATIC=2,U.Physics.P2.Body.KINEMATIC=4,Object.defineProperty(U.Physics.P2.Body.prototype,"static",{get:function(){return this.data.type===U.Physics.P2.Body.STATIC},set:function(t){t&&this.data.type!==U.Physics.P2.Body.STATIC?(this.data.type=U.Physics.P2.Body.STATIC,this.mass=0):t||this.data.type!==U.Physics.P2.Body.STATIC||(this.data.type=U.Physics.P2.Body.DYNAMIC,this.mass=1)}}),Object.defineProperty(U.Physics.P2.Body.prototype,"dynamic",{get:function(){return this.data.type===U.Physics.P2.Body.DYNAMIC},set:function(t){t&&this.data.type!==U.Physics.P2.Body.DYNAMIC?(this.data.type=U.Physics.P2.Body.DYNAMIC,this.mass=1):t||this.data.type!==U.Physics.P2.Body.DYNAMIC||(this.data.type=U.Physics.P2.Body.STATIC,this.mass=0)}}),Object.defineProperty(U.Physics.P2.Body.prototype,"kinematic",{get:function(){return this.data.type===U.Physics.P2.Body.KINEMATIC},set:function(t){t&&this.data.type!==U.Physics.P2.Body.KINEMATIC?(this.data.type=U.Physics.P2.Body.KINEMATIC,this.mass=4):t||this.data.type!==U.Physics.P2.Body.KINEMATIC||(this.data.type=U.Physics.P2.Body.STATIC,this.mass=0)}}),Object.defineProperty(U.Physics.P2.Body.prototype,"allowSleep",{get:function(){return this.data.allowSleep},set:function(t){t!==this.data.allowSleep&&(this.data.allowSleep=t)}}),Object.defineProperty(U.Physics.P2.Body.prototype,"angle",{get:function(){return U.Math.wrapAngle(U.Math.radToDeg(this.data.angle))},set:function(t){this.data.angle=U.Math.degToRad(U.Math.wrapAngle(t))}}),Object.defineProperty(U.Physics.P2.Body.prototype,"angularDamping",{get:function(){return this.data.angularDamping},set:function(t){this.data.angularDamping=t}}),Object.defineProperty(U.Physics.P2.Body.prototype,"angularForce",{get:function(){return this.data.angularForce},set:function(t){this.data.angularForce=t}}),Object.defineProperty(U.Physics.P2.Body.prototype,"angularVelocity",{get:function(){return this.data.angularVelocity},set:function(t){this.data.angularVelocity=t}}),Object.defineProperty(U.Physics.P2.Body.prototype,"damping",{get:function(){return this.data.damping},set:function(t){this.data.damping=t}}),Object.defineProperty(U.Physics.P2.Body.prototype,"fixedRotation",{get:function(){return this.data.fixedRotation},set:function(t){t!==this.data.fixedRotation&&(this.data.fixedRotation=t)}}),Object.defineProperty(U.Physics.P2.Body.prototype,"inertia",{get:function(){return this.data.inertia},set:function(t){this.data.inertia=t}}),Object.defineProperty(U.Physics.P2.Body.prototype,"mass",{get:function(){return this.data.mass},set:function(t){t!==this.data.mass&&(this.data.mass=t,this.data.updateMassProperties())}}),Object.defineProperty(U.Physics.P2.Body.prototype,"motionState",{get:function(){return this.data.type},set:function(t){t!==this.data.type&&(this.data.type=t)}}),Object.defineProperty(U.Physics.P2.Body.prototype,"rotation",{get:function(){return this.data.angle},set:function(t){this.data.angle=t}}),Object.defineProperty(U.Physics.P2.Body.prototype,"sleepSpeedLimit",{get:function(){return this.data.sleepSpeedLimit},set:function(t){this.data.sleepSpeedLimit=t}}),Object.defineProperty(U.Physics.P2.Body.prototype,"x",{get:function(){return this.world.mpxi(this.data.position[0])},set:function(t){this.data.position[0]=this.world.pxmi(t)}}),Object.defineProperty(U.Physics.P2.Body.prototype,"y",{get:function(){return this.world.mpxi(this.data.position[1])},set:function(t){this.data.position[1]=this.world.pxmi(t)}}),Object.defineProperty(U.Physics.P2.Body.prototype,"id",{get:function(){return this.data.id}}),Object.defineProperty(U.Physics.P2.Body.prototype,"debug",{get:function(){return null!==this.debugBody},set:function(t){t&&!this.debugBody?this.debugBody=new U.Physics.P2.BodyDebug(this.game,this.data):!t&&this.debugBody&&(this.debugBody.destroy(),this.debugBody=null)}}),Object.defineProperty(U.Physics.P2.Body.prototype,"collideWorldBounds",{get:function(){return this._collideWorldBounds},set:function(t){t&&!this._collideWorldBounds?(this._collideWorldBounds=!0,this.updateCollisionMask()):!t&&this._collideWorldBounds&&(this._collideWorldBounds=!1,this.updateCollisionMask())}}),U.Physics.P2.BodyDebug=function(t,e,i){U.Group.call(this,t);var n={pixelsPerLengthUnit:t.physics.p2.mpx(1),debugPolygons:!1,lineWidth:1,alpha:.5};this.settings=U.Utils.extend(n,i),this.ppu=this.settings.pixelsPerLengthUnit,this.ppu=-1*this.ppu,this.body=e,this.canvas=new U.Graphics(t),this.canvas.alpha=this.settings.alpha,this.add(this.canvas),this.draw(),this.updateSpriteTransform()},U.Physics.P2.BodyDebug.prototype=Object.create(U.Group.prototype),U.Physics.P2.BodyDebug.prototype.constructor=U.Physics.P2.BodyDebug,U.Utils.extend(U.Physics.P2.BodyDebug.prototype,{updateSpriteTransform:function(){this.position.x=this.body.position[0]*this.ppu,this.position.y=this.body.position[1]*this.ppu,this.rotation=this.body.angle},draw:function(){var t,e,i,n,r,o,s,a,h,l,p,u,d=this.body,c=this.canvas;if(c.clear(),i=parseInt(this.randomPastelHex(),16),r=16711680,o=this.lineWidth,d instanceof p2.Body&&d.shapes.length)for(var y=d.shapes.length,_=0;_!==y;){if(s=(e=d.shapes[_]).position||0,t=e.angle||0,e instanceof p2.Circle)this.drawCircle(c,s[0]*this.ppu,s[1]*this.ppu,t,e.radius*this.ppu,i,o);else if(e instanceof p2.Capsule)this.drawCapsule(c,s[0]*this.ppu,s[1]*this.ppu,t,e.length*this.ppu,e.radius*this.ppu,r,i,o);else if(e instanceof p2.Plane)this.drawPlane(c,s[0]*this.ppu,-s[1]*this.ppu,i,r,5*o,10*o,10*o,100*this.ppu,t);else if(e instanceof p2.Line)this.drawLine(c,e.length*this.ppu,r,o);else if(e instanceof p2.Box)this.drawRectangle(c,s[0]*this.ppu,s[1]*this.ppu,t,e.width*this.ppu,e.height*this.ppu,r,i,o);else if(e instanceof p2.Convex){for(h=[],l=p2.vec2.create(),n=p=0,u=e.vertices.length;0<=u?p<u:u<p;n=0<=u?++p:--p)a=e.vertices[n],p2.vec2.rotate(l,a,t),h.push([(l[0]+s[0])*this.ppu,-(l[1]+s[1])*this.ppu]);this.drawConvex(c,h,e.triangles,r,i,o,this.settings.debugPolygons,[s[0]*this.ppu,-s[1]*this.ppu])}_++}},drawRectangle:function(t,e,i,n,r,o,s,a,h){t.lineStyle(h=void 0===h?1:h,s=void 0===s?0:s,1),t.beginFill(a),t.drawRect(e-r/2,i-o/2,r,o)},drawCircle:function(t,e,i,n,r,o,s){void 0===o&&(o=16777215),t.lineStyle(s=void 0===s?1:s,0,1),t.beginFill(o,1),t.drawCircle(e,i,2*-r),t.endFill(),t.moveTo(e,i),t.lineTo(e+r*Math.cos(-n),i+r*Math.sin(-n))},drawLine:function(t,e,i,n){t.lineStyle(5*(n=void 0===n?1:n),i=void 0===i?0:i,1),t.moveTo(-e/2,0),t.lineTo(e/2,0)},drawConvex:function(t,e,i,n,r,o,s,a){var h,l,p,u,d,c,y,_;if(void 0===o&&(o=1),void 0===n&&(n=0),s){for(h=[16711680,65280,255],l=0;l!==e.length+1;)d=e[l%e.length],_=e[(l+1)%e.length],u=d[0],y=d[1],d=_[0],_=_[1],t.lineStyle(o,h[l%h.length],1),t.moveTo(u,-y),t.lineTo(d,-_),t.drawCircle(u,-y,2*o),l++;return t.lineStyle(o,0,1),t.drawCircle(a[0],a[1],2*o)}for(t.lineStyle(o,n,1),t.beginFill(r),l=0;l!==e.length;)p=(c=e[l])[0],c=c[1],0===l?t.moveTo(p,-c):t.lineTo(p,-c),l++;if(t.endFill(),2<e.length)return t.moveTo(e[e.length-1][0],-e[e.length-1][1]),t.lineTo(e[0][0],-e[0][1])},drawPath:function(t,e,i,n,r){var o,s,a,h,l,p,u,d;for(t.lineStyle(r=void 0===r?1:r,i=void 0===i?0:i,1),"number"==typeof n&&t.beginFill(n),a=s=null,o=0;o<e.length;)u=(p=e[o])[0],d=p[1],u===s&&d===a||(0===o?t.moveTo(u,d):(h=s,l=a,p=e[(o+1)%e.length][0],0!=(u-h)*(e[(o+1)%e.length][1]-l)-(p-h)*(d-l)&&t.lineTo(u,d)),s=u,a=d),o++;"number"==typeof n&&t.endFill(),2<e.length&&"number"==typeof n&&(t.moveTo(e[e.length-1][0],e[e.length-1][1]),t.lineTo(e[0][0],e[0][1]))},drawPlane:function(t,e,i,n,r,o,s,a,h,l){void 0===n&&(n=16777215),t.lineStyle(o=void 0===o?1:o,r,11),t.beginFill(n),t.moveTo(e,-i),r=e+Math.cos(l)*this.game.width,n=i+Math.sin(l)*this.game.height,t.lineTo(r,-n),t.moveTo(e,-i),r=e+Math.cos(l)*-this.game.width,n=i+Math.sin(l)*-this.game.height,t.lineTo(r,-n)},drawCapsule:function(t,e,i,n,r,o,s,a,h){t.lineStyle(h=void 0===h?1:h,s=void 0===s?0:s,1);var l=Math.cos(n),n=Math.sin(n);t.beginFill(a,1),t.drawCircle(-r/2*l+e,-r/2*n+i,2*-o),t.drawCircle(r/2*l+e,r/2*n+i,2*-o),t.endFill(),t.lineStyle(h,s,0),t.beginFill(a,1),t.moveTo(-r/2*l+o*n+e,-r/2*n+o*l+i),t.lineTo(r/2*l+o*n+e,r/2*n+o*l+i),t.lineTo(r/2*l-o*n+e,r/2*n-o*l+i),t.lineTo(-r/2*l-o*n+e,-r/2*n-o*l+i),t.endFill(),t.lineStyle(h,s,1),t.moveTo(-r/2*l+o*n+e,-r/2*n+o*l+i),t.lineTo(r/2*l+o*n+e,r/2*n+o*l+i),t.moveTo(-r/2*l-o*n+e,-r/2*n-o*l+i),t.lineTo(r/2*l-o*n+e,r/2*n-o*l+i)},randomPastelHex:function(){var t=[255,255,255],e=Math.floor(256*Math.random()),i=Math.floor(256*Math.random()),n=Math.floor(256*Math.random());return e=Math.floor((e+3*t[0])/4),i=Math.floor((i+3*t[1])/4),n=Math.floor((n+3*t[2])/4),this.rgbToHex(e,i,n)},rgbToHex:function(t,e,i){return this.componentToHex(t)+this.componentToHex(e)+this.componentToHex(i)},componentToHex:function(t){t=t.toString(16);return 2===t.length?t:t+"0"}}),U.Physics.P2.Spring=function(t,e,i,n,r,o,s,a,h,l){this.game=t.game,void 0===r&&(r=100),void 0===o&&(o=1);o={restLength:n=(this.world=t).pxm(n=void 0===n?1:n),stiffness:r,damping:o};null!=s&&(o.worldAnchorA=[t.pxm(s[0]),t.pxm(s[1])]),null!=a&&(o.worldAnchorB=[t.pxm(a[0]),t.pxm(a[1])]),null!=h&&(o.localAnchorA=[t.pxm(h[0]),t.pxm(h[1])]),null!=l&&(o.localAnchorB=[t.pxm(l[0]),t.pxm(l[1])]),this.data=new p2.LinearSpring(e,i,o),this.data.parent=this},U.Physics.P2.Spring.prototype.constructor=U.Physics.P2.Spring,U.Physics.P2.RotationalSpring=function(t,e,i,n,r,o){this.game=t.game,this.world=t,void 0===r&&(r=100),void 0===o&&(o=1),n=(n=void 0===n?null:n)&&t.pxm(n),this.data=new p2.RotationalSpring(e,i,{restAngle:n,stiffness:r,damping:o}),this.data.parent=this},U.Physics.P2.Spring.prototype.constructor=U.Physics.P2.Spring,U.Physics.P2.Material=function(t){this.name=t,p2.Material.call(this)},U.Physics.P2.Material.prototype=Object.create(p2.Material.prototype),U.Physics.P2.Material.prototype.constructor=U.Physics.P2.Material,U.Physics.P2.ContactMaterial=function(t,e,i){p2.ContactMaterial.call(this,t,e,i)},U.Physics.P2.ContactMaterial.prototype=Object.create(p2.ContactMaterial.prototype),U.Physics.P2.ContactMaterial.prototype.constructor=U.Physics.P2.ContactMaterial,U.Physics.P2.CollisionGroup=function(t){this.mask=t},U.Physics.P2.DistanceConstraint=function(t,e,i,n,r,o,s){void 0===n&&(n=100),void 0===r&&(r=[0,0]),void 0===o&&(o=[0,0]),void 0===s&&(s=Number.MAX_VALUE),this.game=t.game,n=(this.world=t).pxm(n),r=[t.pxmi(r[0]),t.pxmi(r[1])],o=[t.pxmi(o[0]),t.pxmi(o[1])],p2.DistanceConstraint.call(this,e,i,{distance:n,localAnchorA:r,localAnchorB:o,maxForce:s})},U.Physics.P2.DistanceConstraint.prototype=Object.create(p2.DistanceConstraint.prototype),U.Physics.P2.DistanceConstraint.prototype.constructor=U.Physics.P2.DistanceConstraint,U.Physics.P2.GearConstraint=function(t,e,i,n,r){void 0===n&&(n=0),void 0===r&&(r=1),this.game=t.game,this.world=t,p2.GearConstraint.call(this,e,i,{angle:n,ratio:r})},U.Physics.P2.GearConstraint.prototype=Object.create(p2.GearConstraint.prototype),U.Physics.P2.GearConstraint.prototype.constructor=U.Physics.P2.GearConstraint,U.Physics.P2.LockConstraint=function(t,e,i,n,r,o){void 0===n&&(n=[0,0]),void 0===r&&(r=0),void 0===o&&(o=Number.MAX_VALUE),this.game=t.game,n=[(this.world=t).pxm(n[0]),t.pxm(n[1])],p2.LockConstraint.call(this,e,i,{localOffsetB:n,localAngleB:r,maxForce:o})},U.Physics.P2.LockConstraint.prototype=Object.create(p2.LockConstraint.prototype),U.Physics.P2.LockConstraint.prototype.constructor=U.Physics.P2.LockConstraint,U.Physics.P2.PrismaticConstraint=function(t,e,i,n,r,o,s,a){void 0===n&&(n=!0),void 0===r&&(r=[0,0]),void 0===o&&(o=[0,0]),void 0===s&&(s=[0,0]),void 0===a&&(a=Number.MAX_VALUE),this.game=t.game,r=[(this.world=t).pxmi(r[0]),t.pxmi(r[1])],o=[t.pxmi(o[0]),t.pxmi(o[1])],p2.PrismaticConstraint.call(this,e,i,{localAnchorA:r,localAnchorB:o,localAxisA:s,maxForce:a,disableRotationalLock:!n})},U.Physics.P2.PrismaticConstraint.prototype=Object.create(p2.PrismaticConstraint.prototype),U.Physics.P2.PrismaticConstraint.prototype.constructor=U.Physics.P2.PrismaticConstraint,U.Physics.P2.RevoluteConstraint=function(t,e,i,n,r,o,s){void 0===o&&(o=Number.MAX_VALUE),void 0===s&&(s=null),this.game=t.game,i=[(this.world=t).pxmi(i[0]),t.pxmi(i[1])],r=[t.pxmi(r[0]),t.pxmi(r[1])],s=s&&[t.pxmi(s[0]),t.pxmi(s[1])],p2.RevoluteConstraint.call(this,e,n,{worldPivot:s,localPivotA:i,localPivotB:r,maxForce:o})},U.Physics.P2.RevoluteConstraint.prototype=Object.create(p2.RevoluteConstraint.prototype),U.Physics.P2.RevoluteConstraint.prototype.constructor=U.Physics.P2.RevoluteConstraint,U.ImageCollection=function(t,e,i,n,r,o,s){(void 0===i||i<=0)&&(i=32),(void 0===n||n<=0)&&(n=32),void 0===r&&(r=0),void 0===o&&(o=0),this.name=t,this.firstgid=0|e,this.imageWidth=0|i,this.imageHeight=0|n,this.imageMargin=0|r,this.imageSpacing=0|o,this.properties=s||{},this.images=[],this.total=0},U.ImageCollection.prototype={containsImageIndex:function(t){return t>=this.firstgid&&t<this.firstgid+this.total},addImage:function(t,e){this.images.push({gid:t,image:e}),this.total++}},U.ImageCollection.prototype.constructor=U.ImageCollection,U.Tile=function(t,e,i,n,r,o){this.layer=t,this.index=e,this.x=i,this.y=n,this.rotation=0,this.flipped=!1,this.worldX=i*r,this.worldY=n*o,this.width=r,this.height=o,this.centerX=Math.abs(r/2),this.centerY=Math.abs(o/2),this.alpha=1,this.properties={},this.scanned=!1,this.faceTop=!1,this.faceBottom=!1,this.faceLeft=!1,this.faceRight=!1,this.collideLeft=!1,this.collideRight=!1,this.collideUp=!1,this.collideDown=!1,this.collisionCallback=null,this.collisionCallbackContext=this},U.Tile.prototype={containsPoint:function(t,e){return!(t<this.worldX||e<this.worldY||t>this.right||e>this.bottom)},intersects:function(t,e,i,n){return!(i<=this.worldX)&&(!(n<=this.worldY)&&(!(t>=this.worldX+this.width)&&!(e>=this.worldY+this.height)))},setCollisionCallback:function(t,e){this.collisionCallback=t,this.collisionCallbackContext=e},destroy:function(){this.collisionCallback=null,this.collisionCallbackContext=null,this.properties=null},setCollision:function(t,e,i,n){this.collideLeft=t,this.collideRight=e,this.collideUp=i,this.collideDown=n,this.faceLeft=t,this.faceRight=e,this.faceTop=i,this.faceBottom=n},resetCollision:function(){this.collideLeft=!1,this.collideRight=!1,this.collideUp=!1,this.collideDown=!1,this.faceTop=!1,this.faceBottom=!1,this.faceLeft=!1,this.faceRight=!1},isInteresting:function(t,e){return t&&e?this.collideLeft||this.collideRight||this.collideUp||this.collideDown||this.faceTop||this.faceBottom||this.faceLeft||this.faceRight||this.collisionCallback:t?this.collideLeft||this.collideRight||this.collideUp||this.collideDown:!!e&&(this.faceTop||this.faceBottom||this.faceLeft||this.faceRight)},copy:function(t){this.index=t.index,this.alpha=t.alpha,this.properties=t.properties,this.collideUp=t.collideUp,this.collideDown=t.collideDown,this.collideLeft=t.collideLeft,this.collideRight=t.collideRight,this.collisionCallback=t.collisionCallback,this.collisionCallbackContext=t.collisionCallbackContext}},U.Tile.prototype.constructor=U.Tile,Object.defineProperty(U.Tile.prototype,"collides",{get:function(){return this.collideLeft||this.collideRight||this.collideUp||this.collideDown}}),Object.defineProperty(U.Tile.prototype,"canCollide",{get:function(){return this.collideLeft||this.collideRight||this.collideUp||this.collideDown||this.collisionCallback}}),Object.defineProperty(U.Tile.prototype,"left",{get:function(){return this.worldX}}),Object.defineProperty(U.Tile.prototype,"right",{get:function(){return this.worldX+this.width}}),Object.defineProperty(U.Tile.prototype,"top",{get:function(){return this.worldY}}),Object.defineProperty(U.Tile.prototype,"bottom",{get:function(){return this.worldY+this.height}}),U.Tilemap=function(t,e,i,n,r,o){this.game=t,this.key=e;o=U.TilemapParser.parse(this.game,e,i,n,r,o);null!==o&&(this.width=o.width,this.height=o.height,this.tileWidth=o.tileWidth,this.tileHeight=o.tileHeight,this.orientation=o.orientation,this.format=o.format,this.version=o.version,this.properties=o.properties,this.widthInPixels=o.widthInPixels,this.heightInPixels=o.heightInPixels,this.layers=o.layers,this.tilesets=o.tilesets,this.imagecollections=o.imagecollections,this.tiles=o.tiles,this.objects=o.objects,this.collideIndexes=[],this.collision=o.collision,this.images=o.images,this.enableDebug=!1,this.currentLayer=0,this.debugMap=[],this._results=[],this._tempA=0,this._tempB=0)},U.Tilemap.CSV=0,U.Tilemap.TILED_JSON=1,U.Tilemap.NORTH=0,U.Tilemap.EAST=1,U.Tilemap.SOUTH=2,U.Tilemap.WEST=3,U.Tilemap.prototype={create:function(t,e,i,n,r,o){return void 0===o&&(o=this.game.world),this.width=e,this.height=i,this.setTileSize(n,r),this.layers.length=0,this.createBlankLayer(t,e,i,n,r,o)},setTileSize:function(t,e){this.tileWidth=t,this.tileHeight=e,this.widthInPixels=this.width*t,this.heightInPixels=this.height*e},addTilesetImage:function(t,e,i,n,r,o,s){if(void 0===t)return null;void 0===r&&(r=0),void 0===o&&(o=0),void 0===s&&(s=0),0===(i=void 0===i?this.tileWidth:i)&&(i=32),0===(n=void 0===n?this.tileHeight:n)&&(n=32);var a=null;if((e=null==e?t:e)instanceof U.BitmapData)a=e.canvas;else{if(!this.game.cache.checkImageKey(e))return null;a=this.game.cache.getImage(e)}e=this.getTilesetIndex(t);if(null===e&&this.format===U.Tilemap.TILED_JSON)return null;if(this.tilesets[e])return this.tilesets[e].setImage(a),this.tilesets[e];var h=new U.Tileset(t,s,i,n,r,o,{});h.setImage(a),this.tilesets.push(h);for(var l=this.tilesets.length-1,p=r,u=r,d=0,c=0,y=0,_=s;_<s+h.total&&(this.tiles[_]=[p,u,l],p+=i+o,++d!==h.total)&&(++c!==h.columns||(p=r,u+=n+o,c=0,++y!==h.rows));_++);return h},createFromObjects:function(t,e,i,n,r,o,s,a,h){if(void 0===r&&(r=!0),void 0===o&&(o=!1),void 0===s&&(s=this.game.world),void 0===a&&(a=U.Sprite),void 0===h&&(h=!0),this.objects[t])for(var l=0;l<this.objects[t].length;l++){var p=!1,u=this.objects[t][l];if(p=void 0!==u.gid&&"number"==typeof e&&u.gid===e||void 0!==u.id&&"number"==typeof e&&u.id===e||void 0!==u.name&&"string"==typeof e&&u.name===e?!0:p){var d,c=new a(this.game,parseFloat(u.x,10),parseFloat(u.y,10),i,n);for(d in c.name=u.name,c.visible=u.visible,c.autoCull=o,c.exists=r,u.width&&(c.width=u.width),u.height&&(c.height=u.height),u.rotation&&(c.angle=u.rotation),h&&(c.y-=c.height),s.add(c),u.properties)s.set(c,d,u.properties[d],!1,!1,0,!0)}}},createFromTiles:function(t,e,i,n,r,o){"number"==typeof t&&(t=[t]),null==e?e=[]:"number"==typeof e&&(e=[e]),n=this.getLayer(n),void 0===r&&(r=this.game.world),void 0===(o=void 0===o?{}:o).customClass&&(o.customClass=U.Sprite),void 0===o.adjustY&&(o.adjustY=!0);var s=this.layers[n].width,a=this.layers[n].height;if(this.copy(0,0,s,a,n),this._results.length<2)return 0;for(var h,l=0,p=1,u=this._results.length;p<u;p++)if(-1!==t.indexOf(this._results[p].index)){for(var d in h=new o.customClass(this.game,this._results[p].worldX,this._results[p].worldY,i),o)h[d]=o[d];r.add(h),l++}if(1===e.length)for(p=0;p<t.length;p++)this.replace(t[p],e[0],0,0,s,a,n);else if(1<e.length)for(p=0;p<t.length;p++)this.replace(t[p],e[p],0,0,s,a,n);return l},createLayer:function(t,e,i,n){void 0===e&&(e=this.game.width),void 0===i&&(i=this.game.height),void 0===n&&(n=this.game.world);var r=t;if(!(null===(r="string"==typeof t?this.getLayerIndex(t):r)||r>this.layers.length)){void 0===e||e<=0?e=Math.min(this.game.width,this.layers[r].widthInPixels):e>this.game.width&&(e=this.game.width),void 0===i||i<=0?i=Math.min(this.game.height,this.layers[r].heightInPixels):i>this.game.height&&(i=this.game.height),this.enableDebug;i=n.add(new U.TilemapLayer(this.game,this,r,e,i));return this.enableDebug,i}},createBlankLayer:function(t,e,i,n,r,o){if(void 0===o&&(o=this.game.world),null===this.getLayerIndex(t)){for(var s={name:t,x:0,y:0,width:e,height:i,widthInPixels:e*n,heightInPixels:i*r,alpha:1,visible:!0,properties:{},indexes:[],callbacks:[],bodies:[],data:null},a=[],h=0;h<i;h++){for(var l=[],p=0;p<e;p++)l.push(new U.Tile(s,-1,p,h,n,r));a.push(l)}s.data=a,this.layers.push(s),this.currentLayer=this.layers.length-1;var u=s.widthInPixels,d=s.heightInPixels;return u>this.game.width&&(u=this.game.width),d>this.game.height&&(d=this.game.height),(a=new U.TilemapLayer(this.game,this,this.layers.length-1,u,d)).name=t,o.add(a)}},getIndex:function(t,e){for(var i=0;i<t.length;i++)if(t[i].name===e)return i;return null},getLayerIndex:function(t){return this.getIndex(this.layers,t)},getTilesetIndex:function(t){return this.getIndex(this.tilesets,t)},getImageIndex:function(t){return this.getIndex(this.images,t)},setTileIndexCallback:function(t,e,i,n){if(n=this.getLayer(n),"number"==typeof t)this.layers[n].callbacks[t]={callback:e,callbackContext:i};else for(var r=0,o=t.length;r<o;r++)this.layers[n].callbacks[t[r]]={callback:e,callbackContext:i}},setTileLocationCallback:function(t,e,i,n,r,o,s){if(s=this.getLayer(s),this.copy(t,e,i,n,s),!(this._results.length<2))for(var a=1;a<this._results.length;a++)this._results[a].setCollisionCallback(r,o)},setCollision:function(t,e,i,n){if(void 0===e&&(e=!0),void 0===n&&(n=!0),i=this.getLayer(i),"number"==typeof t)return this.setCollisionByIndex(t,e,i,!0);if(Array.isArray(t)){for(var r=0;r<t.length;r++)this.setCollisionByIndex(t[r],e,i,!1);n&&this.calculateFaces(i)}},setCollisionBetween:function(t,e,i,n,r){if(void 0===i&&(i=!0),void 0===r&&(r=!0),n=this.getLayer(n),!(e<t)){for(var o=t;o<=e;o++)this.setCollisionByIndex(o,i,n,!1);r&&this.calculateFaces(n)}},setCollisionByExclusion:function(t,e,i,n){void 0===e&&(e=!0),void 0===n&&(n=!0),i=this.getLayer(i);for(var r=0,o=this.tiles.length;r<o;r++)-1===t.indexOf(r)&&this.setCollisionByIndex(r,e,i,!1);n&&this.calculateFaces(i)},setCollisionByIndex:function(t,e,i,n){var r;void 0===i&&(i=this.currentLayer),void 0===n&&(n=!0),(e=void 0===e?!0:e)?this.collideIndexes.push(t):-1<(r=this.collideIndexes.indexOf(t))&&this.collideIndexes.splice(r,1);for(var o=0;o<this.layers[i].height;o++)for(var s=0;s<this.layers[i].width;s++){var a=this.layers[i].data[o][s];a&&a.index===t&&(e?a.setCollision(!0,!0,!0,!0):a.resetCollision(),a.faceTop=e,a.faceBottom=e,a.faceLeft=e,a.faceRight=e)}return n&&this.calculateFaces(i),i},getLayer:function(t){return void 0===t?t=this.currentLayer:"string"==typeof t?t=this.getLayerIndex(t):t instanceof U.TilemapLayer&&(t=t.index),t},setPreventRecalculate:function(t){if(!0===t&&!0!==this.preventingRecalculate&&(this.preventingRecalculate=!0,this.needToRecalculate={}),!1===t&&!0===this.preventingRecalculate){for(var e in this.preventingRecalculate=!1,this.needToRecalculate)this.calculateFaces(e);this.needToRecalculate=!1}},calculateFaces:function(t){if(this.preventingRecalculate)this.needToRecalculate[t]=!0;else for(var e,i,n,r,o=0,s=this.layers[t].height;o<s;o++)for(var a=0,h=this.layers[t].width;a<h;a++){var l=this.layers[t].data[o][a];l&&(e=this.getTileAbove(t,a,o),i=this.getTileBelow(t,a,o),n=this.getTileLeft(t,a,o),r=this.getTileRight(t,a,o),l.collides&&(l.faceTop=!0,l.faceBottom=!0,l.faceLeft=!0,l.faceRight=!0),e&&e.collides&&(l.faceTop=!1),i&&i.collides&&(l.faceBottom=!1),n&&n.collides&&(l.faceLeft=!1),r&&r.collides&&(l.faceRight=!1))}},getTileAbove:function(t,e,i){return 0<i?this.layers[t].data[i-1][e]:null},getTileBelow:function(t,e,i){return i<this.layers[t].height-1?this.layers[t].data[i+1][e]:null},getTileLeft:function(t,e,i){return 0<e?this.layers[t].data[i][e-1]:null},getTileRight:function(t,e,i){return e<this.layers[t].width-1?this.layers[t].data[i][e+1]:null},setLayer:function(t){t=this.getLayer(t),this.layers[t]&&(this.currentLayer=t)},hasTile:function(t,e,i){return i=this.getLayer(i),void 0!==this.layers[i].data[e]&&void 0!==this.layers[i].data[e][t]&&-1<this.layers[i].data[e][t].index},removeTile:function(t,e,i){if(i=this.getLayer(i),0<=t&&t<this.layers[i].width&&0<=e&&e<this.layers[i].height&&this.hasTile(t,e,i)){var n=this.layers[i].data[e][t];return this.layers[i].data[e][t]=new U.Tile(this.layers[i],-1,t,e,this.tileWidth,this.tileHeight),this.layers[i].dirty=!0,this.calculateFaces(i),n}},removeTileWorldXY:function(t,e,i,n,r){return r=this.getLayer(r),t=this.game.math.snapToFloor(t,i)/i,e=this.game.math.snapToFloor(e,n)/n,this.removeTile(t,e,r)},putTile:function(t,e,i,n){return null===t?this.removeTile(e,i,n):(n=this.getLayer(n),0<=e&&e<this.layers[n].width&&0<=i&&i<this.layers[n].height?(t instanceof U.Tile?(r=t.index,this.hasTile(e,i,n)?this.layers[n].data[i][e].copy(t):this.layers[n].data[i][e]=new U.Tile(n,r,e,i,t.width,t.height)):(r=t,this.hasTile(e,i,n)?this.layers[n].data[i][e].index=r:this.layers[n].data[i][e]=new U.Tile(this.layers[n],r,e,i,this.tileWidth,this.tileHeight)),-1<this.collideIndexes.indexOf(r)?this.layers[n].data[i][e].setCollision(!0,!0,!0,!0):this.layers[n].data[i][e].resetCollision(),this.layers[n].dirty=!0,this.calculateFaces(n),this.layers[n].data[i][e]):null);var r},putTileWorldXY:function(t,e,i,n,r,o){return o=this.getLayer(o),e=this.game.math.snapToFloor(e,n)/n,i=this.game.math.snapToFloor(i,r)/r,this.putTile(t,e,i,o)},searchTileIndex:function(t,e,i,n){void 0===e&&(e=0),void 0===i&&(i=!1),n=this.getLayer(n);var r=0;if(i){for(var o=this.layers[n].height-1;0<=o;o--)for(var s=this.layers[n].width-1;0<=s;s--)if(this.layers[n].data[o][s].index===t){if(r===e)return this.layers[n].data[o][s];r++}}else for(o=0;o<this.layers[n].height;o++)for(s=0;s<this.layers[n].width;s++)if(this.layers[n].data[o][s].index===t){if(r===e)return this.layers[n].data[o][s];r++}return null},getTile:function(t,e,i,n){return void 0===n&&(n=!1),i=this.getLayer(i),0<=t&&t<this.layers[i].width&&0<=e&&e<this.layers[i].height&&(-1!==this.layers[i].data[e][t].index||n)?this.layers[i].data[e][t]:null},getTileWorldXY:function(t,e,i,n,r,o){return void 0===i&&(i=this.tileWidth),void 0===n&&(n=this.tileHeight),r=this.getLayer(r),t=this.game.math.snapToFloor(t,i)/i,e=this.game.math.snapToFloor(e,n)/n,this.getTile(t,e,r,o)},copy:function(t,e,i,n,r){if(r=this.getLayer(r),this.layers[r]){void 0===i&&(i=this.layers[r].width),void 0===n&&(n=this.layers[r].height),(t=void 0===t?0:t)<0&&(t=0),(e=void 0===e?0:e)<0&&(e=0),i>this.layers[r].width&&(i=this.layers[r].width),n>this.layers[r].height&&(n=this.layers[r].height),this._results.length=0,this._results.push({x:t,y:e,width:i,height:n,layer:r});for(var o=e;o<e+n;o++)for(var s=t;s<t+i;s++)this._results.push(this.layers[r].data[o][s]);return this._results}this._results.length=0},paste:function(t,e,i,n){if(void 0===t&&(t=0),void 0===e&&(e=0),n=this.getLayer(n),i&&!(i.length<2)){for(var r=t-i[1].x,o=e-i[1].y,s=1;s<i.length;s++)this.layers[n].data[o+i[s].y][r+i[s].x].copy(i[s]);this.layers[n].dirty=!0,this.calculateFaces(n)}},swap:function(t,e,i,n,r,o,s){s=this.getLayer(s),this.copy(i,n,r,o,s),this._results.length<2||(this._tempA=t,this._tempB=e,this._results.forEach(this.swapHandler,this),this.paste(i,n,this._results,s))},swapHandler:function(t){t.index===this._tempA?t.index=this._tempB:t.index===this._tempB&&(t.index=this._tempA)},forEach:function(t,e,i,n,r,o,s){s=this.getLayer(s),this.copy(i,n,r,o,s),this._results.length<2||(this._results.forEach(t,e),this.paste(i,n,this._results,s))},replace:function(t,e,i,n,r,o,s){if(s=this.getLayer(s),this.copy(i,n,r,o,s),!(this._results.length<2)){for(var a=1;a<this._results.length;a++)this._results[a].index===t&&(this._results[a].index=e);this.paste(i,n,this._results,s)}},random:function(t,e,i,n,r){if(r=this.getLayer(r),this.copy(t,e,i,n,r),!(this._results.length<2)){for(var o,s=[],a=1;a<this._results.length;a++)this._results[a].index&&(o=this._results[a].index,-1===s.indexOf(o)&&s.push(o));for(var h=1;h<this._results.length;h++)this._results[h].index=this.game.rnd.pick(s);this.paste(t,e,this._results,r)}},shuffle:function(t,e,i,n,r){if(r=this.getLayer(r),this.copy(t,e,i,n,r),!(this._results.length<2)){for(var o=[],s=1;s<this._results.length;s++)this._results[s].index&&o.push(this._results[s].index);U.ArrayUtils.shuffle(o);for(var a=1;a<this._results.length;a++)this._results[a].index=o[a-1];this.paste(t,e,this._results,r)}},fill:function(t,e,i,n,r,o){if(o=this.getLayer(o),this.copy(e,i,n,r,o),!(this._results.length<2)){for(var s=1;s<this._results.length;s++)this._results[s].index=t;this.paste(e,i,this._results,o)}},removeAllLayers:function(){this.layers.length=0,this.currentLayer=0},dump:function(){for(var t="",e=[""],i=0;i<this.layers[this.currentLayer].height;i++){for(var n=0;n<this.layers[this.currentLayer].width;n++)t+="%c  ",1<this.layers[this.currentLayer].data[i][n]?this.debugMap[this.layers[this.currentLayer].data[i][n]]?e.push("background: "+this.debugMap[this.layers[this.currentLayer].data[i][n]]):e.push("background: #ffffff"):e.push("background: rgb(0, 0, 0)");t+="\n"}e[0]=t},destroy:function(){this.removeAllLayers(),this.data=[],this.game=null}},U.Tilemap.prototype.constructor=U.Tilemap,Object.defineProperty(U.Tilemap.prototype,"layer",{get:function(){return this.layers[this.currentLayer]},set:function(t){t!==this.currentLayer&&this.setLayer(t)}}),U.TilemapLayer=function(t,e,i,n,r){n|=0,r|=0,U.Sprite.call(this,t,0,0),this.map=e,this.index=i,this.layer=e.layers[i],this.canvas=PIXI.CanvasPool.create(this,n,r),this.context=this.canvas.getContext("2d"),this.setTexture(new PIXI.Texture(new PIXI.BaseTexture(this.canvas))),this.type=U.TILEMAPLAYER,this.physicsType=U.TILEMAPLAYER,this.renderSettings={enableScrollDelta:!1,overdrawRatio:.2,copyCanvas:null},this.debug=!1,this.exists=!0,this.debugSettings={missingImageFill:"rgb(255,255,255)",debuggedTileOverfill:"rgba(0,255,0,0.4)",forceFullRedraw:!0,debugAlpha:.5,facingEdgeStroke:"rgba(0,255,0,1)",collidingTileOverfill:"rgba(0,255,0,0.2)"},this.scrollFactorX=1,this.scrollFactorY=1,this.dirty=!0,this.rayStepRate=4,this._wrap=!1,this._mc={scrollX:0,scrollY:0,renderWidth:0,renderHeight:0,tileWidth:e.tileWidth,tileHeight:e.tileHeight,cw:e.tileWidth,ch:e.tileHeight,tilesets:[]},this._scrollX=0,this._scrollY=0,this._results=[],t.device.canvasBitBltShift||(this.renderSettings.copyCanvas=U.TilemapLayer.ensureSharedCopyCanvas()),this.fixedToCamera=!0},U.TilemapLayer.prototype=Object.create(U.Sprite.prototype),U.TilemapLayer.prototype.constructor=U.TilemapLayer,U.TilemapLayer.prototype.preUpdateCore=U.Component.Core.preUpdate,U.TilemapLayer.sharedCopyCanvas=null,U.TilemapLayer.ensureSharedCopyCanvas=function(){return this.sharedCopyCanvas||(this.sharedCopyCanvas=PIXI.CanvasPool.create(this,2,2)),this.sharedCopyCanvas},U.TilemapLayer.prototype.preUpdate=function(){return this.preUpdateCore()},U.TilemapLayer.prototype.postUpdate=function(){this.fixedToCamera&&(this.position.x=(this.game.camera.view.x+this.cameraOffset.x)/this.game.camera.scale.x,this.position.y=(this.game.camera.view.y+this.cameraOffset.y)/this.game.camera.scale.y),this._scrollX=this.game.camera.view.x*this.scrollFactorX/this.scale.x,this._scrollY=this.game.camera.view.y*this.scrollFactorY/this.scale.y},U.TilemapLayer.prototype._renderCanvas=function(t){this.fixedToCamera&&(this.position.x=(this.game.camera.view.x+this.cameraOffset.x)/this.game.camera.scale.x,this.position.y=(this.game.camera.view.y+this.cameraOffset.y)/this.game.camera.scale.y),this._scrollX=this.game.camera.view.x*this.scrollFactorX/this.scale.x,this._scrollY=this.game.camera.view.y*this.scrollFactorY/this.scale.y,this.render(),PIXI.Sprite.prototype._renderCanvas.call(this,t)},U.TilemapLayer.prototype._renderWebGL=function(t){this.fixedToCamera&&(this.position.x=(this.game.camera.view.x+this.cameraOffset.x)/this.game.camera.scale.x,this.position.y=(this.game.camera.view.y+this.cameraOffset.y)/this.game.camera.scale.y),this._scrollX=this.game.camera.view.x*this.scrollFactorX/this.scale.x,this._scrollY=this.game.camera.view.y*this.scrollFactorY/this.scale.y,this.render(),PIXI.Sprite.prototype._renderWebGL.call(this,t)},U.TilemapLayer.prototype.destroy=function(){PIXI.CanvasPool.remove(this),U.Component.Destroy.prototype.destroy.call(this)},U.TilemapLayer.prototype.resize=function(t,e){this.canvas.width=t,this.canvas.height=e,this.texture.frame.resize(t,e),this.texture.width=t,this.texture.height=e,this.texture.crop.width=t,this.texture.crop.height=e,this.texture.baseTexture.width=t,this.texture.baseTexture.height=e,this.texture.baseTexture.dirty(),this.texture.requiresUpdate=!0,this.texture._updateUvs(),this.dirty=!0},U.TilemapLayer.prototype.resizeWorld=function(){this.game.world.setBounds(0,0,this.layer.widthInPixels*this.scale.x,this.layer.heightInPixels*this.scale.y)},U.TilemapLayer.prototype._fixX=function(t){return 1===this.scrollFactorX||0===this.scrollFactorX&&0===this.position.x?t:0===this.scrollFactorX&&0!==this.position.x?t-this.position.x:this._scrollX+(t-this._scrollX/this.scrollFactorX)},U.TilemapLayer.prototype._unfixX=function(t){return 1===this.scrollFactorX?t:this._scrollX/this.scrollFactorX+(t-this._scrollX)},U.TilemapLayer.prototype._fixY=function(t){return 1===this.scrollFactorY||0===this.scrollFactorY&&0===this.position.y?t:0===this.scrollFactorY&&0!==this.position.y?t-this.position.y:this._scrollY+(t-this._scrollY/this.scrollFactorY)},U.TilemapLayer.prototype._unfixY=function(t){return 1===this.scrollFactorY?t:this._scrollY/this.scrollFactorY+(t-this._scrollY)},U.TilemapLayer.prototype.getTileX=function(t){return Math.floor(this._fixX(t)/this._mc.tileWidth)},U.TilemapLayer.prototype.getTileY=function(t){return Math.floor(this._fixY(t)/this._mc.tileHeight)},U.TilemapLayer.prototype.getTileXY=function(t,e,i){return i.x=this.getTileX(t),i.y=this.getTileY(e),i},U.TilemapLayer.prototype.getRayCastTiles=function(t,e,i,n){e=e||this.rayStepRate;var r=this.getTiles(t.x,t.y,t.width,t.height,i=void 0===i?!1:i,n=void 0===n?!1:n);if(0===r.length)return[];for(var o=t.coordinatesOnLine(e),s=[],a=0;a<r.length;a++)for(var h=0;h<o.length;h++){var l=r[a],p=o[h];if(l.containsPoint(p[0],p[1])){s.push(l);break}}return s},U.TilemapLayer.prototype.getTiles=function(t,e,i,n,r,o){void 0===o&&(o=!1);var s=!((r=void 0===r?!1:r)||o);t=this._fixX(t),e=this._fixY(e);for(var a=Math.floor(t/(this._mc.cw*this.scale.x)),h=Math.floor(e/(this._mc.ch*this.scale.y)),l=Math.ceil((t+i)/(this._mc.cw*this.scale.x))-a,p=Math.ceil((e+n)/(this._mc.ch*this.scale.y))-h;this._results.length;)this._results.pop();for(var u=h;u<h+p;u++)for(var d=a;d<a+l;d++){var c=this.layer.data[u];c&&c[d]&&(s||c[d].isInteresting(r,o))&&this._results.push(c[d])}return this._results.slice()},U.TilemapLayer.prototype.resolveTileset=function(t){var e=this._mc.tilesets;if(t<2e3)for(;e.length<t;)e.push(void 0);var i=this.map.tiles[t]&&this.map.tiles[t][2];if(null!==i){i=this.map.tilesets[i];if(i&&i.containsTileIndex(t))return e[t]=i}return e[t]=null},U.TilemapLayer.prototype.resetTilesetCache=function(){for(var t=this._mc.tilesets;t.length;)t.pop()},U.TilemapLayer.prototype.setScale=function(t,e){t=t||1,e=e||t;for(var i=0;i<this.layer.data.length;i++)for(var n=this.layer.data[i],r=0;r<n.length;r++){var o=n[r];o.width=this.map.tileWidth*t,o.height=this.map.tileHeight*e,o.worldX=o.x*o.width,o.worldY=o.y*o.height}this.scale.setTo(t,e)},U.TilemapLayer.prototype.shiftCanvas=function(t,e,i){var n=t.canvas,r=n.width-Math.abs(e),o=n.height-Math.abs(i),s=0,a=0,h=e,l=i;e<0&&(s=-e,h=0),i<0&&(a=-i,l=0);e=this.renderSettings.copyCanvas;e?((e.width<r||e.height<o)&&(e.width=r,e.height=o),(i=e.getContext("2d")).clearRect(0,0,r,o),i.drawImage(n,s,a,r,o,0,0,r,o),t.clearRect(h,l,r,o),t.drawImage(e,0,0,r,o,h,l,r,o)):(t.save(),t.globalCompositeOperation="copy",t.drawImage(n,s,a,r,o,h,l,r,o),t.restore())},U.TilemapLayer.prototype.renderRegion=function(t,e,i,n,r,o){var s=this.context,a=this.layer.width,h=this.layer.height,l=this._mc.tileWidth,p=this._mc.tileHeight,u=this._mc.tilesets,d=NaN;this._wrap||(i<=r&&(i=Math.max(0,i),r=Math.min(a-1,r)),n<=o&&(n=Math.max(0,n),o=Math.min(h-1,o)));for(var c=i*l-t,y=(i+(1<<20)*a)%a,_=(n+(1<<20)*h)%h,m=o-n,g=n*p-e;0<=m;_++,m--,g+=p){h<=_&&(_-=h);for(var f=this.layer.data[_],x=y,v=r-i,w=c;0<=v;x++,v--,w+=l){a<=x&&(x-=a);var z,b,S=f[x];!S||S.index<0||(void 0===(b=u[z=S.index])&&(b=this.resolveTileset(z)),S.alpha===d||this.debug||(s.globalAlpha=S.alpha,d=S.alpha),b?S.rotation||S.flipped?(s.save(),s.translate(w+S.centerX,g+S.centerY),s.rotate(S.rotation),S.flipped&&s.scale(-1,1),b.draw(s,-S.centerX,-S.centerY,z),s.restore()):b.draw(s,w,g,z):this.debugSettings.missingImageFill&&(s.fillStyle=this.debugSettings.missingImageFill,s.fillRect(w,g,l,p)),S.debug&&this.debugSettings.debuggedTileOverfill&&(s.fillStyle=this.debugSettings.debuggedTileOverfill,s.fillRect(w,g,l,p)))}}},U.TilemapLayer.prototype.renderDeltaScroll=function(t,e){var i=this._mc.scrollX,n=this._mc.scrollY,r=this.canvas.width,o=this.canvas.height,s=this._mc.tileWidth,a=this._mc.tileHeight,h=0,l=-s,p=0,u=-a;t<0?(h=r+t,l=r-1):0<t&&(l=t),e<0?(p=o+e,u=o-1):0<e&&(u=e),this.shiftCanvas(this.context,t,e),h=Math.floor((h+i)/s),l=Math.floor((l+i)/s),p=Math.floor((p+n)/a),u=Math.floor((u+n)/a),h<=l&&(this.context.clearRect(h*s-i,0,(l-h+1)*s,o),e=Math.floor((0+n)/a),o=Math.floor((o-1+n)/a),this.renderRegion(i,n,h,e,l,o)),p<=u&&(this.context.clearRect(0,p*a-n,r,(u-p+1)*a),a=Math.floor((0+i)/s),s=Math.floor((r-1+i)/s),this.renderRegion(i,n,a,p,s,u))},U.TilemapLayer.prototype.renderFull=function(){var t=this._mc.scrollX,e=this._mc.scrollY,i=this.canvas.width,n=this.canvas.height,r=this._mc.tileWidth,o=this._mc.tileHeight,s=Math.floor(t/r),a=Math.floor((i-1+t)/r),r=Math.floor(e/o),o=Math.floor((n-1+e)/o);this.context.clearRect(0,0,i,n),this.renderRegion(t,e,s,r,a,o)},U.TilemapLayer.prototype.render=function(){var t=!1;if(this.visible){(this.dirty||this.layer.dirty)&&(t=!(this.layer.dirty=!1));var e=this.canvas.width,i=this.canvas.height,n=0|this._scrollX,r=0|this._scrollY,o=this._mc,s=o.scrollX-n,a=o.scrollY-r;if(t||0!=s||0!=a||o.renderWidth!==e||o.renderHeight!==i)return this.context.save(),o.scrollX=n,o.scrollY=r,o.renderWidth===e&&o.renderHeight===i||(o.renderWidth=e,o.renderHeight=i),this.debug&&(this.context.globalAlpha=this.debugSettings.debugAlpha,this.debugSettings.forceFullRedraw&&(t=!0)),!t&&this.renderSettings.enableScrollDelta&&Math.abs(s)+Math.abs(a)<Math.min(e,i)?this.renderDeltaScroll(s,a):this.renderFull(),this.debug&&(this.context.globalAlpha=1,this.renderDebug()),this.texture.baseTexture.dirty(),this.dirty=!1,this.context.restore(),!0}},U.TilemapLayer.prototype.renderDebug=function(){var t,e,i,n=this._mc.scrollX,r=this._mc.scrollY,o=this.context,s=this.canvas.width,a=this.canvas.height,h=this.layer.width,l=this.layer.height,p=this._mc.tileWidth,u=this._mc.tileHeight,d=Math.floor(n/p),c=Math.floor((s-1+n)/p),s=Math.floor(r/u),a=Math.floor((a-1+r)/u),y=d*p-n,n=s*u-r,_=(d+(1<<20)*h)%h,r=(s+(1<<20)*l)%l;for(o.strokeStyle=this.debugSettings.facingEdgeStroke,e=r,i=a-s,t=n;0<=i;e++,i--,t+=u){l<=e&&(e-=l);for(var m=this.layer.data[e],g=_,f=c-d,x=y;0<=f;g++,f--,x+=p){h<=g&&(g-=h);var v=m[g];!v||v.index<0||!v.collides||(this.debugSettings.collidingTileOverfill&&(o.fillStyle=this.debugSettings.collidingTileOverfill,o.fillRect(x,t,this._mc.cw,this._mc.ch)),this.debugSettings.facingEdgeStroke&&(o.beginPath(),v.faceTop&&(o.moveTo(x,t),o.lineTo(x+this._mc.cw,t)),v.faceBottom&&(o.moveTo(x,t+this._mc.ch),o.lineTo(x+this._mc.cw,t+this._mc.ch)),v.faceLeft&&(o.moveTo(x,t),o.lineTo(x,t+this._mc.ch)),v.faceRight&&(o.moveTo(x+this._mc.cw,t),o.lineTo(x+this._mc.cw,t+this._mc.ch)),o.closePath(),o.stroke()))}}},Object.defineProperty(U.TilemapLayer.prototype,"wrap",{get:function(){return this._wrap},set:function(t){this._wrap=t,this.dirty=!0}}),Object.defineProperty(U.TilemapLayer.prototype,"scrollX",{get:function(){return this._scrollX},set:function(t){this._scrollX=t}}),Object.defineProperty(U.TilemapLayer.prototype,"scrollY",{get:function(){return this._scrollY},set:function(t){this._scrollY=t}}),Object.defineProperty(U.TilemapLayer.prototype,"collisionWidth",{get:function(){return this._mc.cw},set:function(t){this._mc.cw=0|t,this.dirty=!0}}),Object.defineProperty(U.TilemapLayer.prototype,"collisionHeight",{get:function(){return this._mc.ch},set:function(t){this._mc.ch=0|t,this.dirty=!0}}),U.TilemapParser={INSERT_NULL:!1,parse:function(t,e,i,n,r,o){if(void 0===i&&(i=32),void 0===n&&(n=32),void 0===r&&(r=10),void 0===o&&(o=10),void 0===e)return this.getEmptyData();if(null===e)return this.getEmptyData(i,n,r,o);t=t.cache.getTilemapData(e);return t?t.format===U.Tilemap.CSV?this.parseCSV(e,t.data,i,n):t.format&&t.format!==U.Tilemap.TILED_JSON?void 0:this.parseTiledJSON(t.data):void 0},parseCSV:function(t,e,i,n){for(var r=this.getEmptyData(),o=[],s=(e=e.trim()).split("\n"),e=s.length,a=0,h=0;h<s.length;h++){o[h]=[];for(var l=s[h].split(","),p=0;p<l.length;p++)o[h][p]=new U.Tile(r.layers[0],parseInt(l[p],10),p,h,i,n);0===a&&(a=l.length)}return r.format=U.Tilemap.CSV,r.name=t,r.width=a,r.height=e,r.tileWidth=i,r.tileHeight=n,r.widthInPixels=a*i,r.heightInPixels=e*n,r.layers[0].width=a,r.layers[0].height=e,r.layers[0].widthInPixels=r.widthInPixels,r.layers[0].heightInPixels=r.heightInPixels,r.layers[0].data=o,r},getEmptyData:function(t,e,i,n){return{width:null!=i?i:0,height:null!=n?n:0,tileWidth:null!=t?t:0,tileHeight:null!=e?e:0,orientation:"orthogonal",version:"1",properties:{},widthInPixels:0,heightInPixels:0,layers:[{name:"layer",x:0,y:0,width:0,height:0,widthInPixels:0,heightInPixels:0,alpha:1,visible:!0,properties:{},indexes:[],callbacks:[],bodies:[],data:[]}],images:[],objects:{},collision:{},tilesets:[],tiles:[]}},parseTiledJSON:function(t){if("orthogonal"!==t.orientation)return null;for(var e={width:t.width,height:t.height,tileWidth:t.tilewidth,tileHeight:t.tileheight,orientation:t.orientation,format:U.Tilemap.TILED_JSON,version:t.version,properties:t.properties,widthInPixels:t.width*t.tilewidth,heightInPixels:t.height*t.tileheight},i=[],n=0;n<t.layers.length;n++)if("tilelayer"===t.layers[n].type){var r=t.layers[n];if(!r.compression&&r.encoding&&"base64"===r.encoding){for(var o=window.atob(r.data),s=o.length,a=new Array(s),h=0;h<s;h+=4)a[h/4]=(o.charCodeAt(h)|o.charCodeAt(h+1)<<8|o.charCodeAt(h+2)<<16|o.charCodeAt(h+3)<<24)>>>0;r.data=a,delete r.encoding}else if(r.compression)continue;var l={name:r.name,x:r.x,y:r.y,width:r.width,height:r.height,widthInPixels:r.width*t.tilewidth,heightInPixels:r.height*t.tileheight,alpha:r.opacity,visible:r.visible,properties:{},indexes:[],callbacks:[],bodies:[]};r.properties&&(l.properties=r.properties);for(var p,u,d,c=0,y=[],_=[],m=0,s=r.data.length;m<s;m++){if(u=!1,d=p=0,536870912<(P=r.data[m]))switch(2147483648<P&&(P-=2147483648,d+=4),1073741824<P&&(P-=1073741824,d+=2),536870912<P&&(P-=536870912,d+=1),d){case 5:p=Math.PI/2;break;case 6:p=Math.PI;break;case 3:p=3*Math.PI/2;break;case 4:u=!(p=0);break;case 7:p=Math.PI/2,u=!0;break;case 2:p=Math.PI,u=!0;break;case 1:p=3*Math.PI/2,u=!0}0<P?((G=new U.Tile(l,P,c,_.length,t.tilewidth,t.tileheight)).rotation=p,G.flipped=u,0!==d&&(G.flippedVal=d),y.push(G)):U.TilemapParser.INSERT_NULL?y.push(null):y.push(new U.Tile(l,-1,c,_.length,t.tilewidth,t.tileheight)),++c===r.width&&(_.push(y),c=0,y=[])}l.data=_,i.push(l)}e.layers=i;for(var g,f=[],n=0;n<t.layers.length;n++)"imagelayer"===t.layers[n].type&&(C={name:(g=t.layers[n]).name,image:g.image,x:g.x,y:g.y,alpha:g.opacity,visible:g.visible,properties:{}},g.properties&&(C.properties=g.properties),f.push(C));e.images=f;for(var x=[],v=[],w=null,n=0;n<t.tilesets.length;n++){if((L=t.tilesets[n]).image){var z=new U.Tileset(L.name,L.firstgid,L.tilewidth,L.tileheight,L.margin,L.spacing,L.properties);L.tileproperties&&(z.tileProperties=L.tileproperties),z.updateTileData(L.imagewidth,L.imageheight),x.push(z)}else{var b,S=new U.ImageCollection(L.name,L.firstgid,L.tilewidth,L.tileheight,L.margin,L.spacing,L.properties);for(b in L.tiles){var C=L.tiles[b].image,P=L.firstgid+parseInt(b,10);S.addImage(P,C)}v.push(S)}w&&(w.lastgid=L.firstgid-1),w=L}e.tilesets=x,e.imagecollections=v;var M={},T={};function A(t,e){var i,n={};for(i in e){var r=e[i];void 0!==t[r]&&(n[r]=t[r])}return n}for(n=0;n<t.layers.length;n++)if("objectgroup"===t.layers[n].type){var k=t.layers[n];M[k.name]=[],T[k.name]=[];for(var O=0,s=k.objects.length;O<s;O++)if(k.objects[O].gid){var E={gid:k.objects[O].gid,name:k.objects[O].name,type:k.objects[O].hasOwnProperty("type")?k.objects[O].type:"",x:k.objects[O].x,y:k.objects[O].y,visible:k.objects[O].visible,properties:k.objects[O].properties};k.objects[O].rotation&&(E.rotation=k.objects[O].rotation),M[k.name].push(E)}else if(k.objects[O].polyline){var E={name:k.objects[O].name,type:k.objects[O].type,x:k.objects[O].x,y:k.objects[O].y,width:k.objects[O].width,height:k.objects[O].height,visible:k.objects[O].visible,properties:k.objects[O].properties};k.objects[O].rotation&&(E.rotation=k.objects[O].rotation),E.polyline=[];for(var I=0;I<k.objects[O].polyline.length;I++)E.polyline.push([k.objects[O].polyline[I].x,k.objects[O].polyline[I].y]);T[k.name].push(E),M[k.name].push(E)}else if(k.objects[O].polygon){(E=A(k.objects[O],["name","type","x","y","visible","rotation","properties"])).polygon=[];for(I=0;I<k.objects[O].polygon.length;I++)E.polygon.push([k.objects[O].polygon[I].x,k.objects[O].polygon[I].y]);M[k.name].push(E)}else k.objects[O].ellipse?E=A(k.objects[O],["name","type","ellipse","x","y","width","height","visible","rotation","properties"]):(E=A(k.objects[O],["name","type","x","y","width","height","visible","rotation","properties"])).rectangle=!0,M[k.name].push(E)}e.objects=M,e.collision=T,e.tiles=[];for(var G,D,n=0;n<e.tilesets.length;n++)for(var L,c=(L=e.tilesets[n]).tileMargin,B=L.tileMargin,R=0,F=0,N=0,m=L.firstgid;m<L.firstgid+L.total&&(e.tiles[m]=[c,B,n],c+=L.tileWidth+L.tileSpacing,++R!==L.total)&&(++F!==L.columns||(c=L.tileMargin,B+=L.tileHeight+L.tileSpacing,F=0,++N!==L.rows));m++);for(n=0;n<e.layers.length;n++){l=e.layers[n],L=null;for(h=0;h<l.data.length;h++)for(var y=l.data[h],j=0;j<y.length;j++)null===(G=y[j])||G.index<0||(D=e.tiles[G.index][2],(L=e.tilesets[D]).tileProperties&&L.tileProperties[G.index-L.firstgid]&&(G.properties=U.Utils.mixin(L.tileProperties[G.index-L.firstgid],G.properties)))}return e}},U.Tileset=function(t,e,i,n,r,o,s){(void 0===i||i<=0)&&(i=32),(void 0===n||n<=0)&&(n=32),void 0===r&&(r=0),void 0===o&&(o=0),this.name=t,this.firstgid=0|e,this.tileWidth=0|i,this.tileHeight=0|n,this.tileMargin=0|r,this.tileSpacing=0|o,this.properties=s||{},this.image=null,this.rows=0,this.columns=0,this.total=0,this.drawCoords=[]},U.Tileset.prototype={draw:function(t,e,i,n){n=n-this.firstgid<<1;0<=n&&1+n<this.drawCoords.length&&t.drawImage(this.image,this.drawCoords[n],this.drawCoords[1+n],this.tileWidth,this.tileHeight,e,i,this.tileWidth,this.tileHeight)},containsTileIndex:function(t){return t>=this.firstgid&&t<this.firstgid+this.total},setImage:function(t){this.image=t,this.updateTileData(t.width,t.height)},setSpacing:function(t,e){this.tileMargin=0|t,this.tileSpacing=0|e,this.image&&this.updateTileData(this.image.width,this.image.height)},updateTileData:function(t,e){e=(e-2*this.tileMargin+this.tileSpacing)/(this.tileHeight+this.tileSpacing),t=(t-2*this.tileMargin+this.tileSpacing)/(this.tileWidth+this.tileSpacing),e=Math.floor(e),t=Math.floor(t);this.rows&&this.rows!==e||this.columns&&this.columns,this.rows=e,this.columns=t,this.total=e*t,this.drawCoords.length=0;for(var i=this.tileMargin,n=this.tileMargin,r=0;r<this.rows;r++){for(var o=0;o<this.columns;o++)this.drawCoords.push(i),this.drawCoords.push(n),i+=this.tileWidth+this.tileSpacing;i=this.tileMargin,n+=this.tileHeight+this.tileSpacing}}},U.Tileset.prototype.constructor=U.Tileset,U.Particle=function(t,e,i,n,r){U.Sprite.call(this,t,e,i,n,r),this.autoScale=!1,this.scaleData=null,this._s=0,this.autoAlpha=!1,this.alphaData=null,this._a=0},U.Particle.prototype=Object.create(U.Sprite.prototype),U.Particle.prototype.constructor=U.Particle,U.Particle.prototype.update=function(){this.autoScale&&(this._s--,this._s?this.scale.set(this.scaleData[this._s].x,this.scaleData[this._s].y):this.autoScale=!1),this.autoAlpha&&(this._a--,this._a?this.alpha=this.alphaData[this._a].v:this.autoAlpha=!1)},U.Particle.prototype.onEmit=function(){},U.Particle.prototype.setAlphaData=function(t){this.alphaData=t,this._a=t.length-1,this.alpha=this.alphaData[this._a].v,this.autoAlpha=!0},U.Particle.prototype.setScaleData=function(t){this.scaleData=t,this._s=t.length-1,this.scale.set(this.scaleData[this._s].x,this.scaleData[this._s].y),this.autoScale=!0},U.Particle.prototype.reset=function(t,e,i){return U.Component.Reset.prototype.reset.call(this,t,e,i),this.alpha=1,this.scale.set(1),this.autoScale=!1,this.autoAlpha=!1,this},U.Particles=function(t){this.game=t,this.emitters={},this.ID=0},U.Particles.prototype={add:function(t){return this.emitters[t.name]=t},remove:function(t){delete this.emitters[t.name]},update:function(){for(var t in this.emitters)this.emitters[t].exists&&this.emitters[t].update()}},U.Particles.prototype.constructor=U.Particles,U.Particles.Arcade={},U.Particles.Arcade.Emitter=function(t,e,i,n){this.maxParticles=n||50,U.Group.call(this,t),this.name="emitter"+this.game.particles.ID++,this.type=U.EMITTER,this.physicsType=U.GROUP,this.area=new U.Rectangle(e,i,1,1),this.minParticleSpeed=new U.Point(-100,-100),this.maxParticleSpeed=new U.Point(100,100),this.minParticleScale=1,this.maxParticleScale=1,this.scaleData=null,this.minRotation=-360,this.maxRotation=360,this.minParticleAlpha=1,this.maxParticleAlpha=1,this.alphaData=null,this.gravity=100,this.particleClass=U.Particle,this.particleDrag=new U.Point,this.angularDrag=0,this.frequency=100,this.lifespan=2e3,this.bounce=new U.Point,this.on=!1,this.particleAnchor=new U.Point(.5,.5),this.blendMode=U.blendModes.NORMAL,this.emitX=e,this.emitY=i,this.autoScale=!1,this.autoAlpha=!1,this.particleBringToTop=!1,this.particleSendToBack=!1,this._minParticleScale=new U.Point(1,1),this._maxParticleScale=new U.Point(1,1),this._quantity=0,this._timer=0,this._counter=0,this._flowQuantity=0,this._flowTotal=0,this._explode=!0,this._frames=null},U.Particles.Arcade.Emitter.prototype=Object.create(U.Group.prototype),U.Particles.Arcade.Emitter.prototype.constructor=U.Particles.Arcade.Emitter,U.Particles.Arcade.Emitter.prototype.update=function(){if(this.on&&this.game.time.time>=this._timer)if(this._timer=this.game.time.time+this.frequency*this.game.time.slowMotion,0!==this._flowTotal)if(0<this._flowQuantity){for(var t=0;t<this._flowQuantity;t++)if(this.emitParticle()&&(this._counter++,-1!==this._flowTotal&&this._counter>=this._flowTotal)){this.on=!1;break}}else this.emitParticle()&&(this._counter++,-1!==this._flowTotal&&this._counter>=this._flowTotal&&(this.on=!1));else this.emitParticle()&&(this._counter++,0<this._quantity&&this._counter>=this._quantity&&(this.on=!1));for(t=this.children.length;t--;)this.children[t].exists&&this.children[t].update()},U.Particles.Arcade.Emitter.prototype.makeParticles=function(t,e,i,n,r){var o;void 0===i&&(i=this.maxParticles),void 0===n&&(n=!1),void 0===r&&(r=!1);var s=0,a=t,h=e=void 0===e?0:e;for(this._frames=e,i>this.maxParticles&&(this.maxParticles=i);s<i;)Array.isArray(t)&&(a=this.game.rnd.pick(t)),Array.isArray(e)&&(h=this.game.rnd.pick(e)),o=new this.particleClass(this.game,0,0,a,h),this.game.physics.arcade.enable(o,!1),n?(o.body.checkCollision.any=!0,o.body.checkCollision.none=!1):o.body.checkCollision.none=!0,o.body.collideWorldBounds=r,o.body.skipQuadTree=!0,o.exists=!1,o.visible=!1,o.anchor.copyFrom(this.particleAnchor),this.add(o),s++;return this},U.Particles.Arcade.Emitter.prototype.kill=function(){return this.on=!1,this.alive=!1,this.exists=!1,this},U.Particles.Arcade.Emitter.prototype.revive=function(){return this.alive=!0,this.exists=!0,this},U.Particles.Arcade.Emitter.prototype.explode=function(t,e){return this._flowTotal=0,this.start(!0,t,0,e,!1),this},U.Particles.Arcade.Emitter.prototype.flow=function(t,e,i,n,r){return void 0===n&&(n=-1),void 0===r&&(r=!0),(i=void 0===i||0===i?1:i)>this.maxParticles&&(i=this.maxParticles),this._counter=0,this._flowQuantity=i,this._flowTotal=n,r?(this.start(!0,t,e,i),this._counter+=i,this.on=!0,this._timer=this.game.time.time+e*this.game.time.slowMotion):this.start(!1,t,e,i),this},U.Particles.Arcade.Emitter.prototype.start=function(t,e,i,n,r){if(void 0===t&&(t=!0),void 0===e&&(e=0),null==i&&(i=250),void 0===r&&(r=!1),(n=void 0===n?0:n)>this.maxParticles&&(n=this.maxParticles),this.revive(),this.visible=!0,this.lifespan=e,this.frequency=i,t||r)for(var o=0;o<n;o++)this.emitParticle();else this.on=!0,this._quantity=n,this._counter=0,this._timer=this.game.time.time+i*this.game.time.slowMotion;return this},U.Particles.Arcade.Emitter.prototype.emitParticle=function(t,e,i,n){void 0===t&&(t=null),void 0===e&&(e=null);var r=this.getFirstExists(!1);if(null===r)return!1;var o=this.game.rnd;void 0!==i&&void 0!==n?r.loadTexture(i,n):void 0!==i&&r.loadTexture(i);var s=this.emitX,i=this.emitY;null!==t?s=t:1<this.width&&(s=o.between(this.left,this.right)),null!==e?i=e:1<this.height&&(i=o.between(this.top,this.bottom)),r.reset(s,i),r.angle=0,r.lifespan=this.lifespan,this.particleBringToTop?this.bringToTop(r):this.particleSendToBack&&this.sendToBack(r),this.autoScale?r.setScaleData(this.scaleData):1!==this.minParticleScale||1!==this.maxParticleScale?r.scale.set(o.realInRange(this.minParticleScale,this.maxParticleScale)):this._minParticleScale.x===this._maxParticleScale.x&&this._minParticleScale.y===this._maxParticleScale.y||r.scale.set(o.realInRange(this._minParticleScale.x,this._maxParticleScale.x),o.realInRange(this._minParticleScale.y,this._maxParticleScale.y)),void 0===n&&(Array.isArray(this._frames)?r.frame=this.game.rnd.pick(this._frames):r.frame=this._frames),this.autoAlpha?r.setAlphaData(this.alphaData):r.alpha=o.realInRange(this.minParticleAlpha,this.maxParticleAlpha),r.blendMode=this.blendMode;n=r.body;return n.updateBounds(),n.bounce.copyFrom(this.bounce),n.drag.copyFrom(this.particleDrag),n.velocity.x=o.between(this.minParticleSpeed.x,this.maxParticleSpeed.x),n.velocity.y=o.between(this.minParticleSpeed.y,this.maxParticleSpeed.y),n.angularVelocity=o.between(this.minRotation,this.maxRotation),n.gravity.y=this.gravity,n.angularDrag=this.angularDrag,r.onEmit(),!0},U.Particles.Arcade.Emitter.prototype.destroy=function(){this.game.particles.remove(this),U.Group.prototype.destroy.call(this,!0,!1)},U.Particles.Arcade.Emitter.prototype.setSize=function(t,e){return this.area.width=t,this.area.height=e,this},U.Particles.Arcade.Emitter.prototype.setXSpeed=function(t,e){return e=e||0,this.minParticleSpeed.x=t=t||0,this.maxParticleSpeed.x=e,this},U.Particles.Arcade.Emitter.prototype.setYSpeed=function(t,e){return e=e||0,this.minParticleSpeed.y=t=t||0,this.maxParticleSpeed.y=e,this},U.Particles.Arcade.Emitter.prototype.setRotation=function(t,e){return e=e||0,this.minRotation=t=t||0,this.maxRotation=e,this},U.Particles.Arcade.Emitter.prototype.setAlpha=function(t,e,i,n,r){return void 0===e&&(e=1),void 0===i&&(i=0),void 0===n&&(n=U.Easing.Linear.None),void 0===r&&(r=!1),this.minParticleAlpha=t=void 0===t?1:t,this.maxParticleAlpha=e,this.autoAlpha=!1,0<i&&t!==e&&((n=this.game.make.tween({v:t}).to({v:e},i,n)).yoyo(r),this.alphaData=n.generateData(60),this.alphaData.reverse(),this.autoAlpha=!0),this},U.Particles.Arcade.Emitter.prototype.setScale=function(t,e,i,n,r,o,s){return void 0===t&&(t=1),void 0===e&&(e=1),void 0===i&&(i=1),void 0===n&&(n=1),void 0===r&&(r=0),void 0===o&&(o=U.Easing.Linear.None),void 0===s&&(s=!1),this.minParticleScale=1,this.maxParticleScale=1,this._minParticleScale.set(t,i),this._maxParticleScale.set(e,n),this.autoScale=!1,0<r&&(t!==e||i!==n)&&((o=this.game.make.tween({x:t,y:i}).to({x:e,y:n},r,o)).yoyo(s),this.scaleData=o.generateData(60),this.scaleData.reverse(),this.autoScale=!0),this},U.Particles.Arcade.Emitter.prototype.at=function(t){return t.center?(this.emitX=t.center.x,this.emitY=t.center.y):(this.emitX=t.world.x+t.anchor.x*t.width,this.emitY=t.world.y+t.anchor.y*t.height),this},Object.defineProperty(U.Particles.Arcade.Emitter.prototype,"width",{get:function(){return this.area.width},set:function(t){this.area.width=t}}),Object.defineProperty(U.Particles.Arcade.Emitter.prototype,"height",{get:function(){return this.area.height},set:function(t){this.area.height=t}}),Object.defineProperty(U.Particles.Arcade.Emitter.prototype,"x",{get:function(){return this.emitX},set:function(t){this.emitX=t}}),Object.defineProperty(U.Particles.Arcade.Emitter.prototype,"y",{get:function(){return this.emitY},set:function(t){this.emitY=t}}),Object.defineProperty(U.Particles.Arcade.Emitter.prototype,"left",{get:function(){return Math.floor(this.x-this.area.width/2)}}),Object.defineProperty(U.Particles.Arcade.Emitter.prototype,"right",{get:function(){return Math.floor(this.x+this.area.width/2)}}),Object.defineProperty(U.Particles.Arcade.Emitter.prototype,"top",{get:function(){return Math.floor(this.y-this.area.height/2)}}),Object.defineProperty(U.Particles.Arcade.Emitter.prototype,"bottom",{get:function(){return Math.floor(this.y+this.area.height/2)}}),U.Weapon=function(t,e){U.Plugin.call(this,t,e),this.bullets=null,this.autoExpandBulletsGroup=!1,this.autofire=!1,this.shots=0,this.fireLimit=0,this.fireRate=100,this.fireRateVariance=0,this.fireFrom=new U.Rectangle(0,0,1,1),this.fireAngle=U.ANGLE_UP,this.bulletInheritSpriteSpeed=!1,this.bulletAnimation="",this.bulletFrameRandom=!1,this.bulletFrameCycle=!1,this.bulletWorldWrap=!1,this.bulletWorldWrapPadding=0,this.bulletAngleOffset=0,this.bulletAngleVariance=0,this.bulletSpeed=200,this.bulletSpeedVariance=0,this.bulletLifespan=0,this.bulletKillDistance=0,this.bulletGravity=new U.Point(0,0),this.bulletRotateToVelocity=!1,this.bulletKey="",this.bulletFrame="",this._bulletClass=U.Bullet,this._bulletCollideWorldBounds=!1,this._bulletKillType=U.Weapon.KILL_WORLD_BOUNDS,this._data={customBody:!1,width:0,height:0,offsetX:0,offsetY:0},this.bounds=new U.Rectangle,this.bulletBounds=t.world.bounds,this.bulletFrames=[],this.bulletFrameIndex=0,this.anims={},this.onFire=new U.Signal,this.onKill=new U.Signal,this.onFireLimit=new U.Signal,this.trackedSprite=null,this.trackedPointer=null,this.trackRotation=!1,this.trackOffset=new U.Point,this._nextFire=0,this._rotatedPoint=new U.Point},U.Weapon.prototype=Object.create(U.Plugin.prototype),U.Weapon.prototype.constructor=U.Weapon,U.Weapon.KILL_NEVER=0,U.Weapon.KILL_LIFESPAN=1,U.Weapon.KILL_DISTANCE=2,U.Weapon.KILL_WEAPON_BOUNDS=3,U.Weapon.KILL_CAMERA_BOUNDS=4,U.Weapon.KILL_WORLD_BOUNDS=5,U.Weapon.KILL_STATIC_BOUNDS=6,U.Weapon.prototype.createBullets=function(t,e,i,n){return void 0===t&&(t=1),void 0===n&&(n=this.game.world),this.bullets||(this.bullets=this.game.add.physicsGroup(U.Physics.ARCADE,n),this.bullets.classType=this._bulletClass),0!==t&&(-1===t&&(this.autoExpandBulletsGroup=!0,t=1),this.bullets.createMultiple(t,e,i),this.bullets.setAll("data.bulletManager",this),this.bulletKey=e,this.bulletFrame=i),this},U.Weapon.prototype.forEach=function(t,e){return this.bullets.forEachExists(t,e,arguments),this},U.Weapon.prototype.pauseAll=function(){return this.bullets.setAll("body.enable",!1),this},U.Weapon.prototype.resumeAll=function(){return this.bullets.setAll("body.enable",!0),this},U.Weapon.prototype.killAll=function(){return this.bullets.callAllExists("kill",!0),this.bullets.setAll("body.enable",!0),this},U.Weapon.prototype.resetShots=function(t){return void(this.shots=0)!==t&&(this.fireLimit=t),this},U.Weapon.prototype.destroy=function(){this.parent.remove(this,!1),this.bullets.destroy(),this.game=null,this.parent=null,this.active=!1,this.visible=!1},U.Weapon.prototype.update=function(){this._bulletKillType===U.Weapon.KILL_WEAPON_BOUNDS&&(this.trackedSprite?(this.trackedSprite.updateTransform(),this.bounds.centerOn(this.trackedSprite.worldPosition.x,this.trackedSprite.worldPosition.y)):this.trackedPointer&&this.bounds.centerOn(this.trackedPointer.worldX,this.trackedPointer.worldY)),this.autofire&&this.fire()},U.Weapon.prototype.trackSprite=function(t,e,i,n){return void 0===e&&(e=0),void 0===i&&(i=0),void 0===n&&(n=!1),this.trackedPointer=null,this.trackedSprite=t,this.trackRotation=n,this.trackOffset.set(e,i),this},U.Weapon.prototype.trackPointer=function(t,e,i){return void 0===t&&(t=this.game.input.activePointer),void 0===e&&(e=0),void 0===i&&(i=0),this.trackedPointer=t,this.trackedSprite=null,this.trackRotation=!1,this.trackOffset.set(e,i),this},U.Weapon.prototype.fire=function(t,e,i){if(this.game.time.now<this._nextFire||0<this.fireLimit&&this.shots===this.fireLimit)return!1;var n=this.bulletSpeed;0!==this.bulletSpeedVariance&&(n+=U.Math.between(-this.bulletSpeedVariance,this.bulletSpeedVariance)),t?1<this.fireFrom.width?this.fireFrom.centerOn(t.x,t.y):(this.fireFrom.x=t.x,this.fireFrom.y=t.y):this.trackedSprite?(this.trackRotation?(this._rotatedPoint.set(this.trackedSprite.world.x+this.trackOffset.x,this.trackedSprite.world.y+this.trackOffset.y),this._rotatedPoint.rotate(this.trackedSprite.world.x,this.trackedSprite.world.y,this.trackedSprite.rotation),1<this.fireFrom.width?this.fireFrom.centerOn(this._rotatedPoint.x,this._rotatedPoint.y):(this.fireFrom.x=this._rotatedPoint.x,this.fireFrom.y=this._rotatedPoint.y)):1<this.fireFrom.width?this.fireFrom.centerOn(this.trackedSprite.world.x+this.trackOffset.x,this.trackedSprite.world.y+this.trackOffset.y):(this.fireFrom.x=this.trackedSprite.world.x+this.trackOffset.x,this.fireFrom.y=this.trackedSprite.world.y+this.trackOffset.y),this.bulletInheritSpriteSpeed&&(n+=this.trackedSprite.body.speed)):this.trackedPointer&&(1<this.fireFrom.width?this.fireFrom.centerOn(this.trackedPointer.world.x+this.trackOffset.x,this.trackedPointer.world.y+this.trackOffset.y):(this.fireFrom.x=this.trackedPointer.world.x+this.trackOffset.x,this.fireFrom.y=this.trackedPointer.world.y+this.trackOffset.y));var r=1<this.fireFrom.width?this.fireFrom.randomX:this.fireFrom.x,o=1<this.fireFrom.height?this.fireFrom.randomY:this.fireFrom.y,s=this.trackRotation?this.trackedSprite.angle:this.fireAngle;void 0!==e&&void 0!==i&&(s=this.game.math.radToDeg(Math.atan2(i-o,e-r))),0!==this.bulletAngleVariance&&(s+=U.Math.between(-this.bulletAngleVariance,this.bulletAngleVariance));t=0,i=0;0===s||180===s?t=Math.cos(this.game.math.degToRad(s))*n:i=(90===s||270===s||(t=Math.cos(this.game.math.degToRad(s))*n),Math.sin(this.game.math.degToRad(s))*n);e=null;return this.autoExpandBulletsGroup?(e=this.bullets.getFirstExists(!1,!0,r,o,this.bulletKey,this.bulletFrame)).data.bulletManager=this:e=this.bullets.getFirstExists(!1),e&&(e.reset(r,o),e.data.fromX=r,e.data.fromY=o,e.data.killType=this.bulletKillType,e.data.killDistance=this.bulletKillDistance,e.data.rotateToVelocity=this.bulletRotateToVelocity,this.bulletKillType===U.Weapon.KILL_LIFESPAN&&(e.lifespan=this.bulletLifespan),e.angle=s+this.bulletAngleOffset,""!==this.bulletAnimation?(null===e.animations.getAnimation(this.bulletAnimation)&&(s=this.anims[this.bulletAnimation],e.animations.add(s.name,s.frames,s.frameRate,s.loop,s.useNumericIndex)),e.animations.play(this.bulletAnimation)):this.bulletFrameCycle?(e.frame=this.bulletFrames[this.bulletFrameIndex],this.bulletFrameIndex++,this.bulletFrameIndex>=this.bulletFrames.length&&(this.bulletFrameIndex=0)):this.bulletFrameRandom&&(e.frame=this.bulletFrames[Math.floor(Math.random()*this.bulletFrames.length)]),e.data.bodyDirty&&(this._data.customBody&&e.body.setSize(this._data.width,this._data.height,this._data.offsetX,this._data.offsetY),e.body.collideWorldBounds=this.bulletCollideWorldBounds,e.data.bodyDirty=!1),e.body.velocity.set(t,i),e.body.gravity.set(this.bulletGravity.x,this.bulletGravity.y),0!==this.bulletSpeedVariance?(i=this.fireRate,i+=U.Math.between(-this.fireRateVariance,this.fireRateVariance),this._nextFire=this.game.time.now+(i=i<0?0:i)):this._nextFire=this.game.time.now+this.fireRate,this.shots++,this.onFire.dispatch(e,this,n),0<this.fireLimit&&this.shots===this.fireLimit&&this.onFireLimit.dispatch(this,this.fireLimit)),e},U.Weapon.prototype.fireAtPointer=function(t){return void 0===t&&(t=this.game.input.activePointer),this.fire(null,t.worldX,t.worldY)},U.Weapon.prototype.fireAtSprite=function(t){return this.fire(null,t.world.x,t.world.y)},U.Weapon.prototype.fireAtXY=function(t,e){return this.fire(null,t,e)},U.Weapon.prototype.setBulletBodyOffset=function(t,e,i,n){return void 0===i&&(i=0),void 0===n&&(n=0),this._data.customBody=!0,this._data.width=t,this._data.height=e,this._data.offsetX=i,this._data.offsetY=n,this.bullets.callAll("body.setSize","body",t,e,i,n),this.bullets.setAll("data.bodyDirty",!1),this},U.Weapon.prototype.setBulletFrames=function(t,e,i,n){return void 0===i&&(i=!0),void 0===n&&(n=!1),this.bulletFrames=U.ArrayUtils.numberArray(t,e),this.bulletFrameIndex=0,this.bulletFrameCycle=i,this.bulletFrameRandom=n,this},U.Weapon.prototype.addBulletAnimation=function(t,e,i,n,r){return this.anims[t]={name:t,frames:e,frameRate:i,loop:n,useNumericIndex:r},this.bullets.callAll("animations.add","animations",t,e,i,n,r),this.bulletAnimation=t,this},U.Weapon.prototype.debug=function(t,e,i){void 0===i&&(i=!1),this.game.debug.text("Weapon Plugin",t=void 0===t?16:t,e=void 0===e?32:e),this.game.debug.text("Bullets Alive: "+this.bullets.total+" - Total: "+this.bullets.length,t,e+24),i&&this.bullets.forEachExists(this.game.debug.body,this.game.debug,"rgba(255, 0, 255, 0.8)")},Object.defineProperty(U.Weapon.prototype,"bulletClass",{get:function(){return this._bulletClass},set:function(t){this._bulletClass=t,this.bullets.classType=this._bulletClass}}),Object.defineProperty(U.Weapon.prototype,"bulletKillType",{get:function(){return this._bulletKillType},set:function(t){switch(t){case U.Weapon.KILL_STATIC_BOUNDS:case U.Weapon.KILL_WEAPON_BOUNDS:this.bulletBounds=this.bounds;break;case U.Weapon.KILL_CAMERA_BOUNDS:this.bulletBounds=this.game.camera.view;break;case U.Weapon.KILL_WORLD_BOUNDS:this.bulletBounds=this.game.world.bounds}this._bulletKillType=t}}),Object.defineProperty(U.Weapon.prototype,"bulletCollideWorldBounds",{get:function(){return this._bulletCollideWorldBounds},set:function(t){this._bulletCollideWorldBounds=t,this.bullets.setAll("body.collideWorldBounds",t),this.bullets.setAll("data.bodyDirty",!1)}}),Object.defineProperty(U.Weapon.prototype,"x",{get:function(){return this.fireFrom.x},set:function(t){this.fireFrom.x=t}}),Object.defineProperty(U.Weapon.prototype,"y",{get:function(){return this.fireFrom.y},set:function(t){this.fireFrom.y=t}}),U.Bullet=function(t,e,i,n,r){U.Sprite.call(this,t,e,i,n,r),this.anchor.set(.5),this.data={bulletManager:null,fromX:0,fromY:0,bodyDirty:!0,rotateToVelocity:!1,killType:0,killDistance:0}},U.Bullet.prototype=Object.create(U.Sprite.prototype),U.Bullet.prototype.constructor=U.Bullet,U.Bullet.prototype.kill=function(){return this.alive=!1,this.exists=!1,this.visible=!1,this.data.bulletManager.onKill.dispatch(this),this},U.Bullet.prototype.update=function(){this.exists&&(this.data.killType>U.Weapon.KILL_LIFESPAN&&(this.data.killType===U.Weapon.KILL_DISTANCE?this.game.physics.arcade.distanceToXY(this,this.data.fromX,this.data.fromY,!0)>this.data.killDistance&&this.kill():this.data.bulletManager.bulletBounds.intersects(this)||this.kill()),this.data.rotateToVelocity&&(this.rotation=Math.atan2(this.body.velocity.y,this.body.velocity.x)),this.data.bulletManager.bulletWorldWrap&&this.game.world.wrap(this,this.data.bulletManager.bulletWorldWrapPadding))},U.Video=function(t,e,i){var n;void 0===e&&(e=null),void 0===i&&(i=null),this.game=t,this.key=e,this.width=0,this.height=0,this.type=U.VIDEO,this.disableTextureUpload=!1,this.touchLocked=!1,this.onPlay=new U.Signal,this.onChangeSource=new U.Signal,this.onComplete=new U.Signal,this.onAccess=new U.Signal,this.onError=new U.Signal,this.onTimeout=new U.Signal,this.timeout=15e3,this._timeOutID=null,this.video=null,this.videoStream=null,this.isStreaming=!1,this.retryLimit=20,this.retry=0,this.retryInterval=500,this._retryID=null,this._codeMuted=!1,this._muted=!1,this._codePaused=!1,this._paused=!1,this._pending=!1,this._autoplay=!1,this._endCallback=null,this._playCallback=null,e&&this.game.cache.checkVideoKey(e)?((n=this.game.cache.getVideo(e)).isBlob?this.createVideoFromBlob(n.data):this.video=n.data,this.width=this.video.videoWidth,this.height=this.video.videoHeight):i&&this.createVideoFromURL(i,!1),this.video&&!i?this.baseTexture=new PIXI.BaseTexture(this.video):this.baseTexture=new PIXI.BaseTexture(U.Cache.DEFAULT.baseTexture.source),this.baseTexture.forceLoaded(this.width,this.height),this.texture=new PIXI.Texture(this.baseTexture),this.textureFrame=new U.Frame(0,0,0,this.width,this.height,"video"),this.texture.setFrame(this.textureFrame),this.texture.valid=!1,null!==e&&this.video&&(this.texture.valid=this.video.canplay),this.snapshot=null,U.BitmapData&&(this.snapshot=new U.BitmapData(this.game,"",this.width,this.height)),!this.game.device.cocoonJS&&(this.game.device.iOS||this.game.device.android)||window.PhaserGlobal&&window.PhaserGlobal.fakeiOSTouchLock?this.setTouchLock():n&&(n.locked=!1)},U.Video.prototype={connectToMediaStream:function(t,e){return t&&e&&(this.video=t,this.videoStream=e,this.isStreaming=!0,this.baseTexture.source=this.video,this.updateTexture(null,this.video.videoWidth,this.video.videoHeight),this.onAccess.dispatch(this)),this},startMediaStream:function(t,e,i){if(void 0===t&&(t=!1),void 0===e&&(e=null),void 0===i&&(i=null),!this.game.device.getUserMedia)return this.onError.dispatch(this,"No getUserMedia"),!1;null!==this.videoStream&&(this.videoStream.active?this.videoStream.active=!1:this.videoStream.stop()),this.removeVideoElement(),this.video=document.createElement("video"),this.video.setAttribute("autoplay","autoplay"),null!==e&&(this.video.width=e),null!==i&&(this.video.height=i),this._timeOutID=window.setTimeout(this.getUserMediaTimeout.bind(this),this.timeout);try{navigator.getUserMedia({audio:t,video:!0},this.getUserMediaSuccess.bind(this),this.getUserMediaError.bind(this))}catch(t){this.getUserMediaError(t)}return this},getUserMediaTimeout:function(){clearTimeout(this._timeOutID),this.onTimeout.dispatch(this)},getUserMediaError:function(t){clearTimeout(this._timeOutID),this.onError.dispatch(this,t)},getUserMediaSuccess:function(t){clearTimeout(this._timeOutID),this.videoStream=t,void 0!==this.video.mozSrcObject?this.video.mozSrcObject=t:this.video.src=window.URL&&window.URL.createObjectURL(t)||t;var r=this;this.video.onloadeddata=function(){var n=10;!function t(){var e,i;0<n&&(0<r.video.videoWidth?(e=r.video.videoWidth,i=r.video.videoHeight,isNaN(r.video.videoHeight)&&(i=e/(4/3)),r.video.play(),r.isStreaming=!0,r.baseTexture.source=r.video,r.updateTexture(null,e,i),r.onAccess.dispatch(r)):window.setTimeout(t,500)),n--}()}},createVideoFromBlob:function(t){var e=this;return this.video=document.createElement("video"),this.video.controls=!1,this.video.setAttribute("autoplay","autoplay"),this.video.addEventListener("loadeddata",function(t){e.updateTexture(t)},!0),this.video.src=window.URL.createObjectURL(t),this.video.canplay=!0,this},createVideoFromURL:function(t,e){return void 0===e&&(e=!1),this.texture&&(this.texture.valid=!1),this.video=document.createElement("video"),this.video.controls=!1,e&&this.video.setAttribute("autoplay","autoplay"),this.video.src=t,this.video.canplay=!0,this.video.load(),this.retry=this.retryLimit,this._retryID=window.setTimeout(this.checkVideoProgress.bind(this),this.retryInterval),this.key=t,this},updateTexture:function(t,e,i){var n=!1;null==e&&(e=this.video.videoWidth,n=!0),null==i&&(i=this.video.videoHeight),this.width=e,this.height=i,this.baseTexture.source!==this.video&&(this.baseTexture.source=this.video),this.baseTexture.forceLoaded(e,i),this.texture.frame.resize(e,i),this.texture.width=e,this.texture.height=i,this.texture.valid=!0,this.snapshot&&this.snapshot.resize(e,i),n&&null!==this.key&&(this.onChangeSource.dispatch(this,e,i),this._autoplay&&(this.video.play(),this.onPlay.dispatch(this,this.loop,this.playbackRate)))},complete:function(){this.onComplete.dispatch(this)},play:function(t,e){return void 0===t&&(t=!1),void 0===e&&(e=1),this.game.sound.onMute&&(this.game.sound.onMute.add(this.setMute,this),this.game.sound.onUnMute.add(this.unsetMute,this),this.game.sound.mute&&this.setMute()),this.game.onPause.add(this.setPause,this),this.game.onResume.add(this.setResume,this),this._endCallback=this.complete.bind(this),this.video.addEventListener("ended",this._endCallback,!0),this.video.addEventListener("webkitendfullscreen",this._endCallback,!0),this.video.loop=t?"loop":"",this.video.playbackRate=e,this.touchLocked?this._pending=!0:(this._pending=!1,null!==this.key&&(4!==this.video.readyState?(this.retry=this.retryLimit,this._retryID=window.setTimeout(this.checkVideoProgress.bind(this),this.retryInterval)):(this._playCallback=this.playHandler.bind(this),this.video.addEventListener("playing",this._playCallback,!0))),this.video.play(),this.onPlay.dispatch(this,t,e)),this},playHandler:function(){this.video.removeEventListener("playing",this._playCallback,!0),this.updateTexture()},stop:function(){return this.game.sound.onMute&&(this.game.sound.onMute.remove(this.setMute,this),this.game.sound.onUnMute.remove(this.unsetMute,this)),this.game.onPause.remove(this.setPause,this),this.game.onResume.remove(this.setResume,this),this.isStreaming?(this.video.mozSrcObject?(this.video.mozSrcObject.stop(),this.video.src=null):(this.video.src="",this.videoStream.active?this.videoStream.active=!1:this.videoStream.getTracks?this.videoStream.getTracks().forEach(function(t){t.stop()}):this.videoStream.stop()),this.videoStream=null,this.isStreaming=!1):(this.video.removeEventListener("ended",this._endCallback,!0),this.video.removeEventListener("webkitendfullscreen",this._endCallback,!0),this.video.removeEventListener("playing",this._playCallback,!0),this.touchLocked?this._pending=!1:this.video.pause()),this},add:function(t){if(Array.isArray(t))for(var e=0;e<t.length;e++)t[e].loadTexture&&t[e].loadTexture(this);else t.loadTexture(this);return this},addToWorld:function(t,e,i,n,r,o){r=r||1,o=o||1;e=this.game.add.image(t,e,this);return e.anchor.set(i,n),e.scale.set(r,o),e},render:function(){!this.disableTextureUpload&&this.playing&&this.baseTexture.dirty()},setMute:function(){this._muted||(this._muted=!0,this.video.muted=!0)},unsetMute:function(){this._muted&&!this._codeMuted&&(this._muted=!1,this.video.muted=!1)},setPause:function(){this._paused||this.touchLocked||(this._paused=!0,this.video.pause())},setResume:function(){!this._paused||this._codePaused||this.touchLocked||(this._paused=!1,this.video.ended||this.video.play())},changeSource:function(t,e){return void 0===e&&(e=!0),this.texture.valid=!1,this.video.pause(),this.retry=this.retryLimit,this._retryID=window.setTimeout(this.checkVideoProgress.bind(this),this.retryInterval),this.video.src=t,this.video.load(),(this._autoplay=e)||(this.paused=!0),this},checkVideoProgress:function(){4===this.video.readyState?this.updateTexture():(this.retry--,0<this.retry&&(this._retryID=window.setTimeout(this.checkVideoProgress.bind(this),this.retryInterval)))},setTouchLock:function(){this.game.input.touch.addTouchLockCallback(this.unlock,this),this.touchLocked=!0},unlock:function(){var t;return this.touchLocked=!1,this.video.play(),this.onPlay.dispatch(this,this.loop,this.playbackRate),!this.key||(t=this.game.cache.getVideo(this.key))&&!t.isBlob&&(t.locked=!1),!0},grab:function(t,e,i){if(void 0===t&&(t=!1),void 0===e&&(e=1),void 0===i&&(i=null),null!==this.snapshot)return t&&this.snapshot.cls(),this.snapshot.copy(this.video,0,0,this.width,this.height,0,0,this.width,this.height,0,0,0,1,1,e,i),this.snapshot},removeVideoElement:function(){if(this.video){for(this.video.parentNode&&this.video.parentNode.removeChild(this.video);this.video.hasChildNodes();)this.video.removeChild(this.video.firstChild);this.video.removeAttribute("autoplay"),this.video.removeAttribute("src"),this.video=null}},destroy:function(){this.stop(),this.removeVideoElement(),this.touchLocked&&this.game.input.touch.removeTouchLockCallback(this.unlock,this),this._retryID&&window.clearTimeout(this._retryID)}},Object.defineProperty(U.Video.prototype,"currentTime",{get:function(){return this.video?this.video.currentTime:0},set:function(t){this.video.currentTime=t}}),Object.defineProperty(U.Video.prototype,"duration",{get:function(){return this.video?this.video.duration:0}}),Object.defineProperty(U.Video.prototype,"progress",{get:function(){return this.video?this.video.currentTime/this.video.duration:0}}),Object.defineProperty(U.Video.prototype,"mute",{get:function(){return this._muted},set:function(t){(t=t||null)?this._muted||(this._codeMuted=!0,this.setMute()):this._muted&&(this._codeMuted=!1,this.unsetMute())}}),Object.defineProperty(U.Video.prototype,"paused",{get:function(){return this._paused},set:function(t){t=t||null,this.touchLocked||(t?this._paused||(this._codePaused=!0,this.setPause()):this._paused&&(this._codePaused=!1,this.setResume()))}}),Object.defineProperty(U.Video.prototype,"volume",{get:function(){return this.video?this.video.volume:1},set:function(t){t<0?t=0:1<t&&(t=1),this.video&&(this.video.volume=t)}}),Object.defineProperty(U.Video.prototype,"playbackRate",{get:function(){return this.video?this.video.playbackRate:1},set:function(t){this.video&&(this.video.playbackRate=t)}}),Object.defineProperty(U.Video.prototype,"loop",{get:function(){return!!this.video&&this.video.loop},set:function(t){t&&this.video?this.video.loop="loop":this.video&&(this.video.loop="")}}),Object.defineProperty(U.Video.prototype,"playing",{get:function(){return!(this.video.paused&&this.video.ended)}}),U.Video.prototype.constructor=U.Video,void 0===PIXI.blendModes&&(PIXI.blendModes=U.blendModes),void 0===PIXI.scaleModes&&(PIXI.scaleModes=U.scaleModes),void 0===PIXI.Texture.emptyTexture&&(PIXI.Texture.emptyTexture=new PIXI.Texture(new PIXI.BaseTexture)),void 0===PIXI.DisplayObject._tempMatrix&&(PIXI.DisplayObject._tempMatrix=new PIXI.Matrix),void 0===PIXI.RenderTexture.tempMatrix&&(PIXI.RenderTexture.tempMatrix=new PIXI.Matrix),PIXI.Graphics&&void 0===PIXI.Graphics.POLY&&(PIXI.Graphics.POLY=U.POLYGON,PIXI.Graphics.RECT=U.RECTANGLE,PIXI.Graphics.CIRC=U.CIRCLE,PIXI.Graphics.ELIP=U.ELLIPSE,PIXI.Graphics.RREC=U.ROUNDEDRECTANGLE),PIXI.TextureSilentFail=!0,"undefined"!=typeof exports?(exports="undefined"!=typeof module&&module.exports?module.exports=U:exports).Phaser=U:"undefined"!=typeof define&&define.amd?define("Phaser",n.Phaser=U):n.Phaser=U,U}.call(this),function(t,e){"use strict";"object"==typeof module&&"object"==typeof module.exports?module.exports=t.document?e(t,!0):function(t){if(!t.document)throw new Error("jQuery requires a window with a document");return e(t)}:e(t)}("undefined"!=typeof window?window:this,function(z,t){"use strict";var e=[],b=z.document,i=Object.getPrototypeOf,a=e.slice,_=e.concat,h=e.push,r=e.indexOf,n={},o=n.toString,y=n.hasOwnProperty,s=y.toString,l=s.call(Object),m={};function g(t,e){var i=(e=e||b).createElement("script");i.text=t,e.head.appendChild(i).parentNode.removeChild(i)}function p(t,e){return e.toUpperCase()}var S=function(t,e){return new S.fn.init(t,e)},u=/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,d=/^-ms-/,c=/-([a-z])/g;function f(t){var e=!!t&&"length"in t&&t.length,i=S.type(t);return"function"!==i&&!S.isWindow(t)&&("array"===i||0===e||"number"==typeof e&&0<e&&e-1 in t)}S.fn=S.prototype={jquery:"3.1.1",constructor:S,length:0,toArray:function(){return a.call(this)},get:function(t){return null==t?a.call(this):t<0?this[t+this.length]:this[t]},pushStack:function(t){t=S.merge(this.constructor(),t);return t.prevObject=this,t},each:function(t){return S.each(this,t)},map:function(i){return this.pushStack(S.map(this,function(t,e){return i.call(t,e,t)}))},slice:function(){return this.pushStack(a.apply(this,arguments))},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},eq:function(t){var e=this.length,t=+t+(t<0?e:0);return this.pushStack(0<=t&&t<e?[this[t]]:[])},end:function(){return this.prevObject||this.constructor()},push:h,sort:e.sort,splice:e.splice},S.extend=S.fn.extend=function(){var t,e,i,n,r,o=arguments[0]||{},s=1,a=arguments.length,h=!1;for("boolean"==typeof o&&(h=o,o=arguments[s]||{},s++),"object"==typeof o||S.isFunction(o)||(o={}),s===a&&(o=this,s--);s<a;s++)if(null!=(t=arguments[s]))for(e in t)r=o[e],i=t[e],o!==i&&(h&&i&&(S.isPlainObject(i)||(n=S.isArray(i)))?(r=n?(n=!1,r&&S.isArray(r)?r:[]):r&&S.isPlainObject(r)?r:{},o[e]=S.extend(h,r,i)):void 0!==i&&(o[e]=i));return o},S.extend({expando:"jQuery"+("3.1.1"+Math.random()).replace(/\D/g,""),isReady:!0,error:function(t){throw new Error(t)},noop:function(){},isFunction:function(t){return"function"===S.type(t)},isArray:Array.isArray,isWindow:function(t){return null!=t&&t===t.window},isNumeric:function(t){var e=S.type(t);return("number"===e||"string"===e)&&!isNaN(t-parseFloat(t))},isPlainObject:function(t){return!(!t||"[object Object]"!==o.call(t)||(t=i(t))&&("function"!=typeof(t=y.call(t,"constructor")&&t.constructor)||s.call(t)!==l))},isEmptyObject:function(t){for(var e in t)return!1;return!0},type:function(t){return null==t?t+"":"object"==typeof t||"function"==typeof t?n[o.call(t)]||"object":typeof t},globalEval:function(t){g(t)},camelCase:function(t){return t.replace(d,"ms-").replace(c,p)},nodeName:function(t,e){return t.nodeName&&t.nodeName.toLowerCase()===e.toLowerCase()},each:function(t,e){var i,n=0;if(f(t))for(i=t.length;n<i&&!1!==e.call(t[n],n,t[n]);n++);else for(n in t)if(!1===e.call(t[n],n,t[n]))break;return t},trim:function(t){return null==t?"":(t+"").replace(u,"")},makeArray:function(t,e){e=e||[];return null!=t&&(f(Object(t))?S.merge(e,"string"==typeof t?[t]:t):h.call(e,t)),e},inArray:function(t,e,i){return null==e?-1:r.call(e,t,i)},merge:function(t,e){for(var i=+e.length,n=0,r=t.length;n<i;n++)t[r++]=e[n];return t.length=r,t},grep:function(t,e,i){for(var n=[],r=0,o=t.length,s=!i;r<o;r++)!e(t[r],r)!=s&&n.push(t[r]);return n},map:function(t,e,i){var n,r,o=0,s=[];if(f(t))for(n=t.length;o<n;o++)null!=(r=e(t[o],o,i))&&s.push(r);else for(o in t)r=e(t[o],o,i),null!=r&&s.push(r);return _.apply([],s)},guid:1,proxy:function(t,e){var i,n;if("string"==typeof e&&(n=t[e],e=t,t=n),S.isFunction(t))return i=a.call(arguments,2),(n=function(){return t.apply(e||this,i.concat(a.call(arguments)))}).guid=t.guid=t.guid||S.guid++,n},now:Date.now,support:m}),"function"==typeof Symbol&&(S.fn[Symbol.iterator]=e[Symbol.iterator]),S.each("Boolean Number String Function Array Date RegExp Object Error Symbol".split(" "),function(t,e){n["[object "+e+"]"]=e.toLowerCase()});var x=function(i){function u(t,e,i){var n="0x"+e-65536;return n!=n||i?e:n<0?String.fromCharCode(65536+n):String.fromCharCode(n>>10|55296,1023&n|56320)}function c(t,e){return e?"\0"===t?"":t.slice(0,-1)+"\\"+t.charCodeAt(t.length-1).toString(16)+" ":"\\"+t}function n(){z()}var t,y,v,o,r,_,d,m,w,h,l,z,b,s,S,g,a,p,f,C="sizzle"+ +new Date,x=i.document,P=0,M=0,T=st(),A=st(),k=st(),O=function(t,e){return t===e&&(l=!0),0},E={}.hasOwnProperty,e=[],I=e.pop,G=e.push,D=e.push,L=e.slice,B=function(t,e){for(var i=0,n=t.length;i<n;i++)if(t[i]===e)return i;return-1},R="checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped",F="[\\x20\\t\\r\\n\\f]",N="(?:\\\\.|[\\w-]|[^\0-\\xa0])+",j="\\["+F+"*("+N+")(?:"+F+"*([*^$|!~]?=)"+F+"*(?:'((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\"|("+N+"))|)"+F+"*\\]",U=":("+N+")(?:\\((('((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\")|((?:\\\\.|[^\\\\()[\\]]|"+j+")*)|.*)\\)|)",V=new RegExp(F+"+","g"),W=new RegExp("^"+F+"+|((?:^|[^\\\\])(?:\\\\.)*)"+F+"+$","g"),X=new RegExp("^"+F+"*,"+F+"*"),H=new RegExp("^"+F+"*([>+~]|"+F+")"+F+"*"),q=new RegExp("="+F+"*([^\\]'\"]*?)"+F+"*\\]","g"),Y=new RegExp(U),K=new RegExp("^"+N+"$"),Z={ID:new RegExp("^#("+N+")"),CLASS:new RegExp("^\\.("+N+")"),TAG:new RegExp("^("+N+"|[*])"),ATTR:new RegExp("^"+j),PSEUDO:new RegExp("^"+U),CHILD:new RegExp("^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\("+F+"*(even|odd|(([+-]|)(\\d*)n|)"+F+"*(?:([+-]|)"+F+"*(\\d+)|))"+F+"*\\)|)","i"),bool:new RegExp("^(?:"+R+")$","i"),needsContext:new RegExp("^"+F+"*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\("+F+"*((?:-\\d)?\\d*)"+F+"*\\)|)(?=[^-]|$)","i")},J=/^(?:input|select|textarea|button)$/i,Q=/^h\d$/i,$=/^[^{]+\{\s*\[native \w/,tt=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,et=/[+~]/,it=new RegExp("\\\\([\\da-f]{1,6}"+F+"?|("+F+")|.)","ig"),nt=/([\0-\x1f\x7f]|^-?\d)|^-$|[^\0-\x1f\x7f-\uFFFF\w-]/g,rt=mt(function(t){return!0===t.disabled&&("form"in t||"label"in t)},{dir:"parentNode",next:"legend"});try{D.apply(e=L.call(x.childNodes),x.childNodes),e[x.childNodes.length].nodeType}catch(t){D={apply:e.length?function(t,e){G.apply(t,L.call(e))}:function(t,e){for(var i=t.length,n=0;t[i++]=e[n++];);t.length=i-1}}}function ot(t,e,i,n){var r,o,s,a,h,l,p,u=e&&e.ownerDocument,d=e?e.nodeType:9;if(i=i||[],"string"!=typeof t||!t||1!==d&&9!==d&&11!==d)return i;if(!n&&((e?e.ownerDocument||e:x)!==b&&z(e),e=e||b,S)){if(11!==d&&(h=tt.exec(t)))if(r=h[1]){if(9===d){if(!(s=e.getElementById(r)))return i;if(s.id===r)return i.push(s),i}else if(u&&(s=u.getElementById(r))&&f(e,s)&&s.id===r)return i.push(s),i}else{if(h[2])return D.apply(i,e.getElementsByTagName(t)),i;if((r=h[3])&&y.getElementsByClassName&&e.getElementsByClassName)return D.apply(i,e.getElementsByClassName(r)),i}if(y.qsa&&!k[t+" "]&&(!g||!g.test(t))){if(1!==d)u=e,p=t;else if("object"!==e.nodeName.toLowerCase()){for((a=e.getAttribute("id"))?a=a.replace(nt,c):e.setAttribute("id",a=C),o=(l=_(t)).length;o--;)l[o]="#"+a+" "+_t(l[o]);p=l.join(","),u=et.test(t)&&ct(e.parentNode)||e}if(p)try{return D.apply(i,u.querySelectorAll(p)),i}catch(t){}finally{a===C&&e.removeAttribute("id")}}}return m(t.replace(W,"$1"),e,i,n)}function st(){var i=[];function n(t,e){return i.push(t+" ")>v.cacheLength&&delete n[i.shift()],n[t+" "]=e}return n}function at(t){return t[C]=!0,t}function ht(t){var e=b.createElement("fieldset");try{return!!t(e)}catch(t){return!1}finally{e.parentNode&&e.parentNode.removeChild(e)}}function lt(t,e){for(var i=t.split("|"),n=i.length;n--;)v.attrHandle[i[n]]=e}function pt(t,e){var i=e&&t,n=i&&1===t.nodeType&&1===e.nodeType&&t.sourceIndex-e.sourceIndex;if(n)return n;if(i)for(;i=i.nextSibling;)if(i===e)return-1;return t?1:-1}function ut(e){return function(t){return"form"in t?t.parentNode&&!1===t.disabled?"label"in t?"label"in t.parentNode?t.parentNode.disabled===e:t.disabled===e:t.isDisabled===e||t.isDisabled!==!e&&rt(t)===e:t.disabled===e:"label"in t&&t.disabled===e}}function dt(s){return at(function(o){return o=+o,at(function(t,e){for(var i,n=s([],t.length,o),r=n.length;r--;)t[i=n[r]]&&(t[i]=!(e[i]=t[i]))})})}function ct(t){return t&&void 0!==t.getElementsByTagName&&t}for(t in y=ot.support={},r=ot.isXML=function(t){t=t&&(t.ownerDocument||t).documentElement;return!!t&&"HTML"!==t.nodeName},z=ot.setDocument=function(t){var e,t=t?t.ownerDocument||t:x;return t!==b&&9===t.nodeType&&t.documentElement&&(s=(b=t).documentElement,S=!r(b),x!==b&&(e=b.defaultView)&&e.top!==e&&(e.addEventListener?e.addEventListener("unload",n,!1):e.attachEvent&&e.attachEvent("onunload",n)),y.attributes=ht(function(t){return t.className="i",!t.getAttribute("className")}),y.getElementsByTagName=ht(function(t){return t.appendChild(b.createComment("")),!t.getElementsByTagName("*").length}),y.getElementsByClassName=$.test(b.getElementsByClassName),y.getById=ht(function(t){return s.appendChild(t).id=C,!b.getElementsByName||!b.getElementsByName(C).length}),y.getById?(v.filter.ID=function(t){var e=t.replace(it,u);return function(t){return t.getAttribute("id")===e}},v.find.ID=function(t,e){if(void 0!==e.getElementById&&S){t=e.getElementById(t);return t?[t]:[]}}):(v.filter.ID=function(t){var e=t.replace(it,u);return function(t){t=void 0!==t.getAttributeNode&&t.getAttributeNode("id");return t&&t.value===e}},v.find.ID=function(t,e){if(void 0!==e.getElementById&&S){var i,n,r,o=e.getElementById(t);if(o){if((i=o.getAttributeNode("id"))&&i.value===t)return[o];for(r=e.getElementsByName(t),n=0;o=r[n++];)if((i=o.getAttributeNode("id"))&&i.value===t)return[o]}return[]}}),v.find.TAG=y.getElementsByTagName?function(t,e){return void 0!==e.getElementsByTagName?e.getElementsByTagName(t):y.qsa?e.querySelectorAll(t):void 0}:function(t,e){var i,n=[],r=0,o=e.getElementsByTagName(t);if("*"!==t)return o;for(;i=o[r++];)1===i.nodeType&&n.push(i);return n},v.find.CLASS=y.getElementsByClassName&&function(t,e){if(void 0!==e.getElementsByClassName&&S)return e.getElementsByClassName(t)},a=[],g=[],(y.qsa=$.test(b.querySelectorAll))&&(ht(function(t){s.appendChild(t).innerHTML="<a id='"+C+"'></a><select id='"+C+"-\r\\' msallowcapture=''><option selected=''></option></select>",t.querySelectorAll("[msallowcapture^='']").length&&g.push("[*^$]="+F+"*(?:''|\"\")"),t.querySelectorAll("[selected]").length||g.push("\\["+F+"*(?:value|"+R+")"),t.querySelectorAll("[id~="+C+"-]").length||g.push("~="),t.querySelectorAll(":checked").length||g.push(":checked"),t.querySelectorAll("a#"+C+"+*").length||g.push(".#.+[+~]")}),ht(function(t){t.innerHTML="<a href='' disabled='disabled'></a><select disabled='disabled'><option/></select>";var e=b.createElement("input");e.setAttribute("type","hidden"),t.appendChild(e).setAttribute("name","D"),t.querySelectorAll("[name=d]").length&&g.push("name"+F+"*[*^$|!~]?="),2!==t.querySelectorAll(":enabled").length&&g.push(":enabled",":disabled"),s.appendChild(t).disabled=!0,2!==t.querySelectorAll(":disabled").length&&g.push(":enabled",":disabled"),t.querySelectorAll("*,:x"),g.push(",.*:")})),(y.matchesSelector=$.test(p=s.matches||s.webkitMatchesSelector||s.mozMatchesSelector||s.oMatchesSelector||s.msMatchesSelector))&&ht(function(t){y.disconnectedMatch=p.call(t,"*"),p.call(t,"[s!='']:x"),a.push("!=",U)}),g=g.length&&new RegExp(g.join("|")),a=a.length&&new RegExp(a.join("|")),e=$.test(s.compareDocumentPosition),f=e||$.test(s.contains)?function(t,e){var i=9===t.nodeType?t.documentElement:t,e=e&&e.parentNode;return t===e||!(!e||1!==e.nodeType||!(i.contains?i.contains(e):t.compareDocumentPosition&&16&t.compareDocumentPosition(e)))}:function(t,e){if(e)for(;e=e.parentNode;)if(e===t)return!0;return!1},O=e?function(t,e){if(t===e)return l=!0,0;var i=!t.compareDocumentPosition-!e.compareDocumentPosition;return i||(1&(i=(t.ownerDocument||t)===(e.ownerDocument||e)?t.compareDocumentPosition(e):1)||!y.sortDetached&&e.compareDocumentPosition(t)===i?t===b||t.ownerDocument===x&&f(x,t)?-1:e===b||e.ownerDocument===x&&f(x,e)?1:h?B(h,t)-B(h,e):0:4&i?-1:1)}:function(t,e){if(t===e)return l=!0,0;var i,n=0,r=t.parentNode,o=e.parentNode,s=[t],a=[e];if(!r||!o)return t===b?-1:e===b?1:r?-1:o?1:h?B(h,t)-B(h,e):0;if(r===o)return pt(t,e);for(i=t;i=i.parentNode;)s.unshift(i);for(i=e;i=i.parentNode;)a.unshift(i);for(;s[n]===a[n];)n++;return n?pt(s[n],a[n]):s[n]===x?-1:a[n]===x?1:0}),b},ot.matches=function(t,e){return ot(t,null,null,e)},ot.matchesSelector=function(t,e){if((t.ownerDocument||t)!==b&&z(t),e=e.replace(q,"='$1']"),y.matchesSelector&&S&&!k[e+" "]&&(!a||!a.test(e))&&(!g||!g.test(e)))try{var i=p.call(t,e);if(i||y.disconnectedMatch||t.document&&11!==t.document.nodeType)return i}catch(t){}return 0<ot(e,b,null,[t]).length},ot.contains=function(t,e){return(t.ownerDocument||t)!==b&&z(t),f(t,e)},ot.attr=function(t,e){(t.ownerDocument||t)!==b&&z(t);var i=v.attrHandle[e.toLowerCase()],i=i&&E.call(v.attrHandle,e.toLowerCase())?i(t,e,!S):void 0;return void 0!==i?i:y.attributes||!S?t.getAttribute(e):(i=t.getAttributeNode(e))&&i.specified?i.value:null},ot.escape=function(t){return(t+"").replace(nt,c)},ot.error=function(t){throw new Error("Syntax error, unrecognized expression: "+t)},ot.uniqueSort=function(t){var e,i=[],n=0,r=0;if(l=!y.detectDuplicates,h=!y.sortStable&&t.slice(0),t.sort(O),l){for(;e=t[r++];)e===t[r]&&(n=i.push(r));for(;n--;)t.splice(i[n],1)}return h=null,t},o=ot.getText=function(t){var e,i="",n=0,r=t.nodeType;if(r){if(1===r||9===r||11===r){if("string"==typeof t.textContent)return t.textContent;for(t=t.firstChild;t;t=t.nextSibling)i+=o(t)}else if(3===r||4===r)return t.nodeValue}else for(;e=t[n++];)i+=o(e);return i},(v=ot.selectors={cacheLength:50,createPseudo:at,match:Z,attrHandle:{},find:{},relative:{">":{dir:"parentNode",first:!0}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:!0},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(t){return t[1]=t[1].replace(it,u),t[3]=(t[3]||t[4]||t[5]||"").replace(it,u),"~="===t[2]&&(t[3]=" "+t[3]+" "),t.slice(0,4)},CHILD:function(t){return t[1]=t[1].toLowerCase(),"nth"===t[1].slice(0,3)?(t[3]||ot.error(t[0]),t[4]=+(t[4]?t[5]+(t[6]||1):2*("even"===t[3]||"odd"===t[3])),t[5]=+(t[7]+t[8]||"odd"===t[3])):t[3]&&ot.error(t[0]),t},PSEUDO:function(t){var e,i=!t[6]&&t[2];return Z.CHILD.test(t[0])?null:(t[3]?t[2]=t[4]||t[5]||"":i&&Y.test(i)&&(e=_(i,!0))&&(e=i.indexOf(")",i.length-e)-i.length)&&(t[0]=t[0].slice(0,e),t[2]=i.slice(0,e)),t.slice(0,3))}},filter:{TAG:function(t){var e=t.replace(it,u).toLowerCase();return"*"===t?function(){return!0}:function(t){return t.nodeName&&t.nodeName.toLowerCase()===e}},CLASS:function(t){var e=T[t+" "];return e||(e=new RegExp("(^|"+F+")"+t+"("+F+"|$)"))&&T(t,function(t){return e.test("string"==typeof t.className&&t.className||void 0!==t.getAttribute&&t.getAttribute("class")||"")})},ATTR:function(e,i,n){return function(t){t=ot.attr(t,e);return null==t?"!="===i:!i||(t+="","="===i?t===n:"!="===i?t!==n:"^="===i?n&&0===t.indexOf(n):"*="===i?n&&-1<t.indexOf(n):"$="===i?n&&t.slice(-n.length)===n:"~="===i?-1<(" "+t.replace(V," ")+" ").indexOf(n):"|="===i&&(t===n||t.slice(0,n.length+1)===n+"-"))}},CHILD:function(y,t,e,_,m){var g="nth"!==y.slice(0,3),f="last"!==y.slice(-4),x="of-type"===t;return 1===_&&0===m?function(t){return!!t.parentNode}:function(t,e,i){var n,r,o,s,a,h,l=g!=f?"nextSibling":"previousSibling",p=t.parentNode,u=x&&t.nodeName.toLowerCase(),d=!i&&!x,c=!1;if(p){if(g){for(;l;){for(s=t;s=s[l];)if(x?s.nodeName.toLowerCase()===u:1===s.nodeType)return!1;h=l="only"===y&&!h&&"nextSibling"}return!0}if(h=[f?p.firstChild:p.lastChild],f&&d){for(c=(a=(n=(r=(o=(s=p)[C]||(s[C]={}))[s.uniqueID]||(o[s.uniqueID]={}))[y]||[])[0]===P&&n[1])&&n[2],s=a&&p.childNodes[a];s=++a&&s&&s[l]||(c=a=0)||h.pop();)if(1===s.nodeType&&++c&&s===t){r[y]=[P,a,c];break}}else if(!1===(c=d?a=(n=(r=(o=(s=t)[C]||(s[C]={}))[s.uniqueID]||(o[s.uniqueID]={}))[y]||[])[0]===P&&n[1]:c))for(;(s=++a&&s&&s[l]||(c=a=0)||h.pop())&&((x?s.nodeName.toLowerCase()!==u:1!==s.nodeType)||!++c||(d&&((r=(o=s[C]||(s[C]={}))[s.uniqueID]||(o[s.uniqueID]={}))[y]=[P,c]),s!==t)););return(c-=m)===_||c%_==0&&0<=c/_}}},PSEUDO:function(t,o){var e,s=v.pseudos[t]||v.setFilters[t.toLowerCase()]||ot.error("unsupported pseudo: "+t);return s[C]?s(o):1<s.length?(e=[t,t,"",o],v.setFilters.hasOwnProperty(t.toLowerCase())?at(function(t,e){for(var i,n=s(t,o),r=n.length;r--;)t[i=B(t,n[r])]=!(e[i]=n[r])}):function(t){return s(t,0,e)}):s}},pseudos:{not:at(function(t){var n=[],r=[],a=d(t.replace(W,"$1"));return a[C]?at(function(t,e,i,n){for(var r,o=a(t,null,n,[]),s=t.length;s--;)(r=o[s])&&(t[s]=!(e[s]=r))}):function(t,e,i){return n[0]=t,a(n,null,i,r),n[0]=null,!r.pop()}}),has:at(function(e){return function(t){return 0<ot(e,t).length}}),contains:at(function(e){return e=e.replace(it,u),function(t){return-1<(t.textContent||t.innerText||o(t)).indexOf(e)}}),lang:at(function(i){return K.test(i||"")||ot.error("unsupported lang: "+i),i=i.replace(it,u).toLowerCase(),function(t){var e;do{if(e=S?t.lang:t.getAttribute("xml:lang")||t.getAttribute("lang"))return(e=e.toLowerCase())===i||0===e.indexOf(i+"-")}while((t=t.parentNode)&&1===t.nodeType);return!1}}),target:function(t){var e=i.location&&i.location.hash;return e&&e.slice(1)===t.id},root:function(t){return t===s},focus:function(t){return t===b.activeElement&&(!b.hasFocus||b.hasFocus())&&!!(t.type||t.href||~t.tabIndex)},enabled:ut(!1),disabled:ut(!0),checked:function(t){var e=t.nodeName.toLowerCase();return"input"===e&&!!t.checked||"option"===e&&!!t.selected},selected:function(t){return t.parentNode&&t.parentNode.selectedIndex,!0===t.selected},empty:function(t){for(t=t.firstChild;t;t=t.nextSibling)if(t.nodeType<6)return!1;return!0},parent:function(t){return!v.pseudos.empty(t)},header:function(t){return Q.test(t.nodeName)},input:function(t){return J.test(t.nodeName)},button:function(t){var e=t.nodeName.toLowerCase();return"input"===e&&"button"===t.type||"button"===e},text:function(t){return"input"===t.nodeName.toLowerCase()&&"text"===t.type&&(null==(t=t.getAttribute("type"))||"text"===t.toLowerCase())},first:dt(function(){return[0]}),last:dt(function(t,e){return[e-1]}),eq:dt(function(t,e,i){return[i<0?i+e:i]}),even:dt(function(t,e){for(var i=0;i<e;i+=2)t.push(i);return t}),odd:dt(function(t,e){for(var i=1;i<e;i+=2)t.push(i);return t}),lt:dt(function(t,e,i){for(var n=i<0?i+e:i;0<=--n;)t.push(n);return t}),gt:dt(function(t,e,i){for(var n=i<0?i+e:i;++n<e;)t.push(n);return t})}}).pseudos.nth=v.pseudos.eq,{radio:!0,checkbox:!0,file:!0,password:!0,image:!0})v.pseudos[t]=function(e){return function(t){return"input"===t.nodeName.toLowerCase()&&t.type===e}}(t);for(t in{submit:!0,reset:!0})v.pseudos[t]=function(i){return function(t){var e=t.nodeName.toLowerCase();return("input"===e||"button"===e)&&t.type===i}}(t);function yt(){}function _t(t){for(var e=0,i=t.length,n="";e<i;e++)n+=t[e].value;return n}function mt(s,t,e){var a=t.dir,h=t.next,l=h||a,p=e&&"parentNode"===l,u=M++;return t.first?function(t,e,i){for(;t=t[a];)if(1===t.nodeType||p)return s(t,e,i);return!1}:function(t,e,i){var n,r,o=[P,u];if(i){for(;t=t[a];)if((1===t.nodeType||p)&&s(t,e,i))return!0}else for(;t=t[a];)if(1===t.nodeType||p)if(n=(r=t[C]||(t[C]={}))[t.uniqueID]||(r[t.uniqueID]={}),h&&h===t.nodeName.toLowerCase())t=t[a]||t;else{if((r=n[l])&&r[0]===P&&r[1]===u)return o[2]=r[2];if((n[l]=o)[2]=s(t,e,i))return!0}return!1}}function gt(r){return 1<r.length?function(t,e,i){for(var n=r.length;n--;)if(!r[n](t,e,i))return!1;return!0}:r[0]}function ft(t,e,i,n,r){for(var o,s=[],a=0,h=t.length,l=null!=e;a<h;a++)(o=t[a])&&(i&&!i(o,n,r)||(s.push(o),l&&e.push(a)));return s}function xt(c,y,_,m,g,t){return m&&!m[C]&&(m=xt(m)),g&&!g[C]&&(g=xt(g,t)),at(function(t,e,i,n){var r,o,s,a=[],h=[],l=e.length,p=t||function(t,e,i){for(var n=0,r=e.length;n<r;n++)ot(t,e[n],i);return i}(y||"*",i.nodeType?[i]:i,[]),u=!c||!t&&y?p:ft(p,a,c,i,n),d=_?g||(t?c:l||m)?[]:e:u;if(_&&_(u,d,i,n),m)for(r=ft(d,h),m(r,[],i,n),o=r.length;o--;)(s=r[o])&&(d[h[o]]=!(u[h[o]]=s));if(t){if(g||c){if(g){for(r=[],o=d.length;o--;)(s=d[o])&&r.push(u[o]=s);g(null,d=[],r,n)}for(o=d.length;o--;)(s=d[o])&&-1<(r=g?B(t,s):a[o])&&(t[r]=!(e[r]=s))}}else d=ft(d===e?d.splice(l,d.length):d),g?g(null,e,d,n):D.apply(e,d)})}function vt(m,g){function t(t,e,i,n,r){var o,s,a,h=0,l="0",p=t&&[],u=[],d=w,c=t||x&&v.find.TAG("*",r),y=P+=null==d?1:Math.random()||.1,_=c.length;for(r&&(w=e===b||e||r);l!==_&&null!=(o=c[l]);l++){if(x&&o){for(s=0,e||o.ownerDocument===b||(z(o),i=!S);a=m[s++];)if(a(o,e||b,i)){n.push(o);break}r&&(P=y)}f&&((o=!a&&o)&&h--,t&&p.push(o))}if(h+=l,f&&l!==h){for(s=0;a=g[s++];)a(p,u,e,i);if(t){if(0<h)for(;l--;)p[l]||u[l]||(u[l]=I.call(n));u=ft(u)}D.apply(n,u),r&&!t&&0<u.length&&1<h+g.length&&ot.uniqueSort(n)}return r&&(P=y,w=d),p}var f=0<g.length,x=0<m.length;return f?at(t):t}return yt.prototype=v.filters=v.pseudos,v.setFilters=new yt,_=ot.tokenize=function(t,e){var i,n,r,o,s,a,h,l=A[t+" "];if(l)return e?0:l.slice(0);for(s=t,a=[],h=v.preFilter;s;){for(o in i&&!(n=X.exec(s))||(n&&(s=s.slice(n[0].length)||s),a.push(r=[])),i=!1,(n=H.exec(s))&&(i=n.shift(),r.push({value:i,type:n[0].replace(W," ")}),s=s.slice(i.length)),v.filter)!(n=Z[o].exec(s))||h[o]&&!(n=h[o](n))||(i=n.shift(),r.push({value:i,type:o,matches:n}),s=s.slice(i.length));if(!i)break}return e?s.length:s?ot.error(t):A(t,a).slice(0)},d=ot.compile=function(t,e){var i,n=[],r=[],o=k[t+" "];if(!o){for(i=(e=e||_(t)).length;i--;)((o=function t(e){for(var n,i,r,o=e.length,s=v.relative[e[0].type],a=s||v.relative[" "],h=s?1:0,l=mt(function(t){return t===n},a,!0),p=mt(function(t){return-1<B(n,t)},a,!0),u=[function(t,e,i){return i=!s&&(i||e!==w)||((n=e).nodeType?l:p)(t,e,i),n=null,i}];h<o;h++)if(i=v.relative[e[h].type])u=[mt(gt(u),i)];else{if((i=v.filter[e[h].type].apply(null,e[h].matches))[C]){for(r=++h;r<o&&!v.relative[e[r].type];r++);return xt(1<h&&gt(u),1<h&&_t(e.slice(0,h-1).concat({value:" "===e[h-2].type?"*":""})).replace(W,"$1"),i,h<r&&t(e.slice(h,r)),r<o&&t(e=e.slice(r)),r<o&&_t(e))}u.push(i)}return gt(u)}(e[i]))[C]?n:r).push(o);(o=k(t,vt(r,n))).selector=t}return o},m=ot.select=function(t,e,i,n){var r,o,s,a,h,l="function"==typeof t&&t,p=!n&&_(t=l.selector||t);if(i=i||[],1===p.length){if(2<(o=p[0]=p[0].slice(0)).length&&"ID"===(s=o[0]).type&&9===e.nodeType&&S&&v.relative[o[1].type]){if(!(e=(v.find.ID(s.matches[0].replace(it,u),e)||[])[0]))return i;l&&(e=e.parentNode),t=t.slice(o.shift().value.length)}for(r=Z.needsContext.test(t)?0:o.length;r--&&(s=o[r],!v.relative[a=s.type]);)if((h=v.find[a])&&(n=h(s.matches[0].replace(it,u),et.test(o[0].type)&&ct(e.parentNode)||e))){if(o.splice(r,1),!(t=n.length&&_t(o)))return D.apply(i,n),i;break}}return(l||d(t,p))(n,e,!S,i,!e||et.test(t)&&ct(e.parentNode)||e),i},y.sortStable=C.split("").sort(O).join("")===C,y.detectDuplicates=!!l,z(),y.sortDetached=ht(function(t){return 1&t.compareDocumentPosition(b.createElement("fieldset"))}),ht(function(t){return t.innerHTML="<a href='#'></a>","#"===t.firstChild.getAttribute("href")})||lt("type|href|height|width",function(t,e,i){if(!i)return t.getAttribute(e,"type"===e.toLowerCase()?1:2)}),y.attributes&&ht(function(t){return t.innerHTML="<input/>",t.firstChild.setAttribute("value",""),""===t.firstChild.getAttribute("value")})||lt("value",function(t,e,i){if(!i&&"input"===t.nodeName.toLowerCase())return t.defaultValue}),ht(function(t){return null==t.getAttribute("disabled")})||lt(R,function(t,e,i){if(!i)return!0===t[e]?e.toLowerCase():(e=t.getAttributeNode(e))&&e.specified?e.value:null}),ot}(z);S.find=x,S.expr=x.selectors,S.expr[":"]=S.expr.pseudos,S.uniqueSort=S.unique=x.uniqueSort,S.text=x.getText,S.isXMLDoc=x.isXML,S.contains=x.contains,S.escapeSelector=x.escape;function v(t,e,i){for(var n=[],r=void 0!==i;(t=t[e])&&9!==t.nodeType;)if(1===t.nodeType){if(r&&S(t).is(i))break;n.push(t)}return n}function w(t,e){for(var i=[];t;t=t.nextSibling)1===t.nodeType&&t!==e&&i.push(t);return i}var C=S.expr.match.needsContext,P=/^<([a-z][^\/\0>:\x20\t\r\n\f]*)[\x20\t\r\n\f]*\/?>(?:<\/\1>|)$/i,M=/^.[^:#\[\.,]*$/;function T(t,i,n){return S.isFunction(i)?S.grep(t,function(t,e){return!!i.call(t,e,t)!==n}):i.nodeType?S.grep(t,function(t){return t===i!==n}):"string"!=typeof i?S.grep(t,function(t){return-1<r.call(i,t)!==n}):M.test(i)?S.filter(i,t,n):(i=S.filter(i,t),S.grep(t,function(t){return-1<r.call(i,t)!==n&&1===t.nodeType}))}S.filter=function(t,e,i){var n=e[0];return i&&(t=":not("+t+")"),1===e.length&&1===n.nodeType?S.find.matchesSelector(n,t)?[n]:[]:S.find.matches(t,S.grep(e,function(t){return 1===t.nodeType}))},S.fn.extend({find:function(t){var e,i,n=this.length,r=this;if("string"!=typeof t)return this.pushStack(S(t).filter(function(){for(e=0;e<n;e++)if(S.contains(r[e],this))return!0}));for(i=this.pushStack([]),e=0;e<n;e++)S.find(t,r[e],i);return 1<n?S.uniqueSort(i):i},filter:function(t){return this.pushStack(T(this,t||[],!1))},not:function(t){return this.pushStack(T(this,t||[],!0))},is:function(t){return!!T(this,"string"==typeof t&&C.test(t)?S(t):t||[],!1).length}});var A=/^(?:\s*(<[\w\W]+>)[^>]*|#([\w-]+))$/;(S.fn.init=function(t,e,i){if(!t)return this;if(i=i||k,"string"!=typeof t)return t.nodeType?(this[0]=t,this.length=1,this):S.isFunction(t)?void 0!==i.ready?i.ready(t):t(S):S.makeArray(t,this);if(!(n="<"===t[0]&&">"===t[t.length-1]&&3<=t.length?[null,t,null]:A.exec(t))||!n[1]&&e)return(!e||e.jquery?e||i:this.constructor(e)).find(t);if(n[1]){if(e=e instanceof S?e[0]:e,S.merge(this,S.parseHTML(n[1],e&&e.nodeType?e.ownerDocument||e:b,!0)),P.test(n[1])&&S.isPlainObject(e))for(var n in e)S.isFunction(this[n])?this[n](e[n]):this.attr(n,e[n]);return this}return(t=b.getElementById(n[2]))&&(this[0]=t,this.length=1),this}).prototype=S.fn;var k=S(b),O=/^(?:parents|prev(?:Until|All))/,E={children:!0,contents:!0,next:!0,prev:!0};function I(t,e){for(;(t=t[e])&&1!==t.nodeType;);return t}S.fn.extend({has:function(t){var e=S(t,this),i=e.length;return this.filter(function(){for(var t=0;t<i;t++)if(S.contains(this,e[t]))return!0})},closest:function(t,e){var i,n=0,r=this.length,o=[],s="string"!=typeof t&&S(t);if(!C.test(t))for(;n<r;n++)for(i=this[n];i&&i!==e;i=i.parentNode)if(i.nodeType<11&&(s?-1<s.index(i):1===i.nodeType&&S.find.matchesSelector(i,t))){o.push(i);break}return this.pushStack(1<o.length?S.uniqueSort(o):o)},index:function(t){return t?"string"==typeof t?r.call(S(t),this[0]):r.call(this,t.jquery?t[0]:t):this[0]&&this[0].parentNode?this.first().prevAll().length:-1},add:function(t,e){return this.pushStack(S.uniqueSort(S.merge(this.get(),S(t,e))))},addBack:function(t){return this.add(null==t?this.prevObject:this.prevObject.filter(t))}}),S.each({parent:function(t){t=t.parentNode;return t&&11!==t.nodeType?t:null},parents:function(t){return v(t,"parentNode")},parentsUntil:function(t,e,i){return v(t,"parentNode",i)},next:function(t){return I(t,"nextSibling")},prev:function(t){return I(t,"previousSibling")},nextAll:function(t){return v(t,"nextSibling")},prevAll:function(t){return v(t,"previousSibling")},nextUntil:function(t,e,i){return v(t,"nextSibling",i)},prevUntil:function(t,e,i){return v(t,"previousSibling",i)},siblings:function(t){return w((t.parentNode||{}).firstChild,t)},children:function(t){return w(t.firstChild)},contents:function(t){return t.contentDocument||S.merge([],t.childNodes)}},function(n,r){S.fn[n]=function(t,e){var i=S.map(this,r,t);return(e="Until"!==n.slice(-5)?t:e)&&"string"==typeof e&&(i=S.filter(e,i)),1<this.length&&(E[n]||S.uniqueSort(i),O.test(n)&&i.reverse()),this.pushStack(i)}});var G=/[^\x20\t\r\n\f]+/g;function D(t){return t}function L(t){throw t}function B(t,e,i){var n;try{t&&S.isFunction(n=t.promise)?n.call(t).done(e).fail(i):t&&S.isFunction(n=t.then)?n.call(t,e,i):e.call(void 0,t)}catch(t){i.call(void 0,t)}}S.Callbacks=function(n){var t,i;n="string"==typeof n?(t=n,i={},S.each(t.match(G)||[],function(t,e){i[e]=!0}),i):S.extend({},n);function r(){for(a=n.once,s=o=!0;l.length;p=-1)for(e=l.shift();++p<h.length;)!1===h[p].apply(e[0],e[1])&&n.stopOnFalse&&(p=h.length,e=!1);n.memory||(e=!1),o=!1,a&&(h=e?[]:"")}var o,e,s,a,h=[],l=[],p=-1,u={add:function(){return h&&(e&&!o&&(p=h.length-1,l.push(e)),function i(t){S.each(t,function(t,e){S.isFunction(e)?n.unique&&u.has(e)||h.push(e):e&&e.length&&"string"!==S.type(e)&&i(e)})}(arguments),e&&!o&&r()),this},remove:function(){return S.each(arguments,function(t,e){for(var i;-1<(i=S.inArray(e,h,i));)h.splice(i,1),i<=p&&p--}),this},has:function(t){return t?-1<S.inArray(t,h):0<h.length},empty:function(){return h=h&&[],this},disable:function(){return a=l=[],h=e="",this},disabled:function(){return!h},lock:function(){return a=l=[],e||o||(h=e=""),this},locked:function(){return!!a},fireWith:function(t,e){return a||(e=[t,(e=e||[]).slice?e.slice():e],l.push(e),o||r()),this},fire:function(){return u.fireWith(this,arguments),this},fired:function(){return!!s}};return u},S.extend({Deferred:function(t){var o=[["notify","progress",S.Callbacks("memory"),S.Callbacks("memory"),2],["resolve","done",S.Callbacks("once memory"),S.Callbacks("once memory"),0,"resolved"],["reject","fail",S.Callbacks("once memory"),S.Callbacks("once memory"),1,"rejected"]],r="pending",s={state:function(){return r},always:function(){return a.done(arguments).fail(arguments),this},catch:function(t){return s.then(null,t)},pipe:function(){var r=arguments;return S.Deferred(function(n){S.each(o,function(t,e){var i=S.isFunction(r[e[4]])&&r[e[4]];a[e[1]](function(){var t=i&&i.apply(this,arguments);t&&S.isFunction(t.promise)?t.promise().progress(n.notify).done(n.resolve).fail(n.reject):n[e[0]+"With"](this,i?[t]:arguments)})}),r=null}).promise()},then:function(e,i,n){var h=0;function l(r,o,s,a){return function(){function t(){var t,e;if(!(r<h)){if((t=s.apply(i,n))===o.promise())throw new TypeError("Thenable self-resolution");e=t&&("object"==typeof t||"function"==typeof t)&&t.then,S.isFunction(e)?a?e.call(t,l(h,o,D,a),l(h,o,L,a)):(h++,e.call(t,l(h,o,D,a),l(h,o,L,a),l(h,o,D,o.notifyWith))):(s!==D&&(i=void 0,n=[t]),(a||o.resolveWith)(i,n))}}var i=this,n=arguments,e=a?t:function(){try{t()}catch(t){S.Deferred.exceptionHook&&S.Deferred.exceptionHook(t,e.stackTrace),h<=r+1&&(s!==L&&(i=void 0,n=[t]),o.rejectWith(i,n))}};r?e():(S.Deferred.getStackHook&&(e.stackTrace=S.Deferred.getStackHook()),z.setTimeout(e))}}return S.Deferred(function(t){o[0][3].add(l(0,t,S.isFunction(n)?n:D,t.notifyWith)),o[1][3].add(l(0,t,S.isFunction(e)?e:D)),o[2][3].add(l(0,t,S.isFunction(i)?i:L))}).promise()},promise:function(t){return null!=t?S.extend(t,s):s}},a={};return S.each(o,function(t,e){var i=e[2],n=e[5];s[e[1]]=i.add,n&&i.add(function(){r=n},o[3-t][2].disable,o[0][2].lock),i.add(e[3].fire),a[e[0]]=function(){return a[e[0]+"With"](this===a?void 0:this,arguments),this},a[e[0]+"With"]=i.fireWith}),s.promise(a),t&&t.call(a,a),a},when:function(t){function e(e){return function(t){r[e]=this,o[e]=1<arguments.length?a.call(arguments):t,--i||s.resolveWith(r,o)}}var i=arguments.length,n=i,r=Array(n),o=a.call(arguments),s=S.Deferred();if(i<=1&&(B(t,s.done(e(n)).resolve,s.reject),"pending"===s.state()||S.isFunction(o[n]&&o[n].then)))return s.then();for(;n--;)B(o[n],e(n),s.reject);return s.promise()}});var R=/^(Eval|Internal|Range|Reference|Syntax|Type|URI)Error$/;S.Deferred.exceptionHook=function(t,e){z.console&&z.console.warn&&t&&R.test(t.name)&&z.console.warn("jQuery.Deferred exception: "+t.message,t.stack,e)},S.readyException=function(t){z.setTimeout(function(){throw t})};var F=S.Deferred();function N(){b.removeEventListener("DOMContentLoaded",N),z.removeEventListener("load",N),S.ready()}S.fn.ready=function(t){return F.then(t).catch(function(t){S.readyException(t)}),this},S.extend({isReady:!1,readyWait:1,holdReady:function(t){t?S.readyWait++:S.ready(!0)},ready:function(t){(!0===t?--S.readyWait:S.isReady)||((S.isReady=!0)!==t&&0<--S.readyWait||F.resolveWith(b,[S]))}}),S.ready.then=F.then,"complete"===b.readyState||"loading"!==b.readyState&&!b.documentElement.doScroll?z.setTimeout(S.ready):(b.addEventListener("DOMContentLoaded",N),z.addEventListener("load",N));function j(t,e,i,n,r,o,s){var a=0,h=t.length,l=null==i;if("object"===S.type(i))for(a in r=!0,i)j(t,e,a,i[a],!0,o,s);else if(void 0!==n&&(r=!0,S.isFunction(n)||(s=!0),e=l?s?(e.call(t,n),null):(l=e,function(t,e,i){return l.call(S(t),i)}):e))for(;a<h;a++)e(t[a],i,s?n:n.call(t[a],a,e(t[a],i)));return r?t:l?e.call(t):h?e(t[0],i):o}function U(t){return 1===t.nodeType||9===t.nodeType||!+t.nodeType}function V(){this.expando=S.expando+V.uid++}V.uid=1,V.prototype={cache:function(t){var e=t[this.expando];return e||(e={},U(t)&&(t.nodeType?t[this.expando]=e:Object.defineProperty(t,this.expando,{value:e,configurable:!0}))),e},set:function(t,e,i){var n,r=this.cache(t);if("string"==typeof e)r[S.camelCase(e)]=i;else for(n in e)r[S.camelCase(n)]=e[n];return r},get:function(t,e){return void 0===e?this.cache(t):t[this.expando]&&t[this.expando][S.camelCase(e)]},access:function(t,e,i){return void 0===e||e&&"string"==typeof e&&void 0===i?this.get(t,e):(this.set(t,e,i),void 0!==i?i:e)},remove:function(t,e){var i,n=t[this.expando];if(void 0!==n){if(void 0!==e){i=(e=S.isArray(e)?e.map(S.camelCase):(e=S.camelCase(e))in n?[e]:e.match(G)||[]).length;for(;i--;)delete n[e[i]]}void 0!==e&&!S.isEmptyObject(n)||(t.nodeType?t[this.expando]=void 0:delete t[this.expando])}},hasData:function(t){t=t[this.expando];return void 0!==t&&!S.isEmptyObject(t)}};var W=new V,X=new V,H=/^(?:\{[\w\W]*\}|\[[\w\W]*\])$/,q=/[A-Z]/g;function Y(t,e,i){var n,r;if(void 0===i&&1===t.nodeType)if(n="data-"+e.replace(q,"-$&").toLowerCase(),"string"==typeof(i=t.getAttribute(n))){try{i="true"===(r=i)||"false"!==r&&("null"===r?null:r===+r+""?+r:H.test(r)?JSON.parse(r):r)}catch(t){}X.set(t,e,i)}else i=void 0;return i}S.extend({hasData:function(t){return X.hasData(t)||W.hasData(t)},data:function(t,e,i){return X.access(t,e,i)},removeData:function(t,e){X.remove(t,e)},_data:function(t,e,i){return W.access(t,e,i)},_removeData:function(t,e){W.remove(t,e)}}),S.fn.extend({data:function(i,t){var e,n,r,o=this[0],s=o&&o.attributes;if(void 0!==i)return"object"==typeof i?this.each(function(){X.set(this,i)}):j(this,function(t){var e;return o&&void 0===t?void 0!==(e=X.get(o,i))||void 0!==(e=Y(o,i))?e:void 0:void this.each(function(){X.set(this,i,t)})},null,t,1<arguments.length,null,!0);if(this.length&&(r=X.get(o),1===o.nodeType&&!W.get(o,"hasDataAttrs"))){for(e=s.length;e--;)s[e]&&(0===(n=s[e].name).indexOf("data-")&&(n=S.camelCase(n.slice(5)),Y(o,n,r[n])));W.set(o,"hasDataAttrs",!0)}return r},removeData:function(t){return this.each(function(){X.remove(this,t)})}}),S.extend({queue:function(t,e,i){var n;if(t)return n=W.get(t,e=(e||"fx")+"queue"),i&&(!n||S.isArray(i)?n=W.access(t,e,S.makeArray(i)):n.push(i)),n||[]},dequeue:function(t,e){e=e||"fx";var i=S.queue(t,e),n=i.length,r=i.shift(),o=S._queueHooks(t,e);"inprogress"===r&&(r=i.shift(),n--),r&&("fx"===e&&i.unshift("inprogress"),delete o.stop,r.call(t,function(){S.dequeue(t,e)},o)),!n&&o&&o.empty.fire()},_queueHooks:function(t,e){var i=e+"queueHooks";return W.get(t,i)||W.access(t,i,{empty:S.Callbacks("once memory").add(function(){W.remove(t,[e+"queue",i])})})}}),S.fn.extend({queue:function(e,i){var t=2;return"string"!=typeof e&&(i=e,e="fx",t--),arguments.length<t?S.queue(this[0],e):void 0===i?this:this.each(function(){var t=S.queue(this,e,i);S._queueHooks(this,e),"fx"===e&&"inprogress"!==t[0]&&S.dequeue(this,e)})},dequeue:function(t){return this.each(function(){S.dequeue(this,t)})},clearQueue:function(t){return this.queue(t||"fx",[])},promise:function(t,e){function i(){--r||o.resolveWith(s,[s])}var n,r=1,o=S.Deferred(),s=this,a=this.length;for("string"!=typeof t&&(e=t,t=void 0),t=t||"fx";a--;)(n=W.get(s[a],t+"queueHooks"))&&n.empty&&(r++,n.empty.add(i));return i(),o.promise(e)}});function K(t,e){return"none"===(t=e||t).style.display||""===t.style.display&&S.contains(t.ownerDocument,t)&&"none"===S.css(t,"display")}function Z(t,e,i,n){var r,o={};for(r in e)o[r]=t.style[r],t.style[r]=e[r];for(r in n=i.apply(t,n||[]),e)t.style[r]=o[r];return n}var J=/[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/.source,Q=new RegExp("^(?:([+-])=|)("+J+")([a-z%]*)$","i"),$=["Top","Right","Bottom","Left"];function tt(t,e,i,n){var r,o=1,s=20,a=n?function(){return n.cur()}:function(){return S.css(t,e,"")},h=a(),l=i&&i[3]||(S.cssNumber[e]?"":"px"),p=(S.cssNumber[e]||"px"!==l&&+h)&&Q.exec(S.css(t,e));if(p&&p[3]!==l)for(l=l||p[3],i=i||[],p=+h||1;S.style(t,e,(p/=o=o||".5")+l),o!==(o=a()/h)&&1!==o&&--s;);return i&&(p=+p||+h||0,r=i[1]?p+(i[1]+1)*i[2]:+i[2],n&&(n.unit=l,n.start=p,n.end=r)),r}var et={};function it(t,e){for(var i,n,r,o,s,a=[],h=0,l=t.length;h<l;h++)(n=t[h]).style&&(i=n.style.display,e?("none"===i&&(a[h]=W.get(n,"display")||null,a[h]||(n.style.display="")),""===n.style.display&&K(n)&&(a[h]=(s=o=void 0,o=(r=n).ownerDocument,s=r.nodeName,(r=et[s])||(o=o.body.appendChild(o.createElement(s)),r=S.css(o,"display"),o.parentNode.removeChild(o),et[s]=r="none"===r?"block":r)))):"none"!==i&&(a[h]="none",W.set(n,"display",i)));for(h=0;h<l;h++)null!=a[h]&&(t[h].style.display=a[h]);return t}S.fn.extend({show:function(){return it(this,!0)},hide:function(){return it(this)},toggle:function(t){return"boolean"==typeof t?t?this.show():this.hide():this.each(function(){K(this)?S(this).show():S(this).hide()})}});var nt=/^(?:checkbox|radio)$/i,rt=/<([a-z][^\/\0>\x20\t\r\n\f]+)/i,ot=/^$|\/(?:java|ecma)script/i,st={option:[1,"<select multiple='multiple'>","</select>"],thead:[1,"<table>","</table>"],col:[2,"<table><colgroup>","</colgroup></table>"],tr:[2,"<table><tbody>","</tbody></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],_default:[0,"",""]};function at(t,e){var i=void 0!==t.getElementsByTagName?t.getElementsByTagName(e||"*"):void 0!==t.querySelectorAll?t.querySelectorAll(e||"*"):[];return void 0===e||e&&S.nodeName(t,e)?S.merge([t],i):i}function ht(t,e){for(var i=0,n=t.length;i<n;i++)W.set(t[i],"globalEval",!e||W.get(e[i],"globalEval"))}st.optgroup=st.option,st.tbody=st.tfoot=st.colgroup=st.caption=st.thead,st.th=st.td;var lt=/<|&#?\w+;/;function pt(t,e,i,n,r){for(var o,s,a,h,l,p=e.createDocumentFragment(),u=[],d=0,c=t.length;d<c;d++)if((o=t[d])||0===o)if("object"===S.type(o))S.merge(u,o.nodeType?[o]:o);else if(lt.test(o)){for(s=s||p.appendChild(e.createElement("div")),a=(rt.exec(o)||["",""])[1].toLowerCase(),a=st[a]||st._default,s.innerHTML=a[1]+S.htmlPrefilter(o)+a[2],l=a[0];l--;)s=s.lastChild;S.merge(u,s.childNodes),(s=p.firstChild).textContent=""}else u.push(e.createTextNode(o));for(p.textContent="",d=0;o=u[d++];)if(n&&-1<S.inArray(o,n))r&&r.push(o);else if(h=S.contains(o.ownerDocument,o),s=at(p.appendChild(o),"script"),h&&ht(s),i)for(l=0;o=s[l++];)ot.test(o.type||"")&&i.push(o);return p}e=b.createDocumentFragment().appendChild(b.createElement("div")),(x=b.createElement("input")).setAttribute("type","radio"),x.setAttribute("checked","checked"),x.setAttribute("name","t"),e.appendChild(x),m.checkClone=e.cloneNode(!0).cloneNode(!0).lastChild.checked,e.innerHTML="<textarea>x</textarea>",m.noCloneChecked=!!e.cloneNode(!0).lastChild.defaultValue;var ut=b.documentElement,dt=/^key/,ct=/^(?:mouse|pointer|contextmenu|drag|drop)|click/,yt=/^([^.]*)(?:\.(.+)|)/;function _t(){return!0}function mt(){return!1}function gt(){try{return b.activeElement}catch(t){}}function ft(t,e,i,n,r,o){var s,a;if("object"==typeof e){for(a in"string"!=typeof i&&(n=n||i,i=void 0),e)ft(t,a,i,n,e[a],o);return t}if(null==n&&null==r?(r=i,n=i=void 0):null==r&&("string"==typeof i?(r=n,n=void 0):(r=n,n=i,i=void 0)),!1===r)r=mt;else if(!r)return t;return 1===o&&(s=r,(r=function(t){return S().off(t),s.apply(this,arguments)}).guid=s.guid||(s.guid=S.guid++)),t.each(function(){S.event.add(this,e,r,n,i)})}S.event={global:{},add:function(e,t,i,n,r){var o,s,a,h,l,p,u,d,c,y=W.get(e);if(y)for(i.handler&&(i=(o=i).handler,r=o.selector),r&&S.find.matchesSelector(ut,r),i.guid||(i.guid=S.guid++),(a=y.events)||(a=y.events={}),(s=y.handle)||(s=y.handle=function(t){return void 0!==S&&S.event.triggered!==t.type?S.event.dispatch.apply(e,arguments):void 0}),h=(t=(t||"").match(G)||[""]).length;h--;)u=c=(l=yt.exec(t[h])||[])[1],d=(l[2]||"").split(".").sort(),u&&(p=S.event.special[u]||{},u=(r?p.delegateType:p.bindType)||u,p=S.event.special[u]||{},l=S.extend({type:u,origType:c,data:n,handler:i,guid:i.guid,selector:r,needsContext:r&&S.expr.match.needsContext.test(r),namespace:d.join(".")},o),(c=a[u])||((c=a[u]=[]).delegateCount=0,p.setup&&!1!==p.setup.call(e,n,d,s)||e.addEventListener&&e.addEventListener(u,s)),p.add&&(p.add.call(e,l),l.handler.guid||(l.handler.guid=i.guid)),r?c.splice(c.delegateCount++,0,l):c.push(l),S.event.global[u]=!0)},remove:function(t,e,i,n,r){var o,s,a,h,l,p,u,d,c,y,_,m=W.hasData(t)&&W.get(t);if(m&&(h=m.events)){for(l=(e=(e||"").match(G)||[""]).length;l--;)if(c=_=(a=yt.exec(e[l])||[])[1],y=(a[2]||"").split(".").sort(),c){for(u=S.event.special[c]||{},d=h[c=(n?u.delegateType:u.bindType)||c]||[],a=a[2]&&new RegExp("(^|\\.)"+y.join("\\.(?:.*\\.|)")+"(\\.|$)"),s=o=d.length;o--;)p=d[o],!r&&_!==p.origType||i&&i.guid!==p.guid||a&&!a.test(p.namespace)||n&&n!==p.selector&&("**"!==n||!p.selector)||(d.splice(o,1),p.selector&&d.delegateCount--,u.remove&&u.remove.call(t,p));s&&!d.length&&(u.teardown&&!1!==u.teardown.call(t,y,m.handle)||S.removeEvent(t,c,m.handle),delete h[c])}else for(c in h)S.event.remove(t,c+e[l],i,n,!0);S.isEmptyObject(h)&&W.remove(t,"handle events")}},dispatch:function(t){var e,i,n,r,o,s=S.event.fix(t),a=new Array(arguments.length),h=(W.get(this,"events")||{})[s.type]||[],t=S.event.special[s.type]||{};for(a[0]=s,e=1;e<arguments.length;e++)a[e]=arguments[e];if(s.delegateTarget=this,!t.preDispatch||!1!==t.preDispatch.call(this,s)){for(o=S.event.handlers.call(this,s,h),e=0;(n=o[e++])&&!s.isPropagationStopped();)for(s.currentTarget=n.elem,i=0;(r=n.handlers[i++])&&!s.isImmediatePropagationStopped();)s.rnamespace&&!s.rnamespace.test(r.namespace)||(s.handleObj=r,s.data=r.data,void 0!==(r=((S.event.special[r.origType]||{}).handle||r.handler).apply(n.elem,a))&&!1===(s.result=r)&&(s.preventDefault(),s.stopPropagation()));return t.postDispatch&&t.postDispatch.call(this,s),s.result}},handlers:function(t,e){var i,n,r,o,s,a=[],h=e.delegateCount,l=t.target;if(h&&l.nodeType&&!("click"===t.type&&1<=t.button))for(;l!==this;l=l.parentNode||this)if(1===l.nodeType&&("click"!==t.type||!0!==l.disabled)){for(o=[],s={},i=0;i<h;i++)void 0===s[r=(n=e[i]).selector+" "]&&(s[r]=n.needsContext?-1<S(r,this).index(l):S.find(r,this,null,[l]).length),s[r]&&o.push(n);o.length&&a.push({elem:l,handlers:o})}return l=this,h<e.length&&a.push({elem:l,handlers:e.slice(h)}),a},addProp:function(e,t){Object.defineProperty(S.Event.prototype,e,{enumerable:!0,configurable:!0,get:S.isFunction(t)?function(){if(this.originalEvent)return t(this.originalEvent)}:function(){if(this.originalEvent)return this.originalEvent[e]},set:function(t){Object.defineProperty(this,e,{enumerable:!0,configurable:!0,writable:!0,value:t})}})},fix:function(t){return t[S.expando]?t:new S.Event(t)},special:{load:{noBubble:!0},focus:{trigger:function(){if(this!==gt()&&this.focus)return this.focus(),!1},delegateType:"focusin"},blur:{trigger:function(){if(this===gt()&&this.blur)return this.blur(),!1},delegateType:"focusout"},click:{trigger:function(){if("checkbox"===this.type&&this.click&&S.nodeName(this,"input"))return this.click(),!1},_default:function(t){return S.nodeName(t.target,"a")}},beforeunload:{postDispatch:function(t){void 0!==t.result&&t.originalEvent&&(t.originalEvent.returnValue=t.result)}}}},S.removeEvent=function(t,e,i){t.removeEventListener&&t.removeEventListener(e,i)},S.Event=function(t,e){return this instanceof S.Event?(t&&t.type?(this.originalEvent=t,this.type=t.type,this.isDefaultPrevented=t.defaultPrevented||void 0===t.defaultPrevented&&!1===t.returnValue?_t:mt,this.target=t.target&&3===t.target.nodeType?t.target.parentNode:t.target,this.currentTarget=t.currentTarget,this.relatedTarget=t.relatedTarget):this.type=t,e&&S.extend(this,e),this.timeStamp=t&&t.timeStamp||S.now(),void(this[S.expando]=!0)):new S.Event(t,e)},S.Event.prototype={constructor:S.Event,isDefaultPrevented:mt,isPropagationStopped:mt,isImmediatePropagationStopped:mt,isSimulated:!1,preventDefault:function(){var t=this.originalEvent;this.isDefaultPrevented=_t,t&&!this.isSimulated&&t.preventDefault()},stopPropagation:function(){var t=this.originalEvent;this.isPropagationStopped=_t,t&&!this.isSimulated&&t.stopPropagation()},stopImmediatePropagation:function(){var t=this.originalEvent;this.isImmediatePropagationStopped=_t,t&&!this.isSimulated&&t.stopImmediatePropagation(),this.stopPropagation()}},S.each({altKey:!0,bubbles:!0,cancelable:!0,changedTouches:!0,ctrlKey:!0,detail:!0,eventPhase:!0,metaKey:!0,pageX:!0,pageY:!0,shiftKey:!0,view:!0,char:!0,charCode:!0,key:!0,keyCode:!0,button:!0,buttons:!0,clientX:!0,clientY:!0,offsetX:!0,offsetY:!0,pointerId:!0,pointerType:!0,screenX:!0,screenY:!0,targetTouches:!0,toElement:!0,touches:!0,which:function(t){var e=t.button;return null==t.which&&dt.test(t.type)?null!=t.charCode?t.charCode:t.keyCode:!t.which&&void 0!==e&&ct.test(t.type)?1&e?1:2&e?3:4&e?2:0:t.which}},S.event.addProp),S.each({mouseenter:"mouseover",mouseleave:"mouseout",pointerenter:"pointerover",pointerleave:"pointerout"},function(t,r){S.event.special[t]={delegateType:r,bindType:r,handle:function(t){var e,i=t.relatedTarget,n=t.handleObj;return i&&(i===this||S.contains(this,i))||(t.type=n.origType,e=n.handler.apply(this,arguments),t.type=r),e}}}),S.fn.extend({on:function(t,e,i,n){return ft(this,t,e,i,n)},one:function(t,e,i,n){return ft(this,t,e,i,n,1)},off:function(t,e,i){var n,r;if(t&&t.preventDefault&&t.handleObj)return n=t.handleObj,S(t.delegateTarget).off(n.namespace?n.origType+"."+n.namespace:n.origType,n.selector,n.handler),this;if("object"!=typeof t)return!1!==e&&"function"!=typeof e||(i=e,e=void 0),!1===i&&(i=mt),this.each(function(){S.event.remove(this,t,i,e)});for(r in t)this.off(r,e,t[r]);return this}});var xt=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([a-z][^\/\0>\x20\t\r\n\f]*)[^>]*)\/>/gi,vt=/<script|<style|<link/i,wt=/checked\s*(?:[^=]|=\s*.checked.)/i,zt=/^true\/(.*)/,bt=/^\s*<!(?:\[CDATA\[|--)|(?:\]\]|--)>\s*$/g;function St(t,e){return S.nodeName(t,"table")&&S.nodeName(11!==e.nodeType?e:e.firstChild,"tr")&&t.getElementsByTagName("tbody")[0]||t}function Ct(t){return t.type=(null!==t.getAttribute("type"))+"/"+t.type,t}function Pt(t){var e=zt.exec(t.type);return e?t.type=e[1]:t.removeAttribute("type"),t}function Mt(t,e){var i,n,r,o,s,a;if(1===e.nodeType){if(W.hasData(t)&&(o=W.access(t),s=W.set(e,o),a=o.events))for(r in delete s.handle,s.events={},a)for(i=0,n=a[r].length;i<n;i++)S.event.add(e,r,a[r][i]);X.hasData(t)&&(t=X.access(t),t=S.extend({},t),X.set(e,t))}}function Tt(i,n,r,o){n=_.apply([],n);var t,e,s,a,h,l,p=0,u=i.length,d=u-1,c=n[0],y=S.isFunction(c);if(y||1<u&&"string"==typeof c&&!m.checkClone&&wt.test(c))return i.each(function(t){var e=i.eq(t);y&&(n[0]=c.call(this,t,e.html())),Tt(e,n,r,o)});if(u&&(e=(t=pt(n,i[0].ownerDocument,!1,i,o)).firstChild,1===t.childNodes.length&&(t=e),e||o)){for(a=(s=S.map(at(t,"script"),Ct)).length;p<u;p++)h=t,p!==d&&(h=S.clone(h,!0,!0),a&&S.merge(s,at(h,"script"))),r.call(i[p],h,p);if(a)for(l=s[s.length-1].ownerDocument,S.map(s,Pt),p=0;p<a;p++)h=s[p],ot.test(h.type||"")&&!W.access(h,"globalEval")&&S.contains(l,h)&&(h.src?S._evalUrl&&S._evalUrl(h.src):g(h.textContent.replace(bt,""),l))}return i}function At(t,e,i){for(var n,r=e?S.filter(e,t):t,o=0;null!=(n=r[o]);o++)i||1!==n.nodeType||S.cleanData(at(n)),n.parentNode&&(i&&S.contains(n.ownerDocument,n)&&ht(at(n,"script")),n.parentNode.removeChild(n));return t}S.extend({htmlPrefilter:function(t){return t.replace(xt,"<$1></$2>")},clone:function(t,e,i){var n,r,o,s,a,h,l,p=t.cloneNode(!0),u=S.contains(t.ownerDocument,t);if(!(m.noCloneChecked||1!==t.nodeType&&11!==t.nodeType||S.isXMLDoc(t)))for(s=at(p),n=0,r=(o=at(t)).length;n<r;n++)a=o[n],h=s[n],l=void 0,"input"===(l=h.nodeName.toLowerCase())&&nt.test(a.type)?h.checked=a.checked:"input"!==l&&"textarea"!==l||(h.defaultValue=a.defaultValue);if(e)if(i)for(o=o||at(t),s=s||at(p),n=0,r=o.length;n<r;n++)Mt(o[n],s[n]);else Mt(t,p);return 0<(s=at(p,"script")).length&&ht(s,!u&&at(t,"script")),p},cleanData:function(t){for(var e,i,n,r=S.event.special,o=0;void 0!==(i=t[o]);o++)if(U(i)){if(e=i[W.expando]){if(e.events)for(n in e.events)r[n]?S.event.remove(i,n):S.removeEvent(i,n,e.handle);i[W.expando]=void 0}i[X.expando]&&(i[X.expando]=void 0)}}}),S.fn.extend({detach:function(t){return At(this,t,!0)},remove:function(t){return At(this,t)},text:function(t){return j(this,function(t){return void 0===t?S.text(this):this.empty().each(function(){1!==this.nodeType&&11!==this.nodeType&&9!==this.nodeType||(this.textContent=t)})},null,t,arguments.length)},append:function(){return Tt(this,arguments,function(t){1!==this.nodeType&&11!==this.nodeType&&9!==this.nodeType||St(this,t).appendChild(t)})},prepend:function(){return Tt(this,arguments,function(t){var e;1!==this.nodeType&&11!==this.nodeType&&9!==this.nodeType||(e=St(this,t)).insertBefore(t,e.firstChild)})},before:function(){return Tt(this,arguments,function(t){this.parentNode&&this.parentNode.insertBefore(t,this)})},after:function(){return Tt(this,arguments,function(t){this.parentNode&&this.parentNode.insertBefore(t,this.nextSibling)})},empty:function(){for(var t,e=0;null!=(t=this[e]);e++)1===t.nodeType&&(S.cleanData(at(t,!1)),t.textContent="");return this},clone:function(t,e){return t=null!=t&&t,e=null==e?t:e,this.map(function(){return S.clone(this,t,e)})},html:function(t){return j(this,function(t){var e=this[0]||{},i=0,n=this.length;if(void 0===t&&1===e.nodeType)return e.innerHTML;if("string"==typeof t&&!vt.test(t)&&!st[(rt.exec(t)||["",""])[1].toLowerCase()]){t=S.htmlPrefilter(t);try{for(;i<n;i++)1===(e=this[i]||{}).nodeType&&(S.cleanData(at(e,!1)),e.innerHTML=t);e=0}catch(t){}}e&&this.empty().append(t)},null,t,arguments.length)},replaceWith:function(){var i=[];return Tt(this,arguments,function(t){var e=this.parentNode;S.inArray(this,i)<0&&(S.cleanData(at(this)),e&&e.replaceChild(t,this))},i)}}),S.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(t,s){S.fn[t]=function(t){for(var e,i=[],n=S(t),r=n.length-1,o=0;o<=r;o++)e=o===r?this:this.clone(!0),S(n[o])[s](e),h.apply(i,e.get());return this.pushStack(i)}});function kt(t){var e=t.ownerDocument.defaultView;return(e=!e||!e.opener?z:e).getComputedStyle(t)}var Ot,Et,It,Gt,Dt,Lt,Bt=/^margin/,Rt=new RegExp("^("+J+")(?!px)[a-z%]+$","i");function Ft(){var t;Lt&&(Lt.style.cssText="box-sizing:border-box;position:relative;display:block;margin:auto;border:1px;padding:1px;top:1%;width:50%",Lt.innerHTML="",ut.appendChild(Dt),t=z.getComputedStyle(Lt),Ot="1%"!==t.top,Gt="2px"===t.marginLeft,Et="4px"===t.width,Lt.style.marginRight="50%",It="4px"===t.marginRight,ut.removeChild(Dt),Lt=null)}function Nt(t,e,i){var n,r,o=t.style;return(i=i||kt(t))&&(""!==(r=i.getPropertyValue(e)||i[e])||S.contains(t.ownerDocument,t)||(r=S.style(t,e)),!m.pixelMarginRight()&&Rt.test(r)&&Bt.test(e)&&(n=o.width,t=o.minWidth,e=o.maxWidth,o.minWidth=o.maxWidth=o.width=r,r=i.width,o.width=n,o.minWidth=t,o.maxWidth=e)),void 0!==r?r+"":r}function jt(t,e){return{get:function(){return t()?void delete this.get:(this.get=e).apply(this,arguments)}}}Dt=b.createElement("div"),(Lt=b.createElement("div")).style&&(Lt.style.backgroundClip="content-box",Lt.cloneNode(!0).style.backgroundClip="",m.clearCloneStyle="content-box"===Lt.style.backgroundClip,Dt.style.cssText="border:0;width:8px;height:0;top:0;left:-9999px;padding:0;margin-top:1px;position:absolute",Dt.appendChild(Lt),S.extend(m,{pixelPosition:function(){return Ft(),Ot},boxSizingReliable:function(){return Ft(),Et},pixelMarginRight:function(){return Ft(),It},reliableMarginLeft:function(){return Ft(),Gt}}));var Ut=/^(none|table(?!-c[ea]).+)/,Vt={position:"absolute",visibility:"hidden",display:"block"},Wt={letterSpacing:"0",fontWeight:"400"},Xt=["Webkit","Moz","ms"],Ht=b.createElement("div").style;function qt(t){if(t in Ht)return t;for(var e=t[0].toUpperCase()+t.slice(1),i=Xt.length;i--;)if((t=Xt[i]+e)in Ht)return t}function Yt(t,e,i){var n=Q.exec(e);return n?Math.max(0,n[2]-(i||0))+(n[3]||"px"):e}function Kt(t,e,i,n,r){for(var o=0,s=i===(n?"border":"content")?4:"width"===e?1:0;s<4;s+=2)"margin"===i&&(o+=S.css(t,i+$[s],!0,r)),n?("content"===i&&(o-=S.css(t,"padding"+$[s],!0,r)),"margin"!==i&&(o-=S.css(t,"border"+$[s]+"Width",!0,r))):(o+=S.css(t,"padding"+$[s],!0,r),"padding"!==i&&(o+=S.css(t,"border"+$[s]+"Width",!0,r)));return o}function Zt(t,e,i){var n,r=!0,o=kt(t),s="border-box"===S.css(t,"boxSizing",!1,o);if((n=t.getClientRects().length?t.getBoundingClientRect()[e]:n)<=0||null==n){if(((n=Nt(t,e,o))<0||null==n)&&(n=t.style[e]),Rt.test(n))return n;r=s&&(m.boxSizingReliable()||n===t.style[e]),n=parseFloat(n)||0}return n+Kt(t,e,i||(s?"border":"content"),r,o)+"px"}function Jt(t,e,i,n,r){return new Jt.prototype.init(t,e,i,n,r)}S.extend({cssHooks:{opacity:{get:function(t,e){if(e){t=Nt(t,"opacity");return""===t?"1":t}}}},cssNumber:{animationIterationCount:!0,columnCount:!0,fillOpacity:!0,flexGrow:!0,flexShrink:!0,fontWeight:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,widows:!0,zIndex:!0,zoom:!0},cssProps:{float:"cssFloat"},style:function(t,e,i,n){if(t&&3!==t.nodeType&&8!==t.nodeType&&t.style){var r,o,s,a=S.camelCase(e),h=t.style;return e=S.cssProps[a]||(S.cssProps[a]=qt(a)||a),s=S.cssHooks[e]||S.cssHooks[a],void 0===i?s&&"get"in s&&void 0!==(r=s.get(t,!1,n))?r:h[e]:("string"===(o=typeof i)&&(r=Q.exec(i))&&r[1]&&(i=tt(t,e,r),o="number"),void(null!=i&&i==i&&("number"===o&&(i+=r&&r[3]||(S.cssNumber[a]?"":"px")),m.clearCloneStyle||""!==i||0!==e.indexOf("background")||(h[e]="inherit"),s&&"set"in s&&void 0===(i=s.set(t,i,n))||(h[e]=i))))}},css:function(t,e,i,n){var r,o=S.camelCase(e);return e=S.cssProps[o]||(S.cssProps[o]=qt(o)||o),"normal"===(r=void 0===(r=(o=S.cssHooks[e]||S.cssHooks[o])&&"get"in o?o.get(t,!0,i):r)?Nt(t,e,n):r)&&e in Wt&&(r=Wt[e]),""===i||i?(e=parseFloat(r),!0===i||isFinite(e)?e||0:r):r}}),S.each(["height","width"],function(t,o){S.cssHooks[o]={get:function(t,e,i){if(e)return!Ut.test(S.css(t,"display"))||t.getClientRects().length&&t.getBoundingClientRect().width?Zt(t,o,i):Z(t,Vt,function(){return Zt(t,o,i)})},set:function(t,e,i){var n,r=i&&kt(t),r=i&&Kt(t,o,i,"border-box"===S.css(t,"boxSizing",!1,r),r);return r&&(n=Q.exec(e))&&"px"!==(n[3]||"px")&&(t.style[o]=e,e=S.css(t,o)),Yt(0,e,r)}}}),S.cssHooks.marginLeft=jt(m.reliableMarginLeft,function(t,e){if(e)return(parseFloat(Nt(t,"marginLeft"))||t.getBoundingClientRect().left-Z(t,{marginLeft:0},function(){return t.getBoundingClientRect().left}))+"px"}),S.each({margin:"",padding:"",border:"Width"},function(r,o){S.cssHooks[r+o]={expand:function(t){for(var e=0,i={},n="string"==typeof t?t.split(" "):[t];e<4;e++)i[r+$[e]+o]=n[e]||n[e-2]||n[0];return i}},Bt.test(r)||(S.cssHooks[r+o].set=Yt)}),S.fn.extend({css:function(t,e){return j(this,function(t,e,i){var n,r,o={},s=0;if(S.isArray(e)){for(n=kt(t),r=e.length;s<r;s++)o[e[s]]=S.css(t,e[s],!1,n);return o}return void 0!==i?S.style(t,e,i):S.css(t,e)},t,e,1<arguments.length)}}),((S.Tween=Jt).prototype={constructor:Jt,init:function(t,e,i,n,r,o){this.elem=t,this.prop=i,this.easing=r||S.easing._default,this.options=e,this.start=this.now=this.cur(),this.end=n,this.unit=o||(S.cssNumber[i]?"":"px")},cur:function(){var t=Jt.propHooks[this.prop];return(t&&t.get?t:Jt.propHooks._default).get(this)},run:function(t){var e,i=Jt.propHooks[this.prop];return this.options.duration?this.pos=e=S.easing[this.easing](t,this.options.duration*t,0,1,this.options.duration):this.pos=e=t,this.now=(this.end-this.start)*e+this.start,this.options.step&&this.options.step.call(this.elem,this.now,this),(i&&i.set?i:Jt.propHooks._default).set(this),this}}).init.prototype=Jt.prototype,(Jt.propHooks={_default:{get:function(t){return 1!==t.elem.nodeType||null!=t.elem[t.prop]&&null==t.elem.style[t.prop]?t.elem[t.prop]:(t=S.css(t.elem,t.prop,""))&&"auto"!==t?t:0},set:function(t){S.fx.step[t.prop]?S.fx.step[t.prop](t):1!==t.elem.nodeType||null==t.elem.style[S.cssProps[t.prop]]&&!S.cssHooks[t.prop]?t.elem[t.prop]=t.now:S.style(t.elem,t.prop,t.now+t.unit)}}}).scrollTop=Jt.propHooks.scrollLeft={set:function(t){t.elem.nodeType&&t.elem.parentNode&&(t.elem[t.prop]=t.now)}},S.easing={linear:function(t){return t},swing:function(t){return.5-Math.cos(t*Math.PI)/2},_default:"swing"},S.fx=Jt.prototype.init,S.fx.step={};var Qt,$t,te=/^(?:toggle|show|hide)$/,ee=/queueHooks$/;function ie(){$t&&(z.requestAnimationFrame(ie),S.fx.tick())}function ne(){return z.setTimeout(function(){Qt=void 0}),Qt=S.now()}function re(t,e){var i,n=0,r={height:t};for(e=e?1:0;n<4;n+=2-e)r["margin"+(i=$[n])]=r["padding"+i]=t;return e&&(r.opacity=r.width=t),r}function oe(t,e,i){for(var n,r=(se.tweeners[e]||[]).concat(se.tweeners["*"]),o=0,s=r.length;o<s;o++)if(n=r[o].call(i,e,t))return n}function se(r,t,e){var i,o,n=0,s=se.prefilters.length,a=S.Deferred().always(function(){delete h.elem}),h=function(){if(o)return!1;for(var t=Qt||ne(),t=Math.max(0,l.startTime+l.duration-t),e=1-(t/l.duration||0),i=0,n=l.tweens.length;i<n;i++)l.tweens[i].run(e);return a.notifyWith(r,[l,e,t]),e<1&&n?t:(a.resolveWith(r,[l]),!1)},l=a.promise({elem:r,props:S.extend({},t),opts:S.extend(!0,{specialEasing:{},easing:S.easing._default},e),originalProperties:t,originalOptions:e,startTime:Qt||ne(),duration:e.duration,tweens:[],createTween:function(t,e){t=S.Tween(r,l.opts,t,e,l.opts.specialEasing[t]||l.opts.easing);return l.tweens.push(t),t},stop:function(t){var e=0,i=t?l.tweens.length:0;if(o)return this;for(o=!0;e<i;e++)l.tweens[e].run(1);return t?(a.notifyWith(r,[l,1,0]),a.resolveWith(r,[l,t])):a.rejectWith(r,[l,t]),this}}),p=l.props;for(function(t,e){var i,n,r,o,s;for(i in t)if(n=S.camelCase(i),r=e[n],o=t[i],S.isArray(o)&&(r=o[1],o=t[i]=o[0]),i!==n&&(t[n]=o,delete t[i]),s=S.cssHooks[n],s&&"expand"in s)for(i in o=s.expand(o),delete t[n],o)i in t||(t[i]=o[i],e[i]=r);else e[n]=r}(p,l.opts.specialEasing);n<s;n++)if(i=se.prefilters[n].call(l,r,p,l.opts))return S.isFunction(i.stop)&&(S._queueHooks(l.elem,l.opts.queue).stop=S.proxy(i.stop,i)),i;return S.map(p,oe,l),S.isFunction(l.opts.start)&&l.opts.start.call(r,l),S.fx.timer(S.extend(h,{elem:r,anim:l,queue:l.opts.queue})),l.progress(l.opts.progress).done(l.opts.done,l.opts.complete).fail(l.opts.fail).always(l.opts.always)}S.Animation=S.extend(se,{tweeners:{"*":[function(t,e){var i=this.createTween(t,e);return tt(i.elem,t,Q.exec(e),i),i}]},tweener:function(t,e){for(var i,n=0,r=(t=S.isFunction(t)?(e=t,["*"]):t.match(G)).length;n<r;n++)i=t[n],se.tweeners[i]=se.tweeners[i]||[],se.tweeners[i].unshift(e)},prefilters:[function(t,e,i){var n,r,o,s,a,h,l,p="width"in e||"height"in e,u=this,d={},c=t.style,y=t.nodeType&&K(t),_=W.get(t,"fxshow");for(n in i.queue||(null==(s=S._queueHooks(t,"fx")).unqueued&&(s.unqueued=0,a=s.empty.fire,s.empty.fire=function(){s.unqueued||a()}),s.unqueued++,u.always(function(){u.always(function(){s.unqueued--,S.queue(t,"fx").length||s.empty.fire()})})),e)if(r=e[n],te.test(r)){if(delete e[n],o=o||"toggle"===r,r===(y?"hide":"show")){if("show"!==r||!_||void 0===_[n])continue;y=!0}d[n]=_&&_[n]||S.style(t,n)}if((h=!S.isEmptyObject(e))||!S.isEmptyObject(d))for(n in p&&1===t.nodeType&&(i.overflow=[c.overflow,c.overflowX,c.overflowY],null==(l=_&&_.display)&&(l=W.get(t,"display")),"none"===(p=S.css(t,"display"))&&(l?p=l:(it([t],!0),l=t.style.display||l,p=S.css(t,"display"),it([t]))),("inline"===p||"inline-block"===p&&null!=l)&&"none"===S.css(t,"float")&&(h||(u.done(function(){c.display=l}),null==l&&(p=c.display,l="none"===p?"":p)),c.display="inline-block")),i.overflow&&(c.overflow="hidden",u.always(function(){c.overflow=i.overflow[0],c.overflowX=i.overflow[1],c.overflowY=i.overflow[2]})),h=!1,d)h||(_?"hidden"in _&&(y=_.hidden):_=W.access(t,"fxshow",{display:l}),o&&(_.hidden=!y),y&&it([t],!0),u.done(function(){for(n in y||it([t]),W.remove(t,"fxshow"),d)S.style(t,n,d[n])})),h=oe(y?_[n]:0,n,u),n in _||(_[n]=h.start,y&&(h.end=h.start,h.start=0))}],prefilter:function(t,e){e?se.prefilters.unshift(t):se.prefilters.push(t)}}),S.speed=function(t,e,i){var n=t&&"object"==typeof t?S.extend({},t):{complete:i||!i&&e||S.isFunction(t)&&t,duration:t,easing:i&&e||e&&!S.isFunction(e)&&e};return S.fx.off||b.hidden?n.duration=0:"number"!=typeof n.duration&&(n.duration in S.fx.speeds?n.duration=S.fx.speeds[n.duration]:n.duration=S.fx.speeds._default),null!=n.queue&&!0!==n.queue||(n.queue="fx"),n.old=n.complete,n.complete=function(){S.isFunction(n.old)&&n.old.call(this),n.queue&&S.dequeue(this,n.queue)},n},S.fn.extend({fadeTo:function(t,e,i,n){return this.filter(K).css("opacity",0).show().end().animate({opacity:e},t,i,n)},animate:function(e,t,i,n){function r(){var t=se(this,S.extend({},e),s);(o||W.get(this,"finish"))&&t.stop(!0)}var o=S.isEmptyObject(e),s=S.speed(t,i,n);return r.finish=r,o||!1===s.queue?this.each(r):this.queue(s.queue,r)},stop:function(r,t,o){function s(t){var e=t.stop;delete t.stop,e(o)}return"string"!=typeof r&&(o=t,t=r,r=void 0),t&&!1!==r&&this.queue(r||"fx",[]),this.each(function(){var t=!0,e=null!=r&&r+"queueHooks",i=S.timers,n=W.get(this);if(e)n[e]&&n[e].stop&&s(n[e]);else for(e in n)n[e]&&n[e].stop&&ee.test(e)&&s(n[e]);for(e=i.length;e--;)i[e].elem!==this||null!=r&&i[e].queue!==r||(i[e].anim.stop(o),t=!1,i.splice(e,1));!t&&o||S.dequeue(this,r)})},finish:function(s){return!1!==s&&(s=s||"fx"),this.each(function(){var t,e=W.get(this),i=e[s+"queue"],n=e[s+"queueHooks"],r=S.timers,o=i?i.length:0;for(e.finish=!0,S.queue(this,s,[]),n&&n.stop&&n.stop.call(this,!0),t=r.length;t--;)r[t].elem===this&&r[t].queue===s&&(r[t].anim.stop(!0),r.splice(t,1));for(t=0;t<o;t++)i[t]&&i[t].finish&&i[t].finish.call(this);delete e.finish})}}),S.each(["toggle","show","hide"],function(t,n){var r=S.fn[n];S.fn[n]=function(t,e,i){return null==t||"boolean"==typeof t?r.apply(this,arguments):this.animate(re(n,!0),t,e,i)}}),S.each({slideDown:re("show"),slideUp:re("hide"),slideToggle:re("toggle"),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},function(t,n){S.fn[t]=function(t,e,i){return this.animate(n,t,e,i)}}),S.timers=[],S.fx.tick=function(){var t,e=0,i=S.timers;for(Qt=S.now();e<i.length;e++)(t=i[e])()||i[e]!==t||i.splice(e--,1);i.length||S.fx.stop(),Qt=void 0},S.fx.timer=function(t){S.timers.push(t),t()?S.fx.start():S.timers.pop()},S.fx.interval=13,S.fx.start=function(){$t=$t||(z.requestAnimationFrame?z.requestAnimationFrame(ie):z.setInterval(S.fx.tick,S.fx.interval))},S.fx.stop=function(){z.cancelAnimationFrame?z.cancelAnimationFrame($t):z.clearInterval($t),$t=null},S.fx.speeds={slow:600,fast:200,_default:400},S.fn.delay=function(n,t){return n=S.fx&&S.fx.speeds[n]||n,this.queue(t=t||"fx",function(t,e){var i=z.setTimeout(t,n);e.stop=function(){z.clearTimeout(i)}})},e=b.createElement("input"),J=b.createElement("select").appendChild(b.createElement("option")),e.type="checkbox",m.checkOn=""!==e.value,m.optSelected=J.selected,(e=b.createElement("input")).value="t",e.type="radio",m.radioValue="t"===e.value;var ae,he=S.expr.attrHandle;S.fn.extend({attr:function(t,e){return j(this,S.attr,t,e,1<arguments.length)},removeAttr:function(t){return this.each(function(){S.removeAttr(this,t)})}}),S.extend({attr:function(t,e,i){var n,r,o=t.nodeType;if(3!==o&&8!==o&&2!==o)return void 0===t.getAttribute?S.prop(t,e,i):(1===o&&S.isXMLDoc(t)||(r=S.attrHooks[e.toLowerCase()]||(S.expr.match.bool.test(e)?ae:void 0)),void 0!==i?null===i?void S.removeAttr(t,e):r&&"set"in r&&void 0!==(n=r.set(t,i,e))?n:(t.setAttribute(e,i+""),i):r&&"get"in r&&null!==(n=r.get(t,e))?n:null==(n=S.find.attr(t,e))?void 0:n)},attrHooks:{type:{set:function(t,e){if(!m.radioValue&&"radio"===e&&S.nodeName(t,"input")){var i=t.value;return t.setAttribute("type",e),i&&(t.value=i),e}}}},removeAttr:function(t,e){var i,n=0,r=e&&e.match(G);if(r&&1===t.nodeType)for(;i=r[n++];)t.removeAttribute(i)}}),ae={set:function(t,e,i){return!1===e?S.removeAttr(t,i):t.setAttribute(i,i),i}},S.each(S.expr.match.bool.source.match(/\w+/g),function(t,e){var s=he[e]||S.find.attr;he[e]=function(t,e,i){var n,r,o=e.toLowerCase();return i||(r=he[o],he[o]=n,n=null!=s(t,e,i)?o:null,he[o]=r),n}});var le=/^(?:input|select|textarea|button)$/i,pe=/^(?:a|area)$/i;function ue(t){return(t.match(G)||[]).join(" ")}function de(t){return t.getAttribute&&t.getAttribute("class")||""}S.fn.extend({prop:function(t,e){return j(this,S.prop,t,e,1<arguments.length)},removeProp:function(t){return this.each(function(){delete this[S.propFix[t]||t]})}}),S.extend({prop:function(t,e,i){var n,r,o=t.nodeType;if(3!==o&&8!==o&&2!==o)return 1===o&&S.isXMLDoc(t)||(e=S.propFix[e]||e,r=S.propHooks[e]),void 0!==i?r&&"set"in r&&void 0!==(n=r.set(t,i,e))?n:t[e]=i:r&&"get"in r&&null!==(n=r.get(t,e))?n:t[e]},propHooks:{tabIndex:{get:function(t){var e=S.find.attr(t,"tabindex");return e?parseInt(e,10):le.test(t.nodeName)||pe.test(t.nodeName)&&t.href?0:-1}}},propFix:{for:"htmlFor",class:"className"}}),m.optSelected||(S.propHooks.selected={get:function(t){t=t.parentNode;return t&&t.parentNode&&t.parentNode.selectedIndex,null},set:function(t){t=t.parentNode;t&&(t.selectedIndex,t.parentNode&&t.parentNode.selectedIndex)}}),S.each(["tabIndex","readOnly","maxLength","cellSpacing","cellPadding","rowSpan","colSpan","useMap","frameBorder","contentEditable"],function(){S.propFix[this.toLowerCase()]=this}),S.fn.extend({addClass:function(e){var t,i,n,r,o,s,a=0;if(S.isFunction(e))return this.each(function(t){S(this).addClass(e.call(this,t,de(this)))});if("string"==typeof e&&e)for(t=e.match(G)||[];i=this[a++];)if(s=de(i),n=1===i.nodeType&&" "+ue(s)+" "){for(o=0;r=t[o++];)n.indexOf(" "+r+" ")<0&&(n+=r+" ");s!==(s=ue(n))&&i.setAttribute("class",s)}return this},removeClass:function(e){var t,i,n,r,o,s,a=0;if(S.isFunction(e))return this.each(function(t){S(this).removeClass(e.call(this,t,de(this)))});if(!arguments.length)return this.attr("class","");if("string"==typeof e&&e)for(t=e.match(G)||[];i=this[a++];)if(s=de(i),n=1===i.nodeType&&" "+ue(s)+" "){for(o=0;r=t[o++];)for(;-1<n.indexOf(" "+r+" ");)n=n.replace(" "+r+" "," ");s!==(s=ue(n))&&i.setAttribute("class",s)}return this},toggleClass:function(r,e){var o=typeof r;return"boolean"==typeof e&&"string"==o?e?this.addClass(r):this.removeClass(r):S.isFunction(r)?this.each(function(t){S(this).toggleClass(r.call(this,t,de(this),e),e)}):this.each(function(){var t,e,i,n;if("string"==o)for(e=0,i=S(this),n=r.match(G)||[];t=n[e++];)i.hasClass(t)?i.removeClass(t):i.addClass(t);else void 0!==r&&"boolean"!=o||((t=de(this))&&W.set(this,"__className__",t),this.setAttribute&&this.setAttribute("class",!t&&!1!==r&&W.get(this,"__className__")||""))})},hasClass:function(t){for(var e,i=0,n=" "+t+" ";e=this[i++];)if(1===e.nodeType&&-1<(" "+ue(de(e))+" ").indexOf(n))return!0;return!1}});var ce=/\r/g;S.fn.extend({val:function(e){var i,t,n,r=this[0];return arguments.length?(n=S.isFunction(e),this.each(function(t){1===this.nodeType&&(null==(t=n?e.call(this,t,S(this).val()):e)?t="":"number"==typeof t?t+="":S.isArray(t)&&(t=S.map(t,function(t){return null==t?"":t+""})),(i=S.valHooks[this.type]||S.valHooks[this.nodeName.toLowerCase()])&&"set"in i&&void 0!==i.set(this,t,"value")||(this.value=t))})):r?(i=S.valHooks[r.type]||S.valHooks[r.nodeName.toLowerCase()])&&"get"in i&&void 0!==(t=i.get(r,"value"))?t:"string"==typeof(t=r.value)?t.replace(ce,""):null==t?"":t:void 0}}),S.extend({valHooks:{option:{get:function(t){var e=S.find.attr(t,"value");return null!=e?e:ue(S.text(t))}},select:{get:function(t){for(var e,i=t.options,n=t.selectedIndex,r="select-one"===t.type,o=r?null:[],s=r?n+1:i.length,a=n<0?s:r?n:0;a<s;a++)if(((e=i[a]).selected||a===n)&&!e.disabled&&(!e.parentNode.disabled||!S.nodeName(e.parentNode,"optgroup"))){if(e=S(e).val(),r)return e;o.push(e)}return o},set:function(t,e){for(var i,n,r=t.options,o=S.makeArray(e),s=r.length;s--;)((n=r[s]).selected=-1<S.inArray(S.valHooks.option.get(n),o))&&(i=!0);return i||(t.selectedIndex=-1),o}}}}),S.each(["radio","checkbox"],function(){S.valHooks[this]={set:function(t,e){if(S.isArray(e))return t.checked=-1<S.inArray(S(t).val(),e)}},m.checkOn||(S.valHooks[this].get=function(t){return null===t.getAttribute("value")?"on":t.value})});var ye=/^(?:focusinfocus|focusoutblur)$/;S.extend(S.event,{trigger:function(t,e,i,n){var r,o,s,a,h,l,p=[i||b],u=y.call(t,"type")?t.type:t,d=y.call(t,"namespace")?t.namespace.split("."):[],c=o=i=i||b;if(3!==i.nodeType&&8!==i.nodeType&&!ye.test(u+S.event.triggered)&&(-1<u.indexOf(".")&&(u=(d=u.split(".")).shift(),d.sort()),a=u.indexOf(":")<0&&"on"+u,(t=t[S.expando]?t:new S.Event(u,"object"==typeof t&&t)).isTrigger=n?2:3,t.namespace=d.join("."),t.rnamespace=t.namespace?new RegExp("(^|\\.)"+d.join("\\.(?:.*\\.|)")+"(\\.|$)"):null,t.result=void 0,t.target||(t.target=i),e=null==e?[t]:S.makeArray(e,[t]),l=S.event.special[u]||{},n||!l.trigger||!1!==l.trigger.apply(i,e))){if(!n&&!l.noBubble&&!S.isWindow(i)){for(s=l.delegateType||u,ye.test(s+u)||(c=c.parentNode);c;c=c.parentNode)p.push(c),o=c;o===(i.ownerDocument||b)&&p.push(o.defaultView||o.parentWindow||z)}for(r=0;(c=p[r++])&&!t.isPropagationStopped();)t.type=1<r?s:l.bindType||u,(h=(W.get(c,"events")||{})[t.type]&&W.get(c,"handle"))&&h.apply(c,e),(h=a&&c[a])&&h.apply&&U(c)&&(t.result=h.apply(c,e),!1===t.result&&t.preventDefault());return t.type=u,n||t.isDefaultPrevented()||l._default&&!1!==l._default.apply(p.pop(),e)||!U(i)||a&&S.isFunction(i[u])&&!S.isWindow(i)&&((o=i[a])&&(i[a]=null),i[S.event.triggered=u](),S.event.triggered=void 0,o&&(i[a]=o)),t.result}},simulate:function(t,e,i){t=S.extend(new S.Event,i,{type:t,isSimulated:!0});S.event.trigger(t,null,e)}}),S.fn.extend({trigger:function(t,e){return this.each(function(){S.event.trigger(t,e,this)})},triggerHandler:function(t,e){var i=this[0];if(i)return S.event.trigger(t,e,i,!0)}}),S.each("blur focus focusin focusout resize scroll click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup contextmenu".split(" "),function(t,i){S.fn[i]=function(t,e){return 0<arguments.length?this.on(i,null,t,e):this.trigger(i)}}),S.fn.extend({hover:function(t,e){return this.mouseenter(t).mouseleave(e||t)}}),m.focusin="onfocusin"in z,m.focusin||S.each({focus:"focusin",blur:"focusout"},function(i,n){function r(t){S.event.simulate(n,t.target,S.event.fix(t))}S.event.special[n]={setup:function(){var t=this.ownerDocument||this,e=W.access(t,n);e||t.addEventListener(i,r,!0),W.access(t,n,(e||0)+1)},teardown:function(){var t=this.ownerDocument||this,e=W.access(t,n)-1;e?W.access(t,n,e):(t.removeEventListener(i,r,!0),W.remove(t,n))}}});var _e=z.location,me=S.now(),ge=/\?/;S.parseXML=function(t){var e;if(!t||"string"!=typeof t)return null;try{e=(new z.DOMParser).parseFromString(t,"text/xml")}catch(t){e=void 0}return e&&!e.getElementsByTagName("parsererror").length||S.error("Invalid XML: "+t),e};var fe=/\[\]$/,xe=/\r?\n/g,ve=/^(?:submit|button|image|reset|file)$/i,we=/^(?:input|select|textarea|keygen)/i;S.param=function(t,e){function i(t,e){e=S.isFunction(e)?e():e,r[r.length]=encodeURIComponent(t)+"="+encodeURIComponent(null==e?"":e)}var n,r=[];if(S.isArray(t)||t.jquery&&!S.isPlainObject(t))S.each(t,function(){i(this.name,this.value)});else for(n in t)!function i(n,t,r,o){if(S.isArray(t))S.each(t,function(t,e){r||fe.test(n)?o(n,e):i(n+"["+("object"==typeof e&&null!=e?t:"")+"]",e,r,o)});else if(r||"object"!==S.type(t))o(n,t);else for(var e in t)i(n+"["+e+"]",t[e],r,o)}(n,t[n],e,i);return r.join("&")},S.fn.extend({serialize:function(){return S.param(this.serializeArray())},serializeArray:function(){return this.map(function(){var t=S.prop(this,"elements");return t?S.makeArray(t):this}).filter(function(){var t=this.type;return this.name&&!S(this).is(":disabled")&&we.test(this.nodeName)&&!ve.test(t)&&(this.checked||!nt.test(t))}).map(function(t,e){var i=S(this).val();return null==i?null:S.isArray(i)?S.map(i,function(t){return{name:e.name,value:t.replace(xe,"\r\n")}}):{name:e.name,value:i.replace(xe,"\r\n")}}).get()}});var ze=/%20/g,be=/#.*$/,Se=/([?&])_=[^&]*/,Ce=/^(.*?):[ \t]*([^\r\n]*)$/gm,Pe=/^(?:GET|HEAD)$/,Me=/^\/\//,Te={},Ae={},ke="*/".concat("*"),Oe=b.createElement("a");function Ee(o){return function(t,e){"string"!=typeof t&&(e=t,t="*");var i,n=0,r=t.toLowerCase().match(G)||[];if(S.isFunction(e))for(;i=r[n++];)"+"===i[0]?(i=i.slice(1)||"*",(o[i]=o[i]||[]).unshift(e)):(o[i]=o[i]||[]).push(e)}}function Ie(e,n,r,o){var s={},a=e===Ae;function h(t){var i;return s[t]=!0,S.each(e[t]||[],function(t,e){e=e(n,r,o);return"string"!=typeof e||a||s[e]?a?!(i=e):void 0:(n.dataTypes.unshift(e),h(e),!1)}),i}return h(n.dataTypes[0])||!s["*"]&&h("*")}function Ge(t,e){var i,n,r=S.ajaxSettings.flatOptions||{};for(i in e)void 0!==e[i]&&((r[i]?t:n=n||{})[i]=e[i]);return n&&S.extend(!0,t,n),t}Oe.href=_e.href,S.extend({active:0,lastModified:{},etag:{},ajaxSettings:{url:_e.href,type:"GET",isLocal:/^(?:about|app|app-storage|.+-extension|file|res|widget):$/.test(_e.protocol),global:!0,processData:!0,async:!0,contentType:"application/x-www-form-urlencoded; charset=UTF-8",accepts:{"*":ke,text:"text/plain",html:"text/html",xml:"application/xml, text/xml",json:"application/json, text/javascript"},contents:{xml:/\bxml\b/,html:/\bhtml/,json:/\bjson\b/},responseFields:{xml:"responseXML",text:"responseText",json:"responseJSON"},converters:{"* text":String,"text html":!0,"text json":JSON.parse,"text xml":S.parseXML},flatOptions:{url:!0,context:!0}},ajaxSetup:function(t,e){return e?Ge(Ge(t,S.ajaxSettings),e):Ge(S.ajaxSettings,t)},ajaxPrefilter:Ee(Te),ajaxTransport:Ee(Ae),ajax:function(t,e){"object"==typeof t&&(e=t,t=void 0);var h,l,p,i,u,d,c,n,r,y=S.ajaxSetup({},e=e||{}),_=y.context||y,m=y.context&&(_.nodeType||_.jquery)?S(_):S.event,g=S.Deferred(),f=S.Callbacks("once memory"),x=y.statusCode||{},o={},s={},a="canceled",v={readyState:0,getResponseHeader:function(t){var e;if(d){if(!i)for(i={};e=Ce.exec(p);)i[e[1].toLowerCase()]=e[2];e=i[t.toLowerCase()]}return null==e?null:e},getAllResponseHeaders:function(){return d?p:null},setRequestHeader:function(t,e){return null==d&&(t=s[t.toLowerCase()]=s[t.toLowerCase()]||t,o[t]=e),this},overrideMimeType:function(t){return null==d&&(y.mimeType=t),this},statusCode:function(t){if(t)if(d)v.always(t[v.status]);else for(var e in t)x[e]=[x[e],t[e]];return this},abort:function(t){t=t||a;return h&&h.abort(t),w(0,t),this}};if(g.promise(v),y.url=((t||y.url||_e.href)+"").replace(Me,_e.protocol+"//"),y.type=e.method||e.type||y.method||y.type,y.dataTypes=(y.dataType||"*").toLowerCase().match(G)||[""],null==y.crossDomain){r=b.createElement("a");try{r.href=y.url,r.href=r.href,y.crossDomain=Oe.protocol+"//"+Oe.host!=r.protocol+"//"+r.host}catch(t){y.crossDomain=!0}}if(y.data&&y.processData&&"string"!=typeof y.data&&(y.data=S.param(y.data,y.traditional)),Ie(Te,y,e,v),d)return v;for(n in(c=S.event&&y.global)&&0==S.active++&&S.event.trigger("ajaxStart"),y.type=y.type.toUpperCase(),y.hasContent=!Pe.test(y.type),l=y.url.replace(be,""),y.hasContent?y.data&&y.processData&&0===(y.contentType||"").indexOf("application/x-www-form-urlencoded")&&(y.data=y.data.replace(ze,"+")):(r=y.url.slice(l.length),y.data&&(l+=(ge.test(l)?"&":"?")+y.data,delete y.data),!1===y.cache&&(l=l.replace(Se,"$1"),r=(ge.test(l)?"&":"?")+"_="+me+++r),y.url=l+r),y.ifModified&&(S.lastModified[l]&&v.setRequestHeader("If-Modified-Since",S.lastModified[l]),S.etag[l]&&v.setRequestHeader("If-None-Match",S.etag[l])),(y.data&&y.hasContent&&!1!==y.contentType||e.contentType)&&v.setRequestHeader("Content-Type",y.contentType),v.setRequestHeader("Accept",y.dataTypes[0]&&y.accepts[y.dataTypes[0]]?y.accepts[y.dataTypes[0]]+("*"!==y.dataTypes[0]?", "+ke+"; q=0.01":""):y.accepts["*"]),y.headers)v.setRequestHeader(n,y.headers[n]);if(y.beforeSend&&(!1===y.beforeSend.call(_,v,y)||d))return v.abort();if(a="abort",f.add(y.complete),v.done(y.success),v.fail(y.error),h=Ie(Ae,y,e,v)){if(v.readyState=1,c&&m.trigger("ajaxSend",[v,y]),d)return v;y.async&&0<y.timeout&&(u=z.setTimeout(function(){v.abort("timeout")},y.timeout));try{d=!1,h.send(o,w)}catch(t){if(d)throw t;w(-1,t)}}else w(-1,"No Transport");function w(t,e,i,n){var r,o,s,a=e;d||(d=!0,u&&z.clearTimeout(u),h=void 0,p=n||"",v.readyState=0<t?4:0,n=200<=t&&t<300||304===t,i&&(s=function(t,e,i){for(var n,r,o,s,a=t.contents,h=t.dataTypes;"*"===h[0];)h.shift(),void 0===n&&(n=t.mimeType||e.getResponseHeader("Content-Type"));if(n)for(r in a)if(a[r]&&a[r].test(n)){h.unshift(r);break}if(h[0]in i)o=h[0];else{for(r in i){if(!h[0]||t.converters[r+" "+h[0]]){o=r;break}s=s||r}o=o||s}if(o)return o!==h[0]&&h.unshift(o),i[o]}(y,v,i)),s=function(t,e,i,n){var r,o,s,a,h,l={},p=t.dataTypes.slice();if(p[1])for(s in t.converters)l[s.toLowerCase()]=t.converters[s];for(o=p.shift();o;)if(t.responseFields[o]&&(i[t.responseFields[o]]=e),!h&&n&&t.dataFilter&&(e=t.dataFilter(e,t.dataType)),h=o,o=p.shift())if("*"===o)o=h;else if("*"!==h&&h!==o){if(!(s=l[h+" "+o]||l["* "+o]))for(r in l)if(a=r.split(" "),a[1]===o&&(s=l[h+" "+a[0]]||l["* "+a[0]])){!0===s?s=l[r]:!0!==l[r]&&(o=a[0],p.unshift(a[1]));break}if(!0!==s)if(s&&t.throws)e=s(e);else try{e=s(e)}catch(t){return{state:"parsererror",error:s?t:"No conversion from "+h+" to "+o}}}return{state:"success",data:e}}(y,s,v,n),n?(y.ifModified&&((i=v.getResponseHeader("Last-Modified"))&&(S.lastModified[l]=i),(i=v.getResponseHeader("etag"))&&(S.etag[l]=i)),204===t||"HEAD"===y.type?a="nocontent":304===t?a="notmodified":(a=s.state,r=s.data,n=!(o=s.error))):(o=a,!t&&a||(a="error",t<0&&(t=0))),v.status=t,v.statusText=(e||a)+"",n?g.resolveWith(_,[r,a,v]):g.rejectWith(_,[v,a,o]),v.statusCode(x),x=void 0,c&&m.trigger(n?"ajaxSuccess":"ajaxError",[v,y,n?r:o]),f.fireWith(_,[v,a]),c&&(m.trigger("ajaxComplete",[v,y]),--S.active||S.event.trigger("ajaxStop")))}return v},getJSON:function(t,e,i){return S.get(t,e,i,"json")},getScript:function(t,e){return S.get(t,void 0,e,"script")}}),S.each(["get","post"],function(t,r){S[r]=function(t,e,i,n){return S.isFunction(e)&&(n=n||i,i=e,e=void 0),S.ajax(S.extend({url:t,type:r,dataType:n,data:e,success:i},S.isPlainObject(t)&&t))}}),S._evalUrl=function(t){return S.ajax({url:t,type:"GET",dataType:"script",cache:!0,async:!1,global:!1,throws:!0})},S.fn.extend({wrapAll:function(t){return this[0]&&(S.isFunction(t)&&(t=t.call(this[0])),t=S(t,this[0].ownerDocument).eq(0).clone(!0),this[0].parentNode&&t.insertBefore(this[0]),t.map(function(){for(var t=this;t.firstElementChild;)t=t.firstElementChild;return t}).append(this)),this},wrapInner:function(i){return S.isFunction(i)?this.each(function(t){S(this).wrapInner(i.call(this,t))}):this.each(function(){var t=S(this),e=t.contents();e.length?e.wrapAll(i):t.append(i)})},wrap:function(e){var i=S.isFunction(e);return this.each(function(t){S(this).wrapAll(i?e.call(this,t):e)})},unwrap:function(t){return this.parent(t).not("body").each(function(){S(this).replaceWith(this.childNodes)}),this}}),S.expr.pseudos.hidden=function(t){return!S.expr.pseudos.visible(t)},S.expr.pseudos.visible=function(t){return!!(t.offsetWidth||t.offsetHeight||t.getClientRects().length)},S.ajaxSettings.xhr=function(){try{return new z.XMLHttpRequest}catch(t){}};var De={0:200,1223:204},Le=S.ajaxSettings.xhr();m.cors=!!Le&&"withCredentials"in Le,m.ajax=Le=!!Le,S.ajaxTransport(function(r){var o,s;if(m.cors||Le&&!r.crossDomain)return{send:function(t,e){var i,n=r.xhr();if(n.open(r.type,r.url,r.async,r.username,r.password),r.xhrFields)for(i in r.xhrFields)n[i]=r.xhrFields[i];for(i in r.mimeType&&n.overrideMimeType&&n.overrideMimeType(r.mimeType),r.crossDomain||t["X-Requested-With"]||(t["X-Requested-With"]="XMLHttpRequest"),t)n.setRequestHeader(i,t[i]);o=function(t){return function(){o&&(o=s=n.onload=n.onerror=n.onabort=n.onreadystatechange=null,"abort"===t?n.abort():"error"===t?"number"!=typeof n.status?e(0,"error"):e(n.status,n.statusText):e(De[n.status]||n.status,n.statusText,"text"!==(n.responseType||"text")||"string"!=typeof n.responseText?{binary:n.response}:{text:n.responseText},n.getAllResponseHeaders()))}},n.onload=o(),s=n.onerror=o("error"),void 0!==n.onabort?n.onabort=s:n.onreadystatechange=function(){4===n.readyState&&z.setTimeout(function(){o&&s()})},o=o("abort");try{n.send(r.hasContent&&r.data||null)}catch(t){if(o)throw t}},abort:function(){o&&o()}}}),S.ajaxPrefilter(function(t){t.crossDomain&&(t.contents.script=!1)}),S.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/\b(?:java|ecma)script\b/},converters:{"text script":function(t){return S.globalEval(t),t}}}),S.ajaxPrefilter("script",function(t){void 0===t.cache&&(t.cache=!1),t.crossDomain&&(t.type="GET")}),S.ajaxTransport("script",function(i){var n,r;if(i.crossDomain)return{send:function(t,e){n=S("<script>").prop({charset:i.scriptCharset,src:i.url}).on("load error",r=function(t){n.remove(),r=null,t&&e("error"===t.type?404:200,t.type)}),b.head.appendChild(n[0])},abort:function(){r&&r()}}});var Be=[],Re=/(=)\?(?=&|$)|\?\?/;function Fe(t){return S.isWindow(t)?t:9===t.nodeType&&t.defaultView}S.ajaxSetup({jsonp:"callback",jsonpCallback:function(){var t=Be.pop()||S.expando+"_"+me++;return this[t]=!0,t}}),S.ajaxPrefilter("json jsonp",function(t,e,i){var n,r,o,s=!1!==t.jsonp&&(Re.test(t.url)?"url":"string"==typeof t.data&&0===(t.contentType||"").indexOf("application/x-www-form-urlencoded")&&Re.test(t.data)&&"data");if(s||"jsonp"===t.dataTypes[0])return n=t.jsonpCallback=S.isFunction(t.jsonpCallback)?t.jsonpCallback():t.jsonpCallback,s?t[s]=t[s].replace(Re,"$1"+n):!1!==t.jsonp&&(t.url+=(ge.test(t.url)?"&":"?")+t.jsonp+"="+n),t.converters["script json"]=function(){return o||S.error(n+" was not called"),o[0]},t.dataTypes[0]="json",r=z[n],z[n]=function(){o=arguments},i.always(function(){void 0===r?S(z).removeProp(n):z[n]=r,t[n]&&(t.jsonpCallback=e.jsonpCallback,Be.push(n)),o&&S.isFunction(r)&&r(o[0]),o=r=void 0}),"script"}),m.createHTMLDocument=((e=b.implementation.createHTMLDocument("").body).innerHTML="<form></form><form></form>",2===e.childNodes.length),S.parseHTML=function(t,e,i){return"string"!=typeof t?[]:("boolean"==typeof e&&(i=e,e=!1),e||(m.createHTMLDocument?((n=(e=b.implementation.createHTMLDocument("")).createElement("base")).href=b.location.href,e.head.appendChild(n)):e=b),n=!i&&[],(i=P.exec(t))?[e.createElement(i[1])]:(i=pt([t],e,n),n&&n.length&&S(n).remove(),S.merge([],i.childNodes)));var n},S.fn.load=function(t,e,i){var n,r,o,s=this,a=t.indexOf(" ");return-1<a&&(n=ue(t.slice(a)),t=t.slice(0,a)),S.isFunction(e)?(i=e,e=void 0):e&&"object"==typeof e&&(r="POST"),0<s.length&&S.ajax({url:t,type:r||"GET",dataType:"html",data:e}).done(function(t){o=arguments,s.html(n?S("<div>").append(S.parseHTML(t)).find(n):t)}).always(i&&function(t,e){s.each(function(){i.apply(this,o||[t.responseText,e,t])})}),this},S.each(["ajaxStart","ajaxStop","ajaxComplete","ajaxError","ajaxSuccess","ajaxSend"],function(t,e){S.fn[e]=function(t){return this.on(e,t)}}),S.expr.pseudos.animated=function(e){return S.grep(S.timers,function(t){return e===t.elem}).length},S.offset={setOffset:function(t,e,i){var n,r,o,s,a=S.css(t,"position"),h=S(t),l={};"static"===a&&(t.style.position="relative"),o=h.offset(),n=S.css(t,"top"),s=S.css(t,"left"),s=("absolute"===a||"fixed"===a)&&-1<(n+s).indexOf("auto")?(r=(a=h.position()).top,a.left):(r=parseFloat(n)||0,parseFloat(s)||0),null!=(e=S.isFunction(e)?e.call(t,i,S.extend({},o)):e).top&&(l.top=e.top-o.top+r),null!=e.left&&(l.left=e.left-o.left+s),"using"in e?e.using.call(t,l):h.css(l)}},S.fn.extend({offset:function(e){if(arguments.length)return void 0===e?this:this.each(function(t){S.offset.setOffset(this,e,t)});var t,i,n=this[0];return n?n.getClientRects().length?(t=n.getBoundingClientRect()).width||t.height?(n=Fe(i=n.ownerDocument),i=i.documentElement,{top:t.top+n.pageYOffset-i.clientTop,left:t.left+n.pageXOffset-i.clientLeft}):t:{top:0,left:0}:void 0},position:function(){if(this[0]){var t,e,i=this[0],n={top:0,left:0};return"fixed"===S.css(i,"position")?e=i.getBoundingClientRect():(t=this.offsetParent(),e=this.offset(),n={top:(n=!S.nodeName(t[0],"html")?t.offset():n).top+S.css(t[0],"borderTopWidth",!0),left:n.left+S.css(t[0],"borderLeftWidth",!0)}),{top:e.top-n.top-S.css(i,"marginTop",!0),left:e.left-n.left-S.css(i,"marginLeft",!0)}}},offsetParent:function(){return this.map(function(){for(var t=this.offsetParent;t&&"static"===S.css(t,"position");)t=t.offsetParent;return t||ut})}}),S.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},function(e,r){var o="pageYOffset"===r;S.fn[e]=function(t){return j(this,function(t,e,i){var n=Fe(t);return void 0===i?n?n[r]:t[e]:void(n?n.scrollTo(o?n.pageXOffset:i,o?i:n.pageYOffset):t[e]=i)},e,t,arguments.length)}}),S.each(["top","left"],function(t,i){S.cssHooks[i]=jt(m.pixelPosition,function(t,e){if(e)return e=Nt(t,i),Rt.test(e)?S(t).position()[i]+"px":e})}),S.each({Height:"height",Width:"width"},function(s,a){S.each({padding:"inner"+s,content:a,"":"outer"+s},function(n,o){S.fn[o]=function(t,e){var i=arguments.length&&(n||"boolean"!=typeof t),r=n||(!0===t||!0===e?"margin":"border");return j(this,function(t,e,i){var n;return S.isWindow(t)?0===o.indexOf("outer")?t["inner"+s]:t.document.documentElement["client"+s]:9===t.nodeType?(n=t.documentElement,Math.max(t.body["scroll"+s],n["scroll"+s],t.body["offset"+s],n["offset"+s],n["client"+s])):void 0===i?S.css(t,e,r):S.style(t,e,i,r)},a,i?t:void 0,i)}})}),S.fn.extend({bind:function(t,e,i){return this.on(t,null,e,i)},unbind:function(t,e){return this.off(t,null,e)},delegate:function(t,e,i,n){return this.on(e,t,i,n)},undelegate:function(t,e,i){return 1===arguments.length?this.off(t,"**"):this.off(e,t||"**",i)}}),S.parseJSON=JSON.parse,"function"==typeof define&&define.amd&&define("jquery",[],function(){return S});var Ne=z.jQuery,je=z.$;return S.noConflict=function(t){return z.$===S&&(z.$=je),t&&z.jQuery===S&&(z.jQuery=Ne),S},t||(z.jQuery=z.$=S),S}),function(){var a;function Z(t,e){function i(){return i.method.apply(i.scope,arguments)}return i.scope=t,i.method=e,i}window.js=js={_Boot:{}},window.zpp_nape=zpp_nape={shape:{},constraint:{},geom:{},phys:{},dynamics:{},callbacks:{},util:{},space:{}},window.sandbox=sandbox={},window.nape=nape={shape:{},constraint:{},geom:{},phys:{},dynamics:{},callbacks:{},space:{},util:{}};var h=function(){};h.__name__=["Reflect"],h.field=function(t,e){try{return t[e]}catch(t){return null}},h.fields=function(t){var e=[];if(null!=t){var i,n=Object.prototype.hasOwnProperty;for(i in t)"__id__"!=i&&"hx__closures__"!=i&&n.call(t,i)&&e.push(i)}return e},h.copy=function(t){for(var e={},i=0,n=h.fields(t);i<n.length;){var r=n[i];++i,e[r]=h.field(t,r)}return e},h.prototype.__class__=h;var n=function(){};n.__name__=["Std"],n.string=function(t){return R.__string_rec(t,"")},n.prototype.__class__=n;var t=function(){};t.__name__=["StringTools"],t.hex=function(t,e){for(var i="";;)if(i="0123456789ABCDEF".charAt(15&t)+i,!(0<(t>>>=4)))break;if(null!=e)for(;i.length<e;)i="0"+i;return i},t.prototype.__class__=t;var r=js._Boot.HaxeError=function(t){Error.call(this),this.val=t,this.message=String(t),Error.captureStackTrace&&Error.captureStackTrace(this,r)};r.__name__=["js","_Boot","HaxeError"],r.__super__=Error,r.prototype=Object.create(Error.prototype),r.wrap=function(t){return t instanceof Error?t:new r(t)},r.prototype.val=null,r.prototype.__class__=r;var R=js.Boot=function(){};R.__name__=["js","Boot"],R.getClass=function(t){if(t instanceof Array&&null==t.__enum__)return Array;var e=t.__class__;if(null!=e)return e;t=R.__nativeClassName(t);return null!=t?R.__resolveNativeClass(t):null},R.__string_rec=function(t,e){if(null==t)return"null";if(5<=e.length)return"<...>";var i=typeof t;switch(i="function"==i&&(t.__name__||t.__ename__)?"object":i){case"function":return"<function>";case"object":if(t instanceof Array){if(t.__enum__){if(2==t.length)return t[0];var n=t[0]+"(";e+="\t";for(var r=2,o=t.length;r<o;){var s=r++;n+=2!=s?","+R.__string_rec(t[s],e):R.__string_rec(t[s],e)}return n+")"}var a="[";e+="\t";for(var h=0,l=t.length;h<l;){var p=h++;a+=(0<p?",":"")+R.__string_rec(t[p],e)}return a+="]"}try{u=t.toString}catch(t){return"???"}if(null!=u&&u!=Object.toString&&"function"==typeof u){var u=t.toString();if("[object Object]"!=u)return u}var d=null,c="{\n";e+="\t";var y=null!=t.hasOwnProperty;for(d in t)y&&!t.hasOwnProperty(d)||"prototype"!=d&&"__class__"!=d&&"__super__"!=d&&"__interfaces__"!=d&&"__properties__"!=d&&(2!=c.length&&(c+=", \n"),c+=e+d+" : "+R.__string_rec(t[d],e));return c+="\n"+(e=e.substring(1))+"}";case"string":return t;default:return String(t)}},R.__interfLoop=function(t,e){if(null==t)return!1;if(t==e)return!0;var i=t.__interfaces__;if(null!=i)for(var n=0,r=i.length;n<r;){var o=i[n++];if(o==e||R.__interfLoop(o,e))return!0}return R.__interfLoop(t.__super__,e)},R.__instanceof=function(t,e){if(null==e)return!1;switch(e){case Array:return t instanceof Array&&null==t.__enum__;case ur:return"boolean"==typeof t;case lr:return!0;case pr:return"number"==typeof t;case hr:return"number"==typeof t&&(0|t)===t;case String:return"string"==typeof t;default:if(null==t)return!1;if("function"==typeof e){if(t instanceof e)return!0;if(R.__interfLoop(R.getClass(t),e))return!0}else if("object"==typeof e&&R.__isNativeObj(e)&&t instanceof e)return!0;return e==dr&&null!=t.__name__?!0:e==cr&&null!=t.__ename__||t.__enum__==e}},R.__nativeClassName=function(t){t=R.__toStr.call(t).slice(8,-1);return"Object"==t||"Function"==t||"Math"==t||"JSON"==t?null:t},R.__isNativeObj=function(t){return null!=R.__nativeClassName(t)},R.__resolveNativeClass=function(t){return $global[t]},R.prototype.__class__=R;var Er=nape.Config=function(){};Er.__name__=["nape","Config"],Er.prototype.__class__=Er;var e=nape.callbacks.Callback=function(){this.zpp_inner=null};e.__name__=["nape","callbacks","Callback"],e.prototype.zpp_inner=null,e.prototype.get_event=function(){return At.events[this.zpp_inner.event]},e.prototype.get_listener=function(){return this.zpp_inner.listener.outer},e.prototype.toString=function(){return""},Object.defineProperty(e.prototype,"event",{get:e.prototype.get_event}),Object.defineProperty(e.prototype,"listener",{get:e.prototype.get_listener}),e.prototype.__class__=e;var i=nape.callbacks.BodyCallback=function(){e.call(this)};i.__name__=["nape","callbacks","BodyCallback"],i.__super__=e,(i.prototype=Object.create(e.prototype)).get_body=function(){return this.zpp_inner.body.outer},i.prototype.toString=function(){var t="Cb:"+["WAKE","SLEEP"][this.zpp_inner.event-2];return t+=":"+this.zpp_inner.body.outer.toString(),t+=" : listener: "+n.string(this.zpp_inner.listener.outer)},Object.defineProperty(i.prototype,"body",{get:i.prototype.get_body}),i.prototype.__class__=i;var l=nape.callbacks.Listener=function(){this.zpp_inner=null};l.__name__=["nape","callbacks","Listener"],l.prototype.zpp_inner=null,l.prototype.get_type=function(){return At.types[this.zpp_inner.type]},l.prototype.get_event=function(){return At.events[this.zpp_inner.event]},l.prototype.set_event=function(t){return At.events[this.zpp_inner.event]!=t&&(null==Yn.CbEvent_BEGIN&&(Yn.internal=!0,Yn.CbEvent_BEGIN=new p,Yn.internal=!1),t=t==Yn.CbEvent_BEGIN?0:(null==Yn.CbEvent_ONGOING&&(Yn.internal=!0,Yn.CbEvent_ONGOING=new p,Yn.internal=!1),t==Yn.CbEvent_ONGOING?6:(null==Yn.CbEvent_END&&(Yn.internal=!0,Yn.CbEvent_END=new p,Yn.internal=!1),t==Yn.CbEvent_END?1:(null==Yn.CbEvent_SLEEP&&(Yn.internal=!0,Yn.CbEvent_SLEEP=new p,Yn.internal=!1),t==Yn.CbEvent_SLEEP?3:(null==Yn.CbEvent_WAKE&&(Yn.internal=!0,Yn.CbEvent_WAKE=new p,Yn.internal=!1),t==Yn.CbEvent_WAKE?2:(null==Yn.CbEvent_PRE&&(Yn.internal=!0,Yn.CbEvent_PRE=new p,Yn.internal=!1),t==Yn.CbEvent_PRE?5:4))))),this.zpp_inner.swapEvent(t)),At.events[this.zpp_inner.event]},l.prototype.get_precedence=function(){return this.zpp_inner.precedence},l.prototype.set_precedence=function(t){return this.zpp_inner.precedence!=t&&(this.zpp_inner.precedence=t,this.zpp_inner.invalidate_precedence()),this.zpp_inner.precedence},l.prototype.get_space=function(){return null==this.zpp_inner.space?null:this.zpp_inner.space.outer},l.prototype.set_space=function(t){return(null==this.zpp_inner.space?null:this.zpp_inner.space.outer)!=t&&(null!=this.zpp_inner.space&&this.zpp_inner.space.outer.zpp_inner.wrap_listeners.remove(this),null!=t?(t=t.zpp_inner.wrap_listeners).zpp_inner.reverse_flag?t.push(this):t.unshift(this):this.zpp_inner.space=null),null==this.zpp_inner.space?null:this.zpp_inner.space.outer},l.prototype.toString=function(){var t=["BEGIN","END","WAKE","SLEEP","BREAK","PRE","ONGOING"][this.zpp_inner.event];if(0==this.zpp_inner.type)return"BodyListener{"+t+"::"+n.string(this.zpp_inner.body.outer_zn.zpp_inner_zn.options.outer)+"}";if(1==this.zpp_inner.type)return"ConstraintListener{"+t+"::"+n.string(this.zpp_inner.constraint.outer_zn.zpp_inner_zn.options.outer)+"}";var e,i=this.zpp_inner.interaction;switch(i.itype){case 1:e="COLLISION";break;case 2:e="SENSOR";break;case 4:e="FLUID";break;default:e="ALL"}return(2==this.zpp_inner.type?"InteractionListener{"+t+"#"+e+"::"+n.string(i.outer_zni.zpp_inner_zn.options1.outer)+":"+n.string(i.outer_zni.zpp_inner_zn.options2.outer)+"}":"PreListener{"+e+"::"+n.string(i.outer_znp.zpp_inner_zn.options1.outer)+":"+n.string(i.outer_znp.zpp_inner_zn.options2.outer)+"}")+" precedence="+this.zpp_inner.precedence},Object.defineProperty(l.prototype,"type",{get:l.prototype.get_type}),Object.defineProperty(l.prototype,"event",{get:l.prototype.get_event,set:l.prototype.set_event}),Object.defineProperty(l.prototype,"precedence",{get:l.prototype.get_precedence,set:l.prototype.set_precedence}),Object.defineProperty(l.prototype,"space",{get:l.prototype.get_space,set:l.prototype.set_space}),l.prototype.__class__=l;var o=nape.callbacks.BodyListener=function(t,e,i,n){null==n&&(n=0),this.zpp_inner_zn=null,l.call(this);var r=-1;null==Yn.CbEvent_WAKE&&(Yn.internal=!0,Yn.CbEvent_WAKE=new p,Yn.internal=!1),t==Yn.CbEvent_WAKE?r=2:(null==Yn.CbEvent_SLEEP&&(Yn.internal=!0,Yn.CbEvent_SLEEP=new p,Yn.internal=!1),t==Yn.CbEvent_SLEEP&&(r=3)),this.zpp_inner_zn=new kt(It.argument(e),r,i),this.zpp_inner=this.zpp_inner_zn,((this.zpp_inner.outer=this).zpp_inner_zn.outer_zn=this).zpp_inner.precedence=n};o.__name__=["nape","callbacks","BodyListener"],o.__super__=l,(o.prototype=Object.create(l.prototype)).zpp_inner_zn=null,o.prototype.get_options=function(){return this.zpp_inner_zn.options.outer},o.prototype.set_options=function(t){return this.zpp_inner_zn.options.set(t.zpp_inner),this.zpp_inner_zn.options.outer},o.prototype.get_handler=function(){return this.zpp_inner_zn.handler},o.prototype.set_handler=function(t){return this.zpp_inner_zn.handler=t,this.zpp_inner_zn.handler},Object.defineProperty(o.prototype,"options",{get:o.prototype.get_options,set:o.prototype.set_options}),Object.defineProperty(o.prototype,"handler",{get:o.prototype.get_handler,set:o.prototype.set_handler}),o.prototype.__class__=o;var p=nape.callbacks.CbEvent=function(){};p.__name__=["nape","callbacks","CbEvent"],p.BEGIN=null,p.get_BEGIN=function(){return null==Yn.CbEvent_BEGIN&&(Yn.internal=!0,Yn.CbEvent_BEGIN=new p,Yn.internal=!1),Yn.CbEvent_BEGIN},p.ONGOING=null,p.get_ONGOING=function(){return null==Yn.CbEvent_ONGOING&&(Yn.internal=!0,Yn.CbEvent_ONGOING=new p,Yn.internal=!1),Yn.CbEvent_ONGOING},p.END=null,p.get_END=function(){return null==Yn.CbEvent_END&&(Yn.internal=!0,Yn.CbEvent_END=new p,Yn.internal=!1),Yn.CbEvent_END},p.WAKE=null,p.get_WAKE=function(){return null==Yn.CbEvent_WAKE&&(Yn.internal=!0,Yn.CbEvent_WAKE=new p,Yn.internal=!1),Yn.CbEvent_WAKE},p.SLEEP=null,p.get_SLEEP=function(){return null==Yn.CbEvent_SLEEP&&(Yn.internal=!0,Yn.CbEvent_SLEEP=new p,Yn.internal=!1),Yn.CbEvent_SLEEP},p.BREAK=null,p.get_BREAK=function(){return null==Yn.CbEvent_BREAK&&(Yn.internal=!0,Yn.CbEvent_BREAK=new p,Yn.internal=!1),Yn.CbEvent_BREAK},p.PRE=null,p.get_PRE=function(){return null==Yn.CbEvent_PRE&&(Yn.internal=!0,Yn.CbEvent_PRE=new p,Yn.internal=!1),Yn.CbEvent_PRE},p.prototype.toString=function(){return null==Yn.CbEvent_PRE&&(Yn.internal=!0,Yn.CbEvent_PRE=new p,Yn.internal=!1),this==Yn.CbEvent_PRE?"PRE":(null==Yn.CbEvent_BEGIN&&(Yn.internal=!0,Yn.CbEvent_BEGIN=new p,Yn.internal=!1),this==Yn.CbEvent_BEGIN?"BEGIN":(null==Yn.CbEvent_ONGOING&&(Yn.internal=!0,Yn.CbEvent_ONGOING=new p,Yn.internal=!1),this==Yn.CbEvent_ONGOING?"ONGOING":(null==Yn.CbEvent_END&&(Yn.internal=!0,Yn.CbEvent_END=new p,Yn.internal=!1),this==Yn.CbEvent_END?"END":(null==Yn.CbEvent_WAKE&&(Yn.internal=!0,Yn.CbEvent_WAKE=new p,Yn.internal=!1),this==Yn.CbEvent_WAKE?"WAKE":(null==Yn.CbEvent_SLEEP&&(Yn.internal=!0,Yn.CbEvent_SLEEP=new p,Yn.internal=!1),this==Yn.CbEvent_SLEEP?"SLEEP":(null==Yn.CbEvent_BREAK&&(Yn.internal=!0,Yn.CbEvent_BREAK=new p,Yn.internal=!1),this==Yn.CbEvent_BREAK?"BREAK":""))))))},Object.defineProperty(p,"BEGIN",{get:p.get_BEGIN}),Object.defineProperty(p,"ONGOING",{get:p.get_ONGOING}),Object.defineProperty(p,"END",{get:p.get_END}),Object.defineProperty(p,"WAKE",{get:p.get_WAKE}),Object.defineProperty(p,"SLEEP",{get:p.get_SLEEP}),Object.defineProperty(p,"BREAK",{get:p.get_BREAK}),Object.defineProperty(p,"PRE",{get:p.get_PRE}),p.prototype.__class__=p;var u=nape.callbacks.CbType=function(){this.zpp_inner=null,this.zpp_inner=new Tt,this.zpp_inner.outer=this};u.__name__=["nape","callbacks","CbType"],u.ANY_BODY=null,u.get_ANY_BODY=function(){return Tt.ANY_BODY},u.ANY_CONSTRAINT=null,u.get_ANY_CONSTRAINT=function(){return Tt.ANY_CONSTRAINT},u.ANY_SHAPE=null,u.get_ANY_SHAPE=function(){return Tt.ANY_SHAPE},u.ANY_COMPOUND=null,u.get_ANY_COMPOUND=function(){return Tt.ANY_COMPOUND},u.prototype.zpp_inner=null,u.prototype.get_id=function(){return this.zpp_inner.id},u.prototype.including=function(t){return new x(this).including(t)},u.prototype.excluding=function(t){return new x(this).excluding(t)},u.prototype.get_userData=function(){return null==this.zpp_inner.userData&&(this.zpp_inner.userData={}),this.zpp_inner.userData},u.prototype.get_interactors=function(){return null==this.zpp_inner.wrap_interactors&&(this.zpp_inner.wrap_interactors=Sn.get(this.zpp_inner.interactors,!0)),this.zpp_inner.wrap_interactors},u.prototype.get_constraints=function(){return null==this.zpp_inner.wrap_constraints&&(this.zpp_inner.wrap_constraints=zn.get(this.zpp_inner.constraints,!0)),this.zpp_inner.wrap_constraints},u.prototype.toString=function(){return this==Tt.ANY_BODY?"ANY_BODY":this==Tt.ANY_SHAPE?"ANY_SHAPE":this==Tt.ANY_COMPOUND?"ANY_COMPOUND":this==Tt.ANY_CONSTRAINT?"ANY_CONSTRAINT":"CbType#"+this.zpp_inner.id},Object.defineProperty(u,"ANY_BODY",{get:u.get_ANY_BODY}),Object.defineProperty(u,"ANY_CONSTRAINT",{get:u.get_ANY_CONSTRAINT}),Object.defineProperty(u,"ANY_SHAPE",{get:u.get_ANY_SHAPE}),Object.defineProperty(u,"ANY_COMPOUND",{get:u.get_ANY_COMPOUND}),Object.defineProperty(u.prototype,"id",{get:u.prototype.get_id}),Object.defineProperty(u.prototype,"userData",{get:u.prototype.get_userData}),Object.defineProperty(u.prototype,"interactors",{get:u.prototype.get_interactors}),Object.defineProperty(u.prototype,"constraints",{get:u.prototype.get_constraints}),u.prototype.__class__=u;var Vt=nape.callbacks.CbTypeIterator=function(){this.zpp_next=null,this.zpp_critical=!1,this.zpp_i=0,this.zpp_inner=null};Vt.__name__=["nape","callbacks","CbTypeIterator"],Vt.get=function(t){var e,i=null==Vt.zpp_pool?(Mn.internal=!0,e=new Vt,Mn.internal=!1,e):(Vt.zpp_pool=(i=Vt.zpp_pool).zpp_next,i);return i.zpp_i=0,i.zpp_inner=t,i.zpp_critical=!1,i},Vt.prototype.zpp_inner=null,Vt.prototype.zpp_i=null,Vt.prototype.zpp_critical=null,Vt.prototype.zpp_next=null,Vt.prototype.hasNext=function(){this.zpp_inner.zpp_inner.valmod();var t=this.zpp_inner;t.zpp_inner.valmod(),t.zpp_inner.zip_length&&(t.zpp_inner.zip_length=!1,t.zpp_inner.user_length=t.zpp_inner.inner.length);t=t.zpp_inner.user_length;return this.zpp_critical=!0,this.zpp_i<t||(this.zpp_next=Vt.zpp_pool,(Vt.zpp_pool=this).zpp_inner=null,!1)},Vt.prototype.next=function(){return this.zpp_critical=!1,this.zpp_inner.at(this.zpp_i++)},Vt.prototype.__class__=Vt;var d=nape.callbacks.CbTypeList=function(){this.zpp_inner=null,this.zpp_inner=new Mn,this.zpp_inner.outer=this};d.__name__=["nape","callbacks","CbTypeList"],d.fromArray=function(t){for(var e=new d,i=0;i<t.length;){var n=t[i];++i,e.push(n)}return e},d.prototype.zpp_inner=null,d.prototype.get_length=function(){return this.zpp_inner.valmod(),this.zpp_inner.zip_length&&(this.zpp_inner.zip_length=!1,this.zpp_inner.user_length=this.zpp_inner.inner.length),this.zpp_inner.user_length},d.prototype.has=function(t){return this.zpp_inner.valmod(),this.zpp_inner.inner.has(t.zpp_inner)},d.prototype.at=function(t){if(this.zpp_inner.valmod(),this.zpp_inner.reverse_flag&&(this.zpp_inner.valmod(),this.zpp_inner.zip_length&&(this.zpp_inner.zip_length=!1,this.zpp_inner.user_length=this.zpp_inner.inner.length),t=this.zpp_inner.user_length-1-t),t<this.zpp_inner.at_index||null==this.zpp_inner.at_ite)this.zpp_inner.at_index=t,this.zpp_inner.at_ite=this.zpp_inner.inner.iterator_at(t);else for(;this.zpp_inner.at_index!=t;)this.zpp_inner.at_index++,this.zpp_inner.at_ite=this.zpp_inner.at_ite.next;return this.zpp_inner.at_ite.elt.outer},d.prototype.push=function(t){this.zpp_inner.modify_test(),this.zpp_inner.valmod();var e,i=null==this.zpp_inner.adder||this.zpp_inner.adder(t);return i&&(this.zpp_inner.reverse_flag?this.zpp_inner.inner.add(t.zpp_inner):(null==this.zpp_inner.push_ite&&(e=null==this.zpp_inner.inner.head?null:(this.zpp_inner.valmod(),this.zpp_inner.zip_length&&(this.zpp_inner.zip_length=!1,this.zpp_inner.user_length=this.zpp_inner.inner.length),this.zpp_inner.inner.iterator_at(this.zpp_inner.user_length-1)),this.zpp_inner.push_ite=e),this.zpp_inner.push_ite=this.zpp_inner.inner.insert(this.zpp_inner.push_ite,t.zpp_inner)),this.zpp_inner.invalidate(),null!=this.zpp_inner.post_adder&&this.zpp_inner.post_adder(t)),i},d.prototype.unshift=function(t){this.zpp_inner.modify_test(),this.zpp_inner.valmod();var e,i=null==this.zpp_inner.adder||this.zpp_inner.adder(t);return i&&(this.zpp_inner.reverse_flag?(null==this.zpp_inner.push_ite&&(e=null==this.zpp_inner.inner.head?null:(this.zpp_inner.valmod(),this.zpp_inner.zip_length&&(this.zpp_inner.zip_length=!1,this.zpp_inner.user_length=this.zpp_inner.inner.length),this.zpp_inner.inner.iterator_at(this.zpp_inner.user_length-1)),this.zpp_inner.push_ite=e),this.zpp_inner.push_ite=this.zpp_inner.inner.insert(this.zpp_inner.push_ite,t.zpp_inner)):this.zpp_inner.inner.add(t.zpp_inner),this.zpp_inner.invalidate(),null!=this.zpp_inner.post_adder&&this.zpp_inner.post_adder(t)),i},d.prototype.pop=function(){this.zpp_inner.modify_test(),this.zpp_inner.valmod();var t,e,i=null;return this.zpp_inner.reverse_flag?(e=(i=this.zpp_inner.inner.head.elt).outer,null!=this.zpp_inner.subber&&this.zpp_inner.subber(e),this.zpp_inner.dontremove||this.zpp_inner.inner.pop()):(null!=this.zpp_inner.at_ite&&null==this.zpp_inner.at_ite.next&&(this.zpp_inner.at_ite=null),this.zpp_inner.valmod(),this.zpp_inner.zip_length&&(this.zpp_inner.zip_length=!1,this.zpp_inner.user_length=this.zpp_inner.inner.length),e=(i=(null==(t=1==this.zpp_inner.user_length?null:(this.zpp_inner.valmod(),this.zpp_inner.zip_length&&(this.zpp_inner.zip_length=!1,this.zpp_inner.user_length=this.zpp_inner.inner.length),this.zpp_inner.inner.iterator_at(this.zpp_inner.user_length-2)))?this.zpp_inner.inner.head:t.next).elt).outer,null!=this.zpp_inner.subber&&this.zpp_inner.subber(e),this.zpp_inner.dontremove||this.zpp_inner.inner.erase(t)),this.zpp_inner.invalidate(),i.outer},d.prototype.shift=function(){this.zpp_inner.modify_test(),this.zpp_inner.valmod();var t,e,i=null;return this.zpp_inner.reverse_flag?(null!=this.zpp_inner.at_ite&&null==this.zpp_inner.at_ite.next&&(this.zpp_inner.at_ite=null),this.zpp_inner.valmod(),this.zpp_inner.zip_length&&(this.zpp_inner.zip_length=!1,this.zpp_inner.user_length=this.zpp_inner.inner.length),t=(i=(null==(e=1==this.zpp_inner.user_length?null:(this.zpp_inner.valmod(),this.zpp_inner.zip_length&&(this.zpp_inner.zip_length=!1,this.zpp_inner.user_length=this.zpp_inner.inner.length),this.zpp_inner.inner.iterator_at(this.zpp_inner.user_length-2)))?this.zpp_inner.inner.head:e.next).elt).outer,null!=this.zpp_inner.subber&&this.zpp_inner.subber(t),this.zpp_inner.dontremove||this.zpp_inner.inner.erase(e)):(e=(i=this.zpp_inner.inner.head.elt).outer,null!=this.zpp_inner.subber&&this.zpp_inner.subber(e),this.zpp_inner.dontremove||this.zpp_inner.inner.pop()),this.zpp_inner.invalidate(),i.outer},d.prototype.add=function(t){return this.zpp_inner.reverse_flag?this.push(t):this.unshift(t)},d.prototype.remove=function(t){this.zpp_inner.modify_test(),this.zpp_inner.valmod();for(var e=!1,i=this.zpp_inner.inner.head;null!=i;){if(i.elt==t.zpp_inner){e=!0;break}i=i.next}return e&&(null!=this.zpp_inner.subber&&this.zpp_inner.subber(t),this.zpp_inner.dontremove||this.zpp_inner.inner.remove(t.zpp_inner),this.zpp_inner.invalidate()),e},d.prototype.clear=function(){if(this.zpp_inner.reverse_flag)for(;null!=this.zpp_inner.inner.head;)this.pop();else for(;null!=this.zpp_inner.inner.head;)this.shift()},d.prototype.empty=function(){return null==this.zpp_inner.inner.head},d.prototype.iterator=function(){return this.zpp_inner.valmod(),Vt.get(this)},d.prototype.copy=function(t){null==t&&(t=!1);var e=new d;this.zpp_inner.valmod();for(var i=Vt.get(this);;){i.zpp_inner.zpp_inner.valmod();var n=i.zpp_inner;n.zpp_inner.valmod(),n.zpp_inner.zip_length&&(n.zpp_inner.zip_length=!1,n.zpp_inner.user_length=n.zpp_inner.inner.length);n=n.zpp_inner.user_length;if(i.zpp_critical=!0,!(i.zpp_i<n||(i.zpp_next=Vt.zpp_pool,(Vt.zpp_pool=i).zpp_inner=null,!1)))break;i.zpp_critical=!1;n=i.zpp_inner.at(i.zpp_i++);e.push(t?null:n)}return e},d.prototype.merge=function(t){t.zpp_inner.valmod();for(var e=Vt.get(t);;){e.zpp_inner.zpp_inner.valmod();var i=e.zpp_inner;i.zpp_inner.valmod(),i.zpp_inner.zip_length&&(i.zpp_inner.zip_length=!1,i.zpp_inner.user_length=i.zpp_inner.inner.length);i=i.zpp_inner.user_length;if(e.zpp_critical=!0,!(e.zpp_i<i||(e.zpp_next=Vt.zpp_pool,(Vt.zpp_pool=e).zpp_inner=null,!1)))break;e.zpp_critical=!1;i=e.zpp_inner.at(e.zpp_i++);this.has(i)||(this.zpp_inner.reverse_flag?this.push(i):this.unshift(i))}},d.prototype.toString=function(){var t="[",e=!0;this.zpp_inner.valmod();for(var i=Vt.get(this);;){i.zpp_inner.zpp_inner.valmod();var n=i.zpp_inner;n.zpp_inner.valmod(),n.zpp_inner.zip_length&&(n.zpp_inner.zip_length=!1,n.zpp_inner.user_length=n.zpp_inner.inner.length);n=n.zpp_inner.user_length;if(i.zpp_critical=!0,!(i.zpp_i<n||(i.zpp_next=Vt.zpp_pool,(Vt.zpp_pool=i).zpp_inner=null,!1)))break;i.zpp_critical=!1;n=i.zpp_inner.at(i.zpp_i++);e||(t+=","),t+=null==n?"NULL":n.toString(),e=!1}return t+"]"},d.prototype.foreach=function(t){this.zpp_inner.valmod();for(var e=Vt.get(this);;){e.zpp_inner.zpp_inner.valmod();var i=e.zpp_inner;i.zpp_inner.valmod(),i.zpp_inner.zip_length&&(i.zpp_inner.zip_length=!1,i.zpp_inner.user_length=i.zpp_inner.inner.length);i=i.zpp_inner.user_length;if(e.zpp_critical=!0,!(e.zpp_i<i||(e.zpp_next=Vt.zpp_pool,(Vt.zpp_pool=e).zpp_inner=null,!1)))break;try{e.zpp_critical=!1,t(e.zpp_inner.at(e.zpp_i++))}catch(t){e.zpp_next=Vt.zpp_pool,(Vt.zpp_pool=e).zpp_inner=null;break}}return this},d.prototype.filter=function(t){for(var e=0;;){if(this.zpp_inner.valmod(),this.zpp_inner.zip_length&&(this.zpp_inner.zip_length=!1,this.zpp_inner.user_length=this.zpp_inner.inner.length),!(e<this.zpp_inner.user_length))break;var i=this.at(e);try{t(i)?++e:this.remove(i)}catch(t){break}}return this},Object.defineProperty(d.prototype,"length",{get:d.prototype.get_length}),d.prototype.__class__=d;var s=nape.callbacks.ConstraintCallback=function(){e.call(this)};s.__name__=["nape","callbacks","ConstraintCallback"],s.__super__=e,(s.prototype=Object.create(e.prototype)).get_constraint=function(){return this.zpp_inner.constraint.outer},s.prototype.toString=function(){var t="Cb:"+["WAKE","SLEEP","BREAK"][this.zpp_inner.event-2];return t+=":"+this.zpp_inner.constraint.outer.toString(),t+=" : listener: "+n.string(this.zpp_inner.listener.outer)},Object.defineProperty(s.prototype,"constraint",{get:s.prototype.get_constraint}),s.prototype.__class__=s;var c=nape.callbacks.ConstraintListener=function(t,e,i,n){null==n&&(n=0),this.zpp_inner_zn=null,l.call(this);var r=-1;null==Yn.CbEvent_WAKE&&(Yn.internal=!0,Yn.CbEvent_WAKE=new p,Yn.internal=!1),t==Yn.CbEvent_WAKE?r=2:(null==Yn.CbEvent_SLEEP&&(Yn.internal=!0,Yn.CbEvent_SLEEP=new p,Yn.internal=!1),t==Yn.CbEvent_SLEEP?r=3:(null==Yn.CbEvent_BREAK&&(Yn.internal=!0,Yn.CbEvent_BREAK=new p,Yn.internal=!1),t==Yn.CbEvent_BREAK&&(r=4))),this.zpp_inner_zn=new Ot(It.argument(e),r,i),this.zpp_inner=this.zpp_inner_zn,((this.zpp_inner.outer=this).zpp_inner_zn.outer_zn=this).zpp_inner.precedence=n};c.__name__=["nape","callbacks","ConstraintListener"],c.__super__=l,(c.prototype=Object.create(l.prototype)).zpp_inner_zn=null,c.prototype.get_options=function(){return this.zpp_inner_zn.options.outer},c.prototype.set_options=function(t){return this.zpp_inner_zn.options.set(t.zpp_inner),this.zpp_inner_zn.options.outer},c.prototype.get_handler=function(){return this.zpp_inner_zn.handler},c.prototype.set_handler=function(t){return this.zpp_inner_zn.handler=t,this.zpp_inner_zn.handler},Object.defineProperty(c.prototype,"options",{get:c.prototype.get_options,set:c.prototype.set_options}),Object.defineProperty(c.prototype,"handler",{get:c.prototype.get_handler,set:c.prototype.set_handler}),c.prototype.__class__=c;var y=nape.callbacks.InteractionCallback=function(){e.call(this)};y.__name__=["nape","callbacks","InteractionCallback"],y.__super__=e,(y.prototype=Object.create(e.prototype)).get_int1=function(){return this.zpp_inner.int1.outer_i},y.prototype.get_int2=function(){return this.zpp_inner.int2.outer_i},y.prototype.get_arbiters=function(){return this.zpp_inner.wrap_arbiters},y.prototype.toString=function(){var t="Cb:"+["BEGIN","END","","","","","ONGOING"][this.zpp_inner.event];return t+=":"+this.zpp_inner.int1.outer_i.toString()+"/"+this.zpp_inner.int2.outer_i.toString(),t+=" : "+this.zpp_inner.wrap_arbiters.toString(),t+=" : listener: "+n.string(this.zpp_inner.listener.outer)},Object.defineProperty(y.prototype,"int1",{get:y.prototype.get_int1}),Object.defineProperty(y.prototype,"int2",{get:y.prototype.get_int2}),Object.defineProperty(y.prototype,"arbiters",{get:y.prototype.get_arbiters}),y.prototype.__class__=y;var _=nape.callbacks.InteractionListener=function(t,e,i,n,r,o){null==o&&(o=0),this.zpp_inner_zn=null,l.call(this);var s=-1;null==Yn.CbEvent_BEGIN&&(Yn.internal=!0,Yn.CbEvent_BEGIN=new p,Yn.internal=!1),t==Yn.CbEvent_BEGIN?s=0:(null==Yn.CbEvent_END&&(Yn.internal=!0,Yn.CbEvent_END=new p,Yn.internal=!1),t==Yn.CbEvent_END?s=1:(null==Yn.CbEvent_ONGOING&&(Yn.internal=!0,Yn.CbEvent_ONGOING=new p,Yn.internal=!1),t==Yn.CbEvent_ONGOING&&(s=6))),this.zpp_inner_zn=new Be(It.argument(i),It.argument(n),s,2),this.zpp_inner=this.zpp_inner_zn,((this.zpp_inner.outer=this).zpp_inner_zn.outer_zni=this).zpp_inner.precedence=o,this.zpp_inner_zn.handleri=r;var r=this.zpp_inner_zn.itype,r=1==r?(null==Yn.InteractionType_COLLISION&&(Yn.internal=!0,Yn.InteractionType_COLLISION=new m,Yn.internal=!1),Yn.InteractionType_COLLISION):2==r?(null==Yn.InteractionType_SENSOR&&(Yn.internal=!0,Yn.InteractionType_SENSOR=new m,Yn.internal=!1),Yn.InteractionType_SENSOR):4==r?(null==Yn.InteractionType_FLUID&&(Yn.internal=!0,Yn.InteractionType_FLUID=new m,Yn.internal=!1),Yn.InteractionType_FLUID):7==r?(null==Yn.InteractionType_ANY&&(Yn.internal=!0,Yn.InteractionType_ANY=new m,Yn.internal=!1),Yn.InteractionType_ANY):null;r!=e&&(null==Yn.InteractionType_COLLISION&&(Yn.internal=!0,Yn.InteractionType_COLLISION=new m,Yn.internal=!1),a=e==Yn.InteractionType_COLLISION?1:(null==Yn.InteractionType_SENSOR&&(Yn.internal=!0,Yn.InteractionType_SENSOR=new m,Yn.internal=!1),e==Yn.InteractionType_SENSOR?2:(null==Yn.InteractionType_FLUID&&(Yn.internal=!0,Yn.InteractionType_FLUID=new m,Yn.internal=!1),e==Yn.InteractionType_FLUID?4:7)),this.zpp_inner_zn.itype=a);var a=this.zpp_inner_zn.itype;1==a?null==Yn.InteractionType_COLLISION&&(Yn.internal=!0,Yn.InteractionType_COLLISION=new m,Yn.internal=!1):2==a?null==Yn.InteractionType_SENSOR&&(Yn.internal=!0,Yn.InteractionType_SENSOR=new m,Yn.internal=!1):4==a?null==Yn.InteractionType_FLUID&&(Yn.internal=!0,Yn.InteractionType_FLUID=new m,Yn.internal=!1):7==a&&null==Yn.InteractionType_ANY&&(Yn.internal=!0,Yn.InteractionType_ANY=new m,Yn.internal=!1)};_.__name__=["nape","callbacks","InteractionListener"],_.__super__=l,(_.prototype=Object.create(l.prototype)).zpp_inner_zn=null,_.prototype.get_options1=function(){return this.zpp_inner_zn.options1.outer},_.prototype.set_options1=function(t){return this.zpp_inner_zn.options1.set(t.zpp_inner),this.zpp_inner_zn.options1.outer},_.prototype.get_options2=function(){return this.zpp_inner_zn.options2.outer},_.prototype.set_options2=function(t){return this.zpp_inner_zn.options2.set(t.zpp_inner),this.zpp_inner_zn.options2.outer},_.prototype.get_interactionType=function(){var t=this.zpp_inner_zn.itype;return 1==t?(null==Yn.InteractionType_COLLISION&&(Yn.internal=!0,Yn.InteractionType_COLLISION=new m,Yn.internal=!1),Yn.InteractionType_COLLISION):2==t?(null==Yn.InteractionType_SENSOR&&(Yn.internal=!0,Yn.InteractionType_SENSOR=new m,Yn.internal=!1),Yn.InteractionType_SENSOR):4==t?(null==Yn.InteractionType_FLUID&&(Yn.internal=!0,Yn.InteractionType_FLUID=new m,Yn.internal=!1),Yn.InteractionType_FLUID):7==t?(null==Yn.InteractionType_ANY&&(Yn.internal=!0,Yn.InteractionType_ANY=new m,Yn.internal=!1),Yn.InteractionType_ANY):null},_.prototype.set_interactionType=function(t){var e=this.zpp_inner_zn.itype,e=1==e?(null==Yn.InteractionType_COLLISION&&(Yn.internal=!0,Yn.InteractionType_COLLISION=new m,Yn.internal=!1),Yn.InteractionType_COLLISION):2==e?(null==Yn.InteractionType_SENSOR&&(Yn.internal=!0,Yn.InteractionType_SENSOR=new m,Yn.internal=!1),Yn.InteractionType_SENSOR):4==e?(null==Yn.InteractionType_FLUID&&(Yn.internal=!0,Yn.InteractionType_FLUID=new m,Yn.internal=!1),Yn.InteractionType_FLUID):7==e?(null==Yn.InteractionType_ANY&&(Yn.internal=!0,Yn.InteractionType_ANY=new m,Yn.internal=!1),Yn.InteractionType_ANY):null;e!=t&&(null==Yn.InteractionType_COLLISION&&(Yn.internal=!0,Yn.InteractionType_COLLISION=new m,Yn.internal=!1),i=t==Yn.InteractionType_COLLISION?1:(null==Yn.InteractionType_SENSOR&&(Yn.internal=!0,Yn.InteractionType_SENSOR=new m,Yn.internal=!1),t==Yn.InteractionType_SENSOR?2:(null==Yn.InteractionType_FLUID&&(Yn.internal=!0,Yn.InteractionType_FLUID=new m,Yn.internal=!1),t==Yn.InteractionType_FLUID?4:7)),this.zpp_inner_zn.itype=i);var i=this.zpp_inner_zn.itype;return 1==i?(null==Yn.InteractionType_COLLISION&&(Yn.internal=!0,Yn.InteractionType_COLLISION=new m,Yn.internal=!1),Yn.InteractionType_COLLISION):2==i?(null==Yn.InteractionType_SENSOR&&(Yn.internal=!0,Yn.InteractionType_SENSOR=new m,Yn.internal=!1),Yn.InteractionType_SENSOR):4==i?(null==Yn.InteractionType_FLUID&&(Yn.internal=!0,Yn.InteractionType_FLUID=new m,Yn.internal=!1),Yn.InteractionType_FLUID):7==i?(null==Yn.InteractionType_ANY&&(Yn.internal=!0,Yn.InteractionType_ANY=new m,Yn.internal=!1),Yn.InteractionType_ANY):null},_.prototype.get_handler=function(){return this.zpp_inner_zn.handleri},_.prototype.set_handler=function(t){return this.zpp_inner_zn.handleri=t,this.zpp_inner_zn.handleri},_.prototype.get_allowSleepingCallbacks=function(){return this.zpp_inner_zn.allowSleepingCallbacks},_.prototype.set_allowSleepingCallbacks=function(t){return this.zpp_inner_zn.allowSleepingCallbacks=t,this.zpp_inner_zn.allowSleepingCallbacks},Object.defineProperty(_.prototype,"options1",{get:_.prototype.get_options1,set:_.prototype.set_options1}),Object.defineProperty(_.prototype,"options2",{get:_.prototype.get_options2,set:_.prototype.set_options2}),Object.defineProperty(_.prototype,"interactionType",{get:_.prototype.get_interactionType,set:_.prototype.set_interactionType}),Object.defineProperty(_.prototype,"handler",{get:_.prototype.get_handler,set:_.prototype.set_handler}),Object.defineProperty(_.prototype,"allowSleepingCallbacks",{get:_.prototype.get_allowSleepingCallbacks,set:_.prototype.set_allowSleepingCallbacks}),_.prototype.__class__=_;var m=nape.callbacks.InteractionType=function(){};m.__name__=["nape","callbacks","InteractionType"],m.COLLISION=null,m.get_COLLISION=function(){return null==Yn.InteractionType_COLLISION&&(Yn.internal=!0,Yn.InteractionType_COLLISION=new m,Yn.internal=!1),Yn.InteractionType_COLLISION},m.SENSOR=null,m.get_SENSOR=function(){return null==Yn.InteractionType_SENSOR&&(Yn.internal=!0,Yn.InteractionType_SENSOR=new m,Yn.internal=!1),Yn.InteractionType_SENSOR},m.FLUID=null,m.get_FLUID=function(){return null==Yn.InteractionType_FLUID&&(Yn.internal=!0,Yn.InteractionType_FLUID=new m,Yn.internal=!1),Yn.InteractionType_FLUID},m.ANY=null,m.get_ANY=function(){return null==Yn.InteractionType_ANY&&(Yn.internal=!0,Yn.InteractionType_ANY=new m,Yn.internal=!1),Yn.InteractionType_ANY},m.prototype.toString=function(){return null==Yn.InteractionType_COLLISION&&(Yn.internal=!0,Yn.InteractionType_COLLISION=new m,Yn.internal=!1),this==Yn.InteractionType_COLLISION?"COLLISION":(null==Yn.InteractionType_SENSOR&&(Yn.internal=!0,Yn.InteractionType_SENSOR=new m,Yn.internal=!1),this==Yn.InteractionType_SENSOR?"SENSOR":(null==Yn.InteractionType_FLUID&&(Yn.internal=!0,Yn.InteractionType_FLUID=new m,Yn.internal=!1),this==Yn.InteractionType_FLUID?"FLUID":(null==Yn.InteractionType_ANY&&(Yn.internal=!0,Yn.InteractionType_ANY=new m,Yn.internal=!1),this==Yn.InteractionType_ANY?"ANY":"")))},Object.defineProperty(m,"COLLISION",{get:m.get_COLLISION}),Object.defineProperty(m,"SENSOR",{get:m.get_SENSOR}),Object.defineProperty(m,"FLUID",{get:m.get_FLUID}),Object.defineProperty(m,"ANY",{get:m.get_ANY}),m.prototype.__class__=m;var Wt=nape.callbacks.ListenerIterator=function(){this.zpp_next=null,this.zpp_critical=!1,this.zpp_i=0,this.zpp_inner=null};Wt.__name__=["nape","callbacks","ListenerIterator"],Wt.get=function(t){var e,i=null==Wt.zpp_pool?(Pn.internal=!0,e=new Wt,Pn.internal=!1,e):(Wt.zpp_pool=(i=Wt.zpp_pool).zpp_next,i);return i.zpp_i=0,i.zpp_inner=t,i.zpp_critical=!1,i},Wt.prototype.zpp_inner=null,Wt.prototype.zpp_i=null,Wt.prototype.zpp_critical=null,Wt.prototype.zpp_next=null,Wt.prototype.hasNext=function(){this.zpp_inner.zpp_inner.valmod();var t=this.zpp_inner;t.zpp_inner.valmod(),t.zpp_inner.zip_length&&(t.zpp_inner.zip_length=!1,t.zpp_inner.user_length=t.zpp_inner.inner.length);t=t.zpp_inner.user_length;return this.zpp_critical=!0,this.zpp_i<t||(this.zpp_next=Wt.zpp_pool,(Wt.zpp_pool=this).zpp_inner=null,!1)},Wt.prototype.next=function(){return this.zpp_critical=!1,this.zpp_inner.at(this.zpp_i++)},Wt.prototype.__class__=Wt;var g=nape.callbacks.ListenerList=function(){this.zpp_inner=null,this.zpp_inner=new Pn,this.zpp_inner.outer=this};g.__name__=["nape","callbacks","ListenerList"],g.fromArray=function(t){for(var e=new g,i=0;i<t.length;){var n=t[i];++i,e.push(n)}return e},g.prototype.zpp_inner=null,g.prototype.get_length=function(){return this.zpp_inner.valmod(),this.zpp_inner.zip_length&&(this.zpp_inner.zip_length=!1,this.zpp_inner.user_length=this.zpp_inner.inner.length),this.zpp_inner.user_length},g.prototype.has=function(t){return this.zpp_inner.valmod(),this.zpp_inner.inner.has(t.zpp_inner)},g.prototype.at=function(t){if(this.zpp_inner.valmod(),this.zpp_inner.reverse_flag&&(this.zpp_inner.valmod(),this.zpp_inner.zip_length&&(this.zpp_inner.zip_length=!1,this.zpp_inner.user_length=this.zpp_inner.inner.length),t=this.zpp_inner.user_length-1-t),t<this.zpp_inner.at_index||null==this.zpp_inner.at_ite)this.zpp_inner.at_index=t,this.zpp_inner.at_ite=this.zpp_inner.inner.iterator_at(t);else for(;this.zpp_inner.at_index!=t;)this.zpp_inner.at_index++,this.zpp_inner.at_ite=this.zpp_inner.at_ite.next;return this.zpp_inner.at_ite.elt.outer},g.prototype.push=function(t){this.zpp_inner.modify_test(),this.zpp_inner.valmod();var e,i=null==this.zpp_inner.adder||this.zpp_inner.adder(t);return i&&(this.zpp_inner.reverse_flag?this.zpp_inner.inner.add(t.zpp_inner):(null==this.zpp_inner.push_ite&&(e=null==this.zpp_inner.inner.head?null:(this.zpp_inner.valmod(),this.zpp_inner.zip_length&&(this.zpp_inner.zip_length=!1,this.zpp_inner.user_length=this.zpp_inner.inner.length),this.zpp_inner.inner.iterator_at(this.zpp_inner.user_length-1)),this.zpp_inner.push_ite=e),this.zpp_inner.push_ite=this.zpp_inner.inner.insert(this.zpp_inner.push_ite,t.zpp_inner)),this.zpp_inner.invalidate(),null!=this.zpp_inner.post_adder&&this.zpp_inner.post_adder(t)),i},g.prototype.unshift=function(t){this.zpp_inner.modify_test(),this.zpp_inner.valmod();var e,i=null==this.zpp_inner.adder||this.zpp_inner.adder(t);return i&&(this.zpp_inner.reverse_flag?(null==this.zpp_inner.push_ite&&(e=null==this.zpp_inner.inner.head?null:(this.zpp_inner.valmod(),this.zpp_inner.zip_length&&(this.zpp_inner.zip_length=!1,this.zpp_inner.user_length=this.zpp_inner.inner.length),this.zpp_inner.inner.iterator_at(this.zpp_inner.user_length-1)),this.zpp_inner.push_ite=e),this.zpp_inner.push_ite=this.zpp_inner.inner.insert(this.zpp_inner.push_ite,t.zpp_inner)):this.zpp_inner.inner.add(t.zpp_inner),this.zpp_inner.invalidate(),null!=this.zpp_inner.post_adder&&this.zpp_inner.post_adder(t)),i},g.prototype.pop=function(){this.zpp_inner.modify_test(),this.zpp_inner.valmod();var t,e,i=null;return this.zpp_inner.reverse_flag?(e=(i=this.zpp_inner.inner.head.elt).outer,null!=this.zpp_inner.subber&&this.zpp_inner.subber(e),this.zpp_inner.dontremove||this.zpp_inner.inner.pop()):(null!=this.zpp_inner.at_ite&&null==this.zpp_inner.at_ite.next&&(this.zpp_inner.at_ite=null),this.zpp_inner.valmod(),this.zpp_inner.zip_length&&(this.zpp_inner.zip_length=!1,this.zpp_inner.user_length=this.zpp_inner.inner.length),e=(i=(null==(t=1==this.zpp_inner.user_length?null:(this.zpp_inner.valmod(),this.zpp_inner.zip_length&&(this.zpp_inner.zip_length=!1,this.zpp_inner.user_length=this.zpp_inner.inner.length),this.zpp_inner.inner.iterator_at(this.zpp_inner.user_length-2)))?this.zpp_inner.inner.head:t.next).elt).outer,null!=this.zpp_inner.subber&&this.zpp_inner.subber(e),this.zpp_inner.dontremove||this.zpp_inner.inner.erase(t)),this.zpp_inner.invalidate(),i.outer},g.prototype.shift=function(){this.zpp_inner.modify_test(),this.zpp_inner.valmod();var t,e,i=null;return this.zpp_inner.reverse_flag?(null!=this.zpp_inner.at_ite&&null==this.zpp_inner.at_ite.next&&(this.zpp_inner.at_ite=null),this.zpp_inner.valmod(),this.zpp_inner.zip_length&&(this.zpp_inner.zip_length=!1,this.zpp_inner.user_length=this.zpp_inner.inner.length),t=(i=(null==(e=1==this.zpp_inner.user_length?null:(this.zpp_inner.valmod(),this.zpp_inner.zip_length&&(this.zpp_inner.zip_length=!1,this.zpp_inner.user_length=this.zpp_inner.inner.length),this.zpp_inner.inner.iterator_at(this.zpp_inner.user_length-2)))?this.zpp_inner.inner.head:e.next).elt).outer,null!=this.zpp_inner.subber&&this.zpp_inner.subber(t),this.zpp_inner.dontremove||this.zpp_inner.inner.erase(e)):(e=(i=this.zpp_inner.inner.head.elt).outer,null!=this.zpp_inner.subber&&this.zpp_inner.subber(e),this.zpp_inner.dontremove||this.zpp_inner.inner.pop()),this.zpp_inner.invalidate(),i.outer},g.prototype.add=function(t){return this.zpp_inner.reverse_flag?this.push(t):this.unshift(t)},g.prototype.remove=function(t){this.zpp_inner.modify_test(),this.zpp_inner.valmod();for(var e=!1,i=this.zpp_inner.inner.head;null!=i;){if(i.elt==t.zpp_inner){e=!0;break}i=i.next}return e&&(null!=this.zpp_inner.subber&&this.zpp_inner.subber(t),this.zpp_inner.dontremove||this.zpp_inner.inner.remove(t.zpp_inner),this.zpp_inner.invalidate()),e},g.prototype.clear=function(){if(this.zpp_inner.reverse_flag)for(;null!=this.zpp_inner.inner.head;)this.pop();else for(;null!=this.zpp_inner.inner.head;)this.shift()},g.prototype.empty=function(){return null==this.zpp_inner.inner.head},g.prototype.iterator=function(){return this.zpp_inner.valmod(),Wt.get(this)},g.prototype.copy=function(t){null==t&&(t=!1);var e=new g;this.zpp_inner.valmod();for(var i=Wt.get(this);;){i.zpp_inner.zpp_inner.valmod();var n=i.zpp_inner;n.zpp_inner.valmod(),n.zpp_inner.zip_length&&(n.zpp_inner.zip_length=!1,n.zpp_inner.user_length=n.zpp_inner.inner.length);n=n.zpp_inner.user_length;if(i.zpp_critical=!0,!(i.zpp_i<n||(i.zpp_next=Wt.zpp_pool,(Wt.zpp_pool=i).zpp_inner=null,!1)))break;i.zpp_critical=!1;n=i.zpp_inner.at(i.zpp_i++);e.push(t?null:n)}return e},g.prototype.merge=function(t){t.zpp_inner.valmod();for(var e=Wt.get(t);;){e.zpp_inner.zpp_inner.valmod();var i=e.zpp_inner;i.zpp_inner.valmod(),i.zpp_inner.zip_length&&(i.zpp_inner.zip_length=!1,i.zpp_inner.user_length=i.zpp_inner.inner.length);i=i.zpp_inner.user_length;if(e.zpp_critical=!0,!(e.zpp_i<i||(e.zpp_next=Wt.zpp_pool,(Wt.zpp_pool=e).zpp_inner=null,!1)))break;e.zpp_critical=!1;i=e.zpp_inner.at(e.zpp_i++);this.has(i)||(this.zpp_inner.reverse_flag?this.push(i):this.unshift(i))}},g.prototype.toString=function(){var t="[",e=!0;this.zpp_inner.valmod();for(var i=Wt.get(this);;){i.zpp_inner.zpp_inner.valmod();var n=i.zpp_inner;n.zpp_inner.valmod(),n.zpp_inner.zip_length&&(n.zpp_inner.zip_length=!1,n.zpp_inner.user_length=n.zpp_inner.inner.length);n=n.zpp_inner.user_length;if(i.zpp_critical=!0,!(i.zpp_i<n||(i.zpp_next=Wt.zpp_pool,(Wt.zpp_pool=i).zpp_inner=null,!1)))break;i.zpp_critical=!1;n=i.zpp_inner.at(i.zpp_i++);e||(t+=","),t+=null==n?"NULL":n.toString(),e=!1}return t+"]"},g.prototype.foreach=function(t){this.zpp_inner.valmod();for(var e=Wt.get(this);;){e.zpp_inner.zpp_inner.valmod();var i=e.zpp_inner;i.zpp_inner.valmod(),i.zpp_inner.zip_length&&(i.zpp_inner.zip_length=!1,i.zpp_inner.user_length=i.zpp_inner.inner.length);i=i.zpp_inner.user_length;if(e.zpp_critical=!0,!(e.zpp_i<i||(e.zpp_next=Wt.zpp_pool,(Wt.zpp_pool=e).zpp_inner=null,!1)))break;try{e.zpp_critical=!1,t(e.zpp_inner.at(e.zpp_i++))}catch(t){e.zpp_next=Wt.zpp_pool,(Wt.zpp_pool=e).zpp_inner=null;break}}return this},g.prototype.filter=function(t){for(var e=0;;){if(this.zpp_inner.valmod(),this.zpp_inner.zip_length&&(this.zpp_inner.zip_length=!1,this.zpp_inner.user_length=this.zpp_inner.inner.length),!(e<this.zpp_inner.user_length))break;var i=this.at(e);try{t(i)?++e:this.remove(i)}catch(t){break}}return this},Object.defineProperty(g.prototype,"length",{get:g.prototype.get_length}),g.prototype.__class__=g;var f=nape.callbacks.ListenerType=function(){};f.__name__=["nape","callbacks","ListenerType"],f.BODY=null,f.get_BODY=function(){return null==Yn.ListenerType_BODY&&(Yn.internal=!0,Yn.ListenerType_BODY=new f,Yn.internal=!1),Yn.ListenerType_BODY},f.CONSTRAINT=null,f.get_CONSTRAINT=function(){return null==Yn.ListenerType_CONSTRAINT&&(Yn.internal=!0,Yn.ListenerType_CONSTRAINT=new f,Yn.internal=!1),Yn.ListenerType_CONSTRAINT},f.INTERACTION=null,f.get_INTERACTION=function(){return null==Yn.ListenerType_INTERACTION&&(Yn.internal=!0,Yn.ListenerType_INTERACTION=new f,Yn.internal=!1),Yn.ListenerType_INTERACTION},f.PRE=null,f.get_PRE=function(){return null==Yn.ListenerType_PRE&&(Yn.internal=!0,Yn.ListenerType_PRE=new f,Yn.internal=!1),Yn.ListenerType_PRE},f.prototype.toString=function(){return null==Yn.ListenerType_BODY&&(Yn.internal=!0,Yn.ListenerType_BODY=new f,Yn.internal=!1),this==Yn.ListenerType_BODY?"BODY":(null==Yn.ListenerType_CONSTRAINT&&(Yn.internal=!0,Yn.ListenerType_CONSTRAINT=new f,Yn.internal=!1),this==Yn.ListenerType_CONSTRAINT?"CONSTRAINT":(null==Yn.ListenerType_INTERACTION&&(Yn.internal=!0,Yn.ListenerType_INTERACTION=new f,Yn.internal=!1),this==Yn.ListenerType_INTERACTION?"INTERACTION":(null==Yn.ListenerType_PRE&&(Yn.internal=!0,Yn.ListenerType_PRE=new f,Yn.internal=!1),this==Yn.ListenerType_PRE?"PRE":"")))},Object.defineProperty(f,"BODY",{get:f.get_BODY}),Object.defineProperty(f,"CONSTRAINT",{get:f.get_CONSTRAINT}),Object.defineProperty(f,"INTERACTION",{get:f.get_INTERACTION}),Object.defineProperty(f,"PRE",{get:f.get_PRE}),f.prototype.__class__=f;var x=nape.callbacks.OptionType=function(t,e){this.zpp_inner=null,this.zpp_inner=new It,this.zpp_inner.outer=this,null!=t&&this.including(t),null!=e&&this.excluding(e)};x.__name__=["nape","callbacks","OptionType"],x.prototype.zpp_inner=null,x.prototype.get_includes=function(){return null==this.zpp_inner.wrap_includes&&this.zpp_inner.setup_includes(),this.zpp_inner.wrap_includes},x.prototype.get_excludes=function(){return null==this.zpp_inner.wrap_excludes&&this.zpp_inner.setup_excludes(),this.zpp_inner.wrap_excludes},x.prototype.including=function(t){return this.zpp_inner.append(this.zpp_inner.includes,t),this},x.prototype.excluding=function(t){return this.zpp_inner.append(this.zpp_inner.excludes,t),this},x.prototype.toString=function(){null==this.zpp_inner.wrap_includes&&this.zpp_inner.setup_includes();var t=this.zpp_inner.wrap_includes.toString();return null==this.zpp_inner.wrap_excludes&&this.zpp_inner.setup_excludes(),"@{"+t+" excluding "+this.zpp_inner.wrap_excludes.toString()+"}"},Object.defineProperty(x.prototype,"includes",{get:x.prototype.get_includes}),Object.defineProperty(x.prototype,"excludes",{get:x.prototype.get_excludes}),x.prototype.__class__=x;var v=nape.callbacks.PreCallback=function(){e.call(this)};v.__name__=["nape","callbacks","PreCallback"],v.__super__=e,(v.prototype=Object.create(e.prototype)).get_arbiter=function(){return this.zpp_inner.pre_arbiter.wrapper()},v.prototype.get_int1=function(){return this.zpp_inner.int1.outer_i},v.prototype.get_int2=function(){return this.zpp_inner.int2.outer_i},v.prototype.get_swapped=function(){return this.zpp_inner.pre_swapped},v.prototype.toString=function(){var t="Cb:PRE::"+this.zpp_inner.int1.outer_i.toString()+"/"+this.zpp_inner.int2.outer_i.toString();return t+=" : "+this.zpp_inner.pre_arbiter.wrapper().toString(),t+=" : listnener: "+n.string(this.zpp_inner.listener.outer)},Object.defineProperty(v.prototype,"arbiter",{get:v.prototype.get_arbiter}),Object.defineProperty(v.prototype,"int1",{get:v.prototype.get_int1}),Object.defineProperty(v.prototype,"int2",{get:v.prototype.get_int2}),Object.defineProperty(v.prototype,"swapped",{get:v.prototype.get_swapped}),v.prototype.__class__=v;var Xn=nape.callbacks.PreFlag=function(){};Xn.__name__=["nape","callbacks","PreFlag"],Xn.ACCEPT=null,Xn.get_ACCEPT=function(){return null==Yn.PreFlag_ACCEPT&&(Yn.internal=!0,Yn.PreFlag_ACCEPT=new Xn,Yn.internal=!1),Yn.PreFlag_ACCEPT},Xn.IGNORE=null,Xn.get_IGNORE=function(){return null==Yn.PreFlag_IGNORE&&(Yn.internal=!0,Yn.PreFlag_IGNORE=new Xn,Yn.internal=!1),Yn.PreFlag_IGNORE},Xn.ACCEPT_ONCE=null,Xn.get_ACCEPT_ONCE=function(){return null==Yn.PreFlag_ACCEPT_ONCE&&(Yn.internal=!0,Yn.PreFlag_ACCEPT_ONCE=new Xn,Yn.internal=!1),Yn.PreFlag_ACCEPT_ONCE},Xn.IGNORE_ONCE=null,Xn.get_IGNORE_ONCE=function(){return null==Yn.PreFlag_IGNORE_ONCE&&(Yn.internal=!0,Yn.PreFlag_IGNORE_ONCE=new Xn,Yn.internal=!1),Yn.PreFlag_IGNORE_ONCE},Xn.prototype.toString=function(){return null==Yn.PreFlag_ACCEPT&&(Yn.internal=!0,Yn.PreFlag_ACCEPT=new Xn,Yn.internal=!1),this==Yn.PreFlag_ACCEPT?"ACCEPT":(null==Yn.PreFlag_IGNORE&&(Yn.internal=!0,Yn.PreFlag_IGNORE=new Xn,Yn.internal=!1),this==Yn.PreFlag_IGNORE?"IGNORE":(null==Yn.PreFlag_ACCEPT_ONCE&&(Yn.internal=!0,Yn.PreFlag_ACCEPT_ONCE=new Xn,Yn.internal=!1),this==Yn.PreFlag_ACCEPT_ONCE?"ACCEPT_ONCE":(null==Yn.PreFlag_IGNORE_ONCE&&(Yn.internal=!0,Yn.PreFlag_IGNORE_ONCE=new Xn,Yn.internal=!1),this==Yn.PreFlag_IGNORE_ONCE?"IGNORE_ONCE":"")))},Object.defineProperty(Xn,"ACCEPT",{get:Xn.get_ACCEPT}),Object.defineProperty(Xn,"IGNORE",{get:Xn.get_IGNORE}),Object.defineProperty(Xn,"ACCEPT_ONCE",{get:Xn.get_ACCEPT_ONCE}),Object.defineProperty(Xn,"IGNORE_ONCE",{get:Xn.get_IGNORE_ONCE}),Xn.prototype.__class__=Xn;o=nape.callbacks.PreListener=function(t,e,i,n,r,o){null==o&&(o=!1),null==r&&(r=0),this.zpp_inner_zn=null,l.call(this),this.zpp_inner_zn=new Be(It.argument(e),It.argument(i),5,3),this.zpp_inner=this.zpp_inner_zn,((this.zpp_inner.outer=this).zpp_inner_zn.outer_znp=this).zpp_inner.precedence=r,this.zpp_inner_zn.pure=o,this.zpp_inner_zn.handlerp=n;var n=this.zpp_inner_zn.itype,n=1==n?(null==Yn.InteractionType_COLLISION&&(Yn.internal=!0,Yn.InteractionType_COLLISION=new m,Yn.internal=!1),Yn.InteractionType_COLLISION):2==n?(null==Yn.InteractionType_SENSOR&&(Yn.internal=!0,Yn.InteractionType_SENSOR=new m,Yn.internal=!1),Yn.InteractionType_SENSOR):4==n?(null==Yn.InteractionType_FLUID&&(Yn.internal=!0,Yn.InteractionType_FLUID=new m,Yn.internal=!1),Yn.InteractionType_FLUID):7==n?(null==Yn.InteractionType_ANY&&(Yn.internal=!0,Yn.InteractionType_ANY=new m,Yn.internal=!1),Yn.InteractionType_ANY):null;n!=t&&(null==Yn.InteractionType_COLLISION&&(Yn.internal=!0,Yn.InteractionType_COLLISION=new m,Yn.internal=!1),s=t==Yn.InteractionType_COLLISION?1:(null==Yn.InteractionType_SENSOR&&(Yn.internal=!0,Yn.InteractionType_SENSOR=new m,Yn.internal=!1),t==Yn.InteractionType_SENSOR?2:(null==Yn.InteractionType_FLUID&&(Yn.internal=!0,Yn.InteractionType_FLUID=new m,Yn.internal=!1),t==Yn.InteractionType_FLUID?4:7)),this.zpp_inner_zn.itype=s);var s=this.zpp_inner_zn.itype;1==s?null==Yn.InteractionType_COLLISION&&(Yn.internal=!0,Yn.InteractionType_COLLISION=new m,Yn.internal=!1):2==s?null==Yn.InteractionType_SENSOR&&(Yn.internal=!0,Yn.InteractionType_SENSOR=new m,Yn.internal=!1):4==s?null==Yn.InteractionType_FLUID&&(Yn.internal=!0,Yn.InteractionType_FLUID=new m,Yn.internal=!1):7==s&&null==Yn.InteractionType_ANY&&(Yn.internal=!0,Yn.InteractionType_ANY=new m,Yn.internal=!1)};o.__name__=["nape","callbacks","PreListener"],o.__super__=l,(o.prototype=Object.create(l.prototype)).zpp_inner_zn=null,o.prototype.get_options1=function(){return this.zpp_inner_zn.options1.outer},o.prototype.set_options1=function(t){return this.zpp_inner_zn.options1.set(t.zpp_inner),this.zpp_inner_zn.options1.outer},o.prototype.get_options2=function(){return this.zpp_inner_zn.options2.outer},o.prototype.set_options2=function(t){return this.zpp_inner_zn.options2.set(t.zpp_inner),this.zpp_inner_zn.options2.outer},o.prototype.get_handler=function(){return this.zpp_inner_zn.handlerp},o.prototype.set_handler=function(t){return this.zpp_inner_zn.handlerp=t,this.zpp_inner_zn.wake(),this.zpp_inner_zn.handlerp},o.prototype.get_pure=function(){return this.zpp_inner_zn.pure},o.prototype.set_pure=function(t){return t||this.zpp_inner_zn.wake(),this.zpp_inner_zn.pure=t,this.zpp_inner_zn.pure},o.prototype.get_interactionType=function(){var t=this.zpp_inner_zn.itype;return 1==t?(null==Yn.InteractionType_COLLISION&&(Yn.internal=!0,Yn.InteractionType_COLLISION=new m,Yn.internal=!1),Yn.InteractionType_COLLISION):2==t?(null==Yn.InteractionType_SENSOR&&(Yn.internal=!0,Yn.InteractionType_SENSOR=new m,Yn.internal=!1),Yn.InteractionType_SENSOR):4==t?(null==Yn.InteractionType_FLUID&&(Yn.internal=!0,Yn.InteractionType_FLUID=new m,Yn.internal=!1),Yn.InteractionType_FLUID):7==t?(null==Yn.InteractionType_ANY&&(Yn.internal=!0,Yn.InteractionType_ANY=new m,Yn.internal=!1),Yn.InteractionType_ANY):null},o.prototype.set_interactionType=function(t){var e=this.zpp_inner_zn.itype,e=1==e?(null==Yn.InteractionType_COLLISION&&(Yn.internal=!0,Yn.InteractionType_COLLISION=new m,Yn.internal=!1),Yn.InteractionType_COLLISION):2==e?(null==Yn.InteractionType_SENSOR&&(Yn.internal=!0,Yn.InteractionType_SENSOR=new m,Yn.internal=!1),Yn.InteractionType_SENSOR):4==e?(null==Yn.InteractionType_FLUID&&(Yn.internal=!0,Yn.InteractionType_FLUID=new m,Yn.internal=!1),Yn.InteractionType_FLUID):7==e?(null==Yn.InteractionType_ANY&&(Yn.internal=!0,Yn.InteractionType_ANY=new m,Yn.internal=!1),Yn.InteractionType_ANY):null;e!=t&&(null==Yn.InteractionType_COLLISION&&(Yn.internal=!0,Yn.InteractionType_COLLISION=new m,Yn.internal=!1),i=t==Yn.InteractionType_COLLISION?1:(null==Yn.InteractionType_SENSOR&&(Yn.internal=!0,Yn.InteractionType_SENSOR=new m,Yn.internal=!1),t==Yn.InteractionType_SENSOR?2:(null==Yn.InteractionType_FLUID&&(Yn.internal=!0,Yn.InteractionType_FLUID=new m,Yn.internal=!1),t==Yn.InteractionType_FLUID?4:7)),this.zpp_inner_zn.itype=i);var i=this.zpp_inner_zn.itype;return 1==i?(null==Yn.InteractionType_COLLISION&&(Yn.internal=!0,Yn.InteractionType_COLLISION=new m,Yn.internal=!1),Yn.InteractionType_COLLISION):2==i?(null==Yn.InteractionType_SENSOR&&(Yn.internal=!0,Yn.InteractionType_SENSOR=new m,Yn.internal=!1),Yn.InteractionType_SENSOR):4==i?(null==Yn.InteractionType_FLUID&&(Yn.internal=!0,Yn.InteractionType_FLUID=new m,Yn.internal=!1),Yn.InteractionType_FLUID):7==i?(null==Yn.InteractionType_ANY&&(Yn.internal=!0,Yn.InteractionType_ANY=new m,Yn.internal=!1),Yn.InteractionType_ANY):null},Object.defineProperty(o.prototype,"options1",{get:o.prototype.get_options1,set:o.prototype.set_options1}),Object.defineProperty(o.prototype,"options2",{get:o.prototype.get_options2,set:o.prototype.set_options2}),Object.defineProperty(o.prototype,"handler",{get:o.prototype.get_handler,set:o.prototype.set_handler}),Object.defineProperty(o.prototype,"pure",{get:o.prototype.get_pure,set:o.prototype.set_pure}),Object.defineProperty(o.prototype,"interactionType",{get:o.prototype.get_interactionType,set:o.prototype.set_interactionType}),o.prototype.__class__=o;var w=nape.constraint.Constraint=function(){this.debugDraw=!0,this.zpp_inner.insert_cbtype(Tt.ANY_CONSTRAINT.zpp_inner)};w.__name__=["nape","constraint","Constraint"],w.prototype.zpp_inner=null,w.prototype.get_userData=function(){return null==this.zpp_inner.userData&&(this.zpp_inner.userData={}),this.zpp_inner.userData},w.prototype.debugDraw=null,w.prototype.get_compound=function(){return null==this.zpp_inner.compound?null:this.zpp_inner.compound.outer},w.prototype.set_compound=function(t){return(null==this.zpp_inner.compound?null:this.zpp_inner.compound.outer)!=t&&(null!=(null==this.zpp_inner.compound?null:this.zpp_inner.compound.outer)&&(null==this.zpp_inner.compound?null:this.zpp_inner.compound.outer).zpp_inner.wrap_constraints.remove(this),null!=t&&((t=t.zpp_inner.wrap_constraints).zpp_inner.reverse_flag?t.push(this):t.unshift(this))),null==this.zpp_inner.compound?null:this.zpp_inner.compound.outer},w.prototype.get_space=function(){return null==this.zpp_inner.space?null:this.zpp_inner.space.outer},w.prototype.set_space=function(t){return(null==this.zpp_inner.space?null:this.zpp_inner.space.outer)!=t&&(null!=this.zpp_inner.component&&(this.zpp_inner.component.woken=!1),this.zpp_inner.clearcache(),null!=this.zpp_inner.space&&this.zpp_inner.space.outer.zpp_inner.wrap_constraints.remove(this),null!=t?(t=t.zpp_inner.wrap_constraints).zpp_inner.reverse_flag?t.push(this):t.unshift(this):this.zpp_inner.space=null),null==this.zpp_inner.space?null:this.zpp_inner.space.outer},w.prototype.get_isSleeping=function(){return this.zpp_inner.component.sleeping},w.prototype.get_active=function(){return this.zpp_inner.active},w.prototype.set_active=function(t){return this.zpp_inner.active!=t&&(null!=this.zpp_inner.component&&(this.zpp_inner.component.woken=!1),this.zpp_inner.clearcache(),t?(this.zpp_inner.active=t,this.zpp_inner.activate(),null!=this.zpp_inner.space&&(null!=this.zpp_inner.component&&(this.zpp_inner.component.sleeping=!0),this.zpp_inner.space.wake_constraint(this.zpp_inner,!0))):(null!=this.zpp_inner.space&&(this.zpp_inner.wake(),this.zpp_inner.space.live_constraints.remove(this.zpp_inner)),this.zpp_inner.active=t,this.zpp_inner.deactivate())),this.zpp_inner.active},w.prototype.get_ignore=function(){return this.zpp_inner.ignore},w.prototype.set_ignore=function(t){return this.zpp_inner.ignore!=t&&(this.zpp_inner.ignore=t,this.zpp_inner.wake()),this.zpp_inner.ignore},w.prototype.get_stiff=function(){return this.zpp_inner.stiff},w.prototype.set_stiff=function(t){return this.zpp_inner.stiff!=t&&(this.zpp_inner.stiff=t,this.zpp_inner.wake()),this.zpp_inner.stiff},w.prototype.get_frequency=function(){return this.zpp_inner.frequency},w.prototype.set_frequency=function(t){return this.zpp_inner.frequency!=t&&(this.zpp_inner.frequency=t,this.zpp_inner.stiff||this.zpp_inner.wake()),this.zpp_inner.frequency},w.prototype.get_damping=function(){return this.zpp_inner.damping},w.prototype.set_damping=function(t){return this.zpp_inner.damping!=t&&(this.zpp_inner.damping=t,this.zpp_inner.stiff||this.zpp_inner.wake()),this.zpp_inner.damping},w.prototype.get_maxForce=function(){return this.zpp_inner.maxForce},w.prototype.set_maxForce=function(t){return this.zpp_inner.maxForce!=t&&(this.zpp_inner.maxForce=t,this.zpp_inner.wake()),this.zpp_inner.maxForce},w.prototype.get_maxError=function(){return this.zpp_inner.maxError},w.prototype.set_maxError=function(t){return this.zpp_inner.maxError!=t&&(this.zpp_inner.maxError=t,this.zpp_inner.wake()),this.zpp_inner.maxError},w.prototype.get_breakUnderForce=function(){return this.zpp_inner.breakUnderForce},w.prototype.set_breakUnderForce=function(t){return this.zpp_inner.breakUnderForce!=t&&(this.zpp_inner.breakUnderForce=t,this.zpp_inner.wake()),this.zpp_inner.breakUnderForce},w.prototype.get_breakUnderError=function(){return this.zpp_inner.breakUnderError},w.prototype.set_breakUnderError=function(t){return this.zpp_inner.breakUnderError!=t&&(this.zpp_inner.breakUnderError=t,this.zpp_inner.wake()),this.zpp_inner.breakUnderError},w.prototype.get_removeOnBreak=function(){return this.zpp_inner.removeOnBreak},w.prototype.set_removeOnBreak=function(t){return this.zpp_inner.removeOnBreak=t,this.zpp_inner.removeOnBreak},w.prototype.impulse=function(){return null},w.prototype.bodyImpulse=function(t){return null},w.prototype.visitBodies=function(t){},w.prototype.get_cbTypes=function(){return null==this.zpp_inner.wrap_cbTypes&&this.zpp_inner.setupcbTypes(),this.zpp_inner.wrap_cbTypes},w.prototype.toString=function(){return"{Constraint}"},w.prototype.copy=function(){return this.zpp_inner.copy()},Object.defineProperty(w.prototype,"userData",{get:w.prototype.get_userData}),Object.defineProperty(w.prototype,"compound",{get:w.prototype.get_compound,set:w.prototype.set_compound}),Object.defineProperty(w.prototype,"space",{get:w.prototype.get_space,set:w.prototype.set_space}),Object.defineProperty(w.prototype,"isSleeping",{get:w.prototype.get_isSleeping}),Object.defineProperty(w.prototype,"active",{get:w.prototype.get_active,set:w.prototype.set_active}),Object.defineProperty(w.prototype,"ignore",{get:w.prototype.get_ignore,set:w.prototype.set_ignore}),Object.defineProperty(w.prototype,"stiff",{get:w.prototype.get_stiff,set:w.prototype.set_stiff}),Object.defineProperty(w.prototype,"frequency",{get:w.prototype.get_frequency,set:w.prototype.set_frequency}),Object.defineProperty(w.prototype,"damping",{get:w.prototype.get_damping,set:w.prototype.set_damping}),Object.defineProperty(w.prototype,"maxForce",{get:w.prototype.get_maxForce,set:w.prototype.set_maxForce}),Object.defineProperty(w.prototype,"maxError",{get:w.prototype.get_maxError,set:w.prototype.set_maxError}),Object.defineProperty(w.prototype,"breakUnderForce",{get:w.prototype.get_breakUnderForce,set:w.prototype.set_breakUnderForce}),Object.defineProperty(w.prototype,"breakUnderError",{get:w.prototype.get_breakUnderError,set:w.prototype.set_breakUnderError}),Object.defineProperty(w.prototype,"removeOnBreak",{get:w.prototype.get_removeOnBreak,set:w.prototype.set_removeOnBreak}),Object.defineProperty(w.prototype,"cbTypes",{get:w.prototype.get_cbTypes}),w.prototype.__class__=w;var z=nape.constraint.AngleJoint=function(t,e,i,n,r){null==r&&(r=1),this.zpp_inner_zn=null,this.zpp_inner_zn=new Dt,this.zpp_inner=this.zpp_inner_zn,(this.zpp_inner.outer=this).zpp_inner_zn.outer_zn=this,w.call(this),this.zpp_inner.immutable_midstep("Constraint::body1");t=null==t?null:t.zpp_inner;t!=this.zpp_inner_zn.b1&&(null!=this.zpp_inner_zn.b1&&(null!=(null==this.zpp_inner.space?null:this.zpp_inner.space.outer)&&this.zpp_inner_zn.b2!=this.zpp_inner_zn.b1&&null!=this.zpp_inner_zn.b1&&this.zpp_inner_zn.b1.constraints.remove(this.zpp_inner),this.zpp_inner.active&&null!=(null==this.zpp_inner.space?null:this.zpp_inner.space.outer)&&this.zpp_inner_zn.b1.wake()),this.zpp_inner_zn.b1=t,null!=(null==this.zpp_inner.space?null:this.zpp_inner.space.outer)&&null!=t&&this.zpp_inner_zn.b2!=t&&null!=t&&t.constraints.add(this.zpp_inner),this.zpp_inner.active&&null!=(null==this.zpp_inner.space?null:this.zpp_inner.space.outer)&&(this.zpp_inner.wake(),null!=t&&t.wake())),this.zpp_inner.immutable_midstep("Constraint::body2");e=null==e?null:e.zpp_inner;e!=this.zpp_inner_zn.b2&&(null!=this.zpp_inner_zn.b2&&(null!=(null==this.zpp_inner.space?null:this.zpp_inner.space.outer)&&this.zpp_inner_zn.b1!=this.zpp_inner_zn.b2&&null!=this.zpp_inner_zn.b2&&this.zpp_inner_zn.b2.constraints.remove(this.zpp_inner),this.zpp_inner.active&&null!=(null==this.zpp_inner.space?null:this.zpp_inner.space.outer)&&this.zpp_inner_zn.b2.wake()),this.zpp_inner_zn.b2=e,null!=(null==this.zpp_inner.space?null:this.zpp_inner.space.outer)&&null!=e&&this.zpp_inner_zn.b1!=e&&null!=e&&e.constraints.add(this.zpp_inner),this.zpp_inner.active&&null!=(null==this.zpp_inner.space?null:this.zpp_inner.space.outer)&&(this.zpp_inner.wake(),null!=e&&e.wake())),this.zpp_inner.immutable_midstep("AngleJoint::jointMin"),this.zpp_inner_zn.jointMin!=i&&(this.zpp_inner_zn.jointMin=i,this.zpp_inner.wake()),this.zpp_inner.immutable_midstep("AngleJoint::jointMax"),this.zpp_inner_zn.jointMax!=n&&(this.zpp_inner_zn.jointMax=n,this.zpp_inner.wake()),this.zpp_inner.immutable_midstep("AngleJoint::ratio"),this.zpp_inner_zn.ratio!=r&&(this.zpp_inner_zn.ratio=r,this.zpp_inner.wake())};z.__name__=["nape","constraint","AngleJoint"],z.__super__=w,(z.prototype=Object.create(w.prototype)).zpp_inner_zn=null,z.prototype.get_body1=function(){return null==this.zpp_inner_zn.b1?null:this.zpp_inner_zn.b1.outer},z.prototype.set_body1=function(t){this.zpp_inner.immutable_midstep("Constraint::body1");t=null==t?null:t.zpp_inner;return t!=this.zpp_inner_zn.b1&&(null!=this.zpp_inner_zn.b1&&(null!=(null==this.zpp_inner.space?null:this.zpp_inner.space.outer)&&this.zpp_inner_zn.b2!=this.zpp_inner_zn.b1&&null!=this.zpp_inner_zn.b1&&this.zpp_inner_zn.b1.constraints.remove(this.zpp_inner),this.zpp_inner.active&&null!=(null==this.zpp_inner.space?null:this.zpp_inner.space.outer)&&this.zpp_inner_zn.b1.wake()),this.zpp_inner_zn.b1=t,null!=(null==this.zpp_inner.space?null:this.zpp_inner.space.outer)&&null!=t&&this.zpp_inner_zn.b2!=t&&null!=t&&t.constraints.add(this.zpp_inner),this.zpp_inner.active&&null!=(null==this.zpp_inner.space?null:this.zpp_inner.space.outer)&&(this.zpp_inner.wake(),null!=t&&t.wake())),null==this.zpp_inner_zn.b1?null:this.zpp_inner_zn.b1.outer},z.prototype.get_body2=function(){return null==this.zpp_inner_zn.b2?null:this.zpp_inner_zn.b2.outer},z.prototype.set_body2=function(t){this.zpp_inner.immutable_midstep("Constraint::body2");t=null==t?null:t.zpp_inner;return t!=this.zpp_inner_zn.b2&&(null!=this.zpp_inner_zn.b2&&(null!=(null==this.zpp_inner.space?null:this.zpp_inner.space.outer)&&this.zpp_inner_zn.b1!=this.zpp_inner_zn.b2&&null!=this.zpp_inner_zn.b2&&this.zpp_inner_zn.b2.constraints.remove(this.zpp_inner),this.zpp_inner.active&&null!=(null==this.zpp_inner.space?null:this.zpp_inner.space.outer)&&this.zpp_inner_zn.b2.wake()),this.zpp_inner_zn.b2=t,null!=(null==this.zpp_inner.space?null:this.zpp_inner.space.outer)&&null!=t&&this.zpp_inner_zn.b1!=t&&null!=t&&t.constraints.add(this.zpp_inner),this.zpp_inner.active&&null!=(null==this.zpp_inner.space?null:this.zpp_inner.space.outer)&&(this.zpp_inner.wake(),null!=t&&t.wake())),null==this.zpp_inner_zn.b2?null:this.zpp_inner_zn.b2.outer},z.prototype.get_jointMin=function(){return this.zpp_inner_zn.jointMin},z.prototype.set_jointMin=function(t){return this.zpp_inner.immutable_midstep("AngleJoint::jointMin"),this.zpp_inner_zn.jointMin!=t&&(this.zpp_inner_zn.jointMin=t,this.zpp_inner.wake()),this.zpp_inner_zn.jointMin},z.prototype.get_jointMax=function(){return this.zpp_inner_zn.jointMax},z.prototype.set_jointMax=function(t){return this.zpp_inner.immutable_midstep("AngleJoint::jointMax"),this.zpp_inner_zn.jointMax!=t&&(this.zpp_inner_zn.jointMax=t,this.zpp_inner.wake()),this.zpp_inner_zn.jointMax},z.prototype.get_ratio=function(){return this.zpp_inner_zn.ratio},z.prototype.set_ratio=function(t){return this.zpp_inner.immutable_midstep("AngleJoint::ratio"),this.zpp_inner_zn.ratio!=t&&(this.zpp_inner_zn.ratio=t,this.zpp_inner.wake()),this.zpp_inner_zn.ratio},z.prototype.isSlack=function(){var t,e=this.zpp_inner_zn,i=e.ratio*e.b2.rot-e.b1.rot;return e.equal?(t=!1,e.scale=1):t=i<e.jointMin?!(e.scale=-1):i>e.jointMax?(i-=e.jointMax,!(e.scale=1)):!(i=e.scale=0),t},z.prototype.impulse=function(){var t=new W(1,1);return t.zpp_inner.x[0*t.zpp_inner.n]=this.zpp_inner_zn.jAcc,t},z.prototype.bodyImpulse=function(t){return this.zpp_inner.active?this.zpp_inner_zn.bodyImpulse(t.zpp_inner):K.get(0,0,0)},z.prototype.visitBodies=function(t){null!=(null==this.zpp_inner_zn.b1?null:this.zpp_inner_zn.b1.outer)&&t(null==this.zpp_inner_zn.b1?null:this.zpp_inner_zn.b1.outer),null!=(null==this.zpp_inner_zn.b2?null:this.zpp_inner_zn.b2.outer)&&(null==this.zpp_inner_zn.b2?null:this.zpp_inner_zn.b2.outer)!=(null==this.zpp_inner_zn.b1?null:this.zpp_inner_zn.b1.outer)&&t(null==this.zpp_inner_zn.b2?null:this.zpp_inner_zn.b2.outer)},Object.defineProperty(z.prototype,"body1",{get:z.prototype.get_body1,set:z.prototype.set_body1}),Object.defineProperty(z.prototype,"body2",{get:z.prototype.get_body2,set:z.prototype.set_body2}),Object.defineProperty(z.prototype,"jointMin",{get:z.prototype.get_jointMin,set:z.prototype.set_jointMin}),Object.defineProperty(z.prototype,"jointMax",{get:z.prototype.get_jointMax,set:z.prototype.set_jointMax}),Object.defineProperty(z.prototype,"ratio",{get:z.prototype.get_ratio,set:z.prototype.set_ratio}),z.prototype.__class__=z;var Xt=nape.constraint.ConstraintIterator=function(){this.zpp_next=null,this.zpp_critical=!1,this.zpp_i=0,this.zpp_inner=null};Xt.__name__=["nape","constraint","ConstraintIterator"],Xt.get=function(t){var e,i=null==Xt.zpp_pool?(zn.internal=!0,e=new Xt,zn.internal=!1,e):(Xt.zpp_pool=(i=Xt.zpp_pool).zpp_next,i);return i.zpp_i=0,i.zpp_inner=t,i.zpp_critical=!1,i},Xt.prototype.zpp_inner=null,Xt.prototype.zpp_i=null,Xt.prototype.zpp_critical=null,Xt.prototype.zpp_next=null,Xt.prototype.hasNext=function(){this.zpp_inner.zpp_inner.valmod();var t=this.zpp_inner;t.zpp_inner.valmod(),t.zpp_inner.zip_length&&(t.zpp_inner.zip_length=!1,t.zpp_inner.user_length=t.zpp_inner.inner.length);t=t.zpp_inner.user_length;return this.zpp_critical=!0,this.zpp_i<t||(this.zpp_next=Xt.zpp_pool,(Xt.zpp_pool=this).zpp_inner=null,!1)},Xt.prototype.next=function(){return this.zpp_critical=!1,this.zpp_inner.at(this.zpp_i++)},Xt.prototype.__class__=Xt;var b=nape.constraint.ConstraintList=function(){this.zpp_inner=null,this.zpp_inner=new zn,this.zpp_inner.outer=this};b.__name__=["nape","constraint","ConstraintList"],b.fromArray=function(t){for(var e=new b,i=0;i<t.length;){var n=t[i];++i,e.push(n)}return e},b.prototype.zpp_inner=null,b.prototype.get_length=function(){return this.zpp_inner.valmod(),this.zpp_inner.zip_length&&(this.zpp_inner.zip_length=!1,this.zpp_inner.user_length=this.zpp_inner.inner.length),this.zpp_inner.user_length},b.prototype.has=function(t){return this.zpp_inner.valmod(),this.zpp_inner.inner.has(t.zpp_inner)},b.prototype.at=function(t){if(this.zpp_inner.valmod(),this.zpp_inner.reverse_flag&&(this.zpp_inner.valmod(),this.zpp_inner.zip_length&&(this.zpp_inner.zip_length=!1,this.zpp_inner.user_length=this.zpp_inner.inner.length),t=this.zpp_inner.user_length-1-t),t<this.zpp_inner.at_index||null==this.zpp_inner.at_ite)this.zpp_inner.at_index=t,this.zpp_inner.at_ite=this.zpp_inner.inner.iterator_at(t);else for(;this.zpp_inner.at_index!=t;)this.zpp_inner.at_index++,this.zpp_inner.at_ite=this.zpp_inner.at_ite.next;return this.zpp_inner.at_ite.elt.outer},b.prototype.push=function(t){this.zpp_inner.modify_test(),this.zpp_inner.valmod();var e,i=null==this.zpp_inner.adder||this.zpp_inner.adder(t);return i&&(this.zpp_inner.reverse_flag?this.zpp_inner.inner.add(t.zpp_inner):(null==this.zpp_inner.push_ite&&(e=null==this.zpp_inner.inner.head?null:(this.zpp_inner.valmod(),this.zpp_inner.zip_length&&(this.zpp_inner.zip_length=!1,this.zpp_inner.user_length=this.zpp_inner.inner.length),this.zpp_inner.inner.iterator_at(this.zpp_inner.user_length-1)),this.zpp_inner.push_ite=e),this.zpp_inner.push_ite=this.zpp_inner.inner.insert(this.zpp_inner.push_ite,t.zpp_inner)),this.zpp_inner.invalidate(),null!=this.zpp_inner.post_adder&&this.zpp_inner.post_adder(t)),i},b.prototype.unshift=function(t){this.zpp_inner.modify_test(),this.zpp_inner.valmod();var e,i=null==this.zpp_inner.adder||this.zpp_inner.adder(t);return i&&(this.zpp_inner.reverse_flag?(null==this.zpp_inner.push_ite&&(e=null==this.zpp_inner.inner.head?null:(this.zpp_inner.valmod(),this.zpp_inner.zip_length&&(this.zpp_inner.zip_length=!1,this.zpp_inner.user_length=this.zpp_inner.inner.length),this.zpp_inner.inner.iterator_at(this.zpp_inner.user_length-1)),this.zpp_inner.push_ite=e),this.zpp_inner.push_ite=this.zpp_inner.inner.insert(this.zpp_inner.push_ite,t.zpp_inner)):this.zpp_inner.inner.add(t.zpp_inner),this.zpp_inner.invalidate(),null!=this.zpp_inner.post_adder&&this.zpp_inner.post_adder(t)),i},b.prototype.pop=function(){this.zpp_inner.modify_test(),this.zpp_inner.valmod();var t,e,i=null;return this.zpp_inner.reverse_flag?(e=(i=this.zpp_inner.inner.head.elt).outer,null!=this.zpp_inner.subber&&this.zpp_inner.subber(e),this.zpp_inner.dontremove||this.zpp_inner.inner.pop()):(null!=this.zpp_inner.at_ite&&null==this.zpp_inner.at_ite.next&&(this.zpp_inner.at_ite=null),this.zpp_inner.valmod(),this.zpp_inner.zip_length&&(this.zpp_inner.zip_length=!1,this.zpp_inner.user_length=this.zpp_inner.inner.length),e=(i=(null==(t=1==this.zpp_inner.user_length?null:(this.zpp_inner.valmod(),this.zpp_inner.zip_length&&(this.zpp_inner.zip_length=!1,this.zpp_inner.user_length=this.zpp_inner.inner.length),this.zpp_inner.inner.iterator_at(this.zpp_inner.user_length-2)))?this.zpp_inner.inner.head:t.next).elt).outer,null!=this.zpp_inner.subber&&this.zpp_inner.subber(e),this.zpp_inner.dontremove||this.zpp_inner.inner.erase(t)),this.zpp_inner.invalidate(),i.outer},b.prototype.shift=function(){this.zpp_inner.modify_test(),this.zpp_inner.valmod();var t,e,i=null;return this.zpp_inner.reverse_flag?(null!=this.zpp_inner.at_ite&&null==this.zpp_inner.at_ite.next&&(this.zpp_inner.at_ite=null),this.zpp_inner.valmod(),this.zpp_inner.zip_length&&(this.zpp_inner.zip_length=!1,this.zpp_inner.user_length=this.zpp_inner.inner.length),t=(i=(null==(e=1==this.zpp_inner.user_length?null:(this.zpp_inner.valmod(),this.zpp_inner.zip_length&&(this.zpp_inner.zip_length=!1,this.zpp_inner.user_length=this.zpp_inner.inner.length),this.zpp_inner.inner.iterator_at(this.zpp_inner.user_length-2)))?this.zpp_inner.inner.head:e.next).elt).outer,null!=this.zpp_inner.subber&&this.zpp_inner.subber(t),this.zpp_inner.dontremove||this.zpp_inner.inner.erase(e)):(e=(i=this.zpp_inner.inner.head.elt).outer,null!=this.zpp_inner.subber&&this.zpp_inner.subber(e),this.zpp_inner.dontremove||this.zpp_inner.inner.pop()),this.zpp_inner.invalidate(),i.outer},b.prototype.add=function(t){return this.zpp_inner.reverse_flag?this.push(t):this.unshift(t)},b.prototype.remove=function(t){this.zpp_inner.modify_test(),this.zpp_inner.valmod();for(var e=!1,i=this.zpp_inner.inner.head;null!=i;){if(i.elt==t.zpp_inner){e=!0;break}i=i.next}return e&&(null!=this.zpp_inner.subber&&this.zpp_inner.subber(t),this.zpp_inner.dontremove||this.zpp_inner.inner.remove(t.zpp_inner),this.zpp_inner.invalidate()),e},b.prototype.clear=function(){if(this.zpp_inner.reverse_flag)for(;null!=this.zpp_inner.inner.head;)this.pop();else for(;null!=this.zpp_inner.inner.head;)this.shift()},b.prototype.empty=function(){return null==this.zpp_inner.inner.head},b.prototype.iterator=function(){return this.zpp_inner.valmod(),Xt.get(this)},b.prototype.copy=function(t){null==t&&(t=!1);var e=new b;this.zpp_inner.valmod();for(var i=Xt.get(this);;){i.zpp_inner.zpp_inner.valmod();var n=i.zpp_inner;n.zpp_inner.valmod(),n.zpp_inner.zip_length&&(n.zpp_inner.zip_length=!1,n.zpp_inner.user_length=n.zpp_inner.inner.length);n=n.zpp_inner.user_length;if(i.zpp_critical=!0,!(i.zpp_i<n||(i.zpp_next=Xt.zpp_pool,(Xt.zpp_pool=i).zpp_inner=null,!1)))break;i.zpp_critical=!1;n=i.zpp_inner.at(i.zpp_i++);e.push(t?null:n)}return e},b.prototype.merge=function(t){t.zpp_inner.valmod();for(var e=Xt.get(t);;){e.zpp_inner.zpp_inner.valmod();var i=e.zpp_inner;i.zpp_inner.valmod(),i.zpp_inner.zip_length&&(i.zpp_inner.zip_length=!1,i.zpp_inner.user_length=i.zpp_inner.inner.length);i=i.zpp_inner.user_length;if(e.zpp_critical=!0,!(e.zpp_i<i||(e.zpp_next=Xt.zpp_pool,(Xt.zpp_pool=e).zpp_inner=null,!1)))break;e.zpp_critical=!1;i=e.zpp_inner.at(e.zpp_i++);this.has(i)||(this.zpp_inner.reverse_flag?this.push(i):this.unshift(i))}},b.prototype.toString=function(){var t="[",e=!0;this.zpp_inner.valmod();for(var i=Xt.get(this);;){i.zpp_inner.zpp_inner.valmod();var n=i.zpp_inner;n.zpp_inner.valmod(),n.zpp_inner.zip_length&&(n.zpp_inner.zip_length=!1,n.zpp_inner.user_length=n.zpp_inner.inner.length);n=n.zpp_inner.user_length;if(i.zpp_critical=!0,!(i.zpp_i<n||(i.zpp_next=Xt.zpp_pool,(Xt.zpp_pool=i).zpp_inner=null,!1)))break;i.zpp_critical=!1;n=i.zpp_inner.at(i.zpp_i++);e||(t+=","),t+=null==n?"NULL":n.toString(),e=!1}return t+"]"},b.prototype.foreach=function(t){this.zpp_inner.valmod();for(var e=Xt.get(this);;){e.zpp_inner.zpp_inner.valmod();var i=e.zpp_inner;i.zpp_inner.valmod(),i.zpp_inner.zip_length&&(i.zpp_inner.zip_length=!1,i.zpp_inner.user_length=i.zpp_inner.inner.length);i=i.zpp_inner.user_length;if(e.zpp_critical=!0,!(e.zpp_i<i||(e.zpp_next=Xt.zpp_pool,(Xt.zpp_pool=e).zpp_inner=null,!1)))break;try{e.zpp_critical=!1,t(e.zpp_inner.at(e.zpp_i++))}catch(t){e.zpp_next=Xt.zpp_pool,(Xt.zpp_pool=e).zpp_inner=null;break}}return this},b.prototype.filter=function(t){for(var e=0;;){if(this.zpp_inner.valmod(),this.zpp_inner.zip_length&&(this.zpp_inner.zip_length=!1,this.zpp_inner.user_length=this.zpp_inner.inner.length),!(e<this.zpp_inner.user_length))break;var i=this.at(e);try{t(i)?++e:this.remove(i)}catch(t){break}}return this},Object.defineProperty(b.prototype,"length",{get:b.prototype.get_length}),b.prototype.__class__=b;var S=nape.constraint.DistanceJoint=function(t,e,i,n,r,o){this.zpp_inner_zn=null,this.zpp_inner_zn=new Bt,this.zpp_inner=this.zpp_inner_zn,(this.zpp_inner.outer=this).zpp_inner_zn.outer_zn=this,w.call(this),this.zpp_inner.immutable_midstep("Constraint::body1");var s=null==t?null:t.zpp_inner;s!=this.zpp_inner_zn.b1&&(null!=this.zpp_inner_zn.b1&&(null!=(null==this.zpp_inner.space?null:this.zpp_inner.space.outer)&&this.zpp_inner_zn.b2!=this.zpp_inner_zn.b1&&null!=this.zpp_inner_zn.b1&&this.zpp_inner_zn.b1.constraints.remove(this.zpp_inner),this.zpp_inner.active&&null!=(null==this.zpp_inner.space?null:this.zpp_inner.space.outer)&&this.zpp_inner_zn.b1.wake()),this.zpp_inner_zn.b1=s,null!=(null==this.zpp_inner.space?null:this.zpp_inner.space.outer)&&null!=s&&this.zpp_inner_zn.b2!=s&&null!=s&&s.constraints.add(this.zpp_inner),this.zpp_inner.active&&null!=(null==this.zpp_inner.space?null:this.zpp_inner.space.outer)&&(this.zpp_inner.wake(),null!=s&&s.wake())),this.zpp_inner.immutable_midstep("Constraint::body2");var a=null==e?null:e.zpp_inner;a!=this.zpp_inner_zn.b2&&(null!=this.zpp_inner_zn.b2&&(null!=(null==this.zpp_inner.space?null:this.zpp_inner.space.outer)&&this.zpp_inner_zn.b1!=this.zpp_inner_zn.b2&&null!=this.zpp_inner_zn.b2&&this.zpp_inner_zn.b2.constraints.remove(this.zpp_inner),this.zpp_inner.active&&null!=(null==this.zpp_inner.space?null:this.zpp_inner.space.outer)&&this.zpp_inner_zn.b2.wake()),this.zpp_inner_zn.b2=a,null!=(null==this.zpp_inner.space?null:this.zpp_inner.space.outer)&&null!=a&&this.zpp_inner_zn.b1!=a&&null!=a&&a.constraints.add(this.zpp_inner),this.zpp_inner.active&&null!=(null==this.zpp_inner.space?null:this.zpp_inner.space.outer)&&(this.zpp_inner.wake(),null!=a&&a.wake())),null==this.zpp_inner_zn.wrap_a1&&this.zpp_inner_zn.setup_a1();t=this.zpp_inner_zn.wrap_a1,s=i.zpp_inner;null!=s._validate&&s._validate();e=i.zpp_inner.x,a=i.zpp_inner;null!=a._validate&&a._validate();var s=i.zpp_inner.y,a=t.zpp_inner;null!=a._validate&&a._validate(),t.zpp_inner.x==e&&(null!=(a=t.zpp_inner)._validate&&a._validate(),t.zpp_inner.y==s)||(t.zpp_inner.x=e,t.zpp_inner.y=s,null!=(h=t.zpp_inner)._invalidate&&h._invalidate(h)),i.zpp_inner.weak&&(l=i.zpp_inner,i.zpp_inner.outer=null,i.zpp_inner=null,i.zpp_pool=Bn.poolVec2,Bn.poolVec2=i,null!=l.outer&&(l.outer.zpp_inner=null,l.outer=null),l._isimmutable=null,l._validate=null,l._invalidate=null,l.next=Gr.zpp_pool,Gr.zpp_pool=l),null==this.zpp_inner_zn.wrap_a1&&this.zpp_inner_zn.setup_a1(),null==this.zpp_inner_zn.wrap_a2&&this.zpp_inner_zn.setup_a2();var t=this.zpp_inner_zn.wrap_a2,h=n.zpp_inner;null!=h._validate&&h._validate();var i=n.zpp_inner.x,l=n.zpp_inner;null!=l._validate&&l._validate();var p,h=n.zpp_inner.y,l=t.zpp_inner;null!=l._validate&&l._validate(),t.zpp_inner.x==i&&(null!=(l=t.zpp_inner)._validate&&l._validate(),t.zpp_inner.y==h)||(t.zpp_inner.x=i,t.zpp_inner.y=h,null!=(p=t.zpp_inner)._invalidate&&p._invalidate(p)),n.zpp_inner.weak&&(p=n.zpp_inner,n.zpp_inner.outer=null,n.zpp_inner=null,n.zpp_pool=Bn.poolVec2,Bn.poolVec2=n,null!=p.outer&&(p.outer.zpp_inner=null,p.outer=null),p._isimmutable=null,p._validate=null,p._invalidate=null,p.next=Gr.zpp_pool,Gr.zpp_pool=p),null==this.zpp_inner_zn.wrap_a2&&this.zpp_inner_zn.setup_a2(),this.zpp_inner.immutable_midstep("DistanceJoint::jointMin"),this.zpp_inner_zn.jointMin!=r&&(this.zpp_inner_zn.jointMin=r,this.zpp_inner.wake()),this.zpp_inner.immutable_midstep("DistanceJoint::jointMax"),this.zpp_inner_zn.jointMax!=o&&(this.zpp_inner_zn.jointMax=o,this.zpp_inner.wake())};S.__name__=["nape","constraint","DistanceJoint"],S.__super__=w,(S.prototype=Object.create(w.prototype)).zpp_inner_zn=null,S.prototype.get_body1=function(){return null==this.zpp_inner_zn.b1?null:this.zpp_inner_zn.b1.outer},S.prototype.set_body1=function(t){this.zpp_inner.immutable_midstep("Constraint::body1");t=null==t?null:t.zpp_inner;return t!=this.zpp_inner_zn.b1&&(null!=this.zpp_inner_zn.b1&&(null!=(null==this.zpp_inner.space?null:this.zpp_inner.space.outer)&&this.zpp_inner_zn.b2!=this.zpp_inner_zn.b1&&null!=this.zpp_inner_zn.b1&&this.zpp_inner_zn.b1.constraints.remove(this.zpp_inner),this.zpp_inner.active&&null!=(null==this.zpp_inner.space?null:this.zpp_inner.space.outer)&&this.zpp_inner_zn.b1.wake()),this.zpp_inner_zn.b1=t,null!=(null==this.zpp_inner.space?null:this.zpp_inner.space.outer)&&null!=t&&this.zpp_inner_zn.b2!=t&&null!=t&&t.constraints.add(this.zpp_inner),this.zpp_inner.active&&null!=(null==this.zpp_inner.space?null:this.zpp_inner.space.outer)&&(this.zpp_inner.wake(),null!=t&&t.wake())),null==this.zpp_inner_zn.b1?null:this.zpp_inner_zn.b1.outer},S.prototype.get_body2=function(){return null==this.zpp_inner_zn.b2?null:this.zpp_inner_zn.b2.outer},S.prototype.set_body2=function(t){this.zpp_inner.immutable_midstep("Constraint::body2");t=null==t?null:t.zpp_inner;return t!=this.zpp_inner_zn.b2&&(null!=this.zpp_inner_zn.b2&&(null!=(null==this.zpp_inner.space?null:this.zpp_inner.space.outer)&&this.zpp_inner_zn.b1!=this.zpp_inner_zn.b2&&null!=this.zpp_inner_zn.b2&&this.zpp_inner_zn.b2.constraints.remove(this.zpp_inner),this.zpp_inner.active&&null!=(null==this.zpp_inner.space?null:this.zpp_inner.space.outer)&&this.zpp_inner_zn.b2.wake()),this.zpp_inner_zn.b2=t,null!=(null==this.zpp_inner.space?null:this.zpp_inner.space.outer)&&null!=t&&this.zpp_inner_zn.b1!=t&&null!=t&&t.constraints.add(this.zpp_inner),this.zpp_inner.active&&null!=(null==this.zpp_inner.space?null:this.zpp_inner.space.outer)&&(this.zpp_inner.wake(),null!=t&&t.wake())),null==this.zpp_inner_zn.b2?null:this.zpp_inner_zn.b2.outer},S.prototype.get_anchor1=function(){return null==this.zpp_inner_zn.wrap_a1&&this.zpp_inner_zn.setup_a1(),this.zpp_inner_zn.wrap_a1},S.prototype.set_anchor1=function(t){null==this.zpp_inner_zn.wrap_a1&&this.zpp_inner_zn.setup_a1();var e=this.zpp_inner_zn.wrap_a1,i=t.zpp_inner;null!=i._validate&&i._validate();var n=t.zpp_inner.x,r=t.zpp_inner;null!=r._validate&&r._validate();var o,i=t.zpp_inner.y,r=e.zpp_inner;return null!=r._validate&&r._validate(),e.zpp_inner.x==n&&(null!=(r=e.zpp_inner)._validate&&r._validate(),e.zpp_inner.y==i)||(e.zpp_inner.x=n,e.zpp_inner.y=i,null!=(o=e.zpp_inner)._invalidate&&o._invalidate(o)),t.zpp_inner.weak&&(o=t.zpp_inner,t.zpp_inner.outer=null,t.zpp_inner=null,t.zpp_pool=Bn.poolVec2,Bn.poolVec2=t,null!=o.outer&&(o.outer.zpp_inner=null,o.outer=null),o._isimmutable=null,o._validate=null,o._invalidate=null,o.next=Gr.zpp_pool,Gr.zpp_pool=o),null==this.zpp_inner_zn.wrap_a1&&this.zpp_inner_zn.setup_a1(),this.zpp_inner_zn.wrap_a1},S.prototype.get_anchor2=function(){return null==this.zpp_inner_zn.wrap_a2&&this.zpp_inner_zn.setup_a2(),this.zpp_inner_zn.wrap_a2},S.prototype.set_anchor2=function(t){null==this.zpp_inner_zn.wrap_a2&&this.zpp_inner_zn.setup_a2();var e=this.zpp_inner_zn.wrap_a2,i=t.zpp_inner;null!=i._validate&&i._validate();var n=t.zpp_inner.x,r=t.zpp_inner;null!=r._validate&&r._validate();var o,i=t.zpp_inner.y,r=e.zpp_inner;return null!=r._validate&&r._validate(),e.zpp_inner.x==n&&(null!=(r=e.zpp_inner)._validate&&r._validate(),e.zpp_inner.y==i)||(e.zpp_inner.x=n,e.zpp_inner.y=i,null!=(o=e.zpp_inner)._invalidate&&o._invalidate(o)),t.zpp_inner.weak&&(o=t.zpp_inner,t.zpp_inner.outer=null,t.zpp_inner=null,t.zpp_pool=Bn.poolVec2,Bn.poolVec2=t,null!=o.outer&&(o.outer.zpp_inner=null,o.outer=null),o._isimmutable=null,o._validate=null,o._invalidate=null,o.next=Gr.zpp_pool,Gr.zpp_pool=o),null==this.zpp_inner_zn.wrap_a2&&this.zpp_inner_zn.setup_a2(),this.zpp_inner_zn.wrap_a2},S.prototype.get_jointMin=function(){return this.zpp_inner_zn.jointMin},S.prototype.set_jointMin=function(t){return this.zpp_inner.immutable_midstep("DistanceJoint::jointMin"),this.zpp_inner_zn.jointMin!=t&&(this.zpp_inner_zn.jointMin=t,this.zpp_inner.wake()),this.zpp_inner_zn.jointMin},S.prototype.get_jointMax=function(){return this.zpp_inner_zn.jointMax},S.prototype.set_jointMax=function(t){return this.zpp_inner.immutable_midstep("DistanceJoint::jointMax"),this.zpp_inner_zn.jointMax!=t&&(this.zpp_inner_zn.jointMax=t,this.zpp_inner.wake()),this.zpp_inner_zn.jointMax},S.prototype.isSlack=function(){return this.zpp_inner_zn.slack},S.prototype.impulse=function(){var t=new W(1,1);return t.zpp_inner.x[0*t.zpp_inner.n]=this.zpp_inner_zn.jAcc,t},S.prototype.bodyImpulse=function(t){return this.zpp_inner.active?this.zpp_inner_zn.bodyImpulse(t.zpp_inner):K.get()},S.prototype.visitBodies=function(t){null!=(null==this.zpp_inner_zn.b1?null:this.zpp_inner_zn.b1.outer)&&t(null==this.zpp_inner_zn.b1?null:this.zpp_inner_zn.b1.outer),null!=(null==this.zpp_inner_zn.b2?null:this.zpp_inner_zn.b2.outer)&&(null==this.zpp_inner_zn.b2?null:this.zpp_inner_zn.b2.outer)!=(null==this.zpp_inner_zn.b1?null:this.zpp_inner_zn.b1.outer)&&t(null==this.zpp_inner_zn.b2?null:this.zpp_inner_zn.b2.outer)},Object.defineProperty(S.prototype,"body1",{get:S.prototype.get_body1,set:S.prototype.set_body1}),Object.defineProperty(S.prototype,"body2",{get:S.prototype.get_body2,set:S.prototype.set_body2}),Object.defineProperty(S.prototype,"anchor1",{get:S.prototype.get_anchor1,set:S.prototype.set_anchor1}),Object.defineProperty(S.prototype,"anchor2",{get:S.prototype.get_anchor2,set:S.prototype.set_anchor2}),Object.defineProperty(S.prototype,"jointMin",{get:S.prototype.get_jointMin,set:S.prototype.set_jointMin}),Object.defineProperty(S.prototype,"jointMax",{get:S.prototype.get_jointMax,set:S.prototype.set_jointMax}),S.prototype.__class__=S;var C=nape.constraint.LineJoint=function(t,e,i,n,r,o,s){this.zpp_inner_zn=null,this.zpp_inner_zn=new Rt,this.zpp_inner=this.zpp_inner_zn,(this.zpp_inner.outer=this).zpp_inner_zn.outer_zn=this,w.call(this),this.zpp_inner.immutable_midstep("Constraint::body1");var a=null==t?null:t.zpp_inner;a!=this.zpp_inner_zn.b1&&(null!=this.zpp_inner_zn.b1&&(null!=(null==this.zpp_inner.space?null:this.zpp_inner.space.outer)&&this.zpp_inner_zn.b2!=this.zpp_inner_zn.b1&&null!=this.zpp_inner_zn.b1&&this.zpp_inner_zn.b1.constraints.remove(this.zpp_inner),this.zpp_inner.active&&null!=(null==this.zpp_inner.space?null:this.zpp_inner.space.outer)&&this.zpp_inner_zn.b1.wake()),this.zpp_inner_zn.b1=a,null!=(null==this.zpp_inner.space?null:this.zpp_inner.space.outer)&&null!=a&&this.zpp_inner_zn.b2!=a&&null!=a&&a.constraints.add(this.zpp_inner),this.zpp_inner.active&&null!=(null==this.zpp_inner.space?null:this.zpp_inner.space.outer)&&(this.zpp_inner.wake(),null!=a&&a.wake())),this.zpp_inner.immutable_midstep("Constraint::body2");var h=null==e?null:e.zpp_inner;h!=this.zpp_inner_zn.b2&&(null!=this.zpp_inner_zn.b2&&(null!=(null==this.zpp_inner.space?null:this.zpp_inner.space.outer)&&this.zpp_inner_zn.b1!=this.zpp_inner_zn.b2&&null!=this.zpp_inner_zn.b2&&this.zpp_inner_zn.b2.constraints.remove(this.zpp_inner),this.zpp_inner.active&&null!=(null==this.zpp_inner.space?null:this.zpp_inner.space.outer)&&this.zpp_inner_zn.b2.wake()),this.zpp_inner_zn.b2=h,null!=(null==this.zpp_inner.space?null:this.zpp_inner.space.outer)&&null!=h&&this.zpp_inner_zn.b1!=h&&null!=h&&h.constraints.add(this.zpp_inner),this.zpp_inner.active&&null!=(null==this.zpp_inner.space?null:this.zpp_inner.space.outer)&&(this.zpp_inner.wake(),null!=h&&h.wake())),null==this.zpp_inner_zn.wrap_a1&&this.zpp_inner_zn.setup_a1();t=this.zpp_inner_zn.wrap_a1,a=i.zpp_inner;null!=a._validate&&a._validate();e=i.zpp_inner.x,h=i.zpp_inner;null!=h._validate&&h._validate();var a=i.zpp_inner.y,h=t.zpp_inner;null!=h._validate&&h._validate(),t.zpp_inner.x==e&&(null!=(h=t.zpp_inner)._validate&&h._validate(),t.zpp_inner.y==a)||(t.zpp_inner.x=e,t.zpp_inner.y=a,null!=(l=t.zpp_inner)._invalidate&&l._invalidate(l)),i.zpp_inner.weak&&(p=i.zpp_inner,i.zpp_inner.outer=null,i.zpp_inner=null,i.zpp_pool=Bn.poolVec2,Bn.poolVec2=i,null!=p.outer&&(p.outer.zpp_inner=null,p.outer=null),p._isimmutable=null,p._validate=null,p._invalidate=null,p.next=Gr.zpp_pool,Gr.zpp_pool=p),null==this.zpp_inner_zn.wrap_a1&&this.zpp_inner_zn.setup_a1(),null==this.zpp_inner_zn.wrap_a2&&this.zpp_inner_zn.setup_a2();var t=this.zpp_inner_zn.wrap_a2,l=n.zpp_inner;null!=l._validate&&l._validate();var i=n.zpp_inner.x,p=n.zpp_inner;null!=p._validate&&p._validate();var l=n.zpp_inner.y,p=t.zpp_inner;null!=p._validate&&p._validate(),t.zpp_inner.x==i&&(null!=(p=t.zpp_inner)._validate&&p._validate(),t.zpp_inner.y==l)||(t.zpp_inner.x=i,t.zpp_inner.y=l,null!=(u=t.zpp_inner)._invalidate&&u._invalidate(u)),n.zpp_inner.weak&&(d=n.zpp_inner,n.zpp_inner.outer=null,n.zpp_inner=null,n.zpp_pool=Bn.poolVec2,Bn.poolVec2=n,null!=d.outer&&(d.outer.zpp_inner=null,d.outer=null),d._isimmutable=null,d._validate=null,d._invalidate=null,d.next=Gr.zpp_pool,Gr.zpp_pool=d),null==this.zpp_inner_zn.wrap_a2&&this.zpp_inner_zn.setup_a2(),null==this.zpp_inner_zn.wrap_n&&this.zpp_inner_zn.setup_n();var t=this.zpp_inner_zn.wrap_n,u=r.zpp_inner;null!=u._validate&&u._validate();var n=r.zpp_inner.x,d=r.zpp_inner;null!=d._validate&&d._validate();var c,u=r.zpp_inner.y,d=t.zpp_inner;null!=d._validate&&d._validate(),t.zpp_inner.x==n&&(null!=(d=t.zpp_inner)._validate&&d._validate(),t.zpp_inner.y==u)||(t.zpp_inner.x=n,t.zpp_inner.y=u,null!=(c=t.zpp_inner)._invalidate&&c._invalidate(c)),r.zpp_inner.weak&&(c=r.zpp_inner,r.zpp_inner.outer=null,r.zpp_inner=null,r.zpp_pool=Bn.poolVec2,Bn.poolVec2=r,null!=c.outer&&(c.outer.zpp_inner=null,c.outer=null),c._isimmutable=null,c._validate=null,c._invalidate=null,c.next=Gr.zpp_pool,Gr.zpp_pool=c),null==this.zpp_inner_zn.wrap_n&&this.zpp_inner_zn.setup_n(),this.zpp_inner.immutable_midstep("LineJoint::jointMin"),this.zpp_inner_zn.jointMin!=o&&(this.zpp_inner_zn.jointMin=o,this.zpp_inner.wake()),this.zpp_inner.immutable_midstep("LineJoint::jointMax"),this.zpp_inner_zn.jointMax!=s&&(this.zpp_inner_zn.jointMax=s,this.zpp_inner.wake())};C.__name__=["nape","constraint","LineJoint"],C.__super__=w,(C.prototype=Object.create(w.prototype)).zpp_inner_zn=null,C.prototype.get_body1=function(){return null==this.zpp_inner_zn.b1?null:this.zpp_inner_zn.b1.outer},C.prototype.set_body1=function(t){this.zpp_inner.immutable_midstep("Constraint::body1");t=null==t?null:t.zpp_inner;return t!=this.zpp_inner_zn.b1&&(null!=this.zpp_inner_zn.b1&&(null!=(null==this.zpp_inner.space?null:this.zpp_inner.space.outer)&&this.zpp_inner_zn.b2!=this.zpp_inner_zn.b1&&null!=this.zpp_inner_zn.b1&&this.zpp_inner_zn.b1.constraints.remove(this.zpp_inner),this.zpp_inner.active&&null!=(null==this.zpp_inner.space?null:this.zpp_inner.space.outer)&&this.zpp_inner_zn.b1.wake()),this.zpp_inner_zn.b1=t,null!=(null==this.zpp_inner.space?null:this.zpp_inner.space.outer)&&null!=t&&this.zpp_inner_zn.b2!=t&&null!=t&&t.constraints.add(this.zpp_inner),this.zpp_inner.active&&null!=(null==this.zpp_inner.space?null:this.zpp_inner.space.outer)&&(this.zpp_inner.wake(),null!=t&&t.wake())),null==this.zpp_inner_zn.b1?null:this.zpp_inner_zn.b1.outer},C.prototype.get_body2=function(){return null==this.zpp_inner_zn.b2?null:this.zpp_inner_zn.b2.outer},C.prototype.set_body2=function(t){this.zpp_inner.immutable_midstep("Constraint::body2");t=null==t?null:t.zpp_inner;return t!=this.zpp_inner_zn.b2&&(null!=this.zpp_inner_zn.b2&&(null!=(null==this.zpp_inner.space?null:this.zpp_inner.space.outer)&&this.zpp_inner_zn.b1!=this.zpp_inner_zn.b2&&null!=this.zpp_inner_zn.b2&&this.zpp_inner_zn.b2.constraints.remove(this.zpp_inner),this.zpp_inner.active&&null!=(null==this.zpp_inner.space?null:this.zpp_inner.space.outer)&&this.zpp_inner_zn.b2.wake()),this.zpp_inner_zn.b2=t,null!=(null==this.zpp_inner.space?null:this.zpp_inner.space.outer)&&null!=t&&this.zpp_inner_zn.b1!=t&&null!=t&&t.constraints.add(this.zpp_inner),this.zpp_inner.active&&null!=(null==this.zpp_inner.space?null:this.zpp_inner.space.outer)&&(this.zpp_inner.wake(),null!=t&&t.wake())),null==this.zpp_inner_zn.b2?null:this.zpp_inner_zn.b2.outer},C.prototype.get_anchor1=function(){return null==this.zpp_inner_zn.wrap_a1&&this.zpp_inner_zn.setup_a1(),this.zpp_inner_zn.wrap_a1},C.prototype.set_anchor1=function(t){null==this.zpp_inner_zn.wrap_a1&&this.zpp_inner_zn.setup_a1();var e=this.zpp_inner_zn.wrap_a1,i=t.zpp_inner;null!=i._validate&&i._validate();var n=t.zpp_inner.x,r=t.zpp_inner;null!=r._validate&&r._validate();var o,i=t.zpp_inner.y,r=e.zpp_inner;return null!=r._validate&&r._validate(),e.zpp_inner.x==n&&(null!=(r=e.zpp_inner)._validate&&r._validate(),e.zpp_inner.y==i)||(e.zpp_inner.x=n,e.zpp_inner.y=i,null!=(o=e.zpp_inner)._invalidate&&o._invalidate(o)),t.zpp_inner.weak&&(o=t.zpp_inner,t.zpp_inner.outer=null,t.zpp_inner=null,t.zpp_pool=Bn.poolVec2,Bn.poolVec2=t,null!=o.outer&&(o.outer.zpp_inner=null,o.outer=null),o._isimmutable=null,o._validate=null,o._invalidate=null,o.next=Gr.zpp_pool,Gr.zpp_pool=o),null==this.zpp_inner_zn.wrap_a1&&this.zpp_inner_zn.setup_a1(),this.zpp_inner_zn.wrap_a1},C.prototype.get_anchor2=function(){return null==this.zpp_inner_zn.wrap_a2&&this.zpp_inner_zn.setup_a2(),this.zpp_inner_zn.wrap_a2},C.prototype.set_anchor2=function(t){null==this.zpp_inner_zn.wrap_a2&&this.zpp_inner_zn.setup_a2();var e=this.zpp_inner_zn.wrap_a2,i=t.zpp_inner;null!=i._validate&&i._validate();var n=t.zpp_inner.x,r=t.zpp_inner;null!=r._validate&&r._validate();var o,i=t.zpp_inner.y,r=e.zpp_inner;return null!=r._validate&&r._validate(),e.zpp_inner.x==n&&(null!=(r=e.zpp_inner)._validate&&r._validate(),e.zpp_inner.y==i)||(e.zpp_inner.x=n,e.zpp_inner.y=i,null!=(o=e.zpp_inner)._invalidate&&o._invalidate(o)),t.zpp_inner.weak&&(o=t.zpp_inner,t.zpp_inner.outer=null,t.zpp_inner=null,t.zpp_pool=Bn.poolVec2,Bn.poolVec2=t,null!=o.outer&&(o.outer.zpp_inner=null,o.outer=null),o._isimmutable=null,o._validate=null,o._invalidate=null,o.next=Gr.zpp_pool,Gr.zpp_pool=o),null==this.zpp_inner_zn.wrap_a2&&this.zpp_inner_zn.setup_a2(),this.zpp_inner_zn.wrap_a2},C.prototype.get_direction=function(){return null==this.zpp_inner_zn.wrap_n&&this.zpp_inner_zn.setup_n(),this.zpp_inner_zn.wrap_n},C.prototype.set_direction=function(t){null==this.zpp_inner_zn.wrap_n&&this.zpp_inner_zn.setup_n();var e=this.zpp_inner_zn.wrap_n,i=t.zpp_inner;null!=i._validate&&i._validate();var n=t.zpp_inner.x,r=t.zpp_inner;null!=r._validate&&r._validate();var o,i=t.zpp_inner.y,r=e.zpp_inner;return null!=r._validate&&r._validate(),e.zpp_inner.x==n&&(null!=(r=e.zpp_inner)._validate&&r._validate(),e.zpp_inner.y==i)||(e.zpp_inner.x=n,e.zpp_inner.y=i,null!=(o=e.zpp_inner)._invalidate&&o._invalidate(o)),t.zpp_inner.weak&&(o=t.zpp_inner,t.zpp_inner.outer=null,t.zpp_inner=null,t.zpp_pool=Bn.poolVec2,Bn.poolVec2=t,null!=o.outer&&(o.outer.zpp_inner=null,o.outer=null),o._isimmutable=null,o._validate=null,o._invalidate=null,o.next=Gr.zpp_pool,Gr.zpp_pool=o),null==this.zpp_inner_zn.wrap_n&&this.zpp_inner_zn.setup_n(),this.zpp_inner_zn.wrap_n},C.prototype.get_jointMin=function(){return this.zpp_inner_zn.jointMin},C.prototype.set_jointMin=function(t){return this.zpp_inner.immutable_midstep("LineJoint::jointMin"),this.zpp_inner_zn.jointMin!=t&&(this.zpp_inner_zn.jointMin=t,this.zpp_inner.wake()),this.zpp_inner_zn.jointMin},C.prototype.get_jointMax=function(){return this.zpp_inner_zn.jointMax},C.prototype.set_jointMax=function(t){return this.zpp_inner.immutable_midstep("LineJoint::jointMax"),this.zpp_inner_zn.jointMax!=t&&(this.zpp_inner_zn.jointMax=t,this.zpp_inner.wake()),this.zpp_inner_zn.jointMax},C.prototype.impulse=function(){var t=new W(2,1);return t.zpp_inner.x[0*t.zpp_inner.n]=this.zpp_inner_zn.jAccx,t.zpp_inner.x[t.zpp_inner.n]=this.zpp_inner_zn.jAccy,t},C.prototype.bodyImpulse=function(t){return this.zpp_inner.active?this.zpp_inner_zn.bodyImpulse(t.zpp_inner):K.get()},C.prototype.visitBodies=function(t){null!=(null==this.zpp_inner_zn.b1?null:this.zpp_inner_zn.b1.outer)&&t(null==this.zpp_inner_zn.b1?null:this.zpp_inner_zn.b1.outer),null!=(null==this.zpp_inner_zn.b2?null:this.zpp_inner_zn.b2.outer)&&(null==this.zpp_inner_zn.b2?null:this.zpp_inner_zn.b2.outer)!=(null==this.zpp_inner_zn.b1?null:this.zpp_inner_zn.b1.outer)&&t(null==this.zpp_inner_zn.b2?null:this.zpp_inner_zn.b2.outer)},Object.defineProperty(C.prototype,"body1",{get:C.prototype.get_body1,set:C.prototype.set_body1}),Object.defineProperty(C.prototype,"body2",{get:C.prototype.get_body2,set:C.prototype.set_body2}),Object.defineProperty(C.prototype,"anchor1",{get:C.prototype.get_anchor1,set:C.prototype.set_anchor1}),Object.defineProperty(C.prototype,"anchor2",{get:C.prototype.get_anchor2,set:C.prototype.set_anchor2}),Object.defineProperty(C.prototype,"direction",{get:C.prototype.get_direction,set:C.prototype.set_direction}),Object.defineProperty(C.prototype,"jointMin",{get:C.prototype.get_jointMin,set:C.prototype.set_jointMin}),Object.defineProperty(C.prototype,"jointMax",{get:C.prototype.get_jointMax,set:C.prototype.set_jointMax}),C.prototype.__class__=C;var P=nape.constraint.MotorJoint=function(t,e,i,n){null==n&&(n=1),null==i&&(i=0),this.zpp_inner_zn=null,this.zpp_inner_zn=new Ft,this.zpp_inner=this.zpp_inner_zn,(this.zpp_inner.outer=this).zpp_inner_zn.outer_zn=this,w.call(this),this.zpp_inner.immutable_midstep("Constraint::body1");t=null==t?null:t.zpp_inner;t!=this.zpp_inner_zn.b1&&(null!=this.zpp_inner_zn.b1&&(null!=(null==this.zpp_inner.space?null:this.zpp_inner.space.outer)&&this.zpp_inner_zn.b2!=this.zpp_inner_zn.b1&&null!=this.zpp_inner_zn.b1&&this.zpp_inner_zn.b1.constraints.remove(this.zpp_inner),this.zpp_inner.active&&null!=(null==this.zpp_inner.space?null:this.zpp_inner.space.outer)&&this.zpp_inner_zn.b1.wake()),this.zpp_inner_zn.b1=t,null!=(null==this.zpp_inner.space?null:this.zpp_inner.space.outer)&&null!=t&&this.zpp_inner_zn.b2!=t&&null!=t&&t.constraints.add(this.zpp_inner),this.zpp_inner.active&&null!=(null==this.zpp_inner.space?null:this.zpp_inner.space.outer)&&(this.zpp_inner.wake(),null!=t&&t.wake())),this.zpp_inner.immutable_midstep("Constraint::body2");e=null==e?null:e.zpp_inner;e!=this.zpp_inner_zn.b2&&(null!=this.zpp_inner_zn.b2&&(null!=(null==this.zpp_inner.space?null:this.zpp_inner.space.outer)&&this.zpp_inner_zn.b1!=this.zpp_inner_zn.b2&&null!=this.zpp_inner_zn.b2&&this.zpp_inner_zn.b2.constraints.remove(this.zpp_inner),this.zpp_inner.active&&null!=(null==this.zpp_inner.space?null:this.zpp_inner.space.outer)&&this.zpp_inner_zn.b2.wake()),this.zpp_inner_zn.b2=e,null!=(null==this.zpp_inner.space?null:this.zpp_inner.space.outer)&&null!=e&&this.zpp_inner_zn.b1!=e&&null!=e&&e.constraints.add(this.zpp_inner),this.zpp_inner.active&&null!=(null==this.zpp_inner.space?null:this.zpp_inner.space.outer)&&(this.zpp_inner.wake(),null!=e&&e.wake())),this.zpp_inner.immutable_midstep("MotorJoint::rate"),this.zpp_inner_zn.rate!=i&&(this.zpp_inner_zn.rate=i,this.zpp_inner.wake()),this.zpp_inner.immutable_midstep("MotorJoint::ratio"),this.zpp_inner_zn.ratio!=n&&(this.zpp_inner_zn.ratio=n,this.zpp_inner.wake())};P.__name__=["nape","constraint","MotorJoint"],P.__super__=w,(P.prototype=Object.create(w.prototype)).zpp_inner_zn=null,P.prototype.get_body1=function(){return null==this.zpp_inner_zn.b1?null:this.zpp_inner_zn.b1.outer},P.prototype.set_body1=function(t){this.zpp_inner.immutable_midstep("Constraint::body1");t=null==t?null:t.zpp_inner;return t!=this.zpp_inner_zn.b1&&(null!=this.zpp_inner_zn.b1&&(null!=(null==this.zpp_inner.space?null:this.zpp_inner.space.outer)&&this.zpp_inner_zn.b2!=this.zpp_inner_zn.b1&&null!=this.zpp_inner_zn.b1&&this.zpp_inner_zn.b1.constraints.remove(this.zpp_inner),this.zpp_inner.active&&null!=(null==this.zpp_inner.space?null:this.zpp_inner.space.outer)&&this.zpp_inner_zn.b1.wake()),this.zpp_inner_zn.b1=t,null!=(null==this.zpp_inner.space?null:this.zpp_inner.space.outer)&&null!=t&&this.zpp_inner_zn.b2!=t&&null!=t&&t.constraints.add(this.zpp_inner),this.zpp_inner.active&&null!=(null==this.zpp_inner.space?null:this.zpp_inner.space.outer)&&(this.zpp_inner.wake(),null!=t&&t.wake())),null==this.zpp_inner_zn.b1?null:this.zpp_inner_zn.b1.outer},P.prototype.get_body2=function(){return null==this.zpp_inner_zn.b2?null:this.zpp_inner_zn.b2.outer},P.prototype.set_body2=function(t){this.zpp_inner.immutable_midstep("Constraint::body2");t=null==t?null:t.zpp_inner;return t!=this.zpp_inner_zn.b2&&(null!=this.zpp_inner_zn.b2&&(null!=(null==this.zpp_inner.space?null:this.zpp_inner.space.outer)&&this.zpp_inner_zn.b1!=this.zpp_inner_zn.b2&&null!=this.zpp_inner_zn.b2&&this.zpp_inner_zn.b2.constraints.remove(this.zpp_inner),this.zpp_inner.active&&null!=(null==this.zpp_inner.space?null:this.zpp_inner.space.outer)&&this.zpp_inner_zn.b2.wake()),this.zpp_inner_zn.b2=t,null!=(null==this.zpp_inner.space?null:this.zpp_inner.space.outer)&&null!=t&&this.zpp_inner_zn.b1!=t&&null!=t&&t.constraints.add(this.zpp_inner),this.zpp_inner.active&&null!=(null==this.zpp_inner.space?null:this.zpp_inner.space.outer)&&(this.zpp_inner.wake(),null!=t&&t.wake())),null==this.zpp_inner_zn.b2?null:this.zpp_inner_zn.b2.outer},P.prototype.get_ratio=function(){return this.zpp_inner_zn.ratio},P.prototype.set_ratio=function(t){return this.zpp_inner.immutable_midstep("MotorJoint::ratio"),this.zpp_inner_zn.ratio!=t&&(this.zpp_inner_zn.ratio=t,this.zpp_inner.wake()),this.zpp_inner_zn.ratio},P.prototype.get_rate=function(){return this.zpp_inner_zn.rate},P.prototype.set_rate=function(t){return this.zpp_inner.immutable_midstep("MotorJoint::rate"),this.zpp_inner_zn.rate!=t&&(this.zpp_inner_zn.rate=t,this.zpp_inner.wake()),this.zpp_inner_zn.rate},P.prototype.impulse=function(){var t=new W(1,1);return t.zpp_inner.x[0*t.zpp_inner.n]=this.zpp_inner_zn.jAcc,t},P.prototype.bodyImpulse=function(t){return this.zpp_inner.active?this.zpp_inner_zn.bodyImpulse(t.zpp_inner):K.get()},P.prototype.visitBodies=function(t){null!=(null==this.zpp_inner_zn.b1?null:this.zpp_inner_zn.b1.outer)&&t(null==this.zpp_inner_zn.b1?null:this.zpp_inner_zn.b1.outer),null!=(null==this.zpp_inner_zn.b2?null:this.zpp_inner_zn.b2.outer)&&(null==this.zpp_inner_zn.b2?null:this.zpp_inner_zn.b2.outer)!=(null==this.zpp_inner_zn.b1?null:this.zpp_inner_zn.b1.outer)&&t(null==this.zpp_inner_zn.b2?null:this.zpp_inner_zn.b2.outer)},Object.defineProperty(P.prototype,"body1",{get:P.prototype.get_body1,set:P.prototype.set_body1}),Object.defineProperty(P.prototype,"body2",{get:P.prototype.get_body2,set:P.prototype.set_body2}),Object.defineProperty(P.prototype,"ratio",{get:P.prototype.get_ratio,set:P.prototype.set_ratio}),Object.defineProperty(P.prototype,"rate",{get:P.prototype.get_rate,set:P.prototype.set_rate}),P.prototype.__class__=P;var M=nape.constraint.PivotJoint=function(t,e,i,n){this.zpp_inner_zn=null,this.zpp_inner_zn=new Nt,this.zpp_inner=this.zpp_inner_zn,(this.zpp_inner.outer=this).zpp_inner_zn.outer_zn=this,w.call(this),this.zpp_inner.immutable_midstep("Constraint::body1");var r=null==t?null:t.zpp_inner;r!=this.zpp_inner_zn.b1&&(null!=this.zpp_inner_zn.b1&&(null!=(null==this.zpp_inner.space?null:this.zpp_inner.space.outer)&&this.zpp_inner_zn.b2!=this.zpp_inner_zn.b1&&null!=this.zpp_inner_zn.b1&&this.zpp_inner_zn.b1.constraints.remove(this.zpp_inner),this.zpp_inner.active&&null!=(null==this.zpp_inner.space?null:this.zpp_inner.space.outer)&&this.zpp_inner_zn.b1.wake()),this.zpp_inner_zn.b1=r,null!=(null==this.zpp_inner.space?null:this.zpp_inner.space.outer)&&null!=r&&this.zpp_inner_zn.b2!=r&&null!=r&&r.constraints.add(this.zpp_inner),this.zpp_inner.active&&null!=(null==this.zpp_inner.space?null:this.zpp_inner.space.outer)&&(this.zpp_inner.wake(),null!=r&&r.wake())),this.zpp_inner.immutable_midstep("Constraint::body2");var o=null==e?null:e.zpp_inner;o!=this.zpp_inner_zn.b2&&(null!=this.zpp_inner_zn.b2&&(null!=(null==this.zpp_inner.space?null:this.zpp_inner.space.outer)&&this.zpp_inner_zn.b1!=this.zpp_inner_zn.b2&&null!=this.zpp_inner_zn.b2&&this.zpp_inner_zn.b2.constraints.remove(this.zpp_inner),this.zpp_inner.active&&null!=(null==this.zpp_inner.space?null:this.zpp_inner.space.outer)&&this.zpp_inner_zn.b2.wake()),this.zpp_inner_zn.b2=o,null!=(null==this.zpp_inner.space?null:this.zpp_inner.space.outer)&&null!=o&&this.zpp_inner_zn.b1!=o&&null!=o&&o.constraints.add(this.zpp_inner),this.zpp_inner.active&&null!=(null==this.zpp_inner.space?null:this.zpp_inner.space.outer)&&(this.zpp_inner.wake(),null!=o&&o.wake())),null==this.zpp_inner_zn.wrap_a1&&this.zpp_inner_zn.setup_a1();t=this.zpp_inner_zn.wrap_a1,r=i.zpp_inner;null!=r._validate&&r._validate();e=i.zpp_inner.x,o=i.zpp_inner;null!=o._validate&&o._validate();var r=i.zpp_inner.y,o=t.zpp_inner;null!=o._validate&&o._validate(),t.zpp_inner.x==e&&(null!=(o=t.zpp_inner)._validate&&o._validate(),t.zpp_inner.y==r)||(t.zpp_inner.x=e,t.zpp_inner.y=r,null!=(s=t.zpp_inner)._invalidate&&s._invalidate(s)),i.zpp_inner.weak&&(a=i.zpp_inner,i.zpp_inner.outer=null,i.zpp_inner=null,i.zpp_pool=Bn.poolVec2,Bn.poolVec2=i,null!=a.outer&&(a.outer.zpp_inner=null,a.outer=null),a._isimmutable=null,a._validate=null,a._invalidate=null,a.next=Gr.zpp_pool,Gr.zpp_pool=a),null==this.zpp_inner_zn.wrap_a1&&this.zpp_inner_zn.setup_a1(),null==this.zpp_inner_zn.wrap_a2&&this.zpp_inner_zn.setup_a2();var t=this.zpp_inner_zn.wrap_a2,s=n.zpp_inner;null!=s._validate&&s._validate();var i=n.zpp_inner.x,a=n.zpp_inner;null!=a._validate&&a._validate();var h,s=n.zpp_inner.y,a=t.zpp_inner;null!=a._validate&&a._validate(),t.zpp_inner.x==i&&(null!=(a=t.zpp_inner)._validate&&a._validate(),t.zpp_inner.y==s)||(t.zpp_inner.x=i,t.zpp_inner.y=s,null!=(h=t.zpp_inner)._invalidate&&h._invalidate(h)),n.zpp_inner.weak&&(h=n.zpp_inner,n.zpp_inner.outer=null,n.zpp_inner=null,n.zpp_pool=Bn.poolVec2,Bn.poolVec2=n,null!=h.outer&&(h.outer.zpp_inner=null,h.outer=null),h._isimmutable=null,h._validate=null,h._invalidate=null,h.next=Gr.zpp_pool,Gr.zpp_pool=h),null==this.zpp_inner_zn.wrap_a2&&this.zpp_inner_zn.setup_a2()};M.__name__=["nape","constraint","PivotJoint"],M.__super__=w,(M.prototype=Object.create(w.prototype)).zpp_inner_zn=null,M.prototype.get_body1=function(){return null==this.zpp_inner_zn.b1?null:this.zpp_inner_zn.b1.outer},M.prototype.set_body1=function(t){this.zpp_inner.immutable_midstep("Constraint::body1");t=null==t?null:t.zpp_inner;return t!=this.zpp_inner_zn.b1&&(null!=this.zpp_inner_zn.b1&&(null!=(null==this.zpp_inner.space?null:this.zpp_inner.space.outer)&&this.zpp_inner_zn.b2!=this.zpp_inner_zn.b1&&null!=this.zpp_inner_zn.b1&&this.zpp_inner_zn.b1.constraints.remove(this.zpp_inner),this.zpp_inner.active&&null!=(null==this.zpp_inner.space?null:this.zpp_inner.space.outer)&&this.zpp_inner_zn.b1.wake()),this.zpp_inner_zn.b1=t,null!=(null==this.zpp_inner.space?null:this.zpp_inner.space.outer)&&null!=t&&this.zpp_inner_zn.b2!=t&&null!=t&&t.constraints.add(this.zpp_inner),this.zpp_inner.active&&null!=(null==this.zpp_inner.space?null:this.zpp_inner.space.outer)&&(this.zpp_inner.wake(),null!=t&&t.wake())),null==this.zpp_inner_zn.b1?null:this.zpp_inner_zn.b1.outer},M.prototype.get_body2=function(){return null==this.zpp_inner_zn.b2?null:this.zpp_inner_zn.b2.outer},M.prototype.set_body2=function(t){this.zpp_inner.immutable_midstep("Constraint::body2");t=null==t?null:t.zpp_inner;return t!=this.zpp_inner_zn.b2&&(null!=this.zpp_inner_zn.b2&&(null!=(null==this.zpp_inner.space?null:this.zpp_inner.space.outer)&&this.zpp_inner_zn.b1!=this.zpp_inner_zn.b2&&null!=this.zpp_inner_zn.b2&&this.zpp_inner_zn.b2.constraints.remove(this.zpp_inner),this.zpp_inner.active&&null!=(null==this.zpp_inner.space?null:this.zpp_inner.space.outer)&&this.zpp_inner_zn.b2.wake()),this.zpp_inner_zn.b2=t,null!=(null==this.zpp_inner.space?null:this.zpp_inner.space.outer)&&null!=t&&this.zpp_inner_zn.b1!=t&&null!=t&&t.constraints.add(this.zpp_inner),this.zpp_inner.active&&null!=(null==this.zpp_inner.space?null:this.zpp_inner.space.outer)&&(this.zpp_inner.wake(),null!=t&&t.wake())),null==this.zpp_inner_zn.b2?null:this.zpp_inner_zn.b2.outer},M.prototype.get_anchor1=function(){return null==this.zpp_inner_zn.wrap_a1&&this.zpp_inner_zn.setup_a1(),this.zpp_inner_zn.wrap_a1},M.prototype.set_anchor1=function(t){null==this.zpp_inner_zn.wrap_a1&&this.zpp_inner_zn.setup_a1();var e=this.zpp_inner_zn.wrap_a1,i=t.zpp_inner;null!=i._validate&&i._validate();var n=t.zpp_inner.x,r=t.zpp_inner;null!=r._validate&&r._validate();var o,i=t.zpp_inner.y,r=e.zpp_inner;return null!=r._validate&&r._validate(),e.zpp_inner.x==n&&(null!=(r=e.zpp_inner)._validate&&r._validate(),e.zpp_inner.y==i)||(e.zpp_inner.x=n,e.zpp_inner.y=i,null!=(o=e.zpp_inner)._invalidate&&o._invalidate(o)),t.zpp_inner.weak&&(o=t.zpp_inner,t.zpp_inner.outer=null,t.zpp_inner=null,t.zpp_pool=Bn.poolVec2,Bn.poolVec2=t,null!=o.outer&&(o.outer.zpp_inner=null,o.outer=null),o._isimmutable=null,o._validate=null,o._invalidate=null,o.next=Gr.zpp_pool,Gr.zpp_pool=o),null==this.zpp_inner_zn.wrap_a1&&this.zpp_inner_zn.setup_a1(),this.zpp_inner_zn.wrap_a1},M.prototype.get_anchor2=function(){return null==this.zpp_inner_zn.wrap_a2&&this.zpp_inner_zn.setup_a2(),this.zpp_inner_zn.wrap_a2},M.prototype.set_anchor2=function(t){null==this.zpp_inner_zn.wrap_a2&&this.zpp_inner_zn.setup_a2();var e=this.zpp_inner_zn.wrap_a2,i=t.zpp_inner;null!=i._validate&&i._validate();var n=t.zpp_inner.x,r=t.zpp_inner;null!=r._validate&&r._validate();var o,i=t.zpp_inner.y,r=e.zpp_inner;return null!=r._validate&&r._validate(),e.zpp_inner.x==n&&(null!=(r=e.zpp_inner)._validate&&r._validate(),e.zpp_inner.y==i)||(e.zpp_inner.x=n,e.zpp_inner.y=i,null!=(o=e.zpp_inner)._invalidate&&o._invalidate(o)),t.zpp_inner.weak&&(o=t.zpp_inner,t.zpp_inner.outer=null,t.zpp_inner=null,t.zpp_pool=Bn.poolVec2,Bn.poolVec2=t,null!=o.outer&&(o.outer.zpp_inner=null,o.outer=null),o._isimmutable=null,o._validate=null,o._invalidate=null,o.next=Gr.zpp_pool,Gr.zpp_pool=o),null==this.zpp_inner_zn.wrap_a2&&this.zpp_inner_zn.setup_a2(),this.zpp_inner_zn.wrap_a2},M.prototype.impulse=function(){var t=new W(2,1);return t.zpp_inner.x[0*t.zpp_inner.n]=this.zpp_inner_zn.jAccx,t.zpp_inner.x[t.zpp_inner.n]=this.zpp_inner_zn.jAccy,t},M.prototype.bodyImpulse=function(t){return this.zpp_inner.active?this.zpp_inner_zn.bodyImpulse(t.zpp_inner):K.get()},M.prototype.visitBodies=function(t){null!=(null==this.zpp_inner_zn.b1?null:this.zpp_inner_zn.b1.outer)&&t(null==this.zpp_inner_zn.b1?null:this.zpp_inner_zn.b1.outer),null!=(null==this.zpp_inner_zn.b2?null:this.zpp_inner_zn.b2.outer)&&(null==this.zpp_inner_zn.b2?null:this.zpp_inner_zn.b2.outer)!=(null==this.zpp_inner_zn.b1?null:this.zpp_inner_zn.b1.outer)&&t(null==this.zpp_inner_zn.b2?null:this.zpp_inner_zn.b2.outer)},Object.defineProperty(M.prototype,"body1",{get:M.prototype.get_body1,set:M.prototype.set_body1}),Object.defineProperty(M.prototype,"body2",{get:M.prototype.get_body2,set:M.prototype.set_body2}),Object.defineProperty(M.prototype,"anchor1",{get:M.prototype.get_anchor1,set:M.prototype.set_anchor1}),Object.defineProperty(M.prototype,"anchor2",{get:M.prototype.get_anchor2,set:M.prototype.set_anchor2}),M.prototype.__class__=M;var T=nape.constraint.PulleyJoint=function(t,e,i,n,r,o,s,a,h,l,p){null==p&&(p=1),this.zpp_inner_zn=null,this.zpp_inner_zn=new jt,this.zpp_inner=this.zpp_inner_zn,(this.zpp_inner.outer=this).zpp_inner_zn.outer_zn=this,w.call(this),this.zpp_inner.immutable_midstep("Constraint::body1");t=null==t?null:t.zpp_inner;t!=this.zpp_inner_zn.b1&&(null!=this.zpp_inner_zn.b1&&(null!=(null==this.zpp_inner.space?null:this.zpp_inner.space.outer)&&this.zpp_inner_zn.b2!=this.zpp_inner_zn.b1&&this.zpp_inner_zn.b3!=this.zpp_inner_zn.b1&&this.zpp_inner_zn.b4!=this.zpp_inner_zn.b1&&null!=this.zpp_inner_zn.b1&&this.zpp_inner_zn.b1.constraints.remove(this.zpp_inner),this.zpp_inner.active&&null!=(null==this.zpp_inner.space?null:this.zpp_inner.space.outer)&&this.zpp_inner_zn.b1.wake()),this.zpp_inner_zn.b1=t,null!=(null==this.zpp_inner.space?null:this.zpp_inner.space.outer)&&null!=t&&this.zpp_inner_zn.b2!=t&&this.zpp_inner_zn.b3!=t&&this.zpp_inner_zn.b4!=t&&null!=t&&t.constraints.add(this.zpp_inner),this.zpp_inner.active&&null!=(null==this.zpp_inner.space?null:this.zpp_inner.space.outer)&&(this.zpp_inner.wake(),null!=t&&t.wake())),this.zpp_inner.immutable_midstep("Constraint::body2");t=null==e?null:e.zpp_inner;t!=this.zpp_inner_zn.b2&&(null!=this.zpp_inner_zn.b2&&(null!=(null==this.zpp_inner.space?null:this.zpp_inner.space.outer)&&this.zpp_inner_zn.b1!=this.zpp_inner_zn.b2&&this.zpp_inner_zn.b3!=this.zpp_inner_zn.b2&&this.zpp_inner_zn.b4!=this.zpp_inner_zn.b2&&null!=this.zpp_inner_zn.b2&&this.zpp_inner_zn.b2.constraints.remove(this.zpp_inner),this.zpp_inner.active&&null!=(null==this.zpp_inner.space?null:this.zpp_inner.space.outer)&&this.zpp_inner_zn.b2.wake()),this.zpp_inner_zn.b2=t,null!=(null==this.zpp_inner.space?null:this.zpp_inner.space.outer)&&null!=t&&this.zpp_inner_zn.b1!=t&&this.zpp_inner_zn.b3!=t&&this.zpp_inner_zn.b4!=t&&null!=t&&t.constraints.add(this.zpp_inner),this.zpp_inner.active&&null!=(null==this.zpp_inner.space?null:this.zpp_inner.space.outer)&&(this.zpp_inner.wake(),null!=t&&t.wake())),this.zpp_inner.immutable_midstep("Constraint::body3");e=null==i?null:i.zpp_inner;e!=this.zpp_inner_zn.b3&&(null!=this.zpp_inner_zn.b3&&(null!=(null==this.zpp_inner.space?null:this.zpp_inner.space.outer)&&this.zpp_inner_zn.b1!=this.zpp_inner_zn.b3&&this.zpp_inner_zn.b2!=this.zpp_inner_zn.b3&&this.zpp_inner_zn.b4!=this.zpp_inner_zn.b3&&null!=this.zpp_inner_zn.b3&&this.zpp_inner_zn.b3.constraints.remove(this.zpp_inner),this.zpp_inner.active&&null!=(null==this.zpp_inner.space?null:this.zpp_inner.space.outer)&&this.zpp_inner_zn.b3.wake()),this.zpp_inner_zn.b3=e,null!=(null==this.zpp_inner.space?null:this.zpp_inner.space.outer)&&null!=e&&this.zpp_inner_zn.b1!=e&&this.zpp_inner_zn.b2!=e&&this.zpp_inner_zn.b4!=e&&null!=e&&e.constraints.add(this.zpp_inner),this.zpp_inner.active&&null!=(null==this.zpp_inner.space?null:this.zpp_inner.space.outer)&&(this.zpp_inner.wake(),null!=e&&e.wake())),this.zpp_inner.immutable_midstep("Constraint::body4");t=null==n?null:n.zpp_inner;t!=this.zpp_inner_zn.b4&&(null!=this.zpp_inner_zn.b4&&(null!=(null==this.zpp_inner.space?null:this.zpp_inner.space.outer)&&this.zpp_inner_zn.b1!=this.zpp_inner_zn.b4&&this.zpp_inner_zn.b2!=this.zpp_inner_zn.b4&&this.zpp_inner_zn.b3!=this.zpp_inner_zn.b4&&null!=this.zpp_inner_zn.b4&&this.zpp_inner_zn.b4.constraints.remove(this.zpp_inner),this.zpp_inner.active&&null!=(null==this.zpp_inner.space?null:this.zpp_inner.space.outer)&&this.zpp_inner_zn.b4.wake()),this.zpp_inner_zn.b4=t,null!=(null==this.zpp_inner.space?null:this.zpp_inner.space.outer)&&null!=t&&this.zpp_inner_zn.b1!=t&&this.zpp_inner_zn.b2!=t&&this.zpp_inner_zn.b3!=t&&null!=t&&t.constraints.add(this.zpp_inner),this.zpp_inner.active&&null!=(null==this.zpp_inner.space?null:this.zpp_inner.space.outer)&&(this.zpp_inner.wake(),null!=t&&t.wake())),null==this.zpp_inner_zn.wrap_a1&&this.zpp_inner_zn.setup_a1();i=this.zpp_inner_zn.wrap_a1,e=r.zpp_inner;null!=e._validate&&e._validate();n=r.zpp_inner.x,t=r.zpp_inner;null!=t._validate&&t._validate();var e=r.zpp_inner.y,t=i.zpp_inner;null!=t._validate&&t._validate(),i.zpp_inner.x==n&&(null!=(t=i.zpp_inner)._validate&&t._validate(),i.zpp_inner.y==e)||(i.zpp_inner.x=n,i.zpp_inner.y=e,null!=(u=i.zpp_inner)._invalidate&&u._invalidate(u)),r.zpp_inner.weak&&(d=r.zpp_inner,r.zpp_inner.outer=null,r.zpp_inner=null,r.zpp_pool=Bn.poolVec2,Bn.poolVec2=r,null!=d.outer&&(d.outer.zpp_inner=null,d.outer=null),d._isimmutable=null,d._validate=null,d._invalidate=null,d.next=Gr.zpp_pool,Gr.zpp_pool=d),null==this.zpp_inner_zn.wrap_a1&&this.zpp_inner_zn.setup_a1(),null==this.zpp_inner_zn.wrap_a2&&this.zpp_inner_zn.setup_a2();var i=this.zpp_inner_zn.wrap_a2,u=o.zpp_inner;null!=u._validate&&u._validate();var r=o.zpp_inner.x,d=o.zpp_inner;null!=d._validate&&d._validate();var u=o.zpp_inner.y,d=i.zpp_inner;null!=d._validate&&d._validate(),i.zpp_inner.x==r&&(null!=(d=i.zpp_inner)._validate&&d._validate(),i.zpp_inner.y==u)||(i.zpp_inner.x=r,i.zpp_inner.y=u,null!=(c=i.zpp_inner)._invalidate&&c._invalidate(c)),o.zpp_inner.weak&&(y=o.zpp_inner,o.zpp_inner.outer=null,o.zpp_inner=null,o.zpp_pool=Bn.poolVec2,Bn.poolVec2=o,null!=y.outer&&(y.outer.zpp_inner=null,y.outer=null),y._isimmutable=null,y._validate=null,y._invalidate=null,y.next=Gr.zpp_pool,Gr.zpp_pool=y),null==this.zpp_inner_zn.wrap_a2&&this.zpp_inner_zn.setup_a2(),null==this.zpp_inner_zn.wrap_a3&&this.zpp_inner_zn.setup_a3();var i=this.zpp_inner_zn.wrap_a3,c=s.zpp_inner;null!=c._validate&&c._validate();var o=s.zpp_inner.x,y=s.zpp_inner;null!=y._validate&&y._validate();var c=s.zpp_inner.y,y=i.zpp_inner;null!=y._validate&&y._validate(),i.zpp_inner.x==o&&(null!=(y=i.zpp_inner)._validate&&y._validate(),i.zpp_inner.y==c)||(i.zpp_inner.x=o,i.zpp_inner.y=c,null!=(_=i.zpp_inner)._invalidate&&_._invalidate(_)),s.zpp_inner.weak&&(m=s.zpp_inner,s.zpp_inner.outer=null,s.zpp_inner=null,s.zpp_pool=Bn.poolVec2,Bn.poolVec2=s,null!=m.outer&&(m.outer.zpp_inner=null,m.outer=null),m._isimmutable=null,m._validate=null,m._invalidate=null,m.next=Gr.zpp_pool,Gr.zpp_pool=m),null==this.zpp_inner_zn.wrap_a3&&this.zpp_inner_zn.setup_a3(),null==this.zpp_inner_zn.wrap_a4&&this.zpp_inner_zn.setup_a4();var i=this.zpp_inner_zn.wrap_a4,_=a.zpp_inner;null!=_._validate&&_._validate();var s=a.zpp_inner.x,m=a.zpp_inner;null!=m._validate&&m._validate();var g,_=a.zpp_inner.y,m=i.zpp_inner;null!=m._validate&&m._validate(),i.zpp_inner.x==s&&(null!=(m=i.zpp_inner)._validate&&m._validate(),i.zpp_inner.y==_)||(i.zpp_inner.x=s,i.zpp_inner.y=_,null!=(g=i.zpp_inner)._invalidate&&g._invalidate(g)),a.zpp_inner.weak&&(g=a.zpp_inner,a.zpp_inner.outer=null,a.zpp_inner=null,a.zpp_pool=Bn.poolVec2,Bn.poolVec2=a,null!=g.outer&&(g.outer.zpp_inner=null,g.outer=null),g._isimmutable=null,g._validate=null,g._invalidate=null,g.next=Gr.zpp_pool,Gr.zpp_pool=g),null==this.zpp_inner_zn.wrap_a4&&this.zpp_inner_zn.setup_a4(),this.zpp_inner.immutable_midstep("PulleyJoint::ratio"),this.zpp_inner_zn.ratio!=p&&(this.zpp_inner_zn.ratio=p,this.zpp_inner.wake()),this.zpp_inner.immutable_midstep("PulleyJoint::jointMin"),this.zpp_inner_zn.jointMin!=h&&(this.zpp_inner_zn.jointMin=h,this.zpp_inner.wake()),this.zpp_inner.immutable_midstep("PulleyJoint::jointMax"),this.zpp_inner_zn.jointMax!=l&&(this.zpp_inner_zn.jointMax=l,this.zpp_inner.wake())};T.__name__=["nape","constraint","PulleyJoint"],T.__super__=w,(T.prototype=Object.create(w.prototype)).zpp_inner_zn=null,T.prototype.get_body1=function(){return null==this.zpp_inner_zn.b1?null:this.zpp_inner_zn.b1.outer},T.prototype.set_body1=function(t){this.zpp_inner.immutable_midstep("Constraint::body1");t=null==t?null:t.zpp_inner;return t!=this.zpp_inner_zn.b1&&(null!=this.zpp_inner_zn.b1&&(null!=(null==this.zpp_inner.space?null:this.zpp_inner.space.outer)&&this.zpp_inner_zn.b2!=this.zpp_inner_zn.b1&&this.zpp_inner_zn.b3!=this.zpp_inner_zn.b1&&this.zpp_inner_zn.b4!=this.zpp_inner_zn.b1&&null!=this.zpp_inner_zn.b1&&this.zpp_inner_zn.b1.constraints.remove(this.zpp_inner),this.zpp_inner.active&&null!=(null==this.zpp_inner.space?null:this.zpp_inner.space.outer)&&this.zpp_inner_zn.b1.wake()),this.zpp_inner_zn.b1=t,null!=(null==this.zpp_inner.space?null:this.zpp_inner.space.outer)&&null!=t&&this.zpp_inner_zn.b2!=t&&this.zpp_inner_zn.b3!=t&&this.zpp_inner_zn.b4!=t&&null!=t&&t.constraints.add(this.zpp_inner),this.zpp_inner.active&&null!=(null==this.zpp_inner.space?null:this.zpp_inner.space.outer)&&(this.zpp_inner.wake(),null!=t&&t.wake())),null==this.zpp_inner_zn.b1?null:this.zpp_inner_zn.b1.outer},T.prototype.get_body2=function(){return null==this.zpp_inner_zn.b2?null:this.zpp_inner_zn.b2.outer},T.prototype.set_body2=function(t){this.zpp_inner.immutable_midstep("Constraint::body2");t=null==t?null:t.zpp_inner;return t!=this.zpp_inner_zn.b2&&(null!=this.zpp_inner_zn.b2&&(null!=(null==this.zpp_inner.space?null:this.zpp_inner.space.outer)&&this.zpp_inner_zn.b1!=this.zpp_inner_zn.b2&&this.zpp_inner_zn.b3!=this.zpp_inner_zn.b2&&this.zpp_inner_zn.b4!=this.zpp_inner_zn.b2&&null!=this.zpp_inner_zn.b2&&this.zpp_inner_zn.b2.constraints.remove(this.zpp_inner),this.zpp_inner.active&&null!=(null==this.zpp_inner.space?null:this.zpp_inner.space.outer)&&this.zpp_inner_zn.b2.wake()),this.zpp_inner_zn.b2=t,null!=(null==this.zpp_inner.space?null:this.zpp_inner.space.outer)&&null!=t&&this.zpp_inner_zn.b1!=t&&this.zpp_inner_zn.b3!=t&&this.zpp_inner_zn.b4!=t&&null!=t&&t.constraints.add(this.zpp_inner),this.zpp_inner.active&&null!=(null==this.zpp_inner.space?null:this.zpp_inner.space.outer)&&(this.zpp_inner.wake(),null!=t&&t.wake())),null==this.zpp_inner_zn.b2?null:this.zpp_inner_zn.b2.outer},T.prototype.get_body3=function(){return null==this.zpp_inner_zn.b3?null:this.zpp_inner_zn.b3.outer},T.prototype.set_body3=function(t){this.zpp_inner.immutable_midstep("Constraint::body3");t=null==t?null:t.zpp_inner;return t!=this.zpp_inner_zn.b3&&(null!=this.zpp_inner_zn.b3&&(null!=(null==this.zpp_inner.space?null:this.zpp_inner.space.outer)&&this.zpp_inner_zn.b1!=this.zpp_inner_zn.b3&&this.zpp_inner_zn.b2!=this.zpp_inner_zn.b3&&this.zpp_inner_zn.b4!=this.zpp_inner_zn.b3&&null!=this.zpp_inner_zn.b3&&this.zpp_inner_zn.b3.constraints.remove(this.zpp_inner),this.zpp_inner.active&&null!=(null==this.zpp_inner.space?null:this.zpp_inner.space.outer)&&this.zpp_inner_zn.b3.wake()),this.zpp_inner_zn.b3=t,null!=(null==this.zpp_inner.space?null:this.zpp_inner.space.outer)&&null!=t&&this.zpp_inner_zn.b1!=t&&this.zpp_inner_zn.b2!=t&&this.zpp_inner_zn.b4!=t&&null!=t&&t.constraints.add(this.zpp_inner),this.zpp_inner.active&&null!=(null==this.zpp_inner.space?null:this.zpp_inner.space.outer)&&(this.zpp_inner.wake(),null!=t&&t.wake())),null==this.zpp_inner_zn.b3?null:this.zpp_inner_zn.b3.outer},T.prototype.get_body4=function(){return null==this.zpp_inner_zn.b4?null:this.zpp_inner_zn.b4.outer},T.prototype.set_body4=function(t){this.zpp_inner.immutable_midstep("Constraint::body4");t=null==t?null:t.zpp_inner;return t!=this.zpp_inner_zn.b4&&(null!=this.zpp_inner_zn.b4&&(null!=(null==this.zpp_inner.space?null:this.zpp_inner.space.outer)&&this.zpp_inner_zn.b1!=this.zpp_inner_zn.b4&&this.zpp_inner_zn.b2!=this.zpp_inner_zn.b4&&this.zpp_inner_zn.b3!=this.zpp_inner_zn.b4&&null!=this.zpp_inner_zn.b4&&this.zpp_inner_zn.b4.constraints.remove(this.zpp_inner),this.zpp_inner.active&&null!=(null==this.zpp_inner.space?null:this.zpp_inner.space.outer)&&this.zpp_inner_zn.b4.wake()),this.zpp_inner_zn.b4=t,null!=(null==this.zpp_inner.space?null:this.zpp_inner.space.outer)&&null!=t&&this.zpp_inner_zn.b1!=t&&this.zpp_inner_zn.b2!=t&&this.zpp_inner_zn.b3!=t&&null!=t&&t.constraints.add(this.zpp_inner),this.zpp_inner.active&&null!=(null==this.zpp_inner.space?null:this.zpp_inner.space.outer)&&(this.zpp_inner.wake(),null!=t&&t.wake())),null==this.zpp_inner_zn.b4?null:this.zpp_inner_zn.b4.outer},T.prototype.get_anchor1=function(){return null==this.zpp_inner_zn.wrap_a1&&this.zpp_inner_zn.setup_a1(),this.zpp_inner_zn.wrap_a1},T.prototype.set_anchor1=function(t){null==this.zpp_inner_zn.wrap_a1&&this.zpp_inner_zn.setup_a1();var e=this.zpp_inner_zn.wrap_a1,i=t.zpp_inner;null!=i._validate&&i._validate();var n=t.zpp_inner.x,r=t.zpp_inner;null!=r._validate&&r._validate();var o,i=t.zpp_inner.y,r=e.zpp_inner;return null!=r._validate&&r._validate(),e.zpp_inner.x==n&&(null!=(r=e.zpp_inner)._validate&&r._validate(),e.zpp_inner.y==i)||(e.zpp_inner.x=n,e.zpp_inner.y=i,null!=(o=e.zpp_inner)._invalidate&&o._invalidate(o)),t.zpp_inner.weak&&(o=t.zpp_inner,t.zpp_inner.outer=null,t.zpp_inner=null,t.zpp_pool=Bn.poolVec2,Bn.poolVec2=t,null!=o.outer&&(o.outer.zpp_inner=null,o.outer=null),o._isimmutable=null,o._validate=null,o._invalidate=null,o.next=Gr.zpp_pool,Gr.zpp_pool=o),null==this.zpp_inner_zn.wrap_a1&&this.zpp_inner_zn.setup_a1(),this.zpp_inner_zn.wrap_a1},T.prototype.get_anchor2=function(){return null==this.zpp_inner_zn.wrap_a2&&this.zpp_inner_zn.setup_a2(),this.zpp_inner_zn.wrap_a2},T.prototype.set_anchor2=function(t){null==this.zpp_inner_zn.wrap_a2&&this.zpp_inner_zn.setup_a2();var e=this.zpp_inner_zn.wrap_a2,i=t.zpp_inner;null!=i._validate&&i._validate();var n=t.zpp_inner.x,r=t.zpp_inner;null!=r._validate&&r._validate();var o,i=t.zpp_inner.y,r=e.zpp_inner;return null!=r._validate&&r._validate(),e.zpp_inner.x==n&&(null!=(r=e.zpp_inner)._validate&&r._validate(),e.zpp_inner.y==i)||(e.zpp_inner.x=n,e.zpp_inner.y=i,null!=(o=e.zpp_inner)._invalidate&&o._invalidate(o)),t.zpp_inner.weak&&(o=t.zpp_inner,t.zpp_inner.outer=null,t.zpp_inner=null,t.zpp_pool=Bn.poolVec2,Bn.poolVec2=t,null!=o.outer&&(o.outer.zpp_inner=null,o.outer=null),o._isimmutable=null,o._validate=null,o._invalidate=null,o.next=Gr.zpp_pool,Gr.zpp_pool=o),null==this.zpp_inner_zn.wrap_a2&&this.zpp_inner_zn.setup_a2(),this.zpp_inner_zn.wrap_a2},T.prototype.get_anchor3=function(){return null==this.zpp_inner_zn.wrap_a3&&this.zpp_inner_zn.setup_a3(),this.zpp_inner_zn.wrap_a3},T.prototype.set_anchor3=function(t){null==this.zpp_inner_zn.wrap_a3&&this.zpp_inner_zn.setup_a3();var e=this.zpp_inner_zn.wrap_a3,i=t.zpp_inner;null!=i._validate&&i._validate();var n=t.zpp_inner.x,r=t.zpp_inner;null!=r._validate&&r._validate();var o,i=t.zpp_inner.y,r=e.zpp_inner;return null!=r._validate&&r._validate(),e.zpp_inner.x==n&&(null!=(r=e.zpp_inner)._validate&&r._validate(),e.zpp_inner.y==i)||(e.zpp_inner.x=n,e.zpp_inner.y=i,null!=(o=e.zpp_inner)._invalidate&&o._invalidate(o)),t.zpp_inner.weak&&(o=t.zpp_inner,t.zpp_inner.outer=null,t.zpp_inner=null,t.zpp_pool=Bn.poolVec2,Bn.poolVec2=t,null!=o.outer&&(o.outer.zpp_inner=null,o.outer=null),o._isimmutable=null,o._validate=null,o._invalidate=null,o.next=Gr.zpp_pool,Gr.zpp_pool=o),null==this.zpp_inner_zn.wrap_a3&&this.zpp_inner_zn.setup_a3(),this.zpp_inner_zn.wrap_a3},T.prototype.get_anchor4=function(){return null==this.zpp_inner_zn.wrap_a4&&this.zpp_inner_zn.setup_a4(),this.zpp_inner_zn.wrap_a4},T.prototype.set_anchor4=function(t){null==this.zpp_inner_zn.wrap_a4&&this.zpp_inner_zn.setup_a4();var e=this.zpp_inner_zn.wrap_a4,i=t.zpp_inner;null!=i._validate&&i._validate();var n=t.zpp_inner.x,r=t.zpp_inner;null!=r._validate&&r._validate();var o,i=t.zpp_inner.y,r=e.zpp_inner;return null!=r._validate&&r._validate(),e.zpp_inner.x==n&&(null!=(r=e.zpp_inner)._validate&&r._validate(),e.zpp_inner.y==i)||(e.zpp_inner.x=n,e.zpp_inner.y=i,null!=(o=e.zpp_inner)._invalidate&&o._invalidate(o)),t.zpp_inner.weak&&(o=t.zpp_inner,t.zpp_inner.outer=null,t.zpp_inner=null,t.zpp_pool=Bn.poolVec2,Bn.poolVec2=t,null!=o.outer&&(o.outer.zpp_inner=null,o.outer=null),o._isimmutable=null,o._validate=null,o._invalidate=null,o.next=Gr.zpp_pool,Gr.zpp_pool=o),null==this.zpp_inner_zn.wrap_a4&&this.zpp_inner_zn.setup_a4(),this.zpp_inner_zn.wrap_a4},T.prototype.get_jointMin=function(){return this.zpp_inner_zn.jointMin},T.prototype.set_jointMin=function(t){return this.zpp_inner.immutable_midstep("PulleyJoint::jointMin"),this.zpp_inner_zn.jointMin!=t&&(this.zpp_inner_zn.jointMin=t,this.zpp_inner.wake()),this.zpp_inner_zn.jointMin},T.prototype.get_jointMax=function(){return this.zpp_inner_zn.jointMax},T.prototype.set_jointMax=function(t){return this.zpp_inner.immutable_midstep("PulleyJoint::jointMax"),this.zpp_inner_zn.jointMax!=t&&(this.zpp_inner_zn.jointMax=t,this.zpp_inner.wake()),this.zpp_inner_zn.jointMax},T.prototype.get_ratio=function(){return this.zpp_inner_zn.ratio},T.prototype.set_ratio=function(t){return this.zpp_inner.immutable_midstep("PulleyJoint::ratio"),this.zpp_inner_zn.ratio!=t&&(this.zpp_inner_zn.ratio=t,this.zpp_inner.wake()),this.zpp_inner_zn.ratio},T.prototype.isSlack=function(){return this.zpp_inner_zn.slack},T.prototype.impulse=function(){var t=new W(1,1);return t.zpp_inner.x[0*t.zpp_inner.n]=this.zpp_inner_zn.jAcc,t},T.prototype.bodyImpulse=function(t){return this.zpp_inner.active?this.zpp_inner_zn.bodyImpulse(t.zpp_inner):K.get()},T.prototype.visitBodies=function(t){null!=(null==this.zpp_inner_zn.b1?null:this.zpp_inner_zn.b1.outer)&&t(null==this.zpp_inner_zn.b1?null:this.zpp_inner_zn.b1.outer),null!=(null==this.zpp_inner_zn.b2?null:this.zpp_inner_zn.b2.outer)&&(null==this.zpp_inner_zn.b2?null:this.zpp_inner_zn.b2.outer)!=(null==this.zpp_inner_zn.b1?null:this.zpp_inner_zn.b1.outer)&&t(null==this.zpp_inner_zn.b2?null:this.zpp_inner_zn.b2.outer),null!=(null==this.zpp_inner_zn.b3?null:this.zpp_inner_zn.b3.outer)&&(null==this.zpp_inner_zn.b3?null:this.zpp_inner_zn.b3.outer)!=(null==this.zpp_inner_zn.b1?null:this.zpp_inner_zn.b1.outer)&&(null==this.zpp_inner_zn.b3?null:this.zpp_inner_zn.b3.outer)!=(null==this.zpp_inner_zn.b2?null:this.zpp_inner_zn.b2.outer)&&t(null==this.zpp_inner_zn.b3?null:this.zpp_inner_zn.b3.outer),null!=(null==this.zpp_inner_zn.b4?null:this.zpp_inner_zn.b4.outer)&&(null==this.zpp_inner_zn.b4?null:this.zpp_inner_zn.b4.outer)!=(null==this.zpp_inner_zn.b1?null:this.zpp_inner_zn.b1.outer)&&(null==this.zpp_inner_zn.b4?null:this.zpp_inner_zn.b4.outer)!=(null==this.zpp_inner_zn.b2?null:this.zpp_inner_zn.b2.outer)&&(null==this.zpp_inner_zn.b4?null:this.zpp_inner_zn.b4.outer)!=(null==this.zpp_inner_zn.b3?null:this.zpp_inner_zn.b3.outer)&&t(null==this.zpp_inner_zn.b4?null:this.zpp_inner_zn.b4.outer)},Object.defineProperty(T.prototype,"body1",{get:T.prototype.get_body1,set:T.prototype.set_body1}),Object.defineProperty(T.prototype,"body2",{get:T.prototype.get_body2,set:T.prototype.set_body2}),Object.defineProperty(T.prototype,"body3",{get:T.prototype.get_body3,set:T.prototype.set_body3}),Object.defineProperty(T.prototype,"body4",{get:T.prototype.get_body4,set:T.prototype.set_body4}),Object.defineProperty(T.prototype,"anchor1",{get:T.prototype.get_anchor1,set:T.prototype.set_anchor1}),Object.defineProperty(T.prototype,"anchor2",{get:T.prototype.get_anchor2,set:T.prototype.set_anchor2}),Object.defineProperty(T.prototype,"anchor3",{get:T.prototype.get_anchor3,set:T.prototype.set_anchor3}),Object.defineProperty(T.prototype,"anchor4",{get:T.prototype.get_anchor4,set:T.prototype.set_anchor4}),Object.defineProperty(T.prototype,"jointMin",{get:T.prototype.get_jointMin,set:T.prototype.set_jointMin}),Object.defineProperty(T.prototype,"jointMax",{get:T.prototype.get_jointMax,set:T.prototype.set_jointMax}),Object.defineProperty(T.prototype,"ratio",{get:T.prototype.get_ratio,set:T.prototype.set_ratio}),T.prototype.__class__=T;c=nape.constraint.UserConstraint=function(t,e){null==e&&(e=!1),this.zpp_inner_zn=null,this.zpp_inner_zn=new Ut(t,e),this.zpp_inner=this.zpp_inner_zn,(this.zpp_inner.outer=this).zpp_inner_zn.outer_zn=this,w.call(this)};c.__name__=["nape","constraint","UserConstraint"],c.__super__=w,(c.prototype=Object.create(w.prototype)).zpp_inner_zn=null,c.prototype.__bindVec2=function(){var t=new St;return t.zpp_inner._inuse=!0,t.zpp_inner._invalidate=Z(a=this.zpp_inner_zn,a.bindVec2_invalidate),t},c.prototype.__copy=function(){return null},c.prototype.__broken=function(){},c.prototype.__validate=function(){},c.prototype.__draw=function(t){},c.prototype.__prepare=function(){},c.prototype.__position=function(t){},c.prototype.__velocity=function(t){},c.prototype.__eff_mass=function(t){},c.prototype.__clamp=function(t){},c.prototype.__impulse=function(t,e,i){},c.prototype.impulse=function(){for(var t=new W(this.zpp_inner_zn.dim,1),e=0,i=this.zpp_inner_zn.dim;e<i;){var n=e++;t.zpp_inner.x[n*t.zpp_inner.n]=this.zpp_inner_zn.jAcc[n]}return t},c.prototype.bodyImpulse=function(t){return this.zpp_inner.active?this.zpp_inner_zn.bodyImpulse(t.zpp_inner):K.get()},c.prototype.visitBodies=function(t){for(var e=0,i=this.zpp_inner_zn.bodies.length;e<i;){var n=this.zpp_inner_zn.bodies[e];if(null!=n.body){for(var r=!1,o=e+1;o<i;)if(this.zpp_inner_zn.bodies[o++].body==n.body){r=!0;break}r||t(n.body.outer)}++e}},c.prototype.__invalidate=function(){this.zpp_inner.immutable_midstep("UserConstraint::invalidate()"),this.zpp_inner.active&&null!=(null==this.zpp_inner.space?null:this.zpp_inner.space.outer)&&this.zpp_inner.wake()},c.prototype.__registerBody=function(t,e){return this.zpp_inner.immutable_midstep("UserConstraint::registerBody(..)"),t!=e&&(null!=t&&(this.zpp_inner_zn.remBody(t.zpp_inner),this.zpp_inner.active&&null!=(null==this.zpp_inner.space?null:this.zpp_inner.space.outer)&&t.zpp_inner.wake()),null!=e&&this.zpp_inner_zn.addBody(e.zpp_inner),this.zpp_inner.wake(),null!=e&&e.zpp_inner.wake()),e},c.prototype.__class__=c;var A=nape.constraint.WeldJoint=function(t,e,i,n,r){null==r&&(r=0),this.zpp_inner_zn=null,this.zpp_inner_zn=new se,this.zpp_inner=this.zpp_inner_zn,(this.zpp_inner.outer=this).zpp_inner_zn.outer_zn=this,w.call(this),this.zpp_inner.immutable_midstep("Constraint::body1");var o=null==t?null:t.zpp_inner;o!=this.zpp_inner_zn.b1&&(null!=this.zpp_inner_zn.b1&&(null!=(null==this.zpp_inner.space?null:this.zpp_inner.space.outer)&&this.zpp_inner_zn.b2!=this.zpp_inner_zn.b1&&null!=this.zpp_inner_zn.b1&&this.zpp_inner_zn.b1.constraints.remove(this.zpp_inner),this.zpp_inner.active&&null!=(null==this.zpp_inner.space?null:this.zpp_inner.space.outer)&&this.zpp_inner_zn.b1.wake()),this.zpp_inner_zn.b1=o,null!=(null==this.zpp_inner.space?null:this.zpp_inner.space.outer)&&null!=o&&this.zpp_inner_zn.b2!=o&&null!=o&&o.constraints.add(this.zpp_inner),this.zpp_inner.active&&null!=(null==this.zpp_inner.space?null:this.zpp_inner.space.outer)&&(this.zpp_inner.wake(),null!=o&&o.wake())),this.zpp_inner.immutable_midstep("Constraint::body2");var s=null==e?null:e.zpp_inner;s!=this.zpp_inner_zn.b2&&(null!=this.zpp_inner_zn.b2&&(null!=(null==this.zpp_inner.space?null:this.zpp_inner.space.outer)&&this.zpp_inner_zn.b1!=this.zpp_inner_zn.b2&&null!=this.zpp_inner_zn.b2&&this.zpp_inner_zn.b2.constraints.remove(this.zpp_inner),this.zpp_inner.active&&null!=(null==this.zpp_inner.space?null:this.zpp_inner.space.outer)&&this.zpp_inner_zn.b2.wake()),this.zpp_inner_zn.b2=s,null!=(null==this.zpp_inner.space?null:this.zpp_inner.space.outer)&&null!=s&&this.zpp_inner_zn.b1!=s&&null!=s&&s.constraints.add(this.zpp_inner),this.zpp_inner.active&&null!=(null==this.zpp_inner.space?null:this.zpp_inner.space.outer)&&(this.zpp_inner.wake(),null!=s&&s.wake())),null==this.zpp_inner_zn.wrap_a1&&this.zpp_inner_zn.setup_a1();t=this.zpp_inner_zn.wrap_a1,o=i.zpp_inner;null!=o._validate&&o._validate();e=i.zpp_inner.x,s=i.zpp_inner;null!=s._validate&&s._validate();var o=i.zpp_inner.y,s=t.zpp_inner;null!=s._validate&&s._validate(),t.zpp_inner.x==e&&(null!=(s=t.zpp_inner)._validate&&s._validate(),t.zpp_inner.y==o)||(t.zpp_inner.x=e,t.zpp_inner.y=o,null!=(a=t.zpp_inner)._invalidate&&a._invalidate(a)),i.zpp_inner.weak&&(h=i.zpp_inner,i.zpp_inner.outer=null,i.zpp_inner=null,i.zpp_pool=Bn.poolVec2,Bn.poolVec2=i,null!=h.outer&&(h.outer.zpp_inner=null,h.outer=null),h._isimmutable=null,h._validate=null,h._invalidate=null,h.next=Gr.zpp_pool,Gr.zpp_pool=h),null==this.zpp_inner_zn.wrap_a1&&this.zpp_inner_zn.setup_a1(),null==this.zpp_inner_zn.wrap_a2&&this.zpp_inner_zn.setup_a2();var t=this.zpp_inner_zn.wrap_a2,a=n.zpp_inner;null!=a._validate&&a._validate();var i=n.zpp_inner.x,h=n.zpp_inner;null!=h._validate&&h._validate();var l,a=n.zpp_inner.y,h=t.zpp_inner;null!=h._validate&&h._validate(),t.zpp_inner.x==i&&(null!=(h=t.zpp_inner)._validate&&h._validate(),t.zpp_inner.y==a)||(t.zpp_inner.x=i,t.zpp_inner.y=a,null!=(l=t.zpp_inner)._invalidate&&l._invalidate(l)),n.zpp_inner.weak&&(l=n.zpp_inner,n.zpp_inner.outer=null,n.zpp_inner=null,n.zpp_pool=Bn.poolVec2,Bn.poolVec2=n,null!=l.outer&&(l.outer.zpp_inner=null,l.outer=null),l._isimmutable=null,l._validate=null,l._invalidate=null,l.next=Gr.zpp_pool,Gr.zpp_pool=l),null==this.zpp_inner_zn.wrap_a2&&this.zpp_inner_zn.setup_a2(),this.zpp_inner.immutable_midstep("WeldJoint::phase"),this.zpp_inner_zn.phase!=r&&(this.zpp_inner_zn.phase=r,this.zpp_inner.wake())};A.__name__=["nape","constraint","WeldJoint"],A.__super__=w,(A.prototype=Object.create(w.prototype)).zpp_inner_zn=null,A.prototype.get_body1=function(){return null==this.zpp_inner_zn.b1?null:this.zpp_inner_zn.b1.outer},A.prototype.set_body1=function(t){this.zpp_inner.immutable_midstep("Constraint::body1");t=null==t?null:t.zpp_inner;return t!=this.zpp_inner_zn.b1&&(null!=this.zpp_inner_zn.b1&&(null!=(null==this.zpp_inner.space?null:this.zpp_inner.space.outer)&&this.zpp_inner_zn.b2!=this.zpp_inner_zn.b1&&null!=this.zpp_inner_zn.b1&&this.zpp_inner_zn.b1.constraints.remove(this.zpp_inner),this.zpp_inner.active&&null!=(null==this.zpp_inner.space?null:this.zpp_inner.space.outer)&&this.zpp_inner_zn.b1.wake()),this.zpp_inner_zn.b1=t,null!=(null==this.zpp_inner.space?null:this.zpp_inner.space.outer)&&null!=t&&this.zpp_inner_zn.b2!=t&&null!=t&&t.constraints.add(this.zpp_inner),this.zpp_inner.active&&null!=(null==this.zpp_inner.space?null:this.zpp_inner.space.outer)&&(this.zpp_inner.wake(),null!=t&&t.wake())),null==this.zpp_inner_zn.b1?null:this.zpp_inner_zn.b1.outer},A.prototype.get_body2=function(){return null==this.zpp_inner_zn.b2?null:this.zpp_inner_zn.b2.outer},A.prototype.set_body2=function(t){this.zpp_inner.immutable_midstep("Constraint::body2");t=null==t?null:t.zpp_inner;return t!=this.zpp_inner_zn.b2&&(null!=this.zpp_inner_zn.b2&&(null!=(null==this.zpp_inner.space?null:this.zpp_inner.space.outer)&&this.zpp_inner_zn.b1!=this.zpp_inner_zn.b2&&null!=this.zpp_inner_zn.b2&&this.zpp_inner_zn.b2.constraints.remove(this.zpp_inner),this.zpp_inner.active&&null!=(null==this.zpp_inner.space?null:this.zpp_inner.space.outer)&&this.zpp_inner_zn.b2.wake()),this.zpp_inner_zn.b2=t,null!=(null==this.zpp_inner.space?null:this.zpp_inner.space.outer)&&null!=t&&this.zpp_inner_zn.b1!=t&&null!=t&&t.constraints.add(this.zpp_inner),this.zpp_inner.active&&null!=(null==this.zpp_inner.space?null:this.zpp_inner.space.outer)&&(this.zpp_inner.wake(),null!=t&&t.wake())),null==this.zpp_inner_zn.b2?null:this.zpp_inner_zn.b2.outer},A.prototype.get_anchor1=function(){return null==this.zpp_inner_zn.wrap_a1&&this.zpp_inner_zn.setup_a1(),this.zpp_inner_zn.wrap_a1},A.prototype.set_anchor1=function(t){null==this.zpp_inner_zn.wrap_a1&&this.zpp_inner_zn.setup_a1();var e=this.zpp_inner_zn.wrap_a1,i=t.zpp_inner;null!=i._validate&&i._validate();var n=t.zpp_inner.x,r=t.zpp_inner;null!=r._validate&&r._validate();var o,i=t.zpp_inner.y,r=e.zpp_inner;return null!=r._validate&&r._validate(),e.zpp_inner.x==n&&(null!=(r=e.zpp_inner)._validate&&r._validate(),e.zpp_inner.y==i)||(e.zpp_inner.x=n,e.zpp_inner.y=i,null!=(o=e.zpp_inner)._invalidate&&o._invalidate(o)),t.zpp_inner.weak&&(o=t.zpp_inner,t.zpp_inner.outer=null,t.zpp_inner=null,t.zpp_pool=Bn.poolVec2,Bn.poolVec2=t,null!=o.outer&&(o.outer.zpp_inner=null,o.outer=null),o._isimmutable=null,o._validate=null,o._invalidate=null,o.next=Gr.zpp_pool,Gr.zpp_pool=o),null==this.zpp_inner_zn.wrap_a1&&this.zpp_inner_zn.setup_a1(),this.zpp_inner_zn.wrap_a1},A.prototype.get_anchor2=function(){return null==this.zpp_inner_zn.wrap_a2&&this.zpp_inner_zn.setup_a2(),this.zpp_inner_zn.wrap_a2},A.prototype.set_anchor2=function(t){null==this.zpp_inner_zn.wrap_a2&&this.zpp_inner_zn.setup_a2();var e=this.zpp_inner_zn.wrap_a2,i=t.zpp_inner;null!=i._validate&&i._validate();var n=t.zpp_inner.x,r=t.zpp_inner;null!=r._validate&&r._validate();var o,i=t.zpp_inner.y,r=e.zpp_inner;return null!=r._validate&&r._validate(),e.zpp_inner.x==n&&(null!=(r=e.zpp_inner)._validate&&r._validate(),e.zpp_inner.y==i)||(e.zpp_inner.x=n,e.zpp_inner.y=i,null!=(o=e.zpp_inner)._invalidate&&o._invalidate(o)),t.zpp_inner.weak&&(o=t.zpp_inner,t.zpp_inner.outer=null,t.zpp_inner=null,t.zpp_pool=Bn.poolVec2,Bn.poolVec2=t,null!=o.outer&&(o.outer.zpp_inner=null,o.outer=null),o._isimmutable=null,o._validate=null,o._invalidate=null,o.next=Gr.zpp_pool,Gr.zpp_pool=o),null==this.zpp_inner_zn.wrap_a2&&this.zpp_inner_zn.setup_a2(),this.zpp_inner_zn.wrap_a2},A.prototype.get_phase=function(){return this.zpp_inner_zn.phase},A.prototype.set_phase=function(t){return this.zpp_inner.immutable_midstep("WeldJoint::phase"),this.zpp_inner_zn.phase!=t&&(this.zpp_inner_zn.phase=t,this.zpp_inner.wake()),this.zpp_inner_zn.phase},A.prototype.impulse=function(){var t=new W(3,1);return t.zpp_inner.x[0*t.zpp_inner.n]=this.zpp_inner_zn.jAccx,t.zpp_inner.x[t.zpp_inner.n]=this.zpp_inner_zn.jAccy,t.zpp_inner.x[t.zpp_inner.n]=this.zpp_inner_zn.jAccz,t},A.prototype.bodyImpulse=function(t){return this.zpp_inner.active?this.zpp_inner_zn.bodyImpulse(t.zpp_inner):K.get()},A.prototype.visitBodies=function(t){null!=(null==this.zpp_inner_zn.b1?null:this.zpp_inner_zn.b1.outer)&&t(null==this.zpp_inner_zn.b1?null:this.zpp_inner_zn.b1.outer),null!=(null==this.zpp_inner_zn.b2?null:this.zpp_inner_zn.b2.outer)&&(null==this.zpp_inner_zn.b2?null:this.zpp_inner_zn.b2.outer)!=(null==this.zpp_inner_zn.b1?null:this.zpp_inner_zn.b1.outer)&&t(null==this.zpp_inner_zn.b2?null:this.zpp_inner_zn.b2.outer)},Object.defineProperty(A.prototype,"body1",{get:A.prototype.get_body1,set:A.prototype.set_body1}),Object.defineProperty(A.prototype,"body2",{get:A.prototype.get_body2,set:A.prototype.set_body2}),Object.defineProperty(A.prototype,"anchor1",{get:A.prototype.get_anchor1,set:A.prototype.set_anchor1}),Object.defineProperty(A.prototype,"anchor2",{get:A.prototype.get_anchor2,set:A.prototype.set_anchor2}),Object.defineProperty(A.prototype,"phase",{get:A.prototype.get_phase,set:A.prototype.set_phase}),A.prototype.__class__=A;var k=nape.dynamics.Arbiter=function(){this.zpp_inner=null};k.__name__=["nape","dynamics","Arbiter"],k.prototype.zpp_inner=null,k.prototype.get_isSleeping=function(){return this.zpp_inner.sleeping},k.prototype.get_type=function(){return Qe.types[this.zpp_inner.type]},k.prototype.isCollisionArbiter=function(){return this.zpp_inner.type==Qe.COL},k.prototype.isFluidArbiter=function(){return this.zpp_inner.type==Qe.FLUID},k.prototype.isSensorArbiter=function(){return this.zpp_inner.type==Qe.SENSOR},k.prototype.get_collisionArbiter=function(){return this.zpp_inner.type==Qe.COL?this.zpp_inner.colarb.outer_zn:null},k.prototype.get_fluidArbiter=function(){return this.zpp_inner.type==Qe.FLUID?this.zpp_inner.fluidarb.outer_zn:null},k.prototype.get_shape1=function(){return(this.zpp_inner.ws1.id>this.zpp_inner.ws2.id?this.zpp_inner.ws2:this.zpp_inner.ws1).outer},k.prototype.get_shape2=function(){return(this.zpp_inner.ws1.id>this.zpp_inner.ws2.id?this.zpp_inner.ws1:this.zpp_inner.ws2).outer},k.prototype.get_body1=function(){return(this.zpp_inner.ws1.id>this.zpp_inner.ws2.id?this.zpp_inner.b2:this.zpp_inner.b1).outer},k.prototype.get_body2=function(){return(this.zpp_inner.ws1.id>this.zpp_inner.ws2.id?this.zpp_inner.b1:this.zpp_inner.b2).outer},k.prototype.get_state=function(){var t=this.zpp_inner.immState;return 5==t?(null==Yn.PreFlag_ACCEPT&&(Yn.internal=!0,Yn.PreFlag_ACCEPT=new Xn,Yn.internal=!1),Yn.PreFlag_ACCEPT):1==t?(null==Yn.PreFlag_ACCEPT_ONCE&&(Yn.internal=!0,Yn.PreFlag_ACCEPT_ONCE=new Xn,Yn.internal=!1),Yn.PreFlag_ACCEPT_ONCE):6==t?(null==Yn.PreFlag_IGNORE&&(Yn.internal=!0,Yn.PreFlag_IGNORE=new Xn,Yn.internal=!1),Yn.PreFlag_IGNORE):(null==Yn.PreFlag_IGNORE_ONCE&&(Yn.internal=!0,Yn.PreFlag_IGNORE_ONCE=new Xn,Yn.internal=!1),Yn.PreFlag_IGNORE_ONCE)},k.prototype.totalImpulse=function(t,e){return null==e&&(e=!1),K.get(0,0,0)},k.prototype.toString=function(){var t=this.zpp_inner.type==Qe.COL?"CollisionArbiter":this.zpp_inner.type==Qe.FLUID?"FluidArbiter":"SensorArbiter";if(this.zpp_inner.cleared)return t+"(object-pooled)";var e=t+"("+(this.zpp_inner.ws1.id>this.zpp_inner.ws2.id?this.zpp_inner.ws2:this.zpp_inner.ws1).outer.toString()+"|"+(this.zpp_inner.ws1.id>this.zpp_inner.ws2.id?this.zpp_inner.ws1:this.zpp_inner.ws2).outer.toString()+")"+(this.zpp_inner.type==Qe.COL?"["+["SD","DD"][this.zpp_inner.colarb.stat?0:1]+"]":"")+"<-",t=this.zpp_inner.immState,t=5==t?(null==Yn.PreFlag_ACCEPT&&(Yn.internal=!0,Yn.PreFlag_ACCEPT=new Xn,Yn.internal=!1),Yn.PreFlag_ACCEPT):1==t?(null==Yn.PreFlag_ACCEPT_ONCE&&(Yn.internal=!0,Yn.PreFlag_ACCEPT_ONCE=new Xn,Yn.internal=!1),Yn.PreFlag_ACCEPT_ONCE):6==t?(null==Yn.PreFlag_IGNORE&&(Yn.internal=!0,Yn.PreFlag_IGNORE=new Xn,Yn.internal=!1),Yn.PreFlag_IGNORE):(null==Yn.PreFlag_IGNORE_ONCE&&(Yn.internal=!0,Yn.PreFlag_IGNORE_ONCE=new Xn,Yn.internal=!1),Yn.PreFlag_IGNORE_ONCE);return e+t.toString()},Object.defineProperty(k.prototype,"isSleeping",{get:k.prototype.get_isSleeping}),Object.defineProperty(k.prototype,"type",{get:k.prototype.get_type}),Object.defineProperty(k.prototype,"collisionArbiter",{get:k.prototype.get_collisionArbiter}),Object.defineProperty(k.prototype,"fluidArbiter",{get:k.prototype.get_fluidArbiter}),Object.defineProperty(k.prototype,"shape1",{get:k.prototype.get_shape1}),Object.defineProperty(k.prototype,"shape2",{get:k.prototype.get_shape2}),Object.defineProperty(k.prototype,"body1",{get:k.prototype.get_body1}),Object.defineProperty(k.prototype,"body2",{get:k.prototype.get_body2}),Object.defineProperty(k.prototype,"state",{get:k.prototype.get_state}),k.prototype.__class__=k;var Ht=nape.dynamics.ArbiterIterator=function(){this.zpp_next=null,this.zpp_critical=!1,this.zpp_i=0,this.zpp_inner=null};Ht.__name__=["nape","dynamics","ArbiterIterator"],Ht.get=function(t){var e,i=null==Ht.zpp_pool?(Dn.internal=!0,e=new Ht,Dn.internal=!1,e):(Ht.zpp_pool=(i=Ht.zpp_pool).zpp_next,i);return i.zpp_i=0,i.zpp_inner=t,i.zpp_critical=!1,i},Ht.prototype.zpp_inner=null,Ht.prototype.zpp_i=null,Ht.prototype.zpp_critical=null,Ht.prototype.zpp_next=null,Ht.prototype.hasNext=function(){this.zpp_inner.zpp_inner.valmod();var t=this.zpp_inner.zpp_gl();return this.zpp_critical=!0,this.zpp_i<t||(this.zpp_next=Ht.zpp_pool,(Ht.zpp_pool=this).zpp_inner=null,!1)},Ht.prototype.next=function(){return this.zpp_critical=!1,this.zpp_inner.at(this.zpp_i++)},Ht.prototype.__class__=Ht;var O=nape.dynamics.ArbiterList=function(){this.zpp_inner=null,this.zpp_inner=new Dn,this.zpp_inner.outer=this};O.__name__=["nape","dynamics","ArbiterList"],O.fromArray=function(t){for(var e=new O,i=0;i<t.length;){var n=t[i];++i,e.push(n)}return e},O.prototype.zpp_inner=null,O.prototype.get_length=function(){return this.zpp_gl()},O.prototype.zpp_gl=function(){if(this.zpp_inner.valmod(),this.zpp_inner.zip_length){this.zpp_inner.zip_length=!1,this.zpp_inner.user_length=0;for(var t=this.zpp_inner.inner.head;null!=t;)t.elt.active&&this.zpp_inner.user_length++,t=t.next}return this.zpp_inner.user_length},O.prototype.zpp_vm=function(){this.zpp_inner.valmod()},O.prototype.has=function(t){return this.zpp_vm(),this.zpp_inner.inner.has(t.zpp_inner)},O.prototype.at=function(t){if(this.zpp_vm(),(t=this.zpp_inner.reverse_flag?this.zpp_gl()-1-t:t)<this.zpp_inner.at_index||null==this.zpp_inner.at_ite)for(this.zpp_inner.at_index=0,this.zpp_inner.at_ite=this.zpp_inner.inner.head;!this.zpp_inner.at_ite.elt.active;)this.zpp_inner.at_ite=this.zpp_inner.at_ite.next;for(;this.zpp_inner.at_index!=t;)for(this.zpp_inner.at_index++,this.zpp_inner.at_ite=this.zpp_inner.at_ite.next;!this.zpp_inner.at_ite.elt.active;)this.zpp_inner.at_ite=this.zpp_inner.at_ite.next;return this.zpp_inner.at_ite.elt.wrapper()},O.prototype.push=function(t){this.zpp_inner.modify_test(),this.zpp_vm();var e=null==this.zpp_inner.adder||this.zpp_inner.adder(t);return e&&(this.zpp_inner.reverse_flag?this.zpp_inner.inner.add(t.zpp_inner):(null==this.zpp_inner.push_ite&&(this.zpp_inner.push_ite=this.empty()?null:this.zpp_inner.inner.iterator_at(this.zpp_gl()-1)),this.zpp_inner.push_ite=this.zpp_inner.inner.insert(this.zpp_inner.push_ite,t.zpp_inner)),this.zpp_inner.invalidate(),null!=this.zpp_inner.post_adder&&this.zpp_inner.post_adder(t)),e},O.prototype.unshift=function(t){this.zpp_inner.modify_test(),this.zpp_vm();var e=null==this.zpp_inner.adder||this.zpp_inner.adder(t);return e&&(this.zpp_inner.reverse_flag?(null==this.zpp_inner.push_ite&&(this.zpp_inner.push_ite=this.empty()?null:this.zpp_inner.inner.iterator_at(this.zpp_gl()-1)),this.zpp_inner.push_ite=this.zpp_inner.inner.insert(this.zpp_inner.push_ite,t.zpp_inner)):this.zpp_inner.inner.add(t.zpp_inner),this.zpp_inner.invalidate(),null!=this.zpp_inner.post_adder&&this.zpp_inner.post_adder(t)),e},O.prototype.pop=function(){this.zpp_inner.modify_test(),this.zpp_vm();var t,e,i=null;return this.zpp_inner.reverse_flag?(e=(i=this.zpp_inner.inner.head.elt).wrapper(),null!=this.zpp_inner.subber&&this.zpp_inner.subber(e),this.zpp_inner.dontremove||this.zpp_inner.inner.pop()):(null!=this.zpp_inner.at_ite&&null==this.zpp_inner.at_ite.next&&(this.zpp_inner.at_ite=null),e=(i=(null==(t=1==this.zpp_gl()?null:this.zpp_inner.inner.iterator_at(this.zpp_gl()-2))?this.zpp_inner.inner.head:t.next).elt).wrapper(),null!=this.zpp_inner.subber&&this.zpp_inner.subber(e),this.zpp_inner.dontremove||this.zpp_inner.inner.erase(t)),this.zpp_inner.invalidate(),i.wrapper()},O.prototype.shift=function(){this.zpp_inner.modify_test(),this.zpp_vm();var t,e,i=null;return this.zpp_inner.reverse_flag?(null!=this.zpp_inner.at_ite&&null==this.zpp_inner.at_ite.next&&(this.zpp_inner.at_ite=null),t=(i=(null==(e=1==this.zpp_gl()?null:this.zpp_inner.inner.iterator_at(this.zpp_gl()-2))?this.zpp_inner.inner.head:e.next).elt).wrapper(),null!=this.zpp_inner.subber&&this.zpp_inner.subber(t),this.zpp_inner.dontremove||this.zpp_inner.inner.erase(e)):(e=(i=this.zpp_inner.inner.head.elt).wrapper(),null!=this.zpp_inner.subber&&this.zpp_inner.subber(e),this.zpp_inner.dontremove||this.zpp_inner.inner.pop()),this.zpp_inner.invalidate(),i.wrapper()},O.prototype.add=function(t){return this.zpp_inner.reverse_flag?this.push(t):this.unshift(t)},O.prototype.remove=function(t){this.zpp_inner.modify_test(),this.zpp_vm();for(var e=!1,i=this.zpp_inner.inner.head;null!=i;){if(i.elt==t.zpp_inner){e=!0;break}i=i.next}return e&&(null!=this.zpp_inner.subber&&this.zpp_inner.subber(t),this.zpp_inner.dontremove||this.zpp_inner.inner.remove(t.zpp_inner),this.zpp_inner.invalidate()),e},O.prototype.clear=function(){if(this.zpp_inner.reverse_flag)for(;!this.empty();)this.pop();else for(;!this.empty();)this.shift()},O.prototype.empty=function(){return 0==this.zpp_gl()},O.prototype.iterator=function(){return this.zpp_vm(),Ht.get(this)},O.prototype.copy=function(t){null==t&&(t=!1);for(var e=new O,i=this.iterator();;){i.zpp_inner.zpp_inner.valmod();var n=i.zpp_inner.zpp_gl();if(i.zpp_critical=!0,!(i.zpp_i<n||(i.zpp_next=Ht.zpp_pool,(Ht.zpp_pool=i).zpp_inner=null,!1)))break;i.zpp_critical=!1;n=i.zpp_inner.at(i.zpp_i++);e.push(t?null:n)}return e},O.prototype.merge=function(t){for(var e=t.iterator();;){e.zpp_inner.zpp_inner.valmod();var i=e.zpp_inner.zpp_gl();if(e.zpp_critical=!0,!(e.zpp_i<i||(e.zpp_next=Ht.zpp_pool,(Ht.zpp_pool=e).zpp_inner=null,!1)))break;e.zpp_critical=!1;i=e.zpp_inner.at(e.zpp_i++);this.has(i)||this.add(i)}},O.prototype.toString=function(){for(var t="[",e=!0,i=this.iterator();;){i.zpp_inner.zpp_inner.valmod();var n=i.zpp_inner.zpp_gl();if(i.zpp_critical=!0,!(i.zpp_i<n||(i.zpp_next=Ht.zpp_pool,(Ht.zpp_pool=i).zpp_inner=null,!1)))break;i.zpp_critical=!1;n=i.zpp_inner.at(i.zpp_i++);e||(t+=","),t+=null==n?"NULL":n.toString(),e=!1}return t+"]"},O.prototype.foreach=function(t){for(var e=this.iterator();;){e.zpp_inner.zpp_inner.valmod();var i=e.zpp_inner.zpp_gl();if(e.zpp_critical=!0,!(e.zpp_i<i||(e.zpp_next=Ht.zpp_pool,(Ht.zpp_pool=e).zpp_inner=null,!1)))break;try{e.zpp_critical=!1,t(e.zpp_inner.at(e.zpp_i++))}catch(t){e.zpp_next=Ht.zpp_pool,(Ht.zpp_pool=e).zpp_inner=null;break}}return this},O.prototype.filter=function(t){for(var e=0;e<this.zpp_gl();){var i=this.at(e);try{t(i)?++e:this.remove(i)}catch(t){break}}return this},Object.defineProperty(O.prototype,"length",{get:O.prototype.get_length}),O.prototype.__class__=O;var E=nape.dynamics.ArbiterType=function(){};E.__name__=["nape","dynamics","ArbiterType"],E.COLLISION=null,E.get_COLLISION=function(){return null==Yn.ArbiterType_COLLISION&&(Yn.internal=!0,Yn.ArbiterType_COLLISION=new E,Yn.internal=!1),Yn.ArbiterType_COLLISION},E.SENSOR=null,E.get_SENSOR=function(){return null==Yn.ArbiterType_SENSOR&&(Yn.internal=!0,Yn.ArbiterType_SENSOR=new E,Yn.internal=!1),Yn.ArbiterType_SENSOR},E.FLUID=null,E.get_FLUID=function(){return null==Yn.ArbiterType_FLUID&&(Yn.internal=!0,Yn.ArbiterType_FLUID=new E,Yn.internal=!1),Yn.ArbiterType_FLUID},E.prototype.toString=function(){return null==Yn.ArbiterType_COLLISION&&(Yn.internal=!0,Yn.ArbiterType_COLLISION=new E,Yn.internal=!1),this==Yn.ArbiterType_COLLISION?"COLLISION":(null==Yn.ArbiterType_SENSOR&&(Yn.internal=!0,Yn.ArbiterType_SENSOR=new E,Yn.internal=!1),this==Yn.ArbiterType_SENSOR?"SENSOR":(null==Yn.ArbiterType_FLUID&&(Yn.internal=!0,Yn.ArbiterType_FLUID=new E,Yn.internal=!1),this==Yn.ArbiterType_FLUID?"FLUID":""))},Object.defineProperty(E,"COLLISION",{get:E.get_COLLISION}),Object.defineProperty(E,"SENSOR",{get:E.get_SENSOR}),Object.defineProperty(E,"FLUID",{get:E.get_FLUID}),E.prototype.__class__=E;var I=nape.dynamics.CollisionArbiter=function(){k.call(this)};I.__name__=["nape","dynamics","CollisionArbiter"],I.__super__=k,(I.prototype=Object.create(k.prototype)).get_contacts=function(){return null==this.zpp_inner.colarb.wrap_contacts&&this.zpp_inner.colarb.setupcontacts(),this.zpp_inner.colarb.wrap_contacts},I.prototype.get_normal=function(){return null==this.zpp_inner.colarb.wrap_normal&&this.zpp_inner.colarb.getnormal(),this.zpp_inner.colarb.wrap_normal},I.prototype.get_radius=function(){return this.zpp_inner.colarb.radius},I.prototype.get_referenceEdge1=function(){var t=this.zpp_inner.colarb.__ref_edge1;return null==(t=null!=t&&(1!=(this.zpp_inner.ws1.id>this.zpp_inner.ws2.id?this.zpp_inner.ws2:this.zpp_inner.ws1).outer.zpp_inner.type||(this.zpp_inner.ws1.id>this.zpp_inner.ws2.id?this.zpp_inner.ws2:this.zpp_inner.ws1).outer.zpp_inner!=t.polygon)?this.zpp_inner.colarb.__ref_edge2:t)?null:t.wrapper()},I.prototype.get_referenceEdge2=function(){var t=this.zpp_inner.colarb.__ref_edge1;return null==(t=null!=t&&(1!=(this.zpp_inner.ws1.id>this.zpp_inner.ws2.id?this.zpp_inner.ws1:this.zpp_inner.ws2).outer.zpp_inner.type||(this.zpp_inner.ws1.id>this.zpp_inner.ws2.id?this.zpp_inner.ws1:this.zpp_inner.ws2).outer.zpp_inner!=t.polygon)?this.zpp_inner.colarb.__ref_edge2:t)?null:t.wrapper()},I.prototype.firstVertex=function(){return null!=this.zpp_inner.colarb.__ref_edge1!=(null!=this.zpp_inner.colarb.__ref_edge2)&&-1==this.zpp_inner.colarb.__ref_vertex},I.prototype.secondVertex=function(){return null!=this.zpp_inner.colarb.__ref_edge1!=(null!=this.zpp_inner.colarb.__ref_edge2)&&1==this.zpp_inner.colarb.__ref_vertex},I.prototype.normalImpulse=function(t,e){var i,n,r=0,o=0,s=0,a=this.zpp_inner.colarb;return(e=null==e?!1:e)&&!a.oc1.fresh||(null!=(n=(i=a.oc1.wrapper().normalImpulse(t)).zpp_inner)._validate&&n._validate(),r+=i.zpp_inner.x,null!=(n=i.zpp_inner)._validate&&n._validate(),o+=i.zpp_inner.y,null!=(n=i.zpp_inner)._validate&&n._validate(),s+=i.zpp_inner.z,i.dispose()),a.hc2&&(e&&!a.oc2.fresh||(null!=(t=(a=a.oc2.wrapper().normalImpulse(t)).zpp_inner)._validate&&t._validate(),r+=a.zpp_inner.x,null!=(t=a.zpp_inner)._validate&&t._validate(),o+=a.zpp_inner.y,null!=(t=a.zpp_inner)._validate&&t._validate(),s+=a.zpp_inner.z,a.dispose())),K.get(r,o,s)},I.prototype.tangentImpulse=function(t,e){var i,n,r=0,o=0,s=0,a=this.zpp_inner.colarb;return(e=null==e?!1:e)&&!a.oc1.fresh||(null!=(n=(i=a.oc1.wrapper().tangentImpulse(t)).zpp_inner)._validate&&n._validate(),r+=i.zpp_inner.x,null!=(n=i.zpp_inner)._validate&&n._validate(),o+=i.zpp_inner.y,null!=(n=i.zpp_inner)._validate&&n._validate(),s+=i.zpp_inner.z,i.dispose()),a.hc2&&(e&&!a.oc2.fresh||(null!=(t=(a=a.oc2.wrapper().tangentImpulse(t)).zpp_inner)._validate&&t._validate(),r+=a.zpp_inner.x,null!=(t=a.zpp_inner)._validate&&t._validate(),o+=a.zpp_inner.y,null!=(t=a.zpp_inner)._validate&&t._validate(),s+=a.zpp_inner.z,a.dispose())),K.get(r,o,s)},I.prototype.totalImpulse=function(t,e){var i,n,r=0,o=0,s=0,a=this.zpp_inner.colarb;return(e=null==e?!1:e)&&!a.oc1.fresh||(null!=(n=(i=a.oc1.wrapper().totalImpulse(t)).zpp_inner)._validate&&n._validate(),r+=i.zpp_inner.x,null!=(n=i.zpp_inner)._validate&&n._validate(),o+=i.zpp_inner.y,null!=(n=i.zpp_inner)._validate&&n._validate(),s+=i.zpp_inner.z,i.dispose()),a.hc2&&(e&&!a.oc2.fresh||(null!=(t=(a=a.oc2.wrapper().totalImpulse(t)).zpp_inner)._validate&&t._validate(),r+=a.zpp_inner.x,null!=(t=a.zpp_inner)._validate&&t._validate(),o+=a.zpp_inner.y,null!=(t=a.zpp_inner)._validate&&t._validate(),s+=a.zpp_inner.z,a.dispose())),K.get(r,o,s)},I.prototype.rollingImpulse=function(t,e){var i=this.zpp_inner.colarb;return!(e=null==e?!1:e)||i.oc1.fresh?i.oc1.wrapper().rollingImpulse(t):0},I.prototype.get_elasticity=function(){var t=this.zpp_inner.colarb;return t.invalidated&&(t.invalidated=!1,t.userdef_restitution||(t.s1.material.elasticity<=-1/0||t.s2.material.elasticity<=-1/0?t.restitution=0:t.s1.material.elasticity>=1/0||t.s2.material.elasticity>=1/0?t.restitution=1:t.restitution=(t.s1.material.elasticity+t.s2.material.elasticity)/2,t.restitution<0&&(t.restitution=0),1<t.restitution&&(t.restitution=1)),t.userdef_dyn_fric||(t.dyn_fric=Math.sqrt(t.s1.material.dynamicFriction*t.s2.material.dynamicFriction)),t.userdef_stat_fric||(t.stat_fric=Math.sqrt(t.s1.material.staticFriction*t.s2.material.staticFriction)),t.userdef_rfric||(t.rfric=Math.sqrt(t.s1.material.rollingFriction*t.s2.material.rollingFriction))),t.restitution},I.prototype.set_elasticity=function(t){var e=this.zpp_inner.colarb;e.restitution=t,e.userdef_restitution=!0;e=this.zpp_inner.colarb;return e.invalidated&&(e.invalidated=!1,e.userdef_restitution||(e.s1.material.elasticity<=-1/0||e.s2.material.elasticity<=-1/0?e.restitution=0:e.s1.material.elasticity>=1/0||e.s2.material.elasticity>=1/0?e.restitution=1:e.restitution=(e.s1.material.elasticity+e.s2.material.elasticity)/2,e.restitution<0&&(e.restitution=0),1<e.restitution&&(e.restitution=1)),e.userdef_dyn_fric||(e.dyn_fric=Math.sqrt(e.s1.material.dynamicFriction*e.s2.material.dynamicFriction)),e.userdef_stat_fric||(e.stat_fric=Math.sqrt(e.s1.material.staticFriction*e.s2.material.staticFriction)),e.userdef_rfric||(e.rfric=Math.sqrt(e.s1.material.rollingFriction*e.s2.material.rollingFriction))),e.restitution},I.prototype.get_dynamicFriction=function(){var t=this.zpp_inner.colarb;return t.invalidated&&(t.invalidated=!1,t.userdef_restitution||(t.s1.material.elasticity<=-1/0||t.s2.material.elasticity<=-1/0?t.restitution=0:t.s1.material.elasticity>=1/0||t.s2.material.elasticity>=1/0?t.restitution=1:t.restitution=(t.s1.material.elasticity+t.s2.material.elasticity)/2,t.restitution<0&&(t.restitution=0),1<t.restitution&&(t.restitution=1)),t.userdef_dyn_fric||(t.dyn_fric=Math.sqrt(t.s1.material.dynamicFriction*t.s2.material.dynamicFriction)),t.userdef_stat_fric||(t.stat_fric=Math.sqrt(t.s1.material.staticFriction*t.s2.material.staticFriction)),t.userdef_rfric||(t.rfric=Math.sqrt(t.s1.material.rollingFriction*t.s2.material.rollingFriction))),t.dyn_fric},I.prototype.set_dynamicFriction=function(t){var e=this.zpp_inner.colarb;e.dyn_fric=t,e.userdef_dyn_fric=!0;e=this.zpp_inner.colarb;return e.invalidated&&(e.invalidated=!1,e.userdef_restitution||(e.s1.material.elasticity<=-1/0||e.s2.material.elasticity<=-1/0?e.restitution=0:e.s1.material.elasticity>=1/0||e.s2.material.elasticity>=1/0?e.restitution=1:e.restitution=(e.s1.material.elasticity+e.s2.material.elasticity)/2,e.restitution<0&&(e.restitution=0),1<e.restitution&&(e.restitution=1)),e.userdef_dyn_fric||(e.dyn_fric=Math.sqrt(e.s1.material.dynamicFriction*e.s2.material.dynamicFriction)),e.userdef_stat_fric||(e.stat_fric=Math.sqrt(e.s1.material.staticFriction*e.s2.material.staticFriction)),e.userdef_rfric||(e.rfric=Math.sqrt(e.s1.material.rollingFriction*e.s2.material.rollingFriction))),e.dyn_fric},I.prototype.get_staticFriction=function(){var t=this.zpp_inner.colarb;return t.invalidated&&(t.invalidated=!1,t.userdef_restitution||(t.s1.material.elasticity<=-1/0||t.s2.material.elasticity<=-1/0?t.restitution=0:t.s1.material.elasticity>=1/0||t.s2.material.elasticity>=1/0?t.restitution=1:t.restitution=(t.s1.material.elasticity+t.s2.material.elasticity)/2,t.restitution<0&&(t.restitution=0),1<t.restitution&&(t.restitution=1)),t.userdef_dyn_fric||(t.dyn_fric=Math.sqrt(t.s1.material.dynamicFriction*t.s2.material.dynamicFriction)),t.userdef_stat_fric||(t.stat_fric=Math.sqrt(t.s1.material.staticFriction*t.s2.material.staticFriction)),t.userdef_rfric||(t.rfric=Math.sqrt(t.s1.material.rollingFriction*t.s2.material.rollingFriction))),t.stat_fric},I.prototype.set_staticFriction=function(t){var e=this.zpp_inner.colarb;e.stat_fric=t,e.userdef_stat_fric=!0;e=this.zpp_inner.colarb;return e.invalidated&&(e.invalidated=!1,e.userdef_restitution||(e.s1.material.elasticity<=-1/0||e.s2.material.elasticity<=-1/0?e.restitution=0:e.s1.material.elasticity>=1/0||e.s2.material.elasticity>=1/0?e.restitution=1:e.restitution=(e.s1.material.elasticity+e.s2.material.elasticity)/2,e.restitution<0&&(e.restitution=0),1<e.restitution&&(e.restitution=1)),e.userdef_dyn_fric||(e.dyn_fric=Math.sqrt(e.s1.material.dynamicFriction*e.s2.material.dynamicFriction)),e.userdef_stat_fric||(e.stat_fric=Math.sqrt(e.s1.material.staticFriction*e.s2.material.staticFriction)),e.userdef_rfric||(e.rfric=Math.sqrt(e.s1.material.rollingFriction*e.s2.material.rollingFriction))),e.stat_fric},I.prototype.get_rollingFriction=function(){var t=this.zpp_inner.colarb;return t.invalidated&&(t.invalidated=!1,t.userdef_restitution||(t.s1.material.elasticity<=-1/0||t.s2.material.elasticity<=-1/0?t.restitution=0:t.s1.material.elasticity>=1/0||t.s2.material.elasticity>=1/0?t.restitution=1:t.restitution=(t.s1.material.elasticity+t.s2.material.elasticity)/2,t.restitution<0&&(t.restitution=0),1<t.restitution&&(t.restitution=1)),t.userdef_dyn_fric||(t.dyn_fric=Math.sqrt(t.s1.material.dynamicFriction*t.s2.material.dynamicFriction)),t.userdef_stat_fric||(t.stat_fric=Math.sqrt(t.s1.material.staticFriction*t.s2.material.staticFriction)),t.userdef_rfric||(t.rfric=Math.sqrt(t.s1.material.rollingFriction*t.s2.material.rollingFriction))),t.rfric},I.prototype.set_rollingFriction=function(t){var e=this.zpp_inner.colarb;e.rfric=t,e.userdef_rfric=!0;e=this.zpp_inner.colarb;return e.invalidated&&(e.invalidated=!1,e.userdef_restitution||(e.s1.material.elasticity<=-1/0||e.s2.material.elasticity<=-1/0?e.restitution=0:e.s1.material.elasticity>=1/0||e.s2.material.elasticity>=1/0?e.restitution=1:e.restitution=(e.s1.material.elasticity+e.s2.material.elasticity)/2,e.restitution<0&&(e.restitution=0),1<e.restitution&&(e.restitution=1)),e.userdef_dyn_fric||(e.dyn_fric=Math.sqrt(e.s1.material.dynamicFriction*e.s2.material.dynamicFriction)),e.userdef_stat_fric||(e.stat_fric=Math.sqrt(e.s1.material.staticFriction*e.s2.material.staticFriction)),e.userdef_rfric||(e.rfric=Math.sqrt(e.s1.material.rollingFriction*e.s2.material.rollingFriction))),e.rfric},Object.defineProperty(I.prototype,"contacts",{get:I.prototype.get_contacts}),Object.defineProperty(I.prototype,"normal",{get:I.prototype.get_normal}),Object.defineProperty(I.prototype,"radius",{get:I.prototype.get_radius}),Object.defineProperty(I.prototype,"referenceEdge1",{get:I.prototype.get_referenceEdge1}),Object.defineProperty(I.prototype,"referenceEdge2",{get:I.prototype.get_referenceEdge2}),Object.defineProperty(I.prototype,"elasticity",{get:I.prototype.get_elasticity,set:I.prototype.set_elasticity}),Object.defineProperty(I.prototype,"dynamicFriction",{get:I.prototype.get_dynamicFriction,set:I.prototype.set_dynamicFriction}),Object.defineProperty(I.prototype,"staticFriction",{get:I.prototype.get_staticFriction,set:I.prototype.set_staticFriction}),Object.defineProperty(I.prototype,"rollingFriction",{get:I.prototype.get_rollingFriction,set:I.prototype.set_rollingFriction}),I.prototype.__class__=I;var G=nape.dynamics.Contact=function(){this.zpp_inner=null};G.__name__=["nape","dynamics","Contact"],G.prototype.zpp_inner=null,G.prototype.get_arbiter=function(){if(null==this.zpp_inner.arbiter)return null;var t=this.zpp_inner.arbiter.outer;return t.zpp_inner.type==Qe.COL?t.zpp_inner.colarb.outer_zn:null},G.prototype.get_penetration=function(){return-this.zpp_inner.dist},G.prototype.get_position=function(){return null==this.zpp_inner.wrap_position&&this.zpp_inner.getposition(),this.zpp_inner.wrap_position},G.prototype.get_fresh=function(){return this.zpp_inner.fresh},G.prototype.normalImpulse=function(t){var e=this.zpp_inner.arbiter.colarb,i=this.zpp_inner.inner,n=i.jnAcc;return null==t?K.get(e.nx*n,e.ny*n):t==e.b1.outer?K.get(e.nx*-n,e.ny*-n,-(e.ny*i.r1x-e.nx*i.r1y)*n):K.get(e.nx*n,e.ny*n,(e.ny*i.r2x-e.nx*i.r2y)*n)},G.prototype.tangentImpulse=function(t){var e=this.zpp_inner.arbiter.colarb,i=this.zpp_inner.inner,n=i.jtAcc;return null==t?K.get(-e.ny*n,e.nx*n):t==e.b1.outer?K.get(e.ny*n,-e.nx*n,-(i.r1x*e.nx+i.r1y*e.ny)*n):K.get(-e.ny*n,e.nx*n,(i.r2x*e.nx+i.r2y*e.ny)*n)},G.prototype.rollingImpulse=function(t){var e=this.zpp_inner.arbiter.colarb,i=this.zpp_inner.arbiter.colarb.jrAcc;return null!=t&&t==e.b1.outer?-i:i},G.prototype.totalImpulse=function(t){var e=this.zpp_inner.arbiter.colarb,i=this.zpp_inner.inner,n=i.jnAcc,r=i.jtAcc,o=e.jrAcc;if(null==t)return K.get(e.nx*n-e.ny*r,e.ny*n+e.nx*r,o);var s=e.nx*n-e.ny*r,r=e.ny*n+e.nx*r;return t==e.b1.outer?K.get(-s,-r,-(r*i.r1x-s*i.r1y)-o):K.get(s,r,r*i.r2x-s*i.r2y+o)},G.prototype.get_friction=function(){return this.zpp_inner.inner.friction},G.prototype.toString=function(){return null==this.zpp_inner.arbiter||this.zpp_inner.arbiter.cleared?"{object-pooled}":"{Contact}"},Object.defineProperty(G.prototype,"arbiter",{get:G.prototype.get_arbiter}),Object.defineProperty(G.prototype,"penetration",{get:G.prototype.get_penetration}),Object.defineProperty(G.prototype,"position",{get:G.prototype.get_position}),Object.defineProperty(G.prototype,"fresh",{get:G.prototype.get_fresh}),Object.defineProperty(G.prototype,"friction",{get:G.prototype.get_friction}),G.prototype.__class__=G;var qt=nape.dynamics.ContactIterator=function(){this.zpp_next=null,this.zpp_critical=!1,this.zpp_i=0,this.zpp_inner=null};qt.__name__=["nape","dynamics","ContactIterator"],qt.get=function(t){var e,i=null==qt.zpp_pool?(Ln.internal=!0,e=new qt,Ln.internal=!1,e):(qt.zpp_pool=(i=qt.zpp_pool).zpp_next,i);return i.zpp_i=0,i.zpp_inner=t,i.zpp_critical=!1,i},qt.prototype.zpp_inner=null,qt.prototype.zpp_i=null,qt.prototype.zpp_critical=null,qt.prototype.zpp_next=null,qt.prototype.hasNext=function(){this.zpp_inner.zpp_inner.valmod();var t=this.zpp_inner;if(t.zpp_inner.valmod(),t.zpp_inner.zip_length){t.zpp_inner.zip_length=!1,t.zpp_inner.user_length=0;for(var e=t.zpp_inner.inner.next;null!=e;){var i=e;i.active&&i.arbiter.active&&t.zpp_inner.user_length++,e=e.next}}var n=t.zpp_inner.user_length;return this.zpp_critical=!0,this.zpp_i<n||(this.zpp_next=qt.zpp_pool,(qt.zpp_pool=this).zpp_inner=null,!1)},qt.prototype.next=function(){return this.zpp_critical=!1,this.zpp_inner.at(this.zpp_i++)},qt.prototype.__class__=qt;var D=nape.dynamics.ContactList=function(){this.zpp_inner=null,this.zpp_inner=new Ln,this.zpp_inner.outer=this};D.__name__=["nape","dynamics","ContactList"],D.fromArray=function(t){for(var e=new D,i=0;i<t.length;){var n=t[i];++i,e.push(n)}return e},D.prototype.zpp_inner=null,D.prototype.get_length=function(){if(this.zpp_inner.valmod(),this.zpp_inner.zip_length){this.zpp_inner.zip_length=!1,this.zpp_inner.user_length=0;for(var t=this.zpp_inner.inner.next;null!=t;){var e=t;e.active&&e.arbiter.active&&this.zpp_inner.user_length++,t=t.next}}return this.zpp_inner.user_length},D.prototype.has=function(t){return this.zpp_inner.valmod(),this.zpp_inner.inner.has(t.zpp_inner)},D.prototype.at=function(t){if(this.zpp_inner.valmod(),this.zpp_inner.reverse_flag){if(this.zpp_inner.valmod(),this.zpp_inner.zip_length){this.zpp_inner.zip_length=!1,this.zpp_inner.user_length=0;for(var e=this.zpp_inner.inner.next;null!=e;){var i=e;i.active&&i.arbiter.active&&this.zpp_inner.user_length++,e=e.next}}t=this.zpp_inner.user_length-1-t}if(t<this.zpp_inner.at_index||null==this.zpp_inner.at_ite)for(this.zpp_inner.at_index=0,this.zpp_inner.at_ite=this.zpp_inner.inner.next;;){var n=this.zpp_inner.at_ite;if(n.active&&n.arbiter.active)break;this.zpp_inner.at_ite=this.zpp_inner.at_ite.next}for(;this.zpp_inner.at_index!=t;)for(this.zpp_inner.at_index++,this.zpp_inner.at_ite=this.zpp_inner.at_ite.next;;){var r=this.zpp_inner.at_ite;if(r.active&&r.arbiter.active)break;this.zpp_inner.at_ite=this.zpp_inner.at_ite.next}return this.zpp_inner.at_ite.wrapper()},D.prototype.push=function(t){this.zpp_inner.modify_test(),this.zpp_inner.valmod();var e,i=null==this.zpp_inner.adder||this.zpp_inner.adder(t);if(i){if(this.zpp_inner.reverse_flag)this.zpp_inner.inner.add(t.zpp_inner);else{if(null==this.zpp_inner.push_ite){if(this.zpp_inner.valmod(),this.zpp_inner.zip_length){this.zpp_inner.zip_length=!1,this.zpp_inner.user_length=0;for(var n=this.zpp_inner.inner.next;null!=n;){var r=n;r.active&&r.arbiter.active&&this.zpp_inner.user_length++,n=n.next}}if(0==this.zpp_inner.user_length)e=null;else{if(this.zpp_inner.valmod(),this.zpp_inner.zip_length){this.zpp_inner.zip_length=!1,this.zpp_inner.user_length=0;for(var o=this.zpp_inner.inner.next;null!=o;){var s=o;s.active&&s.arbiter.active&&this.zpp_inner.user_length++,o=o.next}}e=this.zpp_inner.inner.iterator_at(this.zpp_inner.user_length-1)}this.zpp_inner.push_ite=e}this.zpp_inner.push_ite=this.zpp_inner.inner.insert(this.zpp_inner.push_ite,t.zpp_inner)}this.zpp_inner.invalidate(),null!=this.zpp_inner.post_adder&&this.zpp_inner.post_adder(t)}return i},D.prototype.unshift=function(t){this.zpp_inner.modify_test(),this.zpp_inner.valmod();var e,i=null==this.zpp_inner.adder||this.zpp_inner.adder(t);if(i){if(this.zpp_inner.reverse_flag){if(null==this.zpp_inner.push_ite){if(this.zpp_inner.valmod(),this.zpp_inner.zip_length){this.zpp_inner.zip_length=!1,this.zpp_inner.user_length=0;for(var n=this.zpp_inner.inner.next;null!=n;){var r=n;r.active&&r.arbiter.active&&this.zpp_inner.user_length++,n=n.next}}if(0==this.zpp_inner.user_length)e=null;else{if(this.zpp_inner.valmod(),this.zpp_inner.zip_length){this.zpp_inner.zip_length=!1,this.zpp_inner.user_length=0;for(var o=this.zpp_inner.inner.next;null!=o;){var s=o;s.active&&s.arbiter.active&&this.zpp_inner.user_length++,o=o.next}}e=this.zpp_inner.inner.iterator_at(this.zpp_inner.user_length-1)}this.zpp_inner.push_ite=e}this.zpp_inner.push_ite=this.zpp_inner.inner.insert(this.zpp_inner.push_ite,t.zpp_inner)}else this.zpp_inner.inner.add(t.zpp_inner);this.zpp_inner.invalidate(),null!=this.zpp_inner.post_adder&&this.zpp_inner.post_adder(t)}return i},D.prototype.pop=function(){this.zpp_inner.modify_test(),this.zpp_inner.valmod();var t,e=null;if(this.zpp_inner.reverse_flag){var i=(e=this.zpp_inner.inner.next).wrapper();null!=this.zpp_inner.subber&&this.zpp_inner.subber(i),this.zpp_inner.dontremove||this.zpp_inner.inner.pop()}else{if(null!=this.zpp_inner.at_ite&&null==this.zpp_inner.at_ite.next&&(this.zpp_inner.at_ite=null),this.zpp_inner.valmod(),this.zpp_inner.zip_length){this.zpp_inner.zip_length=!1,this.zpp_inner.user_length=0;for(var n=this.zpp_inner.inner.next;null!=n;){var r=n;r.active&&r.arbiter.active&&this.zpp_inner.user_length++,n=n.next}}if(1==this.zpp_inner.user_length)t=null;else{if(this.zpp_inner.valmod(),this.zpp_inner.zip_length){this.zpp_inner.zip_length=!1,this.zpp_inner.user_length=0;for(var o=this.zpp_inner.inner.next;null!=o;){var s=o;s.active&&s.arbiter.active&&this.zpp_inner.user_length++,o=o.next}}t=this.zpp_inner.inner.iterator_at(this.zpp_inner.user_length-2)}i=(e=(null==t?this.zpp_inner.inner:t).next).wrapper();null!=this.zpp_inner.subber&&this.zpp_inner.subber(i),this.zpp_inner.dontremove||this.zpp_inner.inner.erase(t)}return this.zpp_inner.invalidate(),e.wrapper()},D.prototype.shift=function(){this.zpp_inner.modify_test(),this.zpp_inner.valmod();var t=null;if(this.zpp_inner.reverse_flag){if(null!=this.zpp_inner.at_ite&&null==this.zpp_inner.at_ite.next&&(this.zpp_inner.at_ite=null),this.zpp_inner.valmod(),this.zpp_inner.zip_length){this.zpp_inner.zip_length=!1,this.zpp_inner.user_length=0;for(var e=this.zpp_inner.inner.next;null!=e;){var i=e;i.active&&i.arbiter.active&&this.zpp_inner.user_length++,e=e.next}}if(1==this.zpp_inner.user_length)s=null;else{if(this.zpp_inner.valmod(),this.zpp_inner.zip_length){this.zpp_inner.zip_length=!1,this.zpp_inner.user_length=0;for(var n=this.zpp_inner.inner.next;null!=n;){var r=n;r.active&&r.arbiter.active&&this.zpp_inner.user_length++,n=n.next}}s=this.zpp_inner.inner.iterator_at(this.zpp_inner.user_length-2)}var o=(t=(null==s?this.zpp_inner.inner:s).next).wrapper();null!=this.zpp_inner.subber&&this.zpp_inner.subber(o),this.zpp_inner.dontremove||this.zpp_inner.inner.erase(s)}else{var s=(t=this.zpp_inner.inner.next).wrapper();null!=this.zpp_inner.subber&&this.zpp_inner.subber(s),this.zpp_inner.dontremove||this.zpp_inner.inner.pop()}return this.zpp_inner.invalidate(),t.wrapper()},D.prototype.add=function(t){return this.zpp_inner.reverse_flag?this.push(t):this.unshift(t)},D.prototype.remove=function(t){this.zpp_inner.modify_test(),this.zpp_inner.valmod();for(var e=!1,i=this.zpp_inner.inner.next;null!=i;){if(i==t.zpp_inner){e=!0;break}i=i.next}return e&&(null!=this.zpp_inner.subber&&this.zpp_inner.subber(t),this.zpp_inner.dontremove||this.zpp_inner.inner.remove(t.zpp_inner),this.zpp_inner.invalidate()),e},D.prototype.clear=function(){if(this.zpp_inner.reverse_flag)for(;;){if(this.zpp_inner.valmod(),this.zpp_inner.zip_length){this.zpp_inner.zip_length=!1,this.zpp_inner.user_length=0;for(var t=this.zpp_inner.inner.next;null!=t;){var e=t;e.active&&e.arbiter.active&&this.zpp_inner.user_length++,t=t.next}}if(0==this.zpp_inner.user_length)break;this.pop()}else for(;;){if(this.zpp_inner.valmod(),this.zpp_inner.zip_length){this.zpp_inner.zip_length=!1,this.zpp_inner.user_length=0;for(var i=this.zpp_inner.inner.next;null!=i;){var n=i;n.active&&n.arbiter.active&&this.zpp_inner.user_length++,i=i.next}}if(0==this.zpp_inner.user_length)break;this.shift()}},D.prototype.empty=function(){if(this.zpp_inner.valmod(),this.zpp_inner.zip_length){this.zpp_inner.zip_length=!1,this.zpp_inner.user_length=0;for(var t=this.zpp_inner.inner.next;null!=t;){var e=t;e.active&&e.arbiter.active&&this.zpp_inner.user_length++,t=t.next}}return 0==this.zpp_inner.user_length},D.prototype.iterator=function(){return this.zpp_inner.valmod(),qt.get(this)},D.prototype.copy=function(t){null==t&&(t=!1);var e=new D;this.zpp_inner.valmod();for(var i=qt.get(this);;){i.zpp_inner.zpp_inner.valmod();var n=i.zpp_inner;if(n.zpp_inner.valmod(),n.zpp_inner.zip_length){n.zpp_inner.zip_length=!1,n.zpp_inner.user_length=0;for(var r=n.zpp_inner.inner.next;null!=r;){var o=r;o.active&&o.arbiter.active&&n.zpp_inner.user_length++,r=r.next}}var s=n.zpp_inner.user_length;if(i.zpp_critical=!0,!(i.zpp_i<s||(i.zpp_next=qt.zpp_pool,(qt.zpp_pool=i).zpp_inner=null,!1)))break;i.zpp_critical=!1;s=i.zpp_inner.at(i.zpp_i++);e.push(t?null:s)}return e},D.prototype.merge=function(t){t.zpp_inner.valmod();for(var e=qt.get(t);;){e.zpp_inner.zpp_inner.valmod();var i=e.zpp_inner;if(i.zpp_inner.valmod(),i.zpp_inner.zip_length){i.zpp_inner.zip_length=!1,i.zpp_inner.user_length=0;for(var n=i.zpp_inner.inner.next;null!=n;){var r=n;r.active&&r.arbiter.active&&i.zpp_inner.user_length++,n=n.next}}var o=i.zpp_inner.user_length;if(e.zpp_critical=!0,!(e.zpp_i<o||(e.zpp_next=qt.zpp_pool,(qt.zpp_pool=e).zpp_inner=null,!1)))break;e.zpp_critical=!1;o=e.zpp_inner.at(e.zpp_i++);this.has(o)||(this.zpp_inner.reverse_flag?this.push(o):this.unshift(o))}},D.prototype.toString=function(){var t="[",e=!0;this.zpp_inner.valmod();for(var i=qt.get(this);;){i.zpp_inner.zpp_inner.valmod();var n=i.zpp_inner;if(n.zpp_inner.valmod(),n.zpp_inner.zip_length){n.zpp_inner.zip_length=!1,n.zpp_inner.user_length=0;for(var r=n.zpp_inner.inner.next;null!=r;){var o=r;o.active&&o.arbiter.active&&n.zpp_inner.user_length++,r=r.next}}var s=n.zpp_inner.user_length;if(i.zpp_critical=!0,!(i.zpp_i<s||(i.zpp_next=qt.zpp_pool,(qt.zpp_pool=i).zpp_inner=null,!1)))break;i.zpp_critical=!1;s=i.zpp_inner.at(i.zpp_i++);e||(t+=","),t+=null==s?"NULL":s.toString(),e=!1}return t+"]"},D.prototype.foreach=function(t){this.zpp_inner.valmod();for(var e=qt.get(this);;){e.zpp_inner.zpp_inner.valmod();var i=e.zpp_inner;if(i.zpp_inner.valmod(),i.zpp_inner.zip_length){i.zpp_inner.zip_length=!1,i.zpp_inner.user_length=0;for(var n=i.zpp_inner.inner.next;null!=n;){var r=n;r.active&&r.arbiter.active&&i.zpp_inner.user_length++,n=n.next}}var o=i.zpp_inner.user_length;if(e.zpp_critical=!0,!(e.zpp_i<o||(e.zpp_next=qt.zpp_pool,(qt.zpp_pool=e).zpp_inner=null,!1)))break;try{e.zpp_critical=!1,t(e.zpp_inner.at(e.zpp_i++))}catch(t){e.zpp_next=qt.zpp_pool,(qt.zpp_pool=e).zpp_inner=null;break}}return this},D.prototype.filter=function(t){for(var e=0;;){if(this.zpp_inner.valmod(),this.zpp_inner.zip_length){this.zpp_inner.zip_length=!1,this.zpp_inner.user_length=0;for(var i=this.zpp_inner.inner.next;null!=i;){var n=i;n.active&&n.arbiter.active&&this.zpp_inner.user_length++,i=i.next}}if(!(e<this.zpp_inner.user_length))break;var r=this.at(e);try{t(r)?++e:this.remove(r)}catch(t){break}}return this},Object.defineProperty(D.prototype,"length",{get:D.prototype.get_length}),D.prototype.__class__=D;var L=nape.dynamics.FluidArbiter=function(){k.call(this)};L.__name__=["nape","dynamics","FluidArbiter"],L.__super__=k,(L.prototype=Object.create(k.prototype)).get_position=function(){return null==this.zpp_inner.fluidarb.wrap_position&&this.zpp_inner.fluidarb.getposition(),this.zpp_inner.fluidarb.wrap_position},L.prototype.set_position=function(t){null==this.zpp_inner.fluidarb.wrap_position&&this.zpp_inner.fluidarb.getposition();var e=this.zpp_inner.fluidarb.wrap_position,i=t.zpp_inner;null!=i._validate&&i._validate();var n=t.zpp_inner.x,r=t.zpp_inner;null!=r._validate&&r._validate();var o,i=t.zpp_inner.y,r=e.zpp_inner;return null!=r._validate&&r._validate(),e.zpp_inner.x==n&&(null!=(r=e.zpp_inner)._validate&&r._validate(),e.zpp_inner.y==i)||(e.zpp_inner.x=n,e.zpp_inner.y=i,null!=(o=e.zpp_inner)._invalidate&&o._invalidate(o)),t.zpp_inner.weak&&(o=t.zpp_inner,t.zpp_inner.outer=null,t.zpp_inner=null,t.zpp_pool=Bn.poolVec2,Bn.poolVec2=t,null!=o.outer&&(o.outer.zpp_inner=null,o.outer=null),o._isimmutable=null,o._validate=null,o._invalidate=null,o.next=Gr.zpp_pool,Gr.zpp_pool=o),null==this.zpp_inner.fluidarb.wrap_position&&this.zpp_inner.fluidarb.getposition(),this.zpp_inner.fluidarb.wrap_position},L.prototype.get_overlap=function(){return this.zpp_inner.fluidarb.overlap},L.prototype.set_overlap=function(t){return this.zpp_inner.fluidarb.overlap=t,this.zpp_inner.fluidarb.overlap},L.prototype.buoyancyImpulse=function(t){var e=this.zpp_inner.fluidarb;return null==t?K.get(e.buoyx,e.buoyy,0):t.zpp_inner==this.zpp_inner.b2?K.get(e.buoyx,e.buoyy,e.buoyy*e.r2x-e.buoyx*e.r2y):K.get(-e.buoyx,-e.buoyy,-(e.buoyy*e.r1x-e.buoyx*e.r1y))},L.prototype.dragImpulse=function(t){var e=this.zpp_inner.fluidarb,t=null==t||t.zpp_inner==this.zpp_inner.b2?1:-1;return K.get(e.dampx*t,e.dampy*t,e.adamp*t)},L.prototype.totalImpulse=function(t,e){null==e&&(e=!1);var i=this.buoyancyImpulse(t),n=this.dragImpulse(t),e=n.zpp_inner;null!=e._validate&&e._validate();t=n.zpp_inner.x,e=i.zpp_inner;null!=e._validate&&e._validate(),n.zpp_inner.x=t+i.zpp_inner.x;e=n.zpp_inner;null!=e._validate&&e._validate();t=n.zpp_inner;null!=t._validate&&t._validate();e=n.zpp_inner.y,t=i.zpp_inner;null!=t._validate&&t._validate(),n.zpp_inner.y=e+i.zpp_inner.y;t=n.zpp_inner;null!=t._validate&&t._validate();e=n.zpp_inner;null!=e._validate&&e._validate();t=n.zpp_inner.z,e=i.zpp_inner;null!=e._validate&&e._validate(),n.zpp_inner.z=t+i.zpp_inner.z;t=n.zpp_inner;return null!=t._validate&&t._validate(),i.dispose(),n},Object.defineProperty(L.prototype,"position",{get:L.prototype.get_position,set:L.prototype.set_position}),Object.defineProperty(L.prototype,"overlap",{get:L.prototype.get_overlap,set:L.prototype.set_overlap}),L.prototype.__class__=L;var B=nape.dynamics.InteractionFilter=function(t,e,i,n,r,o){null==o&&(o=-1),null==r&&(r=1),null==n&&(n=-1),null==i&&(i=1),null==e&&(e=-1),null==t&&(t=1),(this.zpp_inner=null)==he.zpp_pool?this.zpp_inner=new he:(this.zpp_inner=he.zpp_pool,he.zpp_pool=this.zpp_inner.next,this.zpp_inner.next=null),(this.zpp_inner.outer=this).zpp_inner.collisionGroup!=t&&(this.zpp_inner.collisionGroup=t,this.zpp_inner.invalidate()),this.zpp_inner.collisionMask!=e&&(this.zpp_inner.collisionMask=e,this.zpp_inner.invalidate()),this.zpp_inner.sensorGroup!=i&&(this.zpp_inner.sensorGroup=i,this.zpp_inner.invalidate()),this.zpp_inner.sensorMask!=n&&(this.zpp_inner.sensorMask=n,this.zpp_inner.invalidate()),this.zpp_inner.fluidGroup!=r&&(this.zpp_inner.fluidGroup=r,this.zpp_inner.invalidate()),this.zpp_inner.fluidMask!=o&&(this.zpp_inner.fluidMask=o,this.zpp_inner.invalidate())};B.__name__=["nape","dynamics","InteractionFilter"],B.prototype.zpp_inner=null,B.prototype.get_userData=function(){return null==this.zpp_inner.userData&&(this.zpp_inner.userData={}),this.zpp_inner.userData},B.prototype.get_shapes=function(){return null==this.zpp_inner.wrap_shapes&&(this.zpp_inner.wrap_shapes=In.get(this.zpp_inner.shapes,!0)),this.zpp_inner.wrap_shapes},B.prototype.get_collisionGroup=function(){return this.zpp_inner.collisionGroup},B.prototype.set_collisionGroup=function(t){return this.zpp_inner.collisionGroup!=t&&(this.zpp_inner.collisionGroup=t,this.zpp_inner.invalidate()),this.zpp_inner.collisionGroup},B.prototype.get_collisionMask=function(){return this.zpp_inner.collisionMask},B.prototype.set_collisionMask=function(t){return this.zpp_inner.collisionMask!=t&&(this.zpp_inner.collisionMask=t,this.zpp_inner.invalidate()),this.zpp_inner.collisionMask},B.prototype.get_sensorGroup=function(){return this.zpp_inner.sensorGroup},B.prototype.set_sensorGroup=function(t){return this.zpp_inner.sensorGroup!=t&&(this.zpp_inner.sensorGroup=t,this.zpp_inner.invalidate()),this.zpp_inner.sensorGroup},B.prototype.get_sensorMask=function(){return this.zpp_inner.sensorMask},B.prototype.set_sensorMask=function(t){return this.zpp_inner.sensorMask!=t&&(this.zpp_inner.sensorMask=t,this.zpp_inner.invalidate()),this.zpp_inner.sensorMask},B.prototype.get_fluidGroup=function(){return this.zpp_inner.fluidGroup},B.prototype.set_fluidGroup=function(t){return this.zpp_inner.fluidGroup!=t&&(this.zpp_inner.fluidGroup=t,this.zpp_inner.invalidate()),this.zpp_inner.fluidGroup},B.prototype.get_fluidMask=function(){return this.zpp_inner.fluidMask},B.prototype.set_fluidMask=function(t){return this.zpp_inner.fluidMask!=t&&(this.zpp_inner.fluidMask=t,this.zpp_inner.invalidate()),this.zpp_inner.fluidMask},B.prototype.shouldCollide=function(t){var e=this.zpp_inner,t=t.zpp_inner;return 0!=(e.collisionMask&t.collisionGroup)&&0!=(t.collisionMask&e.collisionGroup)},B.prototype.shouldSense=function(t){var e=this.zpp_inner,t=t.zpp_inner;return 0!=(e.sensorMask&t.sensorGroup)&&0!=(t.sensorMask&e.sensorGroup)},B.prototype.shouldFlow=function(t){var e=this.zpp_inner,t=t.zpp_inner;return 0!=(e.fluidMask&t.fluidGroup)&&0!=(t.fluidMask&e.fluidGroup)},B.prototype.copy=function(){return new B(this.zpp_inner.collisionGroup,this.zpp_inner.collisionMask,this.zpp_inner.sensorGroup,this.zpp_inner.sensorMask,this.zpp_inner.fluidGroup,this.zpp_inner.fluidMask)},B.prototype.toString=function(){return"{ collision: "+t.hex(this.zpp_inner.collisionGroup,8)+"~"+t.hex(this.zpp_inner.collisionMask,8)+" sensor: "+t.hex(this.zpp_inner.sensorGroup,8)+"~"+t.hex(this.zpp_inner.sensorMask,8)+" fluid: "+t.hex(this.zpp_inner.fluidGroup,8)+"~"+t.hex(this.zpp_inner.fluidMask,8)+" }"},Object.defineProperty(B.prototype,"userData",{get:B.prototype.get_userData}),Object.defineProperty(B.prototype,"shapes",{get:B.prototype.get_shapes}),Object.defineProperty(B.prototype,"collisionGroup",{get:B.prototype.get_collisionGroup,set:B.prototype.set_collisionGroup}),Object.defineProperty(B.prototype,"collisionMask",{get:B.prototype.get_collisionMask,set:B.prototype.set_collisionMask}),Object.defineProperty(B.prototype,"sensorGroup",{get:B.prototype.get_sensorGroup,set:B.prototype.set_sensorGroup}),Object.defineProperty(B.prototype,"sensorMask",{get:B.prototype.get_sensorMask,set:B.prototype.set_sensorMask}),Object.defineProperty(B.prototype,"fluidGroup",{get:B.prototype.get_fluidGroup,set:B.prototype.set_fluidGroup}),Object.defineProperty(B.prototype,"fluidMask",{get:B.prototype.get_fluidMask,set:B.prototype.set_fluidMask}),B.prototype.__class__=B;_=nape.dynamics.InteractionGroup=function(t){null==t&&(t=!1),this.zpp_inner=null,this.zpp_inner=new le,(this.zpp_inner.outer=this).zpp_inner.ignore!=t&&(this.zpp_inner.invalidate(!0),this.zpp_inner.ignore=t)};_.__name__=["nape","dynamics","InteractionGroup"],_.prototype.zpp_inner=null,_.prototype.get_group=function(){return null==this.zpp_inner.group?null:this.zpp_inner.group.outer},_.prototype.set_group=function(t){return this.zpp_inner.setGroup(null==t?null:t.zpp_inner),null==this.zpp_inner.group?null:this.zpp_inner.group.outer},_.prototype.get_ignore=function(){return this.zpp_inner.ignore},_.prototype.set_ignore=function(t){return this.zpp_inner.ignore!=t&&(this.zpp_inner.invalidate(!0),this.zpp_inner.ignore=t),this.zpp_inner.ignore},_.prototype.get_interactors=function(){return null==this.zpp_inner.wrap_interactors&&(this.zpp_inner.wrap_interactors=Sn.get(this.zpp_inner.interactors,!0)),this.zpp_inner.wrap_interactors},_.prototype.get_groups=function(){return null==this.zpp_inner.wrap_groups&&(this.zpp_inner.wrap_groups=Gn.get(this.zpp_inner.groups,!0)),this.zpp_inner.wrap_groups},_.prototype.toString=function(){var t="InteractionGroup";return t=this.zpp_inner.ignore?"InteractionGroup:ignore":t},Object.defineProperty(_.prototype,"group",{get:_.prototype.get_group,set:_.prototype.set_group}),Object.defineProperty(_.prototype,"ignore",{get:_.prototype.get_ignore,set:_.prototype.set_ignore}),Object.defineProperty(_.prototype,"interactors",{get:_.prototype.get_interactors}),Object.defineProperty(_.prototype,"groups",{get:_.prototype.get_groups}),_.prototype.__class__=_;var Yt=nape.dynamics.InteractionGroupIterator=function(){this.zpp_next=null,this.zpp_critical=!1,this.zpp_i=0,this.zpp_inner=null};Yt.__name__=["nape","dynamics","InteractionGroupIterator"],Yt.get=function(t){var e,i=null==Yt.zpp_pool?(Gn.internal=!0,e=new Yt,Gn.internal=!1,e):(Yt.zpp_pool=(i=Yt.zpp_pool).zpp_next,i);return i.zpp_i=0,i.zpp_inner=t,i.zpp_critical=!1,i},Yt.prototype.zpp_inner=null,Yt.prototype.zpp_i=null,Yt.prototype.zpp_critical=null,Yt.prototype.zpp_next=null,Yt.prototype.hasNext=function(){this.zpp_inner.zpp_inner.valmod();var t=this.zpp_inner;t.zpp_inner.valmod(),t.zpp_inner.zip_length&&(t.zpp_inner.zip_length=!1,t.zpp_inner.user_length=t.zpp_inner.inner.length);t=t.zpp_inner.user_length;return this.zpp_critical=!0,this.zpp_i<t||(this.zpp_next=Yt.zpp_pool,(Yt.zpp_pool=this).zpp_inner=null,!1)},Yt.prototype.next=function(){return this.zpp_critical=!1,this.zpp_inner.at(this.zpp_i++)},Yt.prototype.__class__=Yt;var F=nape.dynamics.InteractionGroupList=function(){this.zpp_inner=null,this.zpp_inner=new Gn,this.zpp_inner.outer=this};F.__name__=["nape","dynamics","InteractionGroupList"],F.fromArray=function(t){for(var e=new F,i=0;i<t.length;){var n=t[i];++i,e.push(n)}return e},F.prototype.zpp_inner=null,F.prototype.get_length=function(){return this.zpp_inner.valmod(),this.zpp_inner.zip_length&&(this.zpp_inner.zip_length=!1,this.zpp_inner.user_length=this.zpp_inner.inner.length),this.zpp_inner.user_length},F.prototype.has=function(t){return this.zpp_inner.valmod(),this.zpp_inner.inner.has(t.zpp_inner)},F.prototype.at=function(t){if(this.zpp_inner.valmod(),this.zpp_inner.reverse_flag&&(this.zpp_inner.valmod(),this.zpp_inner.zip_length&&(this.zpp_inner.zip_length=!1,this.zpp_inner.user_length=this.zpp_inner.inner.length),t=this.zpp_inner.user_length-1-t),t<this.zpp_inner.at_index||null==this.zpp_inner.at_ite)this.zpp_inner.at_index=t,this.zpp_inner.at_ite=this.zpp_inner.inner.iterator_at(t);else for(;this.zpp_inner.at_index!=t;)this.zpp_inner.at_index++,this.zpp_inner.at_ite=this.zpp_inner.at_ite.next;return this.zpp_inner.at_ite.elt.outer},F.prototype.push=function(t){this.zpp_inner.modify_test(),this.zpp_inner.valmod();var e,i=null==this.zpp_inner.adder||this.zpp_inner.adder(t);return i&&(this.zpp_inner.reverse_flag?this.zpp_inner.inner.add(t.zpp_inner):(null==this.zpp_inner.push_ite&&(e=null==this.zpp_inner.inner.head?null:(this.zpp_inner.valmod(),this.zpp_inner.zip_length&&(this.zpp_inner.zip_length=!1,this.zpp_inner.user_length=this.zpp_inner.inner.length),this.zpp_inner.inner.iterator_at(this.zpp_inner.user_length-1)),this.zpp_inner.push_ite=e),this.zpp_inner.push_ite=this.zpp_inner.inner.insert(this.zpp_inner.push_ite,t.zpp_inner)),this.zpp_inner.invalidate(),null!=this.zpp_inner.post_adder&&this.zpp_inner.post_adder(t)),i},F.prototype.unshift=function(t){this.zpp_inner.modify_test(),this.zpp_inner.valmod();var e,i=null==this.zpp_inner.adder||this.zpp_inner.adder(t);return i&&(this.zpp_inner.reverse_flag?(null==this.zpp_inner.push_ite&&(e=null==this.zpp_inner.inner.head?null:(this.zpp_inner.valmod(),this.zpp_inner.zip_length&&(this.zpp_inner.zip_length=!1,this.zpp_inner.user_length=this.zpp_inner.inner.length),this.zpp_inner.inner.iterator_at(this.zpp_inner.user_length-1)),this.zpp_inner.push_ite=e),this.zpp_inner.push_ite=this.zpp_inner.inner.insert(this.zpp_inner.push_ite,t.zpp_inner)):this.zpp_inner.inner.add(t.zpp_inner),this.zpp_inner.invalidate(),null!=this.zpp_inner.post_adder&&this.zpp_inner.post_adder(t)),i},F.prototype.pop=function(){this.zpp_inner.modify_test(),this.zpp_inner.valmod();var t,e,i=null;return this.zpp_inner.reverse_flag?(e=(i=this.zpp_inner.inner.head.elt).outer,null!=this.zpp_inner.subber&&this.zpp_inner.subber(e),this.zpp_inner.dontremove||this.zpp_inner.inner.pop()):(null!=this.zpp_inner.at_ite&&null==this.zpp_inner.at_ite.next&&(this.zpp_inner.at_ite=null),this.zpp_inner.valmod(),this.zpp_inner.zip_length&&(this.zpp_inner.zip_length=!1,this.zpp_inner.user_length=this.zpp_inner.inner.length),e=(i=(null==(t=1==this.zpp_inner.user_length?null:(this.zpp_inner.valmod(),this.zpp_inner.zip_length&&(this.zpp_inner.zip_length=!1,this.zpp_inner.user_length=this.zpp_inner.inner.length),this.zpp_inner.inner.iterator_at(this.zpp_inner.user_length-2)))?this.zpp_inner.inner.head:t.next).elt).outer,null!=this.zpp_inner.subber&&this.zpp_inner.subber(e),this.zpp_inner.dontremove||this.zpp_inner.inner.erase(t)),this.zpp_inner.invalidate(),i.outer},F.prototype.shift=function(){this.zpp_inner.modify_test(),this.zpp_inner.valmod();var t,e,i=null;return this.zpp_inner.reverse_flag?(null!=this.zpp_inner.at_ite&&null==this.zpp_inner.at_ite.next&&(this.zpp_inner.at_ite=null),this.zpp_inner.valmod(),this.zpp_inner.zip_length&&(this.zpp_inner.zip_length=!1,this.zpp_inner.user_length=this.zpp_inner.inner.length),t=(i=(null==(e=1==this.zpp_inner.user_length?null:(this.zpp_inner.valmod(),this.zpp_inner.zip_length&&(this.zpp_inner.zip_length=!1,this.zpp_inner.user_length=this.zpp_inner.inner.length),this.zpp_inner.inner.iterator_at(this.zpp_inner.user_length-2)))?this.zpp_inner.inner.head:e.next).elt).outer,null!=this.zpp_inner.subber&&this.zpp_inner.subber(t),this.zpp_inner.dontremove||this.zpp_inner.inner.erase(e)):(e=(i=this.zpp_inner.inner.head.elt).outer,null!=this.zpp_inner.subber&&this.zpp_inner.subber(e),this.zpp_inner.dontremove||this.zpp_inner.inner.pop()),this.zpp_inner.invalidate(),i.outer},F.prototype.add=function(t){return this.zpp_inner.reverse_flag?this.push(t):this.unshift(t)},F.prototype.remove=function(t){this.zpp_inner.modify_test(),this.zpp_inner.valmod();for(var e=!1,i=this.zpp_inner.inner.head;null!=i;){if(i.elt==t.zpp_inner){e=!0;break}i=i.next}return e&&(null!=this.zpp_inner.subber&&this.zpp_inner.subber(t),this.zpp_inner.dontremove||this.zpp_inner.inner.remove(t.zpp_inner),this.zpp_inner.invalidate()),e},F.prototype.clear=function(){if(this.zpp_inner.reverse_flag)for(;null!=this.zpp_inner.inner.head;)this.pop();else for(;null!=this.zpp_inner.inner.head;)this.shift()},F.prototype.empty=function(){return null==this.zpp_inner.inner.head},F.prototype.iterator=function(){return this.zpp_inner.valmod(),Yt.get(this)},F.prototype.copy=function(t){null==t&&(t=!1);var e=new F;this.zpp_inner.valmod();for(var i=Yt.get(this);;){i.zpp_inner.zpp_inner.valmod();var n=i.zpp_inner;n.zpp_inner.valmod(),n.zpp_inner.zip_length&&(n.zpp_inner.zip_length=!1,n.zpp_inner.user_length=n.zpp_inner.inner.length);n=n.zpp_inner.user_length;if(i.zpp_critical=!0,!(i.zpp_i<n||(i.zpp_next=Yt.zpp_pool,(Yt.zpp_pool=i).zpp_inner=null,!1)))break;i.zpp_critical=!1;n=i.zpp_inner.at(i.zpp_i++);e.push(t?null:n)}return e},F.prototype.merge=function(t){t.zpp_inner.valmod();for(var e=Yt.get(t);;){e.zpp_inner.zpp_inner.valmod();var i=e.zpp_inner;i.zpp_inner.valmod(),i.zpp_inner.zip_length&&(i.zpp_inner.zip_length=!1,i.zpp_inner.user_length=i.zpp_inner.inner.length);i=i.zpp_inner.user_length;if(e.zpp_critical=!0,!(e.zpp_i<i||(e.zpp_next=Yt.zpp_pool,(Yt.zpp_pool=e).zpp_inner=null,!1)))break;e.zpp_critical=!1;i=e.zpp_inner.at(e.zpp_i++);this.has(i)||(this.zpp_inner.reverse_flag?this.push(i):this.unshift(i))}},F.prototype.toString=function(){var t="[",e=!0;this.zpp_inner.valmod();for(var i=Yt.get(this);;){i.zpp_inner.zpp_inner.valmod();var n=i.zpp_inner;n.zpp_inner.valmod(),n.zpp_inner.zip_length&&(n.zpp_inner.zip_length=!1,n.zpp_inner.user_length=n.zpp_inner.inner.length);n=n.zpp_inner.user_length;if(i.zpp_critical=!0,!(i.zpp_i<n||(i.zpp_next=Yt.zpp_pool,(Yt.zpp_pool=i).zpp_inner=null,!1)))break;i.zpp_critical=!1;n=i.zpp_inner.at(i.zpp_i++);e||(t+=","),t+=null==n?"NULL":n.toString(),e=!1}return t+"]"},F.prototype.foreach=function(t){this.zpp_inner.valmod();for(var e=Yt.get(this);;){e.zpp_inner.zpp_inner.valmod();var i=e.zpp_inner;i.zpp_inner.valmod(),i.zpp_inner.zip_length&&(i.zpp_inner.zip_length=!1,i.zpp_inner.user_length=i.zpp_inner.inner.length);i=i.zpp_inner.user_length;if(e.zpp_critical=!0,!(e.zpp_i<i||(e.zpp_next=Yt.zpp_pool,(Yt.zpp_pool=e).zpp_inner=null,!1)))break;try{e.zpp_critical=!1,t(e.zpp_inner.at(e.zpp_i++))}catch(t){e.zpp_next=Yt.zpp_pool,(Yt.zpp_pool=e).zpp_inner=null;break}}return this},F.prototype.filter=function(t){for(var e=0;;){if(this.zpp_inner.valmod(),this.zpp_inner.zip_length&&(this.zpp_inner.zip_length=!1,this.zpp_inner.user_length=this.zpp_inner.inner.length),!(e<this.zpp_inner.user_length))break;var i=this.at(e);try{t(i)?++e:this.remove(i)}catch(t){break}}return this},Object.defineProperty(F.prototype,"length",{get:F.prototype.get_length}),F.prototype.__class__=F;var N=nape.geom.AABB=function(t,e,i,n){var r;null==n&&(n=0),null==i&&(i=0),null==e&&(e=0),null==t&&(t=0),(this.zpp_inner=null)==De.zpp_pool?r=new De:(r=De.zpp_pool,De.zpp_pool=r.next,r.next=null),r.minx=t,r.miny=e,r.maxx=t+i,r.maxy=e+n,this.zpp_inner=r,this.zpp_inner.outer=this};N.__name__=["nape","geom","AABB"],N.prototype.zpp_inner=null,N.prototype.copy=function(){var t=this.zpp_inner;null!=t._validate&&t._validate();var e,i=this.zpp_inner,n=i.minx,r=i.miny,t=i.maxx,i=i.maxy;return null==De.zpp_pool?e=new De:(e=De.zpp_pool,De.zpp_pool=e.next,e.next=null),e.minx=n,e.miny=r,e.maxx=t,e.maxy=i,e.wrapper()},N.prototype.get_min=function(){return this.zpp_inner.getmin()},N.prototype.set_min=function(t){var e=this.zpp_inner.getmin(),i=t.zpp_inner;null!=i._validate&&i._validate();var n=t.zpp_inner.x,r=t.zpp_inner;null!=r._validate&&r._validate();var o,i=t.zpp_inner.y,r=e.zpp_inner;return null!=r._validate&&r._validate(),e.zpp_inner.x==n&&(null!=(r=e.zpp_inner)._validate&&r._validate(),e.zpp_inner.y==i)||(e.zpp_inner.x=n,e.zpp_inner.y=i,null!=(o=e.zpp_inner)._invalidate&&o._invalidate(o)),t.zpp_inner.weak&&(o=t.zpp_inner,t.zpp_inner.outer=null,t.zpp_inner=null,t.zpp_pool=Bn.poolVec2,Bn.poolVec2=t,null!=o.outer&&(o.outer.zpp_inner=null,o.outer=null),o._isimmutable=null,o._validate=null,o._invalidate=null,o.next=Gr.zpp_pool,Gr.zpp_pool=o),this.zpp_inner.getmin()},N.prototype.get_max=function(){return this.zpp_inner.getmax()},N.prototype.set_max=function(t){var e=this.zpp_inner.getmax(),i=t.zpp_inner;null!=i._validate&&i._validate();var n=t.zpp_inner.x,r=t.zpp_inner;null!=r._validate&&r._validate();var o,i=t.zpp_inner.y,r=e.zpp_inner;return null!=r._validate&&r._validate(),e.zpp_inner.x==n&&(null!=(r=e.zpp_inner)._validate&&r._validate(),e.zpp_inner.y==i)||(e.zpp_inner.x=n,e.zpp_inner.y=i,null!=(o=e.zpp_inner)._invalidate&&o._invalidate(o)),t.zpp_inner.weak&&(o=t.zpp_inner,t.zpp_inner.outer=null,t.zpp_inner=null,t.zpp_pool=Bn.poolVec2,Bn.poolVec2=t,null!=o.outer&&(o.outer.zpp_inner=null,o.outer=null),o._isimmutable=null,o._validate=null,o._invalidate=null,o.next=Gr.zpp_pool,Gr.zpp_pool=o),this.zpp_inner.getmax()},N.prototype.get_x=function(){var t=this.zpp_inner;return null!=t._validate&&t._validate(),this.zpp_inner.minx},N.prototype.set_x=function(t){var e=this.zpp_inner;null!=e._validate&&e._validate(),this.zpp_inner.minx!=t&&(this.zpp_inner.maxx+=t-this.zpp_inner.minx,this.zpp_inner.minx=t,null!=(i=this.zpp_inner)._invalidate&&i._invalidate(i));var i=this.zpp_inner;return null!=i._validate&&i._validate(),this.zpp_inner.minx},N.prototype.get_y=function(){var t=this.zpp_inner;return null!=t._validate&&t._validate(),this.zpp_inner.miny},N.prototype.set_y=function(t){var e=this.zpp_inner;null!=e._validate&&e._validate(),this.zpp_inner.miny!=t&&(this.zpp_inner.maxy+=t-this.zpp_inner.miny,this.zpp_inner.miny=t,null!=(i=this.zpp_inner)._invalidate&&i._invalidate(i));var i=this.zpp_inner;return null!=i._validate&&i._validate(),this.zpp_inner.miny},N.prototype.get_width=function(){var t=this.zpp_inner;null!=t._validate&&t._validate();t=this.zpp_inner;return t.maxx-t.minx},N.prototype.set_width=function(t){var e=this.zpp_inner;null!=e._validate&&e._validate();e=this.zpp_inner;e.maxx-e.minx!=t&&(null!=(i=this.zpp_inner)._validate&&i._validate(),this.zpp_inner.maxx=this.zpp_inner.minx+t,null!=(i=this.zpp_inner)._invalidate&&i._invalidate(i));var i=this.zpp_inner;null!=i._validate&&i._validate();i=this.zpp_inner;return i.maxx-i.minx},N.prototype.get_height=function(){var t=this.zpp_inner;null!=t._validate&&t._validate();t=this.zpp_inner;return t.maxy-t.miny},N.prototype.set_height=function(t){var e=this.zpp_inner;null!=e._validate&&e._validate();e=this.zpp_inner;e.maxy-e.miny!=t&&(null!=(i=this.zpp_inner)._validate&&i._validate(),this.zpp_inner.maxy=this.zpp_inner.miny+t,null!=(i=this.zpp_inner)._invalidate&&i._invalidate(i));var i=this.zpp_inner;null!=i._validate&&i._validate();i=this.zpp_inner;return i.maxy-i.miny},N.prototype.toString=function(){var t=this.zpp_inner;return null!=t._validate&&t._validate(),this.zpp_inner.toString()},Object.defineProperty(N.prototype,"min",{get:N.prototype.get_min,set:N.prototype.set_min}),Object.defineProperty(N.prototype,"max",{get:N.prototype.get_max,set:N.prototype.set_max}),Object.defineProperty(N.prototype,"x",{get:N.prototype.get_x,set:N.prototype.set_x}),Object.defineProperty(N.prototype,"y",{get:N.prototype.get_y,set:N.prototype.set_y}),Object.defineProperty(N.prototype,"width",{get:N.prototype.get_width,set:N.prototype.set_width}),Object.defineProperty(N.prototype,"height",{get:N.prototype.get_height,set:N.prototype.set_height}),N.prototype.__class__=N;var j=nape.geom.ConvexResult=function(){this.zpp_inner=null};j.__name__=["nape","geom","ConvexResult"],j.prototype.zpp_inner=null,j.prototype.get_normal=function(){return this.zpp_inner.normal},j.prototype.get_position=function(){return this.zpp_inner.position},j.prototype.get_toi=function(){return this.zpp_inner.toiDistance},j.prototype.get_shape=function(){return this.zpp_inner.shape},j.prototype.dispose=function(){this.zpp_inner.free()},j.prototype.toString=function(){return"{ shape: "+n.string(this.zpp_inner.shape)+" toi: "+this.zpp_inner.toiDistance+" }"},Object.defineProperty(j.prototype,"normal",{get:j.prototype.get_normal}),Object.defineProperty(j.prototype,"position",{get:j.prototype.get_position}),Object.defineProperty(j.prototype,"toi",{get:j.prototype.get_toi}),Object.defineProperty(j.prototype,"shape",{get:j.prototype.get_shape}),j.prototype.__class__=j;var Kt=nape.geom.ConvexResultIterator=function(){this.zpp_next=null,this.zpp_critical=!1,this.zpp_i=0,this.zpp_inner=null};Kt.__name__=["nape","geom","ConvexResultIterator"],Kt.get=function(t){var e,i=null==Kt.zpp_pool?(On.internal=!0,e=new Kt,On.internal=!1,e):(Kt.zpp_pool=(i=Kt.zpp_pool).zpp_next,i);return i.zpp_i=0,i.zpp_inner=t,i.zpp_critical=!1,i},Kt.prototype.zpp_inner=null,Kt.prototype.zpp_i=null,Kt.prototype.zpp_critical=null,Kt.prototype.zpp_next=null,Kt.prototype.hasNext=function(){this.zpp_inner.zpp_inner.valmod();var t=this.zpp_inner;t.zpp_inner.valmod(),t.zpp_inner.zip_length&&(t.zpp_inner.zip_length=!1,t.zpp_inner.user_length=t.zpp_inner.inner.length);t=t.zpp_inner.user_length;return this.zpp_critical=!0,this.zpp_i<t||(this.zpp_next=Kt.zpp_pool,(Kt.zpp_pool=this).zpp_inner=null,!1)},Kt.prototype.next=function(){return this.zpp_critical=!1,this.zpp_inner.at(this.zpp_i++)},Kt.prototype.__class__=Kt;var bt=nape.geom.ConvexResultList=function(){this.zpp_inner=null,this.zpp_inner=new On,this.zpp_inner.outer=this};bt.__name__=["nape","geom","ConvexResultList"],bt.fromArray=function(t){for(var e=new bt,i=0;i<t.length;){var n=t[i];++i,e.push(n)}return e},bt.prototype.zpp_inner=null,bt.prototype.get_length=function(){return this.zpp_inner.valmod(),this.zpp_inner.zip_length&&(this.zpp_inner.zip_length=!1,this.zpp_inner.user_length=this.zpp_inner.inner.length),this.zpp_inner.user_length},bt.prototype.has=function(t){return this.zpp_inner.valmod(),this.zpp_inner.inner.has(t)},bt.prototype.at=function(t){if(this.zpp_inner.valmod(),this.zpp_inner.reverse_flag&&(this.zpp_inner.valmod(),this.zpp_inner.zip_length&&(this.zpp_inner.zip_length=!1,this.zpp_inner.user_length=this.zpp_inner.inner.length),t=this.zpp_inner.user_length-1-t),t<this.zpp_inner.at_index||null==this.zpp_inner.at_ite)this.zpp_inner.at_index=t,this.zpp_inner.at_ite=this.zpp_inner.inner.iterator_at(t);else for(;this.zpp_inner.at_index!=t;)this.zpp_inner.at_index++,this.zpp_inner.at_ite=this.zpp_inner.at_ite.next;return this.zpp_inner.at_ite.elt},bt.prototype.push=function(t){this.zpp_inner.modify_test(),this.zpp_inner.valmod();var e,i=null==this.zpp_inner.adder||this.zpp_inner.adder(t);return i&&(this.zpp_inner.reverse_flag?this.zpp_inner.inner.add(t):(null==this.zpp_inner.push_ite&&(e=null==this.zpp_inner.inner.head?null:(this.zpp_inner.valmod(),this.zpp_inner.zip_length&&(this.zpp_inner.zip_length=!1,this.zpp_inner.user_length=this.zpp_inner.inner.length),this.zpp_inner.inner.iterator_at(this.zpp_inner.user_length-1)),this.zpp_inner.push_ite=e),this.zpp_inner.push_ite=this.zpp_inner.inner.insert(this.zpp_inner.push_ite,t)),this.zpp_inner.invalidate(),null!=this.zpp_inner.post_adder&&this.zpp_inner.post_adder(t)),i},bt.prototype.unshift=function(t){this.zpp_inner.modify_test(),this.zpp_inner.valmod();var e,i=null==this.zpp_inner.adder||this.zpp_inner.adder(t);return i&&(this.zpp_inner.reverse_flag?(null==this.zpp_inner.push_ite&&(e=null==this.zpp_inner.inner.head?null:(this.zpp_inner.valmod(),this.zpp_inner.zip_length&&(this.zpp_inner.zip_length=!1,this.zpp_inner.user_length=this.zpp_inner.inner.length),this.zpp_inner.inner.iterator_at(this.zpp_inner.user_length-1)),this.zpp_inner.push_ite=e),this.zpp_inner.push_ite=this.zpp_inner.inner.insert(this.zpp_inner.push_ite,t)):this.zpp_inner.inner.add(t),this.zpp_inner.invalidate(),null!=this.zpp_inner.post_adder&&this.zpp_inner.post_adder(t)),i},bt.prototype.pop=function(){this.zpp_inner.modify_test(),this.zpp_inner.valmod();var t,e,i=null;return this.zpp_inner.reverse_flag?(e=i=this.zpp_inner.inner.head.elt,null!=this.zpp_inner.subber&&this.zpp_inner.subber(e),this.zpp_inner.dontremove||this.zpp_inner.inner.pop()):(null!=this.zpp_inner.at_ite&&null==this.zpp_inner.at_ite.next&&(this.zpp_inner.at_ite=null),this.zpp_inner.valmod(),this.zpp_inner.zip_length&&(this.zpp_inner.zip_length=!1,this.zpp_inner.user_length=this.zpp_inner.inner.length),e=i=(null==(t=1==this.zpp_inner.user_length?null:(this.zpp_inner.valmod(),this.zpp_inner.zip_length&&(this.zpp_inner.zip_length=!1,this.zpp_inner.user_length=this.zpp_inner.inner.length),this.zpp_inner.inner.iterator_at(this.zpp_inner.user_length-2)))?this.zpp_inner.inner.head:t.next).elt,null!=this.zpp_inner.subber&&this.zpp_inner.subber(e),this.zpp_inner.dontremove||this.zpp_inner.inner.erase(t)),this.zpp_inner.invalidate(),i},bt.prototype.shift=function(){this.zpp_inner.modify_test(),this.zpp_inner.valmod();var t,e,i=null;return this.zpp_inner.reverse_flag?(null!=this.zpp_inner.at_ite&&null==this.zpp_inner.at_ite.next&&(this.zpp_inner.at_ite=null),this.zpp_inner.valmod(),this.zpp_inner.zip_length&&(this.zpp_inner.zip_length=!1,this.zpp_inner.user_length=this.zpp_inner.inner.length),t=i=(null==(e=1==this.zpp_inner.user_length?null:(this.zpp_inner.valmod(),this.zpp_inner.zip_length&&(this.zpp_inner.zip_length=!1,this.zpp_inner.user_length=this.zpp_inner.inner.length),this.zpp_inner.inner.iterator_at(this.zpp_inner.user_length-2)))?this.zpp_inner.inner.head:e.next).elt,null!=this.zpp_inner.subber&&this.zpp_inner.subber(t),this.zpp_inner.dontremove||this.zpp_inner.inner.erase(e)):(e=i=this.zpp_inner.inner.head.elt,null!=this.zpp_inner.subber&&this.zpp_inner.subber(e),this.zpp_inner.dontremove||this.zpp_inner.inner.pop()),this.zpp_inner.invalidate(),i},bt.prototype.add=function(t){return this.zpp_inner.reverse_flag?this.push(t):this.unshift(t)},bt.prototype.remove=function(t){this.zpp_inner.modify_test(),this.zpp_inner.valmod();for(var e=!1,i=this.zpp_inner.inner.head;null!=i;){if(i.elt==t){e=!0;break}i=i.next}return e&&(null!=this.zpp_inner.subber&&this.zpp_inner.subber(t),this.zpp_inner.dontremove||this.zpp_inner.inner.remove(t),this.zpp_inner.invalidate()),e},bt.prototype.clear=function(){if(this.zpp_inner.reverse_flag)for(;null!=this.zpp_inner.inner.head;)this.pop();else for(;null!=this.zpp_inner.inner.head;)this.shift()},bt.prototype.empty=function(){return null==this.zpp_inner.inner.head},bt.prototype.iterator=function(){return this.zpp_inner.valmod(),Kt.get(this)},bt.prototype.copy=function(t){null==t&&(t=!1);var e=new bt;this.zpp_inner.valmod();for(var i=Kt.get(this);;){i.zpp_inner.zpp_inner.valmod();var n=i.zpp_inner;n.zpp_inner.valmod(),n.zpp_inner.zip_length&&(n.zpp_inner.zip_length=!1,n.zpp_inner.user_length=n.zpp_inner.inner.length);n=n.zpp_inner.user_length;if(i.zpp_critical=!0,!(i.zpp_i<n||(i.zpp_next=Kt.zpp_pool,(Kt.zpp_pool=i).zpp_inner=null,!1)))break;i.zpp_critical=!1;n=i.zpp_inner.at(i.zpp_i++);e.push(t?null:n)}return e},bt.prototype.merge=function(t){t.zpp_inner.valmod();for(var e=Kt.get(t);;){e.zpp_inner.zpp_inner.valmod();var i=e.zpp_inner;i.zpp_inner.valmod(),i.zpp_inner.zip_length&&(i.zpp_inner.zip_length=!1,i.zpp_inner.user_length=i.zpp_inner.inner.length);i=i.zpp_inner.user_length;if(e.zpp_critical=!0,!(e.zpp_i<i||(e.zpp_next=Kt.zpp_pool,(Kt.zpp_pool=e).zpp_inner=null,!1)))break;e.zpp_critical=!1;i=e.zpp_inner.at(e.zpp_i++);this.has(i)||(this.zpp_inner.reverse_flag?this.push(i):this.unshift(i))}},bt.prototype.toString=function(){var t="[",e=!0;this.zpp_inner.valmod();for(var i=Kt.get(this);;){i.zpp_inner.zpp_inner.valmod();var n=i.zpp_inner;n.zpp_inner.valmod(),n.zpp_inner.zip_length&&(n.zpp_inner.zip_length=!1,n.zpp_inner.user_length=n.zpp_inner.inner.length);n=n.zpp_inner.user_length;if(i.zpp_critical=!0,!(i.zpp_i<n||(i.zpp_next=Kt.zpp_pool,(Kt.zpp_pool=i).zpp_inner=null,!1)))break;i.zpp_critical=!1;n=i.zpp_inner.at(i.zpp_i++);e||(t+=","),t+=null==n?"NULL":n.toString(),e=!1}return t+"]"},bt.prototype.foreach=function(t){this.zpp_inner.valmod();for(var e=Kt.get(this);;){e.zpp_inner.zpp_inner.valmod();var i=e.zpp_inner;i.zpp_inner.valmod(),i.zpp_inner.zip_length&&(i.zpp_inner.zip_length=!1,i.zpp_inner.user_length=i.zpp_inner.inner.length);i=i.zpp_inner.user_length;if(e.zpp_critical=!0,!(e.zpp_i<i||(e.zpp_next=Kt.zpp_pool,(Kt.zpp_pool=e).zpp_inner=null,!1)))break;try{e.zpp_critical=!1,t(e.zpp_inner.at(e.zpp_i++))}catch(t){e.zpp_next=Kt.zpp_pool,(Kt.zpp_pool=e).zpp_inner=null;break}}return this},bt.prototype.filter=function(t){for(var e=0;;){if(this.zpp_inner.valmod(),this.zpp_inner.zip_length&&(this.zpp_inner.zip_length=!1,this.zpp_inner.user_length=this.zpp_inner.inner.length),!(e<this.zpp_inner.user_length))break;var i=this.at(e);try{t(i)?++e:this.remove(i)}catch(t){break}}return this},Object.defineProperty(bt.prototype,"length",{get:bt.prototype.get_length}),bt.prototype.__class__=bt;o=nape.geom.Geom=function(){};o.__name__=["nape","geom","Geom"],o.distanceBody=function(t,e,i,n){for(var r=t.zpp_inner.shapes.head;null!=r;)ye.validateShape(r.elt),r=r.next;for(var o=e.zpp_inner.shapes.head;null!=o;)ye.validateShape(o.elt),o=o.next;return Ie.distanceBody(t.zpp_inner,e.zpp_inner,i.zpp_inner,n.zpp_inner)},o.distance=function(t,e,i,n){ye.validateShape(t.zpp_inner),ye.validateShape(e.zpp_inner),null==Gr.zpp_pool?lt=new Gr:(lt=Gr.zpp_pool,Gr.zpp_pool=lt.next,lt.next=null),lt.weak=!1;var r=t.zpp_inner,o=e.zpp_inner,s=i.zpp_inner,a=n.zpp_inner;if(0==r.type&&0==o.type){var h,t=r.circle,e=o.circle,i=0,l=0,i=e.worldCOMx-t.worldCOMx,l=e.worldCOMy-t.worldCOMy,n=Math.sqrt(i*i+l*l),p=n-(t.radius+e.radius);p<1e100&&(0==n?(i=1,l=0):(i*=h=1/n,l*=h),h=t.radius,s.x=t.worldCOMx+i*h,s.y=t.worldCOMy+l*h,h=-e.radius,a.x=e.worldCOMx+i*h,a.y=e.worldCOMy+l*h,lt.x=i,lt.y=l),l=p}else{p=!1;if(0==r.type&&1==o.type&&(d=r,r=o,o=d,u=s,s=a,a=u,p=!0),1==r.type&&0==o.type){for(var u,d=r.polygon,c=o.circle,y=-1e100,_=null,m=d.edges.head;null!=m;){var g=m.elt,f=g.gnormx*c.worldCOMx+g.gnormy*c.worldCOMy-g.gprojection-c.radius;if(1e100<f){y=f;break}0<f?y<f&&(y=f,_=g):y<0&&y<f&&(y=f,_=g),m=m.next}y<1e100&&(u=_.gp0,W=_.gp1,(H=c.worldCOMy*_.gnormx-c.worldCOMx*_.gnormy)<=u.y*_.gnormx-u.x*_.gnormy?(R=B=0,B=c.worldCOMx-u.x,R=c.worldCOMy-u.y,(y=(d=Math.sqrt(B*B+R*R))-c.radius)<1e100&&(0==d?(B=1,R=0):(B*=L=1/d,R*=L),s.x=u.x+0*B,s.y=u.y+0*R,L=-c.radius,a.x=c.worldCOMx+B*L,a.y=c.worldCOMy+R*L,lt.x=B,lt.y=R)):H>=W.y*_.gnormx-W.x*_.gnormy?(N=F=0,F=c.worldCOMx-W.x,N=c.worldCOMy-W.y,(y=(K=Math.sqrt(F*F+N*N))-c.radius)<1e100&&(0==K?(F=1,N=0):(F*=V=1/K,N*=V),s.x=W.x+0*F,s.y=W.y+0*N,Y=-c.radius,a.x=c.worldCOMx+F*Y,a.y=c.worldCOMy+N*Y,lt.x=F,lt.y=N)):(X=-c.radius,a.x=c.worldCOMx+_.gnormx*X,a.y=c.worldCOMy+_.gnormy*X,s.x=a.x+_.gnormx*(j=-y),s.y=a.y+_.gnormy*j,lt.x=_.gnormx,lt.y=_.gnormy)),p&&(lt.x=-lt.x,lt.y=-lt.y),l=y}else{for(var x=r.polygon,v=o.polygon,w=-1e100,z=null,b=null,S=0,C=x.edges.head;null!=C;){for(var P=C.elt,M=1e100,T=v.gverts.next;null!=T;){var A=T,A=P.gnormx*A.x+P.gnormy*A.y;A<M&&(M=A),T=T.next}if(1e100<(M-=P.gprojection)){w=M;break}0<M?w<M&&(w=M,z=P,S=1):w<0&&w<M&&(w=M,z=P,S=1),C=C.next}if(w<1e100){for(var k,O=v.edges.head;null!=O;){for(var E=O.elt,I=1e100,G=x.gverts.next;null!=G;){var D=G,D=E.gnormx*D.x+E.gnormy*D.y;D<I&&(I=D),G=G.next}if(1e100<(I-=E.gprojection)){w=I;break}0<I?w<I&&(w=I,b=E,S=2):w<0&&w<I&&(w=I,b=E,S=2),O=O.next}if(w<1e100){1==S?(q=v,k=z):(q=x,k=b,U=s,s=a,a=U,p=!p);for(var L,B,R,F,N,j,U,V,W,X,H,q,Y,K,Z,J,Q,$,tt,et,it,nt,rt=null,ot=1e100,st=q.edges.head;null!=st;){var at=st.elt,ht=k.gnormx*at.gnormx+k.gnormy*at.gnormy;ht<ot&&(ot=ht,rt=at),st=st.next}p?(lt.x=-k.gnormx,lt.y=-k.gnormy):(lt.x=k.gnormx,lt.y=k.gnormy),l=0<=w?(L=k.gp0,B=k.gp1,R=rt.gp0,Q=rt.gp1,Z=K=et=H=0,V=1/((H=B.x-L.x)*H+(et=B.y-L.y)*et),W=1/((K=Q.x-R.x)*K+(Z=Q.y-R.y)*Z),(it=-(H*(L.x-R.x)+et*(L.y-R.y))*V)<0?it=0:1<it&&(it=1),(J=-(H*(L.x-Q.x)+et*(L.y-Q.y))*V)<0?J=0:1<J&&(J=1),(tt=-(K*(R.x-L.x)+Z*(R.y-L.y))*W)<0?tt=0:1<tt&&(tt=1),(Y=-(K*(R.x-B.x)+Z*(R.y-B.y))*W)<0?Y=0:1<Y&&(Y=1),N=F=0,X=it,F=L.x+H*X,N=L.y+et*X,nt=j=0,r=J,j=L.x+H*r,nt=L.y+et*r,U=o=0,q=tt,o=R.x+K*q,U=R.y+Z*q,W=V=0,it=Y,V=R.x+K*it,W=R.y+Z*it,Z=K=Y=q=tt=r=et=H=J=X=0,it=null,(J=(X=F-R.x)*X+(J=N-R.y)*J)<(et=(H=j-Q.x)*H+(et=nt-Q.y)*et)?(K=F,Z=N,it=R):(K=j,Z=nt,it=Q,J=et),Q=nt=0,et=null,(tt=(r=o-L.x)*r+(tt=U-L.y)*tt)<(Y=(q=V-B.x)*q+(Y=W-B.y)*Y)?(nt=o,Q=U,et=L):(nt=V,Q=W,et=B,tt=Y),0!=(w=J<tt?(s.x=K,s.y=Z,a.x=it.x,a.y=it.y,Math.sqrt(J)):(a.x=nt,a.y=Q,s.x=et.x,s.y=et.y,Math.sqrt(tt)))&&(lt.x=a.x-s.x,lt.y=a.y-s.y,lt.x*=$=1/w,lt.y*=$,p&&(lt.x=-lt.x,lt.y=-lt.y)),w):(it=Z=0,Z=rt.gp0.x,it=rt.gp0.y,et=Q=nt=J=0,Q=(J=rt.gp1.x)-Z,et=(nt=rt.gp1.y)-it,tt=k.gnormy*Z-k.gnormx*it,$=k.gnormy*J-k.gnormx*nt,tt=(-k.tp1-tt)*(p=1/($-tt)),Er.epsilon<tt&&(Z+=Q*tt,it+=et*tt),(p=(-k.tp0-$)*p)<-Er.epsilon&&(J+=Q*p,nt+=et*p),(et=Z*k.gnormx+it*k.gnormy-k.gprojection)<(p=J*k.gnormx+nt*k.gnormy-k.gprojection)?(a.x=Z,a.y=it,s.x=a.x+k.gnormx*(it=-et),s.y=a.y+k.gnormy*it,et):(a.x=J,a.y=nt,s.x=a.x+k.gnormx*(nt=-p),s.y=a.y+k.gnormy*nt,p))}else l=1e100}else l=1e100}}var lt=lt;return null!=lt.outer&&(lt.outer.zpp_inner=null,lt.outer=null),lt._isimmutable=null,lt._validate=null,lt._invalidate=null,lt.next=Gr.zpp_pool,Gr.zpp_pool=lt,l},o.intersectsBody=function(t,e){for(var i=t.zpp_inner.shapes.head;null!=i;)ye.validateShape(i.elt),i=i.next;for(var n=e.zpp_inner.shapes.head;null!=n;)ye.validateShape(n.elt),n=n.next;var r=t.zpp_inner.aabb,o=e.zpp_inner.aabb;if(o.miny<=r.maxy&&r.miny<=o.maxy&&o.minx<=r.maxx&&r.minx<=o.maxx){for(var s=t.zpp_inner.shapes.head;null!=s;){for(var a=s.elt,h=e.zpp_inner.shapes.head;null!=h;){if(Ir.testCollide_safe(a,h.elt))return!0;h=h.next}s=s.next}return!1}return!1},o.intersects=function(t,e){ye.validateShape(t.zpp_inner),ye.validateShape(e.zpp_inner);var i=t.zpp_inner.aabb,n=e.zpp_inner.aabb;return n.miny<=i.maxy&&i.miny<=n.maxy&&n.minx<=i.maxx&&i.minx<=n.maxx&&Ir.testCollide_safe(t.zpp_inner,e.zpp_inner)},o.contains=function(t,e){return ye.validateShape(t.zpp_inner),ye.validateShape(e.zpp_inner),Ir.containTest(t.zpp_inner,e.zpp_inner)},o.prototype.__class__=o;var _i=nape.geom.GeomPoly=function(t){if(this.zpp_inner=null,this.zpp_pool=null,this.zpp_inner=new _e(this),null!=t){if(t instanceof Array&&null==t.__enum__)for(var e=t,i=0;i<e.length;){var n=e[i];++i;var r=n,o=r.zpp_inner;null!=o._validate&&o._validate();n=r.zpp_inner.x,o=r.zpp_inner;null!=o._validate&&o._validate();var s,r=r.zpp_inner.y;null==nn.zpp_pool?s=new nn:(s=nn.zpp_pool,nn.zpp_pool=s.next,s.next=null),s.forced=!1,s.x=n,s.y=r;r=s;null==this.zpp_inner.vertices?this.zpp_inner.vertices=r.prev=r.next=r:(r.prev=this.zpp_inner.vertices,r.next=this.zpp_inner.vertices.next,this.zpp_inner.vertices.next.prev=r,this.zpp_inner.vertices.next=r),this.zpp_inner.vertices=r}else if(R.__instanceof(t,Y))for(var a=t.iterator();;){a.zpp_inner.zpp_inner.valmod();var h=a.zpp_inner.zpp_gl();if(a.zpp_critical=!0,!(a.zpp_i<h||(a.zpp_next=Qt.zpp_pool,(Qt.zpp_pool=a).zpp_inner=null,!1)))break;a.zpp_critical=!1;var l=a.zpp_inner.at(a.zpp_i++),p=l.zpp_inner;null!=p._validate&&p._validate();h=l.zpp_inner.x,p=l.zpp_inner;null!=p._validate&&p._validate();var u,l=l.zpp_inner.y;null==nn.zpp_pool?u=new nn:(u=nn.zpp_pool,nn.zpp_pool=u.next,u.next=null),u.forced=!1,u.x=h,u.y=l;l=u;null==this.zpp_inner.vertices?this.zpp_inner.vertices=l.prev=l.next=l:(l.prev=this.zpp_inner.vertices,l.next=this.zpp_inner.vertices.next,this.zpp_inner.vertices.next.prev=l,this.zpp_inner.vertices.next=l),this.zpp_inner.vertices=l}else if(R.__instanceof(t,_i)){var d=t.zpp_inner.vertices;if(null!=d)for(var c=d;;){var y,_,m,g=c.x,f=c.y;null==Bn.poolVec2?y=new St:(y=Bn.poolVec2,Bn.poolVec2=y.zpp_pool,y.zpp_pool=null),null==y.zpp_inner?(null==Gr.zpp_pool?_=new Gr:(_=Gr.zpp_pool,Gr.zpp_pool=_.next,_.next=null),_.weak=!1,_._immutable=!1,_.x=g,_.y=f,y.zpp_inner=_,y.zpp_inner.outer=y):(null!=(m=y.zpp_inner)._validate&&m._validate(),y.zpp_inner.x==g&&(null!=(m=y.zpp_inner)._validate&&m._validate(),y.zpp_inner.y==f)||(y.zpp_inner.x=g,y.zpp_inner.y=f,null!=(x=y.zpp_inner)._invalidate&&x._invalidate(x))),y.zpp_inner.weak=!1;g=y,c=c.next,f=g.zpp_inner;null!=f._validate&&f._validate();var x=g.zpp_inner.x,f=g.zpp_inner;null!=f._validate&&f._validate();var v,f=g.zpp_inner.y;null==nn.zpp_pool?v=new nn:(v=nn.zpp_pool,nn.zpp_pool=v.next,v.next=null),v.forced=!1,v.x=x,v.y=f;f=v;null==this.zpp_inner.vertices?this.zpp_inner.vertices=f.prev=f.next=f:(f.prev=this.zpp_inner.vertices,f.next=this.zpp_inner.vertices.next,this.zpp_inner.vertices.next.prev=f,this.zpp_inner.vertices.next=f),this.zpp_inner.vertices=f;f=g.zpp_inner;g.zpp_inner.outer=null,g.zpp_inner=null;g=g;g.zpp_pool=Bn.poolVec2,Bn.poolVec2=g;f=f;if(null!=f.outer&&(f.outer.zpp_inner=null,f.outer=null),f._isimmutable=null,f._validate=null,f._invalidate=null,f.next=Gr.zpp_pool,Gr.zpp_pool=f,c==d)break}}if(this.skipForward(1),t instanceof Array&&null==t.__enum__)for(var w=t,z=0;z<w.length;){var b=w[z],S=!!b.zpp_inner.weak&&(S=b.zpp_inner,b.zpp_inner.outer=null,b.zpp_inner=null,(b=b).zpp_pool=Bn.poolVec2,Bn.poolVec2=b,null!=(S=S).outer&&(S.outer.zpp_inner=null,S.outer=null),S._isimmutable=null,S._validate=null,S._invalidate=null,S.next=Gr.zpp_pool,Gr.zpp_pool=S,!0);S?w.splice(z,1):++z}else if(R.__instanceof(t,Y)){t=t;null!=t.zpp_inner._validate&&t.zpp_inner._validate();for(var C=t.zpp_inner.inner,P=null,M=C.head;null!=M;){var T,A=M.elt;A.outer.zpp_inner.weak?(M=C.erase(P),A.outer.zpp_inner.weak&&(A=(T=A.outer).zpp_inner,T.zpp_inner.outer=null,T.zpp_inner=null,(T=T).zpp_pool=Bn.poolVec2,Bn.poolVec2=T,null!=(A=A).outer&&(A.outer.zpp_inner=null,A.outer=null),A._isimmutable=null,A._validate=null,A._invalidate=null,A.next=Gr.zpp_pool,Gr.zpp_pool=A)):M=(P=M).next}}}};_i.__name__=["nape","geom","GeomPoly"],_i.get=function(t){var e;if(null==Bn.poolGeomPoly?e=new _i:(e=Bn.poolGeomPoly,Bn.poolGeomPoly=e.zpp_pool,e.zpp_pool=null),null!=t){if(t instanceof Array&&null==t.__enum__)for(var i=t,n=0;n<i.length;){var r=i[n];++n;var o=r,s=o.zpp_inner;null!=s._validate&&s._validate();r=o.zpp_inner.x,s=o.zpp_inner;null!=s._validate&&s._validate();var a,o=o.zpp_inner.y;null==nn.zpp_pool?a=new nn:(a=nn.zpp_pool,nn.zpp_pool=a.next,a.next=null),a.forced=!1,a.x=r,a.y=o;o=a;null==e.zpp_inner.vertices?e.zpp_inner.vertices=o.prev=o.next=o:(o.prev=e.zpp_inner.vertices,o.next=e.zpp_inner.vertices.next,e.zpp_inner.vertices.next.prev=o,e.zpp_inner.vertices.next=o),e.zpp_inner.vertices=o}else if(R.__instanceof(t,Y))for(var h=t.iterator();;){h.zpp_inner.zpp_inner.valmod();var l=h.zpp_inner.zpp_gl();if(h.zpp_critical=!0,!(h.zpp_i<l||(h.zpp_next=Qt.zpp_pool,(Qt.zpp_pool=h).zpp_inner=null,!1)))break;h.zpp_critical=!1;var p=h.zpp_inner.at(h.zpp_i++),u=p.zpp_inner;null!=u._validate&&u._validate();l=p.zpp_inner.x,u=p.zpp_inner;null!=u._validate&&u._validate();var d,p=p.zpp_inner.y;null==nn.zpp_pool?d=new nn:(d=nn.zpp_pool,nn.zpp_pool=d.next,d.next=null),d.forced=!1,d.x=l,d.y=p;p=d;null==e.zpp_inner.vertices?e.zpp_inner.vertices=p.prev=p.next=p:(p.prev=e.zpp_inner.vertices,p.next=e.zpp_inner.vertices.next,e.zpp_inner.vertices.next.prev=p,e.zpp_inner.vertices.next=p),e.zpp_inner.vertices=p}else if(R.__instanceof(t,_i)){var c=t.zpp_inner.vertices;if(null!=c)for(var y=c;;){var _,m,g,f=y.x,x=y.y;null==Bn.poolVec2?_=new St:(_=Bn.poolVec2,Bn.poolVec2=_.zpp_pool,_.zpp_pool=null),null==_.zpp_inner?(null==Gr.zpp_pool?m=new Gr:(m=Gr.zpp_pool,Gr.zpp_pool=m.next,m.next=null),m.weak=!1,m._immutable=!1,m.x=f,m.y=x,_.zpp_inner=m,_.zpp_inner.outer=_):(null!=(g=_.zpp_inner)._validate&&g._validate(),_.zpp_inner.x==f&&(null!=(g=_.zpp_inner)._validate&&g._validate(),_.zpp_inner.y==x)||(_.zpp_inner.x=f,_.zpp_inner.y=x,null!=(v=_.zpp_inner)._invalidate&&v._invalidate(v))),_.zpp_inner.weak=!1;f=_,y=y.next,x=f.zpp_inner;null!=x._validate&&x._validate();var v=f.zpp_inner.x,x=f.zpp_inner;null!=x._validate&&x._validate();var w,x=f.zpp_inner.y;null==nn.zpp_pool?w=new nn:(w=nn.zpp_pool,nn.zpp_pool=w.next,w.next=null),w.forced=!1,w.x=v,w.y=x;x=w;null==e.zpp_inner.vertices?e.zpp_inner.vertices=x.prev=x.next=x:(x.prev=e.zpp_inner.vertices,x.next=e.zpp_inner.vertices.next,e.zpp_inner.vertices.next.prev=x,e.zpp_inner.vertices.next=x),e.zpp_inner.vertices=x;x=f.zpp_inner;f.zpp_inner.outer=null,f.zpp_inner=null;f=f;f.zpp_pool=Bn.poolVec2,Bn.poolVec2=f;x=x;if(null!=x.outer&&(x.outer.zpp_inner=null,x.outer=null),x._isimmutable=null,x._validate=null,x._invalidate=null,x.next=Gr.zpp_pool,Gr.zpp_pool=x,y==c)break}}if(e.skipForward(1),t instanceof Array&&null==t.__enum__)for(var z=t,b=0;b<z.length;){var S=z[b],C=!!S.zpp_inner.weak&&(C=S.zpp_inner,S.zpp_inner.outer=null,S.zpp_inner=null,(S=S).zpp_pool=Bn.poolVec2,Bn.poolVec2=S,null!=(C=C).outer&&(C.outer.zpp_inner=null,C.outer=null),C._isimmutable=null,C._validate=null,C._invalidate=null,C.next=Gr.zpp_pool,Gr.zpp_pool=C,!0);C?z.splice(b,1):++b}else if(R.__instanceof(t,Y)){t=t;null!=t.zpp_inner._validate&&t.zpp_inner._validate();for(var P=t.zpp_inner.inner,M=null,T=P.head;null!=T;){var A,k=T.elt;k.outer.zpp_inner.weak?(T=P.erase(M),k.outer.zpp_inner.weak&&(k=(A=k.outer).zpp_inner,A.zpp_inner.outer=null,A.zpp_inner=null,(A=A).zpp_pool=Bn.poolVec2,Bn.poolVec2=A,null!=(k=k).outer&&(k.outer.zpp_inner=null,k.outer=null),k._isimmutable=null,k._validate=null,k._invalidate=null,k.next=Gr.zpp_pool,Gr.zpp_pool=k)):T=(M=T).next}}}return e},_i.prototype.zpp_pool=null,_i.prototype.zpp_inner=null,_i.prototype.empty=function(){return null==this.zpp_inner.vertices},_i.prototype.size=function(){var t=0,e=this.zpp_inner.vertices,i=this.zpp_inner.vertices;if(null!=e)for(var n=e;;)if(++t,(n=n.next)==i)break;return t},_i.prototype.iterator=function(){return me.get(this.zpp_inner.vertices,!0)},_i.prototype.forwardIterator=function(){return me.get(this.zpp_inner.vertices,!0)},_i.prototype.backwardsIterator=function(){return me.get(this.zpp_inner.vertices,!1)},_i.prototype.current=function(){var t,e,i,n,r=this.zpp_inner.vertices;return null==r.wrap&&(t=r.x,n=r.y,null==Bn.poolVec2?e=new St:(e=Bn.poolVec2,Bn.poolVec2=e.zpp_pool,e.zpp_pool=null),null==e.zpp_inner?(null==Gr.zpp_pool?i=new Gr:(i=Gr.zpp_pool,Gr.zpp_pool=i.next,i.next=null),i.weak=!1,i._immutable=!1,i.x=t,i.y=n,e.zpp_inner=i,e.zpp_inner.outer=e):(null!=(i=e.zpp_inner)._validate&&i._validate(),e.zpp_inner.x==t&&(null!=(i=e.zpp_inner)._validate&&i._validate(),e.zpp_inner.y==n)||(e.zpp_inner.x=t,e.zpp_inner.y=n,null!=(n=e.zpp_inner)._invalidate&&n._invalidate(n))),e.zpp_inner.weak=!1,r.wrap=e,r.wrap.zpp_inner._inuse=!0,r.wrap.zpp_inner._invalidate=Z(r,r.modwrap),r.wrap.zpp_inner._validate=Z(r,r.getwrap)),r.wrap},_i.prototype.push=function(t){var e=t.zpp_inner;null!=e._validate&&e._validate();var i=t.zpp_inner.x,e=t.zpp_inner;null!=e._validate&&e._validate();e=t.zpp_inner.y;null==nn.zpp_pool?n=new nn:(n=nn.zpp_pool,nn.zpp_pool=n.next,n.next=null),n.forced=!1,n.x=i,n.y=e;var n=n;return null==this.zpp_inner.vertices?this.zpp_inner.vertices=n.prev=n.next=n:(n.prev=this.zpp_inner.vertices,n.next=this.zpp_inner.vertices.next,this.zpp_inner.vertices.next.prev=n,this.zpp_inner.vertices.next=n),this.zpp_inner.vertices=n,t.zpp_inner.weak&&(n=t.zpp_inner,t.zpp_inner.outer=null,t.zpp_inner=null,t.zpp_pool=Bn.poolVec2,Bn.poolVec2=t,null!=n.outer&&(n.outer.zpp_inner=null,n.outer=null),n._isimmutable=null,n._validate=null,n._invalidate=null,n.next=Gr.zpp_pool,Gr.zpp_pool=n),this},_i.prototype.pop=function(){var t,e=this.zpp_inner.vertices,i=null!=this.zpp_inner.vertices&&this.zpp_inner.vertices.prev==this.zpp_inner.vertices?this.zpp_inner.vertices.next=this.zpp_inner.vertices.prev=null:(t=this.zpp_inner.vertices.prev,this.zpp_inner.vertices.prev.next=this.zpp_inner.vertices.next,this.zpp_inner.vertices.next.prev=this.zpp_inner.vertices.prev,this.zpp_inner.vertices.next=this.zpp_inner.vertices.prev=null,this.zpp_inner.vertices=null,t);return this.zpp_inner.vertices=i,null!=e.wrap&&(e.wrap.zpp_inner._inuse=!1,i=(t=e.wrap).zpp_inner,t.zpp_inner.outer=null,t.zpp_inner=null,t.zpp_pool=Bn.poolVec2,Bn.poolVec2=t,null!=i.outer&&(i.outer.zpp_inner=null,i.outer=null),i._isimmutable=null,i._validate=null,i._invalidate=null,i.next=Gr.zpp_pool,Gr.zpp_pool=i,e.wrap=null),e.prev=e.next=null,e.next=nn.zpp_pool,nn.zpp_pool=e,this},_i.prototype.unshift=function(t){var e=t.zpp_inner;null!=e._validate&&e._validate();var i=t.zpp_inner.x,e=t.zpp_inner;null!=e._validate&&e._validate();e=t.zpp_inner.y;null==nn.zpp_pool?n=new nn:(n=nn.zpp_pool,nn.zpp_pool=n.next,n.next=null),n.forced=!1,n.x=i,n.y=e;var n=n;return null==this.zpp_inner.vertices?this.zpp_inner.vertices=n.prev=n.next=n:(n.next=this.zpp_inner.vertices,n.prev=this.zpp_inner.vertices.prev,this.zpp_inner.vertices.prev.next=n,this.zpp_inner.vertices.prev=n),this.zpp_inner.vertices=n,t.zpp_inner.weak&&(n=t.zpp_inner,t.zpp_inner.outer=null,t.zpp_inner=null,t.zpp_pool=Bn.poolVec2,Bn.poolVec2=t,null!=n.outer&&(n.outer.zpp_inner=null,n.outer=null),n._isimmutable=null,n._validate=null,n._invalidate=null,n.next=Gr.zpp_pool,Gr.zpp_pool=n),this},_i.prototype.shift=function(){var t,e=this.zpp_inner.vertices,i=null!=this.zpp_inner.vertices&&this.zpp_inner.vertices.prev==this.zpp_inner.vertices?(this.zpp_inner.vertices.next=this.zpp_inner.vertices.prev=null,this.zpp_inner.vertices=null):(t=this.zpp_inner.vertices.next,this.zpp_inner.vertices.prev.next=this.zpp_inner.vertices.next,this.zpp_inner.vertices.next.prev=this.zpp_inner.vertices.prev,this.zpp_inner.vertices.next=this.zpp_inner.vertices.prev=null,this.zpp_inner.vertices=null,t);return this.zpp_inner.vertices=i,null!=e.wrap&&(e.wrap.zpp_inner._inuse=!1,i=(t=e.wrap).zpp_inner,t.zpp_inner.outer=null,t.zpp_inner=null,t.zpp_pool=Bn.poolVec2,Bn.poolVec2=t,null!=i.outer&&(i.outer.zpp_inner=null,i.outer=null),i._isimmutable=null,i._validate=null,i._invalidate=null,i.next=Gr.zpp_pool,Gr.zpp_pool=i,e.wrap=null),e.prev=e.next=null,e.next=nn.zpp_pool,nn.zpp_pool=e,this},_i.prototype.skipForward=function(t){if(null!=this.zpp_inner.vertices)if(0<t)for(;0<t--;)this.zpp_inner.vertices=this.zpp_inner.vertices.next;else if(t<0)for(;t++<0;)this.zpp_inner.vertices=this.zpp_inner.vertices.prev;return this},_i.prototype.skipBackwards=function(t){return this.skipForward(-t)},_i.prototype.erase=function(t){for(;0!=t&&null!=this.zpp_inner.vertices;){var e,i,n,r=this.zpp_inner.vertices;0<t?(e=null!=this.zpp_inner.vertices&&this.zpp_inner.vertices.prev==this.zpp_inner.vertices?(this.zpp_inner.vertices.next=this.zpp_inner.vertices.prev=null,this.zpp_inner.vertices=null):(e=this.zpp_inner.vertices.next,this.zpp_inner.vertices.prev.next=this.zpp_inner.vertices.next,this.zpp_inner.vertices.next.prev=this.zpp_inner.vertices.prev,this.zpp_inner.vertices.next=this.zpp_inner.vertices.prev=null,this.zpp_inner.vertices=null,e),this.zpp_inner.vertices=e,--t):t<0&&(n=null!=this.zpp_inner.vertices&&this.zpp_inner.vertices.prev==this.zpp_inner.vertices?this.zpp_inner.vertices.next=this.zpp_inner.vertices.prev=null:(i=this.zpp_inner.vertices.prev,this.zpp_inner.vertices.prev.next=this.zpp_inner.vertices.next,this.zpp_inner.vertices.next.prev=this.zpp_inner.vertices.prev,this.zpp_inner.vertices.next=this.zpp_inner.vertices.prev=null,this.zpp_inner.vertices=null,i),this.zpp_inner.vertices=n,++t),null!=r.wrap&&(r.wrap.zpp_inner._inuse=!1,n=(i=r.wrap).zpp_inner,i.zpp_inner.outer=null,i.zpp_inner=null,i.zpp_pool=Bn.poolVec2,Bn.poolVec2=i,null!=n.outer&&(n.outer.zpp_inner=null,n.outer=null),n._isimmutable=null,n._validate=null,n._invalidate=null,n.next=Gr.zpp_pool,Gr.zpp_pool=n,r.wrap=null),r.prev=r.next=null,r.next=nn.zpp_pool,nn.zpp_pool=r}return this},_i.prototype.clear=function(){for(;null!=this.zpp_inner.vertices;){var t,e=this.zpp_inner.vertices,i=null!=this.zpp_inner.vertices&&this.zpp_inner.vertices.prev==this.zpp_inner.vertices?(this.zpp_inner.vertices.next=this.zpp_inner.vertices.prev=null,this.zpp_inner.vertices=null):(t=this.zpp_inner.vertices.next,this.zpp_inner.vertices.prev.next=this.zpp_inner.vertices.next,this.zpp_inner.vertices.next.prev=this.zpp_inner.vertices.prev,this.zpp_inner.vertices.next=this.zpp_inner.vertices.prev=null,this.zpp_inner.vertices=null,t);this.zpp_inner.vertices=i,null!=e.wrap&&(e.wrap.zpp_inner._inuse=!1,i=(t=e.wrap).zpp_inner,t.zpp_inner.outer=null,t.zpp_inner=null,t.zpp_pool=Bn.poolVec2,Bn.poolVec2=t,null!=i.outer&&(i.outer.zpp_inner=null,i.outer=null),i._isimmutable=null,i._validate=null,i._invalidate=null,i.next=Gr.zpp_pool,Gr.zpp_pool=i,e.wrap=null),e.prev=e.next=null,e.next=nn.zpp_pool,nn.zpp_pool=e}return this},_i.prototype.copy=function(){var t=_i.get(),e=this.zpp_inner.vertices,i=this.zpp_inner.vertices;if(null!=e)for(var n=e;;){var r,o=n,s=o.x,o=o.y;null==nn.zpp_pool?r=new nn:(r=nn.zpp_pool,nn.zpp_pool=r.next,r.next=null),r.forced=!1,r.x=s,r.y=o;o=r;if(null==t.zpp_inner.vertices?t.zpp_inner.vertices=o.prev=o.next=o:(o.prev=t.zpp_inner.vertices,o.next=t.zpp_inner.vertices.next,t.zpp_inner.vertices.next.prev=o,t.zpp_inner.vertices.next=o),t.zpp_inner.vertices=o,(n=n.next)==i)break}return t.skipForward(1)},_i.prototype.dispose=function(){this.clear();this.zpp_pool=Bn.poolGeomPoly,Bn.poolGeomPoly=this},_i.prototype.toString=function(){var t="GeomPoly[",e=this.zpp_inner.vertices,i=this.zpp_inner.vertices;if(null!=e)for(var n=e;;){var r=n;if(r!=this.zpp_inner.vertices&&(t+=","),t+="{"+r.x+","+r.y+"}",(n=n.next)==i)break}return t+"]"},_i.prototype.area=function(){if(null==this.zpp_inner.vertices||null==this.zpp_inner.vertices.next||this.zpp_inner.vertices.prev==this.zpp_inner.vertices.next)return 0;var t=0,e=this.zpp_inner.vertices,i=this.zpp_inner.vertices;if(null!=e)for(var n=e;;){var r=n;if(t+=r.x*(r.next.y-r.prev.y),(n=n.next)==i)break}e=.5*t;return e<0?-e:e},_i.prototype.winding=function(){if(null==this.zpp_inner.vertices||null==this.zpp_inner.vertices.next||this.zpp_inner.vertices.prev==this.zpp_inner.vertices.next)return null==Yn.Winding_UNDEFINED&&(Yn.internal=!0,Yn.Winding_UNDEFINED=new J,Yn.internal=!1),Yn.Winding_UNDEFINED;var t=0,e=this.zpp_inner.vertices,i=this.zpp_inner.vertices;if(null!=e)for(var n=e;;){var r=n;if(t+=r.x*(r.next.y-r.prev.y),(n=n.next)==i)break}e=.5*t;return 0<e?(null==Yn.Winding_CLOCKWISE&&(Yn.internal=!0,Yn.Winding_CLOCKWISE=new J,Yn.internal=!1),Yn.Winding_CLOCKWISE):0==e?(null==Yn.Winding_UNDEFINED&&(Yn.internal=!0,Yn.Winding_UNDEFINED=new J,Yn.internal=!1),Yn.Winding_UNDEFINED):(null==Yn.Winding_ANTICLOCKWISE&&(Yn.internal=!0,Yn.Winding_ANTICLOCKWISE=new J,Yn.internal=!1),Yn.Winding_ANTICLOCKWISE)},_i.prototype.contains=function(t){var e=t.zpp_inner;null!=e._validate&&e._validate();var i=t.zpp_inner.x,n=t.zpp_inner;null!=n._validate&&n._validate();var r=t.zpp_inner.y,o=!1,e=this.zpp_inner.vertices,s=this.zpp_inner.vertices;if(null!=e)for(var a=e;;){var h=a,l=h.prev;if((h.y<r&&l.y>=r||l.y<r&&h.y>=r)&&(h.x<=i||l.x<=i)&&h.x+(r-h.y)/(l.y-h.y)*(l.x-h.x)<i&&(o=!o),(a=a.next)==s)break}n=o;return t.zpp_inner.weak&&(e=t.zpp_inner,t.zpp_inner.outer=null,t.zpp_inner=null,t.zpp_pool=Bn.poolVec2,Bn.poolVec2=t,null!=e.outer&&(e.outer.zpp_inner=null,e.outer=null),e._isimmutable=null,e._validate=null,e._invalidate=null,e.next=Gr.zpp_pool,Gr.zpp_pool=e),n},_i.prototype.isClockwise=function(){var t=this.winding();return null==Yn.Winding_CLOCKWISE&&(Yn.internal=!0,Yn.Winding_CLOCKWISE=new J,Yn.internal=!1),t==Yn.Winding_CLOCKWISE},_i.prototype.isConvex=function(){if(null==this.zpp_inner.vertices||null==this.zpp_inner.vertices.next||this.zpp_inner.vertices.prev==this.zpp_inner.vertices.next)return!0;var t=!1,e=!1,i=!0,n=this.zpp_inner.vertices,r=this.zpp_inner.vertices;if(null!=n)for(var o=n;;){var s=o,a=s.prev,h=s.next,l=h.x-s.x,p=h.y-s.y,h=s.x-a.x,p=(s.y-a.y)*l-h*p;if(0<p?e=!0:p<0&&(t=!0),e&&t){i=!1;break}if((o=o.next)==r)break}return i},_i.prototype.isSimple=function(){return null==this.zpp_inner.vertices||null==this.zpp_inner.vertices.next||this.zpp_inner.vertices.prev==this.zpp_inner.vertices.next||Te.isSimple(this.zpp_inner.vertices)},_i.prototype.isMonotone=function(){return null==this.zpp_inner.vertices||null==this.zpp_inner.vertices.next||this.zpp_inner.vertices.prev==this.zpp_inner.vertices.next||ve.isMonotone(this.zpp_inner.vertices)},_i.prototype.isDegenerate=function(){return null==this.zpp_inner.vertices||null==this.zpp_inner.vertices.next||this.zpp_inner.vertices.prev==this.zpp_inner.vertices.next||this.area()<Er.epsilon},_i.prototype.simplify=function(t){if(null==this.zpp_inner.vertices||null==this.zpp_inner.vertices.next||this.zpp_inner.vertices.prev==this.zpp_inner.vertices.next)return this.copy();var e=Oe.simplify(this.zpp_inner.vertices,t),t=_i.get();return t.zpp_inner.vertices=e,t},_i.prototype.simpleDecomposition=function(t){null==ze.sharedGVList&&(ze.sharedGVList=new Pi);for(var e=Te.decompose(this.zpp_inner.vertices,ze.sharedGVList),i=null==t?new mi:t;null!=e.head;){var n=e.pop_unsafe(),r=_i.get();r.zpp_inner.vertices=n,i.zpp_inner.reverse_flag?i.push(r):i.unshift(r)}return i},_i.prototype.monotoneDecomposition=function(t){null==ve.sharedPPoly&&(ve.sharedPPoly=new ze);var e=ve.decompose(this.zpp_inner.vertices,ve.sharedPPoly);null==ze.sharedGVList&&(ze.sharedGVList=new Pi);for(var i=e.extract(ze.sharedGVList),n=null==t?new mi:t;null!=i.head;){var r=i.pop_unsafe(),o=_i.get();o.zpp_inner.vertices=r,n.zpp_inner.reverse_flag?n.push(o):n.unshift(o)}return n},_i.prototype.convexDecomposition=function(t,e){null==t&&(t=!1),null==ve.sharedPPoly&&(ve.sharedPPoly=new ze);var i=ve.decompose(this.zpp_inner.vertices,ve.sharedPPoly);null==ze.sharedPPList&&(ze.sharedPPList=new Ci);for(var n=i.extract_partitions(ze.sharedPPList),r=null==e?new mi:e;null!=n.head;){var o=n.pop_unsafe();Le.triangulate(o),t&&Le.optimise(o),de.optimise(o),null==ze.sharedGVList&&(ze.sharedGVList=new Pi);var s=o.extract(ze.sharedGVList);for(o.next=ze.zpp_pool,ze.zpp_pool=o;null!=s.head;){var a=s.pop_unsafe(),h=_i.get();h.zpp_inner.vertices=a,r.zpp_inner.reverse_flag?r.push(h):r.unshift(h)}}return r},_i.prototype.triangularDecomposition=function(t,e){null==t&&(t=!1),null==ve.sharedPPoly&&(ve.sharedPPoly=new ze);var i=ve.decompose(this.zpp_inner.vertices,ve.sharedPPoly);null==ze.sharedPPList&&(ze.sharedPPList=new Ci);for(var n=i.extract_partitions(ze.sharedPPList),r=null==e?new mi:e;null!=n.head;){var o=n.pop_unsafe();Le.triangulate(o),t&&Le.optimise(o),null==ze.sharedGVList&&(ze.sharedGVList=new Pi);var s=o.extract(ze.sharedGVList);for(o.next=ze.zpp_pool,ze.zpp_pool=o;null!=s.head;){var a=s.pop_unsafe(),h=_i.get();h.zpp_inner.vertices=a,r.zpp_inner.reverse_flag?r.push(h):r.unshift(h)}}return r},_i.prototype.inflate=function(t){var e=_i.get(),i=this.winding();null==Yn.Winding_CLOCKWISE&&(Yn.internal=!0,Yn.Winding_CLOCKWISE=new J,Yn.internal=!1),i==Yn.Winding_CLOCKWISE&&(t=-t);var i=this.zpp_inner.vertices,n=this.zpp_inner.vertices;if(null!=i)for(var r=i;;){var o=r,s=o.prev,a=o.next,h=o.x-s.x,l=o.y-s.y,p=a.x-o.x,u=a.y-o.y,d=h,c=l,y=1/Math.sqrt(d*d+c*c),_=d*=y;d=-(c*=y),c=_,d*=t,c*=t;s=p,a=u,y=1/Math.sqrt(s*s+a*a),_=s*=y;s=-(a*=y),a=_;var m,g,a=u*((s*=t)-d)-p*((a*=t)-c),p=0==a?0:a/(u*h-p*l),d=o.x+d,c=o.y+c;if(d+=h*p,c+=l*p,null==Bn.poolVec2?m=new St:(m=Bn.poolVec2,Bn.poolVec2=m.zpp_pool,m.zpp_pool=null),null==m.zpp_inner?(null==Gr.zpp_pool?g=new Gr:(g=Gr.zpp_pool,Gr.zpp_pool=g.next,g.next=null),g.weak=!1,g._immutable=!1,g.x=d,g.y=c,m.zpp_inner=g,m.zpp_inner.outer=m):(null!=(p=m.zpp_inner)._validate&&p._validate(),m.zpp_inner.x==d&&(null!=(p=m.zpp_inner)._validate&&p._validate(),m.zpp_inner.y==c)||(m.zpp_inner.x=d,m.zpp_inner.y=c,null!=(c=m.zpp_inner)._invalidate&&c._invalidate(c))),m.zpp_inner.weak=!1,e.push(m),(r=r.next)==n)break}return e.skipForward(1)},_i.prototype.cut=function(t,e,i,n,r){var o,r=xi.run(this.zpp_inner.vertices,t,e,i=null==i?!1:i,n=null==n?!1:n,r);return t.zpp_inner.weak&&(o=t.zpp_inner,t.zpp_inner.outer=null,t.zpp_inner=null,t.zpp_pool=Bn.poolVec2,Bn.poolVec2=t,null!=o.outer&&(o.outer.zpp_inner=null,o.outer=null),o._isimmutable=null,o._validate=null,o._invalidate=null,o.next=Gr.zpp_pool,Gr.zpp_pool=o),e.zpp_inner.weak&&(o=e.zpp_inner,e.zpp_inner.outer=null,e.zpp_inner=null,e.zpp_pool=Bn.poolVec2,Bn.poolVec2=e,null!=o.outer&&(o.outer.zpp_inner=null,o.outer=null),o._isimmutable=null,o._validate=null,o._invalidate=null,o.next=Gr.zpp_pool,Gr.zpp_pool=o),r},_i.prototype.transform=function(t){var e=this.zpp_inner.vertices,i=this.zpp_inner.vertices;if(null!=e)for(var n=e;;){var r=n,o=t.zpp_inner.a*r.x+t.zpp_inner.b*r.y+t.zpp_inner.tx;if(r.y=t.zpp_inner.c*r.x+t.zpp_inner.d*r.y+t.zpp_inner.ty,r.x=o,(n=n.next)==i)break}return this},_i.prototype.bounds=function(){var t=1e100,e=1e100,i=-1e100,n=-1e100,r=this.zpp_inner.vertices,o=this.zpp_inner.vertices;if(null!=r)for(var s=r;;){var a=s;if(a.x<t&&(t=a.x),a.y<e&&(e=a.y),a.x>i&&(i=a.x),a.y>n&&(n=a.y),(s=s.next)==o)break}return new N(t,e,i-t,n-e)},_i.prototype.top=function(){var t,e,i,n=this.zpp_inner.vertices,r=this.zpp_inner.vertices.next,o=this.zpp_inner.vertices;if(null!=r)for(var s=r;;){var a=s;if(a.y<n.y&&(n=a),(s=s.next)==o)break}return null==n.wrap&&(t=n.x,r=n.y,null==Bn.poolVec2?e=new St:(e=Bn.poolVec2,Bn.poolVec2=e.zpp_pool,e.zpp_pool=null),null==e.zpp_inner?(null==Gr.zpp_pool?i=new Gr:(i=Gr.zpp_pool,Gr.zpp_pool=i.next,i.next=null),i.weak=!1,i._immutable=!1,i.x=t,i.y=r,e.zpp_inner=i,e.zpp_inner.outer=e):(null!=(i=e.zpp_inner)._validate&&i._validate(),e.zpp_inner.x==t&&(null!=(i=e.zpp_inner)._validate&&i._validate(),e.zpp_inner.y==r)||(e.zpp_inner.x=t,e.zpp_inner.y=r,null!=(r=e.zpp_inner)._invalidate&&r._invalidate(r))),e.zpp_inner.weak=!1,n.wrap=e,n.wrap.zpp_inner._inuse=!0,n.wrap.zpp_inner._invalidate=Z(n,n.modwrap),n.wrap.zpp_inner._validate=Z(n,n.getwrap)),n.wrap},_i.prototype.bottom=function(){var t,e,i,n=this.zpp_inner.vertices,r=this.zpp_inner.vertices.next,o=this.zpp_inner.vertices;if(null!=r)for(var s=r;;){var a=s;if(a.y>n.y&&(n=a),(s=s.next)==o)break}return null==n.wrap&&(t=n.x,r=n.y,null==Bn.poolVec2?e=new St:(e=Bn.poolVec2,Bn.poolVec2=e.zpp_pool,e.zpp_pool=null),null==e.zpp_inner?(null==Gr.zpp_pool?i=new Gr:(i=Gr.zpp_pool,Gr.zpp_pool=i.next,i.next=null),i.weak=!1,i._immutable=!1,i.x=t,i.y=r,e.zpp_inner=i,e.zpp_inner.outer=e):(null!=(i=e.zpp_inner)._validate&&i._validate(),e.zpp_inner.x==t&&(null!=(i=e.zpp_inner)._validate&&i._validate(),e.zpp_inner.y==r)||(e.zpp_inner.x=t,e.zpp_inner.y=r,null!=(r=e.zpp_inner)._invalidate&&r._invalidate(r))),e.zpp_inner.weak=!1,n.wrap=e,n.wrap.zpp_inner._inuse=!0,n.wrap.zpp_inner._invalidate=Z(n,n.modwrap),n.wrap.zpp_inner._validate=Z(n,n.getwrap)),n.wrap},_i.prototype.left=function(){var t,e,i,n=this.zpp_inner.vertices,r=this.zpp_inner.vertices.next,o=this.zpp_inner.vertices;if(null!=r)for(var s=r;;){var a=s;if(a.x<n.x&&(n=a),(s=s.next)==o)break}return null==n.wrap&&(t=n.x,r=n.y,null==Bn.poolVec2?e=new St:(e=Bn.poolVec2,Bn.poolVec2=e.zpp_pool,e.zpp_pool=null),null==e.zpp_inner?(null==Gr.zpp_pool?i=new Gr:(i=Gr.zpp_pool,Gr.zpp_pool=i.next,i.next=null),i.weak=!1,i._immutable=!1,i.x=t,i.y=r,e.zpp_inner=i,e.zpp_inner.outer=e):(null!=(i=e.zpp_inner)._validate&&i._validate(),e.zpp_inner.x==t&&(null!=(i=e.zpp_inner)._validate&&i._validate(),e.zpp_inner.y==r)||(e.zpp_inner.x=t,e.zpp_inner.y=r,null!=(r=e.zpp_inner)._invalidate&&r._invalidate(r))),e.zpp_inner.weak=!1,n.wrap=e,n.wrap.zpp_inner._inuse=!0,n.wrap.zpp_inner._invalidate=Z(n,n.modwrap),n.wrap.zpp_inner._validate=Z(n,n.getwrap)),n.wrap},_i.prototype.right=function(){var t,e,i,n=this.zpp_inner.vertices,r=this.zpp_inner.vertices.next,o=this.zpp_inner.vertices;if(null!=r)for(var s=r;;){var a=s;if(a.x>n.x&&(n=a),(s=s.next)==o)break}return null==n.wrap&&(t=n.x,r=n.y,null==Bn.poolVec2?e=new St:(e=Bn.poolVec2,Bn.poolVec2=e.zpp_pool,e.zpp_pool=null),null==e.zpp_inner?(null==Gr.zpp_pool?i=new Gr:(i=Gr.zpp_pool,Gr.zpp_pool=i.next,i.next=null),i.weak=!1,i._immutable=!1,i.x=t,i.y=r,e.zpp_inner=i,e.zpp_inner.outer=e):(null!=(i=e.zpp_inner)._validate&&i._validate(),e.zpp_inner.x==t&&(null!=(i=e.zpp_inner)._validate&&i._validate(),e.zpp_inner.y==r)||(e.zpp_inner.x=t,e.zpp_inner.y=r,null!=(r=e.zpp_inner)._invalidate&&r._invalidate(r))),e.zpp_inner.weak=!1,n.wrap=e,n.wrap.zpp_inner._inuse=!0,n.wrap.zpp_inner._invalidate=Z(n,n.modwrap),n.wrap.zpp_inner._validate=Z(n,n.getwrap)),n.wrap},_i.prototype.__class__=_i;var Zt=nape.geom.GeomPolyIterator=function(){this.zpp_next=null,this.zpp_critical=!1,this.zpp_i=0,this.zpp_inner=null};Zt.__name__=["nape","geom","GeomPolyIterator"],Zt.get=function(t){var e,i=null==Zt.zpp_pool?(An.internal=!0,e=new Zt,An.internal=!1,e):(Zt.zpp_pool=(i=Zt.zpp_pool).zpp_next,i);return i.zpp_i=0,i.zpp_inner=t,i.zpp_critical=!1,i},Zt.prototype.zpp_inner=null,Zt.prototype.zpp_i=null,Zt.prototype.zpp_critical=null,Zt.prototype.zpp_next=null,Zt.prototype.hasNext=function(){this.zpp_inner.zpp_inner.valmod();var t=this.zpp_inner;t.zpp_inner.valmod(),t.zpp_inner.zip_length&&(t.zpp_inner.zip_length=!1,t.zpp_inner.user_length=t.zpp_inner.inner.length);t=t.zpp_inner.user_length;return this.zpp_critical=!0,this.zpp_i<t||(this.zpp_next=Zt.zpp_pool,(Zt.zpp_pool=this).zpp_inner=null,!1)},Zt.prototype.next=function(){return this.zpp_critical=!1,this.zpp_inner.at(this.zpp_i++)},Zt.prototype.__class__=Zt;var mi=nape.geom.GeomPolyList=function(){this.zpp_inner=null,this.zpp_inner=new An,this.zpp_inner.outer=this};mi.__name__=["nape","geom","GeomPolyList"],mi.fromArray=function(t){for(var e=new mi,i=0;i<t.length;){var n=t[i];++i,e.push(n)}return e},mi.prototype.zpp_inner=null,mi.prototype.get_length=function(){return this.zpp_inner.valmod(),this.zpp_inner.zip_length&&(this.zpp_inner.zip_length=!1,this.zpp_inner.user_length=this.zpp_inner.inner.length),this.zpp_inner.user_length},mi.prototype.has=function(t){return this.zpp_inner.valmod(),this.zpp_inner.inner.has(t.zpp_inner)},mi.prototype.at=function(t){if(this.zpp_inner.valmod(),this.zpp_inner.reverse_flag&&(this.zpp_inner.valmod(),this.zpp_inner.zip_length&&(this.zpp_inner.zip_length=!1,this.zpp_inner.user_length=this.zpp_inner.inner.length),t=this.zpp_inner.user_length-1-t),t<this.zpp_inner.at_index||null==this.zpp_inner.at_ite)this.zpp_inner.at_index=t,this.zpp_inner.at_ite=this.zpp_inner.inner.iterator_at(t);else for(;this.zpp_inner.at_index!=t;)this.zpp_inner.at_index++,this.zpp_inner.at_ite=this.zpp_inner.at_ite.next;return this.zpp_inner.at_ite.elt.outer},mi.prototype.push=function(t){this.zpp_inner.modify_test(),this.zpp_inner.valmod();var e,i=null==this.zpp_inner.adder||this.zpp_inner.adder(t);return i&&(this.zpp_inner.reverse_flag?this.zpp_inner.inner.add(t.zpp_inner):(null==this.zpp_inner.push_ite&&(e=null==this.zpp_inner.inner.head?null:(this.zpp_inner.valmod(),this.zpp_inner.zip_length&&(this.zpp_inner.zip_length=!1,this.zpp_inner.user_length=this.zpp_inner.inner.length),this.zpp_inner.inner.iterator_at(this.zpp_inner.user_length-1)),this.zpp_inner.push_ite=e),this.zpp_inner.push_ite=this.zpp_inner.inner.insert(this.zpp_inner.push_ite,t.zpp_inner)),this.zpp_inner.invalidate(),null!=this.zpp_inner.post_adder&&this.zpp_inner.post_adder(t)),i},mi.prototype.unshift=function(t){this.zpp_inner.modify_test(),this.zpp_inner.valmod();var e,i=null==this.zpp_inner.adder||this.zpp_inner.adder(t);return i&&(this.zpp_inner.reverse_flag?(null==this.zpp_inner.push_ite&&(e=null==this.zpp_inner.inner.head?null:(this.zpp_inner.valmod(),this.zpp_inner.zip_length&&(this.zpp_inner.zip_length=!1,this.zpp_inner.user_length=this.zpp_inner.inner.length),this.zpp_inner.inner.iterator_at(this.zpp_inner.user_length-1)),this.zpp_inner.push_ite=e),this.zpp_inner.push_ite=this.zpp_inner.inner.insert(this.zpp_inner.push_ite,t.zpp_inner)):this.zpp_inner.inner.add(t.zpp_inner),this.zpp_inner.invalidate(),null!=this.zpp_inner.post_adder&&this.zpp_inner.post_adder(t)),i},mi.prototype.pop=function(){this.zpp_inner.modify_test(),this.zpp_inner.valmod();var t,e,i=null;return this.zpp_inner.reverse_flag?(e=(i=this.zpp_inner.inner.head.elt).outer,null!=this.zpp_inner.subber&&this.zpp_inner.subber(e),this.zpp_inner.dontremove||this.zpp_inner.inner.pop()):(null!=this.zpp_inner.at_ite&&null==this.zpp_inner.at_ite.next&&(this.zpp_inner.at_ite=null),this.zpp_inner.valmod(),this.zpp_inner.zip_length&&(this.zpp_inner.zip_length=!1,this.zpp_inner.user_length=this.zpp_inner.inner.length),e=(i=(null==(t=1==this.zpp_inner.user_length?null:(this.zpp_inner.valmod(),this.zpp_inner.zip_length&&(this.zpp_inner.zip_length=!1,this.zpp_inner.user_length=this.zpp_inner.inner.length),this.zpp_inner.inner.iterator_at(this.zpp_inner.user_length-2)))?this.zpp_inner.inner.head:t.next).elt).outer,null!=this.zpp_inner.subber&&this.zpp_inner.subber(e),this.zpp_inner.dontremove||this.zpp_inner.inner.erase(t)),this.zpp_inner.invalidate(),i.outer},mi.prototype.shift=function(){this.zpp_inner.modify_test(),this.zpp_inner.valmod();var t,e,i=null;return this.zpp_inner.reverse_flag?(null!=this.zpp_inner.at_ite&&null==this.zpp_inner.at_ite.next&&(this.zpp_inner.at_ite=null),this.zpp_inner.valmod(),this.zpp_inner.zip_length&&(this.zpp_inner.zip_length=!1,this.zpp_inner.user_length=this.zpp_inner.inner.length),t=(i=(null==(e=1==this.zpp_inner.user_length?null:(this.zpp_inner.valmod(),this.zpp_inner.zip_length&&(this.zpp_inner.zip_length=!1,this.zpp_inner.user_length=this.zpp_inner.inner.length),this.zpp_inner.inner.iterator_at(this.zpp_inner.user_length-2)))?this.zpp_inner.inner.head:e.next).elt).outer,null!=this.zpp_inner.subber&&this.zpp_inner.subber(t),this.zpp_inner.dontremove||this.zpp_inner.inner.erase(e)):(e=(i=this.zpp_inner.inner.head.elt).outer,null!=this.zpp_inner.subber&&this.zpp_inner.subber(e),this.zpp_inner.dontremove||this.zpp_inner.inner.pop()),this.zpp_inner.invalidate(),i.outer},mi.prototype.add=function(t){return this.zpp_inner.reverse_flag?this.push(t):this.unshift(t)},mi.prototype.remove=function(t){this.zpp_inner.modify_test(),this.zpp_inner.valmod();for(var e=!1,i=this.zpp_inner.inner.head;null!=i;){if(i.elt==t.zpp_inner){e=!0;break}i=i.next}return e&&(null!=this.zpp_inner.subber&&this.zpp_inner.subber(t),this.zpp_inner.dontremove||this.zpp_inner.inner.remove(t.zpp_inner),this.zpp_inner.invalidate()),e},mi.prototype.clear=function(){if(this.zpp_inner.reverse_flag)for(;null!=this.zpp_inner.inner.head;)this.pop();else for(;null!=this.zpp_inner.inner.head;)this.shift()},mi.prototype.empty=function(){return null==this.zpp_inner.inner.head},mi.prototype.iterator=function(){return this.zpp_inner.valmod(),Zt.get(this)},mi.prototype.copy=function(t){null==t&&(t=!1);var e=new mi;this.zpp_inner.valmod();for(var i=Zt.get(this);;){i.zpp_inner.zpp_inner.valmod();var n=i.zpp_inner;n.zpp_inner.valmod(),n.zpp_inner.zip_length&&(n.zpp_inner.zip_length=!1,n.zpp_inner.user_length=n.zpp_inner.inner.length);n=n.zpp_inner.user_length;if(i.zpp_critical=!0,!(i.zpp_i<n||(i.zpp_next=Zt.zpp_pool,(Zt.zpp_pool=i).zpp_inner=null,!1)))break;i.zpp_critical=!1;n=i.zpp_inner.at(i.zpp_i++);e.push(t?null:n)}return e},mi.prototype.merge=function(t){t.zpp_inner.valmod();for(var e=Zt.get(t);;){e.zpp_inner.zpp_inner.valmod();var i=e.zpp_inner;i.zpp_inner.valmod(),i.zpp_inner.zip_length&&(i.zpp_inner.zip_length=!1,i.zpp_inner.user_length=i.zpp_inner.inner.length);i=i.zpp_inner.user_length;if(e.zpp_critical=!0,!(e.zpp_i<i||(e.zpp_next=Zt.zpp_pool,(Zt.zpp_pool=e).zpp_inner=null,!1)))break;e.zpp_critical=!1;i=e.zpp_inner.at(e.zpp_i++);this.has(i)||(this.zpp_inner.reverse_flag?this.push(i):this.unshift(i))}},mi.prototype.toString=function(){var t="[",e=!0;this.zpp_inner.valmod();for(var i=Zt.get(this);;){i.zpp_inner.zpp_inner.valmod();var n=i.zpp_inner;n.zpp_inner.valmod(),n.zpp_inner.zip_length&&(n.zpp_inner.zip_length=!1,n.zpp_inner.user_length=n.zpp_inner.inner.length);n=n.zpp_inner.user_length;if(i.zpp_critical=!0,!(i.zpp_i<n||(i.zpp_next=Zt.zpp_pool,(Zt.zpp_pool=i).zpp_inner=null,!1)))break;i.zpp_critical=!1;n=i.zpp_inner.at(i.zpp_i++);e||(t+=","),t+=null==n?"NULL":n.toString(),e=!1}return t+"]"},mi.prototype.foreach=function(t){this.zpp_inner.valmod();for(var e=Zt.get(this);;){e.zpp_inner.zpp_inner.valmod();var i=e.zpp_inner;i.zpp_inner.valmod(),i.zpp_inner.zip_length&&(i.zpp_inner.zip_length=!1,i.zpp_inner.user_length=i.zpp_inner.inner.length);i=i.zpp_inner.user_length;if(e.zpp_critical=!0,!(e.zpp_i<i||(e.zpp_next=Zt.zpp_pool,(Zt.zpp_pool=e).zpp_inner=null,!1)))break;try{e.zpp_critical=!1,t(e.zpp_inner.at(e.zpp_i++))}catch(t){e.zpp_next=Zt.zpp_pool,(Zt.zpp_pool=e).zpp_inner=null;break}}return this},mi.prototype.filter=function(t){for(var e=0;;){if(this.zpp_inner.valmod(),this.zpp_inner.zip_length&&(this.zpp_inner.zip_length=!1,this.zpp_inner.user_length=this.zpp_inner.inner.length),!(e<this.zpp_inner.user_length))break;var i=this.at(e);try{t(i)?++e:this.remove(i)}catch(t){break}}return this},Object.defineProperty(mi.prototype,"length",{get:mi.prototype.get_length}),mi.prototype.__class__=mi;var U=nape.geom.GeomVertexIterator=function(){};U.__name__=["nape","geom","GeomVertexIterator"],U.prototype.zpp_inner=null,U.prototype.hasNext=function(){var t,e=this.zpp_inner.ptr!=this.zpp_inner.start||this.zpp_inner.first;return this.zpp_inner.first=!1,e||((t=this.zpp_inner).outer.zpp_inner=null,t.ptr=t.start=null,t.next=me.zpp_pool,me.zpp_pool=t),e},U.prototype.next=function(){var t,e,i,n,r=this.zpp_inner.ptr;null==r.wrap&&(t=r.x,n=r.y,null==Bn.poolVec2?e=new St:(e=Bn.poolVec2,Bn.poolVec2=e.zpp_pool,e.zpp_pool=null),null==e.zpp_inner?(null==Gr.zpp_pool?i=new Gr:(i=Gr.zpp_pool,Gr.zpp_pool=i.next,i.next=null),i.weak=!1,i._immutable=!1,i.x=t,i.y=n,e.zpp_inner=i,e.zpp_inner.outer=e):(null!=(i=e.zpp_inner)._validate&&i._validate(),e.zpp_inner.x==t&&(null!=(i=e.zpp_inner)._validate&&i._validate(),e.zpp_inner.y==n)||(e.zpp_inner.x=t,e.zpp_inner.y=n,null!=(n=e.zpp_inner)._invalidate&&n._invalidate(n))),e.zpp_inner.weak=!1,r.wrap=e,r.wrap.zpp_inner._inuse=!0,r.wrap.zpp_inner._invalidate=Z(r,r.modwrap),r.wrap.zpp_inner._validate=Z(r,r.getwrap));r=r.wrap;return this.zpp_inner.ptr=this.zpp_inner.forward?this.zpp_inner.ptr.next:this.zpp_inner.ptr.prev,r},U.prototype.__class__=U;c=nape.geom.MarchingSquares=function(){};c.__name__=["nape","geom","MarchingSquares"],c.run=function(t,e,i,n,r,o,s){null==o&&(o=!0),null==n&&(n=2);var a,h=null!=s?s:new mi;if(null==r){var l=e.zpp_inner;null!=l._validate&&l._validate();var p=e.zpp_inner.minx,u=e.zpp_inner;null!=u._validate&&u._validate();var d=e.zpp_inner.miny,s=e.zpp_inner.getmax(),l=s.zpp_inner;null!=l._validate&&l._validate();u=s.zpp_inner.x,l=e.zpp_inner.getmax(),s=l.zpp_inner;null!=s._validate&&s._validate(),on.run(t,p,d,u,l.zpp_inner.y,i,n,o,h)}else{d=e.zpp_inner;null!=d._validate&&d._validate();u=e.zpp_inner,l=u.maxx-u.minx,d=r.zpp_inner;null!=d._validate&&d._validate();u=l/r.zpp_inner.x,d=e.zpp_inner;null!=d._validate&&d._validate();l=e.zpp_inner,d=l.maxy-l.miny,l=r.zpp_inner;null!=l._validate&&l._validate();var d=d/r.zpp_inner.y,c=0|u,y=0|d;c!=u&&++c,y!=d&&++y;for(var _=0,m=c;_<m;){var g=_++,f=e.zpp_inner;null!=f._validate&&f._validate();var x=e.zpp_inner.minx,f=r.zpp_inner;null!=f._validate&&f._validate();for(var v,w=x+r.zpp_inner.x*g,z=g==c-1?(null!=(g=(v=e.zpp_inner.getmax()).zpp_inner)._validate&&g._validate(),v.zpp_inner.x):(null!=(v=r.zpp_inner)._validate&&v._validate(),w+r.zpp_inner.x),b=0,S=y;b<S;){var C=b++,P=e.zpp_inner;null!=P._validate&&P._validate();var M=e.zpp_inner.miny,P=r.zpp_inner;null!=P._validate&&P._validate();var P=M+r.zpp_inner.y*C,T=C==y-1?(null!=(C=(M=e.zpp_inner.getmax()).zpp_inner)._validate&&C._validate(),M.zpp_inner.y):(null!=(T=r.zpp_inner)._validate&&T._validate(),P+r.zpp_inner.y);on.run(t,w,P,z,T,i,n,o,h)}}}return i.zpp_inner.weak&&(a=i.zpp_inner,i.zpp_inner.outer=null,i.zpp_inner=null,i.zpp_pool=Bn.poolVec2,Bn.poolVec2=i,null!=a.outer&&(a.outer.zpp_inner=null,a.outer=null),a._isimmutable=null,a._validate=null,a._invalidate=null,a.next=Gr.zpp_pool,Gr.zpp_pool=a),null!=r&&r.zpp_inner.weak&&(a=r.zpp_inner,r.zpp_inner.outer=null,r.zpp_inner=null,r.zpp_pool=Bn.poolVec2,Bn.poolVec2=r,null!=a.outer&&(a.outer.zpp_inner=null,a.outer=null),a._isimmutable=null,a._validate=null,a._invalidate=null,a.next=Gr.zpp_pool,Gr.zpp_pool=a),h},c.prototype.__class__=c;var V=nape.geom.Mat23=function(t,e,i,n,r,o){null==o&&(o=0),null==r&&(r=0),null==n&&(n=1),null==i&&(i=0),null==e&&(e=0),null==t&&(t=1),this.zpp_inner=null,this.zpp_inner=fe.get(),(this.zpp_inner.outer=this).zpp_inner.a=t;t=this.zpp_inner;null!=t._invalidate&&t._invalidate(),this.zpp_inner.b=e;e=this.zpp_inner;null!=e._invalidate&&e._invalidate(),this.zpp_inner.tx=r;r=this.zpp_inner;null!=r._invalidate&&r._invalidate(),this.zpp_inner.c=i;i=this.zpp_inner;null!=i._invalidate&&i._invalidate(),this.zpp_inner.d=n;n=this.zpp_inner;null!=n._invalidate&&n._invalidate(),this.zpp_inner.ty=o;o=this.zpp_inner;null!=o._invalidate&&o._invalidate()};V.__name__=["nape","geom","Mat23"],V.rotation=function(t){var e=Math.cos(t),t=Math.sin(t);return new V(e,-t,t,e,0,0)},V.translation=function(t,e){return new V(1,0,0,1,t,e)},V.scale=function(t,e){return new V(t,0,0,e,0,0)},V.prototype.zpp_inner=null,V.prototype.get_a=function(){return this.zpp_inner.a},V.prototype.set_a=function(t){this.zpp_inner.a=t;t=this.zpp_inner;return null!=t._invalidate&&t._invalidate(),this.zpp_inner.a},V.prototype.get_b=function(){return this.zpp_inner.b},V.prototype.set_b=function(t){this.zpp_inner.b=t;t=this.zpp_inner;return null!=t._invalidate&&t._invalidate(),this.zpp_inner.b},V.prototype.get_c=function(){return this.zpp_inner.c},V.prototype.set_c=function(t){this.zpp_inner.c=t;t=this.zpp_inner;return null!=t._invalidate&&t._invalidate(),this.zpp_inner.c},V.prototype.get_d=function(){return this.zpp_inner.d},V.prototype.set_d=function(t){this.zpp_inner.d=t;t=this.zpp_inner;return null!=t._invalidate&&t._invalidate(),this.zpp_inner.d},V.prototype.get_tx=function(){return this.zpp_inner.tx},V.prototype.set_tx=function(t){this.zpp_inner.tx=t;t=this.zpp_inner;return null!=t._invalidate&&t._invalidate(),this.zpp_inner.tx},V.prototype.get_ty=function(){return this.zpp_inner.ty},V.prototype.set_ty=function(t){this.zpp_inner.ty=t;t=this.zpp_inner;return null!=t._invalidate&&t._invalidate(),this.zpp_inner.ty},V.prototype.copy=function(){return new V(this.zpp_inner.a,this.zpp_inner.b,this.zpp_inner.c,this.zpp_inner.d,this.zpp_inner.tx,this.zpp_inner.ty)},V.prototype.set=function(t){t=t.zpp_inner;this.zpp_inner.setas(t.a,t.b,t.c,t.d,t.tx,t.ty);t=this.zpp_inner;return null!=t._invalidate&&t._invalidate(),this},V.prototype.setAs=function(t,e,i,n,r,o){this.zpp_inner.setas(t=null==t?1:t,e=null==e?0:e,i=null==i?0:i,n=null==n?1:n,r=null==r?0:r,o=null==o?0:o);o=this.zpp_inner;return null!=o._invalidate&&o._invalidate(),this},V.prototype.reset=function(){return this.setAs()},V.prototype.get_determinant=function(){return this.zpp_inner.a*this.zpp_inner.d-this.zpp_inner.b*this.zpp_inner.c},V.prototype.singular=function(){var t=this.zpp_inner.a*this.zpp_inner.a+this.zpp_inner.b*this.zpp_inner.b+this.zpp_inner.c*this.zpp_inner.c+this.zpp_inner.d*this.zpp_inner.d,e=this.zpp_inner.a*this.zpp_inner.d-this.zpp_inner.b*this.zpp_inner.c;return Er.illConditionedThreshold*(e=e<0?-e:e)<t},V.prototype.inverse=function(){var t=1/(this.zpp_inner.a*this.zpp_inner.d-this.zpp_inner.b*this.zpp_inner.c);return new V(this.zpp_inner.d*t,-this.zpp_inner.b*t,-this.zpp_inner.c*t,this.zpp_inner.a*t,(this.zpp_inner.b*this.zpp_inner.ty-this.zpp_inner.d*this.zpp_inner.tx)*t,(this.zpp_inner.c*this.zpp_inner.tx-this.zpp_inner.a*this.zpp_inner.ty)*t)},V.prototype.transpose=function(){return new V(this.zpp_inner.a,this.zpp_inner.c,this.zpp_inner.b,this.zpp_inner.d,-this.zpp_inner.a*this.zpp_inner.tx-this.zpp_inner.c*this.zpp_inner.ty,-this.zpp_inner.b*this.zpp_inner.tx-this.zpp_inner.d*this.zpp_inner.ty)},V.prototype.concat=function(t){return new V(t.zpp_inner.a*this.zpp_inner.a+t.zpp_inner.b*this.zpp_inner.c,t.zpp_inner.a*this.zpp_inner.b+t.zpp_inner.b*this.zpp_inner.d,t.zpp_inner.c*this.zpp_inner.a+t.zpp_inner.d*this.zpp_inner.c,t.zpp_inner.c*this.zpp_inner.b+t.zpp_inner.d*this.zpp_inner.d,t.zpp_inner.a*this.zpp_inner.tx+t.zpp_inner.b*this.zpp_inner.ty+t.zpp_inner.tx,t.zpp_inner.c*this.zpp_inner.tx+t.zpp_inner.d*this.zpp_inner.ty+t.zpp_inner.ty)},V.prototype.transform=function(t,e,i){var n,r,o,s,a,h,l;return null==i&&(i=!1),i=(e=null==e?!1:e)?(null!=(n=t.zpp_inner)._validate&&n._validate(),o=t.zpp_inner.x*this.zpp_inner.a,null!=(e=t.zpp_inner)._validate&&e._validate(),n=o+t.zpp_inner.y*this.zpp_inner.b,null!=(e=t.zpp_inner)._validate&&e._validate(),o=t.zpp_inner.x*this.zpp_inner.c,null!=(e=t.zpp_inner)._validate&&e._validate(),o=o+t.zpp_inner.y*this.zpp_inner.d,null==Bn.poolVec2?s=new St:(s=Bn.poolVec2,Bn.poolVec2=s.zpp_pool,s.zpp_pool=null),null==s.zpp_inner?(null==Gr.zpp_pool?r=new Gr:(r=Gr.zpp_pool,Gr.zpp_pool=r.next,r.next=null),r.weak=!1,r._immutable=!1,r.x=n,r.y=o,s.zpp_inner=r,s.zpp_inner.outer=s):(null!=(r=s.zpp_inner)._validate&&r._validate(),s.zpp_inner.x==n&&(null!=(r=s.zpp_inner)._validate&&r._validate(),s.zpp_inner.y==o)||(s.zpp_inner.x=n,s.zpp_inner.y=o,null!=(h=s.zpp_inner)._invalidate&&h._invalidate(h))),s.zpp_inner.weak=i,s):(null!=(o=t.zpp_inner)._validate&&o._validate(),h=t.zpp_inner.x*this.zpp_inner.a,null!=(s=t.zpp_inner)._validate&&s._validate(),o=h+t.zpp_inner.y*this.zpp_inner.b+this.zpp_inner.tx,null!=(s=t.zpp_inner)._validate&&s._validate(),h=t.zpp_inner.x*this.zpp_inner.c,null!=(s=t.zpp_inner)._validate&&s._validate(),h=h+t.zpp_inner.y*this.zpp_inner.d+this.zpp_inner.ty,null==Bn.poolVec2?l=new St:(l=Bn.poolVec2,Bn.poolVec2=l.zpp_pool,l.zpp_pool=null),null==l.zpp_inner?(null==Gr.zpp_pool?a=new Gr:(a=Gr.zpp_pool,Gr.zpp_pool=a.next,a.next=null),a.weak=!1,a._immutable=!1,a.x=o,a.y=h,l.zpp_inner=a,l.zpp_inner.outer=l):(null!=(a=l.zpp_inner)._validate&&a._validate(),l.zpp_inner.x==o&&(null!=(a=l.zpp_inner)._validate&&a._validate(),l.zpp_inner.y==h)||(l.zpp_inner.x=o,l.zpp_inner.y=h,null!=(h=l.zpp_inner)._invalidate&&h._invalidate(h))),l.zpp_inner.weak=i,l),t.zpp_inner.weak&&(l=t.zpp_inner,t.zpp_inner.outer=null,t.zpp_inner=null,t.zpp_pool=Bn.poolVec2,Bn.poolVec2=t,null!=l.outer&&(l.outer.zpp_inner=null,l.outer=null),l._isimmutable=null,l._validate=null,l._invalidate=null,l.next=Gr.zpp_pool,Gr.zpp_pool=l),i},V.prototype.inverseTransform=function(t,e,i){null==i&&(i=!1);var n,r,o,s,a,h,l,p=1/(this.zpp_inner.a*this.zpp_inner.d-this.zpp_inner.b*this.zpp_inner.c),i=(e=null==e?!1:e)?(null!=(n=t.zpp_inner)._validate&&n._validate(),s=t.zpp_inner.x*this.zpp_inner.d,null!=(e=t.zpp_inner)._validate&&e._validate(),n=(s-t.zpp_inner.y*this.zpp_inner.b)*p,null!=(e=t.zpp_inner)._validate&&e._validate(),s=t.zpp_inner.y*this.zpp_inner.a,null!=(e=t.zpp_inner)._validate&&e._validate(),s=(s-t.zpp_inner.x*this.zpp_inner.c)*p,null==Bn.poolVec2?a=new St:(a=Bn.poolVec2,Bn.poolVec2=a.zpp_pool,a.zpp_pool=null),null==a.zpp_inner?(null==Gr.zpp_pool?r=new Gr:(r=Gr.zpp_pool,Gr.zpp_pool=r.next,r.next=null),r.weak=!1,r._immutable=!1,r.x=n,r.y=s,a.zpp_inner=r,a.zpp_inner.outer=a):(null!=(r=a.zpp_inner)._validate&&r._validate(),a.zpp_inner.x==n&&(null!=(r=a.zpp_inner)._validate&&r._validate(),a.zpp_inner.y==s)||(a.zpp_inner.x=n,a.zpp_inner.y=s,null!=(o=a.zpp_inner)._invalidate&&o._invalidate(o))),a.zpp_inner.weak=i,a):(null!=(s=t.zpp_inner)._validate&&s._validate(),o=t.zpp_inner.x-this.zpp_inner.tx,null!=(a=t.zpp_inner)._validate&&a._validate(),s=t.zpp_inner.y-this.zpp_inner.ty,a=(o*this.zpp_inner.d-s*this.zpp_inner.b)*p,p=(s*this.zpp_inner.a-o*this.zpp_inner.c)*p,null==Bn.poolVec2?l=new St:(l=Bn.poolVec2,Bn.poolVec2=l.zpp_pool,l.zpp_pool=null),null==l.zpp_inner?(null==Gr.zpp_pool?h=new Gr:(h=Gr.zpp_pool,Gr.zpp_pool=h.next,h.next=null),h.weak=!1,h._immutable=!1,h.x=a,h.y=p,l.zpp_inner=h,l.zpp_inner.outer=l):(null!=(h=l.zpp_inner)._validate&&h._validate(),l.zpp_inner.x==a&&(null!=(h=l.zpp_inner)._validate&&h._validate(),l.zpp_inner.y==p)||(l.zpp_inner.x=a,l.zpp_inner.y=p,null!=(p=l.zpp_inner)._invalidate&&p._invalidate(p))),l.zpp_inner.weak=i,l);return t.zpp_inner.weak&&(l=t.zpp_inner,t.zpp_inner.outer=null,t.zpp_inner=null,t.zpp_pool=Bn.poolVec2,Bn.poolVec2=t,null!=l.outer&&(l.outer.zpp_inner=null,l.outer=null),l._isimmutable=null,l._validate=null,l._invalidate=null,l.next=Gr.zpp_pool,Gr.zpp_pool=l),i},V.prototype.toString=function(){return"{ a: "+this.zpp_inner.a+" b: "+this.zpp_inner.b+" c: "+this.zpp_inner.c+" d: "+this.zpp_inner.d+" tx: "+this.zpp_inner.tx+" ty: "+this.zpp_inner.ty+" }"},V.prototype.equiorthogonal=function(){if(this.singular())return!1;var t=this.zpp_inner.a*this.zpp_inner.b+this.zpp_inner.c*this.zpp_inner.d;if(t*t<Er.epsilon){t=this.zpp_inner.a*this.zpp_inner.a+this.zpp_inner.b*this.zpp_inner.b-this.zpp_inner.c*this.zpp_inner.c-this.zpp_inner.d*this.zpp_inner.d;return t*t<Er.epsilon}return!1},V.prototype.orthogonal=function(){var t=this.zpp_inner.a*this.zpp_inner.b+this.zpp_inner.c*this.zpp_inner.d;if(t*t<Er.epsilon){var e=this.zpp_inner.a*this.zpp_inner.a+this.zpp_inner.b*this.zpp_inner.b-1,t=this.zpp_inner.c*this.zpp_inner.c+this.zpp_inner.d*this.zpp_inner.d-1;return e*e<Er.epsilon&&t*t<Er.epsilon}return!1},V.prototype.equiorthogonalise=function(){var t,e,i,n,r;return this.equiorthogonal()||(t=(r=((i=Math.sqrt(this.zpp_inner.a*this.zpp_inner.a+this.zpp_inner.c*this.zpp_inner.c))+(t=Math.sqrt(this.zpp_inner.b*this.zpp_inner.b+this.zpp_inner.d*this.zpp_inner.d)))/2)/t,this.zpp_inner.a=this.zpp_inner.a*(i=r/i),null!=(n=this.zpp_inner)._invalidate&&n._invalidate(),this.zpp_inner.c=this.zpp_inner.c*i,null!=(e=this.zpp_inner)._invalidate&&e._invalidate(),this.zpp_inner.b=this.zpp_inner.b*t,null!=(n=this.zpp_inner)._invalidate&&n._invalidate(),this.zpp_inner.d=this.zpp_inner.d*t,null!=(i=this.zpp_inner)._invalidate&&i._invalidate(),e=.25*Math.PI-.5*Math.acos((this.zpp_inner.a*this.zpp_inner.b+this.zpp_inner.c*this.zpp_inner.d)/(r*r)),0<this.zpp_inner.a*this.zpp_inner.d-this.zpp_inner.b*this.zpp_inner.c&&(e=-e),n=Math.sin(e),t=Math.cos(e),i=this.zpp_inner.a*t-this.zpp_inner.c*n,r=this.zpp_inner.b*t+this.zpp_inner.d*n,this.zpp_inner.c=this.zpp_inner.c*t+this.zpp_inner.a*n,null!=(e=this.zpp_inner)._invalidate&&e._invalidate(),this.zpp_inner.a=i,null!=(i=this.zpp_inner)._invalidate&&i._invalidate(),this.zpp_inner.d=this.zpp_inner.d*t-this.zpp_inner.b*n,null!=(n=this.zpp_inner)._invalidate&&n._invalidate(),this.zpp_inner.b=r,null!=(r=this.zpp_inner)._invalidate&&r._invalidate(),null!=(r=this.zpp_inner)._invalidate&&r._invalidate()),this},V.prototype.orthogonalise=function(){var t,e,i,n,r;return this.orthogonal()||(e=Math.sqrt(this.zpp_inner.a*this.zpp_inner.a+this.zpp_inner.c*this.zpp_inner.c),i=1/(i=Math.sqrt(this.zpp_inner.b*this.zpp_inner.b+this.zpp_inner.d*this.zpp_inner.d)),this.zpp_inner.a=this.zpp_inner.a*(e=1/e),null!=(r=this.zpp_inner)._invalidate&&r._invalidate(),this.zpp_inner.c=this.zpp_inner.c*e,null!=(n=this.zpp_inner)._invalidate&&n._invalidate(),this.zpp_inner.b=this.zpp_inner.b*i,null!=(t=this.zpp_inner)._invalidate&&t._invalidate(),this.zpp_inner.d=this.zpp_inner.d*i,null!=(r=this.zpp_inner)._invalidate&&r._invalidate(),e=.25*Math.PI-.5*Math.acos(this.zpp_inner.a*this.zpp_inner.b+this.zpp_inner.c*this.zpp_inner.d),0<this.zpp_inner.a*this.zpp_inner.d-this.zpp_inner.b*this.zpp_inner.c&&(e=-e),n=Math.sin(e),t=Math.cos(e),i=this.zpp_inner.a*t-this.zpp_inner.c*n,r=this.zpp_inner.b*t+this.zpp_inner.d*n,this.zpp_inner.c=this.zpp_inner.c*t+this.zpp_inner.a*n,null!=(e=this.zpp_inner)._invalidate&&e._invalidate(),this.zpp_inner.a=i,null!=(i=this.zpp_inner)._invalidate&&i._invalidate(),this.zpp_inner.d=this.zpp_inner.d*t-this.zpp_inner.b*n,null!=(n=this.zpp_inner)._invalidate&&n._invalidate(),this.zpp_inner.b=r,null!=(r=this.zpp_inner)._invalidate&&r._invalidate(),null!=(r=this.zpp_inner)._invalidate&&r._invalidate()),this},Object.defineProperty(V.prototype,"a",{get:V.prototype.get_a,set:V.prototype.set_a}),Object.defineProperty(V.prototype,"b",{get:V.prototype.get_b,set:V.prototype.set_b}),Object.defineProperty(V.prototype,"c",{get:V.prototype.get_c,set:V.prototype.set_c}),Object.defineProperty(V.prototype,"d",{get:V.prototype.get_d,set:V.prototype.set_d}),Object.defineProperty(V.prototype,"tx",{get:V.prototype.get_tx,set:V.prototype.set_tx}),Object.defineProperty(V.prototype,"ty",{get:V.prototype.get_ty,set:V.prototype.set_ty}),Object.defineProperty(V.prototype,"determinant",{get:V.prototype.get_determinant}),V.prototype.__class__=V;var W=nape.geom.MatMN=function(t,e){this.zpp_inner=null,this.zpp_inner=new xe(t,e),this.zpp_inner.outer=this};W.__name__=["nape","geom","MatMN"],W.prototype.zpp_inner=null,W.prototype.get_rows=function(){return this.zpp_inner.m},W.prototype.get_cols=function(){return this.zpp_inner.n},W.prototype.x=function(t,e){return this.zpp_inner.x[t*this.zpp_inner.n+e]},W.prototype.setx=function(t,e,i){return this.zpp_inner.x[t*this.zpp_inner.n+e]=i},W.prototype.toString=function(){for(var t="{ ",e=!0,i=0,n=this.zpp_inner.m;i<n;){var r=i++;e||(t+="; ");for(var e=!1,o=0,s=this.zpp_inner.n;o<s;)t+=this.zpp_inner.x[r*this.zpp_inner.n+o++]+" "}return t+="}"},W.prototype.transpose=function(){for(var t=new W(this.zpp_inner.n,this.zpp_inner.m),e=0,i=this.zpp_inner.m;e<i;)for(var n=e++,r=0,o=this.zpp_inner.n;r<o;){var s=r++;t.zpp_inner.x[s*t.zpp_inner.n+n]=this.zpp_inner.x[n*this.zpp_inner.n+s]}return t},W.prototype.mul=function(t){for(var e=new W(this.zpp_inner.m,t.zpp_inner.n),i=0,n=this.zpp_inner.m;i<n;)for(var r=i++,o=0,s=t.zpp_inner.n;o<s;){for(var a=o++,h=0,l=0,p=this.zpp_inner.n;l<p;){var u=l++;h+=this.zpp_inner.x[r*this.zpp_inner.n+u]*t.zpp_inner.x[u*t.zpp_inner.n+a]}e.zpp_inner.x[r*e.zpp_inner.n+a]=h}return e},Object.defineProperty(W.prototype,"rows",{get:W.prototype.get_rows}),Object.defineProperty(W.prototype,"cols",{get:W.prototype.get_cols}),W.prototype.__class__=W;var X=nape.geom.Ray=function(t,e){this.zpp_inner=null,this.zpp_inner=new be;var i=this.zpp_inner.origin,n=t.zpp_inner;null!=n._validate&&n._validate();var r=t.zpp_inner.x,o=t.zpp_inner;null!=o._validate&&o._validate();var n=t.zpp_inner.y,o=i.zpp_inner;null!=o._validate&&o._validate(),i.zpp_inner.x==r&&(null!=(o=i.zpp_inner)._validate&&o._validate(),i.zpp_inner.y==n)||(i.zpp_inner.x=r,i.zpp_inner.y=n,null!=(s=i.zpp_inner)._invalidate&&s._invalidate(s)),t.zpp_inner.weak&&(a=t.zpp_inner,t.zpp_inner.outer=null,t.zpp_inner=null,t.zpp_pool=Bn.poolVec2,Bn.poolVec2=t,null!=a.outer&&(a.outer.zpp_inner=null,a.outer=null),a._isimmutable=null,a._validate=null,a._invalidate=null,a.next=Gr.zpp_pool,Gr.zpp_pool=a);var i=this.zpp_inner.direction,s=e.zpp_inner;null!=s._validate&&s._validate();var t=e.zpp_inner.x,a=e.zpp_inner;null!=a._validate&&a._validate();var h,s=e.zpp_inner.y,a=i.zpp_inner;null!=a._validate&&a._validate(),i.zpp_inner.x==t&&(null!=(a=i.zpp_inner)._validate&&a._validate(),i.zpp_inner.y==s)||(i.zpp_inner.x=t,i.zpp_inner.y=s,null!=(h=i.zpp_inner)._invalidate&&h._invalidate(h)),e.zpp_inner.weak&&(h=e.zpp_inner,e.zpp_inner.outer=null,e.zpp_inner=null,e.zpp_pool=Bn.poolVec2,Bn.poolVec2=e,null!=h.outer&&(h.outer.zpp_inner=null,h.outer=null),h._isimmutable=null,h._validate=null,h._invalidate=null,h.next=Gr.zpp_pool,Gr.zpp_pool=h),this.zpp_inner.zip_dir=!0,this.zpp_inner.maxdist=1/0};X.__name__=["nape","geom","Ray"],X.fromSegment=function(t,e){var i=new X(t,e.sub(t,!0)),n=t.zpp_inner;null!=n._validate&&n._validate();var r=t.zpp_inner.x,o=t.zpp_inner;null!=o._validate&&o._validate();var s=t.zpp_inner.y,n=e.zpp_inner;null!=n._validate&&n._validate();var o=e.zpp_inner.x,n=e.zpp_inner;null!=n._validate&&n._validate();var a,o=r-o,s=s-e.zpp_inner.y;return i.zpp_inner.maxdist=Math.sqrt(o*o+s*s),t.zpp_inner.weak&&(a=t.zpp_inner,t.zpp_inner.outer=null,t.zpp_inner=null,t.zpp_pool=Bn.poolVec2,Bn.poolVec2=t,null!=a.outer&&(a.outer.zpp_inner=null,a.outer=null),a._isimmutable=null,a._validate=null,a._invalidate=null,a.next=Gr.zpp_pool,Gr.zpp_pool=a),e.zpp_inner.weak&&(a=e.zpp_inner,e.zpp_inner.outer=null,e.zpp_inner=null,e.zpp_pool=Bn.poolVec2,Bn.poolVec2=e,null!=a.outer&&(a.outer.zpp_inner=null,a.outer=null),a._isimmutable=null,a._validate=null,a._invalidate=null,a.next=Gr.zpp_pool,Gr.zpp_pool=a),i},X.prototype.zpp_inner=null,X.prototype.get_userData=function(){return null==this.zpp_inner.userData&&(this.zpp_inner.userData={}),this.zpp_inner.userData},X.prototype.get_origin=function(){return this.zpp_inner.origin},X.prototype.set_origin=function(t){var e=this.zpp_inner.origin,i=t.zpp_inner;null!=i._validate&&i._validate();var n=t.zpp_inner.x,r=t.zpp_inner;null!=r._validate&&r._validate();var o,i=t.zpp_inner.y,r=e.zpp_inner;return null!=r._validate&&r._validate(),e.zpp_inner.x==n&&(null!=(r=e.zpp_inner)._validate&&r._validate(),e.zpp_inner.y==i)||(e.zpp_inner.x=n,e.zpp_inner.y=i,null!=(o=e.zpp_inner)._invalidate&&o._invalidate(o)),t.zpp_inner.weak&&(o=t.zpp_inner,t.zpp_inner.outer=null,t.zpp_inner=null,t.zpp_pool=Bn.poolVec2,Bn.poolVec2=t,null!=o.outer&&(o.outer.zpp_inner=null,o.outer=null),o._isimmutable=null,o._validate=null,o._invalidate=null,o.next=Gr.zpp_pool,Gr.zpp_pool=o),this.zpp_inner.origin},X.prototype.get_direction=function(){return this.zpp_inner.direction},X.prototype.set_direction=function(t){var e=this.zpp_inner.direction,i=t.zpp_inner;null!=i._validate&&i._validate();var n=t.zpp_inner.x,r=t.zpp_inner;null!=r._validate&&r._validate();var o,i=t.zpp_inner.y,r=e.zpp_inner;return null!=r._validate&&r._validate(),e.zpp_inner.x==n&&(null!=(r=e.zpp_inner)._validate&&r._validate(),e.zpp_inner.y==i)||(e.zpp_inner.x=n,e.zpp_inner.y=i,null!=(o=e.zpp_inner)._invalidate&&o._invalidate(o)),t.zpp_inner.weak&&(o=t.zpp_inner,t.zpp_inner.outer=null,t.zpp_inner=null,t.zpp_pool=Bn.poolVec2,Bn.poolVec2=t,null!=o.outer&&(o.outer.zpp_inner=null,o.outer=null),o._isimmutable=null,o._validate=null,o._invalidate=null,o.next=Gr.zpp_pool,Gr.zpp_pool=o),this.zpp_inner.zip_dir=!0,this.zpp_inner.direction},X.prototype.get_maxDistance=function(){return this.zpp_inner.maxdist},X.prototype.set_maxDistance=function(t){return this.zpp_inner.maxdist=t,this.zpp_inner.maxdist},X.prototype.aabb=function(){return this.zpp_inner.rayAABB().wrapper()},X.prototype.at=function(t,e){null==e&&(e=!1),this.zpp_inner.validate_dir();var i=this.zpp_inner.origin,n=i.zpp_inner;null!=n._validate&&n._validate();var r=i.zpp_inner.x+t*this.zpp_inner.dirx,n=this.zpp_inner.origin,i=n.zpp_inner;null!=i._validate&&i._validate();var o,s,t=n.zpp_inner.y+t*this.zpp_inner.diry;return null==Bn.poolVec2?o=new St:(o=Bn.poolVec2,Bn.poolVec2=o.zpp_pool,o.zpp_pool=null),null==o.zpp_inner?(null==Gr.zpp_pool?s=new Gr:(s=Gr.zpp_pool,Gr.zpp_pool=s.next,s.next=null),s.weak=!1,s._immutable=!1,s.x=r,s.y=t,o.zpp_inner=s,o.zpp_inner.outer=o):(null!=(s=o.zpp_inner)._validate&&s._validate(),o.zpp_inner.x==r&&(null!=(s=o.zpp_inner)._validate&&s._validate(),o.zpp_inner.y==t)||(o.zpp_inner.x=r,o.zpp_inner.y=t,null!=(t=o.zpp_inner)._invalidate&&t._invalidate(t))),o.zpp_inner.weak=e,o},X.prototype.copy=function(){var t=new X(this.zpp_inner.origin,this.zpp_inner.direction);return t.zpp_inner.maxdist=this.zpp_inner.maxdist,t},Object.defineProperty(X.prototype,"userData",{get:X.prototype.get_userData}),Object.defineProperty(X.prototype,"origin",{get:X.prototype.get_origin,set:X.prototype.set_origin}),Object.defineProperty(X.prototype,"direction",{get:X.prototype.get_direction,set:X.prototype.set_direction}),Object.defineProperty(X.prototype,"maxDistance",{get:X.prototype.get_maxDistance,set:X.prototype.set_maxDistance}),X.prototype.__class__=X;var H=nape.geom.RayResult=function(){this.zpp_inner=null};H.__name__=["nape","geom","RayResult"],H.prototype.zpp_inner=null,H.prototype.get_normal=function(){return this.zpp_inner.normal},H.prototype.get_distance=function(){return this.zpp_inner.toiDistance},H.prototype.get_inner=function(){return this.zpp_inner.inner},H.prototype.get_shape=function(){return this.zpp_inner.shape},H.prototype.dispose=function(){this.zpp_inner.free()},H.prototype.toString=function(){return"{ shape: "+n.string(this.zpp_inner.shape)+" distance: "+this.zpp_inner.toiDistance+" ?inner: "+n.string(this.zpp_inner.inner)+" }"},Object.defineProperty(H.prototype,"normal",{get:H.prototype.get_normal}),Object.defineProperty(H.prototype,"distance",{get:H.prototype.get_distance}),Object.defineProperty(H.prototype,"inner",{get:H.prototype.get_inner}),Object.defineProperty(H.prototype,"shape",{get:H.prototype.get_shape}),H.prototype.__class__=H;var Jt=nape.geom.RayResultIterator=function(){this.zpp_next=null,this.zpp_critical=!1,this.zpp_i=0,this.zpp_inner=null};Jt.__name__=["nape","geom","RayResultIterator"],Jt.get=function(t){var e,i=null==Jt.zpp_pool?(kn.internal=!0,e=new Jt,kn.internal=!1,e):(Jt.zpp_pool=(i=Jt.zpp_pool).zpp_next,i);return i.zpp_i=0,i.zpp_inner=t,i.zpp_critical=!1,i},Jt.prototype.zpp_inner=null,Jt.prototype.zpp_i=null,Jt.prototype.zpp_critical=null,Jt.prototype.zpp_next=null,Jt.prototype.hasNext=function(){this.zpp_inner.zpp_inner.valmod();var t=this.zpp_inner;t.zpp_inner.valmod(),t.zpp_inner.zip_length&&(t.zpp_inner.zip_length=!1,t.zpp_inner.user_length=t.zpp_inner.inner.length);t=t.zpp_inner.user_length;return this.zpp_critical=!0,this.zpp_i<t||(this.zpp_next=Jt.zpp_pool,(Jt.zpp_pool=this).zpp_inner=null,!1)},Jt.prototype.next=function(){return this.zpp_critical=!1,this.zpp_inner.at(this.zpp_i++)},Jt.prototype.__class__=Jt;var q=nape.geom.RayResultList=function(){this.zpp_inner=null,this.zpp_inner=new kn,this.zpp_inner.outer=this};q.__name__=["nape","geom","RayResultList"],q.fromArray=function(t){for(var e=new q,i=0;i<t.length;){var n=t[i];++i,e.push(n)}return e},q.prototype.zpp_inner=null,q.prototype.get_length=function(){return this.zpp_inner.valmod(),this.zpp_inner.zip_length&&(this.zpp_inner.zip_length=!1,this.zpp_inner.user_length=this.zpp_inner.inner.length),this.zpp_inner.user_length},q.prototype.has=function(t){return this.zpp_inner.valmod(),this.zpp_inner.inner.has(t)},q.prototype.at=function(t){if(this.zpp_inner.valmod(),this.zpp_inner.reverse_flag&&(this.zpp_inner.valmod(),this.zpp_inner.zip_length&&(this.zpp_inner.zip_length=!1,this.zpp_inner.user_length=this.zpp_inner.inner.length),t=this.zpp_inner.user_length-1-t),t<this.zpp_inner.at_index||null==this.zpp_inner.at_ite)this.zpp_inner.at_index=t,this.zpp_inner.at_ite=this.zpp_inner.inner.iterator_at(t);else for(;this.zpp_inner.at_index!=t;)this.zpp_inner.at_index++,this.zpp_inner.at_ite=this.zpp_inner.at_ite.next;return this.zpp_inner.at_ite.elt},q.prototype.push=function(t){this.zpp_inner.modify_test(),this.zpp_inner.valmod();var e,i=null==this.zpp_inner.adder||this.zpp_inner.adder(t);return i&&(this.zpp_inner.reverse_flag?this.zpp_inner.inner.add(t):(null==this.zpp_inner.push_ite&&(e=null==this.zpp_inner.inner.head?null:(this.zpp_inner.valmod(),this.zpp_inner.zip_length&&(this.zpp_inner.zip_length=!1,this.zpp_inner.user_length=this.zpp_inner.inner.length),this.zpp_inner.inner.iterator_at(this.zpp_inner.user_length-1)),this.zpp_inner.push_ite=e),this.zpp_inner.push_ite=this.zpp_inner.inner.insert(this.zpp_inner.push_ite,t)),this.zpp_inner.invalidate(),null!=this.zpp_inner.post_adder&&this.zpp_inner.post_adder(t)),i},q.prototype.unshift=function(t){this.zpp_inner.modify_test(),this.zpp_inner.valmod();var e,i=null==this.zpp_inner.adder||this.zpp_inner.adder(t);return i&&(this.zpp_inner.reverse_flag?(null==this.zpp_inner.push_ite&&(e=null==this.zpp_inner.inner.head?null:(this.zpp_inner.valmod(),this.zpp_inner.zip_length&&(this.zpp_inner.zip_length=!1,this.zpp_inner.user_length=this.zpp_inner.inner.length),this.zpp_inner.inner.iterator_at(this.zpp_inner.user_length-1)),this.zpp_inner.push_ite=e),this.zpp_inner.push_ite=this.zpp_inner.inner.insert(this.zpp_inner.push_ite,t)):this.zpp_inner.inner.add(t),this.zpp_inner.invalidate(),null!=this.zpp_inner.post_adder&&this.zpp_inner.post_adder(t)),i},q.prototype.pop=function(){this.zpp_inner.modify_test(),this.zpp_inner.valmod();var t,e,i=null;return this.zpp_inner.reverse_flag?(e=i=this.zpp_inner.inner.head.elt,null!=this.zpp_inner.subber&&this.zpp_inner.subber(e),this.zpp_inner.dontremove||this.zpp_inner.inner.pop()):(null!=this.zpp_inner.at_ite&&null==this.zpp_inner.at_ite.next&&(this.zpp_inner.at_ite=null),this.zpp_inner.valmod(),this.zpp_inner.zip_length&&(this.zpp_inner.zip_length=!1,this.zpp_inner.user_length=this.zpp_inner.inner.length),e=i=(null==(t=1==this.zpp_inner.user_length?null:(this.zpp_inner.valmod(),this.zpp_inner.zip_length&&(this.zpp_inner.zip_length=!1,this.zpp_inner.user_length=this.zpp_inner.inner.length),this.zpp_inner.inner.iterator_at(this.zpp_inner.user_length-2)))?this.zpp_inner.inner.head:t.next).elt,null!=this.zpp_inner.subber&&this.zpp_inner.subber(e),this.zpp_inner.dontremove||this.zpp_inner.inner.erase(t)),this.zpp_inner.invalidate(),i},q.prototype.shift=function(){this.zpp_inner.modify_test(),this.zpp_inner.valmod();var t,e,i=null;return this.zpp_inner.reverse_flag?(null!=this.zpp_inner.at_ite&&null==this.zpp_inner.at_ite.next&&(this.zpp_inner.at_ite=null),this.zpp_inner.valmod(),this.zpp_inner.zip_length&&(this.zpp_inner.zip_length=!1,this.zpp_inner.user_length=this.zpp_inner.inner.length),t=i=(null==(e=1==this.zpp_inner.user_length?null:(this.zpp_inner.valmod(),this.zpp_inner.zip_length&&(this.zpp_inner.zip_length=!1,this.zpp_inner.user_length=this.zpp_inner.inner.length),this.zpp_inner.inner.iterator_at(this.zpp_inner.user_length-2)))?this.zpp_inner.inner.head:e.next).elt,null!=this.zpp_inner.subber&&this.zpp_inner.subber(t),this.zpp_inner.dontremove||this.zpp_inner.inner.erase(e)):(e=i=this.zpp_inner.inner.head.elt,null!=this.zpp_inner.subber&&this.zpp_inner.subber(e),this.zpp_inner.dontremove||this.zpp_inner.inner.pop()),this.zpp_inner.invalidate(),i},q.prototype.add=function(t){return this.zpp_inner.reverse_flag?this.push(t):this.unshift(t)},q.prototype.remove=function(t){this.zpp_inner.modify_test(),this.zpp_inner.valmod();for(var e=!1,i=this.zpp_inner.inner.head;null!=i;){if(i.elt==t){e=!0;break}i=i.next}return e&&(null!=this.zpp_inner.subber&&this.zpp_inner.subber(t),this.zpp_inner.dontremove||this.zpp_inner.inner.remove(t),this.zpp_inner.invalidate()),e},q.prototype.clear=function(){if(this.zpp_inner.reverse_flag)for(;null!=this.zpp_inner.inner.head;)this.pop();else for(;null!=this.zpp_inner.inner.head;)this.shift()},q.prototype.empty=function(){return null==this.zpp_inner.inner.head},q.prototype.iterator=function(){return this.zpp_inner.valmod(),Jt.get(this)},q.prototype.copy=function(t){null==t&&(t=!1);var e=new q;this.zpp_inner.valmod();for(var i=Jt.get(this);;){i.zpp_inner.zpp_inner.valmod();var n=i.zpp_inner;n.zpp_inner.valmod(),n.zpp_inner.zip_length&&(n.zpp_inner.zip_length=!1,n.zpp_inner.user_length=n.zpp_inner.inner.length);n=n.zpp_inner.user_length;if(i.zpp_critical=!0,!(i.zpp_i<n||(i.zpp_next=Jt.zpp_pool,(Jt.zpp_pool=i).zpp_inner=null,!1)))break;i.zpp_critical=!1;n=i.zpp_inner.at(i.zpp_i++);e.push(t?null:n)}return e},q.prototype.merge=function(t){t.zpp_inner.valmod();for(var e=Jt.get(t);;){e.zpp_inner.zpp_inner.valmod();var i=e.zpp_inner;i.zpp_inner.valmod(),i.zpp_inner.zip_length&&(i.zpp_inner.zip_length=!1,i.zpp_inner.user_length=i.zpp_inner.inner.length);i=i.zpp_inner.user_length;if(e.zpp_critical=!0,!(e.zpp_i<i||(e.zpp_next=Jt.zpp_pool,(Jt.zpp_pool=e).zpp_inner=null,!1)))break;e.zpp_critical=!1;i=e.zpp_inner.at(e.zpp_i++);this.has(i)||(this.zpp_inner.reverse_flag?this.push(i):this.unshift(i))}},q.prototype.toString=function(){var t="[",e=!0;this.zpp_inner.valmod();for(var i=Jt.get(this);;){i.zpp_inner.zpp_inner.valmod();var n=i.zpp_inner;n.zpp_inner.valmod(),n.zpp_inner.zip_length&&(n.zpp_inner.zip_length=!1,n.zpp_inner.user_length=n.zpp_inner.inner.length);n=n.zpp_inner.user_length;if(i.zpp_critical=!0,!(i.zpp_i<n||(i.zpp_next=Jt.zpp_pool,(Jt.zpp_pool=i).zpp_inner=null,!1)))break;i.zpp_critical=!1;n=i.zpp_inner.at(i.zpp_i++);e||(t+=","),t+=null==n?"NULL":n.toString(),e=!1}return t+"]"},q.prototype.foreach=function(t){this.zpp_inner.valmod();for(var e=Jt.get(this);;){e.zpp_inner.zpp_inner.valmod();var i=e.zpp_inner;i.zpp_inner.valmod(),i.zpp_inner.zip_length&&(i.zpp_inner.zip_length=!1,i.zpp_inner.user_length=i.zpp_inner.inner.length);i=i.zpp_inner.user_length;if(e.zpp_critical=!0,!(e.zpp_i<i||(e.zpp_next=Jt.zpp_pool,(Jt.zpp_pool=e).zpp_inner=null,!1)))break;try{e.zpp_critical=!1,t(e.zpp_inner.at(e.zpp_i++))}catch(t){e.zpp_next=Jt.zpp_pool,(Jt.zpp_pool=e).zpp_inner=null;break}}return this},q.prototype.filter=function(t){for(var e=0;;){if(this.zpp_inner.valmod(),this.zpp_inner.zip_length&&(this.zpp_inner.zip_length=!1,this.zpp_inner.user_length=this.zpp_inner.inner.length),!(e<this.zpp_inner.user_length))break;var i=this.at(e);try{t(i)?++e:this.remove(i)}catch(t){break}}return this},Object.defineProperty(q.prototype,"length",{get:q.prototype.get_length}),q.prototype.__class__=q;var St=nape.geom.Vec2=function(t,e){var i;null==e&&(e=0),null==t&&(t=0),this.zpp_pool=null,(this.zpp_inner=null)==Gr.zpp_pool?i=new Gr:(i=Gr.zpp_pool,Gr.zpp_pool=i.next,i.next=null),i.weak=!1,i._immutable=!1,i.x=t,i.y=e,this.zpp_inner=i,this.zpp_inner.outer=this};St.__name__=["nape","geom","Vec2"],St.weak=function(t,e){var i,n;return null==e&&(e=0),null==t&&(t=0),null==Bn.poolVec2?i=new St:(i=Bn.poolVec2,Bn.poolVec2=i.zpp_pool,i.zpp_pool=null),null==i.zpp_inner?(null==Gr.zpp_pool?n=new Gr:(n=Gr.zpp_pool,Gr.zpp_pool=n.next,n.next=null),n.weak=!1,n._immutable=!1,n.x=t,n.y=e,i.zpp_inner=n,i.zpp_inner.outer=i):(null!=(n=i.zpp_inner)._validate&&n._validate(),i.zpp_inner.x==t&&(null!=(n=i.zpp_inner)._validate&&n._validate(),i.zpp_inner.y==e)||(i.zpp_inner.x=t,i.zpp_inner.y=e,null!=(e=i.zpp_inner)._invalidate&&e._invalidate(e))),i.zpp_inner.weak=!0,i},St.get=function(t,e,i){var n,r;return null==i&&(i=!1),null==e&&(e=0),null==t&&(t=0),null==Bn.poolVec2?n=new St:(n=Bn.poolVec2,Bn.poolVec2=n.zpp_pool,n.zpp_pool=null),null==n.zpp_inner?(null==Gr.zpp_pool?r=new Gr:(r=Gr.zpp_pool,Gr.zpp_pool=r.next,r.next=null),r.weak=!1,r._immutable=!1,r.x=t,r.y=e,n.zpp_inner=r,n.zpp_inner.outer=n):(null!=(r=n.zpp_inner)._validate&&r._validate(),n.zpp_inner.x==t&&(null!=(r=n.zpp_inner)._validate&&r._validate(),n.zpp_inner.y==e)||(n.zpp_inner.x=t,n.zpp_inner.y=e,null!=(e=n.zpp_inner)._invalidate&&e._invalidate(e))),n.zpp_inner.weak=i,n},St.fromPolar=function(t,e,i){null==i&&(i=!1);var n,r,o=t*Math.cos(e),e=t*Math.sin(e);return null==Bn.poolVec2?n=new St:(n=Bn.poolVec2,Bn.poolVec2=n.zpp_pool,n.zpp_pool=null),null==n.zpp_inner?(null==Gr.zpp_pool?r=new Gr:(r=Gr.zpp_pool,Gr.zpp_pool=r.next,r.next=null),r.weak=!1,r._immutable=!1,r.x=o,r.y=e,n.zpp_inner=r,n.zpp_inner.outer=n):(null!=(r=n.zpp_inner)._validate&&r._validate(),n.zpp_inner.x==o&&(null!=(r=n.zpp_inner)._validate&&r._validate(),n.zpp_inner.y==e)||(n.zpp_inner.x=o,n.zpp_inner.y=e,null!=(e=n.zpp_inner)._invalidate&&e._invalidate(e))),n.zpp_inner.weak=i,n},St.dsq=function(t,e){var i=t.zpp_inner;null!=i._validate&&i._validate();var n=t.zpp_inner.x,r=t.zpp_inner;null!=r._validate&&r._validate();var o=t.zpp_inner.y,s=e.zpp_inner;null!=s._validate&&s._validate();i=e.zpp_inner.x,r=e.zpp_inner;null!=r._validate&&r._validate();var a,s=0,r=0,r=(s=n-i)*s+(r=o-e.zpp_inner.y)*r;return t.zpp_inner.weak&&(a=t.zpp_inner,t.zpp_inner.outer=null,t.zpp_inner=null,t.zpp_pool=Bn.poolVec2,Bn.poolVec2=t,null!=a.outer&&(a.outer.zpp_inner=null,a.outer=null),a._isimmutable=null,a._validate=null,a._invalidate=null,a.next=Gr.zpp_pool,Gr.zpp_pool=a),e.zpp_inner.weak&&(a=e.zpp_inner,e.zpp_inner.outer=null,e.zpp_inner=null,e.zpp_pool=Bn.poolVec2,Bn.poolVec2=e,null!=a.outer&&(a.outer.zpp_inner=null,a.outer=null),a._isimmutable=null,a._validate=null,a._invalidate=null,a.next=Gr.zpp_pool,Gr.zpp_pool=a),r},St.distance=function(t,e){var i=t.zpp_inner;null!=i._validate&&i._validate();var n=t.zpp_inner.x,r=t.zpp_inner;null!=r._validate&&r._validate();var o=t.zpp_inner.y,i=e.zpp_inner;null!=i._validate&&i._validate();var r=e.zpp_inner.x,i=e.zpp_inner;null!=i._validate&&i._validate();var s,r=n-r,o=o-e.zpp_inner.y,o=Math.sqrt(r*r+o*o);return t.zpp_inner.weak&&(s=t.zpp_inner,t.zpp_inner.outer=null,t.zpp_inner=null,t.zpp_pool=Bn.poolVec2,Bn.poolVec2=t,null!=s.outer&&(s.outer.zpp_inner=null,s.outer=null),s._isimmutable=null,s._validate=null,s._invalidate=null,s.next=Gr.zpp_pool,Gr.zpp_pool=s),e.zpp_inner.weak&&(s=e.zpp_inner,e.zpp_inner.outer=null,e.zpp_inner=null,e.zpp_pool=Bn.poolVec2,Bn.poolVec2=e,null!=s.outer&&(s.outer.zpp_inner=null,s.outer=null),s._isimmutable=null,s._validate=null,s._invalidate=null,s.next=Gr.zpp_pool,Gr.zpp_pool=s),o},St.prototype.zpp_inner=null,St.prototype.zpp_pool=null,St.prototype.dispose=function(){var t=this.zpp_inner;this.zpp_inner.outer=null,this.zpp_inner=null;this.zpp_pool=Bn.poolVec2,Bn.poolVec2=this,null!=t.outer&&(t.outer.zpp_inner=null,t.outer=null),t._isimmutable=null,t._validate=null,t._invalidate=null,t.next=Gr.zpp_pool,Gr.zpp_pool=t},St.prototype.copy=function(t){null==t&&(t=!1);var e=this.zpp_inner;null!=e._validate&&e._validate();var i=this.zpp_inner.x,e=this.zpp_inner;null!=e._validate&&e._validate();var n,r,e=this.zpp_inner.y;return null==Bn.poolVec2?n=new St:(n=Bn.poolVec2,Bn.poolVec2=n.zpp_pool,n.zpp_pool=null),null==n.zpp_inner?(null==Gr.zpp_pool?r=new Gr:(r=Gr.zpp_pool,Gr.zpp_pool=r.next,r.next=null),r.weak=!1,r._immutable=!1,r.x=i,r.y=e,n.zpp_inner=r,n.zpp_inner.outer=n):(null!=(r=n.zpp_inner)._validate&&r._validate(),n.zpp_inner.x==i&&(null!=(r=n.zpp_inner)._validate&&r._validate(),n.zpp_inner.y==e)||(n.zpp_inner.x=i,n.zpp_inner.y=e,null!=(e=n.zpp_inner)._invalidate&&e._invalidate(e))),n.zpp_inner.weak=t,n},St.prototype.get_x=function(){var t=this.zpp_inner;return null!=t._validate&&t._validate(),this.zpp_inner.x},St.prototype.set_x=function(t){var e=this.zpp_inner;null!=e._validate&&e._validate(),this.zpp_inner.x!=t&&(this.zpp_inner.x=t,null!=(i=this.zpp_inner)._invalidate&&i._invalidate(i));var i=this.zpp_inner;return null!=i._validate&&i._validate(),this.zpp_inner.x},St.prototype.get_y=function(){var t=this.zpp_inner;return null!=t._validate&&t._validate(),this.zpp_inner.y},St.prototype.set_y=function(t){var e=this.zpp_inner;null!=e._validate&&e._validate(),this.zpp_inner.y!=t&&(this.zpp_inner.y=t,null!=(i=this.zpp_inner)._invalidate&&i._invalidate(i));var i=this.zpp_inner;return null!=i._validate&&i._validate(),this.zpp_inner.y},St.prototype.get_length=function(){var t=this.zpp_inner;null!=t._validate&&t._validate();var e=this.zpp_inner.x,i=this.zpp_inner;null!=i._validate&&i._validate();t=e*this.zpp_inner.x,i=this.zpp_inner;null!=i._validate&&i._validate();e=this.zpp_inner.y,i=this.zpp_inner;return null!=i._validate&&i._validate(),Math.sqrt(t+e*this.zpp_inner.y)},St.prototype.set_length=function(t){var e=this.zpp_inner;null!=e._validate&&e._validate();var i=this.zpp_inner.x,n=this.zpp_inner;null!=n._validate&&n._validate();e=i*this.zpp_inner.x,n=this.zpp_inner;null!=n._validate&&n._validate();i=this.zpp_inner.y,n=this.zpp_inner;null!=n._validate&&n._validate();t/=Math.sqrt(e+i*this.zpp_inner.y),e=this.zpp_inner;null!=e._validate&&e._validate();i=this.zpp_inner.x*t,e=this.zpp_inner;null!=e._validate&&e._validate(),this.zpp_inner.x!=i&&(this.zpp_inner.x=i,null!=(r=this.zpp_inner)._invalidate&&r._invalidate(r));var r=this.zpp_inner;null!=r._validate&&r._validate();r=this.zpp_inner;null!=r._validate&&r._validate();r=this.zpp_inner.y*t,t=this.zpp_inner;null!=t._validate&&t._validate(),this.zpp_inner.y!=r&&(this.zpp_inner.y=r,null!=(o=this.zpp_inner)._invalidate&&o._invalidate(o));t=this.zpp_inner;null!=t._validate&&t._validate();r=this.zpp_inner;null!=r._invalidate&&r._invalidate(r);var o=this.zpp_inner;null!=o._validate&&o._validate();t=this.zpp_inner.x,r=this.zpp_inner;null!=r._validate&&r._validate();o=t*this.zpp_inner.x,r=this.zpp_inner;null!=r._validate&&r._validate();t=this.zpp_inner.y,r=this.zpp_inner;return null!=r._validate&&r._validate(),Math.sqrt(o+t*this.zpp_inner.y)},St.prototype.lsq=function(){var t=this.zpp_inner;null!=t._validate&&t._validate();var e=this.zpp_inner.x,i=this.zpp_inner;null!=i._validate&&i._validate();t=e*this.zpp_inner.x,i=this.zpp_inner;null!=i._validate&&i._validate();e=this.zpp_inner.y,i=this.zpp_inner;return null!=i._validate&&i._validate(),t+e*this.zpp_inner.y},St.prototype.set=function(t){var e=t.zpp_inner;null!=e._validate&&e._validate();var i=t.zpp_inner.x,n=t.zpp_inner;null!=n._validate&&n._validate();var e=t.zpp_inner.y,n=this.zpp_inner;null!=n._validate&&n._validate(),this.zpp_inner.x==i&&(null!=(n=this.zpp_inner)._validate&&n._validate(),this.zpp_inner.y==e)||(this.zpp_inner.x=i,this.zpp_inner.y=e,null!=(r=this.zpp_inner)._invalidate&&r._invalidate(r));var r;return t.zpp_inner.weak&&(r=t.zpp_inner,t.zpp_inner.outer=null,t.zpp_inner=null,t.zpp_pool=Bn.poolVec2,Bn.poolVec2=t,null!=r.outer&&(r.outer.zpp_inner=null,r.outer=null),r._isimmutable=null,r._validate=null,r._invalidate=null,r.next=Gr.zpp_pool,Gr.zpp_pool=r),this},St.prototype.setxy=function(t,e){var i=this.zpp_inner;return null!=i._validate&&i._validate(),this.zpp_inner.x==t&&(null!=(i=this.zpp_inner)._validate&&i._validate(),this.zpp_inner.y==e)||(this.zpp_inner.x=t,this.zpp_inner.y=e,null!=(e=this.zpp_inner)._invalidate&&e._invalidate(e)),this},St.prototype.get_angle=function(){var t=this.zpp_inner;null!=t._validate&&t._validate();var e=this.zpp_inner.x,t=this.zpp_inner;if(null!=t._validate&&t._validate(),e==this.zpp_inner.y&&(null!=(i=this.zpp_inner)._validate&&i._validate(),0==this.zpp_inner.x))return 0;e=this.zpp_inner;null!=e._validate&&e._validate();var i=this.zpp_inner.y,e=this.zpp_inner;return null!=e._validate&&e._validate(),Math.atan2(i,this.zpp_inner.x)},St.prototype.set_angle=function(t){var e=this.zpp_inner;null!=e._validate&&e._validate();var i=this.zpp_inner.x,n=this.zpp_inner;null!=n._validate&&n._validate();e=i*this.zpp_inner.x,n=this.zpp_inner;null!=n._validate&&n._validate();i=this.zpp_inner.y,n=this.zpp_inner;null!=n._validate&&n._validate();var e=Math.sqrt(e+i*this.zpp_inner.y),i=e*Math.cos(t),e=e*Math.sin(t),t=this.zpp_inner;null!=t._validate&&t._validate(),this.zpp_inner.x==i&&(null!=(t=this.zpp_inner)._validate&&t._validate(),this.zpp_inner.y==e)||(this.zpp_inner.x=i,this.zpp_inner.y=e,null!=(r=this.zpp_inner)._invalidate&&r._invalidate(r));e=this.zpp_inner;null!=e._validate&&e._validate();var r=this.zpp_inner.x,e=this.zpp_inner;if(null!=e._validate&&e._validate(),r==this.zpp_inner.y&&(null!=(o=this.zpp_inner)._validate&&o._validate(),0==this.zpp_inner.x))return 0;r=this.zpp_inner;null!=r._validate&&r._validate();var o=this.zpp_inner.y,r=this.zpp_inner;return null!=r._validate&&r._validate(),Math.atan2(o,this.zpp_inner.x)},St.prototype.rotate=function(t){var e,i;return t%(2*Math.PI)!=0&&(e=Math.sin(t),t=(i=Math.cos(t))*this.zpp_inner.x-e*this.zpp_inner.y,this.zpp_inner.y=this.zpp_inner.x*e+this.zpp_inner.y*i,this.zpp_inner.x=t,null!=(t=this.zpp_inner)._invalidate&&t._invalidate(t)),this},St.prototype.reflect=function(t,e){null==e&&(e=!1);var i=this.zpp_inner;null!=i._validate&&i._validate();var n=this.zpp_inner.x,i=this.zpp_inner;null!=i._validate&&i._validate();var r,i=this.zpp_inner.y;null==Bn.poolVec2?o=new St:(o=Bn.poolVec2,Bn.poolVec2=o.zpp_pool,o.zpp_pool=null),null==o.zpp_inner?(null==Gr.zpp_pool?r=new Gr:(r=Gr.zpp_pool,Gr.zpp_pool=r.next,r.next=null),r.weak=!1,r._immutable=!1,r.x=n,r.y=i,o.zpp_inner=r,o.zpp_inner.outer=o):(null!=(r=o.zpp_inner)._validate&&r._validate(),o.zpp_inner.x==n&&(null!=(r=o.zpp_inner)._validate&&r._validate(),o.zpp_inner.y==i)||(o.zpp_inner.x=n,o.zpp_inner.y=i,null!=(i=o.zpp_inner)._invalidate&&i._invalidate(i))),o.zpp_inner.weak=!0;var o=o.normalise(),o=t.sub(o.muleq(2*o.dot(t)),e);return t.zpp_inner.weak&&(e=t.zpp_inner,t.zpp_inner.outer=null,t.zpp_inner=null,t.zpp_pool=Bn.poolVec2,Bn.poolVec2=t,null!=e.outer&&(e.outer.zpp_inner=null,e.outer=null),e._isimmutable=null,e._validate=null,e._invalidate=null,e.next=Gr.zpp_pool,Gr.zpp_pool=e),o},St.prototype.normalise=function(){var t=this.zpp_inner;null!=t._validate&&t._validate();var e=this.zpp_inner.x,i=this.zpp_inner;null!=i._validate&&i._validate();t=e*this.zpp_inner.x,i=this.zpp_inner;null!=i._validate&&i._validate();e=this.zpp_inner.y,i=this.zpp_inner;null!=i._validate&&i._validate();i=1/Math.sqrt(t+e*this.zpp_inner.y),t=this.zpp_inner;null!=t._validate&&t._validate();e=this.zpp_inner.x*i,t=this.zpp_inner;null!=t._validate&&t._validate(),this.zpp_inner.x!=e&&(this.zpp_inner.x=e,null!=(n=this.zpp_inner)._invalidate&&n._invalidate(n));var n=this.zpp_inner;null!=n._validate&&n._validate();n=this.zpp_inner;null!=n._validate&&n._validate();n=this.zpp_inner.y*i,i=this.zpp_inner;null!=i._validate&&i._validate(),this.zpp_inner.y!=n&&(this.zpp_inner.y=n,null!=(r=this.zpp_inner)._invalidate&&r._invalidate(r));var r=this.zpp_inner;null!=r._validate&&r._validate();r=this.zpp_inner;return null!=r._invalidate&&r._invalidate(r),this},St.prototype.unit=function(t){null==t&&(t=!1);var e=this.zpp_inner;null!=e._validate&&e._validate();var i=this.zpp_inner.x,n=this.zpp_inner;null!=n._validate&&n._validate();e=i*this.zpp_inner.x,n=this.zpp_inner;null!=n._validate&&n._validate();i=this.zpp_inner.y,n=this.zpp_inner;null!=n._validate&&n._validate();n=1/Math.sqrt(e+i*this.zpp_inner.y),e=this.zpp_inner;null!=e._validate&&e._validate();i=this.zpp_inner.x*n,e=this.zpp_inner;null!=e._validate&&e._validate();var r,o,n=this.zpp_inner.y*n;return null==Bn.poolVec2?r=new St:(r=Bn.poolVec2,Bn.poolVec2=r.zpp_pool,r.zpp_pool=null),null==r.zpp_inner?(null==Gr.zpp_pool?o=new Gr:(o=Gr.zpp_pool,Gr.zpp_pool=o.next,o.next=null),o.weak=!1,o._immutable=!1,o.x=i,o.y=n,r.zpp_inner=o,r.zpp_inner.outer=r):(null!=(o=r.zpp_inner)._validate&&o._validate(),r.zpp_inner.x==i&&(null!=(o=r.zpp_inner)._validate&&o._validate(),r.zpp_inner.y==n)||(r.zpp_inner.x=i,r.zpp_inner.y=n,null!=(n=r.zpp_inner)._invalidate&&n._invalidate(n))),r.zpp_inner.weak=t,r},St.prototype.add=function(t,e){null==e&&(e=!1);var i=this.zpp_inner;null!=i._validate&&i._validate();var n=this.zpp_inner.x,r=t.zpp_inner;null!=r._validate&&r._validate();i=n+t.zpp_inner.x,r=this.zpp_inner;null!=r._validate&&r._validate();n=this.zpp_inner.y,r=t.zpp_inner;null!=r._validate&&r._validate();var o,n=n+t.zpp_inner.y;null==Bn.poolVec2?s=new St:(s=Bn.poolVec2,Bn.poolVec2=s.zpp_pool,s.zpp_pool=null),null==s.zpp_inner?(null==Gr.zpp_pool?o=new Gr:(o=Gr.zpp_pool,Gr.zpp_pool=o.next,o.next=null),o.weak=!1,o._immutable=!1,o.x=i,o.y=n,s.zpp_inner=o,s.zpp_inner.outer=s):(null!=(o=s.zpp_inner)._validate&&o._validate(),s.zpp_inner.x==i&&(null!=(o=s.zpp_inner)._validate&&o._validate(),s.zpp_inner.y==n)||(s.zpp_inner.x=i,s.zpp_inner.y=n,null!=(n=s.zpp_inner)._invalidate&&n._invalidate(n))),s.zpp_inner.weak=e;var s,e=s;return t.zpp_inner.weak&&(s=t.zpp_inner,t.zpp_inner.outer=null,t.zpp_inner=null,t.zpp_pool=Bn.poolVec2,Bn.poolVec2=t,null!=s.outer&&(s.outer.zpp_inner=null,s.outer=null),s._isimmutable=null,s._validate=null,s._invalidate=null,s.next=Gr.zpp_pool,Gr.zpp_pool=s),e},St.prototype.addMul=function(t,e,i){null==i&&(i=!1);var n=this.zpp_inner;null!=n._validate&&n._validate();var r=this.zpp_inner.x,o=t.zpp_inner;null!=o._validate&&o._validate();n=r+t.zpp_inner.x*e,o=this.zpp_inner;null!=o._validate&&o._validate();r=this.zpp_inner.y,o=t.zpp_inner;null!=o._validate&&o._validate();var s,e=r+t.zpp_inner.y*e;null==Bn.poolVec2?a=new St:(a=Bn.poolVec2,Bn.poolVec2=a.zpp_pool,a.zpp_pool=null),null==a.zpp_inner?(null==Gr.zpp_pool?s=new Gr:(s=Gr.zpp_pool,Gr.zpp_pool=s.next,s.next=null),s.weak=!1,s._immutable=!1,s.x=n,s.y=e,a.zpp_inner=s,a.zpp_inner.outer=a):(null!=(s=a.zpp_inner)._validate&&s._validate(),a.zpp_inner.x==n&&(null!=(s=a.zpp_inner)._validate&&s._validate(),a.zpp_inner.y==e)||(a.zpp_inner.x=n,a.zpp_inner.y=e,null!=(e=a.zpp_inner)._invalidate&&e._invalidate(e))),a.zpp_inner.weak=i;var a,i=a;return t.zpp_inner.weak&&(a=t.zpp_inner,t.zpp_inner.outer=null,t.zpp_inner=null,t.zpp_pool=Bn.poolVec2,Bn.poolVec2=t,null!=a.outer&&(a.outer.zpp_inner=null,a.outer=null),a._isimmutable=null,a._validate=null,a._invalidate=null,a.next=Gr.zpp_pool,Gr.zpp_pool=a),i},St.prototype.sub=function(t,e){null==e&&(e=!1);var i=this.zpp_inner;null!=i._validate&&i._validate();var n=this.zpp_inner.x,r=t.zpp_inner;null!=r._validate&&r._validate();i=n-t.zpp_inner.x,r=this.zpp_inner;null!=r._validate&&r._validate();n=this.zpp_inner.y,r=t.zpp_inner;null!=r._validate&&r._validate();var o,n=n-t.zpp_inner.y;null==Bn.poolVec2?s=new St:(s=Bn.poolVec2,Bn.poolVec2=s.zpp_pool,s.zpp_pool=null),null==s.zpp_inner?(null==Gr.zpp_pool?o=new Gr:(o=Gr.zpp_pool,Gr.zpp_pool=o.next,o.next=null),o.weak=!1,o._immutable=!1,o.x=i,o.y=n,s.zpp_inner=o,s.zpp_inner.outer=s):(null!=(o=s.zpp_inner)._validate&&o._validate(),s.zpp_inner.x==i&&(null!=(o=s.zpp_inner)._validate&&o._validate(),s.zpp_inner.y==n)||(s.zpp_inner.x=i,s.zpp_inner.y=n,null!=(n=s.zpp_inner)._invalidate&&n._invalidate(n))),s.zpp_inner.weak=e;var s,e=s;return t.zpp_inner.weak&&(s=t.zpp_inner,t.zpp_inner.outer=null,t.zpp_inner=null,t.zpp_pool=Bn.poolVec2,Bn.poolVec2=t,null!=s.outer&&(s.outer.zpp_inner=null,s.outer=null),s._isimmutable=null,s._validate=null,s._invalidate=null,s.next=Gr.zpp_pool,Gr.zpp_pool=s),e},St.prototype.mul=function(t,e){null==e&&(e=!1);var i=this.zpp_inner;null!=i._validate&&i._validate();var n=this.zpp_inner.x*t,i=this.zpp_inner;null!=i._validate&&i._validate();var r,o,t=this.zpp_inner.y*t;return null==Bn.poolVec2?r=new St:(r=Bn.poolVec2,Bn.poolVec2=r.zpp_pool,r.zpp_pool=null),null==r.zpp_inner?(null==Gr.zpp_pool?o=new Gr:(o=Gr.zpp_pool,Gr.zpp_pool=o.next,o.next=null),o.weak=!1,o._immutable=!1,o.x=n,o.y=t,r.zpp_inner=o,r.zpp_inner.outer=r):(null!=(o=r.zpp_inner)._validate&&o._validate(),r.zpp_inner.x==n&&(null!=(o=r.zpp_inner)._validate&&o._validate(),r.zpp_inner.y==t)||(r.zpp_inner.x=n,r.zpp_inner.y=t,null!=(t=r.zpp_inner)._invalidate&&t._invalidate(t))),r.zpp_inner.weak=e,r},St.prototype.addeq=function(t){var e=this.zpp_inner;null!=e._validate&&e._validate();var i=this.zpp_inner.x,n=t.zpp_inner;null!=n._validate&&n._validate();e=i+t.zpp_inner.x,n=this.zpp_inner;null!=n._validate&&n._validate();i=this.zpp_inner.y,n=t.zpp_inner;null!=n._validate&&n._validate();var r,n=i+t.zpp_inner.y,i=this.zpp_inner;return null!=i._validate&&i._validate(),this.zpp_inner.x==e&&(null!=(i=this.zpp_inner)._validate&&i._validate(),this.zpp_inner.y==n)||(this.zpp_inner.x=e,this.zpp_inner.y=n,null!=(r=this.zpp_inner)._invalidate&&r._invalidate(r)),t.zpp_inner.weak&&(r=t.zpp_inner,t.zpp_inner.outer=null,t.zpp_inner=null,t.zpp_pool=Bn.poolVec2,Bn.poolVec2=t,null!=r.outer&&(r.outer.zpp_inner=null,r.outer=null),r._isimmutable=null,r._validate=null,r._invalidate=null,r.next=Gr.zpp_pool,Gr.zpp_pool=r),this},St.prototype.subeq=function(t){var e=this.zpp_inner;null!=e._validate&&e._validate();var i=this.zpp_inner.x,n=t.zpp_inner;null!=n._validate&&n._validate();e=i-t.zpp_inner.x,n=this.zpp_inner;null!=n._validate&&n._validate();i=this.zpp_inner.y,n=t.zpp_inner;null!=n._validate&&n._validate();var r,n=i-t.zpp_inner.y,i=this.zpp_inner;return null!=i._validate&&i._validate(),this.zpp_inner.x==e&&(null!=(i=this.zpp_inner)._validate&&i._validate(),this.zpp_inner.y==n)||(this.zpp_inner.x=e,this.zpp_inner.y=n,null!=(r=this.zpp_inner)._invalidate&&r._invalidate(r)),t.zpp_inner.weak&&(r=t.zpp_inner,t.zpp_inner.outer=null,t.zpp_inner=null,t.zpp_pool=Bn.poolVec2,Bn.poolVec2=t,null!=r.outer&&(r.outer.zpp_inner=null,r.outer=null),r._isimmutable=null,r._validate=null,r._invalidate=null,r.next=Gr.zpp_pool,Gr.zpp_pool=r),this},St.prototype.muleq=function(t){var e=this.zpp_inner;null!=e._validate&&e._validate();var i=this.zpp_inner.x*t,e=this.zpp_inner;null!=e._validate&&e._validate();var e=this.zpp_inner.y*t,t=this.zpp_inner;return null!=t._validate&&t._validate(),this.zpp_inner.x==i&&(null!=(t=this.zpp_inner)._validate&&t._validate(),this.zpp_inner.y==e)||(this.zpp_inner.x=i,this.zpp_inner.y=e,null!=(e=this.zpp_inner)._invalidate&&e._invalidate(e)),this},St.prototype.dot=function(t){var e=this.zpp_inner;null!=e._validate&&e._validate();var i=this.zpp_inner.x,n=t.zpp_inner;null!=n._validate&&n._validate();e=i*t.zpp_inner.x,n=this.zpp_inner;null!=n._validate&&n._validate();i=this.zpp_inner.y,n=t.zpp_inner;null!=n._validate&&n._validate();e+=i*t.zpp_inner.y;return t.zpp_inner.weak&&(i=t.zpp_inner,t.zpp_inner.outer=null,t.zpp_inner=null,t.zpp_pool=Bn.poolVec2,Bn.poolVec2=t,null!=i.outer&&(i.outer.zpp_inner=null,i.outer=null),i._isimmutable=null,i._validate=null,i._invalidate=null,i.next=Gr.zpp_pool,Gr.zpp_pool=i),e},St.prototype.cross=function(t){var e=t.zpp_inner;null!=e._validate&&e._validate();var i=t.zpp_inner.y,n=this.zpp_inner;null!=n._validate&&n._validate();e=i*this.zpp_inner.x,n=t.zpp_inner;null!=n._validate&&n._validate();i=t.zpp_inner.x,n=this.zpp_inner;null!=n._validate&&n._validate();e-=i*this.zpp_inner.y;return t.zpp_inner.weak&&(i=t.zpp_inner,t.zpp_inner.outer=null,t.zpp_inner=null,t.zpp_pool=Bn.poolVec2,Bn.poolVec2=t,null!=i.outer&&(i.outer.zpp_inner=null,i.outer=null),i._isimmutable=null,i._validate=null,i._invalidate=null,i.next=Gr.zpp_pool,Gr.zpp_pool=i),e},St.prototype.perp=function(t){null==t&&(t=!1);var e=this.zpp_inner;null!=e._validate&&e._validate();var i=-this.zpp_inner.y,e=this.zpp_inner;null!=e._validate&&e._validate();var n,r,e=this.zpp_inner.x;return null==Bn.poolVec2?n=new St:(n=Bn.poolVec2,Bn.poolVec2=n.zpp_pool,n.zpp_pool=null),null==n.zpp_inner?(null==Gr.zpp_pool?r=new Gr:(r=Gr.zpp_pool,Gr.zpp_pool=r.next,r.next=null),r.weak=!1,r._immutable=!1,r.x=i,r.y=e,n.zpp_inner=r,n.zpp_inner.outer=n):(null!=(r=n.zpp_inner)._validate&&r._validate(),n.zpp_inner.x==i&&(null!=(r=n.zpp_inner)._validate&&r._validate(),n.zpp_inner.y==e)||(n.zpp_inner.x=i,n.zpp_inner.y=e,null!=(e=n.zpp_inner)._invalidate&&e._invalidate(e))),n.zpp_inner.weak=t,n},St.prototype.toString=function(){var t=this.zpp_inner;return null!=t._validate&&t._validate(),this.zpp_inner.toString()},Object.defineProperty(St.prototype,"x",{get:St.prototype.get_x,set:St.prototype.set_x}),Object.defineProperty(St.prototype,"y",{get:St.prototype.get_y,set:St.prototype.set_y}),Object.defineProperty(St.prototype,"length",{get:St.prototype.get_length,set:St.prototype.set_length}),Object.defineProperty(St.prototype,"angle",{get:St.prototype.get_angle,set:St.prototype.set_angle}),St.prototype.__class__=St;var Qt=nape.geom.Vec2Iterator=function(){this.zpp_next=null,this.zpp_critical=!1,this.zpp_i=0,this.zpp_inner=null};Qt.__name__=["nape","geom","Vec2Iterator"],Qt.get=function(t){var e,i=null==Qt.zpp_pool?(Tn.internal=!0,e=new Qt,Tn.internal=!1,e):(i=Qt.zpp_pool,Qt.zpp_pool=i.zpp_next,i);return i.zpp_i=0,i.zpp_inner=t,i.zpp_critical=!1,i},Qt.prototype.zpp_inner=null,Qt.prototype.zpp_i=null,Qt.prototype.zpp_critical=null,Qt.prototype.zpp_next=null,Qt.prototype.hasNext=function(){this.zpp_inner.zpp_inner.valmod();var t=this.zpp_inner.zpp_gl();return this.zpp_critical=!0,this.zpp_i<t||(this.zpp_next=Qt.zpp_pool,(Qt.zpp_pool=this).zpp_inner=null,!1)},Qt.prototype.next=function(){return this.zpp_critical=!1,this.zpp_inner.at(this.zpp_i++)},Qt.prototype.__class__=Qt;var Y=nape.geom.Vec2List=function(){this.zpp_inner=null,this.zpp_inner=new Tn,this.zpp_inner.outer=this};Y.__name__=["nape","geom","Vec2List"],Y.fromArray=function(t){for(var e=new Y,i=0;i<t.length;){var n=t[i];++i,e.push(n)}return e},Y.prototype.zpp_inner=null,Y.prototype.get_length=function(){return this.zpp_gl()},Y.prototype.zpp_gl=function(){return this.zpp_inner.valmod(),this.zpp_inner.zip_length&&(this.zpp_inner.zip_length=!1,this.zpp_inner.user_length=this.zpp_inner.inner.length),this.zpp_inner.user_length},Y.prototype.zpp_vm=function(){this.zpp_inner.valmod()},Y.prototype.has=function(t){return this.zpp_vm(),this.zpp_inner.inner.has(t.zpp_inner)},Y.prototype.at=function(t){if(this.zpp_vm(),(t=this.zpp_inner.reverse_flag?this.zpp_gl()-1-t:t)<this.zpp_inner.at_index||null==this.zpp_inner.at_ite)this.zpp_inner.at_index=t,this.zpp_inner.at_ite=this.zpp_inner.inner.iterator_at(t);else for(;this.zpp_inner.at_index!=t;)this.zpp_inner.at_index++,this.zpp_inner.at_ite=this.zpp_inner.at_ite.next;var e,i=this.zpp_inner.at_ite.elt;return null==i.outer&&(i.outer=new St,null!=(e=i.outer.zpp_inner).outer&&(e.outer.zpp_inner=null,e.outer=null),e._isimmutable=null,e._validate=null,e._invalidate=null,e.next=Gr.zpp_pool,Gr.zpp_pool=e,i.outer.zpp_inner=i),i.outer},Y.prototype.push=function(t){this.zpp_inner.modify_test(),this.zpp_vm();var e=null==this.zpp_inner.adder||this.zpp_inner.adder(t);return e&&(this.zpp_inner.reverse_flag?this.zpp_inner.inner.add(t.zpp_inner):(null==this.zpp_inner.push_ite&&(this.zpp_inner.push_ite=this.empty()?null:this.zpp_inner.inner.iterator_at(this.zpp_gl()-1)),this.zpp_inner.push_ite=this.zpp_inner.inner.insert(this.zpp_inner.push_ite,t.zpp_inner)),this.zpp_inner.invalidate(),null!=this.zpp_inner.post_adder&&this.zpp_inner.post_adder(t)),e},Y.prototype.unshift=function(t){this.zpp_inner.modify_test(),this.zpp_vm();var e=null==this.zpp_inner.adder||this.zpp_inner.adder(t);return e&&(this.zpp_inner.reverse_flag?(null==this.zpp_inner.push_ite&&(this.zpp_inner.push_ite=this.empty()?null:this.zpp_inner.inner.iterator_at(this.zpp_gl()-1)),this.zpp_inner.push_ite=this.zpp_inner.inner.insert(this.zpp_inner.push_ite,t.zpp_inner)):this.zpp_inner.inner.add(t.zpp_inner),this.zpp_inner.invalidate(),null!=this.zpp_inner.post_adder&&this.zpp_inner.post_adder(t)),e},Y.prototype.pop=function(){this.zpp_inner.modify_test(),this.zpp_vm();var t,e,i,n=null;return this.zpp_inner.reverse_flag?(null==(n=this.zpp_inner.inner.head.elt).outer&&(n.outer=new St,null!=(t=n.outer.zpp_inner).outer&&(t.outer.zpp_inner=null,t.outer=null),t._isimmutable=null,t._validate=null,t._invalidate=null,t.next=Gr.zpp_pool,Gr.zpp_pool=t,n.outer.zpp_inner=n),t=n.outer,null!=this.zpp_inner.subber&&this.zpp_inner.subber(t),this.zpp_inner.dontremove||this.zpp_inner.inner.pop()):(null!=this.zpp_inner.at_ite&&null==this.zpp_inner.at_ite.next&&(this.zpp_inner.at_ite=null),null==(n=(null==(i=1==this.zpp_gl()?null:this.zpp_inner.inner.iterator_at(this.zpp_gl()-2))?this.zpp_inner.inner.head:i.next).elt).outer&&(n.outer=new St,null!=(e=n.outer.zpp_inner).outer&&(e.outer.zpp_inner=null,e.outer=null),e._isimmutable=null,e._validate=null,e._invalidate=null,e.next=Gr.zpp_pool,Gr.zpp_pool=e,n.outer.zpp_inner=n),e=n.outer,null!=this.zpp_inner.subber&&this.zpp_inner.subber(e),this.zpp_inner.dontremove||this.zpp_inner.inner.erase(i)),this.zpp_inner.invalidate(),null==n.outer&&(n.outer=new St,null!=(i=n.outer.zpp_inner).outer&&(i.outer.zpp_inner=null,i.outer=null),i._isimmutable=null,i._validate=null,i._invalidate=null,i.next=Gr.zpp_pool,Gr.zpp_pool=i,n.outer.zpp_inner=n),n.outer},Y.prototype.shift=function(){this.zpp_inner.modify_test(),this.zpp_vm();var t,e,i,n=null;return this.zpp_inner.reverse_flag?(null!=this.zpp_inner.at_ite&&null==this.zpp_inner.at_ite.next&&(this.zpp_inner.at_ite=null),null==(n=(null==(t=1==this.zpp_gl()?null:this.zpp_inner.inner.iterator_at(this.zpp_gl()-2))?this.zpp_inner.inner.head:t.next).elt).outer&&(n.outer=new St,null!=(e=n.outer.zpp_inner).outer&&(e.outer.zpp_inner=null,e.outer=null),e._isimmutable=null,e._validate=null,e._invalidate=null,e.next=Gr.zpp_pool,Gr.zpp_pool=e,n.outer.zpp_inner=n),e=n.outer,null!=this.zpp_inner.subber&&this.zpp_inner.subber(e),this.zpp_inner.dontremove||this.zpp_inner.inner.erase(t)):(null==(n=this.zpp_inner.inner.head.elt).outer&&(n.outer=new St,null!=(i=n.outer.zpp_inner).outer&&(i.outer.zpp_inner=null,i.outer=null),i._isimmutable=null,i._validate=null,i._invalidate=null,i.next=Gr.zpp_pool,Gr.zpp_pool=i,n.outer.zpp_inner=n),i=n.outer,null!=this.zpp_inner.subber&&this.zpp_inner.subber(i),this.zpp_inner.dontremove||this.zpp_inner.inner.pop()),this.zpp_inner.invalidate(),null==n.outer&&(n.outer=new St,null!=(i=n.outer.zpp_inner).outer&&(i.outer.zpp_inner=null,i.outer=null),i._isimmutable=null,i._validate=null,i._invalidate=null,i.next=Gr.zpp_pool,Gr.zpp_pool=i,n.outer.zpp_inner=n),n.outer},Y.prototype.add=function(t){return this.zpp_inner.reverse_flag?this.push(t):this.unshift(t)},Y.prototype.remove=function(t){this.zpp_inner.modify_test(),this.zpp_vm();for(var e=!1,i=this.zpp_inner.inner.head;null!=i;){if(i.elt==t.zpp_inner){e=!0;break}i=i.next}return e&&(null!=this.zpp_inner.subber&&this.zpp_inner.subber(t),this.zpp_inner.dontremove||this.zpp_inner.inner.remove(t.zpp_inner),this.zpp_inner.invalidate()),e},Y.prototype.clear=function(){if(this.zpp_inner.reverse_flag)for(;!this.empty();)this.pop();else for(;!this.empty();)this.shift()},Y.prototype.empty=function(){return 0==this.zpp_gl()},Y.prototype.iterator=function(){return this.zpp_vm(),Qt.get(this)},Y.prototype.copy=function(t){null==t&&(t=!1);for(var e=new Y,i=this.iterator();;){i.zpp_inner.zpp_inner.valmod();var n=i.zpp_inner.zpp_gl();if(i.zpp_critical=!0,!(i.zpp_i<n||(i.zpp_next=Qt.zpp_pool,(Qt.zpp_pool=i).zpp_inner=null,!1)))break;i.zpp_critical=!1;var r,o,s,a,h=i.zpp_inner.at(i.zpp_i++),h=t?(null!=(a=h.zpp_inner)._validate&&a._validate(),r=h.zpp_inner.x,null!=(n=h.zpp_inner)._validate&&n._validate(),a=h.zpp_inner.y,null==Bn.poolVec2?o=new St:(o=Bn.poolVec2,Bn.poolVec2=o.zpp_pool,o.zpp_pool=null),null==o.zpp_inner?(null==Gr.zpp_pool?s=new Gr:(s=Gr.zpp_pool,Gr.zpp_pool=s.next,s.next=null),s.weak=!1,s._immutable=!1,s.x=r,s.y=a,o.zpp_inner=s,o.zpp_inner.outer=o):(null!=(n=o.zpp_inner)._validate&&n._validate(),o.zpp_inner.x==r&&(null!=(n=o.zpp_inner)._validate&&n._validate(),o.zpp_inner.y==a)||(o.zpp_inner.x=r,o.zpp_inner.y=a,null!=(a=o.zpp_inner)._invalidate&&a._invalidate(a))),o.zpp_inner.weak=!1,o):h;e.push(h)}return e},Y.prototype.merge=function(t){for(var e=t.iterator();;){e.zpp_inner.zpp_inner.valmod();var i=e.zpp_inner.zpp_gl();if(e.zpp_critical=!0,!(e.zpp_i<i||(e.zpp_next=Qt.zpp_pool,(Qt.zpp_pool=e).zpp_inner=null,!1)))break;e.zpp_critical=!1;i=e.zpp_inner.at(e.zpp_i++);this.has(i)||this.add(i)}},Y.prototype.toString=function(){for(var t="[",e=!0,i=this.iterator();;){i.zpp_inner.zpp_inner.valmod();var n=i.zpp_inner.zpp_gl();if(i.zpp_critical=!0,!(i.zpp_i<n||(i.zpp_next=Qt.zpp_pool,(Qt.zpp_pool=i).zpp_inner=null,!1)))break;i.zpp_critical=!1;n=i.zpp_inner.at(i.zpp_i++);e||(t+=","),t+=null==n?"NULL":n.toString(),e=!1}return t+"]"},Y.prototype.foreach=function(t){for(var e=this.iterator();;){e.zpp_inner.zpp_inner.valmod();var i=e.zpp_inner.zpp_gl();if(e.zpp_critical=!0,!(e.zpp_i<i||(e.zpp_next=Qt.zpp_pool,(Qt.zpp_pool=e).zpp_inner=null,!1)))break;try{e.zpp_critical=!1,t(e.zpp_inner.at(e.zpp_i++))}catch(t){e.zpp_next=Qt.zpp_pool,(Qt.zpp_pool=e).zpp_inner=null;break}}return this},Y.prototype.filter=function(t){for(var e=0;e<this.zpp_gl();){var i=this.at(e);try{t(i)?++e:this.remove(i)}catch(t){break}}return this},Object.defineProperty(Y.prototype,"length",{get:Y.prototype.get_length}),Y.prototype.__class__=Y;var K=nape.geom.Vec3=function(t,e,i){null==i&&(i=0),null==e&&(e=0),null==t&&(t=0),this.zpp_pool=null,this.zpp_inner=null,this.zpp_inner=new Re,(this.zpp_inner.outer=this).zpp_inner.x=t;t=this.zpp_inner;null!=t._validate&&t._validate(),this.zpp_inner.y=e;e=this.zpp_inner;null!=e._validate&&e._validate(),this.zpp_inner.z=i;i=this.zpp_inner;null!=i._validate&&i._validate()};K.__name__=["nape","geom","Vec3"],K.get=function(t,e,i){var n;return null==i&&(i=0),null==e&&(e=0),null==t&&(t=0),null==Bn.poolVec3?n=new K:(n=Bn.poolVec3,Bn.poolVec3=n.zpp_pool,n.zpp_pool=null),n.setxyz(t,e,i),n.zpp_inner.immutable=!1,n.zpp_inner._validate=null,n},K.prototype.zpp_inner=null,K.prototype.zpp_pool=null,K.prototype.get_x=function(){var t=this.zpp_inner;return null!=t._validate&&t._validate(),this.zpp_inner.x},K.prototype.set_x=function(t){this.zpp_inner.x=t;t=this.zpp_inner;return null!=t._validate&&t._validate(),this.zpp_inner.x},K.prototype.get_y=function(){var t=this.zpp_inner;return null!=t._validate&&t._validate(),this.zpp_inner.y},K.prototype.set_y=function(t){this.zpp_inner.y=t;t=this.zpp_inner;return null!=t._validate&&t._validate(),this.zpp_inner.y},K.prototype.get_z=function(){var t=this.zpp_inner;return null!=t._validate&&t._validate(),this.zpp_inner.z},K.prototype.set_z=function(t){this.zpp_inner.z=t;t=this.zpp_inner;return null!=t._validate&&t._validate(),this.zpp_inner.z},K.prototype.dispose=function(){this.zpp_pool=Bn.poolVec3,Bn.poolVec3=this},K.prototype.get_length=function(){var t=this.zpp_inner;null!=t._validate&&t._validate();var e=this.zpp_inner.x,i=this.zpp_inner;null!=i._validate&&i._validate();t=e*this.zpp_inner.x,i=this.zpp_inner;null!=i._validate&&i._validate();e=this.zpp_inner.y,i=this.zpp_inner;null!=i._validate&&i._validate();i=t+e*this.zpp_inner.y,t=this.zpp_inner;null!=t._validate&&t._validate();e=this.zpp_inner.z,t=this.zpp_inner;return null!=t._validate&&t._validate(),Math.sqrt(i+e*this.zpp_inner.z)},K.prototype.set_length=function(t){var e=this.zpp_inner;null!=e._validate&&e._validate();var i=this.zpp_inner.x,n=this.zpp_inner;null!=n._validate&&n._validate();e=i*this.zpp_inner.x,n=this.zpp_inner;null!=n._validate&&n._validate();i=this.zpp_inner.y,n=this.zpp_inner;null!=n._validate&&n._validate();n=e+i*this.zpp_inner.y,e=this.zpp_inner;null!=e._validate&&e._validate();i=this.zpp_inner.z,e=this.zpp_inner;null!=e._validate&&e._validate();t/=Math.sqrt(n+i*this.zpp_inner.z),n=this.zpp_inner;null!=n._validate&&n._validate(),this.zpp_inner.x=this.zpp_inner.x*t;i=this.zpp_inner;null!=i._validate&&i._validate();n=this.zpp_inner;null!=n._validate&&n._validate(),this.zpp_inner.y=this.zpp_inner.y*t;i=this.zpp_inner;null!=i._validate&&i._validate();n=this.zpp_inner;null!=n._validate&&n._validate(),this.zpp_inner.z=this.zpp_inner.z*t;i=this.zpp_inner;null!=i._validate&&i._validate();n=this.zpp_inner;null!=n._validate&&n._validate();t=this.zpp_inner.x,i=this.zpp_inner;null!=i._validate&&i._validate();n=t*this.zpp_inner.x,i=this.zpp_inner;null!=i._validate&&i._validate();t=this.zpp_inner.y,i=this.zpp_inner;null!=i._validate&&i._validate();i=n+t*this.zpp_inner.y,n=this.zpp_inner;null!=n._validate&&n._validate();t=this.zpp_inner.z,n=this.zpp_inner;return null!=n._validate&&n._validate(),Math.sqrt(i+t*this.zpp_inner.z)},K.prototype.lsq=function(){var t=this.zpp_inner;null!=t._validate&&t._validate();var e=this.zpp_inner.x,i=this.zpp_inner;null!=i._validate&&i._validate();t=e*this.zpp_inner.x,i=this.zpp_inner;null!=i._validate&&i._validate();e=this.zpp_inner.y,i=this.zpp_inner;null!=i._validate&&i._validate();i=t+e*this.zpp_inner.y,t=this.zpp_inner;null!=t._validate&&t._validate();e=this.zpp_inner.z,t=this.zpp_inner;return null!=t._validate&&t._validate(),i+e*this.zpp_inner.z},K.prototype.set=function(t){var e=t.zpp_inner;null!=e._validate&&e._validate();var i=t.zpp_inner.x,n=t.zpp_inner;null!=n._validate&&n._validate();e=t.zpp_inner.y,n=t.zpp_inner;return null!=n._validate&&n._validate(),this.setxyz(i,e,t.zpp_inner.z)},K.prototype.setxyz=function(t,e,i){this.zpp_inner.x=t;t=this.zpp_inner;null!=t._validate&&t._validate(),this.zpp_inner.y=e;e=this.zpp_inner;null!=e._validate&&e._validate(),this.zpp_inner.z=i;i=this.zpp_inner;return null!=i._validate&&i._validate(),this},K.prototype.xy=function(t){null==t&&(t=!1);var e=this.zpp_inner;null!=e._validate&&e._validate();var i=this.zpp_inner.x,e=this.zpp_inner;null!=e._validate&&e._validate();var n,r,e=this.zpp_inner.y;return null==Bn.poolVec2?n=new St:(n=Bn.poolVec2,Bn.poolVec2=n.zpp_pool,n.zpp_pool=null),null==n.zpp_inner?(null==Gr.zpp_pool?r=new Gr:(r=Gr.zpp_pool,Gr.zpp_pool=r.next,r.next=null),r.weak=!1,r._immutable=!1,r.x=i,r.y=e,n.zpp_inner=r,n.zpp_inner.outer=n):(null!=(r=n.zpp_inner)._validate&&r._validate(),n.zpp_inner.x==i&&(null!=(r=n.zpp_inner)._validate&&r._validate(),n.zpp_inner.y==e)||(n.zpp_inner.x=i,n.zpp_inner.y=e,null!=(e=n.zpp_inner)._invalidate&&e._invalidate(e))),n.zpp_inner.weak=t,n},K.prototype.toString=function(){var t=this.zpp_inner;null!=t._validate&&t._validate();var e="{ x: "+this.zpp_inner.x+" y: ",t=this.zpp_inner;null!=t._validate&&t._validate();t=e+this.zpp_inner.y+" z: ",e=this.zpp_inner;return null!=e._validate&&e._validate(),t+this.zpp_inner.z+" }"},Object.defineProperty(K.prototype,"x",{get:K.prototype.get_x,set:K.prototype.set_x}),Object.defineProperty(K.prototype,"y",{get:K.prototype.get_y,set:K.prototype.set_y}),Object.defineProperty(K.prototype,"z",{get:K.prototype.get_z,set:K.prototype.set_z}),Object.defineProperty(K.prototype,"length",{get:K.prototype.get_length,set:K.prototype.set_length}),K.prototype.__class__=K;var J=nape.geom.Winding=function(){};J.__name__=["nape","geom","Winding"],J.UNDEFINED=null,J.get_UNDEFINED=function(){return null==Yn.Winding_UNDEFINED&&(Yn.internal=!0,Yn.Winding_UNDEFINED=new J,Yn.internal=!1),Yn.Winding_UNDEFINED},J.CLOCKWISE=null,J.get_CLOCKWISE=function(){return null==Yn.Winding_CLOCKWISE&&(Yn.internal=!0,Yn.Winding_CLOCKWISE=new J,Yn.internal=!1),Yn.Winding_CLOCKWISE},J.ANTICLOCKWISE=null,J.get_ANTICLOCKWISE=function(){return null==Yn.Winding_ANTICLOCKWISE&&(Yn.internal=!0,Yn.Winding_ANTICLOCKWISE=new J,Yn.internal=!1),Yn.Winding_ANTICLOCKWISE},J.prototype.toString=function(){return null==Yn.Winding_UNDEFINED&&(Yn.internal=!0,Yn.Winding_UNDEFINED=new J,Yn.internal=!1),this==Yn.Winding_UNDEFINED?"UNDEFINED":(null==Yn.Winding_CLOCKWISE&&(Yn.internal=!0,Yn.Winding_CLOCKWISE=new J,Yn.internal=!1),this==Yn.Winding_CLOCKWISE?"CLOCKWISE":(null==Yn.Winding_ANTICLOCKWISE&&(Yn.internal=!0,Yn.Winding_ANTICLOCKWISE=new J,Yn.internal=!1),this==Yn.Winding_ANTICLOCKWISE?"ANTICLOCKWISE":""))},Object.defineProperty(J,"UNDEFINED",{get:J.get_UNDEFINED}),Object.defineProperty(J,"CLOCKWISE",{get:J.get_CLOCKWISE}),Object.defineProperty(J,"ANTICLOCKWISE",{get:J.get_ANTICLOCKWISE}),J.prototype.__class__=J;var Q=nape.phys.Interactor=function(){this.zpp_inner_i=null};Q.__name__=["nape","phys","Interactor"],Q.prototype.zpp_inner_i=null,Q.prototype.get_id=function(){return this.zpp_inner_i.id},Q.prototype.get_userData=function(){return null==this.zpp_inner_i.userData&&(this.zpp_inner_i.userData={}),this.zpp_inner_i.userData},Q.prototype.isShape=function(){return null!=this.zpp_inner_i.ishape},Q.prototype.isBody=function(){return null!=this.zpp_inner_i.ibody},Q.prototype.isCompound=function(){return null!=this.zpp_inner_i.icompound},Q.prototype.get_castShape=function(){return null!=this.zpp_inner_i.ishape?this.zpp_inner_i.ishape.outer:null},Q.prototype.get_castBody=function(){return null!=this.zpp_inner_i.ibody?this.zpp_inner_i.ibody.outer:null},Q.prototype.get_castCompound=function(){return null!=this.zpp_inner_i.icompound?this.zpp_inner_i.icompound.outer:null},Q.prototype.get_group=function(){return null==this.zpp_inner_i.group?null:this.zpp_inner_i.group.outer},Q.prototype.set_group=function(t){return this.zpp_inner_i.immutable_midstep("Interactor::group"),this.zpp_inner_i.setGroup(null==t?null:t.zpp_inner),null==this.zpp_inner_i.group?null:this.zpp_inner_i.group.outer},Q.prototype.get_cbTypes=function(){return null==this.zpp_inner_i.wrap_cbTypes&&this.zpp_inner_i.setupcbTypes(),this.zpp_inner_i.wrap_cbTypes},Q.prototype.toString=function(){return""},Object.defineProperty(Q.prototype,"id",{get:Q.prototype.get_id}),Object.defineProperty(Q.prototype,"userData",{get:Q.prototype.get_userData}),Object.defineProperty(Q.prototype,"castShape",{get:Q.prototype.get_castShape}),Object.defineProperty(Q.prototype,"castBody",{get:Q.prototype.get_castBody}),Object.defineProperty(Q.prototype,"castCompound",{get:Q.prototype.get_castCompound}),Object.defineProperty(Q.prototype,"group",{get:Q.prototype.get_group,set:Q.prototype.set_group}),Object.defineProperty(Q.prototype,"cbTypes",{get:Q.prototype.get_cbTypes}),Q.prototype.__class__=Q;var $=nape.phys.Body=function(t,e){var i,n;this.debugDraw=!0,this.zpp_inner=null,Q.call(this),this.zpp_inner=new Fe,((this.zpp_inner.outer=this).zpp_inner.outer_i=this).zpp_inner_i=this.zpp_inner,null!=e?(null!=(i=e.zpp_inner)._validate&&i._validate(),this.zpp_inner.posx=e.zpp_inner.x,null!=(i=e.zpp_inner)._validate&&i._validate(),this.zpp_inner.posy=e.zpp_inner.y):(this.zpp_inner.posx=0,this.zpp_inner.posy=0),t=null==t?(null==Yn.BodyType_DYNAMIC&&(Yn.internal=!0,Yn.BodyType_DYNAMIC=new et,Yn.internal=!1),Yn.BodyType_DYNAMIC):t,this.zpp_inner.immutable_midstep("Body::type"),Fe.types[this.zpp_inner.type]!=t&&(null==Yn.BodyType_DYNAMIC&&(Yn.internal=!0,Yn.BodyType_DYNAMIC=new et,Yn.internal=!1),1==(n=t==Yn.BodyType_DYNAMIC?2:(null==Yn.BodyType_KINEMATIC&&(Yn.internal=!0,Yn.BodyType_KINEMATIC=new et,Yn.internal=!1),t==Yn.BodyType_KINEMATIC?3:1))&&null!=this.zpp_inner.space&&(this.zpp_inner.velx=0,this.zpp_inner.vely=0,this.zpp_inner.angvel=0),this.zpp_inner.invalidate_type(),null!=this.zpp_inner.space?this.zpp_inner.space.transmitType(this.zpp_inner,n):this.zpp_inner.type=n),null!=e&&e.zpp_inner.weak&&(n=e.zpp_inner,e.zpp_inner.outer=null,e.zpp_inner=null,e.zpp_pool=Bn.poolVec2,Bn.poolVec2=e,null!=n.outer&&(n.outer.zpp_inner=null,n.outer=null),n._isimmutable=null,n._validate=null,n._invalidate=null,n.next=Gr.zpp_pool,Gr.zpp_pool=n),this.zpp_inner_i.insert_cbtype(Tt.ANY_BODY.zpp_inner)};$.__name__=["nape","phys","Body"],$.__super__=Q,($.prototype=Object.create(Q.prototype)).zpp_inner=null,$.prototype.debugDraw=null,$.prototype.get_type=function(){return Fe.types[this.zpp_inner.type]},$.prototype.set_type=function(t){return this.zpp_inner.immutable_midstep("Body::type"),Fe.types[this.zpp_inner.type]!=t&&(null==Yn.BodyType_DYNAMIC&&(Yn.internal=!0,Yn.BodyType_DYNAMIC=new et,Yn.internal=!1),1==(t=t==Yn.BodyType_DYNAMIC?2:(null==Yn.BodyType_KINEMATIC&&(Yn.internal=!0,Yn.BodyType_KINEMATIC=new et,Yn.internal=!1),t==Yn.BodyType_KINEMATIC?3:1))&&null!=this.zpp_inner.space&&(this.zpp_inner.velx=0,this.zpp_inner.vely=0,this.zpp_inner.angvel=0),this.zpp_inner.invalidate_type(),null!=this.zpp_inner.space?this.zpp_inner.space.transmitType(this.zpp_inner,t):this.zpp_inner.type=t),Fe.types[this.zpp_inner.type]},$.prototype.get_isBullet=function(){return this.zpp_inner.bulletEnabled},$.prototype.set_isBullet=function(t){return this.zpp_inner.bulletEnabled=t,this.zpp_inner.bulletEnabled},$.prototype.get_disableCCD=function(){return this.zpp_inner.disableCCD},$.prototype.set_disableCCD=function(t){return this.zpp_inner.disableCCD=t,this.zpp_inner.disableCCD},$.prototype.integrate=function(t){if(this.zpp_inner.immutable_midstep("Body::space"),0==t)return this;var e=this.zpp_inner;e.sweepTime=0,e.sweep_angvel=e.angvel;var i,n,r=t-e.sweepTime;0!=r&&(e.sweepTime=t,e.posx+=e.velx*r,e.posy+=e.vely*r,0!=e.angvel&&(i=e.sweep_angvel*r,e.rot+=i,1e-4<i*i?(e.axisx=Math.sin(e.rot),e.axisy=Math.cos(e.rot)):(n=((t=1-.5*(n=i*i))*e.axisx+i*e.axisy)*(r=1-n*n/8),e.axisy=(t*e.axisy-i*e.axisx)*r,e.axisx=n)));for(var o=e.shapes.head;null!=o;){var s=o.elt;1==s.type&&(s.polygon.invalidate_gverts(),s.polygon.invalidate_gaxi()),s.invalidate_worldCOM(),o=o.next}e.zip_worldCOM=!0,e.zip_axis=!0;for(var a=e.shapes.head;null!=a;){var h=a.elt;1==h.type&&(h.polygon.invalidate_gverts(),h.polygon.invalidate_gaxi()),h.invalidate_worldCOM(),a=a.next}return e.zip_worldCOM=!0,e.sweepTime=0,this},$.prototype.isStatic=function(){return 1==this.zpp_inner.type},$.prototype.isDynamic=function(){return 2==this.zpp_inner.type},$.prototype.isKinematic=function(){return 3==this.zpp_inner.type},$.prototype.get_shapes=function(){return this.zpp_inner.wrap_shapes},$.prototype.get_compound=function(){return null==this.zpp_inner.compound?null:this.zpp_inner.compound.outer},$.prototype.set_compound=function(t){return(null==this.zpp_inner.compound?null:this.zpp_inner.compound.outer)!=t&&(null!=(null==this.zpp_inner.compound?null:this.zpp_inner.compound.outer)&&(null==this.zpp_inner.compound?null:this.zpp_inner.compound.outer).zpp_inner.wrap_bodies.remove(this),null!=t&&((t=t.zpp_inner.wrap_bodies).zpp_inner.reverse_flag?t.push(this):t.unshift(this))),null==this.zpp_inner.compound?null:this.zpp_inner.compound.outer},$.prototype.get_space=function(){return null==this.zpp_inner.space?null:this.zpp_inner.space.outer},$.prototype.set_space=function(t){return this.zpp_inner.immutable_midstep("Body::space"),(null==this.zpp_inner.space?null:this.zpp_inner.space.outer)!=t&&(null!=(null==this.zpp_inner.space?null:this.zpp_inner.space.outer)&&(this.zpp_inner.component.woken=!1),null!=(null==this.zpp_inner.space?null:this.zpp_inner.space.outer)&&(null==this.zpp_inner.space?null:this.zpp_inner.space.outer).zpp_inner.wrap_bodies.remove(this),null!=t&&((t=t.zpp_inner.wrap_bodies).zpp_inner.reverse_flag?t.push(this):t.unshift(this))),null==this.zpp_inner.space?null:this.zpp_inner.space.outer},$.prototype.get_arbiters=function(){return null==this.zpp_inner.wrap_arbiters&&(this.zpp_inner.wrap_arbiters=Dn.get(this.zpp_inner.arbiters,!0)),this.zpp_inner.wrap_arbiters},$.prototype.get_isSleeping=function(){return this.zpp_inner.component.sleeping},$.prototype.get_constraints=function(){return null==this.zpp_inner.wrap_constraints&&(this.zpp_inner.wrap_constraints=zn.get(this.zpp_inner.constraints,!0)),this.zpp_inner.wrap_constraints},$.prototype.copy=function(){return this.zpp_inner.copy()},$.prototype.get_position=function(){return null==this.zpp_inner.wrap_pos&&this.zpp_inner.setupPosition(),this.zpp_inner.wrap_pos},$.prototype.set_position=function(t){null==this.zpp_inner.wrap_pos&&this.zpp_inner.setupPosition();var e=this.zpp_inner.wrap_pos,i=t.zpp_inner;null!=i._validate&&i._validate();var n=t.zpp_inner.x,r=t.zpp_inner;null!=r._validate&&r._validate();var o,i=t.zpp_inner.y,r=e.zpp_inner;return null!=r._validate&&r._validate(),e.zpp_inner.x==n&&(null!=(r=e.zpp_inner)._validate&&r._validate(),e.zpp_inner.y==i)||(e.zpp_inner.x=n,e.zpp_inner.y=i,null!=(o=e.zpp_inner)._invalidate&&o._invalidate(o)),t.zpp_inner.weak&&(o=t.zpp_inner,t.zpp_inner.outer=null,t.zpp_inner=null,t.zpp_pool=Bn.poolVec2,Bn.poolVec2=t,null!=o.outer&&(o.outer.zpp_inner=null,o.outer=null),o._isimmutable=null,o._validate=null,o._invalidate=null,o.next=Gr.zpp_pool,Gr.zpp_pool=o),null==this.zpp_inner.wrap_pos&&this.zpp_inner.setupPosition(),this.zpp_inner.wrap_pos},$.prototype.get_velocity=function(){return null==this.zpp_inner.wrap_vel&&this.zpp_inner.setupVelocity(),this.zpp_inner.wrap_vel},$.prototype.set_velocity=function(t){null==this.zpp_inner.wrap_vel&&this.zpp_inner.setupVelocity();var e=this.zpp_inner.wrap_vel,i=t.zpp_inner;null!=i._validate&&i._validate();var n=t.zpp_inner.x,r=t.zpp_inner;null!=r._validate&&r._validate();var o,i=t.zpp_inner.y,r=e.zpp_inner;return null!=r._validate&&r._validate(),e.zpp_inner.x==n&&(null!=(r=e.zpp_inner)._validate&&r._validate(),e.zpp_inner.y==i)||(e.zpp_inner.x=n,e.zpp_inner.y=i,null!=(o=e.zpp_inner)._invalidate&&o._invalidate(o)),t.zpp_inner.weak&&(o=t.zpp_inner,t.zpp_inner.outer=null,t.zpp_inner=null,t.zpp_pool=Bn.poolVec2,Bn.poolVec2=t,null!=o.outer&&(o.outer.zpp_inner=null,o.outer=null),o._isimmutable=null,o._validate=null,o._invalidate=null,o.next=Gr.zpp_pool,Gr.zpp_pool=o),null==this.zpp_inner.wrap_vel&&this.zpp_inner.setupVelocity(),this.zpp_inner.wrap_vel},$.prototype.setVelocityFromTarget=function(t,e,i){var n=1/i;null==this.zpp_inner.wrap_vel&&this.zpp_inner.setupVelocity();var r=this.zpp_inner.wrap_vel;null==this.zpp_inner.wrap_pos&&this.zpp_inner.setupPosition();var o=t.sub(this.zpp_inner.wrap_pos,!0).muleq(n),s=o.zpp_inner;null!=s._validate&&s._validate();var a=o.zpp_inner.x,i=o.zpp_inner;null!=i._validate&&i._validate();var h,s=o.zpp_inner.y,i=r.zpp_inner;null!=i._validate&&i._validate(),r.zpp_inner.x==a&&(null!=(i=r.zpp_inner)._validate&&i._validate(),r.zpp_inner.y==s)||(r.zpp_inner.x=a,r.zpp_inner.y=s,null!=(h=r.zpp_inner)._invalidate&&h._invalidate(h)),o.zpp_inner.weak&&(h=o.zpp_inner,o.zpp_inner.outer=null,o.zpp_inner=null,o.zpp_pool=Bn.poolVec2,Bn.poolVec2=o,null!=h.outer&&(h.outer.zpp_inner=null,h.outer=null),h._isimmutable=null,h._validate=null,h._invalidate=null,h.next=Gr.zpp_pool,Gr.zpp_pool=h);var n=(e-this.zpp_inner.rot)*n;return this.zpp_inner.angvel!=n&&(this.zpp_inner.angvel=n,this.zpp_inner.wake()),t.zpp_inner.weak&&(n=t.zpp_inner,t.zpp_inner.outer=null,t.zpp_inner=null,t.zpp_pool=Bn.poolVec2,Bn.poolVec2=t,null!=n.outer&&(n.outer.zpp_inner=null,n.outer=null),n._isimmutable=null,n._validate=null,n._invalidate=null,n.next=Gr.zpp_pool,Gr.zpp_pool=n),this},$.prototype.get_kinematicVel=function(){return null==this.zpp_inner.wrap_kinvel&&this.zpp_inner.setupkinvel(),this.zpp_inner.wrap_kinvel},$.prototype.set_kinematicVel=function(t){null==this.zpp_inner.wrap_kinvel&&this.zpp_inner.setupkinvel();var e=this.zpp_inner.wrap_kinvel,i=t.zpp_inner;null!=i._validate&&i._validate();var n=t.zpp_inner.x,r=t.zpp_inner;null!=r._validate&&r._validate();var o,i=t.zpp_inner.y,r=e.zpp_inner;return null!=r._validate&&r._validate(),e.zpp_inner.x==n&&(null!=(r=e.zpp_inner)._validate&&r._validate(),e.zpp_inner.y==i)||(e.zpp_inner.x=n,e.zpp_inner.y=i,null!=(o=e.zpp_inner)._invalidate&&o._invalidate(o)),t.zpp_inner.weak&&(o=t.zpp_inner,t.zpp_inner.outer=null,t.zpp_inner=null,t.zpp_pool=Bn.poolVec2,Bn.poolVec2=t,null!=o.outer&&(o.outer.zpp_inner=null,o.outer=null),o._isimmutable=null,o._validate=null,o._invalidate=null,o.next=Gr.zpp_pool,Gr.zpp_pool=o),null==this.zpp_inner.wrap_kinvel&&this.zpp_inner.setupkinvel(),this.zpp_inner.wrap_kinvel},$.prototype.get_surfaceVel=function(){return null==this.zpp_inner.wrap_svel&&this.zpp_inner.setupsvel(),this.zpp_inner.wrap_svel},$.prototype.set_surfaceVel=function(t){null==this.zpp_inner.wrap_svel&&this.zpp_inner.setupsvel();var e=this.zpp_inner.wrap_svel,i=t.zpp_inner;null!=i._validate&&i._validate();var n=t.zpp_inner.x,r=t.zpp_inner;null!=r._validate&&r._validate();var o,i=t.zpp_inner.y,r=e.zpp_inner;return null!=r._validate&&r._validate(),e.zpp_inner.x==n&&(null!=(r=e.zpp_inner)._validate&&r._validate(),e.zpp_inner.y==i)||(e.zpp_inner.x=n,e.zpp_inner.y=i,null!=(o=e.zpp_inner)._invalidate&&o._invalidate(o)),t.zpp_inner.weak&&(o=t.zpp_inner,t.zpp_inner.outer=null,t.zpp_inner=null,t.zpp_pool=Bn.poolVec2,Bn.poolVec2=t,null!=o.outer&&(o.outer.zpp_inner=null,o.outer=null),o._isimmutable=null,o._validate=null,o._invalidate=null,o.next=Gr.zpp_pool,Gr.zpp_pool=o),null==this.zpp_inner.wrap_svel&&this.zpp_inner.setupsvel(),this.zpp_inner.wrap_svel},$.prototype.get_force=function(){return null==this.zpp_inner.wrap_force&&this.zpp_inner.setupForce(),this.zpp_inner.wrap_force},$.prototype.set_force=function(t){null==this.zpp_inner.wrap_force&&this.zpp_inner.setupForce();var e=this.zpp_inner.wrap_force,i=t.zpp_inner;null!=i._validate&&i._validate();var n=t.zpp_inner.x,r=t.zpp_inner;null!=r._validate&&r._validate();var o,i=t.zpp_inner.y,r=e.zpp_inner;return null!=r._validate&&r._validate(),e.zpp_inner.x==n&&(null!=(r=e.zpp_inner)._validate&&r._validate(),e.zpp_inner.y==i)||(e.zpp_inner.x=n,e.zpp_inner.y=i,null!=(o=e.zpp_inner)._invalidate&&o._invalidate(o)),t.zpp_inner.weak&&(o=t.zpp_inner,t.zpp_inner.outer=null,t.zpp_inner=null,t.zpp_pool=Bn.poolVec2,Bn.poolVec2=t,null!=o.outer&&(o.outer.zpp_inner=null,o.outer=null),o._isimmutable=null,o._validate=null,o._invalidate=null,o.next=Gr.zpp_pool,Gr.zpp_pool=o),null==this.zpp_inner.wrap_force&&this.zpp_inner.setupForce(),this.zpp_inner.wrap_force},$.prototype.get_constraintVelocity=function(){return null==this.zpp_inner.wrapcvel&&this.zpp_inner.setup_cvel(),this.zpp_inner.wrapcvel},$.prototype.get_rotation=function(){return this.zpp_inner.rot},$.prototype.set_rotation=function(t){if(this.zpp_inner.immutable_midstep("Body::rotation"),this.zpp_inner.rot!=t){this.zpp_inner.rot=t;t=this.zpp_inner;t.zip_axis=!0;for(var e=t.shapes.head;null!=e;){var i=e.elt;1==i.type&&(i.polygon.invalidate_gverts(),i.polygon.invalidate_gaxi()),i.invalidate_worldCOM(),e=e.next}t.zip_worldCOM=!0,this.zpp_inner.wake()}return this.zpp_inner.rot},$.prototype.get_angularVel=function(){return this.zpp_inner.angvel},$.prototype.set_angularVel=function(t){return this.zpp_inner.angvel!=t&&(this.zpp_inner.angvel=t,this.zpp_inner.wake()),this.zpp_inner.angvel},$.prototype.get_kinAngVel=function(){return this.zpp_inner.kinangvel},$.prototype.set_kinAngVel=function(t){return this.zpp_inner.kinangvel!=t&&(this.zpp_inner.kinangvel=t,this.zpp_inner.wake()),this.zpp_inner.kinangvel},$.prototype.get_torque=function(){return this.zpp_inner.torque},$.prototype.set_torque=function(t){return this.zpp_inner.torque!=t&&(this.zpp_inner.torque=t,this.zpp_inner.wake()),this.zpp_inner.torque},$.prototype.get_bounds=function(){return this.zpp_inner.aabb.wrapper()},$.prototype.get_allowMovement=function(){return!this.zpp_inner.nomove},$.prototype.set_allowMovement=function(t){return this.zpp_inner.immutable_midstep("Body::"+(null==t?"null":""+t)),!this.zpp_inner.nomove!=t&&(this.zpp_inner.nomove=!t,this.zpp_inner.invalidate_mass()),!this.zpp_inner.nomove},$.prototype.get_allowRotation=function(){return!this.zpp_inner.norotate},$.prototype.set_allowRotation=function(t){return this.zpp_inner.immutable_midstep("Body::"+(null==t?"null":""+t)),!this.zpp_inner.norotate!=t&&(this.zpp_inner.norotate=!t,this.zpp_inner.invalidate_inertia()),!this.zpp_inner.norotate},$.prototype.get_massMode=function(){null==Yn.MassMode_DEFAULT&&(Yn.internal=!0,Yn.MassMode_DEFAULT=new ht,Yn.internal=!1);var t=Yn.MassMode_DEFAULT;return null==Yn.MassMode_FIXED&&(Yn.internal=!0,Yn.MassMode_FIXED=new ht,Yn.internal=!1),[t,Yn.MassMode_FIXED][this.zpp_inner.massMode]},$.prototype.set_massMode=function(t){this.zpp_inner.immutable_midstep("Body::massMode"),null==Yn.MassMode_DEFAULT&&(Yn.internal=!0,Yn.MassMode_DEFAULT=new ht,Yn.internal=!1),t=t==Yn.MassMode_DEFAULT?0:1,this.zpp_inner.massMode=t,this.zpp_inner.invalidate_mass(),null==Yn.MassMode_DEFAULT&&(Yn.internal=!0,Yn.MassMode_DEFAULT=new ht,Yn.internal=!1);t=Yn.MassMode_DEFAULT;return null==Yn.MassMode_FIXED&&(Yn.internal=!0,Yn.MassMode_FIXED=new ht,Yn.internal=!1),[t,Yn.MassMode_FIXED][this.zpp_inner.massMode]},$.prototype.get_constraintMass=function(){return this.zpp_inner.world||this.zpp_inner.validate_mass(),this.zpp_inner.smass},$.prototype.get_mass=function(){return this.zpp_inner.validate_mass(),this.zpp_inner.cmass},$.prototype.set_mass=function(t){return this.zpp_inner.immutable_midstep("Body::mass"),this.zpp_inner.massMode=1,this.zpp_inner.cmass=t,this.zpp_inner.invalidate_mass(),this.zpp_inner.validate_mass(),this.zpp_inner.cmass},$.prototype.get_gravMassMode=function(){null==Yn.GravMassMode_DEFAULT&&(Yn.internal=!0,Yn.GravMassMode_DEFAULT=new ot,Yn.internal=!1);var t=Yn.GravMassMode_DEFAULT;null==Yn.GravMassMode_FIXED&&(Yn.internal=!0,Yn.GravMassMode_FIXED=new ot,Yn.internal=!1);var e=Yn.GravMassMode_FIXED;return null==Yn.GravMassMode_SCALED&&(Yn.internal=!0,Yn.GravMassMode_SCALED=new ot,Yn.internal=!1),[t,e,Yn.GravMassMode_SCALED][this.zpp_inner.massMode]},$.prototype.set_gravMassMode=function(t){this.zpp_inner.immutable_midstep("Body::gravMassMode"),null==Yn.GravMassMode_SCALED&&(Yn.internal=!0,Yn.GravMassMode_SCALED=new ot,Yn.internal=!1),e=t==Yn.GravMassMode_SCALED?2:(null==Yn.GravMassMode_DEFAULT&&(Yn.internal=!0,Yn.GravMassMode_DEFAULT=new ot,Yn.internal=!1),t==Yn.GravMassMode_DEFAULT?0:1),this.zpp_inner.gravMassMode=e,this.zpp_inner.invalidate_gravMass(),null==Yn.GravMassMode_DEFAULT&&(Yn.internal=!0,Yn.GravMassMode_DEFAULT=new ot,Yn.internal=!1);t=Yn.GravMassMode_DEFAULT;null==Yn.GravMassMode_FIXED&&(Yn.internal=!0,Yn.GravMassMode_FIXED=new ot,Yn.internal=!1);var e=Yn.GravMassMode_FIXED;return null==Yn.GravMassMode_SCALED&&(Yn.internal=!0,Yn.GravMassMode_SCALED=new ot,Yn.internal=!1),[t,e,Yn.GravMassMode_SCALED][this.zpp_inner.massMode]},$.prototype.get_gravMass=function(){return this.zpp_inner.validate_gravMass(),this.zpp_inner.gravMass},$.prototype.set_gravMass=function(t){return this.zpp_inner.immutable_midstep("Body::gravMass"),this.zpp_inner.gravMassMode=1,this.zpp_inner.gravMass=t,this.zpp_inner.invalidate_gravMass(),this.zpp_inner.validate_gravMass(),this.zpp_inner.gravMass},$.prototype.get_gravMassScale=function(){return this.zpp_inner.validate_gravMassScale(),this.zpp_inner.gravMassScale},$.prototype.set_gravMassScale=function(t){return this.zpp_inner.immutable_midstep("Body::gravMassScale"),this.zpp_inner.gravMassMode=2,this.zpp_inner.gravMassScale=t,this.zpp_inner.invalidate_gravMassScale(),this.zpp_inner.validate_gravMassScale(),this.zpp_inner.gravMassScale},$.prototype.get_inertiaMode=function(){null==Yn.InertiaMode_DEFAULT&&(Yn.internal=!0,Yn.InertiaMode_DEFAULT=new st,Yn.internal=!1);var t=Yn.InertiaMode_DEFAULT;return null==Yn.InertiaMode_FIXED&&(Yn.internal=!0,Yn.InertiaMode_FIXED=new st,Yn.internal=!1),[t,Yn.InertiaMode_FIXED][this.zpp_inner.inertiaMode]},$.prototype.set_inertiaMode=function(t){this.zpp_inner.immutable_midstep("Body::inertiaMode"),null==Yn.InertiaMode_FIXED&&(Yn.internal=!0,Yn.InertiaMode_FIXED=new st,Yn.internal=!1),t=t==Yn.InertiaMode_FIXED?1:0,this.zpp_inner.inertiaMode=t,this.zpp_inner.invalidate_inertia(),null==Yn.InertiaMode_DEFAULT&&(Yn.internal=!0,Yn.InertiaMode_DEFAULT=new st,Yn.internal=!1);t=Yn.InertiaMode_DEFAULT;return null==Yn.InertiaMode_FIXED&&(Yn.internal=!0,Yn.InertiaMode_FIXED=new st,Yn.internal=!1),[t,Yn.InertiaMode_FIXED][this.zpp_inner.inertiaMode]},$.prototype.get_constraintInertia=function(){return this.zpp_inner.world||this.zpp_inner.validate_inertia(),this.zpp_inner.sinertia},$.prototype.get_inertia=function(){return this.zpp_inner.validate_inertia(),this.zpp_inner.cinertia},$.prototype.set_inertia=function(t){return this.zpp_inner.immutable_midstep("Body::inertia"),this.zpp_inner.inertiaMode=1,this.zpp_inner.cinertia=t,this.zpp_inner.invalidate_inertia(),this.zpp_inner.validate_inertia(),this.zpp_inner.cinertia},$.prototype.connectedBodies=function(t,e){return this.zpp_inner.connectedBodies(t=null==t?-1:t,e)},$.prototype.interactingBodies=function(t,e,i){return null==e&&(e=-1),t=null==t?Qe.COL|Qe.SENSOR|Qe.FLUID:(null==Yn.InteractionType_COLLISION&&(Yn.internal=!0,Yn.InteractionType_COLLISION=new m,Yn.internal=!1),t==Yn.InteractionType_COLLISION?Qe.COL:(null==Yn.InteractionType_SENSOR&&(Yn.internal=!0,Yn.InteractionType_SENSOR=new m,Yn.internal=!1),t==Yn.InteractionType_SENSOR?Qe.SENSOR:Qe.FLUID)),this.zpp_inner.interactingBodies(t,e,i)},$.prototype.crushFactor=function(){var t,e=0;null==Bn.poolVec2?g=new St:(g=Bn.poolVec2,Bn.poolVec2=g.zpp_pool,g.zpp_pool=null),null==g.zpp_inner?(null==Gr.zpp_pool?t=new Gr:(t=Gr.zpp_pool,Gr.zpp_pool=t.next,t.next=null),t.weak=!1,t._immutable=!1,t.x=0,t.y=0,g.zpp_inner=t,g.zpp_inner.outer=g):(null!=(t=g.zpp_inner)._validate&&t._validate(),0==g.zpp_inner.x&&(null!=(l=g.zpp_inner)._validate&&l._validate(),0==g.zpp_inner.y)||(g.zpp_inner.x=0,g.zpp_inner.y=0,null!=(m=g.zpp_inner)._invalidate&&m._invalidate(m))),g.zpp_inner.weak=!1;var i=g;null==this.zpp_inner.wrap_arbiters&&(this.zpp_inner.wrap_arbiters=Dn.get(this.zpp_inner.arbiters,!0));for(var n=this.zpp_inner.wrap_arbiters.iterator();;){n.zpp_inner.zpp_inner.valmod();var r=n.zpp_inner.zpp_gl();if(n.zpp_critical=!0,!(n.zpp_i<r||(n.zpp_next=Ht.zpp_pool,(Ht.zpp_pool=n).zpp_inner=null,!1)))break;n.zpp_critical=!1;var o=n.zpp_inner.at(n.zpp_i++).totalImpulse(this),s=o.xy();i.addeq(s);var a=s.zpp_inner;null!=a._validate&&a._validate();var h=s.zpp_inner.x,r=s.zpp_inner;null!=r._validate&&r._validate();a=h*s.zpp_inner.x,r=s.zpp_inner;null!=r._validate&&r._validate();h=s.zpp_inner.y,r=s.zpp_inner;null!=r._validate&&r._validate(),e+=Math.sqrt(a+h*s.zpp_inner.y);h=s.zpp_inner;s.zpp_inner.outer=null,s.zpp_inner=null,s.zpp_pool=Bn.poolVec2,Bn.poolVec2=s,null!=h.outer&&(h.outer.zpp_inner=null,h.outer=null),h._isimmutable=null,h._validate=null,h._invalidate=null,h.next=Gr.zpp_pool,Gr.zpp_pool=h,o.dispose()}null==this.zpp_inner.wrap_constraints&&(this.zpp_inner.wrap_constraints=zn.get(this.zpp_inner.constraints,!0));var l=this.zpp_inner.wrap_constraints;l.zpp_inner.valmod();for(var p=Xt.get(l);;){p.zpp_inner.zpp_inner.valmod();var u=p.zpp_inner;u.zpp_inner.valmod(),u.zpp_inner.zip_length&&(u.zpp_inner.zip_length=!1,u.zpp_inner.user_length=u.zpp_inner.inner.length);var d=u.zpp_inner.user_length;if(p.zpp_critical=!0,!(p.zpp_i<d||(p.zpp_next=Xt.zpp_pool,(Xt.zpp_pool=p).zpp_inner=null,!1)))break;p.zpp_critical=!1;var c=p.zpp_inner.at(p.zpp_i++).bodyImpulse(this),y=c.xy();i.addeq(y);var _=y.zpp_inner;null!=_._validate&&_._validate();u=y.zpp_inner.x,d=y.zpp_inner;null!=d._validate&&d._validate();_=u*y.zpp_inner.x,d=y.zpp_inner;null!=d._validate&&d._validate();u=y.zpp_inner.y,d=y.zpp_inner;null!=d._validate&&d._validate(),e+=Math.sqrt(_+u*y.zpp_inner.y);u=y.zpp_inner;y.zpp_inner.outer=null,y.zpp_inner=null,y.zpp_pool=Bn.poolVec2,Bn.poolVec2=y,null!=u.outer&&(u.outer.zpp_inner=null,u.outer=null),u._isimmutable=null,u._validate=null,u._invalidate=null,u.next=Gr.zpp_pool,Gr.zpp_pool=u,c.dispose()}var m=i.zpp_inner;null!=m._validate&&m._validate();var g=i.zpp_inner.x,l=i.zpp_inner;null!=l._validate&&l._validate();m=g*i.zpp_inner.x,l=i.zpp_inner;null!=l._validate&&l._validate();g=i.zpp_inner.y,l=i.zpp_inner;null!=l._validate&&l._validate();m=e-Math.sqrt(m+g*i.zpp_inner.y);this.zpp_inner.validate_mass();g=m/(this.zpp_inner.cmass*(null==this.zpp_inner.space?null:this.zpp_inner.space.outer).zpp_inner.pre_dt),m=i.zpp_inner;return i.zpp_inner.outer=null,i.zpp_inner=null,i.zpp_pool=Bn.poolVec2,Bn.poolVec2=i,null!=m.outer&&(m.outer.zpp_inner=null,m.outer=null),m._isimmutable=null,m._validate=null,m._invalidate=null,m.next=Gr.zpp_pool,Gr.zpp_pool=m,g},$.prototype.localPointToWorld=function(t,e){null==e&&(e=!1);var i=this.zpp_inner;i.zip_axis&&(i.zip_axis=!1,i.axisx=Math.sin(i.rot),i.axisy=Math.cos(i.rot));var n=t.zpp_inner;null!=n._validate&&n._validate();var r=this.zpp_inner.axisy*t.zpp_inner.x,i=t.zpp_inner;null!=i._validate&&i._validate();n=r-this.zpp_inner.axisx*t.zpp_inner.y,i=t.zpp_inner;null!=i._validate&&i._validate();var r=t.zpp_inner.x*this.zpp_inner.axisx,i=t.zpp_inner;null!=i._validate&&i._validate(),i=r+t.zpp_inner.y*this.zpp_inner.axisy,t.zpp_inner.weak&&(r=t.zpp_inner,t.zpp_inner.outer=null,t.zpp_inner=null,t.zpp_pool=Bn.poolVec2,Bn.poolVec2=t,null!=r.outer&&(r.outer.zpp_inner=null,r.outer=null),r._isimmutable=null,r._validate=null,r._invalidate=null,r.next=Gr.zpp_pool,Gr.zpp_pool=r);var o,s,n=n+this.zpp_inner.posx,i=i+this.zpp_inner.posy;return null==Bn.poolVec2?o=new St:(o=Bn.poolVec2,Bn.poolVec2=o.zpp_pool,o.zpp_pool=null),null==o.zpp_inner?(null==Gr.zpp_pool?s=new Gr:(s=Gr.zpp_pool,Gr.zpp_pool=s.next,s.next=null),s.weak=!1,s._immutable=!1,s.x=n,s.y=i,o.zpp_inner=s,o.zpp_inner.outer=o):(null!=(s=o.zpp_inner)._validate&&s._validate(),o.zpp_inner.x==n&&(null!=(s=o.zpp_inner)._validate&&s._validate(),o.zpp_inner.y==i)||(o.zpp_inner.x=n,o.zpp_inner.y=i,null!=(i=o.zpp_inner)._invalidate&&i._invalidate(i))),o.zpp_inner.weak=e,o},$.prototype.worldPointToLocal=function(t,e){null==e&&(e=!1);var i=this.zpp_inner;i.zip_axis&&(i.zip_axis=!1,i.axisx=Math.sin(i.rot),i.axisy=Math.cos(i.rot));var n=t.zpp_inner;null!=n._validate&&n._validate();var r,o,s=t.zpp_inner.x-this.zpp_inner.posx,i=t.zpp_inner;return null!=i._validate&&i._validate(),n=t.zpp_inner.y-this.zpp_inner.posy,i=s*this.zpp_inner.axisy+n*this.zpp_inner.axisx,n=n*this.zpp_inner.axisy-s*this.zpp_inner.axisx,t.zpp_inner.weak&&(s=t.zpp_inner,t.zpp_inner.outer=null,t.zpp_inner=null,t.zpp_pool=Bn.poolVec2,Bn.poolVec2=t,null!=s.outer&&(s.outer.zpp_inner=null,s.outer=null),s._isimmutable=null,s._validate=null,s._invalidate=null,s.next=Gr.zpp_pool,Gr.zpp_pool=s),null==Bn.poolVec2?r=new St:(r=Bn.poolVec2,Bn.poolVec2=r.zpp_pool,r.zpp_pool=null),null==r.zpp_inner?(null==Gr.zpp_pool?o=new Gr:(o=Gr.zpp_pool,Gr.zpp_pool=o.next,o.next=null),o.weak=!1,o._immutable=!1,o.x=i,o.y=n,r.zpp_inner=o,r.zpp_inner.outer=r):(null!=(o=r.zpp_inner)._validate&&o._validate(),r.zpp_inner.x==i&&(null!=(o=r.zpp_inner)._validate&&o._validate(),r.zpp_inner.y==n)||(r.zpp_inner.x=i,r.zpp_inner.y=n,null!=(n=r.zpp_inner)._invalidate&&n._invalidate(n))),r.zpp_inner.weak=e,r},$.prototype.localVectorToWorld=function(t,e){null==e&&(e=!1);var i=this.zpp_inner;i.zip_axis&&(i.zip_axis=!1,i.axisx=Math.sin(i.rot),i.axisy=Math.cos(i.rot));var n=t.zpp_inner;null!=n._validate&&n._validate();var r=this.zpp_inner.axisy*t.zpp_inner.x,i=t.zpp_inner;null!=i._validate&&i._validate();n=r-this.zpp_inner.axisx*t.zpp_inner.y,i=t.zpp_inner;null!=i._validate&&i._validate();var o,s,r=t.zpp_inner.x*this.zpp_inner.axisx,i=t.zpp_inner;return null!=i._validate&&i._validate(),i=r+t.zpp_inner.y*this.zpp_inner.axisy,t.zpp_inner.weak&&(r=t.zpp_inner,t.zpp_inner.outer=null,t.zpp_inner=null,t.zpp_pool=Bn.poolVec2,Bn.poolVec2=t,null!=r.outer&&(r.outer.zpp_inner=null,r.outer=null),r._isimmutable=null,r._validate=null,r._invalidate=null,r.next=Gr.zpp_pool,Gr.zpp_pool=r),null==Bn.poolVec2?o=new St:(o=Bn.poolVec2,Bn.poolVec2=o.zpp_pool,o.zpp_pool=null),null==o.zpp_inner?(null==Gr.zpp_pool?s=new Gr:(s=Gr.zpp_pool,Gr.zpp_pool=s.next,s.next=null),s.weak=!1,s._immutable=!1,s.x=n,s.y=i,o.zpp_inner=s,o.zpp_inner.outer=o):(null!=(s=o.zpp_inner)._validate&&s._validate(),o.zpp_inner.x==n&&(null!=(s=o.zpp_inner)._validate&&s._validate(),o.zpp_inner.y==i)||(o.zpp_inner.x=n,o.zpp_inner.y=i,null!=(i=o.zpp_inner)._invalidate&&i._invalidate(i))),o.zpp_inner.weak=e,o},$.prototype.worldVectorToLocal=function(t,e){null==e&&(e=!1);var i=this.zpp_inner;i.zip_axis&&(i.zip_axis=!1,i.axisx=Math.sin(i.rot),i.axisy=Math.cos(i.rot));var n=t.zpp_inner;null!=n._validate&&n._validate();var r=t.zpp_inner.x*this.zpp_inner.axisy,i=t.zpp_inner;null!=i._validate&&i._validate();n=r+t.zpp_inner.y*this.zpp_inner.axisx,i=t.zpp_inner;null!=i._validate&&i._validate();var o,s,r=t.zpp_inner.y*this.zpp_inner.axisy,i=t.zpp_inner;return null!=i._validate&&i._validate(),i=r-t.zpp_inner.x*this.zpp_inner.axisx,t.zpp_inner.weak&&(r=t.zpp_inner,t.zpp_inner.outer=null,t.zpp_inner=null,t.zpp_pool=Bn.poolVec2,Bn.poolVec2=t,null!=r.outer&&(r.outer.zpp_inner=null,r.outer=null),r._isimmutable=null,r._validate=null,r._invalidate=null,r.next=Gr.zpp_pool,Gr.zpp_pool=r),null==Bn.poolVec2?o=new St:(o=Bn.poolVec2,Bn.poolVec2=o.zpp_pool,o.zpp_pool=null),null==o.zpp_inner?(null==Gr.zpp_pool?s=new Gr:(s=Gr.zpp_pool,Gr.zpp_pool=s.next,s.next=null),s.weak=!1,s._immutable=!1,s.x=n,s.y=i,o.zpp_inner=s,o.zpp_inner.outer=o):(null!=(s=o.zpp_inner)._validate&&s._validate(),o.zpp_inner.x==n&&(null!=(s=o.zpp_inner)._validate&&s._validate(),o.zpp_inner.y==i)||(o.zpp_inner.x=n,o.zpp_inner.y=i,null!=(i=o.zpp_inner)._invalidate&&i._invalidate(i))),o.zpp_inner.weak=e,o},$.prototype.applyImpulse=function(t,e,i){if((i=null==i?!1:i)&&this.zpp_inner.component.sleeping)return t.zpp_inner.weak&&(r=t.zpp_inner,t.zpp_inner.outer=null,t.zpp_inner=null,t.zpp_pool=Bn.poolVec2,Bn.poolVec2=t,null!=r.outer&&(r.outer.zpp_inner=null,r.outer=null),r._isimmutable=null,r._validate=null,r._invalidate=null,r.next=Gr.zpp_pool,Gr.zpp_pool=r),null!=e&&e.zpp_inner.weak&&(o=e.zpp_inner,e.zpp_inner.outer=null,e.zpp_inner=null,e.zpp_pool=Bn.poolVec2,Bn.poolVec2=e,null!=o.outer&&(o.outer.zpp_inner=null,o.outer=null),o._isimmutable=null,o._validate=null,o._invalidate=null,o.next=Gr.zpp_pool,Gr.zpp_pool=o),this;this.zpp_inner.validate_mass();var n=this.zpp_inner.imass,r=t.zpp_inner;null!=r._validate&&r._validate(),this.zpp_inner.velx+=t.zpp_inner.x*n;var o=t.zpp_inner;return null!=o._validate&&o._validate(),this.zpp_inner.vely+=t.zpp_inner.y*n,null!=e&&(o=r=0,null!=(n=e.zpp_inner)._validate&&n._validate(),r=e.zpp_inner.x-this.zpp_inner.posx,null!=(n=e.zpp_inner)._validate&&n._validate(),o=e.zpp_inner.y-this.zpp_inner.posy,this.zpp_inner.validate_inertia(),null!=(n=t.zpp_inner)._validate&&n._validate(),n=t.zpp_inner.y*r,null!=(r=t.zpp_inner)._validate&&r._validate(),this.zpp_inner.angvel+=(n-t.zpp_inner.x*o)*this.zpp_inner.iinertia,e.zpp_inner.weak&&(o=e.zpp_inner,e.zpp_inner.outer=null,e.zpp_inner=null,e.zpp_pool=Bn.poolVec2,Bn.poolVec2=e,null!=o.outer&&(o.outer.zpp_inner=null,o.outer=null),o._isimmutable=null,o._validate=null,o._invalidate=null,o.next=Gr.zpp_pool,Gr.zpp_pool=o)),i||2==this.zpp_inner.type&&this.zpp_inner.wake(),t.zpp_inner.weak&&(i=t.zpp_inner,t.zpp_inner.outer=null,t.zpp_inner=null,t.zpp_pool=Bn.poolVec2,Bn.poolVec2=t,null!=i.outer&&(i.outer.zpp_inner=null,i.outer=null),i._isimmutable=null,i._validate=null,i._invalidate=null,i.next=Gr.zpp_pool,Gr.zpp_pool=i),this},$.prototype.applyAngularImpulse=function(t,e){return(e=null==e?!1:e)&&this.zpp_inner.component.sleeping||(this.zpp_inner.validate_inertia(),this.zpp_inner.angvel+=t*this.zpp_inner.iinertia,e||2==this.zpp_inner.type&&this.zpp_inner.wake()),this},$.prototype.translateShapes=function(t){this.zpp_inner.immutable_midstep("Body::translateShapes()");var e=t.zpp_inner.weak;t.zpp_inner.weak=!1;for(var i=this.zpp_inner.shapes.head;null!=i;)i.elt.outer.translate(t),i=i.next;return t.zpp_inner.weak=e,t.zpp_inner.weak&&(e=t.zpp_inner,t.zpp_inner.outer=null,t.zpp_inner=null,t.zpp_pool=Bn.poolVec2,Bn.poolVec2=t,null!=e.outer&&(e.outer.zpp_inner=null,e.outer=null),e._isimmutable=null,e._validate=null,e._invalidate=null,e.next=Gr.zpp_pool,Gr.zpp_pool=e),this},$.prototype.rotateShapes=function(t){this.zpp_inner.immutable_midstep("Body::rotateShapes()");for(var e=this.zpp_inner.shapes.head;null!=e;)e.elt.outer.rotate(t),e=e.next;return this},$.prototype.scaleShapes=function(t,e){this.zpp_inner.immutable_midstep("Body::scaleShapes()");for(var i=this.zpp_inner.shapes.head;null!=i;)i.elt.outer.scale(t,e),i=i.next;return this},$.prototype.transformShapes=function(t){this.zpp_inner.immutable_midstep("Body::transformShapes()");for(var e=this.zpp_inner.shapes.head;null!=e;)e.elt.outer.transform(t),e=e.next;return this},$.prototype.align=function(){this.zpp_inner.immutable_midstep("Body::align()"),this.zpp_inner.validate_localCOM();var t,e=-this.zpp_inner.localCOMx,i=-this.zpp_inner.localCOMy;null==Bn.poolVec2?r=new St:(r=Bn.poolVec2,Bn.poolVec2=r.zpp_pool,r.zpp_pool=null),null==r.zpp_inner?(null==Gr.zpp_pool?t=new Gr:(t=Gr.zpp_pool,Gr.zpp_pool=t.next,t.next=null),t.weak=!1,t._immutable=!1,t.x=e,t.y=i,r.zpp_inner=t,r.zpp_inner.outer=r):(null!=(t=r.zpp_inner)._validate&&t._validate(),r.zpp_inner.x==e&&(null!=(t=r.zpp_inner)._validate&&t._validate(),r.zpp_inner.y==i)||(r.zpp_inner.x=e,r.zpp_inner.y=i,null!=(n=r.zpp_inner)._invalidate&&n._invalidate(n))),r.zpp_inner.weak=!1;var n=r;this.translateShapes(n);var r=this.localVectorToWorld(n);null==this.zpp_inner.wrap_pos&&this.zpp_inner.setupPosition(),this.zpp_inner.wrap_pos.subeq(r),this.zpp_inner.pre_posx<1/0&&(null!=(o=r.zpp_inner)._validate&&o._validate(),this.zpp_inner.pre_posx-=r.zpp_inner.x,null!=(o=r.zpp_inner)._validate&&o._validate(),this.zpp_inner.pre_posy-=r.zpp_inner.y);var o=n.zpp_inner;n.zpp_inner.outer=null,n.zpp_inner=null,n.zpp_pool=Bn.poolVec2,Bn.poolVec2=n,null!=o.outer&&(o.outer.zpp_inner=null,o.outer=null),o._isimmutable=null,o._validate=null,o._invalidate=null,o.next=Gr.zpp_pool,Gr.zpp_pool=o;o=r.zpp_inner;return r.zpp_inner.outer=null,r.zpp_inner=null,r.zpp_pool=Bn.poolVec2,Bn.poolVec2=r,null!=o.outer&&(o.outer.zpp_inner=null,o.outer=null),o._isimmutable=null,o._validate=null,o._invalidate=null,o.next=Gr.zpp_pool,Gr.zpp_pool=o,this},$.prototype.rotate=function(t,e){var i=t.zpp_inner.weak;t.zpp_inner.weak=!1,null==this.zpp_inner.wrap_pos&&this.zpp_inner.setupPosition();var n=this.zpp_inner.wrap_pos.sub(t);n.rotate(e);var r=t.add(n,!0);null==this.zpp_inner.wrap_pos&&this.zpp_inner.setupPosition();var o=this.zpp_inner.wrap_pos,s=r.zpp_inner;null!=s._validate&&s._validate();var a=r.zpp_inner.x,h=r.zpp_inner;null!=h._validate&&h._validate();var s=r.zpp_inner.y,h=o.zpp_inner;null!=h._validate&&h._validate(),o.zpp_inner.x==a&&(null!=(h=o.zpp_inner)._validate&&h._validate(),o.zpp_inner.y==s)||(o.zpp_inner.x=a,o.zpp_inner.y=s,null!=(o=o.zpp_inner)._invalidate&&o._invalidate(o)),r.zpp_inner.weak&&(l=r.zpp_inner,r.zpp_inner.outer=null,r.zpp_inner=null,r.zpp_pool=Bn.poolVec2,Bn.poolVec2=r,null!=l.outer&&(l.outer.zpp_inner=null,l.outer=null),l._isimmutable=null,l._validate=null,l._invalidate=null,l.next=Gr.zpp_pool,Gr.zpp_pool=l),null==this.zpp_inner.wrap_pos&&this.zpp_inner.setupPosition();var l=n.zpp_inner;n.zpp_inner.outer=null,n.zpp_inner=null,n.zpp_pool=Bn.poolVec2,Bn.poolVec2=n,null!=l.outer&&(l.outer.zpp_inner=null,l.outer=null),l._isimmutable=null,l._validate=null,l._invalidate=null,l.next=Gr.zpp_pool,Gr.zpp_pool=l;e=this.zpp_inner.rot+e;if(this.zpp_inner.immutable_midstep("Body::rotation"),this.zpp_inner.rot!=e){this.zpp_inner.rot=e;e=this.zpp_inner;e.zip_axis=!0;for(var p=e.shapes.head;null!=p;){var u=p.elt;1==u.type&&(u.polygon.invalidate_gverts(),u.polygon.invalidate_gaxi()),u.invalidate_worldCOM(),p=p.next}e.zip_worldCOM=!0,this.zpp_inner.wake()}return t.zpp_inner.weak=i,t.zpp_inner.weak&&(i=t.zpp_inner,t.zpp_inner.outer=null,t.zpp_inner=null,t.zpp_pool=Bn.poolVec2,Bn.poolVec2=t,null!=i.outer&&(i.outer.zpp_inner=null,i.outer=null),i._isimmutable=null,i._validate=null,i._invalidate=null,i.next=Gr.zpp_pool,Gr.zpp_pool=i),this},$.prototype.setShapeMaterials=function(t){this.zpp_inner.immutable_midstep("Body::setShapeMaterials()");for(var e=this.zpp_inner.shapes.head;null!=e;){var i=e.elt.outer;i.zpp_inner.immutable_midstep("Shape::material"),i.zpp_inner.setMaterial(t.zpp_inner),i.zpp_inner.material.wrapper(),e=e.next}return this},$.prototype.setShapeFilters=function(t){this.zpp_inner.immutable_midstep("Body::setShapeFilters()");for(var e=this.zpp_inner.shapes.head;null!=e;){var i=e.elt.outer;i.zpp_inner.immutable_midstep("Shape::filter"),i.zpp_inner.setFilter(t.zpp_inner),i.zpp_inner.filter.wrapper(),e=e.next}return this},$.prototype.setShapeFluidProperties=function(t){this.zpp_inner.immutable_midstep("Body::setShapeFluidProperties()");for(var e=this.zpp_inner.shapes.head;null!=e;){var i=e.elt.outer;i.zpp_inner.setFluid(t.zpp_inner),i.zpp_inner.immutable_midstep("Shape::fluidProperties"),null==i.zpp_inner.fluidProperties&&i.zpp_inner.setFluid((new rt).zpp_inner),i.zpp_inner.fluidProperties.wrapper(),e=e.next}return this},$.prototype.get_localCOM=function(){var t,e,i,n;return null==this.zpp_inner.wrap_localCOM&&(t=this.zpp_inner.localCOMx,n=this.zpp_inner.localCOMy,null==Bn.poolVec2?e=new St:(e=Bn.poolVec2,Bn.poolVec2=e.zpp_pool,e.zpp_pool=null),null==e.zpp_inner?(null==Gr.zpp_pool?i=new Gr:(i=Gr.zpp_pool,Gr.zpp_pool=i.next,i.next=null),i.weak=!1,i._immutable=!1,i.x=t,i.y=n,e.zpp_inner=i,e.zpp_inner.outer=e):(null!=(i=e.zpp_inner)._validate&&i._validate(),e.zpp_inner.x==t&&(null!=(i=e.zpp_inner)._validate&&i._validate(),e.zpp_inner.y==n)||(e.zpp_inner.x=t,e.zpp_inner.y=n,null!=(n=e.zpp_inner)._invalidate&&n._invalidate(n))),e.zpp_inner.weak=!1,this.zpp_inner.wrap_localCOM=e,this.zpp_inner.wrap_localCOM.zpp_inner._inuse=!0,this.zpp_inner.wrap_localCOM.zpp_inner._immutable=!0,this.zpp_inner.wrap_localCOM.zpp_inner._validate=Z(a=this.zpp_inner,a.getlocalCOM)),this.zpp_inner.wrap_localCOM},$.prototype.get_worldCOM=function(){var t,e,i,n;return null==this.zpp_inner.wrap_worldCOM&&(t=this.zpp_inner.worldCOMx,n=this.zpp_inner.worldCOMy,null==Bn.poolVec2?e=new St:(e=Bn.poolVec2,Bn.poolVec2=e.zpp_pool,e.zpp_pool=null),null==e.zpp_inner?(null==Gr.zpp_pool?i=new Gr:(i=Gr.zpp_pool,Gr.zpp_pool=i.next,i.next=null),i.weak=!1,i._immutable=!1,i.x=t,i.y=n,e.zpp_inner=i,e.zpp_inner.outer=e):(null!=(i=e.zpp_inner)._validate&&i._validate(),e.zpp_inner.x==t&&(null!=(i=e.zpp_inner)._validate&&i._validate(),e.zpp_inner.y==n)||(e.zpp_inner.x=t,e.zpp_inner.y=n,null!=(n=e.zpp_inner)._invalidate&&n._invalidate(n))),e.zpp_inner.weak=!1,this.zpp_inner.wrap_worldCOM=e,this.zpp_inner.wrap_worldCOM.zpp_inner._inuse=!0,this.zpp_inner.wrap_worldCOM.zpp_inner._immutable=!0,this.zpp_inner.wrap_worldCOM.zpp_inner._validate=Z(a=this.zpp_inner,a.getworldCOM)),this.zpp_inner.wrap_worldCOM},$.prototype.normalImpulse=function(t,e){null==e&&(e=!1);var i=0,n=0,r=0;null==this.zpp_inner.wrap_arbiters&&(this.zpp_inner.wrap_arbiters=Dn.get(this.zpp_inner.arbiters,!0));for(var o=this.zpp_inner.wrap_arbiters.iterator();;){o.zpp_inner.zpp_inner.valmod();var s=o.zpp_inner.zpp_gl();if(o.zpp_critical=!0,!(o.zpp_i<s||(o.zpp_next=Ht.zpp_pool,(Ht.zpp_pool=o).zpp_inner=null,!1)))break;o.zpp_critical=!1;var a=o.zpp_inner.at(o.zpp_i++).zpp_inner;a.type==Qe.COL&&(null!=t&&a.b2!=t.zpp_inner&&a.b1!=t.zpp_inner||(null!=(s=(a=((s=a.wrapper()).zpp_inner.type==Qe.COL?s.zpp_inner.colarb.outer_zn:null).normalImpulse(this,e)).zpp_inner)._validate&&s._validate(),i+=a.zpp_inner.x,null!=(s=a.zpp_inner)._validate&&s._validate(),n+=a.zpp_inner.y,null!=(s=a.zpp_inner)._validate&&s._validate(),r+=a.zpp_inner.z,a.dispose()))}return K.get(i,n,r)},$.prototype.tangentImpulse=function(t,e){null==e&&(e=!1);var i=0,n=0,r=0;null==this.zpp_inner.wrap_arbiters&&(this.zpp_inner.wrap_arbiters=Dn.get(this.zpp_inner.arbiters,!0));for(var o=this.zpp_inner.wrap_arbiters.iterator();;){o.zpp_inner.zpp_inner.valmod();var s=o.zpp_inner.zpp_gl();if(o.zpp_critical=!0,!(o.zpp_i<s||(o.zpp_next=Ht.zpp_pool,(Ht.zpp_pool=o).zpp_inner=null,!1)))break;o.zpp_critical=!1;var a=o.zpp_inner.at(o.zpp_i++).zpp_inner;a.type==Qe.COL&&(null!=t&&a.b2!=t.zpp_inner&&a.b1!=t.zpp_inner||(null!=(s=(a=((s=a.wrapper()).zpp_inner.type==Qe.COL?s.zpp_inner.colarb.outer_zn:null).tangentImpulse(this,e)).zpp_inner)._validate&&s._validate(),i+=a.zpp_inner.x,null!=(s=a.zpp_inner)._validate&&s._validate(),n+=a.zpp_inner.y,null!=(s=a.zpp_inner)._validate&&s._validate(),r+=a.zpp_inner.z,a.dispose()))}return K.get(i,n,r)},$.prototype.totalContactsImpulse=function(t,e){null==e&&(e=!1);var i=0,n=0,r=0;null==this.zpp_inner.wrap_arbiters&&(this.zpp_inner.wrap_arbiters=Dn.get(this.zpp_inner.arbiters,!0));for(var o=this.zpp_inner.wrap_arbiters.iterator();;){o.zpp_inner.zpp_inner.valmod();var s=o.zpp_inner.zpp_gl();if(o.zpp_critical=!0,!(o.zpp_i<s||(o.zpp_next=Ht.zpp_pool,(Ht.zpp_pool=o).zpp_inner=null,!1)))break;o.zpp_critical=!1;var a=o.zpp_inner.at(o.zpp_i++).zpp_inner;a.type==Qe.COL&&(null!=t&&a.b2!=t.zpp_inner&&a.b1!=t.zpp_inner||(null!=(s=(a=((s=a.wrapper()).zpp_inner.type==Qe.COL?s.zpp_inner.colarb.outer_zn:null).totalImpulse(this,e)).zpp_inner)._validate&&s._validate(),i+=a.zpp_inner.x,null!=(s=a.zpp_inner)._validate&&s._validate(),n+=a.zpp_inner.y,null!=(s=a.zpp_inner)._validate&&s._validate(),r+=a.zpp_inner.z,a.dispose()))}return K.get(i,n,r)},$.prototype.rollingImpulse=function(t,e){null==e&&(e=!1);var i=0;null==this.zpp_inner.wrap_arbiters&&(this.zpp_inner.wrap_arbiters=Dn.get(this.zpp_inner.arbiters,!0));for(var n=this.zpp_inner.wrap_arbiters.iterator();;){n.zpp_inner.zpp_inner.valmod();var r=n.zpp_inner.zpp_gl();if(n.zpp_critical=!0,!(n.zpp_i<r||(n.zpp_next=Ht.zpp_pool,(Ht.zpp_pool=n).zpp_inner=null,!1)))break;n.zpp_critical=!1;var r=n.zpp_inner.at(n.zpp_i++).zpp_inner;r.type==Qe.COL&&(null!=t&&r.b2!=t.zpp_inner&&r.b1!=t.zpp_inner||(i+=((r=r.wrapper()).zpp_inner.type==Qe.COL?r.zpp_inner.colarb.outer_zn:null).rollingImpulse(this,e)))}return i},$.prototype.buoyancyImpulse=function(t){var e=0,i=0,n=0;null==this.zpp_inner.wrap_arbiters&&(this.zpp_inner.wrap_arbiters=Dn.get(this.zpp_inner.arbiters,!0));for(var r=this.zpp_inner.wrap_arbiters.iterator();;){r.zpp_inner.zpp_inner.valmod();var o=r.zpp_inner.zpp_gl();if(r.zpp_critical=!0,!(r.zpp_i<o||(r.zpp_next=Ht.zpp_pool,(Ht.zpp_pool=r).zpp_inner=null,!1)))break;r.zpp_critical=!1;var s=r.zpp_inner.at(r.zpp_i++).zpp_inner;s.type==Qe.FLUID&&(null!=t&&s.b2!=t.zpp_inner&&s.b1!=t.zpp_inner||(null!=(o=(s=((o=s.wrapper()).zpp_inner.type==Qe.FLUID?o.zpp_inner.fluidarb.outer_zn:null).buoyancyImpulse(this)).zpp_inner)._validate&&o._validate(),e+=s.zpp_inner.x,null!=(o=s.zpp_inner)._validate&&o._validate(),i+=s.zpp_inner.y,null!=(o=s.zpp_inner)._validate&&o._validate(),n+=s.zpp_inner.z,s.dispose()))}return K.get(e,i,n)},$.prototype.dragImpulse=function(t){var e=0,i=0,n=0;null==this.zpp_inner.wrap_arbiters&&(this.zpp_inner.wrap_arbiters=Dn.get(this.zpp_inner.arbiters,!0));for(var r=this.zpp_inner.wrap_arbiters.iterator();;){r.zpp_inner.zpp_inner.valmod();var o=r.zpp_inner.zpp_gl();if(r.zpp_critical=!0,!(r.zpp_i<o||(r.zpp_next=Ht.zpp_pool,(Ht.zpp_pool=r).zpp_inner=null,!1)))break;r.zpp_critical=!1;var s=r.zpp_inner.at(r.zpp_i++).zpp_inner;s.type==Qe.FLUID&&(null!=t&&s.b2!=t.zpp_inner&&s.b1!=t.zpp_inner||(null!=(o=(s=((o=s.wrapper()).zpp_inner.type==Qe.FLUID?o.zpp_inner.fluidarb.outer_zn:null).dragImpulse(this)).zpp_inner)._validate&&o._validate(),e+=s.zpp_inner.x,null!=(o=s.zpp_inner)._validate&&o._validate(),i+=s.zpp_inner.y,null!=(o=s.zpp_inner)._validate&&o._validate(),n+=s.zpp_inner.z,s.dispose()))}return K.get(e,i,n)},$.prototype.totalFluidImpulse=function(t){var e=0,i=0,n=0;null==this.zpp_inner.wrap_arbiters&&(this.zpp_inner.wrap_arbiters=Dn.get(this.zpp_inner.arbiters,!0));for(var r=this.zpp_inner.wrap_arbiters.iterator();;){r.zpp_inner.zpp_inner.valmod();var o=r.zpp_inner.zpp_gl();if(r.zpp_critical=!0,!(r.zpp_i<o||(r.zpp_next=Ht.zpp_pool,(Ht.zpp_pool=r).zpp_inner=null,!1)))break;r.zpp_critical=!1;var s=r.zpp_inner.at(r.zpp_i++).zpp_inner;s.type==Qe.FLUID&&(null!=t&&s.b2!=t.zpp_inner&&s.b1!=t.zpp_inner||(null!=(o=(s=((o=s.wrapper()).zpp_inner.type==Qe.FLUID?o.zpp_inner.fluidarb.outer_zn:null).totalImpulse(this)).zpp_inner)._validate&&o._validate(),e+=s.zpp_inner.x,null!=(o=s.zpp_inner)._validate&&o._validate(),i+=s.zpp_inner.y,null!=(o=s.zpp_inner)._validate&&o._validate(),n+=s.zpp_inner.z,s.dispose()))}return K.get(e,i,n)},$.prototype.constraintsImpulse=function(){for(var t=0,e=0,i=0,n=this.zpp_inner.constraints.head;null!=n;){var r=n.elt.outer.bodyImpulse(this),o=r.zpp_inner;null!=o._validate&&o._validate(),t+=r.zpp_inner.x;o=r.zpp_inner;null!=o._validate&&o._validate(),e+=r.zpp_inner.y;o=r.zpp_inner;null!=o._validate&&o._validate(),i+=r.zpp_inner.z,r.dispose(),n=n.next}return K.get(t,e,i)},$.prototype.totalImpulse=function(t,e){null==e&&(e=!1);var i=0,n=0,r=0;null==this.zpp_inner.wrap_arbiters&&(this.zpp_inner.wrap_arbiters=Dn.get(this.zpp_inner.arbiters,!0));for(var o=this.zpp_inner.wrap_arbiters.iterator();;){o.zpp_inner.zpp_inner.valmod();var s=o.zpp_inner.zpp_gl();if(o.zpp_critical=!0,!(o.zpp_i<s||(o.zpp_next=Ht.zpp_pool,(Ht.zpp_pool=o).zpp_inner=null,!1)))break;o.zpp_critical=!1;var a=o.zpp_inner.at(o.zpp_i++).zpp_inner;a.type!=Qe.SENSOR&&(null!=t&&a.b2!=t.zpp_inner&&a.b1!=t.zpp_inner||(null!=(a=(s=a.wrapper().totalImpulse(this,e)).zpp_inner)._validate&&a._validate(),i+=s.zpp_inner.x,null!=(a=s.zpp_inner)._validate&&a._validate(),n+=s.zpp_inner.y,null!=(a=s.zpp_inner)._validate&&a._validate(),r+=s.zpp_inner.z,s.dispose()))}for(var h=this.zpp_inner.constraints.head;null!=h;){var l,p=h.elt;p.active&&(null!=(p=(l=p.outer.bodyImpulse(this)).zpp_inner)._validate&&p._validate(),i+=l.zpp_inner.x,null!=(p=l.zpp_inner)._validate&&p._validate(),n+=l.zpp_inner.y,null!=(p=l.zpp_inner)._validate&&p._validate(),r+=l.zpp_inner.z,l.dispose()),h=h.next}return K.get(i,n,r)},$.prototype.contains=function(t){for(var e=t.zpp_inner.weak,i=t.zpp_inner.weak=!1,n=this.zpp_inner.shapes.head;null!=n;){if(n.elt.outer.contains(t)){i=!0;break}n=n.next}return t.zpp_inner.weak=e,t.zpp_inner.weak&&(e=t.zpp_inner,t.zpp_inner.outer=null,t.zpp_inner=null,t.zpp_pool=Bn.poolVec2,Bn.poolVec2=t,null!=e.outer&&(e.outer.zpp_inner=null,e.outer=null),e._isimmutable=null,e._validate=null,e._invalidate=null,e.next=Gr.zpp_pool,Gr.zpp_pool=e),i},$.prototype.toString=function(){return(this.zpp_inner.world?"(space::world":"("+(2==this.zpp_inner.type?"dynamic":1==this.zpp_inner.type?"static":"kinematic"))+")#"+this.zpp_inner_i.id},Object.defineProperty($.prototype,"type",{get:$.prototype.get_type,set:$.prototype.set_type}),Object.defineProperty($.prototype,"isBullet",{get:$.prototype.get_isBullet,set:$.prototype.set_isBullet}),Object.defineProperty($.prototype,"disableCCD",{get:$.prototype.get_disableCCD,set:$.prototype.set_disableCCD}),Object.defineProperty($.prototype,"shapes",{get:$.prototype.get_shapes}),Object.defineProperty($.prototype,"compound",{get:$.prototype.get_compound,set:$.prototype.set_compound}),Object.defineProperty($.prototype,"space",{get:$.prototype.get_space,set:$.prototype.set_space}),Object.defineProperty($.prototype,"arbiters",{get:$.prototype.get_arbiters}),Object.defineProperty($.prototype,"isSleeping",{get:$.prototype.get_isSleeping}),Object.defineProperty($.prototype,"constraints",{get:$.prototype.get_constraints}),Object.defineProperty($.prototype,"position",{get:$.prototype.get_position,set:$.prototype.set_position}),Object.defineProperty($.prototype,"velocity",{get:$.prototype.get_velocity,set:$.prototype.set_velocity}),Object.defineProperty($.prototype,"kinematicVel",{get:$.prototype.get_kinematicVel,set:$.prototype.set_kinematicVel}),Object.defineProperty($.prototype,"surfaceVel",{get:$.prototype.get_surfaceVel,set:$.prototype.set_surfaceVel}),Object.defineProperty($.prototype,"force",{get:$.prototype.get_force,set:$.prototype.set_force}),Object.defineProperty($.prototype,"constraintVelocity",{get:$.prototype.get_constraintVelocity}),Object.defineProperty($.prototype,"rotation",{get:$.prototype.get_rotation,set:$.prototype.set_rotation}),Object.defineProperty($.prototype,"angularVel",{get:$.prototype.get_angularVel,set:$.prototype.set_angularVel}),Object.defineProperty($.prototype,"kinAngVel",{get:$.prototype.get_kinAngVel,set:$.prototype.set_kinAngVel}),Object.defineProperty($.prototype,"torque",{get:$.prototype.get_torque,set:$.prototype.set_torque}),Object.defineProperty($.prototype,"bounds",{get:$.prototype.get_bounds}),Object.defineProperty($.prototype,"allowMovement",{get:$.prototype.get_allowMovement,set:$.prototype.set_allowMovement}),Object.defineProperty($.prototype,"allowRotation",{get:$.prototype.get_allowRotation,set:$.prototype.set_allowRotation}),Object.defineProperty($.prototype,"massMode",{get:$.prototype.get_massMode,set:$.prototype.set_massMode}),Object.defineProperty($.prototype,"constraintMass",{get:$.prototype.get_constraintMass}),Object.defineProperty($.prototype,"mass",{get:$.prototype.get_mass,set:$.prototype.set_mass}),Object.defineProperty($.prototype,"gravMassMode",{get:$.prototype.get_gravMassMode,set:$.prototype.set_gravMassMode}),Object.defineProperty($.prototype,"gravMass",{get:$.prototype.get_gravMass,set:$.prototype.set_gravMass}),Object.defineProperty($.prototype,"gravMassScale",{get:$.prototype.get_gravMassScale,set:$.prototype.set_gravMassScale}),Object.defineProperty($.prototype,"inertiaMode",{get:$.prototype.get_inertiaMode,set:$.prototype.set_inertiaMode}),Object.defineProperty($.prototype,"constraintInertia",{get:$.prototype.get_constraintInertia}),Object.defineProperty($.prototype,"inertia",{get:$.prototype.get_inertia,set:$.prototype.set_inertia}),Object.defineProperty($.prototype,"localCOM",{get:$.prototype.get_localCOM}),Object.defineProperty($.prototype,"worldCOM",{get:$.prototype.get_worldCOM}),$.prototype.__class__=$;var $t=nape.phys.BodyIterator=function(){this.zpp_next=null,this.zpp_critical=!1,this.zpp_i=0,this.zpp_inner=null};$t.__name__=["nape","phys","BodyIterator"],$t.get=function(t){var e,i=null==$t.zpp_pool?(bn.internal=!0,e=new $t,bn.internal=!1,e):($t.zpp_pool=(i=$t.zpp_pool).zpp_next,i);return i.zpp_i=0,i.zpp_inner=t,i.zpp_critical=!1,i},$t.prototype.zpp_inner=null,$t.prototype.zpp_i=null,$t.prototype.zpp_critical=null,$t.prototype.zpp_next=null,$t.prototype.hasNext=function(){this.zpp_inner.zpp_inner.valmod();var t=this.zpp_inner;t.zpp_inner.valmod(),t.zpp_inner.zip_length&&(t.zpp_inner.zip_length=!1,t.zpp_inner.user_length=t.zpp_inner.inner.length);t=t.zpp_inner.user_length;return this.zpp_critical=!0,this.zpp_i<t||(this.zpp_next=$t.zpp_pool,($t.zpp_pool=this).zpp_inner=null,!1)},$t.prototype.next=function(){return this.zpp_critical=!1,this.zpp_inner.at(this.zpp_i++)},$t.prototype.__class__=$t;var tt=nape.phys.BodyList=function(){this.zpp_inner=null,this.zpp_inner=new bn,this.zpp_inner.outer=this};tt.__name__=["nape","phys","BodyList"],tt.fromArray=function(t){for(var e=new tt,i=0;i<t.length;){var n=t[i];++i,e.push(n)}return e},tt.prototype.zpp_inner=null,tt.prototype.get_length=function(){return this.zpp_inner.valmod(),this.zpp_inner.zip_length&&(this.zpp_inner.zip_length=!1,this.zpp_inner.user_length=this.zpp_inner.inner.length),this.zpp_inner.user_length},tt.prototype.has=function(t){return this.zpp_inner.valmod(),this.zpp_inner.inner.has(t.zpp_inner)},tt.prototype.at=function(t){if(this.zpp_inner.valmod(),this.zpp_inner.reverse_flag&&(this.zpp_inner.valmod(),this.zpp_inner.zip_length&&(this.zpp_inner.zip_length=!1,this.zpp_inner.user_length=this.zpp_inner.inner.length),t=this.zpp_inner.user_length-1-t),t<this.zpp_inner.at_index||null==this.zpp_inner.at_ite)this.zpp_inner.at_index=t,this.zpp_inner.at_ite=this.zpp_inner.inner.iterator_at(t);else for(;this.zpp_inner.at_index!=t;)this.zpp_inner.at_index++,this.zpp_inner.at_ite=this.zpp_inner.at_ite.next;return this.zpp_inner.at_ite.elt.outer},tt.prototype.push=function(t){this.zpp_inner.modify_test(),this.zpp_inner.valmod();var e,i=null==this.zpp_inner.adder||this.zpp_inner.adder(t);return i&&(this.zpp_inner.reverse_flag?this.zpp_inner.inner.add(t.zpp_inner):(null==this.zpp_inner.push_ite&&(e=null==this.zpp_inner.inner.head?null:(this.zpp_inner.valmod(),this.zpp_inner.zip_length&&(this.zpp_inner.zip_length=!1,this.zpp_inner.user_length=this.zpp_inner.inner.length),this.zpp_inner.inner.iterator_at(this.zpp_inner.user_length-1)),this.zpp_inner.push_ite=e),this.zpp_inner.push_ite=this.zpp_inner.inner.insert(this.zpp_inner.push_ite,t.zpp_inner)),this.zpp_inner.invalidate(),null!=this.zpp_inner.post_adder&&this.zpp_inner.post_adder(t)),i},tt.prototype.unshift=function(t){this.zpp_inner.modify_test(),this.zpp_inner.valmod();var e,i=null==this.zpp_inner.adder||this.zpp_inner.adder(t);return i&&(this.zpp_inner.reverse_flag?(null==this.zpp_inner.push_ite&&(e=null==this.zpp_inner.inner.head?null:(this.zpp_inner.valmod(),this.zpp_inner.zip_length&&(this.zpp_inner.zip_length=!1,this.zpp_inner.user_length=this.zpp_inner.inner.length),this.zpp_inner.inner.iterator_at(this.zpp_inner.user_length-1)),this.zpp_inner.push_ite=e),this.zpp_inner.push_ite=this.zpp_inner.inner.insert(this.zpp_inner.push_ite,t.zpp_inner)):this.zpp_inner.inner.add(t.zpp_inner),this.zpp_inner.invalidate(),null!=this.zpp_inner.post_adder&&this.zpp_inner.post_adder(t)),i},tt.prototype.pop=function(){this.zpp_inner.modify_test(),this.zpp_inner.valmod();var t,e,i=null;return this.zpp_inner.reverse_flag?(e=(i=this.zpp_inner.inner.head.elt).outer,null!=this.zpp_inner.subber&&this.zpp_inner.subber(e),this.zpp_inner.dontremove||this.zpp_inner.inner.pop()):(null!=this.zpp_inner.at_ite&&null==this.zpp_inner.at_ite.next&&(this.zpp_inner.at_ite=null),this.zpp_inner.valmod(),this.zpp_inner.zip_length&&(this.zpp_inner.zip_length=!1,this.zpp_inner.user_length=this.zpp_inner.inner.length),e=(i=(null==(t=1==this.zpp_inner.user_length?null:(this.zpp_inner.valmod(),this.zpp_inner.zip_length&&(this.zpp_inner.zip_length=!1,this.zpp_inner.user_length=this.zpp_inner.inner.length),this.zpp_inner.inner.iterator_at(this.zpp_inner.user_length-2)))?this.zpp_inner.inner.head:t.next).elt).outer,null!=this.zpp_inner.subber&&this.zpp_inner.subber(e),this.zpp_inner.dontremove||this.zpp_inner.inner.erase(t)),this.zpp_inner.invalidate(),i.outer},tt.prototype.shift=function(){this.zpp_inner.modify_test(),this.zpp_inner.valmod();var t,e,i=null;return this.zpp_inner.reverse_flag?(null!=this.zpp_inner.at_ite&&null==this.zpp_inner.at_ite.next&&(this.zpp_inner.at_ite=null),this.zpp_inner.valmod(),this.zpp_inner.zip_length&&(this.zpp_inner.zip_length=!1,this.zpp_inner.user_length=this.zpp_inner.inner.length),t=(i=(null==(e=1==this.zpp_inner.user_length?null:(this.zpp_inner.valmod(),this.zpp_inner.zip_length&&(this.zpp_inner.zip_length=!1,this.zpp_inner.user_length=this.zpp_inner.inner.length),this.zpp_inner.inner.iterator_at(this.zpp_inner.user_length-2)))?this.zpp_inner.inner.head:e.next).elt).outer,null!=this.zpp_inner.subber&&this.zpp_inner.subber(t),this.zpp_inner.dontremove||this.zpp_inner.inner.erase(e)):(e=(i=this.zpp_inner.inner.head.elt).outer,null!=this.zpp_inner.subber&&this.zpp_inner.subber(e),this.zpp_inner.dontremove||this.zpp_inner.inner.pop()),this.zpp_inner.invalidate(),i.outer},tt.prototype.add=function(t){return this.zpp_inner.reverse_flag?this.push(t):this.unshift(t)},tt.prototype.remove=function(t){this.zpp_inner.modify_test(),this.zpp_inner.valmod();for(var e=!1,i=this.zpp_inner.inner.head;null!=i;){if(i.elt==t.zpp_inner){e=!0;break}i=i.next}return e&&(null!=this.zpp_inner.subber&&this.zpp_inner.subber(t),this.zpp_inner.dontremove||this.zpp_inner.inner.remove(t.zpp_inner),this.zpp_inner.invalidate()),e},tt.prototype.clear=function(){if(this.zpp_inner.reverse_flag)for(;null!=this.zpp_inner.inner.head;)this.pop();else for(;null!=this.zpp_inner.inner.head;)this.shift()},tt.prototype.empty=function(){return null==this.zpp_inner.inner.head},tt.prototype.iterator=function(){return this.zpp_inner.valmod(),$t.get(this)},tt.prototype.copy=function(t){null==t&&(t=!1);var e=new tt;this.zpp_inner.valmod();for(var i=$t.get(this);;){i.zpp_inner.zpp_inner.valmod();var n=i.zpp_inner;n.zpp_inner.valmod(),n.zpp_inner.zip_length&&(n.zpp_inner.zip_length=!1,n.zpp_inner.user_length=n.zpp_inner.inner.length);n=n.zpp_inner.user_length;if(i.zpp_critical=!0,!(i.zpp_i<n||(i.zpp_next=$t.zpp_pool,($t.zpp_pool=i).zpp_inner=null,!1)))break;i.zpp_critical=!1;n=i.zpp_inner.at(i.zpp_i++);e.push(t?null:n)}return e},tt.prototype.merge=function(t){t.zpp_inner.valmod();for(var e=$t.get(t);;){e.zpp_inner.zpp_inner.valmod();var i=e.zpp_inner;i.zpp_inner.valmod(),i.zpp_inner.zip_length&&(i.zpp_inner.zip_length=!1,i.zpp_inner.user_length=i.zpp_inner.inner.length);i=i.zpp_inner.user_length;if(e.zpp_critical=!0,!(e.zpp_i<i||(e.zpp_next=$t.zpp_pool,($t.zpp_pool=e).zpp_inner=null,!1)))break;e.zpp_critical=!1;i=e.zpp_inner.at(e.zpp_i++);this.has(i)||(this.zpp_inner.reverse_flag?this.push(i):this.unshift(i))}},tt.prototype.toString=function(){var t="[",e=!0;this.zpp_inner.valmod();for(var i=$t.get(this);;){i.zpp_inner.zpp_inner.valmod();var n=i.zpp_inner;n.zpp_inner.valmod(),n.zpp_inner.zip_length&&(n.zpp_inner.zip_length=!1,n.zpp_inner.user_length=n.zpp_inner.inner.length);n=n.zpp_inner.user_length;if(i.zpp_critical=!0,!(i.zpp_i<n||(i.zpp_next=$t.zpp_pool,($t.zpp_pool=i).zpp_inner=null,!1)))break;i.zpp_critical=!1;n=i.zpp_inner.at(i.zpp_i++);e||(t+=","),t+=null==n?"NULL":n.toString(),e=!1}return t+"]"},tt.prototype.foreach=function(t){this.zpp_inner.valmod();for(var e=$t.get(this);;){e.zpp_inner.zpp_inner.valmod();var i=e.zpp_inner;i.zpp_inner.valmod(),i.zpp_inner.zip_length&&(i.zpp_inner.zip_length=!1,i.zpp_inner.user_length=i.zpp_inner.inner.length);i=i.zpp_inner.user_length;if(e.zpp_critical=!0,!(e.zpp_i<i||(e.zpp_next=$t.zpp_pool,($t.zpp_pool=e).zpp_inner=null,!1)))break;try{e.zpp_critical=!1,t(e.zpp_inner.at(e.zpp_i++))}catch(t){e.zpp_next=$t.zpp_pool,($t.zpp_pool=e).zpp_inner=null;break}}return this},tt.prototype.filter=function(t){for(var e=0;;){if(this.zpp_inner.valmod(),this.zpp_inner.zip_length&&(this.zpp_inner.zip_length=!1,this.zpp_inner.user_length=this.zpp_inner.inner.length),!(e<this.zpp_inner.user_length))break;var i=this.at(e);try{t(i)?++e:this.remove(i)}catch(t){break}}return this},Object.defineProperty(tt.prototype,"length",{get:tt.prototype.get_length}),tt.prototype.__class__=tt;var et=nape.phys.BodyType=function(){};et.__name__=["nape","phys","BodyType"],et.STATIC=null,et.get_STATIC=function(){return null==Yn.BodyType_STATIC&&(Yn.internal=!0,Yn.BodyType_STATIC=new et,Yn.internal=!1),Yn.BodyType_STATIC},et.DYNAMIC=null,et.get_DYNAMIC=function(){return null==Yn.BodyType_DYNAMIC&&(Yn.internal=!0,Yn.BodyType_DYNAMIC=new et,Yn.internal=!1),Yn.BodyType_DYNAMIC},et.KINEMATIC=null,et.get_KINEMATIC=function(){return null==Yn.BodyType_KINEMATIC&&(Yn.internal=!0,Yn.BodyType_KINEMATIC=new et,Yn.internal=!1),Yn.BodyType_KINEMATIC},et.prototype.toString=function(){return null==Yn.BodyType_STATIC&&(Yn.internal=!0,Yn.BodyType_STATIC=new et,Yn.internal=!1),this==Yn.BodyType_STATIC?"STATIC":(null==Yn.BodyType_DYNAMIC&&(Yn.internal=!0,Yn.BodyType_DYNAMIC=new et,Yn.internal=!1),this==Yn.BodyType_DYNAMIC?"DYNAMIC":(null==Yn.BodyType_KINEMATIC&&(Yn.internal=!0,Yn.BodyType_KINEMATIC=new et,Yn.internal=!1),this==Yn.BodyType_KINEMATIC?"KINEMATIC":""))},Object.defineProperty(et,"STATIC",{get:et.get_STATIC}),Object.defineProperty(et,"DYNAMIC",{get:et.get_DYNAMIC}),Object.defineProperty(et,"KINEMATIC",{get:et.get_KINEMATIC}),et.prototype.__class__=et;var it=nape.phys.Compound=function(){this.zpp_inner=null,Q.call(this),this.zpp_inner=new Ne,((this.zpp_inner.outer=this).zpp_inner.outer_i=this).zpp_inner_i=this.zpp_inner,this.zpp_inner.insert_cbtype(Tt.ANY_COMPOUND.zpp_inner)};it.__name__=["nape","phys","Compound"],it.__super__=Q,(it.prototype=Object.create(Q.prototype)).zpp_inner=null,it.prototype.get_bodies=function(){return this.zpp_inner.wrap_bodies},it.prototype.get_constraints=function(){return this.zpp_inner.wrap_constraints},it.prototype.get_compounds=function(){return this.zpp_inner.wrap_compounds},it.prototype.get_compound=function(){return null==this.zpp_inner.compound?null:this.zpp_inner.compound.outer},it.prototype.set_compound=function(t){return this.zpp_inner.immutable_midstep("Compound::compound"),(null==this.zpp_inner.compound?null:this.zpp_inner.compound.outer)!=t&&(null!=(null==this.zpp_inner.compound?null:this.zpp_inner.compound.outer)&&(null==this.zpp_inner.compound?null:this.zpp_inner.compound.outer).zpp_inner.wrap_compounds.remove(this),null!=t&&((t=t.zpp_inner.wrap_compounds).zpp_inner.reverse_flag?t.push(this):t.unshift(this))),null==this.zpp_inner.compound?null:this.zpp_inner.compound.outer},it.prototype.get_space=function(){return null==this.zpp_inner.space?null:this.zpp_inner.space.outer},it.prototype.set_space=function(t){return this.zpp_inner.immutable_midstep("Compound::space"),(null==this.zpp_inner.space?null:this.zpp_inner.space.outer)!=t&&(null!=(null==this.zpp_inner.space?null:this.zpp_inner.space.outer)&&(null==this.zpp_inner.space?null:this.zpp_inner.space.outer).zpp_inner.wrap_compounds.remove(this),null!=t&&((t=t.zpp_inner.wrap_compounds).zpp_inner.reverse_flag?t.push(this):t.unshift(this))),null==this.zpp_inner.space?null:this.zpp_inner.space.outer},it.prototype.toString=function(){return"Compound"+this.zpp_inner_i.id},it.prototype.copy=function(){return this.zpp_inner.copy()},it.prototype.breakApart=function(){this.zpp_inner.breakApart()},it.prototype.visitBodies=function(t){var e=this.zpp_inner.wrap_bodies;e.zpp_inner.valmod();for(var i=$t.get(e);;){i.zpp_inner.zpp_inner.valmod();var n=i.zpp_inner;n.zpp_inner.valmod(),n.zpp_inner.zip_length&&(n.zpp_inner.zip_length=!1,n.zpp_inner.user_length=n.zpp_inner.inner.length);n=n.zpp_inner.user_length;if(i.zpp_critical=!0,!(i.zpp_i<n||(i.zpp_next=$t.zpp_pool,($t.zpp_pool=i).zpp_inner=null,!1)))break;i.zpp_critical=!1,t(i.zpp_inner.at(i.zpp_i++))}e=this.zpp_inner.wrap_compounds;e.zpp_inner.valmod();for(var r=te.get(e);;){r.zpp_inner.zpp_inner.valmod();var o=r.zpp_inner;o.zpp_inner.valmod(),o.zpp_inner.zip_length&&(o.zpp_inner.zip_length=!1,o.zpp_inner.user_length=o.zpp_inner.inner.length);o=o.zpp_inner.user_length;if(r.zpp_critical=!0,!(r.zpp_i<o||(r.zpp_next=te.zpp_pool,(te.zpp_pool=r).zpp_inner=null,!1)))break;r.zpp_critical=!1,r.zpp_inner.at(r.zpp_i++).visitBodies(t)}},it.prototype.visitConstraints=function(t){var e=this.zpp_inner.wrap_constraints;e.zpp_inner.valmod();for(var i=Xt.get(e);;){i.zpp_inner.zpp_inner.valmod();var n=i.zpp_inner;n.zpp_inner.valmod(),n.zpp_inner.zip_length&&(n.zpp_inner.zip_length=!1,n.zpp_inner.user_length=n.zpp_inner.inner.length);n=n.zpp_inner.user_length;if(i.zpp_critical=!0,!(i.zpp_i<n||(i.zpp_next=Xt.zpp_pool,(Xt.zpp_pool=i).zpp_inner=null,!1)))break;i.zpp_critical=!1,t(i.zpp_inner.at(i.zpp_i++))}e=this.zpp_inner.wrap_compounds;e.zpp_inner.valmod();for(var r=te.get(e);;){r.zpp_inner.zpp_inner.valmod();var o=r.zpp_inner;o.zpp_inner.valmod(),o.zpp_inner.zip_length&&(o.zpp_inner.zip_length=!1,o.zpp_inner.user_length=o.zpp_inner.inner.length);o=o.zpp_inner.user_length;if(r.zpp_critical=!0,!(r.zpp_i<o||(r.zpp_next=te.zpp_pool,(te.zpp_pool=r).zpp_inner=null,!1)))break;r.zpp_critical=!1,r.zpp_inner.at(r.zpp_i++).visitConstraints(t)}},it.prototype.visitCompounds=function(t){var e=this.zpp_inner.wrap_compounds;e.zpp_inner.valmod();for(var i=te.get(e);;){i.zpp_inner.zpp_inner.valmod();var n=i.zpp_inner;n.zpp_inner.valmod(),n.zpp_inner.zip_length&&(n.zpp_inner.zip_length=!1,n.zpp_inner.user_length=n.zpp_inner.inner.length);n=n.zpp_inner.user_length;if(i.zpp_critical=!0,!(i.zpp_i<n||(i.zpp_next=te.zpp_pool,(te.zpp_pool=i).zpp_inner=null,!1)))break;i.zpp_critical=!1;n=i.zpp_inner.at(i.zpp_i++);t(n),n.visitCompounds(t)}},it.prototype.COM=function(t){var e,i,n;null==t&&(t=!1),null==Bn.poolVec2?e=new St:(e=Bn.poolVec2,Bn.poolVec2=e.zpp_pool,e.zpp_pool=null),null==e.zpp_inner?(null==Gr.zpp_pool?i=new Gr:(i=Gr.zpp_pool,Gr.zpp_pool=i.next,i.next=null),i.weak=!1,i._immutable=!1,i.x=0,i.y=0,e.zpp_inner=i,e.zpp_inner.outer=e):(null!=(i=e.zpp_inner)._validate&&i._validate(),0==e.zpp_inner.x&&(null!=(n=e.zpp_inner)._validate&&n._validate(),0==e.zpp_inner.y)||(e.zpp_inner.x=0,e.zpp_inner.y=0,null!=(n=e.zpp_inner)._invalidate&&n._invalidate(n))),e.zpp_inner.weak=t;var o=e,s=0;return this.visitBodies(function(t){var e,i,n,r;null!=t.zpp_inner.wrap_shapes.zpp_inner.inner.head&&(null==t.zpp_inner.wrap_worldCOM&&(e=t.zpp_inner.worldCOMx,n=t.zpp_inner.worldCOMy,null==Bn.poolVec2?r=new St:(r=Bn.poolVec2,Bn.poolVec2=r.zpp_pool,r.zpp_pool=null),null==r.zpp_inner?(null==Gr.zpp_pool?i=new Gr:(i=Gr.zpp_pool,Gr.zpp_pool=i.next,i.next=null),i.weak=!1,i._immutable=!1,i.x=e,i.y=n,r.zpp_inner=i,r.zpp_inner.outer=r):(null!=(i=r.zpp_inner)._validate&&i._validate(),r.zpp_inner.x==e&&(null!=(i=r.zpp_inner)._validate&&i._validate(),r.zpp_inner.y==n)||(r.zpp_inner.x=e,r.zpp_inner.y=n,null!=(n=r.zpp_inner)._invalidate&&n._invalidate(n))),r.zpp_inner.weak=!1,t.zpp_inner.wrap_worldCOM=r,t.zpp_inner.wrap_worldCOM.zpp_inner._inuse=!0,t.zpp_inner.wrap_worldCOM.zpp_inner._immutable=!0,t.zpp_inner.wrap_worldCOM.zpp_inner._validate=Z(a=t.zpp_inner,a.getworldCOM)),r=t.zpp_inner.wrap_worldCOM,t.zpp_inner.validate_mass(),o.addeq(r.mul(t.zpp_inner.cmass,!0)),t.zpp_inner.validate_mass(),s+=t.zpp_inner.cmass)}),o.muleq(1/s),o},it.prototype.translate=function(e){var t,i=e.zpp_inner.weak;return e.zpp_inner.weak=!1,this.visitBodies(function(t){null==t.zpp_inner.wrap_pos&&t.zpp_inner.setupPosition(),t.zpp_inner.wrap_pos.addeq(e)}),e.zpp_inner.weak=i,e.zpp_inner.weak&&(t=e.zpp_inner,e.zpp_inner.outer=null,e.zpp_inner=null,(i=e).zpp_pool=Bn.poolVec2,Bn.poolVec2=i,null!=t.outer&&(t.outer.zpp_inner=null,t.outer=null),t._isimmutable=null,t._validate=null,t._invalidate=null,t.next=Gr.zpp_pool,Gr.zpp_pool=t),this},it.prototype.rotate=function(e,i){var t,n=e.zpp_inner.weak;return e.zpp_inner.weak=!1,this.visitBodies(function(t){t.rotate(e,i)}),e.zpp_inner.weak=n,e.zpp_inner.weak&&(t=e.zpp_inner,e.zpp_inner.outer=null,e.zpp_inner=null,(n=e).zpp_pool=Bn.poolVec2,Bn.poolVec2=n,null!=t.outer&&(t.outer.zpp_inner=null,t.outer=null),t._isimmutable=null,t._validate=null,t._invalidate=null,t.next=Gr.zpp_pool,Gr.zpp_pool=t),this},Object.defineProperty(it.prototype,"bodies",{get:it.prototype.get_bodies}),Object.defineProperty(it.prototype,"constraints",{get:it.prototype.get_constraints}),Object.defineProperty(it.prototype,"compounds",{get:it.prototype.get_compounds}),Object.defineProperty(it.prototype,"compound",{get:it.prototype.get_compound,set:it.prototype.set_compound}),Object.defineProperty(it.prototype,"space",{get:it.prototype.get_space,set:it.prototype.set_space}),it.prototype.__class__=it;var te=nape.phys.CompoundIterator=function(){this.zpp_next=null,this.zpp_critical=!1,this.zpp_i=0,this.zpp_inner=null};te.__name__=["nape","phys","CompoundIterator"],te.get=function(t){var e,i=null==te.zpp_pool?(Cn.internal=!0,e=new te,Cn.internal=!1,e):(i=te.zpp_pool,te.zpp_pool=i.zpp_next,i);return i.zpp_i=0,i.zpp_inner=t,i.zpp_critical=!1,i},te.prototype.zpp_inner=null,te.prototype.zpp_i=null,te.prototype.zpp_critical=null,te.prototype.zpp_next=null,te.prototype.hasNext=function(){this.zpp_inner.zpp_inner.valmod();var t=this.zpp_inner;t.zpp_inner.valmod(),t.zpp_inner.zip_length&&(t.zpp_inner.zip_length=!1,t.zpp_inner.user_length=t.zpp_inner.inner.length);t=t.zpp_inner.user_length;return this.zpp_critical=!0,this.zpp_i<t||(this.zpp_next=te.zpp_pool,(te.zpp_pool=this).zpp_inner=null,!1)},te.prototype.next=function(){return this.zpp_critical=!1,this.zpp_inner.at(this.zpp_i++)},te.prototype.__class__=te;var nt=nape.phys.CompoundList=function(){this.zpp_inner=null,this.zpp_inner=new Cn,this.zpp_inner.outer=this};nt.__name__=["nape","phys","CompoundList"],nt.fromArray=function(t){for(var e=new nt,i=0;i<t.length;){var n=t[i];++i,e.push(n)}return e},nt.prototype.zpp_inner=null,nt.prototype.get_length=function(){return this.zpp_inner.valmod(),this.zpp_inner.zip_length&&(this.zpp_inner.zip_length=!1,this.zpp_inner.user_length=this.zpp_inner.inner.length),this.zpp_inner.user_length},nt.prototype.has=function(t){return this.zpp_inner.valmod(),this.zpp_inner.inner.has(t.zpp_inner)},nt.prototype.at=function(t){if(this.zpp_inner.valmod(),this.zpp_inner.reverse_flag&&(this.zpp_inner.valmod(),this.zpp_inner.zip_length&&(this.zpp_inner.zip_length=!1,this.zpp_inner.user_length=this.zpp_inner.inner.length),t=this.zpp_inner.user_length-1-t),t<this.zpp_inner.at_index||null==this.zpp_inner.at_ite)this.zpp_inner.at_index=t,this.zpp_inner.at_ite=this.zpp_inner.inner.iterator_at(t);else for(;this.zpp_inner.at_index!=t;)this.zpp_inner.at_index++,this.zpp_inner.at_ite=this.zpp_inner.at_ite.next;return this.zpp_inner.at_ite.elt.outer},nt.prototype.push=function(t){this.zpp_inner.modify_test(),this.zpp_inner.valmod();var e,i=null==this.zpp_inner.adder||this.zpp_inner.adder(t);return i&&(this.zpp_inner.reverse_flag?this.zpp_inner.inner.add(t.zpp_inner):(null==this.zpp_inner.push_ite&&(e=null==this.zpp_inner.inner.head?null:(this.zpp_inner.valmod(),this.zpp_inner.zip_length&&(this.zpp_inner.zip_length=!1,this.zpp_inner.user_length=this.zpp_inner.inner.length),this.zpp_inner.inner.iterator_at(this.zpp_inner.user_length-1)),this.zpp_inner.push_ite=e),this.zpp_inner.push_ite=this.zpp_inner.inner.insert(this.zpp_inner.push_ite,t.zpp_inner)),this.zpp_inner.invalidate(),null!=this.zpp_inner.post_adder&&this.zpp_inner.post_adder(t)),i},nt.prototype.unshift=function(t){this.zpp_inner.modify_test(),this.zpp_inner.valmod();var e,i=null==this.zpp_inner.adder||this.zpp_inner.adder(t);return i&&(this.zpp_inner.reverse_flag?(null==this.zpp_inner.push_ite&&(e=null==this.zpp_inner.inner.head?null:(this.zpp_inner.valmod(),this.zpp_inner.zip_length&&(this.zpp_inner.zip_length=!1,this.zpp_inner.user_length=this.zpp_inner.inner.length),this.zpp_inner.inner.iterator_at(this.zpp_inner.user_length-1)),this.zpp_inner.push_ite=e),this.zpp_inner.push_ite=this.zpp_inner.inner.insert(this.zpp_inner.push_ite,t.zpp_inner)):this.zpp_inner.inner.add(t.zpp_inner),this.zpp_inner.invalidate(),null!=this.zpp_inner.post_adder&&this.zpp_inner.post_adder(t)),i},nt.prototype.pop=function(){this.zpp_inner.modify_test(),this.zpp_inner.valmod();var t,e,i=null;return this.zpp_inner.reverse_flag?(e=(i=this.zpp_inner.inner.head.elt).outer,null!=this.zpp_inner.subber&&this.zpp_inner.subber(e),this.zpp_inner.dontremove||this.zpp_inner.inner.pop()):(null!=this.zpp_inner.at_ite&&null==this.zpp_inner.at_ite.next&&(this.zpp_inner.at_ite=null),this.zpp_inner.valmod(),this.zpp_inner.zip_length&&(this.zpp_inner.zip_length=!1,this.zpp_inner.user_length=this.zpp_inner.inner.length),e=(i=(null==(t=1==this.zpp_inner.user_length?null:(this.zpp_inner.valmod(),this.zpp_inner.zip_length&&(this.zpp_inner.zip_length=!1,this.zpp_inner.user_length=this.zpp_inner.inner.length),this.zpp_inner.inner.iterator_at(this.zpp_inner.user_length-2)))?this.zpp_inner.inner.head:t.next).elt).outer,null!=this.zpp_inner.subber&&this.zpp_inner.subber(e),this.zpp_inner.dontremove||this.zpp_inner.inner.erase(t)),this.zpp_inner.invalidate(),i.outer},nt.prototype.shift=function(){this.zpp_inner.modify_test(),this.zpp_inner.valmod();var t,e,i=null;return this.zpp_inner.reverse_flag?(null!=this.zpp_inner.at_ite&&null==this.zpp_inner.at_ite.next&&(this.zpp_inner.at_ite=null),this.zpp_inner.valmod(),this.zpp_inner.zip_length&&(this.zpp_inner.zip_length=!1,this.zpp_inner.user_length=this.zpp_inner.inner.length),t=(i=(null==(e=1==this.zpp_inner.user_length?null:(this.zpp_inner.valmod(),this.zpp_inner.zip_length&&(this.zpp_inner.zip_length=!1,this.zpp_inner.user_length=this.zpp_inner.inner.length),this.zpp_inner.inner.iterator_at(this.zpp_inner.user_length-2)))?this.zpp_inner.inner.head:e.next).elt).outer,null!=this.zpp_inner.subber&&this.zpp_inner.subber(t),this.zpp_inner.dontremove||this.zpp_inner.inner.erase(e)):(e=(i=this.zpp_inner.inner.head.elt).outer,null!=this.zpp_inner.subber&&this.zpp_inner.subber(e),this.zpp_inner.dontremove||this.zpp_inner.inner.pop()),this.zpp_inner.invalidate(),i.outer},nt.prototype.add=function(t){return this.zpp_inner.reverse_flag?this.push(t):this.unshift(t)},nt.prototype.remove=function(t){this.zpp_inner.modify_test(),this.zpp_inner.valmod();for(var e=!1,i=this.zpp_inner.inner.head;null!=i;){if(i.elt==t.zpp_inner){e=!0;break}i=i.next}return e&&(null!=this.zpp_inner.subber&&this.zpp_inner.subber(t),this.zpp_inner.dontremove||this.zpp_inner.inner.remove(t.zpp_inner),this.zpp_inner.invalidate()),e},nt.prototype.clear=function(){if(this.zpp_inner.reverse_flag)for(;null!=this.zpp_inner.inner.head;)this.pop();else for(;null!=this.zpp_inner.inner.head;)this.shift()},nt.prototype.empty=function(){return null==this.zpp_inner.inner.head},nt.prototype.iterator=function(){return this.zpp_inner.valmod(),te.get(this)},nt.prototype.copy=function(t){null==t&&(t=!1);var e=new nt;this.zpp_inner.valmod();for(var i=te.get(this);;){i.zpp_inner.zpp_inner.valmod();var n=i.zpp_inner;n.zpp_inner.valmod(),n.zpp_inner.zip_length&&(n.zpp_inner.zip_length=!1,n.zpp_inner.user_length=n.zpp_inner.inner.length);n=n.zpp_inner.user_length;if(i.zpp_critical=!0,!(i.zpp_i<n||(i.zpp_next=te.zpp_pool,(te.zpp_pool=i).zpp_inner=null,!1)))break;i.zpp_critical=!1;n=i.zpp_inner.at(i.zpp_i++);e.push(t?null:n)}return e},nt.prototype.merge=function(t){t.zpp_inner.valmod();for(var e=te.get(t);;){e.zpp_inner.zpp_inner.valmod();var i=e.zpp_inner;i.zpp_inner.valmod(),i.zpp_inner.zip_length&&(i.zpp_inner.zip_length=!1,i.zpp_inner.user_length=i.zpp_inner.inner.length);i=i.zpp_inner.user_length;if(e.zpp_critical=!0,!(e.zpp_i<i||(e.zpp_next=te.zpp_pool,(te.zpp_pool=e).zpp_inner=null,!1)))break;e.zpp_critical=!1;i=e.zpp_inner.at(e.zpp_i++);this.has(i)||(this.zpp_inner.reverse_flag?this.push(i):this.unshift(i))}},nt.prototype.toString=function(){var t="[",e=!0;this.zpp_inner.valmod();for(var i=te.get(this);;){i.zpp_inner.zpp_inner.valmod();var n=i.zpp_inner;n.zpp_inner.valmod(),n.zpp_inner.zip_length&&(n.zpp_inner.zip_length=!1,n.zpp_inner.user_length=n.zpp_inner.inner.length);n=n.zpp_inner.user_length;if(i.zpp_critical=!0,!(i.zpp_i<n||(i.zpp_next=te.zpp_pool,(te.zpp_pool=i).zpp_inner=null,!1)))break;i.zpp_critical=!1;n=i.zpp_inner.at(i.zpp_i++);e||(t+=","),t+=null==n?"NULL":n.toString(),e=!1}return t+"]"},nt.prototype.foreach=function(t){this.zpp_inner.valmod();for(var e=te.get(this);;){e.zpp_inner.zpp_inner.valmod();var i=e.zpp_inner;i.zpp_inner.valmod(),i.zpp_inner.zip_length&&(i.zpp_inner.zip_length=!1,i.zpp_inner.user_length=i.zpp_inner.inner.length);i=i.zpp_inner.user_length;if(e.zpp_critical=!0,!(e.zpp_i<i||(e.zpp_next=te.zpp_pool,(te.zpp_pool=e).zpp_inner=null,!1)))break;try{e.zpp_critical=!1,t(e.zpp_inner.at(e.zpp_i++))}catch(t){e.zpp_next=te.zpp_pool,(te.zpp_pool=e).zpp_inner=null;break}}return this},nt.prototype.filter=function(t){for(var e=0;;){if(this.zpp_inner.valmod(),this.zpp_inner.zip_length&&(this.zpp_inner.zip_length=!1,this.zpp_inner.user_length=this.zpp_inner.inner.length),!(e<this.zpp_inner.user_length))break;var i=this.at(e);try{t(i)?++e:this.remove(i)}catch(t){break}}return this},Object.defineProperty(nt.prototype,"length",{get:nt.prototype.get_length}),nt.prototype.__class__=nt;var rt=nape.phys.FluidProperties=function(t,e){null==e&&(e=1),null==t&&(t=1),(this.zpp_inner=null)==je.zpp_pool?this.zpp_inner=new je:(this.zpp_inner=je.zpp_pool,je.zpp_pool=this.zpp_inner.next,this.zpp_inner.next=null),t!=1e3*(this.zpp_inner.outer=this).zpp_inner.density&&(this.zpp_inner.density=t/1e3,this.zpp_inner.invalidate()),e!=this.zpp_inner.viscosity&&(this.zpp_inner.viscosity=+e,this.zpp_inner.invalidate())};rt.__name__=["nape","phys","FluidProperties"],rt.prototype.zpp_inner=null,rt.prototype.get_userData=function(){return null==this.zpp_inner.userData&&(this.zpp_inner.userData={}),this.zpp_inner.userData},rt.prototype.get_shapes=function(){return null==this.zpp_inner.wrap_shapes&&(this.zpp_inner.wrap_shapes=In.get(this.zpp_inner.shapes,!0)),this.zpp_inner.wrap_shapes},rt.prototype.copy=function(){var t=new rt(1e3*this.zpp_inner.density,this.zpp_inner.viscosity);null!=this.zpp_inner.userData&&(t.zpp_inner.userData=h.copy(this.zpp_inner.userData));var e,i,n,r,o,s=this.zpp_inner.wrap_gravity;return null==s?null!=t.zpp_inner.wrap_gravity&&(t.zpp_inner.wrap_gravity.zpp_inner._inuse=!1,r=(i=t.zpp_inner.wrap_gravity).zpp_inner,i.zpp_inner.outer=null,i.zpp_inner=null,i.zpp_pool=Bn.poolVec2,Bn.poolVec2=i,null!=r.outer&&(r.outer.zpp_inner=null,r.outer=null),r._isimmutable=null,r._validate=null,r._invalidate=null,r.next=Gr.zpp_pool,Gr.zpp_pool=r,t.zpp_inner.wrap_gravity=null):(null==t.zpp_inner.wrap_gravity&&t.zpp_inner.getgravity(),e=t.zpp_inner.wrap_gravity,null!=(n=s.zpp_inner)._validate&&n._validate(),i=s.zpp_inner.x,null!=(r=s.zpp_inner)._validate&&r._validate(),n=s.zpp_inner.y,null!=(r=e.zpp_inner)._validate&&r._validate(),e.zpp_inner.x==i&&(null!=(r=e.zpp_inner)._validate&&r._validate(),e.zpp_inner.y==n)||(e.zpp_inner.x=i,e.zpp_inner.y=n,null!=(o=e.zpp_inner)._invalidate&&o._invalidate(o)),s.zpp_inner.weak&&(o=s.zpp_inner,s.zpp_inner.outer=null,s.zpp_inner=null,s.zpp_pool=Bn.poolVec2,Bn.poolVec2=s,null!=o.outer&&(o.outer.zpp_inner=null,o.outer=null),o._isimmutable=null,o._validate=null,o._invalidate=null,o.next=Gr.zpp_pool,Gr.zpp_pool=o)),t},rt.prototype.get_density=function(){return 1e3*this.zpp_inner.density},rt.prototype.set_density=function(t){return t!=1e3*this.zpp_inner.density&&(this.zpp_inner.density=t/1e3,this.zpp_inner.invalidate()),1e3*this.zpp_inner.density},rt.prototype.get_viscosity=function(){return this.zpp_inner.viscosity},rt.prototype.set_viscosity=function(t){return t!=this.zpp_inner.viscosity&&(this.zpp_inner.viscosity=+t,this.zpp_inner.invalidate()),this.zpp_inner.viscosity},rt.prototype.get_gravity=function(){return this.zpp_inner.wrap_gravity},rt.prototype.set_gravity=function(t){var e,i,n,r,o;return null==t?null!=this.zpp_inner.wrap_gravity&&(this.zpp_inner.wrap_gravity.zpp_inner._inuse=!1,r=(i=this.zpp_inner.wrap_gravity).zpp_inner,i.zpp_inner.outer=null,i.zpp_inner=null,i.zpp_pool=Bn.poolVec2,Bn.poolVec2=i,null!=r.outer&&(r.outer.zpp_inner=null,r.outer=null),r._isimmutable=null,r._validate=null,r._invalidate=null,r.next=Gr.zpp_pool,Gr.zpp_pool=r,this.zpp_inner.wrap_gravity=null):(null==this.zpp_inner.wrap_gravity&&this.zpp_inner.getgravity(),e=this.zpp_inner.wrap_gravity,null!=(n=t.zpp_inner)._validate&&n._validate(),i=t.zpp_inner.x,null!=(r=t.zpp_inner)._validate&&r._validate(),n=t.zpp_inner.y,null!=(r=e.zpp_inner)._validate&&r._validate(),e.zpp_inner.x==i&&(null!=(r=e.zpp_inner)._validate&&r._validate(),e.zpp_inner.y==n)||(e.zpp_inner.x=i,e.zpp_inner.y=n,null!=(o=e.zpp_inner)._invalidate&&o._invalidate(o)),t.zpp_inner.weak&&(o=t.zpp_inner,t.zpp_inner.outer=null,t.zpp_inner=null,t.zpp_pool=Bn.poolVec2,Bn.poolVec2=t,null!=o.outer&&(o.outer.zpp_inner=null,o.outer=null),o._isimmutable=null,o._validate=null,o._invalidate=null,o.next=Gr.zpp_pool,Gr.zpp_pool=o)),this.zpp_inner.wrap_gravity},rt.prototype.toString=function(){return"{ density: "+1e3*this.zpp_inner.density+" viscosity: "+this.zpp_inner.viscosity+" gravity: "+n.string(this.zpp_inner.wrap_gravity)+" }"},Object.defineProperty(rt.prototype,"userData",{get:rt.prototype.get_userData}),Object.defineProperty(rt.prototype,"shapes",{get:rt.prototype.get_shapes}),Object.defineProperty(rt.prototype,"density",{get:rt.prototype.get_density,set:rt.prototype.set_density}),Object.defineProperty(rt.prototype,"viscosity",{get:rt.prototype.get_viscosity,set:rt.prototype.set_viscosity}),Object.defineProperty(rt.prototype,"gravity",{get:rt.prototype.get_gravity,set:rt.prototype.set_gravity}),rt.prototype.__class__=rt;var ot=nape.phys.GravMassMode=function(){};ot.__name__=["nape","phys","GravMassMode"],ot.DEFAULT=null,ot.get_DEFAULT=function(){return null==Yn.GravMassMode_DEFAULT&&(Yn.internal=!0,Yn.GravMassMode_DEFAULT=new ot,Yn.internal=!1),Yn.GravMassMode_DEFAULT},ot.FIXED=null,ot.get_FIXED=function(){return null==Yn.GravMassMode_FIXED&&(Yn.internal=!0,Yn.GravMassMode_FIXED=new ot,Yn.internal=!1),Yn.GravMassMode_FIXED},ot.SCALED=null,ot.get_SCALED=function(){return null==Yn.GravMassMode_SCALED&&(Yn.internal=!0,Yn.GravMassMode_SCALED=new ot,Yn.internal=!1),Yn.GravMassMode_SCALED},ot.prototype.toString=function(){return null==Yn.GravMassMode_DEFAULT&&(Yn.internal=!0,Yn.GravMassMode_DEFAULT=new ot,Yn.internal=!1),this==Yn.GravMassMode_DEFAULT?"DEFAULT":(null==Yn.GravMassMode_FIXED&&(Yn.internal=!0,Yn.GravMassMode_FIXED=new ot,Yn.internal=!1),this==Yn.GravMassMode_FIXED?"FIXED":(null==Yn.GravMassMode_SCALED&&(Yn.internal=!0,Yn.GravMassMode_SCALED=new ot,Yn.internal=!1),this==Yn.GravMassMode_SCALED?"SCALED":""))},Object.defineProperty(ot,"DEFAULT",{get:ot.get_DEFAULT}),Object.defineProperty(ot,"FIXED",{get:ot.get_FIXED}),Object.defineProperty(ot,"SCALED",{get:ot.get_SCALED}),ot.prototype.__class__=ot;var st=nape.phys.InertiaMode=function(){};st.__name__=["nape","phys","InertiaMode"],st.DEFAULT=null,st.get_DEFAULT=function(){return null==Yn.InertiaMode_DEFAULT&&(Yn.internal=!0,Yn.InertiaMode_DEFAULT=new st,Yn.internal=!1),Yn.InertiaMode_DEFAULT},st.FIXED=null,st.get_FIXED=function(){return null==Yn.InertiaMode_FIXED&&(Yn.internal=!0,Yn.InertiaMode_FIXED=new st,Yn.internal=!1),Yn.InertiaMode_FIXED},st.prototype.toString=function(){return null==Yn.InertiaMode_DEFAULT&&(Yn.internal=!0,Yn.InertiaMode_DEFAULT=new st,Yn.internal=!1),this==Yn.InertiaMode_DEFAULT?"DEFAULT":(null==Yn.InertiaMode_FIXED&&(Yn.internal=!0,Yn.InertiaMode_FIXED=new st,Yn.internal=!1),this==Yn.InertiaMode_FIXED?"FIXED":"")},Object.defineProperty(st,"DEFAULT",{get:st.get_DEFAULT}),Object.defineProperty(st,"FIXED",{get:st.get_FIXED}),st.prototype.__class__=st;var ee=nape.phys.InteractorIterator=function(){this.zpp_next=null,this.zpp_critical=!1,this.zpp_i=0,this.zpp_inner=null};ee.__name__=["nape","phys","InteractorIterator"],ee.get=function(t){var e,i=null==ee.zpp_pool?(Sn.internal=!0,e=new ee,Sn.internal=!1,e):(ee.zpp_pool=(i=ee.zpp_pool).zpp_next,i);return i.zpp_i=0,i.zpp_inner=t,i.zpp_critical=!1,i},ee.prototype.zpp_inner=null,ee.prototype.zpp_i=null,ee.prototype.zpp_critical=null,ee.prototype.zpp_next=null,ee.prototype.hasNext=function(){this.zpp_inner.zpp_inner.valmod();var t=this.zpp_inner;t.zpp_inner.valmod(),t.zpp_inner.zip_length&&(t.zpp_inner.zip_length=!1,t.zpp_inner.user_length=t.zpp_inner.inner.length);t=t.zpp_inner.user_length;return this.zpp_critical=!0,this.zpp_i<t||(this.zpp_next=ee.zpp_pool,(ee.zpp_pool=this).zpp_inner=null,!1)},ee.prototype.next=function(){return this.zpp_critical=!1,this.zpp_inner.at(this.zpp_i++)},ee.prototype.__class__=ee;var at=nape.phys.InteractorList=function(){this.zpp_inner=null,this.zpp_inner=new Sn,this.zpp_inner.outer=this};at.__name__=["nape","phys","InteractorList"],at.fromArray=function(t){for(var e=new at,i=0;i<t.length;){var n=t[i];++i,e.push(n)}return e},at.prototype.zpp_inner=null,at.prototype.get_length=function(){return this.zpp_inner.valmod(),this.zpp_inner.zip_length&&(this.zpp_inner.zip_length=!1,this.zpp_inner.user_length=this.zpp_inner.inner.length),this.zpp_inner.user_length},at.prototype.has=function(t){return this.zpp_inner.valmod(),this.zpp_inner.inner.has(t.zpp_inner_i)},at.prototype.at=function(t){if(this.zpp_inner.valmod(),this.zpp_inner.reverse_flag&&(this.zpp_inner.valmod(),this.zpp_inner.zip_length&&(this.zpp_inner.zip_length=!1,this.zpp_inner.user_length=this.zpp_inner.inner.length),t=this.zpp_inner.user_length-1-t),t<this.zpp_inner.at_index||null==this.zpp_inner.at_ite)this.zpp_inner.at_index=t,this.zpp_inner.at_ite=this.zpp_inner.inner.iterator_at(t);else for(;this.zpp_inner.at_index!=t;)this.zpp_inner.at_index++,this.zpp_inner.at_ite=this.zpp_inner.at_ite.next;return this.zpp_inner.at_ite.elt.outer_i},at.prototype.push=function(t){this.zpp_inner.modify_test(),this.zpp_inner.valmod();var e,i=null==this.zpp_inner.adder||this.zpp_inner.adder(t);return i&&(this.zpp_inner.reverse_flag?this.zpp_inner.inner.add(t.zpp_inner_i):(null==this.zpp_inner.push_ite&&(e=null==this.zpp_inner.inner.head?null:(this.zpp_inner.valmod(),this.zpp_inner.zip_length&&(this.zpp_inner.zip_length=!1,this.zpp_inner.user_length=this.zpp_inner.inner.length),this.zpp_inner.inner.iterator_at(this.zpp_inner.user_length-1)),this.zpp_inner.push_ite=e),this.zpp_inner.push_ite=this.zpp_inner.inner.insert(this.zpp_inner.push_ite,t.zpp_inner_i)),this.zpp_inner.invalidate(),null!=this.zpp_inner.post_adder&&this.zpp_inner.post_adder(t)),i},at.prototype.unshift=function(t){this.zpp_inner.modify_test(),this.zpp_inner.valmod();var e,i=null==this.zpp_inner.adder||this.zpp_inner.adder(t);return i&&(this.zpp_inner.reverse_flag?(null==this.zpp_inner.push_ite&&(e=null==this.zpp_inner.inner.head?null:(this.zpp_inner.valmod(),this.zpp_inner.zip_length&&(this.zpp_inner.zip_length=!1,this.zpp_inner.user_length=this.zpp_inner.inner.length),this.zpp_inner.inner.iterator_at(this.zpp_inner.user_length-1)),this.zpp_inner.push_ite=e),this.zpp_inner.push_ite=this.zpp_inner.inner.insert(this.zpp_inner.push_ite,t.zpp_inner_i)):this.zpp_inner.inner.add(t.zpp_inner_i),this.zpp_inner.invalidate(),null!=this.zpp_inner.post_adder&&this.zpp_inner.post_adder(t)),i},at.prototype.pop=function(){this.zpp_inner.modify_test(),this.zpp_inner.valmod();var t,e,i=null;return this.zpp_inner.reverse_flag?(e=(i=this.zpp_inner.inner.head.elt).outer_i,null!=this.zpp_inner.subber&&this.zpp_inner.subber(e),this.zpp_inner.dontremove||this.zpp_inner.inner.pop()):(null!=this.zpp_inner.at_ite&&null==this.zpp_inner.at_ite.next&&(this.zpp_inner.at_ite=null),this.zpp_inner.valmod(),this.zpp_inner.zip_length&&(this.zpp_inner.zip_length=!1,this.zpp_inner.user_length=this.zpp_inner.inner.length),e=(i=(null==(t=1==this.zpp_inner.user_length?null:(this.zpp_inner.valmod(),this.zpp_inner.zip_length&&(this.zpp_inner.zip_length=!1,this.zpp_inner.user_length=this.zpp_inner.inner.length),this.zpp_inner.inner.iterator_at(this.zpp_inner.user_length-2)))?this.zpp_inner.inner.head:t.next).elt).outer_i,null!=this.zpp_inner.subber&&this.zpp_inner.subber(e),this.zpp_inner.dontremove||this.zpp_inner.inner.erase(t)),this.zpp_inner.invalidate(),i.outer_i},at.prototype.shift=function(){this.zpp_inner.modify_test(),this.zpp_inner.valmod();var t,e,i=null;return this.zpp_inner.reverse_flag?(null!=this.zpp_inner.at_ite&&null==this.zpp_inner.at_ite.next&&(this.zpp_inner.at_ite=null),this.zpp_inner.valmod(),this.zpp_inner.zip_length&&(this.zpp_inner.zip_length=!1,this.zpp_inner.user_length=this.zpp_inner.inner.length),t=(i=(null==(e=1==this.zpp_inner.user_length?null:(this.zpp_inner.valmod(),this.zpp_inner.zip_length&&(this.zpp_inner.zip_length=!1,this.zpp_inner.user_length=this.zpp_inner.inner.length),this.zpp_inner.inner.iterator_at(this.zpp_inner.user_length-2)))?this.zpp_inner.inner.head:e.next).elt).outer_i,null!=this.zpp_inner.subber&&this.zpp_inner.subber(t),this.zpp_inner.dontremove||this.zpp_inner.inner.erase(e)):(e=(i=this.zpp_inner.inner.head.elt).outer_i,null!=this.zpp_inner.subber&&this.zpp_inner.subber(e),this.zpp_inner.dontremove||this.zpp_inner.inner.pop()),this.zpp_inner.invalidate(),i.outer_i},at.prototype.add=function(t){return this.zpp_inner.reverse_flag?this.push(t):this.unshift(t)},at.prototype.remove=function(t){this.zpp_inner.modify_test(),this.zpp_inner.valmod();for(var e=!1,i=this.zpp_inner.inner.head;null!=i;){if(i.elt==t.zpp_inner_i){e=!0;break}i=i.next}return e&&(null!=this.zpp_inner.subber&&this.zpp_inner.subber(t),this.zpp_inner.dontremove||this.zpp_inner.inner.remove(t.zpp_inner_i),this.zpp_inner.invalidate()),e},at.prototype.clear=function(){if(this.zpp_inner.reverse_flag)for(;null!=this.zpp_inner.inner.head;)this.pop();else for(;null!=this.zpp_inner.inner.head;)this.shift()},at.prototype.empty=function(){return null==this.zpp_inner.inner.head},at.prototype.iterator=function(){return this.zpp_inner.valmod(),ee.get(this)},at.prototype.copy=function(t){null==t&&(t=!1);var e=new at;this.zpp_inner.valmod();for(var i=ee.get(this);;){i.zpp_inner.zpp_inner.valmod();var n=i.zpp_inner;n.zpp_inner.valmod(),n.zpp_inner.zip_length&&(n.zpp_inner.zip_length=!1,n.zpp_inner.user_length=n.zpp_inner.inner.length);n=n.zpp_inner.user_length;if(i.zpp_critical=!0,!(i.zpp_i<n||(i.zpp_next=ee.zpp_pool,(ee.zpp_pool=i).zpp_inner=null,!1)))break;i.zpp_critical=!1;n=i.zpp_inner.at(i.zpp_i++);e.push(t?null:n)}return e},at.prototype.merge=function(t){t.zpp_inner.valmod();for(var e=ee.get(t);;){e.zpp_inner.zpp_inner.valmod();var i=e.zpp_inner;i.zpp_inner.valmod(),i.zpp_inner.zip_length&&(i.zpp_inner.zip_length=!1,i.zpp_inner.user_length=i.zpp_inner.inner.length);i=i.zpp_inner.user_length;if(e.zpp_critical=!0,!(e.zpp_i<i||(e.zpp_next=ee.zpp_pool,(ee.zpp_pool=e).zpp_inner=null,!1)))break;e.zpp_critical=!1;i=e.zpp_inner.at(e.zpp_i++);this.has(i)||(this.zpp_inner.reverse_flag?this.push(i):this.unshift(i))}},at.prototype.toString=function(){var t="[",e=!0;this.zpp_inner.valmod();for(var i=ee.get(this);;){i.zpp_inner.zpp_inner.valmod();var n=i.zpp_inner;n.zpp_inner.valmod(),n.zpp_inner.zip_length&&(n.zpp_inner.zip_length=!1,n.zpp_inner.user_length=n.zpp_inner.inner.length);n=n.zpp_inner.user_length;if(i.zpp_critical=!0,!(i.zpp_i<n||(i.zpp_next=ee.zpp_pool,(ee.zpp_pool=i).zpp_inner=null,!1)))break;i.zpp_critical=!1;n=i.zpp_inner.at(i.zpp_i++);e||(t+=","),t+=null==n?"NULL":n.toString(),e=!1}return t+"]"},at.prototype.foreach=function(t){this.zpp_inner.valmod();for(var e=ee.get(this);;){e.zpp_inner.zpp_inner.valmod();var i=e.zpp_inner;i.zpp_inner.valmod(),i.zpp_inner.zip_length&&(i.zpp_inner.zip_length=!1,i.zpp_inner.user_length=i.zpp_inner.inner.length);i=i.zpp_inner.user_length;if(e.zpp_critical=!0,!(e.zpp_i<i||(e.zpp_next=ee.zpp_pool,(ee.zpp_pool=e).zpp_inner=null,!1)))break;try{e.zpp_critical=!1,t(e.zpp_inner.at(e.zpp_i++))}catch(t){e.zpp_next=ee.zpp_pool,(ee.zpp_pool=e).zpp_inner=null;break}}return this},at.prototype.filter=function(t){for(var e=0;;){if(this.zpp_inner.valmod(),this.zpp_inner.zip_length&&(this.zpp_inner.zip_length=!1,this.zpp_inner.user_length=this.zpp_inner.inner.length),!(e<this.zpp_inner.user_length))break;var i=this.at(e);try{t(i)?++e:this.remove(i)}catch(t){break}}return this},Object.defineProperty(at.prototype,"length",{get:at.prototype.get_length}),at.prototype.__class__=at;var ht=nape.phys.MassMode=function(){};ht.__name__=["nape","phys","MassMode"],ht.DEFAULT=null,ht.get_DEFAULT=function(){return null==Yn.MassMode_DEFAULT&&(Yn.internal=!0,Yn.MassMode_DEFAULT=new ht,Yn.internal=!1),Yn.MassMode_DEFAULT},ht.FIXED=null,ht.get_FIXED=function(){return null==Yn.MassMode_FIXED&&(Yn.internal=!0,Yn.MassMode_FIXED=new ht,Yn.internal=!1),Yn.MassMode_FIXED},ht.prototype.toString=function(){return null==Yn.MassMode_DEFAULT&&(Yn.internal=!0,Yn.MassMode_DEFAULT=new ht,Yn.internal=!1),this==Yn.MassMode_DEFAULT?"DEFAULT":(null==Yn.MassMode_FIXED&&(Yn.internal=!0,Yn.MassMode_FIXED=new ht,Yn.internal=!1),this==Yn.MassMode_FIXED?"FIXED":"")},Object.defineProperty(ht,"DEFAULT",{get:ht.get_DEFAULT}),Object.defineProperty(ht,"FIXED",{get:ht.get_FIXED}),ht.prototype.__class__=ht;var lt=nape.phys.Material=function(t,e,i,n,r){null==r&&(r=.001),null==n&&(n=1),null==i&&(i=2),null==e&&(e=1),null==t&&(t=0),(this.zpp_inner=null)==Ue.zpp_pool?this.zpp_inner=new Ue:(this.zpp_inner=Ue.zpp_pool,Ue.zpp_pool=this.zpp_inner.next,this.zpp_inner.next=null),t!=(this.zpp_inner.outer=this).zpp_inner.elasticity&&(this.zpp_inner.elasticity=+t,this.zpp_inner.invalidate(Ue.WAKE|Ue.ARBITERS)),e!=this.zpp_inner.dynamicFriction&&(this.zpp_inner.dynamicFriction=+e,this.zpp_inner.invalidate(Ue.WAKE|Ue.ANGDRAG|Ue.ARBITERS)),i!=this.zpp_inner.staticFriction&&(this.zpp_inner.staticFriction=+i,this.zpp_inner.invalidate(Ue.WAKE|Ue.ARBITERS)),n!=1e3*this.zpp_inner.density&&(this.zpp_inner.density=n/1e3,this.zpp_inner.invalidate(Ue.WAKE|Ue.PROPS)),r!=this.zpp_inner.rollingFriction&&(this.zpp_inner.rollingFriction=+r,this.zpp_inner.invalidate(Ue.WAKE|Ue.ARBITERS))};lt.__name__=["nape","phys","Material"],lt.wood=function(){return new lt(.4,.2,.38,.7,.005)},lt.steel=function(){return new lt(.2,.57,.74,7.8,.001)},lt.ice=function(){return new lt(.3,.03,.1,.9,1e-4)},lt.rubber=function(){return new lt(.8,1,1.4,1.5,.01)},lt.glass=function(){return new lt(.4,.4,.94,2.6,.002)},lt.sand=function(){return new lt(-1,.45,.6,1.6,16)},lt.prototype.zpp_inner=null,lt.prototype.get_userData=function(){return null==this.zpp_inner.userData&&(this.zpp_inner.userData={}),this.zpp_inner.userData},lt.prototype.get_shapes=function(){return null==this.zpp_inner.wrap_shapes&&(this.zpp_inner.wrap_shapes=In.get(this.zpp_inner.shapes,!0)),this.zpp_inner.wrap_shapes},lt.prototype.copy=function(){var t=new lt(this.zpp_inner.elasticity,this.zpp_inner.dynamicFriction,this.zpp_inner.staticFriction,1e3*this.zpp_inner.density,this.zpp_inner.rollingFriction);return null!=this.zpp_inner.userData&&(t.zpp_inner.userData=h.copy(this.zpp_inner.userData)),t},lt.prototype.get_elasticity=function(){return this.zpp_inner.elasticity},lt.prototype.set_elasticity=function(t){return t!=this.zpp_inner.elasticity&&(this.zpp_inner.elasticity=+t,this.zpp_inner.invalidate(Ue.WAKE|Ue.ARBITERS)),this.zpp_inner.elasticity},lt.prototype.get_dynamicFriction=function(){return this.zpp_inner.dynamicFriction},lt.prototype.set_dynamicFriction=function(t){return t!=this.zpp_inner.dynamicFriction&&(this.zpp_inner.dynamicFriction=+t,this.zpp_inner.invalidate(Ue.WAKE|Ue.ANGDRAG|Ue.ARBITERS)),this.zpp_inner.dynamicFriction},lt.prototype.get_staticFriction=function(){return this.zpp_inner.staticFriction},lt.prototype.set_staticFriction=function(t){return t!=this.zpp_inner.staticFriction&&(this.zpp_inner.staticFriction=+t,this.zpp_inner.invalidate(Ue.WAKE|Ue.ARBITERS)),this.zpp_inner.staticFriction},lt.prototype.get_density=function(){return 1e3*this.zpp_inner.density},lt.prototype.set_density=function(t){return t!=1e3*this.zpp_inner.density&&(this.zpp_inner.density=t/1e3,this.zpp_inner.invalidate(Ue.WAKE|Ue.PROPS)),1e3*this.zpp_inner.density},lt.prototype.get_rollingFriction=function(){return this.zpp_inner.rollingFriction},lt.prototype.set_rollingFriction=function(t){return t!=this.zpp_inner.rollingFriction&&(this.zpp_inner.rollingFriction=+t,this.zpp_inner.invalidate(Ue.WAKE|Ue.ARBITERS)),this.zpp_inner.rollingFriction},lt.prototype.toString=function(){return"{ elasticity: "+this.zpp_inner.elasticity+" dynamicFriction: "+this.zpp_inner.dynamicFriction+" staticFriction: "+this.zpp_inner.staticFriction+" density: "+1e3*this.zpp_inner.density+" rollingFriction: "+this.zpp_inner.rollingFriction+" }"},Object.defineProperty(lt.prototype,"userData",{get:lt.prototype.get_userData}),Object.defineProperty(lt.prototype,"shapes",{get:lt.prototype.get_shapes}),Object.defineProperty(lt.prototype,"elasticity",{get:lt.prototype.get_elasticity,set:lt.prototype.set_elasticity}),Object.defineProperty(lt.prototype,"dynamicFriction",{get:lt.prototype.get_dynamicFriction,set:lt.prototype.set_dynamicFriction}),Object.defineProperty(lt.prototype,"staticFriction",{get:lt.prototype.get_staticFriction,set:lt.prototype.set_staticFriction}),Object.defineProperty(lt.prototype,"density",{get:lt.prototype.get_density,set:lt.prototype.set_density}),Object.defineProperty(lt.prototype,"rollingFriction",{get:lt.prototype.get_rollingFriction,set:lt.prototype.set_rollingFriction}),lt.prototype.__class__=lt;var pt=nape.shape.Shape=function(){this.zpp_inner=null,Q.call(this)};pt.__name__=["nape","shape","Shape"],pt.__super__=Q,(pt.prototype=Object.create(Q.prototype)).zpp_inner=null,pt.prototype.get_type=function(){return Ve.types[this.zpp_inner.type]},pt.prototype.isCircle=function(){return 0==this.zpp_inner.type},pt.prototype.isPolygon=function(){return 1==this.zpp_inner.type},pt.prototype.get_body=function(){return null!=this.zpp_inner.body?this.zpp_inner.body.outer:null},pt.prototype.set_body=function(t){return this.zpp_inner.immutable_midstep("Shape::body"),(null!=this.zpp_inner.body?this.zpp_inner.body.outer:null)!=t&&(null!=this.zpp_inner.body&&(null!=this.zpp_inner.body?this.zpp_inner.body.outer:null).zpp_inner.wrap_shapes.remove(this),null!=t&&((t=t.zpp_inner.wrap_shapes).zpp_inner.reverse_flag?t.push(this):t.unshift(this))),null!=this.zpp_inner.body?this.zpp_inner.body.outer:null},pt.prototype.get_castCircle=function(){return 0==this.zpp_inner.type?this.zpp_inner.circle.outer_zn:null},pt.prototype.get_castPolygon=function(){return 1==this.zpp_inner.type?this.zpp_inner.polygon.outer_zn:null},pt.prototype.get_worldCOM=function(){var t,e,i,n;return null==this.zpp_inner.wrap_worldCOM&&(t=this.zpp_inner.worldCOMx,n=this.zpp_inner.worldCOMy,null==Bn.poolVec2?e=new St:(e=Bn.poolVec2,Bn.poolVec2=e.zpp_pool,e.zpp_pool=null),null==e.zpp_inner?(null==Gr.zpp_pool?i=new Gr:(i=Gr.zpp_pool,Gr.zpp_pool=i.next,i.next=null),i.weak=!1,i._immutable=!1,i.x=t,i.y=n,e.zpp_inner=i,e.zpp_inner.outer=e):(null!=(i=e.zpp_inner)._validate&&i._validate(),e.zpp_inner.x==t&&(null!=(i=e.zpp_inner)._validate&&i._validate(),e.zpp_inner.y==n)||(e.zpp_inner.x=t,e.zpp_inner.y=n,null!=(n=e.zpp_inner)._invalidate&&n._invalidate(n))),e.zpp_inner.weak=!1,this.zpp_inner.wrap_worldCOM=e,this.zpp_inner.wrap_worldCOM.zpp_inner._inuse=!0,this.zpp_inner.wrap_worldCOM.zpp_inner._immutable=!0,this.zpp_inner.wrap_worldCOM.zpp_inner._validate=Z(a=this.zpp_inner,a.getworldCOM)),this.zpp_inner.wrap_worldCOM},pt.prototype.get_localCOM=function(){return null==this.zpp_inner.wrap_localCOM&&(0==this.zpp_inner.type?this.zpp_inner.circle:this.zpp_inner.polygon).setupLocalCOM(),this.zpp_inner.wrap_localCOM},pt.prototype.set_localCOM=function(t){this.zpp_inner.immutable_midstep("Body::localCOM"),null==this.zpp_inner.wrap_localCOM&&(0==this.zpp_inner.type?this.zpp_inner.circle:this.zpp_inner.polygon).setupLocalCOM();var e=this.zpp_inner.wrap_localCOM,i=t.zpp_inner;null!=i._validate&&i._validate();var n=t.zpp_inner.x,r=t.zpp_inner;null!=r._validate&&r._validate();var o,i=t.zpp_inner.y,r=e.zpp_inner;return null!=r._validate&&r._validate(),e.zpp_inner.x==n&&(null!=(r=e.zpp_inner)._validate&&r._validate(),e.zpp_inner.y==i)||(e.zpp_inner.x=n,e.zpp_inner.y=i,null!=(o=e.zpp_inner)._invalidate&&o._invalidate(o)),t.zpp_inner.weak&&(o=t.zpp_inner,t.zpp_inner.outer=null,t.zpp_inner=null,t.zpp_pool=Bn.poolVec2,Bn.poolVec2=t,null!=o.outer&&(o.outer.zpp_inner=null,o.outer=null),o._isimmutable=null,o._validate=null,o._invalidate=null,o.next=Gr.zpp_pool,Gr.zpp_pool=o),null==this.zpp_inner.wrap_localCOM&&(0==this.zpp_inner.type?this.zpp_inner.circle:this.zpp_inner.polygon).setupLocalCOM(),this.zpp_inner.wrap_localCOM},pt.prototype.get_area=function(){return this.zpp_inner.validate_area_inertia(),this.zpp_inner.area},pt.prototype.get_inertia=function(){return this.zpp_inner.validate_area_inertia(),this.zpp_inner.inertia},pt.prototype.get_angDrag=function(){return this.zpp_inner.validate_angDrag(),this.zpp_inner.angDrag},pt.prototype.get_material=function(){return this.zpp_inner.material.wrapper()},pt.prototype.set_material=function(t){return this.zpp_inner.immutable_midstep("Shape::material"),this.zpp_inner.setMaterial(t.zpp_inner),this.zpp_inner.material.wrapper()},pt.prototype.get_filter=function(){return this.zpp_inner.filter.wrapper()},pt.prototype.set_filter=function(t){return this.zpp_inner.immutable_midstep("Shape::filter"),this.zpp_inner.setFilter(t.zpp_inner),this.zpp_inner.filter.wrapper()},pt.prototype.get_fluidProperties=function(){return this.zpp_inner.immutable_midstep("Shape::fluidProperties"),null==this.zpp_inner.fluidProperties&&this.zpp_inner.setFluid((new rt).zpp_inner),this.zpp_inner.fluidProperties.wrapper()},pt.prototype.set_fluidProperties=function(t){return this.zpp_inner.setFluid(t.zpp_inner),this.zpp_inner.immutable_midstep("Shape::fluidProperties"),null==this.zpp_inner.fluidProperties&&this.zpp_inner.setFluid((new rt).zpp_inner),this.zpp_inner.fluidProperties.wrapper()},pt.prototype.get_fluidEnabled=function(){return this.zpp_inner.fluidEnabled},pt.prototype.set_fluidEnabled=function(t){return this.zpp_inner.immutable_midstep("Shape::fluidEnabled"),(this.zpp_inner.fluidEnabled=t)&&null==this.zpp_inner.fluidProperties&&(this.zpp_inner.setFluid((new rt).zpp_inner),this.zpp_inner.immutable_midstep("Shape::fluidProperties"),null==this.zpp_inner.fluidProperties&&this.zpp_inner.setFluid((new rt).zpp_inner),this.zpp_inner.fluidProperties.wrapper()),this.zpp_inner.wake(),this.zpp_inner.fluidEnabled},pt.prototype.get_sensorEnabled=function(){return this.zpp_inner.sensorEnabled},pt.prototype.set_sensorEnabled=function(t){return this.zpp_inner.immutable_midstep("Shape::sensorEnabled"),this.zpp_inner.sensorEnabled=t,this.zpp_inner.wake(),this.zpp_inner.sensorEnabled},pt.prototype.get_bounds=function(){return this.zpp_inner.aabb.wrapper()},pt.prototype.translate=function(t){var e,i,n;return this.zpp_inner.immutable_midstep("Shape::translate()"),0<t.lsq()&&(0==this.zpp_inner.type?(null!=(e=t.zpp_inner)._validate&&e._validate(),i=t.zpp_inner.x,null!=(e=t.zpp_inner)._validate&&e._validate(),this.zpp_inner.circle.__translate(i,t.zpp_inner.y)):(null!=(i=t.zpp_inner)._validate&&i._validate(),n=t.zpp_inner.x,null!=(i=t.zpp_inner)._validate&&i._validate(),this.zpp_inner.polygon.__translate(n,t.zpp_inner.y))),t.zpp_inner.weak&&(n=t.zpp_inner,t.zpp_inner.outer=null,t.zpp_inner=null,t.zpp_pool=Bn.poolVec2,Bn.poolVec2=t,null!=n.outer&&(n.outer.zpp_inner=null,n.outer=null),n._isimmutable=null,n._validate=null,n._invalidate=null,n.next=Gr.zpp_pool,Gr.zpp_pool=n),this},pt.prototype.scale=function(t,e){var i;return this.zpp_inner.immutable_midstep("Shape::scale()"),0==this.zpp_inner.type?(i=t*t-e*e)*i<Er.epsilon*Er.epsilon&&this.zpp_inner.circle.__scale(t,e):this.zpp_inner.polygon.__scale(t,e),this},pt.prototype.rotate=function(t){var e;return this.zpp_inner.immutable_midstep("Shape::rotate()"),t%(2*Math.PI)!=0&&(e=Math.cos(t),t=Math.sin(t),(0==this.zpp_inner.type?this.zpp_inner.circle:this.zpp_inner.polygon).__rotate(t,e)),this},pt.prototype.transform=function(t){return this.zpp_inner.immutable_midstep("Shape::transform()"),0==this.zpp_inner.type?t.equiorthogonal()&&this.zpp_inner.circle.__transform(t):this.zpp_inner.polygon.__transform(t),this},pt.prototype.contains=function(t){ye.validateShape(this.zpp_inner);var e=t.zpp_inner;null!=e._validate&&e._validate();var i=Ir.shapeContains(this.zpp_inner,t.zpp_inner);return t.zpp_inner.weak&&(e=t.zpp_inner,t.zpp_inner.outer=null,t.zpp_inner=null,t.zpp_pool=Bn.poolVec2,Bn.poolVec2=t,null!=e.outer&&(e.outer.zpp_inner=null,e.outer=null),e._isimmutable=null,e._validate=null,e._invalidate=null,e.next=Gr.zpp_pool,Gr.zpp_pool=e),i},pt.prototype.copy=function(){return this.zpp_inner.copy()},pt.prototype.toString=function(){return(0==this.zpp_inner.type?"Circle":"Polygon")+"#"+this.zpp_inner_i.id},Object.defineProperty(pt.prototype,"type",{get:pt.prototype.get_type}),Object.defineProperty(pt.prototype,"body",{get:pt.prototype.get_body,set:pt.prototype.set_body}),Object.defineProperty(pt.prototype,"castCircle",{get:pt.prototype.get_castCircle}),Object.defineProperty(pt.prototype,"castPolygon",{get:pt.prototype.get_castPolygon}),Object.defineProperty(pt.prototype,"worldCOM",{get:pt.prototype.get_worldCOM}),Object.defineProperty(pt.prototype,"localCOM",{get:pt.prototype.get_localCOM,set:pt.prototype.set_localCOM}),Object.defineProperty(pt.prototype,"area",{get:pt.prototype.get_area}),Object.defineProperty(pt.prototype,"inertia",{get:pt.prototype.get_inertia}),Object.defineProperty(pt.prototype,"angDrag",{get:pt.prototype.get_angDrag}),Object.defineProperty(pt.prototype,"material",{get:pt.prototype.get_material,set:pt.prototype.set_material}),Object.defineProperty(pt.prototype,"filter",{get:pt.prototype.get_filter,set:pt.prototype.set_filter}),Object.defineProperty(pt.prototype,"fluidProperties",{get:pt.prototype.get_fluidProperties,set:pt.prototype.set_fluidProperties}),Object.defineProperty(pt.prototype,"fluidEnabled",{get:pt.prototype.get_fluidEnabled,set:pt.prototype.set_fluidEnabled}),Object.defineProperty(pt.prototype,"sensorEnabled",{get:pt.prototype.get_sensorEnabled,set:pt.prototype.set_sensorEnabled}),Object.defineProperty(pt.prototype,"bounds",{get:pt.prototype.get_bounds}),pt.prototype.__class__=pt;var ut=nape.shape.Circle=function(t,e,i,n){this.zpp_inner_zn=null,pt.call(this),this.zpp_inner_zn=new We,((this.zpp_inner_zn.outer=this).zpp_inner_zn.outer_zn=this).zpp_inner=this.zpp_inner_zn,this.zpp_inner_i=this.zpp_inner,(this.zpp_inner_i.outer_i=this).zpp_inner.immutable_midstep("Circle::radius"),t!=this.zpp_inner_zn.radius&&(this.zpp_inner_zn.radius=t,this.zpp_inner_zn.invalidate_radius()),null==e?(this.zpp_inner.localCOMx=0,this.zpp_inner.localCOMy=0):(null!=(t=e.zpp_inner)._validate&&t._validate(),this.zpp_inner.localCOMx=e.zpp_inner.x,null!=(t=e.zpp_inner)._validate&&t._validate(),this.zpp_inner.localCOMy=e.zpp_inner.y,e.zpp_inner.weak&&(t=e.zpp_inner,e.zpp_inner.outer=null,e.zpp_inner=null,e.zpp_pool=Bn.poolVec2,Bn.poolVec2=e,null!=t.outer&&(t.outer.zpp_inner=null,t.outer=null),t._isimmutable=null,t._validate=null,t._invalidate=null,t.next=Gr.zpp_pool,Gr.zpp_pool=t)),null==i?null==Ue.zpp_pool?this.zpp_inner.material=new Ue:(this.zpp_inner.material=Ue.zpp_pool,Ue.zpp_pool=this.zpp_inner.material.next,this.zpp_inner.material.next=null):(this.zpp_inner.immutable_midstep("Shape::material"),this.zpp_inner.setMaterial(i.zpp_inner),this.zpp_inner.material.wrapper()),null==n?null==he.zpp_pool?this.zpp_inner.filter=new he:(this.zpp_inner.filter=he.zpp_pool,he.zpp_pool=this.zpp_inner.filter.next,this.zpp_inner.filter.next=null):(this.zpp_inner.immutable_midstep("Shape::filter"),this.zpp_inner.setFilter(n.zpp_inner),this.zpp_inner.filter.wrapper()),this.zpp_inner_i.insert_cbtype(Tt.ANY_SHAPE.zpp_inner)};ut.__name__=["nape","shape","Circle"],ut.__super__=pt,(ut.prototype=Object.create(pt.prototype)).zpp_inner_zn=null,ut.prototype.get_radius=function(){return this.zpp_inner_zn.radius},ut.prototype.set_radius=function(t){return this.zpp_inner.immutable_midstep("Circle::radius"),t!=this.zpp_inner_zn.radius&&(this.zpp_inner_zn.radius=t,this.zpp_inner_zn.invalidate_radius()),this.zpp_inner_zn.radius},Object.defineProperty(ut.prototype,"radius",{get:ut.prototype.get_radius,set:ut.prototype.set_radius}),ut.prototype.__class__=ut;var dt=nape.shape.Edge=function(){this.zpp_inner=null};dt.__name__=["nape","shape","Edge"],dt.prototype.zpp_inner=null,dt.prototype.get_polygon=function(){return this.zpp_inner.polygon.outer_zn},dt.prototype.get_localNormal=function(){return null==this.zpp_inner.wrap_lnorm&&this.zpp_inner.getlnorm(),this.zpp_inner.wrap_lnorm},dt.prototype.get_worldNormal=function(){return null==this.zpp_inner.wrap_gnorm&&this.zpp_inner.getgnorm(),this.zpp_inner.wrap_gnorm},dt.prototype.get_length=function(){return this.zpp_inner.polygon.validate_laxi(),this.zpp_inner.length},dt.prototype.get_localProjection=function(){return this.zpp_inner.polygon.validate_laxi(),this.zpp_inner.lprojection},dt.prototype.get_worldProjection=function(){var t=this.zpp_inner.polygon;if(t.zip_gaxi&&null!=t.body){t.zip_gaxi=!1,t.validate_laxi();var e=t.body;if(e.zip_axis&&(e.zip_axis=!1,e.axisx=Math.sin(e.rot),e.axisy=Math.cos(e.rot)),t.zip_gverts&&null!=t.body){t.zip_gverts=!1,t.validate_lverts();var i=t.body;i.zip_axis&&(i.zip_axis=!1,i.axisx=Math.sin(i.rot),i.axisy=Math.cos(i.rot));for(var n=t.lverts.next,r=t.gverts.next;null!=r;){var o=r,s=n,n=n.next;o.x=t.body.posx+(t.body.axisy*s.x-t.body.axisx*s.y),o.y=t.body.posy+(s.x*t.body.axisx+s.y*t.body.axisy),r=r.next}}for(var a=t.edges.head,h=l=t.gverts.next,l=l.next;null!=l;){var p=l,u=a.elt,a=a.next;u.gp0=h,u.gp1=p,u.gnormx=t.body.axisy*u.lnormx-t.body.axisx*u.lnormy,u.gnormy=u.lnormx*t.body.axisx+u.lnormy*t.body.axisy,u.gprojection=t.body.posx*u.gnormx+t.body.posy*u.gnormy+u.lprojection,null!=u.wrap_gnorm&&(u.wrap_gnorm.zpp_inner.x=u.gnormx,u.wrap_gnorm.zpp_inner.y=u.gnormy),u.tp0=u.gp0.y*u.gnormx-u.gp0.x*u.gnormy,u.tp1=u.gp1.y*u.gnormx-u.gp1.x*u.gnormy,h=p,l=l.next}i=a.elt;i.gp0=h,i.gp1=t.gverts.next,i.gnormx=t.body.axisy*i.lnormx-t.body.axisx*i.lnormy,i.gnormy=i.lnormx*t.body.axisx+i.lnormy*t.body.axisy,i.gprojection=t.body.posx*i.gnormx+t.body.posy*i.gnormy+i.lprojection,null!=i.wrap_gnorm&&(i.wrap_gnorm.zpp_inner.x=i.gnormx,i.wrap_gnorm.zpp_inner.y=i.gnormy),i.tp0=i.gp0.y*i.gnormx-i.gp0.x*i.gnormy,i.tp1=i.gp1.y*i.gnormx-i.gp1.x*i.gnormy}return this.zpp_inner.gprojection},dt.prototype.get_localVertex1=function(){this.zpp_inner.polygon.validate_laxi();var t,e=this.zpp_inner.lp0;return null==e.outer&&(e.outer=new St,null!=(t=e.outer.zpp_inner).outer&&(t.outer.zpp_inner=null,t.outer=null),t._isimmutable=null,t._validate=null,t._invalidate=null,t.next=Gr.zpp_pool,Gr.zpp_pool=t,e.outer.zpp_inner=e),e.outer},dt.prototype.get_localVertex2=function(){this.zpp_inner.polygon.validate_laxi();var t,e=this.zpp_inner.lp1;return null==e.outer&&(e.outer=new St,null!=(t=e.outer.zpp_inner).outer&&(t.outer.zpp_inner=null,t.outer=null),t._isimmutable=null,t._validate=null,t._invalidate=null,t.next=Gr.zpp_pool,Gr.zpp_pool=t,e.outer.zpp_inner=e),e.outer},dt.prototype.get_worldVertex1=function(){var t=this.zpp_inner.polygon;if(t.zip_gaxi&&null!=t.body){t.zip_gaxi=!1,t.validate_laxi();var e=t.body;if(e.zip_axis&&(e.zip_axis=!1,e.axisx=Math.sin(e.rot),e.axisy=Math.cos(e.rot)),t.zip_gverts&&null!=t.body){t.zip_gverts=!1,t.validate_lverts();var i=t.body;i.zip_axis&&(i.zip_axis=!1,i.axisx=Math.sin(i.rot),i.axisy=Math.cos(i.rot));for(var n=t.lverts.next,r=t.gverts.next;null!=r;){var o=r,s=n,n=n.next;o.x=t.body.posx+(t.body.axisy*s.x-t.body.axisx*s.y),o.y=t.body.posy+(s.x*t.body.axisx+s.y*t.body.axisy),r=r.next}}for(var a=t.edges.head,h=l=t.gverts.next,l=l.next;null!=l;){var p=l,u=a.elt,a=a.next;u.gp0=h,u.gp1=p,u.gnormx=t.body.axisy*u.lnormx-t.body.axisx*u.lnormy,u.gnormy=u.lnormx*t.body.axisx+u.lnormy*t.body.axisy,u.gprojection=t.body.posx*u.gnormx+t.body.posy*u.gnormy+u.lprojection,null!=u.wrap_gnorm&&(u.wrap_gnorm.zpp_inner.x=u.gnormx,u.wrap_gnorm.zpp_inner.y=u.gnormy),u.tp0=u.gp0.y*u.gnormx-u.gp0.x*u.gnormy,u.tp1=u.gp1.y*u.gnormx-u.gp1.x*u.gnormy,h=p,l=l.next}e=a.elt;e.gp0=h,e.gp1=t.gverts.next,e.gnormx=t.body.axisy*e.lnormx-t.body.axisx*e.lnormy,e.gnormy=e.lnormx*t.body.axisx+e.lnormy*t.body.axisy,e.gprojection=t.body.posx*e.gnormx+t.body.posy*e.gnormy+e.lprojection,null!=e.wrap_gnorm&&(e.wrap_gnorm.zpp_inner.x=e.gnormx,e.wrap_gnorm.zpp_inner.y=e.gnormy),e.tp0=e.gp0.y*e.gnormx-e.gp0.x*e.gnormy,e.tp1=e.gp1.y*e.gnormx-e.gp1.x*e.gnormy}i=this.zpp_inner.gp0;return null==i.outer&&(i.outer=new St,null!=(e=i.outer.zpp_inner).outer&&(e.outer.zpp_inner=null,e.outer=null),e._isimmutable=null,e._validate=null,e._invalidate=null,e.next=Gr.zpp_pool,Gr.zpp_pool=e,i.outer.zpp_inner=i),i.outer},dt.prototype.get_worldVertex2=function(){var t=this.zpp_inner.polygon;if(t.zip_gaxi&&null!=t.body){t.zip_gaxi=!1,t.validate_laxi();var e=t.body;if(e.zip_axis&&(e.zip_axis=!1,e.axisx=Math.sin(e.rot),e.axisy=Math.cos(e.rot)),t.zip_gverts&&null!=t.body){t.zip_gverts=!1,t.validate_lverts();var i=t.body;i.zip_axis&&(i.zip_axis=!1,i.axisx=Math.sin(i.rot),i.axisy=Math.cos(i.rot));for(var n=t.lverts.next,r=t.gverts.next;null!=r;){var o=r,s=n,n=n.next;o.x=t.body.posx+(t.body.axisy*s.x-t.body.axisx*s.y),o.y=t.body.posy+(s.x*t.body.axisx+s.y*t.body.axisy),r=r.next}}for(var a=t.edges.head,h=l=t.gverts.next,l=l.next;null!=l;){var p=l,u=a.elt,a=a.next;u.gp0=h,u.gp1=p,u.gnormx=t.body.axisy*u.lnormx-t.body.axisx*u.lnormy,u.gnormy=u.lnormx*t.body.axisx+u.lnormy*t.body.axisy,u.gprojection=t.body.posx*u.gnormx+t.body.posy*u.gnormy+u.lprojection,null!=u.wrap_gnorm&&(u.wrap_gnorm.zpp_inner.x=u.gnormx,u.wrap_gnorm.zpp_inner.y=u.gnormy),u.tp0=u.gp0.y*u.gnormx-u.gp0.x*u.gnormy,u.tp1=u.gp1.y*u.gnormx-u.gp1.x*u.gnormy,h=p,l=l.next}e=a.elt;e.gp0=h,e.gp1=t.gverts.next,e.gnormx=t.body.axisy*e.lnormx-t.body.axisx*e.lnormy,e.gnormy=e.lnormx*t.body.axisx+e.lnormy*t.body.axisy,e.gprojection=t.body.posx*e.gnormx+t.body.posy*e.gnormy+e.lprojection,null!=e.wrap_gnorm&&(e.wrap_gnorm.zpp_inner.x=e.gnormx,e.wrap_gnorm.zpp_inner.y=e.gnormy),e.tp0=e.gp0.y*e.gnormx-e.gp0.x*e.gnormy,e.tp1=e.gp1.y*e.gnormx-e.gp1.x*e.gnormy}i=this.zpp_inner.gp1;return null==i.outer&&(i.outer=new St,null!=(e=i.outer.zpp_inner).outer&&(e.outer.zpp_inner=null,e.outer=null),e._isimmutable=null,e._validate=null,e._invalidate=null,e.next=Gr.zpp_pool,Gr.zpp_pool=e,i.outer.zpp_inner=i),i.outer},dt.prototype.toString=function(){if(null==this.zpp_inner.polygon)return"Edge(object-pooled)";if(null==this.zpp_inner.polygon.body)return this.zpp_inner.polygon.validate_laxi(),"{ localNormal : { x: "+this.zpp_inner.lnormx+" y: "+this.zpp_inner.lnormy+" } }";var t=this.zpp_inner.polygon;if(t.zip_gaxi&&null!=t.body){t.zip_gaxi=!1,t.validate_laxi();var e=t.body;if(e.zip_axis&&(e.zip_axis=!1,e.axisx=Math.sin(e.rot),e.axisy=Math.cos(e.rot)),t.zip_gverts&&null!=t.body){t.zip_gverts=!1,t.validate_lverts();var i=t.body;i.zip_axis&&(i.zip_axis=!1,i.axisx=Math.sin(i.rot),i.axisy=Math.cos(i.rot));for(var n=t.lverts.next,r=t.gverts.next;null!=r;){var o=r,s=n,n=n.next;o.x=t.body.posx+(t.body.axisy*s.x-t.body.axisx*s.y),o.y=t.body.posy+(s.x*t.body.axisx+s.y*t.body.axisy),r=r.next}}for(var a=t.edges.head,h=l=t.gverts.next,l=l.next;null!=l;){var p=l,u=a.elt,a=a.next;u.gp0=h,u.gp1=p,u.gnormx=t.body.axisy*u.lnormx-t.body.axisx*u.lnormy,u.gnormy=u.lnormx*t.body.axisx+u.lnormy*t.body.axisy,u.gprojection=t.body.posx*u.gnormx+t.body.posy*u.gnormy+u.lprojection,null!=u.wrap_gnorm&&(u.wrap_gnorm.zpp_inner.x=u.gnormx,u.wrap_gnorm.zpp_inner.y=u.gnormy),u.tp0=u.gp0.y*u.gnormx-u.gp0.x*u.gnormy,u.tp1=u.gp1.y*u.gnormx-u.gp1.x*u.gnormy,h=p,l=l.next}i=a.elt;i.gp0=h,i.gp1=t.gverts.next,i.gnormx=t.body.axisy*i.lnormx-t.body.axisx*i.lnormy,i.gnormy=i.lnormx*t.body.axisx+i.lnormy*t.body.axisy,i.gprojection=t.body.posx*i.gnormx+t.body.posy*i.gnormy+i.lprojection,null!=i.wrap_gnorm&&(i.wrap_gnorm.zpp_inner.x=i.gnormx,i.wrap_gnorm.zpp_inner.y=i.gnormy),i.tp0=i.gp0.y*i.gnormx-i.gp0.x*i.gnormy,i.tp1=i.gp1.y*i.gnormx-i.gp1.x*i.gnormy}return"{ localNormal : { x: "+this.zpp_inner.lnormx+" y: "+this.zpp_inner.lnormy+" } worldNormal : { x: "+this.zpp_inner.gnormx+" y: "+this.zpp_inner.gnormy+" } }"},Object.defineProperty(dt.prototype,"polygon",{get:dt.prototype.get_polygon}),Object.defineProperty(dt.prototype,"localNormal",{get:dt.prototype.get_localNormal}),Object.defineProperty(dt.prototype,"worldNormal",{get:dt.prototype.get_worldNormal}),Object.defineProperty(dt.prototype,"length",{get:dt.prototype.get_length}),Object.defineProperty(dt.prototype,"localProjection",{get:dt.prototype.get_localProjection}),Object.defineProperty(dt.prototype,"worldProjection",{get:dt.prototype.get_worldProjection}),Object.defineProperty(dt.prototype,"localVertex1",{get:dt.prototype.get_localVertex1}),Object.defineProperty(dt.prototype,"localVertex2",{get:dt.prototype.get_localVertex2}),Object.defineProperty(dt.prototype,"worldVertex1",{get:dt.prototype.get_worldVertex1}),Object.defineProperty(dt.prototype,"worldVertex2",{get:dt.prototype.get_worldVertex2}),dt.prototype.__class__=dt;var ie=nape.shape.EdgeIterator=function(){this.zpp_next=null,this.zpp_critical=!1,this.zpp_i=0,this.zpp_inner=null};ie.__name__=["nape","shape","EdgeIterator"],ie.get=function(t){var e,i=null==ie.zpp_pool?(En.internal=!0,e=new ie,En.internal=!1,e):(ie.zpp_pool=(i=ie.zpp_pool).zpp_next,i);return i.zpp_i=0,i.zpp_inner=t,i.zpp_critical=!1,i},ie.prototype.zpp_inner=null,ie.prototype.zpp_i=null,ie.prototype.zpp_critical=null,ie.prototype.zpp_next=null,ie.prototype.hasNext=function(){this.zpp_inner.zpp_inner.valmod();var t=this.zpp_inner;t.zpp_inner.valmod(),t.zpp_inner.zip_length&&(t.zpp_inner.zip_length=!1,t.zpp_inner.user_length=t.zpp_inner.inner.length);t=t.zpp_inner.user_length;return this.zpp_critical=!0,this.zpp_i<t||(this.zpp_next=ie.zpp_pool,(ie.zpp_pool=this).zpp_inner=null,!1)},ie.prototype.next=function(){return this.zpp_critical=!1,this.zpp_inner.at(this.zpp_i++)},ie.prototype.__class__=ie;var ct=nape.shape.EdgeList=function(){this.zpp_inner=null,this.zpp_inner=new En,this.zpp_inner.outer=this};ct.__name__=["nape","shape","EdgeList"],ct.fromArray=function(t){for(var e=new ct,i=0;i<t.length;){var n=t[i];++i,e.push(n)}return e},ct.prototype.zpp_inner=null,ct.prototype.get_length=function(){return this.zpp_inner.valmod(),this.zpp_inner.zip_length&&(this.zpp_inner.zip_length=!1,this.zpp_inner.user_length=this.zpp_inner.inner.length),this.zpp_inner.user_length},ct.prototype.has=function(t){return this.zpp_inner.valmod(),this.zpp_inner.inner.has(t.zpp_inner)},ct.prototype.at=function(t){if(this.zpp_inner.valmod(),this.zpp_inner.reverse_flag&&(this.zpp_inner.valmod(),this.zpp_inner.zip_length&&(this.zpp_inner.zip_length=!1,this.zpp_inner.user_length=this.zpp_inner.inner.length),t==this.zpp_inner.user_length-1||(this.zpp_inner.valmod(),this.zpp_inner.zip_length&&(this.zpp_inner.zip_length=!1,this.zpp_inner.user_length=this.zpp_inner.inner.length),t=this.zpp_inner.user_length-2-t)),t<this.zpp_inner.at_index||null==this.zpp_inner.at_ite)this.zpp_inner.at_index=t,this.zpp_inner.at_ite=this.zpp_inner.inner.iterator_at(t);else for(;this.zpp_inner.at_index!=t;)this.zpp_inner.at_index++,this.zpp_inner.at_ite=this.zpp_inner.at_ite.next;return this.zpp_inner.at_ite.elt.wrapper()},ct.prototype.push=function(t){this.zpp_inner.modify_test(),this.zpp_inner.valmod();var e,i=null==this.zpp_inner.adder||this.zpp_inner.adder(t);return i&&(this.zpp_inner.reverse_flag?this.zpp_inner.inner.add(t.zpp_inner):(null==this.zpp_inner.push_ite&&(e=null==this.zpp_inner.inner.head?null:(this.zpp_inner.valmod(),this.zpp_inner.zip_length&&(this.zpp_inner.zip_length=!1,this.zpp_inner.user_length=this.zpp_inner.inner.length),this.zpp_inner.inner.iterator_at(this.zpp_inner.user_length-1)),this.zpp_inner.push_ite=e),this.zpp_inner.push_ite=this.zpp_inner.inner.insert(this.zpp_inner.push_ite,t.zpp_inner)),this.zpp_inner.invalidate(),null!=this.zpp_inner.post_adder&&this.zpp_inner.post_adder(t)),i},ct.prototype.unshift=function(t){this.zpp_inner.modify_test(),this.zpp_inner.valmod();var e,i=null==this.zpp_inner.adder||this.zpp_inner.adder(t);return i&&(this.zpp_inner.reverse_flag?(null==this.zpp_inner.push_ite&&(e=null==this.zpp_inner.inner.head?null:(this.zpp_inner.valmod(),this.zpp_inner.zip_length&&(this.zpp_inner.zip_length=!1,this.zpp_inner.user_length=this.zpp_inner.inner.length),this.zpp_inner.inner.iterator_at(this.zpp_inner.user_length-1)),this.zpp_inner.push_ite=e),this.zpp_inner.push_ite=this.zpp_inner.inner.insert(this.zpp_inner.push_ite,t.zpp_inner)):this.zpp_inner.inner.add(t.zpp_inner),this.zpp_inner.invalidate(),null!=this.zpp_inner.post_adder&&this.zpp_inner.post_adder(t)),i},ct.prototype.pop=function(){this.zpp_inner.modify_test(),this.zpp_inner.valmod();var t,e,i=null;return this.zpp_inner.reverse_flag?(e=(i=this.zpp_inner.inner.head.elt).wrapper(),null!=this.zpp_inner.subber&&this.zpp_inner.subber(e),this.zpp_inner.dontremove||this.zpp_inner.inner.pop()):(null!=this.zpp_inner.at_ite&&null==this.zpp_inner.at_ite.next&&(this.zpp_inner.at_ite=null),this.zpp_inner.valmod(),this.zpp_inner.zip_length&&(this.zpp_inner.zip_length=!1,this.zpp_inner.user_length=this.zpp_inner.inner.length),e=(i=(null==(t=1==this.zpp_inner.user_length?null:(this.zpp_inner.valmod(),this.zpp_inner.zip_length&&(this.zpp_inner.zip_length=!1,this.zpp_inner.user_length=this.zpp_inner.inner.length),this.zpp_inner.inner.iterator_at(this.zpp_inner.user_length-2)))?this.zpp_inner.inner.head:t.next).elt).wrapper(),null!=this.zpp_inner.subber&&this.zpp_inner.subber(e),this.zpp_inner.dontremove||this.zpp_inner.inner.erase(t)),this.zpp_inner.invalidate(),i.wrapper()},ct.prototype.shift=function(){this.zpp_inner.modify_test(),this.zpp_inner.valmod();var t,e,i=null;return this.zpp_inner.reverse_flag?(null!=this.zpp_inner.at_ite&&null==this.zpp_inner.at_ite.next&&(this.zpp_inner.at_ite=null),this.zpp_inner.valmod(),this.zpp_inner.zip_length&&(this.zpp_inner.zip_length=!1,this.zpp_inner.user_length=this.zpp_inner.inner.length),t=(i=(null==(e=1==this.zpp_inner.user_length?null:(this.zpp_inner.valmod(),this.zpp_inner.zip_length&&(this.zpp_inner.zip_length=!1,this.zpp_inner.user_length=this.zpp_inner.inner.length),this.zpp_inner.inner.iterator_at(this.zpp_inner.user_length-2)))?this.zpp_inner.inner.head:e.next).elt).wrapper(),null!=this.zpp_inner.subber&&this.zpp_inner.subber(t),this.zpp_inner.dontremove||this.zpp_inner.inner.erase(e)):(e=(i=this.zpp_inner.inner.head.elt).wrapper(),null!=this.zpp_inner.subber&&this.zpp_inner.subber(e),this.zpp_inner.dontremove||this.zpp_inner.inner.pop()),this.zpp_inner.invalidate(),i.wrapper()},ct.prototype.add=function(t){return this.zpp_inner.reverse_flag?this.push(t):this.unshift(t)},ct.prototype.remove=function(t){this.zpp_inner.modify_test(),this.zpp_inner.valmod();for(var e=!1,i=this.zpp_inner.inner.head;null!=i;){if(i.elt==t.zpp_inner){e=!0;break}i=i.next}return e&&(null!=this.zpp_inner.subber&&this.zpp_inner.subber(t),this.zpp_inner.dontremove||this.zpp_inner.inner.remove(t.zpp_inner),this.zpp_inner.invalidate()),e},ct.prototype.clear=function(){if(this.zpp_inner.reverse_flag)for(;null!=this.zpp_inner.inner.head;)this.pop();else for(;null!=this.zpp_inner.inner.head;)this.shift()},ct.prototype.empty=function(){return null==this.zpp_inner.inner.head},ct.prototype.iterator=function(){return this.zpp_inner.valmod(),ie.get(this)},ct.prototype.copy=function(t){null==t&&(t=!1);var e=new ct;this.zpp_inner.valmod();for(var i=ie.get(this);;){i.zpp_inner.zpp_inner.valmod();var n=i.zpp_inner;n.zpp_inner.valmod(),n.zpp_inner.zip_length&&(n.zpp_inner.zip_length=!1,n.zpp_inner.user_length=n.zpp_inner.inner.length);n=n.zpp_inner.user_length;if(i.zpp_critical=!0,!(i.zpp_i<n||(i.zpp_next=ie.zpp_pool,(ie.zpp_pool=i).zpp_inner=null,!1)))break;i.zpp_critical=!1;n=i.zpp_inner.at(i.zpp_i++);e.push(t?null:n)}return e},ct.prototype.merge=function(t){t.zpp_inner.valmod();for(var e=ie.get(t);;){e.zpp_inner.zpp_inner.valmod();var i=e.zpp_inner;i.zpp_inner.valmod(),i.zpp_inner.zip_length&&(i.zpp_inner.zip_length=!1,i.zpp_inner.user_length=i.zpp_inner.inner.length);i=i.zpp_inner.user_length;if(e.zpp_critical=!0,!(e.zpp_i<i||(e.zpp_next=ie.zpp_pool,(ie.zpp_pool=e).zpp_inner=null,!1)))break;e.zpp_critical=!1;i=e.zpp_inner.at(e.zpp_i++);this.has(i)||(this.zpp_inner.reverse_flag?this.push(i):this.unshift(i))}},ct.prototype.toString=function(){var t="[",e=!0;this.zpp_inner.valmod();for(var i=ie.get(this);;){i.zpp_inner.zpp_inner.valmod();var n=i.zpp_inner;n.zpp_inner.valmod(),n.zpp_inner.zip_length&&(n.zpp_inner.zip_length=!1,n.zpp_inner.user_length=n.zpp_inner.inner.length);n=n.zpp_inner.user_length;if(i.zpp_critical=!0,!(i.zpp_i<n||(i.zpp_next=ie.zpp_pool,(ie.zpp_pool=i).zpp_inner=null,!1)))break;i.zpp_critical=!1;n=i.zpp_inner.at(i.zpp_i++);e||(t+=","),t+=null==n?"NULL":n.toString(),e=!1}return t+"]"},ct.prototype.foreach=function(t){this.zpp_inner.valmod();for(var e=ie.get(this);;){e.zpp_inner.zpp_inner.valmod();var i=e.zpp_inner;i.zpp_inner.valmod(),i.zpp_inner.zip_length&&(i.zpp_inner.zip_length=!1,i.zpp_inner.user_length=i.zpp_inner.inner.length);i=i.zpp_inner.user_length;if(e.zpp_critical=!0,!(e.zpp_i<i||(e.zpp_next=ie.zpp_pool,(ie.zpp_pool=e).zpp_inner=null,!1)))break;try{e.zpp_critical=!1,t(e.zpp_inner.at(e.zpp_i++))}catch(t){e.zpp_next=ie.zpp_pool,(ie.zpp_pool=e).zpp_inner=null;break}}return this},ct.prototype.filter=function(t){for(var e=0;;){if(this.zpp_inner.valmod(),this.zpp_inner.zip_length&&(this.zpp_inner.zip_length=!1,this.zpp_inner.user_length=this.zpp_inner.inner.length),!(e<this.zpp_inner.user_length))break;var i=this.at(e);try{t(i)?++e:this.remove(i)}catch(t){break}}return this},Object.defineProperty(ct.prototype,"length",{get:ct.prototype.get_length}),ct.prototype.__class__=ct;var yt=nape.shape.Polygon=function(t,e,i){if(this.zpp_inner_zn=null,pt.call(this),this.zpp_inner_zn=new He,((this.zpp_inner_zn.outer=this).zpp_inner_zn.outer_zn=this).zpp_inner=this.zpp_inner_zn,this.zpp_inner_i=this.zpp_inner,this.zpp_inner_i.outer_i=this,t instanceof Array&&null==t.__enum__)for(var n=t,r=0;r<n.length;){var o=n[r];++r;var s=o;null==this.zpp_inner_zn.wrap_lverts&&this.zpp_inner_zn.getlverts();var a=this.zpp_inner_zn.wrap_lverts,h=s.zpp_inner;null!=h._validate&&h._validate();o=s.zpp_inner.x,h=s.zpp_inner;null!=h._validate&&h._validate();var l,p,h=s.zpp_inner.y;null==Bn.poolVec2?l=new St:(l=Bn.poolVec2,Bn.poolVec2=l.zpp_pool,l.zpp_pool=null),null==l.zpp_inner?(null==Gr.zpp_pool?p=new Gr:(p=Gr.zpp_pool,Gr.zpp_pool=p.next,p.next=null),p.weak=!1,p._immutable=!1,p.x=o,p.y=h,l.zpp_inner=p,l.zpp_inner.outer=l):(null!=(s=l.zpp_inner)._validate&&s._validate(),l.zpp_inner.x==o&&(null!=(s=l.zpp_inner)._validate&&s._validate(),l.zpp_inner.y==h)||(l.zpp_inner.x=o,l.zpp_inner.y=h,null!=(h=l.zpp_inner)._invalidate&&h._invalidate(h))),l.zpp_inner.weak=!1,a.push(l)}else if(R.__instanceof(t,Y))for(var u=t.iterator();;){u.zpp_inner.zpp_inner.valmod();var d=u.zpp_inner.zpp_gl();if(u.zpp_critical=!0,!(u.zpp_i<d||(u.zpp_next=Qt.zpp_pool,(Qt.zpp_pool=u).zpp_inner=null,!1)))break;u.zpp_critical=!1;var c=u.zpp_inner.at(u.zpp_i++);null==this.zpp_inner_zn.wrap_lverts&&this.zpp_inner_zn.getlverts();var y=this.zpp_inner_zn.wrap_lverts,_=c.zpp_inner;null!=_._validate&&_._validate();d=c.zpp_inner.x,_=c.zpp_inner;null!=_._validate&&_._validate();var m,g,_=c.zpp_inner.y;null==Bn.poolVec2?m=new St:(m=Bn.poolVec2,Bn.poolVec2=m.zpp_pool,m.zpp_pool=null),null==m.zpp_inner?(null==Gr.zpp_pool?g=new Gr:(g=Gr.zpp_pool,Gr.zpp_pool=g.next,g.next=null),g.weak=!1,g._immutable=!1,g.x=d,g.y=_,m.zpp_inner=g,m.zpp_inner.outer=m):(null!=(c=m.zpp_inner)._validate&&c._validate(),m.zpp_inner.x==d&&(null!=(c=m.zpp_inner)._validate&&c._validate(),m.zpp_inner.y==_)||(m.zpp_inner.x=d,m.zpp_inner.y=_,null!=(_=m.zpp_inner)._invalidate&&_._invalidate(_))),m.zpp_inner.weak=!1,y.push(m)}else if(R.__instanceof(t,_i)){var f=t.zpp_inner.vertices;if(null!=f)for(var x=f;;){var v,w,z=x.x,b=x.y;null==Bn.poolVec2?v=new St:(v=Bn.poolVec2,Bn.poolVec2=v.zpp_pool,v.zpp_pool=null),null==v.zpp_inner?(null==Gr.zpp_pool?w=new Gr:(w=Gr.zpp_pool,Gr.zpp_pool=w.next,w.next=null),w.weak=!1,w._immutable=!1,w.x=z,w.y=b,v.zpp_inner=w,v.zpp_inner.outer=v):(null!=(S=v.zpp_inner)._validate&&S._validate(),v.zpp_inner.x==z&&(null!=(C=v.zpp_inner)._validate&&C._validate(),v.zpp_inner.y==b)||(v.zpp_inner.x=z,v.zpp_inner.y=b,null!=(P=v.zpp_inner)._invalidate&&P._invalidate(P))),v.zpp_inner.weak=!1;var S=v,x=x.next;null==this.zpp_inner_zn.wrap_lverts&&this.zpp_inner_zn.getlverts();var C=this.zpp_inner_zn.wrap_lverts,z=S.zpp_inner;null!=z._validate&&z._validate();var b=S.zpp_inner.x,P=S.zpp_inner;null!=P._validate&&P._validate();var M,T,z=S.zpp_inner.y;null==Bn.poolVec2?M=new St:(M=Bn.poolVec2,Bn.poolVec2=M.zpp_pool,M.zpp_pool=null),null==M.zpp_inner?(null==Gr.zpp_pool?T=new Gr:(T=Gr.zpp_pool,Gr.zpp_pool=T.next,T.next=null),T.weak=!1,T._immutable=!1,T.x=b,T.y=z,M.zpp_inner=T,M.zpp_inner.outer=M):(null!=(P=M.zpp_inner)._validate&&P._validate(),M.zpp_inner.x==b&&(null!=(P=M.zpp_inner)._validate&&P._validate(),M.zpp_inner.y==z)||(M.zpp_inner.x=b,M.zpp_inner.y=z,null!=(z=M.zpp_inner)._invalidate&&z._invalidate(z))),M.zpp_inner.weak=!1,C.push(M);C=S.zpp_inner;S.zpp_inner.outer=null,S.zpp_inner=null;S=S;S.zpp_pool=Bn.poolVec2,Bn.poolVec2=S;C=C;if(null!=C.outer&&(C.outer.zpp_inner=null,C.outer=null),C._isimmutable=null,C._validate=null,C._invalidate=null,C.next=Gr.zpp_pool,Gr.zpp_pool=C,x==f)break}}if(t instanceof Array&&null==t.__enum__)for(var A=t,k=0;k<A.length;){var O=A[k],E=!!O.zpp_inner.weak&&(E=O.zpp_inner,O.zpp_inner.outer=null,O.zpp_inner=null,(O=O).zpp_pool=Bn.poolVec2,Bn.poolVec2=O,null!=(E=E).outer&&(E.outer.zpp_inner=null,E.outer=null),E._isimmutable=null,E._validate=null,E._invalidate=null,E.next=Gr.zpp_pool,Gr.zpp_pool=E,!0);E?A.splice(k,1):++k}else if(R.__instanceof(t,Y)){t=t;null!=t.zpp_inner._validate&&t.zpp_inner._validate();for(var I=t.zpp_inner.inner,G=null,D=I.head;null!=D;){var L,B=D.elt;B.outer.zpp_inner.weak?(D=I.erase(G),B.outer.zpp_inner.weak&&(B=(L=B.outer).zpp_inner,L.zpp_inner.outer=null,L.zpp_inner=null,(L=L).zpp_pool=Bn.poolVec2,Bn.poolVec2=L,null!=(B=B).outer&&(B.outer.zpp_inner=null,B.outer=null),B._isimmutable=null,B._validate=null,B._invalidate=null,B.next=Gr.zpp_pool,Gr.zpp_pool=B)):D=(G=D).next}}null==e?null==Ue.zpp_pool?this.zpp_inner.material=new Ue:(this.zpp_inner.material=Ue.zpp_pool,Ue.zpp_pool=this.zpp_inner.material.next,this.zpp_inner.material.next=null):(this.zpp_inner.immutable_midstep("Shape::material"),this.zpp_inner.setMaterial(e.zpp_inner),this.zpp_inner.material.wrapper()),null==i?null==he.zpp_pool?this.zpp_inner.filter=new he:(this.zpp_inner.filter=he.zpp_pool,he.zpp_pool=this.zpp_inner.filter.next,this.zpp_inner.filter.next=null):(this.zpp_inner.immutable_midstep("Shape::filter"),this.zpp_inner.setFilter(i.zpp_inner),this.zpp_inner.filter.wrapper()),this.zpp_inner_i.insert_cbtype(Tt.ANY_SHAPE.zpp_inner)};yt.__name__=["nape","shape","Polygon"],yt.__super__=pt,yt.prototype=Object.create(pt.prototype),yt.rect=function(t,e,i,n,r){var o;null==r&&(r=!1),null==Bn.poolVec2?h=new St:(h=Bn.poolVec2,Bn.poolVec2=h.zpp_pool,h.zpp_pool=null),null==h.zpp_inner?(null==Gr.zpp_pool?o=new Gr:(o=Gr.zpp_pool,Gr.zpp_pool=o.next,o.next=null),o.weak=!1,o._immutable=!1,o.x=t,o.y=e,h.zpp_inner=o,h.zpp_inner.outer=h):(null!=(o=h.zpp_inner)._validate&&o._validate(),h.zpp_inner.x==t&&(null!=(o=h.zpp_inner)._validate&&o._validate(),h.zpp_inner.y==e)||(h.zpp_inner.x=t,h.zpp_inner.y=e,null!=(a=h.zpp_inner)._invalidate&&a._invalidate(a))),h.zpp_inner.weak=r;var s,a=h,h=t+i;null==Bn.poolVec2?u=new St:(u=Bn.poolVec2,Bn.poolVec2=u.zpp_pool,u.zpp_pool=null),null==u.zpp_inner?(null==Gr.zpp_pool?s=new Gr:(s=Gr.zpp_pool,Gr.zpp_pool=s.next,s.next=null),s.weak=!1,s._immutable=!1,s.x=h,s.y=e,u.zpp_inner=s,u.zpp_inner.outer=u):(null!=(s=u.zpp_inner)._validate&&s._validate(),u.zpp_inner.x==h&&(null!=(s=u.zpp_inner)._validate&&s._validate(),u.zpp_inner.y==e)||(u.zpp_inner.x=h,u.zpp_inner.y=e,null!=(p=u.zpp_inner)._invalidate&&p._invalidate(p))),u.zpp_inner.weak=r;var l,p=u,u=t+i,i=e+n;null==Bn.poolVec2?y=new St:(y=Bn.poolVec2,Bn.poolVec2=y.zpp_pool,y.zpp_pool=null),null==y.zpp_inner?(null==Gr.zpp_pool?l=new Gr:(l=Gr.zpp_pool,Gr.zpp_pool=l.next,l.next=null),l.weak=!1,l._immutable=!1,l.x=u,l.y=i,y.zpp_inner=l,y.zpp_inner.outer=y):(null!=(l=y.zpp_inner)._validate&&l._validate(),y.zpp_inner.x==u&&(null!=(l=y.zpp_inner)._validate&&l._validate(),y.zpp_inner.y==i)||(y.zpp_inner.x=u,y.zpp_inner.y=i,null!=(i=y.zpp_inner)._invalidate&&i._invalidate(i))),y.zpp_inner.weak=r;var d,c,y=y,n=e+n;return null==Bn.poolVec2?d=new St:(d=Bn.poolVec2,Bn.poolVec2=d.zpp_pool,d.zpp_pool=null),null==d.zpp_inner?(null==Gr.zpp_pool?c=new Gr:(c=Gr.zpp_pool,Gr.zpp_pool=c.next,c.next=null),c.weak=!1,c._immutable=!1,c.x=t,c.y=n,d.zpp_inner=c,d.zpp_inner.outer=d):(null!=(c=d.zpp_inner)._validate&&c._validate(),d.zpp_inner.x==t&&(null!=(c=d.zpp_inner)._validate&&c._validate(),d.zpp_inner.y==n)||(d.zpp_inner.x=t,d.zpp_inner.y=n,null!=(n=d.zpp_inner)._invalidate&&n._invalidate(n))),d.zpp_inner.weak=r,[a,p,y,d]},yt.box=function(t,e,i){return yt.rect(-t/2,-e/2,t,e,i=null==i?!1:i)},yt.regular=function(t,e,i,n,r){null==r&&(r=!1),null==n&&(n=0);for(var o=[],s=2*Math.PI/i,a=0;a<i;){var h,l,p=a++*s+n,u=Math.cos(p)*t,d=Math.sin(p)*e;null==Bn.poolVec2?h=new St:(h=Bn.poolVec2,Bn.poolVec2=h.zpp_pool,h.zpp_pool=null),null==h.zpp_inner?(null==Gr.zpp_pool?l=new Gr:(l=Gr.zpp_pool,Gr.zpp_pool=l.next,l.next=null),l.weak=!1,l._immutable=!1,l.x=u,l.y=d,h.zpp_inner=l,h.zpp_inner.outer=h):(null!=(p=h.zpp_inner)._validate&&p._validate(),h.zpp_inner.x==u&&(null!=(p=h.zpp_inner)._validate&&p._validate(),h.zpp_inner.y==d)||(h.zpp_inner.x=u,h.zpp_inner.y=d,null!=(d=h.zpp_inner)._invalidate&&d._invalidate(d))),h.zpp_inner.weak=r,o.push(h)}return o},yt.prototype.zpp_inner_zn=null,yt.prototype.get_localVerts=function(){return null==this.zpp_inner_zn.wrap_lverts&&this.zpp_inner_zn.getlverts(),this.zpp_inner_zn.wrap_lverts},yt.prototype.get_worldVerts=function(){return null==this.zpp_inner_zn.wrap_gverts&&this.zpp_inner_zn.getgverts(),this.zpp_inner_zn.wrap_gverts},yt.prototype.get_edges=function(){return null==this.zpp_inner_zn.wrap_edges&&this.zpp_inner_zn.getedges(),this.zpp_inner_zn.wrap_edges},yt.prototype.validity=function(){return this.zpp_inner_zn.valid()},Object.defineProperty(yt.prototype,"localVerts",{get:yt.prototype.get_localVerts}),Object.defineProperty(yt.prototype,"worldVerts",{get:yt.prototype.get_worldVerts}),Object.defineProperty(yt.prototype,"edges",{get:yt.prototype.get_edges}),yt.prototype.__class__=yt;var ne=nape.shape.ShapeIterator=function(){this.zpp_next=null,this.zpp_critical=!1,this.zpp_i=0,this.zpp_inner=null};ne.__name__=["nape","shape","ShapeIterator"],ne.get=function(t){var e,i=null==ne.zpp_pool?(In.internal=!0,e=new ne,In.internal=!1,e):(ne.zpp_pool=(i=ne.zpp_pool).zpp_next,i);return i.zpp_i=0,i.zpp_inner=t,i.zpp_critical=!1,i},ne.prototype.zpp_inner=null,ne.prototype.zpp_i=null,ne.prototype.zpp_critical=null,ne.prototype.zpp_next=null,ne.prototype.hasNext=function(){this.zpp_inner.zpp_inner.valmod();var t=this.zpp_inner;t.zpp_inner.valmod(),t.zpp_inner.zip_length&&(t.zpp_inner.zip_length=!1,t.zpp_inner.user_length=t.zpp_inner.inner.length);t=t.zpp_inner.user_length;return this.zpp_critical=!0,this.zpp_i<t||(this.zpp_next=ne.zpp_pool,(ne.zpp_pool=this).zpp_inner=null,!1)},ne.prototype.next=function(){return this.zpp_critical=!1,this.zpp_inner.at(this.zpp_i++)},ne.prototype.__class__=ne;var _t=nape.shape.ShapeList=function(){this.zpp_inner=null,this.zpp_inner=new In,this.zpp_inner.outer=this};_t.__name__=["nape","shape","ShapeList"],_t.fromArray=function(t){for(var e=new _t,i=0;i<t.length;){var n=t[i];++i,e.push(n)}return e},_t.prototype.zpp_inner=null,_t.prototype.get_length=function(){return this.zpp_inner.valmod(),this.zpp_inner.zip_length&&(this.zpp_inner.zip_length=!1,this.zpp_inner.user_length=this.zpp_inner.inner.length),this.zpp_inner.user_length},_t.prototype.has=function(t){return this.zpp_inner.valmod(),this.zpp_inner.inner.has(t.zpp_inner)},_t.prototype.at=function(t){if(this.zpp_inner.valmod(),this.zpp_inner.reverse_flag&&(this.zpp_inner.valmod(),this.zpp_inner.zip_length&&(this.zpp_inner.zip_length=!1,this.zpp_inner.user_length=this.zpp_inner.inner.length),t=this.zpp_inner.user_length-1-t),t<this.zpp_inner.at_index||null==this.zpp_inner.at_ite)this.zpp_inner.at_index=t,this.zpp_inner.at_ite=this.zpp_inner.inner.iterator_at(t);else for(;this.zpp_inner.at_index!=t;)this.zpp_inner.at_index++,this.zpp_inner.at_ite=this.zpp_inner.at_ite.next;return this.zpp_inner.at_ite.elt.outer},_t.prototype.push=function(t){this.zpp_inner.modify_test(),this.zpp_inner.valmod();var e,i=null==this.zpp_inner.adder||this.zpp_inner.adder(t);return i&&(this.zpp_inner.reverse_flag?this.zpp_inner.inner.add(t.zpp_inner):(null==this.zpp_inner.push_ite&&(e=null==this.zpp_inner.inner.head?null:(this.zpp_inner.valmod(),this.zpp_inner.zip_length&&(this.zpp_inner.zip_length=!1,this.zpp_inner.user_length=this.zpp_inner.inner.length),this.zpp_inner.inner.iterator_at(this.zpp_inner.user_length-1)),this.zpp_inner.push_ite=e),this.zpp_inner.push_ite=this.zpp_inner.inner.insert(this.zpp_inner.push_ite,t.zpp_inner)),this.zpp_inner.invalidate(),null!=this.zpp_inner.post_adder&&this.zpp_inner.post_adder(t)),i},_t.prototype.unshift=function(t){this.zpp_inner.modify_test(),this.zpp_inner.valmod();var e,i=null==this.zpp_inner.adder||this.zpp_inner.adder(t);return i&&(this.zpp_inner.reverse_flag?(null==this.zpp_inner.push_ite&&(e=null==this.zpp_inner.inner.head?null:(this.zpp_inner.valmod(),this.zpp_inner.zip_length&&(this.zpp_inner.zip_length=!1,this.zpp_inner.user_length=this.zpp_inner.inner.length),this.zpp_inner.inner.iterator_at(this.zpp_inner.user_length-1)),this.zpp_inner.push_ite=e),this.zpp_inner.push_ite=this.zpp_inner.inner.insert(this.zpp_inner.push_ite,t.zpp_inner)):this.zpp_inner.inner.add(t.zpp_inner),this.zpp_inner.invalidate(),null!=this.zpp_inner.post_adder&&this.zpp_inner.post_adder(t)),i},_t.prototype.pop=function(){this.zpp_inner.modify_test(),this.zpp_inner.valmod();var t,e,i=null;return this.zpp_inner.reverse_flag?(e=(i=this.zpp_inner.inner.head.elt).outer,null!=this.zpp_inner.subber&&this.zpp_inner.subber(e),this.zpp_inner.dontremove||this.zpp_inner.inner.pop()):(null!=this.zpp_inner.at_ite&&null==this.zpp_inner.at_ite.next&&(this.zpp_inner.at_ite=null),this.zpp_inner.valmod(),this.zpp_inner.zip_length&&(this.zpp_inner.zip_length=!1,this.zpp_inner.user_length=this.zpp_inner.inner.length),e=(i=(null==(t=1==this.zpp_inner.user_length?null:(this.zpp_inner.valmod(),this.zpp_inner.zip_length&&(this.zpp_inner.zip_length=!1,this.zpp_inner.user_length=this.zpp_inner.inner.length),this.zpp_inner.inner.iterator_at(this.zpp_inner.user_length-2)))?this.zpp_inner.inner.head:t.next).elt).outer,null!=this.zpp_inner.subber&&this.zpp_inner.subber(e),this.zpp_inner.dontremove||this.zpp_inner.inner.erase(t)),this.zpp_inner.invalidate(),i.outer},_t.prototype.shift=function(){this.zpp_inner.modify_test(),this.zpp_inner.valmod();var t,e,i=null;return this.zpp_inner.reverse_flag?(null!=this.zpp_inner.at_ite&&null==this.zpp_inner.at_ite.next&&(this.zpp_inner.at_ite=null),this.zpp_inner.valmod(),this.zpp_inner.zip_length&&(this.zpp_inner.zip_length=!1,this.zpp_inner.user_length=this.zpp_inner.inner.length),t=(i=(null==(e=1==this.zpp_inner.user_length?null:(this.zpp_inner.valmod(),this.zpp_inner.zip_length&&(this.zpp_inner.zip_length=!1,this.zpp_inner.user_length=this.zpp_inner.inner.length),this.zpp_inner.inner.iterator_at(this.zpp_inner.user_length-2)))?this.zpp_inner.inner.head:e.next).elt).outer,null!=this.zpp_inner.subber&&this.zpp_inner.subber(t),this.zpp_inner.dontremove||this.zpp_inner.inner.erase(e)):(e=(i=this.zpp_inner.inner.head.elt).outer,null!=this.zpp_inner.subber&&this.zpp_inner.subber(e),this.zpp_inner.dontremove||this.zpp_inner.inner.pop()),this.zpp_inner.invalidate(),i.outer},_t.prototype.add=function(t){return this.zpp_inner.reverse_flag?this.push(t):this.unshift(t)},_t.prototype.remove=function(t){this.zpp_inner.modify_test(),this.zpp_inner.valmod();for(var e=!1,i=this.zpp_inner.inner.head;null!=i;){if(i.elt==t.zpp_inner){e=!0;break}i=i.next}return e&&(null!=this.zpp_inner.subber&&this.zpp_inner.subber(t),this.zpp_inner.dontremove||this.zpp_inner.inner.remove(t.zpp_inner),this.zpp_inner.invalidate()),e},_t.prototype.clear=function(){if(this.zpp_inner.reverse_flag)for(;null!=this.zpp_inner.inner.head;)this.pop();else for(;null!=this.zpp_inner.inner.head;)this.shift()},_t.prototype.empty=function(){return null==this.zpp_inner.inner.head},_t.prototype.iterator=function(){return this.zpp_inner.valmod(),ne.get(this)},_t.prototype.copy=function(t){null==t&&(t=!1);var e=new _t;this.zpp_inner.valmod();for(var i=ne.get(this);;){i.zpp_inner.zpp_inner.valmod();var n=i.zpp_inner;n.zpp_inner.valmod(),n.zpp_inner.zip_length&&(n.zpp_inner.zip_length=!1,n.zpp_inner.user_length=n.zpp_inner.inner.length);n=n.zpp_inner.user_length;if(i.zpp_critical=!0,!(i.zpp_i<n||(i.zpp_next=ne.zpp_pool,(ne.zpp_pool=i).zpp_inner=null,!1)))break;i.zpp_critical=!1;n=i.zpp_inner.at(i.zpp_i++);e.push(t?null:n)}return e},_t.prototype.merge=function(t){t.zpp_inner.valmod();for(var e=ne.get(t);;){e.zpp_inner.zpp_inner.valmod();var i=e.zpp_inner;i.zpp_inner.valmod(),i.zpp_inner.zip_length&&(i.zpp_inner.zip_length=!1,i.zpp_inner.user_length=i.zpp_inner.inner.length);i=i.zpp_inner.user_length;if(e.zpp_critical=!0,!(e.zpp_i<i||(e.zpp_next=ne.zpp_pool,(ne.zpp_pool=e).zpp_inner=null,!1)))break;e.zpp_critical=!1;i=e.zpp_inner.at(e.zpp_i++);this.has(i)||(this.zpp_inner.reverse_flag?this.push(i):this.unshift(i))}},_t.prototype.toString=function(){var t="[",e=!0;this.zpp_inner.valmod();for(var i=ne.get(this);;){i.zpp_inner.zpp_inner.valmod();var n=i.zpp_inner;n.zpp_inner.valmod(),n.zpp_inner.zip_length&&(n.zpp_inner.zip_length=!1,n.zpp_inner.user_length=n.zpp_inner.inner.length);n=n.zpp_inner.user_length;if(i.zpp_critical=!0,!(i.zpp_i<n||(i.zpp_next=ne.zpp_pool,(ne.zpp_pool=i).zpp_inner=null,!1)))break;i.zpp_critical=!1;n=i.zpp_inner.at(i.zpp_i++);e||(t+=","),t+=null==n?"NULL":n.toString(),e=!1}return t+"]"},_t.prototype.foreach=function(t){this.zpp_inner.valmod();for(var e=ne.get(this);;){e.zpp_inner.zpp_inner.valmod();var i=e.zpp_inner;i.zpp_inner.valmod(),i.zpp_inner.zip_length&&(i.zpp_inner.zip_length=!1,i.zpp_inner.user_length=i.zpp_inner.inner.length);i=i.zpp_inner.user_length;if(e.zpp_critical=!0,!(e.zpp_i<i||(e.zpp_next=ne.zpp_pool,(ne.zpp_pool=e).zpp_inner=null,!1)))break;try{e.zpp_critical=!1,t(e.zpp_inner.at(e.zpp_i++))}catch(t){e.zpp_next=ne.zpp_pool,(ne.zpp_pool=e).zpp_inner=null;break}}return this},_t.prototype.filter=function(t){for(var e=0;;){if(this.zpp_inner.valmod(),this.zpp_inner.zip_length&&(this.zpp_inner.zip_length=!1,this.zpp_inner.user_length=this.zpp_inner.inner.length),!(e<this.zpp_inner.user_length))break;var i=this.at(e);try{t(i)?++e:this.remove(i)}catch(t){break}}return this},Object.defineProperty(_t.prototype,"length",{get:_t.prototype.get_length}),_t.prototype.__class__=_t;var mt=nape.shape.ShapeType=function(){};mt.__name__=["nape","shape","ShapeType"],mt.CIRCLE=null,mt.get_CIRCLE=function(){return null==Yn.ShapeType_CIRCLE&&(Yn.internal=!0,Yn.ShapeType_CIRCLE=new mt,Yn.internal=!1),Yn.ShapeType_CIRCLE},mt.POLYGON=null,mt.get_POLYGON=function(){return null==Yn.ShapeType_POLYGON&&(Yn.internal=!0,Yn.ShapeType_POLYGON=new mt,Yn.internal=!1),Yn.ShapeType_POLYGON},mt.prototype.toString=function(){return null==Yn.ShapeType_CIRCLE&&(Yn.internal=!0,Yn.ShapeType_CIRCLE=new mt,Yn.internal=!1),this==Yn.ShapeType_CIRCLE?"CIRCLE":(null==Yn.ShapeType_POLYGON&&(Yn.internal=!0,Yn.ShapeType_POLYGON=new mt,Yn.internal=!1),this==Yn.ShapeType_POLYGON?"POLYGON":"")},Object.defineProperty(mt,"CIRCLE",{get:mt.get_CIRCLE}),Object.defineProperty(mt,"POLYGON",{get:mt.get_POLYGON}),mt.prototype.__class__=mt;var gt=nape.shape.ValidationResult=function(){};gt.__name__=["nape","shape","ValidationResult"],gt.VALID=null,gt.get_VALID=function(){return null==Yn.ValidationResult_VALID&&(Yn.internal=!0,Yn.ValidationResult_VALID=new gt,Yn.internal=!1),Yn.ValidationResult_VALID},gt.DEGENERATE=null,gt.get_DEGENERATE=function(){return null==Yn.ValidationResult_DEGENERATE&&(Yn.internal=!0,Yn.ValidationResult_DEGENERATE=new gt,Yn.internal=!1),Yn.ValidationResult_DEGENERATE},gt.CONCAVE=null,gt.get_CONCAVE=function(){return null==Yn.ValidationResult_CONCAVE&&(Yn.internal=!0,Yn.ValidationResult_CONCAVE=new gt,Yn.internal=!1),Yn.ValidationResult_CONCAVE},gt.SELF_INTERSECTING=null,gt.get_SELF_INTERSECTING=function(){return null==Yn.ValidationResult_SELF_INTERSECTING&&(Yn.internal=!0,Yn.ValidationResult_SELF_INTERSECTING=new gt,Yn.internal=!1),Yn.ValidationResult_SELF_INTERSECTING},gt.prototype.toString=function(){return null==Yn.ValidationResult_VALID&&(Yn.internal=!0,Yn.ValidationResult_VALID=new gt,Yn.internal=!1),this==Yn.ValidationResult_VALID?"VALID":(null==Yn.ValidationResult_DEGENERATE&&(Yn.internal=!0,Yn.ValidationResult_DEGENERATE=new gt,Yn.internal=!1),this==Yn.ValidationResult_DEGENERATE?"DEGENERATE":(null==Yn.ValidationResult_CONCAVE&&(Yn.internal=!0,Yn.ValidationResult_CONCAVE=new gt,Yn.internal=!1),this==Yn.ValidationResult_CONCAVE?"CONCAVE":(null==Yn.ValidationResult_SELF_INTERSECTING&&(Yn.internal=!0,Yn.ValidationResult_SELF_INTERSECTING=new gt,Yn.internal=!1),this==Yn.ValidationResult_SELF_INTERSECTING?"SELF_INTERSECTING":"")))},Object.defineProperty(gt,"VALID",{get:gt.get_VALID}),Object.defineProperty(gt,"DEGENERATE",{get:gt.get_DEGENERATE}),Object.defineProperty(gt,"CONCAVE",{get:gt.get_CONCAVE}),Object.defineProperty(gt,"SELF_INTERSECTING",{get:gt.get_SELF_INTERSECTING}),gt.prototype.__class__=gt;var ft=nape.space.Broadphase=function(){};ft.__name__=["nape","space","Broadphase"],ft.DYNAMIC_AABB_TREE=null,ft.get_DYNAMIC_AABB_TREE=function(){return null==Yn.Broadphase_DYNAMIC_AABB_TREE&&(Yn.internal=!0,Yn.Broadphase_DYNAMIC_AABB_TREE=new ft,Yn.internal=!1),Yn.Broadphase_DYNAMIC_AABB_TREE},ft.SWEEP_AND_PRUNE=null,ft.get_SWEEP_AND_PRUNE=function(){return null==Yn.Broadphase_SWEEP_AND_PRUNE&&(Yn.internal=!0,Yn.Broadphase_SWEEP_AND_PRUNE=new ft,Yn.internal=!1),Yn.Broadphase_SWEEP_AND_PRUNE},ft.prototype.toString=function(){return null==Yn.Broadphase_DYNAMIC_AABB_TREE&&(Yn.internal=!0,Yn.Broadphase_DYNAMIC_AABB_TREE=new ft,Yn.internal=!1),this==Yn.Broadphase_DYNAMIC_AABB_TREE?"DYNAMIC_AABB_TREE":(null==Yn.Broadphase_SWEEP_AND_PRUNE&&(Yn.internal=!0,Yn.Broadphase_SWEEP_AND_PRUNE=new ft,Yn.internal=!1),this==Yn.Broadphase_SWEEP_AND_PRUNE?"SWEEP_AND_PRUNE":"")},Object.defineProperty(ft,"DYNAMIC_AABB_TREE",{get:ft.get_DYNAMIC_AABB_TREE}),Object.defineProperty(ft,"SWEEP_AND_PRUNE",{get:ft.get_SWEEP_AND_PRUNE}),ft.prototype.__class__=ft;_=nape.space.Space=function(t,e){this.zpp_inner=null,this.zpp_inner=new ii(null==t?null:t.zpp_inner,e),this.zpp_inner.outer=this,null!=t&&t.zpp_inner.weak&&(e=t.zpp_inner,t.zpp_inner.outer=null,t.zpp_inner=null,t.zpp_pool=Bn.poolVec2,Bn.poolVec2=t,null!=e.outer&&(e.outer.zpp_inner=null,e.outer=null),e._isimmutable=null,e._validate=null,e._invalidate=null,e.next=Gr.zpp_pool,Gr.zpp_pool=e)};_.__name__=["nape","space","Space"],_.prototype.zpp_inner=null,_.prototype.get_userData=function(){return null==this.zpp_inner.userData&&(this.zpp_inner.userData={}),this.zpp_inner.userData},_.prototype.get_gravity=function(){return null==this.zpp_inner.wrap_gravity&&this.zpp_inner.getgravity(),this.zpp_inner.wrap_gravity},_.prototype.set_gravity=function(t){null==this.zpp_inner.wrap_gravity&&this.zpp_inner.getgravity();var e=this.zpp_inner.wrap_gravity,i=t.zpp_inner;null!=i._validate&&i._validate();var n=t.zpp_inner.x,r=t.zpp_inner;null!=r._validate&&r._validate();var o,i=t.zpp_inner.y,r=e.zpp_inner;return null!=r._validate&&r._validate(),e.zpp_inner.x==n&&(null!=(r=e.zpp_inner)._validate&&r._validate(),e.zpp_inner.y==i)||(e.zpp_inner.x=n,e.zpp_inner.y=i,null!=(o=e.zpp_inner)._invalidate&&o._invalidate(o)),t.zpp_inner.weak&&(o=t.zpp_inner,t.zpp_inner.outer=null,t.zpp_inner=null,t.zpp_pool=Bn.poolVec2,Bn.poolVec2=t,null!=o.outer&&(o.outer.zpp_inner=null,o.outer=null),o._isimmutable=null,o._validate=null,o._invalidate=null,o.next=Gr.zpp_pool,Gr.zpp_pool=o),null==this.zpp_inner.wrap_gravity&&this.zpp_inner.getgravity(),this.zpp_inner.wrap_gravity},_.prototype.get_broadphase=function(){return this.zpp_inner.bphase.is_sweep?(null==Yn.Broadphase_SWEEP_AND_PRUNE&&(Yn.internal=!0,Yn.Broadphase_SWEEP_AND_PRUNE=new ft,Yn.internal=!1),Yn.Broadphase_SWEEP_AND_PRUNE):(null==Yn.Broadphase_DYNAMIC_AABB_TREE&&(Yn.internal=!0,Yn.Broadphase_DYNAMIC_AABB_TREE=new ft,Yn.internal=!1),Yn.Broadphase_DYNAMIC_AABB_TREE)},_.prototype.get_sortContacts=function(){return this.zpp_inner.sortcontacts},_.prototype.set_sortContacts=function(t){return this.zpp_inner.sortcontacts=t,this.zpp_inner.sortcontacts},_.prototype.get_worldAngularDrag=function(){return this.zpp_inner.global_ang_drag},_.prototype.set_worldAngularDrag=function(t){return this.zpp_inner.global_ang_drag=t,this.zpp_inner.global_ang_drag},_.prototype.get_worldLinearDrag=function(){return this.zpp_inner.global_lin_drag},_.prototype.set_worldLinearDrag=function(t){return this.zpp_inner.global_lin_drag=t,this.zpp_inner.global_lin_drag},_.prototype.get_compounds=function(){return this.zpp_inner.wrap_compounds},_.prototype.get_bodies=function(){return this.zpp_inner.wrap_bodies},_.prototype.get_liveBodies=function(){return this.zpp_inner.wrap_live},_.prototype.get_constraints=function(){return this.zpp_inner.wrap_constraints},_.prototype.get_liveConstraints=function(){return this.zpp_inner.wrap_livecon},_.prototype.visitBodies=function(t){var e=this.zpp_inner.wrap_bodies;e.zpp_inner.valmod();for(var i=$t.get(e);;){i.zpp_inner.zpp_inner.valmod();var n=i.zpp_inner;n.zpp_inner.valmod(),n.zpp_inner.zip_length&&(n.zpp_inner.zip_length=!1,n.zpp_inner.user_length=n.zpp_inner.inner.length);n=n.zpp_inner.user_length;if(i.zpp_critical=!0,!(i.zpp_i<n||(i.zpp_next=$t.zpp_pool,($t.zpp_pool=i).zpp_inner=null,!1)))break;i.zpp_critical=!1,t(i.zpp_inner.at(i.zpp_i++))}e=this.zpp_inner.wrap_compounds;e.zpp_inner.valmod();for(var r=te.get(e);;){r.zpp_inner.zpp_inner.valmod();var o=r.zpp_inner;o.zpp_inner.valmod(),o.zpp_inner.zip_length&&(o.zpp_inner.zip_length=!1,o.zpp_inner.user_length=o.zpp_inner.inner.length);o=o.zpp_inner.user_length;if(r.zpp_critical=!0,!(r.zpp_i<o||(r.zpp_next=te.zpp_pool,(te.zpp_pool=r).zpp_inner=null,!1)))break;r.zpp_critical=!1,r.zpp_inner.at(r.zpp_i++).visitBodies(t)}},_.prototype.visitConstraints=function(t){var e=this.zpp_inner.wrap_constraints;e.zpp_inner.valmod();for(var i=Xt.get(e);;){i.zpp_inner.zpp_inner.valmod();var n=i.zpp_inner;n.zpp_inner.valmod(),n.zpp_inner.zip_length&&(n.zpp_inner.zip_length=!1,n.zpp_inner.user_length=n.zpp_inner.inner.length);n=n.zpp_inner.user_length;if(i.zpp_critical=!0,!(i.zpp_i<n||(i.zpp_next=Xt.zpp_pool,(Xt.zpp_pool=i).zpp_inner=null,!1)))break;i.zpp_critical=!1,t(i.zpp_inner.at(i.zpp_i++))}e=this.zpp_inner.wrap_compounds;e.zpp_inner.valmod();for(var r=te.get(e);;){r.zpp_inner.zpp_inner.valmod();var o=r.zpp_inner;o.zpp_inner.valmod(),o.zpp_inner.zip_length&&(o.zpp_inner.zip_length=!1,o.zpp_inner.user_length=o.zpp_inner.inner.length);o=o.zpp_inner.user_length;if(r.zpp_critical=!0,!(r.zpp_i<o||(r.zpp_next=te.zpp_pool,(te.zpp_pool=r).zpp_inner=null,!1)))break;r.zpp_critical=!1,r.zpp_inner.at(r.zpp_i++).visitConstraints(t)}},_.prototype.visitCompounds=function(t){var e=this.zpp_inner.wrap_compounds;e.zpp_inner.valmod();for(var i=te.get(e);;){i.zpp_inner.zpp_inner.valmod();var n=i.zpp_inner;n.zpp_inner.valmod(),n.zpp_inner.zip_length&&(n.zpp_inner.zip_length=!1,n.zpp_inner.user_length=n.zpp_inner.inner.length);n=n.zpp_inner.user_length;if(i.zpp_critical=!0,!(i.zpp_i<n||(i.zpp_next=te.zpp_pool,(te.zpp_pool=i).zpp_inner=null,!1)))break;i.zpp_critical=!1;n=i.zpp_inner.at(i.zpp_i++);t(n),n.visitCompounds(t)}},_.prototype.get_world=function(){return this.zpp_inner.__static},_.prototype.get_arbiters=function(){var t;return null==this.zpp_inner.wrap_arbiters&&((t=new pe).space=this.zpp_inner,this.zpp_inner.wrap_arbiters=t),this.zpp_inner.wrap_arbiters},_.prototype.get_listeners=function(){return this.zpp_inner.wrap_listeners},_.prototype.clear=function(){this.zpp_inner.clear()},_.prototype.step=function(t,e,i){this.zpp_inner.step(t,e=null==e?10:e,i=null==i?10:i)},_.prototype.get_timeStamp=function(){return this.zpp_inner.stamp},_.prototype.get_elapsedTime=function(){return this.zpp_inner.time},_.prototype.interactionType=function(t,e){if(1==(null!=t.zpp_inner.body?t.zpp_inner.body.outer:null).zpp_inner.type&&1==(null!=e.zpp_inner.body?e.zpp_inner.body.outer:null).zpp_inner.type)return null;if((null!=t.zpp_inner.body?t.zpp_inner.body.outer:null)==(null!=e.zpp_inner.body?e.zpp_inner.body.outer:null))return null;for(var i,n,r,t=t.zpp_inner,e=e.zpp_inner,o=t.body,s=e.body,a=!1,h=o.constraints.head;null!=h;){var l=h.elt;if(l.ignore&&l.pair_exists(o.id,s.id)){a=!0;break}h=h.next}if(a)i=!1;else{for(var p=t;null!=p&&null==p.group;)p=null!=p.ishape?p.ishape.body:(null!=p.icompound?p.icompound:p.ibody).compound;var u,d=null==p?null:p.group;if(null==d)u=!1;else{for(var c=e;null!=c&&null==c.group;)c=null!=c.ishape?c.ishape.body:(null!=c.icompound?c.icompound:c.ibody).compound;var y=null==c?null:c.group;if(null==y)u=!1;else{for(var _=!1;null!=d&&null!=y;){if(d==y){_=d.ignore;break}d.depth<y.depth?y=y.group:d=d.group}u=_}}i=!u}switch(i?!(!t.sensorEnabled&&!e.sensorEnabled)&&(r=t.filter,n=e.filter,0!=(r.sensorMask&n.sensorGroup)&&0!=(n.sensorMask&r.sensorGroup))?2:!!(!(!t.fluidEnabled&&!e.fluidEnabled)&&(n=t.filter,r=e.filter,0!=(n.fluidMask&r.fluidGroup)&&0!=(r.fluidMask&n.fluidGroup)))&&!(0==o.imass&&0==s.imass&&0==o.iinertia&&0==s.iinertia)?0:(t=t.filter,e=e.filter,0!=(t.collisionMask&e.collisionGroup)&&0!=(e.collisionMask&t.collisionGroup)&&!(0==o.imass&&0==s.imass&&0==o.iinertia&&0==s.iinertia)?1:-1):-1){case 0:return null==Yn.InteractionType_FLUID&&(Yn.internal=!0,Yn.InteractionType_FLUID=new m,Yn.internal=!1),Yn.InteractionType_FLUID;case 1:return null==Yn.InteractionType_COLLISION&&(Yn.internal=!0,Yn.InteractionType_COLLISION=new m,Yn.internal=!1),Yn.InteractionType_COLLISION;case 2:return null==Yn.InteractionType_SENSOR&&(Yn.internal=!0,Yn.InteractionType_SENSOR=new m,Yn.internal=!1),Yn.InteractionType_SENSOR;default:return null}},_.prototype.shapesUnderPoint=function(t,e,i){var n=t.zpp_inner;null!=n._validate&&n._validate();var r=t.zpp_inner.x,n=t.zpp_inner;null!=n._validate&&n._validate();e=this.zpp_inner.shapesUnderPoint(r,t.zpp_inner.y,null==e?null:e.zpp_inner,i);return t.zpp_inner.weak&&(i=t.zpp_inner,t.zpp_inner.outer=null,t.zpp_inner=null,t.zpp_pool=Bn.poolVec2,Bn.poolVec2=t,null!=i.outer&&(i.outer.zpp_inner=null,i.outer=null),i._isimmutable=null,i._validate=null,i._invalidate=null,i.next=Gr.zpp_pool,Gr.zpp_pool=i),e},_.prototype.bodiesUnderPoint=function(t,e,i){var n=t.zpp_inner;null!=n._validate&&n._validate();var r=t.zpp_inner.x,n=t.zpp_inner;null!=n._validate&&n._validate();e=this.zpp_inner.bodiesUnderPoint(r,t.zpp_inner.y,null==e?null:e.zpp_inner,i);return t.zpp_inner.weak&&(i=t.zpp_inner,t.zpp_inner.outer=null,t.zpp_inner=null,t.zpp_pool=Bn.poolVec2,Bn.poolVec2=t,null!=i.outer&&(i.outer.zpp_inner=null,i.outer=null),i._isimmutable=null,i._validate=null,i._invalidate=null,i.next=Gr.zpp_pool,Gr.zpp_pool=i),e},_.prototype.shapesInAABB=function(t,e,i,n,r){return this.zpp_inner.shapesInAABB(t,i=null==i?!0:i,e=null==e?!1:e,null==n?null:n.zpp_inner,r)},_.prototype.bodiesInAABB=function(t,e,i,n,r){return this.zpp_inner.bodiesInAABB(t,i=null==i?!0:i,e=null==e?!1:e,null==n?null:n.zpp_inner,r)},_.prototype.shapesInCircle=function(t,e,i,n,r){n=this.zpp_inner.shapesInCircle(t,e,i=null==i?!1:i,null==n?null:n.zpp_inner,r);return t.zpp_inner.weak&&(r=t.zpp_inner,t.zpp_inner.outer=null,t.zpp_inner=null,t.zpp_pool=Bn.poolVec2,Bn.poolVec2=t,null!=r.outer&&(r.outer.zpp_inner=null,r.outer=null),r._isimmutable=null,r._validate=null,r._invalidate=null,r.next=Gr.zpp_pool,Gr.zpp_pool=r),n},_.prototype.bodiesInCircle=function(t,e,i,n,r){n=this.zpp_inner.bodiesInCircle(t,e,i=null==i?!1:i,null==n?null:n.zpp_inner,r);return t.zpp_inner.weak&&(r=t.zpp_inner,t.zpp_inner.outer=null,t.zpp_inner=null,t.zpp_pool=Bn.poolVec2,Bn.poolVec2=t,null!=r.outer&&(r.outer.zpp_inner=null,r.outer=null),r._isimmutable=null,r._validate=null,r._invalidate=null,r.next=Gr.zpp_pool,Gr.zpp_pool=r),n},_.prototype.shapesInShape=function(t,e,i,n){return this.zpp_inner.shapesInShape(t.zpp_inner,e=null==e?!1:e,null==i?null:i.zpp_inner,n)},_.prototype.bodiesInShape=function(t,e,i,n){return this.zpp_inner.bodiesInShape(t.zpp_inner,e=null==e?!1:e,null==i?null:i.zpp_inner,n)},_.prototype.shapesInBody=function(t,e,i){var n=null==i?new _t:i,t=t.zpp_inner.wrap_shapes;t.zpp_inner.valmod();for(var r=ne.get(t);;){r.zpp_inner.zpp_inner.valmod();var o=r.zpp_inner;o.zpp_inner.valmod(),o.zpp_inner.zip_length&&(o.zpp_inner.zip_length=!1,o.zpp_inner.user_length=o.zpp_inner.inner.length);o=o.zpp_inner.user_length;if(r.zpp_critical=!0,!(r.zpp_i<o||(r.zpp_next=ne.zpp_pool,(ne.zpp_pool=r).zpp_inner=null,!1)))break;r.zpp_critical=!1,this.shapesInShape(r.zpp_inner.at(r.zpp_i++),!1,e,n)}return n},_.prototype.bodiesInBody=function(t,e,i){var n=null==i?new tt:i,t=t.zpp_inner.wrap_shapes;t.zpp_inner.valmod();for(var r=ne.get(t);;){r.zpp_inner.zpp_inner.valmod();var o=r.zpp_inner;o.zpp_inner.valmod(),o.zpp_inner.zip_length&&(o.zpp_inner.zip_length=!1,o.zpp_inner.user_length=o.zpp_inner.inner.length);o=o.zpp_inner.user_length;if(r.zpp_critical=!0,!(r.zpp_i<o||(r.zpp_next=ne.zpp_pool,(ne.zpp_pool=r).zpp_inner=null,!1)))break;r.zpp_critical=!1,this.bodiesInShape(r.zpp_inner.at(r.zpp_i++),!1,e,n)}return n},_.prototype.convexCast=function(t,e,i,n){return this.zpp_inner.convexCast(t.zpp_inner,e,n,i=null==i?!1:i)},_.prototype.convexMultiCast=function(t,e,i,n,r){return this.zpp_inner.convexMultiCast(t.zpp_inner,e,n,i=null==i?!1:i,r)},_.prototype.rayCast=function(t,e,i){return this.zpp_inner.rayCast(t,e=null==e?!1:e,i)},_.prototype.rayMultiCast=function(t,e,i,n){return this.zpp_inner.rayMultiCast(t,e=null==e?!1:e,i,n)},Object.defineProperty(_.prototype,"userData",{get:_.prototype.get_userData}),Object.defineProperty(_.prototype,"gravity",{get:_.prototype.get_gravity,set:_.prototype.set_gravity}),Object.defineProperty(_.prototype,"broadphase",{get:_.prototype.get_broadphase}),Object.defineProperty(_.prototype,"sortContacts",{get:_.prototype.get_sortContacts,set:_.prototype.set_sortContacts}),Object.defineProperty(_.prototype,"worldAngularDrag",{get:_.prototype.get_worldAngularDrag,set:_.prototype.set_worldAngularDrag}),Object.defineProperty(_.prototype,"worldLinearDrag",{get:_.prototype.get_worldLinearDrag,set:_.prototype.set_worldLinearDrag}),Object.defineProperty(_.prototype,"compounds",{get:_.prototype.get_compounds}),Object.defineProperty(_.prototype,"bodies",{get:_.prototype.get_bodies}),Object.defineProperty(_.prototype,"liveBodies",{get:_.prototype.get_liveBodies}),Object.defineProperty(_.prototype,"constraints",{get:_.prototype.get_constraints}),Object.defineProperty(_.prototype,"liveConstraints",{get:_.prototype.get_liveConstraints}),Object.defineProperty(_.prototype,"world",{get:_.prototype.get_world}),Object.defineProperty(_.prototype,"arbiters",{get:_.prototype.get_arbiters}),Object.defineProperty(_.prototype,"listeners",{get:_.prototype.get_listeners}),Object.defineProperty(_.prototype,"timeStamp",{get:_.prototype.get_timeStamp}),Object.defineProperty(_.prototype,"elapsedTime",{get:_.prototype.get_elapsedTime}),_.prototype.__class__=_;o=nape.util.Debug=function(){};o.__name__=["nape","util","Debug"],o.version=function(){return"Nape 2.0.19"},o.clearObjectPools=function(){for(;null!=Xt.zpp_pool;){var t=Xt.zpp_pool.zpp_next;Xt.zpp_pool.zpp_next=null,Xt.zpp_pool=t}for(;null!=ee.zpp_pool;){var e=ee.zpp_pool.zpp_next;ee.zpp_pool.zpp_next=null,ee.zpp_pool=e}for(;null!=$t.zpp_pool;){var i=$t.zpp_pool.zpp_next;$t.zpp_pool.zpp_next=null,$t.zpp_pool=i}for(;null!=te.zpp_pool;){var n=te.zpp_pool.zpp_next;te.zpp_pool.zpp_next=null,te.zpp_pool=n}for(;null!=Wt.zpp_pool;){var r=Wt.zpp_pool.zpp_next;Wt.zpp_pool.zpp_next=null,Wt.zpp_pool=r}for(;null!=Vt.zpp_pool;){var o=Vt.zpp_pool.zpp_next;Vt.zpp_pool.zpp_next=null,Vt.zpp_pool=o}for(;null!=Kt.zpp_pool;){var s=Kt.zpp_pool.zpp_next;Kt.zpp_pool.zpp_next=null,Kt.zpp_pool=s}for(;null!=Zt.zpp_pool;){var a=Zt.zpp_pool.zpp_next;Zt.zpp_pool.zpp_next=null,Zt.zpp_pool=a}for(;null!=Qt.zpp_pool;){var h=Qt.zpp_pool.zpp_next;Qt.zpp_pool.zpp_next=null,Qt.zpp_pool=h}for(;null!=Jt.zpp_pool;){var l=Jt.zpp_pool.zpp_next;Jt.zpp_pool.zpp_next=null,Jt.zpp_pool=l}for(;null!=ne.zpp_pool;){var p=ne.zpp_pool.zpp_next;ne.zpp_pool.zpp_next=null,ne.zpp_pool=p}for(;null!=ie.zpp_pool;){var u=ie.zpp_pool.zpp_next;ie.zpp_pool.zpp_next=null,ie.zpp_pool=u}for(;null!=qt.zpp_pool;){var d=qt.zpp_pool.zpp_next;qt.zpp_pool.zpp_next=null,qt.zpp_pool=d}for(;null!=Ht.zpp_pool;){var c=Ht.zpp_pool.zpp_next;Ht.zpp_pool.zpp_next=null,Ht.zpp_pool=c}for(;null!=Yt.zpp_pool;){var y=Yt.zpp_pool.zpp_next;Yt.zpp_pool.zpp_next=null,Yt.zpp_pool=y}for(;null!=Ui.zpp_pool;){var _=Ui.zpp_pool.next;Ui.zpp_pool.next=null,Ui.zpp_pool=_}for(;null!=Vi.zpp_pool;){var m=Vi.zpp_pool.next;Vi.zpp_pool.next=null,Vi.zpp_pool=m}for(;null!=Ue.zpp_pool;){var g=Ue.zpp_pool.next;Ue.zpp_pool.next=null,Ue.zpp_pool=g}for(;null!=Wi.zpp_pool;){var f=Wi.zpp_pool.next;Wi.zpp_pool.next=null,Wi.zpp_pool=f}for(;null!=je.zpp_pool;){var x=je.zpp_pool.next;je.zpp_pool.next=null,je.zpp_pool=x}for(;null!=Xi.zpp_pool;){var v=Xi.zpp_pool.next;Xi.zpp_pool.next=null,Xi.zpp_pool=v}for(;null!=Hi.zpp_pool;){var w=Hi.zpp_pool.next;Hi.zpp_pool.next=null,Hi.zpp_pool=w}for(;null!=qi.zpp_pool;){var z=qi.zpp_pool.next;qi.zpp_pool.next=null,qi.zpp_pool=z}for(;null!=er.zpp_pool;){var b=er.zpp_pool.next;er.zpp_pool.next=null,er.zpp_pool=b}for(;null!=Rn.zpp_pool;){var S=Rn.zpp_pool.next;Rn.zpp_pool.next=null,Rn.zpp_pool=S}for(;null!=qn.zpp_pool;){var C=qn.zpp_pool.next;qn.zpp_pool.next=null,qn.zpp_pool=C}for(;null!=ir.zpp_pool;){var P=ir.zpp_pool.next;ir.zpp_pool.next=null,ir.zpp_pool=P}for(;null!=Yi.zpp_pool;){var M=Yi.zpp_pool.next;Yi.zpp_pool.next=null,Yi.zpp_pool=M}for(;null!=nr.zpp_pool;){var T=nr.zpp_pool.next;nr.zpp_pool.next=null,nr.zpp_pool=T}for(;null!=Ki.zpp_pool;){var A=Ki.zpp_pool.next;Ki.zpp_pool.next=null,Ki.zpp_pool=A}for(;null!=re.zpp_pool;){var k=re.zpp_pool.next;re.zpp_pool.next=null,re.zpp_pool=k}for(;null!=Hn.zpp_pool;){var O=Hn.zpp_pool.next;Hn.zpp_pool.next=null,Hn.zpp_pool=O}for(;null!=Zi.zpp_pool;){var E=Zi.zpp_pool.next;Zi.zpp_pool.next=null,Zi.zpp_pool=E}for(;null!=Ji.zpp_pool;){var I=Ji.zpp_pool.next;Ji.zpp_pool.next=null,Ji.zpp_pool=I}for(;null!=nn.zpp_pool;){var G=nn.zpp_pool.next;nn.zpp_pool.next=null,nn.zpp_pool=G}for(;null!=me.zpp_pool;){var D=me.zpp_pool.next;me.zpp_pool.next=null,me.zpp_pool=D}for(;null!=fe.zpp_pool;){var L=fe.zpp_pool.next;fe.zpp_pool.next=null,fe.zpp_pool=L}for(;null!=Fn.zpp_pool;){var B=Fn.zpp_pool.next;Fn.zpp_pool.next=null,Fn.zpp_pool=B}for(;null!=gi.zpp_pool;){var R=gi.zpp_pool.next;gi.zpp_pool.next=null,gi.zpp_pool=R}for(;null!=fi.zpp_pool;){var F=fi.zpp_pool.next;fi.zpp_pool.next=null,fi.zpp_pool=F}for(;null!=Qi.zpp_pool;){var N=Qi.zpp_pool.next;Qi.zpp_pool.next=null,Qi.zpp_pool=N}for(;null!=$i.zpp_pool;){var j=$i.zpp_pool.next;$i.zpp_pool.next=null,$i.zpp_pool=j}for(;null!=Gr.zpp_pool;){var U=Gr.zpp_pool.next;Gr.zpp_pool.next=null,Gr.zpp_pool=U}for(;null!=tn.zpp_pool;){var V=tn.zpp_pool.next;tn.zpp_pool.next=null,tn.zpp_pool=V}for(;null!=we.zpp_pool;){var W=we.zpp_pool.next;we.zpp_pool.next=null,we.zpp_pool=W}for(;null!=Nn.zpp_pool;){var X=Nn.zpp_pool.next;Nn.zpp_pool.next=null,Nn.zpp_pool=X}for(;null!=Ae.zpp_pool;){var H=Ae.zpp_pool.next;Ae.zpp_pool.next=null,Ae.zpp_pool=H}for(;null!=ke.zpp_pool;){var q=ke.zpp_pool.next;ke.zpp_pool.next=null,ke.zpp_pool=q}for(;null!=ze.zpp_pool;){var Y=ze.zpp_pool.next;ze.zpp_pool.next=null,ze.zpp_pool=Y}for(;null!=en.zpp_pool;){var K=en.zpp_pool.next;en.zpp_pool.next=null,en.zpp_pool=K}for(;null!=sn.zpp_pool;){var Z=sn.zpp_pool.next;sn.zpp_pool.next=null,sn.zpp_pool=Z}for(;null!=Ge.zpp_pool;){var J=Ge.zpp_pool.next;Ge.zpp_pool.next=null,Ge.zpp_pool=J}for(;null!=jn.zpp_pool;){var Q=jn.zpp_pool.next;jn.zpp_pool.next=null,jn.zpp_pool=Q}for(;null!=an.zpp_pool;){var $=an.zpp_pool.next;an.zpp_pool.next=null,an.zpp_pool=$}for(;null!=De.zpp_pool;){var tt=De.zpp_pool.next;De.zpp_pool.next=null,De.zpp_pool=tt}for(;null!=Un.zpp_pool;){var et=Un.zpp_pool.next;Un.zpp_pool.next=null,Un.zpp_pool=et}for(;null!=Se.zpp_pool;){var it=Se.zpp_pool.next;Se.zpp_pool.next=null,Se.zpp_pool=it}for(;null!=Ce.zpp_pool;){var nt=Ce.zpp_pool.next;Ce.zpp_pool.next=null,Ce.zpp_pool=nt}for(;null!=Vn.zpp_pool;){var rt=Vn.zpp_pool.next;Vn.zpp_pool.next=null,Vn.zpp_pool=rt}for(;null!=Wn.zpp_pool;){var ot=Wn.zpp_pool.next;Wn.zpp_pool.next=null,Wn.zpp_pool=ot}for(;null!=Pe.zpp_pool;){var st=Pe.zpp_pool.next;Pe.zpp_pool.next=null,Pe.zpp_pool=st}for(;null!=hi.zpp_pool;){var at=hi.zpp_pool.next;hi.zpp_pool.next=null,hi.zpp_pool=at}for(;null!=Ee.zpp_pool;){var ht=Ee.zpp_pool.next;Ee.zpp_pool.next=null,Ee.zpp_pool=ht}for(;null!=hn.zpp_pool;){var lt=hn.zpp_pool.next;hn.zpp_pool.next=null,hn.zpp_pool=lt}for(;null!=ln.zpp_pool;){var pt=ln.zpp_pool.next;ln.zpp_pool.next=null,ln.zpp_pool=pt}for(;null!=ge.zpp_pool;){var ut=ge.zpp_pool.next;ge.zpp_pool.next=null,ge.zpp_pool=ut}for(;null!=rn.zpp_pool;){var dt=rn.zpp_pool.next;rn.zpp_pool.next=null,rn.zpp_pool=dt}for(;null!=pn.zpp_pool;){var ct=pn.zpp_pool.next;pn.zpp_pool.next=null,pn.zpp_pool=ct}for(;null!=Xe.zpp_pool;){var yt=Xe.zpp_pool.next;Xe.zpp_pool.next=null,Xe.zpp_pool=yt}for(;null!=un.zpp_pool;){var _t=un.zpp_pool.next;un.zpp_pool.next=null,un.zpp_pool=_t}for(;null!=dn.zpp_pool;){var mt=dn.zpp_pool.next;dn.zpp_pool.next=null,dn.zpp_pool=mt}for(;null!=ni.zpp_pool;){var gt=ni.zpp_pool.next;ni.zpp_pool.next=null,ni.zpp_pool=gt}for(;null!=Ye.zpp_pool;){var ft=Ye.zpp_pool.next;Ye.zpp_pool.next=null,Ye.zpp_pool=ft}for(;null!=Ke.zpp_pool;){var xt=Ke.zpp_pool.next;Ke.zpp_pool.next=null,Ke.zpp_pool=xt}for(;null!=cn.zpp_pool;){var vt=cn.zpp_pool.next;cn.zpp_pool.next=null,cn.zpp_pool=vt}for(;null!=Qn.zpp_pool;){var wt=Qn.zpp_pool.next;Qn.zpp_pool.next=null,Qn.zpp_pool=wt}for(;null!=yn.zpp_pool;){var zt=yn.zpp_pool.next;yn.zpp_pool.next=null,yn.zpp_pool=zt}for(;null!=$e.zpp_pool;){var bt=$e.zpp_pool.next;$e.zpp_pool.next=null,$e.zpp_pool=bt}for(;null!=ti.zpp_pool;){var St=ti.zpp_pool.next;ti.zpp_pool.next=null,ti.zpp_pool=St}for(;null!=tr.zpp_pool;){var Ct=tr.zpp_pool.next;tr.zpp_pool.next=null,tr.zpp_pool=Ct}for(;null!=Kn.zpp_pool;){var Pt=Kn.zpp_pool.next;Kn.zpp_pool.next=null,Kn.zpp_pool=Pt}for(;null!=Zn.zpp_pool;){var Mt=Zn.zpp_pool.next;Zn.zpp_pool.next=null,Zn.zpp_pool=Mt}for(;null!=ar.zpp_pool;){var Tt=ar.zpp_pool.next;ar.zpp_pool.next=null,ar.zpp_pool=Tt}for(;null!=rr.zpp_pool;){var At=rr.zpp_pool.next;rr.zpp_pool.next=null,rr.zpp_pool=At}for(;null!=Jn.zpp_pool;){var kt=Jn.zpp_pool.next;Jn.zpp_pool.next=null,Jn.zpp_pool=kt}for(;null!=or.zpp_pool;){var Ot=or.zpp_pool.next;or.zpp_pool.next=null,or.zpp_pool=Ot}for(;null!=_n.zpp_pool;){var Et=_n.zpp_pool.next;_n.zpp_pool.next=null,_n.zpp_pool=Et}for(;null!=sr.zpp_pool;){var It=sr.zpp_pool.next;sr.zpp_pool.next=null,sr.zpp_pool=It}for(;null!=mn.zpp_pool;){var Gt=mn.zpp_pool.next;mn.zpp_pool.next=null,mn.zpp_pool=Gt}for(;null!=gn.zpp_pool;){var Dt=gn.zpp_pool.next;gn.zpp_pool.next=null,gn.zpp_pool=Dt}for(;null!=he.zpp_pool;){var Lt=he.zpp_pool.next;he.zpp_pool.next=null,he.zpp_pool=Lt}for(;null!=fn.zpp_pool;){var Bt=fn.zpp_pool.next;fn.zpp_pool.next=null,fn.zpp_pool=Bt}for(;null!=xn.zpp_pool;){var Rt=xn.zpp_pool.next;xn.zpp_pool.next=null,xn.zpp_pool=Rt}for(;null!=vn.zpp_pool;){var Ft=vn.zpp_pool.next;vn.zpp_pool.next=null,vn.zpp_pool=Ft}for(;null!=Bn.poolGeomPoly;){var Nt=Bn.poolGeomPoly.zpp_pool;Bn.poolGeomPoly.zpp_pool=null,Bn.poolGeomPoly=Nt}for(;null!=Bn.poolVec2;){var jt=Bn.poolVec2.zpp_pool;Bn.poolVec2.zpp_pool=null,Bn.poolVec2=jt}for(;null!=Bn.poolVec3;){var Ut=Bn.poolVec3.zpp_pool;Bn.poolVec3.zpp_pool=null,Bn.poolVec3=Ut}},o.prototype.__class__=o;c=sandbox.Main=function(){};c.__name__=["sandbox","Main"],c.main=function(){},c.prototype.__class__=c;_=zpp_nape.ZPP_Const=function(){};_.__name__=["zpp_nape","ZPP_Const"],_.POSINF=function(){return 1/0},_.NEGINF=function(){return-1/0},_.prototype.__class__=_;var xt=zpp_nape.ZPP_ID=function(){};xt.__name__=["zpp_nape","ZPP_ID"],xt.Constraint=function(){return xt._Constraint++},xt.Interactor=function(){return xt._Interactor++},xt.CbType=function(){return xt._CbType++},xt.CbSet=function(){return xt._CbSet++},xt.Listener=function(){return xt._Listener++},xt.ZPP_SimpleVert=function(){return xt._ZPP_SimpleVert++},xt.ZPP_SimpleSeg=function(){return xt._ZPP_SimpleSeg++},xt.Space=function(){return xt._Space++},xt.InteractionGroup=function(){return xt._InteractionGroup++},xt.prototype.__class__=xt;var re=zpp_nape.callbacks.ZPP_Callback=function(){this.constraint=null,this.body=null,this.pre_swapped=!1,this.pre_arbiter=null,this.wrap_arbiters=null,this.set=null,this.int2=null,this.int1=null,this.length=0,this.prev=null,this.next=null,this.index=0,this.space=null,this.listener=null,this.event=0,this.outer_int=null,this.outer_con=null,this.outer_body=null,this.length=0};re.__name__=["zpp_nape","callbacks","ZPP_Callback"],re.prototype.outer_body=null,re.prototype.outer_con=null,re.prototype.outer_int=null,re.prototype.wrapper_body=function(){return null==this.outer_body&&(this.outer_body=new i,this.outer_body.zpp_inner=this),this.outer_body},re.prototype.wrapper_con=function(){return null==this.outer_con&&(this.outer_con=new s,this.outer_con.zpp_inner=this),this.outer_con},re.prototype.wrapper_int=function(){return null==this.outer_int&&(this.outer_int=new y,this.outer_int.zpp_inner=this),null==this.wrap_arbiters?this.wrap_arbiters=Dn.get(this.set.arbiters,!0):this.wrap_arbiters.zpp_inner.inner=this.set.arbiters,this.wrap_arbiters.zpp_inner.zip_length=!0,this.wrap_arbiters.zpp_inner.at_ite=null,this.outer_int},re.prototype.event=null,re.prototype.listener=null,re.prototype.space=null,re.prototype.index=null,re.prototype.next=null,re.prototype.prev=null,re.prototype.length=null,re.prototype.push=function(t){null!=this.prev?this.prev.next=t:this.next=t,t.prev=this.prev,t.next=null,this.prev=t,this.length++},re.prototype.push_rev=function(t){null!=this.next?this.next.prev=t:this.prev=t,t.next=this.next,t.prev=null,this.next=t,this.length++},re.prototype.pop=function(){var t=this.next;return this.next=t.next,null==this.next?this.prev=null:this.next.prev=null,this.length--,t},re.prototype.pop_rev=function(){var t=this.prev;return this.prev=t.prev,null==this.prev?this.next=null:this.prev.next=null,this.length--,t},re.prototype.empty=function(){return null==this.next},re.prototype.clear=function(){for(;!this.empty();)this.pop()},re.prototype.splice=function(t){var e=t.next;return null==t.prev?(this.next=t.next,null!=this.next?this.next.prev=null:this.prev=null):(t.prev.next=t.next,null!=t.next?t.next.prev=t.prev:this.prev=t.prev),this.length--,e},re.prototype.rotateL=function(){this.push(this.pop())},re.prototype.rotateR=function(){this.push_rev(this.pop_rev())},re.prototype.cycleNext=function(t){return(null==t.next?this:t).next},re.prototype.cyclePrev=function(t){return(null==t.prev?this:t).prev},re.prototype.at=function(t){for(var e=this.next;0!=t--;)e=e.next;return e},re.prototype.rev_at=function(t){for(var e=this.prev;0!=t--;)e=e.prev;return e},re.prototype.free=function(){this.int1=this.int2=null,this.body=null,this.constraint=null,(this.listener=null)!=this.wrap_arbiters&&(this.wrap_arbiters.zpp_inner.inner=null),this.set=null},re.prototype.alloc=function(){},re.prototype.int1=null,re.prototype.int2=null,re.prototype.set=null,re.prototype.wrap_arbiters=null,re.prototype.pre_arbiter=null,re.prototype.pre_swapped=null,re.prototype.genarbs=function(){null==this.wrap_arbiters?this.wrap_arbiters=Dn.get(this.set.arbiters,!0):this.wrap_arbiters.zpp_inner.inner=this.set.arbiters,this.wrap_arbiters.zpp_inner.zip_length=!0,this.wrap_arbiters.zpp_inner.at_ite=null},re.prototype.body=null,re.prototype.constraint=null,re.prototype.__class__=re;var Hn=zpp_nape.callbacks.ZPP_CbSet=function(){this.wrap_constraints=null,this.constraints=null,this.wrap_interactors=null,this.interactors=null,this.zip_conlisteners=!1,this.conlisteners=null,this.zip_bodylisteners=!1,this.bodylisteners=null,this.zip_listeners=!1,this.listeners=null,this.cbpairs=null,this.manager=null,this.id=0,this.next=null,this.count=0,this.cbTypes=null,this.cbTypes=new Et,this.listeners=new vt,this.zip_listeners=!0,this.bodylisteners=new wt,this.zip_bodylisteners=!0,this.conlisteners=new zt,this.zip_conlisteners=!0,this.constraints=new Ct,this.interactors=new Pt,this.id=xt.CbSet(),this.cbpairs=new vi};Hn.__name__=["zpp_nape","callbacks","ZPP_CbSet"],Hn.setlt=function(t,e){for(var i=t.cbTypes.head,n=e.cbTypes.head;null!=i&&null!=n;){var r=i.elt,o=n.elt;if(r.id<o.id)return!0;if(o.id<r.id)return!1;i=i.next,n=n.next}return null!=n&&null==i},Hn.get=function(t){var e;null==Hn.zpp_pool?e=new Hn:(e=Hn.zpp_pool,Hn.zpp_pool=e.next,e.next=null);for(var i=null,n=t.head;null!=n;){var r=n.elt,i=e.cbTypes.insert(i,r);r.cbsets.add(e),n=n.next}return e},Hn.compatible=function(t,e,i){var n=t.options1,r=e.cbTypes;if(!(!n.nonemptyintersection(r,n.includes)||n.nonemptyintersection(r,n.excludes))&&(o=t.options2,n=i.cbTypes,!!o.nonemptyintersection(n,o.includes)&&!o.nonemptyintersection(n,o.excludes)))return!0;var o=t.options2,e=e.cbTypes;if(!o.nonemptyintersection(e,o.includes)||o.nonemptyintersection(e,o.excludes))return!1;t=t.options1,i=i.cbTypes;return!!t.nonemptyintersection(i,t.includes)&&!t.nonemptyintersection(i,t.excludes)},Hn.empty_intersection=function(t,e){for(var i,n=null,r=(t.cbpairs.length<e.cbpairs.length?t:e).cbpairs.head;null!=r;){var o=r.elt;if(o.a==t&&o.b==e||o.a==e&&o.b==t){n=o;break}r=r.next}return null==n&&(null==qn.zpp_pool?i=new qn:(i=qn.zpp_pool,qn.zpp_pool=i.next,i.next=null),i.zip_listeners=!0,Hn.setlt(t,e)?(i.a=t,i.b=e):(i.a=e,i.b=t),n=i,t.cbpairs.add(n),e!=t&&e.cbpairs.add(n)),n.zip_listeners&&(n.zip_listeners=!1,n.__validate()),null==n.listeners.head},Hn.single_intersection=function(t,e,i){for(var n=null,r=(t.cbpairs.length<e.cbpairs.length?t:e).cbpairs.head;null!=r;){var o=r.elt;if(o.a==t&&o.b==e||o.a==e&&o.b==t){n=o;break}r=r.next}null==n&&(null==qn.zpp_pool?s=new qn:(s=qn.zpp_pool,qn.zpp_pool=s.next,s.next=null),s.zip_listeners=!0,Hn.setlt(t,e)?(s.a=t,s.b=e):(s.a=e,s.b=t),n=s,t.cbpairs.add(n),e!=t&&e.cbpairs.add(n)),n.zip_listeners&&(n.zip_listeners=!1,n.__validate());var s=n.listeners.head;return null!=s&&s.elt==i&&null==s.next},Hn.find_all=function(t,e,i,n){for(var r,o=null,s=(t.cbpairs.length<e.cbpairs.length?t:e).cbpairs.head;null!=s;){var a=s.elt;if(a.a==t&&a.b==e||a.a==e&&a.b==t){o=a;break}s=s.next}null==o&&(null==qn.zpp_pool?r=new qn:(r=qn.zpp_pool,qn.zpp_pool=r.next,r.next=null),r.zip_listeners=!0,Hn.setlt(t,e)?(r.a=t,r.b=e):(r.a=e,r.b=t),o=r,t.cbpairs.add(o),e!=t&&e.cbpairs.add(o)),o.zip_listeners&&(o.zip_listeners=!1,o.__validate());for(var h=o.listeners.head;null!=h;){var l=h.elt;l.event==i&&n(l),h=h.next}},Hn.prototype.cbTypes=null,Hn.prototype.count=null,Hn.prototype.next=null,Hn.prototype.id=null,Hn.prototype.manager=null,Hn.prototype.cbpairs=null,Hn.prototype.increment=function(){this.count++},Hn.prototype.decrement=function(){return 0==--this.count},Hn.prototype.invalidate_pairs=function(){for(var t=this.cbpairs.head;null!=t;)t.elt.zip_listeners=!0,t=t.next},Hn.prototype.listeners=null,Hn.prototype.zip_listeners=null,Hn.prototype.invalidate_listeners=function(){this.zip_listeners=!0,this.invalidate_pairs()},Hn.prototype.validate_listeners=function(){this.zip_listeners&&(this.zip_listeners=!1,this.realvalidate_listeners())},Hn.prototype.realvalidate_listeners=function(){this.listeners.clear();for(var t=this.cbTypes.head;null!=t;){for(var e=null,i=this.listeners.head,n=t.elt.listeners.head;null!=n;){var r,o,s=n.elt;null!=i&&i.elt==s?(n=n.next,i=(e=i).next):null==i||(r=i.elt,!(s.precedence<=r.precedence)||s.precedence==r.precedence&&s.id>r.id)?(s.space==this.manager.space&&(r=this.listeners,null==ir.zpp_pool?o=new ir:(o=ir.zpp_pool,ir.zpp_pool=o.next,o.next=null),o.elt=s,s=o,null==e?(s.next=r.head,r.head=s):(s.next=e.next,e.next=s),r.pushmod=r.modified=!0,r.length++,e=s),n=n.next):i=(e=i).next}t=t.next}},Hn.prototype.bodylisteners=null,Hn.prototype.zip_bodylisteners=null,Hn.prototype.invalidate_bodylisteners=function(){this.zip_bodylisteners=!0},Hn.prototype.validate_bodylisteners=function(){this.zip_bodylisteners&&(this.zip_bodylisteners=!1,this.realvalidate_bodylisteners())},Hn.prototype.realvalidate_bodylisteners=function(){this.bodylisteners.clear();for(var t=this.cbTypes.head;null!=t;){for(var e=null,i=this.bodylisteners.head,n=t.elt.bodylisteners.head;null!=n;){var r,o,s=n.elt;null!=i&&i.elt==s?(n=n.next,i=(e=i).next):null==i||(r=i.elt,!(s.precedence<=r.precedence)||s.precedence==r.precedence&&s.id>r.id)?(!(r=s.options).nonemptyintersection(this.cbTypes,r.excludes)&&s.space==this.manager.space&&(r=this.bodylisteners,null==Ki.zpp_pool?o=new Ki:(o=Ki.zpp_pool,Ki.zpp_pool=o.next,o.next=null),o.elt=s,s=o,null==e?(s.next=r.head,r.head=s):(s.next=e.next,e.next=s),r.pushmod=r.modified=!0,r.length++,e=s),n=n.next):i=(e=i).next}t=t.next}},Hn.prototype.conlisteners=null,Hn.prototype.zip_conlisteners=null,Hn.prototype.invalidate_conlisteners=function(){this.zip_conlisteners=!0},Hn.prototype.validate_conlisteners=function(){this.zip_conlisteners&&(this.zip_conlisteners=!1,this.realvalidate_conlisteners())},Hn.prototype.realvalidate_conlisteners=function(){this.conlisteners.clear();for(var t=this.cbTypes.head;null!=t;){for(var e=null,i=this.conlisteners.head,n=t.elt.conlisteners.head;null!=n;){var r,o,s=n.elt;null!=i&&i.elt==s?(n=n.next,i=(e=i).next):null==i||(r=i.elt,!(s.precedence<=r.precedence)||s.precedence==r.precedence&&s.id>r.id)?(!(r=s.options).nonemptyintersection(this.cbTypes,r.excludes)&&s.space==this.manager.space&&(r=this.conlisteners,null==Ji.zpp_pool?o=new Ji:(o=Ji.zpp_pool,Ji.zpp_pool=o.next,o.next=null),o.elt=s,s=o,null==e?(s.next=r.head,r.head=s):(s.next=e.next,e.next=s),r.pushmod=r.modified=!0,r.length++,e=s),n=n.next):i=(e=i).next}t=t.next}},Hn.prototype.validate=function(){this.zip_listeners&&(this.zip_listeners=!1,this.realvalidate_listeners()),this.zip_bodylisteners&&(this.zip_bodylisteners=!1,this.realvalidate_bodylisteners()),this.zip_conlisteners&&(this.zip_conlisteners=!1,this.realvalidate_conlisteners())},Hn.prototype.interactors=null,Hn.prototype.wrap_interactors=null,Hn.prototype.constraints=null,Hn.prototype.wrap_constraints=null,Hn.prototype.addConstraint=function(t){this.constraints.add(t)},Hn.prototype.addInteractor=function(t){this.interactors.add(t)},Hn.prototype.remConstraint=function(t){this.constraints.remove(t)},Hn.prototype.remInteractor=function(t){this.interactors.remove(t)},Hn.prototype.free=function(){for(this.listeners.clear(),this.zip_listeners=!0,this.bodylisteners.clear(),this.zip_bodylisteners=!0,this.conlisteners.clear(),this.zip_conlisteners=!0;null!=this.cbTypes.head;)this.cbTypes.pop_unsafe().cbsets.remove(this)},Hn.prototype.alloc=function(){},Hn.prototype.__class__=Hn;var qn=zpp_nape.callbacks.ZPP_CbSetPair=function(){this.listeners=null,this.zip_listeners=!1,this.next=null,this.b=null,this.a=null,this.listeners=new vt};qn.__name__=["zpp_nape","callbacks","ZPP_CbSetPair"],qn.get=function(t,e){var i;return null==qn.zpp_pool?i=new qn:(i=qn.zpp_pool,qn.zpp_pool=i.next,i.next=null),i.zip_listeners=!0,Hn.setlt(t,e)?(i.a=t,i.b=e):(i.a=e,i.b=t),i},qn.setlt=function(t,e){return!!Hn.setlt(t.a,e.a)||t.a==e.a&&Hn.setlt(t.b,e.b)},qn.prototype.a=null,qn.prototype.b=null,qn.prototype.next=null,qn.prototype.free=function(){this.a=this.b=null,this.listeners.clear()},qn.prototype.alloc=function(){this.zip_listeners=!0},qn.prototype.compatible=function(t){var e=t.options1,i=this.a.cbTypes;if(!(!e.nonemptyintersection(i,e.includes)||e.nonemptyintersection(i,e.excludes))&&(r=t.options2,n=this.b.cbTypes,!!r.nonemptyintersection(n,r.includes)&&!r.nonemptyintersection(n,r.excludes)))return!0;var n=t.options2,r=this.a.cbTypes;if(!n.nonemptyintersection(r,n.includes)||n.nonemptyintersection(r,n.excludes))return!1;n=t.options1,t=this.b.cbTypes;return!!n.nonemptyintersection(t,n.includes)&&!n.nonemptyintersection(t,n.excludes)},qn.prototype.zip_listeners=null,qn.prototype.listeners=null,qn.prototype.invalidate=function(){this.zip_listeners=!0},qn.prototype.validate=function(){this.zip_listeners&&(this.zip_listeners=!1,this.__validate())},qn.prototype.__validate=function(){this.listeners.clear();for(var t=this.a.listeners.head,e=this.b.listeners.head;null!=t&&null!=e;){var i,n,r,o,s=t.elt,a=e.elt;s==a?(i=s.options1,n=this.a.cbTypes,(!!(!(!i.nonemptyintersection(n,i.includes)||i.nonemptyintersection(n,i.excludes))&&(r=s.options2,o=this.b.cbTypes,!!r.nonemptyintersection(o,r.includes)&&!r.nonemptyintersection(o,r.excludes)))||(o=s.options2,r=this.a.cbTypes,!(!o.nonemptyintersection(r,o.includes)||o.nonemptyintersection(r,o.excludes))&&(r=s.options1,o=this.b.cbTypes,!!r.nonemptyintersection(o,r.includes)&&!r.nonemptyintersection(o,r.excludes))))&&this.listeners.add(s),t=t.next,e=e.next):s.precedence>a.precedence||s.precedence==a.precedence&&s.id>a.id?t=t.next:e=e.next}},qn.prototype.empty_intersection=function(){return null==this.listeners.head},qn.prototype.single_intersection=function(t){var e=this.listeners.head;return null!=e&&e.elt==t&&null==e.next},qn.prototype.forall=function(t,e){for(var i=this.listeners.head;null!=i;){var n=i.elt;n.event==t&&e(n),i=i.next}},qn.prototype.__class__=qn;var vt=zpp_nape.util.ZNPList_ZPP_InteractionListener=function(){this.length=0,this.pushmod=!1,this.modified=!1,this.head=null};vt.__name__=["zpp_nape","util","ZNPList_ZPP_InteractionListener"],vt.prototype.head=null,vt.prototype.begin=function(){return this.head},vt.prototype.modified=null,vt.prototype.pushmod=null,vt.prototype.length=null,vt.prototype.setbegin=function(t){this.head=t,this.modified=!0,this.pushmod=!0},vt.prototype.add=function(t){null==ir.zpp_pool?e=new ir:(e=ir.zpp_pool,ir.zpp_pool=e.next,e.next=null),e.elt=t;var e=e;return e.next=this.head,this.head=e,this.modified=!0,this.length++,t},vt.prototype.inlined_add=function(t){null==ir.zpp_pool?e=new ir:(e=ir.zpp_pool,ir.zpp_pool=e.next,e.next=null),e.elt=t;var e=e;return e.next=this.head,this.head=e,this.modified=!0,this.length++,t},vt.prototype.addAll=function(t){for(var e=t.head;null!=e;)this.add(e.elt),e=e.next},vt.prototype.insert=function(t,e){null==ir.zpp_pool?i=new ir:(i=ir.zpp_pool,ir.zpp_pool=i.next,i.next=null),i.elt=e;var i=i;return null==t?(i.next=this.head,this.head=i):(i.next=t.next,t.next=i),this.pushmod=this.modified=!0,this.length++,i},vt.prototype.inlined_insert=function(t,e){null==ir.zpp_pool?i=new ir:(i=ir.zpp_pool,ir.zpp_pool=i.next,i.next=null),i.elt=e;var i=i;return null==t?(i.next=this.head,this.head=i):(i.next=t.next,t.next=i),this.pushmod=this.modified=!0,this.length++,i},vt.prototype.pop=function(){var t=this.head;this.head=t.next,t.elt=null,t.next=ir.zpp_pool,ir.zpp_pool=t,null==this.head&&(this.pushmod=!0),this.modified=!0,this.length--},vt.prototype.inlined_pop=function(){var t=this.head;this.head=t.next,t.elt=null,t.next=ir.zpp_pool,ir.zpp_pool=t,null==this.head&&(this.pushmod=!0),this.modified=!0,this.length--},vt.prototype.pop_unsafe=function(){var t=this.head.elt;return this.pop(),t},vt.prototype.inlined_pop_unsafe=function(){var t=this.head.elt;return this.pop(),t},vt.prototype.remove=function(t){for(var e,i,n=null,r=this.head;null!=r;){if(r.elt==t){null==n?(i=(e=this.head).next,this.head=i,null==this.head&&(this.pushmod=!0)):(i=(e=n.next).next,null==(n.next=i)&&(this.pushmod=!0));var o=e;o.elt=null,o.next=ir.zpp_pool,ir.zpp_pool=o,this.modified=!0,this.length--,this.pushmod=!0;break}r=(n=r).next}},vt.prototype.try_remove=function(t){for(var e=null,i=this.head,n=!1;null!=i;){if(i.elt==t){this.erase(e),n=!0;break}i=(e=i).next}return n},vt.prototype.inlined_remove=function(t){for(var e,i,n=null,r=this.head;null!=r;){if(r.elt==t){null==n?(i=(e=this.head).next,this.head=i,null==this.head&&(this.pushmod=!0)):(i=(e=n.next).next,null==(n.next=i)&&(this.pushmod=!0));var o=e;o.elt=null,o.next=ir.zpp_pool,ir.zpp_pool=o,this.modified=!0,this.length--,this.pushmod=!0;break}r=(n=r).next}},vt.prototype.inlined_try_remove=function(t){for(var e,i,n=null,r=this.head,o=!1;null!=r;){if(r.elt==t){null==n?(i=(e=this.head).next,this.head=i,null==this.head&&(this.pushmod=!0)):(i=(e=n.next).next,null==(n.next=i)&&(this.pushmod=!0));var s=e;s.elt=null,s.next=ir.zpp_pool,ir.zpp_pool=s,this.modified=!0,this.length--,o=this.pushmod=!0;break}r=(n=r).next}return o},vt.prototype.erase=function(t){var e;null==t?(e=(i=this.head).next,this.head=e,null==this.head&&(this.pushmod=!0)):(e=(i=t.next).next,null==(t.next=e)&&(this.pushmod=!0));var i=i;return i.elt=null,i.next=ir.zpp_pool,ir.zpp_pool=i,this.modified=!0,this.length--,this.pushmod=!0,e},vt.prototype.inlined_erase=function(t){var e;null==t?(e=(i=this.head).next,this.head=e,null==this.head&&(this.pushmod=!0)):(e=(i=t.next).next,null==(t.next=e)&&(this.pushmod=!0));var i=i;return i.elt=null,i.next=ir.zpp_pool,ir.zpp_pool=i,this.modified=!0,this.length--,this.pushmod=!0,e},vt.prototype.splice=function(t,e){for(;0<e--&&null!=t.next;)this.erase(t);return t.next},vt.prototype.clear=function(){for(;null!=this.head;){var t=this.head;this.head=t.next,t.elt=null,t.next=ir.zpp_pool,ir.zpp_pool=t,null==this.head&&(this.pushmod=!0),this.modified=!0,this.length--}this.pushmod=!0},vt.prototype.inlined_clear=function(){for(;null!=this.head;){var t=this.head;this.head=t.next,t.elt=null,t.next=ir.zpp_pool,ir.zpp_pool=t,null==this.head&&(this.pushmod=!0),this.modified=!0,this.length--}this.pushmod=!0},vt.prototype.reverse=function(){for(var t=this.head,e=null;null!=t;){var i=t.next;t.next=e,e=this.head=t,t=i}this.modified=!0,this.pushmod=!0},vt.prototype.empty=function(){return null==this.head},vt.prototype.size=function(){return this.length},vt.prototype.has=function(t){for(var e=!1,i=this.head;null!=i;){if(i.elt==t){e=!0;break}i=i.next}return e},vt.prototype.inlined_has=function(t){for(var e=!1,i=this.head;null!=i;){if(i.elt==t){e=!0;break}i=i.next}return e},vt.prototype.front=function(){return this.head.elt},vt.prototype.back=function(){for(var t=this.head,e=t;null!=e;)e=(t=e).next;return t.elt},vt.prototype.iterator_at=function(t){for(var e=this.head;0<t--&&null!=e;)e=e.next;return e},vt.prototype.at=function(t){t=this.iterator_at(t);return null!=t?t.elt:null},vt.prototype.__class__=vt;var wt=zpp_nape.util.ZNPList_ZPP_BodyListener=function(){this.length=0,this.pushmod=!1,this.modified=!1,this.head=null};wt.__name__=["zpp_nape","util","ZNPList_ZPP_BodyListener"],wt.prototype.head=null,wt.prototype.begin=function(){return this.head},wt.prototype.modified=null,wt.prototype.pushmod=null,wt.prototype.length=null,wt.prototype.setbegin=function(t){this.head=t,this.modified=!0,this.pushmod=!0},wt.prototype.add=function(t){null==Ki.zpp_pool?e=new Ki:(e=Ki.zpp_pool,Ki.zpp_pool=e.next,e.next=null),e.elt=t;var e=e;return e.next=this.head,this.head=e,this.modified=!0,this.length++,t},wt.prototype.inlined_add=function(t){null==Ki.zpp_pool?e=new Ki:(e=Ki.zpp_pool,Ki.zpp_pool=e.next,e.next=null),e.elt=t;var e=e;return e.next=this.head,this.head=e,this.modified=!0,this.length++,t},wt.prototype.addAll=function(t){for(var e=t.head;null!=e;)this.add(e.elt),e=e.next},wt.prototype.insert=function(t,e){null==Ki.zpp_pool?i=new Ki:(i=Ki.zpp_pool,Ki.zpp_pool=i.next,i.next=null),i.elt=e;var i=i;return null==t?(i.next=this.head,this.head=i):(i.next=t.next,t.next=i),this.pushmod=this.modified=!0,this.length++,i},wt.prototype.inlined_insert=function(t,e){null==Ki.zpp_pool?i=new Ki:(i=Ki.zpp_pool,Ki.zpp_pool=i.next,i.next=null),i.elt=e;var i=i;return null==t?(i.next=this.head,this.head=i):(i.next=t.next,t.next=i),this.pushmod=this.modified=!0,this.length++,i},wt.prototype.pop=function(){var t=this.head;this.head=t.next,t.elt=null,t.next=Ki.zpp_pool,Ki.zpp_pool=t,null==this.head&&(this.pushmod=!0),this.modified=!0,this.length--},wt.prototype.inlined_pop=function(){var t=this.head;this.head=t.next,t.elt=null,t.next=Ki.zpp_pool,Ki.zpp_pool=t,null==this.head&&(this.pushmod=!0),this.modified=!0,this.length--},wt.prototype.pop_unsafe=function(){var t=this.head.elt;return this.pop(),t},wt.prototype.inlined_pop_unsafe=function(){var t=this.head.elt;return this.pop(),t},wt.prototype.remove=function(t){for(var e,i,n=null,r=this.head;null!=r;){if(r.elt==t){null==n?(i=(e=this.head).next,this.head=i,null==this.head&&(this.pushmod=!0)):(i=(e=n.next).next,null==(n.next=i)&&(this.pushmod=!0));var o=e;o.elt=null,o.next=Ki.zpp_pool,Ki.zpp_pool=o,this.modified=!0,this.length--,this.pushmod=!0;break}r=(n=r).next}},wt.prototype.try_remove=function(t){for(var e=null,i=this.head,n=!1;null!=i;){if(i.elt==t){this.erase(e),n=!0;break}i=(e=i).next}return n},wt.prototype.inlined_remove=function(t){for(var e,i,n=null,r=this.head;null!=r;){if(r.elt==t){null==n?(i=(e=this.head).next,this.head=i,null==this.head&&(this.pushmod=!0)):(i=(e=n.next).next,null==(n.next=i)&&(this.pushmod=!0));var o=e;o.elt=null,o.next=Ki.zpp_pool,Ki.zpp_pool=o,this.modified=!0,this.length--,this.pushmod=!0;break}r=(n=r).next}},wt.prototype.inlined_try_remove=function(t){for(var e,i,n=null,r=this.head,o=!1;null!=r;){if(r.elt==t){null==n?(i=(e=this.head).next,this.head=i,null==this.head&&(this.pushmod=!0)):(i=(e=n.next).next,null==(n.next=i)&&(this.pushmod=!0));var s=e;s.elt=null,s.next=Ki.zpp_pool,Ki.zpp_pool=s,this.modified=!0,this.length--,o=this.pushmod=!0;break}r=(n=r).next}return o},wt.prototype.erase=function(t){var e;null==t?(e=(i=this.head).next,this.head=e,null==this.head&&(this.pushmod=!0)):(e=(i=t.next).next,null==(t.next=e)&&(this.pushmod=!0));var i=i;return i.elt=null,i.next=Ki.zpp_pool,Ki.zpp_pool=i,this.modified=!0,this.length--,this.pushmod=!0,e},wt.prototype.inlined_erase=function(t){var e;null==t?(e=(i=this.head).next,this.head=e,null==this.head&&(this.pushmod=!0)):(e=(i=t.next).next,null==(t.next=e)&&(this.pushmod=!0));var i=i;return i.elt=null,i.next=Ki.zpp_pool,Ki.zpp_pool=i,this.modified=!0,this.length--,this.pushmod=!0,e},wt.prototype.splice=function(t,e){for(;0<e--&&null!=t.next;)this.erase(t);return t.next},wt.prototype.clear=function(){for(;null!=this.head;){var t=this.head;this.head=t.next,t.elt=null,t.next=Ki.zpp_pool,Ki.zpp_pool=t,null==this.head&&(this.pushmod=!0),this.modified=!0,this.length--}this.pushmod=!0},wt.prototype.inlined_clear=function(){for(;null!=this.head;){var t=this.head;this.head=t.next,t.elt=null,t.next=Ki.zpp_pool,Ki.zpp_pool=t,null==this.head&&(this.pushmod=!0),this.modified=!0,this.length--}this.pushmod=!0},wt.prototype.reverse=function(){for(var t=this.head,e=null;null!=t;){var i=t.next;t.next=e,e=this.head=t,t=i}this.modified=!0,this.pushmod=!0},wt.prototype.empty=function(){return null==this.head},wt.prototype.size=function(){return this.length},wt.prototype.has=function(t){for(var e=!1,i=this.head;null!=i;){if(i.elt==t){e=!0;break}i=i.next}return e},wt.prototype.inlined_has=function(t){for(var e=!1,i=this.head;null!=i;){if(i.elt==t){e=!0;break}i=i.next}return e},wt.prototype.front=function(){return this.head.elt},wt.prototype.back=function(){for(var t=this.head,e=t;null!=e;)e=(t=e).next;return t.elt},wt.prototype.iterator_at=function(t){for(var e=this.head;0<t--&&null!=e;)e=e.next;return e},wt.prototype.at=function(t){t=this.iterator_at(t);return null!=t?t.elt:null},wt.prototype.__class__=wt;var zt=zpp_nape.util.ZNPList_ZPP_ConstraintListener=function(){this.length=0,this.pushmod=!1,this.modified=!1,this.head=null};zt.__name__=["zpp_nape","util","ZNPList_ZPP_ConstraintListener"],zt.prototype.head=null,zt.prototype.begin=function(){return this.head},zt.prototype.modified=null,zt.prototype.pushmod=null,zt.prototype.length=null,zt.prototype.setbegin=function(t){this.head=t,this.modified=!0,this.pushmod=!0},zt.prototype.add=function(t){null==Ji.zpp_pool?e=new Ji:(e=Ji.zpp_pool,Ji.zpp_pool=e.next,e.next=null),e.elt=t;var e=e;return e.next=this.head,this.head=e,this.modified=!0,this.length++,t},zt.prototype.inlined_add=function(t){null==Ji.zpp_pool?e=new Ji:(e=Ji.zpp_pool,Ji.zpp_pool=e.next,e.next=null),e.elt=t;var e=e;return e.next=this.head,this.head=e,this.modified=!0,this.length++,t},zt.prototype.addAll=function(t){for(var e=t.head;null!=e;)this.add(e.elt),e=e.next},zt.prototype.insert=function(t,e){null==Ji.zpp_pool?i=new Ji:(i=Ji.zpp_pool,Ji.zpp_pool=i.next,i.next=null),i.elt=e;var i=i;return null==t?(i.next=this.head,this.head=i):(i.next=t.next,t.next=i),this.pushmod=this.modified=!0,this.length++,i},zt.prototype.inlined_insert=function(t,e){null==Ji.zpp_pool?i=new Ji:(i=Ji.zpp_pool,Ji.zpp_pool=i.next,i.next=null),i.elt=e;var i=i;return null==t?(i.next=this.head,this.head=i):(i.next=t.next,t.next=i),this.pushmod=this.modified=!0,this.length++,i},zt.prototype.pop=function(){var t=this.head;this.head=t.next,t.elt=null,t.next=Ji.zpp_pool,Ji.zpp_pool=t,null==this.head&&(this.pushmod=!0),this.modified=!0,this.length--},zt.prototype.inlined_pop=function(){var t=this.head;this.head=t.next,t.elt=null,t.next=Ji.zpp_pool,Ji.zpp_pool=t,null==this.head&&(this.pushmod=!0),this.modified=!0,this.length--},zt.prototype.pop_unsafe=function(){var t=this.head.elt;return this.pop(),t},zt.prototype.inlined_pop_unsafe=function(){var t=this.head.elt;return this.pop(),t},zt.prototype.remove=function(t){for(var e,i,n=null,r=this.head;null!=r;){if(r.elt==t){null==n?(i=(e=this.head).next,this.head=i,null==this.head&&(this.pushmod=!0)):(i=(e=n.next).next,null==(n.next=i)&&(this.pushmod=!0));var o=e;o.elt=null,o.next=Ji.zpp_pool,Ji.zpp_pool=o,this.modified=!0,this.length--,this.pushmod=!0;break}r=(n=r).next}},zt.prototype.try_remove=function(t){for(var e=null,i=this.head,n=!1;null!=i;){if(i.elt==t){this.erase(e),n=!0;break}i=(e=i).next}return n},zt.prototype.inlined_remove=function(t){for(var e,i,n=null,r=this.head;null!=r;){if(r.elt==t){null==n?(i=(e=this.head).next,this.head=i,null==this.head&&(this.pushmod=!0)):(i=(e=n.next).next,null==(n.next=i)&&(this.pushmod=!0));var o=e;o.elt=null,o.next=Ji.zpp_pool,Ji.zpp_pool=o,this.modified=!0,this.length--,this.pushmod=!0;break}r=(n=r).next}},zt.prototype.inlined_try_remove=function(t){for(var e,i,n=null,r=this.head,o=!1;null!=r;){if(r.elt==t){null==n?(i=(e=this.head).next,this.head=i,null==this.head&&(this.pushmod=!0)):(i=(e=n.next).next,null==(n.next=i)&&(this.pushmod=!0));var s=e;s.elt=null,s.next=Ji.zpp_pool,Ji.zpp_pool=s,this.modified=!0,this.length--,o=this.pushmod=!0;break}r=(n=r).next}return o},zt.prototype.erase=function(t){var e;null==t?(e=(i=this.head).next,this.head=e,null==this.head&&(this.pushmod=!0)):(e=(i=t.next).next,null==(t.next=e)&&(this.pushmod=!0));var i=i;return i.elt=null,i.next=Ji.zpp_pool,Ji.zpp_pool=i,this.modified=!0,this.length--,this.pushmod=!0,e},zt.prototype.inlined_erase=function(t){var e;null==t?(e=(i=this.head).next,this.head=e,null==this.head&&(this.pushmod=!0)):(e=(i=t.next).next,null==(t.next=e)&&(this.pushmod=!0));var i=i;return i.elt=null,i.next=Ji.zpp_pool,Ji.zpp_pool=i,this.modified=!0,this.length--,this.pushmod=!0,e},zt.prototype.splice=function(t,e){for(;0<e--&&null!=t.next;)this.erase(t);return t.next},zt.prototype.clear=function(){for(;null!=this.head;){var t=this.head;this.head=t.next,t.elt=null,t.next=Ji.zpp_pool,Ji.zpp_pool=t,null==this.head&&(this.pushmod=!0),this.modified=!0,this.length--}this.pushmod=!0},zt.prototype.inlined_clear=function(){for(;null!=this.head;){var t=this.head;this.head=t.next,t.elt=null,t.next=Ji.zpp_pool,Ji.zpp_pool=t,null==this.head&&(this.pushmod=!0),this.modified=!0,this.length--}this.pushmod=!0},zt.prototype.reverse=function(){for(var t=this.head,e=null;null!=t;){var i=t.next;t.next=e,e=this.head=t,t=i}this.modified=!0,this.pushmod=!0},zt.prototype.empty=function(){return null==this.head},zt.prototype.size=function(){return this.length},zt.prototype.has=function(t){for(var e=!1,i=this.head;null!=i;){if(i.elt==t){e=!0;break}i=i.next}return e},zt.prototype.inlined_has=function(t){for(var e=!1,i=this.head;null!=i;){if(i.elt==t){e=!0;break}i=i.next}return e},zt.prototype.front=function(){return this.head.elt},zt.prototype.back=function(){for(var t=this.head,e=t;null!=e;)e=(t=e).next;return t.elt},zt.prototype.iterator_at=function(t){for(var e=this.head;0<t--&&null!=e;)e=e.next;return e},zt.prototype.at=function(t){t=this.iterator_at(t);return null!=t?t.elt:null},zt.prototype.__class__=zt;var Ct=zpp_nape.util.ZNPList_ZPP_Constraint=function(){this.length=0,this.pushmod=!1,this.modified=!1,this.head=null};Ct.__name__=["zpp_nape","util","ZNPList_ZPP_Constraint"],Ct.prototype.head=null,Ct.prototype.begin=function(){return this.head},Ct.prototype.modified=null,Ct.prototype.pushmod=null,Ct.prototype.length=null,Ct.prototype.setbegin=function(t){this.head=t,this.modified=!0,this.pushmod=!0},Ct.prototype.add=function(t){null==Hi.zpp_pool?e=new Hi:(e=Hi.zpp_pool,Hi.zpp_pool=e.next,e.next=null),e.elt=t;var e=e;return e.next=this.head,this.head=e,this.modified=!0,this.length++,t},Ct.prototype.inlined_add=function(t){null==Hi.zpp_pool?e=new Hi:(e=Hi.zpp_pool,Hi.zpp_pool=e.next,e.next=null),e.elt=t;var e=e;return e.next=this.head,this.head=e,this.modified=!0,this.length++,t},Ct.prototype.addAll=function(t){for(var e=t.head;null!=e;)this.add(e.elt),e=e.next},Ct.prototype.insert=function(t,e){null==Hi.zpp_pool?i=new Hi:(i=Hi.zpp_pool,Hi.zpp_pool=i.next,i.next=null),i.elt=e;var i=i;return null==t?(i.next=this.head,this.head=i):(i.next=t.next,t.next=i),this.pushmod=this.modified=!0,this.length++,i},Ct.prototype.inlined_insert=function(t,e){null==Hi.zpp_pool?i=new Hi:(i=Hi.zpp_pool,Hi.zpp_pool=i.next,i.next=null),i.elt=e;var i=i;return null==t?(i.next=this.head,this.head=i):(i.next=t.next,t.next=i),this.pushmod=this.modified=!0,this.length++,i},Ct.prototype.pop=function(){var t=this.head;this.head=t.next,t.elt=null,t.next=Hi.zpp_pool,Hi.zpp_pool=t,null==this.head&&(this.pushmod=!0),this.modified=!0,this.length--},Ct.prototype.inlined_pop=function(){var t=this.head;this.head=t.next,t.elt=null,t.next=Hi.zpp_pool,Hi.zpp_pool=t,null==this.head&&(this.pushmod=!0),this.modified=!0,this.length--},Ct.prototype.pop_unsafe=function(){var t=this.head.elt;return this.pop(),t},Ct.prototype.inlined_pop_unsafe=function(){var t=this.head.elt;return this.pop(),t},Ct.prototype.remove=function(t){for(var e,i,n=null,r=this.head;null!=r;){if(r.elt==t){null==n?(i=(e=this.head).next,this.head=i,null==this.head&&(this.pushmod=!0)):(i=(e=n.next).next,null==(n.next=i)&&(this.pushmod=!0));var o=e;o.elt=null,o.next=Hi.zpp_pool,Hi.zpp_pool=o,this.modified=!0,this.length--,this.pushmod=!0;break}r=(n=r).next}},Ct.prototype.try_remove=function(t){for(var e=null,i=this.head,n=!1;null!=i;){if(i.elt==t){this.erase(e),n=!0;break}i=(e=i).next}return n},Ct.prototype.inlined_remove=function(t){for(var e,i,n=null,r=this.head;null!=r;){if(r.elt==t){null==n?(i=(e=this.head).next,this.head=i,null==this.head&&(this.pushmod=!0)):(i=(e=n.next).next,null==(n.next=i)&&(this.pushmod=!0));var o=e;o.elt=null,o.next=Hi.zpp_pool,Hi.zpp_pool=o,this.modified=!0,this.length--,this.pushmod=!0;break}r=(n=r).next}},Ct.prototype.inlined_try_remove=function(t){for(var e,i,n=null,r=this.head,o=!1;null!=r;){if(r.elt==t){null==n?(i=(e=this.head).next,this.head=i,null==this.head&&(this.pushmod=!0)):(i=(e=n.next).next,null==(n.next=i)&&(this.pushmod=!0));var s=e;s.elt=null,s.next=Hi.zpp_pool,Hi.zpp_pool=s,this.modified=!0,this.length--,o=this.pushmod=!0;break}r=(n=r).next}return o},Ct.prototype.erase=function(t){var e;null==t?(e=(i=this.head).next,this.head=e,null==this.head&&(this.pushmod=!0)):(e=(i=t.next).next,null==(t.next=e)&&(this.pushmod=!0));var i=i;return i.elt=null,i.next=Hi.zpp_pool,Hi.zpp_pool=i,this.modified=!0,this.length--,this.pushmod=!0,e},Ct.prototype.inlined_erase=function(t){var e;null==t?(e=(i=this.head).next,this.head=e,null==this.head&&(this.pushmod=!0)):(e=(i=t.next).next,null==(t.next=e)&&(this.pushmod=!0));var i=i;return i.elt=null,i.next=Hi.zpp_pool,Hi.zpp_pool=i,this.modified=!0,this.length--,this.pushmod=!0,e},Ct.prototype.splice=function(t,e){for(;0<e--&&null!=t.next;)this.erase(t);return t.next},Ct.prototype.clear=function(){for(;null!=this.head;){var t=this.head;this.head=t.next,t.elt=null,t.next=Hi.zpp_pool,Hi.zpp_pool=t,null==this.head&&(this.pushmod=!0),this.modified=!0,this.length--}this.pushmod=!0},Ct.prototype.inlined_clear=function(){for(;null!=this.head;){var t=this.head;this.head=t.next,t.elt=null,t.next=Hi.zpp_pool,Hi.zpp_pool=t,null==this.head&&(this.pushmod=!0),this.modified=!0,this.length--}this.pushmod=!0},Ct.prototype.reverse=function(){for(var t=this.head,e=null;null!=t;){var i=t.next;t.next=e,e=this.head=t,t=i}this.modified=!0,this.pushmod=!0},Ct.prototype.empty=function(){return null==this.head},Ct.prototype.size=function(){return this.length},Ct.prototype.has=function(t){for(var e=!1,i=this.head;null!=i;){if(i.elt==t){e=!0;break}i=i.next}return e},Ct.prototype.inlined_has=function(t){for(var e=!1,i=this.head;null!=i;){if(i.elt==t){e=!0;break}i=i.next}return e},Ct.prototype.front=function(){return this.head.elt},Ct.prototype.back=function(){for(var t=this.head,e=t;null!=e;)e=(t=e).next;return t.elt},Ct.prototype.iterator_at=function(t){for(var e=this.head;0<t--&&null!=e;)e=e.next;return e},Ct.prototype.at=function(t){t=this.iterator_at(t);return null!=t?t.elt:null},Ct.prototype.__class__=Ct;var Pt=zpp_nape.util.ZNPList_ZPP_Interactor=function(){this.length=0,this.pushmod=!1,this.modified=!1,this.head=null};Pt.__name__=["zpp_nape","util","ZNPList_ZPP_Interactor"],Pt.prototype.head=null,Pt.prototype.begin=function(){return this.head},Pt.prototype.modified=null,Pt.prototype.pushmod=null,Pt.prototype.length=null,Pt.prototype.setbegin=function(t){this.head=t,this.modified=!0,this.pushmod=!0},Pt.prototype.add=function(t){null==nr.zpp_pool?e=new nr:(e=nr.zpp_pool,nr.zpp_pool=e.next,e.next=null),e.elt=t;var e=e;return e.next=this.head,this.head=e,this.modified=!0,this.length++,t},Pt.prototype.inlined_add=function(t){null==nr.zpp_pool?e=new nr:(e=nr.zpp_pool,nr.zpp_pool=e.next,e.next=null),e.elt=t;var e=e;return e.next=this.head,this.head=e,this.modified=!0,this.length++,t},Pt.prototype.addAll=function(t){for(var e=t.head;null!=e;)this.add(e.elt),e=e.next},Pt.prototype.insert=function(t,e){null==nr.zpp_pool?i=new nr:(i=nr.zpp_pool,nr.zpp_pool=i.next,i.next=null),i.elt=e;var i=i;return null==t?(i.next=this.head,this.head=i):(i.next=t.next,t.next=i),this.pushmod=this.modified=!0,this.length++,i},Pt.prototype.inlined_insert=function(t,e){null==nr.zpp_pool?i=new nr:(i=nr.zpp_pool,nr.zpp_pool=i.next,i.next=null),i.elt=e;var i=i;return null==t?(i.next=this.head,this.head=i):(i.next=t.next,t.next=i),this.pushmod=this.modified=!0,this.length++,i},Pt.prototype.pop=function(){var t=this.head;this.head=t.next,t.elt=null,t.next=nr.zpp_pool,nr.zpp_pool=t,null==this.head&&(this.pushmod=!0),this.modified=!0,this.length--},Pt.prototype.inlined_pop=function(){var t=this.head;this.head=t.next,t.elt=null,t.next=nr.zpp_pool,nr.zpp_pool=t,null==this.head&&(this.pushmod=!0),this.modified=!0,this.length--},Pt.prototype.pop_unsafe=function(){var t=this.head.elt;return this.pop(),t},Pt.prototype.inlined_pop_unsafe=function(){var t=this.head.elt;return this.pop(),t},Pt.prototype.remove=function(t){for(var e,i,n=null,r=this.head;null!=r;){if(r.elt==t){null==n?(i=(e=this.head).next,this.head=i,null==this.head&&(this.pushmod=!0)):(i=(e=n.next).next,null==(n.next=i)&&(this.pushmod=!0));var o=e;o.elt=null,o.next=nr.zpp_pool,nr.zpp_pool=o,this.modified=!0,this.length--,this.pushmod=!0;break}r=(n=r).next}},Pt.prototype.try_remove=function(t){for(var e=null,i=this.head,n=!1;null!=i;){if(i.elt==t){this.erase(e),n=!0;break}i=(e=i).next}return n},Pt.prototype.inlined_remove=function(t){for(var e,i,n=null,r=this.head;null!=r;){if(r.elt==t){null==n?(i=(e=this.head).next,this.head=i,null==this.head&&(this.pushmod=!0)):(i=(e=n.next).next,null==(n.next=i)&&(this.pushmod=!0));var o=e;o.elt=null,o.next=nr.zpp_pool,nr.zpp_pool=o,this.modified=!0,this.length--,this.pushmod=!0;break}r=(n=r).next}},Pt.prototype.inlined_try_remove=function(t){for(var e,i,n=null,r=this.head,o=!1;null!=r;){if(r.elt==t){null==n?(i=(e=this.head).next,this.head=i,null==this.head&&(this.pushmod=!0)):(i=(e=n.next).next,null==(n.next=i)&&(this.pushmod=!0));var s=e;s.elt=null,s.next=nr.zpp_pool,nr.zpp_pool=s,this.modified=!0,this.length--,o=this.pushmod=!0;break}r=(n=r).next}return o},Pt.prototype.erase=function(t){var e;null==t?(e=(i=this.head).next,this.head=e,null==this.head&&(this.pushmod=!0)):(e=(i=t.next).next,null==(t.next=e)&&(this.pushmod=!0));var i=i;return i.elt=null,i.next=nr.zpp_pool,nr.zpp_pool=i,this.modified=!0,this.length--,this.pushmod=!0,e},Pt.prototype.inlined_erase=function(t){var e;null==t?(e=(i=this.head).next,this.head=e,null==this.head&&(this.pushmod=!0)):(e=(i=t.next).next,null==(t.next=e)&&(this.pushmod=!0));var i=i;return i.elt=null,i.next=nr.zpp_pool,nr.zpp_pool=i,this.modified=!0,this.length--,this.pushmod=!0,e},Pt.prototype.splice=function(t,e){for(;0<e--&&null!=t.next;)this.erase(t);return t.next},Pt.prototype.clear=function(){for(;null!=this.head;){var t=this.head;this.head=t.next,t.elt=null,t.next=nr.zpp_pool,nr.zpp_pool=t,null==this.head&&(this.pushmod=!0),this.modified=!0,this.length--}this.pushmod=!0},Pt.prototype.inlined_clear=function(){for(;null!=this.head;){var t=this.head;this.head=t.next,t.elt=null,t.next=nr.zpp_pool,nr.zpp_pool=t,null==this.head&&(this.pushmod=!0),this.modified=!0,this.length--}this.pushmod=!0},Pt.prototype.reverse=function(){for(var t=this.head,e=null;null!=t;){var i=t.next;t.next=e,e=this.head=t,t=i}this.modified=!0,this.pushmod=!0},Pt.prototype.empty=function(){return null==this.head},Pt.prototype.size=function(){return this.length},Pt.prototype.has=function(t){for(var e=!1,i=this.head;null!=i;){if(i.elt==t){e=!0;break}i=i.next}return e},Pt.prototype.inlined_has=function(t){for(var e=!1,i=this.head;null!=i;){if(i.elt==t){e=!0;break}i=i.next}return e},Pt.prototype.front=function(){return this.head.elt},Pt.prototype.back=function(){for(var t=this.head,e=t;null!=e;)e=(t=e).next;return t.elt},Pt.prototype.iterator_at=function(t){for(var e=this.head;0<t--&&null!=e;)e=e.next;return e},Pt.prototype.at=function(t){t=this.iterator_at(t);return null!=t?t.elt:null},Pt.prototype.__class__=Pt;var Mt=zpp_nape.util.ZNPList_ZPP_CbSet=function(){this.length=0,this.pushmod=!1,this.modified=!1,this.head=null};Mt.__name__=["zpp_nape","util","ZNPList_ZPP_CbSet"],Mt.prototype.head=null,Mt.prototype.begin=function(){return this.head},Mt.prototype.modified=null,Mt.prototype.pushmod=null,Mt.prototype.length=null,Mt.prototype.setbegin=function(t){this.head=t,this.modified=!0,this.pushmod=!0},Mt.prototype.add=function(t){null==Yi.zpp_pool?e=new Yi:(e=Yi.zpp_pool,Yi.zpp_pool=e.next,e.next=null),e.elt=t;var e=e;return e.next=this.head,this.head=e,this.modified=!0,this.length++,t},Mt.prototype.inlined_add=function(t){null==Yi.zpp_pool?e=new Yi:(e=Yi.zpp_pool,Yi.zpp_pool=e.next,e.next=null),e.elt=t;var e=e;return e.next=this.head,this.head=e,this.modified=!0,this.length++,t},Mt.prototype.addAll=function(t){for(var e=t.head;null!=e;)this.add(e.elt),e=e.next},Mt.prototype.insert=function(t,e){null==Yi.zpp_pool?i=new Yi:(i=Yi.zpp_pool,Yi.zpp_pool=i.next,i.next=null),i.elt=e;var i=i;return null==t?(i.next=this.head,this.head=i):(i.next=t.next,t.next=i),this.pushmod=this.modified=!0,this.length++,i},Mt.prototype.inlined_insert=function(t,e){null==Yi.zpp_pool?i=new Yi:(i=Yi.zpp_pool,Yi.zpp_pool=i.next,i.next=null),i.elt=e;var i=i;return null==t?(i.next=this.head,this.head=i):(i.next=t.next,t.next=i),this.pushmod=this.modified=!0,this.length++,i},Mt.prototype.pop=function(){var t=this.head;this.head=t.next,t.elt=null,t.next=Yi.zpp_pool,Yi.zpp_pool=t,null==this.head&&(this.pushmod=!0),this.modified=!0,this.length--},Mt.prototype.inlined_pop=function(){var t=this.head;this.head=t.next,t.elt=null,t.next=Yi.zpp_pool,Yi.zpp_pool=t,null==this.head&&(this.pushmod=!0),this.modified=!0,this.length--},Mt.prototype.pop_unsafe=function(){var t=this.head.elt;return this.pop(),t},Mt.prototype.inlined_pop_unsafe=function(){var t=this.head.elt;return this.pop(),t},Mt.prototype.remove=function(t){for(var e,i,n=null,r=this.head;null!=r;){if(r.elt==t){null==n?(i=(e=this.head).next,this.head=i,null==this.head&&(this.pushmod=!0)):(i=(e=n.next).next,null==(n.next=i)&&(this.pushmod=!0));var o=e;o.elt=null,o.next=Yi.zpp_pool,Yi.zpp_pool=o,this.modified=!0,this.length--,this.pushmod=!0;break}r=(n=r).next}},Mt.prototype.try_remove=function(t){for(var e=null,i=this.head,n=!1;null!=i;){if(i.elt==t){this.erase(e),n=!0;break}i=(e=i).next}return n},Mt.prototype.inlined_remove=function(t){for(var e,i,n=null,r=this.head;null!=r;){if(r.elt==t){null==n?(i=(e=this.head).next,this.head=i,null==this.head&&(this.pushmod=!0)):(i=(e=n.next).next,null==(n.next=i)&&(this.pushmod=!0));var o=e;o.elt=null,o.next=Yi.zpp_pool,Yi.zpp_pool=o,this.modified=!0,this.length--,this.pushmod=!0;break}r=(n=r).next}},Mt.prototype.inlined_try_remove=function(t){for(var e,i,n=null,r=this.head,o=!1;null!=r;){if(r.elt==t){null==n?(i=(e=this.head).next,this.head=i,null==this.head&&(this.pushmod=!0)):(i=(e=n.next).next,null==(n.next=i)&&(this.pushmod=!0));var s=e;s.elt=null,s.next=Yi.zpp_pool,Yi.zpp_pool=s,this.modified=!0,this.length--,o=this.pushmod=!0;break}r=(n=r).next}return o},Mt.prototype.erase=function(t){var e;null==t?(e=(i=this.head).next,this.head=e,null==this.head&&(this.pushmod=!0)):(e=(i=t.next).next,null==(t.next=e)&&(this.pushmod=!0));var i=i;return i.elt=null,i.next=Yi.zpp_pool,Yi.zpp_pool=i,this.modified=!0,this.length--,this.pushmod=!0,e},Mt.prototype.inlined_erase=function(t){var e;null==t?(e=(i=this.head).next,this.head=e,null==this.head&&(this.pushmod=!0)):(e=(i=t.next).next,null==(t.next=e)&&(this.pushmod=!0));var i=i;return i.elt=null,i.next=Yi.zpp_pool,Yi.zpp_pool=i,this.modified=!0,this.length--,this.pushmod=!0,e},Mt.prototype.splice=function(t,e){for(;0<e--&&null!=t.next;)this.erase(t);return t.next},Mt.prototype.clear=function(){for(;null!=this.head;){var t=this.head;this.head=t.next,t.elt=null,t.next=Yi.zpp_pool,Yi.zpp_pool=t,null==this.head&&(this.pushmod=!0),this.modified=!0,this.length--}this.pushmod=!0},Mt.prototype.inlined_clear=function(){for(;null!=this.head;){var t=this.head;this.head=t.next,t.elt=null,t.next=Yi.zpp_pool,Yi.zpp_pool=t,null==this.head&&(this.pushmod=!0),this.modified=!0,this.length--}this.pushmod=!0},Mt.prototype.reverse=function(){for(var t=this.head,e=null;null!=t;){var i=t.next;t.next=e,e=this.head=t,t=i}this.modified=!0,this.pushmod=!0},Mt.prototype.empty=function(){return null==this.head},Mt.prototype.size=function(){return this.length},Mt.prototype.has=function(t){for(var e=!1,i=this.head;null!=i;){if(i.elt==t){e=!0;break}i=i.next}return e},Mt.prototype.inlined_has=function(t){for(var e=!1,i=this.head;null!=i;){if(i.elt==t){e=!0;break}i=i.next}return e},Mt.prototype.front=function(){return this.head.elt},Mt.prototype.back=function(){for(var t=this.head,e=t;null!=e;)e=(t=e).next;return t.elt},Mt.prototype.iterator_at=function(t){for(var e=this.head;0<t--&&null!=e;)e=e.next;return e},Mt.prototype.at=function(t){t=this.iterator_at(t);return null!=t?t.elt:null},Mt.prototype.__class__=Mt;var Tt=zpp_nape.callbacks.ZPP_CbType=function(){this.conlisteners=null,this.bodylisteners=null,this.listeners=null,this.cbsets=null,this.id=0,this.userData=null,this.outer=null,this.id=xt.CbType(),this.listeners=new vt,this.bodylisteners=new wt,this.conlisteners=new zt,this.constraints=new Ct,this.interactors=new Pt,this.cbsets=new Mt};Tt.__name__=["zpp_nape","callbacks","ZPP_CbType"],Tt.setlt=function(t,e){return t.id<e.id},Tt.prototype.outer=null,Tt.prototype.userData=null,Tt.prototype.id=null,Tt.prototype.cbsets=null,Tt.prototype.interactors=null,Tt.prototype.wrap_interactors=null,Tt.prototype.constraints=null,Tt.prototype.wrap_constraints=null,Tt.prototype.addConstraint=function(t){this.constraints.add(t)},Tt.prototype.addInteractor=function(t){this.interactors.add(t)},Tt.prototype.remConstraint=function(t){this.constraints.remove(t)},Tt.prototype.remInteractor=function(t){this.interactors.remove(t)},Tt.prototype.listeners=null,Tt.prototype.addint=function(t){for(var e=null,i=this.listeners.head;null!=i;){var n=i.elt;if(t.precedence>n.precedence||t.precedence==n.precedence&&t.id>n.id)break;i=(e=i).next}var r=this.listeners;null==ir.zpp_pool?o=new ir:(o=ir.zpp_pool,ir.zpp_pool=o.next,o.next=null),o.elt=t;var o=o;null==e?(o.next=r.head,r.head=o):(o.next=e.next,e.next=o),r.pushmod=r.modified=!0,r.length++;for(var s=this.cbsets.head;null!=s;){var a=s.elt;a.zip_listeners=!0,a.invalidate_pairs(),s=s.next}},Tt.prototype.removeint=function(t){this.listeners.remove(t);for(var e=this.cbsets.head;null!=e;){var i=e.elt;i.zip_listeners=!0,i.invalidate_pairs(),e=e.next}},Tt.prototype.invalidateint=function(){for(var t=this.cbsets.head;null!=t;){var e=t.elt;e.zip_listeners=!0,e.invalidate_pairs(),t=t.next}},Tt.prototype.bodylisteners=null,Tt.prototype.addbody=function(t){for(var e=null,i=this.bodylisteners.head;null!=i;){var n=i.elt;if(t.precedence>n.precedence||t.precedence==n.precedence&&t.id>n.id)break;i=(e=i).next}var r=this.bodylisteners;null==Ki.zpp_pool?o=new Ki:(o=Ki.zpp_pool,Ki.zpp_pool=o.next,o.next=null),o.elt=t;var o=o;null==e?(o.next=r.head,r.head=o):(o.next=e.next,e.next=o),r.pushmod=r.modified=!0,r.length++;for(var s=this.cbsets.head;null!=s;)s.elt.zip_bodylisteners=!0,s=s.next},Tt.prototype.removebody=function(t){this.bodylisteners.remove(t);for(var e=this.cbsets.head;null!=e;)e.elt.zip_bodylisteners=!0,e=e.next},Tt.prototype.invalidatebody=function(){for(var t=this.cbsets.head;null!=t;)t.elt.zip_bodylisteners=!0,t=t.next},Tt.prototype.conlisteners=null,Tt.prototype.addconstraint=function(t){for(var e=null,i=this.conlisteners.head;null!=i;){var n=i.elt;if(t.precedence>n.precedence||t.precedence==n.precedence&&t.id>n.id)break;i=(e=i).next}var r=this.conlisteners;null==Ji.zpp_pool?o=new Ji:(o=Ji.zpp_pool,Ji.zpp_pool=o.next,o.next=null),o.elt=t;var o=o;null==e?(o.next=r.head,r.head=o):(o.next=e.next,e.next=o),r.pushmod=r.modified=!0,r.length++;for(var s=this.cbsets.head;null!=s;)s.elt.zip_conlisteners=!0,s=s.next},Tt.prototype.removeconstraint=function(t){this.conlisteners.remove(t);for(var e=this.cbsets.head;null!=e;)e.elt.zip_conlisteners=!0,e=e.next},Tt.prototype.invalidateconstraint=function(){for(var t=this.cbsets.head;null!=t;)t.elt.zip_conlisteners=!0,t=t.next},Tt.prototype.__class__=Tt;var Yn=zpp_nape.util.ZPP_Flags=function(){};Yn.__name__=["zpp_nape","util","ZPP_Flags"],Yn.GravMassMode_DEFAULT=null,Yn.GravMassMode_FIXED=null,Yn.GravMassMode_SCALED=null,Yn.InertiaMode_DEFAULT=null,Yn.InertiaMode_FIXED=null,Yn.MassMode_DEFAULT=null,Yn.MassMode_FIXED=null,Yn.BodyType_STATIC=null,Yn.BodyType_DYNAMIC=null,Yn.BodyType_KINEMATIC=null,Yn.ListenerType_BODY=null,Yn.PreFlag_ACCEPT=null,Yn.ListenerType_CONSTRAINT=null,Yn.PreFlag_IGNORE=null,Yn.ListenerType_INTERACTION=null,Yn.PreFlag_ACCEPT_ONCE=null,Yn.ListenerType_PRE=null,Yn.PreFlag_IGNORE_ONCE=null,Yn.CbEvent_BEGIN=null,Yn.InteractionType_COLLISION=null,Yn.CbEvent_ONGOING=null,Yn.InteractionType_SENSOR=null,Yn.CbEvent_END=null,Yn.InteractionType_FLUID=null,Yn.CbEvent_WAKE=null,Yn.InteractionType_ANY=null,Yn.CbEvent_SLEEP=null,Yn.CbEvent_BREAK=null,Yn.CbEvent_PRE=null,Yn.Winding_UNDEFINED=null,Yn.Winding_CLOCKWISE=null,Yn.Winding_ANTICLOCKWISE=null,Yn.ValidationResult_VALID=null,Yn.ValidationResult_DEGENERATE=null,Yn.ValidationResult_CONCAVE=null,Yn.ValidationResult_SELF_INTERSECTING=null,Yn.ShapeType_CIRCLE=null,Yn.ShapeType_POLYGON=null,Yn.Broadphase_DYNAMIC_AABB_TREE=null,Yn.Broadphase_SWEEP_AND_PRUNE=null,Yn.ArbiterType_COLLISION=null,Yn.ArbiterType_SENSOR=null,Yn.ArbiterType_FLUID=null,Yn.prototype.__class__=Yn;var At=zpp_nape.callbacks.ZPP_Listener=function(){this.space=null,this.interaction=null,this.constraint=null,this.body=null,this.precedence=0,this.event=0,this.type=0,this.id=0,this.outer=null,this.id=xt.Listener()};At.__name__=["zpp_nape","callbacks","ZPP_Listener"],At.setlt=function(t,e){return!(t.precedence<=e.precedence)||t.precedence==e.precedence&&t.id>e.id},At.prototype.outer=null,At.prototype.id=null,At.prototype.type=null,At.prototype.event=null,At.prototype.precedence=null,At.prototype.body=null,At.prototype.constraint=null,At.prototype.interaction=null,At.prototype.space=null,At.prototype.swapEvent=function(t){},At.prototype.invalidate_precedence=function(){},At.prototype.addedToSpace=function(){},At.prototype.removedFromSpace=function(){},At.prototype.__class__=At;var kt=zpp_nape.callbacks.ZPP_BodyListener=function(t,e,i){this.handler=null,this.options=null,this.outer_zn=null,At.call(this),this.event=e,this.handler=i,(this.body=this).type=0,this.options=t.zpp_inner};kt.__name__=["zpp_nape","callbacks","ZPP_BodyListener"],kt.__super__=At,kt.prototype=Object.create(At.prototype),kt.prototype.outer_zn=null,kt.prototype.options=null,kt.prototype.handler=null,kt.prototype.addedToSpace=function(){this.options.handler=Z(this,this.cbtype_change);for(var t=this.options.includes.head;null!=t;){for(var e=t.elt,i=null,n=e.bodylisteners.head;null!=n;){var r=n.elt;if(this.precedence>r.precedence||this.precedence==r.precedence&&this.id>r.id)break;n=(i=n).next}var o,s=e.bodylisteners;null==Ki.zpp_pool?o=new Ki:(o=Ki.zpp_pool,Ki.zpp_pool=o.next,o.next=null),o.elt=this;var a=o;null==i?(a.next=s.head,s.head=a):(a.next=i.next,i.next=a),s.pushmod=s.modified=!0,s.length++;for(var h=e.cbsets.head;null!=h;)h.elt.zip_bodylisteners=!0,h=h.next;t=t.next}},kt.prototype.removedFromSpace=function(){for(var t=this.options.includes.head;null!=t;){var e=t.elt;e.bodylisteners.remove(this);for(var i=e.cbsets.head;null!=i;)i.elt.zip_bodylisteners=!0,i=i.next;t=t.next}this.options.handler=null},kt.prototype.cbtype_change=function(t,e,i){this.removedFromSpace();var n=this.options;if(e)if(i){for(var r=null,o=n.includes.head;null!=o&&!(t.id<o.elt.id);)o=(r=o).next;e=n.includes;null==Ui.zpp_pool?s=new Ui:(s=Ui.zpp_pool,Ui.zpp_pool=s.next,s.next=null),s.elt=t;var s=s;null==r?(s.next=e.head,e.head=s):(s.next=r.next,r.next=s),e.pushmod=e.modified=!0,e.length++}else n.includes.remove(t);else if(i){for(var a=null,h=n.excludes.head;null!=h&&!(t.id<h.elt.id);)h=(a=h).next;i=n.excludes;null==Ui.zpp_pool?l=new Ui:(l=Ui.zpp_pool,Ui.zpp_pool=l.next,l.next=null),l.elt=t;var l=l;null==a?(l.next=i.head,i.head=l):(l.next=a.next,a.next=l),i.pushmod=i.modified=!0,i.length++}else n.excludes.remove(t);this.addedToSpace()},kt.prototype.invalidate_precedence=function(){null!=this.space&&(this.removedFromSpace(),this.addedToSpace())},kt.prototype.swapEvent=function(t){this.removedFromSpace(),this.event=t,this.addedToSpace()},kt.prototype.__class__=kt;var Ot=zpp_nape.callbacks.ZPP_ConstraintListener=function(t,e,i){this.handler=null,this.options=null,this.outer_zn=null,At.call(this),this.event=e,this.handler=i,(this.constraint=this).type=1,this.options=t.zpp_inner};Ot.__name__=["zpp_nape","callbacks","ZPP_ConstraintListener"],Ot.__super__=At,Ot.prototype=Object.create(At.prototype),Ot.prototype.outer_zn=null,Ot.prototype.options=null,Ot.prototype.handler=null,Ot.prototype.addedToSpace=function(){this.options.handler=Z(this,this.cbtype_change);for(var t=this.options.includes.head;null!=t;){for(var e=t.elt,i=null,n=e.conlisteners.head;null!=n;){var r=n.elt;if(this.precedence>r.precedence||this.precedence==r.precedence&&this.id>r.id)break;n=(i=n).next}var o,s=e.conlisteners;null==Ji.zpp_pool?o=new Ji:(o=Ji.zpp_pool,Ji.zpp_pool=o.next,o.next=null),o.elt=this;var a=o;null==i?(a.next=s.head,s.head=a):(a.next=i.next,i.next=a),s.pushmod=s.modified=!0,s.length++;for(var h=e.cbsets.head;null!=h;)h.elt.zip_conlisteners=!0,h=h.next;t=t.next}},Ot.prototype.removedFromSpace=function(){for(var t=this.options.includes.head;null!=t;){var e=t.elt;e.conlisteners.remove(this);for(var i=e.cbsets.head;null!=i;)i.elt.zip_conlisteners=!0,i=i.next;t=t.next}this.options.handler=null},Ot.prototype.cbtype_change=function(t,e,i){this.removedFromSpace();var n=this.options;if(e)if(i){for(var r=null,o=n.includes.head;null!=o&&!(t.id<o.elt.id);)o=(r=o).next;e=n.includes;null==Ui.zpp_pool?s=new Ui:(s=Ui.zpp_pool,Ui.zpp_pool=s.next,s.next=null),s.elt=t;var s=s;null==r?(s.next=e.head,e.head=s):(s.next=r.next,r.next=s),e.pushmod=e.modified=!0,e.length++}else n.includes.remove(t);else if(i){for(var a=null,h=n.excludes.head;null!=h&&!(t.id<h.elt.id);)h=(a=h).next;i=n.excludes;null==Ui.zpp_pool?l=new Ui:(l=Ui.zpp_pool,Ui.zpp_pool=l.next,l.next=null),l.elt=t;var l=l;null==a?(l.next=i.head,i.head=l):(l.next=a.next,a.next=l),i.pushmod=i.modified=!0,i.length++}else n.excludes.remove(t);this.addedToSpace()},Ot.prototype.invalidate_precedence=function(){null!=this.space&&(this.removedFromSpace(),this.addedToSpace())},Ot.prototype.swapEvent=function(t){this.removedFromSpace(),this.event=t,this.addedToSpace()},Ot.prototype.__class__=Ot;var Et=zpp_nape.util.ZNPList_ZPP_CbType=function(){this.length=0,this.pushmod=!1,this.modified=!1,this.head=null};Et.__name__=["zpp_nape","util","ZNPList_ZPP_CbType"],Et.prototype.head=null,Et.prototype.begin=function(){return this.head},Et.prototype.modified=null,Et.prototype.pushmod=null,Et.prototype.length=null,Et.prototype.setbegin=function(t){this.head=t,this.modified=!0,this.pushmod=!0},Et.prototype.add=function(t){null==Ui.zpp_pool?e=new Ui:(e=Ui.zpp_pool,Ui.zpp_pool=e.next,e.next=null),e.elt=t;var e=e;return e.next=this.head,this.head=e,this.modified=!0,this.length++,t},Et.prototype.inlined_add=function(t){null==Ui.zpp_pool?e=new Ui:(e=Ui.zpp_pool,Ui.zpp_pool=e.next,e.next=null),e.elt=t;var e=e;return e.next=this.head,this.head=e,this.modified=!0,this.length++,t},Et.prototype.addAll=function(t){for(var e=t.head;null!=e;)this.add(e.elt),e=e.next},Et.prototype.insert=function(t,e){null==Ui.zpp_pool?i=new Ui:(i=Ui.zpp_pool,Ui.zpp_pool=i.next,i.next=null),i.elt=e;var i=i;return null==t?(i.next=this.head,this.head=i):(i.next=t.next,t.next=i),this.pushmod=this.modified=!0,this.length++,i},Et.prototype.inlined_insert=function(t,e){null==Ui.zpp_pool?i=new Ui:(i=Ui.zpp_pool,Ui.zpp_pool=i.next,i.next=null),i.elt=e;var i=i;return null==t?(i.next=this.head,this.head=i):(i.next=t.next,t.next=i),this.pushmod=this.modified=!0,this.length++,i},Et.prototype.pop=function(){var t=this.head;this.head=t.next,t.elt=null,t.next=Ui.zpp_pool,Ui.zpp_pool=t,null==this.head&&(this.pushmod=!0),this.modified=!0,this.length--},Et.prototype.inlined_pop=function(){var t=this.head;this.head=t.next,t.elt=null,t.next=Ui.zpp_pool,Ui.zpp_pool=t,null==this.head&&(this.pushmod=!0),this.modified=!0,this.length--},Et.prototype.pop_unsafe=function(){var t=this.head.elt;return this.pop(),t},Et.prototype.inlined_pop_unsafe=function(){var t=this.head.elt;return this.pop(),t},Et.prototype.remove=function(t){for(var e,i,n=null,r=this.head;null!=r;){if(r.elt==t){null==n?(i=(e=this.head).next,this.head=i,null==this.head&&(this.pushmod=!0)):(i=(e=n.next).next,null==(n.next=i)&&(this.pushmod=!0));var o=e;o.elt=null,o.next=Ui.zpp_pool,Ui.zpp_pool=o,this.modified=!0,this.length--,this.pushmod=!0;break}r=(n=r).next}},Et.prototype.try_remove=function(t){for(var e=null,i=this.head,n=!1;null!=i;){if(i.elt==t){this.erase(e),n=!0;break}i=(e=i).next}return n},Et.prototype.inlined_remove=function(t){for(var e,i,n=null,r=this.head;null!=r;){if(r.elt==t){null==n?(i=(e=this.head).next,this.head=i,null==this.head&&(this.pushmod=!0)):(i=(e=n.next).next,null==(n.next=i)&&(this.pushmod=!0));var o=e;o.elt=null,o.next=Ui.zpp_pool,Ui.zpp_pool=o,this.modified=!0,this.length--,this.pushmod=!0;break}r=(n=r).next}},Et.prototype.inlined_try_remove=function(t){for(var e,i,n=null,r=this.head,o=!1;null!=r;){if(r.elt==t){null==n?(i=(e=this.head).next,this.head=i,null==this.head&&(this.pushmod=!0)):(i=(e=n.next).next,null==(n.next=i)&&(this.pushmod=!0));var s=e;s.elt=null,s.next=Ui.zpp_pool,Ui.zpp_pool=s,this.modified=!0,this.length--,o=this.pushmod=!0;break}r=(n=r).next}return o},Et.prototype.erase=function(t){var e;null==t?(e=(i=this.head).next,this.head=e,null==this.head&&(this.pushmod=!0)):(e=(i=t.next).next,null==(t.next=e)&&(this.pushmod=!0));var i=i;return i.elt=null,i.next=Ui.zpp_pool,Ui.zpp_pool=i,this.modified=!0,this.length--,this.pushmod=!0,e},Et.prototype.inlined_erase=function(t){var e;null==t?(e=(i=this.head).next,this.head=e,null==this.head&&(this.pushmod=!0)):(e=(i=t.next).next,null==(t.next=e)&&(this.pushmod=!0));var i=i;return i.elt=null,i.next=Ui.zpp_pool,Ui.zpp_pool=i,this.modified=!0,this.length--,this.pushmod=!0,e},Et.prototype.splice=function(t,e){for(;0<e--&&null!=t.next;)this.erase(t);return t.next},Et.prototype.clear=function(){for(;null!=this.head;){var t=this.head;this.head=t.next,t.elt=null,t.next=Ui.zpp_pool,Ui.zpp_pool=t,null==this.head&&(this.pushmod=!0),this.modified=!0,this.length--}this.pushmod=!0},Et.prototype.inlined_clear=function(){for(;null!=this.head;){var t=this.head;this.head=t.next,t.elt=null,t.next=Ui.zpp_pool,Ui.zpp_pool=t,null==this.head&&(this.pushmod=!0),this.modified=!0,this.length--}this.pushmod=!0},Et.prototype.reverse=function(){for(var t=this.head,e=null;null!=t;){var i=t.next;t.next=e,e=this.head=t,t=i}this.modified=!0,this.pushmod=!0},Et.prototype.empty=function(){return null==this.head},Et.prototype.size=function(){return this.length},Et.prototype.has=function(t){for(var e=!1,i=this.head;null!=i;){if(i.elt==t){e=!0;break}i=i.next}return e},Et.prototype.inlined_has=function(t){for(var e=!1,i=this.head;null!=i;){if(i.elt==t){e=!0;break}i=i.next}return e},Et.prototype.front=function(){return this.head.elt},Et.prototype.back=function(){for(var t=this.head,e=t;null!=e;)e=(t=e).next;return t.elt},Et.prototype.iterator_at=function(t){for(var e=this.head;0<t--&&null!=e;)e=e.next;return e},Et.prototype.at=function(t){t=this.iterator_at(t);return null!=t?t.elt:null},Et.prototype.__class__=Et;var Be=zpp_nape.callbacks.ZPP_InteractionListener=function(t,e,i,n){this.handlerp=null,this.pure=!1,this.allowSleepingCallbacks=!1,this.handleri=null,this.options2=null,this.options1=null,this.itype=0,this.outer_znp=null,this.outer_zni=null,At.call(this),this.type=n,(this.interaction=this).event=i,this.options1=t.zpp_inner,this.options2=e.zpp_inner,this.allowSleepingCallbacks=!1};Be.__name__=["zpp_nape","callbacks","ZPP_InteractionListener"],Be.__super__=At,Be.prototype=Object.create(At.prototype),Be.prototype.outer_zni=null,Be.prototype.outer_znp=null,Be.prototype.itype=null,Be.prototype.options1=null,Be.prototype.options2=null,Be.prototype.handleri=null,Be.prototype.allowSleepingCallbacks=null,Be.prototype.pure=null,Be.prototype.handlerp=null,Be.prototype.setInteractionType=function(t){this.itype=t},Be.prototype.wake=function(){for(var t=this.options1.includes.head,e=this.options2.includes.head;null!=t&&null!=e;){var i=t.elt,n=e.elt;if(i==n){for(var r=i.interactors.head;null!=r;)r.elt.wake(),r=r.next;t=t.next,e=e.next}else if(i.id<n.id){for(var o=i.interactors.head;null!=o;)o.elt.wake(),o=o.next;t=t.next}else{for(var s=n.interactors.head;null!=s;)s.elt.wake(),s=s.next;e=e.next}}for(;null!=t;){for(var a=t.elt.interactors.head;null!=a;)a.elt.wake(),a=a.next;t=t.next}for(;null!=e;){for(var h=e.elt.interactors.head;null!=h;)h.elt.wake(),h=h.next;e=e.next}},Be.prototype.CbSetset=function(t,e,i){for(var n=Be.UCbSet,r=Be.VCbSet,o=Be.WCbSet,s=t.head,a=e.head;null!=s&&null!=a;){var h,l,p,u,d=s.elt,c=a.elt;d==c?(null==Yi.zpp_pool?h=new Yi:(h=Yi.zpp_pool,Yi.zpp_pool=h.next,h.next=null),h.elt=d,(l=h).next=o.head,o.head=l,o.modified=!0,o.length++,s=s.next,a=a.next):Hn.setlt(d,c)?(null==Yi.zpp_pool?p=new Yi:(p=Yi.zpp_pool,Yi.zpp_pool=p.next,p.next=null),p.elt=d,(d=p).next=n.head,n.head=d,n.modified=!0,n.length++,s=s.next):(null==Yi.zpp_pool?u=new Yi:(u=Yi.zpp_pool,Yi.zpp_pool=u.next,u.next=null),u.elt=c,(c=u).next=r.head,r.head=c,r.modified=!0,r.length++,a=a.next)}for(;null!=s;){var y,_=s.elt;null==Yi.zpp_pool?y=new Yi:(y=Yi.zpp_pool,Yi.zpp_pool=y.next,y.next=null),y.elt=_;_=y;_.next=n.head,n.head=_,n.modified=!0,n.length++,s=s.next}for(;null!=a;){var m,g=a.elt;null==Yi.zpp_pool?m=new Yi:(m=Yi.zpp_pool,Yi.zpp_pool=m.next,m.next=null),m.elt=g;g=m;g.next=r.head,r.head=g,r.modified=!0,r.length++,a=a.next}for(;null!=n.head;)for(var f=n.pop_unsafe(),x=e.head;null!=x;)i(f,x.elt),x=x.next;for(;null!=r.head;)for(var v=r.pop_unsafe(),w=o.head;null!=w;)i(v,w.elt),w=w.next;for(;null!=o.head;){var z=o.pop_unsafe();i(z,z);for(var b=o.head;null!=b;)i(z,b.elt),b=b.next}},Be.prototype.CbTypeset=function(t,e,i){for(var n=Be.UCbType,r=Be.VCbType,o=Be.WCbType,s=t.head,a=e.head;null!=s&&null!=a;){var h,l,p,u,d=s.elt,c=a.elt;d==c?(null==Ui.zpp_pool?h=new Ui:(h=Ui.zpp_pool,Ui.zpp_pool=h.next,h.next=null),h.elt=d,(l=h).next=o.head,o.head=l,o.modified=!0,o.length++,s=s.next,a=a.next):d.id<c.id?(null==Ui.zpp_pool?p=new Ui:(p=Ui.zpp_pool,Ui.zpp_pool=p.next,p.next=null),p.elt=d,(d=p).next=n.head,n.head=d,n.modified=!0,n.length++,s=s.next):(null==Ui.zpp_pool?u=new Ui:(u=Ui.zpp_pool,Ui.zpp_pool=u.next,u.next=null),u.elt=c,(c=u).next=r.head,r.head=c,r.modified=!0,r.length++,a=a.next)}for(;null!=s;){var y,_=s.elt;null==Ui.zpp_pool?y=new Ui:(y=Ui.zpp_pool,Ui.zpp_pool=y.next,y.next=null),y.elt=_;_=y;_.next=n.head,n.head=_,n.modified=!0,n.length++,s=s.next}for(;null!=a;){var m,g=a.elt;null==Ui.zpp_pool?m=new Ui:(m=Ui.zpp_pool,Ui.zpp_pool=m.next,m.next=null),m.elt=g;g=m;g.next=r.head,r.head=g,r.modified=!0,r.length++,a=a.next}for(;null!=n.head;)for(var f=n.pop_unsafe(),x=e.head;null!=x;)i(f,x.elt),x=x.next;for(;null!=r.head;)for(var v=r.pop_unsafe(),w=o.head;null!=w;)i(v,w.elt),w=w.next;for(;null!=o.head;){var z=o.pop_unsafe();i(z,z);for(var b=o.head;null!=b;)i(z,b.elt),b=b.next}},Be.prototype.with_uniquesets=function(t){var e,i=this;null==Fn.zpp_pool?e=new Fn:(e=Fn.zpp_pool,Fn.zpp_pool=e.next,e.next=null),e.lt=qn.setlt;for(var n=this.options2.includes,r=Be.UCbType,o=Be.VCbType,s=Be.WCbType,a=this.options1.includes.head,h=n.head;null!=a&&null!=h;){var l,p,u,d,c=a.elt,y=h.elt;c==y?(null==Ui.zpp_pool?l=new Ui:(l=Ui.zpp_pool,Ui.zpp_pool=l.next,l.next=null),l.elt=c,(p=l).next=s.head,s.head=p,s.modified=!0,s.length++,a=a.next,h=h.next):c.id<y.id?(null==Ui.zpp_pool?u=new Ui:(u=Ui.zpp_pool,Ui.zpp_pool=u.next,u.next=null),u.elt=c,(c=u).next=r.head,r.head=c,r.modified=!0,r.length++,a=a.next):(null==Ui.zpp_pool?d=new Ui:(d=Ui.zpp_pool,Ui.zpp_pool=d.next,d.next=null),d.elt=y,(y=d).next=o.head,o.head=y,o.modified=!0,o.length++,h=h.next)}for(;null!=a;){var _,m=a.elt;null==Ui.zpp_pool?_=new Ui:(_=Ui.zpp_pool,Ui.zpp_pool=_.next,_.next=null),_.elt=m;m=_;m.next=r.head,r.head=m,r.modified=!0,r.length++,a=a.next}for(;null!=h;){var g,f=h.elt;null==Ui.zpp_pool?g=new Ui:(g=Ui.zpp_pool,Ui.zpp_pool=g.next,g.next=null),g.elt=f;f=g;f.next=o.head,o.head=f,o.modified=!0,o.length++,h=h.next}for(;null!=r.head;)for(var x=r.pop_unsafe(),v=n.head;null!=v;){for(var w=v.elt.cbsets,z=Be.UCbSet,b=Be.VCbSet,S=Be.WCbSet,C=x.cbsets.head,P=w.head;null!=C&&null!=P;){var M,T,A,k,O=C.elt,E=P.elt;O==E?(null==Yi.zpp_pool?M=new Yi:(M=Yi.zpp_pool,Yi.zpp_pool=M.next,M.next=null),M.elt=O,(T=M).next=S.head,S.head=T,S.modified=!0,S.length++,C=C.next,P=P.next):Hn.setlt(O,E)?(null==Yi.zpp_pool?A=new Yi:(A=Yi.zpp_pool,Yi.zpp_pool=A.next,A.next=null),A.elt=O,(O=A).next=z.head,z.head=O,z.modified=!0,z.length++,C=C.next):(null==Yi.zpp_pool?k=new Yi:(k=Yi.zpp_pool,Yi.zpp_pool=k.next,k.next=null),k.elt=E,(E=k).next=b.head,b.head=E,b.modified=!0,b.length++,P=P.next)}for(;null!=C;){var I,G=C.elt;null==Yi.zpp_pool?I=new Yi:(I=Yi.zpp_pool,Yi.zpp_pool=I.next,I.next=null),I.elt=G;G=I;G.next=z.head,z.head=G,z.modified=!0,z.length++,C=C.next}for(;null!=P;){var D,L=P.elt;null==Yi.zpp_pool?D=new Yi:(D=Yi.zpp_pool,Yi.zpp_pool=D.next,D.next=null),D.elt=L;L=D;L.next=b.head,b.head=L,b.modified=!0,b.length++,P=P.next}for(;null!=z.head;)for(var B=z.pop_unsafe(),R=w.head;null!=R;){var F,N=R.elt;B.validate(),N.validate(),Hn.single_intersection(B,N,i)&&(null==qn.zpp_pool?F=new qn:(F=qn.zpp_pool,qn.zpp_pool=F.next,F.next=null),F.zip_listeners=!0,Hn.setlt(B,N)?(F.a=B,F.b=N):(F.a=N,F.b=B),e.try_insert(F)),R=R.next}for(;null!=b.head;)for(var j=b.pop_unsafe(),U=S.head;null!=U;){var V,W=U.elt;j.validate(),W.validate(),Hn.single_intersection(j,W,i)&&(null==qn.zpp_pool?V=new qn:(V=qn.zpp_pool,qn.zpp_pool=V.next,V.next=null),V.zip_listeners=!0,Hn.setlt(j,W)?(V.a=j,V.b=W):(V.a=W,V.b=j),e.try_insert(V)),U=U.next}for(;null!=S.head;){var X,H=S.pop_unsafe();H.validate(),H.validate(),Hn.single_intersection(H,H,i)&&(null==qn.zpp_pool?X=new qn:(X=qn.zpp_pool,qn.zpp_pool=X.next,X.next=null),X.zip_listeners=!0,Hn.setlt(H,H),X.a=H,X.b=H,e.try_insert(X));for(var q=S.head;null!=q;){var Y,K=q.elt;H.validate(),K.validate(),Hn.single_intersection(H,K,i)&&(null==qn.zpp_pool?Y=new qn:(Y=qn.zpp_pool,qn.zpp_pool=Y.next,Y.next=null),Y.zip_listeners=!0,Hn.setlt(H,K)?(Y.a=H,Y.b=K):(Y.a=K,Y.b=H),e.try_insert(Y)),q=q.next}}v=v.next}for(;null!=o.head;)for(var Z=o.pop_unsafe(),J=s.head;null!=J;){for(var Q=J.elt.cbsets,$=Be.UCbSet,tt=Be.VCbSet,et=Be.WCbSet,it=Z.cbsets.head,nt=Q.head;null!=it&&null!=nt;){var rt,ot,st,at,ht=it.elt,lt=nt.elt;ht==lt?(null==Yi.zpp_pool?rt=new Yi:(rt=Yi.zpp_pool,Yi.zpp_pool=rt.next,rt.next=null),rt.elt=ht,(ot=rt).next=et.head,et.head=ot,et.modified=!0,et.length++,it=it.next,nt=nt.next):Hn.setlt(ht,lt)?(null==Yi.zpp_pool?st=new Yi:(st=Yi.zpp_pool,Yi.zpp_pool=st.next,st.next=null),st.elt=ht,(ht=st).next=$.head,$.head=ht,$.modified=!0,$.length++,it=it.next):(null==Yi.zpp_pool?at=new Yi:(at=Yi.zpp_pool,Yi.zpp_pool=at.next,at.next=null),at.elt=lt,(lt=at).next=tt.head,tt.head=lt,tt.modified=!0,tt.length++,nt=nt.next)}for(;null!=it;){var pt,ut=it.elt;null==Yi.zpp_pool?pt=new Yi:(pt=Yi.zpp_pool,Yi.zpp_pool=pt.next,pt.next=null),pt.elt=ut;ut=pt;ut.next=$.head,$.head=ut,$.modified=!0,$.length++,it=it.next}for(;null!=nt;){var dt,ct=nt.elt;null==Yi.zpp_pool?dt=new Yi:(dt=Yi.zpp_pool,Yi.zpp_pool=dt.next,dt.next=null),dt.elt=ct;ct=dt;ct.next=tt.head,tt.head=ct,tt.modified=!0,tt.length++,nt=nt.next}for(;null!=$.head;)for(var yt=$.pop_unsafe(),_t=Q.head;null!=_t;){var mt,gt=_t.elt;yt.validate(),gt.validate(),Hn.single_intersection(yt,gt,i)&&(null==qn.zpp_pool?mt=new qn:(mt=qn.zpp_pool,qn.zpp_pool=mt.next,mt.next=null),mt.zip_listeners=!0,Hn.setlt(yt,gt)?(mt.a=yt,mt.b=gt):(mt.a=gt,mt.b=yt),e.try_insert(mt)),_t=_t.next}for(;null!=tt.head;)for(var ft=tt.pop_unsafe(),xt=et.head;null!=xt;){var vt,wt=xt.elt;ft.validate(),wt.validate(),Hn.single_intersection(ft,wt,i)&&(null==qn.zpp_pool?vt=new qn:(vt=qn.zpp_pool,qn.zpp_pool=vt.next,vt.next=null),vt.zip_listeners=!0,Hn.setlt(ft,wt)?(vt.a=ft,vt.b=wt):(vt.a=wt,vt.b=ft),e.try_insert(vt)),xt=xt.next}for(;null!=et.head;){var zt,bt=et.pop_unsafe();bt.validate(),bt.validate(),Hn.single_intersection(bt,bt,i)&&(null==qn.zpp_pool?zt=new qn:(zt=qn.zpp_pool,qn.zpp_pool=zt.next,zt.next=null),zt.zip_listeners=!0,Hn.setlt(bt,bt),zt.a=bt,zt.b=bt,e.try_insert(zt));for(var St=et.head;null!=St;){var Ct,Pt=St.elt;bt.validate(),Pt.validate(),Hn.single_intersection(bt,Pt,i)&&(null==qn.zpp_pool?Ct=new qn:(Ct=qn.zpp_pool,qn.zpp_pool=Ct.next,Ct.next=null),Ct.zip_listeners=!0,Hn.setlt(bt,Pt)?(Ct.a=bt,Ct.b=Pt):(Ct.a=Pt,Ct.b=bt),e.try_insert(Ct)),St=St.next}}J=J.next}for(;null!=s.head;){for(var Mt=s.pop_unsafe(),Tt=Mt.cbsets,At=Be.UCbSet,kt=Be.VCbSet,Ot=Be.WCbSet,Et=Mt.cbsets.head,It=Tt.head;null!=Et&&null!=It;){var Gt,Dt,Lt,Bt,Rt=Et.elt,Ft=It.elt;Rt==Ft?(null==Yi.zpp_pool?Gt=new Yi:(Gt=Yi.zpp_pool,Yi.zpp_pool=Gt.next,Gt.next=null),Gt.elt=Rt,(Dt=Gt).next=Ot.head,Ot.head=Dt,Ot.modified=!0,Ot.length++,Et=Et.next,It=It.next):Hn.setlt(Rt,Ft)?(null==Yi.zpp_pool?Lt=new Yi:(Lt=Yi.zpp_pool,Yi.zpp_pool=Lt.next,Lt.next=null),Lt.elt=Rt,(Rt=Lt).next=At.head,At.head=Rt,At.modified=!0,At.length++,Et=Et.next):(null==Yi.zpp_pool?Bt=new Yi:(Bt=Yi.zpp_pool,Yi.zpp_pool=Bt.next,Bt.next=null),Bt.elt=Ft,(Ft=Bt).next=kt.head,kt.head=Ft,kt.modified=!0,kt.length++,It=It.next)}for(;null!=Et;){var Nt,jt=Et.elt;null==Yi.zpp_pool?Nt=new Yi:(Nt=Yi.zpp_pool,Yi.zpp_pool=Nt.next,Nt.next=null),Nt.elt=jt;jt=Nt;jt.next=At.head,At.head=jt,At.modified=!0,At.length++,Et=Et.next}for(;null!=It;){var Ut,Vt=It.elt;null==Yi.zpp_pool?Ut=new Yi:(Ut=Yi.zpp_pool,Yi.zpp_pool=Ut.next,Ut.next=null),Ut.elt=Vt;Vt=Ut;Vt.next=kt.head,kt.head=Vt,kt.modified=!0,kt.length++,It=It.next}for(;null!=At.head;)for(var Wt=At.pop_unsafe(),Xt=Tt.head;null!=Xt;){var Ht,qt=Xt.elt;Wt.validate(),qt.validate(),Hn.single_intersection(Wt,qt,i)&&(null==qn.zpp_pool?Ht=new qn:(Ht=qn.zpp_pool,qn.zpp_pool=Ht.next,Ht.next=null),Ht.zip_listeners=!0,Hn.setlt(Wt,qt)?(Ht.a=Wt,Ht.b=qt):(Ht.a=qt,Ht.b=Wt),e.try_insert(Ht)),Xt=Xt.next}for(;null!=kt.head;)for(var Yt=kt.pop_unsafe(),Kt=Ot.head;null!=Kt;){var Zt,Jt=Kt.elt;Yt.validate(),Jt.validate(),Hn.single_intersection(Yt,Jt,i)&&(null==qn.zpp_pool?Zt=new qn:(Zt=qn.zpp_pool,qn.zpp_pool=Zt.next,Zt.next=null),Zt.zip_listeners=!0,Hn.setlt(Yt,Jt)?(Zt.a=Yt,Zt.b=Jt):(Zt.a=Jt,Zt.b=Yt),e.try_insert(Zt)),Kt=Kt.next}for(;null!=Ot.head;){var Qt,$t=Ot.pop_unsafe();$t.validate(),$t.validate(),Hn.single_intersection($t,$t,i)&&(null==qn.zpp_pool?Qt=new qn:(Qt=qn.zpp_pool,qn.zpp_pool=Qt.next,Qt.next=null),Qt.zip_listeners=!0,Hn.setlt($t,$t),Qt.a=$t,Qt.b=$t,e.try_insert(Qt));for(var te=Ot.head;null!=te;){var ee,ie=te.elt;$t.validate(),ie.validate(),Hn.single_intersection($t,ie,i)&&(null==qn.zpp_pool?ee=new qn:(ee=qn.zpp_pool,qn.zpp_pool=ee.next,ee.next=null),ee.zip_listeners=!0,Hn.setlt($t,ie)?(ee.a=$t,ee.b=ie):(ee.a=ie,ee.b=$t),e.try_insert(ee)),te=te.next}}for(var ne=s.head;null!=ne;){for(var re=ne.elt.cbsets,oe=Be.UCbSet,se=Be.VCbSet,ae=Be.WCbSet,he=Mt.cbsets.head,le=re.head;null!=he&&null!=le;){var pe,ue,de,ce,ye=he.elt,_e=le.elt;ye==_e?(null==Yi.zpp_pool?pe=new Yi:(pe=Yi.zpp_pool,Yi.zpp_pool=pe.next,pe.next=null),pe.elt=ye,(ue=pe).next=ae.head,ae.head=ue,ae.modified=!0,ae.length++,he=he.next,le=le.next):Hn.setlt(ye,_e)?(null==Yi.zpp_pool?de=new Yi:(de=Yi.zpp_pool,Yi.zpp_pool=de.next,de.next=null),de.elt=ye,(ye=de).next=oe.head,oe.head=ye,oe.modified=!0,oe.length++,he=he.next):(null==Yi.zpp_pool?ce=new Yi:(ce=Yi.zpp_pool,Yi.zpp_pool=ce.next,ce.next=null),ce.elt=_e,(_e=ce).next=se.head,se.head=_e,se.modified=!0,se.length++,le=le.next)}for(;null!=he;){var me,ge=he.elt;null==Yi.zpp_pool?me=new Yi:(me=Yi.zpp_pool,Yi.zpp_pool=me.next,me.next=null),me.elt=ge;ge=me;ge.next=oe.head,oe.head=ge,oe.modified=!0,oe.length++,he=he.next}for(;null!=le;){var fe,xe=le.elt;null==Yi.zpp_pool?fe=new Yi:(fe=Yi.zpp_pool,Yi.zpp_pool=fe.next,fe.next=null),fe.elt=xe;xe=fe;xe.next=se.head,se.head=xe,se.modified=!0,se.length++,le=le.next}for(;null!=oe.head;)for(var ve=oe.pop_unsafe(),we=re.head;null!=we;){var ze,be=we.elt;ve.validate(),be.validate(),Hn.single_intersection(ve,be,i)&&(null==qn.zpp_pool?ze=new qn:(ze=qn.zpp_pool,qn.zpp_pool=ze.next,ze.next=null),ze.zip_listeners=!0,Hn.setlt(ve,be)?(ze.a=ve,ze.b=be):(ze.a=be,ze.b=ve),e.try_insert(ze)),we=we.next}for(;null!=se.head;)for(var Se=se.pop_unsafe(),Ce=ae.head;null!=Ce;){var Pe,Me=Ce.elt;Se.validate(),Me.validate(),Hn.single_intersection(Se,Me,i)&&(null==qn.zpp_pool?Pe=new qn:(Pe=qn.zpp_pool,qn.zpp_pool=Pe.next,Pe.next=null),Pe.zip_listeners=!0,Hn.setlt(Se,Me)?(Pe.a=Se,Pe.b=Me):(Pe.a=Me,Pe.b=Se),e.try_insert(Pe)),Ce=Ce.next}for(;null!=ae.head;){var Te,Ae=ae.pop_unsafe();Ae.validate(),Ae.validate(),Hn.single_intersection(Ae,Ae,i)&&(null==qn.zpp_pool?Te=new qn:(Te=qn.zpp_pool,qn.zpp_pool=Te.next,Te.next=null),Te.zip_listeners=!0,Hn.setlt(Ae,Ae),Te.a=Ae,Te.b=Ae,e.try_insert(Te));for(var ke=ae.head;null!=ke;){var Oe,Ee=ke.elt;Ae.validate(),Ee.validate(),Hn.single_intersection(Ae,Ee,i)&&(null==qn.zpp_pool?Oe=new qn:(Oe=qn.zpp_pool,qn.zpp_pool=Oe.next,Oe.next=null),Oe.zip_listeners=!0,Hn.setlt(Ae,Ee)?(Oe.a=Ae,Oe.b=Ee):(Oe.a=Ee,Oe.b=Ae),e.try_insert(Oe)),ke=ke.next}}ne=ne.next}}if(null!=e.parent){for(var Ie,Ge,De=e.parent;null!=De;)De=null!=De.prev?De.prev:null!=De.next?De.next:(Ge=De.data,t?i.space.freshListenerType(Ge.a,Ge.b):i.space.nullListenerType(Ge.a,Ge.b),Ge.a=Ge.b=null,Ge.listeners.clear(),Ge.next=qn.zpp_pool,qn.zpp_pool=Ge,null!=(Ie=De.parent)&&(De==Ie.prev?Ie.prev=null:Ie.next=null,De.parent=null),(Ge=De).data=null,Ge.lt=null,Ge.swapped=null,Ge.next=Fn.zpp_pool,Fn.zpp_pool=Ge,Ie);e.parent=null}var Le=e;Le.data=null,Le.lt=null,Le.swapped=null,Le.next=Fn.zpp_pool,Fn.zpp_pool=Le},Be.prototype.with_union=function(t){for(var e=this.options1.includes.head,i=this.options2.includes.head;null!=e&&null!=i;){var n=e.elt,r=i.elt;n==r?(t(n),e=e.next,i=i.next):n.id<r.id?(t(n),e=e.next):(t(r),i=i.next)}for(;null!=e;)t(e.elt),e=e.next;for(;null!=i;)t(i.elt),i=i.next},Be.prototype.addedToSpace=function(){for(var t=this,e=3==this.type,i=this.options1.includes.head,n=this.options2.includes.head;null!=i&&null!=n;){var r=i.elt,o=n.elt;if(r==o){for(var s=null,a=r.listeners.head;null!=a;){var h=a.elt;if(t.precedence>h.precedence||t.precedence==h.precedence&&t.id>h.id)break;a=(s=a).next}var l,p=r.listeners;null==ir.zpp_pool?l=new ir:(l=ir.zpp_pool,ir.zpp_pool=l.next,l.next=null),l.elt=t;var u=l;null==s?(u.next=p.head,p.head=u):(u.next=s.next,s.next=u),p.pushmod=p.modified=!0,p.length++;for(var d=r.cbsets.head;null!=d;){var c=d.elt;c.zip_listeners=!0,c.invalidate_pairs(),d=d.next}if(e)for(var y=r.interactors.head;null!=y;)y.elt.wake(),y=y.next;i=i.next,n=n.next}else if(r.id<o.id){for(var _=null,m=r.listeners.head;null!=m;){var g=m.elt;if(t.precedence>g.precedence||t.precedence==g.precedence&&t.id>g.id)break;m=(_=m).next}var f,x=r.listeners;null==ir.zpp_pool?f=new ir:(f=ir.zpp_pool,ir.zpp_pool=f.next,f.next=null),f.elt=t;p=f;null==_?(p.next=x.head,x.head=p):(p.next=_.next,_.next=p),x.pushmod=x.modified=!0,x.length++;for(var v=r.cbsets.head;null!=v;){var w=v.elt;w.zip_listeners=!0,w.invalidate_pairs(),v=v.next}if(e)for(var z=r.interactors.head;null!=z;)z.elt.wake(),z=z.next;i=i.next}else{for(var b=null,S=o.listeners.head;null!=S;){var C=S.elt;if(t.precedence>C.precedence||t.precedence==C.precedence&&t.id>C.id)break;S=(b=S).next}var P,x=o.listeners;null==ir.zpp_pool?P=new ir:(P=ir.zpp_pool,ir.zpp_pool=P.next,P.next=null),P.elt=t;r=P;null==b?(r.next=x.head,x.head=r):(r.next=b.next,b.next=r),x.pushmod=x.modified=!0,x.length++;for(var M=o.cbsets.head;null!=M;){var T=M.elt;T.zip_listeners=!0,T.invalidate_pairs(),M=M.next}if(e)for(var A=o.interactors.head;null!=A;)A.elt.wake(),A=A.next;n=n.next}}for(;null!=i;){for(var k=i.elt,O=null,E=k.listeners.head;null!=E;){var I=E.elt;if(t.precedence>I.precedence||t.precedence==I.precedence&&t.id>I.id)break;E=(O=E).next}var G,D=k.listeners;null==ir.zpp_pool?G=new ir:(G=ir.zpp_pool,ir.zpp_pool=G.next,G.next=null),G.elt=t;var L=G;null==O?(L.next=D.head,D.head=L):(L.next=O.next,O.next=L),D.pushmod=D.modified=!0,D.length++;for(var B=k.cbsets.head;null!=B;){var R=B.elt;R.zip_listeners=!0,R.invalidate_pairs(),B=B.next}if(e)for(var F=k.interactors.head;null!=F;)F.elt.wake(),F=F.next;i=i.next}for(;null!=n;){for(var N=n.elt,j=null,U=N.listeners.head;null!=U;){var V=U.elt;if(t.precedence>V.precedence||t.precedence==V.precedence&&t.id>V.id)break;U=(j=U).next}var W,X=N.listeners;null==ir.zpp_pool?W=new ir:(W=ir.zpp_pool,ir.zpp_pool=W.next,W.next=null),W.elt=t;var H=W;null==j?(H.next=X.head,X.head=H):(H.next=j.next,j.next=H),X.pushmod=X.modified=!0,X.length++;for(var q=N.cbsets.head;null!=q;){var Y=q.elt;Y.zip_listeners=!0,Y.invalidate_pairs(),q=q.next}if(e)for(var K=N.interactors.head;null!=K;)K.elt.wake(),K=K.next;n=n.next}this.options1.handler=Z(this,this.cbtype_change1),this.options2.handler=Z(this,this.cbtype_change2),this.with_uniquesets(!0)},Be.prototype.removedFromSpace=function(){this.with_uniquesets(!1);for(var t=3==this.type,e=this.options1.includes.head,i=this.options2.includes.head;null!=e&&null!=i;){var n=e.elt,r=i.elt;if(n==r){n.listeners.remove(this);for(var o=n.cbsets.head;null!=o;){var s=o.elt;s.zip_listeners=!0,s.invalidate_pairs(),o=o.next}if(t)for(var a=n.interactors.head;null!=a;)a.elt.wake(),a=a.next;e=e.next,i=i.next}else if(n.id<r.id){n.listeners.remove(this);for(var h=n.cbsets.head;null!=h;){var l=h.elt;l.zip_listeners=!0,l.invalidate_pairs(),h=h.next}if(t)for(var p=n.interactors.head;null!=p;)p.elt.wake(),p=p.next;e=e.next}else{r.listeners.remove(this);for(var u=r.cbsets.head;null!=u;){var d=u.elt;d.zip_listeners=!0,d.invalidate_pairs(),u=u.next}if(t)for(var c=r.interactors.head;null!=c;)c.elt.wake(),c=c.next;i=i.next}}for(;null!=e;){var y=e.elt;y.listeners.remove(this);for(var _=y.cbsets.head;null!=_;){var m=_.elt;m.zip_listeners=!0,m.invalidate_pairs(),_=_.next}if(t)for(var g=y.interactors.head;null!=g;)g.elt.wake(),g=g.next;e=e.next}for(;null!=i;){var f=i.elt;f.listeners.remove(this);for(var x=f.cbsets.head;null!=x;){var v=x.elt;v.zip_listeners=!0,v.invalidate_pairs(),x=x.next}if(t)for(var w=f.interactors.head;null!=w;)w.elt.wake(),w=w.next;i=i.next}this.options1.handler=null,this.options2.handler=null},Be.prototype.invalidate_precedence=function(){var t=this;if(null!=this.space){for(var e=3==this.type,i=this.options1.includes.head,n=this.options2.includes.head;null!=i&&null!=n;){var r=i.elt,o=n.elt;if(r==o){r.listeners.remove(t);for(var s=r.cbsets.head;null!=s;){var a=s.elt;a.zip_listeners=!0,a.invalidate_pairs(),s=s.next}for(var h=null,l=r.listeners.head;null!=l;){var p=l.elt;if(t.precedence>p.precedence||t.precedence==p.precedence&&t.id>p.id)break;l=(h=l).next}var u,d=r.listeners;null==ir.zpp_pool?u=new ir:(u=ir.zpp_pool,ir.zpp_pool=u.next,u.next=null),u.elt=t;var c=u;null==h?(c.next=d.head,d.head=c):(c.next=h.next,h.next=c),d.pushmod=d.modified=!0,d.length++;for(var y=r.cbsets.head;null!=y;){var _=y.elt;_.zip_listeners=!0,_.invalidate_pairs(),y=y.next}if(e)for(var m=r.interactors.head;null!=m;)m.elt.wake(),m=m.next;i=i.next,n=n.next}else if(r.id<o.id){r.listeners.remove(t);for(var g=r.cbsets.head;null!=g;){var f=g.elt;f.zip_listeners=!0,f.invalidate_pairs(),g=g.next}for(var x=null,v=r.listeners.head;null!=v;){var w=v.elt;if(t.precedence>w.precedence||t.precedence==w.precedence&&t.id>w.id)break;v=(x=v).next}var z,b=r.listeners;null==ir.zpp_pool?z=new ir:(z=ir.zpp_pool,ir.zpp_pool=z.next,z.next=null),z.elt=t;d=z;null==x?(d.next=b.head,b.head=d):(d.next=x.next,x.next=d),b.pushmod=b.modified=!0,b.length++;for(var S=r.cbsets.head;null!=S;){var C=S.elt;C.zip_listeners=!0,C.invalidate_pairs(),S=S.next}if(e)for(var P=r.interactors.head;null!=P;)P.elt.wake(),P=P.next;i=i.next}else{o.listeners.remove(t);for(var M=o.cbsets.head;null!=M;){var T=M.elt;T.zip_listeners=!0,T.invalidate_pairs(),M=M.next}for(var A=null,k=o.listeners.head;null!=k;){var O=k.elt;if(t.precedence>O.precedence||t.precedence==O.precedence&&t.id>O.id)break;k=(A=k).next}var E,b=o.listeners;null==ir.zpp_pool?E=new ir:(E=ir.zpp_pool,ir.zpp_pool=E.next,E.next=null),E.elt=t;r=E;null==A?(r.next=b.head,b.head=r):(r.next=A.next,A.next=r),b.pushmod=b.modified=!0,b.length++;for(var I=o.cbsets.head;null!=I;){var G=I.elt;G.zip_listeners=!0,G.invalidate_pairs(),I=I.next}if(e)for(var D=o.interactors.head;null!=D;)D.elt.wake(),D=D.next;n=n.next}}for(;null!=i;){var L=i.elt;L.listeners.remove(t);for(var B=L.cbsets.head;null!=B;){var R=B.elt;R.zip_listeners=!0,R.invalidate_pairs(),B=B.next}for(var F=null,N=L.listeners.head;null!=N;){var j=N.elt;if(t.precedence>j.precedence||t.precedence==j.precedence&&t.id>j.id)break;N=(F=N).next}var U,V=L.listeners;null==ir.zpp_pool?U=new ir:(U=ir.zpp_pool,ir.zpp_pool=U.next,U.next=null),U.elt=t;var W=U;null==F?(W.next=V.head,V.head=W):(W.next=F.next,F.next=W),V.pushmod=V.modified=!0,V.length++;for(var X=L.cbsets.head;null!=X;){var H=X.elt;H.zip_listeners=!0,H.invalidate_pairs(),X=X.next}if(e)for(var q=L.interactors.head;null!=q;)q.elt.wake(),q=q.next;i=i.next}for(;null!=n;){var Y=n.elt;Y.listeners.remove(t);for(var K=Y.cbsets.head;null!=K;){var Z=K.elt;Z.zip_listeners=!0,Z.invalidate_pairs(),K=K.next}for(var J=null,Q=Y.listeners.head;null!=Q;){var $=Q.elt;if(t.precedence>$.precedence||t.precedence==$.precedence&&t.id>$.id)break;Q=(J=Q).next}var tt,et=Y.listeners;null==ir.zpp_pool?tt=new ir:(tt=ir.zpp_pool,ir.zpp_pool=tt.next,tt.next=null),tt.elt=t;var it=tt;null==J?(it.next=et.head,et.head=it):(it.next=J.next,J.next=it),et.pushmod=et.modified=!0,et.length++;for(var nt=Y.cbsets.head;null!=nt;){var rt=nt.elt;rt.zip_listeners=!0,rt.invalidate_pairs(),nt=nt.next}if(e)for(var ot=Y.interactors.head;null!=ot;)ot.elt.wake(),ot=ot.next;n=n.next}}},Be.prototype.cbtype_change1=function(t,e,i){this.cbtype_change(this.options1,t,e,i)},Be.prototype.cbtype_change2=function(t,e,i){this.cbtype_change(this.options2,t,e,i)},Be.prototype.cbtype_change=function(t,e,i,n){if(this.removedFromSpace(),i)if(n){for(var r=null,o=t.includes.head;null!=o&&!(e.id<o.elt.id);)o=(r=o).next;i=t.includes;null==Ui.zpp_pool?s=new Ui:(s=Ui.zpp_pool,Ui.zpp_pool=s.next,s.next=null),s.elt=e;var s=s;null==r?(s.next=i.head,i.head=s):(s.next=r.next,r.next=s),i.pushmod=i.modified=!0,i.length++}else t.includes.remove(e);else if(n){for(var a=null,h=t.excludes.head;null!=h&&!(e.id<h.elt.id);)h=(a=h).next;n=t.excludes;null==Ui.zpp_pool?l=new Ui:(l=Ui.zpp_pool,Ui.zpp_pool=l.next,l.next=null),l.elt=e;var l=l;null==a?(l.next=n.head,n.head=l):(l.next=a.next,a.next=l),n.pushmod=n.modified=!0,n.length++}else t.excludes.remove(e);this.addedToSpace()},Be.prototype.swapEvent=function(t){this.removedFromSpace(),this.event=t,this.addedToSpace()},Be.prototype.__class__=Be;var It=zpp_nape.callbacks.ZPP_OptionType=function(){this.wrap_excludes=null,this.wrap_includes=null,this.excludes=null,this.includes=null,this.handler=null,this.outer=null,this.includes=new Et,this.excludes=new Et};It.__name__=["zpp_nape","callbacks","ZPP_OptionType"],It.argument=function(t){return null==t?new x:R.__instanceof(t,x)?t:(new x).including(t)},It.prototype.outer=null,It.prototype.handler=null,It.prototype.includes=null,It.prototype.excludes=null,It.prototype.wrap_includes=null,It.prototype.wrap_excludes=null,It.prototype.setup_includes=function(){this.wrap_includes=Mn.get(this.includes,!0)},It.prototype.setup_excludes=function(){this.wrap_excludes=Mn.get(this.excludes,!0)},It.prototype.excluded=function(t){return this.nonemptyintersection(t,this.excludes)},It.prototype.included=function(t){return this.nonemptyintersection(t,this.includes)},It.prototype.compatible=function(t){return!!this.nonemptyintersection(t,this.includes)&&!this.nonemptyintersection(t,this.excludes)},It.prototype.nonemptyintersection=function(t,e){for(var i=!1,n=t.head,r=e.head;null!=r&&null!=n;){var o=r.elt,s=n.elt;if(o==s){i=!0;break}o.id<s.id?r=r.next:n=n.next}return i},It.prototype.effect_change=function(t,e,i){if(e)if(i){for(var n=null,r=this.includes.head;null!=r&&!(t.id<r.elt.id);)r=(n=r).next;e=this.includes;null==Ui.zpp_pool?o=new Ui:(o=Ui.zpp_pool,Ui.zpp_pool=o.next,o.next=null),o.elt=t;var o=o;null==n?(o.next=e.head,e.head=o):(o.next=n.next,n.next=o),e.pushmod=e.modified=!0,e.length++}else this.includes.remove(t);else if(i){for(var s=null,a=this.excludes.head;null!=a&&!(t.id<a.elt.id);)a=(s=a).next;i=this.excludes;null==Ui.zpp_pool?h=new Ui:(h=Ui.zpp_pool,Ui.zpp_pool=h.next,h.next=null),h.elt=t;var h=h;null==s?(h.next=i.head,i.head=h):(h.next=s.next,s.next=h),i.pushmod=i.modified=!0,i.length++}else this.excludes.remove(t)},It.prototype.append_type=function(t,e){if(t==this.includes){if(!this.includes.has(e))if(this.excludes.has(e))null!=this.handler?this.handler(e,!1,!1):this.excludes.remove(e);else if(null!=this.handler)this.handler(e,!0,!0);else{for(var i=null,n=this.includes.head;null!=n&&!(e.id<n.elt.id);)n=(i=n).next;var r=this.includes;null==Ui.zpp_pool?o=new Ui:(o=Ui.zpp_pool,Ui.zpp_pool=o.next,o.next=null),o.elt=e;var o=o;null==i?(o.next=r.head,r.head=o):(o.next=i.next,i.next=o),r.pushmod=r.modified=!0,r.length++}}else if(!this.excludes.has(e))if(this.includes.has(e))null!=this.handler?this.handler(e,!0,!1):this.includes.remove(e);else if(null!=this.handler)this.handler(e,!1,!0);else{for(var s=null,a=this.excludes.head;null!=a&&!(e.id<a.elt.id);)a=(s=a).next;r=this.excludes;null==Ui.zpp_pool?h=new Ui:(h=Ui.zpp_pool,Ui.zpp_pool=h.next,h.next=null),h.elt=e;var h=h;null==s?(h.next=r.head,r.head=h):(h.next=s.next,s.next=h),r.pushmod=r.modified=!0,r.length++}},It.prototype.set=function(t){if(t!=this){for(;null!=this.includes.head;)this.append_type(this.excludes,this.includes.head.elt);for(;null!=this.excludes.head;)this.append_type(this.includes,this.excludes.head.elt);for(var e=t.excludes.head;null!=e;)this.append_type(this.excludes,e.elt),e=e.next;for(var i=t.includes.head;null!=i;)this.append_type(this.includes,i.elt),i=i.next}return this},It.prototype.append=function(t,e){if(R.__instanceof(e,u))this.append_type(t,e.zpp_inner);else if(R.__instanceof(e,d)){var i=e;i.zpp_inner.valmod();for(var n=Vt.get(i);;){n.zpp_inner.zpp_inner.valmod();var r=n.zpp_inner;r.zpp_inner.valmod(),r.zpp_inner.zip_length&&(r.zpp_inner.zip_length=!1,r.zpp_inner.user_length=r.zpp_inner.inner.length);r=r.zpp_inner.user_length;if(n.zpp_critical=!0,!(n.zpp_i<r||(n.zpp_next=Vt.zpp_pool,(Vt.zpp_pool=n).zpp_inner=null,!1)))break;n.zpp_critical=!1,this.append_type(t,n.zpp_inner.at(n.zpp_i++).zpp_inner)}}else if(e instanceof Array&&null==e.__enum__)for(var o=e,s=0;s<o.length;){var a=o[s];++s,this.append_type(t,a.zpp_inner)}},It.prototype.__class__=It;var Gt=zpp_nape.constraint.ZPP_Constraint=function(){this.pre_dt=0,this.wrap_cbTypes=null,this.cbSet=null,this.cbTypes=null,this.__velocity=!1,this.ignore=!1,this.component=null,this.removeOnBreak=!1,this.breakUnderError=!1,this.breakUnderForce=!1,this.maxError=0,this.maxForce=0,this.damping=0,this.frequency=0,this.stiff=!1,this.active=!1,this.space=null,this.compound=null,this.userData=null,this.id=0,this.outer=null,this.__velocity=!1,this.id=xt.Constraint(),this.stiff=!0,this.active=!0,this.ignore=!1,this.frequency=10,this.damping=1,this.maxForce=1/0,this.maxError=1/0,this.breakUnderForce=!1,this.removeOnBreak=!0,this.pre_dt=-1,this.cbTypes=new Et};Gt.__name__=["zpp_nape","constraint","ZPP_Constraint"],Gt.prototype.outer=null,Gt.prototype.clear=function(){},Gt.prototype.id=null,Gt.prototype.userData=null,Gt.prototype.compound=null,Gt.prototype.space=null,Gt.prototype.active=null,Gt.prototype.stiff=null,Gt.prototype.frequency=null,Gt.prototype.damping=null,Gt.prototype.maxForce=null,Gt.prototype.maxError=null,Gt.prototype.breakUnderForce=null,Gt.prototype.breakUnderError=null,Gt.prototype.removeOnBreak=null,Gt.prototype.component=null,Gt.prototype.ignore=null,Gt.prototype.__velocity=null,Gt.prototype.immutable_midstep=function(t){},Gt.prototype.cbTypes=null,Gt.prototype.cbSet=null,Gt.prototype.wrap_cbTypes=null,Gt.prototype.setupcbTypes=function(){this.wrap_cbTypes=Mn.get(this.cbTypes),this.wrap_cbTypes.zpp_inner.adder=Z(this,this.wrap_cbTypes_adder),this.wrap_cbTypes.zpp_inner.subber=Z(this,this.wrap_cbTypes_subber),this.wrap_cbTypes.zpp_inner.dontremove=!0},Gt.prototype.wrap_cbTypes_subber=function(t){t=t.zpp_inner;this.cbTypes.has(t)&&(null!=this.space&&(this.dealloc_cbSet(),t.constraints.remove(this)),this.cbTypes.remove(t),null!=this.space&&(this.alloc_cbSet(),this.wake()))},Gt.prototype.wrap_cbTypes_adder=function(t){return this.insert_cbtype(t.zpp_inner),!1},Gt.prototype.insert_cbtype=function(t){if(!this.cbTypes.has(t)){null!=this.space&&(this.dealloc_cbSet(),t.constraints.add(this));for(var e=null,i=this.cbTypes.head;null!=i&&!(t.id<i.elt.id);)i=(e=i).next;var n=this.cbTypes;null==Ui.zpp_pool?r=new Ui:(r=Ui.zpp_pool,Ui.zpp_pool=r.next,r.next=null),r.elt=t;var r=r;null==e?(r.next=n.head,n.head=r):(r.next=e.next,e.next=r),n.pushmod=n.modified=!0,n.length++,null!=this.space&&(this.alloc_cbSet(),this.wake())}},Gt.prototype.alloc_cbSet=function(){null!=(this.cbSet=this.space.cbsets.get(this.cbTypes))&&(this.cbSet.count++,this.cbSet.constraints.add(this))},Gt.prototype.dealloc_cbSet=function(){if(null!=this.cbSet){if(this.cbSet.constraints.remove(this),0==--this.cbSet.count){this.space.cbsets.remove(this.cbSet);var t=this.cbSet;for(t.listeners.clear(),t.zip_listeners=!0,t.bodylisteners.clear(),t.zip_bodylisteners=!0,t.conlisteners.clear(),t.zip_conlisteners=!0;null!=t.cbTypes.head;)t.cbTypes.pop_unsafe().cbsets.remove(t);t.next=Hn.zpp_pool,Hn.zpp_pool=t}this.cbSet=null}},Gt.prototype.activate=function(){null!=this.space&&this.activeInSpace()},Gt.prototype.deactivate=function(){null!=this.space&&this.inactiveOrOutSpace()},Gt.prototype.addedToSpace=function(){this.active&&this.activeInSpace(),this.activeBodies();for(var t=this.cbTypes.head;null!=t;)t.elt.constraints.add(this),t=t.next},Gt.prototype.removedFromSpace=function(){this.active&&this.inactiveOrOutSpace(),this.inactiveBodies();for(var t=this.cbTypes.head;null!=t;)t.elt.constraints.remove(this),t=t.next},Gt.prototype.activeInSpace=function(){this.alloc_cbSet(),null==ti.zpp_pool?this.component=new ti:(this.component=ti.zpp_pool,ti.zpp_pool=this.component.next,this.component.next=null),this.component.isBody=!1,this.component.constraint=this},Gt.prototype.inactiveOrOutSpace=function(){this.dealloc_cbSet();var t=this.component;t.body=null,t.constraint=null,t.next=ti.zpp_pool,ti.zpp_pool=t,this.component=null},Gt.prototype.activeBodies=function(){},Gt.prototype.inactiveBodies=function(){},Gt.prototype.clearcache=function(){},Gt.prototype.validate=function(){},Gt.prototype.wake_connected=function(){},Gt.prototype.forest=function(){},Gt.prototype.pair_exists=function(t,e){return!1},Gt.prototype.broken=function(){},Gt.prototype.warmStart=function(){},Gt.prototype.pre_dt=null,Gt.prototype.preStep=function(t){return!1},Gt.prototype.applyImpulseVel=function(){return!1},Gt.prototype.applyImpulsePos=function(){return!1},Gt.prototype.wake=function(){null!=this.space&&this.space.wake_constraint(this)},Gt.prototype.draw=function(t){},Gt.prototype.copy=function(t,e){return null},Gt.prototype.copyto=function(t){var e=this.outer;null==e.zpp_inner.wrap_cbTypes&&e.zpp_inner.setupcbTypes();var i=e.zpp_inner.wrap_cbTypes;i.zpp_inner.valmod();for(var n=Vt.get(i);;){n.zpp_inner.zpp_inner.valmod();var r=n.zpp_inner;r.zpp_inner.valmod(),r.zpp_inner.zip_length&&(r.zpp_inner.zip_length=!1,r.zpp_inner.user_length=r.zpp_inner.inner.length);var o=r.zpp_inner.user_length;if(n.zpp_critical=!0,!(n.zpp_i<o||(n.zpp_next=Vt.zpp_pool,(Vt.zpp_pool=n).zpp_inner=null,!1)))break;n.zpp_critical=!1;r=n.zpp_inner.at(n.zpp_i++);null==t.zpp_inner.wrap_cbTypes&&t.zpp_inner.setupcbTypes();o=t.zpp_inner.wrap_cbTypes;o.zpp_inner.reverse_flag?o.push(r):o.unshift(r)}t.zpp_inner.removeOnBreak=e.zpp_inner.removeOnBreak;i=e.zpp_inner.breakUnderError;t.zpp_inner.breakUnderError!=i&&(t.zpp_inner.breakUnderError=i,t.zpp_inner.wake());i=e.zpp_inner.breakUnderForce;t.zpp_inner.breakUnderForce!=i&&(t.zpp_inner.breakUnderForce=i,t.zpp_inner.wake());i=e.zpp_inner.maxError;t.zpp_inner.maxError!=i&&(t.zpp_inner.maxError=i,t.zpp_inner.wake());i=e.zpp_inner.maxForce;t.zpp_inner.maxForce!=i&&(t.zpp_inner.maxForce=i,t.zpp_inner.wake());i=e.zpp_inner.damping;t.zpp_inner.damping!=i&&(t.zpp_inner.damping=i,t.zpp_inner.stiff||t.zpp_inner.wake());i=e.zpp_inner.frequency;t.zpp_inner.frequency!=i&&(t.zpp_inner.frequency=i,t.zpp_inner.stiff||t.zpp_inner.wake());i=e.zpp_inner.stiff;t.zpp_inner.stiff!=i&&(t.zpp_inner.stiff=i,t.zpp_inner.wake());i=e.zpp_inner.ignore;t.zpp_inner.ignore!=i&&(t.zpp_inner.ignore=i,t.zpp_inner.wake());e=e.zpp_inner.active;t.zpp_inner.active!=e&&(null!=t.zpp_inner.component&&(t.zpp_inner.component.woken=!1),t.zpp_inner.clearcache(),e?(t.zpp_inner.active=e,t.zpp_inner.activate(),null!=t.zpp_inner.space&&(null!=t.zpp_inner.component&&(t.zpp_inner.component.sleeping=!0),t.zpp_inner.space.wake_constraint(t.zpp_inner,!0))):(null!=t.zpp_inner.space&&(t.zpp_inner.wake(),t.zpp_inner.space.live_constraints.remove(t.zpp_inner)),t.zpp_inner.active=e,t.zpp_inner.deactivate()))},Gt.prototype.__class__=Gt;var Dt=zpp_nape.constraint.ZPP_AngleJoint=function(){this.stepped=!1,this.bias=0,this.gamma=0,this.jMax=0,this.jAcc=0,this.kMass=0,this.b2=null,this.b1=null,this.scale=0,this.equal=!1,this.slack=!1,this.jointMax=0,this.jointMin=0,this.ratio=0,this.outer_zn=null,Gt.call(this),this.ratio=1,this.jAcc=0,this.slack=!1,this.jMax=1/0,this.stepped=!1};Dt.__name__=["zpp_nape","constraint","ZPP_AngleJoint"],Dt.__super__=Gt,Dt.prototype=Object.create(Gt.prototype),Dt.prototype.outer_zn=null,Dt.prototype.ratio=null,Dt.prototype.jointMin=null,Dt.prototype.jointMax=null,Dt.prototype.slack=null,Dt.prototype.equal=null,Dt.prototype.scale=null,Dt.prototype.is_slack=function(){var t,e=this.ratio*this.b2.rot-this.b1.rot;return this.equal?(t=!1,this.scale=1):t=e<this.jointMin?!(this.scale=-1):e>this.jointMax?(e-=this.jointMax,!(this.scale=1)):!(e=this.scale=0),t},Dt.prototype.bodyImpulse=function(t){return this.stepped?t==this.b1?K.get(0,0,-this.scale*this.jAcc):K.get(0,0,this.ratio*this.scale*this.jAcc):K.get(0,0,0)},Dt.prototype.activeBodies=function(){null!=this.b1&&this.b1.constraints.add(this),this.b2!=this.b1&&null!=this.b2&&this.b2.constraints.add(this)},Dt.prototype.inactiveBodies=function(){null!=this.b1&&this.b1.constraints.remove(this),this.b2!=this.b1&&null!=this.b2&&this.b2.constraints.remove(this)},Dt.prototype.b1=null,Dt.prototype.b2=null,Dt.prototype.kMass=null,Dt.prototype.jAcc=null,Dt.prototype.jMax=null,Dt.prototype.gamma=null,Dt.prototype.bias=null,Dt.prototype.stepped=null,Dt.prototype.copy=function(t,e){var i=new z(null,null,this.jointMin,this.jointMax,this.ratio);if(this.copyto(i),null!=t&&null!=this.b1){for(var n=null,r=0;r<t.length;){var o=t[r];if(++r,o.id==this.b1.id){n=o.bc;break}}null!=n?i.zpp_inner_zn.b1=n.zpp_inner:e.push(Lt.todo(this.b1.id,function(t){i.zpp_inner_zn.b1=t.zpp_inner}))}if(null!=t&&null!=this.b2){for(var s=null,a=0;a<t.length;){var h=t[a];if(++a,h.id==this.b2.id){s=h.bc;break}}null!=s?i.zpp_inner_zn.b2=s.zpp_inner:e.push(Lt.todo(this.b2.id,function(t){i.zpp_inner_zn.b2=t.zpp_inner}))}return i},Dt.prototype.validate=function(){if(null==this.b1||null==this.b2)throw new r("Error: AngleJoint cannot be simulated null bodies");if(this.b1==this.b2)throw new r("Error: AngleJoint cannot be simulated with body1 == body2");if(this.b1.space!=this.space||this.b2.space!=this.space)throw new r("Error: Constraints must have each body within the same space to which the constraint has been assigned");if(this.jointMin>this.jointMax)throw new r("Error: AngleJoint must have jointMin <= jointMax");if(2!=this.b1.type&&2!=this.b2.type)throw new r("Error: Constraints cannot have both bodies non-dynamic")},Dt.prototype.wake_connected=function(){null!=this.b1&&2==this.b1.type&&this.b1.wake(),null!=this.b2&&2==this.b2.type&&this.b2.wake()},Dt.prototype.forest=function(){if(2==this.b1.type){var t,e;if(this.b1.component==this.b1.component.parent)t=this.b1.component;else{for(var i=this.b1.component,n=null;i!=i.parent;){var r=i.parent;i.parent=n,n=i,i=r}for(;null!=n;){var o=n.parent;n.parent=i,n=o}t=i}if(this.component==this.component.parent)e=this.component;else{for(var s=this.component,a=null;s!=s.parent;){var h=s.parent;s.parent=a,a=s,s=h}for(;null!=a;){var l=a.parent;a.parent=s,a=l}e=s}t!=e&&(t.rank<e.rank?t.parent=e:t.rank>e.rank?e.parent=t:(e.parent=t).rank++)}if(2==this.b2.type){var p,u;if(this.b2.component==this.b2.component.parent)p=this.b2.component;else{for(var d=this.b2.component,c=null;d!=d.parent;){var y=d.parent;d.parent=c,c=d,d=y}for(;null!=c;){var _=c.parent;c.parent=d,c=_}p=d}if(this.component==this.component.parent)u=this.component;else{for(var m=this.component,g=null;m!=m.parent;){var f=m.parent;m.parent=g,g=m,m=f}for(;null!=g;){var x=g.parent;g.parent=m,g=x}u=m}p!=u&&(p.rank<u.rank?p.parent=u:p.rank>u.rank?u.parent=p:(u.parent=p).rank++)}},Dt.prototype.pair_exists=function(t,e){return this.b1.id==t&&this.b2.id==e||this.b1.id==e&&this.b2.id==t},Dt.prototype.clearcache=function(){this.jAcc=0,this.pre_dt=-1,this.slack=!1},Dt.prototype.preStep=function(t){-1==this.pre_dt&&(this.pre_dt=t);var e=t/this.pre_dt;this.pre_dt=t,this.stepped=!0,this.equal=this.jointMin==this.jointMax;var i=this.ratio*this.b2.rot-this.b1.rot;this.equal?(i-=this.jointMax,this.slack=!1,this.scale=1):i<this.jointMin?(i=this.jointMin-i,this.scale=-1,this.slack=!1):i>this.jointMax?(i-=this.jointMax,this.scale=1,this.slack=!1):(this.scale=0,this.slack=!(i=0));var n=i;if(!this.slack){if(this.kMass=this.b1.sinertia+this.ratio*this.ratio*this.b2.sinertia,0!=this.kMass?this.kMass=1/this.kMass:this.jAcc=0,this.stiff)this.bias=0,this.gamma=0;else{if(this.breakUnderError&&n*n>this.maxError*this.maxError)return!0;var r=2*Math.PI*this.frequency;this.gamma=1/(t*r*(2*this.damping+r*t));i=1/(1+this.gamma),r=t*r*r*this.gamma;this.gamma*=i,this.kMass*=i,this.bias=-n*r,this.bias<-this.maxError?this.bias=-this.maxError:this.bias>this.maxError&&(this.bias=this.maxError)}this.jAcc*=e,this.jMax=this.maxForce*t}return!1},Dt.prototype.warmStart=function(){this.slack||(this.b1.angvel-=this.scale*this.b1.iinertia*this.jAcc,this.b2.angvel+=this.ratio*this.scale*this.b2.iinertia*this.jAcc)},Dt.prototype.applyImpulseVel=function(){if(this.slack)return!1;var t=this.kMass*(this.bias-this.scale*(this.ratio*(this.b2.angvel+this.b2.kinangvel)-this.b1.angvel-this.b1.kinangvel))-this.jAcc*this.gamma,e=this.jAcc;return this.jAcc+=t,!this.equal&&0<this.jAcc&&(this.jAcc=0),!(!this.breakUnderForce||!(this.jAcc>this.jMax||this.jAcc<-this.jMax))||(this.stiff||(this.jAcc>this.jMax?this.jAcc=this.jMax:this.jAcc<-this.jMax&&(this.jAcc=-this.jMax)),t=this.jAcc-e,this.b1.angvel-=this.scale*this.b1.iinertia*t,this.b2.angvel+=this.ratio*this.scale*this.b2.iinertia*t,!1)},Dt.prototype.applyImpulsePos=function(){var t=this.ratio*this.b2.rot-this.b1.rot;if(this.equal?(t-=this.jointMax,i=!1,this.scale=1):i=t<this.jointMin?(t=this.jointMin-t,!(this.scale=-1)):t>this.jointMax?(t-=this.jointMax,!(this.scale=1)):!(t=this.scale=0),e=t,!i){if(this.breakUnderError&&e*e>this.maxError*this.maxError)return!0;var e,i,n,r,o=-(e*=.5)*this.kMass;(this.equal||o<0)&&(t=this.b1,i=-this.scale*o*this.b1.iinertia,t.rot+=i,1e-4<i*i?(t.axisx=Math.sin(t.rot),t.axisy=Math.cos(t.rot)):(r=((e=1-.5*(r=i*i))*t.axisx+i*t.axisy)*(n=1-r*r/8),t.axisy=(e*t.axisy-i*t.axisx)*n,t.axisx=r),i=this.b2,n=this.ratio*this.scale*o*this.b2.iinertia,i.rot+=n,1e-4<n*n?(i.axisx=Math.sin(i.rot),i.axisy=Math.cos(i.rot)):(t=((r=1-.5*(t=n*n))*i.axisx+n*i.axisy)*(o=1-t*t/8),i.axisy=(r*i.axisy-n*i.axisx)*o,i.axisx=t))}return!1},Dt.prototype.draw=function(t){},Dt.prototype.__class__=Dt;var Lt=zpp_nape.constraint.ZPP_CopyHelper=function(){this.cb=null,this.bc=null,this.id=0};Lt.__name__=["zpp_nape","constraint","ZPP_CopyHelper"],Lt.dict=function(t,e){var i=new Lt;return i.id=t,i.bc=e,i},Lt.todo=function(t,e){var i=new Lt;return i.id=t,i.cb=e,i},Lt.prototype.id=null,Lt.prototype.bc=null,Lt.prototype.cb=null,Lt.prototype.__class__=Lt;var Bt=zpp_nape.constraint.ZPP_DistanceJoint=function(){this.stepped=!1,this.bias=0,this.gamma=0,this.jMax=0,this.jAcc=0,this.kMass=0,this.wrap_a2=null,this.a2rely=0,this.a2relx=0,this.a2localy=0,this.a2localx=0,this.b2=null,this.wrap_a1=null,this.a1rely=0,this.a1relx=0,this.a1localy=0,this.a1localx=0,this.b1=null,this.cx2=0,this.cx1=0,this.ny=0,this.nx=0,this.equal=!1,this.slack=!1,this.jointMax=0,this.jointMin=0,this.outer_zn=null,Gt.call(this),this.a1localx=0,this.a1localy=0,this.a1relx=0,this.a1rely=0,this.a2localx=0,this.a2localy=0,this.a2relx=0,this.a2rely=0,this.jAcc=0,this.jMax=1/0,this.stepped=!1,this.cx1=this.cx2=0};Bt.__name__=["zpp_nape","constraint","ZPP_DistanceJoint"],Bt.__super__=Gt,Bt.prototype=Object.create(Gt.prototype),Bt.prototype.outer_zn=null,Bt.prototype.jointMin=null,Bt.prototype.jointMax=null,Bt.prototype.slack=null,Bt.prototype.equal=null,Bt.prototype.is_slack=function(){this.a1relx=this.b1.axisy*this.a1localx-this.b1.axisx*this.a1localy,this.a1rely=this.a1localx*this.b1.axisx+this.a1localy*this.b1.axisy,this.a2relx=this.b2.axisy*this.a2localx-this.b2.axisx*this.a2localy,this.a2rely=this.a2localx*this.b2.axisx+this.a2localy*this.b2.axisy;var t,e=0,i=0,n=(e=this.b2.posx+this.a2relx-(this.b1.posx+this.a1relx))*e+(i=this.b2.posy+this.a2rely-(this.b1.posy+this.a1rely))*i;return n<Er.epsilon||(e*=t=1/(n=Math.sqrt(n)),i*=t,!this.equal&&(!(n<this.jointMin)&&(n>this.jointMax?(n-=this.jointMax,!1):!(n=0))))},Bt.prototype.nx=null,Bt.prototype.ny=null,Bt.prototype.cx1=null,Bt.prototype.cx2=null,Bt.prototype.bodyImpulse=function(t){return this.stepped?t==this.b1?K.get(-this.jAcc*this.nx,-this.jAcc*this.ny,-this.cx1*this.jAcc):K.get(this.jAcc*this.nx,this.jAcc*this.ny,this.cx2*this.jAcc):K.get(0,0,0)},Bt.prototype.activeBodies=function(){null!=this.b1&&this.b1.constraints.add(this),this.b2!=this.b1&&null!=this.b2&&this.b2.constraints.add(this)},Bt.prototype.inactiveBodies=function(){null!=this.b1&&this.b1.constraints.remove(this),this.b2!=this.b1&&null!=this.b2&&this.b2.constraints.remove(this)},Bt.prototype.b1=null,Bt.prototype.a1localx=null,Bt.prototype.a1localy=null,Bt.prototype.a1relx=null,Bt.prototype.a1rely=null,Bt.prototype.validate_a1=function(){this.wrap_a1.zpp_inner.x=this.a1localx,this.wrap_a1.zpp_inner.y=this.a1localy},Bt.prototype.invalidate_a1=function(t){this.immutable_midstep("Constraint::a1"),this.a1localx=t.x,this.a1localy=t.y,this.wake()},Bt.prototype.setup_a1=function(){var t,e,i=this.a1localx,n=this.a1localy;null==Bn.poolVec2?t=new St:(t=Bn.poolVec2,Bn.poolVec2=t.zpp_pool,t.zpp_pool=null),null==t.zpp_inner?(null==Gr.zpp_pool?e=new Gr:(e=Gr.zpp_pool,Gr.zpp_pool=e.next,e.next=null),e.weak=!1,e._immutable=!1,e.x=i,e.y=n,t.zpp_inner=e,t.zpp_inner.outer=t):(null!=(e=t.zpp_inner)._validate&&e._validate(),t.zpp_inner.x==i&&(null!=(e=t.zpp_inner)._validate&&e._validate(),t.zpp_inner.y==n)||(t.zpp_inner.x=i,t.zpp_inner.y=n,null!=(n=t.zpp_inner)._invalidate&&n._invalidate(n))),t.zpp_inner.weak=!1,this.wrap_a1=t,this.wrap_a1.zpp_inner._inuse=!0,this.wrap_a1.zpp_inner._validate=Z(this,this.validate_a1),this.wrap_a1.zpp_inner._invalidate=Z(this,this.invalidate_a1)},Bt.prototype.wrap_a1=null,Bt.prototype.b2=null,Bt.prototype.a2localx=null,Bt.prototype.a2localy=null,Bt.prototype.a2relx=null,Bt.prototype.a2rely=null,Bt.prototype.validate_a2=function(){this.wrap_a2.zpp_inner.x=this.a2localx,this.wrap_a2.zpp_inner.y=this.a2localy},Bt.prototype.invalidate_a2=function(t){this.immutable_midstep("Constraint::a2"),this.a2localx=t.x,this.a2localy=t.y,this.wake()},Bt.prototype.setup_a2=function(){var t,e,i=this.a2localx,n=this.a2localy;null==Bn.poolVec2?t=new St:(t=Bn.poolVec2,Bn.poolVec2=t.zpp_pool,t.zpp_pool=null),null==t.zpp_inner?(null==Gr.zpp_pool?e=new Gr:(e=Gr.zpp_pool,Gr.zpp_pool=e.next,e.next=null),e.weak=!1,e._immutable=!1,e.x=i,e.y=n,t.zpp_inner=e,t.zpp_inner.outer=t):(null!=(e=t.zpp_inner)._validate&&e._validate(),t.zpp_inner.x==i&&(null!=(e=t.zpp_inner)._validate&&e._validate(),t.zpp_inner.y==n)||(t.zpp_inner.x=i,t.zpp_inner.y=n,null!=(n=t.zpp_inner)._invalidate&&n._invalidate(n))),t.zpp_inner.weak=!1,this.wrap_a2=t,this.wrap_a2.zpp_inner._inuse=!0,this.wrap_a2.zpp_inner._validate=Z(this,this.validate_a2),this.wrap_a2.zpp_inner._invalidate=Z(this,this.invalidate_a2)},Bt.prototype.wrap_a2=null,Bt.prototype.kMass=null,Bt.prototype.jAcc=null,Bt.prototype.jMax=null,Bt.prototype.gamma=null,Bt.prototype.bias=null,Bt.prototype.stepped=null,Bt.prototype.copy=function(t,e){var i=this.outer_zn;null==i.zpp_inner_zn.wrap_a1&&i.zpp_inner_zn.setup_a1();var n=i.zpp_inner_zn.wrap_a1,i=this.outer_zn;null==i.zpp_inner_zn.wrap_a2&&i.zpp_inner_zn.setup_a2();var r=new S(null,null,n,i.zpp_inner_zn.wrap_a2,this.jointMin,this.jointMax);if(this.copyto(r),null!=t&&null!=this.b1){for(var o=null,s=0;s<t.length;){var a=t[s];if(++s,a.id==this.b1.id){o=a.bc;break}}null!=o?r.zpp_inner_zn.b1=o.zpp_inner:e.push(Lt.todo(this.b1.id,function(t){r.zpp_inner_zn.b1=t.zpp_inner}))}if(null!=t&&null!=this.b2){for(var h=null,l=0;l<t.length;){var p=t[l];if(++l,p.id==this.b2.id){h=p.bc;break}}null!=h?r.zpp_inner_zn.b2=h.zpp_inner:e.push(Lt.todo(this.b2.id,function(t){r.zpp_inner_zn.b2=t.zpp_inner}))}return r},Bt.prototype.validate=function(){if(null==this.b1||null==this.b2)throw new r("Error: DistanceJoint cannot be simulated null bodies");if(this.b1==this.b2)throw new r("Error: DistanceJoint cannot be simulated with body1 == body2");if(this.b1.space!=this.space||this.b2.space!=this.space)throw new r("Error: Constraints must have each body within the same space to which the constraint has been assigned");if(this.jointMin>this.jointMax)throw new r("Error: DistanceJoint must have jointMin <= jointMax");if(2!=this.b1.type&&2!=this.b2.type)throw new r("Error: Constraints cannot have both bodies non-dynamic")},Bt.prototype.wake_connected=function(){null!=this.b1&&2==this.b1.type&&this.b1.wake(),null!=this.b2&&2==this.b2.type&&this.b2.wake()},Bt.prototype.forest=function(){if(2==this.b1.type){var t,e;if(this.b1.component==this.b1.component.parent)t=this.b1.component;else{for(var i=this.b1.component,n=null;i!=i.parent;){var r=i.parent;i.parent=n,n=i,i=r}for(;null!=n;){var o=n.parent;n.parent=i,n=o}t=i}if(this.component==this.component.parent)e=this.component;else{for(var s=this.component,a=null;s!=s.parent;){var h=s.parent;s.parent=a,a=s,s=h}for(;null!=a;){var l=a.parent;a.parent=s,a=l}e=s}t!=e&&(t.rank<e.rank?t.parent=e:t.rank>e.rank?e.parent=t:(e.parent=t).rank++)}if(2==this.b2.type){var p,u;if(this.b2.component==this.b2.component.parent)p=this.b2.component;else{for(var d=this.b2.component,c=null;d!=d.parent;){var y=d.parent;d.parent=c,c=d,d=y}for(;null!=c;){var _=c.parent;c.parent=d,c=_}p=d}if(this.component==this.component.parent)u=this.component;else{for(var m=this.component,g=null;m!=m.parent;){var f=m.parent;m.parent=g,g=m,m=f}for(;null!=g;){var x=g.parent;g.parent=m,g=x}u=m}p!=u&&(p.rank<u.rank?p.parent=u:p.rank>u.rank?u.parent=p:(u.parent=p).rank++)}},Bt.prototype.pair_exists=function(t,e){return this.b1.id==t&&this.b2.id==e||this.b1.id==e&&this.b2.id==t},Bt.prototype.clearcache=function(){this.jAcc=0,this.pre_dt=-1},Bt.prototype.preStep=function(t){-1==this.pre_dt&&(this.pre_dt=t);var e=t/this.pre_dt;this.pre_dt=t,this.stepped=!0,this.equal=this.jointMin==this.jointMax,this.a1relx=this.b1.axisy*this.a1localx-this.b1.axisx*this.a1localy,this.a1rely=this.a1localx*this.b1.axisx+this.a1localy*this.b1.axisy,this.a2relx=this.b2.axisy*this.a2localx-this.b2.axisx*this.a2localy,this.a2rely=this.a2localx*this.b2.axisx+this.a2localy*this.b2.axisy,this.nx=this.b2.posx+this.a2relx-(this.b1.posx+this.a1relx),this.ny=this.b2.posy+this.a2rely-(this.b1.posy+this.a1rely);var i=this.nx*this.nx+this.ny*this.ny;i<Er.epsilon?(this.nx=0,this.ny=0,this.slack=!(i=0)):(r=1/(i=Math.sqrt(i)),this.nx*=r,this.ny*=r,this.equal?(i-=this.jointMax,this.slack=!1):i<this.jointMin?(i=this.jointMin-i,this.nx=-this.nx,this.ny=-this.ny,this.slack=!1):i>this.jointMax?(i-=this.jointMax,this.slack=!1):(this.nx=0,this.ny=0,this.slack=!(i=0)));var n=i;if(!this.slack){if(this.cx1=this.ny*this.a1relx-this.nx*this.a1rely,this.cx2=this.ny*this.a2relx-this.nx*this.a2rely,this.kMass=this.b1.smass+this.b2.smass+this.cx1*this.cx1*this.b1.sinertia+this.cx2*this.cx2*this.b2.sinertia,0!=this.kMass?this.kMass=1/this.kMass:this.jAcc=0,this.stiff)this.bias=0,this.gamma=0;else{if(this.breakUnderError&&n*n>this.maxError*this.maxError)return!0;var r=2*Math.PI*this.frequency;this.gamma=1/(t*r*(2*this.damping+r*t));i=1/(1+this.gamma),r=t*r*r*this.gamma;this.gamma*=i,this.kMass*=i,this.bias=-n*r,this.bias<-this.maxError?this.bias=-this.maxError:this.bias>this.maxError&&(this.bias=this.maxError)}this.jAcc*=e,this.jMax=this.maxForce*t}return!1},Bt.prototype.warmStart=function(){var t;this.slack||(t=this.b1.imass*this.jAcc,this.b1.velx-=this.nx*t,this.b1.vely-=this.ny*t,t=this.b2.imass*this.jAcc,this.b2.velx+=this.nx*t,this.b2.vely+=this.ny*t,this.b1.angvel-=this.cx1*this.b1.iinertia*this.jAcc,this.b2.angvel+=this.cx2*this.b2.iinertia*this.jAcc)},Bt.prototype.applyImpulseVel=function(){if(this.slack)return!1;var t=this.kMass*(this.bias-(this.nx*(this.b2.velx+this.b2.kinvelx-this.b1.velx-this.b1.kinvelx)+this.ny*(this.b2.vely+this.b2.kinvely-this.b1.vely-this.b1.kinvely)+(this.b2.angvel+this.b2.kinangvel)*this.cx2-(this.b1.angvel+this.b1.kinangvel)*this.cx1))-this.jAcc*this.gamma,e=this.jAcc;if(this.jAcc+=t,!this.equal&&0<this.jAcc&&(this.jAcc=0),this.breakUnderForce&&this.jAcc<-this.jMax)return!0;this.stiff||this.jAcc<-this.jMax&&(this.jAcc=-this.jMax);t=this.jAcc-e,e=this.b1.imass*t;this.b1.velx-=this.nx*e,this.b1.vely-=this.ny*e;e=this.b2.imass*t;return this.b2.velx+=this.nx*e,this.b2.vely+=this.ny*e,this.b1.angvel-=this.cx1*this.b1.iinertia*t,this.b2.angvel+=this.cx2*this.b2.iinertia*t,!1},Bt.prototype.applyImpulsePos=function(){var t=this.b1.axisy*this.a1localx-this.b1.axisx*this.a1localy,e=this.a1localx*this.b1.axisx+this.a1localy*this.b1.axisy,i=this.b2.axisy*this.a2localx-this.b2.axisx*this.a2localy,n=this.a2localx*this.b2.axisx+this.a2localy*this.b2.axisy,r=0,o=0,s=(r=this.b2.posx+i-(this.b1.posx+t))*r+(o=this.b2.posy+n-(this.b1.posy+e))*o,a=s<Er.epsilon?!(s=o=r=0):(r*=h=1/(s=Math.sqrt(s)),o*=h,this.equal?(s-=this.jointMax,!1):s<this.jointMin?(s=this.jointMin-s,r=-r,o=-o,!1):s>this.jointMax?(s-=this.jointMax,!1):!(s=o=r=0)),h=s;if(!a){if(this.breakUnderError&&h*h>this.maxError*this.maxError)return!0;if(h*h<Er.constraintLinearSlop*Er.constraintLinearSlop)return!1;6<(h*=.5)*h&&(s=this.b1.smass+this.b2.smass,Er.epsilon<s&&(p=-h*(s=.75/s),(this.equal||p<0)&&(a=p*this.b1.imass,this.b1.posx-=r*a,this.b1.posy-=o*a,s=p*this.b2.imass,this.b2.posx+=r*s,this.b2.posy+=o*s,(a=(r=this.b2.posx+i-(this.b1.posx+t))*r+(o=this.b2.posy+n-(this.b1.posy+e))*o)<Er.epsilon?a=o=r=0:(r*=s=1/(a=Math.sqrt(a)),o*=s,this.equal?a-=this.jointMax:a<this.jointMin?(a=this.jointMin-a,r=-r,o=-o):a>this.jointMax?a-=this.jointMax:a=o=r=0),h=a,h*=.5)));var l,p,u,n=this.b1.smass+this.b2.smass+(e=o*t-r*e)*e*this.b1.sinertia+(i=o*i-r*n)*i*this.b2.sinertia;p=-h*(n=0!=n?1/n:n),(this.equal||p<0)&&(n=this.b1.imass*p,this.b1.posx-=r*n,this.b1.posy-=o*n,n=this.b2.imass*p,this.b2.posx+=r*n,this.b2.posy+=o*n,o=this.b1,n=-e*this.b1.iinertia*p,o.rot+=n,1e-4<n*n?(o.axisx=Math.sin(o.rot),o.axisy=Math.cos(o.rot)):(u=((e=1-.5*(u=n*n))*o.axisx+n*o.axisy)*(l=1-u*u/8),o.axisy=(e*o.axisy-n*o.axisx)*l,o.axisx=u),l=this.b2,o=i*this.b2.iinertia*p,l.rot+=o,1e-4<o*o?(l.axisx=Math.sin(l.rot),l.axisy=Math.cos(l.rot)):(u=((i=1-.5*(u=o*o))*l.axisx+o*l.axisy)*(p=1-u*u/8),l.axisy=(i*l.axisy-o*l.axisx)*p,l.axisx=u))}return!1},Bt.prototype.draw=function(t){},Bt.prototype.__class__=Bt;var Rt=zpp_nape.constraint.ZPP_LineJoint=function(){this.biasy=0,this.biasx=0,this.jAccy=0,this.jAccx=0,this.kMassc=0,this.kMassb=0,this.kMassa=0,this.wrap_n=null,this.nrely=0,this.nrelx=0,this.nlocaly=0,this.nlocalx=0,this.wrap_a2=null,this.a2rely=0,this.a2relx=0,this.a2localy=0,this.a2localx=0,this.wrap_a1=null,this.a1rely=0,this.a1relx=0,this.a1localy=0,this.a1localx=0,this.cx2=0,this.cx1=0,this.dot2=0,this.dot1=0,this.equal=!1,this.jointMax=0,this.jointMin=0,this.scale=0,this.outer_zn=null,Gt.call(this),this.a1localx=0,this.a1localy=0,this.a1relx=0,this.a1rely=0,this.a2localx=0,this.a2localy=0,this.a2relx=0,this.a2rely=0,this.nlocalx=0,this.nlocaly=0,this.nrelx=0,this.nrely=0,this.jAccx=0,this.jAccy=0,this.jMax=1/0,this.jointMin=-1/0,this.jointMax=1/0,this.stepped=!1};Rt.__name__=["zpp_nape","constraint","ZPP_LineJoint"],Rt.__super__=Gt,Rt.prototype=Object.create(Gt.prototype),Rt.prototype.outer_zn=null,Rt.prototype.scale=null,Rt.prototype.jointMin=null,Rt.prototype.jointMax=null,Rt.prototype.equal=null,Rt.prototype.dot1=null,Rt.prototype.dot2=null,Rt.prototype.cx1=null,Rt.prototype.cx2=null,Rt.prototype.bodyImpulse=function(t){if(this.stepped){var e=this.scale*this.nrelx*this.jAccy-this.nrely*this.jAccx,i=this.nrelx*this.jAccx+this.scale*this.nrely*this.jAccy;return t==this.b1?K.get(-e,-i,this.scale*this.cx1*i-this.dot1*e):K.get(e,i,this.scale*this.cx1*i-this.dot1*e)}return K.get(0,0,0)},Rt.prototype.activeBodies=function(){null!=this.b1&&this.b1.constraints.add(this),this.b2!=this.b1&&null!=this.b2&&this.b2.constraints.add(this)},Rt.prototype.inactiveBodies=function(){null!=this.b1&&this.b1.constraints.remove(this),this.b2!=this.b1&&null!=this.b2&&this.b2.constraints.remove(this)},Rt.prototype.b1=null,Rt.prototype.a1localx=null,Rt.prototype.a1localy=null,Rt.prototype.a1relx=null,Rt.prototype.a1rely=null,Rt.prototype.validate_a1=function(){this.wrap_a1.zpp_inner.x=this.a1localx,this.wrap_a1.zpp_inner.y=this.a1localy},Rt.prototype.invalidate_a1=function(t){this.immutable_midstep("Constraint::a1"),this.a1localx=t.x,this.a1localy=t.y,this.wake()},Rt.prototype.setup_a1=function(){var t,e,i=this.a1localx,n=this.a1localy;null==Bn.poolVec2?t=new St:(t=Bn.poolVec2,Bn.poolVec2=t.zpp_pool,t.zpp_pool=null),null==t.zpp_inner?(null==Gr.zpp_pool?e=new Gr:(e=Gr.zpp_pool,Gr.zpp_pool=e.next,e.next=null),e.weak=!1,e._immutable=!1,e.x=i,e.y=n,t.zpp_inner=e,t.zpp_inner.outer=t):(null!=(e=t.zpp_inner)._validate&&e._validate(),t.zpp_inner.x==i&&(null!=(e=t.zpp_inner)._validate&&e._validate(),t.zpp_inner.y==n)||(t.zpp_inner.x=i,t.zpp_inner.y=n,null!=(n=t.zpp_inner)._invalidate&&n._invalidate(n))),t.zpp_inner.weak=!1,this.wrap_a1=t,this.wrap_a1.zpp_inner._inuse=!0,this.wrap_a1.zpp_inner._validate=Z(this,this.validate_a1),this.wrap_a1.zpp_inner._invalidate=Z(this,this.invalidate_a1)},Rt.prototype.wrap_a1=null,Rt.prototype.b2=null,Rt.prototype.a2localx=null,Rt.prototype.a2localy=null,Rt.prototype.a2relx=null,Rt.prototype.a2rely=null,Rt.prototype.validate_a2=function(){this.wrap_a2.zpp_inner.x=this.a2localx,this.wrap_a2.zpp_inner.y=this.a2localy},Rt.prototype.invalidate_a2=function(t){this.immutable_midstep("Constraint::a2"),this.a2localx=t.x,this.a2localy=t.y,this.wake()},Rt.prototype.setup_a2=function(){var t,e,i=this.a2localx,n=this.a2localy;null==Bn.poolVec2?t=new St:(t=Bn.poolVec2,Bn.poolVec2=t.zpp_pool,t.zpp_pool=null),null==t.zpp_inner?(null==Gr.zpp_pool?e=new Gr:(e=Gr.zpp_pool,Gr.zpp_pool=e.next,e.next=null),e.weak=!1,e._immutable=!1,e.x=i,e.y=n,t.zpp_inner=e,t.zpp_inner.outer=t):(null!=(e=t.zpp_inner)._validate&&e._validate(),t.zpp_inner.x==i&&(null!=(e=t.zpp_inner)._validate&&e._validate(),t.zpp_inner.y==n)||(t.zpp_inner.x=i,t.zpp_inner.y=n,null!=(n=t.zpp_inner)._invalidate&&n._invalidate(n))),t.zpp_inner.weak=!1,this.wrap_a2=t,this.wrap_a2.zpp_inner._inuse=!0,this.wrap_a2.zpp_inner._validate=Z(this,this.validate_a2),this.wrap_a2.zpp_inner._invalidate=Z(this,this.invalidate_a2)},Rt.prototype.wrap_a2=null,Rt.prototype.zip_n=null,Rt.prototype.nlocalx=null,Rt.prototype.nlocaly=null,Rt.prototype.nrelx=null,Rt.prototype.nrely=null,Rt.prototype.validate_n=function(){this.wrap_n.zpp_inner.x=this.nlocalx,this.wrap_n.zpp_inner.y=this.nlocaly},Rt.prototype.invalidate_n=function(t){this.immutable_midstep("Constraint::n"),this.nlocalx=t.x,this.nlocaly=t.y,this.zip_n=!0,this.wake()},Rt.prototype.setup_n=function(){var t,e,i=this.nlocalx,n=this.nlocaly;null==Bn.poolVec2?t=new St:(t=Bn.poolVec2,Bn.poolVec2=t.zpp_pool,t.zpp_pool=null),null==t.zpp_inner?(null==Gr.zpp_pool?e=new Gr:(e=Gr.zpp_pool,Gr.zpp_pool=e.next,e.next=null),e.weak=!1,e._immutable=!1,e.x=i,e.y=n,t.zpp_inner=e,t.zpp_inner.outer=t):(null!=(e=t.zpp_inner)._validate&&e._validate(),t.zpp_inner.x==i&&(null!=(e=t.zpp_inner)._validate&&e._validate(),t.zpp_inner.y==n)||(t.zpp_inner.x=i,t.zpp_inner.y=n,null!=(n=t.zpp_inner)._invalidate&&n._invalidate(n))),t.zpp_inner.weak=!1,this.wrap_n=t,this.wrap_n.zpp_inner._inuse=!0,this.wrap_n.zpp_inner._validate=Z(this,this.validate_n),this.wrap_n.zpp_inner._invalidate=Z(this,this.invalidate_n)},Rt.prototype.wrap_n=null,Rt.prototype.validate_norm=function(){var t;this.zip_n&&(this.zip_n=!1,t=1/Math.sqrt(this.nlocalx*this.nlocalx+this.nlocaly*this.nlocaly),this.nlocalx*=t,this.nlocaly*=t)},Rt.prototype.kMassa=null,Rt.prototype.kMassb=null,Rt.prototype.kMassc=null,Rt.prototype.jAccx=null,Rt.prototype.jAccy=null,Rt.prototype.jMax=null,Rt.prototype.gamma=null,Rt.prototype.biasx=null,Rt.prototype.biasy=null,Rt.prototype.stepped=null,Rt.prototype.copy=function(t,e){var i=this.outer_zn;null==i.zpp_inner_zn.wrap_a1&&i.zpp_inner_zn.setup_a1();var n=i.zpp_inner_zn.wrap_a1,r=this.outer_zn;null==r.zpp_inner_zn.wrap_a2&&r.zpp_inner_zn.setup_a2();i=r.zpp_inner_zn.wrap_a2,r=this.outer_zn;null==r.zpp_inner_zn.wrap_n&&r.zpp_inner_zn.setup_n();var o=new C(null,null,n,i,r.zpp_inner_zn.wrap_n,this.jointMin,this.jointMax);if(this.copyto(o),null!=t&&null!=this.b1){for(var s=null,a=0;a<t.length;){var h=t[a];if(++a,h.id==this.b1.id){s=h.bc;break}}null!=s?o.zpp_inner_zn.b1=s.zpp_inner:e.push(Lt.todo(this.b1.id,function(t){o.zpp_inner_zn.b1=t.zpp_inner}))}if(null!=t&&null!=this.b2){for(var l=null,p=0;p<t.length;){var u=t[p];if(++p,u.id==this.b2.id){l=u.bc;break}}null!=l?o.zpp_inner_zn.b2=l.zpp_inner:e.push(Lt.todo(this.b2.id,function(t){o.zpp_inner_zn.b2=t.zpp_inner}))}return o},Rt.prototype.validate=function(){if(null==this.b1||null==this.b2)throw new r("Error: AngleJoint cannot be simulated null bodies");if(this.b1==this.b2)throw new r("Error: DistanceJoint cannot be simulated with body1 == body2");if(this.b1.space!=this.space||this.b2.space!=this.space)throw new r("Error: Constraints must have each body within the same space to which the constraint has been assigned");if(this.jointMin>this.jointMax)throw new r("Error: DistanceJoint must have jointMin <= jointMax");if(this.nlocalx*this.nlocalx+this.nlocaly*this.nlocaly<Er.epsilon)throw new r("Error: DistanceJoint direction must be non-degenerate");if(2!=this.b1.type&&2!=this.b2.type)throw new r("Error: Constraints cannot have both bodies non-dynamic")},Rt.prototype.wake_connected=function(){null!=this.b1&&2==this.b1.type&&this.b1.wake(),null!=this.b2&&2==this.b2.type&&this.b2.wake()},Rt.prototype.forest=function(){if(2==this.b1.type){var t,e;if(this.b1.component==this.b1.component.parent)t=this.b1.component;else{for(var i=this.b1.component,n=null;i!=i.parent;){var r=i.parent;i.parent=n,n=i,i=r}for(;null!=n;){var o=n.parent;n.parent=i,n=o}t=i}if(this.component==this.component.parent)e=this.component;else{for(var s=this.component,a=null;s!=s.parent;){var h=s.parent;s.parent=a,a=s,s=h}for(;null!=a;){var l=a.parent;a.parent=s,a=l}e=s}t!=e&&(t.rank<e.rank?t.parent=e:t.rank>e.rank?e.parent=t:(e.parent=t).rank++)}if(2==this.b2.type){var p,u;if(this.b2.component==this.b2.component.parent)p=this.b2.component;else{for(var d=this.b2.component,c=null;d!=d.parent;){var y=d.parent;d.parent=c,c=d,d=y}for(;null!=c;){var _=c.parent;c.parent=d,c=_}p=d}if(this.component==this.component.parent)u=this.component;else{for(var m=this.component,g=null;m!=m.parent;){var f=m.parent;m.parent=g,g=m,m=f}for(;null!=g;){var x=g.parent;g.parent=m,g=x}u=m}p!=u&&(p.rank<u.rank?p.parent=u:p.rank>u.rank?u.parent=p:(u.parent=p).rank++)}},Rt.prototype.pair_exists=function(t,e){return this.b1.id==t&&this.b2.id==e||this.b1.id==e&&this.b2.id==t},Rt.prototype.clearcache=function(){this.jAccx=0,this.jAccy=0,this.pre_dt=-1},Rt.prototype.preStep=function(t){-1==this.pre_dt&&(this.pre_dt=t);var e=t/this.pre_dt;this.pre_dt=t,this.equal=this.jointMin==this.jointMax,this.stepped=!0,this.validate_norm(),this.a1relx=this.b1.axisy*this.a1localx-this.b1.axisx*this.a1localy,this.a1rely=this.a1localx*this.b1.axisx+this.a1localy*this.b1.axisy,this.nrelx=this.b1.axisy*this.nlocalx-this.b1.axisx*this.nlocaly,this.nrely=this.nlocalx*this.b1.axisx+this.nlocaly*this.b1.axisy,this.a2relx=this.b2.axisy*this.a2localx-this.b2.axisx*this.a2localy,this.a2rely=this.a2localx*this.b2.axisx+this.a2localy*this.b2.axisy;var i=0,n=0,r=this.b2.posx+this.a2relx-this.b1.posx-this.a1relx,o=(i=this.b2.posy+this.a2rely-this.b1.posy-this.a1rely)*this.nrelx-r*this.nrely,n=this.nrelx*r+this.nrely*i;this.equal?(n-=this.jointMin,this.scale=1):n>this.jointMax?(n-=this.jointMax,this.scale=1):n<this.jointMin?(n=this.jointMin-n,this.scale=-1):this.scale=n=0;r+=this.a1relx,i+=this.a1rely;this.dot1=this.nrelx*r+this.nrely*i,this.cx1=i*this.nrelx-r*this.nrely,this.dot2=this.nrelx*this.a2relx+this.nrely*this.a2rely,this.cx2=this.a2rely*this.nrelx-this.a2relx*this.nrely,this.kMassa=this.b1.smass+this.b2.smass+this.dot1*this.dot1*this.b1.sinertia+this.dot2*this.dot2*this.b2.sinertia,this.kMassb=-this.scale*(this.dot1*this.cx1*this.b1.sinertia+this.dot2*this.cx2*this.b2.sinertia),this.kMassc=this.scale*this.scale*(this.b1.smass+this.b2.smass+this.cx1*this.cx1*this.b1.sinertia+this.cx2*this.cx2*this.b2.sinertia);i=this.kMassa*this.kMassc-this.kMassb*this.kMassb;if(0!=(1&(s=i!=i?(this.kMassa=this.kMassb=this.kMassc=0,3):0==i?((r=0)!=this.kMassa?this.kMassa=1/this.kMassa:(this.kMassa=0,r=1),0!=this.kMassc?this.kMassc=1/this.kMassc:(this.kMassc=0,r|=2),this.kMassb=0,r):(s=this.kMassc*(i=1/i),this.kMassc=this.kMassa*i,this.kMassa=s,this.kMassb*=-i,0)))&&(this.jAccx=0),0!=(2&s)&&(this.jAccy=0),this.stiff)this.gamma=0,this.biasx=0,this.biasy=0;else{if(this.breakUnderError&&o*o+n*n>this.maxError*this.maxError)return!0;i=2*Math.PI*this.frequency;this.gamma=1/(t*i*(2*this.damping+i*t));var s=1/(1+this.gamma),i=t*i*i*this.gamma;this.gamma*=s,this.kMassa*=s,this.kMassb*=s,this.kMassc*=s,this.biasx=o,this.biasy=n;n=-i;this.biasx*=n,this.biasy*=n;i=this.maxError,n=this.biasx*this.biasx+this.biasy*this.biasy;i*i<n&&(n=i*(1/Math.sqrt(n)),this.biasx*=n,this.biasy*=n)}return this.jAccx*=e,this.jAccy*=e,this.jMax=this.maxForce*t,!1},Rt.prototype.warmStart=function(){var t=this.scale*this.nrelx*this.jAccy-this.nrely*this.jAccx,e=this.nrelx*this.jAccx+this.scale*this.nrely*this.jAccy,i=this.b1.imass;this.b1.velx-=t*i,this.b1.vely-=e*i;i=this.b2.imass;this.b2.velx+=t*i,this.b2.vely+=e*i,this.b1.angvel+=(this.scale*this.cx1*this.jAccy-this.dot1*this.jAccx)*this.b1.iinertia,this.b2.angvel+=(this.dot2*this.jAccx-this.scale*this.cx2*this.jAccy)*this.b2.iinertia},Rt.prototype.applyImpulseVel=function(){var t=this.b2.velx-this.b1.velx,e=this.b2.vely-this.b1.vely;t+=this.b2.kinvelx-this.b1.kinvelx;var i=(e+=this.b2.kinvely-this.b1.kinvely)*this.nrelx-t*this.nrely+(this.b2.angvel+this.b2.kinangvel)*this.dot2-(this.b1.angvel+this.b1.kinangvel)*this.dot1,n=this.scale*(this.nrelx*t+this.nrely*e-(this.b2.angvel+this.b2.kinangvel)*this.cx2+(this.b1.angvel+this.b1.kinangvel)*this.cx1),r=this.biasx-i,o=this.biasy-n,t=this.kMassa*r+this.kMassb*o;o=this.kMassb*r+this.kMassc*o,r=t;e=this.gamma;r-=this.jAccx*e,o-=this.jAccy*e;i=this.jAccx,n=this.jAccy;if(this.jAccx+=r,this.jAccy+=o,0<this.jAccy&&(this.jAccy=0),this.breakUnderForce){if(this.jAccx*this.jAccx+this.jAccy*this.jAccy>this.jMax*this.jMax)return!0}else this.stiff||(t=this.jMax)*t<(e=this.jAccx*this.jAccx+this.jAccy*this.jAccy)&&(s=t*(1/Math.sqrt(e)),this.jAccx*=s,this.jAccy*=s);r=this.jAccx-i,o=this.jAccy-n;var s=this.scale*this.nrelx*o-this.nrely*r,i=this.nrelx*r+this.scale*this.nrely*o,n=this.b1.imass;this.b1.velx-=s*n,this.b1.vely-=i*n;n=this.b2.imass;return this.b2.velx+=s*n,this.b2.vely+=i*n,this.b1.angvel+=(this.scale*this.cx1*o-this.dot1*r)*this.b1.iinertia,this.b2.angvel+=(this.dot2*r-this.scale*this.cx2*o)*this.b2.iinertia,!1},Rt.prototype.applyImpulsePos=function(){var t=this.b1.axisy*this.nlocalx-this.b1.axisx*this.nlocaly,e=this.nlocalx*this.b1.axisx+this.nlocaly*this.b1.axisy,i=this.b1.axisy*this.a1localx-this.b1.axisx*this.a1localy,n=this.a1localx*this.b1.axisx+this.a1localy*this.b1.axisy,r=this.b2.axisy*this.a2localx-this.b2.axisx*this.a2localy,o=this.a2localx*this.b2.axisx+this.a2localy*this.b2.axisy,s=0,a=0,h=0,l=0,s=this.b2.posx+r-this.b1.posx-i,h=(a=this.b2.posy+o-this.b1.posy-n)*t-s*e,l=t*s+e*a,p=this.equal?(l-=this.jointMin,1):l>this.jointMax?(l-=this.jointMax,1):l<this.jointMin?(l=this.jointMin-l,-1):l=0;if(this.breakUnderError&&h*h+l*l>this.maxError*this.maxError)return!0;if(h*h+l*l<Er.constraintLinearSlop*Er.constraintLinearSlop)return!1;var u,d=0,c=0;6<(h*=.5)*h+(l*=.5)*l&&(u=this.b1.smass+this.b2.smass,Er.epsilon<u&&(y=(u=.8/u)*(e*h-p*t*l),_=u*(t*h*p-e*h),m=this.b1.imass,this.b1.posx-=y*m,this.b1.posy-=_*m,m=this.b2.imass,this.b2.posx+=y*m,this.b2.posy+=_*m,s=this.b2.posx+r-this.b1.posx-i,h=(a=this.b2.posy+o-this.b1.posy-n)*t-s*e,l=t*s+e*a,p=this.equal?(l-=this.jointMin,1):l>this.jointMax?(l-=this.jointMax,1):l<this.jointMin?(l=this.jointMin-l,-1):l=0,h*=.5,l*=.5));var y=0,_=0,m=0,n=this.b1.smass+this.b2.smass+(i=t*(_=s+i)+e*(m=a+n))*i*this.b1.sinertia+(a=t*r+e*o)*a*this.b2.sinertia,r=-p*(i*(_=m*t-_*e)*this.b1.sinertia+a*(o=o*t-r*e)*this.b2.sinertia);d=-h,c=-l;l=n*(y=p*p*(this.b1.smass+this.b2.smass+_*_*this.b1.sinertia+o*o*this.b2.sinertia))-r*r;l!=l?d=c=0:0==l?(0!=n?d/=n:d=0,0!=y?c/=y:c=0):(g=(l=1/l)*(y*d-r*c),c=l*(n*c-r*d),d=g);var g=p*t*(c=0<c?0:c)-e*d,t=t*d+p*e*c,e=this.b1.imass;this.b1.posx-=g*e,this.b1.posy-=t*e;e=this.b2.imass;this.b2.posx+=g*e,this.b2.posy+=t*e;t=this.b1,e=(p*_*c-i*d)*this.b1.iinertia;t.rot+=e,1e-4<e*e?(t.axisx=Math.sin(t.rot),t.axisy=Math.cos(t.rot)):(f=((_=1-.5*(f=e*e))*t.axisx+e*t.axisy)*(i=1-f*f/8),t.axisy=(_*t.axisy-e*t.axisx)*i,t.axisx=f);var f=this.b2,d=(a*d-p*o*c)*this.b2.iinertia;return f.rot+=d,1e-4<d*d?(f.axisx=Math.sin(f.rot),f.axisy=Math.cos(f.rot)):(p=((o=1-.5*(p=d*d))*f.axisx+d*f.axisy)*(c=1-p*p/8),f.axisy=(o*f.axisy-d*f.axisx)*c,f.axisx=p),!1},Rt.prototype.draw=function(t){},Rt.prototype.__class__=Rt;var Ft=zpp_nape.constraint.ZPP_MotorJoint=function(){this.stepped=!1,this.jMax=0,this.jAcc=0,this.kMass=0,this.b2=null,this.b1=null,this.rate=0,this.ratio=0,this.outer_zn=null,Gt.call(this),this.jAcc=0,this.stepped=!1,this.__velocity=!0};Ft.__name__=["zpp_nape","constraint","ZPP_MotorJoint"],Ft.__super__=Gt,Ft.prototype=Object.create(Gt.prototype),Ft.prototype.outer_zn=null,Ft.prototype.ratio=null,Ft.prototype.rate=null,Ft.prototype.bodyImpulse=function(t){return this.stepped?t==this.b1?K.get(0,0,-this.jAcc):K.get(0,0,this.ratio*this.jAcc):K.get(0,0,0)},Ft.prototype.activeBodies=function(){null!=this.b1&&this.b1.constraints.add(this),this.b2!=this.b1&&null!=this.b2&&this.b2.constraints.add(this)},Ft.prototype.inactiveBodies=function(){null!=this.b1&&this.b1.constraints.remove(this),this.b2!=this.b1&&null!=this.b2&&this.b2.constraints.remove(this)},Ft.prototype.b1=null,Ft.prototype.b2=null,Ft.prototype.kMass=null,Ft.prototype.jAcc=null,Ft.prototype.jMax=null,Ft.prototype.stepped=null,Ft.prototype.copy=function(t,e){var i=new P(null,null,this.rate,this.ratio);if(this.copyto(i),null!=t&&null!=this.b1){for(var n=null,r=0;r<t.length;){var o=t[r];if(++r,o.id==this.b1.id){n=o.bc;break}}null!=n?i.zpp_inner_zn.b1=n.zpp_inner:e.push(Lt.todo(this.b1.id,function(t){i.zpp_inner_zn.b1=t.zpp_inner}))}if(null!=t&&null!=this.b2){for(var s=null,a=0;a<t.length;){var h=t[a];if(++a,h.id==this.b2.id){s=h.bc;break}}null!=s?i.zpp_inner_zn.b2=s.zpp_inner:e.push(Lt.todo(this.b2.id,function(t){i.zpp_inner_zn.b2=t.zpp_inner}))}return i},Ft.prototype.validate=function(){if(null==this.b1||null==this.b2)throw new r("Error: AngleJoint cannot be simulated null bodies");if(this.b1==this.b2)throw new r("Error: MotorJoint cannot be simulated with body1 == body2");if(this.b1.space!=this.space||this.b2.space!=this.space)throw new r("Error: Constraints must have each body within the same space to which the constraint has been assigned");if(2!=this.b1.type&&2!=this.b2.type)throw new r("Error: Constraints cannot have both bodies non-dynamic")},Ft.prototype.wake_connected=function(){null!=this.b1&&2==this.b1.type&&this.b1.wake(),null!=this.b2&&2==this.b2.type&&this.b2.wake()},Ft.prototype.forest=function(){if(2==this.b1.type){var t,e;if(this.b1.component==this.b1.component.parent)t=this.b1.component;else{for(var i=this.b1.component,n=null;i!=i.parent;){var r=i.parent;i.parent=n,n=i,i=r}for(;null!=n;){var o=n.parent;n.parent=i,n=o}t=i}if(this.component==this.component.parent)e=this.component;else{for(var s=this.component,a=null;s!=s.parent;){var h=s.parent;s.parent=a,a=s,s=h}for(;null!=a;){var l=a.parent;a.parent=s,a=l}e=s}t!=e&&(t.rank<e.rank?t.parent=e:t.rank>e.rank?e.parent=t:(e.parent=t).rank++)}if(2==this.b2.type){var p,u;if(this.b2.component==this.b2.component.parent)p=this.b2.component;else{for(var d=this.b2.component,c=null;d!=d.parent;){var y=d.parent;d.parent=c,c=d,d=y}for(;null!=c;){var _=c.parent;c.parent=d,c=_}p=d}if(this.component==this.component.parent)u=this.component;else{for(var m=this.component,g=null;m!=m.parent;){var f=m.parent;m.parent=g,g=m,m=f}for(;null!=g;){var x=g.parent;g.parent=m,g=x}u=m}p!=u&&(p.rank<u.rank?p.parent=u:p.rank>u.rank?u.parent=p:(u.parent=p).rank++)}},Ft.prototype.pair_exists=function(t,e){return this.b1.id==t&&this.b2.id==e||this.b1.id==e&&this.b2.id==t},Ft.prototype.clearcache=function(){this.jAcc=0,this.pre_dt=-1},Ft.prototype.preStep=function(t){-1==this.pre_dt&&(this.pre_dt=t);var e=t/this.pre_dt;return this.pre_dt=t,this.stepped=!0,this.kMass=this.b1.sinertia+this.ratio*this.ratio*this.b2.sinertia,this.kMass=1/this.kMass,this.jAcc*=e,this.jMax=this.maxForce*t,!1},Ft.prototype.warmStart=function(){this.b1.angvel-=this.b1.iinertia*this.jAcc,this.b2.angvel+=this.ratio*this.b2.iinertia*this.jAcc},Ft.prototype.applyImpulseVel=function(){var t=-this.kMass*(this.ratio*(this.b2.angvel+this.b2.kinangvel)-this.b1.angvel-this.b1.kinangvel-this.rate),e=this.jAcc;if(this.jAcc+=t,this.breakUnderForce){if(this.jAcc>this.jMax||this.jAcc<-this.jMax)return!0}else this.jAcc<-this.jMax?this.jAcc=-this.jMax:this.jAcc>this.jMax&&(this.jAcc=this.jMax);return t=this.jAcc-e,this.b1.angvel-=this.b1.iinertia*t,this.b2.angvel+=this.ratio*this.b2.iinertia*t,!1},Ft.prototype.applyImpulsePos=function(){return!1},Ft.prototype.__class__=Ft;var Nt=zpp_nape.constraint.ZPP_PivotJoint=function(){this.stepped=!1,this.biasy=0,this.biasx=0,this.gamma=0,this.jMax=0,this.jAccy=0,this.jAccx=0,this.kMassc=0,this.kMassb=0,this.kMassa=0,this.wrap_a2=null,this.a2rely=0,this.a2relx=0,this.a2localy=0,this.a2localx=0,this.b2=null,this.wrap_a1=null,this.a1rely=0,this.a1relx=0,this.a1localy=0,this.a1localx=0,this.b1=null,this.outer_zn=null,Gt.call(this),this.stepped=!1,this.jAccx=0,this.jAccy=0,this.jMax=1/0,this.a1localx=0,this.a1localy=0,this.a1relx=0,this.a1rely=0,this.a2localx=0,this.a2localy=0,this.a2relx=0,this.a2rely=0};Nt.__name__=["zpp_nape","constraint","ZPP_PivotJoint"],Nt.__super__=Gt,Nt.prototype=Object.create(Gt.prototype),Nt.prototype.outer_zn=null,Nt.prototype.bodyImpulse=function(t){return this.stepped?t==this.b1?K.get(-this.jAccx,-this.jAccy,-(this.jAccy*this.a1relx-this.jAccx*this.a1rely)):K.get(this.jAccx,this.jAccy,this.jAccy*this.a2relx-this.jAccx*this.a2rely):K.get(0,0,0)},Nt.prototype.activeBodies=function(){null!=this.b1&&this.b1.constraints.add(this),this.b2!=this.b1&&null!=this.b2&&this.b2.constraints.add(this)},Nt.prototype.inactiveBodies=function(){null!=this.b1&&this.b1.constraints.remove(this),this.b2!=this.b1&&null!=this.b2&&this.b2.constraints.remove(this)},Nt.prototype.b1=null,Nt.prototype.a1localx=null,Nt.prototype.a1localy=null,Nt.prototype.a1relx=null,Nt.prototype.a1rely=null,Nt.prototype.validate_a1=function(){this.wrap_a1.zpp_inner.x=this.a1localx,this.wrap_a1.zpp_inner.y=this.a1localy},Nt.prototype.invalidate_a1=function(t){this.immutable_midstep("Constraint::a1"),this.a1localx=t.x,this.a1localy=t.y,this.wake()},Nt.prototype.setup_a1=function(){var t,e,i=this.a1localx,n=this.a1localy;null==Bn.poolVec2?t=new St:(t=Bn.poolVec2,Bn.poolVec2=t.zpp_pool,t.zpp_pool=null),null==t.zpp_inner?(null==Gr.zpp_pool?e=new Gr:(e=Gr.zpp_pool,Gr.zpp_pool=e.next,e.next=null),e.weak=!1,e._immutable=!1,e.x=i,e.y=n,t.zpp_inner=e,t.zpp_inner.outer=t):(null!=(e=t.zpp_inner)._validate&&e._validate(),t.zpp_inner.x==i&&(null!=(e=t.zpp_inner)._validate&&e._validate(),t.zpp_inner.y==n)||(t.zpp_inner.x=i,t.zpp_inner.y=n,null!=(n=t.zpp_inner)._invalidate&&n._invalidate(n))),t.zpp_inner.weak=!1,this.wrap_a1=t,this.wrap_a1.zpp_inner._inuse=!0,this.wrap_a1.zpp_inner._validate=Z(this,this.validate_a1),this.wrap_a1.zpp_inner._invalidate=Z(this,this.invalidate_a1)},Nt.prototype.wrap_a1=null,Nt.prototype.b2=null,Nt.prototype.a2localx=null,Nt.prototype.a2localy=null,Nt.prototype.a2relx=null,Nt.prototype.a2rely=null,Nt.prototype.validate_a2=function(){this.wrap_a2.zpp_inner.x=this.a2localx,this.wrap_a2.zpp_inner.y=this.a2localy},Nt.prototype.invalidate_a2=function(t){this.immutable_midstep("Constraint::a2"),this.a2localx=t.x,this.a2localy=t.y,this.wake()},Nt.prototype.setup_a2=function(){var t,e,i=this.a2localx,n=this.a2localy;null==Bn.poolVec2?t=new St:(t=Bn.poolVec2,Bn.poolVec2=t.zpp_pool,t.zpp_pool=null),null==t.zpp_inner?(null==Gr.zpp_pool?e=new Gr:(e=Gr.zpp_pool,Gr.zpp_pool=e.next,e.next=null),e.weak=!1,e._immutable=!1,e.x=i,e.y=n,t.zpp_inner=e,t.zpp_inner.outer=t):(null!=(e=t.zpp_inner)._validate&&e._validate(),t.zpp_inner.x==i&&(null!=(e=t.zpp_inner)._validate&&e._validate(),t.zpp_inner.y==n)||(t.zpp_inner.x=i,t.zpp_inner.y=n,null!=(n=t.zpp_inner)._invalidate&&n._invalidate(n))),t.zpp_inner.weak=!1,this.wrap_a2=t,this.wrap_a2.zpp_inner._inuse=!0,this.wrap_a2.zpp_inner._validate=Z(this,this.validate_a2),this.wrap_a2.zpp_inner._invalidate=Z(this,this.invalidate_a2)},Nt.prototype.wrap_a2=null,Nt.prototype.kMassa=null,Nt.prototype.kMassb=null,Nt.prototype.kMassc=null,Nt.prototype.jAccx=null,Nt.prototype.jAccy=null,Nt.prototype.jMax=null,Nt.prototype.gamma=null,Nt.prototype.biasx=null,Nt.prototype.biasy=null,Nt.prototype.stepped=null,Nt.prototype.copy=function(t,e){var i=this.outer_zn;null==i.zpp_inner_zn.wrap_a1&&i.zpp_inner_zn.setup_a1();var n=i.zpp_inner_zn.wrap_a1,i=this.outer_zn;null==i.zpp_inner_zn.wrap_a2&&i.zpp_inner_zn.setup_a2();var r=new M(null,null,n,i.zpp_inner_zn.wrap_a2);if(this.copyto(r),null!=t&&null!=this.b1){for(var o=null,s=0;s<t.length;){var a=t[s];if(++s,a.id==this.b1.id){o=a.bc;break}}null!=o?r.zpp_inner_zn.b1=o.zpp_inner:e.push(Lt.todo(this.b1.id,function(t){r.zpp_inner_zn.b1=t.zpp_inner}))}if(null!=t&&null!=this.b2){for(var h=null,l=0;l<t.length;){var p=t[l];if(++l,p.id==this.b2.id){h=p.bc;break}}null!=h?r.zpp_inner_zn.b2=h.zpp_inner:e.push(Lt.todo(this.b2.id,function(t){r.zpp_inner_zn.b2=t.zpp_inner}))}return r},Nt.prototype.validate=function(){if(null==this.b1||null==this.b2)throw new r("Error: PivotJoint cannot be simulated null bodies");if(this.b1==this.b2)throw new r("Error: PivotJoint cannot be simulated with body1 == body2 (body1=body2="+this.b1.outer.toString()+")");if(this.b1.space!=this.space||this.b2.space!=this.space)throw new r("Error: Constraints must have each body within the same space to which the constraint has been assigned (body1="+this.b1.outer.toString()+", body2="+this.b2.outer.toString()+")");if(2!=this.b1.type&&2!=this.b2.type)throw new r("Error: Constraints cannot have both bodies non-dynamic (body1="+this.b1.outer.toString()+", body2="+this.b2.outer.toString()+")")},Nt.prototype.wake_connected=function(){null!=this.b1&&2==this.b1.type&&this.b1.wake(),null!=this.b2&&2==this.b2.type&&this.b2.wake()},Nt.prototype.forest=function(){if(2==this.b1.type){var t,e;if(this.b1.component==this.b1.component.parent)t=this.b1.component;else{for(var i=this.b1.component,n=null;i!=i.parent;){var r=i.parent;i.parent=n,n=i,i=r}for(;null!=n;){var o=n.parent;n.parent=i,n=o}t=i}if(this.component==this.component.parent)e=this.component;else{for(var s=this.component,a=null;s!=s.parent;){var h=s.parent;s.parent=a,a=s,s=h}for(;null!=a;){var l=a.parent;a.parent=s,a=l}e=s}t!=e&&(t.rank<e.rank?t.parent=e:t.rank>e.rank?e.parent=t:(e.parent=t).rank++)}if(2==this.b2.type){var p,u;if(this.b2.component==this.b2.component.parent)p=this.b2.component;else{for(var d=this.b2.component,c=null;d!=d.parent;){var y=d.parent;d.parent=c,c=d,d=y}for(;null!=c;){var _=c.parent;c.parent=d,c=_}p=d}if(this.component==this.component.parent)u=this.component;else{for(var m=this.component,g=null;m!=m.parent;){var f=m.parent;m.parent=g,g=m,m=f}for(;null!=g;){var x=g.parent;g.parent=m,g=x}u=m}p!=u&&(p.rank<u.rank?p.parent=u:p.rank>u.rank?u.parent=p:(u.parent=p).rank++)}},Nt.prototype.pair_exists=function(t,e){return this.b1.id==t&&this.b2.id==e||this.b1.id==e&&this.b2.id==t},Nt.prototype.clearcache=function(){this.jAccx=0,this.jAccy=0,this.pre_dt=-1},Nt.prototype.preStep=function(t){-1==this.pre_dt&&(this.pre_dt=t);var e=t/this.pre_dt;this.pre_dt=t,this.stepped=!0,this.a1relx=this.b1.axisy*this.a1localx-this.b1.axisx*this.a1localy,this.a1rely=this.a1localx*this.b1.axisx+this.a1localy*this.b1.axisy,this.a2relx=this.b2.axisy*this.a2localx-this.b2.axisx*this.a2localy,this.a2rely=this.a2localx*this.b2.axisx+this.a2localy*this.b2.axisy;var i,n=this.b1.smass+this.b2.smass;this.kMassa=n,this.kMassb=0,this.kMassc=n,0!=this.b1.sinertia&&(i=this.a1relx*this.b1.sinertia,n=this.a1rely*this.b1.sinertia,this.kMassa+=n*this.a1rely,this.kMassb+=-n*this.a1relx,this.kMassc+=i*this.a1relx),0!=this.b2.sinertia&&(r=this.a2relx*this.b2.sinertia,o=this.a2rely*this.b2.sinertia,this.kMassa+=o*this.a2rely,this.kMassb+=-o*this.a2relx,this.kMassc+=r*this.a2relx);var r,o=this.kMassa*this.kMassc-this.kMassb*this.kMassb;if(0!=(1&(s=o!=o?(this.kMassa=this.kMassb=this.kMassc=0,3):0==o?((r=0)!=this.kMassa?this.kMassa=1/this.kMassa:(this.kMassa=0,r=1),0!=this.kMassc?this.kMassc=1/this.kMassc:(this.kMassc=0,r|=2),this.kMassb=0,r):(s=this.kMassc*(o=1/o),this.kMassc=this.kMassa*o,this.kMassa=s,this.kMassb*=-o,0)))&&(this.jAccx=0),0!=(2&s)&&(this.jAccy=0),this.stiff)this.biasx=0,this.biasy=0,this.gamma=0;else{o=2*Math.PI*this.frequency;this.gamma=1/(t*o*(2*this.damping+o*t));var s=1/(1+this.gamma),o=t*o*o*this.gamma;if(this.gamma*=s,this.kMassa*=s,this.kMassb*=s,this.kMassc*=s,this.biasx=this.b2.posx+this.a2relx-(this.b1.posx+this.a1relx),this.biasy=this.b2.posy+this.a2rely-(this.b1.posy+this.a1rely),this.breakUnderError&&this.biasx*this.biasx+this.biasy*this.biasy>this.maxError*this.maxError)return!0;s=-o;this.biasx*=s,this.biasy*=s;var o=this.maxError,s=this.biasx*this.biasx+this.biasy*this.biasy;o*o<s&&(s=o*(1/Math.sqrt(s)),this.biasx*=s,this.biasy*=s)}return this.jAccx*=e,this.jAccy*=e,this.jMax=this.maxForce*t,!1},Nt.prototype.warmStart=function(){var t=this.b1.imass;this.b1.velx-=this.jAccx*t,this.b1.vely-=this.jAccy*t;t=this.b2.imass;this.b2.velx+=this.jAccx*t,this.b2.vely+=this.jAccy*t,this.b1.angvel-=(this.jAccy*this.a1relx-this.jAccx*this.a1rely)*this.b1.iinertia,this.b2.angvel+=(this.jAccy*this.a2relx-this.jAccx*this.a2rely)*this.b2.iinertia},Nt.prototype.applyImpulseVel=function(){var t=this.b2.velx+this.b2.kinvelx-this.a2rely*(this.b2.angvel+this.b2.kinangvel)-(this.b1.velx+this.b1.kinvelx-this.a1rely*(this.b1.angvel+this.b1.kinangvel)),e=this.b2.vely+this.b2.kinvely+this.a2relx*(this.b2.angvel+this.b2.kinangvel)-(this.b1.vely+this.b1.kinvely+this.a1relx*(this.b1.angvel+this.b1.kinangvel)),i=this.biasx-t,n=this.biasy-e,r=this.kMassa*i+this.kMassb*n;n=this.kMassb*i+this.kMassc*n,i=r;var o=this.gamma;i-=this.jAccx*o,n-=this.jAccy*o;t=this.jAccx,e=this.jAccy;if(this.jAccx+=i,this.jAccy+=n,this.breakUnderForce){if(this.jAccx*this.jAccx+this.jAccy*this.jAccy>this.jMax*this.jMax)return!0}else this.stiff||(r=this.jMax)*r<(o=this.jAccx*this.jAccx+this.jAccy*this.jAccy)&&(o=r*(1/Math.sqrt(o)),this.jAccx*=o,this.jAccy*=o);i=this.jAccx-t,n=this.jAccy-e;e=this.b1.imass;this.b1.velx-=i*e,this.b1.vely-=n*e;e=this.b2.imass;return this.b2.velx+=i*e,this.b2.vely+=n*e,this.b1.angvel-=(n*this.a1relx-i*this.a1rely)*this.b1.iinertia,this.b2.angvel+=(n*this.a2relx-i*this.a2rely)*this.b2.iinertia,!1},Nt.prototype.applyImpulsePos=function(){var t=this.b1.axisy*this.a1localx-this.b1.axisx*this.a1localy,e=this.a1localx*this.b1.axisx+this.a1localy*this.b1.axisy,i=this.b2.axisy*this.a2localx-this.b2.axisx*this.a2localy,n=this.a2localx*this.b2.axisx+this.a2localy*this.b2.axisy,r=0,o=0,r=this.b2.posx+i-(this.b1.posx+t),o=this.b2.posy+n-(this.b1.posy+e);if(this.breakUnderError&&r*r+o*o>this.maxError*this.maxError)return!0;if(r*r+o*o<Er.constraintLinearSlop*Er.constraintLinearSlop)return!1;var s=0,a=0;6<(r*=.5)*r+(o*=.5)*o&&(p=this.b1.smass+this.b2.smass,Er.epsilon<p&&(400<(u=(s=-r*(p=.75/p))*s+(a=-o*p)*a)&&(s*=d=1/Math.sqrt(u)*20,a*=d),c=this.b1.imass,this.b1.posx-=s*c,this.b1.posy-=a*c,h=this.b2.imass,this.b2.posx+=s*h,this.b2.posy+=a*h,r=this.b2.posx+i-(this.b1.posx+t),o=this.b2.posy+n-(this.b1.posy+e),r*=.5,o*=.5));var h,l,p=0,u=0,d=0,c=this.b1.smass+this.b2.smass,d=p=c;(u=0)!=this.b1.sinertia&&(l=t*this.b1.sinertia,p=c+(h=e*this.b1.sinertia)*e,u+=-h*t,d=c+l*t),0!=this.b2.sinertia&&(c=i*this.b2.sinertia,p+=(l=n*this.b2.sinertia)*n,u+=-l*i,d+=c*i);o=(s=-r)*s+(a=-o)*a;36<o&&(s*=y=1/Math.sqrt(o)*6,a*=y);var y=p*d-u*u;y!=y?s=a=0:0==y?(0!=p?s/=p:s=0,0!=d?a/=d:a=0):(_=(y=1/y)*(d*s-u*a),a=y*(p*a-u*s),s=_);u=this.b1.imass;this.b1.posx-=s*u,this.b1.posy-=a*u;var _=this.b2.imass;this.b2.posx+=s*_,this.b2.posy+=a*_;u=this.b1,_=-(a*t-s*e)*this.b1.iinertia;u.rot+=_,1e-4<_*_?(u.axisx=Math.sin(u.rot),u.axisy=Math.cos(u.rot)):(m=((t=1-.5*(m=_*_))*u.axisx+_*u.axisy)*(e=1-m*m/8),u.axisy=(t*u.axisy-_*u.axisx)*e,u.axisx=m);var m=this.b2,a=(a*i-s*n)*this.b2.iinertia;return m.rot+=a,1e-4<a*a?(m.axisx=Math.sin(m.rot),m.axisy=Math.cos(m.rot)):(i=((s=1-.5*(i=a*a))*m.axisx+a*m.axisy)*(n=1-i*i/8),m.axisy=(s*m.axisy-a*m.axisx)*n,m.axisx=i),!1},Nt.prototype.draw=function(t){},Nt.prototype.__class__=Nt;var jt=zpp_nape.constraint.ZPP_PulleyJoint=function(){this.stepped=!1,this.bias=0,this.gamma=0,this.jMax=0,this.jAcc=0,this.kMass=0,this.wrap_a4=null,this.a4rely=0,this.a4relx=0,this.a4localy=0,this.a4localx=0,this.b4=null,this.wrap_a3=null,this.a3rely=0,this.a3relx=0,this.a3localy=0,this.a3localx=0,this.b3=null,this.wrap_a2=null,this.a2rely=0,this.a2relx=0,this.a2localy=0,this.a2localx=0,this.b2=null,this.wrap_a1=null,this.a1rely=0,this.a1relx=0,this.a1localy=0,this.a1localx=0,this.b1=null,this.cx4=0,this.cx3=0,this.cx2=0,this.cx1=0,this.n34y=0,this.n34x=0,this.n12y=0,this.n12x=0,this.equal=!1,this.slack=!1,this.jointMax=0,this.jointMin=0,this.ratio=1,this.outer_zn=null,Gt.call(this),this.a1localx=0,this.a1localy=0,this.a1relx=0,this.a1rely=0,this.a2localx=0,this.a2localy=0,this.a2relx=0,this.a2rely=0,this.a3localx=0,this.a3localy=0,this.a3relx=0,this.a3rely=0,this.a4localx=0,this.a4localy=0,this.a4relx=0,this.a4rely=0,this.n12x=1,this.n12y=0,this.n34x=1,this.n34y=0,this.jAcc=0,this.jMax=1/0,this.stepped=!1,this.cx1=this.cx2=this.cx3=this.cx4=0};jt.__name__=["zpp_nape","constraint","ZPP_PulleyJoint"],jt.__super__=Gt,jt.prototype=Object.create(Gt.prototype),jt.prototype.outer_zn=null,jt.prototype.ratio=null,jt.prototype.jointMin=null,jt.prototype.jointMax=null,jt.prototype.slack=null,jt.prototype.equal=null,jt.prototype.is_slack=function(){this.a1relx=this.b1.axisy*this.a1localx-this.b1.axisx*this.a1localy,this.a1rely=this.a1localx*this.b1.axisx+this.a1localy*this.b1.axisy,this.a2relx=this.b2.axisy*this.a2localx-this.b2.axisx*this.a2localy,this.a2rely=this.a2localx*this.b2.axisx+this.a2localy*this.b2.axisy,this.a3relx=this.b3.axisy*this.a3localx-this.b3.axisx*this.a3localy,this.a3rely=this.a3localx*this.b3.axisx+this.a3localy*this.b3.axisy,this.a4relx=this.b4.axisy*this.a4localx-this.b4.axisx*this.a4localy,this.a4rely=this.a4localx*this.b4.axisx+this.a4localy*this.b4.axisy;var t=this.b2.posx+this.a2relx-(this.b1.posx+this.a1relx),e=this.b2.posy+this.a2rely-(this.b1.posy+this.a1rely),i=this.b4.posx+this.a4relx-(this.b3.posx+this.a3relx),n=this.b4.posy+this.a4rely-(this.b3.posy+this.a3rely),e=Math.sqrt(t*t+e*e),n=Math.sqrt(i*i+n*n);0==n&&Math.sqrt(0);n=e+this.ratio*n;return!this.equal&&(!(n<this.jointMin)&&(n>this.jointMax?(n-=this.jointMax,!1):!(n=0)))},jt.prototype.n12x=null,jt.prototype.n12y=null,jt.prototype.n34x=null,jt.prototype.n34y=null,jt.prototype.cx1=null,jt.prototype.cx2=null,jt.prototype.cx3=null,jt.prototype.cx4=null,jt.prototype.bodyImpulse=function(t){if(this.stepped){var e,i,n=K.get();return t==this.b1&&(null!=(e=n.zpp_inner)._validate&&e._validate(),n.zpp_inner.x=n.zpp_inner.x-this.jAcc*this.n12x,null!=(e=n.zpp_inner)._validate&&e._validate(),null!=(e=n.zpp_inner)._validate&&e._validate(),n.zpp_inner.y=n.zpp_inner.y-this.jAcc*this.n12y,null!=(e=n.zpp_inner)._validate&&e._validate(),null!=(e=n.zpp_inner)._validate&&e._validate(),n.zpp_inner.z=n.zpp_inner.z-this.cx1*this.jAcc,null!=(e=n.zpp_inner)._validate&&e._validate()),t==this.b2&&(null!=(i=n.zpp_inner)._validate&&i._validate(),n.zpp_inner.x=n.zpp_inner.x+this.jAcc*this.n12x,null!=(i=n.zpp_inner)._validate&&i._validate(),null!=(i=n.zpp_inner)._validate&&i._validate(),n.zpp_inner.y=n.zpp_inner.y+this.jAcc*this.n12y,null!=(i=n.zpp_inner)._validate&&i._validate(),null!=(i=n.zpp_inner)._validate&&i._validate(),n.zpp_inner.z=n.zpp_inner.z+this.cx2*this.jAcc,null!=(i=n.zpp_inner)._validate&&i._validate()),t==this.b3&&(null!=(i=n.zpp_inner)._validate&&i._validate(),n.zpp_inner.x=n.zpp_inner.x-this.jAcc*this.n34x,null!=(i=n.zpp_inner)._validate&&i._validate(),null!=(i=n.zpp_inner)._validate&&i._validate(),n.zpp_inner.y=n.zpp_inner.y-this.jAcc*this.n34y,null!=(i=n.zpp_inner)._validate&&i._validate(),null!=(i=n.zpp_inner)._validate&&i._validate(),n.zpp_inner.z=n.zpp_inner.z-this.cx3*this.jAcc,null!=(i=n.zpp_inner)._validate&&i._validate()),t==this.b4&&(null!=(t=n.zpp_inner)._validate&&t._validate(),n.zpp_inner.x=n.zpp_inner.x+this.jAcc*this.n34x,null!=(t=n.zpp_inner)._validate&&t._validate(),null!=(t=n.zpp_inner)._validate&&t._validate(),n.zpp_inner.y=n.zpp_inner.y+this.jAcc*this.n34y,null!=(t=n.zpp_inner)._validate&&t._validate(),null!=(t=n.zpp_inner)._validate&&t._validate(),n.zpp_inner.z=n.zpp_inner.z+this.cx4*this.jAcc,null!=(t=n.zpp_inner)._validate&&t._validate()),n}return K.get(0,0,0)},jt.prototype.activeBodies=function(){null!=this.b1&&this.b1.constraints.add(this),this.b2!=this.b1&&null!=this.b2&&this.b2.constraints.add(this),this.b3!=this.b1&&this.b3!=this.b2&&null!=this.b3&&this.b3.constraints.add(this),this.b4!=this.b1&&this.b4!=this.b2&&this.b4!=this.b3&&null!=this.b4&&this.b4.constraints.add(this)},jt.prototype.inactiveBodies=function(){null!=this.b1&&this.b1.constraints.remove(this),this.b2!=this.b1&&null!=this.b2&&this.b2.constraints.remove(this),this.b3!=this.b1&&this.b3!=this.b2&&null!=this.b3&&this.b3.constraints.remove(this),this.b4!=this.b1&&this.b4!=this.b2&&this.b4!=this.b3&&null!=this.b4&&this.b4.constraints.remove(this)},jt.prototype.b1=null,jt.prototype.a1localx=null,jt.prototype.a1localy=null,jt.prototype.a1relx=null,jt.prototype.a1rely=null,jt.prototype.validate_a1=function(){this.wrap_a1.zpp_inner.x=this.a1localx,this.wrap_a1.zpp_inner.y=this.a1localy},jt.prototype.invalidate_a1=function(t){this.immutable_midstep("Constraint::a1"),this.a1localx=t.x,this.a1localy=t.y,this.wake()},jt.prototype.setup_a1=function(){var t,e,i=this.a1localx,n=this.a1localy;null==Bn.poolVec2?t=new St:(t=Bn.poolVec2,Bn.poolVec2=t.zpp_pool,t.zpp_pool=null),null==t.zpp_inner?(null==Gr.zpp_pool?e=new Gr:(e=Gr.zpp_pool,Gr.zpp_pool=e.next,e.next=null),e.weak=!1,e._immutable=!1,e.x=i,e.y=n,t.zpp_inner=e,t.zpp_inner.outer=t):(null!=(e=t.zpp_inner)._validate&&e._validate(),t.zpp_inner.x==i&&(null!=(e=t.zpp_inner)._validate&&e._validate(),t.zpp_inner.y==n)||(t.zpp_inner.x=i,t.zpp_inner.y=n,null!=(n=t.zpp_inner)._invalidate&&n._invalidate(n))),t.zpp_inner.weak=!1,this.wrap_a1=t,this.wrap_a1.zpp_inner._inuse=!0,this.wrap_a1.zpp_inner._validate=Z(this,this.validate_a1),this.wrap_a1.zpp_inner._invalidate=Z(this,this.invalidate_a1)},jt.prototype.wrap_a1=null,jt.prototype.b2=null,jt.prototype.a2localx=null,jt.prototype.a2localy=null,jt.prototype.a2relx=null,jt.prototype.a2rely=null,jt.prototype.validate_a2=function(){this.wrap_a2.zpp_inner.x=this.a2localx,this.wrap_a2.zpp_inner.y=this.a2localy},jt.prototype.invalidate_a2=function(t){this.immutable_midstep("Constraint::a2"),this.a2localx=t.x,this.a2localy=t.y,this.wake()},jt.prototype.setup_a2=function(){var t,e,i=this.a2localx,n=this.a2localy;null==Bn.poolVec2?t=new St:(t=Bn.poolVec2,Bn.poolVec2=t.zpp_pool,t.zpp_pool=null),null==t.zpp_inner?(null==Gr.zpp_pool?e=new Gr:(e=Gr.zpp_pool,Gr.zpp_pool=e.next,e.next=null),e.weak=!1,e._immutable=!1,e.x=i,e.y=n,t.zpp_inner=e,t.zpp_inner.outer=t):(null!=(e=t.zpp_inner)._validate&&e._validate(),t.zpp_inner.x==i&&(null!=(e=t.zpp_inner)._validate&&e._validate(),t.zpp_inner.y==n)||(t.zpp_inner.x=i,t.zpp_inner.y=n,null!=(n=t.zpp_inner)._invalidate&&n._invalidate(n))),t.zpp_inner.weak=!1,this.wrap_a2=t,this.wrap_a2.zpp_inner._inuse=!0,this.wrap_a2.zpp_inner._validate=Z(this,this.validate_a2),this.wrap_a2.zpp_inner._invalidate=Z(this,this.invalidate_a2)},jt.prototype.wrap_a2=null,jt.prototype.b3=null,jt.prototype.a3localx=null,jt.prototype.a3localy=null,jt.prototype.a3relx=null,jt.prototype.a3rely=null,jt.prototype.validate_a3=function(){this.wrap_a3.zpp_inner.x=this.a3localx,this.wrap_a3.zpp_inner.y=this.a3localy},jt.prototype.invalidate_a3=function(t){this.immutable_midstep("Constraint::a3"),this.a3localx=t.x,this.a3localy=t.y,this.wake()},jt.prototype.setup_a3=function(){var t,e,i=this.a3localx,n=this.a3localy;null==Bn.poolVec2?t=new St:(t=Bn.poolVec2,Bn.poolVec2=t.zpp_pool,t.zpp_pool=null),null==t.zpp_inner?(null==Gr.zpp_pool?e=new Gr:(e=Gr.zpp_pool,Gr.zpp_pool=e.next,e.next=null),e.weak=!1,e._immutable=!1,e.x=i,e.y=n,t.zpp_inner=e,t.zpp_inner.outer=t):(null!=(e=t.zpp_inner)._validate&&e._validate(),t.zpp_inner.x==i&&(null!=(e=t.zpp_inner)._validate&&e._validate(),t.zpp_inner.y==n)||(t.zpp_inner.x=i,t.zpp_inner.y=n,null!=(n=t.zpp_inner)._invalidate&&n._invalidate(n))),t.zpp_inner.weak=!1,this.wrap_a3=t,this.wrap_a3.zpp_inner._inuse=!0,this.wrap_a3.zpp_inner._validate=Z(this,this.validate_a3),this.wrap_a3.zpp_inner._invalidate=Z(this,this.invalidate_a3)},jt.prototype.wrap_a3=null,jt.prototype.b4=null,jt.prototype.a4localx=null,jt.prototype.a4localy=null,jt.prototype.a4relx=null,jt.prototype.a4rely=null,jt.prototype.validate_a4=function(){this.wrap_a4.zpp_inner.x=this.a4localx,this.wrap_a4.zpp_inner.y=this.a4localy},jt.prototype.invalidate_a4=function(t){this.immutable_midstep("Constraint::a4"),this.a4localx=t.x,this.a4localy=t.y,this.wake()},jt.prototype.setup_a4=function(){var t,e,i=this.a4localx,n=this.a4localy;null==Bn.poolVec2?t=new St:(t=Bn.poolVec2,Bn.poolVec2=t.zpp_pool,t.zpp_pool=null),null==t.zpp_inner?(null==Gr.zpp_pool?e=new Gr:(e=Gr.zpp_pool,Gr.zpp_pool=e.next,e.next=null),e.weak=!1,e._immutable=!1,e.x=i,e.y=n,t.zpp_inner=e,t.zpp_inner.outer=t):(null!=(e=t.zpp_inner)._validate&&e._validate(),t.zpp_inner.x==i&&(null!=(e=t.zpp_inner)._validate&&e._validate(),t.zpp_inner.y==n)||(t.zpp_inner.x=i,t.zpp_inner.y=n,null!=(n=t.zpp_inner)._invalidate&&n._invalidate(n))),t.zpp_inner.weak=!1,this.wrap_a4=t,this.wrap_a4.zpp_inner._inuse=!0,this.wrap_a4.zpp_inner._validate=Z(this,this.validate_a4),this.wrap_a4.zpp_inner._invalidate=Z(this,this.invalidate_a4)},jt.prototype.wrap_a4=null,jt.prototype.kMass=null,jt.prototype.jAcc=null,jt.prototype.jMax=null,jt.prototype.gamma=null,jt.prototype.bias=null,jt.prototype.stepped=null,jt.prototype.copy=function(t,e){var i=this.outer_zn;null==i.zpp_inner_zn.wrap_a1&&i.zpp_inner_zn.setup_a1();var n=i.zpp_inner_zn.wrap_a1,r=this.outer_zn;null==r.zpp_inner_zn.wrap_a2&&r.zpp_inner_zn.setup_a2();var o=r.zpp_inner_zn.wrap_a2,i=this.outer_zn;null==i.zpp_inner_zn.wrap_a3&&i.zpp_inner_zn.setup_a3();r=i.zpp_inner_zn.wrap_a3,i=this.outer_zn;null==i.zpp_inner_zn.wrap_a4&&i.zpp_inner_zn.setup_a4();var s=new T(null,null,null,null,n,o,r,i.zpp_inner_zn.wrap_a4,this.jointMin,this.jointMax,this.ratio);if(this.copyto(s),null!=t&&null!=this.b1){for(var a=null,h=0;h<t.length;){var l=t[h];if(++h,l.id==this.b1.id){a=l.bc;break}}null!=a?s.zpp_inner_zn.b1=a.zpp_inner:e.push(Lt.todo(this.b1.id,function(t){s.zpp_inner_zn.b1=t.zpp_inner}))}if(null!=t&&null!=this.b2){for(var p=null,u=0;u<t.length;){var d=t[u];if(++u,d.id==this.b2.id){p=d.bc;break}}null!=p?s.zpp_inner_zn.b2=p.zpp_inner:e.push(Lt.todo(this.b2.id,function(t){s.zpp_inner_zn.b2=t.zpp_inner}))}if(null!=t&&null!=this.b3){for(var c=null,y=0;y<t.length;){var _=t[y];if(++y,_.id==this.b3.id){c=_.bc;break}}null!=c?s.zpp_inner_zn.b3=c.zpp_inner:e.push(Lt.todo(this.b3.id,function(t){s.zpp_inner_zn.b3=t.zpp_inner}))}if(null!=t&&null!=this.b4){for(var m=null,g=0;g<t.length;){var f=t[g];if(++g,f.id==this.b4.id){m=f.bc;break}}null!=m?s.zpp_inner_zn.b4=m.zpp_inner:e.push(Lt.todo(this.b4.id,function(t){s.zpp_inner_zn.b4=t.zpp_inner}))}return s},jt.prototype.validate=function(){if(null==this.b1||null==this.b2||null==this.b3||null==this.b4)throw new r("Error: PulleyJoint cannot be simulated with null bodies");if(this.b1==this.b2||this.b3==this.b4)throw new r("Error: PulleyJoint cannot have body1==body2 or body3==body4");if(this.b1.space!=this.space||this.b2.space!=this.space||this.b3.space!=this.space||this.b4.space!=this.space)throw new r("Error: Constraints must have each body within the same space to which the constraint has been assigned");if(this.jointMin>this.jointMax)throw new r("Error: PulleyJoint must have jointMin <= jointMax");if(2!=this.b1.type&&2!=this.b2.type)throw new r("Error: PulleyJoint cannot have both bodies in a linked pair non-dynamic");if(2!=this.b3.type&&2!=this.b4.type)throw new r("Error: PulleyJoint cannot have both bodies in a linked pair non-dynamic")},jt.prototype.wake_connected=function(){null!=this.b1&&2==this.b1.type&&this.b1.wake(),null!=this.b2&&2==this.b2.type&&this.b2.wake(),null!=this.b3&&2==this.b3.type&&this.b3.wake(),null!=this.b4&&2==this.b4.type&&this.b4.wake()},jt.prototype.forest=function(){if(2==this.b1.type){var t,e;if(this.b1.component==this.b1.component.parent)t=this.b1.component;else{for(var i=this.b1.component,n=null;i!=i.parent;){var r=i.parent;i.parent=n,n=i,i=r}for(;null!=n;){var o=n.parent;n.parent=i,n=o}t=i}if(this.component==this.component.parent)e=this.component;else{for(var s=this.component,a=null;s!=s.parent;){var h=s.parent;s.parent=a,a=s,s=h}for(;null!=a;){var l=a.parent;a.parent=s,a=l}e=s}t!=e&&(t.rank<e.rank?t.parent=e:t.rank>e.rank?e.parent=t:(e.parent=t).rank++)}if(2==this.b2.type){var p,u;if(this.b2.component==this.b2.component.parent)p=this.b2.component;else{for(var d=this.b2.component,c=null;d!=d.parent;){var y=d.parent;d.parent=c,c=d,d=y}for(;null!=c;){var _=c.parent;c.parent=d,c=_}p=d}if(this.component==this.component.parent)u=this.component;else{for(var m=this.component,g=null;m!=m.parent;){var f=m.parent;m.parent=g,g=m,m=f}for(;null!=g;){var x=g.parent;g.parent=m,g=x}u=m}p!=u&&(p.rank<u.rank?p.parent=u:p.rank>u.rank?u.parent=p:(u.parent=p).rank++)}if(2==this.b3.type){var v,w;if(this.b3.component==this.b3.component.parent)v=this.b3.component;else{for(var z=this.b3.component,b=null;z!=z.parent;){var S=z.parent;z.parent=b,b=z,z=S}for(;null!=b;){var C=b.parent;b.parent=z,b=C}v=z}if(this.component==this.component.parent)w=this.component;else{for(var P=this.component,M=null;P!=P.parent;){var T=P.parent;P.parent=M,M=P,P=T}for(;null!=M;){var A=M.parent;M.parent=P,M=A}w=P}v!=w&&(v.rank<w.rank?v.parent=w:v.rank>w.rank?w.parent=v:(w.parent=v).rank++)}if(2==this.b4.type){var k,O;if(this.b4.component==this.b4.component.parent)k=this.b4.component;else{for(var E=this.b4.component,I=null;E!=E.parent;){var G=E.parent;E.parent=I,I=E,E=G}for(;null!=I;){var D=I.parent;I.parent=E,I=D}k=E}if(this.component==this.component.parent)O=this.component;else{for(var L=this.component,B=null;L!=L.parent;){var R=L.parent;L.parent=B,B=L,L=R}for(;null!=B;){var F=B.parent;B.parent=L,B=F}O=L}k!=O&&(k.rank<O.rank?k.parent=O:k.rank>O.rank?O.parent=k:(O.parent=k).rank++)}},jt.prototype.pair_exists=function(t,e){return this.b1.id==t&&(this.b2.id==e||this.b3.id==e||this.b4.id==e)||this.b2.id==t&&(this.b3.id==e||this.b4.id==e||this.b1.id==e)||this.b3.id==t&&(this.b4.id==e||this.b1.id==e||this.b2.id==e)||this.b4.id==t&&(this.b1.id==e||this.b2.id==e||this.b3.id==e)},jt.prototype.clearcache=function(){this.jAcc=0,this.pre_dt=-1},jt.prototype.preStep=function(t){-1==this.pre_dt&&(this.pre_dt=t);var e=t/this.pre_dt;this.pre_dt=t,this.stepped=!0,this.equal=this.jointMin==this.jointMax,this.a1relx=this.b1.axisy*this.a1localx-this.b1.axisx*this.a1localy,this.a1rely=this.a1localx*this.b1.axisx+this.a1localy*this.b1.axisy,this.a2relx=this.b2.axisy*this.a2localx-this.b2.axisx*this.a2localy,this.a2rely=this.a2localx*this.b2.axisx+this.a2localy*this.b2.axisy,this.a3relx=this.b3.axisy*this.a3localx-this.b3.axisx*this.a3localy,this.a3rely=this.a3localx*this.b3.axisx+this.a3localy*this.b3.axisy,this.a4relx=this.b4.axisy*this.a4localx-this.b4.axisx*this.a4localy,this.a4rely=this.a4localx*this.b4.axisx+this.a4localy*this.b4.axisy;var i=this.b2.posx+this.a2relx-(this.b1.posx+this.a1relx),n=this.b2.posy+this.a2rely-(this.b1.posy+this.a1rely),r=this.b4.posx+this.a4relx-(this.b3.posx+this.a3relx),o=this.b4.posy+this.a4rely-(this.b3.posy+this.a3rely),s=Math.sqrt(i*i+n*n),a=Math.sqrt(r*r+o*o);0!=s&&(this.n12x=i*(i=1/s),this.n12y=n*i),0!=a?(this.n34x=r*(r=1/a),this.n34y=o*r,r=this.ratio,this.n34x*=r,this.n34y*=r):(h=this.ratio/Math.sqrt(this.n34x*this.n34x+this.n34y*this.n34y),this.n34x*=h,this.n34y*=h);var h=s+this.ratio*a;this.equal?(h-=this.jointMax,this.slack=!1):h<this.jointMin?(h=this.jointMin-h,this.n12x=-this.n12x,this.n12y=-this.n12y,this.n34x=-this.n34x,this.n34y=-this.n34y,this.slack=!1):h>this.jointMax?(h-=this.jointMax,this.slack=!1):(this.n12x=0,this.n12y=0,this.n34x=0,this.n34y=0,this.slack=!(h=0));s=h;if(!this.slack){this.cx1=this.n12y*this.a1relx-this.n12x*this.a1rely,this.cx2=this.n12y*this.a2relx-this.n12x*this.a2rely,this.cx3=this.n34y*this.a3relx-this.n34x*this.a3rely,this.cx4=this.n34y*this.a4relx-this.n34x*this.a4rely;a=this.b1.smass+this.b2.smass+this.ratio*this.ratio*(this.b3.smass+this.b4.smass)+this.b1.sinertia*this.cx1*this.cx1+this.b2.sinertia*this.cx2*this.cx2+this.b3.sinertia*this.cx3*this.cx3+this.b4.sinertia*this.cx4*this.cx4;if(this.b1==this.b4&&(a-=2*((this.n12x*this.n34x+this.n12y*this.n34y)*this.b1.smass+this.cx1*this.cx4*this.b1.sinertia)),this.b1==this.b3&&(a+=2*((this.n12x*this.n34x+this.n12y*this.n34y)*this.b1.smass+this.cx1*this.cx3*this.b1.sinertia)),this.b2==this.b3&&(a-=2*((this.n12x*this.n34x+this.n12y*this.n34y)*this.b2.smass+this.cx2*this.cx3*this.b2.sinertia)),this.b2==this.b4&&(a+=2*((this.n12x*this.n34x+this.n12y*this.n34y)*this.b2.smass+this.cx2*this.cx4*this.b2.sinertia)),this.kMass=a,0!=this.kMass?this.kMass=1/this.kMass:this.jAcc=0,this.stiff)this.bias=0,this.gamma=0;else{if(this.breakUnderError&&s*s>this.maxError*this.maxError)return!0;var h=2*Math.PI*this.frequency;this.gamma=1/(t*h*(2*this.damping+h*t));a=1/(1+this.gamma),h=t*h*h*this.gamma;this.gamma*=a,this.kMass*=a,this.bias=-s*h,this.bias<-this.maxError?this.bias=-this.maxError:this.bias>this.maxError&&(this.bias=this.maxError)}this.jAcc*=e,this.jMax=this.maxForce*t}return!1},jt.prototype.warmStart=function(){var t;this.slack||(t=this.b1.imass*this.jAcc,this.b1.velx-=this.n12x*t,this.b1.vely-=this.n12y*t,t=this.b2.imass*this.jAcc,this.b2.velx+=this.n12x*t,this.b2.vely+=this.n12y*t,t=this.b3.imass*this.jAcc,this.b3.velx-=this.n34x*t,this.b3.vely-=this.n34y*t,t=this.b4.imass*this.jAcc,this.b4.velx+=this.n34x*t,this.b4.vely+=this.n34y*t,this.b1.angvel-=this.cx1*this.b1.iinertia*this.jAcc,this.b2.angvel+=this.cx2*this.b2.iinertia*this.jAcc,this.b3.angvel-=this.cx3*this.b3.iinertia*this.jAcc,this.b4.angvel+=this.cx4*this.b4.iinertia*this.jAcc)},jt.prototype.applyImpulseVel=function(){if(this.slack)return!1;var t=this.kMass*(this.bias-(this.n12x*(this.b2.velx+this.b2.kinvelx-this.b1.velx-this.b1.kinvelx)+this.n12y*(this.b2.vely+this.b2.kinvely-this.b1.vely-this.b1.kinvely)+this.n34x*(this.b4.velx+this.b4.kinvelx-this.b3.velx-this.b3.kinvelx)+this.n34y*(this.b4.vely+this.b4.kinvely-this.b3.vely-this.b3.kinvely)+(this.b2.angvel+this.b2.kinangvel)*this.cx2-(this.b1.angvel+this.b1.kinangvel)*this.cx1+(this.b4.angvel+this.b4.kinangvel)*this.cx4-(this.b3.angvel+this.b3.kinangvel)*this.cx3))-this.jAcc*this.gamma,e=this.jAcc;if(this.jAcc+=t,!this.equal&&0<this.jAcc&&(this.jAcc=0),this.breakUnderForce&&this.jAcc<-this.jMax)return!0;this.stiff||this.jAcc<-this.jMax&&(this.jAcc=-this.jMax);t=this.jAcc-e,e=this.b1.imass*t;this.b1.velx-=this.n12x*e,this.b1.vely-=this.n12y*e;e=this.b2.imass*t;this.b2.velx+=this.n12x*e,this.b2.vely+=this.n12y*e;e=this.b3.imass*t;this.b3.velx-=this.n34x*e,this.b3.vely-=this.n34y*e;e=this.b4.imass*t;return this.b4.velx+=this.n34x*e,this.b4.vely+=this.n34y*e,this.b1.angvel-=this.cx1*this.b1.iinertia*t,this.b2.angvel+=this.cx2*this.b2.iinertia*t,this.b3.angvel-=this.cx3*this.b3.iinertia*t,this.b4.angvel+=this.cx4*this.b4.iinertia*t,!1},jt.prototype.applyImpulsePos=function(){var t=this.b1.axisy*this.a1localx-this.b1.axisx*this.a1localy,e=this.a1localx*this.b1.axisx+this.a1localy*this.b1.axisy,i=this.b2.axisy*this.a2localx-this.b2.axisx*this.a2localy,n=this.a2localx*this.b2.axisx+this.a2localy*this.b2.axisy,r=this.b3.axisy*this.a3localx-this.b3.axisx*this.a3localy,o=this.a3localx*this.b3.axisx+this.a3localy*this.b3.axisy,s=this.b4.axisy*this.a4localx-this.b4.axisx*this.a4localy,a=this.a4localx*this.b4.axisx+this.a4localy*this.b4.axisy,h=0,l=0,p=0,u=0;h=this.n12x,l=this.n12y,p=this.n34x,u=this.n34y;var d=this.b2.posx+i-(this.b1.posx+t),c=this.b2.posy+n-(this.b1.posy+e),y=this.b4.posx+s-(this.b3.posx+r),_=this.b4.posy+a-(this.b3.posy+o),m=Math.sqrt(d*d+c*c),g=Math.sqrt(y*y+_*_);0!=m&&(h=d*(d=1/m),l=c*d),0!=g?(p=y*(w=1/g),u=_*w,p*=z=this.ratio,u*=z):(p*=v=this.ratio/Math.sqrt(p*p+u*u),u*=v);var f,x,v,_=m+this.ratio*g,w=this.equal?(_-=this.jointMax,!1):_<this.jointMin?(_=this.jointMin-_,h=-h,l=-l,p=-p,u=-u,!1):_>this.jointMax?(_-=this.jointMax,!1):!(_=u=p=l=h=0),z=_;if(!w){if(this.breakUnderError&&z*z>this.maxError*this.maxError)return!0;if(z*z<Er.constraintLinearSlop*Er.constraintLinearSlop)return!1;6<(z*=.5)*z&&(v=this.b1.smass+this.b2.smass,Er.epsilon<v&&(M=-z*(v=.75/v),(this.equal||M<0)&&(m=M*this.b1.imass,this.b1.posx-=h*m,this.b1.posy-=l*m,g=M*this.b2.imass,this.b2.posx+=h*g,this.b2.posy+=l*g,_=M*this.b3.imass,this.b3.posx-=p*_,this.b3.posy-=u*_,w=M*this.b4.imass,this.b4.posx+=p*w,this.b4.posy+=u*w,_=g=m=v=0,v=this.b2.posx+i-(this.b1.posx+t),m=this.b2.posy+n-(this.b1.posy+e),g=this.b4.posx+s-(this.b3.posx+r),_=this.b4.posy+a-(this.b3.posy+o),0!=(w=Math.sqrt(v*v+m*m))&&(h=v*(x=1/w),l=m*x),0!=(x=Math.sqrt(g*g+_*_))?(p=g*(f=1/x),u=_*f,p*=f=this.ratio,u*=f):(p*=f=this.ratio/Math.sqrt(p*p+u*u),u*=f),x=w+this.ratio*x,this.equal?x-=this.jointMax:x<this.jointMin?(x=this.jointMin-x,h=-h,l=-l,p=-p,u=-u):x>this.jointMax?x-=this.jointMax:x=u=p=l=h=0,z=x,z*=.5)));a=this.b1.smass+this.b2.smass+this.ratio*this.ratio*(this.b3.smass+this.b4.smass)+this.b1.sinertia*(e=l*t-h*e)*e+this.b2.sinertia*(n=l*i-h*n)*n+this.b3.sinertia*(o=u*r-p*o)*o+this.b4.sinertia*(s=u*s-p*a)*s;this.b1==this.b4&&(a-=2*((h*p+l*u)*this.b1.smass+e*s*this.b1.sinertia)),this.b1==this.b3&&(a+=2*((h*p+l*u)*this.b1.smass+e*o*this.b1.sinertia)),this.b2==this.b3&&(a-=2*((h*p+l*u)*this.b2.smass+n*o*this.b2.sinertia)),this.b2==this.b4&&(a+=2*((h*p+l*u)*this.b2.smass+n*s*this.b2.sinertia));var b,S,C,P,M,T;M=-z*(0!=a?1/a:a),(this.equal||M<0)&&(a=this.b1.imass*M,this.b1.posx-=h*a,this.b1.posy-=l*a,a=this.b2.imass*M,this.b2.posx+=h*a,this.b2.posy+=l*a,a=this.b3.imass*M,this.b3.posx-=p*a,this.b3.posy-=u*a,a=this.b4.imass*M,this.b4.posx+=p*a,this.b4.posy+=u*a,u=this.b1,a=-e*this.b1.iinertia*M,u.rot+=a,1e-4<a*a?(u.axisx=Math.sin(u.rot),u.axisy=Math.cos(u.rot)):(b=((e=1-.5*(b=a*a))*u.axisx+a*u.axisy)*(P=1-b*b/8),u.axisy=(e*u.axisy-a*u.axisx)*P,u.axisx=b),P=this.b2,u=n*this.b2.iinertia*M,P.rot+=u,1e-4<u*u?(P.axisx=Math.sin(P.rot),P.axisy=Math.cos(P.rot)):(S=((b=1-.5*(S=u*u))*P.axisx+u*P.axisy)*(n=1-S*S/8),P.axisy=(b*P.axisy-u*P.axisx)*n,P.axisx=S),P=this.b3,S=-o*this.b3.iinertia*M,P.rot+=S,1e-4<S*S?(P.axisx=Math.sin(P.rot),P.axisy=Math.cos(P.rot)):(T=((o=1-.5*(T=S*S))*P.axisx+S*P.axisy)*(C=1-T*T/8),P.axisy=(o*P.axisy-S*P.axisx)*C,P.axisx=T),C=this.b4,P=s*this.b4.iinertia*M,C.rot+=P,1e-4<P*P?(C.axisx=Math.sin(C.rot),C.axisy=Math.cos(C.rot)):(T=((s=1-.5*(T=P*P))*C.axisx+P*C.axisy)*(M=1-T*T/8),C.axisy=(s*C.axisy-P*C.axisx)*M,C.axisx=T))}return!1},jt.prototype.draw=function(t){},jt.prototype.__class__=jt;var Ut=zpp_nape.constraint.ZPP_UserConstraint=function(t,e){this.jOld=null,this.J=null,this.vec3=null,this.Keff=null,this.jMax=0,this.velonly=!1,this.gamma=0,this.soft=0,this.y=null,this.L=null,this.stepped=!1,this.bias=null,this.jAcc=null,this.dim=0,this.bodies=null,this.outer_zn=null,Gt.call(this),this.bodies=[],this.dim=t,this.velonly=e,this.jAcc=[],this.bias=[],this.L=[],this.J=[],this.jOld=[],this.y=[],this.Keff=[],this.vec3=K.get(0,0,0);for(var i=0;i<t;){var n=i++;this.J[n]=this.jOld[n]=this.y[n]=0,this.bias[n]=0;for(var r=this.jAcc[n]=0;r<t;)this.L[n*t+r++]=0}this.stepped=!1};Ut.__name__=["zpp_nape","constraint","ZPP_UserConstraint"],Ut.__super__=Gt,Ut.prototype=Object.create(Gt.prototype),Ut.prototype.outer_zn=null,Ut.prototype.bindVec2_invalidate=function(t){this.outer_zn.__invalidate()},Ut.prototype.bodies=null,Ut.prototype.dim=null,Ut.prototype.jAcc=null,Ut.prototype.bias=null,Ut.prototype.addBody=function(t){for(var e=null,i=0,n=this.bodies;i<n.length;){var r=n[i];if(++i,r.body==t){e=r;break}}null==e?(this.bodies.push(new oe(1,t)),this.active&&null!=this.space&&null!=t&&t.constraints.add(this)):e.cnt++},Ut.prototype.remBody=function(t){for(var e=null,i=0|this.bodies.length,n=0;n<i;){var r=this.bodies[n];if(r.body==t){r.cnt--,0==r.cnt&&(0<i&&(this.bodies[n]=this.bodies[i-1]),this.bodies.pop(),this.active&&null!=this.space&&null!=t&&t.constraints.remove(this)),e=r;break}++n}return null!=e},Ut.prototype.bodyImpulse=function(t){for(var e=0,i=this.dim;e<i;){var n=e++;this.J[n]=this.jAcc[n]}var r=K.get(0,0,0);return this.stepped&&this.outer_zn.__impulse(this.J,t.outer,r),r},Ut.prototype.activeBodies=function(){for(var t=0,e=this.bodies;t<e.length;){var i=e[t];++t,null!=i.body&&i.body.constraints.add(this)}},Ut.prototype.inactiveBodies=function(){for(var t=0,e=this.bodies;t<e.length;){var i=e[t];++t,null!=i.body&&i.body.constraints.remove(this)}},Ut.prototype.stepped=null,Ut.prototype.copy=function(t,e){throw this.copyto(this.outer_zn.__copy()),new r("not done yet")},Ut.prototype.validate=function(){for(var t=0,e=this.bodies;t<e.length;){var i=e[t];if(++t,i.body.space!=this.space)throw new r("Error: Constraints must have each body within the same sapce to which the constraint has been assigned")}this.outer_zn.__validate()},Ut.prototype.wake_connected=function(){for(var t=0,e=this.bodies;t<e.length;){var i=e[t];++t,2==i.body.type&&i.body.wake()}},Ut.prototype.forest=function(){for(var t=0,e=this.bodies;t<e.length;){var i,n,r=e[t];if(++t,2==r.body.type){if(r.body.component==r.body.component.parent)i=r.body.component;else{for(var o=r.body.component,s=null;o!=o.parent;){var a=o.parent;o.parent=s,s=o,o=a}for(;null!=s;){var h=s.parent;s.parent=o,s=h}i=o}if(this.component==this.component.parent)n=this.component;else{for(var l=this.component,p=null;l!=l.parent;){var u=l.parent;l.parent=p,p=l,l=u}for(;null!=p;){var d=p.parent;p.parent=l,p=d}n=l}i!=n&&(i.rank<n.rank?i.parent=n:i.rank>n.rank?n.parent=i:(n.parent=i).rank++)}}},Ut.prototype.pair_exists=function(t,e){for(var i=!1,n=0|this.bodies.length,r=0;r<n;){for(var o=r++,s=this.bodies[o].body,a=1+o;a<n;){var h=this.bodies[a++].body;if(s.id==t&&h.id==e||s.id==e&&h.id==t){i=!0;break}}if(i)break}return i},Ut.prototype.broken=function(){this.outer_zn.__broken()},Ut.prototype.clearcache=function(){for(var t=0,e=this.dim;t<e;)this.jAcc[t++]=0;this.pre_dt=-1},Ut.prototype.lsq=function(t){for(var e=0,i=0,n=this.dim;i<n;){var r=i++;e+=t[r]*t[r]}return e},Ut.prototype._clamp=function(t,e){var i=this.lsq(t);if(e*e<i)for(var n=e/Math.sqrt(i),r=0,o=this.dim;r<o;)t[r++]*=n},Ut.prototype.L=null,Ut.prototype.solve=function(t){for(var e=0,i=0,n=this.dim;i<n;){for(var r=i++,o=0,s=0,a=r-1;s<a;){var h=s++;o+=this.L[r*this.dim+h]*this.L[r*this.dim+h]}var l=Math.sqrt(t[e++]-o);if(0!=(this.L[r*this.dim+r]=l))for(var l=1/l,p=1+r,u=this.dim;p<u;){for(var d=p++,c=0,y=0,_=r-1;y<_;){var m=y++;c+=this.L[d*this.dim+m]*this.L[r*this.dim+m]}this.L[d*this.dim+r]=l*(t[e++]-c)}else{for(var g=1+r,f=this.dim;g<f;)this.L[g++*this.dim+r]=0;e+=this.dim-r-1}}return this.L},Ut.prototype.y=null,Ut.prototype.transform=function(t,e){for(var i=0,n=this.dim;i<n;){var r=i++,o=e[r],s=t[r*this.dim+r];if(0!=s){for(var a=0;a<r;){var h=a++;o-=t[r*this.dim+h]*this.y[h]}this.y[r]=o/s}else this.y[r]=0}for(var l=0,p=this.dim;l<p;){var u=this.dim-1-l++,d=t[u*this.dim+u];if(0!=d){for(var c=this.y[u],y=1+u,_=this.dim;y<_;){var m=y++;c-=t[m*this.dim+u]*e[m]}e[u]=c/d}else e[u]=0}},Ut.prototype.soft=null,Ut.prototype.gamma=null,Ut.prototype.velonly=null,Ut.prototype.jMax=null,Ut.prototype.Keff=null,Ut.prototype.preStep=function(t){this.outer_zn.__validate(),-1==this.pre_dt&&(this.pre_dt=t);var e=t/this.pre_dt;if(this.pre_dt=t,this.stepped=!0,this.outer_zn.__prepare(),this.outer_zn.__eff_mass(this.Keff),this.L=this.solve(this.Keff),this.stiff||this.velonly){for(var i=0,n=this.dim;i<n;)this.bias[i++]=0;this.gamma=0,this.soft=1}else{var r=2*Math.PI*this.frequency;this.gamma=1/(t*r*(2*this.damping+r*t));var o=1/(1+this.gamma),s=t*r*r*this.gamma;if(this.gamma*=o,this.soft=o,this.outer_zn.__position(this.bias),this.breakUnderError&&this.lsq(this.bias)>this.maxError*this.maxError)return!0;for(var a=0,h=this.dim;a<h;)this.bias[a++]*=-s;this._clamp(this.bias,this.maxError)}for(var l=0,p=this.dim;l<p;)this.jAcc[l++]*=e;return this.jMax=this.maxForce*t,!1},Ut.prototype.vec3=null,Ut.prototype.warmStart=function(){for(var t=0,e=this.bodies;t<e.length;){var i=e[t];++t;var n=i.body;this.outer_zn.__impulse(this.jAcc,n.outer,this.vec3);var r=n.imass,o=this.vec3,i=o.zpp_inner;null!=i._validate&&i._validate(),n.velx+=o.zpp_inner.x*r;i=this.vec3,o=i.zpp_inner;null!=o._validate&&o._validate(),n.vely+=i.zpp_inner.y*r;i=this.vec3,r=i.zpp_inner;null!=r._validate&&r._validate(),n.angvel+=i.zpp_inner.z*n.iinertia}},Ut.prototype.J=null,Ut.prototype.jOld=null,Ut.prototype.applyImpulseVel=function(){this.outer_zn.__velocity(this.J);for(var t=0,e=this.dim;t<e;){var i=t++;this.J[i]=this.bias[i]-this.J[i]}this.transform(this.L,this.J);for(var n=0,r=this.dim;n<r;){var o=n++;this.jOld[o]=this.jAcc[o],this.jAcc[o]+=this.J[o]=this.J[o]*this.soft-this.jAcc[o]*this.gamma}if(this.outer_zn.__clamp(this.jAcc),(this.breakUnderForce||!this.stiff)&&this.lsq(this.jAcc)>this.jMax*this.jMax){if(this.breakUnderForce)return!0;this.stiff||this._clamp(this.jAcc,this.jMax)}for(var s=0,a=this.dim;s<a;){var h=s++;this.J[h]=this.jAcc[h]-this.jOld[h]}for(var l=0,p=this.bodies;l<p.length;){var u=p[l];++l;var d=u.body;this.outer_zn.__impulse(this.J,d.outer,this.vec3);var c=d.imass,y=this.vec3,u=y.zpp_inner;null!=u._validate&&u._validate(),d.velx+=y.zpp_inner.x*c;u=this.vec3,y=u.zpp_inner;null!=y._validate&&y._validate(),d.vely+=u.zpp_inner.y*c;u=this.vec3,c=u.zpp_inner;null!=c._validate&&c._validate(),d.angvel+=u.zpp_inner.z*d.iinertia}return!1},Ut.prototype.applyImpulsePos=function(){if(this.velonly)return!1;this.outer_zn.__prepare(),this.outer_zn.__position(this.J);var t=this.lsq(this.J);if(this.breakUnderError&&t>this.maxError*this.maxError)return!0;if(t<Er.constraintLinearSlop*Er.constraintLinearSlop)return!1;for(var e=0,i=this.dim;e<i;)this.J[e++]*=-1;this.outer_zn.__eff_mass(this.Keff),this.transform(this.solve(this.Keff),this.J),this.outer_zn.__clamp(this.J);for(var n=0,r=this.bodies;n<r.length;){var o=r[n];++n;var s=o.body;this.outer_zn.__impulse(this.J,s.outer,this.vec3);var a=s.imass,h=this.vec3,l=h.zpp_inner;null!=l._validate&&l._validate(),s.posx+=h.zpp_inner.x*a;o=this.vec3,l=o.zpp_inner;null!=l._validate&&l._validate(),s.posy+=o.zpp_inner.y*a;h=this.vec3,l=h.zpp_inner;null!=l._validate&&l._validate();o=h.zpp_inner.z*s.iinertia;s.rot+=o,1e-4<o*o?(s.axisx=Math.sin(s.rot),s.axisy=Math.cos(s.rot)):(a=((l=1-.5*(a=o*o))*s.axisx+o*s.axisy)*(h=1-a*a/8),s.axisy=(l*s.axisy-o*s.axisx)*h,s.axisx=a)}return!1},Ut.prototype.draw=function(t){this.outer_zn.__draw(t)},Ut.prototype.__class__=Ut;var oe=zpp_nape.constraint.ZPP_UserBody=function(t,e){this.body=null,this.cnt=0,this.cnt=t,this.body=e};oe.__name__=["zpp_nape","constraint","ZPP_UserBody"],oe.prototype.cnt=null,oe.prototype.body=null,oe.prototype.__class__=oe;var se=zpp_nape.constraint.ZPP_WeldJoint=function(){this.stepped=!1,this.biasz=0,this.biasy=0,this.biasx=0,this.gamma=0,this.jMax=0,this.jAccz=0,this.jAccy=0,this.jAccx=0,this.kMassf=0,this.kMasse=0,this.kMassc=0,this.kMassd=0,this.kMassb=0,this.kMassa=0,this.phase=0,this.wrap_a2=null,this.a2rely=0,this.a2relx=0,this.a2localy=0,this.a2localx=0,this.b2=null,this.wrap_a1=null,this.a1rely=0,this.a1relx=0,this.a1localy=0,this.a1localx=0,this.b1=null,this.outer_zn=null,Gt.call(this),this.phase=0,this.jAccx=0,this.jAccy=0,this.jAccz=0,this.jMax=1/0,this.stepped=!1,this.a1localx=0,this.a1localy=0,this.a1relx=0,this.a1rely=0,this.a2localx=0,this.a2localy=0,this.a2relx=0,this.a2rely=0};se.__name__=["zpp_nape","constraint","ZPP_WeldJoint"],se.__super__=Gt,se.prototype=Object.create(Gt.prototype),se.prototype.outer_zn=null,se.prototype.bodyImpulse=function(t){return this.stepped?t==this.b1?K.get(-this.jAccx,-this.jAccy,-(this.jAccy*this.a1relx-this.jAccx*this.a1rely+this.jAccz)):K.get(this.jAccx,this.jAccy,this.jAccy*this.a2relx-this.jAccx*this.a2rely+this.jAccz):K.get(0,0,0)},se.prototype.activeBodies=function(){null!=this.b1&&this.b1.constraints.add(this),this.b2!=this.b1&&null!=this.b2&&this.b2.constraints.add(this)},se.prototype.inactiveBodies=function(){null!=this.b1&&this.b1.constraints.remove(this),this.b2!=this.b1&&null!=this.b2&&this.b2.constraints.remove(this)},se.prototype.b1=null,se.prototype.a1localx=null,se.prototype.a1localy=null,se.prototype.a1relx=null,se.prototype.a1rely=null,se.prototype.validate_a1=function(){this.wrap_a1.zpp_inner.x=this.a1localx,this.wrap_a1.zpp_inner.y=this.a1localy},se.prototype.invalidate_a1=function(t){this.immutable_midstep("Constraint::a1"),this.a1localx=t.x,this.a1localy=t.y,this.wake()},se.prototype.setup_a1=function(){var t,e,i=this.a1localx,n=this.a1localy;null==Bn.poolVec2?t=new St:(t=Bn.poolVec2,Bn.poolVec2=t.zpp_pool,t.zpp_pool=null),null==t.zpp_inner?(null==Gr.zpp_pool?e=new Gr:(e=Gr.zpp_pool,Gr.zpp_pool=e.next,e.next=null),e.weak=!1,e._immutable=!1,e.x=i,e.y=n,t.zpp_inner=e,t.zpp_inner.outer=t):(null!=(e=t.zpp_inner)._validate&&e._validate(),t.zpp_inner.x==i&&(null!=(e=t.zpp_inner)._validate&&e._validate(),t.zpp_inner.y==n)||(t.zpp_inner.x=i,t.zpp_inner.y=n,null!=(n=t.zpp_inner)._invalidate&&n._invalidate(n))),t.zpp_inner.weak=!1,this.wrap_a1=t,this.wrap_a1.zpp_inner._inuse=!0,this.wrap_a1.zpp_inner._validate=Z(this,this.validate_a1),this.wrap_a1.zpp_inner._invalidate=Z(this,this.invalidate_a1)},se.prototype.wrap_a1=null,se.prototype.b2=null,se.prototype.a2localx=null,se.prototype.a2localy=null,se.prototype.a2relx=null,se.prototype.a2rely=null,se.prototype.validate_a2=function(){this.wrap_a2.zpp_inner.x=this.a2localx,this.wrap_a2.zpp_inner.y=this.a2localy},se.prototype.invalidate_a2=function(t){this.immutable_midstep("Constraint::a2"),this.a2localx=t.x,this.a2localy=t.y,this.wake()},se.prototype.setup_a2=function(){var t,e,i=this.a2localx,n=this.a2localy;null==Bn.poolVec2?t=new St:(t=Bn.poolVec2,Bn.poolVec2=t.zpp_pool,t.zpp_pool=null),null==t.zpp_inner?(null==Gr.zpp_pool?e=new Gr:(e=Gr.zpp_pool,Gr.zpp_pool=e.next,e.next=null),e.weak=!1,e._immutable=!1,e.x=i,e.y=n,t.zpp_inner=e,t.zpp_inner.outer=t):(null!=(e=t.zpp_inner)._validate&&e._validate(),t.zpp_inner.x==i&&(null!=(e=t.zpp_inner)._validate&&e._validate(),t.zpp_inner.y==n)||(t.zpp_inner.x=i,t.zpp_inner.y=n,null!=(n=t.zpp_inner)._invalidate&&n._invalidate(n))),t.zpp_inner.weak=!1,this.wrap_a2=t,this.wrap_a2.zpp_inner._inuse=!0,this.wrap_a2.zpp_inner._validate=Z(this,this.validate_a2),this.wrap_a2.zpp_inner._invalidate=Z(this,this.invalidate_a2)},se.prototype.wrap_a2=null,se.prototype.phase=null,se.prototype.kMassa=null,se.prototype.kMassb=null,se.prototype.kMassd=null,se.prototype.kMassc=null,se.prototype.kMasse=null,se.prototype.kMassf=null,se.prototype.jAccx=null,se.prototype.jAccy=null,se.prototype.jAccz=null,se.prototype.jMax=null,se.prototype.gamma=null,se.prototype.biasx=null,se.prototype.biasy=null,se.prototype.biasz=null,se.prototype.stepped=null,se.prototype.copy=function(t,e){var i=this.outer_zn;null==i.zpp_inner_zn.wrap_a1&&i.zpp_inner_zn.setup_a1();var n=i.zpp_inner_zn.wrap_a1,i=this.outer_zn;null==i.zpp_inner_zn.wrap_a2&&i.zpp_inner_zn.setup_a2();var r=new A(null,null,n,i.zpp_inner_zn.wrap_a2);if(this.copyto(r),null!=t&&null!=this.b1){for(var o=null,s=0;s<t.length;){var a=t[s];if(++s,a.id==this.b1.id){o=a.bc;break}}null!=o?r.zpp_inner_zn.b1=o.zpp_inner:e.push(Lt.todo(this.b1.id,function(t){r.zpp_inner_zn.b1=t.zpp_inner}))}if(null!=t&&null!=this.b2){for(var h=null,l=0;l<t.length;){var p=t[l];if(++l,p.id==this.b2.id){h=p.bc;break}}null!=h?r.zpp_inner_zn.b2=h.zpp_inner:e.push(Lt.todo(this.b2.id,function(t){r.zpp_inner_zn.b2=t.zpp_inner}))}return r},se.prototype.validate=function(){if(null==this.b1||null==this.b2)throw new r("Error: AngleJoint cannot be simulated null bodies");if(this.b1==this.b2)throw new r("Error: WeldJoint cannot be simulated with body1 == body2");if(this.b1.space!=this.space||this.b2.space!=this.space)throw new r("Error: Constraints must have each body within the same space to which the constraint has been assigned");if(2!=this.b1.type&&2!=this.b2.type)throw new r("Error: Constraints cannot have both bodies non-dynamic")},se.prototype.wake_connected=function(){null!=this.b1&&2==this.b1.type&&this.b1.wake(),null!=this.b2&&2==this.b2.type&&this.b2.wake()},se.prototype.forest=function(){if(2==this.b1.type){var t,e;if(this.b1.component==this.b1.component.parent)t=this.b1.component;else{for(var i=this.b1.component,n=null;i!=i.parent;){var r=i.parent;i.parent=n,n=i,i=r}for(;null!=n;){var o=n.parent;n.parent=i,n=o}t=i}if(this.component==this.component.parent)e=this.component;else{for(var s=this.component,a=null;s!=s.parent;){var h=s.parent;s.parent=a,a=s,s=h}for(;null!=a;){var l=a.parent;a.parent=s,a=l}e=s}t!=e&&(t.rank<e.rank?t.parent=e:t.rank>e.rank?e.parent=t:(e.parent=t).rank++)}if(2==this.b2.type){var p,u;if(this.b2.component==this.b2.component.parent)p=this.b2.component;else{for(var d=this.b2.component,c=null;d!=d.parent;){var y=d.parent;d.parent=c,c=d,d=y}for(;null!=c;){var _=c.parent;c.parent=d,c=_}p=d}if(this.component==this.component.parent)u=this.component;else{for(var m=this.component,g=null;m!=m.parent;){var f=m.parent;m.parent=g,g=m,m=f}for(;null!=g;){var x=g.parent;g.parent=m,g=x}u=m}p!=u&&(p.rank<u.rank?p.parent=u:p.rank>u.rank?u.parent=p:(u.parent=p).rank++)}},se.prototype.pair_exists=function(t,e){return this.b1.id==t&&this.b2.id==e||this.b1.id==e&&this.b2.id==t},se.prototype.clearcache=function(){this.jAccx=0,this.jAccy=0,this.jAccz=0,this.pre_dt=-1},se.prototype.preStep=function(t){-1==this.pre_dt&&(this.pre_dt=t);var e=t/this.pre_dt;this.pre_dt=t,this.stepped=!0,this.a1relx=this.b1.axisy*this.a1localx-this.b1.axisx*this.a1localy,this.a1rely=this.a1localx*this.b1.axisx+this.a1localy*this.b1.axisy,this.a2relx=this.b2.axisy*this.a2localx-this.b2.axisx*this.a2localy,this.a2rely=this.a2localx*this.b2.axisx+this.a2localy*this.b2.axisy;var i=this.b1.smass+this.b2.smass;this.kMassa=i,this.kMassb=0,this.kMassd=i,this.kMassc=0,this.kMasse=0,(this.kMassf=0)!=this.b1.sinertia&&(r=this.a1relx*this.b1.sinertia,n=this.a1rely*this.b1.sinertia,this.kMassa+=n*this.a1rely,this.kMassb+=-n*this.a1relx,this.kMassd+=r*this.a1relx,this.kMassc+=-n,this.kMasse+=r,this.kMassf+=this.b1.sinertia),0!=this.b2.sinertia&&(s=this.a2relx*this.b2.sinertia,o=this.a2rely*this.b2.sinertia,this.kMassa+=o*this.a2rely,this.kMassb+=-o*this.a2relx,this.kMassd+=s*this.a2relx,this.kMassc+=-o,this.kMasse+=s,this.kMassf+=this.b2.sinertia);var n,r,o,s,a,i=this.kMassa*(this.kMassd*this.kMassf-this.kMasse*this.kMasse)+this.kMassb*(this.kMassc*this.kMasse-this.kMassb*this.kMassf)+this.kMassc*(this.kMassb*this.kMasse-this.kMassc*this.kMassd);if(0!=(1&(i=i!=i?(this.kMassa=0,this.kMassb=0,this.kMassd=0,this.kMassc=0,this.kMasse=0,this.kMassf=0,7):0==i?((a=0)!=this.kMassa?this.kMassa=1/this.kMassa:(this.kMassa=0,a=1),0!=this.kMassd?this.kMassd=1/this.kMassd:(this.kMassd=0,a|=2),0!=this.kMassf?this.kMassf=1/this.kMassf:(this.kMassf=0,a|=4),this.kMassb=this.kMassc=this.kMasse=0,a):(n=(i=1/i)*(this.kMassd*this.kMassf-this.kMasse*this.kMasse),r=i*(this.kMasse*this.kMassc-this.kMassb*this.kMassf),o=i*(this.kMassa*this.kMassf-this.kMassc*this.kMassc),s=i*(this.kMassb*this.kMasse-this.kMassc*this.kMassd),a=i*(this.kMassb*this.kMassc-this.kMassa*this.kMasse),h=this.kMassa*this.kMassd-this.kMassb*this.kMassb,this.kMassa=n,this.kMassb=r,this.kMassd=o,this.kMassc=s,this.kMasse=a,this.kMassf=i*h,0)))&&(this.jAccx=0),0!=(2&i)&&(this.jAccy=0),0!=(4&i)&&(this.jAccz=0),this.stiff)this.biasx=0,this.biasy=0,this.biasz=0,this.gamma=0;else{var h=2*Math.PI*this.frequency;this.gamma=1/(t*h*(2*this.damping+h*t));i=1/(1+this.gamma),h=t*h*h*this.gamma;if(this.gamma*=i,this.kMassa*=i,this.kMassb*=i,this.kMassd*=i,this.kMassc*=i,this.kMasse*=i,this.kMassf*=i,this.biasx=this.b2.posx+this.a2relx-(this.b1.posx+this.a1relx),this.biasy=this.b2.posy+this.a2rely-(this.b1.posy+this.a1rely),this.biasz=this.b2.rot-this.b1.rot-this.phase,this.breakUnderError&&this.biasx*this.biasx+this.biasy*this.biasy+this.biasz*this.biasz>this.maxError*this.maxError)return!0;i=-h;this.biasx*=i,this.biasy*=i,this.biasz*=i;h=this.maxError,i=this.biasx*this.biasx+this.biasy*this.biasy+this.biasz*this.biasz;h*h<i&&(i=h*(1/Math.sqrt(i)),this.biasx*=i,this.biasy*=i,this.biasz*=i)}return this.jAccx*=e,this.jAccy*=e,this.jAccz*=e,this.jMax=this.maxForce*t,!1},se.prototype.warmStart=function(){var t=this.b1.imass;this.b1.velx-=this.jAccx*t,this.b1.vely-=this.jAccy*t;t=this.b2.imass;this.b2.velx+=this.jAccx*t,this.b2.vely+=this.jAccy*t,this.b1.angvel-=(this.jAccy*this.a1relx-this.jAccx*this.a1rely+this.jAccz)*this.b1.iinertia,this.b2.angvel+=(this.jAccy*this.a2relx-this.jAccx*this.a2rely+this.jAccz)*this.b2.iinertia},se.prototype.applyImpulseVel=function(){var t=this.b2.velx+this.b2.kinvelx-this.a2rely*(this.b2.angvel+this.b2.kinangvel)-(this.b1.velx+this.b1.kinvelx-this.a1rely*(this.b1.angvel+this.b1.kinangvel)),e=this.b2.vely+this.b2.kinvely+this.a2relx*(this.b2.angvel+this.b2.kinangvel)-(this.b1.vely+this.b1.kinvely+this.a1relx*(this.b1.angvel+this.b1.kinangvel)),i=this.b2.angvel+this.b2.kinangvel-this.b1.angvel-this.b1.kinangvel,n=this.biasx-t,r=this.biasy-e,o=this.biasz-i,s=this.kMassa*n+this.kMassb*r+this.kMassc*o,a=this.kMassb*n+this.kMassd*r+this.kMasse*o;o=this.kMassc*n+this.kMasse*r+this.kMassf*o,n=s,r=a;t=this.gamma;n-=this.jAccx*t,r-=this.jAccy*t,o-=this.jAccz*t;e=this.jAccx,i=this.jAccy,s=this.jAccz;if(this.jAccx+=n,this.jAccy+=r,this.jAccz+=o,this.breakUnderForce){if(this.jAccx*this.jAccx+this.jAccy*this.jAccy+this.jAccz*this.jAccz>this.jMax*this.jMax)return!0}else this.stiff||(a=this.jMax)*a<(t=this.jAccx*this.jAccx+this.jAccy*this.jAccy+this.jAccz*this.jAccz)&&(t=a*(1/Math.sqrt(t)),this.jAccx*=t,this.jAccy*=t,this.jAccz*=t);n=this.jAccx-e,r=this.jAccy-i,o=this.jAccz-s;s=this.b1.imass;this.b1.velx-=n*s,this.b1.vely-=r*s;s=this.b2.imass;return this.b2.velx+=n*s,this.b2.vely+=r*s,this.b1.angvel-=(r*this.a1relx-n*this.a1rely+o)*this.b1.iinertia,this.b2.angvel+=(r*this.a2relx-n*this.a2rely+o)*this.b2.iinertia,!1},se.prototype.applyImpulsePos=function(){var t=this.b1.axisy*this.a1localx-this.b1.axisx*this.a1localy,e=this.a1localx*this.b1.axisx+this.a1localy*this.b1.axisy,i=this.b2.axisy*this.a2localx-this.b2.axisx*this.a2localy,n=this.a2localx*this.b2.axisx+this.a2localy*this.b2.axisy,r=0,o=0,s=0,r=this.b2.posx+i-(this.b1.posx+t),o=this.b2.posy+n-(this.b1.posy+e),s=this.b2.rot-this.b1.rot-this.phase,a=0,h=0,l=0;if(this.breakUnderError&&r*r+o*o+s*s>this.maxError*this.maxError)return!0;var p=!0;r*r+o*o<Er.constraintLinearSlop*Er.constraintLinearSlop&&(p=!1,o=r=0);var u=Er.constraintAngularSlop;if(s*s<u*u){if(!p)return!1;s=0}s*=.5,6<(r*=.5)*r+(o*=.5)*o&&(y=this.b1.smass+this.b2.smass,Er.epsilon<y&&(400<(_=(a=-r*(y=.75/y))*a+(h=-o*y)*h)&&(a*=m=1/Math.sqrt(_)*20,h*=m),g=this.b1.imass,this.b1.posx-=a*g,this.b1.posy-=h*g,f=this.b2.imass,this.b2.posx+=a*f,this.b2.posy+=h*f,r=this.b2.posx+i-(this.b1.posx+t),o=this.b2.posy+n-(this.b1.posy+e),s=this.b2.rot-this.b1.rot-this.phase,r*=.5,o*=.5,s*=.5));var d,c,u=0,p=0,y=0,_=0,m=0,g=0,f=this.b1.smass+this.b2.smass,y=u=f;(g=m=_=p=0)!=this.b1.sinertia&&(c=t*this.b1.sinertia,u=f+(d=e*this.b1.sinertia)*e,p+=-d*t,y=f+c*t,_+=-d,m+=c,g+=this.b1.sinertia),0!=this.b2.sinertia&&(d=i*this.b2.sinertia,u+=(c=n*this.b2.sinertia)*n,p+=-c*i,y+=d*i,_+=-c,m+=d,g+=this.b2.sinertia),l=-s;o=(a=-r)*a+(h=-o)*h;36<o&&(a*=x=1/Math.sqrt(o)*6,h*=x);var x,o=u*(y*g-m*m)+p*(_*m-p*g)+_*(p*m-_*y);o!=o?a=h=l=0:0==o?(0!=u?a/=u:a=0,0!=y?h/=y:h=0,0!=g?l/=g:l=0):(v=(o=1/o)*(a*(y*g-m*m)+h*(w=m*_-p*g)+l*(x=p*m-_*y)),w=o*(a*w+h*(u*g-_*_)+l*(m=p*_-u*m)),l=o*(a*x+h*m+l*(u*y-p*p)),a=v,h=w);var v=this.b1.imass;this.b1.posx-=a*v,this.b1.posy-=h*v;var w=this.b2.imass;this.b2.posx+=a*w,this.b2.posy+=h*w;v=this.b1,w=-(h*t-a*e+l)*this.b1.iinertia;v.rot+=w,1e-4<w*w?(v.axisx=Math.sin(v.rot),v.axisy=Math.cos(v.rot)):(z=((t=1-.5*(z=w*w))*v.axisx+w*v.axisy)*(e=1-z*z/8),v.axisy=(t*v.axisy-w*v.axisx)*e,v.axisx=z);var z=this.b2,i=(h*i-a*n+l)*this.b2.iinertia;return z.rot+=i,1e-4<i*i?(z.axisx=Math.sin(z.rot),z.axisy=Math.cos(z.rot)):(a=((n=1-.5*(a=i*i))*z.axisx+i*z.axisy)*(l=1-a*a/8),z.axisy=(n*z.axisy-i*z.axisx)*l,z.axisx=a),!1},se.prototype.draw=function(t){},se.prototype.__class__=se;var Qe=zpp_nape.dynamics.ZPP_Arbiter=function(){this.sensorarb=null,this.fluidarb=null,this.colarb=null,this.type=0,this.pair=null,this.ws2=null,this.ws1=null,this.b2=null,this.b1=null,this.invalidated=!1,this.immState=0,this.fresh=!1,this.continuous=!1,this.presentable=!1,this.intchange=!1,this.present=0,this.sleeping=!1,this.cleared=!1,this.active=!1,this.endGenerated=0,this.sleep_stamp=0,this.up_stamp=0,this.stamp=0,this.di=0,this.id=0,this.hnext=null,this.outer=null};Qe.__name__=["zpp_nape","dynamics","ZPP_Arbiter"],Qe.prototype.outer=null,Qe.prototype.wrapper=function(){return null==this.outer&&(Qe.internal=!0,this.type==Qe.COL?(this.colarb.outer_zn=new I,this.outer=this.colarb.outer_zn):this.type==Qe.FLUID?(this.fluidarb.outer_zn=new L,this.outer=this.fluidarb.outer_zn):this.outer=new k,this.outer.zpp_inner=this,Qe.internal=!1),this.outer},Qe.prototype.inactiveme=function(){return!this.active},Qe.prototype.hnext=null,Qe.prototype.id=null,Qe.prototype.di=null,Qe.prototype.stamp=null,Qe.prototype.up_stamp=null,Qe.prototype.sleep_stamp=null,Qe.prototype.endGenerated=null,Qe.prototype.active=null,Qe.prototype.cleared=null,Qe.prototype.sleeping=null,Qe.prototype.present=null,Qe.prototype.intchange=null,Qe.prototype.presentable=null,Qe.prototype.continuous=null,Qe.prototype.fresh=null,Qe.prototype.immState=null,Qe.prototype.acting=function(){return!!this.active&&0!=(1&this.immState)},Qe.prototype.invalidated=null,Qe.prototype.b1=null,Qe.prototype.b2=null,Qe.prototype.ws1=null,Qe.prototype.ws2=null,Qe.prototype.pair=null,Qe.prototype.swap_features=function(){var t=this.b1;this.b1=this.b2,this.b2=t;t=this.ws1;this.ws1=this.ws2,this.ws2=t;t=this.colarb.s1;this.colarb.s1=this.colarb.s2,this.colarb.s2=t},Qe.prototype.type=null,Qe.prototype.colarb=null,Qe.prototype.fluidarb=null,Qe.prototype.sensorarb=null,Qe.prototype.lazyRetire=function(t,e){if(this.cleared=!0,null==e||this.b2==e)for(var i,n,r=this.b1.arbiters,o=null,s=r.head;null!=s;){if(s.elt==this){null==o?(n=(i=r.head).next,r.head=n,null==r.head&&(r.pushmod=!0)):(n=(i=o.next).next,null==(o.next=n)&&(r.pushmod=!0));var a=i;a.elt=null,a.next=er.zpp_pool,er.zpp_pool=a,r.modified=!0,r.length--,r.pushmod=!0;break}s=(o=s).next}if(null==e||this.b1==e)for(var h,l,p=this.b2.arbiters,u=null,d=p.head;null!=d;){if(d.elt==this){null==u?(l=(h=p.head).next,p.head=l,null==p.head&&(p.pushmod=!0)):(l=(h=u.next).next,null==(u.next=l)&&(p.pushmod=!0));var c=h;c.elt=null,c.next=er.zpp_pool,er.zpp_pool=c,p.modified=!0,p.length--,p.pushmod=!0;break}d=(u=d).next}null!=this.pair&&(this.pair.arb=null,this.pair=null),this.active=!1,t.f_arbiters.modified=!0},Qe.prototype.sup_assign=function(t,e,i,n){this.b1=t.body,this.ws1=t,this.b2=e.body,this.ws2=e,this.id=i,this.di=n;n=this.b1.arbiters;null==er.zpp_pool?r=new er:(r=er.zpp_pool,er.zpp_pool=r.next,r.next=null),r.elt=this;var r=r;r.next=n.head,n.head=r,n.modified=!0,n.length++;n=this.b2.arbiters;null==er.zpp_pool?o=new er:(o=er.zpp_pool,er.zpp_pool=o.next,o.next=null),o.elt=this;var o=o;o.next=n.head,n.head=o,n.modified=!0,n.length++,this.active=!0,this.present=0,this.cleared=!1,this.sleeping=!1,this.fresh=!1,this.presentable=!1},Qe.prototype.sup_retire=function(){if(!this.cleared){for(var t,e,i=this.b1.arbiters,n=null,r=i.head;null!=r;){if(r.elt==this){null==n?(e=(t=i.head).next,i.head=e,null==i.head&&(i.pushmod=!0)):(e=(t=n.next).next,null==(n.next=e)&&(i.pushmod=!0));var o=t;o.elt=null,o.next=er.zpp_pool,er.zpp_pool=o,i.modified=!0,i.length--,i.pushmod=!0;break}r=(n=r).next}for(var s,a,h=this.b2.arbiters,l=null,p=h.head;null!=p;){if(p.elt==this){null==l?(a=(s=h.head).next,h.head=a,null==h.head&&(h.pushmod=!0)):(a=(s=l.next).next,null==(l.next=a)&&(h.pushmod=!0));var u=s;u.elt=null,u.next=er.zpp_pool,er.zpp_pool=u,h.modified=!0,h.length--,h.pushmod=!0;break}p=(l=p).next}null!=this.pair&&(this.pair.arb=null,this.pair=null)}this.b1=this.b2=null,this.active=!1,this.intchange=!1},Qe.prototype.__class__=Qe;var Kn=zpp_nape.dynamics.ZPP_SensorArbiter=function(){this.next=null,Qe.call(this),this.type=Qe.SENSOR,this.sensorarb=this};Kn.__name__=["zpp_nape","dynamics","ZPP_SensorArbiter"],Kn.__super__=Qe,Kn.prototype=Object.create(Qe.prototype),Kn.prototype.next=null,Kn.prototype.alloc=function(){},Kn.prototype.free=function(){},Kn.prototype.assign=function(t,e,i,n){this.b1=t.body,this.ws1=t,this.b2=e.body,this.ws2=e,this.id=i,this.di=n;n=this.b1.arbiters;null==er.zpp_pool?r=new er:(r=er.zpp_pool,er.zpp_pool=r.next,r.next=null),r.elt=this;var r=r;r.next=n.head,n.head=r,n.modified=!0,n.length++;n=this.b2.arbiters;null==er.zpp_pool?o=new er:(o=er.zpp_pool,er.zpp_pool=o.next,o.next=null),o.elt=this;var o=o;o.next=n.head,n.head=o,n.modified=!0,n.length++,this.active=!0,this.present=0,this.cleared=!1,this.sleeping=!1,this.fresh=!1,this.presentable=!1},Kn.prototype.retire=function(){if(!this.cleared){for(var t,e,i=this.b1.arbiters,n=null,r=i.head;null!=r;){if(r.elt==this){null==n?(e=(t=i.head).next,i.head=e,null==i.head&&(i.pushmod=!0)):(e=(t=n.next).next,null==(n.next=e)&&(i.pushmod=!0));var o=t;o.elt=null,o.next=er.zpp_pool,er.zpp_pool=o,i.modified=!0,i.length--,i.pushmod=!0;break}r=(n=r).next}for(var s,a,h=this.b2.arbiters,l=null,p=h.head;null!=p;){if(p.elt==this){null==l?(a=(s=h.head).next,h.head=a,null==h.head&&(h.pushmod=!0)):(a=(s=l.next).next,null==(l.next=a)&&(h.pushmod=!0));var u=s;u.elt=null,u.next=er.zpp_pool,er.zpp_pool=u,h.modified=!0,h.length--,h.pushmod=!0;break}p=(l=p).next}null!=this.pair&&(this.pair.arb=null,this.pair=null)}this.b1=this.b2=null,this.active=!1,this.intchange=!1;this.next=Kn.zpp_pool,Kn.zpp_pool=this},Kn.prototype.makemutable=function(){},Kn.prototype.makeimmutable=function(){},Kn.prototype.__class__=Kn;var Zn=zpp_nape.dynamics.ZPP_FluidArbiter=function(){this.pre_dt=0,this.mutable=!1,this.wrap_position=null,this.buoyy=0,this.buoyx=0,this.ny=0,this.nx=0,this.lgamma=0,this.dampy=0,this.dampx=0,this.vMassc=0,this.vMassb=0,this.vMassa=0,this.agamma=0,this.adamp=0,this.wMass=0,this.nodrag=!1,this.r2y=0,this.r2x=0,this.r1y=0,this.r1x=0,this.overlap=0,this.centroidy=0,this.centroidx=0,this.next=null,this.outer_zn=null,Qe.call(this),this.type=Qe.FLUID,(this.fluidarb=this).buoyx=0,this.buoyy=0,this.pre_dt=-1};Zn.__name__=["zpp_nape","dynamics","ZPP_FluidArbiter"],Zn.__super__=Qe,Zn.prototype=Object.create(Qe.prototype),Zn.prototype.outer_zn=null,Zn.prototype.next=null,Zn.prototype.alloc=function(){},Zn.prototype.free=function(){},Zn.prototype.centroidx=null,Zn.prototype.centroidy=null,Zn.prototype.overlap=null,Zn.prototype.r1x=null,Zn.prototype.r1y=null,Zn.prototype.r2x=null,Zn.prototype.r2y=null,Zn.prototype.nodrag=null,Zn.prototype.wMass=null,Zn.prototype.adamp=null,Zn.prototype.agamma=null,Zn.prototype.vMassa=null,Zn.prototype.vMassb=null,Zn.prototype.vMassc=null,Zn.prototype.dampx=null,Zn.prototype.dampy=null,Zn.prototype.lgamma=null,Zn.prototype.nx=null,Zn.prototype.ny=null,Zn.prototype.buoyx=null,Zn.prototype.buoyy=null,Zn.prototype.position_validate=function(){this.wrap_position.zpp_inner.x=this.centroidx,this.wrap_position.zpp_inner.y=this.centroidy},Zn.prototype.position_invalidate=function(t){this.centroidx=t.x,this.centroidy=t.y},Zn.prototype.wrap_position=null,Zn.prototype.getposition=function(){var t,e,i;null==Bn.poolVec2?t=new St:(t=Bn.poolVec2,Bn.poolVec2=t.zpp_pool,t.zpp_pool=null),null==t.zpp_inner?(null==Gr.zpp_pool?e=new Gr:(e=Gr.zpp_pool,Gr.zpp_pool=e.next,e.next=null),e.weak=!1,e._immutable=!1,e.x=0,e.y=0,t.zpp_inner=e,t.zpp_inner.outer=t):(null!=(e=t.zpp_inner)._validate&&e._validate(),0==t.zpp_inner.x&&(null!=(i=t.zpp_inner)._validate&&i._validate(),0==t.zpp_inner.y)||(t.zpp_inner.x=0,t.zpp_inner.y=0,null!=(i=t.zpp_inner)._invalidate&&i._invalidate(i))),t.zpp_inner.weak=!1,this.wrap_position=t,this.wrap_position.zpp_inner._inuse=!0,this.wrap_position.zpp_inner._immutable=!this.mutable,this.wrap_position.zpp_inner._validate=Z(this,this.position_validate),this.wrap_position.zpp_inner._invalidate=Z(this,this.position_invalidate)},Zn.prototype.assign=function(t,e,i,n){this.b1=t.body,this.ws1=t,this.b2=e.body,this.ws2=e,this.id=i,this.di=n;n=this.b1.arbiters;null==er.zpp_pool?r=new er:(r=er.zpp_pool,er.zpp_pool=r.next,r.next=null),r.elt=this;var r=r;r.next=n.head,n.head=r,n.modified=!0,n.length++;n=this.b2.arbiters;null==er.zpp_pool?o=new er:(o=er.zpp_pool,er.zpp_pool=o.next,o.next=null),o.elt=this;var o=o;o.next=n.head,n.head=o,n.modified=!0,n.length++,this.active=!0,this.present=0,this.cleared=!1,this.sleeping=!1,this.fresh=!1,this.presentable=!1,this.nx=0,this.ny=1,this.dampx=0,this.dampy=0,this.adamp=0},Zn.prototype.retire=function(){if(!this.cleared){for(var t,e,i=this.b1.arbiters,n=null,r=i.head;null!=r;){if(r.elt==this){null==n?(e=(t=i.head).next,i.head=e,null==i.head&&(i.pushmod=!0)):(e=(t=n.next).next,null==(n.next=e)&&(i.pushmod=!0));var o=t;o.elt=null,o.next=er.zpp_pool,er.zpp_pool=o,i.modified=!0,i.length--,i.pushmod=!0;break}r=(n=r).next}for(var s,a,h=this.b2.arbiters,l=null,p=h.head;null!=p;){if(p.elt==this){null==l?(a=(s=h.head).next,h.head=a,null==h.head&&(h.pushmod=!0)):(a=(s=l.next).next,null==(l.next=a)&&(h.pushmod=!0));var u=s;u.elt=null,u.next=er.zpp_pool,er.zpp_pool=u,h.modified=!0,h.length--,h.pushmod=!0;break}p=(l=p).next}null!=this.pair&&(this.pair.arb=null,this.pair=null)}this.b1=this.b2=null,this.active=!1,this.intchange=!1;this.next=Zn.zpp_pool,(Zn.zpp_pool=this).pre_dt=-1},Zn.prototype.mutable=null,Zn.prototype.makemutable=function(){this.mutable=!0,null!=this.wrap_position&&(this.wrap_position.zpp_inner._immutable=!1)},Zn.prototype.makeimmutable=function(){this.mutable=!1,null!=this.wrap_position&&(this.wrap_position.zpp_inner._immutable=!0)},Zn.prototype.inject=function(t,e,i){this.overlap=t,this.centroidx=e,this.centroidy=i},Zn.prototype.pre_dt=null,Zn.prototype.preStep=function(t,e){-1==this.pre_dt&&(this.pre_dt=e);var i=e/this.pre_dt;this.pre_dt=e,this.r1x=this.centroidx-this.b1.posx,this.r1y=this.centroidy-this.b1.posy,this.r2x=this.centroidx-this.b2.posx,this.r2y=this.centroidy-this.b2.posy;var n,r,o,s,a,h=0,l=0,l=this.ws1.fluidEnabled&&null!=this.ws1.fluidProperties.wrap_gravity?(h=this.ws1.fluidProperties.gravityx,this.ws1.fluidProperties.gravityy):(h=t.gravityx,t.gravityy),p=0,u=0,u=this.ws2.fluidEnabled&&null!=this.ws2.fluidProperties.wrap_gravity?(p=this.ws2.fluidProperties.gravityx,this.ws2.fluidProperties.gravityy):(p=t.gravityx,t.gravityy),d=0,c=0;if(this.ws1.fluidEnabled&&this.ws2.fluidEnabled?(n=this.overlap*this.ws1.fluidProperties.density,(o=this.overlap*this.ws2.fluidProperties.density)<n?(d-=h*(s=n+o),c-=l*s):n<o?(d+=p*(r=n+o),c+=u*r):(s=t=0,t=h+p,s=l+u,this.ws1.worldCOMx*(t*=.5)+this.ws1.worldCOMy*(s*=.5)>this.ws2.worldCOMx*t+this.ws2.worldCOMy*s?(d-=t*(r=n+o),c-=s*r):(d+=t*(o=n+o),c+=s*o))):this.ws1.fluidEnabled?(d-=h*(h=this.overlap*this.ws1.fluidProperties.density),c-=l*h):this.ws2.fluidEnabled&&(d+=p*(a=this.overlap*this.ws2.fluidProperties.density),c+=u*a),c*=e,this.buoyx=d*=e,this.buoyy=c,2==this.b1.type&&(a=this.b1.imass,this.b1.velx-=d*a,this.b1.vely-=c*a,this.b1.angvel-=(c*this.r1x-d*this.r1y)*this.b1.iinertia),2==this.b2.type&&(y=this.b2.imass,this.b2.velx+=d*y,this.b2.vely+=c*y,this.b2.angvel+=(c*this.r2x-d*this.r2y)*this.b2.iinertia),this.ws1.fluidEnabled&&0!=this.ws1.fluidProperties.viscosity||this.ws2.fluidEnabled&&0!=this.ws2.fluidProperties.viscosity){this.nodrag=!1;var y=0;this.ws1.fluidEnabled&&(this.ws2.validate_angDrag(),y=this.ws1.fluidProperties.viscosity*this.ws2.angDrag*this.overlap/this.ws2.area),this.ws2.fluidEnabled&&(this.ws1.validate_angDrag(),y+=this.ws2.fluidProperties.viscosity*this.ws1.angDrag*this.overlap/this.ws1.area),0!=y?(v=this.b1.sinertia+this.b2.sinertia,this.wMass=0!=v?1/v:0,y*=4e-4,m=2*Math.PI*y,this.agamma=1/(e*m*(2+m*e)),x=1/(1+this.agamma),this.agamma*=x,this.wMass*=x):(this.wMass=0,this.agamma=0);c=this.b2.velx+this.b2.kinvelx-this.r2y*(this.b2.angvel+this.b2.kinangvel)-(this.b1.velx+this.b1.kinvelx-this.r1y*(this.b2.angvel+this.b2.kinangvel)),d=this.b2.vely+this.b2.kinvely+this.r2x*(this.b2.angvel+this.b2.kinangvel)-(this.b1.vely+this.b1.kinvely+this.r1x*(this.b1.angvel+this.b1.kinangvel));c*c+d*d<Er.epsilon*Er.epsilon||(d*=_=1/Math.sqrt(c*c+d*d),this.nx=c*=_,this.ny=d);var _,m,g,f,x,v=0;if(this.ws1.fluidEnabled){var w=-this.ws1.fluidProperties.viscosity*this.overlap/this.ws2.area;if(0==this.ws2.type)v=0-w*this.ws2.circle.radius*Er.fluidLinearDrag/(2*this.ws2.circle.radius*Math.PI);else{for(var z=0,b=0,S=this.ws2.polygon.edges.head;null!=S;){var C=S.elt;z+=C.length;C=w*C.length*(C.gnormx*this.nx+C.gnormy*this.ny);0<C&&(C*=-Er.fluidVacuumDrag),b-=.5*C*Er.fluidLinearDrag,S=S.next}v=b/z}}if(this.ws2.fluidEnabled){var P=-this.ws2.fluidProperties.viscosity*this.overlap/this.ws1.area;if(0==this.ws1.type)v-=P*this.ws1.circle.radius*Er.fluidLinearDrag/(2*this.ws1.circle.radius*Math.PI);else{for(var M=0,T=0,A=this.ws1.polygon.edges.head;null!=A;){var k=A.elt;M+=k.length;k=P*k.length*(k.gnormx*this.nx+k.gnormy*this.ny);0<k&&(k*=-Er.fluidVacuumDrag),T-=.5*k*Er.fluidLinearDrag,A=A.next}v+=T/M}}0!=v?(x=m=y=0,x=y=_=this.b1.smass+this.b2.smass,(m=0)!=this.b1.sinertia&&(c=this.r1x*this.b1.sinertia,y=_+(d=this.r1y*this.b1.sinertia)*this.r1y,m+=-d*this.r1x,x=_+c*this.r1x),0!=this.b2.sinertia&&(f=this.r2x*this.b2.sinertia,y+=(g=this.r2y*this.b2.sinertia)*this.r2y,m+=-g*this.r2x,x+=f*this.r2x),(g=y*x-m*m)!=g?y=m=x=0:0==g?(y=0!=y?1/y:0,x=0!=x?1/x:0,m=0):(f=x*(g=1/g),x=y*g,y=f,m*=-g),this.vMassa=y,this.vMassb=m,this.vMassc=x,v=2*Math.PI*v,this.lgamma=1/(e*v*(2+v*e)),e=1/(1+this.lgamma),this.lgamma*=e,this.vMassa*=e,this.vMassb*=e,this.vMassc*=e):(this.vMassa=0,this.vMassb=0,this.vMassc=0,this.lgamma=0)}else this.nodrag=!0,this.dampx=0,this.dampy=0,this.adamp=0;this.dampx*=i,this.dampy*=i,this.adamp*=i},Zn.prototype.warmStart=function(){var t=this.b1.imass;this.b1.velx-=this.dampx*t,this.b1.vely-=this.dampy*t;t=this.b2.imass;this.b2.velx+=this.dampx*t,this.b2.vely+=this.dampy*t,this.b1.angvel-=this.b1.iinertia*(this.dampy*this.r1x-this.dampx*this.r1y),this.b2.angvel+=this.b2.iinertia*(this.dampy*this.r2x-this.dampx*this.r2y),this.b1.angvel-=this.adamp*this.b1.iinertia,this.b2.angvel+=this.adamp*this.b2.iinertia},Zn.prototype.applyImpulseVel=function(){var t,e,i,n,r;this.nodrag||(t=this.b1.angvel+this.b1.kinangvel,r=this.b2.angvel+this.b2.kinangvel,i=this.b1.velx+this.b1.kinvelx-this.r1y*t-(this.b2.velx+this.b2.kinvelx-this.r2y*r),e=this.b1.vely+this.b1.kinvely+this.r1x*t-(this.b2.vely+this.b2.kinvely+this.r2x*r),n=this.vMassa*i+this.vMassb*e,e=this.vMassb*i+this.vMassc*e,i=n,n=this.lgamma,i-=this.dampx*n,e-=this.dampy*n,this.dampx+=i,this.dampy+=e,n=this.b1.imass,this.b1.velx-=i*n,this.b1.vely-=e*n,n=this.b2.imass,this.b2.velx+=i*n,this.b2.vely+=e*n,this.b1.angvel-=this.b1.iinertia*(e*this.r1x-i*this.r1y),this.b2.angvel+=this.b2.iinertia*(e*this.r2x-i*this.r2y),r=(t-r)*this.wMass-this.adamp*this.agamma,this.adamp+=r,this.b1.angvel-=r*this.b1.iinertia,this.b2.angvel+=r*this.b2.iinertia)},Zn.prototype.__class__=Zn;var Jn=zpp_nape.dynamics.ZPP_ColArbiter=function(){this.pre_dt=0,this.mutable=!1,this.stat=!1,this.next=null,this.hpc2=!1,this.hc2=!1,this.oc2=null,this.c2=null,this.oc1=null,this.c1=null,this.__ref_vertex=0,this.__ref_edge2=null,this.__ref_edge1=null,this.biasCoef=0,this.rev=!1,this.radius=0,this.lproj=0,this.lnormy=0,this.lnormx=0,this.surfacey=0,this.surfacex=0,this.k2y=0,this.k2x=0,this.k1y=0,this.k1x=0,this.rt2b=0,this.rn2b=0,this.rt2a=0,this.rn2a=0,this.rt1b=0,this.rn1b=0,this.rt1a=0,this.rn1a=0,this.jrAcc=0,this.rMass=0,this.Kc=0,this.Kb=0,this.Ka=0,this.kMassc=0,this.kMassb=0,this.kMassa=0,this.wrap_normal=null,this.ny=0,this.nx=0,this.innards=null,this.wrap_contacts=null,this.contacts=null,this.s2=null,this.s1=null,this.userdef_rfric=!1,this.userdef_restitution=!1,this.userdef_stat_fric=!1,this.userdef_dyn_fric=!1,this.rfric=0,this.restitution=0,this.stat_fric=0,this.dyn_fric=0,this.outer_zn=null,Qe.call(this),this.pre_dt=-1,this.contacts=new Qn,this.innards=new ae,this.type=Qe.COL,this.colarb=this};Jn.__name__=["zpp_nape","dynamics","ZPP_ColArbiter"],Jn.__super__=Qe,Jn.prototype=Object.create(Qe.prototype),Jn.prototype.outer_zn=null,Jn.prototype.dyn_fric=null,Jn.prototype.stat_fric=null,Jn.prototype.restitution=null,Jn.prototype.rfric=null,Jn.prototype.userdef_dyn_fric=null,Jn.prototype.userdef_stat_fric=null,Jn.prototype.userdef_restitution=null,Jn.prototype.userdef_rfric=null,Jn.prototype.s1=null,Jn.prototype.s2=null,Jn.prototype.contacts=null,Jn.prototype.wrap_contacts=null,Jn.prototype.innards=null,Jn.prototype.nx=null,Jn.prototype.ny=null,Jn.prototype.normal_validate=function(){if(this.cleared)throw new r("Error: Arbiter not currently in use");this.wrap_normal.zpp_inner.x=this.nx,this.wrap_normal.zpp_inner.y=this.ny,this.ws1.id>this.ws2.id&&(this.wrap_normal.zpp_inner.x=-this.wrap_normal.zpp_inner.x,this.wrap_normal.zpp_inner.y=-this.wrap_normal.zpp_inner.y)},Jn.prototype.wrap_normal=null,Jn.prototype.getnormal=function(){var t,e,i;null==Bn.poolVec2?t=new St:(t=Bn.poolVec2,Bn.poolVec2=t.zpp_pool,t.zpp_pool=null),null==t.zpp_inner?(null==Gr.zpp_pool?e=new Gr:(e=Gr.zpp_pool,Gr.zpp_pool=e.next,e.next=null),e.weak=!1,e._immutable=!1,e.x=0,e.y=0,t.zpp_inner=e,t.zpp_inner.outer=t):(null!=(e=t.zpp_inner)._validate&&e._validate(),0==t.zpp_inner.x&&(null!=(i=t.zpp_inner)._validate&&i._validate(),0==t.zpp_inner.y)||(t.zpp_inner.x=0,t.zpp_inner.y=0,null!=(i=t.zpp_inner)._invalidate&&i._invalidate(i))),t.zpp_inner.weak=!1,this.wrap_normal=t,this.wrap_normal.zpp_inner._immutable=!0,this.wrap_normal.zpp_inner._inuse=!0,this.wrap_normal.zpp_inner._validate=Z(this,this.normal_validate)},Jn.prototype.kMassa=null,Jn.prototype.kMassb=null,Jn.prototype.kMassc=null,Jn.prototype.Ka=null,Jn.prototype.Kb=null,Jn.prototype.Kc=null,Jn.prototype.rMass=null,Jn.prototype.jrAcc=null,Jn.prototype.rn1a=null,Jn.prototype.rt1a=null,Jn.prototype.rn1b=null,Jn.prototype.rt1b=null,Jn.prototype.rn2a=null,Jn.prototype.rt2a=null,Jn.prototype.rn2b=null,Jn.prototype.rt2b=null,Jn.prototype.k1x=null,Jn.prototype.k1y=null,Jn.prototype.k2x=null,Jn.prototype.k2y=null,Jn.prototype.surfacex=null,Jn.prototype.surfacey=null,Jn.prototype.ptype=null,Jn.prototype.lnormx=null,Jn.prototype.lnormy=null,Jn.prototype.lproj=null,Jn.prototype.radius=null,Jn.prototype.rev=null,Jn.prototype.biasCoef=null,Jn.prototype.__ref_edge1=null,Jn.prototype.__ref_edge2=null,Jn.prototype.__ref_vertex=null,Jn.prototype.c1=null,Jn.prototype.oc1=null,Jn.prototype.c2=null,Jn.prototype.oc2=null,Jn.prototype.hc2=null,Jn.prototype.hpc2=null,Jn.prototype.next=null,Jn.prototype.alloc=function(){},Jn.prototype.free=function(){this.userdef_dyn_fric=!1,this.userdef_stat_fric=!1,this.userdef_restitution=!1,this.userdef_rfric=!1,this.__ref_edge1=this.__ref_edge2=null},Jn.prototype.stat=null,Jn.prototype.injectContact=function(t,e,i,n,r,o,s){null==s&&(s=!1);for(var a,h,l,p=null,u=this.contacts.next;null!=u;){var d=u;if(o==d.hash){p=d;break}u=u.next}return null==p?(null==Qn.zpp_pool?p=new Qn:(p=Qn.zpp_pool,Qn.zpp_pool=p.next,p.next=null),(a=p.inner).jnAcc=a.jtAcc=0,p.hash=o,p.fresh=!0,(p.arbiter=this).jrAcc=0,h=this.contacts,p._inuse=!0,(l=p).next=h.next,h.next=l,h.modified=!0,h.length++,this.innards.add(a)):p.fresh=!1,p.px=t,p.py=e,this.nx=i,this.ny=n,p.dist=r,p.stamp=this.stamp,p.posOnly=s,p},Jn.prototype.assign=function(t,e,i,n){this.b1=t.body,this.ws1=t,this.b2=e.body,this.ws2=e,this.id=i,this.di=n;n=this.b1.arbiters;null==er.zpp_pool?r=new er:(r=er.zpp_pool,er.zpp_pool=r.next,r.next=null),r.elt=this;var r=r;r.next=n.head,n.head=r,n.modified=!0,n.length++;n=this.b2.arbiters;null==er.zpp_pool?o=new er:(o=er.zpp_pool,er.zpp_pool=o.next,o.next=null),o.elt=this;var o=o;o.next=n.head,n.head=o,n.modified=!0,n.length++,this.active=!0,this.present=0,this.cleared=!1,this.sleeping=!1,this.fresh=!1,this.presentable=!1,this.s1=t,this.s2=e,this.userdef_restitution||(this.s1.material.elasticity<=-1/0||this.s2.material.elasticity<=-1/0?this.restitution=0:this.s1.material.elasticity>=1/0||this.s2.material.elasticity>=1/0?this.restitution=1:this.restitution=(this.s1.material.elasticity+this.s2.material.elasticity)/2,this.restitution<0&&(this.restitution=0),1<this.restitution&&(this.restitution=1)),this.userdef_dyn_fric||(this.dyn_fric=Math.sqrt(this.s1.material.dynamicFriction*this.s2.material.dynamicFriction)),this.userdef_stat_fric||(this.stat_fric=Math.sqrt(this.s1.material.staticFriction*this.s2.material.staticFriction)),this.userdef_rfric||(this.rfric=Math.sqrt(this.s1.material.rollingFriction*this.s2.material.rollingFriction))},Jn.prototype.calcProperties=function(){this.userdef_restitution||(this.s1.material.elasticity<=-1/0||this.s2.material.elasticity<=-1/0?this.restitution=0:this.s1.material.elasticity>=1/0||this.s2.material.elasticity>=1/0?this.restitution=1:this.restitution=(this.s1.material.elasticity+this.s2.material.elasticity)/2,this.restitution<0&&(this.restitution=0),1<this.restitution&&(this.restitution=1)),this.userdef_dyn_fric||(this.dyn_fric=Math.sqrt(this.s1.material.dynamicFriction*this.s2.material.dynamicFriction)),this.userdef_stat_fric||(this.stat_fric=Math.sqrt(this.s1.material.staticFriction*this.s2.material.staticFriction)),this.userdef_rfric||(this.rfric=Math.sqrt(this.s1.material.rollingFriction*this.s2.material.rollingFriction))},Jn.prototype.validate_props=function(){this.invalidated&&(this.invalidated=!1,this.userdef_restitution||(this.s1.material.elasticity<=-1/0||this.s2.material.elasticity<=-1/0?this.restitution=0:this.s1.material.elasticity>=1/0||this.s2.material.elasticity>=1/0?this.restitution=1:this.restitution=(this.s1.material.elasticity+this.s2.material.elasticity)/2,this.restitution<0&&(this.restitution=0),1<this.restitution&&(this.restitution=1)),this.userdef_dyn_fric||(this.dyn_fric=Math.sqrt(this.s1.material.dynamicFriction*this.s2.material.dynamicFriction)),this.userdef_stat_fric||(this.stat_fric=Math.sqrt(this.s1.material.staticFriction*this.s2.material.staticFriction)),this.userdef_rfric||(this.rfric=Math.sqrt(this.s1.material.rollingFriction*this.s2.material.rollingFriction)))},Jn.prototype.retire=function(){if(!this.cleared){for(var t,e,i=this.b1.arbiters,n=null,r=i.head;null!=r;){if(r.elt==this){null==n?(e=(t=i.head).next,i.head=e,null==i.head&&(i.pushmod=!0)):(e=(t=n.next).next,null==(n.next=e)&&(i.pushmod=!0));var o=t;o.elt=null,o.next=er.zpp_pool,er.zpp_pool=o,i.modified=!0,i.length--,i.pushmod=!0;break}r=(n=r).next}for(var s,a,h=this.b2.arbiters,l=null,p=h.head;null!=p;){if(p.elt==this){null==l?(a=(s=h.head).next,h.head=a,null==h.head&&(h.pushmod=!0)):(a=(s=l.next).next,null==(l.next=a)&&(h.pushmod=!0));var u=s;u.elt=null,u.next=er.zpp_pool,er.zpp_pool=u,h.modified=!0,h.length--,h.pushmod=!0;break}p=(l=p).next}null!=this.pair&&(this.pair.arb=null,this.pair=null)}for(this.b1=this.b2=null,this.active=!1,this.intchange=!1;null!=this.contacts.next;){var d=this.contacts,c=d.next;d.pop(),c.arbiter=null,c.next=Qn.zpp_pool,Qn.zpp_pool=c;d=this.innards,c=d.next;d.next=c.next,c._inuse=!1,null==d.next&&(d.pushmod=!0),d.modified=!0,d.length--}this.userdef_dyn_fric=!1,this.userdef_stat_fric=!1,this.userdef_restitution=!1,this.userdef_rfric=!1,this.__ref_edge1=this.__ref_edge2=null,this.next=Jn.zpp_pool,(Jn.zpp_pool=this).pre_dt=-1},Jn.prototype.mutable=null,Jn.prototype.makemutable=function(){this.mutable=!0,null!=this.wrap_normal&&(this.wrap_normal.zpp_inner._immutable=!1),null!=this.wrap_contacts&&(this.wrap_contacts.zpp_inner.immutable=!1)},Jn.prototype.makeimmutable=function(){this.mutable=!1,null!=this.wrap_normal&&(this.wrap_normal.zpp_inner._immutable=!0),null!=this.wrap_contacts&&(this.wrap_contacts.zpp_inner.immutable=!0)},Jn.prototype.contacts_adder=function(t){return!1},Jn.prototype.contacts_subber=function(t){for(var e=null,i=null,n=this.innards.next,r=this.contacts.next;null!=r;){var o=r;if(o==t.zpp_inner){this.contacts.erase(e),this.innards.erase(i),o.arbiter=null,o.next=Qn.zpp_pool,Qn.zpp_pool=o;break}e=r,n=(i=n).next,r=r.next}},Jn.prototype.setupcontacts=function(){this.wrap_contacts=Ln.get(this.contacts,!0),this.wrap_contacts.zpp_inner.immutable=!this.mutable,this.wrap_contacts.zpp_inner.adder=Z(this,this.contacts_adder),this.wrap_contacts.zpp_inner.dontremove=!0,this.wrap_contacts.zpp_inner.subber=Z(this,this.contacts_subber)},Jn.prototype.cleanupContacts=function(){var t=!0,e=null,i=null,n=this.innards.next;this.hc2=!1;for(var r,o=this.contacts.next;null!=o;){var s,a,h,l,p,u,d=o;d.stamp+Er.arbiterExpirationDelay<this.stamp?(p=this.contacts,null==e?(a=(s=p.next).next,p.next=a,null==p.next&&(p.pushmod=!0)):(a=(s=e.next).next,null==(e.next=a)&&(p.pushmod=!0)),s._inuse=!1,p.modified=!0,p.length--,p.pushmod=!0,o=a,u=this.innards,null==i?(l=(h=u.next).next,u.next=l,null==u.next&&(u.pushmod=!0)):(l=(h=i.next).next,null==(i.next=l)&&(u.pushmod=!0)),h._inuse=!1,u.modified=!0,u.length--,u.pushmod=!0,n=l,d.arbiter=null,d.next=Qn.zpp_pool,Qn.zpp_pool=d):(p=d.inner,u=d.active,d.active=d.stamp==this.stamp,d.active&&(t?(t=!1,this.c1=p,this.oc1=d):(this.hc2=!0,this.c2=p,this.oc2=d)),u!=d.active&&(this.contacts.modified=!0),e=o,n=(i=n).next,o=o.next)}return this.hc2?(this.hpc2=!0,this.oc1.posOnly?(r=this.c1,this.c1=this.c2,this.c2=r,r=this.oc1,this.oc1=this.oc2,this.oc2=r,this.hc2=!1):this.oc2.posOnly&&(this.hc2=!1),this.oc1.posOnly&&(t=!0)):this.hpc2=!1,t},Jn.prototype.pre_dt=null,Jn.prototype.preStep=function(t){this.invalidated&&(this.invalidated=!1,this.userdef_restitution||(this.s1.material.elasticity<=-1/0||this.s2.material.elasticity<=-1/0?this.restitution=0:this.s1.material.elasticity>=1/0||this.s2.material.elasticity>=1/0?this.restitution=1:this.restitution=(this.s1.material.elasticity+this.s2.material.elasticity)/2,this.restitution<0&&(this.restitution=0),1<this.restitution&&(this.restitution=1)),this.userdef_dyn_fric||(this.dyn_fric=Math.sqrt(this.s1.material.dynamicFriction*this.s2.material.dynamicFriction)),this.userdef_stat_fric||(this.stat_fric=Math.sqrt(this.s1.material.staticFriction*this.s2.material.staticFriction)),this.userdef_rfric||(this.rfric=Math.sqrt(this.s1.material.rollingFriction*this.s2.material.rollingFriction))),-1==this.pre_dt&&(this.pre_dt=t);var e=t/this.pre_dt;this.pre_dt=t;var i=this.b1.smass+this.b2.smass,n=!(this.hc2=!1);this.biasCoef=2!=this.b1.type||2!=this.b2.type?this.continuous?Er.contactContinuousStaticBiasCoef:Er.contactStaticBiasCoef:this.continuous?Er.contactContinuousBiasCoef:Er.contactBiasCoef,this.continuous=!1;for(var r,o,s=null,a=null,h=this.innards.next,l=this.contacts.next;null!=l;){var p,u,d,c,y,_,m,g,f,x=l;x.stamp+Er.arbiterExpirationDelay<this.stamp?(m=this.contacts,null==s?(u=(p=m.next).next,m.next=u,null==m.next&&(m.pushmod=!0)):(u=(p=s.next).next,null==(s.next=u)&&(m.pushmod=!0)),p._inuse=!1,m.modified=!0,m.length--,m.pushmod=!0,l=u,g=this.innards,null==a?(c=(d=g.next).next,g.next=c,null==g.next&&(g.pushmod=!0)):(c=(d=a.next).next,null==(a.next=c)&&(g.pushmod=!0)),d._inuse=!1,g.modified=!0,g.length--,g.pushmod=!0,h=c,x.arbiter=null,x.next=Qn.zpp_pool,Qn.zpp_pool=x):(y=x.inner,_=x.active,x.active=x.stamp==this.stamp,x.active&&(n?(n=!1,this.c1=y,this.oc1=x):(this.hc2=!0,this.c2=y,this.oc2=x),y.r2x=x.px-this.b2.posx,y.r2y=x.py-this.b2.posy,y.r1x=x.px-this.b1.posx,y.r1y=x.py-this.b1.posy,f=y.r2x*this.nx+y.r2y*this.ny,m=i+this.b2.sinertia*(f*f),g=y.r1x*this.nx+y.r1y*this.ny,m+=this.b1.sinertia*(g*g),y.tMass=m<Er.epsilon*Er.epsilon?0:1/m,f=this.ny*y.r2x-this.nx*y.r2y,g=i+this.b2.sinertia*(f*f),m=this.ny*y.r1x-this.nx*y.r1y,g+=this.b1.sinertia*(m*m),y.nMass=g<Er.epsilon*Er.epsilon?0:1/g,m=f=0,g=this.b2.angvel+this.b2.kinangvel,f=this.b2.velx+this.b2.kinvelx-y.r2y*g,m=this.b2.vely+this.b2.kinvely+y.r2x*g,g=this.b1.angvel+this.b1.kinangvel,f-=this.b1.velx+this.b1.kinvelx-y.r1y*g,m-=this.b1.vely+this.b1.kinvely+y.r1x*g,g=this.nx*f+this.ny*m,x.elasticity=this.restitution,y.bounce=g*x.elasticity,y.bounce>-Er.elasticThreshold&&(y.bounce=0),g=m*this.nx-f*this.ny,y.friction=(f=Er.staticFrictionThreshold)*f<g*g?this.dyn_fric:this.stat_fric,y.jnAcc*=e,y.jtAcc*=e),_!=x.active&&(this.contacts.modified=!0),s=l,h=(a=h).next,l=l.next)}return this.hc2?(this.hpc2=!0,this.oc1.posOnly?(r=this.c1,this.c1=this.c2,this.c2=r,r=this.oc1,this.oc1=this.oc2,this.oc2=r,this.hc2=!1):this.oc2.posOnly&&(this.hc2=!1),this.oc1.posOnly&&(n=!0)):this.hpc2=!1,this.jrAcc*=e,n||(this.rn1a=this.ny*this.c1.r1x-this.nx*this.c1.r1y,this.rt1a=this.c1.r1x*this.nx+this.c1.r1y*this.ny,this.rn1b=this.ny*this.c1.r2x-this.nx*this.c1.r2y,this.rt1b=this.c1.r2x*this.nx+this.c1.r2y*this.ny,this.k1x=this.b2.kinvelx-this.c1.r2y*this.b2.kinangvel-(this.b1.kinvelx-this.c1.r1y*this.b1.kinangvel),this.k1y=this.b2.kinvely+this.c1.r2x*this.b2.kinangvel-(this.b1.kinvely+this.c1.r1x*this.b1.kinangvel)),this.hc2&&(this.rn2a=this.ny*this.c2.r1x-this.nx*this.c2.r1y,this.rt2a=this.c2.r1x*this.nx+this.c2.r1y*this.ny,this.rn2b=this.ny*this.c2.r2x-this.nx*this.c2.r2y,this.rt2b=this.c2.r2x*this.nx+this.c2.r2y*this.ny,this.k2x=this.b2.kinvelx-this.c2.r2y*this.b2.kinangvel-(this.b1.kinvelx-this.c2.r1y*this.b1.kinangvel),this.k2y=this.b2.kinvely+this.c2.r2x*this.b2.kinangvel-(this.b1.kinvely+this.c2.r1x*this.b1.kinangvel),this.kMassa=i+this.b1.sinertia*this.rn1a*this.rn1a+this.b2.sinertia*this.rn1b*this.rn1b,this.kMassb=i+this.b1.sinertia*this.rn1a*this.rn2a+this.b2.sinertia*this.rn1b*this.rn2b,this.kMassc=i+this.b1.sinertia*this.rn2a*this.rn2a+this.b2.sinertia*this.rn2b*this.rn2b,this.kMassa*this.kMassa+2*this.kMassb*this.kMassb+this.kMassc*this.kMassc<Er.illConditionedThreshold*(this.kMassa*this.kMassc-this.kMassb*this.kMassb)?(this.Ka=this.kMassa,this.Kb=this.kMassb,this.Kc=this.kMassc,(o=this.kMassa*this.kMassc-this.kMassb*this.kMassb)!=o?this.kMassa=this.kMassb=this.kMassc=0:0==o?(0!=this.kMassa?this.kMassa=1/this.kMassa:this.kMassa=0,0!=this.kMassc?this.kMassc=1/this.kMassc:this.kMassc=0,this.kMassb=0):(r=this.kMassc*(o=1/o),this.kMassc=this.kMassa*o,this.kMassa=r,this.kMassb*=-o)):(this.hc2=!1,this.oc2.dist<this.oc1.dist&&(o=this.c1,this.c1=this.c2,this.c2=o),this.oc2.active=!1,this.contacts.modified=!0)),this.surfacex=this.b2.svelx,this.surfacey=this.b2.svely,this.surfacex+=this.b1.svelx,this.surfacey+=this.b1.svely,this.surfacex=-this.surfacex,this.surfacey=-this.surfacey,this.rMass=this.b1.sinertia+this.b2.sinertia,0!=this.rMass&&(this.rMass=1/this.rMass),n},Jn.prototype.warmStart=function(){var t=this.nx*this.c1.jnAcc-this.ny*this.c1.jtAcc,e=this.ny*this.c1.jnAcc+this.nx*this.c1.jtAcc,i=this.b1.imass;this.b1.velx-=t*i,this.b1.vely-=e*i,this.b1.angvel-=this.b1.iinertia*(e*this.c1.r1x-t*this.c1.r1y);var i=this.b2.imass;this.b2.velx+=t*i,this.b2.vely+=e*i,this.b2.angvel+=this.b2.iinertia*(e*this.c1.r2x-t*this.c1.r2y),this.hc2&&(i=this.nx*this.c2.jnAcc-this.ny*this.c2.jtAcc,e=this.ny*this.c2.jnAcc+this.nx*this.c2.jtAcc,t=this.b1.imass,this.b1.velx-=i*t,this.b1.vely-=e*t,this.b1.angvel-=this.b1.iinertia*(e*this.c2.r1x-i*this.c2.r1y),t=this.b2.imass,this.b2.velx+=i*t,this.b2.vely+=e*t,this.b2.angvel+=this.b2.iinertia*(e*this.c2.r2x-i*this.c2.r2y)),this.b2.angvel+=this.jrAcc*this.b2.iinertia,this.b1.angvel-=this.jrAcc*this.b1.iinertia},Jn.prototype.applyImpulseVel=function(){var t,e,i,n,r,o,s,a,h,l,p,u,d=this.k1x+this.b2.velx-this.c1.r2y*this.b2.angvel-(this.b1.velx-this.c1.r1y*this.b1.angvel),c=this.k1y+this.b2.vely+this.c1.r2x*this.b2.angvel-(this.b1.vely+this.c1.r1x*this.b1.angvel);i=(c*this.nx-d*this.ny+this.surfacex)*this.c1.tMass,(n=this.c1.friction*this.c1.jnAcc)<(o=(r=this.c1.jtAcc)-i)?o=n:o<-n&&(o=-n),i=o-r,this.c1.jtAcc=o,t=-this.ny*i,e=this.nx*i,this.b2.velx+=t*this.b2.imass,this.b2.vely+=e*this.b2.imass,this.b1.velx-=t*this.b1.imass,this.b1.vely-=e*this.b1.imass,this.b2.angvel+=this.rt1b*i*this.b2.iinertia,this.b1.angvel-=this.rt1a*i*this.b1.iinertia,this.hc2?(p=this.k2x+this.b2.velx-this.c2.r2y*this.b2.angvel-(this.b1.velx-this.c2.r1y*this.b1.angvel),i=((u=this.k2y+this.b2.vely+this.c2.r2x*this.b2.angvel-(this.b1.vely+this.c2.r1x*this.b1.angvel))*this.nx-p*this.ny+this.surfacex)*this.c2.tMass,(n=this.c2.friction*this.c2.jnAcc)<(o=(r=this.c2.jtAcc)-i)?o=n:o<-n&&(o=-n),i=o-r,this.c2.jtAcc=o,t=-this.ny*i,e=this.nx*i,this.b2.velx+=t*this.b2.imass,this.b2.vely+=e*this.b2.imass,this.b1.velx-=t*this.b1.imass,this.b1.vely-=e*this.b1.imass,this.b2.angvel+=this.rt2b*i*this.b2.iinertia,this.b1.angvel-=this.rt2a*i*this.b1.iinertia,d=this.k1x+this.b2.velx-this.c1.r2y*this.b2.angvel-(this.b1.velx-this.c1.r1y*this.b1.angvel),c=this.k1y+this.b2.vely+this.c1.r2x*this.b2.angvel-(this.b1.vely+this.c1.r1x*this.b1.angvel),p=this.k2x+this.b2.velx-this.c2.r2y*this.b2.angvel-(this.b1.velx-this.c2.r1y*this.b1.angvel),u=this.k2y+this.b2.vely+this.c2.r2x*this.b2.angvel-(this.b1.vely+this.c2.r1x*this.b1.angvel),s=this.c1.jnAcc,a=this.c2.jnAcc,h=d*this.nx+c*this.ny+this.surfacey+this.c1.bounce-(this.Ka*s+this.Kb*a),l=p*this.nx+u*this.ny+this.surfacey+this.c2.bounce-(this.Kb*s+this.Kc*a),p=-(this.kMassa*h+this.kMassb*l),u=-(this.kMassb*h+this.kMassc*l),0<=p&&0<=u?(h=p-s,l=u-a,this.c1.jnAcc=p,this.c2.jnAcc=u):0<=(p=-this.c1.nMass*h)&&0<=this.Kb*p+l?(h=p-s,l=-a,this.c1.jnAcc=p,this.c2.jnAcc=0):0<=(u=-this.c2.nMass*l)&&0<=this.Kb*u+h?(h=-s,l=u-a,this.c1.jnAcc=0,this.c2.jnAcc=u):0<=h&&0<=l?(h=-s,l=-a,this.c1.jnAcc=this.c2.jnAcc=0):l=h=0,t=this.nx*(i=h+l),e=this.ny*i,this.b2.velx+=t*this.b2.imass,this.b2.vely+=e*this.b2.imass,this.b1.velx-=t*this.b1.imass,this.b1.vely-=e*this.b1.imass,this.b2.angvel+=(this.rn1b*h+this.rn2b*l)*this.b2.iinertia,this.b1.angvel-=(this.rn1a*h+this.rn2a*l)*this.b1.iinertia):(0!=this.radius&&(i=(this.b2.angvel-this.b1.angvel)*this.rMass,n=this.rfric*this.c1.jnAcc,r=this.jrAcc,this.jrAcc-=i,this.jrAcc>n?this.jrAcc=n:this.jrAcc<-n&&(this.jrAcc=-n),i=this.jrAcc-r,this.b2.angvel+=i*this.b2.iinertia,this.b1.angvel-=i*this.b1.iinertia),d=this.k1x+this.b2.velx-this.c1.r2y*this.b2.angvel-(this.b1.velx-this.c1.r1y*this.b1.angvel),c=this.k1y+this.b2.vely+this.c1.r2x*this.b2.angvel-(this.b1.vely+this.c1.r1x*this.b1.angvel),i=(this.c1.bounce+(this.nx*d+this.ny*c)+this.surfacey)*this.c1.nMass,i=(o=(o=(r=this.c1.jnAcc)-i)<0?0:o)-r,this.c1.jnAcc=o,t=this.nx*i,e=this.ny*i,this.b2.velx+=t*this.b2.imass,this.b2.vely+=e*this.b2.imass,this.b1.velx-=t*this.b1.imass,this.b1.vely-=e*this.b1.imass,this.b2.angvel+=this.rn1b*i*this.b2.iinertia,this.b1.angvel-=this.rn1a*i*this.b1.iinertia)},Jn.prototype.applyImpulsePos=function(){if(2==this.ptype){var t=this.c1,e=0,i=0;e=this.b2.axisy*t.lr2x-this.b2.axisx*t.lr2y,i=t.lr2x*this.b2.axisx+t.lr2y*this.b2.axisy,e+=this.b2.posx,i+=this.b2.posy;var n=0,r=0;n=this.b1.axisy*t.lr1x-this.b1.axisx*t.lr1y,r=t.lr1x*this.b1.axisx+t.lr1y*this.b1.axisy;var o=0,s=0,o=e-(n+=this.b1.posx),s=i-(r+=this.b1.posy),a=Math.sqrt(o*o+s*s),h=this.radius-Er.collisionSlop,l=a-h;o*this.nx+s*this.ny<0&&(o=-o,s=-s,l-=this.radius),l<0&&(a<Er.epsilon?0!=this.b1.smass?this.b1.posx+=10*Er.epsilon:this.b2.posx+=10*Er.epsilon:(r=(s*=t=1/a)*(n=(l=.5*(n+e))-this.b1.posx)-(o*=t)*(r=(t=.5*(r+i))-this.b1.posy),e=s*(e=l-this.b2.posx)-o*(i=t-this.b2.posy),0!=(t=this.b2.smass+e*e*this.b2.sinertia+this.b1.smass+r*r*this.b1.sinertia)&&(g=i=0,g=s*(d=-this.biasCoef*(a-h)/t),h=this.b1.imass,this.b1.posx-=(i=o*d)*h,this.b1.posy-=g*h,t=this.b1,o=-r*this.b1.iinertia*d,t.rot+=o,1e-4<o*o?(t.axisx=Math.sin(t.rot),t.axisy=Math.cos(t.rot)):(_=((h=1-.5*(_=o*o))*t.axisx+o*t.axisy)*(r=1-_*_/8),t.axisy=(h*t.axisy-o*t.axisx)*r,t.axisx=_),_=this.b2.imass,this.b2.posx+=i*_,this.b2.posy+=g*_,g=this.b2,_=e*this.b2.iinertia*d,g.rot+=_,1e-4<_*_?(g.axisx=Math.sin(g.rot),g.axisy=Math.cos(g.rot)):(f=((y=1-.5*(c=_*_))*g.axisx+_*g.axisy)*(m=1-c*c/8),g.axisy=(y*g.axisy-_*g.axisx)*m,g.axisx=f))))}else{var p=0,u=0,d=0,c=0,y=0,_=0;0==this.ptype?(p=this.b1.axisy*this.lnormx-this.b1.axisx*this.lnormy,u=this.lnormx*this.b1.axisx+this.lnormy*this.b1.axisy,x=this.lproj+(p*this.b1.posx+u*this.b1.posy),d=this.b2.axisy*this.c1.lr1x-this.b2.axisx*this.c1.lr1y,c=this.c1.lr1x*this.b2.axisx+this.c1.lr1y*this.b2.axisy,d+=this.b2.posx,c+=this.b2.posy,this.hpc2&&(y=this.b2.axisy*this.c2.lr1x-this.b2.axisx*this.c2.lr1y,_=this.c2.lr1x*this.b2.axisx+this.c2.lr1y*this.b2.axisy,y+=this.b2.posx,_+=this.b2.posy)):(p=this.b2.axisy*this.lnormx-this.b2.axisx*this.lnormy,u=this.lnormx*this.b2.axisx+this.lnormy*this.b2.axisy,x=this.lproj+(p*this.b2.posx+u*this.b2.posy),d=this.b1.axisy*this.c1.lr1x-this.b1.axisx*this.c1.lr1y,c=this.c1.lr1x*this.b1.axisx+this.c1.lr1y*this.b1.axisy,d+=this.b1.posx,c+=this.b1.posy,this.hpc2&&(y=this.b1.axisy*this.c2.lr1x-this.b1.axisx*this.c2.lr1y,_=this.c2.lr1x*this.b1.axisx+this.c2.lr1y*this.b1.axisy,y+=this.b1.posx,_+=this.b1.posy));var m=d*p+c*u-x-this.radius,g=0;if(this.hpc2&&(g=y*p+_*u-x-this.radius,g+=Er.collisionSlop),(m+=Er.collisionSlop)<0||g<0){this.rev&&(p=-p,u=-u);var f=d-this.b1.posx,x=c-this.b1.posy,d=d-this.b2.posx,c=c-this.b2.posy;if(this.hpc2){var v=u*f-p*x,w=u*d-p*c,z=u*(y-this.b1.posx)-p*(_-this.b1.posy),b=u*(y-this.b2.posx)-p*(_-this.b2.posy),S=this.b1.smass+this.b2.smass;this.kMassa=S+this.b1.sinertia*v*v+this.b2.sinertia*w*w,this.kMassb=S+this.b1.sinertia*v*z+this.b2.sinertia*w*b,this.kMassc=S+this.b1.sinertia*z*z+this.b2.sinertia*b*b;for(var C=this.kMassa,P=this.kMassb,M=this.kMassc,T=m*this.biasCoef,A=g*this.biasCoef;;){var k=0,O=0;k=-(k=T),O=-(O=A);var E=this.kMassa*this.kMassc-this.kMassb*this.kMassb;if(E!=E?k=O=0:0==E?(0!=this.kMassa?k/=this.kMassa:k=0,0!=this.kMassc?O/=this.kMassc:O=0):(G=(E=1/E)*(this.kMassc*k-this.kMassb*O),O=E*(this.kMassa*O-this.kMassb*k),k=G),0<=k&&0<=O){var I=(k+O)*this.b1.imass;this.b1.posx-=p*I,this.b1.posy-=u*I;var E=this.b1,G=-this.b1.iinertia*(v*k+z*O);E.rot+=G,1e-4<G*G?(E.axisx=Math.sin(E.rot),E.axisy=Math.cos(E.rot)):(D=((I=1-.5*(D=G*G))*E.axisx+G*E.axisy)*(L=1-D*D/8),E.axisy=(I*E.axisy-G*E.axisx)*L,E.axisx=D);G=(k+O)*this.b2.imass;this.b2.posx+=p*G,this.b2.posy+=u*G;var D,L=this.b2,E=this.b2.iinertia*(w*k+b*O);L.rot+=E,1e-4<E*E?(L.axisx=Math.sin(L.rot),L.axisy=Math.cos(L.rot)):(R=((D=1-.5*(R=E*E))*L.axisx+E*L.axisy)*(G=1-R*R/8),L.axisy=(D*L.axisy-E*L.axisx)*G,L.axisx=R);break}if((O=0)<=(k=-T/C)&&0<=P*k+A){L=(k+O)*this.b1.imass;this.b1.posx-=p*L,this.b1.posy-=u*L;var B=this.b1,R=-this.b1.iinertia*(v*k+z*O);B.rot+=R,1e-4<R*R?(B.axisx=Math.sin(B.rot),B.axisy=Math.cos(B.rot)):(N=((L=1-.5*(N=R*R))*B.axisx+R*B.axisy)*(F=1-N*N/8),B.axisy=(L*B.axisy-R*B.axisx)*F,B.axisx=N);var F=(k+O)*this.b2.imass;this.b2.posx+=p*F,this.b2.posy+=u*F;var B=this.b2,N=this.b2.iinertia*(w*k+b*O);B.rot+=N,1e-4<N*N?(B.axisx=Math.sin(B.rot),B.axisy=Math.cos(B.rot)):(U=((F=1-.5*(U=N*N))*B.axisx+N*B.axisy)*(j=1-U*U/8),B.axisy=(F*B.axisy-N*B.axisx)*j,B.axisx=U);break}if((k=0)<=(O=-A/M)&&0<=P*O+T){var j=(k+O)*this.b1.imass;this.b1.posx-=p*j,this.b1.posy-=u*j;var B=this.b1,U=-this.b1.iinertia*(v*k+z*O);B.rot+=U,1e-4<U*U?(B.axisx=Math.sin(B.rot),B.axisy=Math.cos(B.rot)):(W=((j=1-.5*(W=U*U))*B.axisx+U*B.axisy)*(V=1-W*W/8),B.axisy=(j*B.axisy-U*B.axisx)*V,B.axisx=W);var V=(k+O)*this.b2.imass;this.b2.posx+=p*V,this.b2.posy+=u*V;var B=this.b2,W=this.b2.iinertia*(w*k+b*O);B.rot+=W,1e-4<W*W?(B.axisx=Math.sin(B.rot),B.axisy=Math.cos(B.rot)):(V=((k=1-.5*(V=W*W))*B.axisx+W*B.axisy)*(O=1-V*V/8),B.axisy=(k*B.axisy-W*B.axisx)*O,B.axisx=V);break}break}}else{var X,_=u*f-p*x,S=u*d-p*c,g=this.b2.smass+S*S*this.b2.sinertia+this.b1.smass+_*_*this.b1.sinertia;0!=g&&(x=f=0,x=u*(d=-this.biasCoef*m/g),c=this.b1.imass,this.b1.posx-=(f=p*d)*c,this.b1.posy-=x*c,m=this.b1,g=-_*this.b1.iinertia*d,m.rot+=g,1e-4<g*g?(m.axisx=Math.sin(m.rot),m.axisy=Math.cos(m.rot)):(X=((c=1-.5*(X=g*g))*m.axisx+g*m.axisy)*(_=1-X*X/8),m.axisy=(c*m.axisy-g*m.axisx)*_,m.axisx=X),X=this.b2.imass,this.b2.posx+=f*X,this.b2.posy+=x*X,f=this.b2,x=S*this.b2.iinertia*d,f.rot+=x,1e-4<x*x?(f.axisx=Math.sin(f.rot),f.axisy=Math.cos(f.rot)):(X=((S=1-.5*(X=x*x))*f.axisx+x*f.axisy)*(d=1-X*X/8),f.axisy=(S*f.axisy-x*f.axisx)*d,f.axisx=X))}}}},Jn.prototype.__class__=Jn;var Qn=zpp_nape.dynamics.ZPP_Contact=function(){this.length=0,this.pushmod=!1,this.modified=!1,this._inuse=!1,this.next=null,this.elasticity=0,this.dist=0,this.fresh=!1,this.hash=0,this.stamp=0,this.posOnly=!1,this.active=!1,this.inner=null,this.arbiter=null,this.wrap_position=null,this.py=0,this.px=0,this.outer=null,this.inner=new ae};Qn.__name__=["zpp_nape","dynamics","ZPP_Contact"],Qn.prototype.outer=null,Qn.prototype.wrapper=function(){return null==this.outer&&(Qn.internal=!0,this.outer=new G,Qn.internal=!1,this.outer.zpp_inner=this),this.outer},Qn.prototype.px=null,Qn.prototype.py=null,Qn.prototype.position_validate=function(){this.wrap_position.zpp_inner.x=this.px,this.wrap_position.zpp_inner.y=this.py},Qn.prototype.wrap_position=null,Qn.prototype.getposition=function(){var t,e,i;null==Bn.poolVec2?t=new St:(t=Bn.poolVec2,Bn.poolVec2=t.zpp_pool,t.zpp_pool=null),null==t.zpp_inner?(null==Gr.zpp_pool?e=new Gr:(e=Gr.zpp_pool,Gr.zpp_pool=e.next,e.next=null),e.weak=!1,e._immutable=!1,e.x=0,e.y=0,t.zpp_inner=e,t.zpp_inner.outer=t):(null!=(e=t.zpp_inner)._validate&&e._validate(),0==t.zpp_inner.x&&(null!=(i=t.zpp_inner)._validate&&i._validate(),0==t.zpp_inner.y)||(t.zpp_inner.x=0,t.zpp_inner.y=0,null!=(i=t.zpp_inner)._invalidate&&i._invalidate(i))),t.zpp_inner.weak=!1,this.wrap_position=t,this.wrap_position.zpp_inner._inuse=!0,this.wrap_position.zpp_inner._immutable=!0,this.wrap_position.zpp_inner._validate=Z(this,this.position_validate)},Qn.prototype.inactiveme=function(){return!(this.active&&null!=this.arbiter&&this.arbiter.active)},Qn.prototype.arbiter=null,Qn.prototype.inner=null,Qn.prototype.active=null,Qn.prototype.posOnly=null,Qn.prototype.stamp=null,Qn.prototype.hash=null,Qn.prototype.fresh=null,Qn.prototype.dist=null,Qn.prototype.elasticity=null,Qn.prototype.free=function(){this.arbiter=null},Qn.prototype.alloc=function(){},Qn.prototype.next=null,Qn.prototype.elem=function(){return this},Qn.prototype.begin=function(){return this.next},Qn.prototype._inuse=null,Qn.prototype.modified=null,Qn.prototype.pushmod=null,Qn.prototype.length=null,Qn.prototype.setbegin=function(t){this.next=t,this.modified=!0,this.pushmod=!0},Qn.prototype.add=function(t){return t._inuse=!0,t.next=this.next,this.next=t,this.modified=!0,this.length++,t},Qn.prototype.inlined_add=function(t){return t._inuse=!0,t.next=this.next,this.next=t,this.modified=!0,this.length++,t},Qn.prototype.addAll=function(t){for(var e=t.next;null!=e;)this.add(e),e=e.next},Qn.prototype.insert=function(t,e){return e._inuse=!0,null==t?(e.next=this.next,this.next=e):(e.next=t.next,t.next=e),this.pushmod=this.modified=!0,this.length++,e},Qn.prototype.inlined_insert=function(t,e){return e._inuse=!0,null==t?(e.next=this.next,this.next=e):(e.next=t.next,t.next=e),this.pushmod=this.modified=!0,this.length++,e},Qn.prototype.pop=function(){var t=this.next;this.next=t.next,t._inuse=!1,null==this.next&&(this.pushmod=!0),this.modified=!0,this.length--},Qn.prototype.inlined_pop=function(){var t=this.next;this.next=t.next,t._inuse=!1,null==this.next&&(this.pushmod=!0),this.modified=!0,this.length--},Qn.prototype.pop_unsafe=function(){var t=this.next;return this.pop(),t},Qn.prototype.inlined_pop_unsafe=function(){var t=this.next;return this.pop(),t},Qn.prototype.remove=function(t){for(var e,i,n=null,r=this.next;null!=r;){if(r==t){null==n?(i=(e=this.next).next,this.next=i,null==this.next&&(this.pushmod=!0)):(i=(e=n.next).next,null==(n.next=i)&&(this.pushmod=!0)),e._inuse=!1,this.modified=!0,this.length--,this.pushmod=!0;break}r=(n=r).next}},Qn.prototype.try_remove=function(t){for(var e=null,i=this.next,n=!1;null!=i;){if(i==t){this.erase(e),n=!0;break}i=(e=i).next}return n},Qn.prototype.inlined_remove=function(t){for(var e,i,n=null,r=this.next;null!=r;){if(r==t){null==n?(i=(e=this.next).next,this.next=i,null==this.next&&(this.pushmod=!0)):(i=(e=n.next).next,null==(n.next=i)&&(this.pushmod=!0)),e._inuse=!1,this.modified=!0,this.length--,this.pushmod=!0;break}r=(n=r).next}},Qn.prototype.inlined_try_remove=function(t){for(var e,i,n=null,r=this.next,o=!1;null!=r;){if(r==t){null==n?(i=(e=this.next).next,this.next=i,null==this.next&&(this.pushmod=!0)):(i=(e=n.next).next,null==(n.next=i)&&(this.pushmod=!0)),e._inuse=!1,this.modified=!0,this.length--,o=this.pushmod=!0;break}r=(n=r).next}return o},Qn.prototype.erase=function(t){var e,i;return null==t?(i=(e=this.next).next,this.next=i,null==this.next&&(this.pushmod=!0)):(i=(e=t.next).next,null==(t.next=i)&&(this.pushmod=!0)),e._inuse=!1,this.modified=!0,this.length--,this.pushmod=!0,i},Qn.prototype.inlined_erase=function(t){var e,i;return null==t?(i=(e=this.next).next,this.next=i,null==this.next&&(this.pushmod=!0)):(i=(e=t.next).next,null==(t.next=i)&&(this.pushmod=!0)),e._inuse=!1,this.modified=!0,this.length--,this.pushmod=!0,i},Qn.prototype.splice=function(t,e){for(;0<e--&&null!=t.next;)this.erase(t);return t.next},Qn.prototype.clear=function(){},Qn.prototype.inlined_clear=function(){},Qn.prototype.reverse=function(){for(var t=this.next,e=null;null!=t;){var i=t.next;t.next=e,e=this.next=t,t=i}this.modified=!0,this.pushmod=!0},Qn.prototype.empty=function(){return null==this.next},Qn.prototype.size=function(){return this.length},Qn.prototype.has=function(t){for(var e=!1,i=this.next;null!=i;){if(i==t){e=!0;break}i=i.next}return e},Qn.prototype.inlined_has=function(t){for(var e=!1,i=this.next;null!=i;){if(i==t){e=!0;break}i=i.next}return e},Qn.prototype.front=function(){return this.next},Qn.prototype.back=function(){for(var t=this.next,e=t;null!=e;)e=(t=e).next;return t},Qn.prototype.iterator_at=function(t){for(var e=this.next;0<t--&&null!=e;)e=e.next;return e},Qn.prototype.at=function(t){t=this.iterator_at(t);return null!=t?t:null},Qn.prototype.__class__=Qn;var ae=zpp_nape.dynamics.ZPP_IContact=function(){this.length=0,this.pushmod=!1,this.modified=!1,this._inuse=!1,this.next=null,this.lr2y=0,this.lr2x=0,this.lr1y=0,this.lr1x=0,this.jtAcc=0,this.jnAcc=0,this.friction=0,this.bounce=0,this.tMass=0,this.nMass=0,this.r2y=0,this.r2x=0,this.r1y=0,this.r1x=0};ae.__name__=["zpp_nape","dynamics","ZPP_IContact"],ae.prototype.r1x=null,ae.prototype.r1y=null,ae.prototype.r2x=null,ae.prototype.r2y=null,ae.prototype.nMass=null,ae.prototype.tMass=null,ae.prototype.bounce=null,ae.prototype.friction=null,ae.prototype.jnAcc=null,ae.prototype.jtAcc=null,ae.prototype.lr1x=null,ae.prototype.lr1y=null,ae.prototype.lr2x=null,ae.prototype.lr2y=null,ae.prototype.next=null,ae.prototype.elem=function(){return this},ae.prototype.begin=function(){return this.next},ae.prototype._inuse=null,ae.prototype.modified=null,ae.prototype.pushmod=null,ae.prototype.length=null,ae.prototype.setbegin=function(t){this.next=t,this.modified=!0,this.pushmod=!0},ae.prototype.add=function(t){return t._inuse=!0,t.next=this.next,this.next=t,this.modified=!0,this.length++,t},ae.prototype.inlined_add=function(t){return t._inuse=!0,t.next=this.next,this.next=t,this.modified=!0,this.length++,t},ae.prototype.addAll=function(t){for(var e=t.next;null!=e;)this.add(e),e=e.next},ae.prototype.insert=function(t,e){return e._inuse=!0,null==t?(e.next=this.next,this.next=e):(e.next=t.next,t.next=e),this.pushmod=this.modified=!0,this.length++,e},ae.prototype.inlined_insert=function(t,e){return e._inuse=!0,null==t?(e.next=this.next,this.next=e):(e.next=t.next,t.next=e),this.pushmod=this.modified=!0,this.length++,e},ae.prototype.pop=function(){var t=this.next;this.next=t.next,t._inuse=!1,null==this.next&&(this.pushmod=!0),this.modified=!0,this.length--},ae.prototype.inlined_pop=function(){var t=this.next;this.next=t.next,t._inuse=!1,null==this.next&&(this.pushmod=!0),this.modified=!0,this.length--},ae.prototype.pop_unsafe=function(){var t=this.next;return this.pop(),t},ae.prototype.inlined_pop_unsafe=function(){var t=this.next;return this.pop(),t},ae.prototype.remove=function(t){for(var e,i,n=null,r=this.next;null!=r;){if(r==t){null==n?(i=(e=this.next).next,this.next=i,null==this.next&&(this.pushmod=!0)):(i=(e=n.next).next,null==(n.next=i)&&(this.pushmod=!0)),e._inuse=!1,this.modified=!0,this.length--,this.pushmod=!0;break}r=(n=r).next}},ae.prototype.try_remove=function(t){for(var e=null,i=this.next,n=!1;null!=i;){if(i==t){this.erase(e),n=!0;break}i=(e=i).next}return n},ae.prototype.inlined_remove=function(t){for(var e,i,n=null,r=this.next;null!=r;){if(r==t){null==n?(i=(e=this.next).next,this.next=i,null==this.next&&(this.pushmod=!0)):(i=(e=n.next).next,null==(n.next=i)&&(this.pushmod=!0)),e._inuse=!1,this.modified=!0,this.length--,this.pushmod=!0;break}r=(n=r).next}},ae.prototype.inlined_try_remove=function(t){for(var e,i,n=null,r=this.next,o=!1;null!=r;){if(r==t){null==n?(i=(e=this.next).next,this.next=i,null==this.next&&(this.pushmod=!0)):(i=(e=n.next).next,null==(n.next=i)&&(this.pushmod=!0)),e._inuse=!1,this.modified=!0,this.length--,o=this.pushmod=!0;break}r=(n=r).next}return o},ae.prototype.erase=function(t){var e,i;return null==t?(i=(e=this.next).next,this.next=i,null==this.next&&(this.pushmod=!0)):(i=(e=t.next).next,null==(t.next=i)&&(this.pushmod=!0)),e._inuse=!1,this.modified=!0,this.length--,this.pushmod=!0,i},ae.prototype.inlined_erase=function(t){var e,i;return null==t?(i=(e=this.next).next,this.next=i,null==this.next&&(this.pushmod=!0)):(i=(e=t.next).next,null==(t.next=i)&&(this.pushmod=!0)),e._inuse=!1,this.modified=!0,this.length--,this.pushmod=!0,i},ae.prototype.splice=function(t,e){for(;0<e--&&null!=t.next;)this.erase(t);return t.next},ae.prototype.clear=function(){},ae.prototype.inlined_clear=function(){},ae.prototype.reverse=function(){for(var t=this.next,e=null;null!=t;){var i=t.next;t.next=e,e=this.next=t,t=i}this.modified=!0,this.pushmod=!0},ae.prototype.empty=function(){return null==this.next},ae.prototype.size=function(){return this.length},ae.prototype.has=function(t){for(var e=!1,i=this.next;null!=i;){if(i==t){e=!0;break}i=i.next}return e},ae.prototype.inlined_has=function(t){for(var e=!1,i=this.next;null!=i;){if(i==t){e=!0;break}i=i.next}return e},ae.prototype.front=function(){return this.next},ae.prototype.back=function(){for(var t=this.next,e=t;null!=e;)e=(t=e).next;return t},ae.prototype.iterator_at=function(t){for(var e=this.next;0<t--&&null!=e;)e=e.next;return e},ae.prototype.at=function(t){t=this.iterator_at(t);return null!=t?t:null},ae.prototype.__class__=ae;var he=zpp_nape.dynamics.ZPP_InteractionFilter=function(){this.fluidMask=0,this.fluidGroup=0,this.sensorMask=0,this.sensorGroup=0,this.collisionMask=0,this.collisionGroup=0,this.wrap_shapes=null,this.shapes=null,this.outer=null,this.userData=null,this.next=null,this.shapes=new ui,this.collisionGroup=this.sensorGroup=this.fluidGroup=1,this.collisionMask=this.sensorMask=this.fluidMask=-1};he.__name__=["zpp_nape","dynamics","ZPP_InteractionFilter"],he.prototype.next=null,he.prototype.userData=null,he.prototype.outer=null,he.prototype.wrapper=function(){var t;return null==this.outer&&(this.outer=new B,(t=this.outer.zpp_inner).outer=null,t.next=he.zpp_pool,he.zpp_pool=t,this.outer.zpp_inner=this),this.outer},he.prototype.free=function(){this.outer=null},he.prototype.alloc=function(){},he.prototype.shapes=null,he.prototype.wrap_shapes=null,he.prototype.feature_cons=function(){this.shapes=new ui},he.prototype.addShape=function(t){this.shapes.add(t)},he.prototype.remShape=function(t){this.shapes.remove(t)},he.prototype.copy=function(){var t;return null==he.zpp_pool?t=new he:(t=he.zpp_pool,he.zpp_pool=t.next,t.next=null),t.collisionGroup=this.collisionGroup,t.collisionMask=this.collisionMask,t.sensorGroup=this.sensorGroup,t.sensorMask=this.sensorMask,t.fluidGroup=this.fluidGroup,t.fluidMask=this.fluidMask,t},he.prototype.collisionGroup=null,he.prototype.collisionMask=null,he.prototype.shouldCollide=function(t){return 0!=(this.collisionMask&t.collisionGroup)&&0!=(t.collisionMask&this.collisionGroup)},he.prototype.sensorGroup=null,he.prototype.sensorMask=null,he.prototype.shouldSense=function(t){return 0!=(this.sensorMask&t.sensorGroup)&&0!=(t.sensorMask&this.sensorGroup)},he.prototype.fluidGroup=null,he.prototype.fluidMask=null,he.prototype.shouldFlow=function(t){return 0!=(this.fluidMask&t.fluidGroup)&&0!=(t.fluidMask&this.fluidGroup)},he.prototype.invalidate=function(){for(var t=this.shapes.head;null!=t;)t.elt.invalidate_filter(),t=t.next},he.prototype.__class__=he;var le=zpp_nape.dynamics.ZPP_InteractionGroup=function(){this.depth=0,this.wrap_interactors=null,this.interactors=null,this.wrap_groups=null,this.groups=null,this.group=null,this.ignore=!1,this.outer=null,this.depth=0,this.groups=new Bi,this.interactors=new Pt};le.__name__=["zpp_nape","dynamics","ZPP_InteractionGroup"],le.prototype.outer=null,le.prototype.ignore=null,le.prototype.group=null,le.prototype.setGroup=function(t){this.group!=t&&(null!=this.group&&(this.group.groups.remove(this),this.depth=0,this.group.invalidate(!0)),null!=(this.group=t)?(t.groups.add(this),this.depth=t.depth+1,t.invalidate(!0)):this.invalidate(!0))},le.prototype.groups=null,le.prototype.wrap_groups=null,le.prototype.interactors=null,le.prototype.wrap_interactors=null,le.prototype.depth=null,le.prototype.invalidate=function(t){if((t=null==t?!1:t)||this.ignore){for(var e=this.interactors.head;null!=e;){var i=e.elt;(null!=i.ibody?i.ibody:null!=i.ishape?i.ishape.body:i.icompound).wake(),e=e.next}for(var n=this.groups.head;null!=n;)n.elt.invalidate(t),n=n.next}},le.prototype.addGroup=function(t){this.groups.add(t),t.depth=this.depth+1},le.prototype.remGroup=function(t){this.groups.remove(t),t.depth=0},le.prototype.addInteractor=function(t){this.interactors.add(t)},le.prototype.remInteractor=function(t,e){null==e&&(e=-1),this.interactors.remove(t)},le.prototype.__class__=le;var pe=zpp_nape.dynamics.ZPP_SpaceArbiterList=function(){this.at_index_3=0,this.at_index_2=0,this.at_index_1=0,this.at_index_0=0,this.ite_3=null,this.ite_2=null,this.ite_1=null,this.ite_0=null,this.lengths=null,this.zip_length=!1,this._length=0,this.space=null,O.call(this),this.at_index_0=0,this.at_index_1=0,this.at_index_2=0,this.at_index_3=0,this.zip_length=!0,this._length=0,this.lengths=[];for(var t=0;t<4;)++t,this.lengths.push(0)};pe.__name__=["zpp_nape","dynamics","ZPP_SpaceArbiterList"],pe.__super__=O,pe.prototype=Object.create(O.prototype),pe.prototype.space=null,pe.prototype._length=null,pe.prototype.zip_length=null,pe.prototype.zpp_gl=function(){if(this.zpp_vm(),this.zip_length){for(var t=this._length=0,e=this.space.c_arbiters_true.head;null!=e;)e.elt.active&&++t,e=e.next;this.lengths[0]=t,this._length+=t;for(var i=0,n=this.space.c_arbiters_false.head;null!=n;)n.elt.active&&++i,n=n.next;this.lengths[1]=i,this._length+=i;for(var r=0,o=this.space.f_arbiters.head;null!=o;)o.elt.active&&++r,o=o.next;this.lengths[2]=r,this._length+=r;for(var s=0,a=this.space.s_arbiters.head;null!=a;)a.elt.active&&++s,a=a.next;this.lengths[3]=s,this._length+=s,this.zip_length=!1}return this._length},pe.prototype.lengths=null,pe.prototype.ite_0=null,pe.prototype.ite_1=null,pe.prototype.ite_2=null,pe.prototype.ite_3=null,pe.prototype.at_index_0=null,pe.prototype.at_index_1=null,pe.prototype.at_index_2=null,pe.prototype.at_index_3=null,pe.prototype.zpp_vm=function(){var t=!1;this.space.c_arbiters_true.modified&&(this.space.c_arbiters_true.modified=!(t=!0)),this.space.c_arbiters_false.modified&&(this.space.c_arbiters_false.modified=!(t=!0)),this.space.f_arbiters.modified&&(this.space.f_arbiters.modified=!(t=!0)),this.space.s_arbiters.modified&&(this.space.s_arbiters.modified=!(t=!0)),t&&(this.zip_length=!0,this._length=0,this.ite_0=null,this.ite_1=null,this.ite_2=null,this.ite_3=null)},pe.prototype.push=function(t){return!1},pe.prototype.pop=function(){return null},pe.prototype.unshift=function(t){return!1},pe.prototype.shift=function(){return null},pe.prototype.remove=function(t){return!1},pe.prototype.clear=function(){},pe.prototype.at=function(t){this.zpp_vm();var e=null,i=0;if(null==e)if(t<this.lengths[0]){var n=t;if(n<this.at_index_0||null==this.ite_0)for(this.at_index_0=0,this.ite_0=this.space.c_arbiters_true.head;!this.ite_0.elt.active;)this.ite_0=this.ite_0.next;for(;this.at_index_0!=n;)for(this.at_index_0++,this.ite_0=this.ite_0.next;!this.ite_0.elt.active;)this.ite_0=this.ite_0.next;e=this.ite_0.elt.wrapper()}else i=this.lengths[0];if(null==e)if(t<i+this.lengths[1]){var r=t-i;if(r<this.at_index_1||null==this.ite_1)for(this.at_index_1=0,this.ite_1=this.space.c_arbiters_false.head;!this.ite_1.elt.active;)this.ite_1=this.ite_1.next;for(;this.at_index_1!=r;)for(this.at_index_1++,this.ite_1=this.ite_1.next;!this.ite_1.elt.active;)this.ite_1=this.ite_1.next;e=this.ite_1.elt.wrapper()}else i+=this.lengths[1];if(null==e)if(t<i+this.lengths[2]){var o=t-i;if(o<this.at_index_2||null==this.ite_2)for(this.at_index_2=0,this.ite_2=this.space.f_arbiters.head;!this.ite_2.elt.active;)this.ite_2=this.ite_2.next;for(;this.at_index_2!=o;)for(this.at_index_2++,this.ite_2=this.ite_2.next;!this.ite_2.elt.active;)this.ite_2=this.ite_2.next;e=this.ite_2.elt.wrapper()}else i+=this.lengths[2];if(null==e)if(t<i+this.lengths[3]){var s=t-i;if(s<this.at_index_3||null==this.ite_3)for(this.at_index_3=0,this.ite_3=this.space.s_arbiters.head;!this.ite_3.elt.active;)this.ite_3=this.ite_3.next;for(;this.at_index_3!=s;)for(this.at_index_3++,this.ite_3=this.ite_3.next;!this.ite_3.elt.active;)this.ite_3=this.ite_3.next;e=this.ite_3.elt.wrapper()}else i+=this.lengths[3];return e},pe.prototype.__class__=pe;var De=zpp_nape.geom.ZPP_AABB=function(){this.wrap_max=null,this.maxy=0,this.maxx=0,this.wrap_min=null,this.miny=0,this.minx=0,this.next=null,this.outer=null,this._immutable=!1,this._validate=null,this._invalidate=null};De.__name__=["zpp_nape","geom","ZPP_AABB"],De.get=function(t,e,i,n){var r;return null==De.zpp_pool?r=new De:(r=De.zpp_pool,De.zpp_pool=r.next,r.next=null),r.minx=t,r.miny=e,r.maxx=i,r.maxy=n,r},De.prototype._invalidate=null,De.prototype._validate=null,De.prototype._immutable=null,De.prototype.validate=function(){null!=this._validate&&this._validate()},De.prototype.invalidate=function(){null!=this._invalidate&&this._invalidate(this)},De.prototype.outer=null,De.prototype.wrapper=function(){var t;return null==this.outer&&(this.outer=new N,null!=(t=this.outer.zpp_inner).outer&&(t.outer.zpp_inner=null,t.outer=null),t.wrap_min=t.wrap_max=null,t._invalidate=null,t._validate=null,t.next=De.zpp_pool,De.zpp_pool=t,this.outer.zpp_inner=this),this.outer},De.prototype.next=null,De.prototype.alloc=function(){},De.prototype.free=function(){null!=this.outer&&(this.outer.zpp_inner=null,this.outer=null),this.wrap_min=this.wrap_max=null,this._invalidate=null,this._validate=null},De.prototype.copy=function(){var t,e=this.minx,i=this.miny,n=this.maxx,r=this.maxy;return null==De.zpp_pool?t=new De:(t=De.zpp_pool,De.zpp_pool=t.next,t.next=null),t.minx=e,t.miny=i,t.maxx=n,t.maxy=r,t},De.prototype.width=function(){return this.maxx-this.minx},De.prototype.height=function(){return this.maxy-this.miny},De.prototype.perimeter=function(){return 2*(this.maxx-this.minx+(this.maxy-this.miny))},De.prototype.minx=null,De.prototype.miny=null,De.prototype.wrap_min=null,De.prototype.getmin=function(){var t,e,i,n;return null==this.wrap_min&&(t=this.minx,n=this.miny,null==Bn.poolVec2?e=new St:(e=Bn.poolVec2,Bn.poolVec2=e.zpp_pool,e.zpp_pool=null),null==e.zpp_inner?(null==Gr.zpp_pool?i=new Gr:(i=Gr.zpp_pool,Gr.zpp_pool=i.next,i.next=null),i.weak=!1,i._immutable=!1,i.x=t,i.y=n,e.zpp_inner=i,e.zpp_inner.outer=e):(null!=(i=e.zpp_inner)._validate&&i._validate(),e.zpp_inner.x==t&&(null!=(i=e.zpp_inner)._validate&&i._validate(),e.zpp_inner.y==n)||(e.zpp_inner.x=t,e.zpp_inner.y=n,null!=(n=e.zpp_inner)._invalidate&&n._invalidate(n))),e.zpp_inner.weak=!1,this.wrap_min=e,this.wrap_min.zpp_inner._inuse=!0,this._immutable?this.wrap_min.zpp_inner._immutable=!0:this.wrap_min.zpp_inner._invalidate=Z(this,this.mod_min),this.wrap_min.zpp_inner._validate=Z(this,this.dom_min)),this.wrap_min},De.prototype.dom_min=function(){null!=this._validate&&this._validate(),this.wrap_min.zpp_inner.x=this.minx,this.wrap_min.zpp_inner.y=this.miny},De.prototype.mod_min=function(t){t.x==this.minx&&t.y==this.miny||(this.minx=t.x,this.miny=t.y,null!=this._invalidate&&this._invalidate(this))},De.prototype.maxx=null,De.prototype.maxy=null,De.prototype.wrap_max=null,De.prototype.getmax=function(){var t,e,i,n;return null==this.wrap_max&&(t=this.maxx,n=this.maxy,null==Bn.poolVec2?e=new St:(e=Bn.poolVec2,Bn.poolVec2=e.zpp_pool,e.zpp_pool=null),null==e.zpp_inner?(null==Gr.zpp_pool?i=new Gr:(i=Gr.zpp_pool,Gr.zpp_pool=i.next,i.next=null),i.weak=!1,i._immutable=!1,i.x=t,i.y=n,e.zpp_inner=i,e.zpp_inner.outer=e):(null!=(i=e.zpp_inner)._validate&&i._validate(),e.zpp_inner.x==t&&(null!=(i=e.zpp_inner)._validate&&i._validate(),e.zpp_inner.y==n)||(e.zpp_inner.x=t,e.zpp_inner.y=n,null!=(n=e.zpp_inner)._invalidate&&n._invalidate(n))),e.zpp_inner.weak=!1,this.wrap_max=e,this.wrap_max.zpp_inner._inuse=!0,this._immutable?this.wrap_max.zpp_inner._immutable=!0:this.wrap_max.zpp_inner._invalidate=Z(this,this.mod_max),this.wrap_max.zpp_inner._validate=Z(this,this.dom_max)),this.wrap_max},De.prototype.dom_max=function(){null!=this._validate&&this._validate(),this.wrap_max.zpp_inner.x=this.maxx,this.wrap_max.zpp_inner.y=this.maxy},De.prototype.mod_max=function(t){t.x==this.maxx&&t.y==this.maxy||(this.maxx=t.x,this.maxy=t.y,null!=this._invalidate&&this._invalidate(this))},De.prototype.intersectX=function(t){return!(t.minx>this.maxx||this.minx>t.maxx)},De.prototype.intersectY=function(t){return!(t.miny>this.maxy||this.miny>t.maxy)},De.prototype.intersect=function(t){return t.miny<=this.maxy&&this.miny<=t.maxy&&t.minx<=this.maxx&&this.minx<=t.maxx},De.prototype.combine=function(t){t.minx<this.minx&&(this.minx=t.minx),t.maxx>this.maxx&&(this.maxx=t.maxx),t.miny<this.miny&&(this.miny=t.miny),t.maxy>this.maxy&&(this.maxy=t.maxy)},De.prototype.contains=function(t){return t.minx>=this.minx&&t.miny>=this.miny&&t.maxx<=this.maxx&&t.maxy<=this.maxy},De.prototype.containsPoint=function(t){return t.x>=this.minx&&t.x<=this.maxx&&t.y>=this.miny&&t.y<=this.maxy},De.prototype.setCombine=function(t,e){this.minx=(t.minx<e.minx?t:e).minx,this.miny=(t.miny<e.miny?t:e).miny,this.maxx=(t.maxx>e.maxx?t:e).maxx,this.maxy=(t.maxy>e.maxy?t:e).maxy},De.prototype.setExpand=function(t,e){this.minx=t.minx-e,this.miny=t.miny-e,this.maxx=t.maxx+e,this.maxy=t.maxy+e},De.prototype.setExpandPoint=function(t,e){t<this.minx&&(this.minx=t),t>this.maxx&&(this.maxx=t),e<this.miny&&(this.miny=e),e>this.maxy&&(this.maxy=e)},De.prototype.toString=function(){return"{ x: "+this.minx+" y: "+this.miny+" w: "+(this.maxx-this.minx)+" h: "+(this.maxy-this.miny)+" }"},De.prototype.__class__=De;var ue=zpp_nape.util.ZNPList_ZPP_Vec2=function(){this.length=0,this.pushmod=!1,this.modified=!1,this.head=null};ue.__name__=["zpp_nape","util","ZNPList_ZPP_Vec2"],ue.prototype.head=null,ue.prototype.begin=function(){return this.head},ue.prototype.modified=null,ue.prototype.pushmod=null,ue.prototype.length=null,ue.prototype.setbegin=function(t){this.head=t,this.modified=!0,this.pushmod=!0},ue.prototype.add=function(t){null==pn.zpp_pool?e=new pn:(e=pn.zpp_pool,pn.zpp_pool=e.next,e.next=null),e.elt=t;var e=e;return e.next=this.head,this.head=e,this.modified=!0,this.length++,t},ue.prototype.inlined_add=function(t){null==pn.zpp_pool?e=new pn:(e=pn.zpp_pool,pn.zpp_pool=e.next,e.next=null),e.elt=t;var e=e;return e.next=this.head,this.head=e,this.modified=!0,this.length++,t},ue.prototype.addAll=function(t){for(var e=t.head;null!=e;)this.add(e.elt),e=e.next},ue.prototype.insert=function(t,e){null==pn.zpp_pool?i=new pn:(i=pn.zpp_pool,pn.zpp_pool=i.next,i.next=null),i.elt=e;var i=i;return null==t?(i.next=this.head,this.head=i):(i.next=t.next,t.next=i),this.pushmod=this.modified=!0,this.length++,i},ue.prototype.inlined_insert=function(t,e){null==pn.zpp_pool?i=new pn:(i=pn.zpp_pool,pn.zpp_pool=i.next,i.next=null),i.elt=e;var i=i;return null==t?(i.next=this.head,this.head=i):(i.next=t.next,t.next=i),this.pushmod=this.modified=!0,this.length++,i},ue.prototype.pop=function(){var t=this.head;this.head=t.next,t.elt=null,t.next=pn.zpp_pool,pn.zpp_pool=t,null==this.head&&(this.pushmod=!0),this.modified=!0,this.length--},ue.prototype.inlined_pop=function(){var t=this.head;this.head=t.next,t.elt=null,t.next=pn.zpp_pool,pn.zpp_pool=t,null==this.head&&(this.pushmod=!0),this.modified=!0,this.length--},ue.prototype.pop_unsafe=function(){var t=this.head.elt;return this.pop(),t},ue.prototype.inlined_pop_unsafe=function(){var t=this.head.elt;return this.pop(),t},ue.prototype.remove=function(t){for(var e,i,n=null,r=this.head;null!=r;){if(r.elt==t){null==n?(i=(e=this.head).next,this.head=i,null==this.head&&(this.pushmod=!0)):(i=(e=n.next).next,null==(n.next=i)&&(this.pushmod=!0));var o=e;o.elt=null,o.next=pn.zpp_pool,pn.zpp_pool=o,this.modified=!0,this.length--,this.pushmod=!0;break}r=(n=r).next}},ue.prototype.try_remove=function(t){for(var e=null,i=this.head,n=!1;null!=i;){if(i.elt==t){this.erase(e),n=!0;break}i=(e=i).next}return n},ue.prototype.inlined_remove=function(t){for(var e,i,n=null,r=this.head;null!=r;){if(r.elt==t){null==n?(i=(e=this.head).next,this.head=i,null==this.head&&(this.pushmod=!0)):(i=(e=n.next).next,null==(n.next=i)&&(this.pushmod=!0));var o=e;o.elt=null,o.next=pn.zpp_pool,pn.zpp_pool=o,this.modified=!0,this.length--,this.pushmod=!0;break}r=(n=r).next}},ue.prototype.inlined_try_remove=function(t){for(var e,i,n=null,r=this.head,o=!1;null!=r;){if(r.elt==t){null==n?(i=(e=this.head).next,this.head=i,null==this.head&&(this.pushmod=!0)):(i=(e=n.next).next,null==(n.next=i)&&(this.pushmod=!0));var s=e;s.elt=null,s.next=pn.zpp_pool,pn.zpp_pool=s,this.modified=!0,this.length--,o=this.pushmod=!0;break}r=(n=r).next}return o},ue.prototype.erase=function(t){var e;null==t?(e=(i=this.head).next,this.head=e,null==this.head&&(this.pushmod=!0)):(e=(i=t.next).next,null==(t.next=e)&&(this.pushmod=!0));var i=i;return i.elt=null,i.next=pn.zpp_pool,pn.zpp_pool=i,this.modified=!0,this.length--,this.pushmod=!0,e},ue.prototype.inlined_erase=function(t){var e;null==t?(e=(i=this.head).next,this.head=e,null==this.head&&(this.pushmod=!0)):(e=(i=t.next).next,null==(t.next=e)&&(this.pushmod=!0));var i=i;return i.elt=null,i.next=pn.zpp_pool,pn.zpp_pool=i,this.modified=!0,this.length--,this.pushmod=!0,e},ue.prototype.splice=function(t,e){for(;0<e--&&null!=t.next;)this.erase(t);return t.next},ue.prototype.clear=function(){for(;null!=this.head;){var t=this.head;this.head=t.next,t.elt=null,t.next=pn.zpp_pool,pn.zpp_pool=t,null==this.head&&(this.pushmod=!0),this.modified=!0,this.length--}this.pushmod=!0},ue.prototype.inlined_clear=function(){for(;null!=this.head;){var t=this.head;this.head=t.next,t.elt=null,t.next=pn.zpp_pool,pn.zpp_pool=t,null==this.head&&(this.pushmod=!0),this.modified=!0,this.length--}this.pushmod=!0},ue.prototype.reverse=function(){for(var t=this.head,e=null;null!=t;){var i=t.next;t.next=e,e=this.head=t,t=i}this.modified=!0,this.pushmod=!0},ue.prototype.empty=function(){return null==this.head},ue.prototype.size=function(){return this.length},ue.prototype.has=function(t){for(var e=!1,i=this.head;null!=i;){if(i.elt==t){e=!0;break}i=i.next}return e},ue.prototype.inlined_has=function(t){for(var e=!1,i=this.head;null!=i;){if(i.elt==t){e=!0;break}i=i.next}return e},ue.prototype.front=function(){return this.head.elt},ue.prototype.back=function(){for(var t=this.head,e=t;null!=e;)e=(t=e).next;return t.elt},ue.prototype.iterator_at=function(t){for(var e=this.head;0<t--&&null!=e;)e=e.next;return e},ue.prototype.at=function(t){t=this.iterator_at(t);return null!=t?t.elt:null},ue.prototype.__class__=ue;var Ir=zpp_nape.geom.ZPP_Collide=function(){};Ir.__name__=["zpp_nape","geom","ZPP_Collide"],Ir.circleContains=function(t,e){var i=0,n=0;return(i=e.x-t.worldCOMx)*i+(n=e.y-t.worldCOMy)*n<t.radius*t.radius},Ir.polyContains=function(t,e){for(var i=!0,n=t.edges.head;null!=n;){var r=n.elt;if(!(r.gnormx*e.x+r.gnormy*e.y<=r.gprojection)){i=!1;break}n=n.next}return i},Ir.shapeContains=function(t,e){return 0==t.type?Ir.circleContains(t.circle,e):Ir.polyContains(t.polygon,e)},Ir.bodyContains=function(t,e){for(var i=!1,n=t.shapes.head;null!=n;){if(Ir.shapeContains(n.elt,e)){i=!0;break}n=n.next}return i},Ir.containTest=function(t,e){var i=t.aabb,n=e.aabb;if(n.minx>=i.minx&&n.miny>=i.miny&&n.maxx<=i.maxx&&n.maxy<=i.maxy){if(0==t.type){if(0==e.type){var r=t.circle.radius+-e.circle.radius,n=0,i=0;return(n=e.circle.worldCOMx-t.circle.worldCOMx)*n+(i=e.circle.worldCOMy-t.circle.worldCOMy)*i<=r*r}for(var o=!0,s=e.polygon.gverts.next;null!=s;){var a=s,h=t.circle.radius,l=0,p=0;if(!((l=a.x-t.circle.worldCOMx)*l+(p=a.y-t.circle.worldCOMy)*p<=h*h)){o=!1;break}s=s.next}return o}if(0==e.type){for(var u=!0,d=t.polygon.edges.head;null!=d;){var c=d.elt;if(!(c.gnormx*e.circle.worldCOMx+c.gnormy*e.circle.worldCOMy+e.circle.radius<=c.gprojection)){u=!1;break}d=d.next}return u}for(var y=!0,_=t.polygon.edges.head;null!=_;){for(var m=_.elt,g=-1e100,f=e.polygon.gverts.next;null!=f;){var x=f,x=m.gnormx*x.x+m.gnormy*x.y;g<x&&(g=x),f=f.next}if(!(g<=m.gprojection)){y=!1;break}_=_.next}return y}return!1},Ir.contactCollide=function(t,e,i,n){if(1==e.type){if(1==t.type){for(var r=!0,o=-1e100,s=-1,a=null,h=null,l=t.polygon.edges.head;null!=l;){for(var p=l.elt,u=1e100,d=e.polygon.gverts.next;null!=d;){var c=d,c=p.gnormx*c.x+p.gnormy*c.y;if((u=c<u?c:u)-p.gprojection<=o)break;d=d.next}if(0<=(u-=p.gprojection)){r=!1;break}o<u&&(o=u,a=p,s=1),l=l.next}if(r){for(var y=e.polygon.edges.head;null!=y;){for(var _=y.elt,m=1e100,g=t.polygon.gverts.next;null!=g;){var f=g,f=_.gnormx*f.x+_.gnormy*f.y;if((m=f<m?f:m)-_.gprojection<=o)break;g=g.next}if(0<=(m-=_.gprojection)){r=!1;break}o<m&&(o=m,h=_,s=2),y=y.next}if(r){for(var x,v=1==s?(tt=e.polygon,x=a,1):(tt=t.polygon,x=h,-1),w=null,z=1e100,b=tt.edges.head;null!=b;){var S=b.elt,C=x.gnormx*S.gnormx+x.gnormy*S.gnormy;C<z&&(z=C,w=S),b=b.next}var P=0,M=0,P=w.gp0.x,M=w.gp0.y,T=0,A=0,k=(T=w.gp1.x)-P,O=(A=w.gp1.y)-M,E=x.gnormy*P-x.gnormx*M,I=x.gnormy*T-x.gnormx*A,G=1/(I-E),D=(-x.tp1-E)*G;Er.epsilon<D&&(P+=k*D,M+=O*D);var L=(-x.tp0-I)*G;L<-Er.epsilon&&(T+=k*L,A+=O*L);E=0,D=0,I=v,E=x.gnormx*I,D=x.gnormy*I;i.lnormx=x.lnormx,i.lnormy=x.lnormy,i.lproj=x.lprojection,i.radius=0,i.rev=n!=(-1==v),i.ptype=i.rev?1:0;var G=P*x.gnormx+M*x.gnormy-x.gprojection,k=T*x.gnormx+A*x.gnormy-x.gprojection;if(0<G&&0<k)return!1;n&&(E=-E,D=-D);for(var O=P-x.gnormx*G*.5,L=M-x.gnormy*G*.5,B=i.rev?1:0,R=null,F=i.contacts.next;null!=F;){var N=F;if(B==N.hash){R=N;break}F=F.next}null==R?(null==Qn.zpp_pool?R=new Qn:(R=Qn.zpp_pool,Qn.zpp_pool=R.next,R.next=null),(j=R.inner).jnAcc=j.jtAcc=0,R.hash=B,R.fresh=!0,(R.arbiter=i).jrAcc=0,I=i.contacts,R._inuse=!0,(v=R).next=I.next,I.next=v,I.modified=!0,I.length++,i.innards.add(j)):R.fresh=!1,R.px=O,R.py=L,i.nx=E,i.ny=D,R.dist=G,R.stamp=i.stamp,R.posOnly=0<G;var j=R;P-=tt.body.posx,M-=tt.body.posy,j.inner.lr1x=P*tt.body.axisy+M*tt.body.axisx,j.inner.lr1y=M*tt.body.axisy-P*tt.body.axisx;for(var O=T-x.gnormx*k*.5,L=A-x.gnormy*k*.5,U=i.rev?0:1,V=null,W=i.contacts.next;null!=W;){var X=W;if(U==X.hash){V=X;break}W=W.next}return null==V?(null==Qn.zpp_pool?V=new Qn:(V=Qn.zpp_pool,Qn.zpp_pool=V.next,V.next=null),(G=V.inner).jnAcc=G.jtAcc=0,V.hash=U,V.fresh=!0,(V.arbiter=i).jrAcc=0,M=i.contacts,V._inuse=!0,(P=V).next=M.next,M.next=P,M.modified=!0,M.length++,i.innards.add(G)):V.fresh=!1,V.px=O,V.py=L,i.nx=E,i.ny=D,V.dist=k,V.stamp=i.stamp,V.posOnly=0<k,j=V,T-=tt.body.posx,A-=tt.body.posy,j.inner.lr1x=T*tt.body.axisy+A*tt.body.axisx,j.inner.lr1y=A*tt.body.axisy-T*tt.body.axisx,1==s?(i.__ref_edge1=x,i.__ref_edge2=w):(i.__ref_edge2=x,i.__ref_edge1=w),!0}return!1}return!1}for(var H=-1e100,q=!0,Y=null,K=null,Z=e.polygon.gverts.next,J=e.polygon.edges.head;null!=J;){var Q=J.elt,$=Q.gnormx*t.circle.worldCOMx+Q.gnormy*t.circle.worldCOMy-Q.gprojection-t.circle.radius;if(0<$){q=!1;break}H<$&&(H=$,Y=Q,K=Z),Z=Z.next,J=J.next}if(q){O=K,L=(null==K.next?e.polygon.gverts:K).next,E=t.circle.worldCOMy*Y.gnormx-t.circle.worldCOMx*Y.gnormy;if(E<=O.y*Y.gnormx-O.x*Y.gnormy){var D=t.circle.radius,k=0,j=0,A=(k=O.x-t.circle.worldCOMx)*k+(j=O.y-t.circle.worldCOMy)*j;if(D*D<A)vt=null;else if(A<Er.epsilon*Er.epsilon){for(var tt,et=t.circle.worldCOMx,it=t.circle.worldCOMy,nt=null,rt=i.contacts.next;null!=rt;){var ot=rt;if(0==ot.hash){nt=ot;break}rt=rt.next}null==nt?(null==Qn.zpp_pool?nt=new Qn:(nt=Qn.zpp_pool,Qn.zpp_pool=nt.next,nt.next=null),(st=nt.inner).jnAcc=st.jtAcc=0,nt.hash=0,nt.fresh=!0,(nt.arbiter=i).jrAcc=0,T=i.contacts,nt._inuse=!0,(tt=nt).next=T.next,T.next=tt,T.modified=!0,T.length++,i.innards.add(st)):nt.fresh=!1,nt.px=et,nt.py=it,i.nx=1,i.ny=0,nt.dist=-D,nt.stamp=i.stamp,nt.posOnly=!1,vt=nt}else{var st=1/Math.sqrt(A),et=st<Er.epsilon?1e100:1/st,it=.5+(t.circle.radius-.5*D)*st;if(n){for(var at=t.circle.worldCOMx+k*it,ht=t.circle.worldCOMy+j*it,lt=null,pt=i.contacts.next;null!=pt;){var ut=pt;if(0==ut.hash){lt=ut;break}pt=pt.next}null==lt?(null==Qn.zpp_pool?lt=new Qn:(lt=Qn.zpp_pool,Qn.zpp_pool=lt.next,lt.next=null),(ct=lt.inner).jnAcc=ct.jtAcc=0,lt.hash=0,lt.fresh=!0,(lt.arbiter=i).jrAcc=0,dt=i.contacts,lt._inuse=!0,(A=lt).next=dt.next,dt.next=A,dt.modified=!0,dt.length++,i.innards.add(ct)):lt.fresh=!1,lt.px=at,lt.py=ht,i.nx=-k*st,i.ny=-j*st,lt.dist=et-D,lt.stamp=i.stamp,lt.posOnly=!1,vt=lt}else{for(var dt=t.circle.worldCOMx+k*it,ct=t.circle.worldCOMy+j*it,yt=null,_t=i.contacts.next;null!=_t;){var mt=_t;if(0==mt.hash){yt=mt;break}_t=_t.next}null==yt?(null==Qn.zpp_pool?yt=new Qn:(yt=Qn.zpp_pool,Qn.zpp_pool=yt.next,yt.next=null),(at=yt.inner).jnAcc=at.jtAcc=0,yt.hash=0,yt.fresh=!0,(yt.arbiter=i).jrAcc=0,ht=i.contacts,yt._inuse=!0,(it=yt).next=ht.next,ht.next=it,ht.modified=!0,ht.length++,i.innards.add(at)):yt.fresh=!1,yt.px=dt,yt.py=ct,i.nx=k*st,i.ny=j*st,yt.dist=et-D,yt.stamp=i.stamp,yt.posOnly=!1,vt=yt}}return null!=vt&&(xt=vt.inner,i.ptype=2,gt=ft=0,ft=O.x-e.polygon.body.posx,gt=O.y-e.polygon.body.posy,i.__ref_edge1=Y,i.__ref_vertex=-1,n?(xt.lr1x=ft*e.polygon.body.axisy+gt*e.polygon.body.axisx,xt.lr1y=gt*e.polygon.body.axisy-ft*e.polygon.body.axisx,xt.lr2x=t.circle.localCOMx,xt.lr2y=t.circle.localCOMy):(xt.lr2x=ft*e.polygon.body.axisy+gt*e.polygon.body.axisx,xt.lr2y=gt*e.polygon.body.axisy-ft*e.polygon.body.axisx,xt.lr1x=t.circle.localCOMx,xt.lr1y=t.circle.localCOMy),i.radius=t.circle.radius),null!=vt}if(E>=L.y*Y.gnormx-L.x*Y.gnormy){var O=t.circle.radius,gt=0,ft=0,xt=(gt=L.x-t.circle.worldCOMx)*gt+(ft=L.y-t.circle.worldCOMy)*ft;if(O*O<xt)Nt=null;else if(xt<Er.epsilon*Er.epsilon){for(var vt,wt=t.circle.worldCOMx,zt=t.circle.worldCOMy,bt=null,St=i.contacts.next;null!=St;){var Ct=St;if(0==Ct.hash){bt=Ct;break}St=St.next}null==bt?(null==Qn.zpp_pool?bt=new Qn:(bt=Qn.zpp_pool,Qn.zpp_pool=bt.next,bt.next=null),(Pt=bt.inner).jnAcc=Pt.jtAcc=0,bt.hash=0,bt.fresh=!0,(bt.arbiter=i).jrAcc=0,vt=i.contacts,bt._inuse=!0,(E=bt).next=vt.next,vt.next=E,vt.modified=!0,vt.length++,i.innards.add(Pt)):bt.fresh=!1,bt.px=wt,bt.py=zt,i.nx=1,i.ny=0,bt.dist=-O,bt.stamp=i.stamp,bt.posOnly=!1,Nt=bt}else{var Pt=1/Math.sqrt(xt),wt=Pt<Er.epsilon?1e100:1/Pt,zt=.5+(t.circle.radius-.5*O)*Pt;if(n){for(var Mt=t.circle.worldCOMx+gt*zt,Tt=t.circle.worldCOMy+ft*zt,At=null,kt=i.contacts.next;null!=kt;){var Ot=kt;if(0==Ot.hash){At=Ot;break}kt=kt.next}null==At?(null==Qn.zpp_pool?At=new Qn:(At=Qn.zpp_pool,Qn.zpp_pool=At.next,At.next=null),(It=At.inner).jnAcc=It.jtAcc=0,At.hash=0,At.fresh=!0,(At.arbiter=i).jrAcc=0,Et=i.contacts,At._inuse=!0,(xt=At).next=Et.next,Et.next=xt,Et.modified=!0,Et.length++,i.innards.add(It)):At.fresh=!1,At.px=Mt,At.py=Tt,i.nx=-gt*Pt,i.ny=-ft*Pt,At.dist=wt-O,At.stamp=i.stamp,At.posOnly=!1,Nt=At}else{for(var Et=t.circle.worldCOMx+gt*zt,It=t.circle.worldCOMy+ft*zt,Gt=null,Dt=i.contacts.next;null!=Dt;){var Lt=Dt;if(0==Lt.hash){Gt=Lt;break}Dt=Dt.next}null==Gt?(null==Qn.zpp_pool?Gt=new Qn:(Gt=Qn.zpp_pool,Qn.zpp_pool=Gt.next,Gt.next=null),(Mt=Gt.inner).jnAcc=Mt.jtAcc=0,Gt.hash=0,Gt.fresh=!0,(Gt.arbiter=i).jrAcc=0,Tt=i.contacts,Gt._inuse=!0,(zt=Gt).next=Tt.next,Tt.next=zt,Tt.modified=!0,Tt.length++,i.innards.add(Mt)):Gt.fresh=!1,Gt.px=Et,Gt.py=It,i.nx=gt*Pt,i.ny=ft*Pt,Gt.dist=wt-O,Gt.stamp=i.stamp,Gt.posOnly=!1,Nt=Gt}}return null!=Nt&&(Ft=Nt.inner,i.ptype=2,Bt=Rt=0,Rt=L.x-e.polygon.body.posx,Bt=L.y-e.polygon.body.posy,i.__ref_edge1=Y,i.__ref_vertex=1,n?(Ft.lr1x=Rt*e.polygon.body.axisy+Bt*e.polygon.body.axisx,Ft.lr1y=Bt*e.polygon.body.axisy-Rt*e.polygon.body.axisx,Ft.lr2x=t.circle.localCOMx,Ft.lr2y=t.circle.localCOMy):(Ft.lr2x=Rt*e.polygon.body.axisy+Bt*e.polygon.body.axisx,Ft.lr2y=Bt*e.polygon.body.axisy-Rt*e.polygon.body.axisx,Ft.lr1x=t.circle.localCOMx,Ft.lr1y=t.circle.localCOMy),i.radius=t.circle.radius),null!=Nt}var Bt=t.circle.radius+.5*H,Rt=Y.gnormx*Bt,Ft=Y.gnormy*Bt,Nt=t.circle.worldCOMx-Rt,Bt=t.circle.worldCOMy-Ft;if(n){for(var jt=Y.gnormx,Ut=Y.gnormy,Vt=null,Wt=i.contacts.next;null!=Wt;){var Xt=Wt;if(0==Xt.hash){Vt=Xt;break}Wt=Wt.next}null==Vt?(null==Qn.zpp_pool?Vt=new Qn:(Vt=Qn.zpp_pool,Qn.zpp_pool=Vt.next,Vt.next=null),(Qt=Vt.inner).jnAcc=Qt.jtAcc=0,Vt.hash=0,Vt.fresh=!0,(Vt.arbiter=i).jrAcc=0,Rt=i.contacts,Vt._inuse=!0,(Ft=Vt).next=Rt.next,Rt.next=Ft,Rt.modified=!0,Rt.length++,i.innards.add(Qt)):Vt.fresh=!1,Vt.px=Nt,Vt.py=Bt,i.nx=jt,i.ny=Ut,Vt.dist=H,Vt.stamp=i.stamp,Vt.posOnly=!1,Qt=Vt}else{for(var Ht=-Y.gnormx,qt=-Y.gnormy,Yt=null,Kt=i.contacts.next;null!=Kt;){var Zt=Kt;if(0==Zt.hash){Yt=Zt;break}Kt=Kt.next}null==Yt?(null==Qn.zpp_pool?Yt=new Qn:(Yt=Qn.zpp_pool,Qn.zpp_pool=Yt.next,Yt.next=null),(Jt=Yt.inner).jnAcc=Jt.jtAcc=0,Yt.hash=0,Yt.fresh=!0,(Yt.arbiter=i).jrAcc=0,jt=i.contacts,Yt._inuse=!0,(Ut=Yt).next=jt.next,jt.next=Ut,jt.modified=!0,jt.length++,i.innards.add(Jt)):Yt.fresh=!1,Yt.px=Nt,Yt.py=Bt,i.nx=Ht,i.ny=qt,Yt.dist=H,Yt.stamp=i.stamp,Yt.posOnly=!1,Qt=Yt}return i.ptype=n?0:1,i.lnormx=Y.lnormx,i.lnormy=Y.lnormy,i.rev=!n,i.lproj=Y.lprojection,i.radius=t.circle.radius,Qt.inner.lr1x=t.circle.localCOMx,Qt.inner.lr1y=t.circle.localCOMy,i.__ref_edge1=Y,!(i.__ref_vertex=0)}return!1}var Jt=t.circle.radius+e.circle.radius,Nt=0,Bt=0,Ht=(Nt=e.circle.worldCOMx-t.circle.worldCOMx)*Nt+(Bt=e.circle.worldCOMy-t.circle.worldCOMy)*Bt;if(Jt*Jt<Ht)_e=null;else if(Ht<Er.epsilon*Er.epsilon){for(var Qt,$t=t.circle.worldCOMx,te=t.circle.worldCOMy,ee=null,ie=i.contacts.next;null!=ie;){var ne=ie;if(0==ne.hash){ee=ne;break}ie=ie.next}null==ee?(null==Qn.zpp_pool?ee=new Qn:(ee=Qn.zpp_pool,Qn.zpp_pool=ee.next,ee.next=null),(re=ee.inner).jnAcc=re.jtAcc=0,ee.hash=0,ee.fresh=!0,(ee.arbiter=i).jrAcc=0,qt=i.contacts,ee._inuse=!0,(Qt=ee).next=qt.next,qt.next=Qt,qt.modified=!0,qt.length++,i.innards.add(re)):ee.fresh=!1,ee.px=$t,ee.py=te,i.nx=1,i.ny=0,ee.dist=-Jt,ee.stamp=i.stamp,ee.posOnly=!1,_e=ee}else{var re=1/Math.sqrt(Ht),$t=re<Er.epsilon?1e100:1/re,te=.5+(t.circle.radius-.5*Jt)*re;if(n){for(var oe=t.circle.worldCOMx+Nt*te,se=t.circle.worldCOMy+Bt*te,ae=null,he=i.contacts.next;null!=he;){var le=he;if(0==le.hash){ae=le;break}he=he.next}null==ae?(null==Qn.zpp_pool?ae=new Qn:(ae=Qn.zpp_pool,Qn.zpp_pool=ae.next,ae.next=null),(ue=ae.inner).jnAcc=ue.jtAcc=0,ae.hash=0,ae.fresh=!0,(ae.arbiter=i).jrAcc=0,pe=i.contacts,ae._inuse=!0,(Ht=ae).next=pe.next,pe.next=Ht,pe.modified=!0,pe.length++,i.innards.add(ue)):ae.fresh=!1,ae.px=oe,ae.py=se,i.nx=-Nt*re,i.ny=-Bt*re,ae.dist=$t-Jt,ae.stamp=i.stamp,ae.posOnly=!1,_e=ae}else{for(var pe=t.circle.worldCOMx+Nt*te,ue=t.circle.worldCOMy+Bt*te,de=null,ce=i.contacts.next;null!=ce;){var ye=ce;if(0==ye.hash){de=ye;break}ce=ce.next}null==de?(null==Qn.zpp_pool?de=new Qn:(de=Qn.zpp_pool,Qn.zpp_pool=de.next,de.next=null),(oe=de.inner).jnAcc=oe.jtAcc=0,de.hash=0,de.fresh=!0,(de.arbiter=i).jrAcc=0,se=i.contacts,de._inuse=!0,(te=de).next=se.next,se.next=te,se.modified=!0,se.length++,i.innards.add(oe)):de.fresh=!1,de.px=pe,de.py=ue,i.nx=Nt*re,i.ny=Bt*re,de.dist=$t-Jt,de.stamp=i.stamp,de.posOnly=!1,_e=de}}if(null==_e)return!1;var _e=_e.inner;return n?(_e.lr1x=e.circle.localCOMx,_e.lr1y=e.circle.localCOMy,_e.lr2x=t.circle.localCOMx,_e.lr2y=t.circle.localCOMy):(_e.lr1x=t.circle.localCOMx,_e.lr1y=t.circle.localCOMy,_e.lr2x=e.circle.localCOMx,_e.lr2y=e.circle.localCOMy),i.radius=t.circle.radius+e.circle.radius,i.ptype=2,!0},Ir.testCollide_safe=function(t,e){var i;return 0==e.type&&(i=t,t=e,e=i),Ir.testCollide(t,e)},Ir.testCollide=function(t,e){if(1==e.type){if(1==t.type){for(var i=!0,n=t.polygon.edges.head;null!=n;){for(var r=n.elt,o=1e100,s=e.polygon.gverts.next;null!=s;){var a=s,a=r.gnormx*a.x+r.gnormy*a.y;a<o&&(o=a),s=s.next}if(0<(o-=r.gprojection)){i=!1;break}n=n.next}if(i){for(var h=e.polygon.edges.head;null!=h;){for(var l=h.elt,p=1e100,u=t.polygon.gverts.next;null!=u;){var d=u,d=l.gnormx*d.x+l.gnormy*d.y;d<p&&(p=d),u=u.next}if(0<(p-=l.gprojection)){i=!1;break}h=h.next}return i}return!1}for(var c=null,y=null,_=!0,m=-1e100,g=e.polygon.gverts.next,f=e.polygon.edges.head;null!=f;){var x=f.elt,v=x.gnormx*t.circle.worldCOMx+x.gnormy*t.circle.worldCOMy-x.gprojection-t.circle.radius;if(0<v){_=!1;break}m<v&&(m=v,c=x,y=g),g=g.next,f=f.next}if(_){var w=y,z=(null==y.next?e.polygon.gverts:y).next,b=t.circle.worldCOMy*c.gnormx-t.circle.worldCOMx*c.gnormy;if(b<=w.y*c.gnormx-w.x*c.gnormy){var S=t.circle.radius,C=0,P=0;return(C=w.x-t.circle.worldCOMx)*C+(P=w.y-t.circle.worldCOMy)*P<=S*S}if(b>=z.y*c.gnormx-z.x*c.gnormy){var M=t.circle.radius,b=0,T=0;return(b=z.x-t.circle.worldCOMx)*b+(T=z.y-t.circle.worldCOMy)*T<=M*M}return!0}return!1}var z=t.circle.radius+e.circle.radius,T=0,M=0;return(T=e.circle.worldCOMx-t.circle.worldCOMx)*T+(M=e.circle.worldCOMy-t.circle.worldCOMy)*M<=z*z},Ir.flowCollide=function(t,e,i){if(1==e.type){if(1==t.type){for(var n=[],r=[],o=!0,s=!0,a=t.polygon.edges.head;null!=a;){for(var h=a.elt,l=1e100,p=0,u=e.polygon.gverts.next;null!=u;){var d=u,d=h.gnormx*d.x+h.gnormy*d.y;d<l&&(l=d),d>=h.gprojection+Er.epsilon&&(s=!(r[p]=!0)),++p,u=u.next}if(0<(l-=h.gprojection)){o=!1;break}a=a.next}if(s){var c=e.polygon;if(c.zip_worldCOM&&null!=c.body){if(c.zip_worldCOM=!1,c.zip_localCOM){if(c.zip_localCOM=!1,1==c.type){var y=c.polygon;if(null==y.lverts.next.next)y.localCOMx=y.lverts.next.x,y.localCOMy=y.lverts.next.y;else if(null==y.lverts.next.next.next)y.localCOMx=y.lverts.next.x,y.localCOMy=y.lverts.next.y,y.localCOMx+=y.lverts.next.next.x,y.localCOMy+=y.lverts.next.next.y,y.localCOMx*=.5,y.localCOMy*=.5;else{y.localCOMx=0;var _=y.localCOMy=0,m=y.lverts.next,g=m,f=m=m.next;for(m=m.next;null!=m;){var x=m;_+=f.x*(x.y-g.y);var v=x.y*f.x-x.x*f.y;y.localCOMx+=(f.x+x.x)*v,y.localCOMy+=(f.y+x.y)*v,g=f,f=x,m=m.next}var w=m=y.lverts.next;_+=f.x*(w.y-g.y);var z=w.y*f.x-w.x*f.y;y.localCOMx+=(f.x+w.x)*z,y.localCOMy+=(f.y+w.y)*z;var g=f,b=m=m.next;_+=w.x*(b.y-g.y);z=b.y*w.x-b.x*w.y;y.localCOMx+=(w.x+b.x)*z,y.localCOMy+=(w.y+b.y)*z;b=_=1/(3*_);y.localCOMx*=b,y.localCOMy*=b}}null!=c.wrap_localCOM&&(c.wrap_localCOM.zpp_inner.x=c.localCOMx,c.wrap_localCOM.zpp_inner.y=c.localCOMy)}z=c.body;z.zip_axis&&(z.zip_axis=!1,z.axisx=Math.sin(z.rot),z.axisy=Math.cos(z.rot)),c.worldCOMx=c.body.posx+(c.body.axisy*c.localCOMx-c.body.axisx*c.localCOMy),c.worldCOMy=c.body.posy+(c.localCOMx*c.body.axisx+c.localCOMy*c.body.axisy)}b=e.polygon.area,z=e.polygon.worldCOMx,c=e.polygon.worldCOMy;return i.overlap=b,i.centroidx=z,i.centroidy=c,!0}if(o){for(var s=!0,S=e.polygon.edges.head;null!=S;){for(var C=S.elt,P=1e100,M=0,T=t.polygon.gverts.next;null!=T;){var A=T,A=C.gnormx*A.x+C.gnormy*A.y;A<P&&(P=A),A>=C.gprojection+Er.epsilon&&(s=!(n[M]=!0)),++M,T=T.next}if(0<(P-=C.gprojection)){o=!1;break}S=S.next}if(s){var k=t.polygon;if(k.zip_worldCOM&&null!=k.body){if(k.zip_worldCOM=!1,k.zip_localCOM){if(k.zip_localCOM=!1,1==k.type){var O=k.polygon;if(null==O.lverts.next.next)O.localCOMx=O.lverts.next.x,O.localCOMy=O.lverts.next.y;else if(null==O.lverts.next.next.next)O.localCOMx=O.lverts.next.x,O.localCOMy=O.lverts.next.y,O.localCOMx+=O.lverts.next.next.x,O.localCOMy+=O.lverts.next.next.y,O.localCOMx*=.5,O.localCOMy*=.5;else{O.localCOMx=0;var E=O.localCOMy=0,I=O.lverts.next,G=I,D=I=I.next;for(I=I.next;null!=I;){var L=I;E+=D.x*(L.y-G.y);var B=L.y*D.x-L.x*D.y;O.localCOMx+=(D.x+L.x)*B,O.localCOMy+=(D.y+L.y)*B,G=D,D=L,I=I.next}c=I=O.lverts.next;E+=D.x*(c.y-G.y);var R=c.y*D.x-c.x*D.y;O.localCOMx+=(D.x+c.x)*R,O.localCOMy+=(D.y+c.y)*R;var G=D,F=I=I.next;E+=c.x*(F.y-G.y);R=F.y*c.x-F.x*c.y;O.localCOMx+=(c.x+F.x)*R,O.localCOMy+=(c.y+F.y)*R;F=E=1/(3*E);O.localCOMx*=F,O.localCOMy*=F}}null!=k.wrap_localCOM&&(k.wrap_localCOM.zpp_inner.x=k.localCOMx,k.wrap_localCOM.zpp_inner.y=k.localCOMy)}R=k.body;R.zip_axis&&(R.zip_axis=!1,R.axisx=Math.sin(R.rot),R.axisy=Math.cos(R.rot)),k.worldCOMx=k.body.posx+(k.body.axisy*k.localCOMx-k.body.axisx*k.localCOMy),k.worldCOMy=k.body.posy+(k.localCOMx*k.body.axisx+k.localCOMy*k.body.axisy)}F=t.polygon.area,R=t.polygon.worldCOMx,k=t.polygon.worldCOMy;return i.overlap=F,i.centroidx=R,i.centroidy=k,!0}if(o){for(;null!=Ir.flowpoly.head;){var N=Ir.flowpoly.pop_unsafe();N._inuse||(null!=N.outer&&(N.outer.zpp_inner=null,N.outer=null),N._isimmutable=null,N._validate=null,N._invalidate=null,N.next=Gr.zpp_pool,Gr.zpp_pool=N)}for(var j=null,U=!1,V=t.polygon.gverts.next,W=0,X=e.polygon.gverts.next,H=0,q=0,Y=e.polygon.edgeCnt;q<Y;){var K=q++;if(!r[K]){H=K;break}X=X.next}if(null==X){for(var X=e.polygon.gverts.next,U=!0,Z=0,J=t.polygon.edgeCnt;Z<J;){var Q=Z++;if(!n[Q]){W=Q;break}V=V.next}null==V?V=t.polygon.gverts.next:(Ir.flowpoly.add(V),j=Ir.flowpoly.head.elt)}else Ir.flowpoly.add(X),j=Ir.flowpoly.head.elt;var $=1;if(null==Ir.flowpoly.head){for(var tt=!0,et=t.polygon.gverts.next,it=et,nt=et.next;null!=nt;){for(var rt=nt,ot=2,st=e.polygon.gverts.next,at=st,ht=st.next;null!=ht;){var lt=ht,pt=0,ut=it.x-at.x,dt=it.y-at.y,ct=0,yt=rt.x-it.x,_t=0,mt=0,gt=(ct=rt.y-it.y)*(_t=lt.x-at.x)-yt*(mt=lt.y-at.y);Er.epsilon*Er.epsilon<gt*gt&&(_t=(mt*ut-_t*dt)*(gt=1/gt),Er.epsilon<_t&&_t<1-Er.epsilon&&(Er.epsilon<(gt=(ct*ut-yt*dt)*gt)&&gt<1-Er.epsilon&&(pt=_t,!0)))&&pt<ot&&(ot=pt,X=st),at=lt,ht=(st=ht).next}for(;;){var ft=ht=e.polygon.gverts.next,xt=0,vt=it.x-at.x,wt=it.y-at.y,zt=0,bt=rt.x-it.x,St=0,Ct=0,ft=(zt=rt.y-it.y)*(St=ft.x-at.x)-bt*(Ct=ft.y-at.y);Er.epsilon*Er.epsilon<ft*ft&&(St=(Ct*vt-St*wt)*(ft=1/ft),Er.epsilon<St&&St<1-Er.epsilon&&(Er.epsilon<(ft=(zt*vt-bt*wt)*ft)&&ft<1-Er.epsilon&&(xt=St,!0)))&&xt<ot&&(ot=xt,X=st);break}if(2!=ot){var Pt,Mt=ot,Tt=it.x+(rt.x-it.x)*Mt,Mt=it.y+(rt.y-it.y)*Mt;null==Gr.zpp_pool?Pt=new Gr:(Pt=Gr.zpp_pool,Gr.zpp_pool=Pt.next,Pt.next=null),Pt.weak=!1,Pt._immutable=!1,Pt.x=Tt,Pt.y=Mt,j=Pt,Ir.flowpoly.add(j),V=et,tt=!(U=!0);break}it=rt,nt=(et=nt).next}if(tt)for(;;){for(var At=nt=t.polygon.gverts.next,kt=2,Ot=e.polygon.gverts.next,Et=Ot,It=Ot.next;null!=It;){var Gt=It,Dt=0,Lt=it.x-Et.x,Bt=it.y-Et.y,Rt=0,Ft=At.x-it.x,Nt=0,jt=0,Ut=(Rt=At.y-it.y)*(Nt=Gt.x-Et.x)-Ft*(jt=Gt.y-Et.y);Er.epsilon*Er.epsilon<Ut*Ut&&(Nt=(jt*Lt-Nt*Bt)*(Ut=1/Ut),Er.epsilon<Nt&&Nt<1-Er.epsilon&&(Er.epsilon<(Ut=(Rt*Lt-Ft*Bt)*Ut)&&Ut<1-Er.epsilon&&(Dt=Nt,!0)))&&Dt<kt&&(kt=Dt,X=Ot),Et=Gt,It=(Ot=It).next}for(;;){var Vt=It=e.polygon.gverts.next,Wt=0,Xt=it.x-Et.x,Ht=it.y-Et.y,qt=0,Yt=At.x-it.x,Kt=0,Zt=0,Vt=(qt=At.y-it.y)*(Kt=Vt.x-Et.x)-Yt*(Zt=Vt.y-Et.y);Er.epsilon*Er.epsilon<Vt*Vt&&(Kt=(Zt*Xt-Kt*Ht)*(Vt=1/Vt),Er.epsilon<Kt&&Kt<1-Er.epsilon&&(Er.epsilon<(Vt=(qt*Xt-Yt*Ht)*Vt)&&Vt<1-Er.epsilon&&(Wt=Kt,!0)))&&Wt<kt&&(kt=Wt,X=Ot);break}if(2==kt)break;var Jt,Qt=kt,$t=it.x+(At.x-it.x)*Qt,Qt=it.y+(At.y-it.y)*Qt;null==Gr.zpp_pool?Jt=new Gr:(Jt=Gr.zpp_pool,Gr.zpp_pool=Jt.next,Jt.next=null),Jt.weak=!1,Jt._immutable=!1,Jt.x=$t,Jt.y=Qt,j=Jt,Ir.flowpoly.add(j),U=!0,V=et;break}$=2}for(;;)if(U)if(++W,null==(V=V.next)&&(V=t.polygon.gverts.next,W=0),n[W]){for(var te=Ir.flowpoly.head.elt,ee=V,ie=X,ne=X.next,re=-1,oe=null,se=0,ae=0,he=ne=null==ne?e.polygon.gverts.next:ne,le=ne;;){var pe=le,ue=0,de=ie.x-te.x,ce=ie.y-te.y,ye=0,_e=pe.x-ie.x,me=0,ge=0,fe=(ye=pe.y-ie.y)*(me=ee.x-te.x)-_e*(ge=ee.y-te.y);if(Er.epsilon*Er.epsilon<fe*fe&&(me=(ge*de-me*ce)*(fe=1/fe),Er.epsilon<me&&me<1-Er.epsilon&&(Er.epsilon<(fe=(ye*de-_e*ce)*fe)&&fe<1-Er.epsilon&&(ue=me,!0)))&&-1<=ue){if(oe=X,se=H,(ae=1)==$){re=ue,le=he;break}re=ue}ie=pe,X=le,++H>=e.polygon.edgeCnt&&(H=0),null==(le=le.next)&&(le=e.polygon.gverts.next);break}for(;le!=he;){var xe=le,ve=0,we=ie.x-te.x,ze=ie.y-te.y,be=0,Se=xe.x-ie.x,Ce=0,Pe=0,Me=(be=xe.y-ie.y)*(Ce=ee.x-te.x)-Se*(Pe=ee.y-te.y);if(Er.epsilon*Er.epsilon<Me*Me&&(Ce=(Pe*we-Ce*ze)*(Me=1/Me),Er.epsilon<Ce&&Ce<1-Er.epsilon&&(Er.epsilon<(Me=(be*we-Se*ze)*Me)&&Me<1-Er.epsilon&&(ve=Ce,!0)))&&re<=ve){if(oe=X,se=H,++ae==$){re=ve;break}re=ve}ie=xe,X=le,++H>=e.polygon.edgeCnt&&(H=0),null==(le=le.next)&&(le=e.polygon.gverts.next)}if(null==oe)break;var Te,Ae=oe,ke=oe.next,Oe=ke=null==ke?e.polygon.gverts.next:ke,ne=re,ke=Ae.x+(Oe.x-Ae.x)*ne,ne=Ae.y+(Oe.y-Ae.y)*ne;if(null!=j&&(Ie=Ee=0,(Ee=ke-j.x)*Ee+(Ie=ne-j.y)*Ie<Er.epsilon))break;null==Gr.zpp_pool?Te=new Gr:(Te=Gr.zpp_pool,Gr.zpp_pool=Te.next,Te.next=null),Te.weak=!1,Te._immutable=!1,Te.x=ke,Te.y=ne,Ir.flowpoly.add(Te),null==j&&(j=Ir.flowpoly.head.elt),X=oe,H=se,U=!U,$=2}else{var Ee,Ie,Ge=V;if(null!=j&&(Ee=Ge.x,Ie=Ge.y,ne=ke=0,(ke=Ee-j.x)*ke+(ne=Ie-j.y)*ne<Er.epsilon))break;Ir.flowpoly.add(Ge),null==j&&(j=Ir.flowpoly.head.elt),$=1}else if(++H,null==(X=X.next)&&(X=e.polygon.gverts.next,H=0),r[H]){for(var De=Ir.flowpoly.head.elt,Le=X,Be=V,Re=V.next,Fe=-1,Ne=null,je=0,Ue=0,Ve=Re=null==Re?t.polygon.gverts.next:Re,We=Re;;){var Xe=We,He=0,qe=Be.x-De.x,Ye=Be.y-De.y,Ke=0,Ze=Xe.x-Be.x,Je=0,Qe=0,$e=(Ke=Xe.y-Be.y)*(Je=Le.x-De.x)-Ze*(Qe=Le.y-De.y);if(Er.epsilon*Er.epsilon<$e*$e&&(Je=(Qe*qe-Je*Ye)*($e=1/$e),Er.epsilon<Je&&Je<1-Er.epsilon&&(Er.epsilon<($e=(Ke*qe-Ze*Ye)*$e)&&$e<1-Er.epsilon&&(He=Je,!0)))&&-1<=He){if(Ne=V,je=W,(Ue=1)==$){Fe=He,We=Ve;break}Fe=He}Be=Xe,V=We,++W>=t.polygon.edgeCnt&&(W=0),null==(We=We.next)&&(We=t.polygon.gverts.next);break}for(;We!=Ve;){var ti=We,ei=0,ii=Be.x-De.x,ni=Be.y-De.y,ri=0,oi=ti.x-Be.x,si=0,ai=0,hi=(ri=ti.y-Be.y)*(si=Le.x-De.x)-oi*(ai=Le.y-De.y);if(Er.epsilon*Er.epsilon<hi*hi&&(si=(ai*ii-si*ni)*(hi=1/hi),Er.epsilon<si&&si<1-Er.epsilon&&(Er.epsilon<(hi=(ri*ii-oi*ni)*hi)&&hi<1-Er.epsilon&&(ei=si,!0)))&&Fe<=ei){if(Ne=V,je=W,++Ue==$){Fe=ei;break}Fe=ei}Be=ti,V=We,++W>=t.polygon.edgeCnt&&(W=0),null==(We=We.next)&&(We=t.polygon.gverts.next)}if(null==Ne)break;var li,pi=Ne,ui=Ne.next,Ge=ui=null==ui?t.polygon.gverts.next:ui,Re=Fe,ui=pi.x+(Ge.x-pi.x)*Re,pi=pi.y+(Ge.y-pi.y)*Re;if(null!=j&&(ci=di=0,(di=ui-j.x)*di+(ci=pi-j.y)*ci<Er.epsilon))break;null==Gr.zpp_pool?li=new Gr:(li=Gr.zpp_pool,Gr.zpp_pool=li.next,li.next=null),li.weak=!1,li._immutable=!1,li.x=ui,li.y=pi,Ir.flowpoly.add(li),null==j&&(j=Ir.flowpoly.head.elt),V=Ne,W=je,U=!U,$=2}else{var di,ci,Re=X;if(null!=j&&(di=Re.x,ci=Re.y,pi=ui=0,(ui=di-j.x)*ui+(pi=ci-j.y)*pi<Er.epsilon))break;Ir.flowpoly.add(Re),null==j&&(j=Ir.flowpoly.head.elt),$=1}if(null==Ir.flowpoly.head||null==Ir.flowpoly.head.next||null==Ir.flowpoly.head.next.next)return!1;var yi=0,_i=0,mi=0,_i=0,mi=0,yi=0,gi=Ir.flowpoly.head,fi=gi.elt,xi=(gi=gi.next).elt;for(gi=gi.next;null!=gi;){var vi=gi.elt;yi+=xi.x*(vi.y-fi.y);var wi=vi.y*xi.x-vi.x*xi.y;_i+=(xi.x+vi.x)*wi,mi+=(xi.y+vi.y)*wi,fi=xi,xi=vi,gi=gi.next}k=(gi=Ir.flowpoly.head).elt;yi+=xi.x*(k.y-fi.y);var zi=k.y*xi.x-k.x*xi.y;_i+=(xi.x+k.x)*zi,mi+=(xi.y+k.y)*zi;var fi=xi,bi=(gi=gi.next).elt;yi+=k.x*(bi.y-fi.y);zi=bi.y*k.x-bi.x*k.y;_i+=(k.x+bi.x)*zi,mi+=(k.y+bi.y)*zi;bi=1/(6*(yi*=.5));return _i*=bi,mi*=bi,i.overlap=-yi,i.centroidx=_i,i.centroidy=mi,!0}return!1}return!1}for(var Si=[],Ci=!0,Pi=null,Mi=null,Ti=-1e100,Ai=!0,ki=e.polygon.gverts.next,Oi=0,Ei=e.polygon.edges.head;null!=Ei;){var Ii=Ei.elt,Gi=Ii.gnormx*t.circle.worldCOMx+Ii.gnormy*t.circle.worldCOMy;if(Gi>Ii.gprojection+t.circle.radius){Ai=!1;break}Gi+t.circle.radius>Ii.gprojection+Er.epsilon&&(Si[Oi]=!(Ci=!1)),Ti<(Gi-=Ii.gprojection+t.circle.radius)&&(Ti=Gi,Pi=Ii,Mi=ki),ki=ki.next,++Oi,Ei=Ei.next}if(Ai){if(Ci){var Di=t.circle.area,Li=t.circle.worldCOMx,Bi=t.circle.worldCOMy;return i.overlap=Di,i.centroidx=Li,i.centroidy=Bi,!0}var Ri,zi=Mi,bi=(null==Mi.next?e.polygon.gverts:Mi).next,Di=t.circle.worldCOMy*Pi.gnormx-t.circle.worldCOMx*Pi.gnormy;if(Di<=zi.y*Pi.gnormx-zi.x*Pi.gnormy?(Ri=t.circle.radius,Bi=Li=0,(Li=zi.x-t.circle.worldCOMx)*Li+(Bi=zi.y-t.circle.worldCOMy)*Bi<=Ri*Ri):!(Di>=bi.y*Pi.gnormx-bi.x*Pi.gnormy)||(sn=t.circle.radius,Di=Ri=0,(Ri=bi.x-t.circle.worldCOMx)*Ri+(Di=bi.y-t.circle.worldCOMy)*Di<=sn*sn)){for(var Fi=[],Ni=0,ji=!0,Ui=null,Vi=0,Wi=e.polygon.gverts.next;null!=Wi;){var Xi=Wi,Hi=Xi.x,qi=Xi.y,Yi=t.circle.worldCOMx,Ki=t.circle.worldCOMy,Zi=0,Xi=0;(Fi[Ni]=(Zi=Hi-Yi)*Zi+(Xi=qi-Ki)*Xi<=t.circle.radius*t.circle.radius)?(Vi=Ni,Ui=Wi):ji=!1,++Ni,Wi=Wi.next}if(ji){var Ji=e.polygon;if(Ji.zip_worldCOM&&null!=Ji.body){if(Ji.zip_worldCOM=!1,Ji.zip_localCOM){if(Ji.zip_localCOM=!1,1==Ji.type){var Qi=Ji.polygon;if(null==Qi.lverts.next.next)Qi.localCOMx=Qi.lverts.next.x,Qi.localCOMy=Qi.lverts.next.y;else if(null==Qi.lverts.next.next.next)Qi.localCOMx=Qi.lverts.next.x,Qi.localCOMy=Qi.lverts.next.y,Qi.localCOMx+=Qi.lverts.next.next.x,Qi.localCOMy+=Qi.lverts.next.next.y,Qi.localCOMx*=.5,Qi.localCOMy*=.5;else{Qi.localCOMx=0;var $i=Qi.localCOMy=0,tn=Qi.lverts.next,en=tn,nn=tn=tn.next;for(tn=tn.next;null!=tn;){var rn=tn;$i+=nn.x*(rn.y-en.y);var on=rn.y*nn.x-rn.x*nn.y;Qi.localCOMx+=(nn.x+rn.x)*on,Qi.localCOMy+=(nn.y+rn.y)*on,en=nn,nn=rn,tn=tn.next}var sn=tn=Qi.lverts.next;$i+=nn.x*(sn.y-en.y);var an=sn.y*nn.x-sn.x*nn.y;Qi.localCOMx+=(nn.x+sn.x)*an,Qi.localCOMy+=(nn.y+sn.y)*an;var en=nn,hn=tn=tn.next;$i+=sn.x*(hn.y-en.y);an=hn.y*sn.x-hn.x*sn.y;Qi.localCOMx+=(sn.x+hn.x)*an,Qi.localCOMy+=(sn.y+hn.y)*an;hn=$i=1/(3*$i);Qi.localCOMx*=hn,Qi.localCOMy*=hn}}null!=Ji.wrap_localCOM&&(Ji.wrap_localCOM.zpp_inner.x=Ji.localCOMx,Ji.wrap_localCOM.zpp_inner.y=Ji.localCOMy)}an=Ji.body;an.zip_axis&&(an.zip_axis=!1,an.axisx=Math.sin(an.rot),an.axisy=Math.cos(an.rot)),Ji.worldCOMx=Ji.body.posx+(Ji.body.axisy*Ji.localCOMx-Ji.body.axisx*Ji.localCOMy),Ji.worldCOMy=Ji.body.posy+(Ji.localCOMx*Ji.body.axisx+Ji.localCOMy*Ji.body.axisy)}hn=e.polygon.area,an=e.polygon.worldCOMx,Ji=e.polygon.worldCOMy;return i.overlap=hn,i.centroidx=an,i.centroidy=Ji,!0}for(;null!=Ir.flowpoly.head;){var ln=Ir.flowpoly.pop_unsafe();ln._inuse||(null!=ln.outer&&(ln.outer.zpp_inner=null,ln.outer=null),ln._isimmutable=null,ln._validate=null,ln._invalidate=null,ln.next=Gr.zpp_pool,Gr.zpp_pool=ln)}Ir.flowsegs.clear();var pn=null,un=1;for(null==Ui?(Ui=e.polygon.gverts.next,un=2):(pn=Ui,Ir.flowpoly.add(pn));0!=un;)if(1==un)if(null==(Ui=Ui.next)&&(Ui=e.polygon.gverts.next),Fi[Vi=++Vi>=e.polygon.edgeCnt?0:Vi]){var dn=pn.x,cn=pn.y,yn=0,_n=0;if((yn=dn-Ui.x)*yn+(_n=cn-Ui.y)*_n<Er.epsilon)break;Ir.flowpoly.add(Ui)}else{var mn,gn=Ir.flowpoly.head.elt,fn=Ui,xn=0,dn=0,yn=0,cn=0,_n=(xn=fn.x-gn.x)*xn+(dn=fn.y-gn.y)*dn,dn=2*((yn=gn.x-t.circle.worldCOMx)*xn+(cn=gn.y-t.circle.worldCOMy)*dn),yn=Math.sqrt(dn*dn-4*_n*(yn*yn+cn*cn-t.circle.radius*t.circle.radius)),cn=(-dn-yn)*(_n=1/(2*_n)),_n=cn<Er.epsilon?(-dn+yn)*_n:cn,cn=gn.x+(fn.x-gn.x)*_n,fn=gn.y+(fn.y-gn.y)*_n,gn=0,_n=0;if((gn=pn.x-cn)*gn+(_n=pn.y-fn)*_n<Er.epsilon)break;null==Gr.zpp_pool?mn=new Gr:(mn=Gr.zpp_pool,Gr.zpp_pool=mn.next,mn.next=null),mn.weak=!1,mn._immutable=!1,mn.x=cn,mn.y=fn,Ir.flowpoly.add(mn),un=2}else if(2==un){for(var fn=Ui.next,vn=Ui,un=0,wn=fn=null==fn?e.polygon.gverts.next:fn,zn=fn;;){var bn=zn,Sn=Vi+1;if(Sn==e.polygon.edgeCnt&&(Sn=0),Si[Vi]){if(Fi[Sn]){var Cn,Pn=0,Mn=0,Tn=0,An=0,kn=(Pn=bn.x-vn.x)*Pn+(Mn=bn.y-vn.y)*Mn,On=2*((Tn=vn.x-t.circle.worldCOMx)*Pn+(An=vn.y-t.circle.worldCOMy)*Mn),En=Math.sqrt(On*On-4*kn*(Tn*Tn+An*An-t.circle.radius*t.circle.radius)),Pn=(-On-En)*(kn=1/(2*kn)),Mn=Pn<Er.epsilon?(-On+En)*kn:Pn,Tn=vn.x+(bn.x-vn.x)*Mn,An=vn.y+(bn.y-vn.y)*Mn,On=0,En=0;if((On=pn.x-Tn)*On+(En=pn.y-An)*En<Er.epsilon){un=0,zn=wn;break}null==Gr.zpp_pool?Cn=new Gr:(Cn=Gr.zpp_pool,Gr.zpp_pool=Cn.next,Cn.next=null),Cn.weak=!1,Cn._immutable=!1,Cn.x=Tn,Cn.y=An;var kn=Cn;Ir.flowsegs.add(Ir.flowpoly.head.elt),Ir.flowsegs.add(kn),Ir.flowpoly.add(kn),un=1,zn=wn;break}Pn=0,Mn=0,On=0,En=0,Tn=0,An=0,kn=(On=bn.x-vn.x)*On+(En=bn.y-vn.y)*En,En=2*((Tn=vn.x-t.circle.worldCOMx)*On+(An=vn.y-t.circle.worldCOMy)*En),Tn=En*En-4*kn*(Tn*Tn+An*An-t.circle.radius*t.circle.radius),An=Tn*Tn<Er.epsilon?(Pn=Tn<0?10:Mn=-En/(2*kn),!1):(Pn=(-En-(Tn=Math.sqrt(Tn)))*(kn=1/(2*kn)),Mn=(-En+Tn)*kn,!0);if(Pn<1-Er.epsilon&&Er.epsilon<Mn){var In,En=Pn,Tn=vn.x+(bn.x-vn.x)*En,kn=vn.y+(bn.y-vn.y)*En;if(null!=pn&&(En=Pn=0,(Pn=pn.x-Tn)*Pn+(En=pn.y-kn)*En<Er.epsilon)){un=0,zn=wn;break}null==Gr.zpp_pool?In=new Gr:(In=Gr.zpp_pool,Gr.zpp_pool=In.next,In.next=null),In.weak=!1,In._immutable=!1,In.x=Tn,In.y=kn;var Gn,kn=In;null!=Ir.flowpoly.head&&(Ir.flowsegs.add(Ir.flowpoly.head.elt),Ir.flowsegs.add(kn)),Ir.flowpoly.add(kn),null==pn&&(pn=Ir.flowpoly.head.elt),An&&(An=kn=0,Mn=Mn,kn=vn.x+(bn.x-vn.x)*Mn,An=vn.y+(bn.y-vn.y)*Mn,null==Gr.zpp_pool?Gn=new Gr:(Gn=Gr.zpp_pool,Gr.zpp_pool=Gn.next,Gn.next=null),Gn.weak=!1,Gn._immutable=!1,Gn.x=kn,Gn.y=An,Ir.flowpoly.add(Gn))}}vn=bn,Vi=Sn,null==(zn=(Ui=zn).next)&&(zn=e.polygon.gverts.next);break}for(;zn!=wn;){var Dn=zn,Ln=Vi+1;if(Ln==e.polygon.edgeCnt&&(Ln=0),Si[Vi]){if(Fi[Ln]){var Bn,Rn=0,Fn=0,Nn=0,jn=0,Un=(Rn=Dn.x-vn.x)*Rn+(Fn=Dn.y-vn.y)*Fn,Vn=2*((Nn=vn.x-t.circle.worldCOMx)*Rn+(jn=vn.y-t.circle.worldCOMy)*Fn),Wn=Math.sqrt(Vn*Vn-4*Un*(Nn*Nn+jn*jn-t.circle.radius*t.circle.radius)),Rn=(-Vn-Wn)*(Un=1/(2*Un)),Fn=Rn<Er.epsilon?(-Vn+Wn)*Un:Rn,Nn=vn.x+(Dn.x-vn.x)*Fn,jn=vn.y+(Dn.y-vn.y)*Fn,Vn=0,Wn=0;if((Vn=pn.x-Nn)*Vn+(Wn=pn.y-jn)*Wn<Er.epsilon){un=0;break}null==Gr.zpp_pool?Bn=new Gr:(Bn=Gr.zpp_pool,Gr.zpp_pool=Bn.next,Bn.next=null),Bn.weak=!1,Bn._immutable=!1,Bn.x=Nn,Bn.y=jn;var Un=Bn;Ir.flowsegs.add(Ir.flowpoly.head.elt),Ir.flowsegs.add(Un),Ir.flowpoly.add(Un),un=1;break}Rn=0,Fn=0,Vn=0,Wn=0,Nn=0,jn=0,Un=(Vn=Dn.x-vn.x)*Vn+(Wn=Dn.y-vn.y)*Wn,Wn=2*((Nn=vn.x-t.circle.worldCOMx)*Vn+(jn=vn.y-t.circle.worldCOMy)*Wn),Nn=Wn*Wn-4*Un*(Nn*Nn+jn*jn-t.circle.radius*t.circle.radius),jn=Nn*Nn<Er.epsilon?(Rn=Nn<0?10:Fn=-Wn/(2*Un),!1):(Rn=(-Wn-(Nn=Math.sqrt(Nn)))*(Un=1/(2*Un)),Fn=(-Wn+Nn)*Un,!0);if(Rn<1-Er.epsilon&&Er.epsilon<Fn){var Xn,Wn=Rn,Nn=vn.x+(Dn.x-vn.x)*Wn,Un=vn.y+(Dn.y-vn.y)*Wn;if(null!=pn&&(Wn=Rn=0,(Rn=pn.x-Nn)*Rn+(Wn=pn.y-Un)*Wn<Er.epsilon)){un=0;break}null==Gr.zpp_pool?Xn=new Gr:(Xn=Gr.zpp_pool,Gr.zpp_pool=Xn.next,Xn.next=null),Xn.weak=!1,Xn._immutable=!1,Xn.x=Nn,Xn.y=Un;var Hn,Un=Xn;null!=Ir.flowpoly.head&&(Ir.flowsegs.add(Ir.flowpoly.head.elt),Ir.flowsegs.add(Un)),Ir.flowpoly.add(Un),null==pn&&(pn=Ir.flowpoly.head.elt),jn&&(jn=Un=0,Fn=Fn,Un=vn.x+(Dn.x-vn.x)*Fn,jn=vn.y+(Dn.y-vn.y)*Fn,null==Gr.zpp_pool?Hn=new Gr:(Hn=Gr.zpp_pool,Gr.zpp_pool=Hn.next,Hn.next=null),Hn.weak=!1,Hn._immutable=!1,Hn.x=Un,Hn.y=jn,Ir.flowpoly.add(Hn))}}vn=Dn,Vi=Ln,null==(zn=(Ui=zn).next)&&(zn=e.polygon.gverts.next)}}if(null==Ir.flowpoly.head)return!1;if(null==Ir.flowpoly.head.next){for(var qn=!0,Yn=e.polygon.edges.head;null!=Yn;){var Kn=Yn.elt;if(Kn.gnormx*t.circle.worldCOMx+Kn.gnormy*t.circle.worldCOMy>Kn.gprojection){qn=!1;break}Yn=Yn.next}if(qn){var Ji=t.circle.area,Zn=t.circle.worldCOMx,Jn=t.circle.worldCOMy;return i.overlap=Ji,i.centroidx=Zn,i.centroidy=Jn,!0}return!1}var Qn=0,$n=0,tr=0;if(null!=Ir.flowpoly.head.next.next){var er=0,ir=0,nr=0,ir=0,nr=0,er=0,rr=Ir.flowpoly.head,or=rr.elt,sr=(rr=rr.next).elt;for(rr=rr.next;null!=rr;){var ar=rr.elt;er+=sr.x*(ar.y-or.y);var hr=ar.y*sr.x-ar.x*sr.y;ir+=(sr.x+ar.x)*hr,nr+=(sr.y+ar.y)*hr,or=sr,sr=ar,rr=rr.next}var lr=(rr=Ir.flowpoly.head).elt;er+=sr.x*(lr.y-or.y);var pr=lr.y*sr.x-lr.x*sr.y;ir+=(sr.x+lr.x)*pr,nr+=(sr.y+lr.y)*pr;var or=sr,ur=(rr=rr.next).elt;er+=lr.x*(ur.y-or.y);var dr=ur.y*lr.x-ur.x*lr.y;ir+=(lr.x+ur.x)*dr,nr+=(lr.y+ur.y)*dr;var cr=1/(6*(er*=.5)),yr=-er;Qn+=(ir*=cr)*yr,$n+=(nr*=cr)*yr,tr=0-er}else Ir.flowsegs.add(Ir.flowpoly.head.elt),Ir.flowsegs.add(Ir.flowpoly.head.next.elt);for(;null!=Ir.flowsegs.head;){var _r=Ir.flowsegs.pop_unsafe(),mr=Ir.flowsegs.pop_unsafe(),gr=0,fr=0,gr=mr.x-_r.x,fr=mr.y-_r.y,xr=1/Math.sqrt(gr*gr+fr*fr),vr=gr*=xr;gr=-(fr*=xr);var wr=_r.x+mr.x,zr=_r.y+mr.y;wr*=.5,zr*=.5;var xr=gr*(wr-=t.circle.worldCOMx)+(fr=vr)*(zr-=t.circle.worldCOMy),_r=xr/t.circle.radius,mr=Math.sqrt(1-_r*_r),vr=Math.acos(_r),xr=t.circle.radius*(t.circle.radius*vr-xr*mr),mr=.6666666666666666*t.circle.radius*mr*mr*mr/(vr-_r*mr);wr=t.circle.worldCOMx,zr=t.circle.worldCOMy,Qn+=(wr+=gr*mr)*xr,$n+=(zr+=fr*mr)*xr,tr+=xr}Zn=1/tr;return Qn*=Zn,$n*=Zn,i.overlap=tr,i.centroidx=Qn,i.centroidy=$n,!0}return!1}return!1}var Jn=t.circle,pr=e.circle,lr=pr.worldCOMx-Jn.worldCOMx,ur=pr.worldCOMy-Jn.worldCOMy,dr=Jn.radius+pr.radius,cr=lr*lr+ur*ur;if(dr*dr<cr)return!1;if(cr<Er.epsilon*Er.epsilon)return Jn.radius<pr.radius?(yr=Jn.area,Zn=Jn.worldCOMx,dr=Jn.worldCOMy,i.overlap=yr,i.centroidx=Zn,i.centroidy=dr):(Ar=pr.area,kr=pr.worldCOMx,Or=pr.worldCOMy,i.overlap=Ar,i.centroidx=kr,i.centroidy=Or),!0;var br,Sr,Cr,Pr,Mr,Tr,Ar=Math.sqrt(cr),kr=1/Ar,Or=.5*(Ar-(pr.radius*pr.radius-Jn.radius*Jn.radius)*kr);return Or<=-Jn.radius?(br=Jn.area,Sr=Jn.worldCOMx,Tr=Jn.worldCOMy,i.overlap=br,i.centroidx=Sr,i.centroidy=Tr):(cr=Ar-Or)<=-pr.radius?(Pr=pr.area,Mr=pr.worldCOMx,Cr=pr.worldCOMy,i.overlap=Pr,i.centroidx=Mr,i.centroidy=Cr):(Tr=Sr=br=0,Pr=Or/Jn.radius,Mr=Math.sqrt(1-Pr*Pr),Cr=Math.acos(Pr),br=Jn.radius*(Jn.radius*Cr-Or*Mr),Sr=.6666666666666666*Jn.radius*Mr*Mr*Mr/(Cr-Pr*Mr),Cr=cr/pr.radius,Pr=Math.sqrt(1-Cr*Cr),Mr=Math.acos(Cr),cr=br+(Tr=pr.radius*(pr.radius*Mr-cr*Pr)),kr=(Sr*br+(Ar-.6666666666666666*pr.radius*Pr*Pr*Pr/(Mr-Cr*Pr))*Tr)/cr*kr,lr=Jn.worldCOMx+lr*kr,kr=Jn.worldCOMy+ur*kr,i.overlap=cr,i.centroidx=lr,i.centroidy=kr),!0},Ir.prototype.__class__=Ir;var de=zpp_nape.geom.ZPP_Convex=function(){};de.__name__=["zpp_nape","geom","ZPP_Convex"],de.isinner=function(t,e,i){var n=t.x-e.x,r=t.y-e.y,t=i.x-e.x;return 0<=(i.y-e.y)*n-t*r},de.optimise=function(t){var e=t.vertices,i=t.vertices;if(null!=e)for(var n=e;;)if(n.sort(),(n=n.next)==i)break;var e=t.vertices,r=t.vertices;if(null!=e)for(var o=e;;){for(var s=o,a=s.prev,h=null,l=s.diagonals.head;null!=l;){var p=l.elt;if(de.isinner(null==l.next?s.next:l.next.elt,s,a)){for(var u=!0,d=p.prev,c=null,y=p.diagonals.head;null!=y;){var _=y.elt;if(_==s){u=de.isinner(null==y.next?p.next:y.next.elt,p,d);break}d=_,y=(c=y).next}u?(l=s.diagonals.erase(h),p.diagonals.erase(c)):(a=p,l=(h=l).next)}else a=p,l=(h=l).next}if((o=o.next)==r)break}},de.prototype.__class__=de;var ce=zpp_nape.geom.ZPP_ConvexRayResult=function(){this.toiDistance=0,this.next=null,this.inner=!1,this.ray=null,this.position=null,this.convex=null,this.shape=null,this.normal=null};ce.__name__=["zpp_nape","geom","ZPP_ConvexRayResult"],ce.getRay=function(t,e,i,n){var r;null==ce.rayPool?(ce.internal=!0,(r=new H).zpp_inner=new ce,r.zpp_inner.ray=r,ce.internal=!1):(r=ce.rayPool.ray,ce.rayPool=ce.rayPool.next,r.zpp_inner.next=null);var o=r.zpp_inner;return(o.normal=t).zpp_inner._immutable=!0,o.toiDistance=e,o.inner=i,o.shape=n,r},ce.getConvex=function(t,e,i,n){var r;null==ce.convexPool?(ce.internal=!0,(r=new j).zpp_inner=new ce,r.zpp_inner.convex=r,ce.internal=!1):(r=ce.convexPool.convex,ce.convexPool=ce.convexPool.next,r.zpp_inner.next=null);var o=r.zpp_inner;return o.normal=t,o.position=e,t.zpp_inner._immutable=!0,e.zpp_inner._immutable=!0,o.toiDistance=i,o.shape=n,r},ce.prototype.normal=null,ce.prototype.shape=null,ce.prototype.convex=null,ce.prototype.position=null,ce.prototype.ray=null,ce.prototype.inner=null,ce.prototype.next=null,ce.prototype.toiDistance=null,ce.prototype.disposed=function(){},ce.prototype.free=function(){this.normal.zpp_inner._immutable=!1;var t=this.normal,e=t.zpp_inner;t.zpp_inner.outer=null,t.zpp_inner=null,t.zpp_pool=Bn.poolVec2,Bn.poolVec2=t,null!=e.outer&&(e.outer.zpp_inner=null,e.outer=null),e._isimmutable=null,e._validate=null,e._invalidate=null,e.next=Gr.zpp_pool,Gr.zpp_pool=e,null!=this.position&&(this.position.zpp_inner._immutable=!1,e=(t=this.position).zpp_inner,t.zpp_inner.outer=null,t.zpp_inner=null,t.zpp_pool=Bn.poolVec2,Bn.poolVec2=t,null!=e.outer&&(e.outer.zpp_inner=null,e.outer=null),e._isimmutable=null,e._validate=null,e._invalidate=null,e.next=Gr.zpp_pool,Gr.zpp_pool=e),this.shape=null,this.toiDistance=0,null!=this.convex?(this.next=ce.convexPool,ce.convexPool=this):(this.next=ce.rayPool,ce.rayPool=this)},ce.prototype.__class__=ce;var gi=zpp_nape.geom.ZPP_CutVert=function(){this.used=!1,this.rank=0,this.parent=null,this.positive=!1,this.value=0,this.vert=null,this.posy=0,this.posx=0,this.next=null,this.prev=null};gi.__name__=["zpp_nape","geom","ZPP_CutVert"],gi.path=function(t){var e;return null==gi.zpp_pool?e=new gi:(e=gi.zpp_pool,gi.zpp_pool=e.next,e.next=null),e.vert=t,(e.parent=e).rank=0,e.used=!1,e},gi.prototype.prev=null,gi.prototype.next=null,gi.prototype.posx=null,gi.prototype.posy=null,gi.prototype.vert=null,gi.prototype.value=null,gi.prototype.positive=null,gi.prototype.parent=null,gi.prototype.rank=null,gi.prototype.used=null,gi.prototype.alloc=function(){},gi.prototype.free=function(){this.vert=null,this.parent=null},gi.prototype.__class__=gi;var fi=zpp_nape.geom.ZPP_CutInt=function(){this.path1=null,this.start=null,this.end=null,this.path0=null,this.vertex=!1,this.virtualint=!1,this.time=0,this.next=null};fi.__name__=["zpp_nape","geom","ZPP_CutInt"],fi.get=function(t,e,i,n,r,o,s){var a;return null==s&&(s=!1),null==o&&(o=!1),null==fi.zpp_pool?a=new fi:(a=fi.zpp_pool,fi.zpp_pool=a.next,a.next=null),a.virtualint=o,a.end=e,a.start=i,a.path0=n,a.path1=r,a.time=t,a.vertex=s,a},fi.prototype.next=null,fi.prototype.time=null,fi.prototype.virtualint=null,fi.prototype.vertex=null,fi.prototype.path0=null,fi.prototype.end=null,fi.prototype.start=null,fi.prototype.path1=null,fi.prototype.alloc=function(){},fi.prototype.free=function(){this.end=this.start=null,this.path0=this.path1=null},fi.prototype.__class__=fi;var xi=zpp_nape.geom.ZPP_Cutter=function(){};xi.__name__=["zpp_nape","geom","ZPP_Cutter"],xi.run=function(t,e,i,n,r,o){var s=e.zpp_inner;null!=s._validate&&s._validate();var a=e.zpp_inner.x,s=e.zpp_inner;null!=s._validate&&s._validate();var h=e.zpp_inner.y,l=0,e=i.zpp_inner;null!=e._validate&&e._validate();var p=i.zpp_inner.x-a,e=i.zpp_inner;null!=e._validate&&e._validate();for(var u,d=n?0:-1/0,c=r?1:1/0,y=-(h*p-a*(l=i.zpp_inner.y-h)),_=null,m=!1,g=t;;){null==gi.zpp_pool?u=new gi:(u=gi.zpp_pool,gi.zpp_pool=u.next,u.next=null),u.vert=g,u.posx=u.vert.x,u.posy=u.vert.y,u.value=u.posy*p-u.posx*l+y,u.positive=0<u.value,0==u.value&&(m=!0);var f=u;if(null==_?_=f.prev=f.next=f:(f.prev=_,f.next=_.next,_.next.prev=f,_.next=f),_=f,(g=g.next)==t)break}if(m){var x=null,v=_;if(null!=_)for(var w=_;;){var z=w;if(0!=z.value){x=z;break}if((w=w.next)==v)break}var b=p,S=l,C=1/Math.sqrt(b*b+S*S),P=b*=C;b=-(S*=C),S=P;for(var M=null,T=x;;)if(0==T.value||null!=M&&T!=M.next){var A=M.value*T.value;if(0!=A){var k,O=M.next;if(0<A)k=M.positive;else{var E=O.next,A=O.posx+E.posx,E=O.posy+E.posy,I=(A*=.5)+1e-8*b,G=(E*=.5)+1e-8*S,D=!1;if(null!=t)for(var L=t;;){var B=L,R=B.prev;if((B.y<G&&R.y>=G||R.y<G&&B.y>=G)&&(B.x<=I||R.x<=I)&&B.x+(G-B.y)/(R.y-B.y)*(R.x-B.x)<I&&(D=!D),(L=L.next)==t)break}k=D}var F=T;if(null!=O)for(var N=O;;)if(N.positive=k,(N=N.next)==F)break;if((T=(M=T).next)==x)break}else if((T=T.next)==x)break}else if((T=(M=T).next)==x)break;for(;;){if(0!=T.value&&(null==M||T==M.next)){T=(M=T).next;break}var j=M.value*T.value;if(0==j){T=T.next;break}var U,V=M.next;if(0<j)U=M.positive;else{var W=V.next,j=V.posx+W.posx,W=V.posy+W.posy,X=(j*=.5)+1e-8*b,H=(W*=.5)+1e-8*S,q=!1;if(null!=t)for(var Y=t;;){var K=Y,Z=K.prev;if((K.y<H&&Z.y>=H||Z.y<H&&K.y>=H)&&(K.x<=X||Z.x<=X)&&K.x+(H-K.y)/(Z.y-K.y)*(Z.x-K.x)<X&&(q=!q),(Y=Y.next)==t)break}U=q}var J=T;if(null!=V)for(var Q=V;;)if(Q.positive=U,(Q=Q.next)==J)break;T=(M=T).next;break}}null==xi.ints&&(xi.ints=new wi),null==xi.paths&&(xi.paths=new zi);var $=null,C=_.posx,P=_.posy;null==nn.zpp_pool?tt=new nn:(tt=nn.zpp_pool,nn.zpp_pool=tt.next,tt.next=null),tt.forced=!1,tt.x=C,tt.y=P;P=tt;null==$?$=P.prev=P.next=P:(P.next=$,P.prev=$.prev,$.prev.next=P,$.prev=P);var tt=$;null==gi.zpp_pool?Mt=new gi:(Mt=gi.zpp_pool,gi.zpp_pool=Mt.next,Mt.next=null),Mt.vert=$,(Mt.parent=Mt).rank=0,Mt.used=!1;P=Mt;xi.paths.add(P);for(var et=_;;){var it,nt=et.next,rt=nt.posx,ot=nt.posy;null==nn.zpp_pool?it=new nn:(it=nn.zpp_pool,nn.zpp_pool=it.next,it.next=null),it.forced=!1,it.x=rt,it.y=ot;var st,at,ht,lt,pt,ut,dt,ct,yt,_t,mt,gt,ft,xt,vt,wt,zt,bt,St,Ct,Pt=it;if(et.positive==nt.positive?null==$?$=Pt.prev=Pt.next=Pt:(Pt.next=$,Pt.prev=$.prev,$.prev.next=Pt,$.prev=Pt):(st=0,st=nt.posx-et.posx,lt=ht=at=0,(pt=((at=nt.posy-et.posy)*(ht=a-et.posx)-st*(lt=h-et.posy))*(wt=1/(wt=l*st-p*at)))<d||c<pt?(null==fi.zpp_pool?ut=new fi:(ut=fi.zpp_pool,fi.zpp_pool=ut.next,ut.next=null),ut.virtualint=!0,ut.end=null,ut.start=null,ut.path0=null,ut.path1=null,ut.time=pt,ut.vertex=!1,xi.ints.add(ut),null==$?$=Pt.prev=Pt.next=Pt:(Pt.next=$,Pt.prev=$.prev,$.prev.next=Pt,$.prev=Pt)):0==et.value?(_t=(rt=$.prev).x,ot=rt.y,($=null)==nn.zpp_pool?dt=new nn:(dt=nn.zpp_pool,nn.zpp_pool=dt.next,dt.next=null),dt.forced=!1,dt.x=_t,dt.y=ot,_t=dt,null==$?$=_t.prev=_t.next=_t:(_t.next=$,_t.prev=$.prev,$.prev.next=_t,$.prev=_t),null==$?$=Pt.prev=Pt.next=Pt:(Pt.next=$,Pt.prev=$.prev,$.prev.next=Pt,$.prev=Pt),ot=xi.paths.head.elt,null==gi.zpp_pool?ct=new gi:(ct=gi.zpp_pool,gi.zpp_pool=ct.next,ct.next=null),ct.vert=$,(ct.parent=ct).rank=0,ct.used=!1,xi.paths.add(ct),_t=xi.paths.head.elt,null==fi.zpp_pool?yt=new fi:(yt=fi.zpp_pool,fi.zpp_pool=yt.next,yt.next=null),yt.virtualint=!0,yt.end=rt,yt.start=$,yt.path0=ot,yt.path1=_t,yt.time=pt,yt.vertex=!1,xi.ints.add(yt)):0==nt.value?(null==$?$=Pt.prev=Pt.next=Pt:(Pt.next=$,Pt.prev=$.prev,$.prev.next=Pt,$.prev=Pt),_t=$.prev,bt=nt.posx,vt=nt.posy,($=null)==nn.zpp_pool?mt=new nn:(mt=nn.zpp_pool,nn.zpp_pool=mt.next,mt.next=null),mt.forced=!1,mt.x=bt,mt.y=vt,bt=mt,null==$?$=bt.prev=bt.next=bt:(bt.next=$,bt.prev=$.prev,$.prev.next=bt,$.prev=bt),vt=xi.paths.head.elt,null==gi.zpp_pool?gt=new gi:(gt=gi.zpp_pool,gi.zpp_pool=gt.next,gt.next=null),gt.vert=$,(gt.parent=gt).rank=0,gt.used=!1,xi.paths.add(gt),bt=xi.paths.head.elt,null==fi.zpp_pool?ft=new fi:(ft=fi.zpp_pool,fi.zpp_pool=ft.next,ft.next=null),ft.virtualint=!0,ft.end=_t,ft.start=$,ft.path0=vt,ft.path1=bt,ft.time=pt,ft.vertex=!1,xi.ints.add(ft)):(bt=vt=0,vt=et.posx,bt=et.posy,vt+=st*(wt=(l*ht-p*lt)*wt),bt+=at*wt,null==nn.zpp_pool?xt=new nn:(xt=nn.zpp_pool,nn.zpp_pool=xt.next,xt.next=null),xt.forced=!1,xt.x=vt,xt.y=bt,wt=xt,null==$?$=wt.prev=wt.next=wt:(wt.next=$,wt.prev=$.prev,$.prev.next=wt,$.prev=wt),wt=$.prev,($=null)==nn.zpp_pool?zt=new nn:(zt=nn.zpp_pool,nn.zpp_pool=zt.next,zt.next=null),zt.forced=!1,zt.x=vt,zt.y=bt,bt=zt,null==$?$=bt.prev=bt.next=bt:(bt.next=$,bt.prev=$.prev,$.prev.next=bt,$.prev=bt),null==$?$=Pt.prev=Pt.next=Pt:(Pt.next=$,Pt.prev=$.prev,$.prev.next=Pt,$.prev=Pt),bt=xi.paths.head.elt,null==gi.zpp_pool?St=new gi:(St=gi.zpp_pool,gi.zpp_pool=St.next,St.next=null),St.vert=$,(St.parent=St).rank=0,St.used=!1,xi.paths.add(St),Pt=xi.paths.head.elt,null==fi.zpp_pool?Ct=new fi:(Ct=fi.zpp_pool,fi.zpp_pool=Ct.next,Ct.next=null),Ct.virtualint=!1,Ct.end=wt,Ct.start=$,Ct.path0=bt,Ct.path1=Pt,Ct.time=pt,Ct.vertex=!1,xi.ints.add(Ct))),(et=et.next)==_)break}var Mt=$.prev;Mt.next.prev=tt.prev,tt.prev.next=Mt.next,(Mt.next=tt).prev=Mt;var Tt,Mt=xi.paths.head.elt;if(P==P.parent)Bt=P;else{for(var At=P,kt=null;At!=At.parent;){var Ot=At.parent;At.parent=kt,kt=At,At=Ot}for(;null!=kt;){var Et=kt.parent;kt.parent=At,kt=Et}Bt=At}if(Mt==Mt.parent)Tt=Mt;else{for(var It=Mt,Gt=null;It!=It.parent;){var Dt=It.parent;It.parent=Gt,Gt=It,It=Dt}for(;null!=Gt;){var Lt=Gt.parent;Gt.parent=It,Gt=Lt}Tt=It}Bt!=Tt&&(Bt.rank<Tt.rank?Bt.parent=Tt:Bt.rank>Tt.rank?Tt.parent=Bt:(Tt.parent=Bt).rank++);var Bt=xi.ints;if(null!=Bt.head&&null!=Bt.head.next){for(var Rt,Ft,Nt,jt=Bt.head,Ut=null,Vt=null,Wt=null,Xt=null,Ht=1;;){for(Rt=0,Vt=jt,Ut=jt=null;null!=Vt;){for(++Rt,Wt=Vt,Ft=0,Nt=Ht;null!=Wt&&Ft<Ht;)++Ft,Wt=Wt.next;for(;0<Ft||0<Nt&&null!=Wt;)0!=Ft&&(0==Nt||null==Wt||Vt.elt.time<Wt.elt.time)?(Vt=(Xt=Vt).next,--Ft):(Wt=(Xt=Wt).next,--Nt),null!=Ut?Ut.next=Xt:jt=Xt,Ut=Xt;Vt=Wt}if(Ut.next=null,Ht<<=1,!(1<Rt))break}Bt.head=jt,Bt.modified=!0,Bt.pushmod=!0}for(;null!=xi.ints.head;){var qt,Yt,Kt,Zt,Jt=xi.ints.pop_unsafe(),Qt=xi.ints.pop_unsafe();if(Jt.virtualint||Qt.virtualint){if(Jt.virtualint&&!Qt.virtualint){var $t,te,ee,ie,ne,re,oe,se,ae,he,le,pe=null!=Qt.end&&Qt.end.prev==Qt.end?((Qt.end.next=Qt.end.prev=null)!=(ee=Qt.end).wrap&&(ee.wrap.zpp_inner._inuse=!1,te=($t=ee.wrap).zpp_inner,$t.zpp_inner.outer=null,$t.zpp_inner=null,$t.zpp_pool=Bn.poolVec2,Bn.poolVec2=$t,null!=te.outer&&(te.outer.zpp_inner=null,te.outer=null),te._isimmutable=null,te._validate=null,te._invalidate=null,te.next=Gr.zpp_pool,Gr.zpp_pool=te,ee.wrap=null),ee.prev=ee.next=null,ee.next=nn.zpp_pool,nn.zpp_pool=ee,null):(pe=Qt.end.prev,Qt.end.prev.next=Qt.end.next,Qt.end.next.prev=Qt.end.prev,(Qt.end.next=Qt.end.prev=null)!=($t=Qt.end).wrap&&($t.wrap.zpp_inner._inuse=!1,ee=(te=$t.wrap).zpp_inner,te.zpp_inner.outer=null,te.zpp_inner=null,te.zpp_pool=Bn.poolVec2,Bn.poolVec2=te,null!=ee.outer&&(ee.outer.zpp_inner=null,ee.outer=null),ee._isimmutable=null,ee._validate=null,ee._invalidate=null,ee.next=Gr.zpp_pool,Gr.zpp_pool=ee,$t.wrap=null),$t.prev=$t.next=null,$t.next=nn.zpp_pool,nn.zpp_pool=$t,Qt.end=null,pe);if(Qt.end=pe,Qt.vertex||(Qt.end!=Qt.path0.vert?(Qt.start.x=Qt.end.x,Qt.start.y=Qt.end.y,re=null!=Qt.end&&Qt.end.prev==Qt.end?((Qt.end.next=Qt.end.prev=null)!=(ne=Qt.end).wrap&&(ne.wrap.zpp_inner._inuse=!1,ie=(pe=ne.wrap).zpp_inner,pe.zpp_inner.outer=null,pe.zpp_inner=null,pe.zpp_pool=Bn.poolVec2,Bn.poolVec2=pe,null!=ie.outer&&(ie.outer.zpp_inner=null,ie.outer=null),ie._isimmutable=null,ie._validate=null,ie._invalidate=null,ie.next=Gr.zpp_pool,Gr.zpp_pool=ie,ne.wrap=null),ne.prev=ne.next=null,ne.next=nn.zpp_pool,nn.zpp_pool=ne,null):(ae=Qt.end.prev,Qt.end.prev.next=Qt.end.next,Qt.end.next.prev=Qt.end.prev,(Qt.end.next=Qt.end.prev=null)!=(re=Qt.end).wrap&&(re.wrap.zpp_inner._inuse=!1,ne=(ie=re.wrap).zpp_inner,ie.zpp_inner.outer=null,ie.zpp_inner=null,ie.zpp_pool=Bn.poolVec2,Bn.poolVec2=ie,null!=ne.outer&&(ne.outer.zpp_inner=null,ne.outer=null),ne._isimmutable=null,ne._validate=null,ne._invalidate=null,ne.next=Gr.zpp_pool,Gr.zpp_pool=ne,re.wrap=null),re.prev=re.next=null,re.next=nn.zpp_pool,nn.zpp_pool=re,Qt.end=null,ae),Qt.end=re):(ae=Qt.start.next,Qt.start.x=ae.x,Qt.start.y=ae.y,null!=ae&&ae.prev==ae?((ae.next=ae.prev=null)!=(se=ae).wrap&&(se.wrap.zpp_inner._inuse=!1,oe=(re=se.wrap).zpp_inner,re.zpp_inner.outer=null,re.zpp_inner=null,re.zpp_pool=Bn.poolVec2,Bn.poolVec2=re,null!=oe.outer&&(oe.outer.zpp_inner=null,oe.outer=null),oe._isimmutable=null,oe._validate=null,oe._invalidate=null,oe.next=Gr.zpp_pool,Gr.zpp_pool=oe,se.wrap=null),se.prev=se.next=null,se.next=nn.zpp_pool,nn.zpp_pool=se,ae=null):(ae.prev.next=ae.next,ae.next.prev=ae.prev,(ae.next=ae.prev=null)!=(oe=ae).wrap&&(oe.wrap.zpp_inner._inuse=!1,ae=(se=oe.wrap).zpp_inner,se.zpp_inner.outer=null,se.zpp_inner=null,se.zpp_pool=Bn.poolVec2,Bn.poolVec2=se,null!=ae.outer&&(ae.outer.zpp_inner=null,ae.outer=null),ae._isimmutable=null,ae._validate=null,ae._invalidate=null,ae.next=Gr.zpp_pool,Gr.zpp_pool=ae,oe.wrap=null),oe.prev=oe.next=null,oe.next=nn.zpp_pool,nn.zpp_pool=oe))),Qt.end.next.prev=Qt.start.prev,Qt.start.prev.next=Qt.end.next,Qt.end.next=Qt.start,Qt.start.prev=Qt.end,Qt.path0==Qt.path0.parent)he=Qt.path0;else{for(var ue=Qt.path0,de=null;ue!=ue.parent;){var ce=ue.parent;ue.parent=de,de=ue,ue=ce}for(;null!=de;){var ye=de.parent;de.parent=ue,de=ye}he=ue}if(Qt.path1==Qt.path1.parent)le=Qt.path1;else{for(var _e=Qt.path1,me=null;_e!=_e.parent;){var ge=_e.parent;_e.parent=me,me=_e,_e=ge}for(;null!=me;){var fe=me.parent;me.parent=_e,me=fe}le=_e}he!=le&&(he.rank<le.rank?he.parent=le:he.rank>le.rank?le.parent=he:(le.parent=he).rank++)}else if(Qt.virtualint&&!Jt.virtualint){var xe,ve,we,ze,be,Se,Ce,Pe,Me,Te,Ae,ke=null!=Jt.end&&Jt.end.prev==Jt.end?((Jt.end.next=Jt.end.prev=null)!=(we=Jt.end).wrap&&(we.wrap.zpp_inner._inuse=!1,ve=(xe=we.wrap).zpp_inner,xe.zpp_inner.outer=null,xe.zpp_inner=null,xe.zpp_pool=Bn.poolVec2,Bn.poolVec2=xe,null!=ve.outer&&(ve.outer.zpp_inner=null,ve.outer=null),ve._isimmutable=null,ve._validate=null,ve._invalidate=null,ve.next=Gr.zpp_pool,Gr.zpp_pool=ve,we.wrap=null),we.prev=we.next=null,we.next=nn.zpp_pool,nn.zpp_pool=we,null):(ke=Jt.end.prev,Jt.end.prev.next=Jt.end.next,Jt.end.next.prev=Jt.end.prev,(Jt.end.next=Jt.end.prev=null)!=(xe=Jt.end).wrap&&(xe.wrap.zpp_inner._inuse=!1,we=(ve=xe.wrap).zpp_inner,ve.zpp_inner.outer=null,ve.zpp_inner=null,ve.zpp_pool=Bn.poolVec2,Bn.poolVec2=ve,null!=we.outer&&(we.outer.zpp_inner=null,we.outer=null),we._isimmutable=null,we._validate=null,we._invalidate=null,we.next=Gr.zpp_pool,Gr.zpp_pool=we,xe.wrap=null),xe.prev=xe.next=null,xe.next=nn.zpp_pool,nn.zpp_pool=xe,Jt.end=null,ke);if(Jt.end=ke,Jt.vertex||(Jt.end!=Jt.path0.vert?(Jt.start.x=Jt.end.x,Jt.start.y=Jt.end.y,Se=null!=Jt.end&&Jt.end.prev==Jt.end?((Jt.end.next=Jt.end.prev=null)!=(be=Jt.end).wrap&&(be.wrap.zpp_inner._inuse=!1,ze=(ke=be.wrap).zpp_inner,ke.zpp_inner.outer=null,ke.zpp_inner=null,ke.zpp_pool=Bn.poolVec2,Bn.poolVec2=ke,null!=ze.outer&&(ze.outer.zpp_inner=null,ze.outer=null),ze._isimmutable=null,ze._validate=null,ze._invalidate=null,ze.next=Gr.zpp_pool,Gr.zpp_pool=ze,be.wrap=null),be.prev=be.next=null,be.next=nn.zpp_pool,nn.zpp_pool=be,null):(Me=Jt.end.prev,Jt.end.prev.next=Jt.end.next,Jt.end.next.prev=Jt.end.prev,(Jt.end.next=Jt.end.prev=null)!=(Se=Jt.end).wrap&&(Se.wrap.zpp_inner._inuse=!1,be=(ze=Se.wrap).zpp_inner,ze.zpp_inner.outer=null,ze.zpp_inner=null,ze.zpp_pool=Bn.poolVec2,Bn.poolVec2=ze,null!=be.outer&&(be.outer.zpp_inner=null,be.outer=null),be._isimmutable=null,be._validate=null,be._invalidate=null,be.next=Gr.zpp_pool,Gr.zpp_pool=be,Se.wrap=null),Se.prev=Se.next=null,Se.next=nn.zpp_pool,nn.zpp_pool=Se,Jt.end=null,Me),Jt.end=Se):(Me=Jt.start.next,Jt.start.x=Me.x,Jt.start.y=Me.y,null!=Me&&Me.prev==Me?((Me.next=Me.prev=null)!=(Pe=Me).wrap&&(Pe.wrap.zpp_inner._inuse=!1,Ce=(Se=Pe.wrap).zpp_inner,Se.zpp_inner.outer=null,Se.zpp_inner=null,Se.zpp_pool=Bn.poolVec2,Bn.poolVec2=Se,null!=Ce.outer&&(Ce.outer.zpp_inner=null,Ce.outer=null),Ce._isimmutable=null,Ce._validate=null,Ce._invalidate=null,Ce.next=Gr.zpp_pool,Gr.zpp_pool=Ce,Pe.wrap=null),Pe.prev=Pe.next=null,Pe.next=nn.zpp_pool,nn.zpp_pool=Pe,Me=null):(Me.prev.next=Me.next,Me.next.prev=Me.prev,(Me.next=Me.prev=null)!=(Ce=Me).wrap&&(Ce.wrap.zpp_inner._inuse=!1,Me=(Pe=Ce.wrap).zpp_inner,Pe.zpp_inner.outer=null,Pe.zpp_inner=null,Pe.zpp_pool=Bn.poolVec2,Bn.poolVec2=Pe,null!=Me.outer&&(Me.outer.zpp_inner=null,Me.outer=null),Me._isimmutable=null,Me._validate=null,Me._invalidate=null,Me.next=Gr.zpp_pool,Gr.zpp_pool=Me,Ce.wrap=null),Ce.prev=Ce.next=null,Ce.next=nn.zpp_pool,nn.zpp_pool=Ce))),Jt.end.next.prev=Jt.start.prev,Jt.start.prev.next=Jt.end.next,Jt.end.next=Jt.start,Jt.start.prev=Jt.end,Jt.path0==Jt.path0.parent)Te=Jt.path0;else{for(var Oe=Jt.path0,Ee=null;Oe!=Oe.parent;){var Ie=Oe.parent;Oe.parent=Ee,Ee=Oe,Oe=Ie}for(;null!=Ee;){var Ge=Ee.parent;Ee.parent=Oe,Ee=Ge}Te=Oe}if(Jt.path1==Jt.path1.parent)Ae=Jt.path1;else{for(var De=Jt.path1,Le=null;De!=De.parent;){var Be=De.parent;De.parent=Le,Le=De,De=Be}for(;null!=Le;){var Re=Le.parent;Le.parent=De,Le=Re}Ae=De}Te!=Ae&&(Te.rank<Ae.rank?Te.parent=Ae:Te.rank>Ae.rank?Ae.parent=Te:(Ae.parent=Te).rank++)}}else{if(Jt.end.next.prev=Qt.start.prev,Qt.start.prev.next=Jt.end.next,Jt.end.next=Qt.start,Qt.start.prev=Jt.end,Qt.end.next.prev=Jt.start.prev,Jt.start.prev.next=Qt.end.next,Qt.end.next=Jt.start,Jt.start.prev=Qt.end,Jt.path0==Jt.path0.parent)qt=Jt.path0;else{for(var Fe=Jt.path0,Ne=null;Fe!=Fe.parent;){var je=Fe.parent;Fe.parent=Ne,Ne=Fe,Fe=je}for(;null!=Ne;){var Ue=Ne.parent;Ne.parent=Fe,Ne=Ue}qt=Fe}if(Qt.path1==Qt.path1.parent)Yt=Qt.path1;else{for(var Ve=Qt.path1,We=null;Ve!=Ve.parent;){var Xe=Ve.parent;Ve.parent=We,We=Ve,Ve=Xe}for(;null!=We;){var He=We.parent;We.parent=Ve,We=He}Yt=Ve}if(qt!=Yt&&(qt.rank<Yt.rank?qt.parent=Yt:qt.rank>Yt.rank?Yt.parent=qt:(Yt.parent=qt).rank++),Jt.path1==Jt.path1.parent)Kt=Jt.path1;else{for(var qe=Jt.path1,Ye=null;qe!=qe.parent;){var Ke=qe.parent;qe.parent=Ye,Ye=qe,qe=Ke}for(;null!=Ye;){var Ze=Ye.parent;Ye.parent=qe,Ye=Ze}Kt=qe}if(Qt.path0==Qt.path0.parent)Zt=Qt.path0;else{for(var Je=Qt.path0,Qe=null;Je!=Je.parent;){var $e=Je.parent;Je.parent=Qe,Qe=Je,Je=$e}for(;null!=Qe;){var ti=Qe.parent;Qe.parent=Je,Qe=ti}Zt=Je}Kt!=Zt&&(Kt.rank<Zt.rank?Kt.parent=Zt:Kt.rank>Zt.rank?Zt.parent=Kt:(Zt.parent=Kt).rank++)}Jt.end=Jt.start=null,Jt.path0=Jt.path1=null,Jt.next=fi.zpp_pool,fi.zpp_pool=Jt,Qt.end=Qt.start=null,Qt.path0=Qt.path1=null,Qt.next=fi.zpp_pool,fi.zpp_pool=Qt}for(var ei=null==o?new mi:o,ii=xi.paths.head;null!=ii;){var ni,ri=ii.elt;if(ri==ri.parent)ni=ri;else{for(var oi=ri,si=null;oi!=oi.parent;){var ai=oi.parent;oi.parent=si,si=oi,oi=ai}for(;null!=si;){var hi=si.parent;si.parent=oi,si=hi}ni=oi}if(ni.used)ii=ii.next;else{ni.used=!0;for(var li=ni.vert,pi=!0;null!=ni.vert&&(pi||li!=ni.vert);)var ui,pi=!1,li=li.x==li.next.x&&li.y==li.next.y?(li==ni.vert&&(ni.vert=li.next==li?null:li.next,pi=!0),null!=li&&li.prev==li?li.next=li.prev=null:(ui=li.next,li.prev.next=li.next,li.next.prev=li.prev,li.next=li.prev=null,li=null,ui)):li.next;null!=ni.vert&&((ri=_i.get()).zpp_inner.vertices=ni.vert,ei.zpp_inner.reverse_flag?ei.push(ri):ei.unshift(ri)),ii=ii.next}}for(;null!=xi.paths.head;){var di=xi.paths.pop_unsafe();di.vert=null,di.parent=null,di.next=gi.zpp_pool,gi.zpp_pool=di}for(;null!=_;)var ci,yi,_=null!=_&&_.prev==_?(_.next=_.prev=null,(yi=_).vert=null,yi.parent=null,yi.next=gi.zpp_pool,gi.zpp_pool=yi,null):(ci=_.next,_.prev.next=_.next,_.next.prev=_.prev,_.next=_.prev=null,(yi=_).vert=null,yi.parent=null,yi.next=gi.zpp_pool,gi.zpp_pool=yi,_=null,ci);return ei},xi.prototype.__class__=xi;var ye=zpp_nape.geom.ZPP_Geom=function(){};ye.__name__=["zpp_nape","geom","ZPP_Geom"],ye.validateShape=function(t){if(1==t.type){var e=t.polygon;if(e.zip_gaxi&&null!=e.body){e.zip_gaxi=!1,e.validate_laxi();var i=e.body;if(i.zip_axis&&(i.zip_axis=!1,i.axisx=Math.sin(i.rot),i.axisy=Math.cos(i.rot)),e.zip_gverts&&null!=e.body){e.zip_gverts=!1,e.validate_lverts();var n=e.body;n.zip_axis&&(n.zip_axis=!1,n.axisx=Math.sin(n.rot),n.axisy=Math.cos(n.rot));for(var r=e.lverts.next,o=e.gverts.next;null!=o;){var s=o,a=r,r=r.next;s.x=e.body.posx+(e.body.axisy*a.x-e.body.axisx*a.y),s.y=e.body.posy+(a.x*e.body.axisx+a.y*e.body.axisy),o=o.next}}for(var h=e.edges.head,l=p=e.gverts.next,p=p.next;null!=p;){var u=p,d=h.elt,h=h.next;d.gp0=l,d.gp1=u,d.gnormx=e.body.axisy*d.lnormx-e.body.axisx*d.lnormy,d.gnormy=d.lnormx*e.body.axisx+d.lnormy*e.body.axisy,d.gprojection=e.body.posx*d.gnormx+e.body.posy*d.gnormy+d.lprojection,null!=d.wrap_gnorm&&(d.wrap_gnorm.zpp_inner.x=d.gnormx,d.wrap_gnorm.zpp_inner.y=d.gnormy),d.tp0=d.gp0.y*d.gnormx-d.gp0.x*d.gnormy,d.tp1=d.gp1.y*d.gnormx-d.gp1.x*d.gnormy,l=u,p=p.next}i=h.elt;i.gp0=l,i.gp1=e.gverts.next,i.gnormx=e.body.axisy*i.lnormx-e.body.axisx*i.lnormy,i.gnormy=i.lnormx*e.body.axisx+i.lnormy*e.body.axisy,i.gprojection=e.body.posx*i.gnormx+e.body.posy*i.gnormy+i.lprojection,null!=i.wrap_gnorm&&(i.wrap_gnorm.zpp_inner.x=i.gnormx,i.wrap_gnorm.zpp_inner.y=i.gnormy),i.tp0=i.gp0.y*i.gnormx-i.gp0.x*i.gnormy,i.tp1=i.gp1.y*i.gnormx-i.gp1.x*i.gnormy}}if(t.zip_aabb&&null!=t.body)if(t.zip_aabb=!1,0==t.type){n=t.circle;if(n.zip_worldCOM&&null!=n.body){if(n.zip_worldCOM=!1,n.zip_localCOM){if(n.zip_localCOM=!1,1==n.type){var c=n.polygon;if(null==c.lverts.next.next)c.localCOMx=c.lverts.next.x,c.localCOMy=c.lverts.next.y;else if(null==c.lverts.next.next.next)c.localCOMx=c.lverts.next.x,c.localCOMy=c.lverts.next.y,c.localCOMx+=c.lverts.next.next.x,c.localCOMy+=c.lverts.next.next.y,c.localCOMx*=.5,c.localCOMy*=.5;else{c.localCOMx=0;var y=c.localCOMy=0,_=c.lverts.next,m=_,g=_=_.next;for(_=_.next;null!=_;){var f=_;y+=g.x*(f.y-m.y);var x=f.y*g.x-f.x*g.y;c.localCOMx+=(g.x+f.x)*x,c.localCOMy+=(g.y+f.y)*x,m=g,g=f,_=_.next}i=_=c.lverts.next;y+=g.x*(i.y-m.y);var v=i.y*g.x-i.x*g.y;c.localCOMx+=(g.x+i.x)*v,c.localCOMy+=(g.y+i.y)*v;var m=g,w=_=_.next;y+=i.x*(w.y-m.y);v=w.y*i.x-w.x*i.y;c.localCOMx+=(i.x+w.x)*v,c.localCOMy+=(i.y+w.y)*v;w=y=1/(3*y);c.localCOMx*=w,c.localCOMy*=w}}null!=n.wrap_localCOM&&(n.wrap_localCOM.zpp_inner.x=n.localCOMx,n.wrap_localCOM.zpp_inner.y=n.localCOMy)}v=n.body;v.zip_axis&&(v.zip_axis=!1,v.axisx=Math.sin(v.rot),v.axisy=Math.cos(v.rot)),n.worldCOMx=n.body.posx+(n.body.axisy*n.localCOMx-n.body.axisx*n.localCOMy),n.worldCOMy=n.body.posy+(n.localCOMx*n.body.axisx+n.localCOMy*n.body.axisy)}w=n.radius,v=n.radius;n.aabb.minx=n.worldCOMx-w,n.aabb.miny=n.worldCOMy-v,n.aabb.maxx=n.worldCOMx+w,n.aabb.maxy=n.worldCOMy+v}else{var z=t.polygon;if(z.zip_gverts&&null!=z.body){z.zip_gverts=!1,z.validate_lverts();var b=z.body;b.zip_axis&&(b.zip_axis=!1,b.axisx=Math.sin(b.rot),b.axisy=Math.cos(b.rot));for(var S=z.lverts.next,C=z.gverts.next;null!=C;){var P=C,M=S,S=S.next;P.x=z.body.posx+(z.body.axisy*M.x-z.body.axisx*M.y),P.y=z.body.posy+(M.x*z.body.axisx+M.y*z.body.axisy),C=C.next}}var T=z.gverts.next;z.aabb.minx=T.x,z.aabb.miny=T.y,z.aabb.maxx=T.x,z.aabb.maxy=T.y;for(var A=z.gverts.next.next;null!=A;){var k=A;k.x<z.aabb.minx&&(z.aabb.minx=k.x),k.x>z.aabb.maxx&&(z.aabb.maxx=k.x),k.y<z.aabb.miny&&(z.aabb.miny=k.y),k.y>z.aabb.maxy&&(z.aabb.maxy=k.y),A=A.next}}if(t.zip_worldCOM&&null!=t.body){if(t.zip_worldCOM=!1,t.zip_localCOM){if(t.zip_localCOM=!1,1==t.type){var O=t.polygon;if(null==O.lverts.next.next)O.localCOMx=O.lverts.next.x,O.localCOMy=O.lverts.next.y;else if(null==O.lverts.next.next.next)O.localCOMx=O.lverts.next.x,O.localCOMy=O.lverts.next.y,O.localCOMx+=O.lverts.next.next.x,O.localCOMy+=O.lverts.next.next.y,O.localCOMx*=.5,O.localCOMy*=.5;else{O.localCOMx=0;var E=O.localCOMy=0,I=O.lverts.next,G=I,D=I=I.next;for(I=I.next;null!=I;){var L=I;E+=D.x*(L.y-G.y);var B=L.y*D.x-L.x*D.y;O.localCOMx+=(D.x+L.x)*B,O.localCOMy+=(D.y+L.y)*B,G=D,D=L,I=I.next}b=I=O.lverts.next;E+=D.x*(b.y-G.y);var R=b.y*D.x-b.x*D.y;O.localCOMx+=(D.x+b.x)*R,O.localCOMy+=(D.y+b.y)*R;G=D,T=I=I.next;E+=b.x*(T.y-G.y);R=T.y*b.x-T.x*b.y;O.localCOMx+=(b.x+T.x)*R,O.localCOMy+=(b.y+T.y)*R;R=E=1/(3*E);O.localCOMx*=R,O.localCOMy*=R}}null!=t.wrap_localCOM&&(t.wrap_localCOM.zpp_inner.x=t.localCOMx,t.wrap_localCOM.zpp_inner.y=t.localCOMy)}R=t.body;R.zip_axis&&(R.zip_axis=!1,R.axisx=Math.sin(R.rot),R.axisy=Math.cos(R.rot)),t.worldCOMx=t.body.posx+(t.body.axisy*t.localCOMx-t.body.axisx*t.localCOMy),t.worldCOMy=t.body.posy+(t.localCOMx*t.body.axisx+t.localCOMy*t.body.axisy)}},ye.prototype.__class__=ye;var nn=zpp_nape.geom.ZPP_GeomVert=function(){this.forced=!1,this.wrap=null,this.next=null,this.prev=null,this.y=0,this.x=0};nn.__name__=["zpp_nape","geom","ZPP_GeomVert"],nn.get=function(t,e){var i;return null==nn.zpp_pool?i=new nn:(i=nn.zpp_pool,nn.zpp_pool=i.next,i.next=null),i.forced=!1,i.x=t,i.y=e,i},nn.prototype.x=null,nn.prototype.y=null,nn.prototype.prev=null,nn.prototype.next=null,nn.prototype.wrap=null,nn.prototype.forced=null,nn.prototype.free=function(){var t,e;null!=this.wrap&&(this.wrap.zpp_inner._inuse=!1,e=(t=this.wrap).zpp_inner,t.zpp_inner.outer=null,t.zpp_inner=null,t.zpp_pool=Bn.poolVec2,Bn.poolVec2=t,null!=e.outer&&(e.outer.zpp_inner=null,e.outer=null),e._isimmutable=null,e._validate=null,e._invalidate=null,e.next=Gr.zpp_pool,Gr.zpp_pool=e,this.wrap=null),this.prev=this.next=null},nn.prototype.alloc=function(){this.forced=!1},nn.prototype.wrapper=function(){var t,e,i,n;return null==this.wrap&&(t=this.x,n=this.y,null==Bn.poolVec2?e=new St:(e=Bn.poolVec2,Bn.poolVec2=e.zpp_pool,e.zpp_pool=null),null==e.zpp_inner?(null==Gr.zpp_pool?i=new Gr:(i=Gr.zpp_pool,Gr.zpp_pool=i.next,i.next=null),i.weak=!1,i._immutable=!1,i.x=t,i.y=n,e.zpp_inner=i,e.zpp_inner.outer=e):(null!=(i=e.zpp_inner)._validate&&i._validate(),e.zpp_inner.x==t&&(null!=(i=e.zpp_inner)._validate&&i._validate(),e.zpp_inner.y==n)||(e.zpp_inner.x=t,e.zpp_inner.y=n,null!=(n=e.zpp_inner)._invalidate&&n._invalidate(n))),e.zpp_inner.weak=!1,this.wrap=e,this.wrap.zpp_inner._inuse=!0,this.wrap.zpp_inner._invalidate=Z(this,this.modwrap),this.wrap.zpp_inner._validate=Z(this,this.getwrap)),this.wrap},nn.prototype.modwrap=function(t){this.x=t.x,this.y=t.y},nn.prototype.getwrap=function(){this.wrap.zpp_inner.x=this.x,this.wrap.zpp_inner.y=this.y},nn.prototype.__class__=nn;var _e=zpp_nape.geom.ZPP_GeomPoly=function(t){this.vertices=null,this.outer=null,this.outer=t};_e.__name__=["zpp_nape","geom","ZPP_GeomPoly"],_e.prototype.outer=null,_e.prototype.vertices=null,_e.prototype.__class__=_e;var me=zpp_nape.geom.ZPP_GeomVertexIterator=function(){this.next=null,this.outer=null,this.forward=!1,this.first=!1,this.start=null,this.ptr=null,this.outer=new U};me.__name__=["zpp_nape","geom","ZPP_GeomVertexIterator"],me.get=function(t,e){var i;return null==me.zpp_pool?i=new me:(i=me.zpp_pool,me.zpp_pool=i.next,i.next=null),(i.outer.zpp_inner=i).ptr=t,i.forward=e,i.start=t,i.first=null!=t,i.outer},me.prototype.ptr=null,me.prototype.start=null,me.prototype.first=null,me.prototype.forward=null,me.prototype.outer=null,me.prototype.next=null,me.prototype.free=function(){this.outer.zpp_inner=null,this.ptr=this.start=null},me.prototype.alloc=function(){},me.prototype.__class__=me;var ge=zpp_nape.geom.ZPP_MarchSpan=function(){this.next=null,this.out=!1,this.rank=0,this.parent=null,this.parent=this};ge.__name__=["zpp_nape","geom","ZPP_MarchSpan"],ge.prototype.parent=null,ge.prototype.rank=null,ge.prototype.out=null,ge.prototype.next=null,ge.prototype.free=function(){this.parent=this},ge.prototype.alloc=function(){this.out=!1,this.rank=0},ge.prototype.__class__=ge;var rn=zpp_nape.geom.ZPP_MarchPair=function(){this.next=null,this.spanr=null,this.span2=null,this.span1=null,this.pd=null,this.okeyr=0,this.keyr=0,this.pr=null,this.okey2=0,this.key2=0,this.p2=null,this.okey1=0,this.key1=0,this.p1=null};rn.__name__=["zpp_nape","geom","ZPP_MarchPair"],rn.prototype.p1=null,rn.prototype.key1=null,rn.prototype.okey1=null,rn.prototype.p2=null,rn.prototype.key2=null,rn.prototype.okey2=null,rn.prototype.pr=null,rn.prototype.keyr=null,rn.prototype.okeyr=null,rn.prototype.pd=null,rn.prototype.span1=null,rn.prototype.span2=null,rn.prototype.spanr=null,rn.prototype.next=null,rn.prototype.free=function(){this.p1=this.p2=this.pr=this.pd=null,this.span1=this.span2=this.spanr=null},rn.prototype.alloc=function(){},rn.prototype.__class__=rn;var on=zpp_nape.geom.ZPP_MarchingSquares=function(){};on.__name__=["zpp_nape","geom","ZPP_MarchingSquares"],on.isos=null,on.ints=null,on.map=null,on.run=function(t,e,i,n,r,o,s,a,h){var l=n-e,p=o.zpp_inner;null!=p._validate&&p._validate();var u=l/o.zpp_inner.x,d=0|u,p=r-i,l=o.zpp_inner;null!=l._validate&&l._validate();var p=p/o.zpp_inner.y,c=0|p;u!=d&&++d,p!=c&&++c,a&&(null==on.map?on.map=new ai(d,c):on.map.resize(d,c,null)),null==on.isos?on.isos=new oi(d+1,c+1):on.isos.resize(d+1,c+1,0);for(var y=0,_=c+1;y<_;){var m,g,f=y++;g=0==f?i:f<=c?(null!=(m=o.zpp_inner)._validate&&m._validate(),i+o.zpp_inner.y*f):r;for(var x=0,v=d+1;x<v;){var w=x++;b=0==w?e:w<=d?(null!=(z=o.zpp_inner)._validate&&z._validate(),e+o.zpp_inner.x*w):n;var z=on.isos,b=t(b,g);z.list[f*z.width+w]=b}}null==on.ints?on.ints=new si(d+1,1+(c<<1)):on.ints.resize(d+1,1+(c<<1),null);var S=null;a&&(null==ge.zpp_pool?S=new ge:(S=ge.zpp_pool,ge.zpp_pool=S.next,S.next=null),S.out=!1,S.rank=0);for(var C=i,P=0,M=c;P<M;)for(var T,A=P++,k=C,O=A==c-1?r:(null!=(T=o.zpp_inner)._validate&&T._validate(),i+o.zpp_inner.y*(1+A)),C=O,E=e,I=null,G=0,D=d;G<D;){var L,B,R=G++,F=E,N=R==d-1?n:(null!=(N=o.zpp_inner)._validate&&N._validate(),e+o.zpp_inner.x*(1+R)),E=N,F=on.me.marchSquare(t,on.isos,on.ints,F,k,N,O,R,A,0==R||!a,0==A||!a,R==d-1||!a,A==c-1||!a,s);null!=F?a?(N=null!=F.p2&&14!=F.okey2?F.p2:F.p1,F.pd=(0==(128&(N==F.p2?F.okey2:F.okey1))?N:N.prev).prev,(N=on.map).list[A*N.width+R]=F,null!=I&&(N=0!=(1&(R=1&(N=F.key1)|(192&N)>>5))?1:0,0!=(2&R)&&++N,0!=(4&R)&&++N,2<=N)?(on.me.combLR(I,F),F.span1=I.spanr):(null==ge.zpp_pool?F.span1=new ge:(F.span1=ge.zpp_pool,ge.zpp_pool=F.span1.next,F.span1.next=null),(L=F.span1).out=!1,L.rank=0,F.span1.next=S,S=F.span1),null!=F.p2?(null==ge.zpp_pool?F.span2=new ge:(F.span2=ge.zpp_pool,ge.zpp_pool=F.span2.next,F.span2.next=null),(B=F.span2).out=!1,B.rank=0,F.span2.next=S,S=F.span2,F.spanr=F.span2):F.spanr=F.span1,B=0!=(1&(L=(28&F.keyr)>>2))?1:0,0!=(2&L)&&++B,0!=(4&L)&&++B,I=2<=B?F:null):(on.me.output(h,F.p1),null!=F.p2&&on.me.output(h,F.p2),F.p1=F.p2=F.pr=F.pd=null,F.span1=F.span2=F.spanr=null,F.next=rn.zpp_pool,rn.zpp_pool=F):I=null}if(a){for(var j=1,U=c;j<U;)for(var V=j++,W=null,X=0,H=d;X<H;){var q=X++,Y=on.map,K=Y.list[V*Y.width+q];if(null!=K){var Z=7&(null!=K.p2&&14==K.okey2?K.okey2:K.okey1),Y=0!=(1&Z)?1:0;if(0!=(2&Z)&&++Y,0!=(4&Z)&&++Y,Y<2)W=null;else{Z=on.map,Y=Z.list[(V-1)*Z.width+q];if(null!=Y){Z=(112&(null!=Y.p2&&56==Y.okey2?Y.okey2:Y.okey1))>>4,q=0!=(1&Z)?1:0;if(0!=(2&Z)&&++q,0!=(4&Z)&&++q,q<2)W=null;else{var J,Q,$,tt,Z=null!=Y.p2&&56==Y.okey2?Y.span2:Y.span1,q=null!=K.p2&&14==K.okey2?K.span2:K.span1;if(Z==Z.parent)J=Z;else{for(var et=Z,it=null;et!=et.parent;){var nt=et.parent;et.parent=it,it=et,et=nt}for(;null!=it;){var rt=it.parent;it.parent=et,it=rt}J=et}if(q==q.parent)Q=q;else{for(var ot=q,st=null;ot!=ot.parent;){var at=ot.parent;ot.parent=st,st=ot,ot=at}for(;null!=st;){var ht=st.parent;st.parent=ot,st=ht}Q=ot}if(J==Q)W!=q&&on.me.combUD_virtual(Y,K);else{if(Z==Z.parent)$=Z;else{for(var lt=Z,pt=null;lt!=lt.parent;){var ut=lt.parent;lt.parent=pt,pt=lt,lt=ut}for(;null!=pt;){var dt=pt.parent;pt.parent=lt,pt=dt}$=lt}if(q==q.parent)tt=q;else{for(var ct=q,yt=null;ct!=ct.parent;){var _t=ct.parent;ct.parent=yt,yt=ct,ct=_t}for(;null!=yt;){var mt=yt.parent;yt.parent=ct,yt=mt}tt=ct}$!=tt&&($.rank<tt.rank?$.parent=tt:$.rank>tt.rank?tt.parent=$:(tt.parent=$).rank++),on.me.combUD(Y,K)}W=0!=(4&(q==K.span2?K.okey2:K.okey1))?q:null}}else W=null}}else W=null}for(var gt=0,ft=c;gt<ft;)for(var xt=gt++,vt=0,wt=d;vt<wt;){var zt,bt=vt++,St=on.map,St=St.list[xt*St.width+bt];if(null!=St){if(St.span1==St.span1.parent)zt=St.span1;else{for(var Ct=St.span1,Pt=null;Ct!=Ct.parent;){var Mt=Ct.parent;Ct.parent=Pt,Pt=Ct,Ct=Mt}for(;null!=Pt;){var Tt=Pt.parent;Pt.parent=Ct,Pt=Tt}zt=Ct}if(zt.out||(zt.out=!0,on.me.output(h,St.p1)),null!=St.p2){if(St.span2==St.span2.parent)zt=St.span2;else{for(var At=St.span2,kt=null;At!=At.parent;){var Ot=At.parent;At.parent=kt,kt=At,At=Ot}for(;null!=kt;){var Et=kt.parent;kt.parent=At,kt=Et}zt=At}zt.out||(zt.out=!0,on.me.output(h,St.p2))}St.p1=St.p2=St.pr=St.pd=null,St.span1=St.span2=St.spanr=null,St.next=rn.zpp_pool,rn.zpp_pool=St;St=on.map;St.list[xt*St.width+bt]=null}}for(;null!=S;){var It=S,S=It.next;(It.parent=It).next=ge.zpp_pool,ge.zpp_pool=It}}},on.ISO=function(t,e,i){return t(e,i)},on.prototype.output=function(t,e){var i;if(null==e||e.next==e||e.next==e.prev)h=!0;else{var n=0,r=e;if(null!=e)for(var o=e;;){var s=o;if(n+=s.x*(s.next.y-s.prev.y),(o=o.next)==r)break}var a=.5*n,h=a*a<Er.epsilon*Er.epsilon}if(h)for(;null!=e;)e=null!=e&&e.prev==e?e.next=e.prev=null:(i=e.next,e.prev.next=e.next,e.next.prev=e.prev,e.next=e.prev=null,e=null,i);else{h=_i.get();h.zpp_inner.vertices=e,t.zpp_inner.reverse_flag?t.push(h):t.unshift(h)}},on.prototype.linkright=function(t,e){e&=7;return 0==e?t:(3==e?t.next:t).next},on.prototype.linkleft=function(t,e){return 0==(1&e)?t.prev:t},on.prototype.linkdown=function(t,e){return(0==(128&e)?t:t.prev).prev},on.prototype.linkup=function(t,e){return t},on.prototype.combLR=function(t,e){var i=t.pr,n=7&t.okeyr,r=0==n?i:(3==n?i.next:i).next,o=e.p1,s=0==(1&e.okey1)?o.prev:o,a=r.next,n=s.prev;0!=(4&t.keyr)?(e.pr==e.p1&&(e.pr=r.prev),e.p1=r.prev,r.prev.next=s.next,s.next.prev=r.prev,null!=(l=r).wrap&&(l.wrap.zpp_inner._inuse=!1,o=(i=l.wrap).zpp_inner,i.zpp_inner.outer=null,i.zpp_inner=null,i.zpp_pool=Bn.poolVec2,Bn.poolVec2=i,null!=o.outer&&(o.outer.zpp_inner=null,o.outer=null),o._isimmutable=null,o._validate=null,o._invalidate=null,o.next=Gr.zpp_pool,Gr.zpp_pool=o,l.wrap=null),l.prev=l.next=null,l.next=nn.zpp_pool,nn.zpp_pool=l):(r.next=s.next,s.next.prev=r);var h,l=s;null!=l.wrap&&(l.wrap.zpp_inner._inuse=!1,s=(r=l.wrap).zpp_inner,r.zpp_inner.outer=null,r.zpp_inner=null,r.zpp_pool=Bn.poolVec2,Bn.poolVec2=r,null!=s.outer&&(s.outer.zpp_inner=null,s.outer=null),s._isimmutable=null,s._validate=null,s._invalidate=null,s.next=Gr.zpp_pool,Gr.zpp_pool=s,l.wrap=null),l.prev=l.next=null,l.next=nn.zpp_pool,nn.zpp_pool=l,0!=(16&t.keyr)?(e.pd=a.next,a.next.prev=n.prev,n.prev.next=a.next,null!=a.wrap&&(a.wrap.zpp_inner._inuse=!1,h=(e=a.wrap).zpp_inner,e.zpp_inner.outer=null,e.zpp_inner=null,e.zpp_pool=Bn.poolVec2,Bn.poolVec2=e,null!=h.outer&&(h.outer.zpp_inner=null,h.outer=null),h._isimmutable=null,h._validate=null,h._invalidate=null,h.next=Gr.zpp_pool,Gr.zpp_pool=h,a.wrap=null),a.prev=a.next=null,a.next=nn.zpp_pool,nn.zpp_pool=a):(a.prev=n.prev,n.prev.next=a),null!=n.wrap&&(n.wrap.zpp_inner._inuse=!1,a=(h=n.wrap).zpp_inner,h.zpp_inner.outer=null,h.zpp_inner=null,h.zpp_pool=Bn.poolVec2,Bn.poolVec2=h,null!=a.outer&&(a.outer.zpp_inner=null,a.outer=null),a._isimmutable=null,a._validate=null,a._invalidate=null,a.next=Gr.zpp_pool,Gr.zpp_pool=a,n.wrap=null),n.prev=n.next=null,n.next=nn.zpp_pool,nn.zpp_pool=n},on.prototype.combUD=function(t,e){null!=t.p2&&t.key2;var i=null!=e.p2&&14==e.key2?e.p2:e.p1,n=t.pd,r=i,o=n.prev,e=r.next;r.next=n.next,n.next.prev=r,null!=n.wrap&&(n.wrap.zpp_inner._inuse=!1,r=(i=n.wrap).zpp_inner,i.zpp_inner.outer=null,i.zpp_inner=null,i.zpp_pool=Bn.poolVec2,Bn.poolVec2=i,null!=r.outer&&(r.outer.zpp_inner=null,r.outer=null),r._isimmutable=null,r._validate=null,r._invalidate=null,r.next=Gr.zpp_pool,Gr.zpp_pool=r,n.wrap=null),n.prev=n.next=null,n.next=nn.zpp_pool,nn.zpp_pool=n,e.prev=o.prev,o.prev.next=e,o==t.p1&&(t.p1=e),null!=o.wrap&&(o.wrap.zpp_inner._inuse=!1,e=(t=o.wrap).zpp_inner,t.zpp_inner.outer=null,t.zpp_inner=null,t.zpp_pool=Bn.poolVec2,Bn.poolVec2=t,null!=e.outer&&(e.outer.zpp_inner=null,e.outer=null),e._isimmutable=null,e._validate=null,e._invalidate=null,e.next=Gr.zpp_pool,Gr.zpp_pool=e,o.wrap=null),o.prev=o.next=null,o.next=nn.zpp_pool,nn.zpp_pool=o},on.prototype.combUD_virtual=function(t,e){null!=t.p2&&t.key2;e=null!=e.p2&&14==e.key2?e.p2:e.p1,t=t.pd;t.forced=e.forced=t.prev.forced=e.next.forced=!0},on.prototype.combLeft=function(t){var e=1&t|(192&t)>>5,t=0!=(1&e)?1:0;return 0!=(2&e)&&++t,0!=(4&e)&&++t,2<=t},on.prototype.combRight=function(t){var e=(28&t)>>2,t=0!=(1&e)?1:0;return 0!=(2&e)&&++t,0!=(4&e)&&++t,2<=t},on.prototype.combUp=function(t){var e=7&t,t=0!=(1&e)?1:0;return 0!=(2&e)&&++t,0!=(4&e)&&++t,2<=t},on.prototype.combDown=function(t){var e=(112&t)>>4,t=0!=(1&e)?1:0;return 0!=(2&e)&&++t,0!=(4&e)&&++t,2<=t},on.prototype.comb=function(t){var e=0!=(1&t)?1:0;return 0!=(2&t)&&++e,0!=(4&t)&&++e,2<=e},on.prototype.marchSquare=function(t,e,i,n,r,o,s,a,h,l,p,u,d,c){var y=0,_=e.list[h*e.width+a];_<0&&(y=8);var m=e.list[h*e.width+(a+1)];m<0&&(y|=4);var g=e.list[(h+1)*e.width+(a+1)];g<0&&(y|=2);var f,x=e.list[(h+1)*e.width+a];if(x<0&&(y|=1),0==y)return null;if(null==rn.zpp_pool?f=new rn:(f=rn.zpp_pool,rn.zpp_pool=f.next,f.next=null),10!=y&&5!=y){var v=on.look_march[y];f.okey1=v;for(var w=0;w<8;){var z,b,S,C,P,M,T,A,k,O,E,I,G,D,L,B,R,F,N,j=w++;0!=(v&1<<j)&&(N=null,0==j?(null==nn.zpp_pool?z=new nn:(z=nn.zpp_pool,nn.zpp_pool=z.next,z.next=null),z.forced=!1,z.x=n,z.y=r,N=z,(l||p)&&(N.forced=!0)):2==j?(null==nn.zpp_pool?b=new nn:(b=nn.zpp_pool,nn.zpp_pool=b.next,b.next=null),b.forced=!1,b.x=o,b.y=r,N=b,(u||p)&&(N.forced=!0)):4==j?(null==nn.zpp_pool?S=new nn:(S=nn.zpp_pool,nn.zpp_pool=S.next,S.next=null),S.forced=!1,S.x=o,S.y=s,N=S,(u||d)&&(N.forced=!0)):6==j?(null==nn.zpp_pool?C=new nn:(C=nn.zpp_pool,nn.zpp_pool=C.next,C.next=null),C.forced=!1,C.x=n,C.y=s,N=C,(l||d)&&(N.forced=!0)):1==j?(null==(N=i.list[(h<<1)*i.width+a])?(M=this.xlerp(n,o,r,_,m,t,c),null==nn.zpp_pool?P=new nn:(P=nn.zpp_pool,nn.zpp_pool=P.next,P.next=null),P.forced=!1,P.x=M,P.y=r,N=P,i.list[(h<<1)*i.width+a]=N):(M=N.x,k=N.y,null==nn.zpp_pool?T=new nn:(T=nn.zpp_pool,nn.zpp_pool=T.next,T.next=null),T.forced=!1,T.x=M,T.y=k,N=T),p&&(N.forced=!0),N.x!=n&&N.x!=o||(N.x==n&&0!=(1&v)||N.x==o&&0!=(4&v))&&(v^=2)):5==j?(null==(N=i.list[(2+(h<<1))*i.width+a])?(O=this.xlerp(n,o,s,x,g,t,c),null==nn.zpp_pool?A=new nn:(A=nn.zpp_pool,nn.zpp_pool=A.next,A.next=null),A.forced=!1,A.x=O,A.y=s,N=A,i.list[(2+(h<<1))*i.width+a]=N):(k=N.x,O=N.y,null==nn.zpp_pool?E=new nn:(E=nn.zpp_pool,nn.zpp_pool=E.next,E.next=null),E.forced=!1,E.x=k,E.y=O,N=E),d&&(N.forced=!0),N.x!=n&&N.x!=o||(N.x==n&&0!=(64&v)||N.x==o&&0!=(16&v))&&(v^=32)):3==j?(null==(N=i.list[(1+(h<<1))*i.width+(a+1)])?(G=this.ylerp(r,s,o,m,g,t,c),null==nn.zpp_pool?I=new nn:(I=nn.zpp_pool,nn.zpp_pool=I.next,I.next=null),I.forced=!1,I.x=o,I.y=G,N=I,i.list[(1+(h<<1))*i.width+(a+1)]=N):(G=N.x,B=N.y,null==nn.zpp_pool?D=new nn:(D=nn.zpp_pool,nn.zpp_pool=D.next,D.next=null),D.forced=!1,D.x=G,D.y=B,N=D),u&&(N.forced=!0),N.y!=r&&N.y!=s||(N.y==r&&0!=(4&v)||N.y==s&&0!=(16&v))&&(v^=8)):(null==(N=i.list[(1+(h<<1))*i.width+a])?(R=this.ylerp(r,s,n,_,x,t,c),null==nn.zpp_pool?L=new nn:(L=nn.zpp_pool,nn.zpp_pool=L.next,L.next=null),L.forced=!1,L.x=n,L.y=R,N=L,i.list[(1+(h<<1))*i.width+a]=N):(B=N.x,R=N.y,null==nn.zpp_pool?F=new nn:(F=nn.zpp_pool,nn.zpp_pool=F.next,F.next=null),F.forced=!1,F.x=B,F.y=R,N=F),l&&(N.forced=!0),N.y!=r&&N.y!=s||(N.y==r&&0!=(1&v)||N.y==s&&0!=(64&v))&&(v^=128)),N=N,null==f.p1?f.p1=N.prev=N.next=N:(N.prev=f.p1,N.next=f.p1.next,f.p1.next.prev=N,f.p1.next=N),f.p1=N)}f.p1=f.p1.next,1!=(f.key1=v)&&4!=v&&16!=v&&64!=v&&3!=v&&12!=v&&48!=v&&192!=v&&129!=v&&6!=v&&24!=v&&96!=v&&5!=v&&20!=v&&80!=v&&65!=v&&17!=v&&68!=v||(f.key1=v=0,f.p1=null),0==v?f=null:(f.pr=f.p1,f.okeyr=f.okey1,f.keyr=f.key1)}else{e=t(.5*(n+o),.5*(r+s))<0;if(10==y)if(e){var U=187;f.okey1=187;for(var V=0;V<8;){var W,X,H,q,Y,K,Z,J,Q,$,tt,et,it,nt,rt,ot,st,at,ht,lt=V++;0!=(U&1<<lt)&&(ht=null,0==lt?(null==nn.zpp_pool?W=new nn:(W=nn.zpp_pool,nn.zpp_pool=W.next,W.next=null),W.forced=!1,W.x=n,W.y=r,ht=W,(l||p)&&(ht.forced=!0)):2==lt?(null==nn.zpp_pool?X=new nn:(X=nn.zpp_pool,nn.zpp_pool=X.next,X.next=null),X.forced=!1,X.x=o,X.y=r,ht=X,(u||p)&&(ht.forced=!0)):4==lt?(null==nn.zpp_pool?H=new nn:(H=nn.zpp_pool,nn.zpp_pool=H.next,H.next=null),H.forced=!1,H.x=o,H.y=s,ht=H,(u||d)&&(ht.forced=!0)):6==lt?(null==nn.zpp_pool?q=new nn:(q=nn.zpp_pool,nn.zpp_pool=q.next,q.next=null),q.forced=!1,q.x=n,q.y=s,ht=q,(l||d)&&(ht.forced=!0)):1==lt?(null==(ht=i.list[(h<<1)*i.width+a])?(K=this.xlerp(n,o,r,_,m,t,c),null==nn.zpp_pool?Y=new nn:(Y=nn.zpp_pool,nn.zpp_pool=Y.next,Y.next=null),Y.forced=!1,Y.x=K,Y.y=r,ht=Y,i.list[(h<<1)*i.width+a]=ht):(K=ht.x,Q=ht.y,null==nn.zpp_pool?Z=new nn:(Z=nn.zpp_pool,nn.zpp_pool=Z.next,Z.next=null),Z.forced=!1,Z.x=K,Z.y=Q,ht=Z),p&&(ht.forced=!0),ht.x!=n&&ht.x!=o||(ht.x==n&&0!=(1&U)||ht.x==o&&0!=(4&U))&&(U^=2)):5==lt?(null==(ht=i.list[(2+(h<<1))*i.width+a])?($=this.xlerp(n,o,s,x,g,t,c),null==nn.zpp_pool?J=new nn:(J=nn.zpp_pool,nn.zpp_pool=J.next,J.next=null),J.forced=!1,J.x=$,J.y=s,ht=J,i.list[(2+(h<<1))*i.width+a]=ht):(Q=ht.x,$=ht.y,null==nn.zpp_pool?tt=new nn:(tt=nn.zpp_pool,nn.zpp_pool=tt.next,tt.next=null),tt.forced=!1,tt.x=Q,tt.y=$,ht=tt),d&&(ht.forced=!0),ht.x!=n&&ht.x!=o||(ht.x==n&&0!=(64&U)||ht.x==o&&0!=(16&U))&&(U^=32)):3==lt?(null==(ht=i.list[(1+(h<<1))*i.width+(a+1)])?(it=this.ylerp(r,s,o,m,g,t,c),null==nn.zpp_pool?et=new nn:(et=nn.zpp_pool,nn.zpp_pool=et.next,et.next=null),et.forced=!1,et.x=o,et.y=it,ht=et,i.list[(1+(h<<1))*i.width+(a+1)]=ht):(it=ht.x,ot=ht.y,null==nn.zpp_pool?nt=new nn:(nt=nn.zpp_pool,nn.zpp_pool=nt.next,nt.next=null),nt.forced=!1,nt.x=it,nt.y=ot,ht=nt),u&&(ht.forced=!0),ht.y!=r&&ht.y!=s||(ht.y==r&&0!=(4&U)||ht.y==s&&0!=(16&U))&&(U^=8)):(null==(ht=i.list[(1+(h<<1))*i.width+a])?(st=this.ylerp(r,s,n,_,x,t,c),null==nn.zpp_pool?rt=new nn:(rt=nn.zpp_pool,nn.zpp_pool=rt.next,rt.next=null),rt.forced=!1,rt.x=n,rt.y=st,ht=rt,i.list[(1+(h<<1))*i.width+a]=ht):(ot=ht.x,st=ht.y,null==nn.zpp_pool?at=new nn:(at=nn.zpp_pool,nn.zpp_pool=at.next,at.next=null),at.forced=!1,at.x=ot,at.y=st,ht=at),l&&(ht.forced=!0),ht.y!=r&&ht.y!=s||(ht.y==r&&0!=(1&U)||ht.y==s&&0!=(64&U))&&(U^=128)),ht=ht,null==f.p1?f.p1=ht.prev=ht.next=ht:(ht.prev=f.p1,ht.next=f.p1.next,f.p1.next.prev=ht,f.p1.next=ht),f.p1=ht)}f.p1=f.p1.next,1!=(f.key1=U)&&4!=U&&16!=U&&64!=U&&3!=U&&12!=U&&48!=U&&192!=U&&129!=U&&6!=U&&24!=U&&96!=U&&5!=U&&20!=U&&80!=U&&65!=U&&17!=U&&68!=U||(f.key1=U=0,f.p1=null),0==U?f=null:(f.pr=f.p1,f.okeyr=f.okey1,f.keyr=f.key1)}else{var pt=131;f.okey1=131;for(var ut=0;ut<8;){var dt,ct,yt,_t,mt,gt,ft,xt,vt,wt,zt,bt,St,Ct,Pt,Mt,Tt,At,kt,Ot=ut++;0!=(pt&1<<Ot)&&(kt=null,0==Ot?(null==nn.zpp_pool?dt=new nn:(dt=nn.zpp_pool,nn.zpp_pool=dt.next,dt.next=null),dt.forced=!1,dt.x=n,dt.y=r,kt=dt,(l||p)&&(kt.forced=!0)):2==Ot?(null==nn.zpp_pool?ct=new nn:(ct=nn.zpp_pool,nn.zpp_pool=ct.next,ct.next=null),ct.forced=!1,ct.x=o,ct.y=r,kt=ct,(u||p)&&(kt.forced=!0)):4==Ot?(null==nn.zpp_pool?yt=new nn:(yt=nn.zpp_pool,nn.zpp_pool=yt.next,yt.next=null),yt.forced=!1,yt.x=o,yt.y=s,kt=yt,(u||d)&&(kt.forced=!0)):6==Ot?(null==nn.zpp_pool?_t=new nn:(_t=nn.zpp_pool,nn.zpp_pool=_t.next,_t.next=null),_t.forced=!1,_t.x=n,_t.y=s,kt=_t,(l||d)&&(kt.forced=!0)):1==Ot?(null==(kt=i.list[(h<<1)*i.width+a])?(gt=this.xlerp(n,o,r,_,m,t,c),null==nn.zpp_pool?mt=new nn:(mt=nn.zpp_pool,nn.zpp_pool=mt.next,mt.next=null),mt.forced=!1,mt.x=gt,mt.y=r,kt=mt,i.list[(h<<1)*i.width+a]=kt):(gt=kt.x,vt=kt.y,null==nn.zpp_pool?ft=new nn:(ft=nn.zpp_pool,nn.zpp_pool=ft.next,ft.next=null),ft.forced=!1,ft.x=gt,ft.y=vt,kt=ft),p&&(kt.forced=!0),kt.x!=n&&kt.x!=o||(kt.x==n&&0!=(1&pt)||kt.x==o&&0!=(4&pt))&&(pt^=2)):5==Ot?(null==(kt=i.list[(2+(h<<1))*i.width+a])?(wt=this.xlerp(n,o,s,x,g,t,c),null==nn.zpp_pool?xt=new nn:(xt=nn.zpp_pool,nn.zpp_pool=xt.next,xt.next=null),xt.forced=!1,xt.x=wt,xt.y=s,kt=xt,i.list[(2+(h<<1))*i.width+a]=kt):(vt=kt.x,wt=kt.y,null==nn.zpp_pool?zt=new nn:(zt=nn.zpp_pool,nn.zpp_pool=zt.next,zt.next=null),zt.forced=!1,zt.x=vt,zt.y=wt,kt=zt),d&&(kt.forced=!0),kt.x!=n&&kt.x!=o||(kt.x==n&&0!=(64&pt)||kt.x==o&&0!=(16&pt))&&(pt^=32)):3==Ot?(null==(kt=i.list[(1+(h<<1))*i.width+(a+1)])?(St=this.ylerp(r,s,o,m,g,t,c),null==nn.zpp_pool?bt=new nn:(bt=nn.zpp_pool,nn.zpp_pool=bt.next,bt.next=null),bt.forced=!1,bt.x=o,bt.y=St,kt=bt,i.list[(1+(h<<1))*i.width+(a+1)]=kt):(St=kt.x,Mt=kt.y,null==nn.zpp_pool?Ct=new nn:(Ct=nn.zpp_pool,nn.zpp_pool=Ct.next,Ct.next=null),Ct.forced=!1,Ct.x=St,Ct.y=Mt,kt=Ct),u&&(kt.forced=!0),kt.y!=r&&kt.y!=s||(kt.y==r&&0!=(4&pt)||kt.y==s&&0!=(16&pt))&&(pt^=8)):(null==(kt=i.list[(1+(h<<1))*i.width+a])?(Tt=this.ylerp(r,s,n,_,x,t,c),null==nn.zpp_pool?Pt=new nn:(Pt=nn.zpp_pool,nn.zpp_pool=Pt.next,Pt.next=null),Pt.forced=!1,Pt.x=n,Pt.y=Tt,kt=Pt,i.list[(1+(h<<1))*i.width+a]=kt):(Mt=kt.x,Tt=kt.y,null==nn.zpp_pool?At=new nn:(At=nn.zpp_pool,nn.zpp_pool=At.next,At.next=null),At.forced=!1,At.x=Mt,At.y=Tt,kt=At),l&&(kt.forced=!0),kt.y!=r&&kt.y!=s||(kt.y==r&&0!=(1&pt)||kt.y==s&&0!=(64&pt))&&(pt^=128)),kt=kt,null==f.p1?f.p1=kt.prev=kt.next=kt:(kt.prev=f.p1,kt.next=f.p1.next,f.p1.next.prev=kt,f.p1.next=kt),f.p1=kt)}if(f.p1=f.p1.next,1!=(f.key1=pt)&&4!=pt&&16!=pt&&64!=pt&&3!=pt&&12!=pt&&48!=pt&&192!=pt&&129!=pt&&6!=pt&&24!=pt&&96!=pt&&5!=pt&&20!=pt&&80!=pt&&65!=pt&&17!=pt&&68!=pt||(f.key1=pt=0,f.p1=null),0!=pt){var Et=56;f.okey2=56;for(var It=0;It<8;){var Gt,Dt,Lt,Bt,Rt,Ft,Nt,jt,Ut,Vt,Wt,Xt,Ht,qt,Yt,Kt,Zt,Jt,Qt,$t=It++;0!=(Et&1<<$t)&&(Qt=null,0==$t?(null==nn.zpp_pool?Gt=new nn:(Gt=nn.zpp_pool,nn.zpp_pool=Gt.next,Gt.next=null),Gt.forced=!1,Gt.x=n,Gt.y=r,Qt=Gt,(l||p)&&(Qt.forced=!0)):2==$t?(null==nn.zpp_pool?Dt=new nn:(Dt=nn.zpp_pool,nn.zpp_pool=Dt.next,Dt.next=null),Dt.forced=!1,Dt.x=o,Dt.y=r,Qt=Dt,(u||p)&&(Qt.forced=!0)):4==$t?(null==nn.zpp_pool?Lt=new nn:(Lt=nn.zpp_pool,nn.zpp_pool=Lt.next,Lt.next=null),Lt.forced=!1,Lt.x=o,Lt.y=s,Qt=Lt,(u||d)&&(Qt.forced=!0)):6==$t?(null==nn.zpp_pool?Bt=new nn:(Bt=nn.zpp_pool,nn.zpp_pool=Bt.next,Bt.next=null),Bt.forced=!1,Bt.x=n,Bt.y=s,Qt=Bt,(l||d)&&(Qt.forced=!0)):1==$t?(null==(Qt=i.list[(h<<1)*i.width+a])?(Ft=this.xlerp(n,o,r,_,m,t,c),null==nn.zpp_pool?Rt=new nn:(Rt=nn.zpp_pool,nn.zpp_pool=Rt.next,Rt.next=null),Rt.forced=!1,Rt.x=Ft,Rt.y=r,Qt=Rt,i.list[(h<<1)*i.width+a]=Qt):(Ft=Qt.x,Ut=Qt.y,null==nn.zpp_pool?Nt=new nn:(Nt=nn.zpp_pool,nn.zpp_pool=Nt.next,Nt.next=null),Nt.forced=!1,Nt.x=Ft,Nt.y=Ut,Qt=Nt),p&&(Qt.forced=!0),Qt.x!=n&&Qt.x!=o||(Qt.x==n&&0!=(1&Et)||Qt.x==o&&0!=(4&Et))&&(Et^=2)):5==$t?(null==(Qt=i.list[(2+(h<<1))*i.width+a])?(Vt=this.xlerp(n,o,s,x,g,t,c),null==nn.zpp_pool?jt=new nn:(jt=nn.zpp_pool,nn.zpp_pool=jt.next,jt.next=null),jt.forced=!1,jt.x=Vt,jt.y=s,Qt=jt,i.list[(2+(h<<1))*i.width+a]=Qt):(Ut=Qt.x,Vt=Qt.y,null==nn.zpp_pool?Wt=new nn:(Wt=nn.zpp_pool,nn.zpp_pool=Wt.next,Wt.next=null),Wt.forced=!1,Wt.x=Ut,Wt.y=Vt,Qt=Wt),d&&(Qt.forced=!0),Qt.x!=n&&Qt.x!=o||(Qt.x==n&&0!=(64&Et)||Qt.x==o&&0!=(16&Et))&&(Et^=32)):3==$t?(null==(Qt=i.list[(1+(h<<1))*i.width+(a+1)])?(Ht=this.ylerp(r,s,o,m,g,t,c),null==nn.zpp_pool?Xt=new nn:(Xt=nn.zpp_pool,nn.zpp_pool=Xt.next,Xt.next=null),Xt.forced=!1,Xt.x=o,Xt.y=Ht,Qt=Xt,i.list[(1+(h<<1))*i.width+(a+1)]=Qt):(Ht=Qt.x,Kt=Qt.y,null==nn.zpp_pool?qt=new nn:(qt=nn.zpp_pool,nn.zpp_pool=qt.next,qt.next=null),qt.forced=!1,qt.x=Ht,qt.y=Kt,Qt=qt),u&&(Qt.forced=!0),Qt.y!=r&&Qt.y!=s||(Qt.y==r&&0!=(4&Et)||Qt.y==s&&0!=(16&Et))&&(Et^=8)):(null==(Qt=i.list[(1+(h<<1))*i.width+a])?(Zt=this.ylerp(r,s,n,_,x,t,c),null==nn.zpp_pool?Yt=new nn:(Yt=nn.zpp_pool,nn.zpp_pool=Yt.next,Yt.next=null),Yt.forced=!1,Yt.x=n,Yt.y=Zt,Qt=Yt,i.list[(1+(h<<1))*i.width+a]=Qt):(Kt=Qt.x,Zt=Qt.y,null==nn.zpp_pool?Jt=new nn:(Jt=nn.zpp_pool,nn.zpp_pool=Jt.next,Jt.next=null),Jt.forced=!1,Jt.x=Kt,Jt.y=Zt,Qt=Jt),l&&(Qt.forced=!0),Qt.y!=r&&Qt.y!=s||(Qt.y==r&&0!=(1&Et)||Qt.y==s&&0!=(64&Et))&&(Et^=128)),Qt=Qt,null==f.p2?f.p2=Qt.prev=Qt.next=Qt:(Qt.prev=f.p2,Qt.next=f.p2.next,f.p2.next.prev=Qt,f.p2.next=Qt),f.p2=Qt)}f.p2=f.p2.next,1!=(f.key2=Et)&&4!=Et&&16!=Et&&64!=Et&&3!=Et&&12!=Et&&48!=Et&&192!=Et&&129!=Et&&6!=Et&&24!=Et&&96!=Et&&5!=Et&&20!=Et&&80!=Et&&65!=Et&&17!=Et&&68!=Et||(f.key2=Et=0,f.p2=null),0==Et?(f.pr=f.p1,f.okeyr=f.okey1,f.keyr=f.key1):(f.pr=f.p2,f.okeyr=f.okey2,f.keyr=f.key2)}else{var te=56;f.okey1=56;for(var ee=0;ee<8;){var ie,ne,re,oe,se,ae,he,le,pe,ue,de,ce,ye,_e,me,ge,fe,xe,ve,we=ee++;0!=(te&1<<we)&&(ve=null,0==we?(null==nn.zpp_pool?ie=new nn:(ie=nn.zpp_pool,nn.zpp_pool=ie.next,ie.next=null),ie.forced=!1,ie.x=n,ie.y=r,ve=ie,(l||p)&&(ve.forced=!0)):2==we?(null==nn.zpp_pool?ne=new nn:(ne=nn.zpp_pool,nn.zpp_pool=ne.next,ne.next=null),ne.forced=!1,ne.x=o,ne.y=r,ve=ne,(u||p)&&(ve.forced=!0)):4==we?(null==nn.zpp_pool?re=new nn:(re=nn.zpp_pool,nn.zpp_pool=re.next,re.next=null),re.forced=!1,re.x=o,re.y=s,ve=re,(u||d)&&(ve.forced=!0)):6==we?(null==nn.zpp_pool?oe=new nn:(oe=nn.zpp_pool,nn.zpp_pool=oe.next,oe.next=null),oe.forced=!1,oe.x=n,oe.y=s,ve=oe,(l||d)&&(ve.forced=!0)):1==we?(null==(ve=i.list[(h<<1)*i.width+a])?(ae=this.xlerp(n,o,r,_,m,t,c),null==nn.zpp_pool?se=new nn:(se=nn.zpp_pool,nn.zpp_pool=se.next,se.next=null),se.forced=!1,se.x=ae,se.y=r,ve=se,i.list[(h<<1)*i.width+a]=ve):(ae=ve.x,pe=ve.y,null==nn.zpp_pool?he=new nn:(he=nn.zpp_pool,nn.zpp_pool=he.next,he.next=null),he.forced=!1,he.x=ae,he.y=pe,ve=he),p&&(ve.forced=!0),ve.x!=n&&ve.x!=o||(ve.x==n&&0!=(1&te)||ve.x==o&&0!=(4&te))&&(te^=2)):5==we?(null==(ve=i.list[(2+(h<<1))*i.width+a])?(ue=this.xlerp(n,o,s,x,g,t,c),null==nn.zpp_pool?le=new nn:(le=nn.zpp_pool,nn.zpp_pool=le.next,le.next=null),le.forced=!1,le.x=ue,le.y=s,ve=le,i.list[(2+(h<<1))*i.width+a]=ve):(pe=ve.x,ue=ve.y,null==nn.zpp_pool?de=new nn:(de=nn.zpp_pool,nn.zpp_pool=de.next,de.next=null),de.forced=!1,de.x=pe,de.y=ue,ve=de),d&&(ve.forced=!0),ve.x!=n&&ve.x!=o||(ve.x==n&&0!=(64&te)||ve.x==o&&0!=(16&te))&&(te^=32)):3==we?(null==(ve=i.list[(1+(h<<1))*i.width+(a+1)])?(ye=this.ylerp(r,s,o,m,g,t,c),null==nn.zpp_pool?ce=new nn:(ce=nn.zpp_pool,nn.zpp_pool=ce.next,ce.next=null),ce.forced=!1,ce.x=o,ce.y=ye,ve=ce,i.list[(1+(h<<1))*i.width+(a+1)]=ve):(ye=ve.x,ge=ve.y,null==nn.zpp_pool?_e=new nn:(_e=nn.zpp_pool,nn.zpp_pool=_e.next,_e.next=null),_e.forced=!1,_e.x=ye,_e.y=ge,ve=_e),u&&(ve.forced=!0),ve.y!=r&&ve.y!=s||(ve.y==r&&0!=(4&te)||ve.y==s&&0!=(16&te))&&(te^=8)):(null==(ve=i.list[(1+(h<<1))*i.width+a])?(fe=this.ylerp(r,s,n,_,x,t,c),null==nn.zpp_pool?me=new nn:(me=nn.zpp_pool,nn.zpp_pool=me.next,me.next=null),me.forced=!1,me.x=n,me.y=fe,ve=me,i.list[(1+(h<<1))*i.width+a]=ve):(ge=ve.x,fe=ve.y,null==nn.zpp_pool?xe=new nn:(xe=nn.zpp_pool,nn.zpp_pool=xe.next,xe.next=null),xe.forced=!1,xe.x=ge,xe.y=fe,ve=xe),l&&(ve.forced=!0),ve.y!=r&&ve.y!=s||(ve.y==r&&0!=(1&te)||ve.y==s&&0!=(64&te))&&(te^=128)),ve=ve,null==f.p1?f.p1=ve.prev=ve.next=ve:(ve.prev=f.p1,ve.next=f.p1.next,f.p1.next.prev=ve,f.p1.next=ve),f.p1=ve)}f.p1=f.p1.next,1!=(f.key1=te)&&4!=te&&16!=te&&64!=te&&3!=te&&12!=te&&48!=te&&192!=te&&129!=te&&6!=te&&24!=te&&96!=te&&5!=te&&20!=te&&80!=te&&65!=te&&17!=te&&68!=te||(f.key1=te=0,f.p1=null),0==te?f=null:(f.pr=f.p1,f.okeyr=f.okey1,f.keyr=f.key1)}}else if(e){var ze=238;f.okey1=238;for(var be=0;be<8;){var Se,Ce,Pe,Me,Te,Ae,ke,Oe,Ee,Ie,Ge,De,Le,Be,Re,Fe,Ne,je,Ue,Ve=be++;0!=(ze&1<<Ve)&&(Ue=null,0==Ve?(null==nn.zpp_pool?Se=new nn:(Se=nn.zpp_pool,nn.zpp_pool=Se.next,Se.next=null),Se.forced=!1,Se.x=n,Se.y=r,Ue=Se,(l||p)&&(Ue.forced=!0)):2==Ve?(null==nn.zpp_pool?Ce=new nn:(Ce=nn.zpp_pool,nn.zpp_pool=Ce.next,Ce.next=null),Ce.forced=!1,Ce.x=o,Ce.y=r,Ue=Ce,(u||p)&&(Ue.forced=!0)):4==Ve?(null==nn.zpp_pool?Pe=new nn:(Pe=nn.zpp_pool,nn.zpp_pool=Pe.next,Pe.next=null),Pe.forced=!1,Pe.x=o,Pe.y=s,Ue=Pe,(u||d)&&(Ue.forced=!0)):6==Ve?(null==nn.zpp_pool?Me=new nn:(Me=nn.zpp_pool,nn.zpp_pool=Me.next,Me.next=null),Me.forced=!1,Me.x=n,Me.y=s,Ue=Me,(l||d)&&(Ue.forced=!0)):1==Ve?(null==(Ue=i.list[(h<<1)*i.width+a])?(Ae=this.xlerp(n,o,r,_,m,t,c),null==nn.zpp_pool?Te=new nn:(Te=nn.zpp_pool,nn.zpp_pool=Te.next,Te.next=null),Te.forced=!1,Te.x=Ae,Te.y=r,Ue=Te,i.list[(h<<1)*i.width+a]=Ue):(Ae=Ue.x,Ee=Ue.y,null==nn.zpp_pool?ke=new nn:(ke=nn.zpp_pool,nn.zpp_pool=ke.next,ke.next=null),ke.forced=!1,ke.x=Ae,ke.y=Ee,Ue=ke),p&&(Ue.forced=!0),Ue.x!=n&&Ue.x!=o||(Ue.x==n&&0!=(1&ze)||Ue.x==o&&0!=(4&ze))&&(ze^=2)):5==Ve?(null==(Ue=i.list[(2+(h<<1))*i.width+a])?(Ie=this.xlerp(n,o,s,x,g,t,c),null==nn.zpp_pool?Oe=new nn:(Oe=nn.zpp_pool,nn.zpp_pool=Oe.next,Oe.next=null),Oe.forced=!1,Oe.x=Ie,Oe.y=s,Ue=Oe,i.list[(2+(h<<1))*i.width+a]=Ue):(Ee=Ue.x,Ie=Ue.y,null==nn.zpp_pool?Ge=new nn:(Ge=nn.zpp_pool,nn.zpp_pool=Ge.next,Ge.next=null),Ge.forced=!1,Ge.x=Ee,Ge.y=Ie,Ue=Ge),d&&(Ue.forced=!0),Ue.x!=n&&Ue.x!=o||(Ue.x==n&&0!=(64&ze)||Ue.x==o&&0!=(16&ze))&&(ze^=32)):3==Ve?(null==(Ue=i.list[(1+(h<<1))*i.width+(a+1)])?(Le=this.ylerp(r,s,o,m,g,t,c),null==nn.zpp_pool?De=new nn:(De=nn.zpp_pool,nn.zpp_pool=De.next,De.next=null),De.forced=!1,De.x=o,De.y=Le,Ue=De,i.list[(1+(h<<1))*i.width+(a+1)]=Ue):(Le=Ue.x,Fe=Ue.y,null==nn.zpp_pool?Be=new nn:(Be=nn.zpp_pool,nn.zpp_pool=Be.next,Be.next=null),Be.forced=!1,Be.x=Le,Be.y=Fe,Ue=Be),u&&(Ue.forced=!0),Ue.y!=r&&Ue.y!=s||(Ue.y==r&&0!=(4&ze)||Ue.y==s&&0!=(16&ze))&&(ze^=8)):(null==(Ue=i.list[(1+(h<<1))*i.width+a])?(Ne=this.ylerp(r,s,n,_,x,t,c),null==nn.zpp_pool?Re=new nn:(Re=nn.zpp_pool,nn.zpp_pool=Re.next,Re.next=null),Re.forced=!1,Re.x=n,Re.y=Ne,Ue=Re,i.list[(1+(h<<1))*i.width+a]=Ue):(Fe=Ue.x,Ne=Ue.y,null==nn.zpp_pool?je=new nn:(je=nn.zpp_pool,nn.zpp_pool=je.next,je.next=null),je.forced=!1,je.x=Fe,je.y=Ne,Ue=je),l&&(Ue.forced=!0),Ue.y!=r&&Ue.y!=s||(Ue.y==r&&0!=(1&ze)||Ue.y==s&&0!=(64&ze))&&(ze^=128)),Ue=Ue,null==f.p1?f.p1=Ue.prev=Ue.next=Ue:(Ue.prev=f.p1,Ue.next=f.p1.next,f.p1.next.prev=Ue,f.p1.next=Ue),f.p1=Ue)}f.p1=f.p1.next,1!=(f.key1=ze)&&4!=ze&&16!=ze&&64!=ze&&3!=ze&&12!=ze&&48!=ze&&192!=ze&&129!=ze&&6!=ze&&24!=ze&&96!=ze&&5!=ze&&20!=ze&&80!=ze&&65!=ze&&17!=ze&&68!=ze||(f.key1=ze=0,f.p1=null),0==ze?f=null:(f.pr=f.p1,f.okeyr=f.okey1,f.keyr=f.key1)}else{var We=224;f.okey1=224;for(var Xe=0;Xe<8;){var He,qe,Ye,Ke,Ze,Je,Qe,$e,ti,ei,ii,ni,ri,oi,si,ai,hi,li,pi,ui=Xe++;0!=(We&1<<ui)&&(pi=null,0==ui?(null==nn.zpp_pool?He=new nn:(He=nn.zpp_pool,nn.zpp_pool=He.next,He.next=null),He.forced=!1,He.x=n,He.y=r,pi=He,(l||p)&&(pi.forced=!0)):2==ui?(null==nn.zpp_pool?qe=new nn:(qe=nn.zpp_pool,nn.zpp_pool=qe.next,qe.next=null),qe.forced=!1,qe.x=o,qe.y=r,pi=qe,(u||p)&&(pi.forced=!0)):4==ui?(null==nn.zpp_pool?Ye=new nn:(Ye=nn.zpp_pool,nn.zpp_pool=Ye.next,Ye.next=null),Ye.forced=!1,Ye.x=o,Ye.y=s,pi=Ye,(u||d)&&(pi.forced=!0)):6==ui?(null==nn.zpp_pool?Ke=new nn:(Ke=nn.zpp_pool,nn.zpp_pool=Ke.next,Ke.next=null),Ke.forced=!1,Ke.x=n,Ke.y=s,pi=Ke,(l||d)&&(pi.forced=!0)):1==ui?(null==(pi=i.list[(h<<1)*i.width+a])?(Je=this.xlerp(n,o,r,_,m,t,c),null==nn.zpp_pool?Ze=new nn:(Ze=nn.zpp_pool,nn.zpp_pool=Ze.next,Ze.next=null),Ze.forced=!1,Ze.x=Je,Ze.y=r,pi=Ze,i.list[(h<<1)*i.width+a]=pi):(Je=pi.x,ti=pi.y,null==nn.zpp_pool?Qe=new nn:(Qe=nn.zpp_pool,nn.zpp_pool=Qe.next,Qe.next=null),Qe.forced=!1,Qe.x=Je,Qe.y=ti,pi=Qe),p&&(pi.forced=!0),pi.x!=n&&pi.x!=o||(pi.x==n&&0!=(1&We)||pi.x==o&&0!=(4&We))&&(We^=2)):5==ui?(null==(pi=i.list[(2+(h<<1))*i.width+a])?(ei=this.xlerp(n,o,s,x,g,t,c),null==nn.zpp_pool?$e=new nn:($e=nn.zpp_pool,nn.zpp_pool=$e.next,$e.next=null),$e.forced=!1,$e.x=ei,$e.y=s,pi=$e,i.list[(2+(h<<1))*i.width+a]=pi):(ti=pi.x,ei=pi.y,null==nn.zpp_pool?ii=new nn:(ii=nn.zpp_pool,nn.zpp_pool=ii.next,ii.next=null),ii.forced=!1,ii.x=ti,ii.y=ei,pi=ii),d&&(pi.forced=!0),pi.x!=n&&pi.x!=o||(pi.x==n&&0!=(64&We)||pi.x==o&&0!=(16&We))&&(We^=32)):3==ui?(null==(pi=i.list[(1+(h<<1))*i.width+(a+1)])?(ri=this.ylerp(r,s,o,m,g,t,c),null==nn.zpp_pool?ni=new nn:(ni=nn.zpp_pool,nn.zpp_pool=ni.next,ni.next=null),ni.forced=!1,ni.x=o,ni.y=ri,pi=ni,i.list[(1+(h<<1))*i.width+(a+1)]=pi):(ri=pi.x,ai=pi.y,null==nn.zpp_pool?oi=new nn:(oi=nn.zpp_pool,nn.zpp_pool=oi.next,oi.next=null),oi.forced=!1,oi.x=ri,oi.y=ai,pi=oi),u&&(pi.forced=!0),pi.y!=r&&pi.y!=s||(pi.y==r&&0!=(4&We)||pi.y==s&&0!=(16&We))&&(We^=8)):(null==(pi=i.list[(1+(h<<1))*i.width+a])?(hi=this.ylerp(r,s,n,_,x,t,c),null==nn.zpp_pool?si=new nn:(si=nn.zpp_pool,nn.zpp_pool=si.next,si.next=null),si.forced=!1,si.x=n,si.y=hi,pi=si,i.list[(1+(h<<1))*i.width+a]=pi):(ai=pi.x,hi=pi.y,null==nn.zpp_pool?li=new nn:(li=nn.zpp_pool,nn.zpp_pool=li.next,li.next=null),li.forced=!1,li.x=ai,li.y=hi,pi=li),l&&(pi.forced=!0),pi.y!=r&&pi.y!=s||(pi.y==r&&0!=(1&We)||pi.y==s&&0!=(64&We))&&(We^=128)),pi=pi,null==f.p1?f.p1=pi.prev=pi.next=pi:(pi.prev=f.p1,pi.next=f.p1.next,f.p1.next.prev=pi,f.p1.next=pi),f.p1=pi)}if(f.p1=f.p1.next,1!=(f.key1=We)&&4!=We&&16!=We&&64!=We&&3!=We&&12!=We&&48!=We&&192!=We&&129!=We&&6!=We&&24!=We&&96!=We&&5!=We&&20!=We&&80!=We&&65!=We&&17!=We&&68!=We||(f.key1=We=0,f.p1=null),0!=We){var di=14;f.okey2=14;for(var ci=0;ci<8;){var yi,_i,mi,gi,fi,xi,vi,wi,zi,bi,Si,Ci,Pi,Mi,Ti,Ai,ki,Oi,Ei,Ii=ci++;0!=(di&1<<Ii)&&(Ei=null,0==Ii?(null==nn.zpp_pool?yi=new nn:(yi=nn.zpp_pool,nn.zpp_pool=yi.next,yi.next=null),yi.forced=!1,yi.x=n,yi.y=r,Ei=yi,(l||p)&&(Ei.forced=!0)):2==Ii?(null==nn.zpp_pool?_i=new nn:(_i=nn.zpp_pool,nn.zpp_pool=_i.next,_i.next=null),_i.forced=!1,_i.x=o,_i.y=r,Ei=_i,(u||p)&&(Ei.forced=!0)):4==Ii?(null==nn.zpp_pool?mi=new nn:(mi=nn.zpp_pool,nn.zpp_pool=mi.next,mi.next=null),mi.forced=!1,mi.x=o,mi.y=s,Ei=mi,(u||d)&&(Ei.forced=!0)):6==Ii?(null==nn.zpp_pool?gi=new nn:(gi=nn.zpp_pool,nn.zpp_pool=gi.next,gi.next=null),gi.forced=!1,gi.x=n,gi.y=s,Ei=gi,(l||d)&&(Ei.forced=!0)):1==Ii?(null==(Ei=i.list[(h<<1)*i.width+a])?(xi=this.xlerp(n,o,r,_,m,t,c),null==nn.zpp_pool?fi=new nn:(fi=nn.zpp_pool,nn.zpp_pool=fi.next,fi.next=null),fi.forced=!1,fi.x=xi,fi.y=r,Ei=fi,i.list[(h<<1)*i.width+a]=Ei):(xi=Ei.x,zi=Ei.y,null==nn.zpp_pool?vi=new nn:(vi=nn.zpp_pool,nn.zpp_pool=vi.next,vi.next=null),vi.forced=!1,vi.x=xi,vi.y=zi,Ei=vi),p&&(Ei.forced=!0),Ei.x!=n&&Ei.x!=o||(Ei.x==n&&0!=(1&di)||Ei.x==o&&0!=(4&di))&&(di^=2)):5==Ii?(null==(Ei=i.list[(2+(h<<1))*i.width+a])?(bi=this.xlerp(n,o,s,x,g,t,c),null==nn.zpp_pool?wi=new nn:(wi=nn.zpp_pool,nn.zpp_pool=wi.next,wi.next=null),wi.forced=!1,wi.x=bi,wi.y=s,Ei=wi,i.list[(2+(h<<1))*i.width+a]=Ei):(zi=Ei.x,bi=Ei.y,null==nn.zpp_pool?Si=new nn:(Si=nn.zpp_pool,nn.zpp_pool=Si.next,Si.next=null),Si.forced=!1,Si.x=zi,Si.y=bi,Ei=Si),d&&(Ei.forced=!0),Ei.x!=n&&Ei.x!=o||(Ei.x==n&&0!=(64&di)||Ei.x==o&&0!=(16&di))&&(di^=32)):3==Ii?(null==(Ei=i.list[(1+(h<<1))*i.width+(a+1)])?(Pi=this.ylerp(r,s,o,m,g,t,c),null==nn.zpp_pool?Ci=new nn:(Ci=nn.zpp_pool,nn.zpp_pool=Ci.next,Ci.next=null),Ci.forced=!1,Ci.x=o,Ci.y=Pi,Ei=Ci,i.list[(1+(h<<1))*i.width+(a+1)]=Ei):(Pi=Ei.x,Ai=Ei.y,null==nn.zpp_pool?Mi=new nn:(Mi=nn.zpp_pool,nn.zpp_pool=Mi.next,Mi.next=null),Mi.forced=!1,Mi.x=Pi,Mi.y=Ai,Ei=Mi),u&&(Ei.forced=!0),Ei.y!=r&&Ei.y!=s||(Ei.y==r&&0!=(4&di)||Ei.y==s&&0!=(16&di))&&(di^=8)):(null==(Ei=i.list[(1+(h<<1))*i.width+a])?(ki=this.ylerp(r,s,n,_,x,t,c),null==nn.zpp_pool?Ti=new nn:(Ti=nn.zpp_pool,nn.zpp_pool=Ti.next,Ti.next=null),Ti.forced=!1,Ti.x=n,Ti.y=ki,Ei=Ti,i.list[(1+(h<<1))*i.width+a]=Ei):(Ai=Ei.x,ki=Ei.y,null==nn.zpp_pool?Oi=new nn:(Oi=nn.zpp_pool,nn.zpp_pool=Oi.next,Oi.next=null),Oi.forced=!1,Oi.x=Ai,Oi.y=ki,Ei=Oi),l&&(Ei.forced=!0),Ei.y!=r&&Ei.y!=s||(Ei.y==r&&0!=(1&di)||Ei.y==s&&0!=(64&di))&&(di^=128)),Ei=Ei,null==f.p2?f.p2=Ei.prev=Ei.next=Ei:(Ei.prev=f.p2,Ei.next=f.p2.next,f.p2.next.prev=Ei,f.p2.next=Ei),f.p2=Ei)}f.p2=f.p2.next,1!=(f.key2=di)&&4!=di&&16!=di&&64!=di&&3!=di&&12!=di&&48!=di&&192!=di&&129!=di&&6!=di&&24!=di&&96!=di&&5!=di&&20!=di&&80!=di&&65!=di&&17!=di&&68!=di||(f.key2=di=0,f.p2=null),0==di?(f.pr=f.p1,f.okeyr=f.okey1,f.keyr=f.key1):(f.pr=f.p2,f.okeyr=f.okey2,f.keyr=f.key2)}else{var Gi=14;f.okey1=14;for(var Di=0;Di<8;){var Li,Bi,Ri,Fi,Ni,ji,Ui,Vi,Wi,Xi,Hi,qi,Yi,Ki,Zi,Ji,Qi,$i,tn,en=Di++;0!=(Gi&1<<en)&&(tn=null,0==en?(null==nn.zpp_pool?Li=new nn:(Li=nn.zpp_pool,nn.zpp_pool=Li.next,Li.next=null),Li.forced=!1,Li.x=n,Li.y=r,tn=Li,(l||p)&&(tn.forced=!0)):2==en?(null==nn.zpp_pool?Bi=new nn:(Bi=nn.zpp_pool,nn.zpp_pool=Bi.next,Bi.next=null),Bi.forced=!1,Bi.x=o,Bi.y=r,tn=Bi,(u||p)&&(tn.forced=!0)):4==en?(null==nn.zpp_pool?Ri=new nn:(Ri=nn.zpp_pool,nn.zpp_pool=Ri.next,Ri.next=null),Ri.forced=!1,Ri.x=o,Ri.y=s,tn=Ri,(u||d)&&(tn.forced=!0)):6==en?(null==nn.zpp_pool?Fi=new nn:(Fi=nn.zpp_pool,nn.zpp_pool=Fi.next,Fi.next=null),Fi.forced=!1,Fi.x=n,Fi.y=s,tn=Fi,(l||d)&&(tn.forced=!0)):1==en?(null==(tn=i.list[(h<<1)*i.width+a])?(ji=this.xlerp(n,o,r,_,m,t,c),null==nn.zpp_pool?Ni=new nn:(Ni=nn.zpp_pool,nn.zpp_pool=Ni.next,Ni.next=null),Ni.forced=!1,Ni.x=ji,Ni.y=r,tn=Ni,i.list[(h<<1)*i.width+a]=tn):(ji=tn.x,Wi=tn.y,null==nn.zpp_pool?Ui=new nn:(Ui=nn.zpp_pool,nn.zpp_pool=Ui.next,Ui.next=null),Ui.forced=!1,Ui.x=ji,Ui.y=Wi,tn=Ui),p&&(tn.forced=!0),tn.x!=n&&tn.x!=o||(tn.x==n&&0!=(1&Gi)||tn.x==o&&0!=(4&Gi))&&(Gi^=2)):5==en?(null==(tn=i.list[(2+(h<<1))*i.width+a])?(Xi=this.xlerp(n,o,s,x,g,t,c),null==nn.zpp_pool?Vi=new nn:(Vi=nn.zpp_pool,nn.zpp_pool=Vi.next,Vi.next=null),Vi.forced=!1,Vi.x=Xi,Vi.y=s,tn=Vi,i.list[(2+(h<<1))*i.width+a]=tn):(Wi=tn.x,Xi=tn.y,null==nn.zpp_pool?Hi=new nn:(Hi=nn.zpp_pool,nn.zpp_pool=Hi.next,Hi.next=null),Hi.forced=!1,Hi.x=Wi,Hi.y=Xi,tn=Hi),d&&(tn.forced=!0),tn.x!=n&&tn.x!=o||(tn.x==n&&0!=(64&Gi)||tn.x==o&&0!=(16&Gi))&&(Gi^=32)):3==en?(null==(tn=i.list[(1+(h<<1))*i.width+(a+1)])?(Yi=this.ylerp(r,s,o,m,g,t,c),null==nn.zpp_pool?qi=new nn:(qi=nn.zpp_pool,nn.zpp_pool=qi.next,qi.next=null),qi.forced=!1,qi.x=o,qi.y=Yi,tn=qi,i.list[(1+(h<<1))*i.width+(a+1)]=tn):(Yi=tn.x,Ji=tn.y,null==nn.zpp_pool?Ki=new nn:(Ki=nn.zpp_pool,nn.zpp_pool=Ki.next,Ki.next=null),Ki.forced=!1,Ki.x=Yi,Ki.y=Ji,tn=Ki),u&&(tn.forced=!0),tn.y!=r&&tn.y!=s||(tn.y==r&&0!=(4&Gi)||tn.y==s&&0!=(16&Gi))&&(Gi^=8)):(null==(tn=i.list[(1+(h<<1))*i.width+a])?(Qi=this.ylerp(r,s,n,_,x,t,c),null==nn.zpp_pool?Zi=new nn:(Zi=nn.zpp_pool,nn.zpp_pool=Zi.next,Zi.next=null),Zi.forced=!1,Zi.x=n,Zi.y=Qi,tn=Zi,i.list[(1+(h<<1))*i.width+a]=tn):(Ji=tn.x,Qi=tn.y,null==nn.zpp_pool?$i=new nn:($i=nn.zpp_pool,nn.zpp_pool=$i.next,$i.next=null),$i.forced=!1,$i.x=Ji,$i.y=Qi,tn=$i),l&&(tn.forced=!0),tn.y!=r&&tn.y!=s||(tn.y==r&&0!=(1&Gi)||tn.y==s&&0!=(64&Gi))&&(Gi^=128)),tn=tn,null==f.p1?f.p1=tn.prev=tn.next=tn:(tn.prev=f.p1,tn.next=f.p1.next,f.p1.next.prev=tn,f.p1.next=tn),f.p1=tn)}f.p1=f.p1.next,1!=(f.key1=Gi)&&4!=Gi&&16!=Gi&&64!=Gi&&3!=Gi&&12!=Gi&&48!=Gi&&192!=Gi&&129!=Gi&&6!=Gi&&24!=Gi&&96!=Gi&&5!=Gi&&20!=Gi&&80!=Gi&&65!=Gi&&17!=Gi&&68!=Gi||(f.key1=Gi=0,f.p1=null),0==Gi?f=null:(f.pr=f.p1,f.okeyr=f.okey1,f.keyr=f.key1)}}}return f},on.prototype.lerp=function(t,e,i,n){if(0==i)return t;if(0==n)return e;n=i-n,n=n*n<Er.epsilon*Er.epsilon?.5:i/n;return n<0?n=0:1<n&&(n=1),t+n*(e-t)},on.prototype.xlerp=function(t,e,i,n,r,o,s){var a,h;for(h=0==n?t:0==r?e:((a=(a=n-r)*a<Er.epsilon*Er.epsilon?.5:n/a)<0?a=0:1<a&&(a=1),t+a*(e-t));0!=s--&&t<h&&h<e;){var l=o(h,i);if(0==l)break;n*l<0?(e=h,r=l):(t=h,n=l),h=0==n?t:0==r?e:((l=(l=n-r)*l<Er.epsilon*Er.epsilon?.5:n/l)<0?l=0:1<l&&(l=1),t+l*(e-t))}return h},on.prototype.ylerp=function(t,e,i,n,r,o,s){var a,h;for(h=0==n?t:0==r?e:((a=(a=n-r)*a<Er.epsilon*Er.epsilon?.5:n/a)<0?a=0:1<a&&(a=1),t+a*(e-t));0!=s--&&t<h&&h<e;){var l=o(i,h);if(0==l)break;n*l<0?(e=h,r=l):(t=h,n=l),h=0==n?t:0==r?e:((l=(l=n-r)*l<Er.epsilon*Er.epsilon?.5:n/l)<0?l=0:1<l&&(l=1),t+l*(e-t))}return h},on.prototype.__class__=on;var fe=zpp_nape.geom.ZPP_Mat23=function(){this.next=null,this._invalidate=null,this.ty=0,this.tx=0,this.d=0,this.c=0,this.b=0,this.a=0,this.outer=null};fe.__name__=["zpp_nape","geom","ZPP_Mat23"],fe.get=function(){var t;return null==fe.zpp_pool?t=new fe:(t=fe.zpp_pool,fe.zpp_pool=t.next,t.next=null),t},fe.identity=function(){var t=fe.get();return t.setas(1,0,0,1,0,0),t},fe.prototype.outer=null,fe.prototype.wrapper=function(){var t;return null==this.outer&&(this.outer=new V,(t=this.outer.zpp_inner).next=fe.zpp_pool,fe.zpp_pool=t,this.outer.zpp_inner=this),this.outer},fe.prototype.a=null,fe.prototype.b=null,fe.prototype.c=null,fe.prototype.d=null,fe.prototype.tx=null,fe.prototype.ty=null,fe.prototype._invalidate=null,fe.prototype.invalidate=function(){null!=this._invalidate&&this._invalidate()},fe.prototype.set=function(t){this.setas(t.a,t.b,t.c,t.d,t.tx,t.ty)},fe.prototype.setas=function(t,e,i,n,r,o){this.tx=r,this.ty=o,this.a=t,this.b=e,this.c=i,this.d=n},fe.prototype.next=null,fe.prototype.free=function(){},fe.prototype.alloc=function(){},fe.prototype.__class__=fe;var xe=zpp_nape.geom.ZPP_MatMN=function(t,e){this.x=null,this.n=0,this.m=0,this.outer=null,this.m=t,this.n=e,this.x=[];for(var i=0,n=t*e;i<n;)++i,this.x.push(0)};xe.__name__=["zpp_nape","geom","ZPP_MatMN"],xe.prototype.outer=null,xe.prototype.m=null,xe.prototype.n=null,xe.prototype.x=null,xe.prototype.__class__=xe;var ve=zpp_nape.geom.ZPP_Monotone=function(){};ve.__name__=["zpp_nape","geom","ZPP_Monotone"],ve.bisector=function(t){var e=t.prev,i=t.next,n=t.x-e.x,r=t.y-e.y,e=i.x-t.x,i=i.y-t.y;null==Gr.zpp_pool?o=new Gr:(o=Gr.zpp_pool,Gr.zpp_pool=o.next,o.next=null),o.weak=!1,o._immutable=!1,o.x=-r-i,o.y=n+e;var t=o,o=1/Math.sqrt(t.x*t.x+t.y*t.y);return t.x*=o,t.y*=o,i*n-e*r<0&&(t.x=-t.x,t.y=-t.y),t},ve.below=function(t,e){if(t.y<e.y)return!0;if(t.y>e.y)return!1;if(t.x<e.x)return!0;if(t.x>e.x)return!1;var i=ve.bisector(t),n=ve.bisector(e);i.x+=t.x,i.y+=t.y,n.x+=e.x,n.y+=e.y;e=i.x<n.x||i.x==n.x&&i.y<n.y;return null!=i.outer&&(i.outer.zpp_inner=null,i.outer=null),i._isimmutable=null,i._validate=null,i._invalidate=null,i.next=Gr.zpp_pool,Gr.zpp_pool=i,null!=n.outer&&(n.outer.zpp_inner=null,n.outer=null),n._isimmutable=null,n._validate=null,n._invalidate=null,n.next=Gr.zpp_pool,Gr.zpp_pool=n,e},ve.above=function(t,e){return ve.below(e,t)},ve.left_vertex=function(t){var e=t.prev;return e.y>t.y||e.y==t.y&&t.next.y<t.y},ve.isMonotone=function(t){var e=t,i=t,n=t.next;if(null!=n)for(var r=n;;){var o=r;if(o.y<e.y&&(e=o),o.y>i.y&&(i=o),(r=r.next)==t)break}var s=!0,a=e;if(i!=e.next){var h=e.next,l=i;if(null!=h)for(var p=h;;){var u=p;if(u.y<a.y){s=!1;break}if(a=u,(p=p.next)==l)break}}if(!s)return!1;if(i!=(a=e).prev){var h=e.prev,d=i;if(null!=h)for(var c=h;;){var y=c;if(y.y<a.y){s=!1;break}if(a=y,(c=c.prev)==d)break}}return s},ve.sharedPPoly=null,ve.getShared=function(){return null==ve.sharedPPoly&&(ve.sharedPPoly=new ze),ve.sharedPPoly},ve.decompose=function(t,e){if(null==e?e=new ze(t):e.init(t),null==e.vertices)return e;null==ve.queue&&(ve.queue=new bi);var t=e.vertices,i=e.vertices;if(null!=t)for(var n=t;;){var r=n;ve.queue.add(r);var o=r.next.x-r.x,s=r.next.y-r.y,a=r.prev.x-r.x,s=0<(r.prev.y-r.y)*o-a*s;if(r.type=ve.below(r.prev,r)?ve.below(r.next,r)?s?0:3:4:ve.below(r,r.next)?s?1:2:4,(n=n.next)==i)break}t=ve.queue;if(null!=t.head&&null!=t.head.next){for(var h,l,p,u=t.head,d=null,c=null,y=null,_=null,m=1;;){for(h=0,c=u,d=u=null;null!=c;){for(++h,y=c,l=0,p=m;null!=y&&l<m;)++l,y=y.next;for(;0<l||0<p&&null!=y;)0!=l&&(0==p||null==y||ve.above(c.elt,y.elt))?(c=(_=c).next,--l):(y=(_=y).next,--p),null!=d?d.next=_:u=_,d=_;c=y}if(d.next=null,m<<=1,!(1<h))break}t.head=u,t.modified=!0,t.pushmod=!0}for(null==ve.edges&&(null==Nn.zpp_pool?ve.edges=new Nn:(ve.edges=Nn.zpp_pool,Nn.zpp_pool=ve.edges.next,ve.edges.next=null),ve.edges.lt=we.edge_lt,ve.edges.swapped=we.edge_swap);null!=ve.queue.head;){var g=ve.queue.pop_unsafe();switch(g.type){case 0:(g.helper=g).node=ve.edges.insert(g);break;case 1:var f=g.prev;2==f.helper.type&&e.add_diagonal(g,f.helper),ve.edges.remove_node(f.node);break;case 2:f=g.prev;2==f.helper.type&&e.add_diagonal(g,f.helper),ve.edges.remove_node(f.node);var x=null;if(!ve.edges.empty()){for(var v=ve.edges.parent;null!=v.prev;)v=v.prev;for(;null!=v;){var w=v.data;if(!we.vert_lt(w,g)){x=w;break}if(null!=v.next)for(v=v.next;null!=v.prev;)v=v.prev;else{for(;null!=v.parent&&v==v.parent.next;)v=v.parent;v=v.parent}}}f=x;null!=f&&(2==f.helper.type&&e.add_diagonal(g,f.helper),f.helper=g);break;case 3:var z=null;if(!ve.edges.empty()){for(var b=ve.edges.parent;null!=b.prev;)b=b.prev;for(;null!=b;){var S=b.data;if(!we.vert_lt(S,g)){z=S;break}if(null!=b.next)for(b=b.next;null!=b.prev;)b=b.prev;else{for(;null!=b.parent&&b==b.parent.next;)b=b.parent;b=b.parent}}}var C=z;null!=C&&(e.add_diagonal(g,C.helper),C.helper=g),g.node=ve.edges.insert(g),g.helper=g;break;case 4:C=g.prev;if(ve.left_vertex(g))2==C.helper.type&&e.add_diagonal(g,C.helper),ve.edges.remove_node(C.node),g.node=ve.edges.insert(g),g.helper=g;else{var P=null;if(!ve.edges.empty()){for(var M=ve.edges.parent;null!=M.prev;)M=M.prev;for(;null!=M;){var T=M.data;if(!we.vert_lt(T,g)){P=T;break}if(null!=M.next)for(M=M.next;null!=M.prev;)M=M.prev;else{for(;null!=M.parent&&M==M.parent.next;)M=M.parent;M=M.parent}}}C=P;2==C.helper.type&&e.add_diagonal(g,C.helper),C.helper=g}}}return e},ve.prototype.__class__=ve;var we=zpp_nape.geom.ZPP_PartitionVertex=function(){this.node=null,this.prev=null,this.next=null,this.rightchain=!1,this.helper=null,this.type=0,this.diagonals=null,this.forced=!1,this.y=0,this.x=0,this.mag=0,this.id=0,this.id=we.nextId++,this.diagonals=new bi};we.__name__=["zpp_nape","geom","ZPP_PartitionVertex"],we.get=function(t){var e;return null==we.zpp_pool?e=new we:(e=we.zpp_pool,we.zpp_pool=e.next,e.next=null),e.x=t.x,e.y=t.y,e},we.rightdistance=function(t,e){var i=t.next.y>t.y,n=t.next.x-t.x,r=t.next.y-t.y,o=e.x-t.x;return(i?-1:1)*((e.y-t.y)*n-o*r)},we.vert_lt=function(t,e){if(e==t||e==t.next)return!0;if(t.y!=t.next.y)return we.rightdistance(t,e)<=0;var i=t.x,t=t.next.x;return(i<t?i:t)<=e.x},we.edge_swap=function(t,e){var i=t.node;t.node=e.node,e.node=i},we.edge_lt=function(t,e){if(t==e&&t.next==e.next)return!1;if(t==e.next)return!we.vert_lt(t,e);if(e==t.next)return we.vert_lt(e,t);if(t.y==t.next.y){if(e.y!=e.next.y)return 0<we.rightdistance(e,t)||0<we.rightdistance(e,t.next);var i=t.x,n=t.next.x,r=e.x,o=e.next.x;return(o<r?r:o)<(n<i?i:n)}var s=we.rightdistance(t,e),a=we.rightdistance(t,e.next);if(0==s&&0==a){r=t.x,o=t.next.x,i=e.x,n=e.next.x;return(n<i?i:n)<(o<r?r:o)}if(0<=s*a)return s<0||a<0;a=we.rightdistance(e,t),t=we.rightdistance(e,t.next);return 0<=a*t&&(0<a||0<t)},we.prototype.id=null,we.prototype.mag=null,we.prototype.x=null,we.prototype.y=null,we.prototype.forced=null,we.prototype.diagonals=null,we.prototype.type=null,we.prototype.helper=null,we.prototype.rightchain=null,we.prototype.next=null,we.prototype.prev=null,we.prototype.alloc=function(){},we.prototype.free=function(){this.helper=null},we.prototype.copy=function(){var t;return null==we.zpp_pool?t=new we:(t=we.zpp_pool,we.zpp_pool=t.next,t.next=null),t.x=this.x,t.y=this.y,t.forced=this.forced,t},we.prototype.sort=function(){var t=0,e=0,i=0;t=this.prev.x-this.x,e=this.prev.y-this.y,i=this.next.x-this.x;var n=(this.next.y-this.y)*t-i*e,r=0<n?-1:0==n?0:1,n=this.diagonals;if(null!=n.head&&null!=n.head.next){for(var o,s,a,h,l,p,u=n.head,d=null,c=null,y=null,_=null,m=1;;){for(o=0,c=u,d=u=null;null!=c;){for(++o,y=c,s=0,a=m;null!=y&&s<m;)++s,y=y.next;for(;0<s||0<a&&null!=y;)0!=s&&(0==a||null==y||(1==r?(t=c.elt.x-this.x,e=c.elt.y-this.y,i=y.elt.x-this.x,1==(0<(h=(y.elt.y-this.y)*t-i*e)?-1:0==h?0:1)):(t=this.prev.x-this.x,e=this.prev.y-this.y,i=c.elt.x-this.x,p=(c.elt.y-this.y)*t-i*e,t=this.prev.x-this.x,e=this.prev.y-this.y,i=y.elt.x-this.x,(l=0<p?-1:0==p?0:1)*(p=0<(h=(y.elt.y-this.y)*t-i*e)?-1:0==h?0:1)==1||l*p==0&&(1==l||1==p)?(t=c.elt.x-this.x,e=c.elt.y-this.y,i=y.elt.x-this.x,1==(0<(h=(y.elt.y-this.y)*t-i*e)?-1:0==h?0:1)):-1==l||-1==p?-1==p:0!=l||0!=p||(t=this.x-this.prev.x,e=this.y-this.prev.y,l=t*(i=c.elt.x-this.x)+e*(c.elt.y-this.y),p=t*(i=y.elt.x-this.x)+e*(y.elt.y-this.y),l<0&&0<p||!(p<0&&0<l)))))?(c=(_=c).next,--s):(y=(_=y).next,--a),null!=d?d.next=_:u=_,d=_;c=y}if(d.next=null,m<<=1,!(1<o))break}n.head=u,n.modified=!0,n.pushmod=!0}},we.prototype.node=null,we.prototype.__class__=we;var ze=zpp_nape.geom.ZPP_PartitionedPoly=function(t){this.next=null,this.vertices=null,this.init(t)};ze.__name__=["zpp_nape","geom","ZPP_PartitionedPoly"],ze.sharedPPList=null,ze.getSharedPP=function(){return null==ze.sharedPPList&&(ze.sharedPPList=new Ci),ze.sharedPPList},ze.sharedGVList=null,ze.getShared=function(){return null==ze.sharedGVList&&(ze.sharedGVList=new Pi),ze.sharedGVList},ze.prototype.vertices=null,ze.prototype.eq=function(t,e){var i=t.x,n=t.y,r=0,t=0;return(r=i-e.x)*r+(t=n-e.y)*t<Er.epsilon*Er.epsilon},ze.prototype.next=null,ze.prototype.alloc=function(){},ze.prototype.free=function(){},ze.prototype.init=function(t){if(null!=t){var e=0;if(null!=t)for(var i=t;;){var n=i;if(e+=n.x*(n.next.y-n.prev.y),(i=i.next)==t)break}for(var r=0<.5*e,o=t;;){var s,a,h,l=r?(null==we.zpp_pool?s=new we:(s=we.zpp_pool,we.zpp_pool=s.next,s.next=null),s.x=o.x,s.y=o.y,a=s,null==this.vertices?this.vertices=a.prev=a.next=a:(a.prev=this.vertices,a.next=this.vertices.next,this.vertices.next.prev=a,this.vertices.next=a),a):(null==we.zpp_pool?h=new we:(h=we.zpp_pool,we.zpp_pool=h.next,h.next=null),h.x=o.x,h.y=o.y,l=h,null==this.vertices?this.vertices=l.prev=l.next=l:(l.next=this.vertices,l.prev=this.vertices.prev,this.vertices.prev.next=l,this.vertices.prev=l),l);if(this.vertices=l,this.vertices.forced=o.forced,(o=o.next)==t)break}this.remove_collinear_vertices()}},ze.prototype.remove_collinear_vertices=function(){for(var t,e=this.vertices,i=!0;i||e!=this.vertices;){var n,r,i=!1;if(this.eq(e,e.next)){if(e==this.vertices&&(this.vertices=e.next,i=!0),e.forced&&(e.next.forced=!0),null==(e=null!=e&&e.prev==e?(e.next=e.prev=null,(r=e).helper=null,r.next=we.zpp_pool,we.zpp_pool=r,null):(n=e.next,e.prev.next=e.next,e.next.prev=e.prev,e.next=e.prev=null,(r=e).helper=null,r.next=we.zpp_pool,we.zpp_pool=r,e=null,n))){this.vertices=null;break}}else e=e.next}if(null==this.vertices)return!0;for(;;){for(e=this.vertices,i=!(t=!1);i||e!=this.vertices;){i=!1;var o,s=e.prev,a=e.x-s.x,h=e.y-s.y,s=e.next.x-e.x,h=(e.next.y-e.y)*a-s*h;if(Er.epsilon*Er.epsilon<=h*h)e=e.next;else if(e==this.vertices&&(this.vertices=e.next,i=!0),t=!0,null==(e=null!=e&&e.prev==e?(e.next=e.prev=null,(o=e).helper=null,o.next=we.zpp_pool,we.zpp_pool=o,null):(h=e.next,e.prev.next=e.next,e.next.prev=e.prev,e.next=e.prev=null,(o=e).helper=null,o.next=we.zpp_pool,we.zpp_pool=o,e=null,h))){t=!1,this.vertices=null;break}}if(!t)break}return null==this.vertices},ze.prototype.add_diagonal=function(t,e){t.diagonals.add(e),e.diagonals.add(t),t.forced=e.forced=!0},ze.prototype.extract_partitions=function(t){if(null==t&&(t=new Ci),null!=this.vertices){var e=this.vertices,i=this.vertices;if(null!=e)for(var n=e;;)if(n.sort(),(n=n.next)==i)break;for(this.pull_partitions(this.vertices,t);null!=this.vertices;){var r,o=null!=this.vertices&&this.vertices.prev==this.vertices?(this.vertices.next=this.vertices.prev=null,(r=this.vertices).helper=null,r.next=we.zpp_pool,we.zpp_pool=r,this.vertices=null):(o=this.vertices.next,this.vertices.prev.next=this.vertices.next,this.vertices.next.prev=this.vertices.prev,this.vertices.next=this.vertices.prev=null,(r=this.vertices).helper=null,r.next=we.zpp_pool,we.zpp_pool=r,this.vertices=null,o);this.vertices=o}for(var s=null,a=t.head;null!=a;)a.elt.remove_collinear_vertices()?t.erase(s):a=(s=a).next}return t},ze.prototype.pull_partitions=function(t,e){var i;null==ze.zpp_pool?i=new ze:(i=ze.zpp_pool,ze.zpp_pool=i.next,i.next=null);for(var n,r=t;;){null==we.zpp_pool?n=new we:(n=we.zpp_pool,we.zpp_pool=n.next,n.next=null),n.x=r.x,n.y=r.y,n.forced=r.forced;var o=n;if(null==i.vertices?i.vertices=o.prev=o.next=o:(o.prev=i.vertices,o.next=i.vertices.next,i.vertices.next.prev=o,i.vertices.next=o),i.vertices=o,i.vertices.forced=r.forced,null!=r.diagonals.head){var s=r.diagonals,o=s.head.elt;if(s.pop(),o==t)break;r=this.pull_partitions(r,e)}else r=r.next;if(r==t)break}var a=0,h=i.vertices,l=i.vertices;if(null!=h)for(var p=h;;){var u=p;if(a+=u.x*(u.next.y-u.prev.y),(p=p.next)==l)break}return.5*a!=0&&e.add(i),r},ze.prototype.extract=function(t){if(null==t&&(t=new Pi),null!=this.vertices){var e=this.vertices,i=this.vertices;if(null!=e)for(var n=e;;)if(n.sort(),(n=n.next)==i)break;for(this.pull(this.vertices,t);null!=this.vertices;){var r,o=null!=this.vertices&&this.vertices.prev==this.vertices?(this.vertices.next=this.vertices.prev=null,(r=this.vertices).helper=null,r.next=we.zpp_pool,we.zpp_pool=r,this.vertices=null):(o=this.vertices.next,this.vertices.prev.next=this.vertices.next,this.vertices.next.prev=this.vertices.prev,this.vertices.next=this.vertices.prev=null,(r=this.vertices).helper=null,r.next=we.zpp_pool,we.zpp_pool=r,this.vertices=null,o);this.vertices=o}}return t},ze.prototype.pull=function(t,e){for(var i=null,n=t;;){var r,o=n.x,s=n.y;null==nn.zpp_pool?r=new nn:(r=nn.zpp_pool,nn.zpp_pool=r.next,r.next=null),r.forced=!1,r.x=o,r.y=s;o=r;if(null==i?i=o.prev=o.next=o:(o.prev=i,o.next=i.next,i.next.prev=o,i.next=o),(i=o).forced=n.forced,null!=n.diagonals.head){s=n.diagonals,o=s.head.elt;if(s.pop(),o==t)break;n=this.pull(n,e)}else n=n.next;if(n==t)break}var a=0,h=i;if(null!=i)for(var l=i;;){var p=l;if(a+=p.x*(p.next.y-p.prev.y),(l=l.next)==h)break}var u=.5*a;if(Er.epsilon*Er.epsilon<=u*u){for(var d,c=i,y=!0;y||c!=i;){var y=!1,_=c.x,m=c.y,_=_-c.next.x,m=m-c.next.y;if(_*_+m*m<Er.epsilon*Er.epsilon){if(c==i&&(i=c.next,y=!0),c.forced&&(c.next.forced=!0),null==(c=null!=c&&c.prev==c?c.next=c.prev=null:(m=c.next,c.prev.next=c.next,c.next.prev=c.prev,c.next=c.prev=null,c=null,m))){i=null;break}}else c=c.next}if(null!=i)for(;;){for(c=i,y=!(d=!1);y||c!=i;){y=!1;var g=c.prev,f=c.x-g.x,x=c.y-g.y,g=c.next.x-c.x,x=(c.next.y-c.y)*f-g*x;if(Er.epsilon*Er.epsilon<=x*x)c=c.next;else if(c==i&&(i=c.next,y=!0),d=!0,null==(c=null!=c&&c.prev==c?c.next=c.prev=null:(x=c.next,c.prev.next=c.next,c.next.prev=c.prev,c.next=c.prev=null,c=null,x))){d=!1,i=null;break}}if(!d)break}null!=i&&e.add(i)}return n},ze.prototype.__class__=ze;var be=zpp_nape.geom.ZPP_Ray=function(){var t,e,i,n,r,o;this.zip_dir=!1,this.absnormaly=0,this.absnormalx=0,this.normaly=0,this.normalx=0,this.idiry=0,this.idirx=0,this.diry=0,this.dirx=0,this.originy=0,this.originx=0,this.userData=null,this.maxdist=0,this.direction=null,(this.origin=null)==Bn.poolVec2?t=new St:(t=Bn.poolVec2,Bn.poolVec2=t.zpp_pool,t.zpp_pool=null),null==t.zpp_inner?(null==Gr.zpp_pool?e=new Gr:(e=Gr.zpp_pool,Gr.zpp_pool=e.next,e.next=null),e.weak=!1,e._immutable=!1,e.x=0,e.y=0,t.zpp_inner=e,t.zpp_inner.outer=t):(null!=(e=t.zpp_inner)._validate&&e._validate(),0==t.zpp_inner.x&&(null!=(i=t.zpp_inner)._validate&&i._validate(),0==t.zpp_inner.y)||(t.zpp_inner.x=0,t.zpp_inner.y=0,null!=(i=t.zpp_inner)._invalidate&&i._invalidate(i))),t.zpp_inner.weak=!1,this.origin=t,this.origin.zpp_inner._invalidate=Z(this,this.origin_invalidate),null==Bn.poolVec2?n=new St:(n=Bn.poolVec2,Bn.poolVec2=n.zpp_pool,n.zpp_pool=null),null==n.zpp_inner?(null==Gr.zpp_pool?r=new Gr:(r=Gr.zpp_pool,Gr.zpp_pool=r.next,r.next=null),r.weak=!1,r._immutable=!1,r.x=0,r.y=0,n.zpp_inner=r,n.zpp_inner.outer=n):(null!=(r=n.zpp_inner)._validate&&r._validate(),0==n.zpp_inner.x&&(null!=(o=n.zpp_inner)._validate&&o._validate(),0==n.zpp_inner.y)||(n.zpp_inner.x=0,n.zpp_inner.y=0,null!=(o=n.zpp_inner)._invalidate&&o._invalidate(o))),n.zpp_inner.weak=!1,this.direction=n,this.direction.zpp_inner._invalidate=Z(this,this.direction_invalidate),this.originx=0,this.originy=0,this.dirx=0,this.diry=0,this.zip_dir=!1};be.__name__=["zpp_nape","geom","ZPP_Ray"],be.prototype.origin=null,be.prototype.direction=null,be.prototype.maxdist=null,be.prototype.userData=null,be.prototype.originx=null,be.prototype.originy=null,be.prototype.dirx=null,be.prototype.diry=null,be.prototype.idirx=null,be.prototype.idiry=null,be.prototype.normalx=null,be.prototype.normaly=null,be.prototype.absnormalx=null,be.prototype.absnormaly=null,be.prototype.origin_invalidate=function(t){this.originx=t.x,this.originy=t.y},be.prototype.direction_invalidate=function(t){this.dirx=t.x,this.diry=t.y,this.zip_dir=!0},be.prototype.zip_dir=null,be.prototype.invalidate_dir=function(){this.zip_dir=!0},be.prototype.validate_dir=function(){var t;this.zip_dir&&(this.zip_dir=!1,t=1/Math.sqrt(this.dirx*this.dirx+this.diry*this.diry),this.dirx*=t,this.diry*=t,this.idirx=1/this.dirx,this.idiry=1/this.diry,this.normalx=-this.diry,this.normaly=this.dirx,t=this.normalx,this.absnormalx=t<0?-t:t,t=this.normaly,this.absnormaly=t<0?-t:t)},be.prototype.rayAABB=function(){var t,e,i=this.originx,n=i,r=this.originy,o=r;return this.maxdist>=1/0?(0<this.dirx?n=1/0:this.dirx<0&&(n=-1/0),0<this.diry?o=1/0:this.diry<0&&(o=-1/0)):(n+=this.maxdist*this.dirx,o+=this.maxdist*this.diry),n<i&&(t=i,i=n,n=t),o<r&&(t=r,r=o,o=t),null==De.zpp_pool?e=new De:(e=De.zpp_pool,De.zpp_pool=e.next,e.next=null),e.minx=i,e.miny=r,e.maxx=n,e.maxy=o,e},be.prototype.aabbtest=function(t){var e=this.normalx*(this.originx-.5*(t.minx+t.maxx))+this.normaly*(this.originy-.5*(t.miny+t.maxy));return(e<0?-e:e)<.5*this.absnormalx*(t.maxx-t.minx)+.5*this.absnormaly*(t.maxy-t.miny)},be.prototype.aabbsect=function(t){var e=this.originx>=t.minx&&this.originx<=t.maxx,i=this.originy>=t.miny&&this.originy<=t.maxy;if(e&&i)return 0;for(var n=-1;!(0<=this.dirx&&this.originx>=t.maxx||this.dirx<=0&&this.originx<=t.minx||0<=this.diry&&this.originy>=t.maxy||this.diry<=0&&this.originy<=t.miny);){if(0<this.dirx){var r=(t.minx-this.originx)*this.idirx;if(0<=r&&r<=this.maxdist){var o=this.originy+r*this.diry;if(o>=t.miny&&o<=t.maxy){n=r;break}}}else if(this.dirx<0){o=(t.maxx-this.originx)*this.idirx;if(0<=o&&o<=this.maxdist){r=this.originy+o*this.diry;if(r>=t.miny&&r<=t.maxy){n=o;break}}}if(0<this.diry){var s=(t.miny-this.originy)*this.idiry;if(0<=s&&s<=this.maxdist){var a=this.originx+s*this.dirx;if(a>=t.minx&&a<=t.maxx){n=s;break}}}else if(this.diry<0){a=(t.maxy-this.originy)*this.idiry;if(0<=a&&a<=this.maxdist){s=this.originx+a*this.dirx;if(s>=t.minx&&s<=t.maxx){n=a;break}}}break}return n},be.prototype.circlesect=function(t,e,i){if(t.zip_worldCOM&&null!=t.body){if(t.zip_worldCOM=!1,t.zip_localCOM){if(t.zip_localCOM=!1,1==t.type){var n=t.polygon;if(null==n.lverts.next.next)n.localCOMx=n.lverts.next.x,n.localCOMy=n.lverts.next.y;else if(null==n.lverts.next.next.next)n.localCOMx=n.lverts.next.x,n.localCOMy=n.lverts.next.y,n.localCOMx+=n.lverts.next.next.x,n.localCOMy+=n.lverts.next.next.y,n.localCOMx*=.5,n.localCOMy*=.5;else{n.localCOMx=0;var r=n.localCOMy=0,o=n.lverts.next,s=o,a=o=o.next;for(o=o.next;null!=o;){var h=o;r+=a.x*(h.y-s.y);var l=h.y*a.x-h.x*a.y;n.localCOMx+=(a.x+h.x)*l,n.localCOMy+=(a.y+h.y)*l,s=a,a=h,o=o.next}var p=o=n.lverts.next;r+=a.x*(p.y-s.y);var u=p.y*a.x-p.x*a.y;n.localCOMx+=(a.x+p.x)*u,n.localCOMy+=(a.y+p.y)*u;var s=a,d=o=o.next;r+=p.x*(d.y-s.y);var c=d.y*p.x-d.x*p.y;n.localCOMx+=(p.x+d.x)*c,n.localCOMy+=(p.y+d.y)*c;var y=r=1/(3*r);n.localCOMx*=y,n.localCOMy*=y}}null!=t.wrap_localCOM&&(t.wrap_localCOM.zpp_inner.x=t.localCOMx,t.wrap_localCOM.zpp_inner.y=t.localCOMy)}var _=t.body;_.zip_axis&&(_.zip_axis=!1,_.axisx=Math.sin(_.rot),_.axisy=Math.cos(_.rot)),t.worldCOMx=t.body.posx+(t.body.axisy*t.localCOMx-t.body.axisx*t.localCOMy),t.worldCOMy=t.body.posy+(t.localCOMx*t.body.axisx+t.localCOMy*t.body.axisy)}var m=this.originx-t.worldCOMx,u=this.originy-t.worldCOMy,p=this.dirx*this.dirx+this.diry*this.diry,d=2*(m*this.dirx+u*this.diry),c=m*m+u*u-t.radius*t.radius,y=d*d-4*p*c;if(0==y){var g=-d/2*p;if((!e||0<c)&&0<g&&g<i&&g<=this.maxdist){_=0,m=0,_=this.originx,m=this.originy;_+=this.dirx*g,m+=this.diry*g,_-=t.worldCOMx,m-=t.worldCOMy;var f,x,u=1/Math.sqrt(_*_+m*m);return _*=u,m*=u,c<=0&&(_=-_,m=-m),null==Bn.poolVec2?f=new St:(f=Bn.poolVec2,Bn.poolVec2=f.zpp_pool,f.zpp_pool=null),null==f.zpp_inner?(null==Gr.zpp_pool?x=new Gr:(x=Gr.zpp_pool,Gr.zpp_pool=x.next,x.next=null),x.weak=!1,x._immutable=!1,x.x=_,x.y=m,f.zpp_inner=x,f.zpp_inner.outer=f):(null!=(x=f.zpp_inner)._validate&&x._validate(),f.zpp_inner.x==_&&(null!=(x=f.zpp_inner)._validate&&x._validate(),f.zpp_inner.y==m)||(f.zpp_inner.x=_,f.zpp_inner.y=m,null!=(m=f.zpp_inner)._invalidate&&m._invalidate(m))),f.zpp_inner.weak=!1,ce.getRay(f,g,c<=0,t.outer)}return null}var g=(-d-(y=Math.sqrt(y)))*(p=1/(2*p)),c=(-d+y)*p;if(0<g){if(g<i&&g<=this.maxdist){d=this.originx,y=this.originy;d+=this.dirx*g,y+=this.diry*g,d-=t.worldCOMx,y-=t.worldCOMy;var v,w,p=1/Math.sqrt(d*d+y*y);return d*=p,y*=p,null==Bn.poolVec2?v=new St:(v=Bn.poolVec2,Bn.poolVec2=v.zpp_pool,v.zpp_pool=null),null==v.zpp_inner?(null==Gr.zpp_pool?w=new Gr:(w=Gr.zpp_pool,Gr.zpp_pool=w.next,w.next=null),w.weak=!1,w._immutable=!1,w.x=d,w.y=y,v.zpp_inner=w,v.zpp_inner.outer=v):(null!=(w=v.zpp_inner)._validate&&w._validate(),v.zpp_inner.x==d&&(null!=(w=v.zpp_inner)._validate&&w._validate(),v.zpp_inner.y==y)||(v.zpp_inner.x=d,v.zpp_inner.y=y,null!=(y=v.zpp_inner)._invalidate&&y._invalidate(y))),v.zpp_inner.weak=!1,ce.getRay(v,g,!1,t.outer)}return null}if(0<c&&e){if(c<i&&c<=this.maxdist){g=this.originx,e=this.originy;g+=this.dirx*c,e+=this.diry*c,g-=t.worldCOMx,e-=t.worldCOMy;var z,b,i=1/Math.sqrt(g*g+e*e);return g=-(g*=i),e=-(e*=i),null==Bn.poolVec2?z=new St:(z=Bn.poolVec2,Bn.poolVec2=z.zpp_pool,z.zpp_pool=null),null==z.zpp_inner?(null==Gr.zpp_pool?b=new Gr:(b=Gr.zpp_pool,Gr.zpp_pool=b.next,b.next=null),b.weak=!1,b._immutable=!1,b.x=g,b.y=e,z.zpp_inner=b,z.zpp_inner.outer=z):(null!=(b=z.zpp_inner)._validate&&b._validate(),z.zpp_inner.x==g&&(null!=(b=z.zpp_inner)._validate&&b._validate(),z.zpp_inner.y==e)||(z.zpp_inner.x=g,z.zpp_inner.y=e,null!=(e=z.zpp_inner)._invalidate&&e._invalidate(e))),z.zpp_inner.weak=!1,ce.getRay(z,c,!0,t.outer)}return null}return null},be.prototype.circlesect2=function(t,e,i){if(t.zip_worldCOM&&null!=t.body){if(t.zip_worldCOM=!1,t.zip_localCOM){if(t.zip_localCOM=!1,1==t.type){var n=t.polygon;if(null==n.lverts.next.next)n.localCOMx=n.lverts.next.x,n.localCOMy=n.lverts.next.y;else if(null==n.lverts.next.next.next)n.localCOMx=n.lverts.next.x,n.localCOMy=n.lverts.next.y,n.localCOMx+=n.lverts.next.next.x,n.localCOMy+=n.lverts.next.next.y,n.localCOMx*=.5,n.localCOMy*=.5;else{n.localCOMx=0;var r=n.localCOMy=0,o=n.lverts.next,s=o,a=o=o.next;for(o=o.next;null!=o;){var h=o;r+=a.x*(h.y-s.y);var l=h.y*a.x-h.x*a.y;n.localCOMx+=(a.x+h.x)*l,n.localCOMy+=(a.y+h.y)*l,s=a,a=h,o=o.next}var p=o=n.lverts.next;r+=a.x*(p.y-s.y);var u=p.y*a.x-p.x*a.y;n.localCOMx+=(a.x+p.x)*u,n.localCOMy+=(a.y+p.y)*u;var s=a,d=o=o.next;r+=p.x*(d.y-s.y);var c=d.y*p.x-d.x*p.y;n.localCOMx+=(p.x+d.x)*c,n.localCOMy+=(p.y+d.y)*c;var y=r=1/(3*r);n.localCOMx*=y,n.localCOMy*=y}}null!=t.wrap_localCOM&&(t.wrap_localCOM.zpp_inner.x=t.localCOMx,t.wrap_localCOM.zpp_inner.y=t.localCOMy)}var _=t.body;_.zip_axis&&(_.zip_axis=!1,_.axisx=Math.sin(_.rot),_.axisy=Math.cos(_.rot)),t.worldCOMx=t.body.posx+(t.body.axisy*t.localCOMx-t.body.axisx*t.localCOMy),t.worldCOMy=t.body.posy+(t.localCOMx*t.body.axisx+t.localCOMy*t.body.axisy)}var m=this.originx-t.worldCOMx,g=this.originy-t.worldCOMy,u=this.dirx*this.dirx+this.diry*this.diry,p=2*(m*this.dirx+g*this.diry),d=m*m+g*g-t.radius*t.radius;if(0==(c=p*p-4*u*d)){y=-p/2*u;if((!e||0<d)&&0<y&&y<=this.maxdist){_=0,m=0,_=this.originx,m=this.originy;_+=this.dirx*y,m+=this.diry*y,_-=t.worldCOMx,m-=t.worldCOMy;var f,g=1/Math.sqrt(_*_+m*m);_*=g,m*=g,d<=0&&(_=-_,m=-m),null==Bn.poolVec2?z=new St:(z=Bn.poolVec2,Bn.poolVec2=z.zpp_pool,z.zpp_pool=null),null==z.zpp_inner?(null==Gr.zpp_pool?f=new Gr:(f=Gr.zpp_pool,Gr.zpp_pool=f.next,f.next=null),f.weak=!1,f._immutable=!1,f.x=_,f.y=m,z.zpp_inner=f,z.zpp_inner.outer=z):(null!=(f=z.zpp_inner)._validate&&f._validate(),z.zpp_inner.x==_&&(null!=(f=z.zpp_inner)._validate&&f._validate(),z.zpp_inner.y==m)||(z.zpp_inner.x=_,z.zpp_inner.y=m,null!=(m=z.zpp_inner)._invalidate&&m._invalidate(m))),z.zpp_inner.weak=!1;for(var x=ce.getRay(z,y,d<=0,t.outer),v=null,w=i.zpp_inner.inner.head;null!=w&&!(x.zpp_inner.toiDistance<w.elt.zpp_inner.toiDistance);)w=(v=w).next;var z=i.zpp_inner.inner;null==vn.zpp_pool?b=new vn:(b=vn.zpp_pool,vn.zpp_pool=b.next,b.next=null),b.elt=x;var b=b;null==v?(b.next=z.head,z.head=b):(b.next=v.next,v.next=b),z.pushmod=z.modified=!0,z.length++}}else{b=(-p-(c=Math.sqrt(c)))*(u=1/(2*u)),z=(-p+c)*u;if(0<b&&b<=this.maxdist){p=this.originx,c=this.originy;p+=this.dirx*b,c+=this.diry*b,p-=t.worldCOMx,c-=t.worldCOMy;var S,u=1/Math.sqrt(p*p+c*c);p*=u,c*=u,null==Bn.poolVec2?T=new St:(T=Bn.poolVec2,Bn.poolVec2=T.zpp_pool,T.zpp_pool=null),null==T.zpp_inner?(null==Gr.zpp_pool?S=new Gr:(S=Gr.zpp_pool,Gr.zpp_pool=S.next,S.next=null),S.weak=!1,S._immutable=!1,S.x=p,S.y=c,T.zpp_inner=S,T.zpp_inner.outer=T):(null!=(S=T.zpp_inner)._validate&&S._validate(),T.zpp_inner.x==p&&(null!=(S=T.zpp_inner)._validate&&S._validate(),T.zpp_inner.y==c)||(T.zpp_inner.x=p,T.zpp_inner.y=c,null!=(c=T.zpp_inner)._invalidate&&c._invalidate(c))),T.zpp_inner.weak=!1;for(var C=ce.getRay(T,b,!1,t.outer),P=null,M=i.zpp_inner.inner.head;null!=M&&!(C.zpp_inner.toiDistance<M.elt.zpp_inner.toiDistance);)M=(P=M).next;var T=i.zpp_inner.inner;null==vn.zpp_pool?A=new vn:(A=vn.zpp_pool,vn.zpp_pool=A.next,A.next=null),A.elt=C;var A=A;null==P?(A.next=T.head,T.head=A):(A.next=P.next,P.next=A),T.pushmod=T.modified=!0,T.length++}if(0<z&&z<=this.maxdist&&e){A=this.originx,T=this.originy;A+=this.dirx*z,T+=this.diry*z,A-=t.worldCOMx,T-=t.worldCOMy;var k,O,e=1/Math.sqrt(A*A+T*T);A=-(A*=e),T=-(T*=e),null==Bn.poolVec2?k=new St:(k=Bn.poolVec2,Bn.poolVec2=k.zpp_pool,k.zpp_pool=null),null==k.zpp_inner?(null==Gr.zpp_pool?O=new Gr:(O=Gr.zpp_pool,Gr.zpp_pool=O.next,O.next=null),O.weak=!1,O._immutable=!1,O.x=A,O.y=T,k.zpp_inner=O,k.zpp_inner.outer=k):(null!=(O=k.zpp_inner)._validate&&O._validate(),k.zpp_inner.x==A&&(null!=(O=k.zpp_inner)._validate&&O._validate(),k.zpp_inner.y==T)||(k.zpp_inner.x=A,k.zpp_inner.y=T,null!=(T=k.zpp_inner)._invalidate&&T._invalidate(T))),k.zpp_inner.weak=!1;for(var E=ce.getRay(k,z,!0,t.outer),I=null,G=i.zpp_inner.inner.head;null!=G&&!(E.zpp_inner.toiDistance<G.elt.zpp_inner.toiDistance);)G=(I=G).next;i=i.zpp_inner.inner;null==vn.zpp_pool?D=new vn:(D=vn.zpp_pool,vn.zpp_pool=D.next,D.next=null),D.elt=E;var D=D;null==I?(D.next=i.head,i.head=D):(D.next=I.next,I.next=D),i.pushmod=i.modified=!0,i.length++}}},be.prototype.polysect=function(t,e,i){for(var n=i,r=null,o=t.edges.head,s=t.gverts.next,a=s,h=s.next;null!=h;){var l,p,u,d,c=h,y=o.elt;(e||y.gnormx*this.dirx+y.gnormy*this.diry<0)&&(l=d=0,d=c.x-a.x,l=c.y-a.y,u=p=0,p=a.x-this.originx,u=a.y-this.originy,y=l*this.dirx-d*this.diry,Er.epsilon<y*y&&(0<(d=(l*p-d*u)*(y=1/y))&&d<n&&d<=this.maxdist&&(y=(this.diry*p-this.dirx*u)*y,-Er.epsilon<y&&y<1+Er.epsilon&&(n=d,r=o.elt)))),o=o.next,a=c,h=h.next}for(;;){var _,m,g,f=h=t.gverts.next,x=o.elt;(e||x.gnormx*this.dirx+x.gnormy*this.diry<0)&&(_=g=0,g=f.x-a.x,_=f.y-a.y,x=m=0,m=a.x-this.originx,x=a.y-this.originy,f=_*this.dirx-g*this.diry,Er.epsilon<f*f&&(0<(g=(_*m-g*x)*(f=1/f))&&g<n&&g<=this.maxdist&&(f=(this.diry*m-this.dirx*x)*f,-Er.epsilon<f&&f<1+Er.epsilon&&(n=g,r=o.elt)))),o=o.next;break}if(null==r)return null;var v,w,z=0,i=0,z=r.gnormx,i=r.gnormy,s=0<z*this.dirx+i*this.diry;return s&&(z=-z,i=-i),null==Bn.poolVec2?v=new St:(v=Bn.poolVec2,Bn.poolVec2=v.zpp_pool,v.zpp_pool=null),null==v.zpp_inner?(null==Gr.zpp_pool?w=new Gr:(w=Gr.zpp_pool,Gr.zpp_pool=w.next,w.next=null),w.weak=!1,w._immutable=!1,w.x=z,w.y=i,v.zpp_inner=w,v.zpp_inner.outer=v):(null!=(w=v.zpp_inner)._validate&&w._validate(),v.zpp_inner.x==z&&(null!=(w=v.zpp_inner)._validate&&w._validate(),v.zpp_inner.y==i)||(v.zpp_inner.x=z,v.zpp_inner.y=i,null!=(i=v.zpp_inner)._invalidate&&i._invalidate(i))),v.zpp_inner.weak=!1,ce.getRay(v,n,s,t.outer)},be.prototype.polysect2=function(t,e,i){for(var n=1/0,r=-1,o=null,s=null,a=t.edges.head,h=t.gverts.next,l=h,p=h.next;null!=p;){var u,d,c,y,_=p,m=a.elt;(e||m.gnormx*this.dirx+m.gnormy*this.diry<0)&&(u=y=0,y=_.x-l.x,u=_.y-l.y,c=d=0,d=l.x-this.originx,c=l.y-this.originy,m=u*this.dirx-y*this.diry,Er.epsilon<m*m&&(0<(y=(u*d-y*c)*(m=1/m))&&y<=this.maxdist&&(y<n||r<y)&&(m=(this.diry*d-this.dirx*c)*m,-Er.epsilon<m&&m<1+Er.epsilon&&(y<n&&(n=y,o=a.elt),r<y&&(r=y,s=a.elt))))),a=a.next,l=_,p=p.next}for(;;){var g,f,x,v=p=t.gverts.next,w=a.elt;(e||w.gnormx*this.dirx+w.gnormy*this.diry<0)&&(g=x=0,x=v.x-l.x,g=v.y-l.y,w=f=0,f=l.x-this.originx,w=l.y-this.originy,v=g*this.dirx-x*this.diry,Er.epsilon<v*v&&(0<(x=(g*f-x*w)*(v=1/v))&&x<=this.maxdist&&(x<n||r<x)&&(v=(this.diry*f-this.dirx*w)*v,-Er.epsilon<v&&v<1+Er.epsilon&&(x<n&&(n=x,o=a.elt),r<x&&(r=x,s=a.elt))))),a=a.next;break}if(null!=o){var z,b=0,h=0,b=o.gnormx,h=o.gnormy,S=0<b*this.dirx+h*this.diry;S&&(b=-b,h=-h),null==Bn.poolVec2?T=new St:(T=Bn.poolVec2,Bn.poolVec2=T.zpp_pool,T.zpp_pool=null),null==T.zpp_inner?(null==Gr.zpp_pool?z=new Gr:(z=Gr.zpp_pool,Gr.zpp_pool=z.next,z.next=null),z.weak=!1,z._immutable=!1,z.x=b,z.y=h,T.zpp_inner=z,T.zpp_inner.outer=T):(null!=(z=T.zpp_inner)._validate&&z._validate(),T.zpp_inner.x==b&&(null!=(z=T.zpp_inner)._validate&&z._validate(),T.zpp_inner.y==h)||(T.zpp_inner.x=b,T.zpp_inner.y=h,null!=(h=T.zpp_inner)._invalidate&&h._invalidate(h))),T.zpp_inner.weak=!1;for(var C=ce.getRay(T,n,S,t.outer),P=null,M=i.zpp_inner.inner.head;null!=M&&!(C.zpp_inner.toiDistance<M.elt.zpp_inner.toiDistance);)M=(P=M).next;var T=i.zpp_inner.inner;null==vn.zpp_pool?O=new vn:(O=vn.zpp_pool,vn.zpp_pool=O.next,O.next=null),O.elt=C;S=O;null==P?(S.next=T.head,T.head=S):(S.next=P.next,P.next=S),T.pushmod=T.modified=!0,T.length++}if(null!=s&&o!=s){var A,k,O=0,S=0,O=s.gnormx,S=s.gnormy,T=0<O*this.dirx+S*this.diry;T&&(O=-O,S=-S),null==Bn.poolVec2?A=new St:(A=Bn.poolVec2,Bn.poolVec2=A.zpp_pool,A.zpp_pool=null),null==A.zpp_inner?(null==Gr.zpp_pool?k=new Gr:(k=Gr.zpp_pool,Gr.zpp_pool=k.next,k.next=null),k.weak=!1,k._immutable=!1,k.x=O,k.y=S,A.zpp_inner=k,A.zpp_inner.outer=A):(null!=(k=A.zpp_inner)._validate&&k._validate(),A.zpp_inner.x==O&&(null!=(k=A.zpp_inner)._validate&&k._validate(),A.zpp_inner.y==S)||(A.zpp_inner.x=O,A.zpp_inner.y=S,null!=(S=A.zpp_inner)._invalidate&&S._invalidate(S))),A.zpp_inner.weak=!1;for(var E=ce.getRay(A,r,T,t.outer),I=null,G=i.zpp_inner.inner.head;null!=G&&!(E.zpp_inner.toiDistance<G.elt.zpp_inner.toiDistance);)G=(I=G).next;i=i.zpp_inner.inner;null==vn.zpp_pool?D=new vn:(D=vn.zpp_pool,vn.zpp_pool=D.next,D.next=null),D.elt=E;var D=D;null==I?(D.next=i.head,i.head=D):(D.next=I.next,I.next=D),i.pushmod=i.modified=!0,i.length++}},be.prototype.__class__=be;var Se=zpp_nape.geom.ZPP_SimpleVert=function(){this.node=null,this.next=null,this.id=0,this.links=null,this.y=0,this.x=0,this.forced=!1,this.id=xt.ZPP_SimpleVert(),null==Un.zpp_pool?this.links=new Un:(this.links=Un.zpp_pool,Un.zpp_pool=this.links.next,this.links.next=null),this.links.lt=Se.less_xy};Se.__name__=["zpp_nape","geom","ZPP_SimpleVert"],Se.less_xy=function(t,e){return t.y<e.y||t.y==e.y&&t.x<e.x},Se.swap_nodes=function(t,e){var i=t.node;t.node=e.node,e.node=i},Se.get=function(t,e){var i;return null==Se.zpp_pool?i=new Se:(i=Se.zpp_pool,Se.zpp_pool=i.next,i.next=null),i.x=t,i.y=e,i},Se.prototype.forced=null,Se.prototype.x=null,Se.prototype.y=null,Se.prototype.links=null,Se.prototype.id=null,Se.prototype.next=null,Se.prototype.node=null,Se.prototype.free=function(){this.links.clear(),this.node=null,this.forced=!1},Se.prototype.alloc=function(){},Se.prototype.__class__=Se;var Ce=zpp_nape.geom.ZPP_SimpleSeg=function(){this.node=null,this.prev=null,this.next=null,this.id=0,this.vertices=null,this.right=null,this.left=null,this.id=xt.ZPP_SimpleSeg(),null==Un.zpp_pool?this.vertices=new Un:(this.vertices=Un.zpp_pool,Un.zpp_pool=this.vertices.next,this.vertices.next=null),this.vertices.lt=Z(this,this.less_xy)};Ce.__name__=["zpp_nape","geom","ZPP_SimpleSeg"],Ce.get=function(t,e){var i;return null==Ce.zpp_pool?i=new Ce:(i=Ce.zpp_pool,Ce.zpp_pool=i.next,i.next=null),i.left=t,i.right=e,i.vertices.insert(t),i.vertices.insert(e),i},Ce.prototype.left=null,Ce.prototype.right=null,Ce.prototype.vertices=null,Ce.prototype.id=null,Ce.prototype.next=null,Ce.prototype.free=function(){this.left=this.right=null,this.prev=null,this.node=null,this.vertices.clear()},Ce.prototype.alloc=function(){},Ce.prototype.prev=null,Ce.prototype.node=null,Ce.prototype.less_xy=function(t,e){return t.x<e.x||t.x==e.x&&t.y<e.y},Ce.prototype.__class__=Ce;var Pe=zpp_nape.geom.ZPP_SimpleEvent=function(){this.next=null,this.node=null,this.segment2=null,this.segment=null,this.vertex=null,this.type=0};Pe.__name__=["zpp_nape","geom","ZPP_SimpleEvent"],Pe.swap_nodes=function(t,e){var i=t.node;t.node=e.node,e.node=i},Pe.less_xy=function(t,e){return t.vertex.x<e.vertex.x||!(t.vertex.x>e.vertex.x)&&(t.vertex.y<e.vertex.y||!(t.vertex.y>e.vertex.y)&&t.type<e.type)},Pe.get=function(t){var e;return null==Pe.zpp_pool?e=new Pe:(e=Pe.zpp_pool,Pe.zpp_pool=e.next,e.next=null),e.vertex=t,e},Pe.prototype.type=null,Pe.prototype.vertex=null,Pe.prototype.segment=null,Pe.prototype.segment2=null,Pe.prototype.node=null,Pe.prototype.next=null,Pe.prototype.free=function(){this.vertex=null,this.segment=this.segment2=null,this.node=null},Pe.prototype.alloc=function(){},Pe.prototype.__class__=Pe;var Me=zpp_nape.geom.ZPP_SimpleSweep=function(){this.tree=null,this.sweepx=0,null==Vn.zpp_pool?this.tree=new Vn:(this.tree=Vn.zpp_pool,Vn.zpp_pool=this.tree.next,this.tree.next=null),this.tree.lt=Z(this,this.edge_lt),this.tree.swapped=Z(this,this.swap_nodes)};Me.__name__=["zpp_nape","geom","ZPP_SimpleSweep"],Me.prototype.sweepx=null,Me.prototype.tree=null,Me.prototype.swap_nodes=function(t,e){var i=t.node;t.node=e.node,e.node=i},Me.prototype.edge_lt=function(t,e){var i=0,n=0,r=0,o=0;if(t.left==e.left&&t.right==e.right)return!1;if(t.left==e.right)return t.left.x==t.right.x?t.left.y<t.right.y?t.left.y>e.left.y:t.right.y>e.left.y:(a=t.right.x<t.left.x,i=t.right.x-t.left.x,n=t.right.y-t.left.y,r=e.left.x-t.left.x,o=e.left.y-t.left.y,(a?n*r-i*o:o*i-r*n)<0);if(t.right==e.left){var s=e.left.x==e.right.x?e.left.y<e.right.y?e.left.y>t.left.y:e.right.y>t.left.y:(a=e.right.x<e.left.x,i=e.right.x-e.left.x,n=e.right.y-e.left.y,r=t.left.x-e.left.x,o=t.left.y-e.left.y,(a?n*r-i*o:o*i-r*n)<0);return!s}if(t.left==e.left)return t.left.x==t.right.x?t.left.y<t.right.y?t.left.y>e.right.y:t.right.y>e.right.y:(a=t.right.x<t.left.x,i=t.right.x-t.left.x,n=t.right.y-t.left.y,r=e.right.x-t.left.x,o=e.right.y-t.left.y,(a?n*r-i*o:o*i-r*n)<0);if(t.right==e.right)return t.left.x==t.right.x?t.left.y<t.right.y?t.left.y>e.left.y:t.right.y>e.left.y:(a=t.right.x<t.left.x,i=t.right.x-t.left.x,n=t.right.y-t.left.y,r=e.left.x-t.left.x,o=e.left.y-t.left.y,(a?n*r-i*o:o*i-r*n)<0);if(t.left.x==t.right.x){if(e.left.x==e.right.x)return(t.left.y<t.right.y?t.right:t.left).y>(e.left.y<e.right.y?e.right:e.left).y;var a=e.right.x<e.left.x,i=e.right.x-e.left.x,n=e.right.y-e.left.y,r=t.left.x-e.left.x,o=t.left.y-e.left.y,s=a?n*r-i*o:o*i-r*n;return a=e.right.x<e.left.x,i=e.right.x-e.left.x,n=e.right.y-e.left.y,r=t.right.x-e.left.x,o=t.right.y-e.left.y,0<=s*(a?n*r-i*o:o*i-r*n)?0<=s:this.sweepx>=t.left.x}if(e.left.x==e.right.x){a=t.right.x<t.left.x,i=t.right.x-t.left.x,n=t.right.y-t.left.y,r=e.left.x-t.left.x,o=e.left.y-t.left.y;var h=a?n*r-i*o:o*i-r*n;return a=t.right.x<t.left.x,i=t.right.x-t.left.x,n=t.right.y-t.left.y,r=e.right.x-t.left.x,o=e.right.y-t.left.y,0<=h*(a?n*r-i*o:o*i-r*n)?h<0:this.sweepx<e.left.x}a=t.right.x<t.left.x,i=t.right.x-t.left.x,n=t.right.y-t.left.y,r=e.left.x-t.left.x,o=e.left.y-t.left.y;h=(a?n*r-i*o:o*i-r*n)<0;if(a=t.right.x<t.left.x,i=t.right.x-t.left.x,n=t.right.y-t.left.y,r=e.right.x-t.left.x,o=e.right.y-t.left.y,h==(a?n*r-i*o:o*i-r*n)<0)return h;a=e.right.x<e.left.x,i=e.right.x-e.left.x,n=e.right.y-e.left.y,r=t.left.x-e.left.x,o=t.left.y-e.left.y;h=0<=(a?n*r-i*o:o*i-r*n);return a=e.right.x<e.left.x,i=e.right.x-e.left.x,n=e.right.y-e.left.y,r=t.right.x-e.left.x,o=t.right.y-e.left.y,h==0<=(a?n*r-i*o:o*i-r*n)?h:(this.sweepx-t.left.x)/(t.right.x-t.left.x)*(t.right.y-t.left.y)+t.left.y>(this.sweepx-e.left.x)/(e.right.x-e.left.x)*(e.right.y-e.left.y)+e.left.y},Me.prototype.clear=function(){this.tree.clear()},Me.prototype.add=function(t){t.node=this.tree.insert(t);var e=this.tree.successor_node(t.node),i=this.tree.predecessor_node(t.node);return null!=e&&(t.next=e.data,e.data.prev=t),null!=i&&(t.prev=i.data,i.data.next=t),t},Me.prototype.remove=function(t){var e=this.tree.successor_node(t.node),i=this.tree.predecessor_node(t.node);null!=e&&(e.data.prev=t.prev),null!=i&&(i.data.next=t.next),this.tree.remove_node(t.node),t.node=null},Me.prototype.intersect=function(t,e){if(null==t||null==e)return!1;if(t.left==e.left||t.left==e.right||t.right==e.left||t.right==e.right)return!1;var i=(e.left.x-t.left.x)*(t.right.y-t.left.y)-(t.right.x-t.left.x)*(e.left.y-t.left.y),n=(e.right.x-t.left.x)*(t.right.y-t.left.y)-(t.right.x-t.left.x)*(e.right.y-t.left.y);if(0<i*n)return!1;n=(t.left.x-e.left.x)*(e.right.y-e.left.y)-(e.right.x-e.left.x)*(t.left.y-e.left.y),e=(t.right.x-e.left.x)*(e.right.y-e.left.y)-(e.right.x-e.left.x)*(t.right.y-e.left.y);return!(0<n*e)},Me.prototype.intersection=function(t,e){if(null==t||null==e)return null;if(t.left==e.left||t.left==e.right||t.right==e.left||t.right==e.right)return null;var i=t.right.x-t.left.x,n=t.right.y-t.left.y,r=0,o=e.right.x-e.left.x,s=(r=e.right.y-e.left.y)*i-o*n;if(0==s)return null;var a=0,h=0,l=(r*(a=e.left.x-t.left.x)-o*(h=e.left.y-t.left.y))*(s=1/s);if(l<0||1<l)return null;var p,s=(n*a-i*h)*s;if(s<0||1<s)return null;p=0==s||1==s||0==l||1==l?0==s?e.left:1==s?e.right:0==l?t.left:t.right:(o=.5*(t.left.x+i*l+e.left.x+o*s),s=.5*(t.left.y+n*l+e.left.y+r*s),null==Se.zpp_pool?p=new Se:(p=Se.zpp_pool,Se.zpp_pool=p.next,p.next=null),p.x=o,p.y=s,p),null==Pe.zpp_pool?u=new Pe:(u=Pe.zpp_pool,Pe.zpp_pool=u.next,u.next=null),u.vertex=p;var u=u;return u.type=0,u.segment=t,u.segment2=e,u},Me.prototype.__class__=Me;var Te=zpp_nape.geom.ZPP_Simple=function(){};Te.__name__=["zpp_nape","geom","ZPP_Simple"],Te.decompose=function(t,e){null==Te.sweep&&(Te.sweep=new Me,Te.inthash=new li),null==Te.vertices&&(null==Un.zpp_pool?Te.vertices=new Un:(Te.vertices=Un.zpp_pool,Un.zpp_pool=Te.vertices.next,Te.vertices.next=null),Te.vertices.lt=Se.less_xy,Te.vertices.swapped=Se.swap_nodes),null==Te.queue&&(null==Wn.zpp_pool?Te.queue=new Wn:(Te.queue=Wn.zpp_pool,Wn.zpp_pool=Te.queue.next,Te.queue.next=null),Te.queue.lt=Pe.less_xy,Te.queue.swapped=Pe.swap_nodes);var i=null,n=null;if(null!=t)for(var r=t;;){var o,s=r,a=s.x,s=s.y;null==Se.zpp_pool?o=new Se:(o=Se.zpp_pool,Se.zpp_pool=o.next,o.next=null),o.x=a,o.y=s;for(var h=o,l=Te.vertices.parent;null!=l;)if(Te.vertices.lt(h,l.data))l=l.prev;else{if(!Te.vertices.lt(l.data,h))break;l=l.next}var p,u,d,a=l;if(null!=a?((d=h).links.clear(),d.node=null,d.forced=!1,d.next=Se.zpp_pool,Se.zpp_pool=d,h=a.data):h.node=Te.vertices.insert(h),null!=n&&(null==Pe.zpp_pool?p=new Pe:(p=Pe.zpp_pool,Pe.zpp_pool=p.next,p.next=null),p.vertex=n,s=p,null==Pe.zpp_pool?u=new Pe:(u=Pe.zpp_pool,Pe.zpp_pool=u.next,u.next=null),u.vertex=h,d=u,a=Pe.less_xy(s,d)?(s.type=1,d.type=2,Ce.get(n,h)):(s.type=2,d.type=1,Ce.get(h,n)),s.segment=d.segment=a,Te.queue.insert(s),Te.queue.insert(d),n.links.insert(h),h.links.insert(n)),n=h,null==i&&(i=h),(r=r.next)==t)break}null==Pe.zpp_pool?y=new Pe:(y=Pe.zpp_pool,Pe.zpp_pool=y.next,y.next=null),y.vertex=n;var c=y;null==Pe.zpp_pool?_=new Pe:(_=Pe.zpp_pool,Pe.zpp_pool=_.next,_.next=null),_.vertex=i;var y=_,_=Pe.less_xy(c,y)?(c.type=1,y.type=2,Ce.get(n,i)):(c.type=2,y.type=1,Ce.get(i,n));for(c.segment=y.segment=_,Te.queue.insert(c),Te.queue.insert(y),n.links.insert(i),i.links.insert(n),null==Te.ints&&(null==Wn.zpp_pool?Te.ints=new Wn:(Te.ints=Wn.zpp_pool,Wn.zpp_pool=Te.ints.next,Te.ints.next=null),Te.ints.lt=Pe.less_xy);!Te.queue.empty();){var m=Te.queue.pop_front();if(Te.sweep.sweepx=m.vertex.x,1==m.type){var g=m.segment;if(Te.sweep.add(g),null!=g.next&&null!=g&&!(g.next.id<g.id?Te.inthash.has(g.next.id,g.id):Te.inthash.has(g.id,g.next.id))){var f=Te.sweep.intersection(g.next,g);if(null!=f)if(f.vertex.x>=Te.sweep.sweepx){for(var x=Te.queue.parent;null!=x;)if(Te.queue.lt(f,x.data))x=x.prev;else{if(!Te.queue.lt(x.data,f))break;x=x.next}if(null==x){for(var v=Te.ints.parent;null!=v;)if(Te.ints.lt(f,v.data))v=v.prev;else{if(!Te.ints.lt(v.data,f))break;v=v.next}var w,z,b,S,C,P=v;null!=P?((w=f.vertex).links.clear(),w.node=null,w.forced=!1,w.next=Se.zpp_pool,Se.zpp_pool=w,f.vertex=P.data.vertex,P.data=f,Te.queue.insert(f)):(Te.queue.insert(f),Te.ints.insert(f)),g.next.id<g.id?(C=g.next.id,b=g.id,null==hi.zpp_pool?z=new hi:(z=hi.zpp_pool,hi.zpp_pool=z.next,z.next=null),z.id=C,z.di=b,(C=z).value=!0,Te.inthash.add(C)):(b=g.id,C=g.next.id,null==hi.zpp_pool?S=new hi:(S=hi.zpp_pool,hi.zpp_pool=S.next,S.next=null),S.id=b,S.di=C,(C=S).value=!0,Te.inthash.add(C))}else{var M=f.vertex;M.links.clear(),M.node=null,M.forced=!1,M.next=Se.zpp_pool,Se.zpp_pool=M,f.vertex=null,f.segment=f.segment2=null,f.node=null,f.next=Pe.zpp_pool,Pe.zpp_pool=f}}else{var T=f.vertex;T.links.clear(),T.node=null,T.forced=!1,T.next=Se.zpp_pool,Se.zpp_pool=T,f.vertex=null,f.segment=f.segment2=null,f.node=null,f.next=Pe.zpp_pool,Pe.zpp_pool=f}}if(null!=g&&null!=g.prev&&!(g.id<g.prev.id?Te.inthash.has(g.id,g.prev.id):Te.inthash.has(g.prev.id,g.id))){var A=Te.sweep.intersection(g,g.prev);if(null!=A)if(A.vertex.x>=Te.sweep.sweepx){for(var k=Te.queue.parent;null!=k;)if(Te.queue.lt(A,k.data))k=k.prev;else{if(!Te.queue.lt(k.data,A))break;k=k.next}if(null==k){for(var O=Te.ints.parent;null!=O;)if(Te.ints.lt(A,O.data))O=O.prev;else{if(!Te.ints.lt(O.data,A))break;O=O.next}var E,I,G,M=O;null!=M?((T=A.vertex).links.clear(),T.node=null,T.forced=!1,T.next=Se.zpp_pool,Se.zpp_pool=T,A.vertex=M.data.vertex,M.data=A,Te.queue.insert(A)):(Te.queue.insert(A),Te.ints.insert(A)),g.id<g.prev.id?(M=g.id,I=g.prev.id,null==hi.zpp_pool?E=new hi:(E=hi.zpp_pool,hi.zpp_pool=E.next,E.next=null),E.id=M,E.di=I,(I=E).value=!0,Te.inthash.add(I)):(I=g.prev.id,B=g.id,null==hi.zpp_pool?G=new hi:(G=hi.zpp_pool,hi.zpp_pool=G.next,G.next=null),G.id=I,G.di=B,(B=G).value=!0,Te.inthash.add(B))}else{var D=A.vertex;D.links.clear(),D.node=null,D.forced=!1,D.next=Se.zpp_pool,Se.zpp_pool=D,A.vertex=null,A.segment=A.segment2=null,A.node=null,A.next=Pe.zpp_pool,Pe.zpp_pool=A}}else{var L=A.vertex;L.links.clear(),L.node=null,L.forced=!1,L.next=Se.zpp_pool,Se.zpp_pool=L,A.vertex=null,A.segment=A.segment2=null,A.node=null,A.next=Pe.zpp_pool,Pe.zpp_pool=A}}}else if(2==m.type){var B=m.segment;if(null!=B.node){D=B.next,L=B.prev;if(Te.sweep.remove(B),B.left=B.right=null,B.prev=null,B.node=null,B.vertices.clear(),B.next=Ce.zpp_pool,Ce.zpp_pool=B,null!=D&&null!=L&&!(D.id<L.id?Te.inthash.has(D.id,L.id):Te.inthash.has(L.id,D.id))){var R=Te.sweep.intersection(D,L);if(null!=R)if(R.vertex.x>=Te.sweep.sweepx){for(var F=Te.queue.parent;null!=F;)if(Te.queue.lt(R,F.data))F=F.prev;else{if(!Te.queue.lt(F.data,R))break;F=F.next}if(null==F){for(var N=Te.ints.parent;null!=N;)if(Te.ints.lt(R,N.data))N=N.prev;else{if(!Te.ints.lt(N.data,R))break;N=N.next}var j,U,V,B=N;null!=B?((j=R.vertex).links.clear(),j.node=null,j.forced=!1,j.next=Se.zpp_pool,Se.zpp_pool=j,R.vertex=B.data.vertex,B.data=R,Te.queue.insert(R)):(Te.queue.insert(R),Te.ints.insert(R)),D.id<L.id?(j=D.id,B=L.id,null==hi.zpp_pool?U=new hi:(U=hi.zpp_pool,hi.zpp_pool=U.next,U.next=null),U.id=j,U.di=B,(B=U).value=!0,Te.inthash.add(B)):(L=L.id,D=D.id,null==hi.zpp_pool?V=new hi:(V=hi.zpp_pool,hi.zpp_pool=V.next,V.next=null),V.id=L,V.di=D,(D=V).value=!0,Te.inthash.add(D))}else{var W=R.vertex;W.links.clear(),W.node=null,W.forced=!1,W.next=Se.zpp_pool,Se.zpp_pool=W,R.vertex=null,R.segment=R.segment2=null,R.node=null,R.next=Pe.zpp_pool,Pe.zpp_pool=R}}else{var X=R.vertex;X.links.clear(),X.node=null,X.forced=!1,X.next=Se.zpp_pool,Se.zpp_pool=X,R.vertex=null,R.segment=R.segment2=null,R.node=null,R.next=Pe.zpp_pool,Pe.zpp_pool=R}}}}else{var H=m.vertex,W=null==H.node,q=m.segment,Y=m.segment2;Y.next!=q&&(Q=q,q=Y,Y=Q);for(var K=q.vertices.parent;null!=K;)if(q.vertices.lt(H,K.data))K=K.prev;else{if(!q.vertices.lt(K.data,H))break;K=K.next}for(var X=null==K,Z=Y.vertices.parent;null!=Z;)if(Y.vertices.lt(H,Z.data))Z=Z.prev;else{if(!Y.vertices.lt(Z.data,H))break;Z=Z.next}var J,Q=null==Z;if(X&&(J=q.vertices.insert(H),X=H==q.left?H:q.vertices.predecessor_node(J).data,J=H==q.right?H:q.vertices.successor_node(J).data,X.links.remove(J),H!=X&&X.links.insert(H),J.links.remove(X),H!=J&&J.links.insert(H),H!=X&&H.links.insert(X),H!=J&&H.links.insert(J)),Q&&(J=Y.vertices.insert(H),Q=H==Y.left?H:Y.vertices.predecessor_node(J).data,J=H==Y.right?H:Y.vertices.successor_node(J).data,Q.links.remove(J),H!=Q&&Q.links.insert(H),J.links.remove(Q),H!=J&&J.links.insert(H),H!=Q&&H.links.insert(Q),H!=J&&H.links.insert(J)),W&&(H.node=Te.vertices.insert(H)),H.forced=!0,W&&(it=q.node,at=Y.node,it.data=Y,(at.data=q).node=at,Y.node=it,Y.next=q.next,q.next=Y,q.prev=Y.prev,null!=(Y.prev=q).prev&&(q.prev.next=q),null!=Y.next&&(Y.next.prev=Y)),null!=Y.next&&null!=Y&&!(Y.next.id<Y.id?Te.inthash.has(Y.next.id,Y.id):Te.inthash.has(Y.id,Y.next.id))){var $=Te.sweep.intersection(Y.next,Y);if(null!=$)if($.vertex.x>=Te.sweep.sweepx){for(var tt=Te.queue.parent;null!=tt;)if(Te.queue.lt($,tt.data))tt=tt.prev;else{if(!Te.queue.lt(tt.data,$))break;tt=tt.next}if(null==tt){for(var et=Te.ints.parent;null!=et;)if(Te.ints.lt($,et.data))et=et.prev;else{if(!Te.ints.lt(et.data,$))break;et=et.next}var it,nt,rt,ot,st,at=et;null!=at?((it=$.vertex).links.clear(),it.node=null,it.forced=!1,it.next=Se.zpp_pool,Se.zpp_pool=it,$.vertex=at.data.vertex,at.data=$,Te.queue.insert($)):(Te.queue.insert($),Te.ints.insert($)),Y.next.id<Y.id?(st=Y.next.id,rt=Y.id,null==hi.zpp_pool?nt=new hi:(nt=hi.zpp_pool,hi.zpp_pool=nt.next,nt.next=null),nt.id=st,nt.di=rt,(st=nt).value=!0,Te.inthash.add(st)):(rt=Y.id,st=Y.next.id,null==hi.zpp_pool?ot=new hi:(ot=hi.zpp_pool,hi.zpp_pool=ot.next,ot.next=null),ot.id=rt,ot.di=st,(st=ot).value=!0,Te.inthash.add(st))}else{var ht=$.vertex;ht.links.clear(),ht.node=null,ht.forced=!1,ht.next=Se.zpp_pool,Se.zpp_pool=ht,$.vertex=null,$.segment=$.segment2=null,$.node=null,$.next=Pe.zpp_pool,Pe.zpp_pool=$}}else{var lt=$.vertex;lt.links.clear(),lt.node=null,lt.forced=!1,lt.next=Se.zpp_pool,Se.zpp_pool=lt,$.vertex=null,$.segment=$.segment2=null,$.node=null,$.next=Pe.zpp_pool,Pe.zpp_pool=$}}if(null!=q&&null!=q.prev&&!(q.id<q.prev.id?Te.inthash.has(q.id,q.prev.id):Te.inthash.has(q.prev.id,q.id))){var pt=Te.sweep.intersection(q,q.prev);if(null!=pt)if(pt.vertex.x>=Te.sweep.sweepx){for(var ut=Te.queue.parent;null!=ut;)if(Te.queue.lt(pt,ut.data))ut=ut.prev;else{if(!Te.queue.lt(ut.data,pt))break;ut=ut.next}if(null==ut){for(var dt=Te.ints.parent;null!=dt;)if(Te.ints.lt(pt,dt.data))dt=dt.prev;else{if(!Te.ints.lt(dt.data,pt))break;dt=dt.next}var ct,yt,_t,mt,ht=dt;null!=ht?((lt=pt.vertex).links.clear(),lt.node=null,lt.forced=!1,lt.next=Se.zpp_pool,Se.zpp_pool=lt,pt.vertex=ht.data.vertex,ht.data=pt,Te.queue.insert(pt)):(Te.queue.insert(pt),Te.ints.insert(pt)),q.id<q.prev.id?(mt=q.id,yt=q.prev.id,null==hi.zpp_pool?ct=new hi:(ct=hi.zpp_pool,hi.zpp_pool=ct.next,ct.next=null),ct.id=mt,ct.di=yt,(mt=ct).value=!0,Te.inthash.add(mt)):(yt=q.prev.id,mt=q.id,null==hi.zpp_pool?_t=new hi:(_t=hi.zpp_pool,hi.zpp_pool=_t.next,_t.next=null),_t.id=yt,_t.di=mt,(mt=_t).value=!0,Te.inthash.add(mt))}else{var gt=pt.vertex;gt.links.clear(),gt.node=null,gt.forced=!1,gt.next=Se.zpp_pool,Se.zpp_pool=gt,pt.vertex=null,pt.segment=pt.segment2=null,pt.node=null,pt.next=Pe.zpp_pool,Pe.zpp_pool=pt}}else{gt=pt.vertex;gt.links.clear(),gt.node=null,gt.forced=!1,gt.next=Se.zpp_pool,Se.zpp_pool=gt,pt.vertex=null,pt.segment=pt.segment2=null,pt.node=null,pt.next=Pe.zpp_pool,Pe.zpp_pool=pt}}Te.ints.remove(m)}m.vertex=null,m.segment=m.segment2=null,m.node=null,m.next=Pe.zpp_pool,Pe.zpp_pool=m}for(var ft=0,xt=Te.inthash.table.length;ft<xt;){var vt=ft++,wt=Te.inthash.table[vt];if(null!=wt){for(;null!=wt;){var zt=wt.hnext;wt.hnext=null;var bt=wt;bt.next=hi.zpp_pool,hi.zpp_pool=bt,wt=zt}Te.inthash.table[vt]=null}}for(null==e&&(e=new Pi);!Te.vertices.empty();)Te.clip_polygon(Te.vertices,e);return e},Te.clip_polygon=function(t,e){var i=null,n=t.first(),r=n,o=n.links.parent,s=null==o.prev?o.next:o.prev,a=o.data,h=s.data,l=n.x-a.x,o=n.y-a.y,s=h.x-n.x;(h.y-n.y)*l-s*o<0&&(h=a);o=n.x,a=n.y;null==nn.zpp_pool?p=new nn:(p=nn.zpp_pool,nn.zpp_pool=p.next,p.next=null),p.forced=!1,p.x=o,p.y=a;var p=p;for(null==i?i=p.prev=p.next=p:(p.prev=i,p.next=i.next,i.next.prev=p,i.next=p),(i=p).forced=n.forced;;){if(n.links.remove(h),h.links.remove(n),h==r){n.links.empty()&&(t.remove(n),(c=n).links.clear(),c.node=null,c.forced=!1,c.next=Se.zpp_pool,Se.zpp_pool=c);break}var u,d=h.x,c=h.y;null==nn.zpp_pool?u=new nn:(u=nn.zpp_pool,nn.zpp_pool=u.next,u.next=null),u.forced=!1,u.x=d,u.y=c;c=u;if(null==i?i=c.prev=c.next=c:(c.prev=i,c.next=i.next,i.next.prev=c,i.next=c),(i=c).forced=h.forced,h.links.singular())n.links.empty()&&(t.remove(n),(y=n).links.clear(),y.node=null,y.forced=!1,y.next=Se.zpp_pool,Se.zpp_pool=y),h=(n=h).links.parent.data;else{var y,_=null,m=0;if(!h.links.empty()){for(var g=h.links.parent;null!=g.prev;)g=g.prev;for(;null!=g;){var f,x,v,w,z=g.data;if(null==_?(f=w=0,w=h.x-n.x,f=h.y-n.y,v=0,v=(_=z).x-h.x,m=(z.y-h.y)*w-v*f):(w=x=0,x=h.x-n.x,w=h.y-n.y,v=0,v=z.x-h.x,0<(f=(z.y-h.y)*x-v*w)&&m<=0?(_=z,m=f):0<=m*f&&(v=x=0,x=h.x-z.x,v=h.y-z.y,w=0,w=_.x-h.x,0<(_.y-h.y)*x-w*v&&(_=z,m=f))),null!=g.next)for(g=g.next;null!=g.prev;)g=g.prev;else{for(;null!=g.parent&&g==g.parent.next;)g=g.parent;g=g.parent}}}n.links.empty()&&(t.remove(n),(y=n).links.clear(),y.node=null,y.forced=!1,y.next=Se.zpp_pool,Se.zpp_pool=y),n=h,h=_}}t.remove(r),r.links.clear(),r.node=null,r.forced=!1,r.next=Se.zpp_pool,Se.zpp_pool=r,e.add(i)},Te.isSimple=function(t){null==Te.sweep&&(Te.sweep=new Me,Te.inthash=new li);var e=Te.list_vertices;if(null==e&&(e=Te.list_vertices=new Mi),null!=t)for(var i=t;;){var n,r=i,o=r.x,r=r.y;if(null==Se.zpp_pool?n=new Se:(n=Se.zpp_pool,Se.zpp_pool=n.next,n.next=null),n.x=o,n.y=r,e.add(n),(i=i.next)==t)break}var s=Te.list_queue;null==s&&(s=Te.list_queue=new Ti);for(var a=(h=e.head).elt,h=h.next;null!=h;){var l,p=h.elt;null==Pe.zpp_pool?l=new Pe:(l=Pe.zpp_pool,Pe.zpp_pool=l.next,l.next=null),l.vertex=a;var u,d=s.add(l);null==Pe.zpp_pool?u=new Pe:(u=Pe.zpp_pool,Pe.zpp_pool=u.next,u.next=null),u.vertex=p;var c=s.add(u),y=Pe.less_xy(d,c)?(d.type=1,c.type=2,Ce.get(a,p)):(d.type=2,c.type=1,Ce.get(p,a));d.segment=c.segment=y,a=p,h=h.next}var _=e.head.elt;null==Pe.zpp_pool?m=new Pe:(m=Pe.zpp_pool,Pe.zpp_pool=m.next,m.next=null),m.vertex=a;var m=s.add(m);null==Pe.zpp_pool?g=new Pe:(g=Pe.zpp_pool,Pe.zpp_pool=g.next,g.next=null),g.vertex=_;var g=s.add(g),_=Pe.less_xy(m,g)?(m.type=1,g.type=2,Ce.get(a,_)):(m.type=2,g.type=1,Ce.get(_,a));m.segment=g.segment=_;_=s;if(null!=_.head&&null!=_.head.next){for(var f,x,v,w=_.head,z=null,b=null,S=null,C=null,P=1;;){for(f=0,b=w,z=w=null;null!=b;){for(++f,S=b,x=0,v=P;null!=S&&x<P;)++x,S=S.next;for(;0<x||0<v&&null!=S;)0!=x&&(0==v||null==S||Pe.less_xy(b.elt,S.elt))?(b=(C=b).next,--x):(S=(C=S).next,--v),null!=z?z.next=C:w=C,z=C;b=S}if(z.next=null,P<<=1,!(1<f))break}_.head=w,_.modified=!0,_.pushmod=!0}for(var M=!0;null!=s.head;){var T=s.pop_unsafe(),A=T.segment;if(1==T.type){if(Te.sweep.add(A),Te.sweep.intersect(A,A.next)||Te.sweep.intersect(A,A.prev)){M=!1;break}}else if(2==T.type){if(Te.sweep.intersect(A.prev,A.next)){M=!1;break}Te.sweep.remove(A),A.left=A.right=null,A.prev=null,A.node=null,A.vertices.clear(),A.next=Ce.zpp_pool,Ce.zpp_pool=A}T.vertex=null,T.segment=T.segment2=null,T.node=null,T.next=Pe.zpp_pool,Pe.zpp_pool=T}for(;null!=s.head;){var k,O=s.pop_unsafe();2==O.type&&((k=O.segment).left=k.right=null,k.prev=null,k.node=null,k.vertices.clear(),k.next=Ce.zpp_pool,Ce.zpp_pool=k),O.vertex=null,O.segment=O.segment2=null,O.node=null,O.next=Pe.zpp_pool,Pe.zpp_pool=O}for(Te.sweep.clear();null!=e.head;){var E=e.pop_unsafe();E.links.clear(),E.node=null,E.forced=!1,E.next=Se.zpp_pool,Se.zpp_pool=E}return M},Te.prototype.__class__=Te;var Ae=zpp_nape.geom.ZPP_SimplifyV=function(){this.forced=!1,this.flag=!1,this.prev=null,this.next=null,this.y=0,this.x=0};Ae.__name__=["zpp_nape","geom","ZPP_SimplifyV"],Ae.get=function(t){var e;return null==Ae.zpp_pool?e=new Ae:(e=Ae.zpp_pool,Ae.zpp_pool=e.next,e.next=null),e.x=t.x,e.y=t.y,e.flag=!1,e},Ae.prototype.x=null,Ae.prototype.y=null,Ae.prototype.next=null,Ae.prototype.prev=null,Ae.prototype.flag=null,Ae.prototype.forced=null,Ae.prototype.free=function(){},Ae.prototype.alloc=function(){},Ae.prototype.__class__=Ae;var ke=zpp_nape.geom.ZPP_SimplifyP=function(){this.max=null,this.min=null,this.next=null};ke.__name__=["zpp_nape","geom","ZPP_SimplifyP"],ke.get=function(t,e){var i;return null==ke.zpp_pool?i=new ke:(i=ke.zpp_pool,ke.zpp_pool=i.next,i.next=null),i.min=t,i.max=e,i},ke.prototype.next=null,ke.prototype.min=null,ke.prototype.max=null,ke.prototype.free=function(){this.min=this.max=null},ke.prototype.alloc=function(){},ke.prototype.__class__=ke;var Oe=zpp_nape.geom.ZPP_Simplify=function(){};Oe.__name__=["zpp_nape","geom","ZPP_Simplify"],Oe.lessval=function(t,e){return t.x-e.x+(t.y-e.y)},Oe.less=function(t,e){return t.x-e.x+(t.y-e.y)<0},Oe.distance=function(t,e,i){var n=i.x-e.x,r=i.y-e.y,o=0,s=0,o=t.x-e.x,s=t.y-e.y;if(n*n+r*r==0)return o*o+s*s;var a=(o*n+s*r)/(n*n+r*r);if(a<=0)return o*o+s*s;if(1<=a){var h=t.x,l=t.y,e=0,t=0;return(e=h-i.x)*e+(t=l-i.y)*t}return(o-=n*a)*o+(s-=r*a)*s},Oe.simplify=function(t,e){var i=null,n=null,r=null;e*=e,null==Oe.stack&&(Oe.stack=new Si);for(var o,s,a,h,l,p,u,d,c=null,y=null,_=t;;){null==Ae.zpp_pool?o=new Ae:(o=Ae.zpp_pool,Ae.zpp_pool=o.next,o.next=null),o.x=_.x,o.y=_.y,o.flag=!1;var m,g=o;if(g.forced=_.forced,g.forced&&(g.flag=!0,null!=c?(null==ke.zpp_pool?m=new ke:(m=ke.zpp_pool,ke.zpp_pool=m.next,m.next=null),m.min=c,m.max=g,Oe.stack.add(m)):y=g,c=g),null==i?i=g.prev=g.next=g:(g.prev=i,g.next=i.next,i.next.prev=g,i.next=g),i=g,null==n?r=n=g:(g.x-n.x+(g.y-n.y)<0&&(n=g),r.x-g.x+(r.y-g.y)<0&&(r=g)),(_=_.next)==t)break}for(null==Oe.stack.head?null==y?(n.flag=r.flag=!0,null==ke.zpp_pool?s=new ke:(s=ke.zpp_pool,ke.zpp_pool=s.next,s.next=null),s.min=n,s.max=r,Oe.stack.add(s),null==ke.zpp_pool?a=new ke:(a=ke.zpp_pool,ke.zpp_pool=a.next,a.next=null),a.min=r,a.max=n,Oe.stack.add(a)):(s=n.x-y.x+(n.y-y.y),(a=(a=r.x-y.x+(r.y-y.y))<0?-a:a)<(s=s<0?-s:s)?(n.flag=y.flag=!0,null==ke.zpp_pool?h=new ke:(h=ke.zpp_pool,ke.zpp_pool=h.next,h.next=null),h.min=n,h.max=y,Oe.stack.add(h),null==ke.zpp_pool?l=new ke:(l=ke.zpp_pool,ke.zpp_pool=l.next,l.next=null),l.min=y,l.max=n,Oe.stack.add(l)):(r.flag=y.flag=!0,null==ke.zpp_pool?p=new ke:(p=ke.zpp_pool,ke.zpp_pool=p.next,p.next=null),p.min=r,p.max=y,Oe.stack.add(p),null==ke.zpp_pool?u=new ke:(u=ke.zpp_pool,ke.zpp_pool=u.next,u.next=null),u.min=y,u.max=r,Oe.stack.add(u))):(null==ke.zpp_pool?d=new ke:(d=ke.zpp_pool,ke.zpp_pool=d.next,d.next=null),d.min=c,d.max=y,Oe.stack.add(d));null!=Oe.stack.head;){var f=Oe.stack.pop_unsafe(),x=f.min,v=f.max;f.min=f.max=null,f.next=ke.zpp_pool,ke.zpp_pool=f;for(var w,z,b=e,S=null,C=x.next;C!=v;){var P=Oe.distance(C,x,v);b<P&&(b=P,S=C),C=C.next}null!=S&&(S.flag=!0,null==ke.zpp_pool?w=new ke:(w=ke.zpp_pool,ke.zpp_pool=w.next,w.next=null),w.min=x,w.max=S,Oe.stack.add(w),null==ke.zpp_pool?z=new ke:(z=ke.zpp_pool,ke.zpp_pool=z.next,z.next=null),z.min=S,z.max=v,Oe.stack.add(z))}for(var M,T,A,k,O=null;null!=i;)i.flag&&(M=i.x,A=i.y,null==nn.zpp_pool?T=new nn:(T=nn.zpp_pool,nn.zpp_pool=T.next,T.next=null),T.forced=!1,T.x=M,T.y=A,A=T,null==O?O=A.prev=A.next=A:(A.prev=O,A.next=O.next,O.next.prev=A,O.next=A),(O=A).forced=i.forced),i=null!=i&&i.prev==i?(i.next=i.prev=null,(k=i).next=Ae.zpp_pool,Ae.zpp_pool=k,null):(A=i.next,i.prev.next=i.next,i.next.prev=i.prev,i.next=i.prev=null,(k=i).next=Ae.zpp_pool,Ae.zpp_pool=k,i=null,A);return O},Oe.prototype.__class__=Oe;var Ee=zpp_nape.geom.ZPP_ToiEvent=function(){this.kinematic=!1,this.failed=!1,this.slipped=!1,this.axis=null,this.c2=null,this.c1=null,this.frozen2=!1,this.frozen1=!1,this.arbiter=null,this.s2=null,this.s1=null,this.toi=0,this.next=null,this.c1=new Gr,this.c2=new Gr,this.axis=new Gr};Ee.__name__=["zpp_nape","geom","ZPP_ToiEvent"],Ee.prototype.next=null,Ee.prototype.alloc=function(){this.failed=!1,this.s1=this.s2=null,this.arbiter=null},Ee.prototype.free=function(){},Ee.prototype.toi=null,Ee.prototype.s1=null,Ee.prototype.s2=null,Ee.prototype.arbiter=null,Ee.prototype.frozen1=null,Ee.prototype.frozen2=null,Ee.prototype.c1=null,Ee.prototype.c2=null,Ee.prototype.axis=null,Ee.prototype.slipped=null,Ee.prototype.failed=null,Ee.prototype.kinematic=null,Ee.prototype.__class__=Ee;var Ie=zpp_nape.geom.ZPP_SweepDistance=function(){};Ie.__name__=["zpp_nape","geom","ZPP_SweepDistance"],Ie.dynamicSweep=function(t,e,i,n,r){var o=t.s1,s=t.s2,a=o.body,h=s.body,l=h.velx-a.velx,p=h.vely-a.vely,u=a.angvel,d=h.angvel,c=o.sweepCoef*(u=u<0?-u:u)+s.sweepCoef*(d=d<0?-d:d);if(!(r=null==r?!1:r)&&!t.kinematic&&l*l+p*p<Er.dynamicSweepLinearThreshold*Er.dynamicSweepLinearThreshold&&c<Er.dynamicSweepAngularThreshold)return t.toi=-1,void(t.failed=!0);for(var y=t.c1,_=t.c2,m=t.axis,g=i,f=0;;){var x,v,w=g*e,z=w-a.sweepTime;if(0!=z&&(a.sweepTime=w,a.posx+=a.velx*z,a.posy+=a.vely*z,0!=a.angvel&&(x=a.sweep_angvel*z,a.rot+=x,1e-4<x*x?(a.axisx=Math.sin(a.rot),a.axisy=Math.cos(a.rot)):(v=((w=1-.5*(v=x*x))*a.axisx+x*a.axisy)*(z=1-v*v/8),a.axisy=(w*a.axisy-x*a.axisx)*z,a.axisx=v))),0==o.type)o.worldCOMx=a.posx+(a.axisy*o.localCOMx-a.axisx*o.localCOMy),o.worldCOMy=a.posy+(o.localCOMx*a.axisx+o.localCOMy*a.axisy);else{for(var b=o.polygon,S=b.lverts.next,C=b.gverts.next;null!=C;){var P=C,M=S,S=S.next;P.x=a.posx+(a.axisy*M.x-a.axisx*M.y),P.y=a.posy+(M.x*a.axisx+M.y*a.axisy),C=C.next}for(var T=b.edges.head,A=k=b.gverts.next,k=k.next;null!=k;){var O=k,E=T.elt,T=T.next;E.gnormx=a.axisy*E.lnormx-a.axisx*E.lnormy,E.gnormy=E.lnormx*a.axisx+E.lnormy*a.axisy,E.gprojection=a.posx*E.gnormx+a.posy*E.gnormy+E.lprojection,E.tp0=A.y*E.gnormx-A.x*E.gnormy,E.tp1=O.y*E.gnormx-O.x*E.gnormy,A=O,k=k.next}var I=b.gverts.next,b=T.elt;b.gnormx=a.axisy*b.lnormx-a.axisx*b.lnormy,b.gnormy=b.lnormx*a.axisx+b.lnormy*a.axisy,b.gprojection=a.posx*b.gnormx+a.posy*b.gnormy+b.lprojection,b.tp0=A.y*b.gnormx-A.x*b.gnormy,b.tp1=I.y*b.gnormx-I.x*b.gnormy}I=g*e,b=I-h.sweepTime;if(0!=b&&(h.sweepTime=I,h.posx+=h.velx*b,h.posy+=h.vely*b,0!=h.angvel&&(q=h.sweep_angvel*b,h.rot+=q,1e-4<q*q?(h.axisx=Math.sin(h.rot),h.axisy=Math.cos(h.rot)):(K=((H=1-.5*(K=q*q))*h.axisx+q*h.axisy)*(Y=1-K*K/8),h.axisy=(H*h.axisy-q*h.axisx)*Y,h.axisx=K))),0==s.type)s.worldCOMx=h.posx+(h.axisy*s.localCOMx-h.axisx*s.localCOMy),s.worldCOMy=h.posy+(s.localCOMx*h.axisx+s.localCOMy*h.axisy);else{for(var G=s.polygon,D=G.lverts.next,L=G.gverts.next;null!=L;){var B=L,R=D,D=D.next;B.x=h.posx+(h.axisy*R.x-h.axisx*R.y),B.y=h.posy+(R.x*h.axisx+R.y*h.axisy),L=L.next}for(var F=G.edges.head,N=j=G.gverts.next,j=j.next;null!=j;){var U=j,V=F.elt,F=F.next;V.gnormx=h.axisy*V.lnormx-h.axisx*V.lnormy,V.gnormy=V.lnormx*h.axisx+V.lnormy*h.axisy,V.gprojection=h.posx*V.gnormx+h.posy*V.gnormy+V.lprojection,V.tp0=N.y*V.gnormx-N.x*V.gnormy,V.tp1=U.y*V.gnormx-U.x*V.gnormy,N=U,j=j.next}var W=G.gverts.next,X=F.elt;X.gnormx=h.axisy*X.lnormx-h.axisx*X.lnormy,X.gnormy=X.lnormx*h.axisx+X.lnormy*h.axisy,X.gprojection=h.posx*X.gnormx+h.posy*X.gnormy+X.lprojection,X.tp0=N.y*X.gnormx-N.x*X.gnormy,X.tp1=W.y*X.gnormx-W.x*X.gnormy}var H=o,q=s,Y=y,K=_;if(0==o.type&&0==s.type){var Z,G=o.circle,W=s.circle,J=0,Q=0,J=W.worldCOMx-G.worldCOMx,Q=W.worldCOMy-G.worldCOMy,X=Math.sqrt(J*J+Q*Q),$=X-(G.radius+W.radius);$<1e100&&(0==X?(J=1,Q=0):(J*=Z=1/X,Q*=Z),Z=G.radius,y.x=G.worldCOMx+J*Z,y.y=G.worldCOMy+Q*Z,Z=-W.radius,_.x=W.worldCOMx+J*Z,_.y=W.worldCOMy+Q*Z,m.x=J,m.y=Q),J=$}else{Q=!1;if(0==o.type&&1==s.type&&(H=s,q=o,Y=_,K=y,Q=!0),1==H.type&&0==q.type){for(var $=H.polygon,tt=q.circle,et=-1e100,it=null,nt=$.edges.head;null!=nt;){var rt=nt.elt,ot=rt.gnormx*tt.worldCOMx+rt.gnormy*tt.worldCOMy-rt.gprojection-tt.radius;if(1e100<ot){et=ot;break}0<ot?et<ot&&(et=ot,it=rt):et<0&&et<ot&&(et=ot,it=rt),nt=nt.next}et<1e100&&(Ct=it.gp0,Lt=it.gp1,(Rt=tt.worldCOMy*it.gnormx-tt.worldCOMx*it.gnormy)<=Ct.y*it.gnormx-Ct.x*it.gnormy?(Bt=It=0,It=tt.worldCOMx-Ct.x,Bt=tt.worldCOMy-Ct.y,(et=($=Math.sqrt(It*It+Bt*Bt))-tt.radius)<1e100&&(0==$?(It=1,Bt=0):(It*=St=1/$,Bt*=St),Y.x=Ct.x+0*It,Y.y=Ct.y+0*Bt,Pt=-tt.radius,K.x=tt.worldCOMx+It*Pt,K.y=tt.worldCOMy+Bt*Pt,m.x=It,m.y=Bt)):Rt>=Lt.y*it.gnormx-Lt.x*it.gnormy?(Et=Tt=0,Tt=tt.worldCOMx-Lt.x,Et=tt.worldCOMy-Lt.y,(et=(kt=Math.sqrt(Tt*Tt+Et*Et))-tt.radius)<1e100&&(0==kt?(Tt=1,Et=0):(Tt*=Ot=1/kt,Et*=Ot),Y.x=Lt.x+0*Tt,Y.y=Lt.y+0*Et,Mt=-tt.radius,K.x=tt.worldCOMx+Tt*Mt,K.y=tt.worldCOMy+Et*Mt,m.x=Tt,m.y=Et)):(At=-tt.radius,K.x=tt.worldCOMx+it.gnormx*At,K.y=tt.worldCOMy+it.gnormy*At,Y.x=K.x+it.gnormx*(Gt=-et),Y.y=K.y+it.gnormy*Gt,m.x=it.gnormx,m.y=it.gnormy)),Q&&(m.x=-m.x,m.y=-m.y),J=et}else{for(var st=H.polygon,at=q.polygon,ht=-1e100,lt=null,pt=null,ut=0,dt=st.edges.head;null!=dt;){for(var ct=dt.elt,yt=1e100,_t=at.gverts.next;null!=_t;){var mt=_t,mt=ct.gnormx*mt.x+ct.gnormy*mt.y;mt<yt&&(yt=mt),_t=_t.next}if(1e100<(yt-=ct.gprojection)){ht=yt;break}0<yt?ht<yt&&(ht=yt,lt=ct,ut=1):ht<0&&ht<yt&&(ht=yt,lt=ct,ut=1),dt=dt.next}if(ht<1e100){for(var gt,ft,xt=at.edges.head;null!=xt;){for(var vt=xt.elt,wt=1e100,zt=st.gverts.next;null!=zt;){var bt=zt,bt=vt.gnormx*bt.x+vt.gnormy*bt.y;bt<wt&&(wt=bt),zt=zt.next}if(1e100<(wt-=vt.gprojection)){ht=wt;break}0<wt?ht<wt&&(ht=wt,pt=vt,ut=2):ht<0&&ht<wt&&(ht=wt,pt=vt,ut=2),xt=xt.next}if(ht<1e100){1==ut?(gt=at,ft=lt):(gt=st,ft=pt,Dt=Y,Y=K,K=Dt,Q=!Q);for(var St,Ct,Pt,Mt,Tt,At,kt,Ot,Et,It,Gt,Dt,Lt,Bt,Rt,Ft,Nt,jt,Ut,Vt,Wt,Xt,Ht=null,qt=1e100,Yt=gt.edges.head;null!=Yt;){var Kt=Yt.elt,Zt=ft.gnormx*Kt.gnormx+ft.gnormy*Kt.gnormy;Zt<qt&&(qt=Zt,Ht=Kt),Yt=Yt.next}Q?(m.x=-ft.gnormx,m.y=-ft.gnormy):(m.x=ft.gnormx,m.y=ft.gnormy),J=0<=ht?(St=ft.gp0,Ct=ft.gp1,Pt=Ht.gp0,jt=Ht.gp1,Rt=Bt=Ut=It=0,kt=1/((It=Ct.x-St.x)*It+(Ut=Ct.y-St.y)*Ut),Ot=1/((Bt=jt.x-Pt.x)*Bt+(Rt=jt.y-Pt.y)*Rt),(Ft=-(It*(St.x-Pt.x)+Ut*(St.y-Pt.y))*kt)<0?Ft=0:1<Ft&&(Ft=1),(Xt=-(It*(St.x-jt.x)+Ut*(St.y-jt.y))*kt)<0?Xt=0:1<Xt&&(Xt=1),(Wt=-(Bt*(Pt.x-St.x)+Rt*(Pt.y-St.y))*Ot)<0?Wt=0:1<Wt&&(Wt=1),(Lt=-(Bt*(Pt.x-Ct.x)+Rt*(Pt.y-Ct.y))*Ot)<0?Lt=0:1<Lt&&(Lt=1),Tt=Mt=0,Et=Ft,Mt=St.x+It*Et,Tt=St.y+Ut*Et,Nt=At=0,Gt=Xt,At=St.x+It*Gt,Nt=St.y+Ut*Gt,q=H=0,Dt=Wt,H=Pt.x+Bt*Dt,q=Pt.y+Rt*Dt,Ot=kt=0,Ft=Lt,kt=Pt.x+Bt*Ft,Ot=Pt.y+Rt*Ft,Rt=Bt=Lt=Dt=Wt=Gt=Ut=It=Xt=Et=0,Ft=null,(Xt=(Et=Mt-Pt.x)*Et+(Xt=Tt-Pt.y)*Xt)<(Ut=(It=At-jt.x)*It+(Ut=Nt-jt.y)*Ut)?(Bt=Mt,Rt=Tt,Ft=Pt):(Bt=At,Rt=Nt,Ft=jt,Xt=Ut),jt=Nt=0,Ut=null,(Wt=(Gt=H-St.x)*Gt+(Wt=q-St.y)*Wt)<(Lt=(Dt=kt-Ct.x)*Dt+(Lt=Ot-Ct.y)*Lt)?(Nt=H,jt=q,Ut=St):(Nt=kt,jt=Ot,Ut=Ct,Wt=Lt),0!=(ht=Xt<Wt?(Y.x=Bt,Y.y=Rt,K.x=Ft.x,K.y=Ft.y,Math.sqrt(Xt)):(K.x=Nt,K.y=jt,Y.x=Ut.x,Y.y=Ut.y,Math.sqrt(Wt)))&&(m.x=K.x-Y.x,m.y=K.y-Y.y,m.x*=Vt=1/ht,m.y*=Vt,Q&&(m.x=-m.x,m.y=-m.y)),ht):(Xt=Ft=0,Ft=Ht.gp0.x,Xt=Ht.gp0.y,Wt=Ut=jt=Nt=0,Ut=(Nt=Ht.gp1.x)-Ft,Wt=(jt=Ht.gp1.y)-Xt,Vt=ft.gnormy*Ft-ft.gnormx*Xt,Q=ft.gnormy*Nt-ft.gnormx*jt,Vt=(-ft.tp1-Vt)*(Qt=1/(Q-Vt)),Er.epsilon<Vt&&(Ft+=Ut*Vt,Xt+=Wt*Vt),(Qt=(-ft.tp0-Q)*Qt)<-Er.epsilon&&(Nt+=Ut*Qt,jt+=Wt*Qt),(Wt=Ft*ft.gnormx+Xt*ft.gnormy-ft.gprojection)<(Qt=Nt*ft.gnormx+jt*ft.gnormy-ft.gprojection)?(K.x=Ft,K.y=Xt,Y.x=K.x+ft.gnormx*(Xt=-Wt),Y.y=K.y+ft.gnormy*Xt,Wt):(K.x=Nt,K.y=jt,Y.x=K.x+ft.gnormx*(Jt=-Qt),Y.y=K.y+ft.gnormy*Jt,Qt))}else J=1e100}else J=1e100}}var K=J+n,Jt=l*m.x+p*m.y;if(K<Er.distanceThresholdCCD){if(r)break;var Qt=y.x-a.posx,$t=y.y-a.posy,te=_.x-h.posx,ee=_.y-h.posy,$t=Jt-a.sweep_angvel*(m.y*Qt-m.x*$t)+h.sweep_angvel*(m.y*te-m.x*ee);if(0<$t&&(t.slipped=!0),$t<=0||K<.5*Er.distanceThresholdCCD)break}te=(c-Jt)*e;if(te<=0){g=-1;break}ee=K/te;if(1<=(g+=ee=ee<1e-6?1e-6:ee)){var $t=(g=1)*e,Jt=$t-a.sweepTime;if(0!=Jt&&(a.sweepTime=$t,a.posx+=a.velx*Jt,a.posy+=a.vely*Jt,0!=a.angvel&&(te=a.sweep_angvel*Jt,a.rot+=te,1e-4<te*te?(a.axisx=Math.sin(a.rot),a.axisy=Math.cos(a.rot)):(ee=(($t=1-.5*(ee=te*te))*a.axisx+te*a.axisy)*(Jt=1-ee*ee/8),a.axisy=($t*a.axisy-te*a.axisx)*Jt,a.axisx=ee))),0==o.type)o.worldCOMx=a.posx+(a.axisy*o.localCOMx-a.axisx*o.localCOMy),o.worldCOMy=a.posy+(o.localCOMx*a.axisx+o.localCOMy*a.axisy);else{for(var ie=o.polygon,ne=ie.lverts.next,re=ie.gverts.next;null!=re;){var oe=re,se=ne,ne=ne.next;oe.x=a.posx+(a.axisy*se.x-a.axisx*se.y),oe.y=a.posy+(se.x*a.axisx+se.y*a.axisy),re=re.next}for(var ae=ie.edges.head,he=le=ie.gverts.next,le=le.next;null!=le;){var pe=le,ue=ae.elt,ae=ae.next;ue.gnormx=a.axisy*ue.lnormx-a.axisx*ue.lnormy,ue.gnormy=ue.lnormx*a.axisx+ue.lnormy*a.axisy,ue.gprojection=a.posx*ue.gnormx+a.posy*ue.gnormy+ue.lprojection,ue.tp0=he.y*ue.gnormx-he.x*ue.gnormy,ue.tp1=pe.y*ue.gnormx-pe.x*ue.gnormy,he=pe,le=le.next}var de=ie.gverts.next,ie=ae.elt;ie.gnormx=a.axisy*ie.lnormx-a.axisx*ie.lnormy,ie.gnormy=ie.lnormx*a.axisx+ie.lnormy*a.axisy,ie.gprojection=a.posx*ie.gnormx+a.posy*ie.gnormy+ie.lprojection,ie.tp0=he.y*ie.gnormx-he.x*ie.gnormy,ie.tp1=de.y*ie.gnormx-de.x*ie.gnormy}de=g*e,ie=de-h.sweepTime;if(0!=ie&&(h.sweepTime=de,h.posx+=h.velx*ie,h.posy+=h.vely*ie,0!=h.angvel&&(Me=h.sweep_angvel*ie,h.rot+=Me,1e-4<Me*Me?(h.axisx=Math.sin(h.rot),h.axisy=Math.cos(h.rot)):(ke=((Pe=1-.5*(Ce=Me*Me))*h.axisx+Me*h.axisy)*(Te=1-Ce*Ce/8),h.axisy=(Pe*h.axisy-Me*h.axisx)*Te,h.axisx=ke))),0==s.type)s.worldCOMx=h.posx+(h.axisy*s.localCOMx-h.axisx*s.localCOMy),s.worldCOMy=h.posy+(s.localCOMx*h.axisx+s.localCOMy*h.axisy);else{for(var ce=s.polygon,ye=ce.lverts.next,_e=ce.gverts.next;null!=_e;){var me=_e,ge=ye,ye=ye.next;me.x=h.posx+(h.axisy*ge.x-h.axisx*ge.y),me.y=h.posy+(ge.x*h.axisx+ge.y*h.axisy),_e=_e.next}for(var fe=ce.edges.head,xe=ve=ce.gverts.next,ve=ve.next;null!=ve;){var we=ve,ze=fe.elt,fe=fe.next;ze.gnormx=h.axisy*ze.lnormx-h.axisx*ze.lnormy,ze.gnormy=ze.lnormx*h.axisx+ze.lnormy*h.axisy,ze.gprojection=h.posx*ze.gnormx+h.posy*ze.gnormy+ze.lprojection,ze.tp0=xe.y*ze.gnormx-xe.x*ze.gnormy,ze.tp1=we.y*ze.gnormx-we.x*ze.gnormy,xe=we,ve=ve.next}var be=ce.gverts.next,Se=fe.elt;Se.gnormx=h.axisy*Se.lnormx-h.axisx*Se.lnormy,Se.gnormy=Se.lnormx*h.axisx+Se.lnormy*h.axisy,Se.gprojection=h.posx*Se.gnormx+h.posy*Se.gnormy+Se.lprojection,Se.tp0=xe.y*Se.gnormx-xe.x*Se.gnormy,Se.tp1=be.y*Se.gnormx-be.x*Se.gnormy}var Ce=o,Pe=s,Me=y,Te=_;if(0==o.type&&0==s.type){var Ae,ke=o.circle,ce=s.circle,be=0,Oe=0,be=ce.worldCOMx-ke.worldCOMx,Oe=ce.worldCOMy-ke.worldCOMy,Se=Math.sqrt(be*be+Oe*Oe),Ee=Se-(ke.radius+ce.radius);Ee<1e100&&(0==Se?(be=1,Oe=0):(be*=Ae=1/Se,Oe*=Ae),Ae=ke.radius,y.x=ke.worldCOMx+be*Ae,y.y=ke.worldCOMy+Oe*Ae,Ae=-ce.radius,_.x=ce.worldCOMx+be*Ae,_.y=ce.worldCOMy+Oe*Ae,m.x=be,m.y=Oe),Oe=Ee}else{Ee=!1;if(0==o.type&&1==s.type&&(Ce=s,Pe=o,Me=_,Te=y,Ee=!0),1==Ce.type&&0==Pe.type){for(var Ie=Ce.polygon,Ge=Pe.circle,De=-1e100,Le=null,Be=Ie.edges.head;null!=Be;){var Re=Be.elt,Fe=Re.gnormx*Ge.worldCOMx+Re.gnormy*Ge.worldCOMy-Re.gprojection-Ge.radius;if(1e100<Fe){De=Fe;break}0<Fe?De<Fe&&(De=Fe,Le=Re):De<0&&De<Fe&&(De=Fe,Le=Re),Be=Be.next}De<1e100&&(ci=Le.gp0,mi=Le.gp1,(pi=Ge.worldCOMy*Le.gnormx-Ge.worldCOMx*Le.gnormy)<=ci.y*Le.gnormx-ci.x*Le.gnormy?(li=fi=0,fi=Ge.worldCOMx-ci.x,li=Ge.worldCOMy-ci.y,(De=(ri=Math.sqrt(fi*fi+li*li))-Ge.radius)<1e100&&(0==ri?(fi=1,li=0):(fi*=oi=1/ri,li*=oi),Me.x=ci.x+0*fi,Me.y=ci.y+0*li,gi=-Ge.radius,Te.x=Ge.worldCOMx+fi*gi,Te.y=Ge.worldCOMy+li*gi,m.x=fi,m.y=li)):pi>=mi.y*Le.gnormx-mi.x*Le.gnormy?(ui=ai=0,ai=Ge.worldCOMx-mi.x,ui=Ge.worldCOMy-mi.y,(De=(xi=Math.sqrt(ai*ai+ui*ui))-Ge.radius)<1e100&&(0==xi?(ai=1,ui=0):(ai*=di=1/xi,ui*=di),Me.x=mi.x+0*ai,Me.y=mi.y+0*ui,si=-Ge.radius,Te.x=Ge.worldCOMx+ai*si,Te.y=Ge.worldCOMy+ui*si,m.x=ai,m.y=ui)):(hi=-Ge.radius,Te.x=Ge.worldCOMx+Le.gnormx*hi,Te.y=Ge.worldCOMy+Le.gnormy*hi,Me.x=Te.x+Le.gnormx*(yi=-De),Me.y=Te.y+Le.gnormy*yi,m.x=Le.gnormx,m.y=Le.gnormy)),Ee&&(m.x=-m.x,m.y=-m.y),Oe=De}else{for(var Ne=Ce.polygon,je=Pe.polygon,Ue=-1e100,Ve=null,We=null,Xe=0,He=Ne.edges.head;null!=He;){for(var qe=He.elt,Ye=1e100,Ke=je.gverts.next;null!=Ke;){var Ze=Ke,Ze=qe.gnormx*Ze.x+qe.gnormy*Ze.y;Ze<Ye&&(Ye=Ze),Ke=Ke.next}if(1e100<(Ye-=qe.gprojection)){Ue=Ye;break}0<Ye?Ue<Ye&&(Ue=Ye,Ve=qe,Xe=1):Ue<0&&Ue<Ye&&(Ue=Ye,Ve=qe,Xe=1),He=He.next}if(Ue<1e100){for(var Je,Qe,$e=je.edges.head;null!=$e;){for(var ti=$e.elt,ei=1e100,ii=Ne.gverts.next;null!=ii;){var ni=ii,ni=ti.gnormx*ni.x+ti.gnormy*ni.y;ni<ei&&(ei=ni),ii=ii.next}if(1e100<(ei-=ti.gprojection)){Ue=ei;break}0<ei?Ue<ei&&(Ue=ei,We=ti,Xe=2):Ue<0&&Ue<ei&&(Ue=ei,We=ti,Xe=2),$e=$e.next}if(Ue<1e100){1==Xe?(Je=je,Qe=Ve):(Je=Ne,Qe=We,_i=Me,Me=Te,Te=_i,Ee=!Ee);for(var ri,oi,si,ai,hi,li,pi,ui,di,ci,yi,_i,mi,gi,fi,xi,vi,wi,zi,bi,Si,Ci=null,Pi=1e100,Mi=Je.edges.head;null!=Mi;){var Ti=Mi.elt,Ai=Qe.gnormx*Ti.gnormx+Qe.gnormy*Ti.gnormy;Ai<Pi&&(Pi=Ai,Ci=Ti),Mi=Mi.next}Ee?(m.x=-Qe.gnormx,m.y=-Qe.gnormy):(m.x=Qe.gnormx,m.y=Qe.gnormy),Oe=0<=Ue?(Ie=Qe.gp0,ri=Qe.gp1,oi=Ci.gp0,Si=Ci.gp1,fi=gi=wi=ci=0,li=1/((ci=ri.x-Ie.x)*ci+(wi=ri.y-Ie.y)*wi),pi=1/((gi=Si.x-oi.x)*gi+(fi=Si.y-oi.y)*fi),(xi=-(ci*(Ie.x-oi.x)+wi*(Ie.y-oi.y))*li)<0?xi=0:1<xi&&(xi=1),(di=-(ci*(Ie.x-Si.x)+wi*(Ie.y-Si.y))*li)<0?di=0:1<di&&(di=1),(bi=-(gi*(oi.x-Ie.x)+fi*(oi.y-Ie.y))*pi)<0?bi=0:1<bi&&(bi=1),(mi=-(gi*(oi.x-ri.x)+fi*(oi.y-ri.y))*pi)<0?mi=0:1<mi&&(mi=1),ai=si=0,ui=xi,si=Ie.x+ci*ui,ai=Ie.y+wi*ui,vi=hi=0,yi=di,hi=Ie.x+ci*yi,vi=Ie.y+wi*yi,Pe=Ce=0,_i=bi,Ce=oi.x+gi*_i,Pe=oi.y+fi*_i,pi=li=0,xi=mi,li=oi.x+gi*xi,pi=oi.y+fi*xi,fi=gi=mi=_i=bi=yi=wi=ci=di=ui=0,xi=null,(di=(ui=si-oi.x)*ui+(di=ai-oi.y)*di)<(wi=(ci=hi-Si.x)*ci+(wi=vi-Si.y)*wi)?(gi=si,fi=ai,xi=oi):(gi=hi,fi=vi,xi=Si,di=wi),Si=vi=0,wi=null,(bi=(yi=Ce-Ie.x)*yi+(bi=Pe-Ie.y)*bi)<(mi=(_i=li-ri.x)*_i+(mi=pi-ri.y)*mi)?(vi=Ce,Si=Pe,wi=Ie):(vi=li,Si=pi,wi=ri,bi=mi),0!=(Ue=di<bi?(Me.x=gi,Me.y=fi,Te.x=xi.x,Te.y=xi.y,Math.sqrt(di)):(Te.x=vi,Te.y=Si,Me.x=wi.x,Me.y=wi.y,Math.sqrt(bi)))&&(m.x=Te.x-Me.x,m.y=Te.y-Me.y,m.x*=zi=1/Ue,m.y*=zi,Ee&&(m.x=-m.x,m.y=-m.y)),Ue):(Si=vi=0,vi=Ci.gp0.x,Si=Ci.gp0.y,bi=wi=Oi=ki=0,wi=(ki=Ci.gp1.x)-vi,bi=(Oi=Ci.gp1.y)-Si,zi=Qe.gnormy*vi-Qe.gnormx*Si,Ee=Qe.gnormy*ki-Qe.gnormx*Oi,zi=(-Qe.tp1-zi)*(Ii=1/(Ee-zi)),Er.epsilon<zi&&(vi+=wi*zi,Si+=bi*zi),(Ii=(-Qe.tp0-Ee)*Ii)<-Er.epsilon&&(ki+=wi*Ii,Oi+=bi*Ii),(bi=vi*Qe.gnormx+Si*Qe.gnormy-Qe.gprojection)<(Ii=ki*Qe.gnormx+Oi*Qe.gnormy-Qe.gprojection)?(Te.x=vi,Te.y=Si,Me.x=Te.x+Qe.gnormx*(Si=-bi),Me.y=Te.y+Qe.gnormy*Si,bi):(Te.x=ki,Te.y=Oi,Me.x=Te.x+Qe.gnormx*(Ei=-Ii),Me.y=Te.y+Qe.gnormy*Ei,Ii))}else Oe=1e100}else Oe=1e100}}var ki=Oe+n,Oi=l*m.x+p*m.y;if(ki<Er.distanceThresholdCCD){if(r)break;var Me=y.x-a.posx,Te=y.y-a.posy,Ei=_.x-h.posx,Ii=_.y-h.posy,Ii=Oi-a.sweep_angvel*(m.y*Me-m.x*Te)+h.sweep_angvel*(m.y*Ei-m.x*Ii);if(0<Ii&&(t.slipped=!0),Ii<=0||ki<.5*Er.distanceThresholdCCD)break}g=-1;break}if(40<=++f){n<K&&(t.failed=!0);break}}t.toi=g},Ie.staticSweep=function(t,e,i,n){for(var r=t.s1,o=t.s2,s=r.body,a=-s.velx,h=-s.vely,l=s.sweep_angvel,p=r.sweepCoef*(l=l<0?-l:l),u=t.c1,d=t.c2,c=t.axis,y=i,_=0;;){var m=y*e,g=m-s.sweepTime;if(0!=g&&(s.sweepTime=m,s.posx+=s.velx*g,s.posy+=s.vely*g,0!=s.angvel&&(O=s.sweep_angvel*g,s.rot+=O,1e-4<O*O?(s.axisx=Math.sin(s.rot),s.axisy=Math.cos(s.rot)):(I=((k=1-.5*(I=O*O))*s.axisx+O*s.axisy)*(E=1-I*I/8),s.axisy=(k*s.axisy-O*s.axisx)*E,s.axisx=I))),0==r.type)r.worldCOMx=s.posx+(s.axisy*r.localCOMx-s.axisx*r.localCOMy),r.worldCOMy=s.posy+(r.localCOMx*s.axisx+r.localCOMy*s.axisy);else{for(var f=r.polygon,x=f.lverts.next,v=f.gverts.next;null!=v;){var w=v,z=x,x=x.next;w.x=s.posx+(s.axisy*z.x-s.axisx*z.y),w.y=s.posy+(z.x*s.axisx+z.y*s.axisy),v=v.next}for(var b=f.edges.head,S=C=f.gverts.next,C=C.next;null!=C;){var P=C,M=b.elt,b=b.next;M.gnormx=s.axisy*M.lnormx-s.axisx*M.lnormy,M.gnormy=M.lnormx*s.axisx+M.lnormy*s.axisy,M.gprojection=s.posx*M.gnormx+s.posy*M.gnormy+M.lprojection,M.tp0=S.y*M.gnormx-S.x*M.gnormy,M.tp1=P.y*M.gnormx-P.x*M.gnormy,S=P,C=C.next}var T=f.gverts.next,A=b.elt;A.gnormx=s.axisy*A.lnormx-s.axisx*A.lnormy,A.gnormy=A.lnormx*s.axisx+A.lnormy*s.axisy,A.gprojection=s.posx*A.gnormx+s.posy*A.gnormy+A.lprojection,A.tp0=S.y*A.gnormx-S.x*A.gnormy,A.tp1=T.y*A.gnormx-T.x*A.gnormy}var k=r,O=o,E=u,I=d;if(0==r.type&&0==o.type){var G,f=r.circle,T=o.circle,D=0,L=0,D=T.worldCOMx-f.worldCOMx,L=T.worldCOMy-f.worldCOMy,A=Math.sqrt(D*D+L*L),B=A-(f.radius+T.radius);B<1e100&&(0==A?(D=1,L=0):(D*=G=1/A,L*=G),G=f.radius,u.x=f.worldCOMx+D*G,u.y=f.worldCOMy+L*G,G=-T.radius,d.x=T.worldCOMx+D*G,d.y=T.worldCOMy+L*G,c.x=D,c.y=L),D=B}else{L=!1;if(0==r.type&&1==o.type&&(k=o,O=r,E=d,I=u,L=!0),1==k.type&&0==O.type){for(var B=k.polygon,R=O.circle,F=-1e100,N=null,j=B.edges.head;null!=j;){var U=j.elt,V=U.gnormx*R.worldCOMx+U.gnormy*R.worldCOMy-U.gprojection-R.radius;if(1e100<V){F=V;break}0<V?F<V&&(F=V,N=U):F<0&&F<V&&(F=V,N=U),j=j.next}F<1e100&&(lt=N.gp0,vt=N.gp1,(zt=R.worldCOMy*N.gnormx-R.worldCOMx*N.gnormy)<=lt.y*N.gnormx-lt.x*N.gnormy?(wt=gt=0,gt=R.worldCOMx-lt.x,wt=R.worldCOMy-lt.y,(F=(B=Math.sqrt(gt*gt+wt*wt))-R.radius)<1e100&&(0==B?(gt=1,wt=0):(gt*=ht=1/B,wt*=ht),E.x=lt.x+0*gt,E.y=lt.y+0*wt,pt=-R.radius,I.x=R.worldCOMx+gt*pt,I.y=R.worldCOMy+wt*pt,c.x=gt,c.y=wt)):zt>=vt.y*N.gnormx-vt.x*N.gnormy?(mt=dt=0,dt=R.worldCOMx-vt.x,mt=R.worldCOMy-vt.y,(F=(yt=Math.sqrt(dt*dt+mt*mt))-R.radius)<1e100&&(0==yt?(dt=1,mt=0):(dt*=_t=1/yt,mt*=_t),E.x=vt.x+0*dt,E.y=vt.y+0*mt,ut=-R.radius,I.x=R.worldCOMx+dt*ut,I.y=R.worldCOMy+mt*ut,c.x=dt,c.y=mt)):(ct=-R.radius,I.x=R.worldCOMx+N.gnormx*ct,I.y=R.worldCOMy+N.gnormy*ct,E.x=I.x+N.gnormx*(ft=-F),E.y=I.y+N.gnormy*ft,c.x=N.gnormx,c.y=N.gnormy)),L&&(c.x=-c.x,c.y=-c.y),D=F}else{for(var W=k.polygon,X=O.polygon,H=-1e100,q=null,Y=null,K=0,Z=W.edges.head;null!=Z;){for(var J=Z.elt,Q=1e100,$=X.gverts.next;null!=$;){var tt=$,tt=J.gnormx*tt.x+J.gnormy*tt.y;tt<Q&&(Q=tt),$=$.next}if(1e100<(Q-=J.gprojection)){H=Q;break}0<Q?H<Q&&(H=Q,q=J,K=1):H<0&&H<Q&&(H=Q,q=J,K=1),Z=Z.next}if(H<1e100){for(var et,it,nt=X.edges.head;null!=nt;){for(var rt=nt.elt,ot=1e100,st=W.gverts.next;null!=st;){var at=st,at=rt.gnormx*at.x+rt.gnormy*at.y;at<ot&&(ot=at),st=st.next}if(1e100<(ot-=rt.gprojection)){H=ot;break}0<ot?H<ot&&(H=ot,Y=rt,K=2):H<0&&H<ot&&(H=ot,Y=rt,K=2),nt=nt.next}if(H<1e100){1==K?(et=X,it=q):(et=W,it=Y,xt=E,E=I,I=xt,L=!L);for(var ht,lt,pt,ut,dt,ct,yt,_t,mt,gt,ft,xt,vt,wt,zt,bt,St,Ct,Pt,Mt,Tt,At,kt=null,Ot=1e100,Et=et.edges.head;null!=Et;){var It=Et.elt,Gt=it.gnormx*It.gnormx+it.gnormy*It.gnormy;Gt<Ot&&(Ot=Gt,kt=It),Et=Et.next}L?(c.x=-it.gnormx,c.y=-it.gnormy):(c.x=it.gnormx,c.y=it.gnormy),D=0<=H?(ht=it.gp0,lt=it.gp1,pt=kt.gp0,Ct=kt.gp1,zt=wt=Pt=gt=0,yt=1/((gt=lt.x-ht.x)*gt+(Pt=lt.y-ht.y)*Pt),_t=1/((wt=Ct.x-pt.x)*wt+(zt=Ct.y-pt.y)*zt),(bt=-(gt*(ht.x-pt.x)+Pt*(ht.y-pt.y))*yt)<0?bt=0:1<bt&&(bt=1),(At=-(gt*(ht.x-Ct.x)+Pt*(ht.y-Ct.y))*yt)<0?At=0:1<At&&(At=1),(Tt=-(wt*(pt.x-ht.x)+zt*(pt.y-ht.y))*_t)<0?Tt=0:1<Tt&&(Tt=1),(vt=-(wt*(pt.x-lt.x)+zt*(pt.y-lt.y))*_t)<0?vt=0:1<vt&&(vt=1),dt=ut=0,mt=bt,ut=ht.x+gt*mt,dt=ht.y+Pt*mt,St=ct=0,ft=At,ct=ht.x+gt*ft,St=ht.y+Pt*ft,O=k=0,xt=Tt,k=pt.x+wt*xt,O=pt.y+zt*xt,_t=yt=0,bt=vt,yt=pt.x+wt*bt,_t=pt.y+zt*bt,zt=wt=vt=xt=Tt=ft=Pt=gt=At=mt=0,bt=null,(At=(mt=ut-pt.x)*mt+(At=dt-pt.y)*At)<(Pt=(gt=ct-Ct.x)*gt+(Pt=St-Ct.y)*Pt)?(wt=ut,zt=dt,bt=pt):(wt=ct,zt=St,bt=Ct,At=Pt),Ct=St=0,Pt=null,(Tt=(ft=k-ht.x)*ft+(Tt=O-ht.y)*Tt)<(vt=(xt=yt-lt.x)*xt+(vt=_t-lt.y)*vt)?(St=k,Ct=O,Pt=ht):(St=yt,Ct=_t,Pt=lt,Tt=vt),0!=(H=At<Tt?(E.x=wt,E.y=zt,I.x=bt.x,I.y=bt.y,Math.sqrt(At)):(I.x=St,I.y=Ct,E.x=Pt.x,E.y=Pt.y,Math.sqrt(Tt)))&&(c.x=I.x-E.x,c.y=I.y-E.y,c.x*=Mt=1/H,c.y*=Mt,L&&(c.x=-c.x,c.y=-c.y)),H):(At=bt=0,bt=kt.gp0.x,At=kt.gp0.y,Tt=Pt=Ct=St=0,Pt=(St=kt.gp1.x)-bt,Tt=(Ct=kt.gp1.y)-At,Mt=it.gnormy*bt-it.gnormx*At,L=it.gnormy*St-it.gnormx*Ct,Mt=(-it.tp1-Mt)*(Lt=1/(L-Mt)),Er.epsilon<Mt&&(bt+=Pt*Mt,At+=Tt*Mt),(Lt=(-it.tp0-L)*Lt)<-Er.epsilon&&(St+=Pt*Lt,Ct+=Tt*Lt),(Tt=bt*it.gnormx+At*it.gnormy-it.gprojection)<(Lt=St*it.gnormx+Ct*it.gnormy-it.gprojection)?(I.x=bt,I.y=At,E.x=I.x+it.gnormx*(At=-Tt),E.y=I.y+it.gnormy*At,Tt):(I.x=St,I.y=Ct,E.x=I.x+it.gnormx*(Dt=-Lt),E.y=I.y+it.gnormy*Dt,Lt))}else D=1e100}else D=1e100}}var I=D+n,Dt=a*c.x+h*c.y;if(I<Er.distanceThresholdCCD){var Lt=u.x-s.posx,Bt=u.y-s.posy,Bt=Dt-s.sweep_angvel*(c.y*Lt-c.x*Bt);if(0<Bt&&(t.slipped=!0),Bt<=0||I<.5*Er.distanceThresholdCCD)break}Bt=(p-Dt)*e;if(Bt<=0){y=-1;break}Dt=I/Bt;if(1<=(y+=Dt=Dt<1e-6?1e-6:Dt)){Bt=(y=1)*e,Dt=Bt-s.sweepTime;if(0!=Dt&&(s.sweepTime=Bt,s.posx+=s.velx*Dt,s.posy+=s.vely*Dt,0!=s.angvel&&(Jt=s.sweep_angvel*Dt,s.rot+=Jt,1e-4<Jt*Jt?(s.axisx=Math.sin(s.rot),s.axisy=Math.cos(s.rot)):($t=((Zt=1-.5*($t=Jt*Jt))*s.axisx+Jt*s.axisy)*(Qt=1-$t*$t/8),s.axisy=(Zt*s.axisy-Jt*s.axisx)*Qt,s.axisx=$t))),0==r.type)r.worldCOMx=s.posx+(s.axisy*r.localCOMx-s.axisx*r.localCOMy),r.worldCOMy=s.posy+(r.localCOMx*s.axisx+r.localCOMy*s.axisy);else{for(var Rt=r.polygon,Ft=Rt.lverts.next,Nt=Rt.gverts.next;null!=Nt;){var jt=Nt,Ut=Ft,Ft=Ft.next;jt.x=s.posx+(s.axisy*Ut.x-s.axisx*Ut.y),jt.y=s.posy+(Ut.x*s.axisx+Ut.y*s.axisy),Nt=Nt.next}for(var Vt=Rt.edges.head,Wt=Xt=Rt.gverts.next,Xt=Xt.next;null!=Xt;){var Ht=Xt,qt=Vt.elt,Vt=Vt.next;qt.gnormx=s.axisy*qt.lnormx-s.axisx*qt.lnormy,qt.gnormy=qt.lnormx*s.axisx+qt.lnormy*s.axisy,qt.gprojection=s.posx*qt.gnormx+s.posy*qt.gnormy+qt.lprojection,qt.tp0=Wt.y*qt.gnormx-Wt.x*qt.gnormy,qt.tp1=Ht.y*qt.gnormx-Ht.x*qt.gnormy,Wt=Ht,Xt=Xt.next}var Yt=Rt.gverts.next,Kt=Vt.elt;Kt.gnormx=s.axisy*Kt.lnormx-s.axisx*Kt.lnormy,Kt.gnormy=Kt.lnormx*s.axisx+Kt.lnormy*s.axisy,Kt.gprojection=s.posx*Kt.gnormx+s.posy*Kt.gnormy+Kt.lprojection,Kt.tp0=Wt.y*Kt.gnormx-Wt.x*Kt.gnormy,Kt.tp1=Yt.y*Kt.gnormx-Yt.x*Kt.gnormy}var Zt=r,Jt=o,Qt=u,$t=d;if(0==r.type&&0==o.type){var te,Rt=r.circle,Yt=o.circle,ee=0,ie=0,ee=Yt.worldCOMx-Rt.worldCOMx,ie=Yt.worldCOMy-Rt.worldCOMy,Kt=Math.sqrt(ee*ee+ie*ie),ne=Kt-(Rt.radius+Yt.radius);ne<1e100&&(0==Kt?(ee=1,ie=0):(ee*=te=1/Kt,ie*=te),te=Rt.radius,u.x=Rt.worldCOMx+ee*te,u.y=Rt.worldCOMy+ie*te,te=-Yt.radius,d.x=Yt.worldCOMx+ee*te,d.y=Yt.worldCOMy+ie*te,c.x=ee,c.y=ie),ee=ne}else{ie=!1;if(0==r.type&&1==o.type&&(Zt=o,Jt=r,Qt=d,$t=u,ie=!0),1==Zt.type&&0==Jt.type){for(var ne=Zt.polygon,re=Jt.circle,oe=-1e100,se=null,ae=ne.edges.head;null!=ae;){var he=ae.elt,le=he.gnormx*re.worldCOMx+he.gnormy*re.worldCOMy-he.gprojection-re.radius;if(1e100<le){oe=le;break}0<le?oe<le&&(oe=le,se=he):oe<0&&oe<le&&(oe=le,se=he),ae=ae.next}oe<1e100&&(Ae=se.gp0,Ne=se.gp1,(Ue=re.worldCOMy*se.gnormx-re.worldCOMx*se.gnormy)<=Ae.y*se.gnormx-Ae.x*se.gnormy?(je=Be=0,Be=re.worldCOMx-Ae.x,je=re.worldCOMy-Ae.y,(oe=(ne=Math.sqrt(Be*Be+je*je))-re.radius)<1e100&&(0==ne?(Be=1,je=0):(Be*=Te=1/ne,je*=Te),Qt.x=Ae.x+0*Be,Qt.y=Ae.y+0*je,ke=-re.radius,$t.x=re.worldCOMx+Be*ke,$t.y=re.worldCOMy+je*ke,c.x=Be,c.y=je)):Ue>=Ne.y*se.gnormx-Ne.x*se.gnormy?(Le=Ee=0,Ee=re.worldCOMx-Ne.x,Le=re.worldCOMy-Ne.y,(oe=(Ge=Math.sqrt(Ee*Ee+Le*Le))-re.radius)<1e100&&(0==Ge?(Ee=1,Le=0):(Ee*=De=1/Ge,Le*=De),Qt.x=Ne.x+0*Ee,Qt.y=Ne.y+0*Le,Oe=-re.radius,$t.x=re.worldCOMx+Ee*Oe,$t.y=re.worldCOMy+Le*Oe,c.x=Ee,c.y=Le)):(Ie=-re.radius,$t.x=re.worldCOMx+se.gnormx*Ie,$t.y=re.worldCOMy+se.gnormy*Ie,Qt.x=$t.x+se.gnormx*(Re=-oe),Qt.y=$t.y+se.gnormy*Re,c.x=se.gnormx,c.y=se.gnormy)),ie&&(c.x=-c.x,c.y=-c.y),ee=oe}else{for(var pe=Zt.polygon,ue=Jt.polygon,de=-1e100,ce=null,ye=null,_e=0,me=pe.edges.head;null!=me;){for(var ge=me.elt,fe=1e100,xe=ue.gverts.next;null!=xe;){var ve=xe,ve=ge.gnormx*ve.x+ge.gnormy*ve.y;ve<fe&&(fe=ve),xe=xe.next}if(1e100<(fe-=ge.gprojection)){de=fe;break}0<fe?de<fe&&(de=fe,ce=ge,_e=1):de<0&&de<fe&&(de=fe,ce=ge,_e=1),me=me.next}if(de<1e100){for(var we,ze,be=ue.edges.head;null!=be;){for(var Se=be.elt,Ce=1e100,Pe=pe.gverts.next;null!=Pe;){var Me=Pe,Me=Se.gnormx*Me.x+Se.gnormy*Me.y;Me<Ce&&(Ce=Me),Pe=Pe.next}if(1e100<(Ce-=Se.gprojection)){de=Ce;break}0<Ce?de<Ce&&(de=Ce,ye=Se,_e=2):de<0&&de<Ce&&(de=Ce,ye=Se,_e=2),be=be.next}if(de<1e100){1==_e?(we=ue,ze=ce):(we=pe,ze=ye,Fe=Qt,Qt=$t,$t=Fe,ie=!ie);for(var Te,Ae,ke,Oe,Ee,Ie,Ge,De,Le,Be,Re,Fe,Ne,je,Ue,Ve,We,Xe,He,qe,Ye,Ke,Ze=null,Je=1e100,Qe=we.edges.head;null!=Qe;){var $e=Qe.elt,ti=ze.gnormx*$e.gnormx+ze.gnormy*$e.gnormy;ti<Je&&(Je=ti,Ze=$e),Qe=Qe.next}ie?(c.x=-ze.gnormx,c.y=-ze.gnormy):(c.x=ze.gnormx,c.y=ze.gnormy),ee=0<=de?(Te=ze.gp0,Ae=ze.gp1,ke=Ze.gp0,Xe=Ze.gp1,Ue=je=He=Be=0,Ge=1/((Be=Ae.x-Te.x)*Be+(He=Ae.y-Te.y)*He),De=1/((je=Xe.x-ke.x)*je+(Ue=Xe.y-ke.y)*Ue),(Ve=-(Be*(Te.x-ke.x)+He*(Te.y-ke.y))*Ge)<0?Ve=0:1<Ve&&(Ve=1),(Ke=-(Be*(Te.x-Xe.x)+He*(Te.y-Xe.y))*Ge)<0?Ke=0:1<Ke&&(Ke=1),(Ye=-(je*(ke.x-Te.x)+Ue*(ke.y-Te.y))*De)<0?Ye=0:1<Ye&&(Ye=1),(Ne=-(je*(ke.x-Ae.x)+Ue*(ke.y-Ae.y))*De)<0?Ne=0:1<Ne&&(Ne=1),Ee=Oe=0,Le=Ve,Oe=Te.x+Be*Le,Ee=Te.y+He*Le,We=Ie=0,Re=Ke,Ie=Te.x+Be*Re,We=Te.y+He*Re,Jt=Zt=0,Fe=Ye,Zt=ke.x+je*Fe,Jt=ke.y+Ue*Fe,De=Ge=0,Ve=Ne,Ge=ke.x+je*Ve,De=ke.y+Ue*Ve,Ue=je=Ne=Fe=Ye=Re=He=Be=Ke=Le=0,Ve=null,(Ke=(Le=Oe-ke.x)*Le+(Ke=Ee-ke.y)*Ke)<(He=(Be=Ie-Xe.x)*Be+(He=We-Xe.y)*He)?(je=Oe,Ue=Ee,Ve=ke):(je=Ie,Ue=We,Ve=Xe,Ke=He),Xe=We=0,He=null,(Ye=(Re=Zt-Te.x)*Re+(Ye=Jt-Te.y)*Ye)<(Ne=(Fe=Ge-Ae.x)*Fe+(Ne=De-Ae.y)*Ne)?(We=Zt,Xe=Jt,He=Te):(We=Ge,Xe=De,He=Ae,Ye=Ne),0!=(de=Ke<Ye?(Qt.x=je,Qt.y=Ue,$t.x=Ve.x,$t.y=Ve.y,Math.sqrt(Ke)):($t.x=We,$t.y=Xe,Qt.x=He.x,Qt.y=He.y,Math.sqrt(Ye)))&&(c.x=$t.x-Qt.x,c.y=$t.y-Qt.y,c.x*=qe=1/de,c.y*=qe,ie&&(c.x=-c.x,c.y=-c.y)),de):(Ke=Ve=0,Ve=Ze.gp0.x,Ke=Ze.gp0.y,Ye=He=Xe=We=0,He=(We=Ze.gp1.x)-Ve,Ye=(Xe=Ze.gp1.y)-Ke,qe=ze.gnormy*Ve-ze.gnormx*Ke,ie=ze.gnormy*We-ze.gnormx*Xe,qe=(-ze.tp1-qe)*(ii=1/(ie-qe)),Er.epsilon<qe&&(Ve+=He*qe,Ke+=Ye*qe),(ii=(-ze.tp0-ie)*ii)<-Er.epsilon&&(We+=He*ii,Xe+=Ye*ii),(Ye=Ve*ze.gnormx+Ke*ze.gnormy-ze.gprojection)<(ii=We*ze.gnormx+Xe*ze.gnormy-ze.gprojection)?($t.x=Ve,$t.y=Ke,Qt.x=$t.x+ze.gnormx*(Ke=-Ye),Qt.y=$t.y+ze.gnormy*Ke,Ye):($t.x=We,$t.y=Xe,Qt.x=$t.x+ze.gnormx*(ei=-ii),Qt.y=$t.y+ze.gnormy*ei,ii))}else ee=1e100}else ee=1e100}}Qt=ee+n,$t=a*c.x+h*c.y;if(Qt<Er.distanceThresholdCCD){var ei=u.x-s.posx,ii=u.y-s.posy,ii=$t-s.sweep_angvel*(c.y*ei-c.x*ii);if(0<ii&&(t.slipped=!0),ii<=0||Qt<.5*Er.distanceThresholdCCD)break}y=-1;break}if(40<=++_){n<I&&(t.failed=!0);break}}t.toi=y},Ie.distanceBody=function(t,e,i,n){var r,o,s;null==Gr.zpp_pool?r=new Gr:(r=Gr.zpp_pool,Gr.zpp_pool=r.next,r.next=null),r.weak=!1,null==Gr.zpp_pool?o=new Gr:(o=Gr.zpp_pool,Gr.zpp_pool=o.next,o.next=null),o.weak=!1,null==Gr.zpp_pool?s=new Gr:(s=Gr.zpp_pool,Gr.zpp_pool=s.next,s.next=null),s.weak=!1;for(var a=1e100,h=t.shapes.head;null!=h;){for(var l=h.elt,p=e.shapes.head;null!=p;){var u=p.elt,d=l,c=u,y=r,_=o;if(0==l.type&&0==u.type){var m,g=l.circle,f=u.circle,x=0,v=0,x=f.worldCOMx-g.worldCOMx,v=f.worldCOMy-g.worldCOMy,w=Math.sqrt(x*x+v*v),z=w-(g.radius+f.radius);z<a&&(0==w?(x=1,v=0):(x*=m=1/w,v*=m),m=g.radius,y.x=g.worldCOMx+x*m,y.y=g.worldCOMy+v*m,m=-f.radius,_.x=f.worldCOMx+x*m,_.y=f.worldCOMy+v*m,s.x=x,s.y=v),v=z}else{z=!1;if(0==l.type&&1==u.type&&(d=u,c=l,b=y,y=_,_=b,z=!0),1==d.type&&0==c.type){for(var b=d.polygon,S=c.circle,C=-1e100,P=null,M=b.edges.head;null!=M;){var T=M.elt,A=T.gnormx*S.worldCOMx+T.gnormy*S.worldCOMy-T.gprojection-S.radius;if(a<A){C=A;break}0<A?C<A&&(C=A,P=T):C<0&&C<A&&(C=A,P=T),M=M.next}C<a&&(Y=P.gp0,st=P.gp1,(at=S.worldCOMy*P.gnormx-S.worldCOMx*P.gnormy)<=Y.y*P.gnormx-Y.x*P.gnormy?(nt=Z=0,Z=S.worldCOMx-Y.x,nt=S.worldCOMy-Y.y,(C=(b=Math.sqrt(Z*Z+nt*nt))-S.radius)<a&&(0==b?(Z=1,nt=0):(Z*=K=1/b,nt*=K),y.x=Y.x+0*Z,y.y=Y.y+0*nt,K=-S.radius,_.x=S.worldCOMx+Z*K,_.y=S.worldCOMy+nt*K,s.x=Z,s.y=nt)):at>=st.y*P.gnormx-st.x*P.gnormy?(it=Q=0,Q=S.worldCOMx-st.x,it=S.worldCOMy-st.y,(C=(tt=Math.sqrt(Q*Q+it*it))-S.radius)<a&&(0==tt?(Q=1,it=0):(Q*=et=1/tt,it*=et),y.x=st.x+0*Q,y.y=st.y+0*it,J=-S.radius,_.x=S.worldCOMx+Q*J,_.y=S.worldCOMy+it*J,s.x=Q,s.y=it)):($=-S.radius,_.x=S.worldCOMx+P.gnormx*$,_.y=S.worldCOMy+P.gnormy*$,y.x=_.x+P.gnormx*(rt=-C),y.y=_.y+P.gnormy*rt,s.x=P.gnormx,s.y=P.gnormy)),z&&(s.x=-s.x,s.y=-s.y),v=C}else{for(var k=d.polygon,O=c.polygon,E=-1e100,I=null,G=null,D=0,L=k.edges.head;null!=L;){for(var B=L.elt,R=1e100,F=O.gverts.next;null!=F;){var N=F,N=B.gnormx*N.x+B.gnormy*N.y;N<R&&(R=N),F=F.next}if(a<(R-=B.gprojection)){E=R;break}0<R?E<R&&(E=R,I=B,D=1):E<0&&E<R&&(E=R,I=B,D=1),L=L.next}if(E<a){for(var j,U,V=O.edges.head;null!=V;){for(var W=V.elt,X=1e100,H=k.gverts.next;null!=H;){var q=H,q=W.gnormx*q.x+W.gnormy*q.y;q<X&&(X=q),H=H.next}if(a<(X-=W.gprojection)){E=X;break}0<X?E<X&&(E=X,G=W,D=2):E<0&&E<X&&(E=X,G=W,D=2),V=V.next}if(E<a){1==D?(j=O,U=I):(j=k,U=G,ot=y,y=_,_=ot,z=!z);for(var Y,K,Z,J,Q,$,tt,et,it,nt,rt,ot,st,at,ht,lt,pt,ut,dt,ct,yt,_t,mt=null,gt=1e100,ft=j.edges.head;null!=ft;){var xt=ft.elt,vt=U.gnormx*xt.gnormx+U.gnormy*xt.gnormy;vt<gt&&(gt=vt,mt=xt),ft=ft.next}z?(s.x=-U.gnormx,s.y=-U.gnormy):(s.x=U.gnormx,s.y=U.gnormy),v=0<=E?(Y=U.gp0,K=U.gp1,Z=mt.gp0,pt=mt.gp1,ht=at=ct=nt=0,tt=1/((nt=K.x-Y.x)*nt+(ct=K.y-Y.y)*ct),et=1/((at=pt.x-Z.x)*at+(ht=pt.y-Z.y)*ht),(yt=-(nt*(Y.x-Z.x)+ct*(Y.y-Z.y))*tt)<0?yt=0:1<yt&&(yt=1),(lt=-(nt*(Y.x-pt.x)+ct*(Y.y-pt.y))*tt)<0?lt=0:1<lt&&(lt=1),(dt=-(at*(Z.x-Y.x)+ht*(Z.y-Y.y))*et)<0?dt=0:1<dt&&(dt=1),(st=-(at*(Z.x-K.x)+ht*(Z.y-K.y))*et)<0?st=0:1<st&&(st=1),Q=J=0,it=yt,J=Y.x+nt*it,Q=Y.y+ct*it,_t=$=0,rt=lt,$=Y.x+nt*rt,_t=Y.y+ct*rt,c=d=0,ot=dt,d=Z.x+at*ot,c=Z.y+ht*ot,et=tt=0,yt=st,tt=Z.x+at*yt,et=Z.y+ht*yt,ht=at=st=ot=dt=rt=ct=nt=lt=it=0,yt=null,(lt=(it=J-Z.x)*it+(lt=Q-Z.y)*lt)<(ct=(nt=$-pt.x)*nt+(ct=_t-pt.y)*ct)?(at=J,ht=Q,yt=Z):(at=$,ht=_t,yt=pt,lt=ct),pt=_t=0,ct=null,(dt=(rt=d-Y.x)*rt+(dt=c-Y.y)*dt)<(st=(ot=tt-K.x)*ot+(st=et-K.y)*st)?(_t=d,pt=c,ct=Y):(_t=tt,pt=et,ct=K,dt=st),0!=(E=lt<dt?(y.x=at,y.y=ht,_.x=yt.x,_.y=yt.y,Math.sqrt(lt)):(_.x=_t,_.y=pt,y.x=ct.x,y.y=ct.y,Math.sqrt(dt)))&&(s.x=_.x-y.x,s.y=_.y-y.y,s.x*=ut=1/E,s.y*=ut,z&&(s.x=-s.x,s.y=-s.y)),E):(yt=ht=0,ht=mt.gp0.x,yt=mt.gp0.y,ct=pt=_t=lt=0,pt=(lt=mt.gp1.x)-ht,ct=(_t=mt.gp1.y)-yt,dt=U.gnormy*ht-U.gnormx*yt,ut=U.gnormy*lt-U.gnormx*_t,dt=(-U.tp1-dt)*(z=1/(ut-dt)),Er.epsilon<dt&&(ht+=pt*dt,yt+=ct*dt),(z=(-U.tp0-ut)*z)<-Er.epsilon&&(lt+=pt*z,_t+=ct*z),(ct=ht*U.gnormx+yt*U.gnormy-U.gprojection)<(z=lt*U.gnormx+_t*U.gnormy-U.gprojection)?(_.x=ht,_.y=yt,y.x=_.x+U.gnormx*(yt=-ct),y.y=_.y+U.gnormy*yt,ct):(_.x=lt,_.y=_t,y.x=_.x+U.gnormx*(_t=-z),y.y=_.y+U.gnormy*_t,z))}else v=a}else v=a}}v<a&&(a=v,i.x=r.x,i.y=r.y,n.x=o.x,n.y=o.y),p=p.next}h=h.next}t=r;null!=t.outer&&(t.outer.zpp_inner=null,t.outer=null),t._isimmutable=null,t._validate=null,t._invalidate=null,t.next=Gr.zpp_pool,Gr.zpp_pool=t;t=o;null!=t.outer&&(t.outer.zpp_inner=null,t.outer=null),t._isimmutable=null,t._validate=null,t._invalidate=null,t.next=Gr.zpp_pool,Gr.zpp_pool=t;t=s;return null!=t.outer&&(t.outer.zpp_inner=null,t.outer=null),t._isimmutable=null,t._validate=null,t._invalidate=null,t.next=Gr.zpp_pool,Gr.zpp_pool=t,a},Ie.distance=function(t,e,i,n,r,o){if(null==o&&(o=1e100),0==t.type&&0==e.type){var s,a=t.circle,h=e.circle,l=0,p=0,l=h.worldCOMx-a.worldCOMx,p=h.worldCOMy-a.worldCOMy,u=Math.sqrt(l*l+p*p),d=u-(a.radius+h.radius);return d<o&&(0==u?(l=1,p=0):(l*=s=1/u,p*=s),s=a.radius,i.x=a.worldCOMx+l*s,i.y=a.worldCOMy+p*s,s=-h.radius,n.x=h.worldCOMx+l*s,n.y=h.worldCOMy+p*s,r.x=l,r.y=p),d}l=!1;if(0==t.type&&1==e.type&&(c=t,t=e,e=c,y=i,i=n,n=y,l=!0),1==t.type&&0==e.type){for(var c,y,p=t.polygon,_=e.circle,m=-1e100,g=null,f=p.edges.head;null!=f;){var x=f.elt,v=x.gnormx*_.worldCOMx+x.gnormy*_.worldCOMy-x.gprojection-_.radius;if(o<v){m=v;break}0<v?m<v&&(m=v,g=x):m<0&&m<v&&(m=v,g=x),f=f.next}return m<o&&(d=g.gp0,q=g.gp1,(V=_.worldCOMy*g.gnormx-_.worldCOMx*g.gnormy)<=d.y*g.gnormx-d.x*g.gnormy?(y=c=0,c=_.worldCOMx-d.x,y=_.worldCOMy-d.y,(m=(p=Math.sqrt(c*c+y*y))-_.radius)<o&&(0==p?(c=1,y=0):(c*=p=1/p,y*=p),i.x=d.x+0*c,i.y=d.y+0*y,d=-_.radius,n.x=_.worldCOMx+c*d,n.y=_.worldCOMy+y*d,r.x=c,r.y=y)):V>=q.y*g.gnormx-q.x*g.gnormy?(tt=$=0,$=_.worldCOMx-q.x,tt=_.worldCOMy-q.y,(m=(W=Math.sqrt($*$+tt*tt))-_.radius)<o&&(0==W?($=1,tt=0):($*=X=1/W,tt*=X),i.x=q.x+0*$,i.y=q.y+0*tt,Y=-_.radius,n.x=_.worldCOMx+$*Y,n.y=_.worldCOMy+tt*Y,r.x=$,r.y=tt)):(it=-_.radius,n.x=_.worldCOMx+g.gnormx*it,n.y=_.worldCOMy+g.gnormy*it,i.x=n.x+g.gnormx*(nt=-m),i.y=n.y+g.gnormy*nt,r.x=g.gnormx,r.y=g.gnormy)),l&&(r.x=-r.x,r.y=-r.y),m}for(var w=t.polygon,z=e.polygon,b=-1e100,S=null,C=null,P=0,M=w.edges.head;null!=M;){for(var T=M.elt,A=1e100,k=z.gverts.next;null!=k;){var O=k,O=T.gnormx*O.x+T.gnormy*O.y;O<A&&(A=O),k=k.next}if(o<(A-=T.gprojection)){b=A;break}0<A?b<A&&(b=A,S=T,P=1):b<0&&b<A&&(b=A,S=T,P=1),M=M.next}if(b<o){for(var E,I=z.edges.head;null!=I;){for(var G=I.elt,D=1e100,L=w.gverts.next;null!=L;){var B=L,B=G.gnormx*B.x+G.gnormy*B.y;B<D&&(D=B),L=L.next}if(o<(D-=G.gprojection)){b=D;break}0<D?b<D&&(b=D,C=G,P=2):b<0&&b<D&&(b=D,C=G,P=2),I=I.next}if(b<o){1==P?(ot=z,E=S):(ot=w,E=C,rt=i,i=n,n=rt,l=!l);for(var R=null,F=1e100,N=ot.edges.head;null!=N;){var j=N.elt,U=E.gnormx*j.gnormx+E.gnormy*j.gnormy;U<F&&(F=U,R=j),N=N.next}if(l?(r.x=-E.gnormx,r.y=-E.gnormy):(r.x=E.gnormx,r.y=E.gnormy),0<=b){var V=E.gp0,W=E.gp1,X=R.gp0,H=R.gp1,q=0,Y=0,K=0,Z=0,J=1/((q=W.x-V.x)*q+(Y=W.y-V.y)*Y),Q=1/((K=H.x-X.x)*K+(Z=H.y-X.y)*Z),$=-(q*(V.x-X.x)+Y*(V.y-X.y))*J,tt=-(q*(V.x-H.x)+Y*(V.y-H.y))*J,et=-(K*(X.x-V.x)+Z*(X.y-V.y))*Q,it=-(K*(X.x-W.x)+Z*(X.y-W.y))*Q;$<0?$=0:1<$&&($=1),tt<0?tt=0:1<tt&&(tt=1),et<0?et=0:1<et&&(et=1),it<0?it=0:1<it&&(it=1);var nt=$,t=V.x+q*nt,e=V.y+Y*nt,rt=tt,ot=V.x+q*rt,J=V.y+Y*rt,Q=et,$=X.x+K*Q,nt=X.y+Z*Q,tt=it,q=X.x+K*tt,Y=X.y+Z*tt,rt=0,et=0,Q=(rt=t-X.x)*rt+(et=e-X.y)*et,it=0,K=0,Z=(it=ot-H.x)*it+(K=J-H.y)*K,tt=0,rt=0,et=(tt=$-V.x)*tt+(rt=nt-V.y)*rt,it=0,K=0,tt=(it=q-W.x)*it+(K=Y-W.y)*K,rt=0,it=0,K=null;Q<Z?(rt=t,it=e,K=X):(rt=ot,it=J,K=H,Q=Z);J=0,H=0,Z=null;return et<tt?(J=$,H=nt,Z=V):(J=q,H=Y,Z=W,et=tt),0!=(b=Q<et?(i.x=rt,i.y=it,n.x=K.x,n.y=K.y,Math.sqrt(Q)):(n.x=J,n.y=H,i.x=Z.x,i.y=Z.y,Math.sqrt(et)))&&(r.x=n.x-i.x,r.y=n.y-i.y,r.x*=st=1/b,r.y*=st,l&&(r.x=-r.x,r.y=-r.y)),b}var K=0,Q=0,K=R.gp0.x,Q=R.gp0.y,J=0,H=0,Z=(J=R.gp1.x)-K,et=(H=R.gp1.y)-Q,st=E.gnormy*K-E.gnormx*Q,l=E.gnormy*J-E.gnormx*H,r=1/(l-st),st=(-E.tp1-st)*r;Er.epsilon<st&&(K+=Z*st,Q+=et*st);r=(-E.tp0-l)*r;r<-Er.epsilon&&(J+=Z*r,H+=et*r);et=K*E.gnormx+Q*E.gnormy-E.gprojection,r=J*E.gnormx+H*E.gnormy-E.gprojection;if(et<r){n.x=K,n.y=Q;Q=-et;return i.x=n.x+E.gnormx*Q,i.y=n.y+E.gnormy*Q,et}n.x=J,n.y=H;H=-r;return i.x=n.x+E.gnormx*H,i.y=n.y+E.gnormy*H,r}return o}return o},Ie.prototype.__class__=Ie;var Ge=zpp_nape.geom.ZPP_PartitionPair=function(){this.node=null,this.di=0,this.id=0,this.b=null,this.a=null,this.length=0,this.pushmod=!1,this.modified=!1,this._inuse=!1,this.next=null};Ge.__name__=["zpp_nape","geom","ZPP_PartitionPair"],Ge.get=function(t,e){var i;return null==Ge.zpp_pool?i=new Ge:(i=Ge.zpp_pool,Ge.zpp_pool=i.next,i.next=null),i.a=t,i.b=e,t.id<e.id?(i.id=t.id,i.di=e.id):(i.id=e.id,i.di=t.id),i},Ge.edge_swap=function(t,e){var i=t.node;t.node=e.node,e.node=i},Ge.edge_lt=function(t,e){return!(t.id>=e.id)||t.id==e.id&&t.di<e.di},Ge.prototype.next=null,Ge.prototype.elem=function(){return this},Ge.prototype.begin=function(){return this.next},Ge.prototype._inuse=null,Ge.prototype.modified=null,Ge.prototype.pushmod=null,Ge.prototype.length=null,Ge.prototype.setbegin=function(t){this.next=t,this.modified=!0,this.pushmod=!0},Ge.prototype.add=function(t){return t._inuse=!0,t.next=this.next,this.next=t,this.modified=!0,this.length++,t},Ge.prototype.inlined_add=function(t){return t._inuse=!0,t.next=this.next,this.next=t,this.modified=!0,this.length++,t},Ge.prototype.addAll=function(t){for(var e=t.next;null!=e;)this.add(e),e=e.next},Ge.prototype.insert=function(t,e){return e._inuse=!0,null==t?(e.next=this.next,this.next=e):(e.next=t.next,t.next=e),this.pushmod=this.modified=!0,this.length++,e},Ge.prototype.inlined_insert=function(t,e){return e._inuse=!0,null==t?(e.next=this.next,this.next=e):(e.next=t.next,t.next=e),this.pushmod=this.modified=!0,this.length++,e},Ge.prototype.pop=function(){var t=this.next;this.next=t.next,t._inuse=!1,null==this.next&&(this.pushmod=!0),this.modified=!0,this.length--},Ge.prototype.inlined_pop=function(){var t=this.next;this.next=t.next,t._inuse=!1,null==this.next&&(this.pushmod=!0),this.modified=!0,this.length--},Ge.prototype.pop_unsafe=function(){var t=this.next;return this.pop(),t},Ge.prototype.inlined_pop_unsafe=function(){var t=this.next;return this.pop(),t},Ge.prototype.remove=function(t){for(var e,i,n=null,r=this.next;null!=r;){if(r==t){null==n?(i=(e=this.next).next,this.next=i,null==this.next&&(this.pushmod=!0)):(i=(e=n.next).next,null==(n.next=i)&&(this.pushmod=!0)),e._inuse=!1,this.modified=!0,this.length--,this.pushmod=!0;break}r=(n=r).next}},Ge.prototype.try_remove=function(t){for(var e=null,i=this.next,n=!1;null!=i;){if(i==t){this.erase(e),n=!0;break}i=(e=i).next}return n},Ge.prototype.inlined_remove=function(t){for(var e,i,n=null,r=this.next;null!=r;){if(r==t){null==n?(i=(e=this.next).next,this.next=i,null==this.next&&(this.pushmod=!0)):(i=(e=n.next).next,null==(n.next=i)&&(this.pushmod=!0)),e._inuse=!1,this.modified=!0,this.length--,this.pushmod=!0;break}r=(n=r).next}},Ge.prototype.inlined_try_remove=function(t){for(var e,i,n=null,r=this.next,o=!1;null!=r;){if(r==t){null==n?(i=(e=this.next).next,this.next=i,null==this.next&&(this.pushmod=!0)):(i=(e=n.next).next,null==(n.next=i)&&(this.pushmod=!0)),e._inuse=!1,this.modified=!0,this.length--,o=this.pushmod=!0;break}r=(n=r).next}return o},Ge.prototype.erase=function(t){var e,i;return null==t?(i=(e=this.next).next,this.next=i,null==this.next&&(this.pushmod=!0)):(i=(e=t.next).next,null==(t.next=i)&&(this.pushmod=!0)),e._inuse=!1,this.modified=!0,this.length--,this.pushmod=!0,i},Ge.prototype.inlined_erase=function(t){var e,i;return null==t?(i=(e=this.next).next,this.next=i,null==this.next&&(this.pushmod=!0)):(i=(e=t.next).next,null==(t.next=i)&&(this.pushmod=!0)),e._inuse=!1,this.modified=!0,this.length--,this.pushmod=!0,i},Ge.prototype.splice=function(t,e){for(;0<e--&&null!=t.next;)this.erase(t);return t.next},Ge.prototype.clear=function(){},Ge.prototype.inlined_clear=function(){},Ge.prototype.reverse=function(){for(var t=this.next,e=null;null!=t;){var i=t.next;t.next=e,e=this.next=t,t=i}this.modified=!0,this.pushmod=!0},Ge.prototype.empty=function(){return null==this.next},Ge.prototype.size=function(){return this.length},Ge.prototype.has=function(t){for(var e=!1,i=this.next;null!=i;){if(i==t){e=!0;break}i=i.next}return e},Ge.prototype.inlined_has=function(t){for(var e=!1,i=this.next;null!=i;){if(i==t){e=!0;break}i=i.next}return e},Ge.prototype.front=function(){return this.next},Ge.prototype.back=function(){for(var t=this.next,e=t;null!=e;)e=(t=e).next;return t},Ge.prototype.iterator_at=function(t){for(var e=this.next;0<t--&&null!=e;)e=e.next;return e},Ge.prototype.at=function(t){t=this.iterator_at(t);return null!=t?t:null},Ge.prototype.free=function(){this.a=this.b=null,this.node=null},Ge.prototype.alloc=function(){},Ge.prototype.a=null,Ge.prototype.b=null,Ge.prototype.id=null,Ge.prototype.di=null,Ge.prototype.node=null,Ge.prototype.__class__=Ge;var Le=zpp_nape.geom.ZPP_Triangular=function(){};Le.__name__=["zpp_nape","geom","ZPP_Triangular"],Le.lt=function(t,e){return t.y<e.y||t.y==e.y&&t.x<e.x},Le.right_turn=function(t,e,i){var n=i.x-e.x,r=i.y-e.y,i=e.x-t.x;return(e.y-t.y)*n-i*r},Le.delaunay=function(t,e,i,n){var r=0,o=0,s=0,r=i.x-e.x,o=i.y-e.y,s=e.x-t.x,a=0<=(e.y-t.y)*r-s*o||(r=n.x-i.x,o=n.y-i.y,s=i.x-e.x,0<=(i.y-e.y)*r-s*o),a=!!a||(r=t.x-n.x,o=t.y-n.y,s=n.x-i.x,0<=(n.y-i.y)*r-s*o),o=!!a||(r=e.x-t.x,o=e.y-t.y,s=t.x-n.x,0<=(t.y-n.y)*r-s*o);return!!o||0<e.x*(i.y*n.mag-i.mag*n.y)-i.x*(e.y*n.mag-e.mag*n.y)+n.x*(e.y*i.mag-e.mag*i.y)-(t.x*(i.y*n.mag-i.mag*n.y)-i.x*(t.y*n.mag-t.mag*n.y)+n.x*(t.y*i.mag-t.mag*i.y))+(t.x*(e.y*n.mag-e.mag*n.y)-e.x*(t.y*n.mag-t.mag*n.y)+n.x*(t.y*e.mag-t.mag*e.y))-(t.x*(e.y*i.mag-e.mag*i.y)-e.x*(t.y*i.mag-t.mag*i.y)+i.x*(t.y*e.mag-t.mag*e.y))},Le.optimise=function(t){var e,i=t.vertices,n=t.vertices;if(null!=i)for(var r=i;;){var o=r;if(o.sort(),o.mag=o.x*o.x+o.y*o.y,(r=r.next)==n)break}null==Le.edgeSet&&(null==jn.zpp_pool?Le.edgeSet=new jn:(Le.edgeSet=jn.zpp_pool,jn.zpp_pool=Le.edgeSet.next,Le.edgeSet.next=null),Le.edgeSet.lt=Ge.edge_lt,Le.edgeSet.swapped=Ge.edge_swap),null==Ge.zpp_pool?e=new Ge:(e=Ge.zpp_pool,Ge.zpp_pool=e.next,e.next=null);var i=t.vertices,s=t.vertices;if(null!=i)for(var a=i;;){var h=a,l=h.next;h.diagonals.reverse();for(var p=h.diagonals.head;null!=p;){var u,d,c=p.elt;c.id<h.id?(l=c,p=p.next):(Le.delaunay(h,l,c,null==p.next?h.prev:p.next.elt)||(null==Ge.zpp_pool?u=new Ge:(u=Ge.zpp_pool,Ge.zpp_pool=u.next,u.next=null),u.a=h,u.b=c,h.id<c.id?(u.id=h.id,u.di=c.id):(u.id=c.id,u.di=h.id),d=u,e.add(d),d.node=Le.edgeSet.insert(d)),l=c,p=p.next)}if((a=a.next)==s)break}for(;null!=e.next;){for(var y=e.pop_unsafe(),_=y.a,m=y.b,g=_.next,f=null,x=_.diagonals.head;null!=x;){var v=x.elt;if(v==m){f=null==(x=x.next)?_.prev:x.elt;break}g=v,x=x.next}if(_.diagonals.remove(m),m.diagonals.remove(_),m==g.next)g.diagonals.add(f);else for(var w=g.diagonals.head;null!=w;){if(w.elt==m){g.diagonals.insert(w,f);break}w=w.next}if(_==f.next)f.diagonals.add(g);else for(var z=f.diagonals.head;null!=z;){if(z.elt==_){f.diagonals.insert(z,g);break}z=z.next}Le.edgeSet.remove_node(y.node),y.a=y.b=null,y.node=null,y.next=Ge.zpp_pool,Ge.zpp_pool=y}i=e;i.a=i.b=null,i.node=null,i.next=Ge.zpp_pool,Ge.zpp_pool=i},Le.triangulate=function(t){var e=t.vertices,i=t.vertices,n=t.vertices.next,r=t.vertices;if(null!=n)for(var o=n;;){var s=o;if((s.y<e.y||s.y==e.y&&s.x<e.x)&&(e=s),(i.y<s.y||i.y==s.y&&i.x<s.x)&&(i=s),(o=o.next)==r)break}null==Le.queue&&(Le.queue=new bi);var a=i.prev,h=i.next;for(Le.queue.add(i);a!=e||h!=e;)a==e||h!=e&&(a.y<h.y||a.y==h.y&&a.x<h.x)?(Le.queue.add(h),h.rightchain=!1,h=h.next):(Le.queue.add(a),a.rightchain=!0,a=a.prev);Le.queue.add(e),null==Le.stack&&(Le.stack=new bi),Le.stack.add(Le.queue.pop_unsafe());var l=Le.queue.pop_unsafe();for(Le.stack.add(l);;){var p=Le.queue.pop_unsafe();if(null==Le.queue.head)break;if(p.rightchain!=Le.stack.head.elt.rightchain){for(;;){var u=Le.stack.pop_unsafe();if(null==Le.stack.head)break;t.add_diagonal(u,p)}Le.stack.add(l)}else{for(var d=Le.stack.pop_unsafe();null!=Le.stack.head;){var c=Le.stack.head.elt,y=p.x-d.x,_=p.y-d.y,m=d.x-c.x,_=(d.y-c.y)*y-m*_;if(p.rightchain&&0<=_||!p.rightchain&&_<=0)break;t.add_diagonal(c,p),d=c,Le.stack.pop()}Le.stack.add(d)}Le.stack.add(p),l=p}if(null!=Le.stack.head)for(Le.stack.pop();null!=Le.stack.head;){var g=Le.stack.pop_unsafe();if(null==Le.stack.head)break;t.add_diagonal(i,g)}return t},Le.prototype.__class__=Le;var Gr=zpp_nape.geom.ZPP_Vec2=function(){this.y=0,this.x=0,this.length=0,this.pushmod=!1,this.modified=!1,this._inuse=!1,this.next=null,this.weak=!1,this.outer=null,this._isimmutable=null,this._immutable=!1,this._validate=null,this._invalidate=null};Gr.__name__=["zpp_nape","geom","ZPP_Vec2"],Gr.get=function(t,e,i){var n;return null==i&&(i=!1),null==Gr.zpp_pool?n=new Gr:(n=Gr.zpp_pool,Gr.zpp_pool=n.next,n.next=null),n.weak=!1,n._immutable=i,n.x=t,n.y=e,n},Gr.prototype._invalidate=null,Gr.prototype._validate=null,Gr.prototype.validate=function(){null!=this._validate&&this._validate()},Gr.prototype.invalidate=function(){null!=this._invalidate&&this._invalidate(this)},Gr.prototype._immutable=null,Gr.prototype._isimmutable=null,Gr.prototype.immutable=function(){},Gr.prototype.outer=null,Gr.prototype.wrapper=function(){var t;return null==this.outer&&(this.outer=new St,null!=(t=this.outer.zpp_inner).outer&&(t.outer.zpp_inner=null,t.outer=null),t._isimmutable=null,t._validate=null,t._invalidate=null,t.next=Gr.zpp_pool,Gr.zpp_pool=t,this.outer.zpp_inner=this),this.outer},Gr.prototype.weak=null,Gr.prototype.free=function(){null!=this.outer&&(this.outer.zpp_inner=null,this.outer=null),this._isimmutable=null,this._validate=null,this._invalidate=null},Gr.prototype.alloc=function(){this.weak=!1},Gr.prototype.next=null,Gr.prototype.elem=function(){return this},Gr.prototype.begin=function(){return this.next},Gr.prototype._inuse=null,Gr.prototype.modified=null,Gr.prototype.pushmod=null,Gr.prototype.length=null,Gr.prototype.setbegin=function(t){this.next=t,this.modified=!0,this.pushmod=!0},Gr.prototype.add=function(t){return t._inuse=!0,t.next=this.next,this.next=t,this.modified=!0,this.length++,t},Gr.prototype.inlined_add=function(t){return t._inuse=!0,t.next=this.next,this.next=t,this.modified=!0,this.length++,t},Gr.prototype.addAll=function(t){for(var e=t.next;null!=e;)this.add(e),e=e.next},Gr.prototype.insert=function(t,e){return e._inuse=!0,null==t?(e.next=this.next,this.next=e):(e.next=t.next,t.next=e),this.pushmod=this.modified=!0,this.length++,e},Gr.prototype.inlined_insert=function(t,e){return e._inuse=!0,null==t?(e.next=this.next,this.next=e):(e.next=t.next,t.next=e),this.pushmod=this.modified=!0,this.length++,e},Gr.prototype.pop=function(){var t=this.next;this.next=t.next,t._inuse=!1,null==this.next&&(this.pushmod=!0),this.modified=!0,this.length--},Gr.prototype.inlined_pop=function(){var t=this.next;this.next=t.next,t._inuse=!1,null==this.next&&(this.pushmod=!0),this.modified=!0,this.length--},Gr.prototype.pop_unsafe=function(){var t=this.next;return this.pop(),t},Gr.prototype.inlined_pop_unsafe=function(){var t=this.next;return this.pop(),t},Gr.prototype.remove=function(t){for(var e,i,n=null,r=this.next;null!=r;){if(r==t){null==n?(i=(e=this.next).next,this.next=i,null==this.next&&(this.pushmod=!0)):(i=(e=n.next).next,null==(n.next=i)&&(this.pushmod=!0)),e._inuse=!1,this.modified=!0,this.length--,this.pushmod=!0;break}r=(n=r).next}},Gr.prototype.try_remove=function(t){for(var e=null,i=this.next,n=!1;null!=i;){if(i==t){this.erase(e),n=!0;break}i=(e=i).next}return n},Gr.prototype.inlined_remove=function(t){for(var e,i,n=null,r=this.next;null!=r;){if(r==t){null==n?(i=(e=this.next).next,this.next=i,null==this.next&&(this.pushmod=!0)):(i=(e=n.next).next,null==(n.next=i)&&(this.pushmod=!0)),e._inuse=!1,this.modified=!0,this.length--,this.pushmod=!0;break}r=(n=r).next}},Gr.prototype.inlined_try_remove=function(t){for(var e,i,n=null,r=this.next,o=!1;null!=r;){if(r==t){null==n?(i=(e=this.next).next,this.next=i,null==this.next&&(this.pushmod=!0)):(i=(e=n.next).next,null==(n.next=i)&&(this.pushmod=!0)),e._inuse=!1,this.modified=!0,this.length--,o=this.pushmod=!0;break}r=(n=r).next}return o},Gr.prototype.erase=function(t){var e,i;return null==t?(i=(e=this.next).next,this.next=i,null==this.next&&(this.pushmod=!0)):(i=(e=t.next).next,null==(t.next=i)&&(this.pushmod=!0)),e._inuse=!1,this.modified=!0,this.length--,this.pushmod=!0,i},Gr.prototype.inlined_erase=function(t){var e,i;return null==t?(i=(e=this.next).next,this.next=i,null==this.next&&(this.pushmod=!0)):(i=(e=t.next).next,null==(t.next=i)&&(this.pushmod=!0)),e._inuse=!1,this.modified=!0,this.length--,this.pushmod=!0,i},Gr.prototype.splice=function(t,e){for(;0<e--&&null!=t.next;)this.erase(t);return t.next},Gr.prototype.clear=function(){},Gr.prototype.inlined_clear=function(){},Gr.prototype.reverse=function(){for(var t=this.next,e=null;null!=t;){var i=t.next;t.next=e,e=this.next=t,t=i}this.modified=!0,this.pushmod=!0},Gr.prototype.empty=function(){return null==this.next},Gr.prototype.size=function(){return this.length},Gr.prototype.has=function(t){for(var e=!1,i=this.next;null!=i;){if(i==t){e=!0;break}i=i.next}return e},Gr.prototype.inlined_has=function(t){for(var e=!1,i=this.next;null!=i;){if(i==t){e=!0;break}i=i.next}return e},Gr.prototype.front=function(){return this.next},Gr.prototype.back=function(){for(var t=this.next,e=t;null!=e;)e=(t=e).next;return t},Gr.prototype.iterator_at=function(t){for(var e=this.next;0<t--&&null!=e;)e=e.next;return e},Gr.prototype.at=function(t){t=this.iterator_at(t);return null!=t?t:null},Gr.prototype.x=null,Gr.prototype.y=null,Gr.prototype.copy=function(){var t,e=this.x,i=this.y;return null==Gr.zpp_pool?t=new Gr:(t=Gr.zpp_pool,Gr.zpp_pool=t.next,t.next=null),t.weak=!1,t._immutable=!1,t.x=e,t.y=i,t},Gr.prototype.toString=function(){return"{ x: "+this.x+" y: "+this.y+" }"},Gr.prototype.__class__=Gr;var Re=zpp_nape.geom.ZPP_Vec3=function(){this._validate=null,this.immutable=!1,this.z=0,this.y=0,this.x=0,this.outer=null,this.immutable=!1,this._validate=null};Re.__name__=["zpp_nape","geom","ZPP_Vec3"],Re.prototype.outer=null,Re.prototype.x=null,Re.prototype.y=null,Re.prototype.z=null,Re.prototype.immutable=null,Re.prototype._validate=null,Re.prototype.validate=function(){null!=this._validate&&this._validate()},Re.prototype.__class__=Re;o=zpp_nape.geom.ZPP_VecMath=function(){};o.__name__=["zpp_nape","geom","ZPP_VecMath"],o.vec_dsq=function(t,e,i,n){var r=0,o=0;return(r=t-i)*r+(o=e-n)*o},o.vec_distance=function(t,e,i,n){i=t-i,n=e-n;return Math.sqrt(i*i+n*n)},o.prototype.__class__=o;var $n=zpp_nape.phys.ZPP_Interactor=function(){this.wrap_cbTypes=null,this.cbSet=null,this.cbTypes=null,this.group=null,this.cbsets=null,this.icompound=null,this.ibody=null,this.ishape=null,this.userData=null,this.id=0,this.outer_i=null,this.id=xt.Interactor(),this.cbsets=new pi,this.cbTypes=new Et};$n.__name__=["zpp_nape","phys","ZPP_Interactor"],$n.get=function(t,e){for(var i=(t.id<e.id?t:e).id,n=(t.id<e.id?e:t).id,r=null,o=(t.cbsets.length<e.cbsets.length?t:e).cbsets.head;null!=o;){var s=o.elt;if(s.id==i&&s.di==n){r=s;break}o=o.next}return r},$n.int_callback=function(t,e,i){var n=t.int1,r=t.int2,o=e.options1,t=n.cbTypes;!(!o.nonemptyintersection(t,o.includes)||o.nonemptyintersection(t,o.excludes))&&(o=e.options2,e=r.cbTypes,!!o.nonemptyintersection(e,o.includes)&&!o.nonemptyintersection(e,o.excludes))?(i.int1=n,i.int2=r):(i.int1=r,i.int2=n)},$n.prototype.outer_i=null,$n.prototype.id=null,$n.prototype.userData=null,$n.prototype.ishape=null,$n.prototype.ibody=null,$n.prototype.icompound=null,$n.prototype.isShape=function(){return null!=this.ishape},$n.prototype.isBody=function(){return null!=this.ibody},$n.prototype.isCompound=function(){return null!=this.icompound},$n.prototype.__iaddedToSpace=function(){null!=this.group&&this.group.interactors.add(this);for(var t=this.cbTypes.head;null!=t;)t.elt.interactors.add(this),t=t.next;this.alloc_cbSet()},$n.prototype.__iremovedFromSpace=function(){null!=this.group&&this.group.interactors.remove(this);for(var t=this.cbTypes.head;null!=t;)t.elt.interactors.remove(this),t=t.next;this.dealloc_cbSet()},$n.prototype.wake=function(){var t;null!=this.ishape?null!=(t=this.ishape.body)&&null!=t.space&&t.space.non_inlined_wake(t):null!=this.ibody?null!=this.ibody.space&&this.ibody.space.non_inlined_wake(this.ibody):null!=this.icompound.space&&this.icompound.space.wakeCompound(this.icompound)},$n.prototype.cbsets=null,$n.prototype.getSpace=function(){return null!=this.ishape?null==this.ishape.body?null:this.ishape.body.space:(null!=this.ibody?this.ibody:this.icompound).space},$n.prototype.group=null,$n.prototype.cbTypes=null,$n.prototype.cbSet=null,$n.prototype.wrap_cbTypes=null,$n.prototype.setupcbTypes=function(){this.wrap_cbTypes=Mn.get(this.cbTypes),this.wrap_cbTypes.zpp_inner.adder=Z(this,this.wrap_cbTypes_adder),this.wrap_cbTypes.zpp_inner.subber=Z(this,this.wrap_cbTypes_subber),this.wrap_cbTypes.zpp_inner.dontremove=!0},$n.prototype.wrap_cbTypes_subber=function(t){var e=t.zpp_inner;this.cbTypes.has(e)&&(null!=(t=null!=this.ishape?null==this.ishape.body?null:this.ishape.body.space:(null!=this.ibody?this.ibody:this.icompound).space)&&(this.dealloc_cbSet(),e.interactors.remove(this)),this.cbTypes.remove(e),null!=t&&(this.alloc_cbSet(),this.wake()))},$n.prototype.wrap_cbTypes_adder=function(t){return this.insert_cbtype(t.zpp_inner),!1},$n.prototype.insert_cbtype=function(t){if(!this.cbTypes.has(t)){var e=null!=this.ishape?null==this.ishape.body?null:this.ishape.body.space:(null!=this.ibody?this.ibody:this.icompound).space;null!=e&&(this.dealloc_cbSet(),t.interactors.add(this));for(var i=null,n=this.cbTypes.head;null!=n&&!(t.id<n.elt.id);)n=(i=n).next;var r=this.cbTypes;null==Ui.zpp_pool?o=new Ui:(o=Ui.zpp_pool,Ui.zpp_pool=o.next,o.next=null),o.elt=t;var o=o;null==i?(o.next=r.head,r.head=o):(o.next=i.next,i.next=o),r.pushmod=r.modified=!0,r.length++,null!=e&&(this.alloc_cbSet(),this.wake())}},$n.prototype.alloc_cbSet=function(){var t=null!=this.ishape?null==this.ishape.body?null:this.ishape.body.space:(null!=this.ibody?this.ibody:this.icompound).space;null!=(this.cbSet=t.cbsets.get(this.cbTypes))&&(this.cbSet.count++,this.cbSet.interactors.add(this),this.cbSet.validate(),t.freshInteractorType(this))},$n.prototype.dealloc_cbSet=function(){var t=null!=this.ishape?null==this.ishape.body?null:this.ishape.body.space:(null!=this.ibody?this.ibody:this.icompound).space;if(null!=this.cbSet){if(this.cbSet.interactors.remove(this),t.nullInteractorType(this),0==--this.cbSet.count){t.cbsets.remove(this.cbSet);var e=this.cbSet;for(e.listeners.clear(),e.zip_listeners=!0,e.bodylisteners.clear(),e.zip_bodylisteners=!0,e.conlisteners.clear(),e.zip_conlisteners=!0;null!=e.cbTypes.head;)e.cbTypes.pop_unsafe().cbsets.remove(e);e.next=Hn.zpp_pool,Hn.zpp_pool=e}this.cbSet=null}},$n.prototype.setGroup=function(t){var e;this.group!=t&&((e=null!=(null!=this.ishape?null==this.ishape.body?null:this.ishape.body.space:(null!=this.ibody?this.ibody:this.icompound).space))&&null!=this.group&&this.group.interactors.remove(this),this.group=t,e&&null!=t&&t.interactors.add(this),e&&(null!=this.ishape?this.ishape.body:null!=this.ibody?this.ibody:this.icompound).wake())},$n.prototype.immutable_midstep=function(t){null==this.ibody&&(null!=this.ishape?this.ishape.__immutable_midstep(t):this.icompound.__imutable_midstep(t))},$n.prototype.lookup_group=function(){for(var t=this;null!=t&&null==t.group;)t=null!=t.ishape?t.ishape.body:(null!=t.icompound?t.icompound:t.ibody).compound;return null==t?null:t.group},$n.prototype.copyto=function(t){t.zpp_inner_i.group=this.group;var e=this.outer_i;null==e.zpp_inner_i.wrap_cbTypes&&e.zpp_inner_i.setupcbTypes();e=e.zpp_inner_i.wrap_cbTypes;e.zpp_inner.valmod();for(var i=Vt.get(e);;){i.zpp_inner.zpp_inner.valmod();var n=i.zpp_inner;n.zpp_inner.valmod(),n.zpp_inner.zip_length&&(n.zpp_inner.zip_length=!1,n.zpp_inner.user_length=n.zpp_inner.inner.length);var r=n.zpp_inner.user_length;if(i.zpp_critical=!0,!(i.zpp_i<r||(i.zpp_next=Vt.zpp_pool,(Vt.zpp_pool=i).zpp_inner=null,!1)))break;i.zpp_critical=!1;n=i.zpp_inner.at(i.zpp_i++);null==t.zpp_inner_i.wrap_cbTypes&&t.zpp_inner_i.setupcbTypes();r=t.zpp_inner_i.wrap_cbTypes;r.zpp_inner.reverse_flag?r.push(n):r.unshift(n)}null!=this.userData&&(t.zpp_inner_i.userData=h.copy(this.userData))},$n.prototype.__class__=$n;var Fe=zpp_nape.phys.ZPP_Body=function(){var t;this.wrap_worldCOM=null,this.wrap_localCOM=null,this.zip_worldCOM=!1,this.worldCOMy=0,this.worldCOMx=0,this.zip_localCOM=!1,this.localCOMy=0,this.localCOMx=0,this.zip_aabb=!1,this.aabb=null,this.norotate=!1,this.sinertia=0,this.iinertia=0,this.cinertia=0,this.zip_inertia=!1,this.inertia=0,this.inertiaMode=0,this.zip_gravMassScale=!1,this.gravMassScale=0,this.gravMassMode=0,this.zip_gravMass=!1,this.gravMass=0,this.nomove=!1,this.cmass=0,this.smass=0,this.imass=0,this.massMode=0,this.zip_mass=!1,this.mass=0,this.zip_axis=!1,this.axisy=0,this.axisx=0,this.rot=0,this.pre_rot=0,this.kinangvel=0,this.torque=0,this.angvel=0,this.wrapcvel=null,this.wrap_svel=null,this.svely=0,this.svelx=0,this.wrap_kinvel=null,this.kinvely=0,this.kinvelx=0,this.wrap_force=null,this.forcey=0,this.forcex=0,this.wrap_vel=null,this.vely=0,this.velx=0,this.wrap_pos=null,this.posy=0,this.posx=0,this.pre_posy=0,this.pre_posx=0,this.disableCCD=!1,this.bulletEnabled=!1,this.bullet=!1,this.sweepRadius=0,this.sweepFrozen=!1,this.sweep_angvel=0,this.sweepTime=0,this.graph_depth=0,this.component=null,this.wrap_constraints=null,this.constraints=null,this.wrap_arbiters=null,this.arbiters=null,this.space=null,this.wrap_shapes=null,this.shapes=null,this.compound=null,this.type=0,this.world=!1,this.outer=null,$n.call(this),(this.ibody=this).world=!1,this.bulletEnabled=!1,this.sweepTime=0,this.sweep_angvel=0,this.norotate=this.nomove=!1,this.disableCCD=!1,this.posx=0,this.posy=0,this.rot=0,this.axisx=0,this.axisy=1,this.svelx=0,this.svely=0,this.velx=0,this.vely=0,this.kinvelx=0,this.kinvely=0,this.forcex=0,this.forcey=0,this.torque=this.angvel=this.kinangvel=0,this.pre_posx=1/0,this.pre_posy=1/0,this.pre_rot=1/0,this.localCOMx=0,this.localCOMy=0,this.worldCOMx=0,this.worldCOMy=0,this.zip_aabb=!0,null==De.zpp_pool?t=new De:(t=De.zpp_pool,De.zpp_pool=t.next,t.next=null),t.minx=0,t.miny=0,t.maxx=0,t.maxy=0,this.aabb=t,this.aabb._immutable=!0,this.aabb._validate=Z(this,this.aabb_validate),this.massMode=0,this.gravMassMode=0,this.gravMassScale=1,this.inertiaMode=0,this.arbiters=new yi,this.constraints=new Ct,this.shapes=new ui,this.wrap_shapes=In.get(this.shapes),this.wrap_shapes.zpp_inner.adder=Z(this,this.shapes_adder),this.wrap_shapes.zpp_inner.subber=Z(this,this.shapes_subber),this.wrap_shapes.zpp_inner._invalidate=Z(this,this.shapes_invalidate),this.kinematicDelaySleep=!1};Fe.__name__=["zpp_nape","phys","ZPP_Body"],Fe.__super__=$n,Fe.prototype=Object.create($n.prototype),Fe.bodysetlt=function(t,e){return t.id<e.id},Fe.__static=function(){null==Yn.BodyType_STATIC&&(Yn.internal=!0,Yn.BodyType_STATIC=new et,Yn.internal=!1);var t=new $(Yn.BodyType_STATIC),e=t.zpp_inner;return e.world=!0,e.wrap_shapes.zpp_inner.immutable=!0,e.smass=e.imass=e.cmass=e.mass=e.gravMass=0,e.sinertia=e.iinertia=e.cinertia=e.inertia=0,e.cbTypes.clear(),t},Fe.prototype.outer=null,Fe.prototype.world=null,Fe.prototype.type=null,Fe.prototype.isStatic=function(){return 1==this.type},Fe.prototype.isDynamic=function(){return 2==this.type},Fe.prototype.isKinematic=function(){return 3==this.type},Fe.prototype.invalidate_type=function(){this.invalidate_mass(),this.invalidate_inertia()},Fe.prototype.compound=null,Fe.prototype.shapes=null,Fe.prototype.wrap_shapes=null,Fe.prototype.invalidate_shapes=function(){this.zip_aabb=!0,this.zip_localCOM=!0,this.zip_worldCOM=!0,this.invalidate_mass(),this.invalidate_inertia()},Fe.prototype.space=null,Fe.prototype.arbiters=null,Fe.prototype.wrap_arbiters=null,Fe.prototype.constraints=null,Fe.prototype.wrap_constraints=null,Fe.prototype.component=null,Fe.prototype.graph_depth=null,Fe.prototype.init_bodysetlist=function(){null==Fe.bodyset&&(Fe.bodyset=new Rn,Fe.bodyset.lt=Fe.bodysetlt,Fe.bodystack=new di)},Fe.prototype.connectedBodies_cont=function(t){Fe.bodyset.try_insert_bool(t.zpp_inner)&&(Fe.bodystack.add(t.zpp_inner),t.zpp_inner.graph_depth=Fe.cur_graph_depth+1)},Fe.prototype.connectedBodies=function(t,e){null==Fe.bodyset&&(Fe.bodyset=new Rn,Fe.bodyset.lt=Fe.bodysetlt,Fe.bodystack=new di);var i=null==e?new tt:e;for(Fe.bodystack.add(this),Fe.bodyset.insert(this),this.graph_depth=0;null!=Fe.bodystack.head;){var n=Fe.bodystack.pop_unsafe();if(n.graph_depth!=t){Fe.cur_graph_depth=n.graph_depth;for(var r=n.constraints.head;null!=r;)r.elt.outer.visitBodies(Z(this,this.connectedBodies_cont)),r=r.next}}e=Fe.bodyset;if(null!=e.parent){for(var o,s,a=e.parent;null!=a;)a=null!=a.prev?a.prev:null!=a.next?a.next:((o=a.data)!=this&&(s=o.outer,i.zpp_inner.reverse_flag?i.push(s):i.unshift(s)),null!=(o=a.parent)&&(a==o.prev?o.prev=null:o.next=null,a.parent=null),(s=a).data=null,s.lt=null,s.swapped=null,s.next=Rn.zpp_pool,Rn.zpp_pool=s,o);e.parent=null}return i},Fe.prototype.interactingBodies=function(t,e,i){null==Fe.bodyset&&(Fe.bodyset=new Rn,Fe.bodyset.lt=Fe.bodysetlt,Fe.bodystack=new di);var n=null==i?new tt:i;for(Fe.bodyset.insert(this),Fe.bodystack.add(this),this.graph_depth=0;null!=Fe.bodystack.head;){var r=Fe.bodystack.pop_unsafe();if(r.graph_depth!=e)for(var o=r.arbiters.head;null!=o;){var s=o.elt;0!=(s.type&t)&&(s=s.b1==r?s.b2:s.b1,Fe.bodyset.try_insert_bool(s)&&(Fe.bodystack.add(s),s.graph_depth=r.graph_depth+1)),o=o.next}}i=Fe.bodyset;if(null!=i.parent){for(var a,h,l=i.parent;null!=l;)l=null!=l.prev?l.prev:null!=l.next?l.next:((a=l.data)!=this&&(h=a.outer,n.zpp_inner.reverse_flag?n.push(h):n.unshift(h)),null!=(a=l.parent)&&(l==a.prev?a.prev=null:a.next=null,l.parent=null),(h=l).data=null,h.lt=null,h.swapped=null,h.next=Rn.zpp_pool,Rn.zpp_pool=h,a);i.parent=null}return n},Fe.prototype.atRest=function(t){if(2!=this.type)return this.component.sleeping;var e,i,n,r,o=Er.linearSleepThreshold;return!(this.velx*this.velx+this.vely*this.vely>(o*=o))&&(e=this.posx,i=this.posy,r=n=0,!(.25*o*t*t<(n=e-this.pre_posx)*n+(r=i-this.pre_posy)*r)&&(r=i=0,i=(i=this.aabb.maxx-this.aabb.minx)*i+(r=this.aabb.maxy-this.aabb.miny)*r,r=Er.angularSleepThreshold,!(4*this.angvel*this.angvel*i>(r*=r))&&!(r*t*t<(t=this.rot-this.pre_rot)*t*i)))||(this.component.waket=this.space.stamp),this.component.waket+Er.sleepDelay<this.space.stamp},Fe.prototype.refreshArbiters=function(){for(var t=this.arbiters.head;null!=t;)t.elt.invalidated=!0,t=t.next},Fe.prototype.sweepTime=null,Fe.prototype.sweep_angvel=null,Fe.prototype.sweepFrozen=null,Fe.prototype.sweepRadius=null,Fe.prototype.bullet=null,Fe.prototype.bulletEnabled=null,Fe.prototype.disableCCD=null,Fe.prototype.sweepIntegrate=function(t){var e,i,n=t-this.sweepTime;0!=n&&(this.sweepTime=t,this.posx+=this.velx*n,this.posy+=this.vely*n,0!=this.angvel&&(e=this.sweep_angvel*n,this.rot+=e,1e-4<e*e?(this.axisx=Math.sin(this.rot),this.axisy=Math.cos(this.rot)):(i=((t=1-.5*(i=e*e))*this.axisx+e*this.axisy)*(n=1-i*i/8),this.axisy=(t*this.axisy-e*this.axisx)*n,this.axisx=i)))},Fe.prototype.sweepValidate=function(t){if(0==t.type)t.worldCOMx=this.posx+(this.axisy*t.localCOMx-this.axisx*t.localCOMy),t.worldCOMy=this.posy+(t.localCOMx*this.axisx+t.localCOMy*this.axisy);else{for(var e=t.polygon,i=e.lverts.next,n=e.gverts.next;null!=n;){var r=n,o=i,i=i.next;r.x=this.posx+(this.axisy*o.x-this.axisx*o.y),r.y=this.posy+(o.x*this.axisx+o.y*this.axisy),n=n.next}for(var s=e.edges.head,a=h=e.gverts.next,h=h.next;null!=h;){var l=h,p=s.elt,s=s.next;p.gnormx=this.axisy*p.lnormx-this.axisx*p.lnormy,p.gnormy=p.lnormx*this.axisx+p.lnormy*this.axisy,p.gprojection=this.posx*p.gnormx+this.posy*p.gnormy+p.lprojection,p.tp0=a.y*p.gnormx-a.x*p.gnormy,p.tp1=l.y*p.gnormx-l.x*p.gnormy,a=l,h=h.next}t=e.gverts.next,e=s.elt;e.gnormx=this.axisy*e.lnormx-this.axisx*e.lnormy,e.gnormy=e.lnormx*this.axisx+e.lnormy*this.axisy,e.gprojection=this.posx*e.gnormx+this.posy*e.gnormy+e.lprojection,e.tp0=a.y*e.gnormx-a.x*e.gnormy,e.tp1=t.y*e.gnormx-t.x*e.gnormy}},Fe.prototype.pre_posx=null,Fe.prototype.pre_posy=null,Fe.prototype.posx=null,Fe.prototype.posy=null,Fe.prototype.wrap_pos=null,Fe.prototype.velx=null,Fe.prototype.vely=null,Fe.prototype.wrap_vel=null,Fe.prototype.forcex=null,Fe.prototype.forcey=null,Fe.prototype.wrap_force=null,Fe.prototype.kinvelx=null,Fe.prototype.kinvely=null,Fe.prototype.wrap_kinvel=null,Fe.prototype.svelx=null,Fe.prototype.svely=null,Fe.prototype.wrap_svel=null,Fe.prototype.invalidate_pos=function(){for(var t=this.shapes.head;null!=t;){var e=t.elt;1==e.type&&(e.polygon.invalidate_gverts(),e.polygon.invalidate_gaxi()),e.invalidate_worldCOM(),t=t.next}this.zip_worldCOM=!0},Fe.prototype.pos_invalidate=function(t){if(this.immutable_midstep("Body::position"),this.posx!=t.x||this.posy!=t.y){this.posx=t.x,this.posy=t.y;for(var e=this.shapes.head;null!=e;){var i=e.elt;1==i.type&&(i.polygon.invalidate_gverts(),i.polygon.invalidate_gaxi()),i.invalidate_worldCOM(),e=e.next}this.zip_worldCOM=!0,this.wake()}},Fe.prototype.pos_validate=function(){this.wrap_pos.zpp_inner.x=this.posx,this.wrap_pos.zpp_inner.y=this.posy},Fe.prototype.vel_invalidate=function(t){this.velx=t.x,this.vely=t.y,this.wake()},Fe.prototype.vel_validate=function(){this.wrap_vel.zpp_inner.x=this.velx,this.wrap_vel.zpp_inner.y=this.vely},Fe.prototype.kinvel_invalidate=function(t){this.kinvelx=t.x,this.kinvely=t.y,this.wake()},Fe.prototype.kinvel_validate=function(){this.wrap_kinvel.zpp_inner.x=this.kinvelx,this.wrap_kinvel.zpp_inner.y=this.kinvely},Fe.prototype.svel_invalidate=function(t){this.svelx=t.x,this.svely=t.y,this.wake()},Fe.prototype.svel_validate=function(){this.wrap_svel.zpp_inner.x=this.svelx,this.wrap_svel.zpp_inner.y=this.svely},Fe.prototype.force_invalidate=function(t){this.forcex=t.x,this.forcey=t.y,this.wake()},Fe.prototype.force_validate=function(){this.wrap_force.zpp_inner.x=this.forcex,this.wrap_force.zpp_inner.y=this.forcey},Fe.prototype.setupPosition=function(){var t,e,i=this.posx,n=this.posy;null==Bn.poolVec2?t=new St:(t=Bn.poolVec2,Bn.poolVec2=t.zpp_pool,t.zpp_pool=null),null==t.zpp_inner?(null==Gr.zpp_pool?e=new Gr:(e=Gr.zpp_pool,Gr.zpp_pool=e.next,e.next=null),e.weak=!1,e._immutable=!1,e.x=i,e.y=n,t.zpp_inner=e,t.zpp_inner.outer=t):(null!=(e=t.zpp_inner)._validate&&e._validate(),t.zpp_inner.x==i&&(null!=(e=t.zpp_inner)._validate&&e._validate(),t.zpp_inner.y==n)||(t.zpp_inner.x=i,t.zpp_inner.y=n,null!=(n=t.zpp_inner)._invalidate&&n._invalidate(n))),t.zpp_inner.weak=!1,this.wrap_pos=t,this.wrap_pos.zpp_inner._inuse=!0,this.world?this.wrap_pos.zpp_inner._immutable=!0:(this.wrap_pos.zpp_inner._invalidate=Z(this,this.pos_invalidate),this.wrap_pos.zpp_inner._validate=Z(this,this.pos_validate))},Fe.prototype.setupVelocity=function(){var t,e,i=this.velx,n=this.vely;null==Bn.poolVec2?t=new St:(t=Bn.poolVec2,Bn.poolVec2=t.zpp_pool,t.zpp_pool=null),null==t.zpp_inner?(null==Gr.zpp_pool?e=new Gr:(e=Gr.zpp_pool,Gr.zpp_pool=e.next,e.next=null),e.weak=!1,e._immutable=!1,e.x=i,e.y=n,t.zpp_inner=e,t.zpp_inner.outer=t):(null!=(e=t.zpp_inner)._validate&&e._validate(),t.zpp_inner.x==i&&(null!=(e=t.zpp_inner)._validate&&e._validate(),t.zpp_inner.y==n)||(t.zpp_inner.x=i,t.zpp_inner.y=n,null!=(n=t.zpp_inner)._invalidate&&n._invalidate(n))),t.zpp_inner.weak=!1,this.wrap_vel=t,this.wrap_vel.zpp_inner._inuse=!0,this.world?this.wrap_vel.zpp_inner._immutable=!0:(this.wrap_vel.zpp_inner._invalidate=Z(this,this.vel_invalidate),this.wrap_vel.zpp_inner._validate=Z(this,this.vel_validate))},Fe.prototype.setupkinvel=function(){var t,e,i=this.kinvelx,n=this.kinvely;null==Bn.poolVec2?t=new St:(t=Bn.poolVec2,Bn.poolVec2=t.zpp_pool,t.zpp_pool=null),null==t.zpp_inner?(null==Gr.zpp_pool?e=new Gr:(e=Gr.zpp_pool,Gr.zpp_pool=e.next,e.next=null),e.weak=!1,e._immutable=!1,e.x=i,e.y=n,t.zpp_inner=e,t.zpp_inner.outer=t):(null!=(e=t.zpp_inner)._validate&&e._validate(),t.zpp_inner.x==i&&(null!=(e=t.zpp_inner)._validate&&e._validate(),t.zpp_inner.y==n)||(t.zpp_inner.x=i,t.zpp_inner.y=n,null!=(n=t.zpp_inner)._invalidate&&n._invalidate(n))),t.zpp_inner.weak=!1,this.wrap_kinvel=t,this.wrap_kinvel.zpp_inner._inuse=!0,this.world?this.wrap_kinvel.zpp_inner._immutable=!0:(this.wrap_kinvel.zpp_inner._invalidate=Z(this,this.kinvel_invalidate),this.wrap_kinvel.zpp_inner._validate=Z(this,this.kinvel_validate))},Fe.prototype.setupsvel=function(){var t,e,i=this.svelx,n=this.svely;null==Bn.poolVec2?t=new St:(t=Bn.poolVec2,Bn.poolVec2=t.zpp_pool,t.zpp_pool=null),null==t.zpp_inner?(null==Gr.zpp_pool?e=new Gr:(e=Gr.zpp_pool,Gr.zpp_pool=e.next,e.next=null),e.weak=!1,e._immutable=!1,e.x=i,e.y=n,t.zpp_inner=e,t.zpp_inner.outer=t):(null!=(e=t.zpp_inner)._validate&&e._validate(),t.zpp_inner.x==i&&(null!=(e=t.zpp_inner)._validate&&e._validate(),t.zpp_inner.y==n)||(t.zpp_inner.x=i,t.zpp_inner.y=n,null!=(n=t.zpp_inner)._invalidate&&n._invalidate(n))),t.zpp_inner.weak=!1,this.wrap_svel=t,this.wrap_svel.zpp_inner._inuse=!0,this.world?this.wrap_svel.zpp_inner._immutable=!0:(this.wrap_svel.zpp_inner._invalidate=Z(this,this.svel_invalidate),this.wrap_svel.zpp_inner._validate=Z(this,this.svel_validate))},Fe.prototype.setupForce=function(){var t,e,i=this.forcex,n=this.forcey;null==Bn.poolVec2?t=new St:(t=Bn.poolVec2,Bn.poolVec2=t.zpp_pool,t.zpp_pool=null),null==t.zpp_inner?(null==Gr.zpp_pool?e=new Gr:(e=Gr.zpp_pool,Gr.zpp_pool=e.next,e.next=null),e.weak=!1,e._immutable=!1,e.x=i,e.y=n,t.zpp_inner=e,t.zpp_inner.outer=t):(null!=(e=t.zpp_inner)._validate&&e._validate(),t.zpp_inner.x==i&&(null!=(e=t.zpp_inner)._validate&&e._validate(),t.zpp_inner.y==n)||(t.zpp_inner.x=i,t.zpp_inner.y=n,null!=(n=t.zpp_inner)._invalidate&&n._invalidate(n))),t.zpp_inner.weak=!1,this.wrap_force=t,this.wrap_force.zpp_inner._inuse=!0,this.world?this.wrap_force.zpp_inner._immutable=!0:(this.wrap_force.zpp_inner._invalidate=Z(this,this.force_invalidate),this.wrap_force.zpp_inner._validate=Z(this,this.force_validate))},Fe.prototype.cvel_validate=function(){this.wrapcvel.zpp_inner.x=this.velx+this.kinvelx,this.wrapcvel.zpp_inner.y=this.vely+this.kinvely,this.wrapcvel.zpp_inner.z=this.angvel+this.kinangvel},Fe.prototype.wrapcvel=null,Fe.prototype.setup_cvel=function(){this.wrapcvel=K.get(),this.wrapcvel.zpp_inner.immutable=!0,this.wrapcvel.zpp_inner._validate=Z(this,this.cvel_validate)},Fe.prototype.angvel=null,Fe.prototype.torque=null,Fe.prototype.kinangvel=null,Fe.prototype.pre_rot=null,Fe.prototype.rot=null,Fe.prototype.invalidate_rot=function(){this.zip_axis=!0;for(var t=this.shapes.head;null!=t;){var e=t.elt;1==e.type&&(e.polygon.invalidate_gverts(),e.polygon.invalidate_gaxi()),e.invalidate_worldCOM(),t=t.next}this.zip_worldCOM=!0},Fe.prototype.axisx=null,Fe.prototype.axisy=null,Fe.prototype.zip_axis=null,Fe.prototype.validate_axis=function(){this.zip_axis&&(this.zip_axis=!1,this.axisx=Math.sin(this.rot),this.axisy=Math.cos(this.rot))},Fe.prototype.quick_validate_axis=function(){this.axisx=Math.sin(this.rot),this.axisy=Math.cos(this.rot)},Fe.prototype.delta_rot=function(t){var e,i,n;this.rot+=t,1e-4<t*t?(this.axisx=Math.sin(this.rot),this.axisy=Math.cos(this.rot)):(n=((e=1-.5*(n=t*t))*this.axisx+t*this.axisy)*(i=1-n*n/8),this.axisy=(e*this.axisy-t*this.axisx)*i,this.axisx=n)},Fe.prototype.kinematicDelaySleep=null,Fe.prototype.mass=null,Fe.prototype.zip_mass=null,Fe.prototype.massMode=null,Fe.prototype.imass=null,Fe.prototype.smass=null,Fe.prototype.cmass=null,Fe.prototype.nomove=null,Fe.prototype.invalidate_mass=function(){this.zip_mass=!0,this.invalidate_gravMass()},Fe.prototype.validate_mass=function(){if(this.zip_mass||(this.massMode,0)){if(this.zip_mass=!1,0==this.massMode){this.cmass=0;for(var t=this.shapes.head;null!=t;){var e=t.elt;e.refmaterial.density=e.material.density,e.validate_area_inertia(),this.cmass+=e.area*e.material.density,t=t.next}}2!=this.type||this.nomove?(this.mass=1/0,this.imass=this.smass=0):(this.mass=this.cmass,this.imass=this.smass=1/this.mass)}},Fe.prototype.gravMass=null,Fe.prototype.zip_gravMass=null,Fe.prototype.gravMassMode=null,Fe.prototype.gravMassScale=null,Fe.prototype.zip_gravMassScale=null,Fe.prototype.invalidate_gravMass=function(){1!=this.gravMassMode&&(this.zip_gravMass=!0),2!=this.gravMassMode&&(this.zip_gravMassScale=!0),this.wake()},Fe.prototype.validate_gravMass=function(){this.zip_gravMass&&(this.zip_gravMass=!1,this.validate_mass(),0==this.gravMassMode?(this.validate_mass(),this.gravMass=this.cmass):2==this.gravMassMode&&(this.validate_mass(),this.gravMass=this.cmass*this.gravMassScale))},Fe.prototype.invalidate_gravMassScale=function(){2!=this.gravMassMode?this.zip_gravMassScale=!0:this.invalidate_gravMass()},Fe.prototype.validate_gravMassScale=function(){this.zip_gravMassScale&&(this.zip_gravMassScale=!1,0==this.gravMassMode?this.gravMassScale=1:1==this.gravMassMode&&(this.validate_mass(),this.gravMassScale=this.gravMass/this.cmass))},Fe.prototype.inertiaMode=null,Fe.prototype.inertia=null,Fe.prototype.zip_inertia=null,Fe.prototype.cinertia=null,Fe.prototype.iinertia=null,Fe.prototype.sinertia=null,Fe.prototype.norotate=null,Fe.prototype.invalidate_inertia=function(){this.zip_inertia=!0,this.wake()},Fe.prototype.validate_inertia=function(){if(this.zip_inertia||(this.inertiaMode,0)){if(this.zip_inertia=!1,0==this.inertiaMode){this.cinertia=0;for(var t=this.shapes.head;null!=t;){var e=t.elt;e.refmaterial.density=e.material.density,e.validate_area_inertia(),this.cinertia+=e.inertia*e.area*e.material.density,t=t.next}}2!=this.type||this.norotate?(this.inertia=1/0,this.sinertia=this.iinertia=0):(this.inertia=this.cinertia,this.sinertia=this.iinertia=1/this.inertia)}},Fe.prototype.invalidate_wake=function(){this.wake()},Fe.prototype.aabb=null,Fe.prototype.zip_aabb=null,Fe.prototype.validate_aabb=function(){if(this.zip_aabb){this.zip_aabb=!1,this.aabb.minx=1/0,this.aabb.miny=1/0,this.aabb.maxx=-1/0,this.aabb.maxy=-1/0;for(var t=this.shapes.head;null!=t;){var e=t.elt;if(e.zip_aabb&&null!=e.body)if(e.zip_aabb=!1,0==e.type){var i=e.circle;if(i.zip_worldCOM&&null!=i.body){if(i.zip_worldCOM=!1,i.zip_localCOM){if(i.zip_localCOM=!1,1==i.type){var n=i.polygon;if(null==n.lverts.next.next)n.localCOMx=n.lverts.next.x,n.localCOMy=n.lverts.next.y;else if(null==n.lverts.next.next.next)n.localCOMx=n.lverts.next.x,n.localCOMy=n.lverts.next.y,n.localCOMx+=n.lverts.next.next.x,n.localCOMy+=n.lverts.next.next.y,n.localCOMx*=.5,n.localCOMy*=.5;else{n.localCOMx=0;var r=n.localCOMy=0,o=n.lverts.next,s=o,a=o=o.next;for(o=o.next;null!=o;){var h=o;r+=a.x*(h.y-s.y);var l=h.y*a.x-h.x*a.y;n.localCOMx+=(a.x+h.x)*l,n.localCOMy+=(a.y+h.y)*l,s=a,a=h,o=o.next}var p=o=n.lverts.next;r+=a.x*(p.y-s.y);var u=p.y*a.x-p.x*a.y;n.localCOMx+=(a.x+p.x)*u,n.localCOMy+=(a.y+p.y)*u;var s=a,d=o=o.next;r+=p.x*(d.y-s.y);u=d.y*p.x-d.x*p.y;n.localCOMx+=(p.x+d.x)*u,n.localCOMy+=(p.y+d.y)*u;d=r=1/(3*r);n.localCOMx*=d,n.localCOMy*=d}}null!=i.wrap_localCOM&&(i.wrap_localCOM.zpp_inner.x=i.localCOMx,i.wrap_localCOM.zpp_inner.y=i.localCOMy)}u=i.body;u.zip_axis&&(u.zip_axis=!1,u.axisx=Math.sin(u.rot),u.axisy=Math.cos(u.rot)),i.worldCOMx=i.body.posx+(i.body.axisy*i.localCOMx-i.body.axisx*i.localCOMy),i.worldCOMy=i.body.posy+(i.localCOMx*i.body.axisx+i.localCOMy*i.body.axisy)}d=i.radius,u=i.radius;i.aabb.minx=i.worldCOMx-d,i.aabb.miny=i.worldCOMy-u,i.aabb.maxx=i.worldCOMx+d,i.aabb.maxy=i.worldCOMy+u}else{var c=e.polygon;if(c.zip_gverts&&null!=c.body){c.zip_gverts=!1,c.validate_lverts();var y=c.body;y.zip_axis&&(y.zip_axis=!1,y.axisx=Math.sin(y.rot),y.axisy=Math.cos(y.rot));for(var _=c.lverts.next,m=c.gverts.next;null!=m;){var g=m,f=_,_=_.next;g.x=c.body.posx+(c.body.axisy*f.x-c.body.axisx*f.y),g.y=c.body.posy+(f.x*c.body.axisx+f.y*c.body.axisy),m=m.next}}y=c.gverts.next;c.aabb.minx=y.x,c.aabb.miny=y.y,c.aabb.maxx=y.x,c.aabb.maxy=y.y;for(var x=c.gverts.next.next;null!=x;){var v=x;v.x<c.aabb.minx&&(c.aabb.minx=v.x),v.x>c.aabb.maxx&&(c.aabb.maxx=v.x),v.y<c.aabb.miny&&(c.aabb.miny=v.y),v.y>c.aabb.maxy&&(c.aabb.maxy=v.y),x=x.next}}y=this.aabb,e=e.aabb;e.minx<y.minx&&(y.minx=e.minx),e.maxx>y.maxx&&(y.maxx=e.maxx),e.miny<y.miny&&(y.miny=e.miny),e.maxy>y.maxy&&(y.maxy=e.maxy),t=t.next}}},Fe.prototype.invalidate_aabb=function(){this.zip_aabb=!0},Fe.prototype.localCOMx=null,Fe.prototype.localCOMy=null,Fe.prototype.zip_localCOM=null,Fe.prototype.worldCOMx=null,Fe.prototype.worldCOMy=null,Fe.prototype.zip_worldCOM=null,Fe.prototype.wrap_localCOM=null,Fe.prototype.wrap_worldCOM=null,Fe.prototype.invalidate_localCOM=function(){this.zip_localCOM=!0,this.zip_worldCOM=!0},Fe.prototype.invalidate_worldCOM=function(){this.zip_worldCOM=!0},Fe.prototype.validate_localCOM=function(){if(this.zip_localCOM){this.zip_localCOM=!1;for(var t,e=0,i=0,n=0,r=this.shapes.head;null!=r;){var o=r.elt;if(o.zip_localCOM){if(o.zip_localCOM=!1,1==o.type){var s=o.polygon;if(null==s.lverts.next.next)s.localCOMx=s.lverts.next.x,s.localCOMy=s.lverts.next.y;else if(null==s.lverts.next.next.next)s.localCOMx=s.lverts.next.x,s.localCOMy=s.lverts.next.y,s.localCOMx+=s.lverts.next.next.x,s.localCOMy+=s.lverts.next.next.y,s.localCOMx*=.5,s.localCOMy*=.5;else{s.localCOMx=0;var a=s.localCOMy=0,h=s.lverts.next,l=h,p=h=h.next;for(h=h.next;null!=h;){var u=h;a+=p.x*(u.y-l.y);var d=u.y*p.x-u.x*p.y;s.localCOMx+=(p.x+u.x)*d,s.localCOMy+=(p.y+u.y)*d,l=p,p=u,h=h.next}var c=h=s.lverts.next;a+=p.x*(c.y-l.y);var y=c.y*p.x-c.x*p.y;s.localCOMx+=(p.x+c.x)*y,s.localCOMy+=(p.y+c.y)*y;var l=p,_=h=h.next;a+=c.x*(_.y-l.y);y=_.y*c.x-_.x*c.y;s.localCOMx+=(c.x+_.x)*y,s.localCOMy+=(c.y+_.y)*y;y=a=1/(3*a);s.localCOMx*=y,s.localCOMy*=y}}null!=o.wrap_localCOM&&(o.wrap_localCOM.zpp_inner.x=o.localCOMx,o.wrap_localCOM.zpp_inner.y=o.localCOMy)}o.validate_area_inertia();y=o.area*o.material.density;e+=o.localCOMx*y,i+=o.localCOMy*y,n+=o.area*o.material.density,r=r.next}0!=n&&(this.localCOMx=e*(t=1/n),this.localCOMy=i*t),null!=this.wrap_localCOM&&(this.wrap_localCOM.zpp_inner.x=this.localCOMx,this.wrap_localCOM.zpp_inner.y=this.localCOMy),this.zip_mass&&0==this.massMode&&(this.zip_mass=!1,this.cmass=n,2==this.type?(this.mass=this.cmass,this.imass=this.smass=1/this.mass):(this.mass=1/0,this.imass=this.smass=0))}},Fe.prototype.validate_worldCOM=function(){this.zip_worldCOM&&(this.zip_worldCOM=!1,this.validate_localCOM(),this.zip_axis&&(this.zip_axis=!1,this.axisx=Math.sin(this.rot),this.axisy=Math.cos(this.rot)),this.worldCOMx=this.posx+(this.axisy*this.localCOMx-this.axisx*this.localCOMy),this.worldCOMy=this.posy+(this.localCOMx*this.axisx+this.localCOMy*this.axisy),null!=this.wrap_worldCOM&&(this.wrap_worldCOM.zpp_inner.x=this.worldCOMx,this.wrap_worldCOM.zpp_inner.y=this.worldCOMy))},Fe.prototype.getlocalCOM=function(){this.validate_localCOM()},Fe.prototype.getworldCOM=function(){this.validate_worldCOM()},Fe.prototype.__immutable_midstep=function(t){},Fe.prototype.clear=function(){for(;null!=this.shapes.head;){var t=this.shapes.pop_unsafe();t.removedFromBody(),t.body=null}this.invalidate_shapes(),this.pre_posx=0,this.pre_posy=0,this.posx=0,this.posy=0,this.velx=0,this.vely=0,this.forcex=0,this.forcey=0,this.kinvelx=0,this.kinvely=0,this.svelx=0,this.svely=0,this.angvel=this.torque=this.kinangvel=this.pre_rot=this.rot=0;for(var e=this.shapes.head;null!=e;){var i=e.elt;1==i.type&&(i.polygon.invalidate_gverts(),i.polygon.invalidate_gaxi()),i.invalidate_worldCOM(),e=e.next}this.zip_worldCOM=!0,this.zip_axis=!0;for(var n=this.shapes.head;null!=n;){var r=n.elt;1==r.type&&(r.polygon.invalidate_gverts(),r.polygon.invalidate_gaxi()),r.invalidate_worldCOM(),n=n.next}this.zip_worldCOM=!0,this.axisx=0,this.axisy=1,this.zip_axis=!1,this.massMode=0,this.gravMassMode=0,this.gravMassScale=1,this.inertiaMode=0,this.norotate=!1,this.nomove=!1},Fe.prototype.aabb_validate=function(){if(this.zip_aabb){this.zip_aabb=!1,this.aabb.minx=1/0,this.aabb.miny=1/0,this.aabb.maxx=-1/0,this.aabb.maxy=-1/0;for(var t=this.shapes.head;null!=t;){var e=t.elt;if(e.zip_aabb&&null!=e.body)if(e.zip_aabb=!1,0==e.type){var i=e.circle;if(i.zip_worldCOM&&null!=i.body){if(i.zip_worldCOM=!1,i.zip_localCOM){if(i.zip_localCOM=!1,1==i.type){var n=i.polygon;if(null==n.lverts.next.next)n.localCOMx=n.lverts.next.x,n.localCOMy=n.lverts.next.y;else if(null==n.lverts.next.next.next)n.localCOMx=n.lverts.next.x,n.localCOMy=n.lverts.next.y,n.localCOMx+=n.lverts.next.next.x,n.localCOMy+=n.lverts.next.next.y,n.localCOMx*=.5,n.localCOMy*=.5;else{n.localCOMx=0;var r=n.localCOMy=0,o=n.lverts.next,s=o,a=o=o.next;for(o=o.next;null!=o;){var h=o;r+=a.x*(h.y-s.y);var l=h.y*a.x-h.x*a.y;n.localCOMx+=(a.x+h.x)*l,n.localCOMy+=(a.y+h.y)*l,s=a,a=h,o=o.next}var p=o=n.lverts.next;r+=a.x*(p.y-s.y);var u=p.y*a.x-p.x*a.y;n.localCOMx+=(a.x+p.x)*u,n.localCOMy+=(a.y+p.y)*u;var s=a,d=o=o.next;r+=p.x*(d.y-s.y);u=d.y*p.x-d.x*p.y;n.localCOMx+=(p.x+d.x)*u,n.localCOMy+=(p.y+d.y)*u;d=r=1/(3*r);n.localCOMx*=d,n.localCOMy*=d}}null!=i.wrap_localCOM&&(i.wrap_localCOM.zpp_inner.x=i.localCOMx,i.wrap_localCOM.zpp_inner.y=i.localCOMy)}u=i.body;u.zip_axis&&(u.zip_axis=!1,u.axisx=Math.sin(u.rot),u.axisy=Math.cos(u.rot)),i.worldCOMx=i.body.posx+(i.body.axisy*i.localCOMx-i.body.axisx*i.localCOMy),i.worldCOMy=i.body.posy+(i.localCOMx*i.body.axisx+i.localCOMy*i.body.axisy)}d=i.radius,u=i.radius;i.aabb.minx=i.worldCOMx-d,i.aabb.miny=i.worldCOMy-u,i.aabb.maxx=i.worldCOMx+d,i.aabb.maxy=i.worldCOMy+u}else{var c=e.polygon;if(c.zip_gverts&&null!=c.body){c.zip_gverts=!1,c.validate_lverts();var y=c.body;y.zip_axis&&(y.zip_axis=!1,y.axisx=Math.sin(y.rot),y.axisy=Math.cos(y.rot));for(var _=c.lverts.next,m=c.gverts.next;null!=m;){var g=m,f=_,_=_.next;g.x=c.body.posx+(c.body.axisy*f.x-c.body.axisx*f.y),g.y=c.body.posy+(f.x*c.body.axisx+f.y*c.body.axisy),m=m.next}}y=c.gverts.next;c.aabb.minx=y.x,c.aabb.miny=y.y,c.aabb.maxx=y.x,c.aabb.maxy=y.y;for(var x=c.gverts.next.next;null!=x;){var v=x;v.x<c.aabb.minx&&(c.aabb.minx=v.x),v.x>c.aabb.maxx&&(c.aabb.maxx=v.x),v.y<c.aabb.miny&&(c.aabb.miny=v.y),v.y>c.aabb.maxy&&(c.aabb.maxy=v.y),x=x.next}}y=this.aabb,e=e.aabb;e.minx<y.minx&&(y.minx=e.minx),e.maxx>y.maxx&&(y.maxx=e.maxx),e.miny<y.miny&&(y.miny=e.miny),e.maxy>y.maxy&&(y.maxy=e.maxy),t=t.next}}},Fe.prototype.shapes_adder=function(t){return t.zpp_inner.body!=this&&(null!=t.zpp_inner.body&&t.zpp_inner.body.wrap_shapes.remove(t),t.zpp_inner.body=this,t.zpp_inner.addedToBody(),null!=this.space&&(e=this.space,(n=(i=t.zpp_inner).body).world||(n.component.waket=e.stamp+(e.midstep?0:1),3==n.type&&(n.kinematicDelaySleep=!0),n.component.sleeping&&e.really_wake(n,!1)),e.bphase.insert(i),i.addedToSpace()),1==t.zpp_inner.type&&(t.zpp_inner.polygon.invalidate_gaxi(),t.zpp_inner.polygon.invalidate_gverts()),!0);var e,i,n},Fe.prototype.shapes_subber=function(t){null!=this.space&&this.space.removed_shape(t.zpp_inner),t.zpp_inner.body=null,t.zpp_inner.removedFromBody()},Fe.prototype.shapes_invalidate=function(t){this.invalidate_shapes()},Fe.prototype.addedToSpace=function(){null==ti.zpp_pool?this.component=new ti:(this.component=ti.zpp_pool,ti.zpp_pool=this.component.next,this.component.next=null),this.component.isBody=!0,(this.component.body=this).__iaddedToSpace()},Fe.prototype.removedFromSpace=function(){for(;null!=this.arbiters.head;){var t=this.arbiters.pop_unsafe();if(t.cleared=!0,t.b2==this)for(var e,i,n=t.b1.arbiters,r=null,o=n.head;null!=o;){if(o.elt==t){null==r?(i=(e=n.head).next,n.head=i,null==n.head&&(n.pushmod=!0)):(i=(e=r.next).next,null==(r.next=i)&&(n.pushmod=!0));var s=e;s.elt=null,s.next=er.zpp_pool,er.zpp_pool=s,n.modified=!0,n.length--,n.pushmod=!0;break}o=(r=o).next}if(t.b1==this)for(var a,h,l=t.b2.arbiters,p=null,u=l.head;null!=u;){if(u.elt==t){null==p?(h=(a=l.head).next,l.head=h,null==l.head&&(l.pushmod=!0)):(h=(a=p.next).next,null==(p.next=h)&&(l.pushmod=!0));var d=a;d.elt=null,d.next=er.zpp_pool,er.zpp_pool=d,l.modified=!0,l.length--,l.pushmod=!0;break}u=(p=u).next}null!=t.pair&&(t.pair.arb=null,t.pair=null),t.active=!1,this.space.f_arbiters.modified=!0}var c=this.component;c.body=null,c.constraint=null,c.next=ti.zpp_pool,ti.zpp_pool=c,this.component=null,this.__iremovedFromSpace()},Fe.prototype.copy=function(){var t=(new $).zpp_inner;t.type=this.type,t.bulletEnabled=this.bulletEnabled,t.disableCCD=this.disableCCD;for(var e=this.shapes.head;null!=e;){var i=t.outer.zpp_inner.wrap_shapes,n=e.elt.outer.copy();i.zpp_inner.reverse_flag?i.push(n):i.unshift(n),e=e.next}if(t.posx=this.posx,t.posy=this.posy,t.velx=this.velx,t.vely=this.vely,t.forcex=this.forcex,t.forcey=this.forcey,t.rot=this.rot,t.angvel=this.angvel,t.torque=this.torque,t.kinvelx=this.kinvelx,t.kinvely=this.kinvely,t.kinangvel=this.kinangvel,t.svelx=this.svelx,t.svely=this.svely,this.zip_axis){t.zip_axis=!0;for(var r=t.shapes.head;null!=r;){var o=r.elt;1==o.type&&(o.polygon.invalidate_gverts(),o.polygon.invalidate_gaxi()),o.invalidate_worldCOM(),r=r.next}t.zip_worldCOM=!0}else t.axisx=this.axisx,t.axisy=this.axisy;return t.rot=this.rot,t.massMode=this.massMode,t.gravMassMode=this.gravMassMode,t.inertiaMode=this.inertiaMode,t.norotate=this.norotate,t.nomove=this.nomove,t.cmass=this.cmass,t.cinertia=this.cinertia,this.zip_mass?t.invalidate_mass():t.mass=this.mass,this.zip_gravMass?t.invalidate_gravMass():t.gravMass=this.gravMass,this.zip_gravMassScale?t.invalidate_gravMassScale():t.gravMassScale=this.gravMassScale,this.zip_inertia?t.invalidate_inertia():t.inertia=this.inertia,this.zip_aabb?t.zip_aabb=!0:(t.aabb.minx=this.aabb.minx,t.aabb.miny=this.aabb.miny,t.aabb.maxx=this.aabb.maxx,t.aabb.maxy=this.aabb.maxy),this.zip_localCOM?(t.zip_localCOM=!0,t.zip_worldCOM=!0):(t.localCOMx=this.localCOMx,t.localCOMy=this.localCOMy),this.zip_worldCOM?t.zip_worldCOM=!0:(t.worldCOMx=this.worldCOMx,t.worldCOMy=this.worldCOMy),this.copyto(t.outer),t.outer},Fe.prototype.__class__=Fe;var Ne=zpp_nape.phys.ZPP_Compound=function(){this.space=null,this.compound=null,this.depth=0,this.wrap_compounds=null,this.wrap_constraints=null,this.wrap_bodies=null,this.compounds=null,this.constraints=null,this.bodies=null,this.outer=null,$n.call(this),(this.icompound=this).depth=1,this.bodies=new di,this.wrap_bodies=bn.get(this.bodies),this.wrap_bodies.zpp_inner.adder=Z(this,this.bodies_adder),this.wrap_bodies.zpp_inner.subber=Z(this,this.bodies_subber),this.constraints=new Ct,this.wrap_constraints=zn.get(this.constraints),this.wrap_constraints.zpp_inner.adder=Z(this,this.constraints_adder),this.wrap_constraints.zpp_inner.subber=Z(this,this.constraints_subber),this.compounds=new ci,this.wrap_compounds=Cn.get(this.compounds),this.wrap_compounds.zpp_inner.adder=Z(this,this.compounds_adder),this.wrap_compounds.zpp_inner.subber=Z(this,this.compounds_subber)};Ne.__name__=["zpp_nape","phys","ZPP_Compound"],Ne.__super__=$n,Ne.prototype=Object.create($n.prototype),Ne.prototype.outer=null,Ne.prototype.bodies=null,Ne.prototype.constraints=null,Ne.prototype.compounds=null,Ne.prototype.wrap_bodies=null,Ne.prototype.wrap_constraints=null,Ne.prototype.wrap_compounds=null,Ne.prototype.depth=null,Ne.prototype.compound=null,Ne.prototype.space=null,Ne.prototype.__imutable_midstep=function(t){},Ne.prototype.addedToSpace=function(){this.__iaddedToSpace()},Ne.prototype.removedFromSpace=function(){this.__iremovedFromSpace()},Ne.prototype.breakApart=function(){for(null!=this.space&&(this.__iremovedFromSpace(),this.space.nullInteractorType(this)),null!=this.compound?this.compound.compounds.remove(this):null!=this.space&&this.space.compounds.remove(this);null!=this.bodies.head;){var t=this.bodies.pop_unsafe();null!=(t.compound=this.compound)?this.compound.bodies.add(t):null!=this.space&&this.space.bodies.add(t),null!=this.space&&this.space.freshInteractorType(t)}for(;null!=this.constraints.head;){var e=this.constraints.pop_unsafe();null!=(e.compound=this.compound)?this.compound.constraints.add(e):null!=this.space&&this.space.constraints.add(e)}for(;null!=this.compounds.head;){var i=this.compounds.pop_unsafe();null!=(i.compound=this.compound)?this.compound.compounds.add(i):null!=this.space&&this.space.compounds.add(i),null!=this.space&&this.space.freshInteractorType(i)}this.compound=null,this.space=null},Ne.prototype.bodies_adder=function(t){return t.zpp_inner.compound!=this&&(null!=t.zpp_inner.compound?t.zpp_inner.compound.wrap_bodies.remove(t):null!=t.zpp_inner.space&&t.zpp_inner.space.wrap_bodies.remove(t),null!=(t.zpp_inner.compound=this).space&&this.space.addBody(t.zpp_inner),!0)},Ne.prototype.bodies_subber=function(t){(t.zpp_inner.compound=null)!=this.space&&this.space.remBody(t.zpp_inner)},Ne.prototype.constraints_adder=function(t){return t.zpp_inner.compound!=this&&(null!=t.zpp_inner.compound?t.zpp_inner.compound.wrap_constraints.remove(t):null!=t.zpp_inner.space&&t.zpp_inner.space.wrap_constraints.remove(t),null!=(t.zpp_inner.compound=this).space&&this.space.addConstraint(t.zpp_inner),!0)},Ne.prototype.constraints_subber=function(t){(t.zpp_inner.compound=null)!=this.space&&this.space.remConstraint(t.zpp_inner)},Ne.prototype.compounds_adder=function(t){return t.zpp_inner.compound!=this&&(null!=t.zpp_inner.compound?t.zpp_inner.compound.wrap_compounds.remove(t):null!=t.zpp_inner.space&&t.zpp_inner.space.wrap_compounds.remove(t),t.zpp_inner.compound=this,t.zpp_inner.depth=this.depth+1,null!=this.space&&this.space.addCompound(t.zpp_inner),!0)},Ne.prototype.compounds_subber=function(t){t.zpp_inner.compound=null,t.zpp_inner.depth=1,null!=this.space&&this.space.remCompound(t.zpp_inner)},Ne.prototype.copy=function(t,e){var i=null==t;null==t&&(t=[]),null==e&&(e=[]);for(var n=new it,r=this.compounds.head;null!=r;){var o,s=r.elt.copy(t,e);s.zpp_inner.immutable_midstep("Compound::compound"),(null==s.zpp_inner.compound?null:s.zpp_inner.compound.outer)!=n&&(null!=(null==s.zpp_inner.compound?null:s.zpp_inner.compound.outer)&&(null==s.zpp_inner.compound?null:s.zpp_inner.compound.outer).zpp_inner.wrap_compounds.remove(s),null!=n&&((o=n.zpp_inner.wrap_compounds).zpp_inner.reverse_flag?o.push(s):o.unshift(s))),r=r.next}for(var a=this.bodies.head;null!=a;){var h=a.elt,l=h.outer.copy();t.push(Lt.dict(h.id,l)),(null==l.zpp_inner.compound?null:l.zpp_inner.compound.outer)!=n&&(null!=(null==l.zpp_inner.compound?null:l.zpp_inner.compound.outer)&&(null==l.zpp_inner.compound?null:l.zpp_inner.compound.outer).zpp_inner.wrap_bodies.remove(l),null!=n&&((h=n.zpp_inner.wrap_bodies).zpp_inner.reverse_flag?h.push(l):h.unshift(l))),a=a.next}for(var p=this.constraints.head;null!=p;){var u,d=p.elt.copy(t,e);(null==d.zpp_inner.compound?null:d.zpp_inner.compound.outer)!=n&&(null!=(null==d.zpp_inner.compound?null:d.zpp_inner.compound.outer)&&(null==d.zpp_inner.compound?null:d.zpp_inner.compound.outer).zpp_inner.wrap_constraints.remove(d),null!=n&&((u=n.zpp_inner.wrap_constraints).zpp_inner.reverse_flag?u.push(d):u.unshift(d))),p=p.next}if(i)for(;0<e.length;)for(var c=e.pop(),y=0;y<t.length;){var _=t[y];if(++y,_.id==c.id){c.cb(_.bc);break}}return this.copyto(n),n},Ne.prototype.__class__=Ne;var je=zpp_nape.phys.ZPP_FluidProperties=function(){this.wrap_gravity=null,this.gravityy=0,this.gravityx=0,this.density=0,this.viscosity=0,this.wrap_shapes=null,this.shapes=null,this.outer=null,this.userData=null,this.next=null,this.shapes=new ui,this.density=this.viscosity=1,this.wrap_gravity=null,this.gravityx=0,this.gravityy=0};je.__name__=["zpp_nape","phys","ZPP_FluidProperties"],je.prototype.next=null,je.prototype.userData=null,je.prototype.outer=null,je.prototype.wrapper=function(){var t;return null==this.outer&&(this.outer=new rt,(t=this.outer.zpp_inner).outer=null,t.next=je.zpp_pool,je.zpp_pool=t,this.outer.zpp_inner=this),this.outer},je.prototype.free=function(){this.outer=null},je.prototype.alloc=function(){},je.prototype.shapes=null,je.prototype.wrap_shapes=null,je.prototype.feature_cons=function(){this.shapes=new ui},je.prototype.addShape=function(t){this.shapes.add(t)},je.prototype.remShape=function(t){this.shapes.remove(t)},je.prototype.copy=function(){var t;return null==je.zpp_pool?t=new je:(t=je.zpp_pool,je.zpp_pool=t.next,t.next=null),t.viscosity=this.viscosity,t.density=this.density,t},je.prototype.viscosity=null,je.prototype.density=null,je.prototype.gravityx=null,je.prototype.gravityy=null,je.prototype.wrap_gravity=null,je.prototype.gravity_invalidate=function(t){this.gravityx=t.x,this.gravityy=t.y,this.invalidate()},je.prototype.gravity_validate=function(){this.wrap_gravity.zpp_inner.x=this.gravityx,this.wrap_gravity.zpp_inner.y=this.gravityy},je.prototype.getgravity=function(){var t,e,i=this.gravityx,n=this.gravityy;null==Bn.poolVec2?t=new St:(t=Bn.poolVec2,Bn.poolVec2=t.zpp_pool,t.zpp_pool=null),null==t.zpp_inner?(null==Gr.zpp_pool?e=new Gr:(e=Gr.zpp_pool,Gr.zpp_pool=e.next,e.next=null),e.weak=!1,e._immutable=!1,e.x=i,e.y=n,t.zpp_inner=e,t.zpp_inner.outer=t):(null!=(e=t.zpp_inner)._validate&&e._validate(),t.zpp_inner.x==i&&(null!=(e=t.zpp_inner)._validate&&e._validate(),t.zpp_inner.y==n)||(t.zpp_inner.x=i,t.zpp_inner.y=n,null!=(n=t.zpp_inner)._invalidate&&n._invalidate(n))),t.zpp_inner.weak=!1,this.wrap_gravity=t,this.wrap_gravity.zpp_inner._inuse=!0,this.wrap_gravity.zpp_inner._invalidate=Z(this,this.gravity_invalidate),this.wrap_gravity.zpp_inner._validate=Z(this,this.gravity_validate)},je.prototype.invalidate=function(){for(var t=this.shapes.head;null!=t;)t.elt.invalidate_fluidprops(),t=t.next},je.prototype.__class__=je;var Ue=zpp_nape.phys.ZPP_Material=function(){this.rollingFriction=0,this.elasticity=0,this.density=0,this.staticFriction=0,this.dynamicFriction=0,this.wrap_shapes=null,this.shapes=null,this.outer=null,this.userData=null,this.next=null,this.shapes=new ui,this.elasticity=0,this.dynamicFriction=1,this.staticFriction=2,this.density=.001,this.rollingFriction=.01};Ue.__name__=["zpp_nape","phys","ZPP_Material"],Ue.prototype.next=null,Ue.prototype.userData=null,Ue.prototype.outer=null,Ue.prototype.wrapper=function(){var t;return null==this.outer&&(this.outer=new lt,(t=this.outer.zpp_inner).outer=null,t.next=Ue.zpp_pool,Ue.zpp_pool=t,this.outer.zpp_inner=this),this.outer},Ue.prototype.free=function(){this.outer=null},Ue.prototype.alloc=function(){},Ue.prototype.shapes=null,Ue.prototype.wrap_shapes=null,Ue.prototype.feature_cons=function(){this.shapes=new ui},Ue.prototype.addShape=function(t){this.shapes.add(t)},Ue.prototype.remShape=function(t){this.shapes.remove(t)},Ue.prototype.dynamicFriction=null,Ue.prototype.staticFriction=null,Ue.prototype.density=null,Ue.prototype.elasticity=null,Ue.prototype.rollingFriction=null,Ue.prototype.copy=function(){var t=new Ue;return t.dynamicFriction=this.dynamicFriction,t.staticFriction=this.staticFriction,t.density=this.density,t.elasticity=this.elasticity,t.rollingFriction=this.rollingFriction,t},Ue.prototype.set=function(t){this.dynamicFriction=t.dynamicFriction,this.staticFriction=t.staticFriction,this.density=t.density,this.elasticity=t.elasticity,this.rollingFriction=t.rollingFriction},Ue.prototype.invalidate=function(t){for(var e=this.shapes.head;null!=e;)e.elt.invalidate_material(t),e=e.next},Ue.prototype.__class__=Ue;var Ve=zpp_nape.shape.ZPP_Shape=function(t){var e;this.zip_aabb=!1,this.aabb=null,this.pairs=null,this.node=null,this.sweep=null,this.sensorEnabled=!1,this.fluidEnabled=!1,this.fluidProperties=null,this.filter=null,this.material=null,this.refmaterial=null,this.polygon=null,this.circle=null,this.sweepCoef=0,this.zip_sweepRadius=!1,this.sweepRadius=0,this.wrap_worldCOM=null,this.wrap_localCOM=null,this.zip_worldCOM=!1,this.worldCOMy=0,this.worldCOMx=0,this.zip_localCOM=!1,this.localCOMy=0,this.localCOMx=0,this.zip_angDrag=!1,this.angDrag=0,this.inertia=0,this.zip_area_inertia=!1,this.area=0,this.type=0,this.body=null,this.outer=null,$n.call(this),this.pairs=new Ai,(this.ishape=this).type=t,null==De.zpp_pool?e=new De:(e=De.zpp_pool,De.zpp_pool=e.next,e.next=null),e.minx=0,e.miny=0,e.maxx=0,e.maxy=0,this.aabb=e,this.aabb._immutable=!0,this.aabb._validate=Z(this,this.aabb_validate),this.zip_area_inertia=this.zip_angDrag=this.zip_localCOM=this.zip_sweepRadius=!0,this.localCOMx=0,this.localCOMy=0,this.worldCOMx=0,this.worldCOMy=0,this.fluidEnabled=!1,this.sensorEnabled=!1,this.fluidProperties=null,this.body=null,this.refmaterial=new Ue,this.sweepRadius=this.sweepCoef=0};Ve.__name__=["zpp_nape","shape","ZPP_Shape"],Ve.__super__=$n,Ve.prototype=Object.create($n.prototype),Ve.prototype.outer=null,Ve.prototype.body=null,Ve.prototype.type=null,Ve.prototype.isCircle=function(){return 0==this.type},Ve.prototype.isPolygon=function(){return 1==this.type},Ve.prototype.area=null,Ve.prototype.zip_area_inertia=null,Ve.prototype.inertia=null,Ve.prototype.angDrag=null,Ve.prototype.zip_angDrag=null,Ve.prototype.localCOMx=null,Ve.prototype.localCOMy=null,Ve.prototype.zip_localCOM=null,Ve.prototype.worldCOMx=null,Ve.prototype.worldCOMy=null,Ve.prototype.zip_worldCOM=null,Ve.prototype.wrap_localCOM=null,Ve.prototype.wrap_worldCOM=null,Ve.prototype.sweepRadius=null,Ve.prototype.zip_sweepRadius=null,Ve.prototype.sweepCoef=null,Ve.prototype.invalidate_sweepRadius=function(){this.zip_sweepRadius=!0},Ve.prototype.validate_sweepRadius=function(){this.zip_sweepRadius&&(this.zip_sweepRadius=!1,(0==this.type?this.circle:this.polygon).__validate_sweepRadius())},Ve.prototype.circle=null,Ve.prototype.polygon=null,Ve.prototype.refmaterial=null,Ve.prototype.material=null,Ve.prototype.filter=null,Ve.prototype.fluidProperties=null,Ve.prototype.fluidEnabled=null,Ve.prototype.sensorEnabled=null,Ve.prototype.sweep=null,Ve.prototype.node=null,Ve.prototype.pairs=null,Ve.prototype.clear=function(){(0==this.type?this.circle:this.polygon).__clear()},Ve.prototype.aabb=null,Ve.prototype.zip_aabb=null,Ve.prototype.validate_aabb=function(){if(this.zip_aabb&&null!=this.body)if(this.zip_aabb=!1,0==this.type){var t=this.circle;if(t.zip_worldCOM&&null!=t.body){if(t.zip_worldCOM=!1,t.zip_localCOM){if(t.zip_localCOM=!1,1==t.type){var e=t.polygon;if(null==e.lverts.next.next)e.localCOMx=e.lverts.next.x,e.localCOMy=e.lverts.next.y;else if(null==e.lverts.next.next.next)e.localCOMx=e.lverts.next.x,e.localCOMy=e.lverts.next.y,e.localCOMx+=e.lverts.next.next.x,e.localCOMy+=e.lverts.next.next.y,e.localCOMx*=.5,e.localCOMy*=.5;else{e.localCOMx=0;var i=e.localCOMy=0,n=e.lverts.next,r=n,o=n=n.next;for(n=n.next;null!=n;){var s=n;i+=o.x*(s.y-r.y);var a=s.y*o.x-s.x*o.y;e.localCOMx+=(o.x+s.x)*a,e.localCOMy+=(o.y+s.y)*a,r=o,o=s,n=n.next}var h=n=e.lverts.next;i+=o.x*(h.y-r.y);var l=h.y*o.x-h.x*o.y;e.localCOMx+=(o.x+h.x)*l,e.localCOMy+=(o.y+h.y)*l;var r=o,p=n=n.next;i+=h.x*(p.y-r.y);l=p.y*h.x-p.x*h.y;e.localCOMx+=(h.x+p.x)*l,e.localCOMy+=(h.y+p.y)*l;p=i=1/(3*i);e.localCOMx*=p,e.localCOMy*=p}}null!=t.wrap_localCOM&&(t.wrap_localCOM.zpp_inner.x=t.localCOMx,t.wrap_localCOM.zpp_inner.y=t.localCOMy)}l=t.body;l.zip_axis&&(l.zip_axis=!1,l.axisx=Math.sin(l.rot),l.axisy=Math.cos(l.rot)),t.worldCOMx=t.body.posx+(t.body.axisy*t.localCOMx-t.body.axisx*t.localCOMy),t.worldCOMy=t.body.posy+(t.localCOMx*t.body.axisx+t.localCOMy*t.body.axisy)}p=t.radius,l=t.radius;t.aabb.minx=t.worldCOMx-p,t.aabb.miny=t.worldCOMy-l,t.aabb.maxx=t.worldCOMx+p,t.aabb.maxy=t.worldCOMy+l}else{var u=this.polygon;if(u.zip_gverts&&null!=u.body){u.zip_gverts=!1,u.validate_lverts();var d=u.body;d.zip_axis&&(d.zip_axis=!1,d.axisx=Math.sin(d.rot),d.axisy=Math.cos(d.rot));for(var c=u.lverts.next,y=u.gverts.next;null!=y;){var _=y,m=c,c=c.next;_.x=u.body.posx+(u.body.axisy*m.x-u.body.axisx*m.y),_.y=u.body.posy+(m.x*u.body.axisx+m.y*u.body.axisy),y=y.next}}d=u.gverts.next;u.aabb.minx=d.x,u.aabb.miny=d.y,u.aabb.maxx=d.x,u.aabb.maxy=d.y;for(var g=u.gverts.next.next;null!=g;){var f=g;f.x<u.aabb.minx&&(u.aabb.minx=f.x),f.x>u.aabb.maxx&&(u.aabb.maxx=f.x),f.y<u.aabb.miny&&(u.aabb.miny=f.y),f.y>u.aabb.maxy&&(u.aabb.maxy=f.y),g=g.next}}},Ve.prototype.force_validate_aabb=function(){if(0==this.type){var t=this.circle;t.worldCOMx=t.body.posx+(t.body.axisy*t.localCOMx-t.body.axisx*t.localCOMy),t.worldCOMy=t.body.posy+(t.localCOMx*t.body.axisx+t.localCOMy*t.body.axisy),t.aabb.minx=t.worldCOMx-t.radius,t.aabb.miny=t.worldCOMy-t.radius,t.aabb.maxx=t.worldCOMx+t.radius,t.aabb.maxy=t.worldCOMy+t.radius}else{var e=this.polygon,i=e.lverts.next,n=e.gverts.next,t=i;i=i.next,n.x=e.body.posx+(e.body.axisy*t.x-e.body.axisx*t.y),n.y=e.body.posy+(t.x*e.body.axisx+t.y*e.body.axisy),e.aabb.minx=n.x,e.aabb.miny=n.y,e.aabb.maxx=n.x,e.aabb.maxy=n.y;for(var r=e.gverts.next.next;null!=r;){var o=r,s=i,i=i.next;o.x=e.body.posx+(e.body.axisy*s.x-e.body.axisx*s.y),o.y=e.body.posy+(s.x*e.body.axisx+s.y*e.body.axisy),o.x<e.aabb.minx&&(e.aabb.minx=o.x),o.x>e.aabb.maxx&&(e.aabb.maxx=o.x),o.y<e.aabb.miny&&(e.aabb.miny=o.y),o.y>e.aabb.maxy&&(e.aabb.maxy=o.y),r=r.next}}},Ve.prototype.invalidate_aabb=function(){this.zip_aabb=!0,null!=this.body&&(this.body.zip_aabb=!0)},Ve.prototype.validate_area_inertia=function(){this.zip_area_inertia&&(this.zip_area_inertia=!1,(0==this.type?this.circle:this.polygon).__validate_area_inertia())},Ve.prototype.validate_angDrag=function(){!this.zip_angDrag&&this.refmaterial.dynamicFriction==this.material.dynamicFriction||(this.zip_angDrag=!1,this.refmaterial.dynamicFriction=this.material.dynamicFriction,(0==this.type?this.circle:this.polygon).__validate_angDrag())},Ve.prototype.validate_localCOM=function(){if(this.zip_localCOM){if(this.zip_localCOM=!1,1==this.type){var t=this.polygon;if(null==t.lverts.next.next)t.localCOMx=t.lverts.next.x,t.localCOMy=t.lverts.next.y;else if(null==t.lverts.next.next.next)t.localCOMx=t.lverts.next.x,t.localCOMy=t.lverts.next.y,t.localCOMx+=t.lverts.next.next.x,t.localCOMy+=t.lverts.next.next.y,t.localCOMx*=.5,t.localCOMy*=.5;else{t.localCOMx=0;var e=t.localCOMy=0,i=t.lverts.next,n=i,r=i=i.next;for(i=i.next;null!=i;){var o=i;e+=r.x*(o.y-n.y);var s=o.y*r.x-o.x*r.y;t.localCOMx+=(r.x+o.x)*s,t.localCOMy+=(r.y+o.y)*s,n=r,r=o,i=i.next}var a=i=t.lverts.next;e+=r.x*(a.y-n.y);var h=a.y*r.x-a.x*r.y;t.localCOMx+=(r.x+a.x)*h,t.localCOMy+=(r.y+a.y)*h;var n=r,l=i=i.next;e+=a.x*(l.y-n.y);h=l.y*a.x-l.x*a.y;t.localCOMx+=(a.x+l.x)*h,t.localCOMy+=(a.y+l.y)*h;h=e=1/(3*e);t.localCOMx*=h,t.localCOMy*=h}}null!=this.wrap_localCOM&&(this.wrap_localCOM.zpp_inner.x=this.localCOMx,this.wrap_localCOM.zpp_inner.y=this.localCOMy)}},Ve.prototype.validate_worldCOM=function(){if(this.zip_worldCOM&&null!=this.body){if(this.zip_worldCOM=!1,this.zip_localCOM){if(this.zip_localCOM=!1,1==this.type){var t=this.polygon;if(null==t.lverts.next.next)t.localCOMx=t.lverts.next.x,t.localCOMy=t.lverts.next.y;else if(null==t.lverts.next.next.next)t.localCOMx=t.lverts.next.x,t.localCOMy=t.lverts.next.y,t.localCOMx+=t.lverts.next.next.x,t.localCOMy+=t.lverts.next.next.y,t.localCOMx*=.5,t.localCOMy*=.5;else{t.localCOMx=0;var e=t.localCOMy=0,i=t.lverts.next,n=i,r=i=i.next;for(i=i.next;null!=i;){var o=i;e+=r.x*(o.y-n.y);var s=o.y*r.x-o.x*r.y;t.localCOMx+=(r.x+o.x)*s,t.localCOMy+=(r.y+o.y)*s,n=r,r=o,i=i.next}var a=i=t.lverts.next;e+=r.x*(a.y-n.y);var h=a.y*r.x-a.x*r.y;t.localCOMx+=(r.x+a.x)*h,t.localCOMy+=(r.y+a.y)*h;var n=r,l=i=i.next;e+=a.x*(l.y-n.y);h=l.y*a.x-l.x*a.y;t.localCOMx+=(a.x+l.x)*h,t.localCOMy+=(a.y+l.y)*h;h=e=1/(3*e);t.localCOMx*=h,t.localCOMy*=h}}null!=this.wrap_localCOM&&(this.wrap_localCOM.zpp_inner.x=this.localCOMx,this.wrap_localCOM.zpp_inner.y=this.localCOMy)}h=this.body;h.zip_axis&&(h.zip_axis=!1,h.axisx=Math.sin(h.rot),h.axisy=Math.cos(h.rot)),this.worldCOMx=this.body.posx+(this.body.axisy*this.localCOMx-this.body.axisx*this.localCOMy),this.worldCOMy=this.body.posy+(this.localCOMx*this.body.axisx+this.localCOMy*this.body.axisy)}},Ve.prototype.getworldCOM=function(){if(this.zip_worldCOM&&null!=this.body){if(this.zip_worldCOM=!1,this.zip_localCOM){if(this.zip_localCOM=!1,1==this.type){var t=this.polygon;if(null==t.lverts.next.next)t.localCOMx=t.lverts.next.x,t.localCOMy=t.lverts.next.y;else if(null==t.lverts.next.next.next)t.localCOMx=t.lverts.next.x,t.localCOMy=t.lverts.next.y,t.localCOMx+=t.lverts.next.next.x,t.localCOMy+=t.lverts.next.next.y,t.localCOMx*=.5,t.localCOMy*=.5;else{t.localCOMx=0;var e=t.localCOMy=0,i=t.lverts.next,n=i,r=i=i.next;for(i=i.next;null!=i;){var o=i;e+=r.x*(o.y-n.y);var s=o.y*r.x-o.x*r.y;t.localCOMx+=(r.x+o.x)*s,t.localCOMy+=(r.y+o.y)*s,n=r,r=o,i=i.next}var a=i=t.lverts.next;e+=r.x*(a.y-n.y);var h=a.y*r.x-a.x*r.y;t.localCOMx+=(r.x+a.x)*h,t.localCOMy+=(r.y+a.y)*h;var n=r,l=i=i.next;e+=a.x*(l.y-n.y);h=l.y*a.x-l.x*a.y;t.localCOMx+=(a.x+l.x)*h,t.localCOMy+=(a.y+l.y)*h;h=e=1/(3*e);t.localCOMx*=h,t.localCOMy*=h}}null!=this.wrap_localCOM&&(this.wrap_localCOM.zpp_inner.x=this.localCOMx,this.wrap_localCOM.zpp_inner.y=this.localCOMy)}h=this.body;h.zip_axis&&(h.zip_axis=!1,h.axisx=Math.sin(h.rot),h.axisy=Math.cos(h.rot)),this.worldCOMx=this.body.posx+(this.body.axisy*this.localCOMx-this.body.axisx*this.localCOMy),this.worldCOMy=this.body.posy+(this.localCOMx*this.body.axisx+this.localCOMy*this.body.axisy)}this.wrap_worldCOM.zpp_inner.x=this.worldCOMx,this.wrap_worldCOM.zpp_inner.y=this.worldCOMy},Ve.prototype.invalidate_area_inertia=function(){var t;this.zip_area_inertia=!0,null!=this.body&&((t=this.body).zip_localCOM=!0,t.zip_worldCOM=!0,this.body.invalidate_mass(),this.body.invalidate_inertia())},Ve.prototype.invalidate_angDrag=function(){this.zip_angDrag=!0},Ve.prototype.invalidate_localCOM=function(){var t;this.zip_localCOM=!0,this.invalidate_area_inertia(),0==this.type&&(this.zip_sweepRadius=!0),this.invalidate_angDrag(),this.invalidate_worldCOM(),null!=this.body&&((t=this.body).zip_localCOM=!0,t.zip_worldCOM=!0)},Ve.prototype.invalidate_worldCOM=function(){this.zip_worldCOM=!0,this.zip_aabb=!0,null!=this.body&&(this.body.zip_aabb=!0)},Ve.prototype.invalidate_material=function(t){var e;0!=(t&Ue.WAKE)&&this.wake(),0!=(t&Ue.ARBITERS)&&null!=this.body&&this.body.refreshArbiters(),0!=(t&Ue.PROPS)&&null!=this.body&&((e=this.body).zip_localCOM=!0,e.zip_worldCOM=!0,this.body.invalidate_mass(),this.body.invalidate_inertia()),0!=(t&Ue.ANGDRAG)&&this.invalidate_angDrag(),this.refmaterial.set(this.material)},Ve.prototype.invalidate_filter=function(){this.wake()},Ve.prototype.invalidate_fluidprops=function(){this.fluidEnabled&&this.wake()},Ve.prototype.aabb_validate=function(){if(this.zip_aabb&&null!=this.body)if(this.zip_aabb=!1,0==this.type){var t=this.circle;if(t.zip_worldCOM&&null!=t.body){if(t.zip_worldCOM=!1,t.zip_localCOM){if(t.zip_localCOM=!1,1==t.type){var e=t.polygon;if(null==e.lverts.next.next)e.localCOMx=e.lverts.next.x,e.localCOMy=e.lverts.next.y;else if(null==e.lverts.next.next.next)e.localCOMx=e.lverts.next.x,e.localCOMy=e.lverts.next.y,e.localCOMx+=e.lverts.next.next.x,e.localCOMy+=e.lverts.next.next.y,e.localCOMx*=.5,e.localCOMy*=.5;else{e.localCOMx=0;var i=e.localCOMy=0,n=e.lverts.next,r=n,o=n=n.next;for(n=n.next;null!=n;){var s=n;i+=o.x*(s.y-r.y);var a=s.y*o.x-s.x*o.y;e.localCOMx+=(o.x+s.x)*a,e.localCOMy+=(o.y+s.y)*a,r=o,o=s,n=n.next}var h=n=e.lverts.next;i+=o.x*(h.y-r.y);var l=h.y*o.x-h.x*o.y;e.localCOMx+=(o.x+h.x)*l,e.localCOMy+=(o.y+h.y)*l;var r=o,p=n=n.next;i+=h.x*(p.y-r.y);l=p.y*h.x-p.x*h.y;e.localCOMx+=(h.x+p.x)*l,e.localCOMy+=(h.y+p.y)*l;p=i=1/(3*i);e.localCOMx*=p,e.localCOMy*=p}}null!=t.wrap_localCOM&&(t.wrap_localCOM.zpp_inner.x=t.localCOMx,t.wrap_localCOM.zpp_inner.y=t.localCOMy)}l=t.body;l.zip_axis&&(l.zip_axis=!1,l.axisx=Math.sin(l.rot),l.axisy=Math.cos(l.rot)),t.worldCOMx=t.body.posx+(t.body.axisy*t.localCOMx-t.body.axisx*t.localCOMy),t.worldCOMy=t.body.posy+(t.localCOMx*t.body.axisx+t.localCOMy*t.body.axisy)}p=t.radius,l=t.radius;t.aabb.minx=t.worldCOMx-p,t.aabb.miny=t.worldCOMy-l,t.aabb.maxx=t.worldCOMx+p,t.aabb.maxy=t.worldCOMy+l}else{var u=this.polygon;if(u.zip_gverts&&null!=u.body){u.zip_gverts=!1,u.validate_lverts();var d=u.body;d.zip_axis&&(d.zip_axis=!1,d.axisx=Math.sin(d.rot),d.axisy=Math.cos(d.rot));for(var c=u.lverts.next,y=u.gverts.next;null!=y;){var _=y,m=c,c=c.next;_.x=u.body.posx+(u.body.axisy*m.x-u.body.axisx*m.y),_.y=u.body.posy+(m.x*u.body.axisx+m.y*u.body.axisy),y=y.next}}d=u.gverts.next;u.aabb.minx=d.x,u.aabb.miny=d.y,u.aabb.maxx=d.x,u.aabb.maxy=d.y;for(var g=u.gverts.next.next;null!=g;){var f=g;f.x<u.aabb.minx&&(u.aabb.minx=f.x),f.x>u.aabb.maxx&&(u.aabb.maxx=f.x),f.y<u.aabb.miny&&(u.aabb.miny=f.y),f.y>u.aabb.maxy&&(u.aabb.maxy=f.y),g=g.next}}},Ve.prototype.setMaterial=function(t){this.material!=t&&(null!=this.body&&null!=this.body.space&&null!=this.material&&this.material.shapes.remove(this),this.material=t,null!=this.body&&null!=this.body.space&&t.shapes.add(this),this.wake(),null!=this.body&&this.body.refreshArbiters())},Ve.prototype.setFilter=function(t){this.filter!=t&&(null!=this.body&&null!=this.body.space&&null!=this.filter&&this.filter.shapes.remove(this),this.filter=t,null!=this.body&&null!=this.body.space&&t.shapes.add(this),this.wake())},Ve.prototype.setFluid=function(t){this.fluidProperties!=t&&(null!=this.body&&null!=this.body.space&&null!=this.fluidProperties&&this.fluidProperties.shapes.remove(this),this.fluidProperties=t,null!=this.body&&null!=this.body.space&&t.shapes.add(this),this.fluidEnabled&&this.wake())},Ve.prototype.__immutable_midstep=function(t){},Ve.prototype.addedToBody=function(){this.invalidate_worldCOM(),this.zip_aabb=!0,null!=this.body&&(this.body.zip_aabb=!0)},Ve.prototype.removedFromBody=function(){},Ve.prototype.addedToSpace=function(){this.__iaddedToSpace(),this.material.shapes.add(this),this.filter.shapes.add(this),null!=this.fluidProperties&&this.fluidProperties.shapes.add(this)},Ve.prototype.removedFromSpace=function(){this.__iremovedFromSpace(),this.material.shapes.remove(this),this.filter.shapes.remove(this),null!=this.fluidProperties&&this.fluidProperties.shapes.remove(this)},Ve.prototype.copy=function(){var t=null,t=(0==this.type?this.circle:this.polygon).__copy();this.zip_area_inertia?t.invalidate_area_inertia():(t.area=this.area,t.inertia=this.inertia),this.zip_sweepRadius?t.zip_sweepRadius=!0:(t.sweepRadius=this.sweepRadius,t.sweepCoef=this.sweepCoef),this.zip_angDrag?t.invalidate_angDrag():t.angDrag=this.angDrag,this.zip_aabb?(t.zip_aabb=!0,null!=t.body&&(t.body.zip_aabb=!0)):(t.aabb.minx=this.aabb.minx,t.aabb.miny=this.aabb.miny,t.aabb.maxx=this.aabb.maxx,t.aabb.maxy=this.aabb.maxy);var e=t.material;e.outer=null,e.next=Ue.zpp_pool,Ue.zpp_pool=e;e=t.filter;return e.outer=null,e.next=he.zpp_pool,he.zpp_pool=e,t.material=this.material,t.filter=this.filter,null!=this.fluidProperties&&(t.fluidProperties=this.fluidProperties),t.fluidEnabled=this.fluidEnabled,t.sensorEnabled=this.sensorEnabled,null!=this.userData&&(t.userData=h.copy(this.userData)),this.copyto(t.outer),t.outer},Ve.prototype.__class__=Ve;var We=zpp_nape.shape.ZPP_Circle=function(){this.radius=0,this.outer_zn=null,Ve.call(this,0),(this.circle=this).zip_localCOM=!1};We.__name__=["zpp_nape","shape","ZPP_Circle"],We.__super__=Ve,We.prototype=Object.create(Ve.prototype),We.prototype.outer_zn=null,We.prototype.radius=null,We.prototype.__clear=function(){},We.prototype.invalidate_radius=function(){this.invalidate_area_inertia(),this.invalidate_angDrag(),this.zip_aabb=!0,null!=this.body&&(this.body.zip_aabb=!0),null!=this.body&&this.body.wake()},We.prototype.localCOM_validate=function(){this.wrap_localCOM.zpp_inner.x=this.localCOMx,this.wrap_localCOM.zpp_inner.y=this.localCOMy},We.prototype.localCOM_invalidate=function(t){this.localCOMx=t.x,this.localCOMy=t.y,this.invalidate_localCOM(),null!=this.body&&this.body.wake()},We.prototype.setupLocalCOM=function(){var t,e,i=this.localCOMx,n=this.localCOMy;null==Bn.poolVec2?t=new St:(t=Bn.poolVec2,Bn.poolVec2=t.zpp_pool,t.zpp_pool=null),null==t.zpp_inner?(null==Gr.zpp_pool?e=new Gr:(e=Gr.zpp_pool,Gr.zpp_pool=e.next,e.next=null),e.weak=!1,e._immutable=!1,e.x=i,e.y=n,t.zpp_inner=e,t.zpp_inner.outer=t):(null!=(e=t.zpp_inner)._validate&&e._validate(),t.zpp_inner.x==i&&(null!=(e=t.zpp_inner)._validate&&e._validate(),t.zpp_inner.y==n)||(t.zpp_inner.x=i,t.zpp_inner.y=n,null!=(n=t.zpp_inner)._invalidate&&n._invalidate(n))),t.zpp_inner.weak=!1,this.wrap_localCOM=t,this.wrap_localCOM.zpp_inner._inuse=!0,this.wrap_localCOM.zpp_inner._validate=Z(this,this.localCOM_validate),this.wrap_localCOM.zpp_inner._invalidate=Z(this,this.localCOM_invalidate)},We.prototype.__validate_aabb=function(){if(this.zip_worldCOM&&null!=this.body){if(this.zip_worldCOM=!1,this.zip_localCOM){if(this.zip_localCOM=!1,1==this.type){var t=this.polygon;if(null==t.lverts.next.next)t.localCOMx=t.lverts.next.x,t.localCOMy=t.lverts.next.y;else if(null==t.lverts.next.next.next)t.localCOMx=t.lverts.next.x,t.localCOMy=t.lverts.next.y,t.localCOMx+=t.lverts.next.next.x,t.localCOMy+=t.lverts.next.next.y,t.localCOMx*=.5,t.localCOMy*=.5;else{t.localCOMx=0;var e=t.localCOMy=0,i=t.lverts.next,n=i,r=i=i.next;for(i=i.next;null!=i;){var o=i;e+=r.x*(o.y-n.y);var s=o.y*r.x-o.x*r.y;t.localCOMx+=(r.x+o.x)*s,t.localCOMy+=(r.y+o.y)*s,n=r,r=o,i=i.next}var a=i=t.lverts.next;e+=r.x*(a.y-n.y);var h=a.y*r.x-a.x*r.y;t.localCOMx+=(r.x+a.x)*h,t.localCOMy+=(r.y+a.y)*h;var n=r,l=i=i.next;e+=a.x*(l.y-n.y);h=l.y*a.x-l.x*a.y;t.localCOMx+=(a.x+l.x)*h,t.localCOMy+=(a.y+l.y)*h;l=e=1/(3*e);t.localCOMx*=l,t.localCOMy*=l}}null!=this.wrap_localCOM&&(this.wrap_localCOM.zpp_inner.x=this.localCOMx,this.wrap_localCOM.zpp_inner.y=this.localCOMy)}h=this.body;h.zip_axis&&(h.zip_axis=!1,h.axisx=Math.sin(h.rot),h.axisy=Math.cos(h.rot)),this.worldCOMx=this.body.posx+(this.body.axisy*this.localCOMx-this.body.axisx*this.localCOMy),this.worldCOMy=this.body.posy+(this.localCOMx*this.body.axisx+this.localCOMy*this.body.axisy)}l=this.radius,h=this.radius;this.aabb.minx=this.worldCOMx-l,this.aabb.miny=this.worldCOMy-h,this.aabb.maxx=this.worldCOMx+l,this.aabb.maxy=this.worldCOMy+h},We.prototype._force_validate_aabb=function(){this.worldCOMx=this.body.posx+(this.body.axisy*this.localCOMx-this.body.axisx*this.localCOMy),this.worldCOMy=this.body.posy+(this.localCOMx*this.body.axisx+this.localCOMy*this.body.axisy),this.aabb.minx=this.worldCOMx-this.radius,this.aabb.miny=this.worldCOMy-this.radius,this.aabb.maxx=this.worldCOMx+this.radius,this.aabb.maxy=this.worldCOMy+this.radius},We.prototype.__validate_sweepRadius=function(){this.sweepCoef=Math.sqrt(this.localCOMx*this.localCOMx+this.localCOMy*this.localCOMy),this.sweepRadius=this.sweepCoef+this.radius},We.prototype.__validate_area_inertia=function(){var t=this.radius*this.radius;this.area=t*Math.PI,this.inertia=.5*t+(this.localCOMx*this.localCOMx+this.localCOMy*this.localCOMy)},We.prototype.__validate_angDrag=function(){var t=this.localCOMx*this.localCOMx+this.localCOMy*this.localCOMy,e=this.radius*this.radius;this.angDrag=(t+2*e)*(this.material.dynamicFriction*Er.fluidAngularDragFriction)+.5*Er.fluidAngularDrag*(1+Er.fluidVacuumDrag)*t,this.angDrag/=2*(t+.5*e)},We.prototype.__scale=function(t,e){var i=((t<0?-t:t)+(e<0?-e:e))/2;this.radius*=i<0?-i:i,this.invalidate_radius(),0<this.localCOMx*this.localCOMx+this.localCOMy*this.localCOMy&&(this.localCOMx*=t,this.localCOMy*=e,this.invalidate_localCOM())},We.prototype.__translate=function(t,e){this.localCOMx+=t,this.localCOMy+=e,this.invalidate_localCOM()},We.prototype.__rotate=function(t,e){var i,n;0<this.localCOMx*this.localCOMx+this.localCOMy*this.localCOMy&&(n=i=0,i=e*this.localCOMx-t*this.localCOMy,n=this.localCOMx*t+this.localCOMy*e,this.localCOMx=i,this.localCOMy=n,this.invalidate_localCOM())},We.prototype.__transform=function(t){var e=t.zpp_inner.a*t.zpp_inner.d-t.zpp_inner.b*t.zpp_inner.c;e<0&&(e=-e),this.radius*=Math.sqrt(e);e=t.zpp_inner.a*this.localCOMx+t.zpp_inner.b*this.localCOMy+t.zpp_inner.tx;this.localCOMy=t.zpp_inner.c*this.localCOMx+t.zpp_inner.d*this.localCOMy+t.zpp_inner.ty,this.localCOMx=e,this.invalidate_radius(),this.invalidate_localCOM()},We.prototype.__copy=function(){var t=new ut(this.radius).zpp_inner_zn;return t.localCOMx=this.localCOMx,t.localCOMy=this.localCOMy,t.zip_localCOM=!1,t},We.prototype.__class__=We;var Xe=zpp_nape.shape.ZPP_Edge=function(){this.tp1=0,this.tp0=0,this.gp1=null,this.lp1=null,this.gp0=null,this.lp0=null,this.gprojection=0,this.lprojection=0,this.length=0,this.wrap_gnorm=null,this.gnormy=0,this.gnormx=0,this.wrap_lnorm=null,this.lnormy=0,this.lnormx=0,this.outer=null,this.polygon=null,this.next=null,this.lnormx=0,this.lnormy=0,this.gnormx=0,this.gnormy=0,this.length=0,this.lprojection=0,this.gprojection=0};Xe.__name__=["zpp_nape","shape","ZPP_Edge"],Xe.prototype.next=null,Xe.prototype.free=function(){this.polygon=null},Xe.prototype.alloc=function(){},Xe.prototype.polygon=null,Xe.prototype.outer=null,Xe.prototype.wrapper=function(){return null==this.outer&&(Xe.internal=!0,this.outer=new dt,Xe.internal=!1,this.outer.zpp_inner=this),this.outer},Xe.prototype.lnormx=null,Xe.prototype.lnormy=null,Xe.prototype.wrap_lnorm=null,Xe.prototype.gnormx=null,Xe.prototype.gnormy=null,Xe.prototype.wrap_gnorm=null,Xe.prototype.length=null,Xe.prototype.lprojection=null,Xe.prototype.gprojection=null,Xe.prototype.lp0=null,Xe.prototype.gp0=null,Xe.prototype.lp1=null,Xe.prototype.gp1=null,Xe.prototype.tp0=null,Xe.prototype.tp1=null,Xe.prototype.lnorm_validate=function(){this.polygon.validate_laxi(),this.wrap_lnorm.zpp_inner.x=this.lnormx,this.wrap_lnorm.zpp_inner.y=this.lnormy},Xe.prototype.gnorm_validate=function(){var t=this.polygon;if(t.zip_gaxi&&null!=t.body){t.zip_gaxi=!1,t.validate_laxi();var e=t.body;if(e.zip_axis&&(e.zip_axis=!1,e.axisx=Math.sin(e.rot),e.axisy=Math.cos(e.rot)),t.zip_gverts&&null!=t.body){t.zip_gverts=!1,t.validate_lverts();var i=t.body;i.zip_axis&&(i.zip_axis=!1,i.axisx=Math.sin(i.rot),i.axisy=Math.cos(i.rot));for(var n=t.lverts.next,r=t.gverts.next;null!=r;){var o=r,s=n,n=n.next;o.x=t.body.posx+(t.body.axisy*s.x-t.body.axisx*s.y),o.y=t.body.posy+(s.x*t.body.axisx+s.y*t.body.axisy),r=r.next}}for(var a=t.edges.head,h=l=t.gverts.next,l=l.next;null!=l;){var p=l,u=a.elt,a=a.next;u.gp0=h,u.gp1=p,u.gnormx=t.body.axisy*u.lnormx-t.body.axisx*u.lnormy,u.gnormy=u.lnormx*t.body.axisx+u.lnormy*t.body.axisy,u.gprojection=t.body.posx*u.gnormx+t.body.posy*u.gnormy+u.lprojection,null!=u.wrap_gnorm&&(u.wrap_gnorm.zpp_inner.x=u.gnormx,u.wrap_gnorm.zpp_inner.y=u.gnormy),u.tp0=u.gp0.y*u.gnormx-u.gp0.x*u.gnormy,u.tp1=u.gp1.y*u.gnormx-u.gp1.x*u.gnormy,h=p,l=l.next}i=a.elt;i.gp0=h,i.gp1=t.gverts.next,i.gnormx=t.body.axisy*i.lnormx-t.body.axisx*i.lnormy,i.gnormy=i.lnormx*t.body.axisx+i.lnormy*t.body.axisy,i.gprojection=t.body.posx*i.gnormx+t.body.posy*i.gnormy+i.lprojection,null!=i.wrap_gnorm&&(i.wrap_gnorm.zpp_inner.x=i.gnormx,i.wrap_gnorm.zpp_inner.y=i.gnormy),i.tp0=i.gp0.y*i.gnormx-i.gp0.x*i.gnormy,i.tp1=i.gp1.y*i.gnormx-i.gp1.x*i.gnormy}this.wrap_gnorm.zpp_inner.x=this.gnormx,this.wrap_gnorm.zpp_inner.y=this.gnormy},Xe.prototype.getlnorm=function(){var t,e,i=this.lnormx,n=this.lnormy;null==Bn.poolVec2?t=new St:(t=Bn.poolVec2,Bn.poolVec2=t.zpp_pool,t.zpp_pool=null),null==t.zpp_inner?(null==Gr.zpp_pool?e=new Gr:(e=Gr.zpp_pool,Gr.zpp_pool=e.next,e.next=null),e.weak=!1,e._immutable=!1,e.x=i,e.y=n,t.zpp_inner=e,t.zpp_inner.outer=t):(null!=(e=t.zpp_inner)._validate&&e._validate(),t.zpp_inner.x==i&&(null!=(e=t.zpp_inner)._validate&&e._validate(),t.zpp_inner.y==n)||(t.zpp_inner.x=i,t.zpp_inner.y=n,null!=(n=t.zpp_inner)._invalidate&&n._invalidate(n))),t.zpp_inner.weak=!1,this.wrap_lnorm=t,this.wrap_lnorm.zpp_inner._immutable=!0,this.wrap_lnorm.zpp_inner._validate=Z(this,this.lnorm_validate)},Xe.prototype.getgnorm=function(){var t,e,i=this.gnormx,n=this.gnormy;null==Bn.poolVec2?t=new St:(t=Bn.poolVec2,Bn.poolVec2=t.zpp_pool,t.zpp_pool=null),null==t.zpp_inner?(null==Gr.zpp_pool?e=new Gr:(e=Gr.zpp_pool,Gr.zpp_pool=e.next,e.next=null),e.weak=!1,e._immutable=!1,e.x=i,e.y=n,t.zpp_inner=e,t.zpp_inner.outer=t):(null!=(e=t.zpp_inner)._validate&&e._validate(),t.zpp_inner.x==i&&(null!=(e=t.zpp_inner)._validate&&e._validate(),t.zpp_inner.y==n)||(t.zpp_inner.x=i,t.zpp_inner.y=n,null!=(n=t.zpp_inner)._invalidate&&n._invalidate(n))),t.zpp_inner.weak=!1,this.wrap_gnorm=t,this.wrap_gnorm.zpp_inner._immutable=!0,this.wrap_gnorm.zpp_inner._validate=Z(this,this.gnorm_validate)},Xe.prototype.__class__=Xe;var He=zpp_nape.shape.ZPP_Polygon=function(){this.zip_sanitation=!1,this.zip_valid=!1,this.zip_gaxi=!1,this.zip_gverts=!1,this.zip_laxi=!1,this.zip_lverts=!1,this.reverse_flag=!1,this.edgeCnt=0,this.wrap_edges=null,this.edges=null,this.wrap_gverts=null,this.gverts=null,this.wrap_lverts=null,this.lverts=null,this.outer_zn=null,Ve.call(this,1),(this.polygon=this).lverts=new Gr,this.gverts=new Gr,this.edges=new ki,this.edgeCnt=0};He.__name__=["zpp_nape","shape","ZPP_Polygon"],He.__super__=Ve,He.prototype=Object.create(Ve.prototype),He.prototype.outer_zn=null,He.prototype.lverts=null,He.prototype.wrap_lverts=null,He.prototype.gverts=null,He.prototype.wrap_gverts=null,He.prototype.edges=null,He.prototype.wrap_edges=null,He.prototype.edgeCnt=null,He.prototype.reverse_flag=null,He.prototype.__clear=function(){},He.prototype.lverts_pa_invalidate=function(t){this.invalidate_lverts()},He.prototype.gverts_pa_validate=function(){if(this.zip_gverts&&null!=this.body){this.zip_gverts=!1,this.validate_lverts();var t=this.body;t.zip_axis&&(t.zip_axis=!1,t.axisx=Math.sin(t.rot),t.axisy=Math.cos(t.rot));for(var e=this.lverts.next,i=this.gverts.next;null!=i;){var n=i,r=e,e=e.next;n.x=this.body.posx+(this.body.axisy*r.x-this.body.axisx*r.y),n.y=this.body.posy+(r.x*this.body.axisx+r.y*this.body.axisy),i=i.next}}},He.prototype.lverts_post_adder=function(t){t.zpp_inner._invalidate=Z(this,this.lverts_pa_invalidate);for(var e=null,i=null,n=this.lverts.next;null!=n&&n!=t.zpp_inner;)e=(null==e?this.gverts:e).next,i=null==i?this.edges.head:i.next,n=n.next;null==Gr.zpp_pool?a=new Gr:(a=Gr.zpp_pool,Gr.zpp_pool=a.next,a.next=null),a.weak=!1,a._immutable=!0,a.x=0,a.y=0;var r,o,s,a=a;this.gverts.insert(e,a),null!=this.lverts.next.next&&(null==this.lverts.next.next.next?(null==Xe.zpp_pool?r=new Xe:(r=Xe.zpp_pool,Xe.zpp_pool=r.next,r.next=null),(r.polygon=this).edges.add(r),null==Xe.zpp_pool?o=new Xe:(o=Xe.zpp_pool,Xe.zpp_pool=o.next,o.next=null),(o.polygon=this).edges.add(o),this.edgeCnt+=2):(null==Xe.zpp_pool?s=new Xe:(s=Xe.zpp_pool,Xe.zpp_pool=s.next,s.next=null),(s.polygon=this).edges.insert(i,s),this.edgeCnt++)),a._validate=Z(this,this.gverts_pa_validate)},He.prototype.lverts_subber=function(t){this.cleanup_lvert(t.zpp_inner)},He.prototype.lverts_invalidate=function(t){this.invalidate_lverts()},He.prototype.lverts_validate=function(){this.validate_lverts()},He.prototype.gverts_validate=function(){if(this.zip_gverts&&null!=this.body){this.zip_gverts=!1,this.validate_lverts();var t=this.body;t.zip_axis&&(t.zip_axis=!1,t.axisx=Math.sin(t.rot),t.axisy=Math.cos(t.rot));for(var e=this.lverts.next,i=this.gverts.next;null!=i;){var n=i,r=e,e=e.next;n.x=this.body.posx+(this.body.axisy*r.x-this.body.axisx*r.y),n.y=this.body.posy+(r.x*this.body.axisx+r.y*this.body.axisy),i=i.next}}},He.prototype.edges_validate=function(){this.validate_lverts()},He.prototype.getlverts=function(){this.wrap_lverts=wn.get(this.lverts),this.wrap_lverts.zpp_inner.post_adder=Z(this,this.lverts_post_adder),this.wrap_lverts.zpp_inner.subber=Z(this,this.lverts_subber),this.wrap_lverts.zpp_inner._invalidate=Z(this,this.lverts_invalidate),this.wrap_lverts.zpp_inner._validate=Z(this,this.lverts_validate),this.wrap_lverts.zpp_inner.reverse_flag=this.reverse_flag},He.prototype.getgverts=function(){this.wrap_gverts=wn.get(this.gverts,!0),this.wrap_gverts.zpp_inner.reverse_flag=this.reverse_flag,this.wrap_gverts.zpp_inner._validate=Z(this,this.gverts_validate)},He.prototype.getedges=function(){this.wrap_edges=En.get(this.edges,!0),this.wrap_edges.zpp_inner.reverse_flag=this.reverse_flag,this.wrap_edges.zpp_inner._validate=Z(this,this.edges_validate)},He.prototype.zip_lverts=null,He.prototype.invalidate_lverts=function(){this.invalidate_laxi(),this.invalidate_area_inertia(),this.invalidate_angDrag(),this.invalidate_localCOM(),this.invalidate_gverts(),this.zip_lverts=!0,this.zip_valid=!0,this.zip_sanitation=!0,null!=this.body&&this.body.wake()},He.prototype.zip_laxi=null,He.prototype.invalidate_laxi=function(){this.invalidate_gaxi(),this.zip_sweepRadius=!0,this.zip_laxi=!0},He.prototype.zip_gverts=null,He.prototype.invalidate_gverts=function(){this.zip_aabb=!0,null!=this.body&&(this.body.zip_aabb=!0),this.zip_gverts=!0},He.prototype.zip_gaxi=null,He.prototype.invalidate_gaxi=function(){this.zip_gaxi=!0},He.prototype.zip_valid=null,He.prototype.validation=null,He.prototype.valid=function(){if(this.zip_valid){if(this.zip_valid=!1,this.zip_sanitation&&(this.zip_sanitation=!1,this.splice_collinear_real()),this.lverts.length<3)return null==Yn.ValidationResult_DEGENERATE&&(Yn.internal=!0,Yn.ValidationResult_DEGENERATE=new gt,Yn.internal=!1),this.validation=Yn.ValidationResult_DEGENERATE;if(this.validate_lverts(),this.validate_area_inertia(),this.area<Er.epsilon)return null==Yn.ValidationResult_DEGENERATE&&(Yn.internal=!0,Yn.ValidationResult_DEGENERATE=new gt,Yn.internal=!1),this.validation=Yn.ValidationResult_DEGENERATE;var t=!1,e=!1,i=!0,n=c=this.lverts.next,r=c=c.next;for(c=c.next;null!=c;){var o=c,s=o.x-r.x,a=o.y-r.y,h=r.x-n.x,a=(r.y-n.y)*s-h*a;if(Er.epsilon<a?e=!0:a<-Er.epsilon&&(t=!0),e&&t){i=!1;break}n=r,r=o,c=c.next}if(i){for(var l=c=this.lverts.next;;){var p=l.x-r.x,u=l.y-r.y,d=r.x-n.x,u=(r.y-n.y)*p-d*u;if(Er.epsilon<u?e=!0:u<-Er.epsilon&&(t=!0),e&&t){i=!1;break}break}if(i)for(var c,n=r,r=l,y=c=c.next;;){var _=y.x-l.x,m=y.y-l.y,g=l.x-n.x,m=(l.y-n.y)*_-g*m;if(Er.epsilon<m?e=!0:m<-Er.epsilon&&(t=!0),e&&t)break;break}}if(e&&t)return null==Yn.ValidationResult_CONCAVE&&(Yn.internal=!0,Yn.ValidationResult_CONCAVE=new gt,Yn.internal=!1),this.validation=Yn.ValidationResult_CONCAVE;for(var f=!0,x=!0,v=w=this.lverts.next,w=w.next;null!=w;){var z=w;if(!f){x=!1;break}for(var b=!0,S=C=this.lverts.next,C=C.next;null!=C;){var P=C;if(v!=S&&v!=P&&z!=S&&z!=P){var M=v.x-S.x,T=v.y-S.y,A=z.x-v.x,k=z.y-v.y,O=P.x-S.x,E=P.y-S.y;if(Er.epsilon<(I=k*O-A*E)*I){O=(E*M-O*T)*(I=1/I);if(Er.epsilon<O&&O<1-Er.epsilon){var I=(k*M-A*T)*I;if(Er.epsilon<I&&I<1-Er.epsilon){b=f=!1;break}}}S=P,C=C.next}else S=P,C=C.next}if(b)for(;;){var G=this.lverts.next;if(v==S||v==G||z==S||z==G)break;var D=v.x-S.x,L=v.y-S.y,B=z.x-v.x,R=z.y-v.y,F=G.x-S.x,N=G.y-S.y;if(Er.epsilon<(G=R*F-B*N)*G){F=(N*D-F*L)*(G=1/G);if(Er.epsilon<F&&F<1-Er.epsilon){G=(R*D-B*L)*G;if(Er.epsilon<G&&G<1-Er.epsilon){f=!1;break}}}break}v=z,w=w.next}if(x)for(;;){var j=this.lverts.next;if(!f)break;for(var U=!0,V=W=this.lverts.next,W=W.next;null!=W;){var X=W;if(v!=V&&v!=X&&j!=V&&j!=X){var H=v.x-V.x,q=v.y-V.y,Y=j.x-v.x,K=j.y-v.y,Z=X.x-V.x,J=X.y-V.y;if(Er.epsilon<(Q=K*Z-Y*J)*Q){Z=(J*H-Z*q)*(Q=1/Q);if(Er.epsilon<Z&&Z<1-Er.epsilon){var Q=(K*H-Y*q)*Q;if(Er.epsilon<Q&&Q<1-Er.epsilon){U=f=!1;break}}}V=X,W=W.next}else V=X,W=W.next}if(U)for(;;){var $=this.lverts.next;if(v==V||v==$||j==V||j==$)break;var tt=v.x-V.x,et=v.y-V.y,it=j.x-v.x,nt=j.y-v.y,rt=$.x-V.x,ot=$.y-V.y;if(Er.epsilon<($=nt*rt-it*ot)*$){rt=(ot*tt-rt*et)*($=1/$);if(Er.epsilon<rt&&rt<1-Er.epsilon){$=(nt*tt-it*et)*$;if(Er.epsilon<$&&$<1-Er.epsilon){f=!1;break}}}break}break}return f?(null==Yn.ValidationResult_VALID&&(Yn.internal=!0,Yn.ValidationResult_VALID=new gt,Yn.internal=!1),this.validation=Yn.ValidationResult_VALID):(null==Yn.ValidationResult_SELF_INTERSECTING&&(Yn.internal=!0,Yn.ValidationResult_SELF_INTERSECTING=new gt,Yn.internal=!1),this.validation=Yn.ValidationResult_SELF_INTERSECTING)}return this.validation},He.prototype.validate_lverts=function(){this.zip_lverts&&(this.zip_lverts=!1,2<this.lverts.length&&(this.validate_area_inertia(),this.area<0&&(this.reverse_vertices(),this.area=-this.area)))},He.prototype.cleanup_lvert=function(t){for(var e=null,i=null,n=this.lverts.next;null!=n&&n!=t;)e=(null==e?this.gverts:e).next,i=null==i?this.edges.head:i.next,n=n.next;var r=(null==e?this.gverts:e).next;this.gverts.erase(e);var o,r=r;null!=r.outer&&(r.outer.zpp_inner=null,r.outer=null),r._isimmutable=null,r._validate=null,r._invalidate=null,r.next=Gr.zpp_pool,Gr.zpp_pool=r,2==this.edgeCnt?((o=this.edges.pop_unsafe()).polygon=null,o.next=Xe.zpp_pool,Xe.zpp_pool=o,(o=this.edges.pop_unsafe()).polygon=null,o.next=Xe.zpp_pool,Xe.zpp_pool=o,this.edgeCnt=0):0!=this.edgeCnt&&(o=(null==i?this.edges.head:i.next).elt,this.edges.erase(i),(o=o).polygon=null,o.next=Xe.zpp_pool,Xe.zpp_pool=o,this.edgeCnt--)},He.prototype.zip_sanitation=null,He.prototype.splice_collinear=function(){this.zip_sanitation&&(this.zip_sanitation=!1,this.splice_collinear_real())},He.prototype.splice_collinear_real=function(){if(null!=this.lverts.next&&null!=this.lverts.next.next&&null!=this.lverts.next.next.next){for(var t=null,e=this.lverts.next;null!=e;)var i=(null==e.next?this.lverts:e).next,n=e,r=n.x,o=n.y,s=0,n=0,e=(s=r-i.x)*s+(n=o-i.y)*n<Er.epsilon*Er.epsilon?(this.cleanup_lvert(e),this.lverts.erase(t)):(t=e).next;if(null!=this.lverts.next)for(;;){for(var a=!1,h=this.lverts.next;null!=h;)var l=(null==h.next?this.lverts:h).next,p=(null==l.next?this.lverts:l).next,u=h,d=l.x-u.x,c=l.y-u.y,u=p.x-l.x,c=(p.y-l.y)*d-u*c,h=(Er.epsilon*Er.epsilon<=c*c||(this.cleanup_lvert(l),this.lverts.erase(null==h.next?null:h),a=!0),h.next);if(!a)break}}},He.prototype.reverse_vertices=function(){this.lverts.reverse(),this.gverts.reverse(),this.edges.reverse(),this.edges.insert(this.edges.iterator_at(this.edgeCnt-1),this.edges.pop_unsafe()),this.reverse_flag=!this.reverse_flag,null!=this.wrap_lverts&&(this.wrap_lverts.zpp_inner.reverse_flag=this.reverse_flag),null!=this.wrap_gverts&&(this.wrap_gverts.zpp_inner.reverse_flag=this.reverse_flag),null!=this.wrap_edges&&(this.wrap_edges.zpp_inner.reverse_flag=this.reverse_flag)},He.prototype.validate_laxi=function(){if(this.zip_laxi){this.zip_laxi=!1,this.validate_lverts();for(var t=this.edges.head,e=i=this.lverts.next,i=i.next;null!=i;){var n=i,r=t.elt,t=t.next;r.lp0=e,r.lp1=n;var o=e.x-n.x,s=e.y-n.y,a=Math.sqrt(o*o+s*s),a=1/(r.length=a);s*=a;a=o*=a;r.lprojection=(o=-s)*e.x+(s=a)*e.y,r.lnormx=o,r.lnormy=s,null!=r.wrap_lnorm&&(r.wrap_lnorm.zpp_inner.x=o,r.wrap_lnorm.zpp_inner.y=s),e=n,i=i.next}var h=this.lverts.next,l=t.elt;l.lp0=e,l.lp1=h;var p=e.x-h.x,u=e.y-h.y,d=Math.sqrt(p*p+u*u),h=1/(l.length=d),d=p*=h;l.lprojection=(p=-(u*=h))*e.x+(u=d)*e.y,l.lnormx=p,l.lnormy=u,null!=l.wrap_lnorm&&(l.wrap_lnorm.zpp_inner.x=p,l.wrap_lnorm.zpp_inner.y=u)}},He.prototype.validate_gverts=function(){if(this.zip_gverts&&null!=this.body){this.zip_gverts=!1,this.validate_lverts();var t=this.body;t.zip_axis&&(t.zip_axis=!1,t.axisx=Math.sin(t.rot),t.axisy=Math.cos(t.rot));for(var e=this.lverts.next,i=this.gverts.next;null!=i;){var n=i,r=e,e=e.next;n.x=this.body.posx+(this.body.axisy*r.x-this.body.axisx*r.y),n.y=this.body.posy+(r.x*this.body.axisx+r.y*this.body.axisy),i=i.next}}},He.prototype.validate_gaxi=function(){if(this.zip_gaxi&&null!=this.body){this.zip_gaxi=!1,this.validate_laxi();var t=this.body;if(t.zip_axis&&(t.zip_axis=!1,t.axisx=Math.sin(t.rot),t.axisy=Math.cos(t.rot)),this.zip_gverts&&null!=this.body){this.zip_gverts=!1,this.validate_lverts();var e=this.body;e.zip_axis&&(e.zip_axis=!1,e.axisx=Math.sin(e.rot),e.axisy=Math.cos(e.rot));for(var i=this.lverts.next,n=this.gverts.next;null!=n;){var r=n,o=i,i=i.next;r.x=this.body.posx+(this.body.axisy*o.x-this.body.axisx*o.y),r.y=this.body.posy+(o.x*this.body.axisx+o.y*this.body.axisy),n=n.next}}for(var s=this.edges.head,a=h=this.gverts.next,h=h.next;null!=h;){var l=h,p=s.elt,s=s.next;p.gp0=a,p.gp1=l,p.gnormx=this.body.axisy*p.lnormx-this.body.axisx*p.lnormy,p.gnormy=p.lnormx*this.body.axisx+p.lnormy*this.body.axisy,p.gprojection=this.body.posx*p.gnormx+this.body.posy*p.gnormy+p.lprojection,null!=p.wrap_gnorm&&(p.wrap_gnorm.zpp_inner.x=p.gnormx,p.wrap_gnorm.zpp_inner.y=p.gnormy),p.tp0=p.gp0.y*p.gnormx-p.gp0.x*p.gnormy,p.tp1=p.gp1.y*p.gnormx-p.gp1.x*p.gnormy,a=l,h=h.next}e=s.elt;e.gp0=a,e.gp1=this.gverts.next,e.gnormx=this.body.axisy*e.lnormx-this.body.axisx*e.lnormy,e.gnormy=e.lnormx*this.body.axisx+e.lnormy*this.body.axisy,e.gprojection=this.body.posx*e.gnormx+this.body.posy*e.gnormy+e.lprojection,null!=e.wrap_gnorm&&(e.wrap_gnorm.zpp_inner.x=e.gnormx,e.wrap_gnorm.zpp_inner.y=e.gnormy),e.tp0=e.gp0.y*e.gnormx-e.gp0.x*e.gnormy,e.tp1=e.gp1.y*e.gnormx-e.gp1.x*e.gnormy}},He.prototype.__validate_aabb=function(){if(this.zip_gverts&&null!=this.body){this.zip_gverts=!1,this.validate_lverts();var t=this.body;t.zip_axis&&(t.zip_axis=!1,t.axisx=Math.sin(t.rot),t.axisy=Math.cos(t.rot));for(var e=this.lverts.next,i=this.gverts.next;null!=i;){var n=i,r=e,e=e.next;n.x=this.body.posx+(this.body.axisy*r.x-this.body.axisx*r.y),n.y=this.body.posy+(r.x*this.body.axisx+r.y*this.body.axisy),i=i.next}}t=this.gverts.next;this.aabb.minx=t.x,this.aabb.miny=t.y,this.aabb.maxx=t.x,this.aabb.maxy=t.y;for(var o=this.gverts.next.next;null!=o;){var s=o;s.x<this.aabb.minx&&(this.aabb.minx=s.x),s.x>this.aabb.maxx&&(this.aabb.maxx=s.x),s.y<this.aabb.miny&&(this.aabb.miny=s.y),s.y>this.aabb.maxy&&(this.aabb.maxy=s.y),o=o.next}},He.prototype._force_validate_aabb=function(){var t=this.lverts.next,e=this.gverts.next,i=t;t=t.next,e.x=this.body.posx+(this.body.axisy*i.x-this.body.axisx*i.y),e.y=this.body.posy+(i.x*this.body.axisx+i.y*this.body.axisy),this.aabb.minx=e.x,this.aabb.miny=e.y,this.aabb.maxx=e.x,this.aabb.maxy=e.y;for(var n=this.gverts.next.next;null!=n;){var r=n,o=t,t=t.next;r.x=this.body.posx+(this.body.axisy*o.x-this.body.axisx*o.y),r.y=this.body.posy+(o.x*this.body.axisx+o.y*this.body.axisy),r.x<this.aabb.minx&&(this.aabb.minx=r.x),r.x>this.aabb.maxx&&(this.aabb.maxx=r.x),r.y<this.aabb.miny&&(this.aabb.miny=r.y),r.y>this.aabb.maxy&&(this.aabb.maxy=r.y),n=n.next}},He.prototype.__validate_sweepRadius=function(){var t=0,e=0;this.validate_laxi();for(var i=this.lverts.next;null!=i;){var n=i,n=n.x*n.x+n.y*n.y;t<n&&(t=n),i=i.next}for(var r=this.edges.head;null!=r;){var o=r.elt;if(o.lprojection<e&&(e=o.lprojection)<0)break;r=r.next}e<0&&(e=0),this.sweepRadius=Math.sqrt(t),this.sweepCoef=this.sweepRadius-e},He.prototype.__validate_area_inertia=function(){if(null==this.lverts.next||null==this.lverts.next.next||null==this.lverts.next.next.next)this.area=0,this.inertia=0;else{var t=this.area=0,e=0,i=this.lverts.next,n=i,r=i=i.next;for(i=i.next;null!=i;){var o=i,s=r.y*n.x-r.x*n.y;t+=s*(r.x*r.x+r.y*r.y+(r.x*n.x+r.y*n.y)+(n.x*n.x+n.y*n.y)),e+=s,this.area+=r.x*(o.y-n.y),n=r,r=o,i=i.next}var a=i=this.lverts.next,h=r.y*n.x-r.x*n.y;t+=h*(r.x*r.x+r.y*r.y+(r.x*n.x+r.y*n.y)+(n.x*n.x+n.y*n.y)),e+=h,this.area+=r.x*(a.y-n.y),n=r,i=i.next;h=a.y*n.x-a.x*n.y;t+=h*(a.x*a.x+a.y*a.y+(a.x*n.x+a.y*n.y)+(n.x*n.x+n.y*n.y)),e+=h,this.area+=a.x*(i.y-n.y),this.inertia=t/(6*e),this.area*=.5,this.area<0&&(this.area=-this.area,this.reverse_vertices())}},He.prototype.__validate_angDrag=function(){this.validate_area_inertia(),this.validate_laxi();for(var t=0,e=this.edges.head,i=0,n=this.lverts.next,r=n,o=n.next;null!=o;){var s=o,a=e.elt,e=e.next;i+=a.length;var h=s.x-r.x,l=s.y-r.y;t+=a.length*Er.fluidAngularDragFriction*this.material.dynamicFriction*a.lprojection*a.lprojection;var p,u,d,c,y=-(r.y*a.lnormx-r.x*a.lnormy)/(l*a.lnormx-h*a.lnormy);0<y&&(u=p=0,p=r.x,u=r.y,p+=h*(c=1<y?1:y),u+=l*c,d=a.lnormy*r.x-a.lnormx*r.y,t+=((u=a.lnormy*p-a.lnormx*u)*u*u-d*d*d)/(3*(u-d))*c*a.length*Er.fluidAngularDrag),y<1&&(c=d=0,d=r.x,c=r.y,d+=h*(y=y<0?0:y),c+=l*y,d=a.lnormy*d-a.lnormx*c,t+=((c=a.lnormy*s.x-a.lnormx*s.y)*c*c-d*d*d)/(3*(c-d))*Er.fluidVacuumDrag*(1-y)*a.length*Er.fluidAngularDrag),r=s,o=o.next}for(;;){var _=o=this.lverts.next,m=e.elt;e=e.next,i+=m.length;var g=_.x-r.x,f=_.y-r.y;t+=m.length*Er.fluidAngularDragFriction*this.material.dynamicFriction*m.lprojection*m.lprojection;var x,v,w,z,b=-(r.y*m.lnormx-r.x*m.lnormy)/(f*m.lnormx-g*m.lnormy);0<b&&(v=x=0,x=r.x,v=r.y,x+=g*(z=1<b?1:b),v+=f*z,w=m.lnormy*r.x-m.lnormx*r.y,t+=((v=m.lnormy*x-m.lnormx*v)*v*v-w*w*w)/(3*(v-w))*z*m.length*Er.fluidAngularDrag),b<1&&(z=w=0,w=r.x,z=r.y,w+=g*(b=b<0?0:b),z+=f*b,z=m.lnormy*w-m.lnormx*z,t+=((_=m.lnormy*_.x-m.lnormx*_.y)*_*_-z*z*z)/(3*(_-z))*Er.fluidVacuumDrag*(1-b)*m.length*Er.fluidAngularDrag);break}this.angDrag=t/(this.inertia*i)},He.prototype.__validate_localCOM=function(){if(null==this.lverts.next.next)this.localCOMx=this.lverts.next.x,this.localCOMy=this.lverts.next.y;else if(null==this.lverts.next.next.next)this.localCOMx=this.lverts.next.x,this.localCOMy=this.lverts.next.y,this.localCOMx+=this.lverts.next.next.x,this.localCOMy+=this.lverts.next.next.y,this.localCOMx*=.5,this.localCOMy*=.5;else{this.localCOMx=0;var t=this.localCOMy=0,e=this.lverts.next,i=e,n=e=e.next;for(e=e.next;null!=e;){var r=e;t+=n.x*(r.y-i.y);var o=r.y*n.x-r.x*n.y;this.localCOMx+=(n.x+r.x)*o,this.localCOMy+=(n.y+r.y)*o,i=n,n=r,e=e.next}var s=e=this.lverts.next;t+=n.x*(s.y-i.y);var a=s.y*n.x-s.x*n.y;this.localCOMx+=(n.x+s.x)*a,this.localCOMy+=(n.y+s.y)*a;var i=n,h=e=e.next;t+=s.x*(h.y-i.y);a=h.y*s.x-h.x*s.y;this.localCOMx+=(s.x+h.x)*a,this.localCOMy+=(s.y+h.y)*a;a=t=1/(3*t);this.localCOMx*=a,this.localCOMy*=a}},He.prototype.localCOM_validate=function(){if(this.zip_localCOM){if(this.zip_localCOM=!1,1==this.type){var t=this.polygon;if(null==t.lverts.next.next)t.localCOMx=t.lverts.next.x,t.localCOMy=t.lverts.next.y;else if(null==t.lverts.next.next.next)t.localCOMx=t.lverts.next.x,t.localCOMy=t.lverts.next.y,t.localCOMx+=t.lverts.next.next.x,t.localCOMy+=t.lverts.next.next.y,t.localCOMx*=.5,t.localCOMy*=.5;else{t.localCOMx=0;var e=t.localCOMy=0,i=t.lverts.next,n=i,r=i=i.next;for(i=i.next;null!=i;){var o=i;e+=r.x*(o.y-n.y);var s=o.y*r.x-o.x*r.y;t.localCOMx+=(r.x+o.x)*s,t.localCOMy+=(r.y+o.y)*s,n=r,r=o,i=i.next}var a=i=t.lverts.next;e+=r.x*(a.y-n.y);var h=a.y*r.x-a.x*r.y;t.localCOMx+=(r.x+a.x)*h,t.localCOMy+=(r.y+a.y)*h;var n=r,l=i=i.next;e+=a.x*(l.y-n.y);h=l.y*a.x-l.x*a.y;t.localCOMx+=(a.x+l.x)*h,t.localCOMy+=(a.y+l.y)*h;h=e=1/(3*e);t.localCOMx*=h,t.localCOMy*=h}}null!=this.wrap_localCOM&&(this.wrap_localCOM.zpp_inner.x=this.localCOMx,this.wrap_localCOM.zpp_inner.y=this.localCOMy)}},He.prototype.localCOM_invalidate=function(t){if(this.zip_localCOM){if(this.zip_localCOM=!1,1==this.type){var e=this.polygon;if(null==e.lverts.next.next)e.localCOMx=e.lverts.next.x,e.localCOMy=e.lverts.next.y;else if(null==e.lverts.next.next.next)e.localCOMx=e.lverts.next.x,e.localCOMy=e.lverts.next.y,e.localCOMx+=e.lverts.next.next.x,e.localCOMy+=e.lverts.next.next.y,e.localCOMx*=.5,e.localCOMy*=.5;else{e.localCOMx=0;var i=e.localCOMy=0,n=e.lverts.next,r=n,o=n=n.next;for(n=n.next;null!=n;){var s=n;i+=o.x*(s.y-r.y);var a=s.y*o.x-s.x*o.y;e.localCOMx+=(o.x+s.x)*a,e.localCOMy+=(o.y+s.y)*a,r=o,o=s,n=n.next}var h=n=e.lverts.next;i+=o.x*(h.y-r.y);var l=h.y*o.x-h.x*o.y;e.localCOMx+=(o.x+h.x)*l,e.localCOMy+=(o.y+h.y)*l;var r=o,p=n=n.next;i+=h.x*(p.y-r.y);l=p.y*h.x-p.x*h.y;e.localCOMx+=(h.x+p.x)*l,e.localCOMy+=(h.y+p.y)*l;l=i=1/(3*i);e.localCOMx*=l,e.localCOMy*=l}}null!=this.wrap_localCOM&&(this.wrap_localCOM.zpp_inner.x=this.localCOMx,this.wrap_localCOM.zpp_inner.y=this.localCOMy)}for(var u=t.x-this.localCOMx,d=t.y-this.localCOMy,c=this.lverts.next;null!=c;){var y=c;y.x+=u,y.y+=d,c=c.next}this.invalidate_lverts()},He.prototype.setupLocalCOM=function(){var t,e,i=this.localCOMx,n=this.localCOMy;null==Bn.poolVec2?t=new St:(t=Bn.poolVec2,Bn.poolVec2=t.zpp_pool,t.zpp_pool=null),null==t.zpp_inner?(null==Gr.zpp_pool?e=new Gr:(e=Gr.zpp_pool,Gr.zpp_pool=e.next,e.next=null),e.weak=!1,e._immutable=!1,e.x=i,e.y=n,t.zpp_inner=e,t.zpp_inner.outer=t):(null!=(e=t.zpp_inner)._validate&&e._validate(),t.zpp_inner.x==i&&(null!=(e=t.zpp_inner)._validate&&e._validate(),t.zpp_inner.y==n)||(t.zpp_inner.x=i,t.zpp_inner.y=n,null!=(n=t.zpp_inner)._invalidate&&n._invalidate(n))),t.zpp_inner.weak=!1,this.wrap_localCOM=t,this.wrap_localCOM.zpp_inner._inuse=!0,this.wrap_localCOM.zpp_inner._validate=Z(this,this.localCOM_validate),this.wrap_localCOM.zpp_inner._invalidate=Z(this,this.localCOM_invalidate)},He.prototype.__translate=function(t,e){for(var i=this.lverts.next;null!=i;){var n=i;n.x+=t,n.y+=e,i=i.next}this.invalidate_lverts()},He.prototype.__scale=function(t,e){for(var i=this.lverts.next;null!=i;){var n=i;n.x*=t,n.y*=e,i=i.next}this.invalidate_lverts()},He.prototype.__rotate=function(t,e){for(var i=this.lverts.next;null!=i;){var n=i,r=e*n.x-t*n.y,o=n.x*t+n.y*e;n.x=r,n.y=o,i=i.next}this.invalidate_lverts()},He.prototype.__transform=function(t){for(var e=this.lverts.next;null!=e;){var i=e,n=t.zpp_inner.a*i.x+t.zpp_inner.b*i.y+t.zpp_inner.tx;i.y=t.zpp_inner.c*i.x+t.zpp_inner.d*i.y+t.zpp_inner.ty,i.x=n,e=e.next}this.invalidate_lverts()},He.prototype.__copy=function(){var t=this.outer_zn;return null==t.zpp_inner_zn.wrap_lverts&&t.zpp_inner_zn.getlverts(),new yt(t.zpp_inner_zn.wrap_lverts).zpp_inner_zn},He.prototype.__class__=He;var qe=zpp_nape.space.ZPP_Broadphase=function(){this.circShape=null,this.matrix=null,this.aabbShape=null,this.dynab=null,this.sweep=null,this.is_sweep=!1,this.space=null};qe.__name__=["zpp_nape","space","ZPP_Broadphase"],qe.prototype.space=null,qe.prototype.is_sweep=null,qe.prototype.sweep=null,qe.prototype.dynab=null,qe.prototype.insert=function(t){(this.is_sweep?this.sweep:this.dynab).__insert(t)},qe.prototype.remove=function(t){(this.is_sweep?this.sweep:this.dynab).__remove(t)},qe.prototype.sync=function(t){if(this.is_sweep){if(!this.sweep.space.continuous&&t.zip_aabb&&null!=t.body)if(t.zip_aabb=!1,0==t.type){var e=t.circle;if(e.zip_worldCOM&&null!=e.body){if(e.zip_worldCOM=!1,e.zip_localCOM){if(e.zip_localCOM=!1,1==e.type){var i=e.polygon;if(null==i.lverts.next.next)i.localCOMx=i.lverts.next.x,i.localCOMy=i.lverts.next.y;else if(null==i.lverts.next.next.next)i.localCOMx=i.lverts.next.x,i.localCOMy=i.lverts.next.y,i.localCOMx+=i.lverts.next.next.x,i.localCOMy+=i.lverts.next.next.y,i.localCOMx*=.5,i.localCOMy*=.5;else{i.localCOMx=0;var n=i.localCOMy=0,r=i.lverts.next,o=r,s=r=r.next;for(r=r.next;null!=r;){var a=r;n+=s.x*(a.y-o.y);var h=a.y*s.x-a.x*s.y;i.localCOMx+=(s.x+a.x)*h,i.localCOMy+=(s.y+a.y)*h,o=s,s=a,r=r.next}var l=r=i.lverts.next;n+=s.x*(l.y-o.y);var p=l.y*s.x-l.x*s.y;i.localCOMx+=(s.x+l.x)*p,i.localCOMy+=(s.y+l.y)*p;var o=s,u=r=r.next;n+=l.x*(u.y-o.y);p=u.y*l.x-u.x*l.y;i.localCOMx+=(l.x+u.x)*p,i.localCOMy+=(l.y+u.y)*p;u=n=1/(3*n);i.localCOMx*=u,i.localCOMy*=u}}null!=e.wrap_localCOM&&(e.wrap_localCOM.zpp_inner.x=e.localCOMx,e.wrap_localCOM.zpp_inner.y=e.localCOMy)}p=e.body;p.zip_axis&&(p.zip_axis=!1,p.axisx=Math.sin(p.rot),p.axisy=Math.cos(p.rot)),e.worldCOMx=e.body.posx+(e.body.axisy*e.localCOMx-e.body.axisx*e.localCOMy),e.worldCOMy=e.body.posy+(e.localCOMx*e.body.axisx+e.localCOMy*e.body.axisy)}u=e.radius,p=e.radius;e.aabb.minx=e.worldCOMx-u,e.aabb.miny=e.worldCOMy-p,e.aabb.maxx=e.worldCOMx+u,e.aabb.maxy=e.worldCOMy+p}else{var d=t.polygon;if(d.zip_gverts&&null!=d.body){d.zip_gverts=!1,d.validate_lverts();var c=d.body;c.zip_axis&&(c.zip_axis=!1,c.axisx=Math.sin(c.rot),c.axisy=Math.cos(c.rot));for(var y=d.lverts.next,_=d.gverts.next;null!=_;){var m=_,g=y,y=y.next;m.x=d.body.posx+(d.body.axisy*g.x-d.body.axisx*g.y),m.y=d.body.posy+(g.x*d.body.axisx+g.y*d.body.axisy),_=_.next}}var f=d.gverts.next;d.aabb.minx=f.x,d.aabb.miny=f.y,d.aabb.maxx=f.x,d.aabb.maxy=f.y;for(var x=d.gverts.next.next;null!=x;){var v=x;v.x<d.aabb.minx&&(d.aabb.minx=v.x),v.x>d.aabb.maxx&&(d.aabb.maxx=v.x),v.y<d.aabb.miny&&(d.aabb.miny=v.y),v.y>d.aabb.maxy&&(d.aabb.maxy=v.y),x=x.next}}}else{e=this.dynab,p=t.node;if(!p.synced){if(!e.space.continuous&&t.zip_aabb&&null!=t.body)if(t.zip_aabb=!1,0==t.type){c=t.circle;if(c.zip_worldCOM&&null!=c.body){if(c.zip_worldCOM=!1,c.zip_localCOM){if(c.zip_localCOM=!1,1==c.type){var w=c.polygon;if(null==w.lverts.next.next)w.localCOMx=w.lverts.next.x,w.localCOMy=w.lverts.next.y;else if(null==w.lverts.next.next.next)w.localCOMx=w.lverts.next.x,w.localCOMy=w.lverts.next.y,w.localCOMx+=w.lverts.next.next.x,w.localCOMy+=w.lverts.next.next.y,w.localCOMx*=.5,w.localCOMy*=.5;else{w.localCOMx=0;var z=w.localCOMy=0,b=w.lverts.next,S=b,C=b=b.next;for(b=b.next;null!=b;){var P=b;z+=C.x*(P.y-S.y);var M=P.y*C.x-P.x*C.y;w.localCOMx+=(C.x+P.x)*M,w.localCOMy+=(C.y+P.y)*M,S=C,C=P,b=b.next}f=b=w.lverts.next;z+=C.x*(f.y-S.y);var T=f.y*C.x-f.x*C.y;w.localCOMx+=(C.x+f.x)*T,w.localCOMy+=(C.y+f.y)*T;var S=C,A=b=b.next;z+=f.x*(A.y-S.y);T=A.y*f.x-A.x*f.y;w.localCOMx+=(f.x+A.x)*T,w.localCOMy+=(f.y+A.y)*T;A=z=1/(3*z);w.localCOMx*=A,w.localCOMy*=A}}null!=c.wrap_localCOM&&(c.wrap_localCOM.zpp_inner.x=c.localCOMx,c.wrap_localCOM.zpp_inner.y=c.localCOMy)}T=c.body;T.zip_axis&&(T.zip_axis=!1,T.axisx=Math.sin(T.rot),T.axisy=Math.cos(T.rot)),c.worldCOMx=c.body.posx+(c.body.axisy*c.localCOMx-c.body.axisx*c.localCOMy),c.worldCOMy=c.body.posy+(c.localCOMx*c.body.axisx+c.localCOMy*c.body.axisy)}A=c.radius,T=c.radius;c.aabb.minx=c.worldCOMx-A,c.aabb.miny=c.worldCOMy-T,c.aabb.maxx=c.worldCOMx+A,c.aabb.maxy=c.worldCOMy+T}else{var k=t.polygon;if(k.zip_gverts&&null!=k.body){k.zip_gverts=!1,k.validate_lverts();var O=k.body;O.zip_axis&&(O.zip_axis=!1,O.axisx=Math.sin(O.rot),O.axisy=Math.cos(O.rot));for(var E=k.lverts.next,I=k.gverts.next;null!=I;){var G=I,D=E,E=E.next;G.x=k.body.posx+(k.body.axisy*D.x-k.body.axisx*D.y),G.y=k.body.posy+(D.x*k.body.axisx+D.y*k.body.axisy),I=I.next}}var O=k.gverts.next;k.aabb.minx=O.x,k.aabb.miny=O.y,k.aabb.maxx=O.x,k.aabb.maxy=O.y;for(var L=k.gverts.next.next;null!=L;){var B=L;B.x<k.aabb.minx&&(k.aabb.minx=B.x),B.x>k.aabb.maxx&&(k.aabb.maxx=B.x),B.y<k.aabb.miny&&(k.aabb.miny=B.y),B.y>k.aabb.maxy&&(k.aabb.maxy=B.y),L=L.next}}(p.dyn!=(1!=t.body.type&&!t.body.component.sleeping)||(O=p.aabb,!((t=t.aabb).minx>=O.minx&&t.miny>=O.miny&&t.maxx<=O.maxx&&t.maxy<=O.maxy)))&&(p.synced=!0,p.snext=e.syncs,e.syncs=p)}}},qe.prototype.broadphase=function(t,e){},qe.prototype.clear=function(){},qe.prototype.shapesUnderPoint=function(t,e,i,n){return null},qe.prototype.bodiesUnderPoint=function(t,e,i,n){return null},qe.prototype.aabbShape=null,qe.prototype.matrix=null,qe.prototype.updateAABBShape=function(t){var e,i,n;null==this.aabbShape?(null==Yn.BodyType_STATIC&&(Yn.internal=!0,Yn.BodyType_STATIC=new et,Yn.internal=!1),i=new $(Yn.BodyType_STATIC).zpp_inner.wrap_shapes,n=this.aabbShape=new yt(yt.rect(t.minx,t.miny,t.maxx-t.minx,t.maxy-t.miny)),i.zpp_inner.reverse_flag?i.push(n):i.unshift(n)):(r=this.aabbShape.zpp_inner.aabb,e=(t.maxx-t.minx)/(r.maxx-r.minx),c=(t.maxy-t.miny)/(r.maxy-r.miny),null==this.matrix&&(this.matrix=new V),(i=this.matrix).zpp_inner.a=e,null!=(n=i.zpp_inner)._invalidate&&n._invalidate(),o=this.matrix,(i=this.matrix).zpp_inner.c=0,null!=(n=i.zpp_inner)._invalidate&&n._invalidate(),o.zpp_inner.b=i.zpp_inner.c,null!=(o=o.zpp_inner)._invalidate&&o._invalidate(),(o=this.matrix).zpp_inner.d=c,null!=(o=o.zpp_inner)._invalidate&&o._invalidate(),(o=this.matrix).zpp_inner.tx=t.minx-e*r.minx,null!=(o=o.zpp_inner)._invalidate&&o._invalidate(),(o=this.matrix).zpp_inner.ty=t.miny-c*r.miny,null!=(c=o.zpp_inner)._invalidate&&c._invalidate(),this.aabbShape.transform(this.matrix));var r=this.aabbShape.zpp_inner;if(r.zip_aabb&&null!=r.body)if(r.zip_aabb=!1,0==r.type){var o=r.circle;if(o.zip_worldCOM&&null!=o.body){if(o.zip_worldCOM=!1,o.zip_localCOM){if(o.zip_localCOM=!1,1==o.type){var s=o.polygon;if(null==s.lverts.next.next)s.localCOMx=s.lverts.next.x,s.localCOMy=s.lverts.next.y;else if(null==s.lverts.next.next.next)s.localCOMx=s.lverts.next.x,s.localCOMy=s.lverts.next.y,s.localCOMx+=s.lverts.next.next.x,s.localCOMy+=s.lverts.next.next.y,s.localCOMx*=.5,s.localCOMy*=.5;else{s.localCOMx=0;var a=s.localCOMy=0,h=s.lverts.next,l=h,p=h=h.next;for(h=h.next;null!=h;){var u=h;a+=p.x*(u.y-l.y);var d=u.y*p.x-u.x*p.y;s.localCOMx+=(p.x+u.x)*d,s.localCOMy+=(p.y+u.y)*d,l=p,p=u,h=h.next}var c=h=s.lverts.next;a+=p.x*(c.y-l.y);var y=c.y*p.x-c.x*p.y;s.localCOMx+=(p.x+c.x)*y,s.localCOMy+=(p.y+c.y)*y;var l=p,_=h=h.next;a+=c.x*(_.y-l.y);y=_.y*c.x-_.x*c.y;s.localCOMx+=(c.x+_.x)*y,s.localCOMy+=(c.y+_.y)*y;_=a=1/(3*a);s.localCOMx*=_,s.localCOMy*=_}}null!=o.wrap_localCOM&&(o.wrap_localCOM.zpp_inner.x=o.localCOMx,o.wrap_localCOM.zpp_inner.y=o.localCOMy)}y=o.body;y.zip_axis&&(y.zip_axis=!1,y.axisx=Math.sin(y.rot),y.axisy=Math.cos(y.rot)),o.worldCOMx=o.body.posx+(o.body.axisy*o.localCOMx-o.body.axisx*o.localCOMy),o.worldCOMy=o.body.posy+(o.localCOMx*o.body.axisx+o.localCOMy*o.body.axisy)}_=o.radius,y=o.radius;o.aabb.minx=o.worldCOMx-_,o.aabb.miny=o.worldCOMy-y,o.aabb.maxx=o.worldCOMx+_,o.aabb.maxy=o.worldCOMy+y}else{var m=r.polygon;if(m.zip_gverts&&null!=m.body){m.zip_gverts=!1,m.validate_lverts();var g=m.body;g.zip_axis&&(g.zip_axis=!1,g.axisx=Math.sin(g.rot),g.axisy=Math.cos(g.rot));for(var f=m.lverts.next,x=m.gverts.next;null!=x;){var v=x,w=f,f=f.next;v.x=m.body.posx+(m.body.axisy*w.x-m.body.axisx*w.y),v.y=m.body.posy+(w.x*m.body.axisx+w.y*m.body.axisy),x=x.next}}g=m.gverts.next;m.aabb.minx=g.x,m.aabb.miny=g.y,m.aabb.maxx=g.x,m.aabb.maxy=g.y;for(var z=m.gverts.next.next;null!=z;){var b=z;b.x<m.aabb.minx&&(m.aabb.minx=b.x),b.x>m.aabb.maxx&&(m.aabb.maxx=b.x),b.y<m.aabb.miny&&(m.aabb.miny=b.y),b.y>m.aabb.maxy&&(m.aabb.maxy=b.y),z=z.next}}var S=this.aabbShape.zpp_inner.polygon;if(S.zip_gaxi&&null!=S.body){S.zip_gaxi=!1,S.validate_laxi();g=S.body;if(g.zip_axis&&(g.zip_axis=!1,g.axisx=Math.sin(g.rot),g.axisy=Math.cos(g.rot)),S.zip_gverts&&null!=S.body){S.zip_gverts=!1,S.validate_lverts();var C=S.body;C.zip_axis&&(C.zip_axis=!1,C.axisx=Math.sin(C.rot),C.axisy=Math.cos(C.rot));for(var P=S.lverts.next,M=S.gverts.next;null!=M;){var T=M,A=P,P=P.next;T.x=S.body.posx+(S.body.axisy*A.x-S.body.axisx*A.y),T.y=S.body.posy+(A.x*S.body.axisx+A.y*S.body.axisy),M=M.next}}for(var k=S.edges.head,O=E=S.gverts.next,E=E.next;null!=E;){var I=E,G=k.elt,k=k.next;G.gp0=O,G.gp1=I,G.gnormx=S.body.axisy*G.lnormx-S.body.axisx*G.lnormy,G.gnormy=G.lnormx*S.body.axisx+G.lnormy*S.body.axisy,G.gprojection=S.body.posx*G.gnormx+S.body.posy*G.gnormy+G.lprojection,null!=G.wrap_gnorm&&(G.wrap_gnorm.zpp_inner.x=G.gnormx,G.wrap_gnorm.zpp_inner.y=G.gnormy),G.tp0=G.gp0.y*G.gnormx-G.gp0.x*G.gnormy,G.tp1=G.gp1.y*G.gnormx-G.gp1.x*G.gnormy,O=I,E=E.next}C=k.elt;C.gp0=O,C.gp1=S.gverts.next,C.gnormx=S.body.axisy*C.lnormx-S.body.axisx*C.lnormy,C.gnormy=C.lnormx*S.body.axisx+C.lnormy*S.body.axisy,C.gprojection=S.body.posx*C.gnormx+S.body.posy*C.gnormy+C.lprojection,null!=C.wrap_gnorm&&(C.wrap_gnorm.zpp_inner.x=C.gnormx,C.wrap_gnorm.zpp_inner.y=C.gnormy),C.tp0=C.gp0.y*C.gnormx-C.gp0.x*C.gnormy,C.tp1=C.gp1.y*C.gnormx-C.gp1.x*C.gnormy}},qe.prototype.shapesInAABB=function(t,e,i,n,r){return null},qe.prototype.bodiesInAABB=function(t,e,i,n,r){return null},qe.prototype.circShape=null,qe.prototype.updateCircShape=function(t,e,i){var n,r,o,s;null==this.circShape?(null==Yn.BodyType_STATIC&&(Yn.internal=!0,Yn.BodyType_STATIC=new et,Yn.internal=!1),n=new $(Yn.BodyType_STATIC).zpp_inner.wrap_shapes,null==Bn.poolVec2?s=new St:(s=Bn.poolVec2,Bn.poolVec2=s.zpp_pool,s.zpp_pool=null),null==s.zpp_inner?(null==Gr.zpp_pool?r=new Gr:(r=Gr.zpp_pool,Gr.zpp_pool=r.next,r.next=null),r.weak=!1,r._immutable=!1,r.x=t,r.y=e,s.zpp_inner=r,s.zpp_inner.outer=s):(null!=(r=s.zpp_inner)._validate&&r._validate(),s.zpp_inner.x==t&&(null!=(o=s.zpp_inner)._validate&&o._validate(),s.zpp_inner.y==e)||(s.zpp_inner.x=t,s.zpp_inner.y=e,null!=(o=s.zpp_inner)._invalidate&&o._invalidate(o))),s.zpp_inner.weak=!1,s=this.circShape=new ut(i,s),n.zpp_inner.reverse_flag?n.push(s):n.unshift(s)):(m=i/(a=this.circShape.zpp_inner.circle).radius,null==this.matrix&&(this.matrix=new V),s=this.matrix,(h=this.matrix).zpp_inner.d=m,null!=(i=h.zpp_inner)._invalidate&&i._invalidate(),s.zpp_inner.a=h.zpp_inner.d,null!=(i=s.zpp_inner)._invalidate&&i._invalidate(),h=this.matrix,(s=this.matrix).zpp_inner.c=0,null!=(i=s.zpp_inner)._invalidate&&i._invalidate(),h.zpp_inner.b=s.zpp_inner.c,null!=(h=h.zpp_inner)._invalidate&&h._invalidate(),(h=this.matrix).zpp_inner.tx=t-m*a.localCOMx,null!=(h=h.zpp_inner)._invalidate&&h._invalidate(),(h=this.matrix).zpp_inner.ty=e-m*a.localCOMy,null!=(m=h.zpp_inner)._invalidate&&m._invalidate(),this.circShape.transform(this.matrix));var a=this.circShape.zpp_inner;if(a.zip_aabb&&null!=a.body)if(a.zip_aabb=!1,0==a.type){var h=a.circle;if(h.zip_worldCOM&&null!=h.body){if(h.zip_worldCOM=!1,h.zip_localCOM){if(h.zip_localCOM=!1,1==h.type){var l=h.polygon;if(null==l.lverts.next.next)l.localCOMx=l.lverts.next.x,l.localCOMy=l.lverts.next.y;else if(null==l.lverts.next.next.next)l.localCOMx=l.lverts.next.x,l.localCOMy=l.lverts.next.y,l.localCOMx+=l.lverts.next.next.x,l.localCOMy+=l.lverts.next.next.y,l.localCOMx*=.5,l.localCOMy*=.5;else{l.localCOMx=0;var p=l.localCOMy=0,u=l.lverts.next,d=u,c=u=u.next;for(u=u.next;null!=u;){var y=u;p+=c.x*(y.y-d.y);var _=y.y*c.x-y.x*c.y;l.localCOMx+=(c.x+y.x)*_,l.localCOMy+=(c.y+y.y)*_,d=c,c=y,u=u.next}var m=u=l.lverts.next;p+=c.x*(m.y-d.y);var g=m.y*c.x-m.x*c.y;l.localCOMx+=(c.x+m.x)*g,l.localCOMy+=(c.y+m.y)*g;var d=c,f=u=u.next;p+=m.x*(f.y-d.y);g=f.y*m.x-f.x*m.y;l.localCOMx+=(m.x+f.x)*g,l.localCOMy+=(m.y+f.y)*g;f=p=1/(3*p);l.localCOMx*=f,l.localCOMy*=f}}null!=h.wrap_localCOM&&(h.wrap_localCOM.zpp_inner.x=h.localCOMx,h.wrap_localCOM.zpp_inner.y=h.localCOMy)}g=h.body;g.zip_axis&&(g.zip_axis=!1,g.axisx=Math.sin(g.rot),g.axisy=Math.cos(g.rot)),h.worldCOMx=h.body.posx+(h.body.axisy*h.localCOMx-h.body.axisx*h.localCOMy),h.worldCOMy=h.body.posy+(h.localCOMx*h.body.axisx+h.localCOMy*h.body.axisy)}f=h.radius,g=h.radius;h.aabb.minx=h.worldCOMx-f,h.aabb.miny=h.worldCOMy-g,h.aabb.maxx=h.worldCOMx+f,h.aabb.maxy=h.worldCOMy+g}else{var x=a.polygon;if(x.zip_gverts&&null!=x.body){x.zip_gverts=!1,x.validate_lverts();var v=x.body;v.zip_axis&&(v.zip_axis=!1,v.axisx=Math.sin(v.rot),v.axisy=Math.cos(v.rot));for(var w=x.lverts.next,z=x.gverts.next;null!=z;){var b=z,S=w,w=w.next;b.x=x.body.posx+(x.body.axisy*S.x-x.body.axisx*S.y),b.y=x.body.posy+(S.x*x.body.axisx+S.y*x.body.axisy),z=z.next}}v=x.gverts.next;x.aabb.minx=v.x,x.aabb.miny=v.y,x.aabb.maxx=v.x,x.aabb.maxy=v.y;for(var C=x.gverts.next.next;null!=C;){var P=C;P.x<x.aabb.minx&&(x.aabb.minx=P.x),P.x>x.aabb.maxx&&(x.aabb.maxx=P.x),P.y<x.aabb.miny&&(x.aabb.miny=P.y),P.y>x.aabb.maxy&&(x.aabb.maxy=P.y),C=C.next}}},qe.prototype.shapesInCircle=function(t,e,i,n,r,o){return null},qe.prototype.bodiesInCircle=function(t,e,i,n,r,o){return null},qe.prototype.validateShape=function(t){if(1==t.type){var e=t.polygon;if(e.zip_gaxi&&null!=e.body){e.zip_gaxi=!1,e.validate_laxi();var i=e.body;if(i.zip_axis&&(i.zip_axis=!1,i.axisx=Math.sin(i.rot),i.axisy=Math.cos(i.rot)),e.zip_gverts&&null!=e.body){e.zip_gverts=!1,e.validate_lverts();var n=e.body;n.zip_axis&&(n.zip_axis=!1,n.axisx=Math.sin(n.rot),n.axisy=Math.cos(n.rot));for(var r=e.lverts.next,o=e.gverts.next;null!=o;){var s=o,a=r,r=r.next;s.x=e.body.posx+(e.body.axisy*a.x-e.body.axisx*a.y),s.y=e.body.posy+(a.x*e.body.axisx+a.y*e.body.axisy),o=o.next}}for(var h=e.edges.head,l=p=e.gverts.next,p=p.next;null!=p;){var u=p,d=h.elt,h=h.next;d.gp0=l,d.gp1=u,d.gnormx=e.body.axisy*d.lnormx-e.body.axisx*d.lnormy,d.gnormy=d.lnormx*e.body.axisx+d.lnormy*e.body.axisy,d.gprojection=e.body.posx*d.gnormx+e.body.posy*d.gnormy+d.lprojection,null!=d.wrap_gnorm&&(d.wrap_gnorm.zpp_inner.x=d.gnormx,d.wrap_gnorm.zpp_inner.y=d.gnormy),d.tp0=d.gp0.y*d.gnormx-d.gp0.x*d.gnormy,d.tp1=d.gp1.y*d.gnormx-d.gp1.x*d.gnormy,l=u,p=p.next}i=h.elt;i.gp0=l,i.gp1=e.gverts.next,i.gnormx=e.body.axisy*i.lnormx-e.body.axisx*i.lnormy,i.gnormy=i.lnormx*e.body.axisx+i.lnormy*e.body.axisy,i.gprojection=e.body.posx*i.gnormx+e.body.posy*i.gnormy+i.lprojection,null!=i.wrap_gnorm&&(i.wrap_gnorm.zpp_inner.x=i.gnormx,i.wrap_gnorm.zpp_inner.y=i.gnormy),i.tp0=i.gp0.y*i.gnormx-i.gp0.x*i.gnormy,i.tp1=i.gp1.y*i.gnormx-i.gp1.x*i.gnormy}}if(t.zip_aabb&&null!=t.body)if(t.zip_aabb=!1,0==t.type){n=t.circle;if(n.zip_worldCOM&&null!=n.body){if(n.zip_worldCOM=!1,n.zip_localCOM){if(n.zip_localCOM=!1,1==n.type){var c=n.polygon;if(null==c.lverts.next.next)c.localCOMx=c.lverts.next.x,c.localCOMy=c.lverts.next.y;else if(null==c.lverts.next.next.next)c.localCOMx=c.lverts.next.x,c.localCOMy=c.lverts.next.y,c.localCOMx+=c.lverts.next.next.x,c.localCOMy+=c.lverts.next.next.y,c.localCOMx*=.5,c.localCOMy*=.5;else{c.localCOMx=0;var y=c.localCOMy=0,_=c.lverts.next,m=_,g=_=_.next;for(_=_.next;null!=_;){var f=_;y+=g.x*(f.y-m.y);var x=f.y*g.x-f.x*g.y;c.localCOMx+=(g.x+f.x)*x,c.localCOMy+=(g.y+f.y)*x,m=g,g=f,_=_.next}i=_=c.lverts.next;y+=g.x*(i.y-m.y);var v=i.y*g.x-i.x*g.y;c.localCOMx+=(g.x+i.x)*v,c.localCOMy+=(g.y+i.y)*v;var m=g,w=_=_.next;y+=i.x*(w.y-m.y);v=w.y*i.x-w.x*i.y;c.localCOMx+=(i.x+w.x)*v,c.localCOMy+=(i.y+w.y)*v;w=y=1/(3*y);c.localCOMx*=w,c.localCOMy*=w}}null!=n.wrap_localCOM&&(n.wrap_localCOM.zpp_inner.x=n.localCOMx,n.wrap_localCOM.zpp_inner.y=n.localCOMy)}v=n.body;v.zip_axis&&(v.zip_axis=!1,v.axisx=Math.sin(v.rot),v.axisy=Math.cos(v.rot)),n.worldCOMx=n.body.posx+(n.body.axisy*n.localCOMx-n.body.axisx*n.localCOMy),n.worldCOMy=n.body.posy+(n.localCOMx*n.body.axisx+n.localCOMy*n.body.axisy)}w=n.radius,v=n.radius;n.aabb.minx=n.worldCOMx-w,n.aabb.miny=n.worldCOMy-v,n.aabb.maxx=n.worldCOMx+w,n.aabb.maxy=n.worldCOMy+v}else{var z=t.polygon;if(z.zip_gverts&&null!=z.body){z.zip_gverts=!1,z.validate_lverts();var b=z.body;b.zip_axis&&(b.zip_axis=!1,b.axisx=Math.sin(b.rot),b.axisy=Math.cos(b.rot));for(var S=z.lverts.next,C=z.gverts.next;null!=C;){var P=C,M=S,S=S.next;P.x=z.body.posx+(z.body.axisy*M.x-z.body.axisx*M.y),P.y=z.body.posy+(M.x*z.body.axisx+M.y*z.body.axisy),C=C.next}}var T=z.gverts.next;z.aabb.minx=T.x,z.aabb.miny=T.y,z.aabb.maxx=T.x,z.aabb.maxy=T.y;for(var A=z.gverts.next.next;null!=A;){var k=A;k.x<z.aabb.minx&&(z.aabb.minx=k.x),k.x>z.aabb.maxx&&(z.aabb.maxx=k.x),k.y<z.aabb.miny&&(z.aabb.miny=k.y),k.y>z.aabb.maxy&&(z.aabb.maxy=k.y),A=A.next}}if(t.zip_worldCOM&&null!=t.body){if(t.zip_worldCOM=!1,t.zip_localCOM){if(t.zip_localCOM=!1,1==t.type){var O=t.polygon;if(null==O.lverts.next.next)O.localCOMx=O.lverts.next.x,O.localCOMy=O.lverts.next.y;else if(null==O.lverts.next.next.next)O.localCOMx=O.lverts.next.x,O.localCOMy=O.lverts.next.y,O.localCOMx+=O.lverts.next.next.x,O.localCOMy+=O.lverts.next.next.y,O.localCOMx*=.5,O.localCOMy*=.5;else{O.localCOMx=0;var E=O.localCOMy=0,I=O.lverts.next,G=I,D=I=I.next;for(I=I.next;null!=I;){var L=I;E+=D.x*(L.y-G.y);var B=L.y*D.x-L.x*D.y;O.localCOMx+=(D.x+L.x)*B,O.localCOMy+=(D.y+L.y)*B,G=D,D=L,I=I.next}b=I=O.lverts.next;E+=D.x*(b.y-G.y);var R=b.y*D.x-b.x*D.y;O.localCOMx+=(D.x+b.x)*R,O.localCOMy+=(D.y+b.y)*R;G=D,T=I=I.next;E+=b.x*(T.y-G.y);R=T.y*b.x-T.x*b.y;O.localCOMx+=(b.x+T.x)*R,O.localCOMy+=(b.y+T.y)*R;R=E=1/(3*E);O.localCOMx*=R,O.localCOMy*=R}}null!=t.wrap_localCOM&&(t.wrap_localCOM.zpp_inner.x=t.localCOMx,t.wrap_localCOM.zpp_inner.y=t.localCOMy)}R=t.body;R.zip_axis&&(R.zip_axis=!1,R.axisx=Math.sin(R.rot),R.axisy=Math.cos(R.rot)),t.worldCOMx=t.body.posx+(t.body.axisy*t.localCOMx-t.body.axisx*t.localCOMy),t.worldCOMy=t.body.posy+(t.localCOMx*t.body.axisx+t.localCOMy*t.body.axisy)}},qe.prototype.shapesInShape=function(t,e,i,n){return null},qe.prototype.bodiesInShape=function(t,e,i,n){return null},qe.prototype.rayCast=function(t,e,i){return null},qe.prototype.rayMultiCast=function(t,e,i,n){return null},qe.prototype.__class__=qe;var Ye=zpp_nape.space.ZPP_AABBNode=function(){this.first_sync=!1,this.synced=!1,this.snext=null,this.moved=!1,this.mnext=null,this.next=null,this.rayt=0,this.height=0,this.child2=null,this.child1=null,this.parent=null,this.dyn=!1,this.shape=null,this.aabb=null,this.height=-1};Ye.__name__=["zpp_nape","space","ZPP_AABBNode"],Ye.prototype.aabb=null,Ye.prototype.shape=null,Ye.prototype.dyn=null,Ye.prototype.parent=null,Ye.prototype.child1=null,Ye.prototype.child2=null,Ye.prototype.height=null,Ye.prototype.rayt=null,Ye.prototype.next=null,Ye.prototype.alloc=function(){null==De.zpp_pool?this.aabb=new De:(this.aabb=De.zpp_pool,De.zpp_pool=this.aabb.next,this.aabb.next=null),this.moved=!1,this.synced=!1,this.first_sync=!1},Ye.prototype.free=function(){this.height=-1;var t=this.aabb;null!=t.outer&&(t.outer.zpp_inner=null,t.outer=null),t.wrap_min=t.wrap_max=null,t._invalidate=null,t._validate=null,t.next=De.zpp_pool,De.zpp_pool=t,this.child1=this.child2=this.parent=null,this.next=null,this.snext=null,this.mnext=null},Ye.prototype.mnext=null,Ye.prototype.moved=null,Ye.prototype.snext=null,Ye.prototype.synced=null,Ye.prototype.first_sync=null,Ye.prototype.isLeaf=function(){return null==this.child1},Ye.prototype.__class__=Ye;var Ke=zpp_nape.space.ZPP_AABBPair=function(){this.next=null,this.arb=null,this.di=0,this.id=0,this.sleeping=!1,this.first=!1,this.n2=null,this.n1=null};Ke.__name__=["zpp_nape","space","ZPP_AABBPair"],Ke.prototype.n1=null,Ke.prototype.n2=null,Ke.prototype.first=null,Ke.prototype.sleeping=null,Ke.prototype.id=null,Ke.prototype.di=null,Ke.prototype.arb=null,Ke.prototype.next=null,Ke.prototype.alloc=function(){},Ke.prototype.free=function(){this.n1=this.n2=null,this.sleeping=!1},Ke.prototype.__class__=Ke;var Ze=zpp_nape.space.ZPP_AABBTree=function(){this.root=null};Ze.__name__=["zpp_nape","space","ZPP_AABBTree"],Ze.prototype.root=null,Ze.prototype.clear=function(){if(null!=this.root){var t=null;for(this.root.next=t,t=this.root;null!=t;){var e=t,t=e.next;(e.next=null)==e.child1?(e.shape.node=null,e.shape.removedFromSpace(),e.shape=null):(null!=e.child1&&(e.child1.next=t,t=e.child1),null!=e.child2&&(e.child2.next=t,t=e.child2)),e.height=-1;var i=e.aabb;null!=i.outer&&(i.outer.zpp_inner=null,i.outer=null),i.wrap_min=i.wrap_max=null,i._invalidate=null,i._validate=null,i.next=De.zpp_pool,De.zpp_pool=i,e.child1=e.child2=e.parent=null,e.next=null,e.snext=null,e.mnext=null,e.next=Ye.zpp_pool,Ye.zpp_pool=e}this.root=null}},Ze.prototype.insertLeaf=function(t){if(null==this.root)this.root=t,this.root.parent=null;else{for(var e=t.aabb,i=this.root;null!=i.child1;){var n=i.child1,r=i.child2,o=i.aabb,s=2*(o.maxx-o.minx+(o.maxy-o.miny)),a=Ze.tmpaabb,h=i.aabb;a.minx=(h.minx<e.minx?h:e).minx,a.miny=(h.miny<e.miny?h:e).miny,a.maxx=(h.maxx>e.maxx?h:e).maxx,a.maxy=(h.maxy>e.maxy?h:e).maxy;var l,o=Ze.tmpaabb,a=2*(o.maxx-o.minx+(o.maxy-o.miny)),h=2*a,o=2*(a-s),a=Ze.tmpaabb,s=n.aabb;a.minx=(e.minx<s.minx?e:s).minx,a.miny=(e.miny<s.miny?e:s).miny,a.maxx=(e.maxx>s.maxx?e:s).maxx,a.maxy=(e.maxy>s.maxy?e:s).maxy,l=null==n.child1?2*((s=Ze.tmpaabb).maxx-s.minx+(s.maxy-s.miny))+o:(d=2*((l=n.aabb).maxx-l.minx+(l.maxy-l.miny)),2*((u=Ze.tmpaabb).maxx-u.minx+(u.maxy-u.miny))-d+o);var p,u=Ze.tmpaabb,d=r.aabb;if(u.minx=(e.minx<d.minx?e:d).minx,u.miny=(e.miny<d.miny?e:d).miny,u.maxx=(e.maxx>d.maxx?e:d).maxx,u.maxy=(e.maxy>d.maxy?e:d).maxy,o=null==r.child1?2*((p=Ze.tmpaabb).maxx-p.minx+(p.maxy-p.miny))+o:(p=2*((d=r.aabb).maxx-d.minx+(d.maxy-d.miny)),2*((d=Ze.tmpaabb).maxx-d.minx+(d.maxy-d.miny))-p+o),h<l&&h<o)break;i=l<o?n:r}var c,y=i,_=y.parent;null==Ye.zpp_pool?c=new Ye:(c=Ye.zpp_pool,Ye.zpp_pool=c.next,c.next=null),null==De.zpp_pool?c.aabb=new De:(c.aabb=De.zpp_pool,De.zpp_pool=c.aabb.next,c.aabb.next=null),c.moved=!1,c.synced=!1,c.first_sync=!1,c.parent=_;var m,g,f,x,v,w,z,b,S,C,P=c.aabb,M=y.aabb;for(P.minx=(e.minx<M.minx?e:M).minx,P.miny=(e.miny<M.miny?e:M).miny,P.maxx=(e.maxx>M.maxx?e:M).maxx,P.maxy=(e.maxy>M.maxy?e:M).maxy,c.height=y.height+1,null!=_?(_.child1==y?_.child1=c:_.child2=c,c.child1=y,c.child2=t,y.parent=c,t.parent=c):(c.child1=y,c.child2=t,y.parent=c,t.parent=c,this.root=c),i=t.parent;null!=i;){null==i.child1||i.height<2||(O=i.child1,1<(S=(m=i.child2).height-O.height)?(g=m.child1,f=m.child2,m.child1=i,m.parent=i.parent,null!=(i.parent=m).parent?m.parent.child1==i?m.parent.child1=m:m.parent.child2=m:this.root=m,g.height>f.height?(m.child2=g,x=((i.child2=f).parent=i).aabb,v=O.aabb,w=f.aabb,x.minx=(v.minx<w.minx?v:w).minx,x.miny=(v.miny<w.miny?v:w).miny,x.maxx=(v.maxx>w.maxx?v:w).maxx,x.maxy=(v.maxy>w.maxy?v:w).maxy,x=m.aabb,v=i.aabb,w=g.aabb,x.minx=(v.minx<w.minx?v:w).minx,x.miny=(v.miny<w.miny?v:w).miny,x.maxx=(v.maxx>w.maxx?v:w).maxx,x.maxy=(v.maxy>w.maxy?v:w).maxy,v=O.height,w=f.height,i.height=1+(w<v?v:w),v=i.height,w=g.height,m.height=1+(w<v?v:w)):(m.child2=f,w=((i.child2=g).parent=i).aabb,z=O.aabb,b=g.aabb,w.minx=(z.minx<b.minx?z:b).minx,w.miny=(z.miny<b.miny?z:b).miny,w.maxx=(z.maxx>b.maxx?z:b).maxx,w.maxy=(z.maxy>b.maxy?z:b).maxy,w=m.aabb,z=i.aabb,b=f.aabb,w.minx=(z.minx<b.minx?z:b).minx,w.miny=(z.miny<b.miny?z:b).miny,w.maxx=(z.maxx>b.maxx?z:b).maxx,w.maxy=(z.maxy>b.maxy?z:b).maxy,z=O.height,b=g.height,i.height=1+(b<z?z:b),z=i.height,b=f.height,m.height=1+(b<z?z:b)),i=m):S<-1&&(z=O.child1,T=O.child2,O.child1=i,O.parent=i.parent,null!=(i.parent=O).parent?O.parent.child1==i?O.parent.child1=O:O.parent.child2=O:this.root=O,z.height>T.height?(O.child2=z,b=((i.child1=T).parent=i).aabb,S=m.aabb,C=T.aabb,b.minx=(S.minx<C.minx?S:C).minx,b.miny=(S.miny<C.miny?S:C).miny,b.maxx=(S.maxx>C.maxx?S:C).maxx,b.maxy=(S.maxy>C.maxy?S:C).maxy,b=O.aabb,S=i.aabb,C=z.aabb,b.minx=(S.minx<C.minx?S:C).minx,b.miny=(S.miny<C.miny?S:C).miny,b.maxx=(S.maxx>C.maxx?S:C).maxx,b.maxy=(S.maxy>C.maxy?S:C).maxy,S=m.height,C=T.height,i.height=1+(C<S?S:C),S=i.height,C=z.height,O.height=1+(C<S?S:C)):(O.child2=T,C=((i.child1=z).parent=i).aabb,A=m.aabb,k=z.aabb,C.minx=(A.minx<k.minx?A:k).minx,C.miny=(A.miny<k.miny?A:k).miny,C.maxx=(A.maxx>k.maxx?A:k).maxx,C.maxy=(A.maxy>k.maxy?A:k).maxy,C=O.aabb,A=i.aabb,k=T.aabb,C.minx=(A.minx<k.minx?A:k).minx,C.miny=(A.miny<k.miny?A:k).miny,C.maxx=(A.maxx>k.maxx?A:k).maxx,C.maxy=(A.maxy>k.maxy?A:k).maxy,A=m.height,k=z.height,i.height=1+(k<A?A:k),A=i.height,k=T.height,O.height=1+(k<A?A:k)),i=O));var T=i.child1,A=i.child2,k=T.height,O=A.height;i.height=1+(O<k?k:O);O=i.aabb,T=T.aabb,A=A.aabb;O.minx=(T.minx<A.minx?T:A).minx,O.miny=(T.miny<A.miny?T:A).miny,O.maxx=(T.maxx>A.maxx?T:A).maxx,O.maxy=(T.maxy>A.maxy?T:A).maxy,i=i.parent}}},Ze.prototype.inlined_insertLeaf=function(t){if(null==this.root)this.root=t,this.root.parent=null;else{for(var e=t.aabb,i=this.root;null!=i.child1;){var n=i.child1,r=i.child2,o=i.aabb,s=2*(o.maxx-o.minx+(o.maxy-o.miny)),a=Ze.tmpaabb,h=i.aabb;a.minx=(h.minx<e.minx?h:e).minx,a.miny=(h.miny<e.miny?h:e).miny,a.maxx=(h.maxx>e.maxx?h:e).maxx,a.maxy=(h.maxy>e.maxy?h:e).maxy;var l,o=Ze.tmpaabb,a=2*(o.maxx-o.minx+(o.maxy-o.miny)),h=2*a,o=2*(a-s),a=Ze.tmpaabb,s=n.aabb;a.minx=(e.minx<s.minx?e:s).minx,a.miny=(e.miny<s.miny?e:s).miny,a.maxx=(e.maxx>s.maxx?e:s).maxx,a.maxy=(e.maxy>s.maxy?e:s).maxy,l=null==n.child1?2*((s=Ze.tmpaabb).maxx-s.minx+(s.maxy-s.miny))+o:(d=2*((l=n.aabb).maxx-l.minx+(l.maxy-l.miny)),2*((u=Ze.tmpaabb).maxx-u.minx+(u.maxy-u.miny))-d+o);var p,u=Ze.tmpaabb,d=r.aabb;if(u.minx=(e.minx<d.minx?e:d).minx,u.miny=(e.miny<d.miny?e:d).miny,u.maxx=(e.maxx>d.maxx?e:d).maxx,u.maxy=(e.maxy>d.maxy?e:d).maxy,o=null==r.child1?2*((p=Ze.tmpaabb).maxx-p.minx+(p.maxy-p.miny))+o:(p=2*((d=r.aabb).maxx-d.minx+(d.maxy-d.miny)),2*((d=Ze.tmpaabb).maxx-d.minx+(d.maxy-d.miny))-p+o),h<l&&h<o)break;i=l<o?n:r}var c,y=i,_=y.parent;null==Ye.zpp_pool?c=new Ye:(c=Ye.zpp_pool,Ye.zpp_pool=c.next,c.next=null),null==De.zpp_pool?c.aabb=new De:(c.aabb=De.zpp_pool,De.zpp_pool=c.aabb.next,c.aabb.next=null),c.moved=!1,c.synced=!1,c.first_sync=!1,c.parent=_;var m,g,f,x,v,w,z,b,S,C,P=c.aabb,M=y.aabb;for(P.minx=(e.minx<M.minx?e:M).minx,P.miny=(e.miny<M.miny?e:M).miny,P.maxx=(e.maxx>M.maxx?e:M).maxx,P.maxy=(e.maxy>M.maxy?e:M).maxy,c.height=y.height+1,null!=_?(_.child1==y?_.child1=c:_.child2=c,c.child1=y,c.child2=t,y.parent=c,t.parent=c):(c.child1=y,c.child2=t,y.parent=c,t.parent=c,this.root=c),i=t.parent;null!=i;){null==i.child1||i.height<2||(O=i.child1,1<(S=(m=i.child2).height-O.height)?(g=m.child1,f=m.child2,m.child1=i,m.parent=i.parent,null!=(i.parent=m).parent?m.parent.child1==i?m.parent.child1=m:m.parent.child2=m:this.root=m,g.height>f.height?(m.child2=g,x=((i.child2=f).parent=i).aabb,v=O.aabb,w=f.aabb,x.minx=(v.minx<w.minx?v:w).minx,x.miny=(v.miny<w.miny?v:w).miny,x.maxx=(v.maxx>w.maxx?v:w).maxx,x.maxy=(v.maxy>w.maxy?v:w).maxy,x=m.aabb,v=i.aabb,w=g.aabb,x.minx=(v.minx<w.minx?v:w).minx,x.miny=(v.miny<w.miny?v:w).miny,x.maxx=(v.maxx>w.maxx?v:w).maxx,x.maxy=(v.maxy>w.maxy?v:w).maxy,v=O.height,w=f.height,i.height=1+(w<v?v:w),v=i.height,w=g.height,m.height=1+(w<v?v:w)):(m.child2=f,w=((i.child2=g).parent=i).aabb,z=O.aabb,b=g.aabb,w.minx=(z.minx<b.minx?z:b).minx,w.miny=(z.miny<b.miny?z:b).miny,w.maxx=(z.maxx>b.maxx?z:b).maxx,w.maxy=(z.maxy>b.maxy?z:b).maxy,w=m.aabb,z=i.aabb,b=f.aabb,w.minx=(z.minx<b.minx?z:b).minx,w.miny=(z.miny<b.miny?z:b).miny,w.maxx=(z.maxx>b.maxx?z:b).maxx,w.maxy=(z.maxy>b.maxy?z:b).maxy,z=O.height,b=g.height,i.height=1+(b<z?z:b),z=i.height,b=f.height,m.height=1+(b<z?z:b)),i=m):S<-1&&(z=O.child1,T=O.child2,O.child1=i,O.parent=i.parent,null!=(i.parent=O).parent?O.parent.child1==i?O.parent.child1=O:O.parent.child2=O:this.root=O,z.height>T.height?(O.child2=z,b=((i.child1=T).parent=i).aabb,S=m.aabb,C=T.aabb,b.minx=(S.minx<C.minx?S:C).minx,b.miny=(S.miny<C.miny?S:C).miny,b.maxx=(S.maxx>C.maxx?S:C).maxx,b.maxy=(S.maxy>C.maxy?S:C).maxy,b=O.aabb,S=i.aabb,C=z.aabb,b.minx=(S.minx<C.minx?S:C).minx,b.miny=(S.miny<C.miny?S:C).miny,b.maxx=(S.maxx>C.maxx?S:C).maxx,b.maxy=(S.maxy>C.maxy?S:C).maxy,S=m.height,C=T.height,i.height=1+(C<S?S:C),S=i.height,C=z.height,O.height=1+(C<S?S:C)):(O.child2=T,C=((i.child1=z).parent=i).aabb,A=m.aabb,k=z.aabb,C.minx=(A.minx<k.minx?A:k).minx,C.miny=(A.miny<k.miny?A:k).miny,C.maxx=(A.maxx>k.maxx?A:k).maxx,C.maxy=(A.maxy>k.maxy?A:k).maxy,C=O.aabb,A=i.aabb,k=T.aabb,C.minx=(A.minx<k.minx?A:k).minx,C.miny=(A.miny<k.miny?A:k).miny,C.maxx=(A.maxx>k.maxx?A:k).maxx,C.maxy=(A.maxy>k.maxy?A:k).maxy,A=m.height,k=z.height,i.height=1+(k<A?A:k),A=i.height,k=T.height,O.height=1+(k<A?A:k)),i=O));var T=i.child1,A=i.child2,k=T.height,O=A.height;i.height=1+(O<k?k:O);O=i.aabb,T=T.aabb,A=A.aabb;O.minx=(T.minx<A.minx?T:A).minx,O.miny=(T.miny<A.miny?T:A).miny,O.maxx=(T.maxx>A.maxx?T:A).maxx,O.maxy=(T.maxy>A.maxy?T:A).maxy,i=i.parent}}},Ze.prototype.removeLeaf=function(t){if(t==this.root)this.root=null;else{var e=t.parent,i=e.parent,n=e.child1==t?e.child2:e.child1;if(null!=i){i.child1==e?i.child1=n:i.child2=n,n.parent=i,e.height=-1;t=e.aabb;null!=t.outer&&(t.outer.zpp_inner=null,t.outer=null),t.wrap_min=t.wrap_max=null,t._invalidate=null,t._validate=null,t.next=De.zpp_pool,De.zpp_pool=t,e.child1=e.child2=e.parent=null,e.next=null,e.snext=null,e.mnext=null,e.next=Ye.zpp_pool,Ye.zpp_pool=e;for(var r,o,s,a,h,l,p,u,d,c=i;null!=c;){null==c.child1||c.height<2||(f=c.child1,1<(d=(r=c.child2).height-f.height)?(o=r.child1,l=r.child2,r.child1=c,r.parent=c.parent,null!=(c.parent=r).parent?r.parent.child1==c?r.parent.child1=r:r.parent.child2=r:this.root=r,o.height>l.height?(r.child2=o,s=((c.child2=l).parent=c).aabb,a=f.aabb,h=l.aabb,s.minx=(a.minx<h.minx?a:h).minx,s.miny=(a.miny<h.miny?a:h).miny,s.maxx=(a.maxx>h.maxx?a:h).maxx,s.maxy=(a.maxy>h.maxy?a:h).maxy,s=r.aabb,a=c.aabb,h=o.aabb,s.minx=(a.minx<h.minx?a:h).minx,s.miny=(a.miny<h.miny?a:h).miny,s.maxx=(a.maxx>h.maxx?a:h).maxx,s.maxy=(a.maxy>h.maxy?a:h).maxy,a=f.height,h=l.height,c.height=1+(h<a?a:h),a=c.height,h=o.height,r.height=1+(h<a?a:h)):(r.child2=l,h=((c.child2=o).parent=c).aabb,p=f.aabb,u=o.aabb,h.minx=(p.minx<u.minx?p:u).minx,h.miny=(p.miny<u.miny?p:u).miny,h.maxx=(p.maxx>u.maxx?p:u).maxx,h.maxy=(p.maxy>u.maxy?p:u).maxy,h=r.aabb,p=c.aabb,u=l.aabb,h.minx=(p.minx<u.minx?p:u).minx,h.miny=(p.miny<u.miny?p:u).miny,h.maxx=(p.maxx>u.maxx?p:u).maxx,h.maxy=(p.maxy>u.maxy?p:u).maxy,p=f.height,u=o.height,c.height=1+(u<p?p:u),p=c.height,u=l.height,r.height=1+(u<p?p:u)),c=r):d<-1&&(l=f.child1,_=f.child2,f.child1=c,f.parent=c.parent,null!=(c.parent=f).parent?f.parent.child1==c?f.parent.child1=f:f.parent.child2=f:this.root=f,l.height>_.height?(f.child2=l,p=((c.child1=_).parent=c).aabb,u=r.aabb,d=_.aabb,p.minx=(u.minx<d.minx?u:d).minx,p.miny=(u.miny<d.miny?u:d).miny,p.maxx=(u.maxx>d.maxx?u:d).maxx,p.maxy=(u.maxy>d.maxy?u:d).maxy,p=f.aabb,u=c.aabb,d=l.aabb,p.minx=(u.minx<d.minx?u:d).minx,p.miny=(u.miny<d.miny?u:d).miny,p.maxx=(u.maxx>d.maxx?u:d).maxx,p.maxy=(u.maxy>d.maxy?u:d).maxy,u=r.height,d=_.height,c.height=1+(d<u?u:d),u=c.height,d=l.height,f.height=1+(d<u?u:d)):(f.child2=_,g=((c.child1=l).parent=c).aabb,y=r.aabb,m=l.aabb,g.minx=(y.minx<m.minx?y:m).minx,g.miny=(y.miny<m.miny?y:m).miny,g.maxx=(y.maxx>m.maxx?y:m).maxx,g.maxy=(y.maxy>m.maxy?y:m).maxy,g=f.aabb,y=c.aabb,m=_.aabb,g.minx=(y.minx<m.minx?y:m).minx,g.miny=(y.miny<m.miny?y:m).miny,g.maxx=(y.maxx>m.maxx?y:m).maxx,g.maxy=(y.maxy>m.maxy?y:m).maxy,g=r.height,y=l.height,c.height=1+(y<g?g:y),m=c.height,g=_.height,f.height=1+(g<m?m:g)),c=f));var y=c.child1,_=c.child2,m=c.aabb,g=y.aabb,f=_.aabb;m.minx=(g.minx<f.minx?g:f).minx,m.miny=(g.miny<f.miny?g:f).miny,m.maxx=(g.maxx>f.maxx?g:f).maxx,m.maxy=(g.maxy>f.maxy?g:f).maxy;y=y.height,_=_.height;c.height=1+(_<y?y:_),c=c.parent}}else{(this.root=n).parent=null,e.height=-1;n=e.aabb;null!=n.outer&&(n.outer.zpp_inner=null,n.outer=null),n.wrap_min=n.wrap_max=null,n._invalidate=null,n._validate=null,n.next=De.zpp_pool,De.zpp_pool=n,e.child1=e.child2=e.parent=null,e.next=null,e.snext=null,e.mnext=null,e.next=Ye.zpp_pool,Ye.zpp_pool=e}}},Ze.prototype.inlined_removeLeaf=function(t){if(t==this.root)this.root=null;else{var e=t.parent,i=e.parent,n=e.child1==t?e.child2:e.child1;if(null!=i){i.child1==e?i.child1=n:i.child2=n,n.parent=i,e.height=-1;t=e.aabb;null!=t.outer&&(t.outer.zpp_inner=null,t.outer=null),t.wrap_min=t.wrap_max=null,t._invalidate=null,t._validate=null,t.next=De.zpp_pool,De.zpp_pool=t,e.child1=e.child2=e.parent=null,e.next=null,e.snext=null,e.mnext=null,e.next=Ye.zpp_pool,Ye.zpp_pool=e;for(var r,o,s,a,h,l,p,u,d,c=i;null!=c;){null==c.child1||c.height<2||(f=c.child1,1<(d=(r=c.child2).height-f.height)?(o=r.child1,l=r.child2,r.child1=c,r.parent=c.parent,null!=(c.parent=r).parent?r.parent.child1==c?r.parent.child1=r:r.parent.child2=r:this.root=r,o.height>l.height?(r.child2=o,s=((c.child2=l).parent=c).aabb,a=f.aabb,h=l.aabb,s.minx=(a.minx<h.minx?a:h).minx,s.miny=(a.miny<h.miny?a:h).miny,s.maxx=(a.maxx>h.maxx?a:h).maxx,s.maxy=(a.maxy>h.maxy?a:h).maxy,s=r.aabb,a=c.aabb,h=o.aabb,s.minx=(a.minx<h.minx?a:h).minx,s.miny=(a.miny<h.miny?a:h).miny,s.maxx=(a.maxx>h.maxx?a:h).maxx,s.maxy=(a.maxy>h.maxy?a:h).maxy,a=f.height,h=l.height,c.height=1+(h<a?a:h),a=c.height,h=o.height,r.height=1+(h<a?a:h)):(r.child2=l,h=((c.child2=o).parent=c).aabb,p=f.aabb,u=o.aabb,h.minx=(p.minx<u.minx?p:u).minx,h.miny=(p.miny<u.miny?p:u).miny,h.maxx=(p.maxx>u.maxx?p:u).maxx,h.maxy=(p.maxy>u.maxy?p:u).maxy,h=r.aabb,p=c.aabb,u=l.aabb,h.minx=(p.minx<u.minx?p:u).minx,h.miny=(p.miny<u.miny?p:u).miny,h.maxx=(p.maxx>u.maxx?p:u).maxx,h.maxy=(p.maxy>u.maxy?p:u).maxy,p=f.height,u=o.height,c.height=1+(u<p?p:u),p=c.height,u=l.height,r.height=1+(u<p?p:u)),c=r):d<-1&&(l=f.child1,_=f.child2,f.child1=c,f.parent=c.parent,null!=(c.parent=f).parent?f.parent.child1==c?f.parent.child1=f:f.parent.child2=f:this.root=f,l.height>_.height?(f.child2=l,p=((c.child1=_).parent=c).aabb,u=r.aabb,d=_.aabb,p.minx=(u.minx<d.minx?u:d).minx,p.miny=(u.miny<d.miny?u:d).miny,p.maxx=(u.maxx>d.maxx?u:d).maxx,p.maxy=(u.maxy>d.maxy?u:d).maxy,p=f.aabb,u=c.aabb,d=l.aabb,p.minx=(u.minx<d.minx?u:d).minx,p.miny=(u.miny<d.miny?u:d).miny,p.maxx=(u.maxx>d.maxx?u:d).maxx,p.maxy=(u.maxy>d.maxy?u:d).maxy,u=r.height,d=_.height,c.height=1+(d<u?u:d),u=c.height,d=l.height,f.height=1+(d<u?u:d)):(f.child2=_,g=((c.child1=l).parent=c).aabb,y=r.aabb,m=l.aabb,g.minx=(y.minx<m.minx?y:m).minx,g.miny=(y.miny<m.miny?y:m).miny,g.maxx=(y.maxx>m.maxx?y:m).maxx,g.maxy=(y.maxy>m.maxy?y:m).maxy,g=f.aabb,y=c.aabb,m=_.aabb,g.minx=(y.minx<m.minx?y:m).minx,g.miny=(y.miny<m.miny?y:m).miny,g.maxx=(y.maxx>m.maxx?y:m).maxx,g.maxy=(y.maxy>m.maxy?y:m).maxy,g=r.height,y=l.height,c.height=1+(y<g?g:y),m=c.height,g=_.height,f.height=1+(g<m?m:g)),c=f));var y=c.child1,_=c.child2,m=c.aabb,g=y.aabb,f=_.aabb;m.minx=(g.minx<f.minx?g:f).minx,m.miny=(g.miny<f.miny?g:f).miny,m.maxx=(g.maxx>f.maxx?g:f).maxx,m.maxy=(g.maxy>f.maxy?g:f).maxy;y=y.height,_=_.height;c.height=1+(_<y?y:_),c=c.parent}}else{(this.root=n).parent=null,e.height=-1;n=e.aabb;null!=n.outer&&(n.outer.zpp_inner=null,n.outer=null),n.wrap_min=n.wrap_max=null,n._invalidate=null,n._validate=null,n.next=De.zpp_pool,De.zpp_pool=n,e.child1=e.child2=e.parent=null,e.next=null,e.snext=null,e.mnext=null,e.next=Ye.zpp_pool,Ye.zpp_pool=e}}},Ze.prototype.balance=function(t){if(null==t.child1||t.height<2)return t;var e=t.child1,i=t.child2,n=i.height-e.height;if(1<n){var r,o,s,a=i.child1,h=i.child2;return i.child1=t,i.parent=t.parent,null!=(t.parent=i).parent?i.parent.child1==t?i.parent.child1=i:i.parent.child2=i:this.root=i,a.height>h.height?(i.child2=a,r=((t.child2=h).parent=t).aabb,o=e.aabb,s=h.aabb,r.minx=(o.minx<s.minx?o:s).minx,r.miny=(o.miny<s.miny?o:s).miny,r.maxx=(o.maxx>s.maxx?o:s).maxx,r.maxy=(o.maxy>s.maxy?o:s).maxy,r=i.aabb,o=t.aabb,s=a.aabb,r.minx=(o.minx<s.minx?o:s).minx,r.miny=(o.miny<s.miny?o:s).miny,r.maxx=(o.maxx>s.maxx?o:s).maxx,r.maxy=(o.maxy>s.maxy?o:s).maxy,o=e.height,s=h.height,t.height=1+(s<o?o:s),o=t.height,s=a.height,i.height=1+(s<o?o:s)):(i.child2=h,o=((t.child2=a).parent=t).aabb,s=e.aabb,d=a.aabb,o.minx=(s.minx<d.minx?s:d).minx,o.miny=(s.miny<d.miny?s:d).miny,o.maxx=(s.maxx>d.maxx?s:d).maxx,o.maxy=(s.maxy>d.maxy?s:d).maxy,o=i.aabb,s=t.aabb,d=h.aabb,o.minx=(s.minx<d.minx?s:d).minx,o.miny=(s.miny<d.miny?s:d).miny,o.maxx=(s.maxx>d.maxx?s:d).maxx,o.maxy=(s.maxy>d.maxy?s:d).maxy,s=e.height,d=a.height,t.height=1+(d<s?s:d),s=t.height,d=h.height,i.height=1+(d<s?s:d)),i}if(n<-1){var l,p,u,d=e.child1,n=e.child2;return e.child1=t,e.parent=t.parent,null!=(t.parent=e).parent?e.parent.child1==t?e.parent.child1=e:e.parent.child2=e:this.root=e,d.height>n.height?(e.child2=d,u=((t.child1=n).parent=t).aabb,l=i.aabb,p=n.aabb,u.minx=(l.minx<p.minx?l:p).minx,u.miny=(l.miny<p.miny?l:p).miny,u.maxx=(l.maxx>p.maxx?l:p).maxx,u.maxy=(l.maxy>p.maxy?l:p).maxy,u=e.aabb,l=t.aabb,p=d.aabb,u.minx=(l.minx<p.minx?l:p).minx,u.miny=(l.miny<p.miny?l:p).miny,u.maxx=(l.maxx>p.maxx?l:p).maxx,u.maxy=(l.maxy>p.maxy?l:p).maxy,u=i.height,l=n.height,t.height=1+(l<u?u:l),p=t.height,u=d.height,e.height=1+(u<p?p:u)):(e.child2=n,l=((t.child1=d).parent=t).aabb,p=i.aabb,u=d.aabb,l.minx=(p.minx<u.minx?p:u).minx,l.miny=(p.miny<u.miny?p:u).miny,l.maxx=(p.maxx>u.maxx?p:u).maxx,l.maxy=(p.maxy>u.maxy?p:u).maxy,l=e.aabb,p=t.aabb,u=n.aabb,l.minx=(p.minx<u.minx?p:u).minx,l.miny=(p.miny<u.miny?p:u).miny,l.maxx=(p.maxx>u.maxx?p:u).maxx,l.maxy=(p.maxy>u.maxy?p:u).maxy,i=i.height,d=d.height,t.height=1+(d<i?i:d),d=t.height,n=n.height,e.height=1+(n<d?d:n)),e}return t},Ze.prototype.__class__=Ze;var Je=zpp_nape.space.ZPP_DynAABBPhase=function(t){this.openlist=null,this.failed=null,this.treeStack2=null,this.treeStack=null,this.moves=null,this.syncs=null,this.pairs=null,this.dtree=null,this.stree=null,qe.call(this),this.space=t,this.is_sweep=!1,(this.dynab=this).stree=new Ze,this.dtree=new Ze};Je.__name__=["zpp_nape","space","ZPP_DynAABBPhase"],Je.__super__=qe,(Je.prototype=Object.create(qe.prototype)).stree=null,Je.prototype.dtree=null,Je.prototype.pairs=null,Je.prototype.syncs=null,Je.prototype.moves=null,Je.prototype.dyn=function(t){return 1!=t.body.type&&!t.body.component.sleeping},Je.prototype.__insert=function(t){var e;null==Ye.zpp_pool?e=new Ye:(e=Ye.zpp_pool,Ye.zpp_pool=e.next,e.next=null),null==De.zpp_pool?e.aabb=new De:(e.aabb=De.zpp_pool,De.zpp_pool=e.aabb.next,e.aabb.next=null),e.moved=!1,e.synced=!1,e.first_sync=!1,((e.shape=t).node=e).synced=!0,e.first_sync=!0,e.snext=this.syncs,this.syncs=e},Je.prototype.__remove=function(t){var e=t.node;if(e.first_sync||(e.dyn?this.dtree:this.stree).removeLeaf(e),t.node=null,e.synced){for(var i=null,n=this.syncs;null!=n&&n!=e;)n=(i=n).snext;null==i?this.syncs=n.snext:i.snext=n.snext,n.snext=null,e.synced=!1}if(e.moved){for(var r=null,o=this.moves;null!=o&&o!=e;)o=(r=o).mnext;null==r?this.moves=o.mnext:r.mnext=o.mnext,o.mnext=null,e.moved=!1}for(var s=null,a=this.pairs;null!=a;){var h,l=a.next;a.n1!=e&&a.n2!=e?(s=a,a=l):(null==s?this.pairs=l:s.next=l,null!=a.arb&&(a.arb.pair=null),a.arb=null,a.n1.shape.pairs.remove(a),a.n2.shape.pairs.remove(a),(h=a).n1=h.n2=null,h.sleeping=!1,h.next=Ke.zpp_pool,Ke.zpp_pool=h,a=l)}for(;null!=t.pairs.head;){var p=t.pairs.pop_unsafe();(p.n1==e?p.n2:p.n1).shape.pairs.remove(p),null!=p.arb&&(p.arb.pair=null),p.arb=null,p.n1=p.n2=null,p.sleeping=!1,p.next=Ke.zpp_pool,Ke.zpp_pool=p}e.height=-1;var u=e.aabb;null!=u.outer&&(u.outer.zpp_inner=null,u.outer=null),u.wrap_min=u.wrap_max=null,u._invalidate=null,u._validate=null,u.next=De.zpp_pool,De.zpp_pool=u,e.child1=e.child2=e.parent=null,e.next=null,e.snext=null,e.mnext=null,e.next=Ye.zpp_pool,Ye.zpp_pool=e},Je.prototype.__sync=function(t){var e=t.node;if(!e.synced){if(!this.space.continuous&&t.zip_aabb&&null!=t.body)if(t.zip_aabb=!1,0==t.type){var i=t.circle;if(i.zip_worldCOM&&null!=i.body){if(i.zip_worldCOM=!1,i.zip_localCOM){if(i.zip_localCOM=!1,1==i.type){var n=i.polygon;if(null==n.lverts.next.next)n.localCOMx=n.lverts.next.x,n.localCOMy=n.lverts.next.y;else if(null==n.lverts.next.next.next)n.localCOMx=n.lverts.next.x,n.localCOMy=n.lverts.next.y,n.localCOMx+=n.lverts.next.next.x,n.localCOMy+=n.lverts.next.next.y,n.localCOMx*=.5,n.localCOMy*=.5;else{n.localCOMx=0;var r=n.localCOMy=0,o=n.lverts.next,s=o,a=o=o.next;for(o=o.next;null!=o;){var h=o;r+=a.x*(h.y-s.y);var l=h.y*a.x-h.x*a.y;n.localCOMx+=(a.x+h.x)*l,n.localCOMy+=(a.y+h.y)*l,s=a,a=h,o=o.next}var p=o=n.lverts.next;r+=a.x*(p.y-s.y);var u=p.y*a.x-p.x*a.y;n.localCOMx+=(a.x+p.x)*u,n.localCOMy+=(a.y+p.y)*u;var s=a,d=o=o.next;r+=p.x*(d.y-s.y);u=d.y*p.x-d.x*p.y;n.localCOMx+=(p.x+d.x)*u,n.localCOMy+=(p.y+d.y)*u;d=r=1/(3*r);n.localCOMx*=d,n.localCOMy*=d}}null!=i.wrap_localCOM&&(i.wrap_localCOM.zpp_inner.x=i.localCOMx,i.wrap_localCOM.zpp_inner.y=i.localCOMy)}u=i.body;u.zip_axis&&(u.zip_axis=!1,u.axisx=Math.sin(u.rot),u.axisy=Math.cos(u.rot)),i.worldCOMx=i.body.posx+(i.body.axisy*i.localCOMx-i.body.axisx*i.localCOMy),i.worldCOMy=i.body.posy+(i.localCOMx*i.body.axisx+i.localCOMy*i.body.axisy)}d=i.radius,u=i.radius;i.aabb.minx=i.worldCOMx-d,i.aabb.miny=i.worldCOMy-u,i.aabb.maxx=i.worldCOMx+d,i.aabb.maxy=i.worldCOMy+u}else{var c=t.polygon;if(c.zip_gverts&&null!=c.body){c.zip_gverts=!1,c.validate_lverts();var y=c.body;y.zip_axis&&(y.zip_axis=!1,y.axisx=Math.sin(y.rot),y.axisy=Math.cos(y.rot));for(var _=c.lverts.next,m=c.gverts.next;null!=m;){var g=m,f=_,_=_.next;g.x=c.body.posx+(c.body.axisy*f.x-c.body.axisx*f.y),g.y=c.body.posy+(f.x*c.body.axisx+f.y*c.body.axisy),m=m.next}}var y=c.gverts.next;c.aabb.minx=y.x,c.aabb.miny=y.y,c.aabb.maxx=y.x,c.aabb.maxy=y.y;for(var x=c.gverts.next.next;null!=x;){var v=x;v.x<c.aabb.minx&&(c.aabb.minx=v.x),v.x>c.aabb.maxx&&(c.aabb.maxx=v.x),v.y<c.aabb.miny&&(c.aabb.miny=v.y),v.y>c.aabb.maxy&&(c.aabb.maxy=v.y),x=x.next}}(e.dyn!=(1!=t.body.type&&!t.body.component.sleeping)||(y=e.aabb,!((t=t.aabb).minx>=y.minx&&t.miny>=y.miny&&t.maxx<=y.maxx&&t.maxy<=y.maxy)))&&(e.synced=!0,e.snext=this.syncs,this.syncs=e)}},Je.prototype.sync_broadphase=function(){if(this.space.validation(),null!=this.syncs)if(null==this.moves){for(var t=this.syncs;null!=t;){var e=t.shape;if(t.first_sync)t.first_sync=!1;else{var i=t.dyn?this.dtree:this.stree;if(t==i.root)i.root=null;else{var n=t.parent,r=n.parent,o=n.child1==t?n.child2:n.child1;if(null!=r){r.child1==n?r.child1=o:r.child2=o,o.parent=r,n.height=-1;var s=n.aabb;null!=s.outer&&(s.outer.zpp_inner=null,s.outer=null),s.wrap_min=s.wrap_max=null,s._invalidate=null,s._validate=null,s.next=De.zpp_pool,De.zpp_pool=s,n.child1=n.child2=n.parent=null,n.next=null,n.snext=null,n.mnext=null,n.next=Ye.zpp_pool,Ye.zpp_pool=n;for(var a,h,l,p,u,d,c,y,_,m=r;null!=m;){null==m.child1||m.height<2||(w=m.child1,1<(_=(a=m.child2).height-w.height)?(h=a.child1,d=a.child2,a.child1=m,a.parent=m.parent,null!=(m.parent=a).parent?a.parent.child1==m?a.parent.child1=a:a.parent.child2=a:i.root=a,h.height>d.height?(a.child2=h,l=((m.child2=d).parent=m).aabb,p=w.aabb,u=d.aabb,l.minx=(p.minx<u.minx?p:u).minx,l.miny=(p.miny<u.miny?p:u).miny,l.maxx=(p.maxx>u.maxx?p:u).maxx,l.maxy=(p.maxy>u.maxy?p:u).maxy,l=a.aabb,p=m.aabb,u=h.aabb,l.minx=(p.minx<u.minx?p:u).minx,l.miny=(p.miny<u.miny?p:u).miny,l.maxx=(p.maxx>u.maxx?p:u).maxx,l.maxy=(p.maxy>u.maxy?p:u).maxy,p=w.height,u=d.height,m.height=1+(u<p?p:u),p=m.height,u=h.height,a.height=1+(u<p?p:u)):(a.child2=d,u=((m.child2=h).parent=m).aabb,c=w.aabb,y=h.aabb,u.minx=(c.minx<y.minx?c:y).minx,u.miny=(c.miny<y.miny?c:y).miny,u.maxx=(c.maxx>y.maxx?c:y).maxx,u.maxy=(c.maxy>y.maxy?c:y).maxy,u=a.aabb,c=m.aabb,y=d.aabb,u.minx=(c.minx<y.minx?c:y).minx,u.miny=(c.miny<y.miny?c:y).miny,u.maxx=(c.maxx>y.maxx?c:y).maxx,u.maxy=(c.maxy>y.maxy?c:y).maxy,c=w.height,y=h.height,m.height=1+(y<c?c:y),c=m.height,y=d.height,a.height=1+(y<c?c:y)),m=a):_<-1&&(d=w.child1,f=w.child2,w.child1=m,w.parent=m.parent,null!=(m.parent=w).parent?w.parent.child1==m?w.parent.child1=w:w.parent.child2=w:i.root=w,d.height>f.height?(w.child2=d,c=((m.child1=f).parent=m).aabb,y=a.aabb,_=f.aabb,c.minx=(y.minx<_.minx?y:_).minx,c.miny=(y.miny<_.miny?y:_).miny,c.maxx=(y.maxx>_.maxx?y:_).maxx,c.maxy=(y.maxy>_.maxy?y:_).maxy,c=w.aabb,y=m.aabb,_=d.aabb,c.minx=(y.minx<_.minx?y:_).minx,c.miny=(y.miny<_.miny?y:_).miny,c.maxx=(y.maxx>_.maxx?y:_).maxx,c.maxy=(y.maxy>_.maxy?y:_).maxy,y=a.height,_=f.height,m.height=1+(_<y?y:_),y=m.height,_=d.height,w.height=1+(_<y?y:_)):(w.child2=f,v=((m.child1=d).parent=m).aabb,g=a.aabb,x=d.aabb,v.minx=(g.minx<x.minx?g:x).minx,v.miny=(g.miny<x.miny?g:x).miny,v.maxx=(g.maxx>x.maxx?g:x).maxx,v.maxy=(g.maxy>x.maxy?g:x).maxy,v=w.aabb,g=m.aabb,x=f.aabb,v.minx=(g.minx<x.minx?g:x).minx,v.miny=(g.miny<x.miny?g:x).miny,v.maxx=(g.maxx>x.maxx?g:x).maxx,v.maxy=(g.maxy>x.maxy?g:x).maxy,v=a.height,g=d.height,m.height=1+(g<v?v:g),x=m.height,v=f.height,w.height=1+(v<x?x:v)),m=w));var g=m.child1,f=m.child2,x=m.aabb,v=g.aabb,w=f.aabb;x.minx=(v.minx<w.minx?v:w).minx,x.miny=(v.miny<w.miny?v:w).miny,x.maxx=(v.maxx>w.maxx?v:w).maxx,x.maxy=(v.maxy>w.maxy?v:w).maxy;g=g.height,f=f.height;m.height=1+(f<g?g:f),m=m.parent}}else{(i.root=o).parent=null,n.height=-1;var z=n.aabb;null!=z.outer&&(z.outer.zpp_inner=null,z.outer=null),z.wrap_min=z.wrap_max=null,z._invalidate=null,z._validate=null,z.next=De.zpp_pool,De.zpp_pool=z,n.child1=n.child2=n.parent=null,n.next=null,n.snext=null,n.mnext=null,n.next=Ye.zpp_pool,Ye.zpp_pool=n}}}o=t.aabb;if(!this.space.continuous&&e.zip_aabb&&null!=e.body)if(e.zip_aabb=!1,0==e.type){z=e.circle;if(z.zip_worldCOM&&null!=z.body){if(z.zip_worldCOM=!1,z.zip_localCOM){if(z.zip_localCOM=!1,1==z.type){var b=z.polygon;if(null==b.lverts.next.next)b.localCOMx=b.lverts.next.x,b.localCOMy=b.lverts.next.y;else if(null==b.lverts.next.next.next)b.localCOMx=b.lverts.next.x,b.localCOMy=b.lverts.next.y,b.localCOMx+=b.lverts.next.next.x,b.localCOMy+=b.lverts.next.next.y,b.localCOMx*=.5,b.localCOMy*=.5;else{b.localCOMx=0;var S=b.localCOMy=0,C=b.lverts.next,P=C,M=C=C.next;for(C=C.next;null!=C;){var T=C;S+=M.x*(T.y-P.y);var A=T.y*M.x-T.x*M.y;b.localCOMx+=(M.x+T.x)*A,b.localCOMy+=(M.y+T.y)*A,P=M,M=T,C=C.next}n=C=b.lverts.next;S+=M.x*(n.y-P.y);var k=n.y*M.x-n.x*M.y;b.localCOMx+=(M.x+n.x)*k,b.localCOMy+=(M.y+n.y)*k;var P=M,O=C=C.next;S+=n.x*(O.y-P.y);k=O.y*n.x-O.x*n.y;b.localCOMx+=(n.x+O.x)*k,b.localCOMy+=(n.y+O.y)*k;O=S=1/(3*S);b.localCOMx*=O,b.localCOMy*=O}}null!=z.wrap_localCOM&&(z.wrap_localCOM.zpp_inner.x=z.localCOMx,z.wrap_localCOM.zpp_inner.y=z.localCOMy)}k=z.body;k.zip_axis&&(k.zip_axis=!1,k.axisx=Math.sin(k.rot),k.axisy=Math.cos(k.rot)),z.worldCOMx=z.body.posx+(z.body.axisy*z.localCOMx-z.body.axisx*z.localCOMy),z.worldCOMy=z.body.posy+(z.localCOMx*z.body.axisx+z.localCOMy*z.body.axisy)}O=z.radius,k=z.radius;z.aabb.minx=z.worldCOMx-O,z.aabb.miny=z.worldCOMy-k,z.aabb.maxx=z.worldCOMx+O,z.aabb.maxy=z.worldCOMy+k}else{var E=e.polygon;if(E.zip_gverts&&null!=E.body){E.zip_gverts=!1,E.validate_lverts();var I=E.body;I.zip_axis&&(I.zip_axis=!1,I.axisx=Math.sin(I.rot),I.axisy=Math.cos(I.rot));for(var G=E.lverts.next,D=E.gverts.next;null!=D;){var L=D,B=G,G=G.next;L.x=E.body.posx+(E.body.axisy*B.x-E.body.axisx*B.y),L.y=E.body.posy+(B.x*E.body.axisx+B.y*E.body.axisy),D=D.next}}var R=E.gverts.next;E.aabb.minx=R.x,E.aabb.miny=R.y,E.aabb.maxx=R.x,E.aabb.maxy=R.y;for(var F=E.gverts.next.next;null!=F;){var N=F;N.x<E.aabb.minx&&(E.aabb.minx=N.x),N.x>E.aabb.maxx&&(E.aabb.maxx=N.x),N.y<E.aabb.miny&&(E.aabb.miny=N.y),N.y>E.aabb.maxy&&(E.aabb.maxy=N.y),F=F.next}}I=e.aabb;o.minx=I.minx-3,o.miny=I.miny-3,o.maxx=I.maxx+3,o.maxy=I.maxy+3;var j=(t.dyn=1!=e.body.type&&!e.body.component.sleeping)?this.dtree:this.stree;if(null==j.root)j.root=t,j.root.parent=null;else{for(var U=t.aabb,V=j.root;null!=V.child1;){var W=V.child1,X=V.child2,H=V.aabb,q=2*(H.maxx-H.minx+(H.maxy-H.miny)),Y=Ze.tmpaabb,K=V.aabb;Y.minx=(K.minx<U.minx?K:U).minx,Y.miny=(K.miny<U.miny?K:U).miny,Y.maxx=(K.maxx>U.maxx?K:U).maxx,Y.maxy=(K.maxy>U.maxy?K:U).maxy;var Z,H=Ze.tmpaabb,Y=2*(H.maxx-H.minx+(H.maxy-H.miny)),K=2*Y,H=2*(Y-q),Y=Ze.tmpaabb,q=W.aabb;Y.minx=(U.minx<q.minx?U:q).minx,Y.miny=(U.miny<q.miny?U:q).miny,Y.maxx=(U.maxx>q.maxx?U:q).maxx,Y.maxy=(U.maxy>q.maxy?U:q).maxy,Z=null==W.child1?2*((q=Ze.tmpaabb).maxx-q.minx+(q.maxy-q.miny))+H:($=2*((Z=W.aabb).maxx-Z.minx+(Z.maxy-Z.miny)),2*((Q=Ze.tmpaabb).maxx-Q.minx+(Q.maxy-Q.miny))-$+H);var J,Q=Ze.tmpaabb,$=X.aabb;if(Q.minx=(U.minx<$.minx?U:$).minx,Q.miny=(U.miny<$.miny?U:$).miny,Q.maxx=(U.maxx>$.maxx?U:$).maxx,Q.maxy=(U.maxy>$.maxy?U:$).maxy,H=null==X.child1?2*((J=Ze.tmpaabb).maxx-J.minx+(J.maxy-J.miny))+H:(J=2*(($=X.aabb).maxx-$.minx+($.maxy-$.miny)),2*(($=Ze.tmpaabb).maxx-$.minx+($.maxy-$.miny))-J+H),K<Z&&K<H)break;V=Z<H?W:X}var tt,R=V,o=R.parent;null==Ye.zpp_pool?tt=new Ye:(tt=Ye.zpp_pool,Ye.zpp_pool=tt.next,tt.next=null),null==De.zpp_pool?tt.aabb=new De:(tt.aabb=De.zpp_pool,De.zpp_pool=tt.aabb.next,tt.aabb.next=null),tt.moved=!1,tt.synced=!1,tt.first_sync=!1,tt.parent=o;var et,it,nt,rt,ot,st,at,ht,lt,pt,I=tt.aabb,e=R.aabb;for(I.minx=(U.minx<e.minx?U:e).minx,I.miny=(U.miny<e.miny?U:e).miny,I.maxx=(U.maxx>e.maxx?U:e).maxx,I.maxy=(U.maxy>e.maxy?U:e).maxy,tt.height=R.height+1,null!=o?(o.child1==R?o.child1=tt:o.child2=tt,tt.child1=R,tt.child2=t,R.parent=tt,t.parent=tt):(tt.child1=R,tt.child2=t,R.parent=tt,t.parent=tt,j.root=tt),V=t.parent;null!=V;){null==V.child1||V.height<2||(yt=V.child1,1<(lt=(et=V.child2).height-yt.height)?(it=et.child1,nt=et.child2,et.child1=V,et.parent=V.parent,null!=(V.parent=et).parent?et.parent.child1==V?et.parent.child1=et:et.parent.child2=et:j.root=et,it.height>nt.height?(et.child2=it,rt=((V.child2=nt).parent=V).aabb,ot=yt.aabb,st=nt.aabb,rt.minx=(ot.minx<st.minx?ot:st).minx,rt.miny=(ot.miny<st.miny?ot:st).miny,rt.maxx=(ot.maxx>st.maxx?ot:st).maxx,rt.maxy=(ot.maxy>st.maxy?ot:st).maxy,rt=et.aabb,ot=V.aabb,st=it.aabb,rt.minx=(ot.minx<st.minx?ot:st).minx,rt.miny=(ot.miny<st.miny?ot:st).miny,rt.maxx=(ot.maxx>st.maxx?ot:st).maxx,rt.maxy=(ot.maxy>st.maxy?ot:st).maxy,ot=yt.height,st=nt.height,V.height=1+(st<ot?ot:st),ot=V.height,st=it.height,et.height=1+(st<ot?ot:st)):(et.child2=nt,st=((V.child2=it).parent=V).aabb,at=yt.aabb,ht=it.aabb,st.minx=(at.minx<ht.minx?at:ht).minx,st.miny=(at.miny<ht.miny?at:ht).miny,st.maxx=(at.maxx>ht.maxx?at:ht).maxx,st.maxy=(at.maxy>ht.maxy?at:ht).maxy,st=et.aabb,at=V.aabb,ht=nt.aabb,st.minx=(at.minx<ht.minx?at:ht).minx,st.miny=(at.miny<ht.miny?at:ht).miny,st.maxx=(at.maxx>ht.maxx?at:ht).maxx,st.maxy=(at.maxy>ht.maxy?at:ht).maxy,at=yt.height,ht=it.height,V.height=1+(ht<at?at:ht),at=V.height,ht=nt.height,et.height=1+(ht<at?at:ht)),V=et):lt<-1&&(at=yt.child1,ut=yt.child2,yt.child1=V,yt.parent=V.parent,null!=(V.parent=yt).parent?yt.parent.child1==V?yt.parent.child1=yt:yt.parent.child2=yt:j.root=yt,at.height>ut.height?(yt.child2=at,ht=((V.child1=ut).parent=V).aabb,lt=et.aabb,pt=ut.aabb,ht.minx=(lt.minx<pt.minx?lt:pt).minx,ht.miny=(lt.miny<pt.miny?lt:pt).miny,ht.maxx=(lt.maxx>pt.maxx?lt:pt).maxx,ht.maxy=(lt.maxy>pt.maxy?lt:pt).maxy,ht=yt.aabb,lt=V.aabb,pt=at.aabb,ht.minx=(lt.minx<pt.minx?lt:pt).minx,ht.miny=(lt.miny<pt.miny?lt:pt).miny,ht.maxx=(lt.maxx>pt.maxx?lt:pt).maxx,ht.maxy=(lt.maxy>pt.maxy?lt:pt).maxy,lt=et.height,pt=ut.height,V.height=1+(pt<lt?lt:pt),lt=V.height,pt=at.height,yt.height=1+(pt<lt?lt:pt)):(yt.child2=ut,pt=((V.child1=at).parent=V).aabb,dt=et.aabb,ct=at.aabb,pt.minx=(dt.minx<ct.minx?dt:ct).minx,pt.miny=(dt.miny<ct.miny?dt:ct).miny,pt.maxx=(dt.maxx>ct.maxx?dt:ct).maxx,pt.maxy=(dt.maxy>ct.maxy?dt:ct).maxy,pt=yt.aabb,dt=V.aabb,ct=ut.aabb,pt.minx=(dt.minx<ct.minx?dt:ct).minx,pt.miny=(dt.miny<ct.miny?dt:ct).miny,pt.maxx=(dt.maxx>ct.maxx?dt:ct).maxx,pt.maxy=(dt.maxy>ct.maxy?dt:ct).maxy,dt=et.height,ct=at.height,V.height=1+(ct<dt?dt:ct),dt=V.height,ct=ut.height,yt.height=1+(ct<dt?dt:ct)),V=yt));var ut=V.child1,dt=V.child2,ct=ut.height,yt=dt.height;V.height=1+(yt<ct?ct:yt);yt=V.aabb,ut=ut.aabb,dt=dt.aabb;yt.minx=(ut.minx<dt.minx?ut:dt).minx,yt.miny=(ut.miny<dt.miny?ut:dt).miny,yt.maxx=(ut.maxx>dt.maxx?ut:dt).maxx,yt.maxy=(ut.maxy>dt.maxy?ut:dt).maxy,V=V.parent}}t.synced=!1,t.moved=!0,t.mnext=t.snext,t.snext=null,t=t.mnext}var _t=this.syncs;this.syncs=this.moves,this.moves=_t}else for(;null!=this.syncs;){var mt=this.syncs;this.syncs=mt.snext,mt.snext=null;var gt=mt.shape;if(mt.first_sync)mt.first_sync=!1;else{var ft=mt.dyn?this.dtree:this.stree;if(mt==ft.root)ft.root=null;else{var xt=mt.parent,vt=xt.parent,wt=xt.child1==mt?xt.child2:xt.child1;if(null!=vt){vt.child1==xt?vt.child1=wt:vt.child2=wt,wt.parent=vt,xt.height=-1;var zt=xt.aabb;null!=zt.outer&&(zt.outer.zpp_inner=null,zt.outer=null),zt.wrap_min=zt.wrap_max=null,zt._invalidate=null,zt._validate=null,zt.next=De.zpp_pool,De.zpp_pool=zt,xt.child1=xt.child2=xt.parent=null,xt.next=null,xt.snext=null,xt.mnext=null,xt.next=Ye.zpp_pool,Ye.zpp_pool=xt;for(var bt,St,Ct,Pt,Mt,Tt,At,kt,Ot,Et=vt;null!=Et;){null==Et.child1||Et.height<2||(Bt=Et.child1,1<(Ot=(bt=Et.child2).height-Bt.height)?(St=bt.child1,Tt=bt.child2,bt.child1=Et,bt.parent=Et.parent,null!=(Et.parent=bt).parent?bt.parent.child1==Et?bt.parent.child1=bt:bt.parent.child2=bt:ft.root=bt,St.height>Tt.height?(bt.child2=St,Ct=((Et.child2=Tt).parent=Et).aabb,Pt=Bt.aabb,Mt=Tt.aabb,Ct.minx=(Pt.minx<Mt.minx?Pt:Mt).minx,Ct.miny=(Pt.miny<Mt.miny?Pt:Mt).miny,Ct.maxx=(Pt.maxx>Mt.maxx?Pt:Mt).maxx,Ct.maxy=(Pt.maxy>Mt.maxy?Pt:Mt).maxy,Ct=bt.aabb,Pt=Et.aabb,Mt=St.aabb,Ct.minx=(Pt.minx<Mt.minx?Pt:Mt).minx,Ct.miny=(Pt.miny<Mt.miny?Pt:Mt).miny,Ct.maxx=(Pt.maxx>Mt.maxx?Pt:Mt).maxx,Ct.maxy=(Pt.maxy>Mt.maxy?Pt:Mt).maxy,Pt=Bt.height,Mt=Tt.height,Et.height=1+(Mt<Pt?Pt:Mt),Pt=Et.height,Mt=St.height,bt.height=1+(Mt<Pt?Pt:Mt)):(bt.child2=Tt,Mt=((Et.child2=St).parent=Et).aabb,At=Bt.aabb,kt=St.aabb,Mt.minx=(At.minx<kt.minx?At:kt).minx,Mt.miny=(At.miny<kt.miny?At:kt).miny,Mt.maxx=(At.maxx>kt.maxx?At:kt).maxx,Mt.maxy=(At.maxy>kt.maxy?At:kt).maxy,Mt=bt.aabb,At=Et.aabb,kt=Tt.aabb,Mt.minx=(At.minx<kt.minx?At:kt).minx,Mt.miny=(At.miny<kt.miny?At:kt).miny,Mt.maxx=(At.maxx>kt.maxx?At:kt).maxx,Mt.maxy=(At.maxy>kt.maxy?At:kt).maxy,At=Bt.height,kt=St.height,Et.height=1+(kt<At?At:kt),At=Et.height,kt=Tt.height,bt.height=1+(kt<At?At:kt)),Et=bt):Ot<-1&&(Tt=Bt.child1,Gt=Bt.child2,Bt.child1=Et,Bt.parent=Et.parent,null!=(Et.parent=Bt).parent?Bt.parent.child1==Et?Bt.parent.child1=Bt:Bt.parent.child2=Bt:ft.root=Bt,Tt.height>Gt.height?(Bt.child2=Tt,At=((Et.child1=Gt).parent=Et).aabb,kt=bt.aabb,Ot=Gt.aabb,At.minx=(kt.minx<Ot.minx?kt:Ot).minx,At.miny=(kt.miny<Ot.miny?kt:Ot).miny,At.maxx=(kt.maxx>Ot.maxx?kt:Ot).maxx,At.maxy=(kt.maxy>Ot.maxy?kt:Ot).maxy,At=Bt.aabb,kt=Et.aabb,Ot=Tt.aabb,At.minx=(kt.minx<Ot.minx?kt:Ot).minx,At.miny=(kt.miny<Ot.miny?kt:Ot).miny,At.maxx=(kt.maxx>Ot.maxx?kt:Ot).maxx,At.maxy=(kt.maxy>Ot.maxy?kt:Ot).maxy,kt=bt.height,Ot=Gt.height,Et.height=1+(Ot<kt?kt:Ot),kt=Et.height,Ot=Tt.height,Bt.height=1+(Ot<kt?kt:Ot)):(Bt.child2=Gt,Lt=((Et.child1=Tt).parent=Et).aabb,It=bt.aabb,Dt=Tt.aabb,Lt.minx=(It.minx<Dt.minx?It:Dt).minx,Lt.miny=(It.miny<Dt.miny?It:Dt).miny,Lt.maxx=(It.maxx>Dt.maxx?It:Dt).maxx,Lt.maxy=(It.maxy>Dt.maxy?It:Dt).maxy,Lt=Bt.aabb,It=Et.aabb,Dt=Gt.aabb,Lt.minx=(It.minx<Dt.minx?It:Dt).minx,Lt.miny=(It.miny<Dt.miny?It:Dt).miny,Lt.maxx=(It.maxx>Dt.maxx?It:Dt).maxx,Lt.maxy=(It.maxy>Dt.maxy?It:Dt).maxy,Lt=bt.height,It=Tt.height,Et.height=1+(It<Lt?Lt:It),Dt=Et.height,Lt=Gt.height,Bt.height=1+(Lt<Dt?Dt:Lt)),Et=Bt));var It=Et.child1,Gt=Et.child2,Dt=Et.aabb,Lt=It.aabb,Bt=Gt.aabb;Dt.minx=(Lt.minx<Bt.minx?Lt:Bt).minx,Dt.miny=(Lt.miny<Bt.miny?Lt:Bt).miny,Dt.maxx=(Lt.maxx>Bt.maxx?Lt:Bt).maxx,Dt.maxy=(Lt.maxy>Bt.maxy?Lt:Bt).maxy;It=It.height,Gt=Gt.height;Et.height=1+(Gt<It?It:Gt),Et=Et.parent}}else{(ft.root=wt).parent=null,xt.height=-1;var Rt=xt.aabb;null!=Rt.outer&&(Rt.outer.zpp_inner=null,Rt.outer=null),Rt.wrap_min=Rt.wrap_max=null,Rt._invalidate=null,Rt._validate=null,Rt.next=De.zpp_pool,De.zpp_pool=Rt,xt.child1=xt.child2=xt.parent=null,xt.next=null,xt.snext=null,xt.mnext=null,xt.next=Ye.zpp_pool,Ye.zpp_pool=xt}}}wt=mt.aabb;if(!this.space.continuous&&gt.zip_aabb&&null!=gt.body)if(gt.zip_aabb=!1,0==gt.type){Rt=gt.circle;if(Rt.zip_worldCOM&&null!=Rt.body){if(Rt.zip_worldCOM=!1,Rt.zip_localCOM){if(Rt.zip_localCOM=!1,1==Rt.type){var Ft=Rt.polygon;if(null==Ft.lverts.next.next)Ft.localCOMx=Ft.lverts.next.x,Ft.localCOMy=Ft.lverts.next.y;else if(null==Ft.lverts.next.next.next)Ft.localCOMx=Ft.lverts.next.x,Ft.localCOMy=Ft.lverts.next.y,Ft.localCOMx+=Ft.lverts.next.next.x,Ft.localCOMy+=Ft.lverts.next.next.y,Ft.localCOMx*=.5,Ft.localCOMy*=.5;else{Ft.localCOMx=0;var Nt=Ft.localCOMy=0,jt=Ft.lverts.next,Ut=jt,Vt=jt=jt.next;for(jt=jt.next;null!=jt;){var Wt=jt;Nt+=Vt.x*(Wt.y-Ut.y);var Xt=Wt.y*Vt.x-Wt.x*Vt.y;Ft.localCOMx+=(Vt.x+Wt.x)*Xt,Ft.localCOMy+=(Vt.y+Wt.y)*Xt,Ut=Vt,Vt=Wt,jt=jt.next}xt=jt=Ft.lverts.next;Nt+=Vt.x*(xt.y-Ut.y);var Ht=xt.y*Vt.x-xt.x*Vt.y;Ft.localCOMx+=(Vt.x+xt.x)*Ht,Ft.localCOMy+=(Vt.y+xt.y)*Ht;var Ut=Vt,qt=jt=jt.next;Nt+=xt.x*(qt.y-Ut.y);Ht=qt.y*xt.x-qt.x*xt.y;Ft.localCOMx+=(xt.x+qt.x)*Ht,Ft.localCOMy+=(xt.y+qt.y)*Ht;qt=Nt=1/(3*Nt);Ft.localCOMx*=qt,Ft.localCOMy*=qt}}null!=Rt.wrap_localCOM&&(Rt.wrap_localCOM.zpp_inner.x=Rt.localCOMx,Rt.wrap_localCOM.zpp_inner.y=Rt.localCOMy)}Ht=Rt.body;Ht.zip_axis&&(Ht.zip_axis=!1,Ht.axisx=Math.sin(Ht.rot),Ht.axisy=Math.cos(Ht.rot)),Rt.worldCOMx=Rt.body.posx+(Rt.body.axisy*Rt.localCOMx-Rt.body.axisx*Rt.localCOMy),Rt.worldCOMy=Rt.body.posy+(Rt.localCOMx*Rt.body.axisx+Rt.localCOMy*Rt.body.axisy)}qt=Rt.radius,Ht=Rt.radius;Rt.aabb.minx=Rt.worldCOMx-qt,Rt.aabb.miny=Rt.worldCOMy-Ht,Rt.aabb.maxx=Rt.worldCOMx+qt,Rt.aabb.maxy=Rt.worldCOMy+Ht}else{var Yt=gt.polygon;if(Yt.zip_gverts&&null!=Yt.body){Yt.zip_gverts=!1,Yt.validate_lverts();var Kt=Yt.body;Kt.zip_axis&&(Kt.zip_axis=!1,Kt.axisx=Math.sin(Kt.rot),Kt.axisy=Math.cos(Kt.rot));for(var Zt=Yt.lverts.next,Jt=Yt.gverts.next;null!=Jt;){var Qt=Jt,$t=Zt,Zt=Zt.next;Qt.x=Yt.body.posx+(Yt.body.axisy*$t.x-Yt.body.axisx*$t.y),Qt.y=Yt.body.posy+($t.x*Yt.body.axisx+$t.y*Yt.body.axisy),Jt=Jt.next}}var te=Yt.gverts.next;Yt.aabb.minx=te.x,Yt.aabb.miny=te.y,Yt.aabb.maxx=te.x,Yt.aabb.maxy=te.y;for(var ee=Yt.gverts.next.next;null!=ee;){var ie=ee;ie.x<Yt.aabb.minx&&(Yt.aabb.minx=ie.x),ie.x>Yt.aabb.maxx&&(Yt.aabb.maxx=ie.x),ie.y<Yt.aabb.miny&&(Yt.aabb.miny=ie.y),ie.y>Yt.aabb.maxy&&(Yt.aabb.maxy=ie.y),ee=ee.next}}Kt=gt.aabb;wt.minx=Kt.minx-3,wt.miny=Kt.miny-3,wt.maxx=Kt.maxx+3,wt.maxy=Kt.maxy+3;var ne=(mt.dyn=1!=gt.body.type&&!gt.body.component.sleeping)?this.dtree:this.stree;if(null==ne.root)ne.root=mt,ne.root.parent=null;else{for(var re=mt.aabb,oe=ne.root;null!=oe.child1;){var se=oe.child1,ae=oe.child2,he=oe.aabb,le=2*(he.maxx-he.minx+(he.maxy-he.miny)),pe=Ze.tmpaabb,ue=oe.aabb;pe.minx=(ue.minx<re.minx?ue:re).minx,pe.miny=(ue.miny<re.miny?ue:re).miny,pe.maxx=(ue.maxx>re.maxx?ue:re).maxx,pe.maxy=(ue.maxy>re.maxy?ue:re).maxy;var de,he=Ze.tmpaabb,pe=2*(he.maxx-he.minx+(he.maxy-he.miny)),ue=2*pe,he=2*(pe-le),pe=Ze.tmpaabb,le=se.aabb;pe.minx=(re.minx<le.minx?re:le).minx,pe.miny=(re.miny<le.miny?re:le).miny,pe.maxx=(re.maxx>le.maxx?re:le).maxx,pe.maxy=(re.maxy>le.maxy?re:le).maxy,de=null==se.child1?2*((le=Ze.tmpaabb).maxx-le.minx+(le.maxy-le.miny))+he:(_e=2*((de=se.aabb).maxx-de.minx+(de.maxy-de.miny)),2*((ye=Ze.tmpaabb).maxx-ye.minx+(ye.maxy-ye.miny))-_e+he);var ce,ye=Ze.tmpaabb,_e=ae.aabb;if(ye.minx=(re.minx<_e.minx?re:_e).minx,ye.miny=(re.miny<_e.miny?re:_e).miny,ye.maxx=(re.maxx>_e.maxx?re:_e).maxx,ye.maxy=(re.maxy>_e.maxy?re:_e).maxy,he=null==ae.child1?2*((ce=Ze.tmpaabb).maxx-ce.minx+(ce.maxy-ce.miny))+he:(ce=2*((_e=ae.aabb).maxx-_e.minx+(_e.maxy-_e.miny)),2*((_e=Ze.tmpaabb).maxx-_e.minx+(_e.maxy-_e.miny))-ce+he),ue<de&&ue<he)break;oe=de<he?se:ae}var me,te=oe,wt=te.parent;null==Ye.zpp_pool?me=new Ye:(me=Ye.zpp_pool,Ye.zpp_pool=me.next,me.next=null),null==De.zpp_pool?me.aabb=new De:(me.aabb=De.zpp_pool,De.zpp_pool=me.aabb.next,me.aabb.next=null),me.moved=!1,me.synced=!1,me.first_sync=!1,me.parent=wt;var ge,fe,xe,ve,we,ze,be,Se,Ce,Pe,Kt=me.aabb,gt=te.aabb;for(Kt.minx=(re.minx<gt.minx?re:gt).minx,Kt.miny=(re.miny<gt.miny?re:gt).miny,Kt.maxx=(re.maxx>gt.maxx?re:gt).maxx,Kt.maxy=(re.maxy>gt.maxy?re:gt).maxy,me.height=te.height+1,null!=wt?(wt.child1==te?wt.child1=me:wt.child2=me,me.child1=te,me.child2=mt,te.parent=me,mt.parent=me):(me.child1=te,me.child2=mt,te.parent=me,mt.parent=me,ne.root=me),oe=mt.parent;null!=oe;){null==oe.child1||oe.height<2||(ke=oe.child1,1<(Ce=(ge=oe.child2).height-ke.height)?(fe=ge.child1,xe=ge.child2,ge.child1=oe,ge.parent=oe.parent,null!=(oe.parent=ge).parent?ge.parent.child1==oe?ge.parent.child1=ge:ge.parent.child2=ge:ne.root=ge,fe.height>xe.height?(ge.child2=fe,ve=((oe.child2=xe).parent=oe).aabb,we=ke.aabb,ze=xe.aabb,ve.minx=(we.minx<ze.minx?we:ze).minx,ve.miny=(we.miny<ze.miny?we:ze).miny,ve.maxx=(we.maxx>ze.maxx?we:ze).maxx,ve.maxy=(we.maxy>ze.maxy?we:ze).maxy,ve=ge.aabb,we=oe.aabb,ze=fe.aabb,ve.minx=(we.minx<ze.minx?we:ze).minx,ve.miny=(we.miny<ze.miny?we:ze).miny,ve.maxx=(we.maxx>ze.maxx?we:ze).maxx,ve.maxy=(we.maxy>ze.maxy?we:ze).maxy,we=ke.height,ze=xe.height,oe.height=1+(ze<we?we:ze),we=oe.height,ze=fe.height,ge.height=1+(ze<we?we:ze)):(ge.child2=xe,ze=((oe.child2=fe).parent=oe).aabb,be=ke.aabb,Se=fe.aabb,ze.minx=(be.minx<Se.minx?be:Se).minx,ze.miny=(be.miny<Se.miny?be:Se).miny,ze.maxx=(be.maxx>Se.maxx?be:Se).maxx,ze.maxy=(be.maxy>Se.maxy?be:Se).maxy,ze=ge.aabb,be=oe.aabb,Se=xe.aabb,ze.minx=(be.minx<Se.minx?be:Se).minx,ze.miny=(be.miny<Se.miny?be:Se).miny,ze.maxx=(be.maxx>Se.maxx?be:Se).maxx,ze.maxy=(be.maxy>Se.maxy?be:Se).maxy,be=ke.height,Se=fe.height,oe.height=1+(Se<be?be:Se),be=oe.height,Se=xe.height,ge.height=1+(Se<be?be:Se)),oe=ge):Ce<-1&&(be=ke.child1,Me=ke.child2,ke.child1=oe,ke.parent=oe.parent,null!=(oe.parent=ke).parent?ke.parent.child1==oe?ke.parent.child1=ke:ke.parent.child2=ke:ne.root=ke,be.height>Me.height?(ke.child2=be,Se=((oe.child1=Me).parent=oe).aabb,Ce=ge.aabb,Pe=Me.aabb,Se.minx=(Ce.minx<Pe.minx?Ce:Pe).minx,Se.miny=(Ce.miny<Pe.miny?Ce:Pe).miny,Se.maxx=(Ce.maxx>Pe.maxx?Ce:Pe).maxx,Se.maxy=(Ce.maxy>Pe.maxy?Ce:Pe).maxy,Se=ke.aabb,Ce=oe.aabb,Pe=be.aabb,Se.minx=(Ce.minx<Pe.minx?Ce:Pe).minx,Se.miny=(Ce.miny<Pe.miny?Ce:Pe).miny,Se.maxx=(Ce.maxx>Pe.maxx?Ce:Pe).maxx,Se.maxy=(Ce.maxy>Pe.maxy?Ce:Pe).maxy,Ce=ge.height,Pe=Me.height,oe.height=1+(Pe<Ce?Ce:Pe),Ce=oe.height,Pe=be.height,ke.height=1+(Pe<Ce?Ce:Pe)):(ke.child2=Me,Pe=((oe.child1=be).parent=oe).aabb,Te=ge.aabb,Ae=be.aabb,Pe.minx=(Te.minx<Ae.minx?Te:Ae).minx,Pe.miny=(Te.miny<Ae.miny?Te:Ae).miny,Pe.maxx=(Te.maxx>Ae.maxx?Te:Ae).maxx,Pe.maxy=(Te.maxy>Ae.maxy?Te:Ae).maxy,Pe=ke.aabb,Te=oe.aabb,Ae=Me.aabb,Pe.minx=(Te.minx<Ae.minx?Te:Ae).minx,Pe.miny=(Te.miny<Ae.miny?Te:Ae).miny,Pe.maxx=(Te.maxx>Ae.maxx?Te:Ae).maxx,Pe.maxy=(Te.maxy>Ae.maxy?Te:Ae).maxy,Te=ge.height,Ae=be.height,oe.height=1+(Ae<Te?Te:Ae),Te=oe.height,Ae=Me.height,ke.height=1+(Ae<Te?Te:Ae)),oe=ke));var Me=oe.child1,Te=oe.child2,Ae=Me.height,ke=Te.height;oe.height=1+(ke<Ae?Ae:ke);ke=oe.aabb,Me=Me.aabb,Te=Te.aabb;ke.minx=(Me.minx<Te.minx?Me:Te).minx,ke.miny=(Me.miny<Te.miny?Me:Te).miny,ke.maxx=(Me.maxx>Te.maxx?Me:Te).maxx,ke.maxy=(Me.maxy>Te.maxy?Me:Te).maxy,oe=oe.parent}}mt.synced=!1,mt.moved||(mt.moved=!0,mt.mnext=this.moves,this.moves=mt)}},Je.prototype.broadphase=function(t,e){for(var i=this.syncs;null!=i;){var n=i.shape;if(i.first_sync)i.first_sync=!1;else{var r=i.dyn?this.dtree:this.stree;if(i==r.root)r.root=null;else{var o=i.parent,s=o.parent,a=o.child1==i?o.child2:o.child1;if(null!=s){s.child1==o?s.child1=a:s.child2=a,a.parent=s,o.height=-1;var h=o.aabb;null!=h.outer&&(h.outer.zpp_inner=null,h.outer=null),h.wrap_min=h.wrap_max=null,h._invalidate=null,h._validate=null,h.next=De.zpp_pool,De.zpp_pool=h,o.child1=o.child2=o.parent=null,o.next=null,o.snext=null,o.mnext=null,o.next=Ye.zpp_pool,Ye.zpp_pool=o;for(var l,p,u,d,c,y,_,m,g,f=s;null!=f;){null==f.child1||f.height<2||(b=f.child1,1<(g=(l=f.child2).height-b.height)?(p=l.child1,y=l.child2,l.child1=f,l.parent=f.parent,null!=(f.parent=l).parent?l.parent.child1==f?l.parent.child1=l:l.parent.child2=l:r.root=l,p.height>y.height?(l.child2=p,u=((f.child2=y).parent=f).aabb,d=b.aabb,c=y.aabb,u.minx=(d.minx<c.minx?d:c).minx,u.miny=(d.miny<c.miny?d:c).miny,u.maxx=(d.maxx>c.maxx?d:c).maxx,u.maxy=(d.maxy>c.maxy?d:c).maxy,u=l.aabb,d=f.aabb,c=p.aabb,u.minx=(d.minx<c.minx?d:c).minx,u.miny=(d.miny<c.miny?d:c).miny,u.maxx=(d.maxx>c.maxx?d:c).maxx,u.maxy=(d.maxy>c.maxy?d:c).maxy,d=b.height,c=y.height,f.height=1+(c<d?d:c),d=f.height,c=p.height,l.height=1+(c<d?d:c)):(l.child2=y,c=((f.child2=p).parent=f).aabb,_=b.aabb,m=p.aabb,c.minx=(_.minx<m.minx?_:m).minx,c.miny=(_.miny<m.miny?_:m).miny,c.maxx=(_.maxx>m.maxx?_:m).maxx,c.maxy=(_.maxy>m.maxy?_:m).maxy,c=l.aabb,_=f.aabb,m=y.aabb,c.minx=(_.minx<m.minx?_:m).minx,c.miny=(_.miny<m.miny?_:m).miny,c.maxx=(_.maxx>m.maxx?_:m).maxx,c.maxy=(_.maxy>m.maxy?_:m).maxy,_=b.height,m=p.height,f.height=1+(m<_?_:m),_=f.height,m=y.height,l.height=1+(m<_?_:m)),f=l):g<-1&&(y=b.child1,v=b.child2,b.child1=f,b.parent=f.parent,null!=(f.parent=b).parent?b.parent.child1==f?b.parent.child1=b:b.parent.child2=b:r.root=b,y.height>v.height?(b.child2=y,_=((f.child1=v).parent=f).aabb,m=l.aabb,g=v.aabb,_.minx=(m.minx<g.minx?m:g).minx,_.miny=(m.miny<g.miny?m:g).miny,_.maxx=(m.maxx>g.maxx?m:g).maxx,_.maxy=(m.maxy>g.maxy?m:g).maxy,_=b.aabb,m=f.aabb,g=y.aabb,_.minx=(m.minx<g.minx?m:g).minx,_.miny=(m.miny<g.miny?m:g).miny,_.maxx=(m.maxx>g.maxx?m:g).maxx,_.maxy=(m.maxy>g.maxy?m:g).maxy,m=l.height,g=v.height,f.height=1+(g<m?m:g),m=f.height,g=y.height,b.height=1+(g<m?m:g)):(b.child2=v,z=((f.child1=y).parent=f).aabb,x=l.aabb,w=y.aabb,z.minx=(x.minx<w.minx?x:w).minx,z.miny=(x.miny<w.miny?x:w).miny,z.maxx=(x.maxx>w.maxx?x:w).maxx,z.maxy=(x.maxy>w.maxy?x:w).maxy,z=b.aabb,x=f.aabb,w=v.aabb,z.minx=(x.minx<w.minx?x:w).minx,z.miny=(x.miny<w.miny?x:w).miny,z.maxx=(x.maxx>w.maxx?x:w).maxx,z.maxy=(x.maxy>w.maxy?x:w).maxy,z=l.height,x=y.height,f.height=1+(x<z?z:x),w=f.height,z=v.height,b.height=1+(z<w?w:z)),f=b));var x=f.child1,v=f.child2,w=f.aabb,z=x.aabb,b=v.aabb;w.minx=(z.minx<b.minx?z:b).minx,w.miny=(z.miny<b.miny?z:b).miny,w.maxx=(z.maxx>b.maxx?z:b).maxx,w.maxy=(z.maxy>b.maxy?z:b).maxy;x=x.height,v=v.height;f.height=1+(v<x?x:v),f=f.parent}}else{(r.root=a).parent=null,o.height=-1;var S=o.aabb;null!=S.outer&&(S.outer.zpp_inner=null,S.outer=null),S.wrap_min=S.wrap_max=null,S._invalidate=null,S._validate=null,S.next=De.zpp_pool,De.zpp_pool=S,o.child1=o.child2=o.parent=null,o.next=null,o.snext=null,o.mnext=null,o.next=Ye.zpp_pool,Ye.zpp_pool=o}}}a=i.aabb;if(!t.continuous&&n.zip_aabb&&null!=n.body)if(n.zip_aabb=!1,0==n.type){S=n.circle;if(S.zip_worldCOM&&null!=S.body){if(S.zip_worldCOM=!1,S.zip_localCOM){if(S.zip_localCOM=!1,1==S.type){var C=S.polygon;if(null==C.lverts.next.next)C.localCOMx=C.lverts.next.x,C.localCOMy=C.lverts.next.y;else if(null==C.lverts.next.next.next)C.localCOMx=C.lverts.next.x,C.localCOMy=C.lverts.next.y,C.localCOMx+=C.lverts.next.next.x,C.localCOMy+=C.lverts.next.next.y,C.localCOMx*=.5,C.localCOMy*=.5;else{C.localCOMx=0;var P=C.localCOMy=0,M=C.lverts.next,T=M,A=M=M.next;for(M=M.next;null!=M;){var k=M;P+=A.x*(k.y-T.y);var O=k.y*A.x-k.x*A.y;C.localCOMx+=(A.x+k.x)*O,C.localCOMy+=(A.y+k.y)*O,T=A,A=k,M=M.next}o=M=C.lverts.next;P+=A.x*(o.y-T.y);var E=o.y*A.x-o.x*A.y;C.localCOMx+=(A.x+o.x)*E,C.localCOMy+=(A.y+o.y)*E;var T=A,I=M=M.next;P+=o.x*(I.y-T.y);E=I.y*o.x-I.x*o.y;C.localCOMx+=(o.x+I.x)*E,C.localCOMy+=(o.y+I.y)*E;I=P=1/(3*P);C.localCOMx*=I,C.localCOMy*=I}}null!=S.wrap_localCOM&&(S.wrap_localCOM.zpp_inner.x=S.localCOMx,S.wrap_localCOM.zpp_inner.y=S.localCOMy)}E=S.body;E.zip_axis&&(E.zip_axis=!1,E.axisx=Math.sin(E.rot),E.axisy=Math.cos(E.rot)),S.worldCOMx=S.body.posx+(S.body.axisy*S.localCOMx-S.body.axisx*S.localCOMy),S.worldCOMy=S.body.posy+(S.localCOMx*S.body.axisx+S.localCOMy*S.body.axisy)}I=S.radius,E=S.radius;S.aabb.minx=S.worldCOMx-I,S.aabb.miny=S.worldCOMy-E,S.aabb.maxx=S.worldCOMx+I,S.aabb.maxy=S.worldCOMy+E}else{var G=n.polygon;if(G.zip_gverts&&null!=G.body){G.zip_gverts=!1,G.validate_lverts();var D=G.body;D.zip_axis&&(D.zip_axis=!1,D.axisx=Math.sin(D.rot),D.axisy=Math.cos(D.rot));for(var L=G.lverts.next,B=G.gverts.next;null!=B;){var R=B,F=L,L=L.next;R.x=G.body.posx+(G.body.axisy*F.x-G.body.axisx*F.y),R.y=G.body.posy+(F.x*G.body.axisx+F.y*G.body.axisy),B=B.next}}var N=G.gverts.next;G.aabb.minx=N.x,G.aabb.miny=N.y,G.aabb.maxx=N.x,G.aabb.maxy=N.y;for(var j=G.gverts.next.next;null!=j;){var U=j;U.x<G.aabb.minx&&(G.aabb.minx=U.x),U.x>G.aabb.maxx&&(G.aabb.maxx=U.x),U.y<G.aabb.miny&&(G.aabb.miny=U.y),U.y>G.aabb.maxy&&(G.aabb.maxy=U.y),j=j.next}}D=n.aabb;a.minx=D.minx-3,a.miny=D.miny-3,a.maxx=D.maxx+3,a.maxy=D.maxy+3;var V=(i.dyn=1!=n.body.type&&!n.body.component.sleeping)?this.dtree:this.stree;if(null==V.root)V.root=i,V.root.parent=null;else{for(var W=i.aabb,X=V.root;null!=X.child1;){var H=X.child1,q=X.child2,Y=X.aabb,K=2*(Y.maxx-Y.minx+(Y.maxy-Y.miny)),Z=Ze.tmpaabb,J=X.aabb;Z.minx=(J.minx<W.minx?J:W).minx,Z.miny=(J.miny<W.miny?J:W).miny,Z.maxx=(J.maxx>W.maxx?J:W).maxx,Z.maxy=(J.maxy>W.maxy?J:W).maxy;var Q,Y=Ze.tmpaabb,Z=2*(Y.maxx-Y.minx+(Y.maxy-Y.miny)),J=2*Z,Y=2*(Z-K),Z=Ze.tmpaabb,K=H.aabb;Z.minx=(W.minx<K.minx?W:K).minx,Z.miny=(W.miny<K.miny?W:K).miny,Z.maxx=(W.maxx>K.maxx?W:K).maxx,Z.maxy=(W.maxy>K.maxy?W:K).maxy,Q=null==H.child1?2*((K=Ze.tmpaabb).maxx-K.minx+(K.maxy-K.miny))+Y:(et=2*((Q=H.aabb).maxx-Q.minx+(Q.maxy-Q.miny)),2*((tt=Ze.tmpaabb).maxx-tt.minx+(tt.maxy-tt.miny))-et+Y);var $,tt=Ze.tmpaabb,et=q.aabb;if(tt.minx=(W.minx<et.minx?W:et).minx,tt.miny=(W.miny<et.miny?W:et).miny,tt.maxx=(W.maxx>et.maxx?W:et).maxx,tt.maxy=(W.maxy>et.maxy?W:et).maxy,Y=null==q.child1?2*(($=Ze.tmpaabb).maxx-$.minx+($.maxy-$.miny))+Y:($=2*((et=q.aabb).maxx-et.minx+(et.maxy-et.miny)),2*((et=Ze.tmpaabb).maxx-et.minx+(et.maxy-et.miny))-$+Y),J<Q&&J<Y)break;X=Q<Y?H:q}var it,N=X,a=N.parent;null==Ye.zpp_pool?it=new Ye:(it=Ye.zpp_pool,Ye.zpp_pool=it.next,it.next=null),null==De.zpp_pool?it.aabb=new De:(it.aabb=De.zpp_pool,De.zpp_pool=it.aabb.next,it.aabb.next=null),it.moved=!1,it.synced=!1,it.first_sync=!1,it.parent=a;var nt,rt,ot,st,at,ht,lt,pt,ut,dt,D=it.aabb,n=N.aabb;for(D.minx=(W.minx<n.minx?W:n).minx,D.miny=(W.miny<n.miny?W:n).miny,D.maxx=(W.maxx>n.maxx?W:n).maxx,D.maxy=(W.maxy>n.maxy?W:n).maxy,it.height=N.height+1,null!=a?(a.child1==N?a.child1=it:a.child2=it,it.child1=N,it.child2=i,N.parent=it,i.parent=it):(it.child1=N,it.child2=i,N.parent=it,i.parent=it,V.root=it),X=i.parent;null!=X;){null==X.child1||X.height<2||(mt=X.child1,1<(ut=(nt=X.child2).height-mt.height)?(rt=nt.child1,ot=nt.child2,nt.child1=X,nt.parent=X.parent,null!=(X.parent=nt).parent?nt.parent.child1==X?nt.parent.child1=nt:nt.parent.child2=nt:V.root=nt,rt.height>ot.height?(nt.child2=rt,st=((X.child2=ot).parent=X).aabb,at=mt.aabb,ht=ot.aabb,st.minx=(at.minx<ht.minx?at:ht).minx,st.miny=(at.miny<ht.miny?at:ht).miny,st.maxx=(at.maxx>ht.maxx?at:ht).maxx,st.maxy=(at.maxy>ht.maxy?at:ht).maxy,st=nt.aabb,at=X.aabb,ht=rt.aabb,st.minx=(at.minx<ht.minx?at:ht).minx,st.miny=(at.miny<ht.miny?at:ht).miny,st.maxx=(at.maxx>ht.maxx?at:ht).maxx,st.maxy=(at.maxy>ht.maxy?at:ht).maxy,at=mt.height,ht=ot.height,X.height=1+(ht<at?at:ht),at=X.height,ht=rt.height,nt.height=1+(ht<at?at:ht)):(nt.child2=ot,ht=((X.child2=rt).parent=X).aabb,lt=mt.aabb,pt=rt.aabb,ht.minx=(lt.minx<pt.minx?lt:pt).minx,ht.miny=(lt.miny<pt.miny?lt:pt).miny,ht.maxx=(lt.maxx>pt.maxx?lt:pt).maxx,ht.maxy=(lt.maxy>pt.maxy?lt:pt).maxy,ht=nt.aabb,lt=X.aabb,pt=ot.aabb,ht.minx=(lt.minx<pt.minx?lt:pt).minx,ht.miny=(lt.miny<pt.miny?lt:pt).miny,ht.maxx=(lt.maxx>pt.maxx?lt:pt).maxx,ht.maxy=(lt.maxy>pt.maxy?lt:pt).maxy,lt=mt.height,pt=rt.height,X.height=1+(pt<lt?lt:pt),lt=X.height,pt=ot.height,nt.height=1+(pt<lt?lt:pt)),X=nt):ut<-1&&(lt=mt.child1,ct=mt.child2,mt.child1=X,mt.parent=X.parent,null!=(X.parent=mt).parent?mt.parent.child1==X?mt.parent.child1=mt:mt.parent.child2=mt:V.root=mt,lt.height>ct.height?(mt.child2=lt,pt=((X.child1=ct).parent=X).aabb,ut=nt.aabb,dt=ct.aabb,pt.minx=(ut.minx<dt.minx?ut:dt).minx,pt.miny=(ut.miny<dt.miny?ut:dt).miny,pt.maxx=(ut.maxx>dt.maxx?ut:dt).maxx,pt.maxy=(ut.maxy>dt.maxy?ut:dt).maxy,pt=mt.aabb,ut=X.aabb,dt=lt.aabb,pt.minx=(ut.minx<dt.minx?ut:dt).minx,pt.miny=(ut.miny<dt.miny?ut:dt).miny,pt.maxx=(ut.maxx>dt.maxx?ut:dt).maxx,pt.maxy=(ut.maxy>dt.maxy?ut:dt).maxy,ut=nt.height,dt=ct.height,X.height=1+(dt<ut?ut:dt),ut=X.height,dt=lt.height,mt.height=1+(dt<ut?ut:dt)):(mt.child2=ct,dt=((X.child1=lt).parent=X).aabb,yt=nt.aabb,_t=lt.aabb,dt.minx=(yt.minx<_t.minx?yt:_t).minx,dt.miny=(yt.miny<_t.miny?yt:_t).miny,dt.maxx=(yt.maxx>_t.maxx?yt:_t).maxx,dt.maxy=(yt.maxy>_t.maxy?yt:_t).maxy,dt=mt.aabb,yt=X.aabb,_t=ct.aabb,dt.minx=(yt.minx<_t.minx?yt:_t).minx,dt.miny=(yt.miny<_t.miny?yt:_t).miny,dt.maxx=(yt.maxx>_t.maxx?yt:_t).maxx,dt.maxy=(yt.maxy>_t.maxy?yt:_t).maxy,yt=nt.height,_t=lt.height,X.height=1+(_t<yt?yt:_t),yt=X.height,_t=ct.height,mt.height=1+(_t<yt?yt:_t)),X=mt));var ct=X.child1,yt=X.child2,_t=ct.height,mt=yt.height;X.height=1+(mt<_t?_t:mt);mt=X.aabb,ct=ct.aabb,yt=yt.aabb;mt.minx=(ct.minx<yt.minx?ct:yt).minx,mt.miny=(ct.miny<yt.miny?ct:yt).miny,mt.maxx=(ct.maxx>yt.maxx?ct:yt).maxx,mt.maxy=(ct.maxy>yt.maxy?ct:yt).maxy,X=X.parent}}i.synced=!1,i=i.snext}for(;null!=this.syncs;){var gt=this.syncs;if(this.syncs=gt.snext,gt.snext=null,!gt.moved){gt.moved=!1;var ft=gt.shape;if(!ft.body.component.sleeping){var xt=gt.aabb,vt=null;for(null!=this.dtree.root&&(this.dtree.root.next=vt,vt=this.dtree.root);null!=vt;){var wt=vt,vt=wt.next;if(wt.next=null,wt!=gt)if(null==wt.child1){var zt=wt.shape;if(zt.body!=ft.body&&(1!=zt.body.type||1!=ft.body.type)){var bt=wt.aabb;if(bt.miny<=xt.maxy&&xt.miny<=bt.maxy&&bt.minx<=xt.maxx&&xt.minx<=bt.maxx){for(var St,Ct,Pt,Mt=ft.id<zt.id?(St=ft.id,zt.id):(St=zt.id,ft.id),Tt=null,At=(ft.pairs.length<zt.pairs.length?ft:zt).pairs.head;null!=At;){var kt=At.elt;if(kt.id==St&&kt.di==Mt){Tt=kt;break}At=At.next}null==Tt?(null==Ke.zpp_pool?Tt=new Ke:(Tt=Ke.zpp_pool,Ke.zpp_pool=Tt.next,Tt.next=null),Tt.n1=gt,Tt.n2=wt,Tt.id=St,Tt.di=Mt,Tt.next=this.pairs,(this.pairs=Tt).first=!0,Ot=ft.pairs,null==un.zpp_pool?Ct=new un:(Ct=un.zpp_pool,un.zpp_pool=Ct.next,Ct.next=null),Ct.elt=Tt,(bt=Ct).next=Ot.head,Ot.head=bt,Ot.modified=!0,Ot.length++,Ot=zt.pairs,null==un.zpp_pool?Pt=new un:(Pt=un.zpp_pool,un.zpp_pool=Pt.next,Pt.next=null),Pt.elt=Tt,(zt=Pt).next=Ot.head,Ot.head=zt,Ot.modified=!0,Ot.length++):Tt.sleeping&&(Tt.sleeping=!1,Tt.next=this.pairs,(this.pairs=Tt).first=!0)}}}else{var Ot=wt.aabb;Ot.miny<=xt.maxy&&xt.miny<=Ot.maxy&&Ot.minx<=xt.maxx&&xt.minx<=Ot.maxx&&(null!=wt.child1&&(wt.child1.next=vt,vt=wt.child1),null!=wt.child2&&(wt.child2.next=vt,vt=wt.child2))}}for(null!=this.stree.root&&(this.stree.root.next=vt,vt=this.stree.root);null!=vt;){var Et=vt;if(vt=Et.next,Et.next=null,Et!=gt)if(null==Et.child1){var It=Et.shape;if(It.body!=ft.body&&(1!=It.body.type||1!=ft.body.type)){var Gt=Et.aabb;if(Gt.miny<=xt.maxy&&xt.miny<=Gt.maxy&&Gt.minx<=xt.maxx&&xt.minx<=Gt.maxx){for(var Dt,Lt,Bt,Rt=ft.id<It.id?(Dt=ft.id,It.id):(Dt=It.id,ft.id),Ft=null,Nt=(ft.pairs.length<It.pairs.length?ft:It).pairs.head;null!=Nt;){var jt=Nt.elt;if(jt.id==Dt&&jt.di==Rt){Ft=jt;break}Nt=Nt.next}null==Ft?(null==Ke.zpp_pool?Ft=new Ke:(Ft=Ke.zpp_pool,Ke.zpp_pool=Ft.next,Ft.next=null),Ft.n1=gt,Ft.n2=Et,Ft.id=Dt,Ft.di=Rt,Ft.next=this.pairs,(this.pairs=Ft).first=!0,Ut=ft.pairs,null==un.zpp_pool?Lt=new un:(Lt=un.zpp_pool,un.zpp_pool=Lt.next,Lt.next=null),Lt.elt=Ft,(Gt=Lt).next=Ut.head,Ut.head=Gt,Ut.modified=!0,Ut.length++,Ut=It.pairs,null==un.zpp_pool?Bt=new un:(Bt=un.zpp_pool,un.zpp_pool=Bt.next,Bt.next=null),Bt.elt=Ft,(It=Bt).next=Ut.head,Ut.head=It,Ut.modified=!0,Ut.length++):Ft.sleeping&&(Ft.sleeping=!1,Ft.next=this.pairs,(this.pairs=Ft).first=!0)}}}else{var Ut=Et.aabb;Ut.miny<=xt.maxy&&xt.miny<=Ut.maxy&&Ut.minx<=xt.maxx&&xt.minx<=Ut.maxx&&(null!=Et.child1&&(Et.child1.next=vt,vt=Et.child1),null!=Et.child2&&(Et.child2.next=vt,vt=Et.child2))}}}}}for(;null!=this.moves;){var Vt=this.moves;this.moves=Vt.mnext,Vt.mnext=null,Vt.moved=!1;var Wt=Vt.shape;if(!Wt.body.component.sleeping){var Xt=Vt.aabb,Ht=null;for(null!=this.dtree.root&&(this.dtree.root.next=Ht,Ht=this.dtree.root);null!=Ht;){var qt=Ht,Ht=qt.next;if(qt.next=null,qt!=Vt)if(null==qt.child1){var Yt=qt.shape;if(Yt.body!=Wt.body&&(1!=Yt.body.type||1!=Wt.body.type)){var Kt=qt.aabb;if(Kt.miny<=Xt.maxy&&Xt.miny<=Kt.maxy&&Kt.minx<=Xt.maxx&&Xt.minx<=Kt.maxx){for(var Zt,Jt,Qt,$t=Wt.id<Yt.id?(Zt=Wt.id,Yt.id):(Zt=Yt.id,Wt.id),te=null,ee=(Wt.pairs.length<Yt.pairs.length?Wt:Yt).pairs.head;null!=ee;){var ie=ee.elt;if(ie.id==Zt&&ie.di==$t){te=ie;break}ee=ee.next}null==te?(null==Ke.zpp_pool?te=new Ke:(te=Ke.zpp_pool,Ke.zpp_pool=te.next,te.next=null),te.n1=Vt,te.n2=qt,te.id=Zt,te.di=$t,te.next=this.pairs,(this.pairs=te).first=!0,ne=Wt.pairs,null==un.zpp_pool?Jt=new un:(Jt=un.zpp_pool,un.zpp_pool=Jt.next,Jt.next=null),Jt.elt=te,(Kt=Jt).next=ne.head,ne.head=Kt,ne.modified=!0,ne.length++,ne=Yt.pairs,null==un.zpp_pool?Qt=new un:(Qt=un.zpp_pool,un.zpp_pool=Qt.next,Qt.next=null),Qt.elt=te,(Yt=Qt).next=ne.head,ne.head=Yt,ne.modified=!0,ne.length++):te.sleeping&&(te.sleeping=!1,te.next=this.pairs,(this.pairs=te).first=!0)}}}else{var ne=qt.aabb;ne.miny<=Xt.maxy&&Xt.miny<=ne.maxy&&ne.minx<=Xt.maxx&&Xt.minx<=ne.maxx&&(null!=qt.child1&&(qt.child1.next=Ht,Ht=qt.child1),null!=qt.child2&&(qt.child2.next=Ht,Ht=qt.child2))}}for(null!=this.stree.root&&(this.stree.root.next=Ht,Ht=this.stree.root);null!=Ht;){var re=Ht;if(Ht=re.next,re.next=null,re!=Vt)if(null==re.child1){var oe=re.shape;if(oe.body!=Wt.body&&(1!=oe.body.type||1!=Wt.body.type)){var se=re.aabb;if(se.miny<=Xt.maxy&&Xt.miny<=se.maxy&&se.minx<=Xt.maxx&&Xt.minx<=se.maxx){for(var ae,he,le,pe=Wt.id<oe.id?(ae=Wt.id,oe.id):(ae=oe.id,Wt.id),ue=null,de=(Wt.pairs.length<oe.pairs.length?Wt:oe).pairs.head;null!=de;){var ce=de.elt;if(ce.id==ae&&ce.di==pe){ue=ce;break}de=de.next}null==ue?(null==Ke.zpp_pool?ue=new Ke:(ue=Ke.zpp_pool,Ke.zpp_pool=ue.next,ue.next=null),ue.n1=Vt,ue.n2=re,ue.id=ae,ue.di=pe,ue.next=this.pairs,(this.pairs=ue).first=!0,ye=Wt.pairs,null==un.zpp_pool?he=new un:(he=un.zpp_pool,un.zpp_pool=he.next,he.next=null),he.elt=ue,(se=he).next=ye.head,ye.head=se,ye.modified=!0,ye.length++,ye=oe.pairs,null==un.zpp_pool?le=new un:(le=un.zpp_pool,un.zpp_pool=le.next,le.next=null),le.elt=ue,(oe=le).next=ye.head,ye.head=oe,ye.modified=!0,ye.length++):ue.sleeping&&(ue.sleeping=!1,ue.next=this.pairs,(this.pairs=ue).first=!0)}}}else{var ye=re.aabb;ye.miny<=Xt.maxy&&Xt.miny<=ye.maxy&&ye.minx<=Xt.maxx&&Xt.minx<=ye.maxx&&(null!=re.child1&&(re.child1.next=Ht,Ht=re.child1),null!=re.child2&&(re.child2.next=Ht,Ht=re.child2))}}}}for(var _e=null,me=this.pairs;null!=me;)if(!me.first&&(Ie=me.n1.aabb,!((Ge=me.n2.aabb).miny<=Ie.maxy&&Ie.miny<=Ge.maxy&&Ge.minx<=Ie.maxx&&Ie.minx<=Ge.maxx))){null==_e?this.pairs=me.next:_e.next=me.next;for(var ge,fe,xe=me.n1.shape.pairs,ve=null,we=xe.head;null!=we;){if(we.elt==me){null==ve?(fe=(ge=xe.head).next,xe.head=fe,null==xe.head&&(xe.pushmod=!0)):(fe=(ge=ve.next).next,null==(ve.next=fe)&&(xe.pushmod=!0));var ze=ge;ze.elt=null,ze.next=un.zpp_pool,un.zpp_pool=ze,xe.modified=!0,xe.length--,xe.pushmod=!0;break}we=(ve=we).next}for(var be,Se,Ce=me.n2.shape.pairs,Pe=null,Me=Ce.head;null!=Me;){if(Me.elt==me){null==Pe?(Se=(be=Ce.head).next,Ce.head=Se,null==Ce.head&&(Ce.pushmod=!0)):(Se=(be=Pe.next).next,null==(Pe.next=Se)&&(Ce.pushmod=!0));var Te=be;Te.elt=null,Te.next=un.zpp_pool,un.zpp_pool=Te,Ce.modified=!0,Ce.length--,Ce.pushmod=!0;break}Me=(Pe=Me).next}var Ae=me.next;null!=me.arb&&(me.arb.pair=null),me.arb=null;var ke=me;ke.n1=ke.n2=null,ke.sleeping=!1,ke.next=Ke.zpp_pool,Ke.zpp_pool=ke,me=Ae}else var Oe=me.n1.shape,Ee=Oe.body,Ie=me.n2.shape,Ge=Ie.body,me=me.first||!Ee.component.sleeping&&1!=Ee.type||!Ge.component.sleeping&&1!=Ge.type?(me.first=!1,ke=Oe.aabb,(Ae=Ie.aabb).miny<=ke.maxy&&ke.miny<=Ae.maxy&&Ae.minx<=ke.maxx&&ke.minx<=Ae.maxx&&(Ae=me.arb,me.arb=e?t.narrowPhase(Oe,Ie,2!=Ee.type||2!=Ge.type,me.arb,!1):t.continuousEvent(Oe,Ie,2!=Ee.type||2!=Ge.type,me.arb,!1),null==me.arb?null!=Ae&&(Ae.pair=null):me.arb.pair=me),(_e=me).next):(me.sleeping=!0,null==_e?this.pairs=me.next:_e.next=me.next,me.next)},Je.prototype.clear=function(){for(;null!=this.syncs;){var t=this.syncs.snext;this.syncs.snext=null,this.syncs.first_sync&&(this.syncs.shape.node=null,this.syncs.shape.removedFromSpace(),this.syncs.shape=null),this.syncs=t}for(;null!=this.moves;){var e=this.moves.mnext;this.moves.mnext=null,this.moves.first_sync&&(this.moves.shape.node=null,this.moves.shape.removedFromSpace(),this.moves.shape=null),this.moves=e}for(;null!=this.pairs;){var i=this.pairs.next;null!=this.pairs.arb&&(this.pairs.arb.pair=null),this.pairs.arb=null;for(var n,r,o=this.pairs.n1.shape.pairs,s=this.pairs,a=null,h=o.head;null!=h;){if(h.elt==s){null==a?(r=(n=o.head).next,o.head=r,null==o.head&&(o.pushmod=!0)):(r=(n=a.next).next,null==(a.next=r)&&(o.pushmod=!0));var l=n;l.elt=null,l.next=un.zpp_pool,un.zpp_pool=l,o.modified=!0,o.length--,o.pushmod=!0;break}h=(a=h).next}for(var p,u,d=this.pairs.n2.shape.pairs,c=this.pairs,y=null,_=d.head;null!=_;){if(_.elt==c){null==y?(u=(p=d.head).next,d.head=u,null==d.head&&(d.pushmod=!0)):(u=(p=y.next).next,null==(y.next=u)&&(d.pushmod=!0));var m=p;m.elt=null,m.next=un.zpp_pool,un.zpp_pool=m,d.modified=!0,d.length--,d.pushmod=!0;break}_=(y=_).next}var g=this.pairs;g.n1=g.n2=null,g.sleeping=!1,g.next=Ke.zpp_pool,Ke.zpp_pool=g,this.pairs=i}this.dtree.clear(),this.stree.clear()},Je.prototype.treeStack=null,Je.prototype.shapesUnderPoint=function(t,e,i,n){var r;this.sync_broadphase(),null==Gr.zpp_pool?r=new Gr:(r=Gr.zpp_pool,Gr.zpp_pool=r.next,r.next=null),r.weak=!1,r._immutable=!1,r.x=t,r.y=e;var o=r,s=null==n?new _t:n;if(null!=this.stree.root)for(null==this.treeStack&&(this.treeStack=new Oi),this.treeStack.add(this.stree.root);null!=this.treeStack.head;){var a=this.treeStack.pop_unsafe(),h=a.aabb;o.x>=h.minx&&o.x<=h.maxx&&o.y>=h.miny&&o.y<=h.maxy&&(null==a.child1?(null==i||0!=((h=a.shape.filter).collisionMask&i.collisionGroup)&&0!=(i.collisionMask&h.collisionGroup))&&(0==a.shape.type?Ir.circleContains(a.shape.circle,o)&&s.push(a.shape.outer):Ir.polyContains(a.shape.polygon,o)&&s.push(a.shape.outer)):(null!=a.child1&&this.treeStack.add(a.child1),null!=a.child2&&this.treeStack.add(a.child2)))}if(null!=this.dtree.root)for(null==this.treeStack&&(this.treeStack=new Oi),this.treeStack.add(this.dtree.root);null!=this.treeStack.head;){var l=this.treeStack.pop_unsafe(),p=l.aabb;o.x>=p.minx&&o.x<=p.maxx&&o.y>=p.miny&&o.y<=p.maxy&&(null==l.child1?(null==i||0!=((p=l.shape.filter).collisionMask&i.collisionGroup)&&0!=(i.collisionMask&p.collisionGroup))&&(0==l.shape.type?Ir.circleContains(l.shape.circle,o)&&s.push(l.shape.outer):Ir.polyContains(l.shape.polygon,o)&&s.push(l.shape.outer)):(null!=l.child1&&this.treeStack.add(l.child1),null!=l.child2&&this.treeStack.add(l.child2)))}return null!=o.outer&&(o.outer.zpp_inner=null,o.outer=null),o._isimmutable=null,o._validate=null,o._invalidate=null,o.next=Gr.zpp_pool,Gr.zpp_pool=o,s},Je.prototype.bodiesUnderPoint=function(t,e,i,n){var r;this.sync_broadphase(),null==Gr.zpp_pool?r=new Gr:(r=Gr.zpp_pool,Gr.zpp_pool=r.next,r.next=null),r.weak=!1,r._immutable=!1,r.x=t,r.y=e;var o=r,s=null==n?new tt:n;if(null!=this.stree.root)for(null==this.treeStack&&(this.treeStack=new Oi),this.treeStack.add(this.stree.root);null!=this.treeStack.head;){var a,h=this.treeStack.pop_unsafe(),l=h.aabb;o.x>=l.minx&&o.x<=l.maxx&&o.y>=l.miny&&o.y<=l.maxy&&(null==h.child1?(a=h.shape.body.outer,s.has(a)||(null==i||0!=((l=h.shape.filter).collisionMask&i.collisionGroup)&&0!=(i.collisionMask&l.collisionGroup))&&(0==h.shape.type?Ir.circleContains(h.shape.circle,o)&&s.push(a):Ir.polyContains(h.shape.polygon,o)&&s.push(a))):(null!=h.child1&&this.treeStack.add(h.child1),null!=h.child2&&this.treeStack.add(h.child2)))}if(null!=this.dtree.root)for(null==this.treeStack&&(this.treeStack=new Oi),this.treeStack.add(this.dtree.root);null!=this.treeStack.head;){var p,u=this.treeStack.pop_unsafe(),d=u.aabb;o.x>=d.minx&&o.x<=d.maxx&&o.y>=d.miny&&o.y<=d.maxy&&(null==u.child1?(p=u.shape.body.outer,s.has(p)||(null==i||0!=((d=u.shape.filter).collisionMask&i.collisionGroup)&&0!=(i.collisionMask&d.collisionGroup))&&(0==u.shape.type?Ir.circleContains(u.shape.circle,o)&&s.push(p):Ir.polyContains(u.shape.polygon,o)&&s.push(p))):(null!=u.child1&&this.treeStack.add(u.child1),null!=u.child2&&this.treeStack.add(u.child2)))}return null!=o.outer&&(o.outer.zpp_inner=null,o.outer=null),o._isimmutable=null,o._validate=null,o._invalidate=null,o.next=Gr.zpp_pool,Gr.zpp_pool=o,s},Je.prototype.treeStack2=null,Je.prototype.shapesInAABB=function(t,e,i,n,r){this.sync_broadphase(),this.updateAABBShape(t);var o=this.aabbShape.zpp_inner.aabb,s=null==r?new _t:r;if(null!=this.stree.root)for(null==this.treeStack&&(this.treeStack=new Oi),this.treeStack.add(this.stree.root);null!=this.treeStack.head;){var a=this.treeStack.pop_unsafe(),h=a.aabb;if(h.minx>=o.minx&&h.miny>=o.miny&&h.maxx<=o.maxx&&h.maxy<=o.maxy)if(null==a.child1)(null==n||0!=((d=a.shape.filter).collisionMask&n.collisionGroup)&&0!=(n.collisionMask&d.collisionGroup))&&s.push(a.shape.outer);else for(null==this.treeStack2&&(this.treeStack2=new Oi),this.treeStack2.add(a);null!=this.treeStack2.head;){var l,p=this.treeStack2.pop_unsafe();null==p.child1?(null==n||0!=((l=p.shape.filter).collisionMask&n.collisionGroup)&&0!=(n.collisionMask&l.collisionGroup))&&s.push(p.shape.outer):(null!=p.child1&&this.treeStack2.add(p.child1),null!=p.child2&&this.treeStack2.add(p.child2))}else{var u,d=a.aabb;o.miny<=d.maxy&&d.miny<=o.maxy&&o.minx<=d.maxx&&d.minx<=o.maxx&&(null==a.child1?(null==n||0!=((d=a.shape.filter).collisionMask&n.collisionGroup)&&0!=(n.collisionMask&d.collisionGroup))&&(e?i?Ir.containTest(this.aabbShape.zpp_inner,a.shape)&&s.push(a.shape.outer):((u=a.shape.aabb).minx>=o.minx&&u.miny>=o.miny&&u.maxx<=o.maxx&&u.maxy<=o.maxy||Ir.testCollide_safe(a.shape,this.aabbShape.zpp_inner))&&s.push(a.shape.outer):(!i||(u=a.shape.aabb).minx>=o.minx&&u.miny>=o.miny&&u.maxx<=o.maxx&&u.maxy<=o.maxy)&&s.push(a.shape.outer)):(null!=a.child1&&this.treeStack.add(a.child1),null!=a.child2&&this.treeStack.add(a.child2)))}}if(null!=this.dtree.root)for(null==this.treeStack&&(this.treeStack=new Oi),this.treeStack.add(this.dtree.root);null!=this.treeStack.head;){var c=this.treeStack.pop_unsafe(),y=c.aabb;if(y.minx>=o.minx&&y.miny>=o.miny&&y.maxx<=o.maxx&&y.maxy<=o.maxy)if(null==c.child1)(null==n||0!=((f=c.shape.filter).collisionMask&n.collisionGroup)&&0!=(n.collisionMask&f.collisionGroup))&&s.push(c.shape.outer);else for(null==this.treeStack2&&(this.treeStack2=new Oi),this.treeStack2.add(c);null!=this.treeStack2.head;){var _,m=this.treeStack2.pop_unsafe();null==m.child1?(null==n||0!=((_=m.shape.filter).collisionMask&n.collisionGroup)&&0!=(n.collisionMask&_.collisionGroup))&&s.push(m.shape.outer):(null!=m.child1&&this.treeStack2.add(m.child1),null!=m.child2&&this.treeStack2.add(m.child2))}else{var g,f=c.aabb;o.miny<=f.maxy&&f.miny<=o.maxy&&o.minx<=f.maxx&&f.minx<=o.maxx&&(null==c.child1?(null==n||0!=((f=c.shape.filter).collisionMask&n.collisionGroup)&&0!=(n.collisionMask&f.collisionGroup))&&(e?i?Ir.containTest(this.aabbShape.zpp_inner,c.shape)&&s.push(c.shape.outer):((g=c.shape.aabb).minx>=o.minx&&g.miny>=o.miny&&g.maxx<=o.maxx&&g.maxy<=o.maxy||Ir.testCollide_safe(c.shape,this.aabbShape.zpp_inner))&&s.push(c.shape.outer):(!i||(g=c.shape.aabb).minx>=o.minx&&g.miny>=o.miny&&g.maxx<=o.maxx&&g.maxy<=o.maxy)&&s.push(c.shape.outer)):(null!=c.child1&&this.treeStack.add(c.child1),null!=c.child2&&this.treeStack.add(c.child2)))}}return s},Je.prototype.failed=null,Je.prototype.bodiesInAABB=function(t,e,i,n,r){this.sync_broadphase(),this.updateAABBShape(t);var o=this.aabbShape.zpp_inner.aabb,s=null==r?new tt:r;if(null==this.failed&&(this.failed=new tt),null!=this.stree.root)for(null==this.treeStack&&(this.treeStack=new Oi),this.treeStack.add(this.stree.root);null!=this.treeStack.head;){var a=this.treeStack.pop_unsafe(),h=a.aabb;if(h.minx>=o.minx&&h.miny>=o.miny&&h.maxx<=o.maxx&&h.maxy<=o.maxy)if(null==a.child1)(null==n||0!=((h=a.shape.filter).collisionMask&n.collisionGroup)&&0!=(n.collisionMask&h.collisionGroup))&&(c=a.shape.body.outer,s.has(c)||s.push(c));else for(null==this.treeStack2&&(this.treeStack2=new Oi),this.treeStack2.add(a);null!=this.treeStack2.head;){var l,p=this.treeStack2.pop_unsafe();null==p.child1?(null==n||0!=((l=p.shape.filter).collisionMask&n.collisionGroup)&&0!=(n.collisionMask&l.collisionGroup))&&(l=p.shape.body.outer,s.has(l)||s.push(l)):(null!=p.child1&&this.treeStack2.add(p.child1),null!=p.child2&&this.treeStack2.add(p.child2))}else{var u,d,c=a.aabb;o.miny<=c.maxy&&c.miny<=o.maxy&&o.minx<=c.maxx&&c.minx<=o.maxx&&(null==a.child1?(c=a.shape.body.outer,(null==n||0!=((u=a.shape.filter).collisionMask&n.collisionGroup)&&0!=(n.collisionMask&u.collisionGroup))&&(e?i?this.failed.has(c)||(u=Ir.containTest(this.aabbShape.zpp_inner,a.shape),!s.has(c)&&u?s.push(c):u||(s.remove(c),this.failed.push(c))):!s.has(c)&&Ir.testCollide_safe(a.shape,this.aabbShape.zpp_inner)&&s.push(c):i?this.failed.has(c)||(d=(d=a.shape.aabb).minx>=o.minx&&d.miny>=o.miny&&d.maxx<=o.maxx&&d.maxy<=o.maxy,!s.has(c)&&d?s.push(c):d||(s.remove(c),this.failed.push(c))):!s.has(c)&&((d=a.shape.aabb).minx>=o.minx&&d.miny>=o.miny&&d.maxx<=o.maxx&&d.maxy<=o.maxy)&&s.push(c))):(null!=a.child1&&this.treeStack.add(a.child1),null!=a.child2&&this.treeStack.add(a.child2)))}}if(null!=this.dtree.root)for(null==this.treeStack&&(this.treeStack=new Oi),this.treeStack.add(this.dtree.root);null!=this.treeStack.head;){var y=this.treeStack.pop_unsafe(),_=y.aabb;if(_.minx>=o.minx&&_.miny>=o.miny&&_.maxx<=o.maxx&&_.maxy<=o.maxy)if(null==y.child1)(null==n||0!=((_=y.shape.filter).collisionMask&n.collisionGroup)&&0!=(n.collisionMask&_.collisionGroup))&&(v=y.shape.body.outer,s.has(v)||s.push(v));else for(null==this.treeStack2&&(this.treeStack2=new Oi),this.treeStack2.add(y);null!=this.treeStack2.head;){var m,g=this.treeStack2.pop_unsafe();null==g.child1?(null==n||0!=((m=g.shape.filter).collisionMask&n.collisionGroup)&&0!=(n.collisionMask&m.collisionGroup))&&(m=g.shape.body.outer,s.has(m)||s.push(m)):(null!=g.child1&&this.treeStack2.add(g.child1),null!=g.child2&&this.treeStack2.add(g.child2))}else{var f,x,v=y.aabb;o.miny<=v.maxy&&v.miny<=o.maxy&&o.minx<=v.maxx&&v.minx<=o.maxx&&(null==y.child1?(v=y.shape.body.outer,(null==n||0!=((f=y.shape.filter).collisionMask&n.collisionGroup)&&0!=(n.collisionMask&f.collisionGroup))&&(e?i?this.failed.has(v)||(f=Ir.containTest(this.aabbShape.zpp_inner,y.shape),!s.has(v)&&f?s.push(v):f||(s.remove(v),this.failed.push(v))):!s.has(v)&&Ir.testCollide_safe(y.shape,this.aabbShape.zpp_inner)&&s.push(v):i?this.failed.has(v)||(x=(x=y.shape.aabb).minx>=o.minx&&x.miny>=o.miny&&x.maxx<=o.maxx&&x.maxy<=o.maxy,!s.has(v)&&x?s.push(v):x||(s.remove(v),this.failed.push(v))):!s.has(v)&&((x=y.shape.aabb).minx>=o.minx&&x.miny>=o.miny&&x.maxx<=o.maxx&&x.maxy<=o.maxy)&&s.push(v))):(null!=y.child1&&this.treeStack.add(y.child1),null!=y.child2&&this.treeStack.add(y.child2)))}}return this.failed.clear(),s},Je.prototype.shapesInCircle=function(t,e,i,n,r,o){this.sync_broadphase(),this.updateCircShape(t,e,i);var s=this.circShape.zpp_inner.aabb,a=null==o?new _t:o;if(null!=this.stree.root)for(null==this.treeStack&&(this.treeStack=new Oi),this.treeStack.add(this.stree.root);null!=this.treeStack.head;){var h=this.treeStack.pop_unsafe(),l=h.aabb;s.miny<=l.maxy&&l.miny<=s.maxy&&s.minx<=l.maxx&&l.minx<=s.maxx&&(null==h.child1?(null==r||0!=((l=h.shape.filter).collisionMask&r.collisionGroup)&&0!=(r.collisionMask&l.collisionGroup))&&(n?Ir.containTest(this.circShape.zpp_inner,h.shape)&&a.push(h.shape.outer):Ir.testCollide_safe(h.shape,this.circShape.zpp_inner)&&a.push(h.shape.outer)):(null!=h.child1&&this.treeStack.add(h.child1),null!=h.child2&&this.treeStack.add(h.child2)))}if(null!=this.dtree.root)for(null==this.treeStack&&(this.treeStack=new Oi),this.treeStack.add(this.dtree.root);null!=this.treeStack.head;){var p=this.treeStack.pop_unsafe(),u=p.aabb;s.miny<=u.maxy&&u.miny<=s.maxy&&s.minx<=u.maxx&&u.minx<=s.maxx&&(null==p.child1?(null==r||0!=((u=p.shape.filter).collisionMask&r.collisionGroup)&&0!=(r.collisionMask&u.collisionGroup))&&(n?Ir.containTest(this.circShape.zpp_inner,p.shape)&&a.push(p.shape.outer):Ir.testCollide_safe(p.shape,this.circShape.zpp_inner)&&a.push(p.shape.outer)):(null!=p.child1&&this.treeStack.add(p.child1),null!=p.child2&&this.treeStack.add(p.child2)))}return a},Je.prototype.bodiesInCircle=function(t,e,i,n,r,o){this.sync_broadphase(),this.updateCircShape(t,e,i);var s=this.circShape.zpp_inner.aabb,a=null==o?new tt:o;if(null==this.failed&&(this.failed=new tt),null!=this.stree.root)for(null==this.treeStack&&(this.treeStack=new Oi),this.treeStack.add(this.stree.root);null!=this.treeStack.head;){var h,l=this.treeStack.pop_unsafe(),p=l.aabb;s.miny<=p.maxy&&p.miny<=s.maxy&&s.minx<=p.maxx&&p.minx<=s.maxx&&(null==l.child1?(p=l.shape.body.outer,(null==r||0!=((h=l.shape.filter).collisionMask&r.collisionGroup)&&0!=(r.collisionMask&h.collisionGroup))&&(n?this.failed.has(p)||(h=Ir.containTest(this.circShape.zpp_inner,l.shape),!a.has(p)&&h?a.push(p):h||(a.remove(p),this.failed.push(p))):!a.has(p)&&Ir.testCollide_safe(l.shape,this.circShape.zpp_inner)&&a.push(p))):(null!=l.child1&&this.treeStack.add(l.child1),null!=l.child2&&this.treeStack.add(l.child2)))}if(null!=this.dtree.root)for(null==this.treeStack&&(this.treeStack=new Oi),this.treeStack.add(this.dtree.root);null!=this.treeStack.head;){var u,d=this.treeStack.pop_unsafe(),c=d.aabb;s.miny<=c.maxy&&c.miny<=s.maxy&&s.minx<=c.maxx&&c.minx<=s.maxx&&(null==d.child1?(c=d.shape.body.outer,(null==r||0!=((u=d.shape.filter).collisionMask&r.collisionGroup)&&0!=(r.collisionMask&u.collisionGroup))&&(n?this.failed.has(c)||(u=Ir.containTest(this.circShape.zpp_inner,d.shape),!a.has(c)&&u?a.push(c):u||(a.remove(c),this.failed.push(c))):!a.has(c)&&Ir.testCollide_safe(d.shape,this.circShape.zpp_inner)&&a.push(c))):(null!=d.child1&&this.treeStack.add(d.child1),null!=d.child2&&this.treeStack.add(d.child2)))}return this.failed.clear(),a},Je.prototype.shapesInShape=function(t,e,i,n){this.sync_broadphase(),this.validateShape(t);var r=t.aabb,o=null==n?new _t:n;if(null!=this.stree.root)for(null==this.treeStack&&(this.treeStack=new Oi),this.treeStack.add(this.stree.root);null!=this.treeStack.head;){var s=this.treeStack.pop_unsafe(),a=s.aabb;r.miny<=a.maxy&&a.miny<=r.maxy&&r.minx<=a.maxx&&a.minx<=r.maxx&&(null==s.child1?(null==i||0!=((a=s.shape.filter).collisionMask&i.collisionGroup)&&0!=(i.collisionMask&a.collisionGroup))&&(e?Ir.containTest(t,s.shape)&&o.push(s.shape.outer):Ir.testCollide_safe(s.shape,t)&&o.push(s.shape.outer)):(null!=s.child1&&this.treeStack.add(s.child1),null!=s.child2&&this.treeStack.add(s.child2)))}if(null!=this.dtree.root)for(null==this.treeStack&&(this.treeStack=new Oi),this.treeStack.add(this.dtree.root);null!=this.treeStack.head;){var h=this.treeStack.pop_unsafe(),l=h.aabb;r.miny<=l.maxy&&l.miny<=r.maxy&&r.minx<=l.maxx&&l.minx<=r.maxx&&(null==h.child1?(null==i||0!=((l=h.shape.filter).collisionMask&i.collisionGroup)&&0!=(i.collisionMask&l.collisionGroup))&&(e?Ir.containTest(t,h.shape)&&o.push(h.shape.outer):Ir.testCollide_safe(h.shape,t)&&o.push(h.shape.outer)):(null!=h.child1&&this.treeStack.add(h.child1),null!=h.child2&&this.treeStack.add(h.child2)))}return o},Je.prototype.bodiesInShape=function(t,e,i,n){this.sync_broadphase(),this.validateShape(t);var r=t.aabb,o=null==n?new tt:n;if(null==this.failed&&(this.failed=new tt),null!=this.stree.root)for(null==this.treeStack&&(this.treeStack=new Oi),this.treeStack.add(this.stree.root);null!=this.treeStack.head;){var s,a=this.treeStack.pop_unsafe(),h=a.aabb;r.miny<=h.maxy&&h.miny<=r.maxy&&r.minx<=h.maxx&&h.minx<=r.maxx&&(null==a.child1?(h=a.shape.body.outer,(null==i||0!=((s=a.shape.filter).collisionMask&i.collisionGroup)&&0!=(i.collisionMask&s.collisionGroup))&&(e?this.failed.has(h)||(s=Ir.containTest(t,a.shape),!o.has(h)&&s?o.push(h):s||(o.remove(h),this.failed.push(h))):!o.has(h)&&Ir.testCollide_safe(a.shape,t)&&o.push(h))):(null!=a.child1&&this.treeStack.add(a.child1),null!=a.child2&&this.treeStack.add(a.child2)))}if(null!=this.dtree.root)for(null==this.treeStack&&(this.treeStack=new Oi),this.treeStack.add(this.dtree.root);null!=this.treeStack.head;){var l,p=this.treeStack.pop_unsafe(),u=p.aabb;r.miny<=u.maxy&&u.miny<=r.maxy&&r.minx<=u.maxx&&u.minx<=r.maxx&&(null==p.child1?(u=p.shape.body.outer,(null==i||0!=((l=p.shape.filter).collisionMask&i.collisionGroup)&&0!=(i.collisionMask&l.collisionGroup))&&(e?this.failed.has(u)||(l=Ir.containTest(t,p.shape),!o.has(u)&&l?o.push(u):l||(o.remove(u),this.failed.push(u))):!o.has(u)&&Ir.testCollide_safe(p.shape,t)&&o.push(u))):(null!=p.child1&&this.treeStack.add(p.child1),null!=p.child2&&this.treeStack.add(p.child2)))}return this.failed.clear(),o},Je.prototype.openlist=null,Je.prototype.rayCast=function(t,e,i){null==this.openlist&&(this.openlist=new Oi),this.sync_broadphase(),t.validate_dir();var n=t.maxdist;if(null!=this.dtree.root&&t.aabbtest(this.dtree.root.aabb)){var r=t.aabbsect(this.dtree.root.aabb);if(0<=r&&r<n){this.dtree.root.rayt=r;for(var o=null,s=this.openlist.head;null!=s&&!(this.dtree.root.rayt<s.elt.rayt);)s=(o=s).next;var a=this.openlist;null==cn.zpp_pool?h=new cn:(h=cn.zpp_pool,cn.zpp_pool=h.next,h.next=null),h.elt=this.dtree.root;var h=h;null==o?(h.next=a.head,a.head=h):(h.next=o.next,o.next=h),a.pushmod=a.modified=!0,a.length++}}if(null!=this.stree.root&&t.aabbtest(this.stree.root.aabb)){a=t.aabbsect(this.stree.root.aabb);if(0<=a&&a<n){this.stree.root.rayt=a;for(var l=null,p=this.openlist.head;null!=p&&!(this.stree.root.rayt<p.elt.rayt);)p=(l=p).next;a=this.openlist;null==cn.zpp_pool?u=new cn:(u=cn.zpp_pool,cn.zpp_pool=u.next,u.next=null),u.elt=this.stree.root;var u=u;null==l?(u.next=a.head,a.head=u):(u.next=l.next,l.next=u),a.pushmod=a.modified=!0,a.length++}}for(var d=null;null!=this.openlist.head;){var c=this.openlist.pop_unsafe();if(c.rayt>=n)break;if(null==c.child1){var y,_=c.shape;!(null==i||0!=((y=_.filter).collisionMask&i.collisionGroup)&&0!=(i.collisionMask&y.collisionGroup))||null!=(m=0==_.type?t.circlesect(_.circle,e,n):t.aabbtest(_.aabb)?t.polysect(_.polygon,e,n):null)&&(n=m.zpp_inner.toiDistance,null!=d&&d.zpp_inner.free(),d=m)}else{if(null!=c.child1&&t.aabbtest(c.child1.aabb)){var m=t.aabbsect(c.child1.aabb);if(0<=m&&m<n){c.child1.rayt=m;for(var g=null,f=this.openlist.head;null!=f&&!(c.child1.rayt<f.elt.rayt);)f=(g=f).next;var x,v=this.openlist;null==cn.zpp_pool?x=new cn:(x=cn.zpp_pool,cn.zpp_pool=x.next,x.next=null),x.elt=c.child1;var w=x;null==g?(w.next=v.head,v.head=w):(w.next=g.next,g.next=w),v.pushmod=v.modified=!0,v.length++}}if(null!=c.child2&&t.aabbtest(c.child2.aabb)){w=t.aabbsect(c.child2.aabb);if(0<=w&&w<n){c.child2.rayt=w;for(var z=null,b=this.openlist.head;null!=b&&!(c.child2.rayt<b.elt.rayt);)b=(z=b).next;var S,v=this.openlist;null==cn.zpp_pool?S=new cn:(S=cn.zpp_pool,cn.zpp_pool=S.next,S.next=null),S.elt=c.child2;w=S;null==z?(w.next=v.head,v.head=w):(w.next=z.next,z.next=w),v.pushmod=v.modified=!0,v.length++}}}}return this.openlist.clear(),d},Je.prototype.rayMultiCast=function(t,e,i,n){null==this.openlist&&(this.openlist=new Oi),this.sync_broadphase(),t.validate_dir();var r,o=t.maxdist>=1/0,s=null==n?new q:n;for(null!=this.dtree.root&&t.aabbtest(this.dtree.root.aabb)&&(o||0<=(r=t.aabbsect(this.dtree.root.aabb))&&r<t.maxdist)&&this.openlist.add(this.dtree.root),null!=this.stree.root&&t.aabbtest(this.stree.root.aabb)&&(o||0<=(r=t.aabbsect(this.stree.root.aabb))&&r<t.maxdist)&&this.openlist.add(this.stree.root);null!=this.openlist.head;){var a,h,l,p=this.openlist.pop_unsafe();null==p.child1?(a=p.shape,(null==i||0!=((h=a.filter).collisionMask&i.collisionGroup)&&0!=(i.collisionMask&h.collisionGroup))&&(0==a.type?t.circlesect2(a.circle,e,s):t.aabbtest(a.aabb)&&t.polysect2(a.polygon,e,s))):(null!=p.child1&&t.aabbtest(p.child1.aabb)&&(o||0<=(l=t.aabbsect(p.child1.aabb))&&l<t.maxdist)&&this.openlist.add(p.child1),null!=p.child2&&t.aabbtest(p.child2.aabb)&&(o||0<=(l=t.aabbsect(p.child2.aabb))&&l<t.maxdist)&&this.openlist.add(p.child2))}return this.openlist.clear(),s},Je.prototype.__class__=Je;var $e=zpp_nape.space.ZPP_Island=function(){this.waket=0,this.sleep=!1,this.comps=null,this.length=0,this.pushmod=!1,this.modified=!1,this._inuse=!1,this.next=null,this.comps=new Ei};$e.__name__=["zpp_nape","space","ZPP_Island"],$e.prototype.next=null,$e.prototype.elem=function(){return this},$e.prototype.begin=function(){return this.next},$e.prototype._inuse=null,$e.prototype.modified=null,$e.prototype.pushmod=null,$e.prototype.length=null,$e.prototype.setbegin=function(t){this.next=t,this.modified=!0,this.pushmod=!0},$e.prototype.add=function(t){return t._inuse=!0,t.next=this.next,this.next=t,this.modified=!0,this.length++,t},$e.prototype.inlined_add=function(t){return t._inuse=!0,t.next=this.next,this.next=t,this.modified=!0,this.length++,t},$e.prototype.addAll=function(t){for(var e=t.next;null!=e;)this.add(e),e=e.next},$e.prototype.insert=function(t,e){return e._inuse=!0,null==t?(e.next=this.next,this.next=e):(e.next=t.next,t.next=e),this.pushmod=this.modified=!0,this.length++,e},$e.prototype.inlined_insert=function(t,e){return e._inuse=!0,null==t?(e.next=this.next,this.next=e):(e.next=t.next,t.next=e),this.pushmod=this.modified=!0,this.length++,e},$e.prototype.pop=function(){var t=this.next;this.next=t.next,t._inuse=!1,null==this.next&&(this.pushmod=!0),this.modified=!0,this.length--},$e.prototype.inlined_pop=function(){var t=this.next;this.next=t.next,t._inuse=!1,null==this.next&&(this.pushmod=!0),this.modified=!0,this.length--},$e.prototype.pop_unsafe=function(){var t=this.next;return this.pop(),t},$e.prototype.inlined_pop_unsafe=function(){var t=this.next;return this.pop(),t},$e.prototype.remove=function(t){for(var e,i,n=null,r=this.next;null!=r;){if(r==t){null==n?(i=(e=this.next).next,this.next=i,null==this.next&&(this.pushmod=!0)):(i=(e=n.next).next,null==(n.next=i)&&(this.pushmod=!0)),e._inuse=!1,this.modified=!0,this.length--,this.pushmod=!0;break}r=(n=r).next}},$e.prototype.try_remove=function(t){for(var e=null,i=this.next,n=!1;null!=i;){if(i==t){this.erase(e),n=!0;break}i=(e=i).next}return n},$e.prototype.inlined_remove=function(t){for(var e,i,n=null,r=this.next;null!=r;){if(r==t){null==n?(i=(e=this.next).next,this.next=i,null==this.next&&(this.pushmod=!0)):(i=(e=n.next).next,null==(n.next=i)&&(this.pushmod=!0)),e._inuse=!1,this.modified=!0,this.length--,this.pushmod=!0;break}r=(n=r).next}},$e.prototype.inlined_try_remove=function(t){for(var e,i,n=null,r=this.next,o=!1;null!=r;){if(r==t){null==n?(i=(e=this.next).next,this.next=i,null==this.next&&(this.pushmod=!0)):(i=(e=n.next).next,null==(n.next=i)&&(this.pushmod=!0)),e._inuse=!1,this.modified=!0,this.length--,o=this.pushmod=!0;break}r=(n=r).next}return o},$e.prototype.erase=function(t){var e,i;return null==t?(i=(e=this.next).next,this.next=i,null==this.next&&(this.pushmod=!0)):(i=(e=t.next).next,null==(t.next=i)&&(this.pushmod=!0)),e._inuse=!1,this.modified=!0,this.length--,this.pushmod=!0,i},$e.prototype.inlined_erase=function(t){var e,i;return null==t?(i=(e=this.next).next,this.next=i,null==this.next&&(this.pushmod=!0)):(i=(e=t.next).next,null==(t.next=i)&&(this.pushmod=!0)),e._inuse=!1,this.modified=!0,this.length--,this.pushmod=!0,i},$e.prototype.splice=function(t,e){for(;0<e--&&null!=t.next;)this.erase(t);return t.next},$e.prototype.clear=function(){},$e.prototype.inlined_clear=function(){},$e.prototype.reverse=function(){for(var t=this.next,e=null;null!=t;){var i=t.next;t.next=e,e=this.next=t,t=i}this.modified=!0,this.pushmod=!0},$e.prototype.empty=function(){return null==this.next},$e.prototype.size=function(){return this.length},$e.prototype.has=function(t){for(var e=!1,i=this.next;null!=i;){if(i==t){e=!0;break}i=i.next}return e},$e.prototype.inlined_has=function(t){for(var e=!1,i=this.next;null!=i;){if(i==t){e=!0;break}i=i.next}return e},$e.prototype.front=function(){return this.next},$e.prototype.back=function(){for(var t=this.next,e=t;null!=e;)e=(t=e).next;return t},$e.prototype.iterator_at=function(t){for(var e=this.next;0<t--&&null!=e;)e=e.next;return e},$e.prototype.at=function(t){t=this.iterator_at(t);return null!=t?t:null},$e.prototype.comps=null,$e.prototype.sleep=null,$e.prototype.waket=null,$e.prototype.free=function(){},$e.prototype.alloc=function(){this.waket=0},$e.prototype.__class__=$e;var ti=zpp_nape.space.ZPP_Component=function(){this.woken=!1,this.waket=0,this.sleeping=!1,this.island=null,this.constraint=null,this.body=null,this.isBody=!1,this.rank=0,this.parent=null,this.next=null,this.sleeping=!1,this.island=null,(this.parent=this).rank=0,this.woken=!1};ti.__name__=["zpp_nape","space","ZPP_Component"],ti.prototype.next=null,ti.prototype.parent=null,ti.prototype.rank=null,ti.prototype.isBody=null,ti.prototype.body=null,ti.prototype.constraint=null,ti.prototype.island=null,ti.prototype.sleeping=null,ti.prototype.waket=null,ti.prototype.woken=null,ti.prototype.free=function(){this.body=null,this.constraint=null},ti.prototype.alloc=function(){},ti.prototype.reset=function(){this.sleeping=!1,this.island=null,(this.parent=this).rank=0},ti.prototype.__class__=ti;var tr=zpp_nape.space.ZPP_CallbackSet=function(){this.lazydel=!1,this.freed=!1,this.length=0,this.pushmod=!1,this.modified=!1,this._inuse=!1,this.next=null,this.int2=null,this.int1=null,this.di=0,this.id=0,this.arbiters=new yi};tr.__name__=["zpp_nape","space","ZPP_CallbackSet"],tr.get=function(t,e){var i;return null==tr.zpp_pool?i=new tr:(i=tr.zpp_pool,tr.zpp_pool=i.next,i.next=null),i.freed=!1,i.lazydel=!1,i.COLLISIONstate=1,i.COLLISIONstamp=0,i.SENSORstate=1,i.SENSORstamp=0,i.FLUIDstate=1,i.FLUIDstamp=0,t.id<e.id?(i.int1=t,i.int2=e):(i.int1=e,i.int2=t),i.id=i.int1.id,i.di=i.int2.id,i},tr.prototype.id=null,tr.prototype.di=null,tr.prototype.int1=null,tr.prototype.int2=null,tr.prototype.arbiters=null,tr.prototype.COLLISIONstate=null,tr.prototype.COLLISIONstamp=null,tr.prototype.SENSORstate=null,tr.prototype.SENSORstamp=null,tr.prototype.FLUIDstate=null,tr.prototype.FLUIDstamp=null,tr.prototype.next=null,tr.prototype.elem=function(){return this},tr.prototype.begin=function(){return this.next},tr.prototype._inuse=null,tr.prototype.modified=null,tr.prototype.pushmod=null,tr.prototype.length=null,tr.prototype.setbegin=function(t){this.next=t,this.modified=!0,this.pushmod=!0},tr.prototype.add=function(t){return t._inuse=!0,t.next=this.next,this.next=t,this.modified=!0,this.length++,t},tr.prototype.inlined_add=function(t){return t._inuse=!0,t.next=this.next,this.next=t,this.modified=!0,this.length++,t},tr.prototype.addAll=function(t){for(var e=t.next;null!=e;)this.add(e),e=e.next},tr.prototype.insert=function(t,e){return e._inuse=!0,null==t?(e.next=this.next,this.next=e):(e.next=t.next,t.next=e),this.pushmod=this.modified=!0,this.length++,e},tr.prototype.inlined_insert=function(t,e){return e._inuse=!0,null==t?(e.next=this.next,this.next=e):(e.next=t.next,t.next=e),this.pushmod=this.modified=!0,this.length++,e},tr.prototype.pop=function(){var t=this.next;this.next=t.next,t._inuse=!1,null==this.next&&(this.pushmod=!0),this.modified=!0,this.length--},tr.prototype.inlined_pop=function(){var t=this.next;this.next=t.next,t._inuse=!1,null==this.next&&(this.pushmod=!0),this.modified=!0,this.length--},tr.prototype.pop_unsafe=function(){var t=this.next;return this.pop(),t},tr.prototype.inlined_pop_unsafe=function(){var t=this.next;return this.pop(),t},tr.prototype.remove=function(t){for(var e,i,n=null,r=this.next;null!=r;){if(r==t){null==n?(i=(e=this.next).next,this.next=i,null==this.next&&(this.pushmod=!0)):(i=(e=n.next).next,null==(n.next=i)&&(this.pushmod=!0)),e._inuse=!1,this.modified=!0,this.length--,this.pushmod=!0;break}r=(n=r).next}},tr.prototype.try_remove=function(t){for(var e=null,i=this.next,n=!1;null!=i;){if(i==t){this.erase(e),n=!0;break}i=(e=i).next}return n},tr.prototype.inlined_remove=function(t){for(var e,i,n=null,r=this.next;null!=r;){if(r==t){null==n?(i=(e=this.next).next,this.next=i,null==this.next&&(this.pushmod=!0)):(i=(e=n.next).next,null==(n.next=i)&&(this.pushmod=!0)),e._inuse=!1,this.modified=!0,this.length--,this.pushmod=!0;break}r=(n=r).next}},tr.prototype.inlined_try_remove=function(t){for(var e,i,n=null,r=this.next,o=!1;null!=r;){if(r==t){null==n?(i=(e=this.next).next,this.next=i,null==this.next&&(this.pushmod=!0)):(i=(e=n.next).next,null==(n.next=i)&&(this.pushmod=!0)),e._inuse=!1,this.modified=!0,this.length--,o=this.pushmod=!0;break}r=(n=r).next}return o},tr.prototype.erase=function(t){var e,i;return null==t?(i=(e=this.next).next,this.next=i,null==this.next&&(this.pushmod=!0)):(i=(e=t.next).next,null==(t.next=i)&&(this.pushmod=!0)),e._inuse=!1,this.modified=!0,this.length--,this.pushmod=!0,i},tr.prototype.inlined_erase=function(t){var e,i;return null==t?(i=(e=this.next).next,this.next=i,null==this.next&&(this.pushmod=!0)):(i=(e=t.next).next,null==(t.next=i)&&(this.pushmod=!0)),e._inuse=!1,this.modified=!0,this.length--,this.pushmod=!0,i},tr.prototype.splice=function(t,e){for(;0<e--&&null!=t.next;)this.erase(t);return t.next},tr.prototype.clear=function(){},tr.prototype.inlined_clear=function(){},tr.prototype.reverse=function(){for(var t=this.next,e=null;null!=t;){var i=t.next;t.next=e,e=this.next=t,t=i}this.modified=!0,this.pushmod=!0},tr.prototype.empty=function(){return null==this.next},tr.prototype.size=function(){return this.length},tr.prototype.has=function(t){for(var e=!1,i=this.next;null!=i;){if(i==t){e=!0;break}i=i.next}return e},tr.prototype.inlined_has=function(t){for(var e=!1,i=this.next;null!=i;){if(i==t){e=!0;break}i=i.next}return e},tr.prototype.front=function(){return this.next},tr.prototype.back=function(){for(var t=this.next,e=t;null!=e;)e=(t=e).next;return t},tr.prototype.iterator_at=function(t){for(var e=this.next;0<t--&&null!=e;)e=e.next;return e},tr.prototype.at=function(t){t=this.iterator_at(t);return null!=t?t:null},tr.prototype.freed=null,tr.prototype.lazydel=null,tr.prototype.free=function(){this.int1=this.int2=null,this.id=this.di=-1,this.freed=!0},tr.prototype.alloc=function(){this.freed=!1,this.lazydel=!1,this.COLLISIONstate=1,this.COLLISIONstamp=0,this.SENSORstate=1,this.SENSORstamp=0,this.FLUIDstate=1,this.FLUIDstamp=0},tr.prototype.add_arb=function(t){for(var e=!1,i=this.arbiters.head;null!=i;){if(i.elt==t){e=!0;break}i=i.next}if(e)return!1;var n=this.arbiters;null==er.zpp_pool?r=new er:(r=er.zpp_pool,er.zpp_pool=r.next,r.next=null),r.elt=t;var r=r;return r.next=n.head,n.head=r,n.modified=!0,n.length++,!0},tr.prototype.try_remove_arb=function(t){for(var e,i,n=this.arbiters,r=null,o=n.head,s=!1;null!=o;){if(o.elt==t){null==r?(i=(e=n.head).next,n.head=i,null==n.head&&(n.pushmod=!0)):(i=(e=r.next).next,null==(r.next=i)&&(n.pushmod=!0));var a=e;a.elt=null,a.next=er.zpp_pool,er.zpp_pool=a,n.modified=!0,n.length--,s=n.pushmod=!0;break}o=(r=o).next}return s},tr.prototype.remove_arb=function(t){for(var e,i,n=this.arbiters,r=null,o=n.head;null!=o;){if(o.elt==t){null==r?(i=(e=n.head).next,n.head=i,null==n.head&&(n.pushmod=!0)):(i=(e=r.next).next,null==(r.next=i)&&(n.pushmod=!0));var s=e;s.elt=null,s.next=er.zpp_pool,er.zpp_pool=s,n.modified=!0,n.length--,n.pushmod=!0;break}o=(r=o).next}},tr.prototype.empty_arb=function(t){for(var e=!0,i=this.arbiters.head;null!=i;){if(0!=(i.elt.type&t)){e=!1;break}i=i.next}return e},tr.prototype.really_empty=function(){return null==this.arbiters.head},tr.prototype.sleeping=function(){for(var t=!0,e=this.arbiters.head;null!=e;){if(!e.elt.sleeping){t=!1;break}e=e.next}return t},tr.prototype.__class__=tr;var ei=zpp_nape.space.ZPP_CbSetManager=function(t){this.space=null,(this.cbsets=null)==ar.zpp_pool?this.cbsets=new ar:(this.cbsets=ar.zpp_pool,ar.zpp_pool=this.cbsets.next,this.cbsets.next=null),this.cbsets.lt=Hn.setlt,this.space=t};ei.__name__=["zpp_nape","space","ZPP_CbSetManager"],ei.prototype.cbsets=null,ei.prototype.space=null,ei.prototype.get=function(t){if(null==t.head)return null;var e;null==Hn.zpp_pool?e=new Hn:(e=Hn.zpp_pool,Hn.zpp_pool=e.next,e.next=null);var i=e.cbTypes;e.cbTypes=t;var n=this.cbsets.find_weak(e),r=null!=n?n.data:(r=Hn.get(t),this.cbsets.insert(r),r.manager=this,r);e.cbTypes=i;var o=e;for(o.listeners.clear(),o.zip_listeners=!0,o.bodylisteners.clear(),o.zip_bodylisteners=!0,o.conlisteners.clear(),o.zip_conlisteners=!0;null!=o.cbTypes.head;)o.cbTypes.pop_unsafe().cbsets.remove(o);return o.next=Hn.zpp_pool,Hn.zpp_pool=o,r},ei.prototype.remove=function(t){for(this.cbsets.remove(t);null!=t.cbpairs.head;){var e=t.cbpairs.pop_unsafe();e.a!=e.b&&(t==e.a?e.b:e.a).cbpairs.remove(e),e.a=e.b=null,e.listeners.clear(),e.next=qn.zpp_pool,qn.zpp_pool=e}t.manager=null},ei.prototype.clear=function(){},ei.prototype.validate=function(){if(!this.cbsets.empty()){for(var t=this.cbsets.parent;null!=t.prev;)t=t.prev;for(;null!=t;)if(t.data.validate(),null!=t.next)for(t=t.next;null!=t.prev;)t=t.prev;else{for(;null!=t.parent&&t==t.parent.next;)t=t.parent;t=t.parent}}},ei.prototype.pair=function(t,e){for(var i,n=null,r=(t.cbpairs.length<e.cbpairs.length?t:e).cbpairs.head;null!=r;){var o=r.elt;if(o.a==t&&o.b==e||o.a==e&&o.b==t){n=o;break}r=r.next}return null==n&&(null==qn.zpp_pool?i=new qn:(i=qn.zpp_pool,qn.zpp_pool=i.next,i.next=null),i.zip_listeners=!0,Hn.setlt(t,e)?(i.a=t,i.b=e):(i.a=e,i.b=t),n=i,t.cbpairs.add(n),e!=t&&e.cbpairs.add(n)),n.zip_listeners&&(n.zip_listeners=!1,n.__validate()),n},ei.prototype.valid_listener=function(t){return t.space==this.space},ei.prototype.__class__=ei;var ii=zpp_nape.space.ZPP_Space=function(t,e){this.prelisteners=null,this.precb=null,this.continuous=!1,this.toiEvents=null,this.pre_dt=0,this.convexShapeList=null,this.cbsets=null,this.callbackset_list=null,this.callbacks=null,this.wrap_listeners=null,this.listeners=null,this.islands=null,this.staticsleep=null,this.wrap_livecon=null,this.live_constraints=null,this.wrap_live=null,this.live=null,this.wrap_arbiters=null,this.s_arbiters=null,this.f_arbiters=null,this.c_arbiters_false=null,this.c_arbiters_true=null,this.sortcontacts=!1,this.time=0,this.midstep=!1,this.stamp=0,this.global_ang_drag=0,this.global_lin_drag=0,this.__static=null,this.bphase=null,this.kinematics=null,this.wrap_constraints=null,this.constraints=null,this.wrap_compounds=null,this.compounds=null,this.wrap_bodies=null,this.bodies=null,this.wrap_gravity=null,this.gravityy=0,this.gravityx=0,this.userData=null,this.outer=null,this.toiEvents=new Ri,this.global_lin_drag=.015,this.global_ang_drag=.015,this.precb=new v,this.precb.zpp_inner=new re,this.sortcontacts=!0,this.pre_dt=0,null==e||(null==Yn.Broadphase_DYNAMIC_AABB_TREE&&(Yn.internal=!0,Yn.Broadphase_DYNAMIC_AABB_TREE=new ft,Yn.internal=!1),e==Yn.Broadphase_DYNAMIC_AABB_TREE)?this.bphase=new Je(this):(null==Yn.Broadphase_SWEEP_AND_PRUNE&&(Yn.internal=!0,Yn.Broadphase_SWEEP_AND_PRUNE=new ft,Yn.internal=!1),e==Yn.Broadphase_SWEEP_AND_PRUNE&&(this.bphase=new ri(this))),this.time=0,null!=t?(this.gravityx=t.x,this.gravityy=t.y):(this.gravityx=0,this.gravityy=0),this.bodies=new di,this.wrap_bodies=bn.get(this.bodies),this.wrap_bodies.zpp_inner.adder=Z(this,this.bodies_adder),this.wrap_bodies.zpp_inner.subber=Z(this,this.bodies_subber),this.compounds=new ci,this.wrap_compounds=Cn.get(this.compounds),this.wrap_compounds.zpp_inner.adder=Z(this,this.compounds_adder),this.wrap_compounds.zpp_inner.subber=Z(this,this.compounds_subber),this.kinematics=new di,this.c_arbiters_true=new Li,this.c_arbiters_false=new Li,this.f_arbiters=new Ii,this.s_arbiters=new Gi,this.islands=new $e,this.live=new di,this.wrap_live=bn.get(this.live,!0),this.staticsleep=new di,this.constraints=new Ct,this.wrap_constraints=zn.get(this.constraints),this.wrap_constraints.zpp_inner.adder=Z(this,this.constraints_adder),this.wrap_constraints.zpp_inner.subber=Z(this,this.constraints_subber),this.live_constraints=new Ct,this.wrap_livecon=zn.get(this.live_constraints,!0),this.__static=Fe.__static(),(this.__static.zpp_inner.space=this).callbacks=new re,this.midstep=!1,this.listeners=new Di,this.wrap_listeners=Pn.get(this.listeners),this.wrap_listeners.zpp_inner.adder=Z(this,this.listeners_adder),this.wrap_listeners.zpp_inner.subber=Z(this,this.listeners_subber),this.callbackset_list=new tr,this.mrca1=new Pt,this.mrca2=new Pt,this.prelisteners=new vt,this.cbsets=new ei(this)};ii.__name__=["zpp_nape","space","ZPP_Space"],ii.prototype.outer=null,ii.prototype.userData=null,ii.prototype.gravityx=null,ii.prototype.gravityy=null,ii.prototype.wrap_gravity=null,ii.prototype.getgravity=function(){var t,e,i=this.gravityx,n=this.gravityy;null==Bn.poolVec2?t=new St:(t=Bn.poolVec2,Bn.poolVec2=t.zpp_pool,t.zpp_pool=null),null==t.zpp_inner?(null==Gr.zpp_pool?e=new Gr:(e=Gr.zpp_pool,Gr.zpp_pool=e.next,e.next=null),e.weak=!1,e._immutable=!1,e.x=i,e.y=n,t.zpp_inner=e,t.zpp_inner.outer=t):(null!=(e=t.zpp_inner)._validate&&e._validate(),t.zpp_inner.x==i&&(null!=(e=t.zpp_inner)._validate&&e._validate(),t.zpp_inner.y==n)||(t.zpp_inner.x=i,t.zpp_inner.y=n,null!=(n=t.zpp_inner)._invalidate&&n._invalidate(n))),t.zpp_inner.weak=!1,this.wrap_gravity=t,this.wrap_gravity.zpp_inner._inuse=!0,this.wrap_gravity.zpp_inner._invalidate=Z(this,this.gravity_invalidate),this.wrap_gravity.zpp_inner._validate=Z(this,this.gravity_validate)},ii.prototype.gravity_invalidate=function(t){this.gravityx=t.x,this.gravityy=t.y;for(var e=new ci,i=this.bodies.head;null!=i;){var n=i.elt;n.world||(n.component.waket=this.stamp+(this.midstep?0:1),3==n.type&&(n.kinematicDelaySleep=!0),n.component.sleeping&&this.really_wake(n,!1)),i=i.next}for(var r=this.compounds.head;null!=r;)e.add(r.elt),r=r.next;for(;null!=e.head;){for(var o=e.pop_unsafe(),s=o.bodies.head;null!=s;){var a=s.elt;a.world||(a.component.waket=this.stamp+(this.midstep?0:1),3==a.type&&(a.kinematicDelaySleep=!0),a.component.sleeping&&this.really_wake(a,!1)),s=s.next}for(var h=o.compounds.head;null!=h;)e.add(h.elt),h=h.next}},ii.prototype.gravity_validate=function(){this.wrap_gravity.zpp_inner.x=this.gravityx,this.wrap_gravity.zpp_inner.y=this.gravityy},ii.prototype.bodies=null,ii.prototype.wrap_bodies=null,ii.prototype.compounds=null,ii.prototype.wrap_compounds=null,ii.prototype.constraints=null,ii.prototype.wrap_constraints=null,ii.prototype.kinematics=null,ii.prototype.bphase=null,ii.prototype.__static=null,ii.prototype.global_lin_drag=null,ii.prototype.global_ang_drag=null,ii.prototype.stamp=null,ii.prototype.midstep=null,ii.prototype.time=null,ii.prototype.sortcontacts=null,ii.prototype.c_arbiters_true=null,ii.prototype.c_arbiters_false=null,ii.prototype.f_arbiters=null,ii.prototype.s_arbiters=null,ii.prototype.wrap_arbiters=null,ii.prototype.live=null,ii.prototype.wrap_live=null,ii.prototype.live_constraints=null,ii.prototype.wrap_livecon=null,ii.prototype.staticsleep=null,ii.prototype.islands=null,ii.prototype.listeners=null,ii.prototype.wrap_listeners=null,ii.prototype.callbacks=null,ii.prototype.callbackset_list=null,ii.prototype.cbsets=null,ii.prototype.clear=function(){for(;null!=this.listeners.head;)this.remListener(this.listeners.pop_unsafe());for(;null!=this.callbackset_list.next;){var t=this.callbackset_list.pop_unsafe();t.arbiters.clear(),t.int1=t.int2=null,t.id=t.di=-1,t.freed=!0,t.next=tr.zpp_pool,tr.zpp_pool=t}for(;null!=this.c_arbiters_true.head;){var e=this.c_arbiters_true.pop_unsafe();if(!e.cleared){for(var i,n,r=e.b1.arbiters,o=null,s=r.head;null!=s;){if(s.elt==e){null==o?(n=(i=r.head).next,r.head=n,null==r.head&&(r.pushmod=!0)):(n=(i=o.next).next,null==(o.next=n)&&(r.pushmod=!0));var a=i;a.elt=null,a.next=er.zpp_pool,er.zpp_pool=a,r.modified=!0,r.length--,r.pushmod=!0;break}s=(o=s).next}for(var h,l,p=e.b2.arbiters,u=null,d=p.head;null!=d;){if(d.elt==e){null==u?(l=(h=p.head).next,p.head=l,null==p.head&&(p.pushmod=!0)):(l=(h=u.next).next,null==(u.next=l)&&(p.pushmod=!0));var c=h;c.elt=null,c.next=er.zpp_pool,er.zpp_pool=c,p.modified=!0,p.length--,p.pushmod=!0;break}d=(u=d).next}null!=e.pair&&(e.pair.arb=null,e.pair=null)}for(e.b1=e.b2=null,e.active=!1,e.intchange=!1;null!=e.contacts.next;){var y=e.contacts,_=y.next;y.pop(),_.arbiter=null,_.next=Qn.zpp_pool,Qn.zpp_pool=_;y=e.innards,_=y.next;y.next=_.next,_._inuse=!1,null==y.next&&(y.pushmod=!0),y.modified=!0,y.length--}e.userdef_dyn_fric=!1,e.userdef_stat_fric=!1,e.userdef_restitution=!1,e.userdef_rfric=!1,e.__ref_edge1=e.__ref_edge2=null,e.next=Jn.zpp_pool,(Jn.zpp_pool=e).pre_dt=-1}for(;null!=this.c_arbiters_false.head;){var m=this.c_arbiters_false.pop_unsafe();if(!m.cleared){for(var g,f,x=m.b1.arbiters,v=null,w=x.head;null!=w;){if(w.elt==m){null==v?(f=(g=x.head).next,x.head=f,null==x.head&&(x.pushmod=!0)):(f=(g=v.next).next,null==(v.next=f)&&(x.pushmod=!0));var z=g;z.elt=null,z.next=er.zpp_pool,er.zpp_pool=z,x.modified=!0,x.length--,x.pushmod=!0;break}w=(v=w).next}for(var b,S,C=m.b2.arbiters,P=null,M=C.head;null!=M;){if(M.elt==m){null==P?(S=(b=C.head).next,C.head=S,null==C.head&&(C.pushmod=!0)):(S=(b=P.next).next,null==(P.next=S)&&(C.pushmod=!0));var T=b;T.elt=null,T.next=er.zpp_pool,er.zpp_pool=T,C.modified=!0,C.length--,C.pushmod=!0;break}M=(P=M).next}null!=m.pair&&(m.pair.arb=null,m.pair=null)}for(m.b1=m.b2=null,m.active=!1,m.intchange=!1;null!=m.contacts.next;){var A=m.contacts,k=A.next;A.pop(),k.arbiter=null,k.next=Qn.zpp_pool,Qn.zpp_pool=k;A=m.innards,k=A.next;A.next=k.next,k._inuse=!1,null==A.next&&(A.pushmod=!0),A.modified=!0,A.length--}m.userdef_dyn_fric=!1,m.userdef_stat_fric=!1,m.userdef_restitution=!1,m.userdef_rfric=!1,m.__ref_edge1=m.__ref_edge2=null,m.next=Jn.zpp_pool,(Jn.zpp_pool=m).pre_dt=-1}for(;null!=this.s_arbiters.head;){var O=this.s_arbiters.pop_unsafe();if(!O.cleared){for(var E,I,G=O.b1.arbiters,D=null,L=G.head;null!=L;){if(L.elt==O){null==D?(I=(E=G.head).next,G.head=I,null==G.head&&(G.pushmod=!0)):(I=(E=D.next).next,null==(D.next=I)&&(G.pushmod=!0));var B=E;B.elt=null,B.next=er.zpp_pool,er.zpp_pool=B,G.modified=!0,G.length--,G.pushmod=!0;break}L=(D=L).next}for(var R,F,N=O.b2.arbiters,j=null,U=N.head;null!=U;){if(U.elt==O){null==j?(F=(R=N.head).next,N.head=F,null==N.head&&(N.pushmod=!0)):(F=(R=j.next).next,null==(j.next=F)&&(N.pushmod=!0));var V=R;V.elt=null,V.next=er.zpp_pool,er.zpp_pool=V,N.modified=!0,N.length--,N.pushmod=!0;break}U=(j=U).next}null!=O.pair&&(O.pair.arb=null,O.pair=null)}O.b1=O.b2=null,O.active=!1,O.intchange=!1,O.next=Kn.zpp_pool,Kn.zpp_pool=O}for(;null!=this.f_arbiters.head;){var W=this.f_arbiters.pop_unsafe();if(!W.cleared){for(var X,H,q=W.b1.arbiters,Y=null,K=q.head;null!=K;){if(K.elt==W){null==Y?(H=(X=q.head).next,q.head=H,null==q.head&&(q.pushmod=!0)):(H=(X=Y.next).next,null==(Y.next=H)&&(q.pushmod=!0));var Z=X;Z.elt=null,Z.next=er.zpp_pool,er.zpp_pool=Z,q.modified=!0,q.length--,q.pushmod=!0;break}K=(Y=K).next}for(var J,Q,$=W.b2.arbiters,tt=null,et=$.head;null!=et;){if(et.elt==W){null==tt?(Q=(J=$.head).next,$.head=Q,null==$.head&&($.pushmod=!0)):(Q=(J=tt.next).next,null==(tt.next=Q)&&($.pushmod=!0));var it=J;it.elt=null,it.next=er.zpp_pool,er.zpp_pool=it,$.modified=!0,$.length--,$.pushmod=!0;break}et=(tt=et).next}null!=W.pair&&(W.pair.arb=null,W.pair=null)}W.b1=W.b2=null,W.active=!1,W.intchange=!1,W.next=Zn.zpp_pool,(Zn.zpp_pool=W).pre_dt=-1}for(this.bphase.clear();null!=this.bodies.head;){var nt=this.bodies.pop_unsafe();if(null!=nt.component){var rt=nt.component.island;if(null!=rt){for(;null!=rt.comps.head;){var ot=rt.comps.pop_unsafe();ot.sleeping=!1,ot.island=null,(ot.parent=ot).rank=0}rt.next=$e.zpp_pool,$e.zpp_pool=rt}}nt.removedFromSpace(),nt.space=null}for(;null!=this.constraints.head;){var st=this.constraints.pop_unsafe();if(null!=st.component){var at=st.component.island;if(null!=at){for(;null!=at.comps.head;){var ht=at.comps.pop_unsafe();ht.sleeping=!1,ht.island=null,(ht.parent=ht).rank=0}at.next=$e.zpp_pool,$e.zpp_pool=at}}st.removedFromSpace(),st.space=null}this.kinematics.clear();for(var lt=new ci;null!=this.compounds.head;)lt.add(this.compounds.pop_unsafe());for(;null!=lt.head;){var pt=lt.pop_unsafe();pt.removedFromSpace(),pt.space=null;for(var ut=pt.bodies.head;null!=ut;){var dt=ut.elt;if(null!=dt.component){var ct=dt.component.island;if(null!=ct){for(;null!=ct.comps.head;){var yt=ct.comps.pop_unsafe();yt.sleeping=!1,yt.island=null,(yt.parent=yt).rank=0}ct.next=$e.zpp_pool,$e.zpp_pool=ct}}dt.removedFromSpace(),dt.space=null,ut=ut.next}for(var _t=pt.constraints.head;null!=_t;){var mt=_t.elt;if(null!=mt.component){var gt=mt.component.island;if(null!=gt){for(;null!=gt.comps.head;){var ft=gt.comps.pop_unsafe();ft.sleeping=!1,ft.island=null,(ft.parent=ft).rank=0}gt.next=$e.zpp_pool,$e.zpp_pool=gt}}mt.removedFromSpace(),mt.space=null,_t=_t.next}for(var xt=pt.compounds.head;null!=xt;)lt.add(xt.elt),xt=xt.next}this.staticsleep.clear(),this.live.clear(),this.live_constraints.clear(),this.stamp=0,this.time=0,this.mrca1.clear(),this.mrca2.clear(),this.prelisteners.clear(),this.cbsets.clear()},ii.prototype.bodies_adder=function(t){return t.zpp_inner.space!=this&&(null!=t.zpp_inner.space&&t.zpp_inner.space.outer.zpp_inner.wrap_bodies.remove(t),this.addBody(t.zpp_inner),!0)},ii.prototype.bodies_subber=function(t){this.remBody(t.zpp_inner)},ii.prototype.compounds_adder=function(t){return t.zpp_inner.space!=this&&(null!=t.zpp_inner.space&&t.zpp_inner.space.wrap_compounds.remove(t),this.addCompound(t.zpp_inner),!0)},ii.prototype.compounds_subber=function(t){this.remCompound(t.zpp_inner)},ii.prototype.constraints_adder=function(t){return t.zpp_inner.space!=this&&(null!=t.zpp_inner.space&&t.zpp_inner.space.outer.zpp_inner.wrap_constraints.remove(t),this.addConstraint(t.zpp_inner),!0)},ii.prototype.constraints_subber=function(t){this.remConstraint(t.zpp_inner)},ii.prototype.listeners_adder=function(t){return t.zpp_inner.space!=this&&(null!=t.zpp_inner.space&&t.zpp_inner.space.outer.zpp_inner.wrap_listeners.remove(t),this.addListener(t.zpp_inner),!0)},ii.prototype.listeners_subber=function(t){this.remListener(t.zpp_inner)},ii.prototype.revoke_listener=function(t){},ii.prototype.unrevoke_listener=function(t){},ii.prototype.addListener=function(t){t.space=this,t.addedToSpace()},ii.prototype.remListener=function(t){t.removedFromSpace(),t.space=null},ii.prototype.add_callbackset=function(t){var e=t.int1.cbsets;null==Vi.zpp_pool?i=new Vi:(i=Vi.zpp_pool,Vi.zpp_pool=i.next,i.next=null),i.elt=t;var i=i;i.next=e.head,e.head=i,e.modified=!0,e.length++;e=t.int2.cbsets;null==Vi.zpp_pool?n=new Vi:(n=Vi.zpp_pool,Vi.zpp_pool=n.next,n.next=null),n.elt=t;var n=n;n.next=e.head,e.head=n,e.modified=!0,e.length++;e=this.callbackset_list;t._inuse=!0,t.next=e.next,e.next=t,e.modified=!0,e.length++},ii.prototype.remove_callbackset=function(t){t.lazydel=!0;for(var e,i,n=t.int1.cbsets,r=null,o=n.head;null!=o;){if(o.elt==t){null==r?(i=(e=n.head).next,n.head=i,null==n.head&&(n.pushmod=!0)):(i=(e=r.next).next,null==(r.next=i)&&(n.pushmod=!0));var s=e;s.elt=null,s.next=Vi.zpp_pool,Vi.zpp_pool=s,n.modified=!0,n.length--,n.pushmod=!0;break}o=(r=o).next}for(var a,h,l=t.int2.cbsets,p=null,u=l.head;null!=u;){if(u.elt==t){null==p?(h=(a=l.head).next,l.head=h,null==l.head&&(l.pushmod=!0)):(h=(a=p.next).next,null==(p.next=h)&&(l.pushmod=!0));var d=a;d.elt=null,d.next=Vi.zpp_pool,Vi.zpp_pool=d,l.modified=!0,l.length--,l.pushmod=!0;break}u=(p=u).next}},ii.prototype.transmitType=function(t,e){t.world||(t.component.waket=this.stamp+(this.midstep?0:1),3==t.type&&(t.kinematicDelaySleep=!0),t.component.sleeping&&this.really_wake(t,!1)),2==t.type?this.live.remove(t):3==t.type?(this.kinematics.remove(t),this.staticsleep.remove(t)):1==t.type&&this.staticsleep.remove(t),t.type=e,3==t.type&&this.kinematics.add(t),1==t.type&&this.static_validation(t),t.component.sleeping=!0,t.world||(t.component.waket=this.stamp+(this.midstep?0:1),3==t.type&&(t.kinematicDelaySleep=!0),t.component.sleeping&&this.really_wake(t,!0))},ii.prototype.added_shape=function(t,e){(e=null==e?!1:e)||((e=t.body).world||(e.component.waket=this.stamp+(this.midstep?0:1),3==e.type&&(e.kinematicDelaySleep=!0),e.component.sleeping&&this.really_wake(e,!1))),this.bphase.insert(t),t.addedToSpace()},ii.prototype.removed_shape=function(t,e){var i=t.body;(e=null==e?!1:e)||i.wake();for(var n=null,r=i.arbiters.head;null!=r;){var o,s=r.elt;if(s.ws1!=t&&s.ws2!=t)r=(n=r).next;else{if(0!=s.present){this.MRCA_chains(s.ws1,s.ws2);for(var a=this.mrca1.head;null!=a;){for(var h=a.elt,l=this.mrca2.head;null!=l;){var p=l.elt,u=h.cbSet,d=p.cbSet;u.validate(),d.validate();for(var c,y=null,_=(u.cbpairs.length<d.cbpairs.length?u:d).cbpairs.head;null!=_;){var m=_.elt;if(m.a==u&&m.b==d||m.a==d&&m.b==u){y=m;break}_=_.next}if(null==y&&(null==qn.zpp_pool?c=new qn:(c=qn.zpp_pool,qn.zpp_pool=c.next,c.next=null),c.zip_listeners=!0,Hn.setlt(u,d)?(c.a=u,c.b=d):(c.a=d,c.b=u),y=c,u.cbpairs.add(y),d!=u&&d.cbpairs.add(y)),y.zip_listeners&&(y.zip_listeners=!1,y.__validate()),null!=y.listeners.head){var g=$n.get(h,p);g.remove_arb(s),s.present--;for(var f,x=null,v=(u.cbpairs.length<d.cbpairs.length?u:d).cbpairs.head;null!=v;){var w=v.elt;if(w.a==u&&w.b==d||w.a==d&&w.b==u){x=w;break}v=v.next}null==x&&(null==qn.zpp_pool?f=new qn:(f=qn.zpp_pool,qn.zpp_pool=f.next,f.next=null),f.zip_listeners=!0,Hn.setlt(u,d)?(f.a=u,f.b=d):(f.a=d,f.b=u),x=f,u.cbpairs.add(x),d!=u&&d.cbpairs.add(x)),x.zip_listeners&&(x.zip_listeners=!1,x.__validate());for(var z=x.listeners.head;null!=z;){var b,S,C,P,M,T=z.elt;1==T.event&&0!=(T.itype&s.type)&&g.empty_arb(T.itype)&&((b=this.push_callback(T)).event=1,S=g.int1,C=g.int2,M=T.options1,P=S.cbTypes,!(!M.nonemptyintersection(P,M.includes)||M.nonemptyintersection(P,M.excludes))&&(M=T.options2,T=C.cbTypes,!!M.nonemptyintersection(T,M.includes)&&!M.nonemptyintersection(T,M.excludes))?(b.int1=S,b.int2=C):(b.int1=C,b.int2=S),b.set=g),z=z.next}null==g.arbiters.head&&this.remove_callbackset(g),l=l.next}else l=l.next}a=a.next}}if(s.b1!=i&&2==s.b1.type&&((o=s.b1).world||(o.component.waket=this.stamp+(this.midstep?0:1),3==o.type&&(o.kinematicDelaySleep=!0),o.component.sleeping&&this.really_wake(o,!1))),s.b2!=i&&2==s.b2.type&&((o=s.b2).world||(o.component.waket=this.stamp+(this.midstep?0:1),3==o.type&&(o.kinematicDelaySleep=!0),o.component.sleeping&&this.really_wake(o,!1))),s.cleared=!0,null==i||s.b2==i)for(var A,k,O=s.b1.arbiters,E=null,I=O.head;null!=I;){if(I.elt==s){null==E?(k=(A=O.head).next,O.head=k,null==O.head&&(O.pushmod=!0)):(k=(A=E.next).next,null==(E.next=k)&&(O.pushmod=!0));var G=A;G.elt=null,G.next=er.zpp_pool,er.zpp_pool=G,O.modified=!0,O.length--,O.pushmod=!0;break}I=(E=I).next}if(null==i||s.b1==i)for(var D,L,B=s.b2.arbiters,R=null,F=B.head;null!=F;){if(F.elt==s){null==R?(L=(D=B.head).next,B.head=L,null==B.head&&(B.pushmod=!0)):(L=(D=R.next).next,null==(R.next=L)&&(B.pushmod=!0));var N=D;N.elt=null,N.next=er.zpp_pool,er.zpp_pool=N,B.modified=!0,B.length--,B.pushmod=!0;break}F=(R=F).next}null!=s.pair&&(s.pair.arb=null,s.pair=null),s.active=!1,this.f_arbiters.modified=!0,r=i.arbiters.erase(n)}}this.bphase.remove(t),t.removedFromSpace()},ii.prototype.addConstraint=function(t){t.space=this,t.addedToSpace(),t.active&&(t.component.sleeping=!0,this.wake_constraint(t,!0))},ii.prototype.remConstraint=function(t){t.active&&(this.wake_constraint(t,!0),this.live_constraints.remove(t)),t.removedFromSpace(),t.space=null},ii.prototype.addCompound=function(t){t.space=this,t.addedToSpace();for(var e=t.bodies.head;null!=e;)this.addBody(e.elt),e=e.next;for(var i=t.constraints.head;null!=i;)this.addConstraint(i.elt),i=i.next;for(var n=t.compounds.head;null!=n;)this.addCompound(n.elt),n=n.next},ii.prototype.remCompound=function(t){for(var e=t.bodies.head;null!=e;)this.remBody(e.elt),e=e.next;for(var i=t.constraints.head;null!=i;)this.remConstraint(i.elt),i=i.next;for(var n=t.compounds.head;null!=n;)this.remCompound(n.elt),n=n.next;t.removedFromSpace(),t.space=null},ii.prototype.addBody=function(t,e){null==e&&(e=-1),t.space=this,t.addedToSpace(),t.component.sleeping=!0,t.world||(t.component.waket=this.stamp+(this.midstep?0:1),3==t.type&&(t.kinematicDelaySleep=!0),t.component.sleeping&&this.really_wake(t,!0));for(var i=t.shapes.head;null!=i;){var n=i.elt;this.bphase.insert(n),n.addedToSpace(),i=i.next}1==t.type?this.static_validation(t):2!=t.type&&3!=e&&this.kinematics.add(t)},ii.prototype.remBody=function(t,e){null==e&&(e=-1),1==t.type?(t.world||(t.component.waket=this.stamp+(this.midstep?0:1),3==t.type&&(t.kinematicDelaySleep=!0),t.component.sleeping&&this.really_wake(t,!0)),this.staticsleep.remove(t)):2==t.type?(t.world||(t.component.waket=this.stamp+(this.midstep?0:1),3==t.type&&(t.kinematicDelaySleep=!0),t.component.sleeping&&this.really_wake(t,!0)),this.live.remove(t)):(3!=e&&this.kinematics.remove(t),t.world||(t.component.waket=this.stamp+(this.midstep?0:1),3==t.type&&(t.kinematicDelaySleep=!0),t.component.sleeping&&this.really_wake(t,!0)),this.staticsleep.remove(t));for(var i=t.shapes.head;null!=i;)this.removed_shape(i.elt,!0),i=i.next;t.removedFromSpace(),t.space=null},ii.prototype.shapesUnderPoint=function(t,e,i,n){return this.bphase.shapesUnderPoint(t,e,i,n)},ii.prototype.bodiesUnderPoint=function(t,e,i,n){return this.bphase.bodiesUnderPoint(t,e,i,n)},ii.prototype.shapesInAABB=function(t,e,i,n,r){return this.bphase.shapesInAABB(t.zpp_inner,e,i,n,r)},ii.prototype.bodiesInAABB=function(t,e,i,n,r){return this.bphase.bodiesInAABB(t.zpp_inner,e,i,n,r)},ii.prototype.shapesInCircle=function(t,e,i,n,r){var o=t.zpp_inner;null!=o._validate&&o._validate();var s=t.zpp_inner.x,o=t.zpp_inner;return null!=o._validate&&o._validate(),this.bphase.shapesInCircle(s,t.zpp_inner.y,e,i,n,r)},ii.prototype.bodiesInCircle=function(t,e,i,n,r){var o=t.zpp_inner;null!=o._validate&&o._validate();var s=t.zpp_inner.x,o=t.zpp_inner;return null!=o._validate&&o._validate(),this.bphase.bodiesInCircle(s,t.zpp_inner.y,e,i,n,r)},ii.prototype.shapesInShape=function(t,e,i,n){return this.bphase.shapesInShape(t,e,i,n)},ii.prototype.bodiesInShape=function(t,e,i,n){return this.bphase.bodiesInShape(t,e,i,n)},ii.prototype.rayCast=function(t,e,i){return this.bphase.rayCast(t.zpp_inner,e,null==i?null:i.zpp_inner)},ii.prototype.rayMultiCast=function(t,e,i,n){return this.bphase.rayMultiCast(t.zpp_inner,e,null==i?null:i.zpp_inner,n)},ii.prototype.convexShapeList=null,ii.prototype.convexCast=function(t,e,i,n){var r;if(null==Ee.zpp_pool?r=new Ee:(r=Ee.zpp_pool,Ee.zpp_pool=r.next,r.next=null),r.failed=!1,r.s1=r.s2=null,r.arbiter=null,0==t.type){var o=t.circle;if(o.zip_worldCOM&&null!=o.body){if(o.zip_worldCOM=!1,o.zip_localCOM){if(o.zip_localCOM=!1,1==o.type){var s=o.polygon;if(null==s.lverts.next.next)s.localCOMx=s.lverts.next.x,s.localCOMy=s.lverts.next.y;else if(null==s.lverts.next.next.next)s.localCOMx=s.lverts.next.x,s.localCOMy=s.lverts.next.y,s.localCOMx+=s.lverts.next.next.x,s.localCOMy+=s.lverts.next.next.y,s.localCOMx*=.5,s.localCOMy*=.5;else{s.localCOMx=0;var a=s.localCOMy=0,h=s.lverts.next,l=h,p=h=h.next;for(h=h.next;null!=h;){var u=h;a+=p.x*(u.y-l.y);var d=u.y*p.x-u.x*p.y;s.localCOMx+=(p.x+u.x)*d,s.localCOMy+=(p.y+u.y)*d,l=p,p=u,h=h.next}var c=h=s.lverts.next;a+=p.x*(c.y-l.y);var y=c.y*p.x-c.x*p.y;s.localCOMx+=(p.x+c.x)*y,s.localCOMy+=(p.y+c.y)*y;var l=p,_=h=h.next;a+=c.x*(_.y-l.y);y=_.y*c.x-_.x*c.y;s.localCOMx+=(c.x+_.x)*y,s.localCOMy+=(c.y+_.y)*y;y=a=1/(3*a);s.localCOMx*=y,s.localCOMy*=y}}null!=o.wrap_localCOM&&(o.wrap_localCOM.zpp_inner.x=o.localCOMx,o.wrap_localCOM.zpp_inner.y=o.localCOMy)}y=o.body;y.zip_axis&&(y.zip_axis=!1,y.axisx=Math.sin(y.rot),y.axisy=Math.cos(y.rot)),o.worldCOMx=o.body.posx+(o.body.axisy*o.localCOMx-o.body.axisx*o.localCOMy),o.worldCOMy=o.body.posy+(o.localCOMx*o.body.axisx+o.localCOMy*o.body.axisy)}}else{var m=t.polygon;if(m.zip_gaxi&&null!=m.body){m.zip_gaxi=!1,m.validate_laxi();var g=m.body;if(g.zip_axis&&(g.zip_axis=!1,g.axisx=Math.sin(g.rot),g.axisy=Math.cos(g.rot)),m.zip_gverts&&null!=m.body){m.zip_gverts=!1,m.validate_lverts();var f=m.body;f.zip_axis&&(f.zip_axis=!1,f.axisx=Math.sin(f.rot),f.axisy=Math.cos(f.rot));for(var x=m.lverts.next,v=m.gverts.next;null!=v;){var w=v,z=x,x=x.next;w.x=m.body.posx+(m.body.axisy*z.x-m.body.axisx*z.y),w.y=m.body.posy+(z.x*m.body.axisx+z.y*m.body.axisy),v=v.next}}for(var b=m.edges.head,S=C=m.gverts.next,C=C.next;null!=C;){var P=C,M=b.elt,b=b.next;M.gp0=S,M.gp1=P,M.gnormx=m.body.axisy*M.lnormx-m.body.axisx*M.lnormy,M.gnormy=M.lnormx*m.body.axisx+M.lnormy*m.body.axisy,M.gprojection=m.body.posx*M.gnormx+m.body.posy*M.gnormy+M.lprojection,null!=M.wrap_gnorm&&(M.wrap_gnorm.zpp_inner.x=M.gnormx,M.wrap_gnorm.zpp_inner.y=M.gnormy),M.tp0=M.gp0.y*M.gnormx-M.gp0.x*M.gnormy,M.tp1=M.gp1.y*M.gnormx-M.gp1.x*M.gnormy,S=P,C=C.next}var T=b.elt;T.gp0=S,T.gp1=m.gverts.next,T.gnormx=m.body.axisy*T.lnormx-m.body.axisx*T.lnormy,T.gnormy=T.lnormx*m.body.axisx+T.lnormy*m.body.axisy,T.gprojection=m.body.posx*T.gnormx+m.body.posy*T.gnormy+T.lprojection,null!=T.wrap_gnorm&&(T.wrap_gnorm.zpp_inner.x=T.gnormx,T.wrap_gnorm.zpp_inner.y=T.gnormy),T.tp0=T.gp0.y*T.gnormx-T.gp0.x*T.gnormy,T.tp1=T.gp1.y*T.gnormx-T.gp1.x*T.gnormy}}var A=t.body,g=A.posx,f=A.posy;A.sweepTime=0,A.sweep_angvel=A.angvel;var T=e-A.sweepTime;0!=T&&(A.sweepTime=e,A.posx+=A.velx*T,A.posy+=A.vely*T,0!=A.angvel&&(k=A.sweep_angvel*T,A.rot+=k,1e-4<k*k?(A.axisx=Math.sin(A.rot),A.axisy=Math.cos(A.rot)):(E=((T=1-.5*(E=k*k))*A.axisx+k*A.axisy)*(O=1-E*E/8),A.axisy=(T*A.axisy-k*A.axisx)*O,A.axisx=E)));var k=A.posx,O=A.posy;t.validate_sweepRadius();var E=t.sweepRadius;null==De.zpp_pool?it=new De:(it=De.zpp_pool,De.zpp_pool=it.next,it.next=null),it.minx=(g<k?g:k)-E,it.maxx=(k<g?g:k)+E,it.miny=(f<O?f:O)-E,it.maxy=(O<f?f:O)+E;O=this.convexShapeList=this.bphase.shapesInAABB(it,!1,!1,null==i?null:i.zpp_inner,this.convexShapeList),E=it;null!=E.outer&&(E.outer.zpp_inner=null,E.outer=null),E.wrap_min=E.wrap_max=null,E._invalidate=null,E._validate=null,E.next=De.zpp_pool,De.zpp_pool=E;var I=0,G=0,I=0,G=0,D=0,L=0,D=0,L=0,B=null,R=e+1;O.zpp_inner.valmod();for(var F=ne.get(O);;){F.zpp_inner.zpp_inner.valmod();var N=F.zpp_inner;N.zpp_inner.valmod(),N.zpp_inner.zip_length&&(N.zpp_inner.zip_length=!1,N.zpp_inner.user_length=N.zpp_inner.inner.length);var j=N.zpp_inner.user_length;if(F.zpp_critical=!0,!(F.zpp_i<j||(F.zpp_next=ne.zpp_pool,(ne.zpp_pool=F).zpp_inner=null,!1)))break;F.zpp_critical=!1;var U=F.zpp_inner.at(F.zpp_i++);if(U!=t.outer&&(null!=U.zpp_inner.body?U.zpp_inner.body.outer:null)!=A.outer){if(r.s1=t,r.s2=U.zpp_inner,n){U.zpp_inner.validate_sweepRadius(),(null!=U.zpp_inner.body?U.zpp_inner.body.outer:null).zpp_inner.sweep_angvel=(null!=U.zpp_inner.body?U.zpp_inner.body.outer:null).zpp_inner.angvel,(null!=U.zpp_inner.body?U.zpp_inner.body.outer:null).zpp_inner.sweepTime=0,Ie.dynamicSweep(r,e,0,0,!0);var V=(null!=U.zpp_inner.body?U.zpp_inner.body.outer:null).zpp_inner,W=0-V.sweepTime;0!=W&&(V.sweepTime=0,V.posx+=V.velx*W,V.posy+=V.vely*W,0!=V.angvel&&(N=V.sweep_angvel*W,V.rot+=N,1e-4<N*N?(V.axisx=Math.sin(V.rot),V.axisy=Math.cos(V.rot)):(H=((j=1-.5*(H=N*N))*V.axisx+N*V.axisy)*(W=1-H*H/8),V.axisy=(j*V.axisy-N*V.axisx)*W,V.axisx=H)));var X=(null!=U.zpp_inner.body?U.zpp_inner.body.outer:null).zpp_inner,V=U.zpp_inner;if(0==V.type)V.worldCOMx=X.posx+(X.axisy*V.localCOMx-X.axisx*V.localCOMy),V.worldCOMy=X.posy+(V.localCOMx*X.axisx+V.localCOMy*X.axisy);else{for(var H=V.polygon,q=H.lverts.next,Y=H.gverts.next;null!=Y;){var K=Y,Z=q,q=q.next;K.x=X.posx+(X.axisy*Z.x-X.axisx*Z.y),K.y=X.posy+(Z.x*X.axisx+Z.y*X.axisy),Y=Y.next}for(var J=H.edges.head,Q=$=H.gverts.next,$=$.next;null!=$;){var tt=$,et=J.elt,J=J.next;et.gnormx=X.axisy*et.lnormx-X.axisx*et.lnormy,et.gnormy=et.lnormx*X.axisx+et.lnormy*X.axisy,et.gprojection=X.posx*et.gnormx+X.posy*et.gnormy+et.lprojection,et.tp0=Q.y*et.gnormx-Q.x*et.gnormy,et.tp1=tt.y*et.gnormx-tt.x*et.gnormy,Q=tt,$=$.next}V=H.gverts.next,H=J.elt;H.gnormx=X.axisy*H.lnormx-X.axisx*H.lnormy,H.gnormy=H.lnormx*X.axisx+H.lnormy*X.axisy,H.gprojection=X.posx*H.gnormx+X.posy*H.gnormy+H.lprojection,H.tp0=Q.y*H.gnormx-Q.x*H.gnormy,H.tp1=V.y*H.gnormx-V.x*H.gnormy}}else Ie.staticSweep(r,e,0,0);r.toi*=e,0<r.toi&&r.toi<R&&(R=r.toi,I=r.axis.x,G=r.axis.y,D=r.c2.x,L=r.c2.y,B=U)}}O.clear();i=r;i.next=Ee.zpp_pool,Ee.zpp_pool=i;var it=0-A.sweepTime;if(0!=it&&(A.sweepTime=0,A.posx+=A.velx*it,A.posy+=A.vely*it,0!=A.angvel&&(E=A.sweep_angvel*it,A.rot+=E,1e-4<E*E?(A.axisx=Math.sin(A.rot),A.axisy=Math.cos(A.rot)):(O=((i=1-.5*(O=E*E))*A.axisx+E*A.axisy)*(it=1-O*O/8),A.axisy=(i*A.axisy-E*A.axisx)*it,A.axisx=O))),0==t.type)t.worldCOMx=A.posx+(A.axisy*t.localCOMx-A.axisx*t.localCOMy),t.worldCOMy=A.posy+(t.localCOMx*A.axisx+t.localCOMy*A.axisy);else{for(var nt=t.polygon,rt=nt.lverts.next,ot=nt.gverts.next;null!=ot;){var st=ot,at=rt,rt=rt.next;st.x=A.posx+(A.axisy*at.x-A.axisx*at.y),st.y=A.posy+(at.x*A.axisx+at.y*A.axisy),ot=ot.next}for(var ht=nt.edges.head,lt=pt=nt.gverts.next,pt=pt.next;null!=pt;){var ut=pt,dt=ht.elt,ht=ht.next;dt.gnormx=A.axisy*dt.lnormx-A.axisx*dt.lnormy,dt.gnormy=dt.lnormx*A.axisx+dt.lnormy*A.axisy,dt.gprojection=A.posx*dt.gnormx+A.posy*dt.gnormy+dt.lprojection,dt.tp0=lt.y*dt.gnormx-lt.x*dt.gnormy,dt.tp1=ut.y*dt.gnormx-ut.x*dt.gnormy,lt=ut,pt=pt.next}var ct=nt.gverts.next,nt=ht.elt;nt.gnormx=A.axisy*nt.lnormx-A.axisx*nt.lnormy,nt.gnormy=nt.lnormx*A.axisx+nt.lnormy*A.axisy,nt.gprojection=A.posx*nt.gnormx+A.posy*nt.gnormy+nt.lprojection,nt.tp0=lt.y*nt.gnormx-lt.x*nt.gnormy,nt.tp1=ct.y*nt.gnormx-ct.x*nt.gnormy}if(R<=e){var yt,ct=-I,nt=-G;null==Bn.poolVec2?ft=new St:(ft=Bn.poolVec2,Bn.poolVec2=ft.zpp_pool,ft.zpp_pool=null),null==ft.zpp_inner?(null==Gr.zpp_pool?yt=new Gr:(yt=Gr.zpp_pool,Gr.zpp_pool=yt.next,yt.next=null),yt.weak=!1,yt._immutable=!1,yt.x=ct,yt.y=nt,ft.zpp_inner=yt,ft.zpp_inner.outer=ft):(null!=(yt=ft.zpp_inner)._validate&&yt._validate(),ft.zpp_inner.x==ct&&(null!=(yt=ft.zpp_inner)._validate&&yt._validate(),ft.zpp_inner.y==nt)||(ft.zpp_inner.x=ct,ft.zpp_inner.y=nt,null!=(nt=ft.zpp_inner)._invalidate&&nt._invalidate(nt))),ft.zpp_inner.weak=!1;var _t,mt,gt,ft=ft;return null==Bn.poolVec2?_t=new St:(_t=Bn.poolVec2,Bn.poolVec2=_t.zpp_pool,_t.zpp_pool=null),null==_t.zpp_inner?(null==Gr.zpp_pool?mt=new Gr:(mt=Gr.zpp_pool,Gr.zpp_pool=mt.next,mt.next=null),mt.weak=!1,mt._immutable=!1,mt.x=D,mt.y=L,_t.zpp_inner=mt,_t.zpp_inner.outer=_t):(null!=(mt=_t.zpp_inner)._validate&&mt._validate(),_t.zpp_inner.x==D&&(null!=(gt=_t.zpp_inner)._validate&&gt._validate(),_t.zpp_inner.y==L)||(_t.zpp_inner.x=D,_t.zpp_inner.y=L,null!=(gt=_t.zpp_inner)._invalidate&&gt._invalidate(gt))),_t.zpp_inner.weak=!1,ce.getConvex(ft,_t,R,B)}return null},ii.prototype.prepareCast=function(t){if(0==t.type){var e=t.circle;if(e.zip_worldCOM&&null!=e.body){if(e.zip_worldCOM=!1,e.zip_localCOM){if(e.zip_localCOM=!1,1==e.type){var i=e.polygon;if(null==i.lverts.next.next)i.localCOMx=i.lverts.next.x,i.localCOMy=i.lverts.next.y;else if(null==i.lverts.next.next.next)i.localCOMx=i.lverts.next.x,i.localCOMy=i.lverts.next.y,i.localCOMx+=i.lverts.next.next.x,i.localCOMy+=i.lverts.next.next.y,i.localCOMx*=.5,i.localCOMy*=.5;else{i.localCOMx=0;var n=i.localCOMy=0,r=i.lverts.next,o=r,s=r=r.next;for(r=r.next;null!=r;){var a=r;n+=s.x*(a.y-o.y);var h=a.y*s.x-a.x*s.y;i.localCOMx+=(s.x+a.x)*h,i.localCOMy+=(s.y+a.y)*h,o=s,s=a,r=r.next}var l=r=i.lverts.next;n+=s.x*(l.y-o.y);var p=l.y*s.x-l.x*s.y;i.localCOMx+=(s.x+l.x)*p,i.localCOMy+=(s.y+l.y)*p;var o=s,u=r=r.next;n+=l.x*(u.y-o.y);p=u.y*l.x-u.x*l.y;i.localCOMx+=(l.x+u.x)*p,i.localCOMy+=(l.y+u.y)*p;p=n=1/(3*n);i.localCOMx*=p,i.localCOMy*=p}}null!=e.wrap_localCOM&&(e.wrap_localCOM.zpp_inner.x=e.localCOMx,e.wrap_localCOM.zpp_inner.y=e.localCOMy)}p=e.body;p.zip_axis&&(p.zip_axis=!1,p.axisx=Math.sin(p.rot),p.axisy=Math.cos(p.rot)),e.worldCOMx=e.body.posx+(e.body.axisy*e.localCOMx-e.body.axisx*e.localCOMy),e.worldCOMy=e.body.posy+(e.localCOMx*e.body.axisx+e.localCOMy*e.body.axisy)}}else{var d=t.polygon;if(d.zip_gaxi&&null!=d.body){d.zip_gaxi=!1,d.validate_laxi();t=d.body;if(t.zip_axis&&(t.zip_axis=!1,t.axisx=Math.sin(t.rot),t.axisy=Math.cos(t.rot)),d.zip_gverts&&null!=d.body){d.zip_gverts=!1,d.validate_lverts();var c=d.body;c.zip_axis&&(c.zip_axis=!1,c.axisx=Math.sin(c.rot),c.axisy=Math.cos(c.rot));for(var y=d.lverts.next,_=d.gverts.next;null!=_;){var m=_,g=y,y=y.next;m.x=d.body.posx+(d.body.axisy*g.x-d.body.axisx*g.y),m.y=d.body.posy+(g.x*d.body.axisx+g.y*d.body.axisy),_=_.next}}for(var f=d.edges.head,x=v=d.gverts.next,v=v.next;null!=v;){var w=v,z=f.elt,f=f.next;z.gp0=x,z.gp1=w,z.gnormx=d.body.axisy*z.lnormx-d.body.axisx*z.lnormy,z.gnormy=z.lnormx*d.body.axisx+z.lnormy*d.body.axisy,z.gprojection=d.body.posx*z.gnormx+d.body.posy*z.gnormy+z.lprojection,null!=z.wrap_gnorm&&(z.wrap_gnorm.zpp_inner.x=z.gnormx,z.wrap_gnorm.zpp_inner.y=z.gnormy),z.tp0=z.gp0.y*z.gnormx-z.gp0.x*z.gnormy,z.tp1=z.gp1.y*z.gnormx-z.gp1.x*z.gnormy,x=w,v=v.next}c=f.elt;c.gp0=x,c.gp1=d.gverts.next,c.gnormx=d.body.axisy*c.lnormx-d.body.axisx*c.lnormy,c.gnormy=c.lnormx*d.body.axisx+c.lnormy*d.body.axisy,c.gprojection=d.body.posx*c.gnormx+d.body.posy*c.gnormy+c.lprojection,null!=c.wrap_gnorm&&(c.wrap_gnorm.zpp_inner.x=c.gnormx,c.wrap_gnorm.zpp_inner.y=c.gnormy),c.tp0=c.gp0.y*c.gnormx-c.gp0.x*c.gnormy,c.tp1=c.gp1.y*c.gnormx-c.gp1.x*c.gnormy}}},ii.prototype.convexMultiCast=function(t,e,i,n,r){var o;if(null==Ee.zpp_pool?o=new Ee:(o=Ee.zpp_pool,Ee.zpp_pool=o.next,o.next=null),o.failed=!1,o.s1=o.s2=null,o.arbiter=null,0==t.type){var s=t.circle;if(s.zip_worldCOM&&null!=s.body){if(s.zip_worldCOM=!1,s.zip_localCOM){if(s.zip_localCOM=!1,1==s.type){var a=s.polygon;if(null==a.lverts.next.next)a.localCOMx=a.lverts.next.x,a.localCOMy=a.lverts.next.y;else if(null==a.lverts.next.next.next)a.localCOMx=a.lverts.next.x,a.localCOMy=a.lverts.next.y,a.localCOMx+=a.lverts.next.next.x,a.localCOMy+=a.lverts.next.next.y,a.localCOMx*=.5,a.localCOMy*=.5;else{a.localCOMx=0;var h=a.localCOMy=0,l=a.lverts.next,p=l,u=l=l.next;for(l=l.next;null!=l;){var d=l;h+=u.x*(d.y-p.y);var c=d.y*u.x-d.x*u.y;a.localCOMx+=(u.x+d.x)*c,a.localCOMy+=(u.y+d.y)*c,p=u,u=d,l=l.next}var y=l=a.lverts.next;h+=u.x*(y.y-p.y);var _=y.y*u.x-y.x*u.y;a.localCOMx+=(u.x+y.x)*_,a.localCOMy+=(u.y+y.y)*_;var p=u,m=l=l.next;h+=y.x*(m.y-p.y);_=m.y*y.x-m.x*y.y;a.localCOMx+=(y.x+m.x)*_,a.localCOMy+=(y.y+m.y)*_;_=h=1/(3*h);a.localCOMx*=_,a.localCOMy*=_}}null!=s.wrap_localCOM&&(s.wrap_localCOM.zpp_inner.x=s.localCOMx,s.wrap_localCOM.zpp_inner.y=s.localCOMy)}_=s.body;_.zip_axis&&(_.zip_axis=!1,_.axisx=Math.sin(_.rot),_.axisy=Math.cos(_.rot)),s.worldCOMx=s.body.posx+(s.body.axisy*s.localCOMx-s.body.axisx*s.localCOMy),s.worldCOMy=s.body.posy+(s.localCOMx*s.body.axisx+s.localCOMy*s.body.axisy)}}else{var g=t.polygon;if(g.zip_gaxi&&null!=g.body){g.zip_gaxi=!1,g.validate_laxi();var f=g.body;if(f.zip_axis&&(f.zip_axis=!1,f.axisx=Math.sin(f.rot),f.axisy=Math.cos(f.rot)),g.zip_gverts&&null!=g.body){g.zip_gverts=!1,g.validate_lverts();var x=g.body;x.zip_axis&&(x.zip_axis=!1,x.axisx=Math.sin(x.rot),x.axisy=Math.cos(x.rot));for(var v=g.lverts.next,w=g.gverts.next;null!=w;){var z=w,b=v,v=v.next;z.x=g.body.posx+(g.body.axisy*b.x-g.body.axisx*b.y),z.y=g.body.posy+(b.x*g.body.axisx+b.y*g.body.axisy),w=w.next}}for(var S=g.edges.head,C=P=g.gverts.next,P=P.next;null!=P;){var M=P,T=S.elt,S=S.next;T.gp0=C,T.gp1=M,T.gnormx=g.body.axisy*T.lnormx-g.body.axisx*T.lnormy,T.gnormy=T.lnormx*g.body.axisx+T.lnormy*g.body.axisy,T.gprojection=g.body.posx*T.gnormx+g.body.posy*T.gnormy+T.lprojection,null!=T.wrap_gnorm&&(T.wrap_gnorm.zpp_inner.x=T.gnormx,T.wrap_gnorm.zpp_inner.y=T.gnormy),T.tp0=T.gp0.y*T.gnormx-T.gp0.x*T.gnormy,T.tp1=T.gp1.y*T.gnormx-T.gp1.x*T.gnormy,C=M,P=P.next}var A=S.elt;A.gp0=C,A.gp1=g.gverts.next,A.gnormx=g.body.axisy*A.lnormx-g.body.axisx*A.lnormy,A.gnormy=A.lnormx*g.body.axisx+A.lnormy*g.body.axisy,A.gprojection=g.body.posx*A.gnormx+g.body.posy*A.gnormy+A.lprojection,null!=A.wrap_gnorm&&(A.wrap_gnorm.zpp_inner.x=A.gnormx,A.wrap_gnorm.zpp_inner.y=A.gnormy),A.tp0=A.gp0.y*A.gnormx-A.gp0.x*A.gnormy,A.tp1=A.gp1.y*A.gnormx-A.gp1.x*A.gnormy}}var k=t.body,f=k.posx,x=k.posy;k.sweepTime=0,k.sweep_angvel=k.angvel;var A=e-k.sweepTime;0!=A&&(k.sweepTime=e,k.posx+=k.velx*A,k.posy+=k.vely*A,0!=k.angvel&&(O=k.sweep_angvel*A,k.rot+=O,1e-4<O*O?(k.axisx=Math.sin(k.rot),k.axisy=Math.cos(k.rot)):(I=((A=1-.5*(I=O*O))*k.axisx+O*k.axisy)*(E=1-I*I/8),k.axisy=(A*k.axisy-O*k.axisx)*E,k.axisx=I)));var O=k.posx,E=k.posy;t.validate_sweepRadius();var I=t.sweepRadius;null==De.zpp_pool?G=new De:(G=De.zpp_pool,De.zpp_pool=G.next,G.next=null),G.minx=(f<O?f:O)-I,G.maxx=(O<f?f:O)+I,G.miny=(x<E?x:E)-I,G.maxy=(E<x?x:E)+I;var i=this.convexShapeList=this.bphase.shapesInAABB(G,!1,!1,null==i?null:i.zpp_inner,this.convexShapeList),G=G;null!=G.outer&&(G.outer.zpp_inner=null,G.outer=null),G.wrap_min=G.wrap_max=null,G._invalidate=null,G._validate=null,G.next=De.zpp_pool,De.zpp_pool=G;var D=null==r?new bt:r;i.zpp_inner.valmod();for(var L=ne.get(i);;){L.zpp_inner.zpp_inner.valmod();var B=L.zpp_inner;B.zpp_inner.valmod(),B.zpp_inner.zip_length&&(B.zpp_inner.zip_length=!1,B.zpp_inner.user_length=B.zpp_inner.inner.length);var R=B.zpp_inner.user_length;if(L.zpp_critical=!0,!(L.zpp_i<R||(L.zpp_next=ne.zpp_pool,(ne.zpp_pool=L).zpp_inner=null,!1)))break;L.zpp_critical=!1;var F=L.zpp_inner.at(L.zpp_i++);if(F!=t.outer&&(null!=F.zpp_inner.body?F.zpp_inner.body.outer:null)!=k.outer){if(o.s1=t,o.s2=F.zpp_inner,n){F.zpp_inner.validate_sweepRadius(),(null!=F.zpp_inner.body?F.zpp_inner.body.outer:null).zpp_inner.sweep_angvel=(null!=F.zpp_inner.body?F.zpp_inner.body.outer:null).zpp_inner.angvel,(null!=F.zpp_inner.body?F.zpp_inner.body.outer:null).zpp_inner.sweepTime=0,Ie.dynamicSweep(o,e,0,0,!0);var N=(null!=F.zpp_inner.body?F.zpp_inner.body.outer:null).zpp_inner,j=0-N.sweepTime;0!=j&&(N.sweepTime=0,N.posx+=N.velx*j,N.posy+=N.vely*j,0!=N.angvel&&(B=N.sweep_angvel*j,N.rot+=B,1e-4<B*B?(N.axisx=Math.sin(N.rot),N.axisy=Math.cos(N.rot)):(V=((R=1-.5*(V=B*B))*N.axisx+B*N.axisy)*(j=1-V*V/8),N.axisy=(R*N.axisy-B*N.axisx)*j,N.axisx=V)));var U=(null!=F.zpp_inner.body?F.zpp_inner.body.outer:null).zpp_inner,V=F.zpp_inner;if(0==V.type)V.worldCOMx=U.posx+(U.axisy*V.localCOMx-U.axisx*V.localCOMy),V.worldCOMy=U.posy+(V.localCOMx*U.axisx+V.localCOMy*U.axisy);else{for(var W=V.polygon,X=W.lverts.next,H=W.gverts.next;null!=H;){var q=H,Y=X,X=X.next;q.x=U.posx+(U.axisy*Y.x-U.axisx*Y.y),q.y=U.posy+(Y.x*U.axisx+Y.y*U.axisy),H=H.next}for(var K=W.edges.head,Z=J=W.gverts.next,J=J.next;null!=J;){var Q=J,$=K.elt,K=K.next;$.gnormx=U.axisy*$.lnormx-U.axisx*$.lnormy,$.gnormy=$.lnormx*U.axisx+$.lnormy*U.axisy,$.gprojection=U.posx*$.gnormx+U.posy*$.gnormy+$.lprojection,$.tp0=Z.y*$.gnormx-Z.x*$.gnormy,$.tp1=Q.y*$.gnormx-Q.x*$.gnormy,Z=Q,J=J.next}var tt=W.gverts.next,et=K.elt;et.gnormx=U.axisy*et.lnormx-U.axisx*et.lnormy,et.gnormy=et.lnormx*U.axisx+et.lnormy*U.axisy,et.gprojection=U.posx*et.gnormx+U.posy*et.gnormy+et.lprojection,et.tp0=Z.y*et.gnormx-Z.x*et.gnormy,et.tp1=tt.y*et.gnormx-tt.x*et.gnormy}}else Ie.staticSweep(o,e,0,0);if(o.toi*=e,0<o.toi){var it,nt,W=-o.axis.x,tt=-o.axis.y;null==Bn.poolVec2?it=new St:(it=Bn.poolVec2,Bn.poolVec2=it.zpp_pool,it.zpp_pool=null),null==it.zpp_inner?(null==Gr.zpp_pool?nt=new Gr:(nt=Gr.zpp_pool,Gr.zpp_pool=nt.next,nt.next=null),nt.weak=!1,nt._immutable=!1,nt.x=W,nt.y=tt,it.zpp_inner=nt,it.zpp_inner.outer=it):(null!=(et=it.zpp_inner)._validate&&et._validate(),it.zpp_inner.x==W&&(null!=(at=it.zpp_inner)._validate&&at._validate(),it.zpp_inner.y==tt)||(it.zpp_inner.x=W,it.zpp_inner.y=tt,null!=(st=it.zpp_inner)._invalidate&&st._invalidate(st))),it.zpp_inner.weak=!1;var rt,ot,st,at=it,W=o.c2.x,tt=o.c2.y;null==Bn.poolVec2?rt=new St:(rt=Bn.poolVec2,Bn.poolVec2=rt.zpp_pool,rt.zpp_pool=null),null==rt.zpp_inner?(null==Gr.zpp_pool?ot=new Gr:(ot=Gr.zpp_pool,Gr.zpp_pool=ot.next,ot.next=null),ot.weak=!1,ot._immutable=!1,ot.x=W,ot.y=tt,rt.zpp_inner=ot,rt.zpp_inner.outer=rt):(null!=(st=rt.zpp_inner)._validate&&st._validate(),rt.zpp_inner.x==W&&(null!=(st=rt.zpp_inner)._validate&&st._validate(),rt.zpp_inner.y==tt)||(rt.zpp_inner.x=W,rt.zpp_inner.y=tt,null!=(tt=rt.zpp_inner)._invalidate&&tt._invalidate(tt))),rt.zpp_inner.weak=!1;for(var ht=ce.getConvex(at,rt,o.toi,F),lt=null,pt=D.zpp_inner.inner.head;null!=pt&&!(ht.zpp_inner.toiDistance<pt.elt.zpp_inner.toiDistance);)pt=(lt=pt).next;var ut,at=D.zpp_inner.inner;null==fn.zpp_pool?ut=new fn:(ut=fn.zpp_pool,fn.zpp_pool=ut.next,ut.next=null),ut.elt=ht;F=ut;null==lt?(F.next=at.head,at.head=F):(F.next=lt.next,lt.next=F),at.pushmod=at.modified=!0,at.length++}}}i.clear();r=o;r.next=Ee.zpp_pool,Ee.zpp_pool=r;i=0-k.sweepTime;if(0!=i&&(k.sweepTime=0,k.posx+=k.velx*i,k.posy+=k.vely*i,0!=k.angvel&&(r=k.sweep_angvel*i,k.rot+=r,1e-4<r*r?(k.axisx=Math.sin(k.rot),k.axisy=Math.cos(k.rot)):(zt=((i=1-.5*(zt=r*r))*k.axisx+r*k.axisy)*(dt=1-zt*zt/8),k.axisy=(i*k.axisy-r*k.axisx)*dt,k.axisx=zt))),0==t.type)t.worldCOMx=k.posx+(k.axisy*t.localCOMx-k.axisx*t.localCOMy),t.worldCOMy=k.posy+(t.localCOMx*k.axisx+t.localCOMy*k.axisy);else{for(var dt=t.polygon,ct=dt.lverts.next,yt=dt.gverts.next;null!=yt;){var _t=yt,mt=ct,ct=ct.next;_t.x=k.posx+(k.axisy*mt.x-k.axisx*mt.y),_t.y=k.posy+(mt.x*k.axisx+mt.y*k.axisy),yt=yt.next}for(var gt=dt.edges.head,ft=xt=dt.gverts.next,xt=xt.next;null!=xt;){var vt=xt,wt=gt.elt,gt=gt.next;wt.gnormx=k.axisy*wt.lnormx-k.axisx*wt.lnormy,wt.gnormy=wt.lnormx*k.axisx+wt.lnormy*k.axisy,wt.gprojection=k.posx*wt.gnormx+k.posy*wt.gnormy+wt.lprojection,wt.tp0=ft.y*wt.gnormx-ft.x*wt.gnormy,wt.tp1=vt.y*wt.gnormx-vt.x*wt.gnormy,ft=vt,xt=xt.next}var zt=dt.gverts.next,dt=gt.elt;dt.gnormx=k.axisy*dt.lnormx-k.axisx*dt.lnormy,dt.gnormy=dt.lnormx*k.axisx+dt.lnormy*k.axisy,dt.gprojection=k.posx*dt.gnormx+k.posy*dt.gnormy+dt.lprojection,dt.tp0=ft.y*dt.gnormx-ft.x*dt.gnormy,dt.tp1=zt.y*dt.gnormx-zt.x*dt.gnormy}return D},ii.prototype.push_callback=function(t){var e;return null==re.zpp_pool?e=new re:(e=re.zpp_pool,re.zpp_pool=e.next,e.next=null),this.callbacks.push(e),e.listener=t,e},ii.prototype.pre_dt=null,ii.prototype.step=function(t,e,i){if(this.time+=t,this.pre_dt=t,this.midstep=!0,this.stamp++,this.validation(),this.bphase.broadphase(this,!0),this.prestep(t),this.sortcontacts){var n=this.c_arbiters_false;if(null!=n.head&&null!=n.head.next){for(var r,o,s,a=n.head,h=null,l=null,p=null,u=null,d=1;;){for(r=0,l=a,h=a=null;null!=l;){for(++r,p=l,o=0,s=d;null!=p&&o<d;)++o,p=p.next;for(;0<o||0<s&&null!=p;)0!=o&&(0==s||null==p||!l.elt.active||!p.elt.active||l.elt.oc1.dist<p.elt.oc1.dist)?(l=(u=l).next,--o):(p=(u=p).next,--s),null!=h?h.next=u:a=u,h=u;l=p}if(h.next=null,d<<=1,!(1<r))break}n.head=a,n.modified=!0,n.pushmod=!0}}this.updateVel(t),this.warmStart(),this.iterateVel(e);for(var c=this.kinematics.head;null!=c;){var y=c.elt;y.pre_posx=y.posx,y.pre_posy=y.posy,y.pre_rot=y.rot,c=c.next}for(var _=this.live.head;null!=_;){var m=_.elt;m.pre_posx=m.posx,m.pre_posy=m.posy,m.pre_rot=m.rot,_=_.next}this.updatePos(t),this.continuous=!0,this.continuousCollisions(t),this.continuous=!1,this.iteratePos(i);for(var g=this.kinematics.head;null!=g;){var f=g.elt,x=!(f.posx==f.pre_posx&&f.posy==f.pre_posy),v=f.pre_rot!=f.rot;if(x){for(var w=f.shapes.head;null!=w;){var z=w.elt;1==z.type&&(z.polygon.invalidate_gverts(),z.polygon.invalidate_gaxi()),z.invalidate_worldCOM(),w=w.next}f.zip_worldCOM=!0}if(v){f.zip_axis=!0;for(var b=f.shapes.head;null!=b;){var S=b.elt;1==S.type&&(S.polygon.invalidate_gverts(),S.polygon.invalidate_gaxi()),S.invalidate_worldCOM(),b=b.next}f.zip_worldCOM=!0}g=g.next}for(var C=this.live.head;null!=C;){var P=C.elt,M=!(P.posx==P.pre_posx&&P.posy==P.pre_posy),T=P.pre_rot!=P.rot;if(M){for(var A=P.shapes.head;null!=A;){var k=A.elt;1==k.type&&(k.polygon.invalidate_gverts(),k.polygon.invalidate_gaxi()),k.invalidate_worldCOM(),A=A.next}P.zip_worldCOM=!0}if(T){P.zip_axis=!0;for(var O=P.shapes.head;null!=O;){var E=O.elt;1==E.type&&(E.polygon.invalidate_gverts(),E.polygon.invalidate_gaxi()),E.invalidate_worldCOM(),O=O.next}P.zip_worldCOM=!0}C=C.next}for(var I=null,G=this.staticsleep.head;null!=G;){var D,L,B,R=G.elt;3!=R.type||0==R.velx&&0==R.vely&&0==R.angvel?R.kinematicDelaySleep?(R.kinematicDelaySleep=!1,G=G.next):(R.component.sleeping=!0,D=this.staticsleep,null==I?(B=(L=D.head).next,D.head=B,null==D.head&&(D.pushmod=!0)):(B=(L=I.next).next,null==(I.next=B)&&(D.pushmod=!0)),(R=L).elt=null,R.next=Xi.zpp_pool,Xi.zpp_pool=R,D.modified=!0,D.length--,D.pushmod=!0,G=B):G=(I=G).next}this.doForests(t),this.sleepArbiters(),this.midstep=!1;for(var F=null,N=this.callbackset_list.next;null!=N;){var j=N;if(null!=j.arbiters.head){for(var U=!0,V=j.arbiters.head;null!=V;){if(!V.elt.sleeping){U=!1;break}V=V.next}for(var W,X=U,H=j.int1.cbSet,q=j.int2.cbSet,Y=null,K=(H.cbpairs.length<q.cbpairs.length?H:q).cbpairs.head;null!=K;){var Z=K.elt;if(Z.a==H&&Z.b==q||Z.a==q&&Z.b==H){Y=Z;break}K=K.next}null==Y&&(null==qn.zpp_pool?W=new qn:(W=qn.zpp_pool,qn.zpp_pool=W.next,W.next=null),W.zip_listeners=!0,Hn.setlt(H,q)?(W.a=H,W.b=q):(W.a=q,W.b=H),Y=W,H.cbpairs.add(Y),q!=H&&q.cbpairs.add(Y)),Y.zip_listeners&&(Y.zip_listeners=!1,Y.__validate());for(var J=Y.listeners.head;null!=J;){var Q,$,tt,et,it,nt=J.elt;6==nt.event&&(X&&!nt.allowSleepingCallbacks||j.empty_arb(nt.itype)||((Q=this.push_callback(nt)).event=6,$=j.int1,tt=j.int2,it=nt.options1,et=$.cbTypes,!(!it.nonemptyintersection(et,it.includes)||it.nonemptyintersection(et,it.excludes))&&(it=nt.options2,nt=tt.cbTypes,!!it.nonemptyintersection(nt,it.includes)&&!it.nonemptyintersection(nt,it.excludes))?(Q.int1=$,Q.int2=tt):(Q.int1=tt,Q.int2=$),Q.set=j)),J=J.next}N=(F=N).next}else{var rt,ot,st=this.callbackset_list;null==F?(ot=(rt=st.next).next,st.next=ot,null==st.next&&(st.pushmod=!0)):(ot=(rt=F.next).next,null==(F.next=ot)&&(st.pushmod=!0)),rt._inuse=!1,st.modified=!0,st.length--,st.pushmod=!0,N=ot,j.int1=j.int2=null,j.id=j.di=-1,j.freed=!0,j.next=tr.zpp_pool,tr.zpp_pool=j}}for(;!this.callbacks.empty();){var at=this.callbacks.pop();0==at.listener.type?at.listener.body.handler(at.wrapper_body()):1==at.listener.type?at.listener.constraint.handler(at.wrapper_con()):2==at.listener.type&&at.listener.interaction.handleri(at.wrapper_int()),at.int1=at.int2=null,at.body=null,at.constraint=null,(at.listener=null)!=at.wrap_arbiters&&(at.wrap_arbiters.zpp_inner.inner=null),at.set=null,at.next=re.zpp_pool,re.zpp_pool=at}},ii.prototype.toiEvents=null,ii.prototype.continuousCollisions=function(t){var e=2*Math.PI/t;this.bphase.broadphase(this,!1);for(var i=0;i<1&&null!=this.toiEvents.head;){for(var n=null,r=2,o=!1,s=null,a=null,h=this.toiEvents.head;null!=h;){var l=h.elt,p=l.s1.body,u=l.s2.body;if(p.sweepFrozen&&u.sweepFrozen){if(0==l.toi||!Ir.testCollide_safe(l.s1,l.s2)){h=this.toiEvents.erase(a),l.next=Ee.zpp_pool,Ee.zpp_pool=l;continue}l.toi=0}if(l.frozen1!=p.sweepFrozen||l.frozen2!=u.sweepFrozen){if(l.kinematic){h=this.toiEvents.erase(a),l.next=Ee.zpp_pool,Ee.zpp_pool=l;continue}if(l.frozen1=p.sweepFrozen,l.frozen2=u.sweepFrozen,l.frozen1&&(u=l.s1,l.s1=l.s2,l.s2=u,l.frozen1=!1,l.frozen2=!0),Ie.staticSweep(l,t,0,Er.collisionSlopCCD),l.toi<0){h=this.toiEvents.erase(a),l.next=Ee.zpp_pool,Ee.zpp_pool=l;continue}}0<=l.toi&&(l.toi<r||!o&&l.kinematic)&&(r=(n=l).toi,o=l.kinematic,s=a),h=(a=h).next}if(null==n)break;this.toiEvents.erase(s);var i=n.toi,d=n.s1.body,c=n.s2.body;if(!d.sweepFrozen){var y,_=i*t,m=_-d.sweepTime;0!=m&&(d.sweepTime=_,d.posx+=d.velx*m,d.posy+=d.vely*m,0!=d.angvel&&(y=d.sweep_angvel*m,d.rot+=y,1e-4<y*y?(d.axisx=Math.sin(d.rot),d.axisy=Math.cos(d.rot)):(g=((_=1-.5*(g=y*y))*d.axisx+y*d.axisy)*(m=1-g*g/8),d.axisy=(_*d.axisy-y*d.axisx)*m,d.axisx=g)));var g=n.s1;if(0==g.type)g.worldCOMx=d.posx+(d.axisy*g.localCOMx-d.axisx*g.localCOMy),g.worldCOMy=d.posy+(g.localCOMx*d.axisx+g.localCOMy*d.axisy);else{for(var f=g.polygon,x=f.lverts.next,v=f.gverts.next;null!=v;){var w=v,z=x,x=x.next;w.x=d.posx+(d.axisy*z.x-d.axisx*z.y),w.y=d.posy+(z.x*d.axisx+z.y*d.axisy),v=v.next}for(var b=f.edges.head,S=C=f.gverts.next,C=C.next;null!=C;){var P=C,M=b.elt,b=b.next;M.gnormx=d.axisy*M.lnormx-d.axisx*M.lnormy,M.gnormy=M.lnormx*d.axisx+M.lnormy*d.axisy,M.gprojection=d.posx*M.gnormx+d.posy*M.gnormy+M.lprojection,M.tp0=S.y*M.gnormx-S.x*M.gnormy,M.tp1=P.y*M.gnormx-P.x*M.gnormy,S=P,C=C.next}var T=f.gverts.next,f=b.elt;f.gnormx=d.axisy*f.lnormx-d.axisx*f.lnormy,f.gnormy=f.lnormx*d.axisx+f.lnormy*d.axisy,f.gprojection=d.posx*f.gnormx+d.posy*f.gnormy+f.lprojection,f.tp0=S.y*f.gnormx-S.x*f.gnormy,f.tp1=T.y*f.gnormx-T.x*f.gnormy}}if(!c.sweepFrozen){T=i*t,f=T-c.sweepTime;0!=f&&(c.sweepTime=T,c.posx+=c.velx*f,c.posy+=c.vely*f,0!=c.angvel&&(A=c.sweep_angvel*f,c.rot+=A,1e-4<A*A?(c.axisx=Math.sin(c.rot),c.axisy=Math.cos(c.rot)):(V=((f=1-.5*(V=A*A))*c.axisx+A*c.axisy)*(ot=1-V*V/8),c.axisy=(f*c.axisy-A*c.axisx)*ot,c.axisx=V)));var A=n.s2;if(0==A.type)A.worldCOMx=c.posx+(c.axisy*A.localCOMx-c.axisx*A.localCOMy),A.worldCOMy=c.posy+(A.localCOMx*c.axisx+A.localCOMy*c.axisy);else{for(var k=A.polygon,O=k.lverts.next,E=k.gverts.next;null!=E;){var I=E,G=O,O=O.next;I.x=c.posx+(c.axisy*G.x-c.axisx*G.y),I.y=c.posy+(G.x*c.axisx+G.y*c.axisy),E=E.next}for(var D=k.edges.head,L=B=k.gverts.next,B=B.next;null!=B;){var R=B,F=D.elt,D=D.next;F.gnormx=c.axisy*F.lnormx-c.axisx*F.lnormy,F.gnormy=F.lnormx*c.axisx+F.lnormy*c.axisy,F.gprojection=c.posx*F.gnormx+c.posy*F.gnormy+F.lprojection,F.tp0=L.y*F.gnormx-L.x*F.gnormy,F.tp1=R.y*F.gnormx-R.x*F.gnormy,L=R,B=B.next}var N=k.gverts.next,j=D.elt;j.gnormx=c.axisy*j.lnormx-c.axisx*j.lnormy,j.gnormy=j.lnormx*c.axisx+j.lnormy*c.axisy,j.gprojection=c.posx*j.gnormx+c.posy*j.gnormy+j.lprojection,j.tp0=L.y*j.gnormx-L.x*j.gnormy,j.tp1=N.y*j.gnormx-N.x*j.gnormy}}var U,V,W,X,H,q,Y,K,Z,J,Q,$,tt,et,it,nt,rt,ot=this.narrowPhase(n.s1,n.s2,!0,n.arbiter,!0);null==ot?null!=n.arbiter&&null!=n.arbiter.pair&&(n.arbiter.pair.arb=null,n.arbiter.pair=null):this.presteparb(ot,t,!0)||ot.type==Qe.COL&&ot.active&&0!=(1&ot.immState)&&(A=(V=ot.colarb).nx*V.c1.jnAcc-V.ny*V.c1.jtAcc,k=V.ny*V.c1.jnAcc+V.nx*V.c1.jtAcc,N=V.b1.imass,V.b1.velx-=A*N,V.b1.vely-=k*N,V.b1.angvel-=V.b1.iinertia*(k*V.c1.r1x-A*V.c1.r1y),j=V.b2.imass,V.b2.velx+=A*j,V.b2.vely+=k*j,V.b2.angvel+=V.b2.iinertia*(k*V.c1.r2x-A*V.c1.r2y),V.hc2&&(U=V.nx*V.c2.jnAcc-V.ny*V.c2.jtAcc,X=V.ny*V.c2.jnAcc+V.nx*V.c2.jtAcc,Q=V.b1.imass,V.b1.velx-=U*Q,V.b1.vely-=X*Q,V.b1.angvel-=V.b1.iinertia*(X*V.c2.r1x-U*V.c2.r1y),W=V.b2.imass,V.b2.velx+=U*W,V.b2.vely+=X*W,V.b2.angvel+=V.b2.iinertia*(X*V.c2.r2x-U*V.c2.r2y)),V.b2.angvel+=V.jrAcc*V.b2.iinertia,V.b1.angvel-=V.jrAcc*V.b1.iinertia,j=(N=ot.colarb).k1x+N.b2.velx-N.c1.r2y*N.b2.angvel-(N.b1.velx-N.c1.r1y*N.b1.angvel),A=((k=N.k1y+N.b2.vely+N.c1.r2x*N.b2.angvel-(N.b1.vely+N.c1.r1x*N.b1.angvel))*N.nx-j*N.ny+N.surfacex)*N.c1.tMass,(Q=N.c1.friction*N.c1.jnAcc)<(X=(W=N.c1.jtAcc)-A)?X=Q:X<-Q&&(X=-Q),A=X-W,N.c1.jtAcc=X,U=-N.ny*A,V=N.nx*A,N.b2.velx+=U*N.b2.imass,N.b2.vely+=V*N.b2.imass,N.b1.velx-=U*N.b1.imass,N.b1.vely-=V*N.b1.imass,N.b2.angvel+=N.rt1b*A*N.b2.iinertia,N.b1.angvel-=N.rt1a*A*N.b1.iinertia,N.hc2?(it=N.k2x+N.b2.velx-N.c2.r2y*N.b2.angvel-(N.b1.velx-N.c2.r1y*N.b1.angvel),A=((q=N.k2y+N.b2.vely+N.c2.r2x*N.b2.angvel-(N.b1.vely+N.c2.r1x*N.b1.angvel))*N.nx-it*N.ny+N.surfacex)*N.c2.tMass,(Q=N.c2.friction*N.c2.jnAcc)<(X=(W=N.c2.jtAcc)-A)?X=Q:X<-Q&&(X=-Q),A=X-W,N.c2.jtAcc=X,U=-N.ny*A,V=N.nx*A,N.b2.velx+=U*N.b2.imass,N.b2.vely+=V*N.b2.imass,N.b1.velx-=U*N.b1.imass,N.b1.vely-=V*N.b1.imass,N.b2.angvel+=N.rt2b*A*N.b2.iinertia,N.b1.angvel-=N.rt2a*A*N.b1.iinertia,j=N.k1x+N.b2.velx-N.c1.r2y*N.b2.angvel-(N.b1.velx-N.c1.r1y*N.b1.angvel),k=N.k1y+N.b2.vely+N.c1.r2x*N.b2.angvel-(N.b1.vely+N.c1.r1x*N.b1.angvel),it=N.k2x+N.b2.velx-N.c2.r2y*N.b2.angvel-(N.b1.velx-N.c2.r1y*N.b1.angvel),q=N.k2y+N.b2.vely+N.c2.r2x*N.b2.angvel-(N.b1.vely+N.c2.r1x*N.b1.angvel),Y=N.c1.jnAcc,et=N.c2.jnAcc,rt=j*N.nx+k*N.ny+N.surfacey+N.c1.bounce-(N.Ka*Y+N.Kb*et),nt=it*N.nx+q*N.ny+N.surfacey+N.c2.bounce-(N.Kb*Y+N.Kc*et),it=-(N.kMassa*rt+N.kMassb*nt),q=-(N.kMassb*rt+N.kMassc*nt),0<=it&&0<=q?(rt=it-Y,nt=q-et,N.c1.jnAcc=it,N.c2.jnAcc=q):0<=(it=-N.c1.nMass*rt)&&0<=N.Kb*it+nt?(rt=it-Y,nt=-et,N.c1.jnAcc=it,N.c2.jnAcc=0):0<=(q=-N.c2.nMass*nt)&&0<=N.Kb*q+rt?(rt=-Y,nt=q-et,N.c1.jnAcc=0,N.c2.jnAcc=q):0<=rt&&0<=nt?(rt=-Y,nt=-et,N.c1.jnAcc=N.c2.jnAcc=0):nt=rt=0,U=N.nx*(A=rt+nt),V=N.ny*A,N.b2.velx+=U*N.b2.imass,N.b2.vely+=V*N.b2.imass,N.b1.velx-=U*N.b1.imass,N.b1.vely-=V*N.b1.imass,N.b2.angvel+=(N.rn1b*rt+N.rn2b*nt)*N.b2.iinertia,N.b1.angvel-=(N.rn1a*rt+N.rn2a*nt)*N.b1.iinertia):(0!=N.radius&&(A=(N.b2.angvel-N.b1.angvel)*N.rMass,Q=N.rfric*N.c1.jnAcc,W=N.jrAcc,N.jrAcc-=A,N.jrAcc>Q?N.jrAcc=Q:N.jrAcc<-Q&&(N.jrAcc=-Q),A=N.jrAcc-W,N.b2.angvel+=A*N.b2.iinertia,N.b1.angvel-=A*N.b1.iinertia),j=N.k1x+N.b2.velx-N.c1.r2y*N.b2.angvel-(N.b1.velx-N.c1.r1y*N.b1.angvel),k=N.k1y+N.b2.vely+N.c1.r2x*N.b2.angvel-(N.b1.vely+N.c1.r1x*N.b1.angvel),A=(N.c1.bounce+(N.nx*j+N.ny*k)+N.surfacey)*N.c1.nMass,A=(X=(X=(W=N.c1.jnAcc)-A)<0?0:X)-W,N.c1.jnAcc=X,U=N.nx*A,V=N.ny*A,N.b2.velx+=U*N.b2.imass,N.b2.vely+=V*N.b2.imass,N.b1.velx-=U*N.b1.imass,N.b1.vely-=V*N.b1.imass,N.b2.angvel+=N.rn1b*A*N.b2.iinertia,N.b1.angvel-=N.rn1a*A*N.b1.iinertia),q=(it=ot.colarb).k1x+it.b2.velx-it.c1.r2y*it.b2.angvel-(it.b1.velx-it.c1.r1y*it.b1.angvel),et=((Y=it.k1y+it.b2.vely+it.c1.r2x*it.b2.angvel-(it.b1.vely+it.c1.r1x*it.b1.angvel))*it.nx-q*it.ny+it.surfacex)*it.c1.tMass,(rt=it.c1.friction*it.c1.jnAcc)<(Q=(nt=it.c1.jtAcc)-et)?Q=rt:Q<-rt&&(Q=-rt),et=Q-nt,it.c1.jtAcc=Q,j=-it.ny*et,k=it.nx*et,it.b2.velx+=j*it.b2.imass,it.b2.vely+=k*it.b2.imass,it.b1.velx-=j*it.b1.imass,it.b1.vely-=k*it.b1.imass,it.b2.angvel+=it.rt1b*et*it.b2.iinertia,it.b1.angvel-=it.rt1a*et*it.b1.iinertia,it.hc2?(W=it.k2x+it.b2.velx-it.c2.r2y*it.b2.angvel-(it.b1.velx-it.c2.r1y*it.b1.angvel),et=((X=it.k2y+it.b2.vely+it.c2.r2x*it.b2.angvel-(it.b1.vely+it.c2.r1x*it.b1.angvel))*it.nx-W*it.ny+it.surfacex)*it.c2.tMass,(rt=it.c2.friction*it.c2.jnAcc)<(Q=(nt=it.c2.jtAcc)-et)?Q=rt:Q<-rt&&(Q=-rt),et=Q-nt,it.c2.jtAcc=Q,j=-it.ny*et,k=it.nx*et,it.b2.velx+=j*it.b2.imass,it.b2.vely+=k*it.b2.imass,it.b1.velx-=j*it.b1.imass,it.b1.vely-=k*it.b1.imass,it.b2.angvel+=it.rt2b*et*it.b2.iinertia,it.b1.angvel-=it.rt2a*et*it.b1.iinertia,q=it.k1x+it.b2.velx-it.c1.r2y*it.b2.angvel-(it.b1.velx-it.c1.r1y*it.b1.angvel),Y=it.k1y+it.b2.vely+it.c1.r2x*it.b2.angvel-(it.b1.vely+it.c1.r1x*it.b1.angvel),W=it.k2x+it.b2.velx-it.c2.r2y*it.b2.angvel-(it.b1.velx-it.c2.r1y*it.b1.angvel),X=it.k2y+it.b2.vely+it.c2.r2x*it.b2.angvel-(it.b1.vely+it.c2.r1x*it.b1.angvel),U=it.c1.jnAcc,V=it.c2.jnAcc,A=q*it.nx+Y*it.ny+it.surfacey+it.c1.bounce-(it.Ka*U+it.Kb*V),N=W*it.nx+X*it.ny+it.surfacey+it.c2.bounce-(it.Kb*U+it.Kc*V),W=-(it.kMassa*A+it.kMassb*N),X=-(it.kMassb*A+it.kMassc*N),0<=W&&0<=X?(A=W-U,N=X-V,it.c1.jnAcc=W,it.c2.jnAcc=X):0<=(W=-it.c1.nMass*A)&&0<=it.Kb*W+N?(A=W-U,N=-V,it.c1.jnAcc=W,it.c2.jnAcc=0):0<=(X=-it.c2.nMass*N)&&0<=it.Kb*X+A?(A=-U,N=X-V,it.c1.jnAcc=0,it.c2.jnAcc=X):0<=A&&0<=N?(A=-U,N=-V,it.c1.jnAcc=it.c2.jnAcc=0):N=A=0,j=it.nx*(et=A+N),k=it.ny*et,it.b2.velx+=j*it.b2.imass,it.b2.vely+=k*it.b2.imass,it.b1.velx-=j*it.b1.imass,it.b1.vely-=k*it.b1.imass,it.b2.angvel+=(it.rn1b*A+it.rn2b*N)*it.b2.iinertia,it.b1.angvel-=(it.rn1a*A+it.rn2a*N)*it.b1.iinertia):(0!=it.radius&&(et=(it.b2.angvel-it.b1.angvel)*it.rMass,rt=it.rfric*it.c1.jnAcc,nt=it.jrAcc,it.jrAcc-=et,it.jrAcc>rt?it.jrAcc=rt:it.jrAcc<-rt&&(it.jrAcc=-rt),et=it.jrAcc-nt,it.b2.angvel+=et*it.b2.iinertia,it.b1.angvel-=et*it.b1.iinertia),q=it.k1x+it.b2.velx-it.c1.r2y*it.b2.angvel-(it.b1.velx-it.c1.r1y*it.b1.angvel),Y=it.k1y+it.b2.vely+it.c1.r2x*it.b2.angvel-(it.b1.vely+it.c1.r1x*it.b1.angvel),et=(it.c1.bounce+(it.nx*q+it.ny*Y)+it.surfacey)*it.c1.nMass,et=(Q=(Q=(nt=it.c1.jnAcc)-et)<0?0:Q)-nt,it.c1.jnAcc=Q,j=it.nx*et,k=it.ny*et,it.b2.velx+=j*it.b2.imass,it.b2.vely+=k*it.b2.imass,it.b1.velx-=j*it.b1.imass,it.b1.vely-=k*it.b1.imass,it.b2.angvel+=it.rn1b*et*it.b2.iinertia,it.b1.angvel-=it.rn1a*et*it.b1.iinertia),q=(rt=ot.colarb).k1x+rt.b2.velx-rt.c1.r2y*rt.b2.angvel-(rt.b1.velx-rt.c1.r1y*rt.b1.angvel),nt=((Y=rt.k1y+rt.b2.vely+rt.c1.r2x*rt.b2.angvel-(rt.b1.vely+rt.c1.r1x*rt.b1.angvel))*rt.nx-q*rt.ny+rt.surfacex)*rt.c1.tMass,(Q=rt.c1.friction*rt.c1.jnAcc)<(k=(j=rt.c1.jtAcc)-nt)?k=Q:k<-Q&&(k=-Q),nt=k-j,rt.c1.jtAcc=k,et=-rt.ny*nt,it=rt.nx*nt,rt.b2.velx+=et*rt.b2.imass,rt.b2.vely+=it*rt.b2.imass,rt.b1.velx-=et*rt.b1.imass,rt.b1.vely-=it*rt.b1.imass,rt.b2.angvel+=rt.rt1b*nt*rt.b2.iinertia,rt.b1.angvel-=rt.rt1a*nt*rt.b1.iinertia,rt.hc2?(H=rt.k2x+rt.b2.velx-rt.c2.r2y*rt.b2.angvel-(rt.b1.velx-rt.c2.r1y*rt.b1.angvel),nt=(($=rt.k2y+rt.b2.vely+rt.c2.r2x*rt.b2.angvel-(rt.b1.vely+rt.c2.r1x*rt.b1.angvel))*rt.nx-H*rt.ny+rt.surfacex)*rt.c2.tMass,(Q=rt.c2.friction*rt.c2.jnAcc)<(k=(j=rt.c2.jtAcc)-nt)?k=Q:k<-Q&&(k=-Q),nt=k-j,rt.c2.jtAcc=k,et=-rt.ny*nt,it=rt.nx*nt,rt.b2.velx+=et*rt.b2.imass,rt.b2.vely+=it*rt.b2.imass,rt.b1.velx-=et*rt.b1.imass,rt.b1.vely-=it*rt.b1.imass,rt.b2.angvel+=rt.rt2b*nt*rt.b2.iinertia,rt.b1.angvel-=rt.rt2a*nt*rt.b1.iinertia,q=rt.k1x+rt.b2.velx-rt.c1.r2y*rt.b2.angvel-(rt.b1.velx-rt.c1.r1y*rt.b1.angvel),Y=rt.k1y+rt.b2.vely+rt.c1.r2x*rt.b2.angvel-(rt.b1.vely+rt.c1.r1x*rt.b1.angvel),H=rt.k2x+rt.b2.velx-rt.c2.r2y*rt.b2.angvel-(rt.b1.velx-rt.c2.r1y*rt.b1.angvel),$=rt.k2y+rt.b2.vely+rt.c2.r2x*rt.b2.angvel-(rt.b1.vely+rt.c2.r1x*rt.b1.angvel),tt=rt.c1.jnAcc,K=rt.c2.jnAcc,Z=q*rt.nx+Y*rt.ny+rt.surfacey+rt.c1.bounce-(rt.Ka*tt+rt.Kb*K),J=H*rt.nx+$*rt.ny+rt.surfacey+rt.c2.bounce-(rt.Kb*tt+rt.Kc*K),H=-(rt.kMassa*Z+rt.kMassb*J),$=-(rt.kMassb*Z+rt.kMassc*J),0<=H&&0<=$?(Z=H-tt,J=$-K,rt.c1.jnAcc=H,rt.c2.jnAcc=$):0<=(H=-rt.c1.nMass*Z)&&0<=rt.Kb*H+J?(Z=H-tt,J=-K,rt.c1.jnAcc=H,rt.c2.jnAcc=0):0<=($=-rt.c2.nMass*J)&&0<=rt.Kb*$+Z?(Z=-tt,J=$-K,rt.c1.jnAcc=0,rt.c2.jnAcc=$):0<=Z&&0<=J?(Z=-tt,J=-K,rt.c1.jnAcc=rt.c2.jnAcc=0):J=Z=0,et=rt.nx*(nt=Z+J),it=rt.ny*nt,rt.b2.velx+=et*rt.b2.imass,rt.b2.vely+=it*rt.b2.imass,rt.b1.velx-=et*rt.b1.imass,rt.b1.vely-=it*rt.b1.imass,rt.b2.angvel+=(rt.rn1b*Z+rt.rn2b*J)*rt.b2.iinertia,rt.b1.angvel-=(rt.rn1a*Z+rt.rn2a*J)*rt.b1.iinertia):(0!=rt.radius&&(nt=(rt.b2.angvel-rt.b1.angvel)*rt.rMass,Q=rt.rfric*rt.c1.jnAcc,j=rt.jrAcc,rt.jrAcc-=nt,rt.jrAcc>Q?rt.jrAcc=Q:rt.jrAcc<-Q&&(rt.jrAcc=-Q),nt=rt.jrAcc-j,rt.b2.angvel+=nt*rt.b2.iinertia,rt.b1.angvel-=nt*rt.b1.iinertia),q=rt.k1x+rt.b2.velx-rt.c1.r2y*rt.b2.angvel-(rt.b1.velx-rt.c1.r1y*rt.b1.angvel),Y=rt.k1y+rt.b2.vely+rt.c1.r2x*rt.b2.angvel-(rt.b1.vely+rt.c1.r1x*rt.b1.angvel),nt=(rt.c1.bounce+(rt.nx*q+rt.ny*Y)+rt.surfacey)*rt.c1.nMass,nt=(k=(k=(j=rt.c1.jnAcc)-nt)<0?0:k)-j,rt.c1.jnAcc=k,et=rt.nx*nt,it=rt.ny*nt,rt.b2.velx+=et*rt.b2.imass,rt.b2.vely+=it*rt.b2.imass,rt.b1.velx-=et*rt.b1.imass,rt.b1.vely-=it*rt.b1.imass,rt.b2.angvel+=rt.rn1b*nt*rt.b2.iinertia,rt.b1.angvel-=rt.rn1a*nt*rt.b1.iinertia),$=(H=ot.colarb).k1x+H.b2.velx-H.c1.r2y*H.b2.angvel-(H.b1.velx-H.c1.r1y*H.b1.angvel),K=((tt=H.k1y+H.b2.vely+H.c1.r2x*H.b2.angvel-(H.b1.vely+H.c1.r1x*H.b1.angvel))*H.nx-$*H.ny+H.surfacex)*H.c1.tMass,(Z=H.c1.friction*H.c1.jnAcc)<(Q=(J=H.c1.jtAcc)-K)?Q=Z:Q<-Z&&(Q=-Z),K=Q-J,H.c1.jtAcc=Q,q=-H.ny*K,Y=H.nx*K,H.b2.velx+=q*H.b2.imass,H.b2.vely+=Y*H.b2.imass,H.b1.velx-=q*H.b1.imass,H.b1.vely-=Y*H.b1.imass,H.b2.angvel+=H.rt1b*K*H.b2.iinertia,H.b1.angvel-=H.rt1a*K*H.b1.iinertia,H.hc2?(j=H.k2x+H.b2.velx-H.c2.r2y*H.b2.angvel-(H.b1.velx-H.c2.r1y*H.b1.angvel),K=((k=H.k2y+H.b2.vely+H.c2.r2x*H.b2.angvel-(H.b1.vely+H.c2.r1x*H.b1.angvel))*H.nx-j*H.ny+H.surfacex)*H.c2.tMass,(Z=H.c2.friction*H.c2.jnAcc)<(Q=(J=H.c2.jtAcc)-K)?Q=Z:Q<-Z&&(Q=-Z),K=Q-J,H.c2.jtAcc=Q,q=-H.ny*K,Y=H.nx*K,H.b2.velx+=q*H.b2.imass,H.b2.vely+=Y*H.b2.imass,H.b1.velx-=q*H.b1.imass,H.b1.vely-=Y*H.b1.imass,H.b2.angvel+=H.rt2b*K*H.b2.iinertia,H.b1.angvel-=H.rt2a*K*H.b1.iinertia,$=H.k1x+H.b2.velx-H.c1.r2y*H.b2.angvel-(H.b1.velx-H.c1.r1y*H.b1.angvel),tt=H.k1y+H.b2.vely+H.c1.r2x*H.b2.angvel-(H.b1.vely+H.c1.r1x*H.b1.angvel),j=H.k2x+H.b2.velx-H.c2.r2y*H.b2.angvel-(H.b1.velx-H.c2.r1y*H.b1.angvel),k=H.k2y+H.b2.vely+H.c2.r2x*H.b2.angvel-(H.b1.vely+H.c2.r1x*H.b1.angvel),et=H.c1.jnAcc,it=H.c2.jnAcc,nt=$*H.nx+tt*H.ny+H.surfacey+H.c1.bounce-(H.Ka*et+H.Kb*it),rt=j*H.nx+k*H.ny+H.surfacey+H.c2.bounce-(H.Kb*et+H.Kc*it),j=-(H.kMassa*nt+H.kMassb*rt),k=-(H.kMassb*nt+H.kMassc*rt),0<=j&&0<=k?(nt=j-et,rt=k-it,H.c1.jnAcc=j,H.c2.jnAcc=k):0<=(j=-H.c1.nMass*nt)&&0<=H.Kb*j+rt?(nt=j-et,rt=-it,H.c1.jnAcc=j,H.c2.jnAcc=0):0<=(k=-H.c2.nMass*rt)&&0<=H.Kb*k+nt?(nt=-et,rt=k-it,H.c1.jnAcc=0,H.c2.jnAcc=k):0<=nt&&0<=rt?(nt=-et,rt=-it,H.c1.jnAcc=H.c2.jnAcc=0):rt=nt=0,q=H.nx*(K=nt+rt),Y=H.ny*K,H.b2.velx+=q*H.b2.imass,H.b2.vely+=Y*H.b2.imass,H.b1.velx-=q*H.b1.imass,H.b1.vely-=Y*H.b1.imass,H.b2.angvel+=(H.rn1b*nt+H.rn2b*rt)*H.b2.iinertia,H.b1.angvel-=(H.rn1a*nt+H.rn2a*rt)*H.b1.iinertia):(0!=H.radius&&(K=(H.b2.angvel-H.b1.angvel)*H.rMass,Z=H.rfric*H.c1.jnAcc,J=H.jrAcc,H.jrAcc-=K,H.jrAcc>Z?H.jrAcc=Z:H.jrAcc<-Z&&(H.jrAcc=-Z),K=H.jrAcc-J,H.b2.angvel+=K*H.b2.iinertia,H.b1.angvel-=K*H.b1.iinertia),$=H.k1x+H.b2.velx-H.c1.r2y*H.b2.angvel-(H.b1.velx-H.c1.r1y*H.b1.angvel),tt=H.k1y+H.b2.vely+H.c1.r2x*H.b2.angvel-(H.b1.vely+H.c1.r1x*H.b1.angvel),K=(H.c1.bounce+(H.nx*$+H.ny*tt)+H.surfacey)*H.c1.nMass,K=(Q=(Q=(J=H.c1.jnAcc)-K)<0?0:Q)-J,H.c1.jnAcc=Q,q=H.nx*K,Y=H.ny*K,H.b2.velx+=q*H.b2.imass,H.b2.vely+=Y*H.b2.imass,H.b1.velx-=q*H.b1.imass,H.b1.vely-=Y*H.b1.imass,H.b2.angvel+=H.rn1b*K*H.b2.iinertia,H.b1.angvel-=H.rn1a*K*H.b1.iinertia),d.sweep_angvel=d.angvel%e,c.sweep_angvel=c.angvel%e),null!=ot&&ot.active&&0!=(1&ot.immState)&&ot.type==Qe.COL&&(d.sweepFrozen||3==d.type||(d.sweepFrozen=!0,n.failed?d.angvel=d.sweep_angvel=0:n.slipped?d.angvel=d.sweep_angvel*=Er.angularCCDSlipScale:d.angvel=d.sweep_angvel),c.sweepFrozen||3==c.type||(c.sweepFrozen=!0,n.failed?c.angvel=c.sweep_angvel=0:n.slipped?c.angvel=c.sweep_angvel*=Er.angularCCDSlipScale:c.angvel=c.sweep_angvel));ot=n;ot.next=Ee.zpp_pool,Ee.zpp_pool=ot}for(;null!=this.toiEvents.head;){var st=this.toiEvents.pop_unsafe();st.next=Ee.zpp_pool,Ee.zpp_pool=st}for(var at=this.kinematics.head;null!=at;){var ht,lt,pt,ut=at.elt,dt=t-ut.sweepTime;0!=dt&&(ut.sweepTime=t,ut.posx+=ut.velx*dt,ut.posy+=ut.vely*dt,0!=ut.angvel&&(ht=ut.sweep_angvel*dt,ut.rot+=ht,1e-4<ht*ht?(ut.axisx=Math.sin(ut.rot),ut.axisy=Math.cos(ut.rot)):(pt=((lt=1-.5*(pt=ht*ht))*ut.axisx+ht*ut.axisy)*(dt=1-pt*pt/8),ut.axisy=(lt*ut.axisy-ht*ut.axisx)*dt,ut.axisx=pt))),ut.sweepTime=0,at=at.next}for(var ct=this.live.head;null!=ct;){var yt,_t,mt,gt,ft=ct.elt;ft.sweepFrozen||0!=(mt=t-ft.sweepTime)&&(ft.sweepTime=t,ft.posx+=ft.velx*mt,ft.posy+=ft.vely*mt,0!=ft.angvel&&(yt=ft.sweep_angvel*mt,ft.rot+=yt,1e-4<yt*yt?(ft.axisx=Math.sin(ft.rot),ft.axisy=Math.cos(ft.rot)):(gt=((_t=1-.5*(gt=yt*yt))*ft.axisx+yt*ft.axisy)*(mt=1-gt*gt/8),ft.axisy=(_t*ft.axisy-yt*ft.axisx)*mt,ft.axisx=gt))),ft.sweepTime=0,ct=ct.next}},ii.prototype.continuousEvent=function(t,e,i,n,r){if(t.body.sweepFrozen&&e.body.sweepFrozen)return n;if(t.body.disableCCD||e.body.disableCCD)return n;if(null==n||null!=n.colarb){for(var o,s,a,h=t.body,l=e.body,p=!1,u=h.constraints.head;null!=u;){var d=u.elt;if(d.ignore&&d.pair_exists(h.id,l.id)){p=!0;break}u=u.next}if(p)o=!1;else{for(var c=t;null!=c&&null==c.group;)c=null!=c.ishape?c.ishape.body:(null!=c.icompound?c.icompound:c.ibody).compound;var y,_=null==c?null:c.group;if(null==_)y=!1;else{for(var m=e;null!=m&&null==m.group;)m=null!=m.ishape?m.ishape.body:(null!=m.icompound?m.icompound:m.ibody).compound;var g=null==m?null:m.group;if(null==g)y=!1;else{for(var f=!1;null!=_&&null!=g;){if(_==g){f=_.ignore;break}_.depth<g.depth?g=g.group:_=_.group}y=f}}o=!y}w=(o?!(!t.sensorEnabled&&!e.sensorEnabled)&&(a=t.filter,s=e.filter,0!=(a.sensorMask&s.sensorGroup)&&0!=(s.sensorMask&a.sensorGroup))?2:!!(!(!t.fluidEnabled&&!e.fluidEnabled)&&(s=t.filter,a=e.filter,0!=(s.fluidMask&a.fluidGroup)&&0!=(a.fluidMask&s.fluidGroup)))&&!(0==h.imass&&0==l.imass&&0==h.iinertia&&0==l.iinertia)?0:(v=t.filter,w=e.filter,0!=(v.collisionMask&w.collisionGroup)&&0!=(w.collisionMask&v.collisionGroup)&&!(0==h.imass&&0==l.imass&&0==h.iinertia&&0==l.iinertia)?1:-1):-1)<=0}else w=!0;if(w)return n;var x,v=t.body,w=e.body;return(i||v.bullet||w.bullet)&&(null==Ee.zpp_pool?x=new Ee:(x=Ee.zpp_pool,Ee.zpp_pool=x.next,x.next=null),x.failed=!1,x.s1=x.s2=null,x.arbiter=null,w=3==v.type||3==w.type,i&&!w?(2!=t.body.type?(x.s2=t,x.s1=e):(x.s1=t,x.s2=e),x.kinematic=!1,Ie.staticSweep(x,this.pre_dt,0,Er.collisionSlopCCD)):(x.s1=t,x.s2=e,x.kinematic=w,x.s1.body.sweepFrozen||x.s2.body.sweepFrozen?(x.s1.body.sweepFrozen&&(w=x.s1,x.s1=x.s2,x.s2=w,x.frozen1=!1,x.frozen2=!0),Ie.staticSweep(x,this.pre_dt,0,Er.collisionSlopCCD)):Ie.dynamicSweep(x,this.pre_dt,0,Er.collisionSlopCCD)),i&&x.toi<0||x.failed?((i=x).next=Ee.zpp_pool,Ee.zpp_pool=i):(this.toiEvents.add(x),x.frozen1=x.s1.body.sweepFrozen,x.frozen2=x.s2.body.sweepFrozen,x.arbiter=null!=n?n.colarb:null)),n},ii.prototype.bodyCbWake=function(t){if(2==t.type&&null!=t.cbSet)if(this.midstep)for(var e=t.cbSet.bodylisteners.head;null!=e;){var i=e.elt;2==i.event?((i=this.push_callback(i)).event=2,i.body=t,e=e.next):e=e.next}else t.component.woken=!0},ii.prototype.bodyCbSleep=function(t){if(2==t.type&&null!=t.cbSet)for(var e=t.cbSet.bodylisteners.head;null!=e;){var i=e.elt;3==i.event?((i=this.push_callback(i)).event=3,i.body=t,e=e.next):e=e.next}},ii.prototype.constraintCbWake=function(t){if(null!=t.cbSet)if(this.midstep)for(var e=t.cbSet.conlisteners.head;null!=e;){var i=e.elt;2==i.event?((i=this.push_callback(i)).event=2,i.constraint=t,e=e.next):e=e.next}else t.component.woken=!0},ii.prototype.constraintCbSleep=function(t){if(null!=t.cbSet)for(var e=t.cbSet.conlisteners.head;null!=e;){var i=e.elt;3==i.event?((i=this.push_callback(i)).event=3,i.constraint=t,e=e.next):e=e.next}},ii.prototype.constraintCbBreak=function(t){if(null!=t.cbSet)for(var e=t.cbSet.conlisteners.head;null!=e;){var i=e.elt;4==i.event?((i=this.push_callback(i)).event=4,i.constraint=t,e=e.next):e=e.next}},ii.prototype.nullListenerType=function(t,e){for(var i=new Pt,n=t.interactors.head;null!=n;)i.add(n.elt),n=n.next;if(t!=e)for(var r=e.interactors.head;null!=r;)i.add(r.elt),r=r.next;for(;null!=i.head;){var o=i.pop_unsafe();if(null!=o.icompound){for(var s=o.icompound,a=s.bodies.head;null!=a;)i.add(a.elt),a=a.next;for(var h=s.compounds.head;null!=h;)i.add(h.elt),h=h.next}else for(var s=null!=o.ibody?o.ibody:o.ishape.body,l=null!=o.ishape?o.ishape:null,p=s.arbiters.head;null!=p;){var u=p.elt;if(0!=u.present)if(null==l||u.ws1==l||u.ws2==l){this.MRCA_chains(u.ws1,u.ws2);for(var d=this.mrca1.head;null!=d;){var c=d.elt;if(c.cbSet==t||c.cbSet==e){for(var y=this.mrca2.head;null!=y;){var _=y.elt;if(c.cbSet==t&&_.cbSet!=e||c.cbSet==e&&_.cbSet!=t)y=y.next;else{var m=$n.get(c,_);if(null!=m){for(;null!=m.arbiters.head;)m.arbiters.pop_unsafe().present--;this.remove_callbackset(m)}y=y.next}}d=d.next}else d=d.next}p=p.next}else p=p.next;else p=p.next}}},ii.prototype.nullInteractorType=function(t,e){if(null==e&&(e=t),null!=t.icompound){for(var i=t.icompound,n=i.bodies.head;null!=n;)this.nullInteractorType(n.elt,e),n=n.next;for(var r=i.compounds.head;null!=r;)this.nullInteractorType(r.elt,e),r=r.next}else for(var i=null!=t.ibody?t.ibody:t.ishape.body,o=null!=t.ishape?t.ishape:null,s=i.arbiters.head;null!=s;){var a=s.elt;if(0!=a.present)if(null==o||a.ws1==o||a.ws2==o){this.MRCA_chains(a.ws1,a.ws2);for(var h=this.mrca1.head;null!=h;){for(var l=h.elt,p=this.mrca2.head;null!=p;){var u=p.elt;l==e||u==e?(null!=(u=$n.get(l,u))&&(a.present--,u.remove_arb(a),null==u.arbiters.head&&this.remove_callbackset(u)),p=p.next):p=p.next}h=h.next}s=s.next}else s=s.next;else s=s.next}},ii.prototype.freshListenerType=function(t,e){for(var i=new Pt,n=t.interactors.head;null!=n;)i.add(n.elt),n=n.next;if(t!=e)for(var r=e.interactors.head;null!=r;)i.add(r.elt),r=r.next;for(;null!=i.head;){var o=i.pop_unsafe();if(null!=o.icompound){for(var s=o.icompound,a=s.bodies.head;null!=a;)i.add(a.elt),a=a.next;for(var h=s.compounds.head;null!=h;)i.add(h.elt),h=h.next}else for(var s=null!=o.ibody?o.ibody:o.ishape.body,l=null!=o.ishape?o.ishape:null,p=s.arbiters.head;null!=p;){var u=p.elt;if(u.presentable)if(null==l||u.ws1==l||u.ws2==l){this.MRCA_chains(u.ws1,u.ws2);for(var d=this.mrca1.head;null!=d;){var c=d.elt;if(c.cbSet==t||c.cbSet==e){for(var y=this.mrca2.head;null!=y;){var _=y.elt;if(c.cbSet==t&&_.cbSet!=e||c.cbSet==e&&_.cbSet!=t)y=y.next;else{var m=$n.get(c,_);null==m&&(m=tr.get(c,_),this.add_callbackset(m));for(var g,f=!1,x=m.arbiters.head;null!=x;){if(x.elt==u){f=!0;break}x=x.next}!f&&(_=m.arbiters,null==er.zpp_pool?g=new er:(g=er.zpp_pool,er.zpp_pool=g.next,g.next=null),g.elt=u,(m=g).next=_.head,_.head=m,_.modified=!0,_.length++,!0)&&u.present++,y=y.next}}d=d.next}else d=d.next}p=p.next}else p=p.next;else p=p.next}}},ii.prototype.freshInteractorType=function(t,e){if(null==e&&(e=t),null!=t.icompound){for(var i=t.icompound,n=i.bodies.head;null!=n;)this.freshInteractorType(n.elt,e),n=n.next;for(var r=i.compounds.head;null!=r;)this.freshInteractorType(r.elt,e),r=r.next}else for(var i=null!=t.ibody?t.ibody:t.ishape.body,o=null!=t.ishape?t.ishape:null,s=i.arbiters.head;null!=s;){var a=s.elt;if(a.presentable)if(null==o||a.ws1==o||a.ws2==o){this.MRCA_chains(a.ws1,a.ws2);for(var h=this.mrca1.head;null!=h;){for(var l=h.elt,p=this.mrca2.head;null!=p;){var u=p.elt;if(l==e||u==e){var d=l.cbSet,c=u.cbSet;d.validate(),c.validate();for(var y,_=null,m=(d.cbpairs.length<c.cbpairs.length?d:c).cbpairs.head;null!=m;){var g=m.elt;if(g.a==d&&g.b==c||g.a==c&&g.b==d){_=g;break}m=m.next}if(null==_&&(null==qn.zpp_pool?y=new qn:(y=qn.zpp_pool,qn.zpp_pool=y.next,y.next=null),y.zip_listeners=!0,Hn.setlt(d,c)?(y.a=d,y.b=c):(y.a=c,y.b=d),_=y,d.cbpairs.add(_),c!=d&&c.cbpairs.add(_)),_.zip_listeners&&(_.zip_listeners=!1,_.__validate()),null!=_.listeners.head){var f=$n.get(l,u);null==f&&(f=tr.get(l,u),this.add_callbackset(f));for(var x,v=!1,w=f.arbiters.head;null!=w;){if(w.elt==a){v=!0;break}w=w.next}!v&&(u=f.arbiters,null==er.zpp_pool?x=new er:(x=er.zpp_pool,er.zpp_pool=x.next,x.next=null),x.elt=a,(f=x).next=u.head,u.head=f,u.modified=!0,u.length++,!0)&&a.present++}p=p.next}else p=p.next}h=h.next}s=s.next}else s=s.next;else s=s.next}},ii.prototype.wakeCompound=function(t){for(var e=t.bodies.head;null!=e;){var i=e.elt;i.world||(i.component.waket=this.stamp+(this.midstep?0:1),3==i.type&&(i.kinematicDelaySleep=!0),i.component.sleeping&&this.really_wake(i,!1)),e=e.next}for(var n=t.constraints.head;null!=n;)this.wake_constraint(n.elt),n=n.next;for(var r=t.compounds.head;null!=r;)this.wakeCompound(r.elt),r=r.next},ii.prototype.wakeIsland=function(t){for(;null!=t.comps.head;){var e=t.comps.pop_unsafe();if(e.waket=this.stamp+(this.midstep?0:1),e.isBody){var i=e.body;this.live.add(i);for(var n=i.arbiters.head;null!=n;){var r,o,s,a,h,l,p,u,d,c=n.elt;c.sleeping&&(c.sleeping=!1,c.up_stamp+=this.stamp-c.sleep_stamp,c.type==Qe.COL?(h=c.colarb).stat?(r=this.c_arbiters_true,null==sr.zpp_pool?o=new sr:(o=sr.zpp_pool,sr.zpp_pool=o.next,o.next=null),o.elt=h,(s=o).next=r.head,r.head=s,r.modified=!0,r.length++):(p=this.c_arbiters_false,null==sr.zpp_pool?a=new sr:(a=sr.zpp_pool,sr.zpp_pool=a.next,a.next=null),a.elt=h,(h=a).next=p.head,p.head=h,p.modified=!0,p.length++):c.type==Qe.FLUID?(u=this.f_arbiters,p=c.fluidarb,null==rr.zpp_pool?l=new rr:(l=rr.zpp_pool,rr.zpp_pool=l.next,l.next=null),l.elt=p,(p=l).next=u.head,u.head=p,u.modified=!0,u.length++):(u=this.s_arbiters,c=c.sensorarb,null==or.zpp_pool?d=new or:(d=or.zpp_pool,or.zpp_pool=d.next,d.next=null),d.elt=c,(c=d).next=u.head,u.head=c,u.modified=!0,u.length++)),n=n.next}if(this.bodyCbWake(i),e.sleeping=!1,e.island=null,(e.parent=e).rank=0,1!=i.type)for(var y=i.shapes.head;null!=y;){var _=y.elt;null!=_.node&&this.bphase.sync(_),y=y.next}}else{var m,g=e.constraint,f=this.live_constraints;null==Hi.zpp_pool?m=new Hi:(m=Hi.zpp_pool,Hi.zpp_pool=m.next,m.next=null),m.elt=g;i=m;i.next=f.head,f.head=i,f.modified=!0,f.length++,this.constraintCbWake(g),e.sleeping=!1,e.island=null,(e.parent=e).rank=0}}t.next=$e.zpp_pool,$e.zpp_pool=t},ii.prototype.non_inlined_wake=function(t,e){null==e&&(e=!1),t.world||(t.component.waket=this.stamp+(this.midstep?0:1),3==t.type&&(t.kinematicDelaySleep=!0),t.component.sleeping&&this.really_wake(t,e))},ii.prototype.really_wake=function(t,e){if(null==e&&(e=!1),null==t.component.island){var i,n,r;t.component.sleeping=!1,3==t.type||1==t.type?(n=this.staticsleep,null==Xi.zpp_pool?i=new Xi:(i=Xi.zpp_pool,Xi.zpp_pool=i.next,i.next=null),i.elt=t,(i=i).next=n.head,n.head=i,n.modified=!0,n.length++):(n=this.live,null==Xi.zpp_pool?r=new Xi:(r=Xi.zpp_pool,Xi.zpp_pool=r.next,r.next=null),r.elt=t,(r=r).next=n.head,n.head=r,n.modified=!0,n.length++);for(var o=t.constraints.head;null!=o;){var s=o.elt;s.space==this&&this.wake_constraint(s),o=o.next}for(var a=t.arbiters.head;null!=a;){var h,l,p,u,d,c,y,_,m,g,f=a.elt;f.sleeping&&(f.sleeping=!1,f.up_stamp+=this.stamp+(this.midstep?0:1)-f.sleep_stamp,f.type==Qe.COL?(d=f.colarb).stat?(h=this.c_arbiters_true,null==sr.zpp_pool?l=new sr:(l=sr.zpp_pool,sr.zpp_pool=l.next,l.next=null),l.elt=d,(p=l).next=h.head,h.head=p,h.modified=!0,h.length++):(y=this.c_arbiters_false,null==sr.zpp_pool?u=new sr:(u=sr.zpp_pool,sr.zpp_pool=u.next,u.next=null),u.elt=d,(d=u).next=y.head,y.head=d,y.modified=!0,y.length++):f.type==Qe.FLUID?(m=this.f_arbiters,y=f.fluidarb,null==rr.zpp_pool?c=new rr:(c=rr.zpp_pool,rr.zpp_pool=c.next,c.next=null),c.elt=y,(y=c).next=m.head,m.head=y,m.modified=!0,m.length++):(g=this.s_arbiters,m=f.sensorarb,null==or.zpp_pool?_=new or:(_=or.zpp_pool,or.zpp_pool=_.next,_.next=null),_.elt=m,(m=_).next=g.head,g.head=m,g.modified=!0,g.length++)),f.type!=Qe.SENSOR&&!f.cleared&&f.up_stamp>=this.stamp&&0!=(1&f.immState)&&(2==f.b1.type&&f.b1.component.sleeping&&((g=f.b1).world||(g.component.waket=this.stamp+(this.midstep?0:1),3==g.type&&(g.kinematicDelaySleep=!0),g.component.sleeping&&this.really_wake(g,!1))),2==f.b2.type&&f.b2.component.sleeping&&((f=f.b2).world||(f.component.waket=this.stamp+(this.midstep?0:1),3==f.type&&(f.kinematicDelaySleep=!0),f.component.sleeping&&this.really_wake(f,!1)))),a=a.next}if(e||2!=t.type||this.bodyCbWake(t),!e&&!this.bphase.is_sweep&&1!=t.type)for(var x=t.shapes.head;null!=x;){var v=x.elt;null!=v.node&&this.bphase.sync(v),x=x.next}}else this.wakeIsland(t.component.island)},ii.prototype.wake_constraint=function(t,e){var i,n;return null==e&&(e=!1),!!t.active&&(t.component.waket=this.stamp+(this.midstep?0:1),!!t.component.sleeping&&(null==t.component.island?(t.component.sleeping=!1,i=this.live_constraints,null==Hi.zpp_pool?n=new Hi:(n=Hi.zpp_pool,Hi.zpp_pool=n.next,n.next=null),n.elt=t,(n=n).next=i.head,i.head=n,i.modified=!0,i.length++,t.wake_connected(),e||this.constraintCbWake(t)):this.wakeIsland(t.component.island),!0))},ii.prototype.doForests=function(t){for(var e=this.c_arbiters_false.head;null!=e;){var i,n,r=e.elt;if(!r.cleared&&r.up_stamp==this.stamp&&0!=(1&r.immState)&&2==r.b1.type&&2==r.b2.type){if(r.b1.component==r.b1.component.parent)i=r.b1.component;else{for(var o=r.b1.component,s=null;o!=o.parent;){var a=o.parent;o.parent=s,s=o,o=a}for(;null!=s;){var h=s.parent;s.parent=o,s=h}i=o}if(r.b2.component==r.b2.component.parent)n=r.b2.component;else{for(var l=r.b2.component,p=null;l!=l.parent;){var u=l.parent;l.parent=p,p=l,l=u}for(;null!=p;){var d=p.parent;p.parent=l,p=d}n=l}i!=n&&(i.rank<n.rank?i.parent=n:i.rank>n.rank?n.parent=i:(n.parent=i).rank++)}e=e.next}for(var c=this.f_arbiters.head;null!=c;){var y,_,m=c.elt;if(!m.cleared&&m.up_stamp==this.stamp&&0!=(1&m.immState)&&2==m.b1.type&&2==m.b2.type){if(m.b1.component==m.b1.component.parent)y=m.b1.component;else{for(var g=m.b1.component,f=null;g!=g.parent;){var x=g.parent;g.parent=f,f=g,g=x}for(;null!=f;){var v=f.parent;f.parent=g,f=v}y=g}if(m.b2.component==m.b2.component.parent)_=m.b2.component;else{for(var w=m.b2.component,z=null;w!=w.parent;){var b=w.parent;w.parent=z,z=w,w=b}for(;null!=z;){var S=z.parent;z.parent=w,z=S}_=w}y!=_&&(y.rank<_.rank?y.parent=_:y.rank>_.rank?_.parent=y:(_.parent=y).rank++)}c=c.next}for(var C=this.live_constraints.head;null!=C;)C.elt.forest(),C=C.next;for(;null!=this.live.head;){var P=this.live,M=P.head.elt;P.pop();var T,P=M.component;if(P==P.parent)T=P;else{for(var A=P,k=null;A!=A.parent;){var O=A.parent;A.parent=k,k=A,A=O}for(;null!=k;){var E=k.parent;k.parent=A,k=E}T=A}null==T.island&&(null==$e.zpp_pool?T.island=new $e:(T.island=$e.zpp_pool,$e.zpp_pool=T.island.next,T.island.next=null),T.island.waket=0,D=this.islands,(G=T.island)._inuse=!0,G.next=D.next,D.next=G,D.modified=!0,D.length++,T.island.sleep=!0),P.island=T.island;var I,G=P.island.comps;null==yn.zpp_pool?I=new yn:(I=yn.zpp_pool,yn.zpp_pool=I.next,I.next=null),I.elt=P;var D=I;D.next=G.head,G.head=D,G.modified=!0,G.length++;M=M.atRest(t);P.island.sleep=P.island.sleep&&M,P.waket>P.island.waket&&(P.island.waket=P.waket)}for(;null!=this.live_constraints.head;){var L=this.live_constraints,B=L.head.elt;L.pop();var R,F=B.component;if(F==F.parent)R=F;else{for(var N=F,j=null;N!=N.parent;){var U=N.parent;N.parent=j,j=N,N=U}for(;null!=j;){var V=j.parent;j.parent=N,j=V}R=N}F.island=R.island;var W,L=F.island.comps;null==yn.zpp_pool?W=new yn:(W=yn.zpp_pool,yn.zpp_pool=W.next,W.next=null),W.elt=F;B=W;B.next=L.head,L.head=B,L.modified=!0,L.length++,F.waket>F.island.waket&&(F.island.waket=F.waket)}for(;null!=this.islands.next;){var X=this.islands,H=X.next;if(X.pop(),H.sleep)for(var q=H.comps.head;null!=q;){var Y=q.elt;if(Y.isBody){var K=Y.body;K.velx=0,K.vely=0,K.angvel=0,Y.sleeping=!0;for(var Z=K.shapes.head;null!=Z;)this.bphase.sync(Z.elt),Z=Z.next;this.bodyCbSleep(K)}else this.constraintCbSleep(Y.constraint),Y.sleeping=!0;q=q.next}else{for(;null!=H.comps.head;){var J,Q,$,tt,et=H.comps,it=et.head.elt;et.pop(),it.waket=H.waket,it.isBody?(tt=this.live,Q=it.body,null==Xi.zpp_pool?J=new Xi:(J=Xi.zpp_pool,Xi.zpp_pool=J.next,J.next=null),J.elt=Q,(Q=J).next=tt.head,tt.head=Q,tt.modified=!0,tt.length++):(Q=this.live_constraints,tt=it.constraint,null==Hi.zpp_pool?$=new Hi:($=Hi.zpp_pool,Hi.zpp_pool=$.next,$.next=null),$.elt=tt,(tt=$).next=Q.head,Q.head=tt,Q.modified=!0,Q.length++),it.sleeping=!1,it.island=null,(it.parent=it).rank=0}H.next=$e.zpp_pool,$e.zpp_pool=H}}},ii.prototype.sleepArbiters=function(){var t=null,e=this.c_arbiters_true,i=e.head,n=null!=this.c_arbiters_false;for(n&&null==i&&(n=!1,i=this.c_arbiters_false.head,e=this.c_arbiters_false,t=null);null!=i;){var r,o,s=i.elt;s.b1.component.sleeping&&s.b2.component.sleeping?(s.sleep_stamp=this.stamp,s.sleeping=!0,null==t?(o=(r=e.head).next,e.head=o,null==e.head&&(e.pushmod=!0)):(o=(r=t.next).next,null==(t.next=o)&&(e.pushmod=!0)),(s=r).elt=null,s.next=sr.zpp_pool,sr.zpp_pool=s,e.modified=!0,e.length--,e.pushmod=!0,i=o,n&&null==i&&(n=!1,i=this.c_arbiters_false.head,e=this.c_arbiters_false,t=null)):(i=(t=i).next,n&&null==i&&(n=!1,i=this.c_arbiters_false.head,e=this.c_arbiters_false,t=null))}for(var a=null,h=this.f_arbiters,l=h.head;null!=l;){var p,u,d=l.elt;d.b1.component.sleeping&&d.b2.component.sleeping?(d.sleep_stamp=this.stamp,d.sleeping=!0,null==a?(u=(p=h.head).next,h.head=u,null==h.head&&(h.pushmod=!0)):(u=(p=a.next).next,null==(a.next=u)&&(h.pushmod=!0)),(d=p).elt=null,d.next=rr.zpp_pool,rr.zpp_pool=d,h.modified=!0,h.length--,h.pushmod=!0,l=u):l=(a=l).next}for(var c=null,y=this.s_arbiters,_=y.head;null!=_;){var m,g,f=_.elt;f.b1.component.sleeping&&f.b2.component.sleeping?(f.sleep_stamp=this.stamp,f.sleeping=!0,null==c?(g=(m=y.head).next,y.head=g,null==y.head&&(y.pushmod=!0)):(g=(m=c.next).next,null==(c.next=g)&&(y.pushmod=!0)),(f=m).elt=null,f.next=or.zpp_pool,or.zpp_pool=f,y.modified=!0,y.length--,y.pushmod=!0,_=g):_=(c=_).next}},ii.prototype.static_validation=function(t){if(null!=t.shapes.head&&t.zip_aabb){t.zip_aabb=!1,t.aabb.minx=1/0,t.aabb.miny=1/0,t.aabb.maxx=-1/0,t.aabb.maxy=-1/0;for(var e=t.shapes.head;null!=e;){var i=e.elt;if(i.zip_aabb&&null!=i.body)if(i.zip_aabb=!1,0==i.type){var n=i.circle;if(n.zip_worldCOM&&null!=n.body){if(n.zip_worldCOM=!1,n.zip_localCOM){if(n.zip_localCOM=!1,1==n.type){var r=n.polygon;if(null==r.lverts.next.next)r.localCOMx=r.lverts.next.x,r.localCOMy=r.lverts.next.y;else if(null==r.lverts.next.next.next)r.localCOMx=r.lverts.next.x,r.localCOMy=r.lverts.next.y,r.localCOMx+=r.lverts.next.next.x,r.localCOMy+=r.lverts.next.next.y,r.localCOMx*=.5,r.localCOMy*=.5;else{r.localCOMx=0;var o=r.localCOMy=0,s=r.lverts.next,a=s,h=s=s.next;for(s=s.next;null!=s;){var l=s;o+=h.x*(l.y-a.y);var p=l.y*h.x-l.x*h.y;r.localCOMx+=(h.x+l.x)*p,r.localCOMy+=(h.y+l.y)*p,a=h,h=l,s=s.next}var u=s=r.lverts.next;o+=h.x*(u.y-a.y);var d=u.y*h.x-u.x*h.y;r.localCOMx+=(h.x+u.x)*d,r.localCOMy+=(h.y+u.y)*d;var a=h,c=s=s.next;o+=u.x*(c.y-a.y);d=c.y*u.x-c.x*u.y;r.localCOMx+=(u.x+c.x)*d,r.localCOMy+=(u.y+c.y)*d;c=o=1/(3*o);r.localCOMx*=c,r.localCOMy*=c}}null!=n.wrap_localCOM&&(n.wrap_localCOM.zpp_inner.x=n.localCOMx,n.wrap_localCOM.zpp_inner.y=n.localCOMy)}d=n.body;d.zip_axis&&(d.zip_axis=!1,d.axisx=Math.sin(d.rot),d.axisy=Math.cos(d.rot)),n.worldCOMx=n.body.posx+(n.body.axisy*n.localCOMx-n.body.axisx*n.localCOMy),n.worldCOMy=n.body.posy+(n.localCOMx*n.body.axisx+n.localCOMy*n.body.axisy)}c=n.radius,d=n.radius;n.aabb.minx=n.worldCOMx-c,n.aabb.miny=n.worldCOMy-d,n.aabb.maxx=n.worldCOMx+c,n.aabb.maxy=n.worldCOMy+d}else{var y=i.polygon;if(y.zip_gverts&&null!=y.body){y.zip_gverts=!1,y.validate_lverts();var _=y.body;_.zip_axis&&(_.zip_axis=!1,_.axisx=Math.sin(_.rot),_.axisy=Math.cos(_.rot));for(var m=y.lverts.next,g=y.gverts.next;null!=g;){var f=g,x=m,m=m.next;f.x=y.body.posx+(y.body.axisy*x.x-y.body.axisx*x.y),f.y=y.body.posy+(x.x*y.body.axisx+x.y*y.body.axisy),g=g.next}}_=y.gverts.next;y.aabb.minx=_.x,y.aabb.miny=_.y,y.aabb.maxx=_.x,y.aabb.maxy=_.y;for(var v=y.gverts.next.next;null!=v;){var w=v;w.x<y.aabb.minx&&(y.aabb.minx=w.x),w.x>y.aabb.maxx&&(y.aabb.maxx=w.x),w.y<y.aabb.miny&&(y.aabb.miny=w.y),w.y>y.aabb.maxy&&(y.aabb.maxy=w.y),v=v.next}}_=t.aabb,i=i.aabb;i.minx<_.minx&&(_.minx=i.minx),i.maxx>_.maxx&&(_.maxx=i.maxx),i.miny<_.miny&&(_.miny=i.miny),i.maxy>_.maxy&&(_.maxy=i.maxy),e=e.next}}t.validate_mass(),t.validate_inertia();for(var z=t.shapes.head;null!=z;){var b=z.elt;if(1==b.type){var S=b.polygon;S.zip_sanitation&&(S.zip_sanitation=!1,S.splice_collinear_real());var C=b.polygon;if(C.zip_gaxi&&null!=C.body){C.zip_gaxi=!1,C.validate_laxi();b=C.body;if(b.zip_axis&&(b.zip_axis=!1,b.axisx=Math.sin(b.rot),b.axisy=Math.cos(b.rot)),C.zip_gverts&&null!=C.body){C.zip_gverts=!1,C.validate_lverts();var P=C.body;P.zip_axis&&(P.zip_axis=!1,P.axisx=Math.sin(P.rot),P.axisy=Math.cos(P.rot));for(var M=C.lverts.next,T=C.gverts.next;null!=T;){var A=T,k=M,M=M.next;A.x=C.body.posx+(C.body.axisy*k.x-C.body.axisx*k.y),A.y=C.body.posy+(k.x*C.body.axisx+k.y*C.body.axisy),T=T.next}}for(var O=C.edges.head,E=I=C.gverts.next,I=I.next;null!=I;){var G=I,D=O.elt,O=O.next;D.gp0=E,D.gp1=G,D.gnormx=C.body.axisy*D.lnormx-C.body.axisx*D.lnormy,D.gnormy=D.lnormx*C.body.axisx+D.lnormy*C.body.axisy,D.gprojection=C.body.posx*D.gnormx+C.body.posy*D.gnormy+D.lprojection,null!=D.wrap_gnorm&&(D.wrap_gnorm.zpp_inner.x=D.gnormx,D.wrap_gnorm.zpp_inner.y=D.gnormy),D.tp0=D.gp0.y*D.gnormx-D.gp0.x*D.gnormy,D.tp1=D.gp1.y*D.gnormx-D.gp1.x*D.gnormy,E=G,I=I.next}P=O.elt;P.gp0=E,P.gp1=C.gverts.next,P.gnormx=C.body.axisy*P.lnormx-C.body.axisx*P.lnormy,P.gnormy=P.lnormx*C.body.axisx+P.lnormy*C.body.axisy,P.gprojection=C.body.posx*P.gnormx+C.body.posy*P.gnormy+P.lprojection,null!=P.wrap_gnorm&&(P.wrap_gnorm.zpp_inner.x=P.gnormx,P.wrap_gnorm.zpp_inner.y=P.gnormy),P.tp0=P.gp0.y*P.gnormx-P.gp0.x*P.gnormy,P.tp1=P.gp1.y*P.gnormx-P.gp1.x*P.gnormy}}z=z.next}t.sweepFrozen=!0},ii.prototype.validation=function(){var t=this.cbsets;if(!t.cbsets.empty()){for(var e=t.cbsets.parent;null!=e.prev;)e=e.prev;for(;null!=e;)if(e.data.validate(),null!=e.next)for(e=e.next;null!=e.prev;)e=e.prev;else{for(;null!=e.parent&&e==e.parent.next;)e=e.parent;e=e.parent}}for(var i=this.live.head;null!=i;){var n=i.elt;n.sweepRadius=0;for(var r=n.shapes.head;null!=r;){var o=r.elt;if(1==o.type){var s=o.polygon;s.zip_sanitation&&(s.zip_sanitation=!1,s.splice_collinear_real());var a=o.polygon;if(a.zip_gaxi&&null!=a.body){a.zip_gaxi=!1,a.validate_laxi();s=a.body;if(s.zip_axis&&(s.zip_axis=!1,s.axisx=Math.sin(s.rot),s.axisy=Math.cos(s.rot)),a.zip_gverts&&null!=a.body){a.zip_gverts=!1,a.validate_lverts();var h=a.body;h.zip_axis&&(h.zip_axis=!1,h.axisx=Math.sin(h.rot),h.axisy=Math.cos(h.rot));for(var l=a.lverts.next,p=a.gverts.next;null!=p;){var u=p,d=l,l=l.next;u.x=a.body.posx+(a.body.axisy*d.x-a.body.axisx*d.y),u.y=a.body.posy+(d.x*a.body.axisx+d.y*a.body.axisy),p=p.next}}for(var c=a.edges.head,y=_=a.gverts.next,_=_.next;null!=_;){var m=_,g=c.elt,c=c.next;g.gp0=y,g.gp1=m,g.gnormx=a.body.axisy*g.lnormx-a.body.axisx*g.lnormy,g.gnormy=g.lnormx*a.body.axisx+g.lnormy*a.body.axisy,g.gprojection=a.body.posx*g.gnormx+a.body.posy*g.gnormy+g.lprojection,null!=g.wrap_gnorm&&(g.wrap_gnorm.zpp_inner.x=g.gnormx,g.wrap_gnorm.zpp_inner.y=g.gnormy),g.tp0=g.gp0.y*g.gnormx-g.gp0.x*g.gnormy,g.tp1=g.gp1.y*g.gnormx-g.gp1.x*g.gnormy,y=m,_=_.next}h=c.elt;h.gp0=y,h.gp1=a.gverts.next,h.gnormx=a.body.axisy*h.lnormx-a.body.axisx*h.lnormy,h.gnormy=h.lnormx*a.body.axisx+h.lnormy*a.body.axisy,h.gprojection=a.body.posx*h.gnormx+a.body.posy*h.gnormy+h.lprojection,null!=h.wrap_gnorm&&(h.wrap_gnorm.zpp_inner.x=h.gnormx,h.wrap_gnorm.zpp_inner.y=h.gnormy),h.tp0=h.gp0.y*h.gnormx-h.gp0.x*h.gnormy,h.tp1=h.gp1.y*h.gnormx-h.gp1.x*h.gnormy}}o.validate_sweepRadius(),o.sweepRadius>n.sweepRadius&&(n.sweepRadius=o.sweepRadius),r=r.next}if(n.validate_mass(),n.validate_inertia(),null!=n.shapes.head){if(n.zip_aabb){n.zip_aabb=!1,n.aabb.minx=1/0,n.aabb.miny=1/0,n.aabb.maxx=-1/0,n.aabb.maxy=-1/0;for(var f=n.shapes.head;null!=f;){var x=f.elt;if(x.zip_aabb&&null!=x.body)if(x.zip_aabb=!1,0==x.type){var v=x.circle;if(v.zip_worldCOM&&null!=v.body){if(v.zip_worldCOM=!1,v.zip_localCOM){if(v.zip_localCOM=!1,1==v.type){var w=v.polygon;if(null==w.lverts.next.next)w.localCOMx=w.lverts.next.x,w.localCOMy=w.lverts.next.y;else if(null==w.lverts.next.next.next)w.localCOMx=w.lverts.next.x,w.localCOMy=w.lverts.next.y,w.localCOMx+=w.lverts.next.next.x,w.localCOMy+=w.lverts.next.next.y,w.localCOMx*=.5,w.localCOMy*=.5;else{w.localCOMx=0;var z=w.localCOMy=0,b=w.lverts.next,S=b,C=b=b.next;for(b=b.next;null!=b;){var P=b;z+=C.x*(P.y-S.y);var M=P.y*C.x-P.x*C.y;w.localCOMx+=(C.x+P.x)*M,w.localCOMy+=(C.y+P.y)*M,S=C,C=P,b=b.next}var T=b=w.lverts.next;z+=C.x*(T.y-S.y);var A=T.y*C.x-T.x*C.y;w.localCOMx+=(C.x+T.x)*A,w.localCOMy+=(C.y+T.y)*A;var S=C,k=b=b.next;z+=T.x*(k.y-S.y);A=k.y*T.x-k.x*T.y;w.localCOMx+=(T.x+k.x)*A,w.localCOMy+=(T.y+k.y)*A;k=z=1/(3*z);w.localCOMx*=k,w.localCOMy*=k}}null!=v.wrap_localCOM&&(v.wrap_localCOM.zpp_inner.x=v.localCOMx,v.wrap_localCOM.zpp_inner.y=v.localCOMy)}A=v.body;A.zip_axis&&(A.zip_axis=!1,A.axisx=Math.sin(A.rot),A.axisy=Math.cos(A.rot)),v.worldCOMx=v.body.posx+(v.body.axisy*v.localCOMx-v.body.axisx*v.localCOMy),v.worldCOMy=v.body.posy+(v.localCOMx*v.body.axisx+v.localCOMy*v.body.axisy)}k=v.radius,A=v.radius;v.aabb.minx=v.worldCOMx-k,v.aabb.miny=v.worldCOMy-A,v.aabb.maxx=v.worldCOMx+k,v.aabb.maxy=v.worldCOMy+A}else{var O=x.polygon;if(O.zip_gverts&&null!=O.body){O.zip_gverts=!1,O.validate_lverts();var E=O.body;E.zip_axis&&(E.zip_axis=!1,E.axisx=Math.sin(E.rot),E.axisy=Math.cos(E.rot));for(var I=O.lverts.next,G=O.gverts.next;null!=G;){var D=G,L=I,I=I.next;D.x=O.body.posx+(O.body.axisy*L.x-O.body.axisx*L.y),D.y=O.body.posy+(L.x*O.body.axisx+L.y*O.body.axisy),G=G.next}}E=O.gverts.next;O.aabb.minx=E.x,O.aabb.miny=E.y,O.aabb.maxx=E.x,O.aabb.maxy=E.y;for(var B=O.gverts.next.next;null!=B;){var R=B;R.x<O.aabb.minx&&(O.aabb.minx=R.x),R.x>O.aabb.maxx&&(O.aabb.maxx=R.x),R.y<O.aabb.miny&&(O.aabb.miny=R.y),R.y>O.aabb.maxy&&(O.aabb.maxy=R.y),B=B.next}}E=n.aabb,x=x.aabb;x.minx<E.minx&&(E.minx=x.minx),x.maxx>E.maxx&&(E.maxx=x.maxx),x.miny<E.miny&&(E.miny=x.miny),x.maxy>E.maxy&&(E.maxy=x.maxy),f=f.next}}n.validate_worldCOM()}if(n.validate_gravMass(),n.zip_axis&&(n.zip_axis=!1,n.axisx=Math.sin(n.rot),n.axisy=Math.cos(n.rot)),n.component.woken&&null!=n.cbSet)for(var F=n.cbSet.bodylisteners.head;null!=F;){var N=F.elt;2==N.event?((N=this.push_callback(N)).event=2,N.body=n,F=F.next):F=F.next}n.component.woken=!1;for(var j=n.shapes.head;null!=j;)this.bphase.sync(j.elt),j=j.next;i=i.next}for(var U=this.kinematics.head;null!=U;){var V=U.elt;V.sweepRadius=0;for(var W=V.shapes.head;null!=W;){var X=W.elt;if(1==X.type){var H=X.polygon;H.zip_sanitation&&(H.zip_sanitation=!1,H.splice_collinear_real());var q=X.polygon;if(q.zip_gaxi&&null!=q.body){q.zip_gaxi=!1,q.validate_laxi();H=q.body;if(H.zip_axis&&(H.zip_axis=!1,H.axisx=Math.sin(H.rot),H.axisy=Math.cos(H.rot)),q.zip_gverts&&null!=q.body){q.zip_gverts=!1,q.validate_lverts();var Y=q.body;Y.zip_axis&&(Y.zip_axis=!1,Y.axisx=Math.sin(Y.rot),Y.axisy=Math.cos(Y.rot));for(var K=q.lverts.next,Z=q.gverts.next;null!=Z;){var J=Z,Q=K,K=K.next;J.x=q.body.posx+(q.body.axisy*Q.x-q.body.axisx*Q.y),J.y=q.body.posy+(Q.x*q.body.axisx+Q.y*q.body.axisy),Z=Z.next}}for(var $=q.edges.head,tt=et=q.gverts.next,et=et.next;null!=et;){var it=et,nt=$.elt,$=$.next;nt.gp0=tt,nt.gp1=it,nt.gnormx=q.body.axisy*nt.lnormx-q.body.axisx*nt.lnormy,nt.gnormy=nt.lnormx*q.body.axisx+nt.lnormy*q.body.axisy,nt.gprojection=q.body.posx*nt.gnormx+q.body.posy*nt.gnormy+nt.lprojection,null!=nt.wrap_gnorm&&(nt.wrap_gnorm.zpp_inner.x=nt.gnormx,nt.wrap_gnorm.zpp_inner.y=nt.gnormy),nt.tp0=nt.gp0.y*nt.gnormx-nt.gp0.x*nt.gnormy,nt.tp1=nt.gp1.y*nt.gnormx-nt.gp1.x*nt.gnormy,tt=it,et=et.next}Y=$.elt;Y.gp0=tt,Y.gp1=q.gverts.next,Y.gnormx=q.body.axisy*Y.lnormx-q.body.axisx*Y.lnormy,Y.gnormy=Y.lnormx*q.body.axisx+Y.lnormy*q.body.axisy,Y.gprojection=q.body.posx*Y.gnormx+q.body.posy*Y.gnormy+Y.lprojection,null!=Y.wrap_gnorm&&(Y.wrap_gnorm.zpp_inner.x=Y.gnormx,Y.wrap_gnorm.zpp_inner.y=Y.gnormy),Y.tp0=Y.gp0.y*Y.gnormx-Y.gp0.x*Y.gnormy,Y.tp1=Y.gp1.y*Y.gnormx-Y.gp1.x*Y.gnormy}}X.validate_sweepRadius(),X.sweepRadius>V.sweepRadius&&(V.sweepRadius=X.sweepRadius),W=W.next}if(V.validate_mass(),V.validate_inertia(),null!=V.shapes.head){if(V.zip_aabb){V.zip_aabb=!1,V.aabb.minx=1/0,V.aabb.miny=1/0,V.aabb.maxx=-1/0,V.aabb.maxy=-1/0;for(var rt=V.shapes.head;null!=rt;){var ot=rt.elt;if(ot.zip_aabb&&null!=ot.body)if(ot.zip_aabb=!1,0==ot.type){var st=ot.circle;if(st.zip_worldCOM&&null!=st.body){if(st.zip_worldCOM=!1,st.zip_localCOM){if(st.zip_localCOM=!1,1==st.type){var at=st.polygon;if(null==at.lverts.next.next)at.localCOMx=at.lverts.next.x,at.localCOMy=at.lverts.next.y;else if(null==at.lverts.next.next.next)at.localCOMx=at.lverts.next.x,at.localCOMy=at.lverts.next.y,at.localCOMx+=at.lverts.next.next.x,at.localCOMy+=at.lverts.next.next.y,at.localCOMx*=.5,at.localCOMy*=.5;else{at.localCOMx=0;var ht=at.localCOMy=0,lt=at.lverts.next,pt=lt,ut=lt=lt.next;for(lt=lt.next;null!=lt;){var dt=lt;ht+=ut.x*(dt.y-pt.y);var ct=dt.y*ut.x-dt.x*ut.y;at.localCOMx+=(ut.x+dt.x)*ct,at.localCOMy+=(ut.y+dt.y)*ct,pt=ut,ut=dt,lt=lt.next}var yt=lt=at.lverts.next;ht+=ut.x*(yt.y-pt.y);var _t=yt.y*ut.x-yt.x*ut.y;at.localCOMx+=(ut.x+yt.x)*_t,at.localCOMy+=(ut.y+yt.y)*_t;var pt=ut,mt=lt=lt.next;ht+=yt.x*(mt.y-pt.y);_t=mt.y*yt.x-mt.x*yt.y;at.localCOMx+=(yt.x+mt.x)*_t,at.localCOMy+=(yt.y+mt.y)*_t;mt=ht=1/(3*ht);at.localCOMx*=mt,at.localCOMy*=mt}}null!=st.wrap_localCOM&&(st.wrap_localCOM.zpp_inner.x=st.localCOMx,st.wrap_localCOM.zpp_inner.y=st.localCOMy)}_t=st.body;_t.zip_axis&&(_t.zip_axis=!1,_t.axisx=Math.sin(_t.rot),_t.axisy=Math.cos(_t.rot)),st.worldCOMx=st.body.posx+(st.body.axisy*st.localCOMx-st.body.axisx*st.localCOMy),st.worldCOMy=st.body.posy+(st.localCOMx*st.body.axisx+st.localCOMy*st.body.axisy)}mt=st.radius,_t=st.radius;st.aabb.minx=st.worldCOMx-mt,st.aabb.miny=st.worldCOMy-_t,st.aabb.maxx=st.worldCOMx+mt,st.aabb.maxy=st.worldCOMy+_t}else{var gt=ot.polygon;if(gt.zip_gverts&&null!=gt.body){gt.zip_gverts=!1,gt.validate_lverts();var ft=gt.body;ft.zip_axis&&(ft.zip_axis=!1,ft.axisx=Math.sin(ft.rot),ft.axisy=Math.cos(ft.rot));for(var xt=gt.lverts.next,vt=gt.gverts.next;null!=vt;){var wt=vt,zt=xt,xt=xt.next;wt.x=gt.body.posx+(gt.body.axisy*zt.x-gt.body.axisx*zt.y),wt.y=gt.body.posy+(zt.x*gt.body.axisx+zt.y*gt.body.axisy),vt=vt.next}}ft=gt.gverts.next;gt.aabb.minx=ft.x,gt.aabb.miny=ft.y,gt.aabb.maxx=ft.x,gt.aabb.maxy=ft.y;for(var bt=gt.gverts.next.next;null!=bt;){var St=bt;St.x<gt.aabb.minx&&(gt.aabb.minx=St.x),St.x>gt.aabb.maxx&&(gt.aabb.maxx=St.x),St.y<gt.aabb.miny&&(gt.aabb.miny=St.y),St.y>gt.aabb.maxy&&(gt.aabb.maxy=St.y),bt=bt.next}}ft=V.aabb,ot=ot.aabb;ot.minx<ft.minx&&(ft.minx=ot.minx),ot.maxx>ft.maxx&&(ft.maxx=ot.maxx),ot.miny<ft.miny&&(ft.miny=ot.miny),ot.maxy>ft.maxy&&(ft.maxy=ot.maxy),rt=rt.next}}V.validate_worldCOM()}V.validate_gravMass(),V.zip_axis&&(V.zip_axis=!1,V.axisx=Math.sin(V.rot),V.axisy=Math.cos(V.rot));for(var Ct=V.shapes.head;null!=Ct;)this.bphase.sync(Ct.elt),Ct=Ct.next;U=U.next}for(var Pt=this.live_constraints.head;null!=Pt;){var Mt=Pt.elt;if(Mt.active){if(Mt.component.woken&&null!=Mt.cbSet)for(var Tt=Mt.cbSet.conlisteners.head;null!=Tt;){var At=Tt.elt;2==At.event?((At=this.push_callback(At)).event=2,At.constraint=Mt,Tt=Tt.next):Tt=Tt.next}Mt.component.woken=!1}Pt=Pt.next}},ii.prototype.updateVel=function(t){for(var e=1-t*this.global_lin_drag,i=1-t*this.global_ang_drag,n=this.live.head;null!=n;){var r,o,s=n.elt;0!=s.smass&&(o=t*s.imass,s.velx=e*s.velx+(s.forcex+this.gravityx*s.gravMass)*o,s.vely=e*s.vely+(s.forcey+this.gravityy*s.gravMass)*o),0!=s.sinertia&&(o=r=0,r=s.worldCOMx-s.posx,o=s.worldCOMy-s.posy,s.angvel=i*s.angvel+(s.torque+(this.gravityy*r-this.gravityx*o)*s.gravMass)*t*s.iinertia),n=n.next}},ii.prototype.updatePos=function(t){for(var e=2*Math.PI/t,i=this.live.head;null!=i;){var n=i.elt;n.pre_posx=n.posx,n.pre_posy=n.posy,n.pre_rot=n.rot,n.sweepTime=0,n.sweep_angvel=n.angvel%e;var r,o=t-n.sweepTime;if(0!=o&&(n.sweepTime=t,n.posx+=n.velx*o,n.posy+=n.vely*o,0!=n.angvel&&(r=n.sweep_angvel*o,n.rot+=r,1e-4<r*r?(n.axisx=Math.sin(n.rot),n.axisy=Math.cos(n.rot)):(a=((o=1-.5*(a=r*r))*n.axisx+r*n.axisy)*(s=1-a*a/8),n.axisy=(o*n.axisy-r*n.axisx)*s,n.axisx=a))),n.disableCCD)n.sweepFrozen=!0,n.bullet=!1;else{var s=Er.staticCCDLinearThreshold*n.sweepRadius,a=Er.staticCCDAngularThreshold;if((n.velx*n.velx+n.vely*n.vely)*t*t>s*s||n.angvel*n.angvel*t*t>a*a||3==n.type){for(var h=n.sweep_angvel,l=1/(h=h<0?-h:h),p=n.shapes.head;null!=p;){var u,d,c=p.elt,y=c.aabb,_=y.minx,m=y.miny,g=y.maxx,f=y.maxy,x=h*t*c.sweepCoef*.008333333333333333|0,v=h*t/(x=8<x?8:x),w=t-n.sweepTime;if(0!=w&&(n.sweepTime=t,n.posx+=n.velx*w,n.posy+=n.vely*w,0!=n.angvel&&(u=n.sweep_angvel*w,n.rot+=u,1e-4<u*u?(n.axisx=Math.sin(n.rot),n.axisy=Math.cos(n.rot)):(C=((d=1-.5*(C=u*u))*n.axisx+u*n.axisy)*(w=1-C*C/8),n.axisy=(d*n.axisy-u*n.axisx)*w,n.axisx=C))),0==c.type){var z=c.circle;z.worldCOMx=z.body.posx+(z.body.axisy*z.localCOMx-z.body.axisx*z.localCOMy),z.worldCOMy=z.body.posy+(z.localCOMx*z.body.axisx+z.localCOMy*z.body.axisy),z.aabb.minx=z.worldCOMx-z.radius,z.aabb.miny=z.worldCOMy-z.radius,z.aabb.maxx=z.worldCOMx+z.radius,z.aabb.maxy=z.worldCOMy+z.radius}else{var b=c.polygon,S=b.lverts.next,C=b.gverts.next,z=S;S=S.next,C.x=b.body.posx+(b.body.axisy*z.x-b.body.axisx*z.y),C.y=b.body.posy+(z.x*b.body.axisx+z.y*b.body.axisy),b.aabb.minx=C.x,b.aabb.miny=C.y,b.aabb.maxx=C.x,b.aabb.maxy=C.y;for(var P=b.gverts.next.next;null!=P;){var M=P,T=S,S=S.next;M.x=b.body.posx+(b.body.axisy*T.x-b.body.axisx*T.y),M.y=b.body.posy+(T.x*b.body.axisx+T.y*b.body.axisy),M.x<b.aabb.minx&&(b.aabb.minx=M.x),M.x>b.aabb.maxx&&(b.aabb.maxx=M.x),M.y<b.aabb.miny&&(b.aabb.miny=M.y),M.y>b.aabb.maxy&&(b.aabb.maxy=M.y),P=P.next}}_<y.minx?y.minx=_:_=y.minx,m<y.miny?y.miny=m:m=y.miny,g>y.maxx?y.maxx=g:g=y.maxx,f>y.maxy?y.maxy=f:f=y.maxy;for(var A=1,k=x;A<k;){var O,E=v*A++*l,I=E-n.sweepTime;if(0!=I&&(n.sweepTime=E,n.posx+=n.velx*I,n.posy+=n.vely*I,0!=n.angvel&&(O=n.sweep_angvel*I,n.rot+=O,1e-4<O*O?(n.axisx=Math.sin(n.rot),n.axisy=Math.cos(n.rot)):(B=((E=1-.5*(B=O*O))*n.axisx+O*n.axisy)*(I=1-B*B/8),n.axisy=(E*n.axisy-O*n.axisx)*I,n.axisx=B))),0==c.type){var G=c.circle;G.worldCOMx=G.body.posx+(G.body.axisy*G.localCOMx-G.body.axisx*G.localCOMy),G.worldCOMy=G.body.posy+(G.localCOMx*G.body.axisx+G.localCOMy*G.body.axisy),G.aabb.minx=G.worldCOMx-G.radius,G.aabb.miny=G.worldCOMy-G.radius,G.aabb.maxx=G.worldCOMx+G.radius,G.aabb.maxy=G.worldCOMy+G.radius}else{var D=c.polygon,L=D.lverts.next,B=D.gverts.next,G=L;L=L.next,B.x=D.body.posx+(D.body.axisy*G.x-D.body.axisx*G.y),B.y=D.body.posy+(G.x*D.body.axisx+G.y*D.body.axisy),D.aabb.minx=B.x,D.aabb.miny=B.y,D.aabb.maxx=B.x,D.aabb.maxy=B.y;for(var R=D.gverts.next.next;null!=R;){var F=R,N=L,L=L.next;F.x=D.body.posx+(D.body.axisy*N.x-D.body.axisx*N.y),F.y=D.body.posy+(N.x*D.body.axisx+N.y*D.body.axisy),F.x<D.aabb.minx&&(D.aabb.minx=F.x),F.x>D.aabb.maxx&&(D.aabb.maxx=F.x),F.y<D.aabb.miny&&(D.aabb.miny=F.y),F.y>D.aabb.maxy&&(D.aabb.maxy=F.y),R=R.next}}_<y.minx?y.minx=_:_=y.minx,m<y.miny?y.miny=m:m=y.miny,g>y.maxx?y.maxx=g:g=y.maxx,f>y.maxy?y.maxy=f:f=y.maxy}this.bphase.sync(c),p=p.next}n.sweepFrozen=!1,2==n.type&&n.bulletEnabled&&(s=Er.bulletCCDLinearThreshold*n.sweepRadius,a=Er.bulletCCDAngularThreshold,((n.velx*n.velx+n.vely*n.vely)*t*t>s*s||n.angvel*n.angvel*t*t>a*a)&&(n.bullet=!0))}else n.sweepFrozen=!0,n.bullet=!1}i=i.next}for(var j=this.kinematics.head;null!=j;){var U=j.elt;U.pre_posx=U.posx,U.pre_posy=U.posy,U.pre_rot=U.rot,U.sweepTime=0,U.sweep_angvel=U.angvel%e;var V,W=t-U.sweepTime;if(0!=W&&(U.sweepTime=t,U.posx+=U.velx*W,U.posy+=U.vely*W,0!=U.angvel&&(V=U.sweep_angvel*W,U.rot+=V,1e-4<V*V?(U.axisx=Math.sin(U.rot),U.axisy=Math.cos(U.rot)):(H=((W=1-.5*(H=V*V))*U.axisx+V*U.axisy)*(X=1-H*H/8),U.axisy=(W*U.axisy-V*U.axisx)*X,U.axisx=H))),U.disableCCD)U.sweepFrozen=!0,U.bullet=!1;else{var X=Er.staticCCDLinearThreshold*U.sweepRadius,H=Er.staticCCDAngularThreshold;if((U.velx*U.velx+U.vely*U.vely)*t*t>X*X||U.angvel*U.angvel*t*t>H*H||3==U.type){for(var q=U.sweep_angvel,Y=1/(q=q<0?-q:q),K=U.shapes.head;null!=K;){var Z,J,Q=K.elt,$=Q.aabb,tt=$.minx,et=$.miny,it=$.maxx,nt=$.maxy,rt=q*t*Q.sweepCoef*.008333333333333333|0,ot=q*t/(rt=8<rt?8:rt),st=t-U.sweepTime;if(0!=st&&(U.sweepTime=t,U.posx+=U.velx*st,U.posy+=U.vely*st,0!=U.angvel&&(Z=U.sweep_angvel*st,U.rot+=Z,1e-4<Z*Z?(U.axisx=Math.sin(U.rot),U.axisy=Math.cos(U.rot)):(pt=((J=1-.5*(pt=Z*Z))*U.axisx+Z*U.axisy)*(st=1-pt*pt/8),U.axisy=(J*U.axisy-Z*U.axisx)*st,U.axisx=pt))),0==Q.type){var at=Q.circle;at.worldCOMx=at.body.posx+(at.body.axisy*at.localCOMx-at.body.axisx*at.localCOMy),at.worldCOMy=at.body.posy+(at.localCOMx*at.body.axisx+at.localCOMy*at.body.axisy),at.aabb.minx=at.worldCOMx-at.radius,at.aabb.miny=at.worldCOMy-at.radius,at.aabb.maxx=at.worldCOMx+at.radius,at.aabb.maxy=at.worldCOMy+at.radius}else{var ht=Q.polygon,lt=ht.lverts.next,pt=ht.gverts.next,at=lt;lt=lt.next,pt.x=ht.body.posx+(ht.body.axisy*at.x-ht.body.axisx*at.y),pt.y=ht.body.posy+(at.x*ht.body.axisx+at.y*ht.body.axisy),ht.aabb.minx=pt.x,ht.aabb.miny=pt.y,ht.aabb.maxx=pt.x,ht.aabb.maxy=pt.y;for(var ut=ht.gverts.next.next;null!=ut;){var dt=ut,ct=lt,lt=lt.next;dt.x=ht.body.posx+(ht.body.axisy*ct.x-ht.body.axisx*ct.y),dt.y=ht.body.posy+(ct.x*ht.body.axisx+ct.y*ht.body.axisy),dt.x<ht.aabb.minx&&(ht.aabb.minx=dt.x),dt.x>ht.aabb.maxx&&(ht.aabb.maxx=dt.x),dt.y<ht.aabb.miny&&(ht.aabb.miny=dt.y),dt.y>ht.aabb.maxy&&(ht.aabb.maxy=dt.y),ut=ut.next}}tt<$.minx?$.minx=tt:tt=$.minx,et<$.miny?$.miny=et:et=$.miny,it>$.maxx?$.maxx=it:it=$.maxx,nt>$.maxy?$.maxy=nt:nt=$.maxy;for(var yt=1,_t=rt;yt<_t;){var mt,gt=ot*yt++*Y,ft=gt-U.sweepTime;if(0!=ft&&(U.sweepTime=gt,U.posx+=U.velx*ft,U.posy+=U.vely*ft,0!=U.angvel&&(mt=U.sweep_angvel*ft,U.rot+=mt,1e-4<mt*mt?(U.axisx=Math.sin(U.rot),U.axisy=Math.cos(U.rot)):(zt=((gt=1-.5*(zt=mt*mt))*U.axisx+mt*U.axisy)*(ft=1-zt*zt/8),U.axisy=(gt*U.axisy-mt*U.axisx)*ft,U.axisx=zt))),0==Q.type){var xt=Q.circle;xt.worldCOMx=xt.body.posx+(xt.body.axisy*xt.localCOMx-xt.body.axisx*xt.localCOMy),xt.worldCOMy=xt.body.posy+(xt.localCOMx*xt.body.axisx+xt.localCOMy*xt.body.axisy),xt.aabb.minx=xt.worldCOMx-xt.radius,xt.aabb.miny=xt.worldCOMy-xt.radius,xt.aabb.maxx=xt.worldCOMx+xt.radius,xt.aabb.maxy=xt.worldCOMy+xt.radius}else{var vt=Q.polygon,wt=vt.lverts.next,zt=vt.gverts.next,xt=wt;wt=wt.next,zt.x=vt.body.posx+(vt.body.axisy*xt.x-vt.body.axisx*xt.y),zt.y=vt.body.posy+(xt.x*vt.body.axisx+xt.y*vt.body.axisy),vt.aabb.minx=zt.x,vt.aabb.miny=zt.y,vt.aabb.maxx=zt.x,vt.aabb.maxy=zt.y;for(var bt=vt.gverts.next.next;null!=bt;){var St=bt,Ct=wt,wt=wt.next;St.x=vt.body.posx+(vt.body.axisy*Ct.x-vt.body.axisx*Ct.y),St.y=vt.body.posy+(Ct.x*vt.body.axisx+Ct.y*vt.body.axisy),St.x<vt.aabb.minx&&(vt.aabb.minx=St.x),St.x>vt.aabb.maxx&&(vt.aabb.maxx=St.x),St.y<vt.aabb.miny&&(vt.aabb.miny=St.y),St.y>vt.aabb.maxy&&(vt.aabb.maxy=St.y),bt=bt.next}}tt<$.minx?$.minx=tt:tt=$.minx,et<$.miny?$.miny=et:et=$.miny,it>$.maxx?$.maxx=it:it=$.maxx,nt>$.maxy?$.maxy=nt:nt=$.maxy}this.bphase.sync(Q),K=K.next}U.sweepFrozen=!1,2==U.type&&U.bulletEnabled&&(X=Er.bulletCCDLinearThreshold*U.sweepRadius,H=Er.bulletCCDAngularThreshold,((U.velx*U.velx+U.vely*U.vely)*t*t>X*X||U.angvel*U.angvel*t*t>H*H)&&(U.bullet=!0))}else U.sweepFrozen=!0,U.bullet=!1}j=j.next}},ii.prototype.continuous=null,ii.prototype.presteparb=function(t,e,i){null==i&&(i=!1);if(!t.cleared&&t.b1.component.sleeping&&t.b2.component.sleeping)return t.sleep_stamp=this.stamp,t.sleeping=!0;if(!t.cleared||0!=t.present||t.intchange){var i=!i&&t.up_stamp==this.stamp-1&&!t.cleared&&!t.intchange,n=t.fresh&&!t.cleared&&!t.intchange;if(i&&(t.endGenerated=this.stamp),n||i||t.cleared||t.intchange){for(var r=t.ws1,o=t.ws2,s=this.mrca1;null!=s.head;){var a=s.head;s.head=a.next,a.elt=null,a.next=nr.zpp_pool,nr.zpp_pool=a,null==s.head&&(s.pushmod=!0),s.modified=!0,s.length--}s.pushmod=!0;for(var h,l,p,u,d,c=this.mrca2;null!=c.head;){var y=c.head;c.head=y.next,y.elt=null,y.next=nr.zpp_pool,nr.zpp_pool=y,null==c.head&&(c.pushmod=!0),c.modified=!0,c.length--}c.pushmod=!0,null!=r.cbSet&&(l=this.mrca1,null==nr.zpp_pool?h=new nr:(h=nr.zpp_pool,nr.zpp_pool=h.next,h.next=null),h.elt=r,(h=h).next=l.head,l.head=h,l.modified=!0,l.length++),null!=r.body.cbSet&&(u=this.mrca1,l=r.body,null==nr.zpp_pool?p=new nr:(p=nr.zpp_pool,nr.zpp_pool=p.next,p.next=null),p.elt=l,(p=p).next=u.head,u.head=p,u.modified=!0,u.length++),null!=o.cbSet&&(u=this.mrca2,null==nr.zpp_pool?d=new nr:(d=nr.zpp_pool,nr.zpp_pool=d.next,d.next=null),d.elt=o,(d=d).next=u.head,u.head=d,u.modified=!0,u.length++),null!=o.body.cbSet&&(xe=this.mrca2,fe=o.body,null==nr.zpp_pool?Xt=new nr:(Xt=nr.zpp_pool,nr.zpp_pool=Xt.next,Xt.next=null),Xt.elt=fe,(fe=Xt).next=xe.head,xe.head=fe,xe.modified=!0,xe.length++);for(var _,m,g,f,x=r.body.compound,v=o.body.compound;x!=v;)(null==x?0:x.depth)<(null==v?0:v.depth)?(null!=v.cbSet&&(f=this.mrca2,null==nr.zpp_pool?_=new nr:(_=nr.zpp_pool,nr.zpp_pool=_.next,_.next=null),_.elt=v,(m=_).next=f.head,f.head=m,f.modified=!0,f.length++),v=v.compound):(null!=x.cbSet&&(m=this.mrca1,null==nr.zpp_pool?g=new nr:(g=nr.zpp_pool,nr.zpp_pool=g.next,g.next=null),g.elt=x,(f=g).next=m.head,m.head=f,m.modified=!0,m.length++),x=x.compound);for(var w=this.mrca1.head;null!=w;){for(var z=w.elt,b=this.mrca2.head;null!=b;){for(var S,C=b.elt,P=z.cbSet,M=C.cbSet,T=null,A=(P.cbpairs.length<M.cbpairs.length?P:M).cbpairs.head;null!=A;){var k=A.elt;if(k.a==P&&k.b==M||k.a==M&&k.b==P){T=k;break}A=A.next}if(null==T&&(null==qn.zpp_pool?S=new qn:(S=qn.zpp_pool,qn.zpp_pool=S.next,S.next=null),S.zip_listeners=!0,Hn.setlt(P,M)?(S.a=P,S.b=M):(S.a=M,S.b=P),T=S,P.cbpairs.add(T),M!=P&&M.cbpairs.add(T)),T.zip_listeners&&(T.zip_listeners=!1,T.__validate()),null!=T.listeners.head){var O=$n.get(z,C);if(n||t.intchange){null==O&&(O=tr.get(z,C),this.add_callbackset(O));for(var E,I=null,G=(P.cbpairs.length<M.cbpairs.length?P:M).cbpairs.head;null!=G;){var D=G.elt;if(D.a==P&&D.b==M||D.a==M&&D.b==P){I=D;break}G=G.next}null==I&&(null==qn.zpp_pool?E=new qn:(E=qn.zpp_pool,qn.zpp_pool=E.next,E.next=null),E.zip_listeners=!0,Hn.setlt(P,M)?(E.a=P,E.b=M):(E.a=M,E.b=P),I=E,P.cbpairs.add(I),M!=P&&M.cbpairs.add(I)),I.zip_listeners&&(I.zip_listeners=!1,I.__validate());for(var L=I.listeners.head;null!=L;){var B,R,F,N,j,U=L.elt;0==U.event&&0!=(U.itype&t.type)&&O.empty_arb(U.itype)&&((B=this.push_callback(U)).event=0,R=O.int1,F=O.int2,j=U.options1,N=R.cbTypes,!(!j.nonemptyintersection(N,j.includes)||j.nonemptyintersection(N,j.excludes))&&(j=U.options2,U=F.cbTypes,!!j.nonemptyintersection(U,j.includes)&&!j.nonemptyintersection(U,j.excludes))?(B.int1=R,B.int2=F):(B.int1=F,B.int2=R),B.set=O),L=L.next}for(var V,W,X=!1,H=O.arbiters.head;null!=H;){if(H.elt==t){X=!0;break}H=H.next}!X&&(V=O.arbiters,null==er.zpp_pool?W=new er:(W=er.zpp_pool,er.zpp_pool=W.next,W.next=null),W.elt=t,(C=W).next=V.head,V.head=C,V.modified=!0,V.length++,!0)&&t.present++}else{t.present--,O.remove_arb(t);for(var q,Y=null,K=(P.cbpairs.length<M.cbpairs.length?P:M).cbpairs.head;null!=K;){var Z=K.elt;if(Z.a==P&&Z.b==M||Z.a==M&&Z.b==P){Y=Z;break}K=K.next}null==Y&&(null==qn.zpp_pool?q=new qn:(q=qn.zpp_pool,qn.zpp_pool=q.next,q.next=null),q.zip_listeners=!0,Hn.setlt(P,M)?(q.a=P,q.b=M):(q.a=M,q.b=P),Y=q,P.cbpairs.add(Y),M!=P&&M.cbpairs.add(Y)),Y.zip_listeners&&(Y.zip_listeners=!1,Y.__validate());for(var J=Y.listeners.head;null!=J;){var Q,$,tt,et,it,nt=J.elt;1==nt.event&&0!=(nt.itype&t.type)&&O.empty_arb(nt.itype)&&((Q=this.push_callback(nt)).event=1,$=O.int1,tt=O.int2,it=nt.options1,et=$.cbTypes,!(!it.nonemptyintersection(et,it.includes)||it.nonemptyintersection(et,it.excludes))&&(it=nt.options2,nt=tt.cbTypes,!!it.nonemptyintersection(nt,it.includes)&&!it.nonemptyintersection(nt,it.excludes))?(Q.int1=$,Q.int2=tt):(Q.int1=tt,Q.int2=$),Q.set=O),J=J.next}null==O.arbiters.head&&this.remove_callbackset(O)}b=b.next}else b=b.next}w=w.next}}t.fresh=!1,t.intchange=!1}if(t.cleared||t.up_stamp+(t.type==Qe.COL?Er.arbiterExpirationDelay:0)<this.stamp){if(t.type==Qe.SENSOR){var rt=t.sensorarb;if(!rt.cleared){for(var ot,st,at=rt.b1.arbiters,ht=null,lt=at.head;null!=lt;){if(lt.elt==rt){null==ht?(st=(ot=at.head).next,at.head=st,null==at.head&&(at.pushmod=!0)):(st=(ot=ht.next).next,null==(ht.next=st)&&(at.pushmod=!0));var pt=ot;pt.elt=null,pt.next=er.zpp_pool,er.zpp_pool=pt,at.modified=!0,at.length--,at.pushmod=!0;break}lt=(ht=lt).next}for(var ut,dt,ct=rt.b2.arbiters,yt=null,_t=ct.head;null!=_t;){if(_t.elt==rt){null==yt?(dt=(ut=ct.head).next,ct.head=dt,null==ct.head&&(ct.pushmod=!0)):(dt=(ut=yt.next).next,null==(yt.next=dt)&&(ct.pushmod=!0));var mt=ut;mt.elt=null,mt.next=er.zpp_pool,er.zpp_pool=mt,ct.modified=!0,ct.length--,ct.pushmod=!0;break}_t=(yt=_t).next}null!=rt.pair&&(rt.pair.arb=null,rt.pair=null)}rt.b1=rt.b2=null,rt.active=!1,rt.intchange=!1,rt.next=Kn.zpp_pool,Kn.zpp_pool=rt}else if(t.type==Qe.FLUID){var gt=t.fluidarb;if(!gt.cleared){for(var ft,xt,vt=gt.b1.arbiters,wt=null,zt=vt.head;null!=zt;){if(zt.elt==gt){null==wt?(xt=(ft=vt.head).next,vt.head=xt,null==vt.head&&(vt.pushmod=!0)):(xt=(ft=wt.next).next,null==(wt.next=xt)&&(vt.pushmod=!0));var bt=ft;bt.elt=null,bt.next=er.zpp_pool,er.zpp_pool=bt,vt.modified=!0,vt.length--,vt.pushmod=!0;break}zt=(wt=zt).next}for(var St,Ct,Pt=gt.b2.arbiters,Mt=null,Tt=Pt.head;null!=Tt;){if(Tt.elt==gt){null==Mt?(Ct=(St=Pt.head).next,Pt.head=Ct,null==Pt.head&&(Pt.pushmod=!0)):(Ct=(St=Mt.next).next,null==(Mt.next=Ct)&&(Pt.pushmod=!0));var At=St;At.elt=null,At.next=er.zpp_pool,er.zpp_pool=At,Pt.modified=!0,Pt.length--,Pt.pushmod=!0;break}Tt=(Mt=Tt).next}null!=gt.pair&&(gt.pair.arb=null,gt.pair=null)}gt.b1=gt.b2=null,gt.active=!1,gt.intchange=!1,gt.next=Zn.zpp_pool,(Zn.zpp_pool=gt).pre_dt=-1}else{var kt=t.colarb;if(!kt.cleared){for(var Ot,Et,It=kt.b1.arbiters,Gt=null,Dt=It.head;null!=Dt;){if(Dt.elt==kt){null==Gt?(Et=(Ot=It.head).next,It.head=Et,null==It.head&&(It.pushmod=!0)):(Et=(Ot=Gt.next).next,null==(Gt.next=Et)&&(It.pushmod=!0));var Lt=Ot;Lt.elt=null,Lt.next=er.zpp_pool,er.zpp_pool=Lt,It.modified=!0,It.length--,It.pushmod=!0;break}Dt=(Gt=Dt).next}for(var Bt,Rt,Ft=kt.b2.arbiters,Nt=null,jt=Ft.head;null!=jt;){if(jt.elt==kt){null==Nt?(Rt=(Bt=Ft.head).next,Ft.head=Rt,null==Ft.head&&(Ft.pushmod=!0)):(Rt=(Bt=Nt.next).next,null==(Nt.next=Rt)&&(Ft.pushmod=!0));var Ut=Bt;Ut.elt=null,Ut.next=er.zpp_pool,er.zpp_pool=Ut,Ft.modified=!0,Ft.length--,Ft.pushmod=!0;break}jt=(Nt=jt).next}null!=kt.pair&&(kt.pair.arb=null,kt.pair=null)}for(kt.b1=kt.b2=null,kt.active=!1,kt.intchange=!1;null!=kt.contacts.next;){var Vt=kt.contacts,Wt=Vt.next;Vt.pop(),Wt.arbiter=null,Wt.next=Qn.zpp_pool,Qn.zpp_pool=Wt;Vt=kt.innards,Wt=Vt.next;Vt.next=Wt.next,Wt._inuse=!1,null==Vt.next&&(Vt.pushmod=!0),Vt.modified=!0,Vt.length--}kt.userdef_dyn_fric=!1,kt.userdef_stat_fric=!1,kt.userdef_restitution=!1,kt.userdef_rfric=!1,kt.__ref_edge1=kt.__ref_edge2=null,kt.next=Jn.zpp_pool,(Jn.zpp_pool=kt).pre_dt=-1}return!0}var Xt=t.active;if(t.active=t.presentable=t.up_stamp==this.stamp,0!=(1&t.immState)){if(t.active&&t.type!=Qe.SENSOR)if(null!=t.colarb){var Ht=t.colarb;Ht.invalidated&&(Ht.invalidated=!1,Ht.userdef_restitution||(Ht.s1.material.elasticity<=-1/0||Ht.s2.material.elasticity<=-1/0?Ht.restitution=0:Ht.s1.material.elasticity>=1/0||Ht.s2.material.elasticity>=1/0?Ht.restitution=1:Ht.restitution=(Ht.s1.material.elasticity+Ht.s2.material.elasticity)/2,Ht.restitution<0&&(Ht.restitution=0),1<Ht.restitution&&(Ht.restitution=1)),Ht.userdef_dyn_fric||(Ht.dyn_fric=Math.sqrt(Ht.s1.material.dynamicFriction*Ht.s2.material.dynamicFriction)),Ht.userdef_stat_fric||(Ht.stat_fric=Math.sqrt(Ht.s1.material.staticFriction*Ht.s2.material.staticFriction)),Ht.userdef_rfric||(Ht.rfric=Math.sqrt(Ht.s1.material.rollingFriction*Ht.s2.material.rollingFriction))),-1==Ht.pre_dt&&(Ht.pre_dt=e);var qt=e/Ht.pre_dt;Ht.pre_dt=e;var Yt=Ht.b1.smass+Ht.b2.smass,Kt=!(Ht.hc2=!1);Ht.biasCoef=2!=Ht.b1.type||2!=Ht.b2.type?Ht.continuous?Er.contactContinuousStaticBiasCoef:Er.contactStaticBiasCoef:Ht.continuous?Er.contactContinuousBiasCoef:Er.contactBiasCoef,Ht.continuous=!1;for(var Zt=null,Jt=null,Qt=Ht.innards.next,$t=Ht.contacts.next;null!=$t;){var te,ee,ie,ne,re,oe,se,ae,he,le=$t;le.stamp+Er.arbiterExpirationDelay<Ht.stamp?(se=Ht.contacts,null==Zt?(ee=(te=se.next).next,se.next=ee,null==se.next&&(se.pushmod=!0)):(ee=(te=Zt.next).next,null==(Zt.next=ee)&&(se.pushmod=!0)),te._inuse=!1,se.modified=!0,se.length--,se.pushmod=!0,$t=ee,ae=Ht.innards,null==Jt?(ne=(ie=ae.next).next,ae.next=ne,null==ae.next&&(ae.pushmod=!0)):(ne=(ie=Jt.next).next,null==(Jt.next=ne)&&(ae.pushmod=!0)),ie._inuse=!1,ae.modified=!0,ae.length--,ae.pushmod=!0,Qt=ne,le.arbiter=null,le.next=Qn.zpp_pool,Qn.zpp_pool=le):(re=le.inner,oe=le.active,le.active=le.stamp==Ht.stamp,le.active&&(Kt?(Kt=!1,Ht.c1=re,Ht.oc1=le):(Ht.hc2=!0,Ht.c2=re,Ht.oc2=le),re.r2x=le.px-Ht.b2.posx,re.r2y=le.py-Ht.b2.posy,re.r1x=le.px-Ht.b1.posx,re.r1y=le.py-Ht.b1.posy,he=re.r2x*Ht.nx+re.r2y*Ht.ny,se=Yt+Ht.b2.sinertia*(he*he),ae=re.r1x*Ht.nx+re.r1y*Ht.ny,se+=Ht.b1.sinertia*(ae*ae),re.tMass=se<Er.epsilon*Er.epsilon?0:1/se,he=Ht.ny*re.r2x-Ht.nx*re.r2y,ae=Yt+Ht.b2.sinertia*(he*he),se=Ht.ny*re.r1x-Ht.nx*re.r1y,ae+=Ht.b1.sinertia*(se*se),re.nMass=ae<Er.epsilon*Er.epsilon?0:1/ae,se=he=0,ae=Ht.b2.angvel+Ht.b2.kinangvel,he=Ht.b2.velx+Ht.b2.kinvelx-re.r2y*ae,se=Ht.b2.vely+Ht.b2.kinvely+re.r2x*ae,ae=Ht.b1.angvel+Ht.b1.kinangvel,he-=Ht.b1.velx+Ht.b1.kinvelx-re.r1y*ae,se-=Ht.b1.vely+Ht.b1.kinvely+re.r1x*ae,ae=Ht.nx*he+Ht.ny*se,le.elasticity=Ht.restitution,re.bounce=ae*le.elasticity,re.bounce>-Er.elasticThreshold&&(re.bounce=0),ae=se*Ht.nx-he*Ht.ny,re.friction=(he=Er.staticFrictionThreshold)*he<ae*ae?Ht.dyn_fric:Ht.stat_fric,re.jnAcc*=qt,re.jtAcc*=qt),oe!=le.active&&(Ht.contacts.modified=!0),Zt=$t,Qt=(Jt=Qt).next,$t=$t.next)}Ht.hc2?(Ht.hpc2=!0,Ht.oc1.posOnly?(ve=Ht.c1,Ht.c1=Ht.c2,Ht.c2=ve,we=Ht.oc1,Ht.oc1=Ht.oc2,Ht.oc2=we,Ht.hc2=!1):Ht.oc2.posOnly&&(Ht.hc2=!1),Ht.oc1.posOnly&&(Kt=!0)):Ht.hpc2=!1,Ht.jrAcc*=qt,Kt||(Ht.rn1a=Ht.ny*Ht.c1.r1x-Ht.nx*Ht.c1.r1y,Ht.rt1a=Ht.c1.r1x*Ht.nx+Ht.c1.r1y*Ht.ny,Ht.rn1b=Ht.ny*Ht.c1.r2x-Ht.nx*Ht.c1.r2y,Ht.rt1b=Ht.c1.r2x*Ht.nx+Ht.c1.r2y*Ht.ny,Ht.k1x=Ht.b2.kinvelx-Ht.c1.r2y*Ht.b2.kinangvel-(Ht.b1.kinvelx-Ht.c1.r1y*Ht.b1.kinangvel),Ht.k1y=Ht.b2.kinvely+Ht.c1.r2x*Ht.b2.kinangvel-(Ht.b1.kinvely+Ht.c1.r1x*Ht.b1.kinangvel)),Ht.hc2&&(Ht.rn2a=Ht.ny*Ht.c2.r1x-Ht.nx*Ht.c2.r1y,Ht.rt2a=Ht.c2.r1x*Ht.nx+Ht.c2.r1y*Ht.ny,Ht.rn2b=Ht.ny*Ht.c2.r2x-Ht.nx*Ht.c2.r2y,Ht.rt2b=Ht.c2.r2x*Ht.nx+Ht.c2.r2y*Ht.ny,Ht.k2x=Ht.b2.kinvelx-Ht.c2.r2y*Ht.b2.kinangvel-(Ht.b1.kinvelx-Ht.c2.r1y*Ht.b1.kinangvel),Ht.k2y=Ht.b2.kinvely+Ht.c2.r2x*Ht.b2.kinangvel-(Ht.b1.kinvely+Ht.c2.r1x*Ht.b1.kinangvel),Ht.kMassa=Yt+Ht.b1.sinertia*Ht.rn1a*Ht.rn1a+Ht.b2.sinertia*Ht.rn1b*Ht.rn1b,Ht.kMassb=Yt+Ht.b1.sinertia*Ht.rn1a*Ht.rn2a+Ht.b2.sinertia*Ht.rn1b*Ht.rn2b,Ht.kMassc=Yt+Ht.b1.sinertia*Ht.rn2a*Ht.rn2a+Ht.b2.sinertia*Ht.rn2b*Ht.rn2b,Ht.kMassa*Ht.kMassa+2*Ht.kMassb*Ht.kMassb+Ht.kMassc*Ht.kMassc<Er.illConditionedThreshold*(Ht.kMassa*Ht.kMassc-Ht.kMassb*Ht.kMassb)?(Ht.Ka=Ht.kMassa,Ht.Kb=Ht.kMassb,Ht.Kc=Ht.kMassc,(ye=Ht.kMassa*Ht.kMassc-Ht.kMassb*Ht.kMassb)!=ye?Ht.kMassa=Ht.kMassb=Ht.kMassc=0:0==ye?(0!=Ht.kMassa?Ht.kMassa=1/Ht.kMassa:Ht.kMassa=0,0!=Ht.kMassc?Ht.kMassc=1/Ht.kMassc:Ht.kMassc=0,Ht.kMassb=0):(de=Ht.kMassc*(ye=1/ye),Ht.kMassc=Ht.kMassa*ye,Ht.kMassa=de,Ht.kMassb*=-ye)):(Ht.hc2=!1,Ht.oc2.dist<Ht.oc1.dist&&(_e=Ht.c1,Ht.c1=Ht.c2,Ht.c2=_e),Ht.oc2.active=!1,Ht.contacts.modified=!0)),Ht.surfacex=Ht.b2.svelx,Ht.surfacey=Ht.b2.svely,Ht.surfacex+=Ht.b1.svelx,Ht.surfacey+=Ht.b1.svely,Ht.surfacex=-Ht.surfacex,Ht.surfacey=-Ht.surfacey,Ht.rMass=Ht.b1.sinertia+Ht.b2.sinertia,0!=Ht.rMass&&(Ht.rMass=1/Ht.rMass),Kt&&(t.active=!1)}else{var pe=t.fluidarb;-1==pe.pre_dt&&(pe.pre_dt=e);var ue=e/pe.pre_dt;pe.pre_dt=e,pe.r1x=pe.centroidx-pe.b1.posx,pe.r1y=pe.centroidy-pe.b1.posy,pe.r2x=pe.centroidx-pe.b2.posx,pe.r2y=pe.centroidy-pe.b2.posy;var de,ce,ye,_e,me,ge,fe=0,xe=0,xe=pe.ws1.fluidEnabled&&null!=pe.ws1.fluidProperties.wrap_gravity?(fe=pe.ws1.fluidProperties.gravityx,pe.ws1.fluidProperties.gravityy):(fe=this.gravityx,this.gravityy),r=0,o=0,o=pe.ws2.fluidEnabled&&null!=pe.ws2.fluidProperties.wrap_gravity?(r=pe.ws2.fluidProperties.gravityx,pe.ws2.fluidProperties.gravityy):(r=this.gravityx,this.gravityy),ve=0,we=0;if(pe.ws1.fluidEnabled&&pe.ws2.fluidEnabled?(de=pe.overlap*pe.ws1.fluidProperties.density,(ye=pe.overlap*pe.ws2.fluidProperties.density)<de?(ve-=fe*(me=de+ye),we-=xe*me):de<ye?(ve+=r*(ce=de+ye),we+=o*ce):(me=_e=0,_e=fe+r,me=xe+o,pe.ws1.worldCOMx*(_e*=.5)+pe.ws1.worldCOMy*(me*=.5)>pe.ws2.worldCOMx*_e+pe.ws2.worldCOMy*me?(ve-=_e*(ce=de+ye),we-=me*ce):(ve+=_e*(ye=de+ye),we+=me*ye))):pe.ws1.fluidEnabled?(ve-=fe*(fe=pe.overlap*pe.ws1.fluidProperties.density),we-=xe*fe):pe.ws2.fluidEnabled&&(ve+=r*(ge=pe.overlap*pe.ws2.fluidProperties.density),we+=o*ge),we*=e,pe.buoyx=ve*=e,pe.buoyy=we,2==pe.b1.type&&(ge=pe.b1.imass,pe.b1.velx-=ve*ge,pe.b1.vely-=we*ge,pe.b1.angvel-=(we*pe.r1x-ve*pe.r1y)*pe.b1.iinertia),2==pe.b2.type&&(ze=pe.b2.imass,pe.b2.velx+=ve*ze,pe.b2.vely+=we*ze,pe.b2.angvel+=(we*pe.r2x-ve*pe.r2y)*pe.b2.iinertia),pe.ws1.fluidEnabled&&0!=pe.ws1.fluidProperties.viscosity||pe.ws2.fluidEnabled&&0!=pe.ws2.fluidProperties.viscosity){pe.nodrag=!1;var ze=0;pe.ws1.fluidEnabled&&(pe.ws2.validate_angDrag(),ze=pe.ws1.fluidProperties.viscosity*pe.ws2.angDrag*pe.overlap/pe.ws2.area),pe.ws2.fluidEnabled&&(pe.ws1.validate_angDrag(),ze+=pe.ws2.fluidProperties.viscosity*pe.ws1.angDrag*pe.overlap/pe.ws1.area),0!=ze?(Te=pe.b1.sinertia+pe.b2.sinertia,pe.wMass=0!=Te?1/Te:0,ze*=4e-4,Se=2*Math.PI*ze,pe.agamma=1/(e*Se*(2+Se*e)),Me=1/(1+pe.agamma),pe.agamma*=Me,pe.wMass*=Me):(pe.wMass=0,pe.agamma=0);we=pe.b2.velx+pe.b2.kinvelx-pe.r2y*(pe.b2.angvel+pe.b2.kinangvel)-(pe.b1.velx+pe.b1.kinvelx-pe.r1y*(pe.b2.angvel+pe.b2.kinangvel)),ve=pe.b2.vely+pe.b2.kinvely+pe.r2x*(pe.b2.angvel+pe.b2.kinangvel)-(pe.b1.vely+pe.b1.kinvely+pe.r1x*(pe.b1.angvel+pe.b1.kinangvel));we*we+ve*ve<Er.epsilon*Er.epsilon||(ve*=be=1/Math.sqrt(we*we+ve*ve),pe.nx=we*=be,pe.ny=ve);var be,Se,Ce,Pe,Me,Te=0;if(pe.ws1.fluidEnabled){var Ae=-pe.ws1.fluidProperties.viscosity*pe.overlap/pe.ws2.area;if(0==pe.ws2.type)Te=0-Ae*pe.ws2.circle.radius*Er.fluidLinearDrag/(2*pe.ws2.circle.radius*Math.PI);else{for(var ke=0,Oe=0,Ee=pe.ws2.polygon.edges.head;null!=Ee;){var Ie=Ee.elt;ke+=Ie.length;Ie=Ae*Ie.length*(Ie.gnormx*pe.nx+Ie.gnormy*pe.ny);0<Ie&&(Ie*=-Er.fluidVacuumDrag),Oe-=.5*Ie*Er.fluidLinearDrag,Ee=Ee.next}Te=Oe/ke}}if(pe.ws2.fluidEnabled){var Ge=-pe.ws2.fluidProperties.viscosity*pe.overlap/pe.ws1.area;if(0==pe.ws1.type)Te-=Ge*pe.ws1.circle.radius*Er.fluidLinearDrag/(2*pe.ws1.circle.radius*Math.PI);else{for(var De=0,Le=0,Be=pe.ws1.polygon.edges.head;null!=Be;){var Re=Be.elt;De+=Re.length;Re=Ge*Re.length*(Re.gnormx*pe.nx+Re.gnormy*pe.ny);0<Re&&(Re*=-Er.fluidVacuumDrag),Le-=.5*Re*Er.fluidLinearDrag,Be=Be.next}Te+=Le/De}}0!=Te?(Me=Se=ze=0,Me=ze=be=pe.b1.smass+pe.b2.smass,(Se=0)!=pe.b1.sinertia&&(we=pe.r1x*pe.b1.sinertia,ze=be+(ve=pe.r1y*pe.b1.sinertia)*pe.r1y,Se+=-ve*pe.r1x,Me=be+we*pe.r1x),0!=pe.b2.sinertia&&(Pe=pe.r2x*pe.b2.sinertia,ze+=(Ce=pe.r2y*pe.b2.sinertia)*pe.r2y,Se+=-Ce*pe.r2x,Me+=Pe*pe.r2x),(Ce=ze*Me-Se*Se)!=Ce?ze=Se=Me=0:0==Ce?(ze=0!=ze?1/ze:0,Me=0!=Me?1/Me:0,Se=0):(Pe=Me*(Ce=1/Ce),Me=ze*Ce,ze=Pe,Se*=-Ce),pe.vMassa=ze,pe.vMassb=Se,pe.vMassc=Me,Te=2*Math.PI*Te,pe.lgamma=1/(e*Te*(2+Te*e)),e=1/(1+pe.lgamma),pe.lgamma*=e,pe.vMassa*=e,pe.vMassb*=e,pe.vMassc*=e):(pe.vMassa=0,pe.vMassb=0,pe.vMassc=0,pe.lgamma=0)}else pe.nodrag=!0,pe.dampx=0,pe.dampy=0,pe.adamp=0;pe.dampx*=ue,pe.dampy*=ue,pe.adamp*=ue}}else if(null!=t.colarb){var Fe=t.colarb,Ne=!0,je=null,Ue=null,Ve=Fe.innards.next;Fe.hc2=!1;for(var We=Fe.contacts.next;null!=We;){var Xe,He,qe,Ye,Ke,Ze,Je=We;Je.stamp+Er.arbiterExpirationDelay<Fe.stamp?(Ke=Fe.contacts,null==je?(He=(Xe=Ke.next).next,Ke.next=He,null==Ke.next&&(Ke.pushmod=!0)):(He=(Xe=je.next).next,null==(je.next=He)&&(Ke.pushmod=!0)),Xe._inuse=!1,Ke.modified=!0,Ke.length--,Ke.pushmod=!0,We=He,Ze=Fe.innards,null==Ue?(Ye=(qe=Ze.next).next,Ze.next=Ye,null==Ze.next&&(Ze.pushmod=!0)):(Ye=(qe=Ue.next).next,null==(Ue.next=Ye)&&(Ze.pushmod=!0)),qe._inuse=!1,Ze.modified=!0,Ze.length--,Ze.pushmod=!0,Ve=Ye,Je.arbiter=null,Je.next=Qn.zpp_pool,Qn.zpp_pool=Je):(Ke=Je.inner,Ze=Je.active,Je.active=Je.stamp==Fe.stamp,Je.active&&(Ne?(Ne=!1,Fe.c1=Ke,Fe.oc1=Je):(Fe.hc2=!0,Fe.c2=Ke,Fe.oc2=Je)),Ze!=Je.active&&(Fe.contacts.modified=!0),je=We,Ve=(Ue=Ve).next,We=We.next)}Fe.hc2?(Fe.hpc2=!0,Fe.oc1.posOnly?(ue=Fe.c1,Fe.c1=Fe.c2,Fe.c2=ue,ue=Fe.oc1,Fe.oc1=Fe.oc2,Fe.oc2=ue,Fe.hc2=!1):Fe.oc2.posOnly&&(Fe.hc2=!1),Fe.oc1.posOnly&&(Ne=!0)):Fe.hpc2=!1,Ne&&(t.active=!1)}return Xt!=t.active&&(t.b1.arbiters.modified=!0,t.b2.arbiters.modified=!0,this.c_arbiters_true.modified=this.c_arbiters_false.modified=!0,this.s_arbiters.modified=this.f_arbiters.modified=!0),!1},ii.prototype.prestep=function(t){for(var e=null,i=this.live_constraints.head;null!=i;){var n=i.elt;n.preStep(t)?(i=this.live_constraints.erase(e),n.broken(),this.constraintCbBreak(n),n.removeOnBreak?(n.component.sleeping=!0,this.midstep=!1,(null!=n.compound?n.compound:this).wrap_constraints.remove(n.outer),this.midstep=!0):n.active=!1,n.clearcache()):i=(e=i).next}var r,o,s,a=null,h=this.c_arbiters_true,l=h.head,p=null!=this.c_arbiters_false;for(p&&null==l&&(p=!1,l=this.c_arbiters_false.head,h=this.c_arbiters_false,a=null);null!=l;)this.presteparb(l.elt,t)?(null==a?(o=(r=h.head).next,h.head=o,null==h.head&&(h.pushmod=!0)):(o=(r=a.next).next,null==(a.next=o)&&(h.pushmod=!0)),(s=r).elt=null,s.next=sr.zpp_pool,sr.zpp_pool=s,h.modified=!0,h.length--,h.pushmod=!0,l=o,p&&null==l&&(p=!1,l=this.c_arbiters_false.head,h=this.c_arbiters_false,a=null)):(l=(a=l).next,p&&null==l&&(p=!1,l=this.c_arbiters_false.head,h=this.c_arbiters_false,a=null));for(var u,d,c,y=null,_=this.f_arbiters,m=_.head;null!=m;)this.presteparb(m.elt,t)?(null==y?(d=(u=_.head).next,_.head=d,null==_.head&&(_.pushmod=!0)):(d=(u=y.next).next,null==(y.next=d)&&(_.pushmod=!0)),(c=u).elt=null,c.next=rr.zpp_pool,rr.zpp_pool=c,_.modified=!0,_.length--,_.pushmod=!0,m=d):m=(y=m).next;for(var g,f,x,v=null,w=this.s_arbiters,z=w.head;null!=z;)this.presteparb(z.elt,t)?(null==v?(f=(g=w.head).next,w.head=f,null==w.head&&(w.pushmod=!0)):(f=(g=v.next).next,null==(v.next=f)&&(w.pushmod=!0)),(x=g).elt=null,x.next=or.zpp_pool,or.zpp_pool=x,w.modified=!0,w.length--,w.pushmod=!0,z=f):z=(v=z).next},ii.prototype.warmStart=function(){for(var t=this.f_arbiters.head;null!=t;){var e,i=t.elt;i.active&&0!=(1&i.immState)&&(e=i.b1.imass,i.b1.velx-=i.dampx*e,i.b1.vely-=i.dampy*e,e=i.b2.imass,i.b2.velx+=i.dampx*e,i.b2.vely+=i.dampy*e,i.b1.angvel-=i.b1.iinertia*(i.dampy*i.r1x-i.dampx*i.r1y),i.b2.angvel+=i.b2.iinertia*(i.dampy*i.r2x-i.dampx*i.r2y),i.b1.angvel-=i.adamp*i.b1.iinertia,i.b2.angvel+=i.adamp*i.b2.iinertia),t=t.next}var n=this.c_arbiters_false.head,r=!0;for(null==n&&(n=this.c_arbiters_true.head,r=!1);null!=n;){var o,s,a,h=n.elt;h.active&&0!=(1&h.immState)&&(a=h.nx*h.c1.jnAcc-h.ny*h.c1.jtAcc,s=h.ny*h.c1.jnAcc+h.nx*h.c1.jtAcc,o=h.b1.imass,h.b1.velx-=a*o,h.b1.vely-=s*o,h.b1.angvel-=h.b1.iinertia*(s*h.c1.r1x-a*h.c1.r1y),o=h.b2.imass,h.b2.velx+=a*o,h.b2.vely+=s*o,h.b2.angvel+=h.b2.iinertia*(s*h.c1.r2x-a*h.c1.r2y),h.hc2&&(o=h.nx*h.c2.jnAcc-h.ny*h.c2.jtAcc,s=h.ny*h.c2.jnAcc+h.nx*h.c2.jtAcc,a=h.b1.imass,h.b1.velx-=o*a,h.b1.vely-=s*a,h.b1.angvel-=h.b1.iinertia*(s*h.c2.r1x-o*h.c2.r1y),a=h.b2.imass,h.b2.velx+=o*a,h.b2.vely+=s*a,h.b2.angvel+=h.b2.iinertia*(s*h.c2.r2x-o*h.c2.r2y)),h.b2.angvel+=h.jrAcc*h.b2.iinertia,h.b1.angvel-=h.jrAcc*h.b1.iinertia),n=n.next,r&&null==n&&(n=this.c_arbiters_true.head,r=!1)}for(var l=this.live_constraints.head;null!=l;)l.elt.warmStart(),l=l.next},ii.prototype.iterateVel=function(t){for(var e=0;e<t;){++e;for(var i=this.f_arbiters.head;null!=i;){var n,r,o,s,a,h=i.elt;h.active&&0!=(1&h.immState)&&(h.nodrag||(n=h.b1.angvel+h.b1.kinangvel,a=h.b2.angvel+h.b2.kinangvel,o=h.b1.velx+h.b1.kinvelx-h.r1y*n-(h.b2.velx+h.b2.kinvelx-h.r2y*a),r=h.b1.vely+h.b1.kinvely+h.r1x*n-(h.b2.vely+h.b2.kinvely+h.r2x*a),s=h.vMassa*o+h.vMassb*r,r=h.vMassb*o+h.vMassc*r,o=s,s=h.lgamma,o-=h.dampx*s,r-=h.dampy*s,h.dampx+=o,h.dampy+=r,s=h.b1.imass,h.b1.velx-=o*s,h.b1.vely-=r*s,s=h.b2.imass,h.b2.velx+=o*s,h.b2.vely+=r*s,h.b1.angvel-=h.b1.iinertia*(r*h.r1x-o*h.r1y),h.b2.angvel+=h.b2.iinertia*(r*h.r2x-o*h.r2y),a=(n-a)*h.wMass-h.adamp*h.agamma,h.adamp+=a,h.b1.angvel-=a*h.b1.iinertia,h.b2.angvel+=a*h.b2.iinertia)),i=i.next}for(var l=null,p=this.live_constraints.head;null!=p;){var u=p.elt;u.applyImpulseVel()?(p=this.live_constraints.erase(l),u.broken(),this.constraintCbBreak(u),u.removeOnBreak?(u.component.sleeping=!0,this.midstep=!1,(null!=u.compound?u.compound:this).wrap_constraints.remove(u.outer),this.midstep=!0):u.active=!1,u.clearcache()):p=(l=p).next}var d=this.c_arbiters_false.head,c=!0;for(null==d&&(d=this.c_arbiters_true.head,c=!1);null!=d;){var y,_,m,g,f,x,v,w,z,b,S,C,P,M,T=d.elt;T.active&&0!=(1&T.immState)&&(v=T.k1x+T.b2.velx-T.c1.r2y*T.b2.angvel-(T.b1.velx-T.c1.r1y*T.b1.angvel),m=((w=T.k1y+T.b2.vely+T.c1.r2x*T.b2.angvel-(T.b1.vely+T.c1.r1x*T.b1.angvel))*T.nx-v*T.ny+T.surfacex)*T.c1.tMass,(g=T.c1.friction*T.c1.jnAcc)<(x=(f=T.c1.jtAcc)-m)?x=g:x<-g&&(x=-g),m=x-f,T.c1.jtAcc=x,y=-T.ny*m,_=T.nx*m,T.b2.velx+=y*T.b2.imass,T.b2.vely+=_*T.b2.imass,T.b1.velx-=y*T.b1.imass,T.b1.vely-=_*T.b1.imass,T.b2.angvel+=T.rt1b*m*T.b2.iinertia,T.b1.angvel-=T.rt1a*m*T.b1.iinertia,T.hc2?(P=T.k2x+T.b2.velx-T.c2.r2y*T.b2.angvel-(T.b1.velx-T.c2.r1y*T.b1.angvel),m=((M=T.k2y+T.b2.vely+T.c2.r2x*T.b2.angvel-(T.b1.vely+T.c2.r1x*T.b1.angvel))*T.nx-P*T.ny+T.surfacex)*T.c2.tMass,(g=T.c2.friction*T.c2.jnAcc)<(x=(f=T.c2.jtAcc)-m)?x=g:x<-g&&(x=-g),m=x-f,T.c2.jtAcc=x,y=-T.ny*m,_=T.nx*m,T.b2.velx+=y*T.b2.imass,T.b2.vely+=_*T.b2.imass,T.b1.velx-=y*T.b1.imass,T.b1.vely-=_*T.b1.imass,T.b2.angvel+=T.rt2b*m*T.b2.iinertia,T.b1.angvel-=T.rt2a*m*T.b1.iinertia,v=T.k1x+T.b2.velx-T.c1.r2y*T.b2.angvel-(T.b1.velx-T.c1.r1y*T.b1.angvel),w=T.k1y+T.b2.vely+T.c1.r2x*T.b2.angvel-(T.b1.vely+T.c1.r1x*T.b1.angvel),P=T.k2x+T.b2.velx-T.c2.r2y*T.b2.angvel-(T.b1.velx-T.c2.r1y*T.b1.angvel),M=T.k2y+T.b2.vely+T.c2.r2x*T.b2.angvel-(T.b1.vely+T.c2.r1x*T.b1.angvel),z=T.c1.jnAcc,b=T.c2.jnAcc,S=v*T.nx+w*T.ny+T.surfacey+T.c1.bounce-(T.Ka*z+T.Kb*b),C=P*T.nx+M*T.ny+T.surfacey+T.c2.bounce-(T.Kb*z+T.Kc*b),P=-(T.kMassa*S+T.kMassb*C),M=-(T.kMassb*S+T.kMassc*C),0<=P&&0<=M?(S=P-z,C=M-b,T.c1.jnAcc=P,T.c2.jnAcc=M):0<=(P=-T.c1.nMass*S)&&0<=T.Kb*P+C?(S=P-z,C=-b,T.c1.jnAcc=P,T.c2.jnAcc=0):0<=(M=-T.c2.nMass*C)&&0<=T.Kb*M+S?(S=-z,C=M-b,T.c1.jnAcc=0,T.c2.jnAcc=M):0<=S&&0<=C?(S=-z,C=-b,T.c1.jnAcc=T.c2.jnAcc=0):C=S=0,y=T.nx*(m=S+C),_=T.ny*m,T.b2.velx+=y*T.b2.imass,T.b2.vely+=_*T.b2.imass,T.b1.velx-=y*T.b1.imass,T.b1.vely-=_*T.b1.imass,T.b2.angvel+=(T.rn1b*S+T.rn2b*C)*T.b2.iinertia,T.b1.angvel-=(T.rn1a*S+T.rn2a*C)*T.b1.iinertia):(0!=T.radius&&(m=(T.b2.angvel-T.b1.angvel)*T.rMass,g=T.rfric*T.c1.jnAcc,f=T.jrAcc,T.jrAcc-=m,T.jrAcc>g?T.jrAcc=g:T.jrAcc<-g&&(T.jrAcc=-g),m=T.jrAcc-f,T.b2.angvel+=m*T.b2.iinertia,T.b1.angvel-=m*T.b1.iinertia),v=T.k1x+T.b2.velx-T.c1.r2y*T.b2.angvel-(T.b1.velx-T.c1.r1y*T.b1.angvel),w=T.k1y+T.b2.vely+T.c1.r2x*T.b2.angvel-(T.b1.vely+T.c1.r1x*T.b1.angvel),m=(T.c1.bounce+(T.nx*v+T.ny*w)+T.surfacey)*T.c1.nMass,m=(x=(x=(f=T.c1.jnAcc)-m)<0?0:x)-f,T.c1.jnAcc=x,y=T.nx*m,_=T.ny*m,T.b2.velx+=y*T.b2.imass,T.b2.vely+=_*T.b2.imass,T.b1.velx-=y*T.b1.imass,T.b1.vely-=_*T.b1.imass,T.b2.angvel+=T.rn1b*m*T.b2.iinertia,T.b1.angvel-=T.rn1a*m*T.b1.iinertia)),d=d.next,c&&null==d&&(d=this.c_arbiters_true.head,c=!1)}}},ii.prototype.iteratePos=function(t){for(var e=0;e<t;){++e;for(var i=null,n=this.live_constraints.head;null!=n;){var r=n.elt;!r.__velocity&&r.stiff&&r.applyImpulsePos()?(n=this.live_constraints.erase(i),r.broken(),this.constraintCbBreak(r),r.removeOnBreak?(r.component.sleeping=!0,this.midstep=!1,(null!=r.compound?r.compound:this).wrap_constraints.remove(r.outer),this.midstep=!0):r.active=!1,r.clearcache()):n=(i=n).next}var o=this.c_arbiters_false.head,s=!0;for(null==o&&(o=this.c_arbiters_true.head,s=!1);null!=o;){var a=o.elt;if(a.active&&0!=(1&a.immState))if(2==a.ptype){var h=a.c1,l=0,p=0;l=a.b2.axisy*h.lr2x-a.b2.axisx*h.lr2y,p=h.lr2x*a.b2.axisx+h.lr2y*a.b2.axisy,l+=a.b2.posx,p+=a.b2.posy;var u=0,d=0;u=a.b1.axisy*h.lr1x-a.b1.axisx*h.lr1y,d=h.lr1x*a.b1.axisx+h.lr1y*a.b1.axisy;var c=0,y=0,c=l-(u+=a.b1.posx),y=p-(d+=a.b1.posy),_=Math.sqrt(c*c+y*y),m=a.radius-Er.collisionSlop,h=_-m;c*a.nx+y*a.ny<0&&(c=-c,y=-y,h-=a.radius),h<0&&(_<Er.epsilon?0!=a.b1.smass?a.b1.posx+=10*Er.epsilon:a.b2.posx+=10*Er.epsilon:(c*=v=1/_,d=(y*=v)*(u=(v=.5*(u+l))-a.b1.posx)-c*(d=(u=.5*(d+p))-a.b1.posy),v=y*(l=v-a.b2.posx)-c*(p=u-a.b2.posy),0!=(u=a.b2.smass+v*v*a.b2.sinertia+a.b1.smass+d*d*a.b1.sinertia)&&(P=p=0,P=y*(w=-a.biasCoef*(_-m)/u),m=a.b1.imass,a.b1.posx-=(p=c*w)*m,a.b1.posy-=P*m,u=a.b1,c=-d*a.b1.iinertia*w,u.rot+=c,1e-4<c*c?(u.axisx=Math.sin(u.rot),u.axisy=Math.cos(u.rot)):(S=((m=1-.5*(S=c*c))*u.axisx+c*u.axisy)*(d=1-S*S/8),u.axisy=(m*u.axisy-c*u.axisx)*d,u.axisx=S),S=a.b2.imass,a.b2.posx+=p*S,a.b2.posy+=P*S,P=a.b2,S=v*a.b2.iinertia*w,P.rot+=S,1e-4<S*S?(P.axisx=Math.sin(P.rot),P.axisy=Math.cos(P.rot)):(M=((b=1-.5*(z=S*S))*P.axisx+S*P.axisy)*(C=1-z*z/8),P.axisy=(b*P.axisy-S*P.axisx)*C,P.axisx=M))))}else{var g,f=0,x=0,v=0,w=0,z=0,b=0;0==a.ptype?(f=a.b1.axisy*a.lnormx-a.b1.axisx*a.lnormy,x=a.lnormx*a.b1.axisx+a.lnormy*a.b1.axisy,g=a.lproj+(f*a.b1.posx+x*a.b1.posy),v=a.b2.axisy*a.c1.lr1x-a.b2.axisx*a.c1.lr1y,w=a.c1.lr1x*a.b2.axisx+a.c1.lr1y*a.b2.axisy,v+=a.b2.posx,w+=a.b2.posy,a.hpc2&&(z=a.b2.axisy*a.c2.lr1x-a.b2.axisx*a.c2.lr1y,b=a.c2.lr1x*a.b2.axisx+a.c2.lr1y*a.b2.axisy,z+=a.b2.posx,b+=a.b2.posy)):(f=a.b2.axisy*a.lnormx-a.b2.axisx*a.lnormy,x=a.lnormx*a.b2.axisx+a.lnormy*a.b2.axisy,g=a.lproj+(f*a.b2.posx+x*a.b2.posy),v=a.b1.axisy*a.c1.lr1x-a.b1.axisx*a.c1.lr1y,w=a.c1.lr1x*a.b1.axisx+a.c1.lr1y*a.b1.axisy,v+=a.b1.posx,w+=a.b1.posy,a.hpc2&&(z=a.b1.axisy*a.c2.lr1x-a.b1.axisx*a.c2.lr1y,b=a.c2.lr1x*a.b1.axisx+a.c2.lr1y*a.b1.axisy,z+=a.b1.posx,b+=a.b1.posy));var S=v*f+w*x-g-a.radius;S+=Er.collisionSlop;var C=0;if(a.hpc2&&(C=z*f+b*x-g-a.radius,C+=Er.collisionSlop),S<0||C<0){a.rev&&(f=-f,x=-x);var P=v-a.b1.posx,M=w-a.b1.posy,v=v-a.b2.posx,w=w-a.b2.posy;if(a.hpc2){var T=x*P-f*M,A=x*v-f*w,k=x*(z-a.b1.posx)-f*(b-a.b1.posy),O=x*(z-a.b2.posx)-f*(b-a.b2.posy),E=a.b1.smass+a.b2.smass;a.kMassa=E+a.b1.sinertia*T*T+a.b2.sinertia*A*A,a.kMassb=E+a.b1.sinertia*T*k+a.b2.sinertia*A*O,a.kMassc=E+a.b1.sinertia*k*k+a.b2.sinertia*O*O;for(var I=a.kMassa,G=a.kMassb,D=a.kMassc,L=S*a.biasCoef,B=C*a.biasCoef;;){var R=0,F=0;R=-(R=L),F=-(F=B);var N=a.kMassa*a.kMassc-a.kMassb*a.kMassb;if(N!=N?R=F=0:0==N?(0!=a.kMassa?R/=a.kMassa:R=0,0!=a.kMassc?F/=a.kMassc:F=0):(U=(N=1/N)*(a.kMassc*R-a.kMassb*F),F=N*(a.kMassa*F-a.kMassb*R),R=U),0<=R&&0<=F){var j=(R+F)*a.b1.imass;a.b1.posx-=f*j,a.b1.posy-=x*j;var N=a.b1,U=-a.b1.iinertia*(T*R+k*F);N.rot+=U,1e-4<U*U?(N.axisx=Math.sin(N.rot),N.axisy=Math.cos(N.rot)):(V=((j=1-.5*(V=U*U))*N.axisx+U*N.axisy)*(W=1-V*V/8),N.axisy=(j*N.axisy-U*N.axisx)*W,N.axisx=V);U=(R+F)*a.b2.imass;a.b2.posx+=f*U,a.b2.posy+=x*U;var V,W=a.b2,N=a.b2.iinertia*(A*R+O*F);W.rot+=N,1e-4<N*N?(W.axisx=Math.sin(W.rot),W.axisy=Math.cos(W.rot)):(H=((V=1-.5*(H=N*N))*W.axisx+N*W.axisy)*(U=1-H*H/8),W.axisy=(V*W.axisy-N*W.axisx)*U,W.axisx=H);break}if((F=0)<=(R=-L/I)&&0<=G*R+B){W=(R+F)*a.b1.imass;a.b1.posx-=f*W,a.b1.posy-=x*W;var X=a.b1,H=-a.b1.iinertia*(T*R+k*F);X.rot+=H,1e-4<H*H?(X.axisx=Math.sin(X.rot),X.axisy=Math.cos(X.rot)):(Y=((W=1-.5*(Y=H*H))*X.axisx+H*X.axisy)*(q=1-Y*Y/8),X.axisy=(W*X.axisy-H*X.axisx)*q,X.axisx=Y);var q=(R+F)*a.b2.imass;a.b2.posx+=f*q,a.b2.posy+=x*q;var X=a.b2,Y=a.b2.iinertia*(A*R+O*F);X.rot+=Y,1e-4<Y*Y?(X.axisx=Math.sin(X.rot),X.axisy=Math.cos(X.rot)):(Z=((q=1-.5*(Z=Y*Y))*X.axisx+Y*X.axisy)*(K=1-Z*Z/8),X.axisy=(q*X.axisy-Y*X.axisx)*K,X.axisx=Z);break}if((R=0)<=(F=-B/D)&&0<=G*F+L){var K=(R+F)*a.b1.imass;a.b1.posx-=f*K,a.b1.posy-=x*K;var X=a.b1,Z=-a.b1.iinertia*(T*R+k*F);X.rot+=Z,1e-4<Z*Z?(X.axisx=Math.sin(X.rot),X.axisy=Math.cos(X.rot)):(Q=((K=1-.5*(Q=Z*Z))*X.axisx+Z*X.axisy)*(J=1-Q*Q/8),X.axisy=(K*X.axisy-Z*X.axisx)*J,X.axisx=Q);var J=(R+F)*a.b2.imass;a.b2.posx+=f*J,a.b2.posy+=x*J;var X=a.b2,Q=a.b2.iinertia*(A*R+O*F);X.rot+=Q,1e-4<Q*Q?(X.axisx=Math.sin(X.rot),X.axisy=Math.cos(X.rot)):(J=((R=1-.5*(J=Q*Q))*X.axisx+Q*X.axisy)*(F=1-J*J/8),X.axisy=(R*X.axisy-Q*X.axisx)*F,X.axisx=J);break}break}}else{var $,b=x*P-f*M,E=x*v-f*w,C=a.b2.smass+E*E*a.b2.sinertia+a.b1.smass+b*b*a.b1.sinertia;0!=C&&(M=P=0,M=x*(v=-a.biasCoef*S/C),w=a.b1.imass,a.b1.posx-=(P=f*v)*w,a.b1.posy-=M*w,S=a.b1,C=-b*a.b1.iinertia*v,S.rot+=C,1e-4<C*C?(S.axisx=Math.sin(S.rot),S.axisy=Math.cos(S.rot)):($=((w=1-.5*($=C*C))*S.axisx+C*S.axisy)*(b=1-$*$/8),S.axisy=(w*S.axisy-C*S.axisx)*b,S.axisx=$),$=a.b2.imass,a.b2.posx+=P*$,a.b2.posy+=M*$,P=a.b2,M=E*a.b2.iinertia*v,P.rot+=M,1e-4<M*M?(P.axisx=Math.sin(P.rot),P.axisy=Math.cos(P.rot)):($=((E=1-.5*($=M*M))*P.axisx+M*P.axisy)*(v=1-$*$/8),P.axisy=(E*P.axisy-M*P.axisx)*v,P.axisx=$))}}}o=o.next,s&&null==o&&(o=this.c_arbiters_true.head,s=!1)}}},ii.prototype.group_ignore=function(t,e){for(var i=t;null!=i&&null==i.group;)i=null!=i.ishape?i.ishape.body:(null!=i.icompound?i.icompound:i.ibody).compound;var n=null==i?null:i.group;if(null==n)return!1;for(var r=e;null!=r&&null==r.group;)r=null!=r.ishape?r.ishape.body:(null!=r.icompound?r.icompound:r.ibody).compound;var o=null==r?null:r.group;if(null==o)return!1;for(var s=!1;null!=n&&null!=o;){if(n==o){s=n.ignore;break}n.depth<o.depth?o=o.group:n=n.group}return s},ii.prototype.interactionType=function(t,e,i,n){for(var r,o,s,a=!1,h=i.constraints.head;null!=h;){var l=h.elt;if(l.ignore&&l.pair_exists(i.id,n.id)){a=!0;break}h=h.next}if(a)r=!1;else{for(var p=t;null!=p&&null==p.group;)p=null!=p.ishape?p.ishape.body:(null!=p.icompound?p.icompound:p.ibody).compound;var u,d=null==p?null:p.group;if(null==d)u=!1;else{for(var c=e;null!=c&&null==c.group;)c=null!=c.ishape?c.ishape.body:(null!=c.icompound?c.icompound:c.ibody).compound;var y=null==c?null:c.group;if(null==y)u=!1;else{for(var _=!1;null!=d&&null!=y;){if(d==y){_=d.ignore;break}d.depth<y.depth?y=y.group:d=d.group}u=_}}r=!u}if(r){if(!(!t.sensorEnabled&&!e.sensorEnabled)&&(s=t.filter,o=e.filter,0!=(s.sensorMask&o.sensorGroup)&&0!=(o.sensorMask&s.sensorGroup)))return 2;if(!!(!(!t.fluidEnabled&&!e.fluidEnabled)&&(o=t.filter,s=e.filter,0!=(o.fluidMask&s.fluidGroup)&&0!=(s.fluidMask&o.fluidGroup)))&&!(0==i.imass&&0==n.imass&&0==i.iinertia&&0==n.iinertia))return 0;var t=t.filter,e=e.filter,t=0!=(t.collisionMask&e.collisionGroup)&&0!=(e.collisionMask&t.collisionGroup)&&!(0==i.imass&&0==n.imass&&0==i.iinertia&&0==n.iinertia);return t?1:-1}return-1},ii.prototype.precb=null,ii.prototype.prelisteners=null,ii.prototype.narrowPhase=function(t,e,i,n,r){for(var o,s,a,h=null,l=t.body,p=e.body,u=!1,d=l.constraints.head;null!=d;){var c=d.elt;if(c.ignore&&c.pair_exists(l.id,p.id)){u=!0;break}d=d.next}if(u)o=!1;else{for(var y=t;null!=y&&null==y.group;)y=null!=y.ishape?y.ishape.body:(null!=y.icompound?y.icompound:y.ibody).compound;var _,m=null==y?null:y.group;if(null==m)_=!1;else{for(var g=e;null!=g&&null==g.group;)g=null!=g.ishape?g.ishape.body:(null!=g.icompound?g.icompound:g.ibody).compound;var f=null==g?null:g.group;if(null==f)_=!1;else{for(var x=!1;null!=m&&null!=f;){if(m==f){x=m.ignore;break}m.depth<f.depth?f=f.group:m=m.group}_=x}}o=!_}if(-1!=(ie=o?!(!t.sensorEnabled&&!e.sensorEnabled)&&(ie=t.filter,o=e.filter,0!=(ie.sensorMask&o.sensorGroup)&&0!=(o.sensorMask&ie.sensorGroup))?2:!!(!(!t.fluidEnabled&&!e.fluidEnabled)&&(I=t.filter,z=e.filter,0!=(I.fluidMask&z.fluidGroup)&&0!=(z.fluidMask&I.fluidGroup)))&&!(0==l.imass&&0==p.imass&&0==l.iinertia&&0==p.iinertia)?0:(M=t.filter,G=e.filter,0!=(M.collisionMask&G.collisionGroup)&&0!=(G.collisionMask&M.collisionGroup)&&!(0==l.imass&&0==p.imass&&0==l.iinertia&&0==p.iinertia)?1:-1):-1)){t.type>e.type?(s=e,a=t):t.type!=e.type||t.id<e.id?(s=t,a=e):(a=t,s=e);var v,w,z=s==e;if(0==ie){if(null==n){for(var b=null,S=(l.arbiters.length<p.arbiters.length?l:p).arbiters.head;null!=S;){var C=S.elt;if(C.id==s.id&&C.di==a.id){b=C;break}S=S.next}v=b}else v=n;var P,M,T,A,k,O,E,I=null==v,G=!1;if(I)null==Zn.zpp_pool?P=new Zn:(P=Zn.zpp_pool,Zn.zpp_pool=P.next,P.next=null);else if(null==v.fluidarb){v.cleared=!0;for(var D,L,B=v.b1.arbiters,R=null,F=B.head;null!=F;){if(F.elt==v){null==R?(L=(D=B.head).next,B.head=L,null==B.head&&(B.pushmod=!0)):(L=(D=R.next).next,null==(R.next=L)&&(B.pushmod=!0));var N=D;N.elt=null,N.next=er.zpp_pool,er.zpp_pool=N,B.modified=!0,B.length--,B.pushmod=!0;break}F=(R=F).next}for(var j,U,V=v.b2.arbiters,W=null,X=V.head;null!=X;){if(X.elt==v){null==W?(U=(j=V.head).next,V.head=U,null==V.head&&(V.pushmod=!0)):(U=(j=W.next).next,null==(W.next=U)&&(V.pushmod=!0));var H=j;H.elt=null,H.next=er.zpp_pool,er.zpp_pool=H,V.modified=!0,V.length--,V.pushmod=!0;break}X=(W=X).next}null!=v.pair&&(v.pair.arb=null,v.pair=null),v.active=!1,this.f_arbiters.modified=!0,null==Zn.zpp_pool?P=new Zn:(P=Zn.zpp_pool,Zn.zpp_pool=P.next,P.next=null),G=I=P.intchange=!0}else P=v.fluidarb;if(I||P.stamp!=this.stamp||r)if(P.stamp=this.stamp,Ir.flowCollide(s,a,P)){if(I?(M=s.id,Y=a.id,P.b1=t.body,P.ws1=t,P.b2=e.body,P.ws2=e,P.id=M,P.di=Y,Y=P.b1.arbiters,null==er.zpp_pool?T=new er:(T=er.zpp_pool,er.zpp_pool=T.next,T.next=null),T.elt=P,(T=T).next=Y.head,Y.head=T,Y.modified=!0,Y.length++,Y=P.b2.arbiters,null==er.zpp_pool?A=new er:(A=er.zpp_pool,er.zpp_pool=A.next,A.next=null),A.elt=P,(A=A).next=Y.head,Y.head=A,Y.modified=!0,Y.length++,P.active=!0,P.present=0,P.cleared=!1,P.sleeping=!1,P.fresh=!1,P.presentable=!1,P.nx=0,P.ny=1,P.dampx=0,P.dampy=0,P.adamp=0,Y=this.f_arbiters,null==rr.zpp_pool?k=new rr:(k=rr.zpp_pool,rr.zpp_pool=k.next,k.next=null),k.elt=P,(k=k).next=Y.head,Y.head=k,Y.modified=!0,Y.length++,P.fresh=!G):P.fresh=P.up_stamp<this.stamp-1||P.endGenerated==this.stamp&&r,P.up_stamp=P.stamp,P.fresh||0==(4&P.immState)){for(var q=!(P.immState=1),Y=P.ws1.id>P.ws2.id?P.ws2:P.ws1,G=P.ws1.id>P.ws2.id?P.ws1:P.ws2,K=this.mrca1;null!=K.head;){var Z=K.head;K.head=Z.next,Z.elt=null,Z.next=nr.zpp_pool,nr.zpp_pool=Z,null==K.head&&(K.pushmod=!0),K.modified=!0,K.length--}K.pushmod=!0;for(var J,Q,$,tt,et,it,nt=this.mrca2;null!=nt.head;){var rt=nt.head;nt.head=rt.next,rt.elt=null,rt.next=nr.zpp_pool,nr.zpp_pool=rt,null==nt.head&&(nt.pushmod=!0),nt.modified=!0,nt.length--}nt.pushmod=!0,null!=Y.cbSet&&(Q=this.mrca1,null==nr.zpp_pool?J=new nr:(J=nr.zpp_pool,nr.zpp_pool=J.next,J.next=null),J.elt=Y,(J=J).next=Q.head,Q.head=J,Q.modified=!0,Q.length++),null!=Y.body.cbSet&&(J=this.mrca1,Q=Y.body,null==nr.zpp_pool?$=new nr:($=nr.zpp_pool,nr.zpp_pool=$.next,$.next=null),$.elt=Q,($=$).next=J.head,J.head=$,J.modified=!0,J.length++),null!=G.cbSet&&(et=this.mrca2,null==nr.zpp_pool?tt=new nr:(tt=nr.zpp_pool,nr.zpp_pool=tt.next,tt.next=null),tt.elt=G,(tt=tt).next=et.head,et.head=tt,et.modified=!0,et.length++),null!=G.body.cbSet&&(tt=this.mrca2,et=G.body,null==nr.zpp_pool?it=new nr:(it=nr.zpp_pool,nr.zpp_pool=it.next,it.next=null),it.elt=et,(it=it).next=tt.head,tt.head=it,tt.modified=!0,tt.length++);for(var ot,st,at,ht,lt=Y.body.compound,pt=G.body.compound;lt!=pt;)(null==lt?0:lt.depth)<(null==pt?0:pt.depth)?(null!=pt.cbSet&&(ht=this.mrca2,null==nr.zpp_pool?ot=new nr:(ot=nr.zpp_pool,nr.zpp_pool=ot.next,ot.next=null),ot.elt=pt,(st=ot).next=ht.head,ht.head=st,ht.modified=!0,ht.length++),pt=pt.compound):(null!=lt.cbSet&&(st=this.mrca1,null==nr.zpp_pool?at=new nr:(at=nr.zpp_pool,nr.zpp_pool=at.next,at.next=null),at.elt=lt,(ht=at).next=st.head,st.head=ht,st.modified=!0,st.length++),lt=lt.compound);for(var ut,dt=this.mrca1.head;null!=dt;){for(var ct=dt.elt,yt=this.mrca2.head;null!=yt;){for(var _t,mt=yt.elt,gt=ct.cbSet,ft=mt.cbSet,xt=null,vt=(gt.cbpairs.length<ft.cbpairs.length?gt:ft).cbpairs.head;null!=vt;){var wt=vt.elt;if(wt.a==gt&&wt.b==ft||wt.a==ft&&wt.b==gt){xt=wt;break}vt=vt.next}if(null==xt&&(null==qn.zpp_pool?_t=new qn:(_t=qn.zpp_pool,qn.zpp_pool=_t.next,_t.next=null),_t.zip_listeners=!0,Hn.setlt(gt,ft)?(_t.a=gt,_t.b=ft):(_t.a=ft,_t.b=gt),xt=_t,gt.cbpairs.add(xt),ft!=gt&&ft.cbpairs.add(xt)),xt.zip_listeners&&(xt.zip_listeners=!1,xt.__validate()),null!=xt.listeners.head){for(var zt=null,bt=null,St=this.prelisteners;null!=St.head;){var Ct=St.head;St.head=Ct.next,Ct.elt=null,Ct.next=ir.zpp_pool,ir.zpp_pool=Ct,null==St.head&&(St.pushmod=!0),St.modified=!0,St.length--}St.pushmod=!0;for(var Pt,Mt=null,Tt=null,At=(gt.cbpairs.length<ft.cbpairs.length?gt:ft).cbpairs.head;null!=At;){var kt=At.elt;if(kt.a==gt&&kt.b==ft||kt.a==ft&&kt.b==gt){Tt=kt;break}At=At.next}null==Tt&&(null==qn.zpp_pool?Pt=new qn:(Pt=qn.zpp_pool,qn.zpp_pool=Pt.next,Pt.next=null),Pt.zip_listeners=!0,Hn.setlt(gt,ft)?(Pt.a=gt,Pt.b=ft):(Pt.a=ft,Pt.b=gt),Tt=Pt,gt.cbpairs.add(Tt),ft!=gt&&ft.cbpairs.add(Tt)),Tt.zip_listeners&&(Tt.zip_listeners=!1,Tt.__validate());for(var Ot=Tt.listeners.head;null!=Ot;){var Et,It,Gt,Dt=Ot.elt;5==Dt.event&&0!=(4&Dt.itype)&&(Et=this.prelisteners,null==ir.zpp_pool?It=new ir:(It=ir.zpp_pool,ir.zpp_pool=It.next,It.next=null),It.elt=Dt,Gt=It,null==Mt?(Gt.next=Et.head,Et.head=Gt):(Gt.next=Mt.next,Mt.next=Gt),Et.pushmod=Et.modified=!0,Et.length++,Mt=Gt,q=!!q||!Dt.pure),Ot=Ot.next}if(null!=this.prelisteners.head){if(null==(zt=$n.get(ct,mt))&&(bt=tr.get(ct,mt),this.add_callbackset(bt)),null==zt||(zt.FLUIDstamp!=this.stamp||r)&&0==(4&zt.FLUIDstate)){if(null!=(zt=null!=bt?bt:zt))for(var Lt=this.prelisteners.head;null!=Lt;)7==Lt.elt.itype&&(zt.COLLISIONstamp=this.stamp,zt.SENSORstamp=this.stamp),zt.FLUIDstamp=this.stamp,Lt=Lt.next;bt=P.active;P.active=!0,this.precb.zpp_inner.pre_arbiter=P,this.precb.zpp_inner.set=zt;for(var Bt=this.prelisteners.head;null!=Bt;){var Rt=Bt.elt;this.precb.zpp_inner.listener=Rt;var Ft=this.precb.zpp_inner,Nt=zt.int1,jt=zt.int2,Ut=Rt.options1,Vt=Nt.cbTypes;!(!Ut.nonemptyintersection(Vt,Ut.includes)||Ut.nonemptyintersection(Vt,Ut.excludes))&&(Vt=Rt.options2,Ut=jt.cbTypes,!!Vt.nonemptyintersection(Ut,Vt.includes)&&!Vt.nonemptyintersection(Ut,Vt.excludes))?(Ft.int1=Nt,Ft.int2=jt):(Ft.int1=jt,Ft.int2=Nt),this.precb.zpp_inner.pre_swapped=ct!=this.precb.zpp_inner.int1;var Rt=Rt.handlerp(this.precb);null!=Rt&&(null==Yn.PreFlag_ACCEPT&&(Yn.internal=!0,Yn.PreFlag_ACCEPT=new Xn,Yn.internal=!1),Rt=Rt==Yn.PreFlag_ACCEPT?5:(null==Yn.PreFlag_ACCEPT_ONCE&&(Yn.internal=!0,Yn.PreFlag_ACCEPT_ONCE=new Xn,Yn.internal=!1),Rt==Yn.PreFlag_ACCEPT_ONCE?1:(null==Yn.PreFlag_IGNORE&&(Yn.internal=!0,Yn.PreFlag_IGNORE=new Xn,Yn.internal=!1),Rt==Yn.PreFlag_IGNORE?6:2)),P.immState=Rt),Bt=Bt.next}if(P.active=bt,null!=zt)for(var Wt=this.prelisteners.head;null!=Wt;)7==Wt.elt.itype&&(zt.COLLISIONstate=P.immState,zt.SENSORstate=P.immState),zt.FLUIDstate=P.immState,Wt=Wt.next}else null==zt?0==(4&P.immState)&&(P.immState=1):P.immState=zt.FLUIDstate;yt=yt.next}else yt=yt.next}else yt=yt.next}dt=dt.next}q&&0==(4&P.immState)&&(2==P.b1.type&&((G=P.b1).world||(G.component.waket=this.stamp+(this.midstep?0:1),3==G.type&&(G.kinematicDelaySleep=!0),G.component.sleeping&&this.really_wake(G,!1))),2==P.b1.type&&((ut=P.b2).world||(ut.component.waket=this.stamp+(this.midstep?0:1),3==ut.type&&(ut.kinematicDelaySleep=!0),ut.component.sleeping&&this.really_wake(ut,!1))))}0!=(1&P.immState)&&(2==P.b1.type&&P.b1.component.sleeping&&((ut=P.b1).world||(ut.component.waket=this.stamp+(this.midstep?0:1),3==ut.type&&(ut.kinematicDelaySleep=!0),ut.component.sleeping&&this.really_wake(ut,!1))),2==P.b2.type&&P.b2.component.sleeping&&((O=P.b2).world||(O.component.waket=this.stamp+(this.midstep?0:1),3==O.type&&(O.kinematicDelaySleep=!0),O.component.sleeping&&this.really_wake(O,!1)))),P.sleeping&&(P.sleeping=!1,O=this.f_arbiters,null==rr.zpp_pool?E=new rr:(E=rr.zpp_pool,rr.zpp_pool=E.next,E.next=null),E.elt=P,(E=E).next=O.head,O.head=E,O.modified=!0,O.length++),h=P}else h=I?((Ht=P).next=Zn.zpp_pool,Zn.zpp_pool=Ht,null):P;else h=P}else if(1==ie){var Xt,Ht=i?this.c_arbiters_true:this.c_arbiters_false;if(null==n){for(var qt=null,Yt=(l.arbiters.length<p.arbiters.length?l:p).arbiters.head;null!=Yt;){var Kt=Yt.elt;if(Kt.id==s.id&&Kt.di==a.id){qt=Kt;break}Yt=Yt.next}Xt=qt}else Xt=n;var Zt,Jt,Qt,$t,te,ee=null==Xt,ie=!1;if(ee)null==Jn.zpp_pool?Zt=new Jn:(Zt=Jn.zpp_pool,Jn.zpp_pool=Zt.next,Zt.next=null),Zt.stat=i;else if(null==Xt.colarb){Xt.cleared=!0;for(var ne,re,oe=Xt.b1.arbiters,se=null,ae=oe.head;null!=ae;){if(ae.elt==Xt){null==se?(re=(ne=oe.head).next,oe.head=re,null==oe.head&&(oe.pushmod=!0)):(re=(ne=se.next).next,null==(se.next=re)&&(oe.pushmod=!0));var he=ne;he.elt=null,he.next=er.zpp_pool,er.zpp_pool=he,oe.modified=!0,oe.length--,oe.pushmod=!0;break}ae=(se=ae).next}for(var le,pe,ue=Xt.b2.arbiters,de=null,ce=ue.head;null!=ce;){if(ce.elt==Xt){null==de?(pe=(le=ue.head).next,ue.head=pe,null==ue.head&&(ue.pushmod=!0)):(pe=(le=de.next).next,null==(de.next=pe)&&(ue.pushmod=!0));var ye=le;ye.elt=null,ye.next=er.zpp_pool,er.zpp_pool=ye,ue.modified=!0,ue.length--,ue.pushmod=!0;break}ce=(de=ce).next}null!=Xt.pair&&(Xt.pair.arb=null,Xt.pair=null),Xt.active=!1,this.f_arbiters.modified=!0,null==Jn.zpp_pool?Zt=new Jn:(Zt=Jn.zpp_pool,Jn.zpp_pool=Zt.next,Zt.next=null),Zt.intchange=!0,Zt.stat=i,ie=ee=!0}else z=s!=(Zt=Xt.colarb).s1,Zt.stat!=i&&(Zt.stat=i,Zt.sleeping||((i?this.c_arbiters_false:this.c_arbiters_true).remove(Zt),Ht.add(Zt)));if(ee||Zt.stamp!=this.stamp||r)if(Zt.stamp=this.stamp,Ir.contactCollide(s,a,Zt,z)){if(ee?(i=s.id,z=a.id,Zt.b1=t.body,Zt.ws1=t,Zt.b2=e.body,Zt.ws2=e,Zt.id=i,Zt.di=z,z=Zt.b1.arbiters,null==er.zpp_pool?Jt=new er:(Jt=er.zpp_pool,er.zpp_pool=Jt.next,Jt.next=null),Jt.elt=Zt,(Jt=Jt).next=z.head,z.head=Jt,z.modified=!0,z.length++,z=Zt.b2.arbiters,null==er.zpp_pool?Qt=new er:(Qt=er.zpp_pool,er.zpp_pool=Qt.next,Qt.next=null),Qt.elt=Zt,(Qt=Qt).next=z.head,z.head=Qt,z.modified=!0,z.length++,Zt.active=!0,Zt.present=0,Zt.cleared=!1,Zt.sleeping=!1,Zt.fresh=!1,Zt.presentable=!1,Zt.s1=t,Zt.s2=e,Zt.userdef_restitution||(Zt.s1.material.elasticity<=-1/0||Zt.s2.material.elasticity<=-1/0?Zt.restitution=0:Zt.s1.material.elasticity>=1/0||Zt.s2.material.elasticity>=1/0?Zt.restitution=1:Zt.restitution=(Zt.s1.material.elasticity+Zt.s2.material.elasticity)/2,Zt.restitution<0&&(Zt.restitution=0),1<Zt.restitution&&(Zt.restitution=1)),Zt.userdef_dyn_fric||(Zt.dyn_fric=Math.sqrt(Zt.s1.material.dynamicFriction*Zt.s2.material.dynamicFriction)),Zt.userdef_stat_fric||(Zt.stat_fric=Math.sqrt(Zt.s1.material.staticFriction*Zt.s2.material.staticFriction)),Zt.userdef_rfric||(Zt.rfric=Math.sqrt(Zt.s1.material.rollingFriction*Zt.s2.material.rollingFriction)),null==sr.zpp_pool?me=new sr:(me=sr.zpp_pool,sr.zpp_pool=me.next,me.next=null),me.elt=Zt,(me=me).next=Ht.head,Ht.head=me,Ht.modified=!0,Ht.length++,Zt.fresh=!ie):Zt.fresh=Zt.up_stamp<this.stamp-1||Zt.endGenerated==this.stamp&&r,Zt.up_stamp=Zt.stamp,Zt.fresh||0==(4&Zt.immState)){for(var _e=!(Zt.immState=1),me=Zt.ws1.id>Zt.ws2.id?Zt.ws2:Zt.ws1,ie=Zt.ws1.id>Zt.ws2.id?Zt.ws1:Zt.ws2,ge=this.mrca1;null!=ge.head;){var fe=ge.head;ge.head=fe.next,fe.elt=null,fe.next=nr.zpp_pool,nr.zpp_pool=fe,null==ge.head&&(ge.pushmod=!0),ge.modified=!0,ge.length--}ge.pushmod=!0;for(var xe,ve,we,ze,be,Se,Ce=this.mrca2;null!=Ce.head;){var Pe=Ce.head;Ce.head=Pe.next,Pe.elt=null,Pe.next=nr.zpp_pool,nr.zpp_pool=Pe,null==Ce.head&&(Ce.pushmod=!0),Ce.modified=!0,Ce.length--}Ce.pushmod=!0,null!=me.cbSet&&(ve=this.mrca1,null==nr.zpp_pool?xe=new nr:(xe=nr.zpp_pool,nr.zpp_pool=xe.next,xe.next=null),xe.elt=me,(xe=xe).next=ve.head,ve.head=xe,ve.modified=!0,ve.length++),null!=me.body.cbSet&&(xe=this.mrca1,ve=me.body,null==nr.zpp_pool?we=new nr:(we=nr.zpp_pool,nr.zpp_pool=we.next,we.next=null),we.elt=ve,(we=we).next=xe.head,xe.head=we,xe.modified=!0,xe.length++),null!=ie.cbSet&&(be=this.mrca2,null==nr.zpp_pool?ze=new nr:(ze=nr.zpp_pool,nr.zpp_pool=ze.next,ze.next=null),ze.elt=ie,(ze=ze).next=be.head,be.head=ze,be.modified=!0,be.length++),null!=ie.body.cbSet&&(ze=this.mrca2,be=ie.body,null==nr.zpp_pool?Se=new nr:(Se=nr.zpp_pool,nr.zpp_pool=Se.next,Se.next=null),Se.elt=be,(Se=Se).next=ze.head,ze.head=Se,ze.modified=!0,ze.length++);for(var Me,Te,Ae,ke,Oe=me.body.compound,Ee=ie.body.compound;Oe!=Ee;)(null==Oe?0:Oe.depth)<(null==Ee?0:Ee.depth)?(null!=Ee.cbSet&&(ke=this.mrca2,null==nr.zpp_pool?Me=new nr:(Me=nr.zpp_pool,nr.zpp_pool=Me.next,Me.next=null),Me.elt=Ee,(Te=Me).next=ke.head,ke.head=Te,ke.modified=!0,ke.length++),Ee=Ee.compound):(null!=Oe.cbSet&&(Te=this.mrca1,null==nr.zpp_pool?Ae=new nr:(Ae=nr.zpp_pool,nr.zpp_pool=Ae.next,Ae.next=null),Ae.elt=Oe,(ke=Ae).next=Te.head,Te.head=ke,Te.modified=!0,Te.length++),Oe=Oe.compound);for(var Ie,Ge=this.mrca1.head;null!=Ge;){for(var De=Ge.elt,Le=this.mrca2.head;null!=Le;){for(var Be,Re=Le.elt,Fe=De.cbSet,Ne=Re.cbSet,je=null,Ue=(Fe.cbpairs.length<Ne.cbpairs.length?Fe:Ne).cbpairs.head;null!=Ue;){var Ve=Ue.elt;if(Ve.a==Fe&&Ve.b==Ne||Ve.a==Ne&&Ve.b==Fe){je=Ve;break}Ue=Ue.next}if(null==je&&(null==qn.zpp_pool?Be=new qn:(Be=qn.zpp_pool,qn.zpp_pool=Be.next,Be.next=null),Be.zip_listeners=!0,Hn.setlt(Fe,Ne)?(Be.a=Fe,Be.b=Ne):(Be.a=Ne,Be.b=Fe),je=Be,Fe.cbpairs.add(je),Ne!=Fe&&Ne.cbpairs.add(je)),je.zip_listeners&&(je.zip_listeners=!1,je.__validate()),null!=je.listeners.head){for(var We=null,Xe=null,He=this.prelisteners;null!=He.head;){var qe=He.head;He.head=qe.next,qe.elt=null,qe.next=ir.zpp_pool,ir.zpp_pool=qe,null==He.head&&(He.pushmod=!0),He.modified=!0,He.length--}He.pushmod=!0;for(var Ye,Ke=null,Ze=null,Je=(Fe.cbpairs.length<Ne.cbpairs.length?Fe:Ne).cbpairs.head;null!=Je;){var Qe=Je.elt;if(Qe.a==Fe&&Qe.b==Ne||Qe.a==Ne&&Qe.b==Fe){Ze=Qe;break}Je=Je.next}null==Ze&&(null==qn.zpp_pool?Ye=new qn:(Ye=qn.zpp_pool,qn.zpp_pool=Ye.next,Ye.next=null),Ye.zip_listeners=!0,Hn.setlt(Fe,Ne)?(Ye.a=Fe,Ye.b=Ne):(Ye.a=Ne,Ye.b=Fe),Ze=Ye,Fe.cbpairs.add(Ze),Ne!=Fe&&Ne.cbpairs.add(Ze)),Ze.zip_listeners&&(Ze.zip_listeners=!1,Ze.__validate());for(var $e=Ze.listeners.head;null!=$e;){var ti,ei,ii,ni=$e.elt;5==ni.event&&0!=(1&ni.itype)&&(ti=this.prelisteners,null==ir.zpp_pool?ei=new ir:(ei=ir.zpp_pool,ir.zpp_pool=ei.next,ei.next=null),ei.elt=ni,ii=ei,null==Ke?(ii.next=ti.head,ti.head=ii):(ii.next=Ke.next,Ke.next=ii),ti.pushmod=ti.modified=!0,ti.length++,Ke=ii,_e=!!_e||!ni.pure),$e=$e.next}if(null!=this.prelisteners.head){if(null==(We=$n.get(De,Re))&&(Xe=tr.get(De,Re),this.add_callbackset(Xe)),null==We||(We.COLLISIONstamp!=this.stamp||r)&&0==(4&We.COLLISIONstate)){if(null!=(We=null!=Xe?Xe:We))for(var ri=this.prelisteners.head;null!=ri;)7==ri.elt.itype?(We.COLLISIONstamp=this.stamp,We.SENSORstamp=this.stamp,We.FLUIDstamp=this.stamp):We.COLLISIONstamp=this.stamp,ri=ri.next;var Re=Zt.active,oi=Zt.active=!0,si=null,ai=null,hi=Zt.innards.next;Zt.hc2=!1;for(var li=Zt.contacts.next;null!=li;){var pi,ui,di,ci,yi,_i,mi=li;mi.stamp+Er.arbiterExpirationDelay<Zt.stamp?(yi=Zt.contacts,null==si?(ui=(pi=yi.next).next,yi.next=ui,null==yi.next&&(yi.pushmod=!0)):(ui=(pi=si.next).next,null==(si.next=ui)&&(yi.pushmod=!0)),pi._inuse=!1,yi.modified=!0,yi.length--,yi.pushmod=!0,li=ui,_i=Zt.innards,null==ai?(ci=(di=_i.next).next,_i.next=ci,null==_i.next&&(_i.pushmod=!0)):(ci=(di=ai.next).next,null==(ai.next=ci)&&(_i.pushmod=!0)),di._inuse=!1,_i.modified=!0,_i.length--,_i.pushmod=!0,hi=ci,mi.arbiter=null,mi.next=Qn.zpp_pool,Qn.zpp_pool=mi):(yi=mi.inner,_i=mi.active,mi.active=mi.stamp==Zt.stamp,mi.active&&(oi?(oi=!1,Zt.c1=yi,Zt.oc1=mi):(Zt.hc2=!0,Zt.c2=yi,Zt.oc2=mi)),_i!=mi.active&&(Zt.contacts.modified=!0),si=li,hi=(ai=hi).next,li=li.next)}Zt.hc2?(Zt.hpc2=!0,Zt.oc1.posOnly?(Xe=Zt.c1,Zt.c1=Zt.c2,Zt.c2=Xe,Xe=Zt.oc1,Zt.oc1=Zt.oc2,Zt.oc2=Xe,Zt.hc2=!1):Zt.oc2.posOnly&&(Zt.hc2=!1)):Zt.hpc2=!1,this.precb.zpp_inner.pre_arbiter=Zt,this.precb.zpp_inner.set=We;for(var gi=this.prelisteners.head;null!=gi;){var fi=gi.elt;this.precb.zpp_inner.listener=fi;var xi=this.precb.zpp_inner,vi=We.int1,wi=We.int2,zi=fi.options1,bi=vi.cbTypes;!(!zi.nonemptyintersection(bi,zi.includes)||zi.nonemptyintersection(bi,zi.excludes))&&(bi=fi.options2,zi=wi.cbTypes,!!bi.nonemptyintersection(zi,bi.includes)&&!bi.nonemptyintersection(zi,bi.excludes))?(xi.int1=vi,xi.int2=wi):(xi.int1=wi,xi.int2=vi),this.precb.zpp_inner.pre_swapped=De!=this.precb.zpp_inner.int1;var fi=fi.handlerp(this.precb);null!=fi&&(null==Yn.PreFlag_ACCEPT&&(Yn.internal=!0,Yn.PreFlag_ACCEPT=new Xn,Yn.internal=!1),fi=fi==Yn.PreFlag_ACCEPT?5:(null==Yn.PreFlag_ACCEPT_ONCE&&(Yn.internal=!0,Yn.PreFlag_ACCEPT_ONCE=new Xn,Yn.internal=!1),fi==Yn.PreFlag_ACCEPT_ONCE?1:(null==Yn.PreFlag_IGNORE&&(Yn.internal=!0,Yn.PreFlag_IGNORE=new Xn,Yn.internal=!1),fi==Yn.PreFlag_IGNORE?6:2)),Zt.immState=fi),gi=gi.next}if(Zt.active=Re,null!=We)for(var Si=this.prelisteners.head;null!=Si;)7==Si.elt.itype?(We.COLLISIONstate=Zt.immState,We.SENSORstate=Zt.immState,We.FLUIDstate=Zt.immState):We.COLLISIONstate=Zt.immState,Si=Si.next}else null==We?0==(4&Zt.immState)&&(Zt.immState=1):Zt.immState=We.COLLISIONstate;Le=Le.next}else Le=Le.next}else Le=Le.next}Ge=Ge.next}_e&&0==(4&Zt.immState)&&(2==Zt.b1.type&&((Ie=Zt.b1).world||(Ie.component.waket=this.stamp+(this.midstep?0:1),3==Ie.type&&(Ie.kinematicDelaySleep=!0),Ie.component.sleeping&&this.really_wake(Ie,!1))),2==Zt.b1.type&&((Ie=Zt.b2).world||(Ie.component.waket=this.stamp+(this.midstep?0:1),3==Ie.type&&(Ie.kinematicDelaySleep=!0),Ie.component.sleeping&&this.really_wake(Ie,!1))))}0!=(1&Zt.immState)&&(2==Zt.b1.type&&Zt.b1.component.sleeping&&(($t=Zt.b1).world||($t.component.waket=this.stamp+(this.midstep?0:1),3==$t.type&&($t.kinematicDelaySleep=!0),$t.component.sleeping&&this.really_wake($t,!1))),2==Zt.b2.type&&Zt.b2.component.sleeping&&(($t=Zt.b2).world||($t.component.waket=this.stamp+(this.midstep?0:1),3==$t.type&&($t.kinematicDelaySleep=!0),$t.component.sleeping&&this.really_wake($t,!1)))),Zt.sleeping&&(Zt.sleeping=!1,null==sr.zpp_pool?te=new sr:(te=sr.zpp_pool,sr.zpp_pool=te.next,te.next=null),te.elt=Zt,(te=te).next=Ht.head,Ht.head=te,Ht.modified=!0,Ht.length++),h=Zt}else h=ee?((Ii=Zt).userdef_dyn_fric=!1,Ii.userdef_stat_fric=!1,Ii.userdef_restitution=!1,Ii.userdef_rfric=!1,Ii.__ref_edge1=Ii.__ref_edge2=null,Ii.next=Jn.zpp_pool,Jn.zpp_pool=Ii,null):Zt;else h=Zt}else{if(null==n){for(var Ci=null,Pi=(l.arbiters.length<p.arbiters.length?l:p).arbiters.head;null!=Pi;){var Mi=Pi.elt;if(Mi.id==s.id&&Mi.di==a.id){Ci=Mi;break}Pi=Pi.next}w=Ci}else w=n;var Ti,Ai,ki,Oi,Ei,ee=null==w,Ii=!1;if(ee)null==Kn.zpp_pool?Ti=new Kn:(Ti=Kn.zpp_pool,Kn.zpp_pool=Ti.next,Ti.next=null);else if(null==w.sensorarb){w.cleared=!0;for(var Gi,Di,Li=w.b1.arbiters,Bi=null,Ri=Li.head;null!=Ri;){if(Ri.elt==w){null==Bi?(Di=(Gi=Li.head).next,Li.head=Di,null==Li.head&&(Li.pushmod=!0)):(Di=(Gi=Bi.next).next,null==(Bi.next=Di)&&(Li.pushmod=!0));var Fi=Gi;Fi.elt=null,Fi.next=er.zpp_pool,er.zpp_pool=Fi,Li.modified=!0,Li.length--,Li.pushmod=!0;break}Ri=(Bi=Ri).next}for(var Ni,ji,Ui=w.b2.arbiters,Vi=null,Wi=Ui.head;null!=Wi;){if(Wi.elt==w){null==Vi?(ji=(Ni=Ui.head).next,Ui.head=ji,null==Ui.head&&(Ui.pushmod=!0)):(ji=(Ni=Vi.next).next,null==(Vi.next=ji)&&(Ui.pushmod=!0));var Xi=Ni;Xi.elt=null,Xi.next=er.zpp_pool,er.zpp_pool=Xi,Ui.modified=!0,Ui.length--,Ui.pushmod=!0;break}Wi=(Vi=Wi).next}null!=w.pair&&(w.pair.arb=null,w.pair=null),w.active=!1,this.f_arbiters.modified=!0,null==Kn.zpp_pool?Ti=new Kn:(Ti=Kn.zpp_pool,Kn.zpp_pool=Ti.next,Ti.next=null),Ii=ee=Ti.intchange=!0}else Ti=w.sensorarb;if(ee||Ti.stamp!=this.stamp||r)if(Ti.stamp=this.stamp,Ir.testCollide(s,a)){if(ee?(n=s.id,qi=a.id,Ti.b1=t.body,Ti.ws1=t,Ti.b2=e.body,Ti.ws2=e,Ti.id=n,Ti.di=qi,qi=Ti.b1.arbiters,null==er.zpp_pool?Ai=new er:(Ai=er.zpp_pool,er.zpp_pool=Ai.next,Ai.next=null),Ai.elt=Ti,(Ai=Ai).next=qi.head,qi.head=Ai,qi.modified=!0,qi.length++,qi=Ti.b2.arbiters,null==er.zpp_pool?ki=new er:(ki=er.zpp_pool,er.zpp_pool=ki.next,ki.next=null),ki.elt=Ti,(ki=ki).next=qi.head,qi.head=ki,qi.modified=!0,qi.length++,Ti.active=!0,Ti.present=0,Ti.cleared=!1,Ti.sleeping=!1,Ti.fresh=!1,Ti.presentable=!1,qi=this.s_arbiters,null==or.zpp_pool?Oi=new or:(Oi=or.zpp_pool,or.zpp_pool=Oi.next,Oi.next=null),Oi.elt=Ti,(Oi=Oi).next=qi.head,qi.head=Oi,qi.modified=!0,qi.length++,Ti.fresh=!Ii):Ti.fresh=Ti.up_stamp<this.stamp-1||Ti.endGenerated==this.stamp&&r,Ti.up_stamp=Ti.stamp,Ti.fresh||0==(4&Ti.immState)){for(var Hi=!(Ti.immState=1),qi=Ti.ws1.id>Ti.ws2.id?Ti.ws2:Ti.ws1,Ii=Ti.ws1.id>Ti.ws2.id?Ti.ws1:Ti.ws2,Yi=this.mrca1;null!=Yi.head;){var Ki=Yi.head;Yi.head=Ki.next,Ki.elt=null,Ki.next=nr.zpp_pool,nr.zpp_pool=Ki,null==Yi.head&&(Yi.pushmod=!0),Yi.modified=!0,Yi.length--}Yi.pushmod=!0;for(var Zi,Ji,Qi,$i,tn,en,nn=this.mrca2;null!=nn.head;){var rn=nn.head;nn.head=rn.next,rn.elt=null,rn.next=nr.zpp_pool,nr.zpp_pool=rn,null==nn.head&&(nn.pushmod=!0),nn.modified=!0,nn.length--}nn.pushmod=!0,null!=qi.cbSet&&(Ji=this.mrca1,null==nr.zpp_pool?Zi=new nr:(Zi=nr.zpp_pool,nr.zpp_pool=Zi.next,Zi.next=null),Zi.elt=qi,(Zi=Zi).next=Ji.head,Ji.head=Zi,Ji.modified=!0,Ji.length++),null!=qi.body.cbSet&&(Zi=this.mrca1,Ji=qi.body,null==nr.zpp_pool?Qi=new nr:(Qi=nr.zpp_pool,nr.zpp_pool=Qi.next,Qi.next=null),Qi.elt=Ji,(Qi=Qi).next=Zi.head,Zi.head=Qi,Zi.modified=!0,Zi.length++),null!=Ii.cbSet&&(tn=this.mrca2,null==nr.zpp_pool?$i=new nr:($i=nr.zpp_pool,nr.zpp_pool=$i.next,$i.next=null),$i.elt=Ii,($i=$i).next=tn.head,tn.head=$i,tn.modified=!0,tn.length++),null!=Ii.body.cbSet&&($i=this.mrca2,tn=Ii.body,null==nr.zpp_pool?en=new nr:(en=nr.zpp_pool,nr.zpp_pool=en.next,en.next=null),en.elt=tn,(en=en).next=$i.head,$i.head=en,$i.modified=!0,$i.length++);for(var on,sn,an,hn,ln=qi.body.compound,pn=Ii.body.compound;ln!=pn;)(null==ln?0:ln.depth)<(null==pn?0:pn.depth)?(null!=pn.cbSet&&(hn=this.mrca2,null==nr.zpp_pool?on=new nr:(on=nr.zpp_pool,nr.zpp_pool=on.next,on.next=null),on.elt=pn,(sn=on).next=hn.head,hn.head=sn,hn.modified=!0,hn.length++),pn=pn.compound):(null!=ln.cbSet&&(sn=this.mrca1,null==nr.zpp_pool?an=new nr:(an=nr.zpp_pool,nr.zpp_pool=an.next,an.next=null),an.elt=ln,(hn=an).next=sn.head,sn.head=hn,sn.modified=!0,sn.length++),ln=ln.compound);for(var un,dn=this.mrca1.head;null!=dn;){for(var cn=dn.elt,yn=this.mrca2.head;null!=yn;){for(var _n,mn=yn.elt,gn=cn.cbSet,fn=mn.cbSet,xn=null,vn=(gn.cbpairs.length<fn.cbpairs.length?gn:fn).cbpairs.head;null!=vn;){var wn=vn.elt;if(wn.a==gn&&wn.b==fn||wn.a==fn&&wn.b==gn){xn=wn;break}vn=vn.next}if(null==xn&&(null==qn.zpp_pool?_n=new qn:(_n=qn.zpp_pool,qn.zpp_pool=_n.next,_n.next=null),_n.zip_listeners=!0,Hn.setlt(gn,fn)?(_n.a=gn,_n.b=fn):(_n.a=fn,_n.b=gn),xn=_n,gn.cbpairs.add(xn),fn!=gn&&fn.cbpairs.add(xn)),xn.zip_listeners&&(xn.zip_listeners=!1,xn.__validate()),null!=xn.listeners.head){for(var zn=null,bn=null,Sn=this.prelisteners;null!=Sn.head;){var Cn=Sn.head;Sn.head=Cn.next,Cn.elt=null,Cn.next=ir.zpp_pool,ir.zpp_pool=Cn,null==Sn.head&&(Sn.pushmod=!0),Sn.modified=!0,Sn.length--}Sn.pushmod=!0;for(var Pn,Mn=null,Tn=null,An=(gn.cbpairs.length<fn.cbpairs.length?gn:fn).cbpairs.head;null!=An;){var kn=An.elt;if(kn.a==gn&&kn.b==fn||kn.a==fn&&kn.b==gn){Tn=kn;break}An=An.next}null==Tn&&(null==qn.zpp_pool?Pn=new qn:(Pn=qn.zpp_pool,qn.zpp_pool=Pn.next,Pn.next=null),Pn.zip_listeners=!0,Hn.setlt(gn,fn)?(Pn.a=gn,Pn.b=fn):(Pn.a=fn,Pn.b=gn),Tn=Pn,gn.cbpairs.add(Tn),fn!=gn&&fn.cbpairs.add(Tn)),Tn.zip_listeners&&(Tn.zip_listeners=!1,Tn.__validate());for(var On=Tn.listeners.head;null!=On;){var En,In,Gn,Dn=On.elt;5==Dn.event&&0!=(2&Dn.itype)&&(En=this.prelisteners,null==ir.zpp_pool?In=new ir:(In=ir.zpp_pool,ir.zpp_pool=In.next,In.next=null),In.elt=Dn,Gn=In,null==Mn?(Gn.next=En.head,En.head=Gn):(Gn.next=Mn.next,Mn.next=Gn),En.pushmod=En.modified=!0,En.length++,Mn=Gn,Hi=!!Hi||!Dn.pure),On=On.next}if(null!=this.prelisteners.head){if(null==(zn=$n.get(cn,mn))&&(bn=tr.get(cn,mn),this.add_callbackset(bn)),null==zn||(zn.SENSORstamp!=this.stamp||r)&&0==(4&zn.SENSORstate)){if(null!=(zn=null!=bn?bn:zn))for(var Ln=this.prelisteners.head;null!=Ln;)7==Ln.elt.itype?(zn.COLLISIONstamp=this.stamp,zn.SENSORstamp=this.stamp,zn.FLUIDstamp=this.stamp):zn.SENSORstamp=this.stamp,Ln=Ln.next;bn=Ti.active;Ti.active=!0,this.precb.zpp_inner.pre_arbiter=Ti,this.precb.zpp_inner.set=zn;for(var Bn=this.prelisteners.head;null!=Bn;){var Rn=Bn.elt;this.precb.zpp_inner.listener=Rn;var Fn=this.precb.zpp_inner,Nn=zn.int1,jn=zn.int2,Un=Rn.options1,Vn=Nn.cbTypes;!(!Un.nonemptyintersection(Vn,Un.includes)||Un.nonemptyintersection(Vn,Un.excludes))&&(Vn=Rn.options2,Un=jn.cbTypes,!!Vn.nonemptyintersection(Un,Vn.includes)&&!Vn.nonemptyintersection(Un,Vn.excludes))?(Fn.int1=Nn,Fn.int2=jn):(Fn.int1=jn,Fn.int2=Nn),this.precb.zpp_inner.pre_swapped=cn!=this.precb.zpp_inner.int1;var Rn=Rn.handlerp(this.precb);null!=Rn&&(null==Yn.PreFlag_ACCEPT&&(Yn.internal=!0,Yn.PreFlag_ACCEPT=new Xn,Yn.internal=!1),Rn=Rn==Yn.PreFlag_ACCEPT?5:(null==Yn.PreFlag_ACCEPT_ONCE&&(Yn.internal=!0,Yn.PreFlag_ACCEPT_ONCE=new Xn,Yn.internal=!1),Rn==Yn.PreFlag_ACCEPT_ONCE?1:(null==Yn.PreFlag_IGNORE&&(Yn.internal=!0,Yn.PreFlag_IGNORE=new Xn,Yn.internal=!1),Rn==Yn.PreFlag_IGNORE?6:2)),Ti.immState=Rn),Bn=Bn.next}if(Ti.active=bn,null!=zn)for(var Wn=this.prelisteners.head;null!=Wn;)7==Wn.elt.itype?(zn.COLLISIONstate=Ti.immState,zn.SENSORstate=Ti.immState,zn.FLUIDstate=Ti.immState):zn.SENSORstate=Ti.immState,Wn=Wn.next}else null==zn?0==(4&Ti.immState)&&(Ti.immState=1):Ti.immState=zn.SENSORstate;yn=yn.next}else yn=yn.next}else yn=yn.next}dn=dn.next}Hi&&0==(4&Ti.immState)&&(1!=Ti.b1.type&&((Ii=Ti.b1).world||(Ii.component.waket=this.stamp+(this.midstep?0:1),3==Ii.type&&(Ii.kinematicDelaySleep=!0),Ii.component.sleeping&&this.really_wake(Ii,!1))),1!=Ti.b2.type&&((un=Ti.b2).world||(un.component.waket=this.stamp+(this.midstep?0:1),3==un.type&&(un.kinematicDelaySleep=!0),un.component.sleeping&&this.really_wake(un,!1))))}Ti.sleeping&&(Ti.sleeping=!1,un=this.s_arbiters,null==or.zpp_pool?Ei=new or:(Ei=or.zpp_pool,or.zpp_pool=Ei.next,Ei.next=null),Ei.elt=Ti,(Ei=Ei).next=un.head,un.head=Ei,un.modified=!0,un.length++),h=Ti}else h=ee?((ee=Ti).next=Kn.zpp_pool,Kn.zpp_pool=ee,null):Ti;else h=Ti}}return h},ii.prototype.mrca1=null,ii.prototype.mrca2=null,ii.prototype.MRCA_chains=function(t,e){for(var i=this.mrca1;null!=i.head;){var n=i.head;i.head=n.next,n.elt=null,n.next=nr.zpp_pool,nr.zpp_pool=n,null==i.head&&(i.pushmod=!0),i.modified=!0,i.length--}i.pushmod=!0;for(var r,o,s,a,h,l,p=this.mrca2;null!=p.head;){var u=p.head;p.head=u.next,u.elt=null,u.next=nr.zpp_pool,nr.zpp_pool=u,null==p.head&&(p.pushmod=!0),p.modified=!0,p.length--}p.pushmod=!0,null!=t.cbSet&&(o=this.mrca1,null==nr.zpp_pool?r=new nr:(r=nr.zpp_pool,nr.zpp_pool=r.next,r.next=null),r.elt=t,(r=r).next=o.head,o.head=r,o.modified=!0,o.length++),null!=t.body.cbSet&&(r=this.mrca1,o=t.body,null==nr.zpp_pool?s=new nr:(s=nr.zpp_pool,nr.zpp_pool=s.next,s.next=null),s.elt=o,(s=s).next=r.head,r.head=s,r.modified=!0,r.length++),null!=e.cbSet&&(h=this.mrca2,null==nr.zpp_pool?a=new nr:(a=nr.zpp_pool,nr.zpp_pool=a.next,a.next=null),a.elt=e,(a=a).next=h.head,h.head=a,h.modified=!0,h.length++),null!=e.body.cbSet&&(a=this.mrca2,h=e.body,null==nr.zpp_pool?l=new nr:(l=nr.zpp_pool,nr.zpp_pool=l.next,l.next=null),l.elt=h,(l=l).next=a.head,a.head=l,a.modified=!0,a.length++);for(var d,c,y,_,m=t.body.compound,g=e.body.compound;m!=g;)(null==m?0:m.depth)<(null==g?0:g.depth)?(null!=g.cbSet&&(_=this.mrca2,null==nr.zpp_pool?d=new nr:(d=nr.zpp_pool,nr.zpp_pool=d.next,d.next=null),d.elt=g,(c=d).next=_.head,_.head=c,_.modified=!0,_.length++),g=g.compound):(null!=m.cbSet&&(c=this.mrca1,null==nr.zpp_pool?y=new nr:(y=nr.zpp_pool,nr.zpp_pool=y.next,y.next=null),y.elt=m,(_=y).next=c.head,c.head=_,c.modified=!0,c.length++),m=m.compound)},ii.prototype.inlined_MRCA_chains=function(t,e){for(var i=this.mrca1;null!=i.head;){var n=i.head;i.head=n.next,n.elt=null,n.next=nr.zpp_pool,nr.zpp_pool=n,null==i.head&&(i.pushmod=!0),i.modified=!0,i.length--}i.pushmod=!0;for(var r,o,s,a,h,l,p=this.mrca2;null!=p.head;){var u=p.head;p.head=u.next,u.elt=null,u.next=nr.zpp_pool,nr.zpp_pool=u,null==p.head&&(p.pushmod=!0),p.modified=!0,p.length--}p.pushmod=!0,null!=t.cbSet&&(o=this.mrca1,null==nr.zpp_pool?r=new nr:(r=nr.zpp_pool,nr.zpp_pool=r.next,r.next=null),r.elt=t,(r=r).next=o.head,o.head=r,o.modified=!0,o.length++),null!=t.body.cbSet&&(r=this.mrca1,o=t.body,null==nr.zpp_pool?s=new nr:(s=nr.zpp_pool,nr.zpp_pool=s.next,s.next=null),s.elt=o,(s=s).next=r.head,r.head=s,r.modified=!0,r.length++),null!=e.cbSet&&(h=this.mrca2,null==nr.zpp_pool?a=new nr:(a=nr.zpp_pool,nr.zpp_pool=a.next,a.next=null),a.elt=e,(a=a).next=h.head,h.head=a,h.modified=!0,h.length++),null!=e.body.cbSet&&(a=this.mrca2,h=e.body,null==nr.zpp_pool?l=new nr:(l=nr.zpp_pool,nr.zpp_pool=l.next,l.next=null),l.elt=h,(l=l).next=a.head,a.head=l,a.modified=!0,a.length++);for(var d,c,y,_,m=t.body.compound,g=e.body.compound;m!=g;)(null==m?0:m.depth)<(null==g?0:g.depth)?(null!=g.cbSet&&(_=this.mrca2,null==nr.zpp_pool?d=new nr:(d=nr.zpp_pool,nr.zpp_pool=d.next,d.next=null),d.elt=g,(c=d).next=_.head,_.head=c,_.modified=!0,_.length++),g=g.compound):(null!=m.cbSet&&(c=this.mrca1,null==nr.zpp_pool?y=new nr:(y=nr.zpp_pool,nr.zpp_pool=y.next,y.next=null),y.elt=m,(_=y).next=c.head,c.head=_,c.modified=!0,c.length++),m=m.compound)},ii.prototype.__class__=ii;var ni=zpp_nape.space.ZPP_SweepData=function(){this.aabb=null,this.shape=null,this.prev=null,this.next=null};ni.__name__=["zpp_nape","space","ZPP_SweepData"],ni.prototype.next=null,ni.prototype.prev=null,ni.prototype.shape=null,ni.prototype.aabb=null,ni.prototype.free=function(){this.prev=null,this.shape=null,this.aabb=null},ni.prototype.alloc=function(){},ni.prototype.gt=function(t){return this.aabb.minx>t.aabb.minx},ni.prototype.__class__=ni;var ri=zpp_nape.space.ZPP_SweepPhase=function(t){this.failed=null,this.list=null,qe.call(this),this.space=t,this.is_sweep=!0,this.sweep=this};ri.__name__=["zpp_nape","space","ZPP_SweepPhase"],ri.__super__=qe,ri.prototype=Object.create(qe.prototype),ri.prototype.list=null,ri.prototype.__insert=function(t){var e;null==ni.zpp_pool?e=new ni:(e=ni.zpp_pool,ni.zpp_pool=e.next,e.next=null),(t.sweep=e).shape=t,e.aabb=t.aabb,e.next=this.list,null!=this.list&&(this.list.prev=e),this.list=e},ri.prototype.__remove=function(t){var e=t.sweep;null==e.prev?this.list=e.next:e.prev.next=e.next,null!=e.next&&(e.next.prev=e.prev),t.sweep=null,e.prev=null,e.shape=null,e.aabb=null,e.next=ni.zpp_pool,ni.zpp_pool=e},ri.prototype.__sync=function(t){if(!this.space.continuous&&t.zip_aabb&&null!=t.body)if(t.zip_aabb=!1,0==t.type){var e=t.circle;if(e.zip_worldCOM&&null!=e.body){if(e.zip_worldCOM=!1,e.zip_localCOM){if(e.zip_localCOM=!1,1==e.type){var i=e.polygon;if(null==i.lverts.next.next)i.localCOMx=i.lverts.next.x,i.localCOMy=i.lverts.next.y;else if(null==i.lverts.next.next.next)i.localCOMx=i.lverts.next.x,i.localCOMy=i.lverts.next.y,i.localCOMx+=i.lverts.next.next.x,i.localCOMy+=i.lverts.next.next.y,i.localCOMx*=.5,i.localCOMy*=.5;else{i.localCOMx=0;var n=i.localCOMy=0,r=i.lverts.next,o=r,s=r=r.next;for(r=r.next;null!=r;){var a=r;n+=s.x*(a.y-o.y);var h=a.y*s.x-a.x*s.y;i.localCOMx+=(s.x+a.x)*h,i.localCOMy+=(s.y+a.y)*h,o=s,s=a,r=r.next}var l=r=i.lverts.next;n+=s.x*(l.y-o.y);var p=l.y*s.x-l.x*s.y;i.localCOMx+=(s.x+l.x)*p,i.localCOMy+=(s.y+l.y)*p;var o=s,u=r=r.next;n+=l.x*(u.y-o.y);p=u.y*l.x-u.x*l.y;i.localCOMx+=(l.x+u.x)*p,i.localCOMy+=(l.y+u.y)*p;u=n=1/(3*n);i.localCOMx*=u,i.localCOMy*=u}}null!=e.wrap_localCOM&&(e.wrap_localCOM.zpp_inner.x=e.localCOMx,e.wrap_localCOM.zpp_inner.y=e.localCOMy)}p=e.body;p.zip_axis&&(p.zip_axis=!1,p.axisx=Math.sin(p.rot),p.axisy=Math.cos(p.rot)),e.worldCOMx=e.body.posx+(e.body.axisy*e.localCOMx-e.body.axisx*e.localCOMy),e.worldCOMy=e.body.posy+(e.localCOMx*e.body.axisx+e.localCOMy*e.body.axisy)}u=e.radius,p=e.radius;e.aabb.minx=e.worldCOMx-u,e.aabb.miny=e.worldCOMy-p,e.aabb.maxx=e.worldCOMx+u,e.aabb.maxy=e.worldCOMy+p}else{var d=t.polygon;if(d.zip_gverts&&null!=d.body){d.zip_gverts=!1,d.validate_lverts();var c=d.body;c.zip_axis&&(c.zip_axis=!1,c.axisx=Math.sin(c.rot),c.axisy=Math.cos(c.rot));for(var y=d.lverts.next,_=d.gverts.next;null!=_;){var m=_,g=y,y=y.next;m.x=d.body.posx+(d.body.axisy*g.x-d.body.axisx*g.y),m.y=d.body.posy+(g.x*d.body.axisx+g.y*d.body.axisy),_=_.next}}c=d.gverts.next;d.aabb.minx=c.x,d.aabb.miny=c.y,d.aabb.maxx=c.x,d.aabb.maxy=c.y;for(var f=d.gverts.next.next;null!=f;){var x=f;x.x<d.aabb.minx&&(d.aabb.minx=x.x),x.x>d.aabb.maxx&&(d.aabb.maxx=x.x),x.y<d.aabb.miny&&(d.aabb.miny=x.y),x.y>d.aabb.maxy&&(d.aabb.maxy=x.y),f=f.next}}},ri.prototype.sync_broadphase=function(){if(this.space.validation(),null!=this.list)for(var t=this.list.next;null!=t;){var e=t.next,i=t.prev;if(t.aabb.minx>i.aabb.minx)t=e;else{for(;null!=i.prev&&i.prev.aabb.minx>t.aabb.minx;)i=i.prev;var n=t.prev;n.next=t.next,null!=t.next&&(t.next.prev=n),null==i.prev?(t.prev=null,((this.list=t).next=i).prev=t):(t.prev=i.prev,((i.prev=t).prev.next=t).next=i),t=e}}},ri.prototype.sync_broadphase_fast=function(){for(var t=this.list.next;null!=t;){var e=t.next,i=t.prev;if(t.aabb.minx>i.aabb.minx)t=e;else{for(;null!=i.prev&&i.prev.aabb.minx>t.aabb.minx;)i=i.prev;var n=t.prev;n.next=t.next,null!=t.next&&(t.next.prev=n),null==i.prev?(t.prev=null,((this.list=t).next=i).prev=t):(t.prev=i.prev,((i.prev=t).prev.next=t).next=i),t=e}}},ri.prototype.broadphase=function(t,e){if(null!=this.list){for(var i=this.list.next;null!=i;){var n=i.next,r=i.prev;if(i.aabb.minx>r.aabb.minx)i=n;else{for(;null!=r.prev&&r.prev.aabb.minx>i.aabb.minx;)r=r.prev;var o=i.prev;o.next=i.next,null!=i.next&&(i.next.prev=o),null==r.prev?(i.prev=null,((this.list=i).next=r).prev=i):(i.prev=r.prev,((r.prev=i).prev.next=i).next=r),i=n}}for(var s=this.list;null!=s;){for(var a=s.next,h=s.shape,l=h.body,p=s.aabb.maxx;null!=a&&!(a.aabb.minx>p);){var u,d,c=a.shape,y=c.body;a=(y!=l&&(1==l.type&&1==y.type||l.component.sleeping&&y.component.sleeping||(u=h.aabb,(d=c.aabb).miny>u.maxy||u.miny>d.maxy||(e?t.narrowPhase(h,c,2!=l.type||2!=y.type,null,!1):t.continuousEvent(h,c,2!=l.type||2!=y.type,null,!1)))),a.next)}s=s.next}}},ri.prototype.clear=function(){for(;null!=this.list;)this.list.shape.removedFromSpace(),this.__remove(this.list.shape)},ri.prototype.shapesUnderPoint=function(t,e,i,n){var r;this.sync_broadphase(),null==Gr.zpp_pool?r=new Gr:(r=Gr.zpp_pool,Gr.zpp_pool=r.next,r.next=null),r.weak=!1,r._immutable=!1,r.x=t,r.y=e;for(var o,s,a=r,h=null==n?new _t:n,l=this.list;null!=l&&l.aabb.minx>t;)l=l.next;for(;null!=l&&l.aabb.minx<=t;)l.aabb.maxx>=t&&l.aabb.miny<=e&&l.aabb.maxy>=e&&(o=l.shape,(null==i||0!=((s=o.filter).collisionMask&i.collisionGroup)&&0!=(i.collisionMask&s.collisionGroup))&&(0==o.type?Ir.circleContains(o.circle,a)&&h.push(o.outer):Ir.polyContains(o.polygon,a)&&h.push(o.outer))),l=l.next;return null!=a.outer&&(a.outer.zpp_inner=null,a.outer=null),a._isimmutable=null,a._validate=null,a._invalidate=null,a.next=Gr.zpp_pool,Gr.zpp_pool=a,h},ri.prototype.bodiesUnderPoint=function(t,e,i,n){var r;this.sync_broadphase(),null==Gr.zpp_pool?r=new Gr:(r=Gr.zpp_pool,Gr.zpp_pool=r.next,r.next=null),r.weak=!1,r._immutable=!1,r.x=t,r.y=e;for(var o,s,a,h=r,l=null==n?new tt:n,p=this.list;null!=p&&p.aabb.minx>t;)p=p.next;for(;null!=p&&p.aabb.minx<=t;)p.aabb.maxx>=t&&p.aabb.miny<=e&&p.aabb.maxy>=e&&(s=(o=p.shape).body.outer,l.has(s)||(null==i||0!=((a=o.filter).collisionMask&i.collisionGroup)&&0!=(i.collisionMask&a.collisionGroup))&&(0==o.type?Ir.circleContains(o.circle,h)&&l.push(s):Ir.polyContains(o.polygon,h)&&l.push(s))),p=p.next;return null!=h.outer&&(h.outer.zpp_inner=null,h.outer=null),h._isimmutable=null,h._validate=null,h._invalidate=null,h.next=Gr.zpp_pool,Gr.zpp_pool=h,l},ri.prototype.shapesInAABB=function(t,e,i,n,r){this.sync_broadphase(),this.updateAABBShape(t);for(var o=this.aabbShape.zpp_inner.aabb,s=null==r?new _t:r,a=this.list;null!=a&&a.aabb.maxx<o.minx;)a=a.next;for(;null!=a&&a.aabb.minx<=o.maxx;){var h,l,p=a.shape;(null==n||0!=((h=p.filter).collisionMask&n.collisionGroup)&&0!=(n.collisionMask&h.collisionGroup))&&(e?i?Ir.containTest(this.aabbShape.zpp_inner,p)&&s.push(p.outer):(h=a.aabb).minx>=o.minx&&h.miny>=o.miny&&h.maxx<=o.maxx&&h.maxy<=o.maxy?s.push(p.outer):(h=a.aabb,o.miny<=h.maxy&&h.miny<=o.maxy&&o.minx<=h.maxx&&h.minx<=o.maxx&&Ir.testCollide_safe(p,this.aabbShape.zpp_inner)&&s.push(p.outer)):(i?(l=a.aabb).minx>=o.minx&&l.miny>=o.miny&&l.maxx<=o.maxx&&l.maxy<=o.maxy:(l=a.aabb,o.miny<=l.maxy&&l.miny<=o.maxy&&o.minx<=l.maxx&&l.minx<=o.maxx))&&s.push(p.outer)),a=a.next}return s},ri.prototype.failed=null,ri.prototype.bodiesInAABB=function(t,e,i,n,r){this.sync_broadphase(),this.updateAABBShape(t);var o=this.aabbShape.zpp_inner.aabb,s=null==r?new tt:r;null==this.failed&&(this.failed=new tt);for(var a=this.list;null!=a&&a.aabb.maxx<o.minx;)a=a.next;for(;null!=a&&a.aabb.minx<=o.maxx;){var h,l=a.shape,p=l.body.outer,u=a.aabb;o.miny<=u.maxy&&u.miny<=o.maxy&&o.minx<=u.maxx&&u.minx<=o.maxx&&(null==n||0!=((u=l.filter).collisionMask&n.collisionGroup)&&0!=(n.collisionMask&u.collisionGroup))&&(e?i?this.failed.has(p)||(h=Ir.containTest(this.aabbShape.zpp_inner,l),!s.has(p)&&h?s.push(p):h||(s.remove(p),this.failed.push(p))):!s.has(p)&&Ir.testCollide_safe(l,this.aabbShape.zpp_inner)&&s.push(p):i?this.failed.has(p)||(h=(h=l.aabb).minx>=o.minx&&h.miny>=o.miny&&h.maxx<=o.maxx&&h.maxy<=o.maxy,!s.has(p)&&h?s.push(p):h||(s.remove(p),this.failed.push(p))):!s.has(p)&&((l=l.aabb).minx>=o.minx&&l.miny>=o.miny&&l.maxx<=o.maxx&&l.maxy<=o.maxy)&&s.push(p)),a=a.next}return this.failed.clear(),s},ri.prototype.shapesInCircle=function(t,e,i,n,r,o){this.sync_broadphase(),this.updateCircShape(t,e,i);for(var s=this.circShape.zpp_inner.aabb,a=null==o?new _t:o,h=this.list;null!=h&&h.aabb.maxx<s.minx;)h=h.next;for(;null!=h&&h.aabb.minx<=s.maxx;){var l,p=h.aabb;s.miny<=p.maxy&&p.miny<=s.maxy&&s.minx<=p.maxx&&p.minx<=s.maxx&&(l=h.shape,(null==r||0!=((p=l.filter).collisionMask&r.collisionGroup)&&0!=(r.collisionMask&p.collisionGroup))&&(n?Ir.containTest(this.circShape.zpp_inner,l)&&a.push(l.outer):Ir.testCollide_safe(l,this.circShape.zpp_inner)&&a.push(l.outer))),h=h.next}return a},ri.prototype.bodiesInCircle=function(t,e,i,n,r,o){this.sync_broadphase(),this.updateCircShape(t,e,i);var s=this.circShape.zpp_inner.aabb,a=null==o?new tt:o;null==this.failed&&(this.failed=new tt);for(var h=this.list;null!=h&&h.aabb.maxx<s.minx;)h=h.next;for(;null!=h&&h.aabb.minx<=s.maxx;){var l,p,u=h.aabb;s.miny<=u.maxy&&u.miny<=s.maxy&&s.minx<=u.maxx&&u.minx<=s.maxx&&(u=(l=h.shape).body.outer,(null==r||0!=((p=l.filter).collisionMask&r.collisionGroup)&&0!=(r.collisionMask&p.collisionGroup))&&(n?this.failed.has(u)||(p=Ir.containTest(this.circShape.zpp_inner,l),!a.has(u)&&p?a.push(u):p||(a.remove(u),this.failed.push(u))):!a.has(u)&&Ir.testCollide_safe(l,this.circShape.zpp_inner)&&a.push(u))),h=h.next}return this.failed.clear(),a},ri.prototype.shapesInShape=function(t,e,i,n){this.sync_broadphase(),this.validateShape(t);for(var r=t.aabb,o=null==n?new _t:n,s=this.list;null!=s&&s.aabb.maxx<r.minx;)s=s.next;for(;null!=s&&s.aabb.minx<=r.maxx;){var a,h=s.aabb;r.miny<=h.maxy&&h.miny<=r.maxy&&r.minx<=h.maxx&&h.minx<=r.maxx&&(a=s.shape,(null==i||0!=((h=a.filter).collisionMask&i.collisionGroup)&&0!=(i.collisionMask&h.collisionGroup))&&(e?Ir.containTest(t,a)&&o.push(a.outer):Ir.testCollide_safe(a,t)&&o.push(a.outer))),s=s.next}return o},ri.prototype.bodiesInShape=function(t,e,i,n){this.sync_broadphase(),this.validateShape(t);var r=t.aabb,o=null==n?new tt:n;null==this.failed&&(this.failed=new tt);for(var s=this.list;null!=s&&s.aabb.maxx<r.minx;)s=s.next;for(;null!=s&&s.aabb.minx<=r.maxx;){var a,h,l=s.aabb;r.miny<=l.maxy&&l.miny<=r.maxy&&r.minx<=l.maxx&&l.minx<=r.maxx&&(l=(a=s.shape).body.outer,(null==i||0!=((h=a.filter).collisionMask&i.collisionGroup)&&0!=(i.collisionMask&h.collisionGroup))&&(e?this.failed.has(l)||(h=Ir.containTest(t,a),!o.has(l)&&h?o.push(l):h||(o.remove(l),this.failed.push(l))):!o.has(l)&&Ir.testCollide_safe(t,a)&&o.push(l))),s=s.next}return this.failed.clear(),o},ri.prototype.rayCast=function(t,e,i){this.sync_broadphase(),t.validate_dir();var n=t.rayAABB(),r=t.maxdist,o=null;if(0==t.dirx)for(var s=this.list;null!=s&&s.aabb.minx<=n.minx;){var a,h=s.aabb;!(n.miny<=h.maxy&&h.miny<=n.maxy&&n.minx<=h.maxx&&h.minx<=n.maxx&&(null==i||0!=((a=s.shape.filter).collisionMask&i.collisionGroup)&&0!=(i.collisionMask&a.collisionGroup)))||0<=(a=t.aabbsect(s.aabb))&&a<r&&(null!=(a=0==s.shape.type?t.circlesect(s.shape.circle,e,r):t.polysect(s.shape.polygon,e,r))&&(r=a.zpp_inner.toiDistance,null!=o&&o.zpp_inner.free(),o=a)),s=s.next}else if(t.dirx<0){for(var l=this.list,p=null;null!=l&&l.aabb.minx<=n.maxx;)l=(p=l).next;for(l=p;null!=l;){var u,d=l.aabb;!(n.miny<=d.maxy&&d.miny<=n.maxy&&n.minx<=d.maxx&&d.minx<=n.maxx&&(null==i||0!=((u=l.shape.filter).collisionMask&i.collisionGroup)&&0!=(i.collisionMask&u.collisionGroup)))||0<=(u=t.aabbsect(l.aabb))&&u<r&&(null!=(u=0==l.shape.type?t.circlesect(l.shape.circle,e,r):t.polysect(l.shape.polygon,e,r))&&(r=u.zpp_inner.toiDistance,null!=o&&o.zpp_inner.free(),o=u)),l=l.prev}}else for(var c=this.list;null!=c&&c.aabb.minx<=n.maxx&&c.aabb.minx<t.originx+t.dirx*r;){var y,_=c.aabb;!(n.miny<=_.maxy&&_.miny<=n.maxy&&n.minx<=_.maxx&&_.minx<=n.maxx&&(null==i||0!=((y=c.shape.filter).collisionMask&i.collisionGroup)&&0!=(i.collisionMask&y.collisionGroup)))||0<=(y=t.aabbsect(c.aabb))&&y<r&&(null!=(y=0==c.shape.type?t.circlesect(c.shape.circle,e,r):t.polysect(c.shape.polygon,e,r))&&(r=y.zpp_inner.toiDistance,null!=o&&o.zpp_inner.free(),o=y)),c=c.next}return null!=n.outer&&(n.outer.zpp_inner=null,n.outer=null),n.wrap_min=n.wrap_max=null,n._invalidate=null,n._validate=null,n.next=De.zpp_pool,De.zpp_pool=n,o},ri.prototype.rayMultiCast=function(t,e,i,n){this.sync_broadphase(),t.validate_dir();var r=t.rayAABB(),o=null==n?new q:n;if(0==t.dirx)for(var s=this.list;null!=s&&s.aabb.minx<=r.minx;){var a=s.aabb;r.miny<=a.maxy&&a.miny<=r.maxy&&r.minx<=a.maxx&&a.minx<=r.maxx&&(null==i||0!=((a=s.shape.filter).collisionMask&i.collisionGroup)&&0!=(i.collisionMask&a.collisionGroup))&&0<=t.aabbsect(s.aabb)&&(0==s.shape.type?t.circlesect2(s.shape.circle,e,o):t.polysect2(s.shape.polygon,e,o)),s=s.next}else if(t.dirx<0){for(var h=this.list,l=null;null!=h&&h.aabb.minx<=r.maxx;)h=(l=h).next;for(h=l;null!=h;){var p=h.aabb;r.miny<=p.maxy&&p.miny<=r.maxy&&r.minx<=p.maxx&&p.minx<=r.maxx&&(null==i||0!=((p=h.shape.filter).collisionMask&i.collisionGroup)&&0!=(i.collisionMask&p.collisionGroup))&&0<=t.aabbsect(h.aabb)&&(0==h.shape.type?t.circlesect2(h.shape.circle,e,o):t.polysect2(h.shape.polygon,e,o)),h=h.prev}}else for(var u=this.list;null!=u&&u.aabb.minx<=r.maxx;){var d=u.aabb;r.miny<=d.maxy&&d.miny<=r.maxy&&r.minx<=d.maxx&&d.minx<=r.maxx&&(null==i||0!=((d=u.shape.filter).collisionMask&i.collisionGroup)&&0!=(i.collisionMask&d.collisionGroup))&&0<=t.aabbsect(u.aabb)&&(0==u.shape.type?t.circlesect2(u.shape.circle,e,o):t.polysect2(u.shape.polygon,e,o)),u=u.next}return null!=r.outer&&(r.outer.zpp_inner=null,r.outer=null),r.wrap_min=r.wrap_max=null,r._invalidate=null,r._validate=null,r.next=De.zpp_pool,De.zpp_pool=r,o},ri.prototype.__class__=ri;var oi=zpp_nape.util.ZNPArray2_Float=function(t,e){this.width=0,this.list=null,this.width=t,this.list=[]};oi.__name__=["zpp_nape","util","ZNPArray2_Float"],oi.prototype.list=null,oi.prototype.width=null,oi.prototype.resize=function(t,e,i){for(var n=0,r=(this.width=t)*e;n<r;)this.list[n++]=i},oi.prototype.get=function(t,e){return this.list[e*this.width+t]},oi.prototype.set=function(t,e,i){return this.list[e*this.width+t]=i},oi.prototype.__class__=oi;var si=zpp_nape.util.ZNPArray2_ZPP_GeomVert=function(t,e){this.width=0,this.list=null,this.width=t,this.list=[]};si.__name__=["zpp_nape","util","ZNPArray2_ZPP_GeomVert"],si.prototype.list=null,si.prototype.width=null,si.prototype.resize=function(t,e,i){for(var n=0,r=(this.width=t)*e;n<r;)this.list[n++]=i},si.prototype.get=function(t,e){return this.list[e*this.width+t]},si.prototype.set=function(t,e,i){return this.list[e*this.width+t]=i},si.prototype.__class__=si;var ai=zpp_nape.util.ZNPArray2_ZPP_MarchPair=function(t,e){this.width=0,this.list=null,this.width=t,this.list=[]};ai.__name__=["zpp_nape","util","ZNPArray2_ZPP_MarchPair"],ai.prototype.list=null,ai.prototype.width=null,ai.prototype.resize=function(t,e,i){for(var n=0,r=(this.width=t)*e;n<r;)this.list[n++]=i},ai.prototype.get=function(t,e){return this.list[e*this.width+t]},ai.prototype.set=function(t,e,i){return this.list[e*this.width+t]=i},ai.prototype.__class__=ai;var hi=zpp_nape.util.Hashable2_Boolfalse=function(){this.di=0,this.id=0,this.hnext=null,this.next=null,this.value=!1};hi.__name__=["zpp_nape","util","Hashable2_Boolfalse"],hi.get=function(t,e,i){null==hi.zpp_pool?n=new hi:(n=hi.zpp_pool,hi.zpp_pool=n.next,n.next=null),n.id=t,n.di=e;var n=n;return n.value=i,n},hi.getpersist=function(t,e){var i;return null==hi.zpp_pool?i=new hi:(i=hi.zpp_pool,hi.zpp_pool=i.next,i.next=null),i.id=t,i.di=e,i},hi.ordered_get=function(t,e,i){if(t<=e){null==hi.zpp_pool?n=new hi:(n=hi.zpp_pool,hi.zpp_pool=n.next,n.next=null),n.id=t,n.di=e;var n=n;return n.value=i,n}null==hi.zpp_pool?r=new hi:(r=hi.zpp_pool,hi.zpp_pool=r.next,r.next=null),r.id=e,r.di=t;var r=r;return r.value=i,r},hi.ordered_get_persist=function(t,e){var i,n;return t<=e?(null==hi.zpp_pool?i=new hi:(i=hi.zpp_pool,hi.zpp_pool=i.next,i.next=null),i.id=t,i.di=e,i):(null==hi.zpp_pool?n=new hi:(n=hi.zpp_pool,hi.zpp_pool=n.next,n.next=null),n.id=e,n.di=t,n)},hi.prototype.value=null,hi.prototype.next=null,hi.prototype.hnext=null,hi.prototype.id=null,hi.prototype.di=null,hi.prototype.free=function(){},hi.prototype.alloc=function(){},hi.prototype.__class__=hi;var li=zpp_nape.util.FastHash2_Hashable2_Boolfalse=function(){this.cnt=0,this.table=null,this.cnt=0,this.table=[];for(var t=0;t<1048576;)++t,this.table.push(null)};li.__name__=["zpp_nape","util","FastHash2_Hashable2_Boolfalse"],li.prototype.table=null,li.prototype.cnt=null,li.prototype.empty=function(){return 0==this.cnt},li.prototype.clear=function(){for(var t=0,e=this.table.length;t<e;){var i=t++,n=this.table[i];if(null!=n){for(;null!=n;){var r=n.hnext;n.hnext=null,n=r}this.table[i]=null}}},li.prototype.get=function(t,e){var i=this.table[106039*t+e&1048575];if(null==i)return null;if(i.id==t&&i.di==e)return i;for(;;)if(null==(i=i.hnext)||i.id==t&&i.di==e)break;return i},li.prototype.ordered_get=function(t,e){var i;e<t&&(i=t,t=e,e=i);var n=this.table[106039*t+e&1048575];if(null==n)return null;if(n.id==t&&n.di==e)return n;for(;;)if(null==(n=n.hnext)||n.id==t&&n.di==e)break;return n},li.prototype.has=function(t,e){var i=this.table[106039*t+e&1048575];if(null==i)return!1;if(i.id==t&&i.di==e)return!0;for(;;)if(null==(i=i.hnext)||i.id==t&&i.di==e)break;return null!=i},li.prototype.maybeAdd=function(t){var e=106039*t.id+t.di&1048575,i=this.table[e];null==i?(this.table[e]=t).hnext=null:(t.hnext=i.hnext,i.hnext=t),this.cnt++},li.prototype.add=function(t){var e=106039*t.id+t.di&1048575,i=this.table[e];null==i?(this.table[e]=t).hnext=null:(t.hnext=i.hnext,i.hnext=t),this.cnt++},li.prototype.remove=function(t){var e,i=106039*t.id+t.di&1048575,n=this.table[i];if(n==t)this.table[i]=n.hnext;else if(null!=n){for(;;)if(null==(n=(e=n).hnext)||n==t)break;e.hnext=n.hnext}t.hnext=null,this.cnt--},li.prototype.hash=function(t,e){return 106039*t+e&1048575},li.prototype.__class__=li;var pi=zpp_nape.util.ZNPList_ZPP_CallbackSet=function(){this.length=0,this.pushmod=!1,this.modified=!1,this.head=null};pi.__name__=["zpp_nape","util","ZNPList_ZPP_CallbackSet"],pi.prototype.head=null,pi.prototype.begin=function(){return this.head},pi.prototype.modified=null,pi.prototype.pushmod=null,pi.prototype.length=null,pi.prototype.setbegin=function(t){this.head=t,this.modified=!0,this.pushmod=!0},pi.prototype.add=function(t){null==Vi.zpp_pool?e=new Vi:(e=Vi.zpp_pool,Vi.zpp_pool=e.next,e.next=null),e.elt=t;var e=e;return e.next=this.head,this.head=e,this.modified=!0,this.length++,t},pi.prototype.inlined_add=function(t){null==Vi.zpp_pool?e=new Vi:(e=Vi.zpp_pool,Vi.zpp_pool=e.next,e.next=null),e.elt=t;var e=e;return e.next=this.head,this.head=e,this.modified=!0,this.length++,t},pi.prototype.addAll=function(t){for(var e=t.head;null!=e;)this.add(e.elt),e=e.next},pi.prototype.insert=function(t,e){null==Vi.zpp_pool?i=new Vi:(i=Vi.zpp_pool,Vi.zpp_pool=i.next,i.next=null),i.elt=e;var i=i;return null==t?(i.next=this.head,this.head=i):(i.next=t.next,t.next=i),this.pushmod=this.modified=!0,this.length++,i},pi.prototype.inlined_insert=function(t,e){null==Vi.zpp_pool?i=new Vi:(i=Vi.zpp_pool,Vi.zpp_pool=i.next,i.next=null),i.elt=e;var i=i;return null==t?(i.next=this.head,this.head=i):(i.next=t.next,t.next=i),this.pushmod=this.modified=!0,this.length++,i},pi.prototype.pop=function(){var t=this.head;this.head=t.next,t.elt=null,t.next=Vi.zpp_pool,Vi.zpp_pool=t,null==this.head&&(this.pushmod=!0),this.modified=!0,this.length--},pi.prototype.inlined_pop=function(){var t=this.head;this.head=t.next,t.elt=null,t.next=Vi.zpp_pool,Vi.zpp_pool=t,null==this.head&&(this.pushmod=!0),this.modified=!0,this.length--},pi.prototype.pop_unsafe=function(){var t=this.head.elt;return this.pop(),t},pi.prototype.inlined_pop_unsafe=function(){var t=this.head.elt;return this.pop(),t},pi.prototype.remove=function(t){for(var e,i,n=null,r=this.head;null!=r;){if(r.elt==t){null==n?(i=(e=this.head).next,this.head=i,null==this.head&&(this.pushmod=!0)):(i=(e=n.next).next,null==(n.next=i)&&(this.pushmod=!0));var o=e;o.elt=null,o.next=Vi.zpp_pool,Vi.zpp_pool=o,this.modified=!0,this.length--,this.pushmod=!0;break}r=(n=r).next}},pi.prototype.try_remove=function(t){for(var e=null,i=this.head,n=!1;null!=i;){if(i.elt==t){this.erase(e),n=!0;break}i=(e=i).next}return n},pi.prototype.inlined_remove=function(t){for(var e,i,n=null,r=this.head;null!=r;){if(r.elt==t){null==n?(i=(e=this.head).next,this.head=i,null==this.head&&(this.pushmod=!0)):(i=(e=n.next).next,null==(n.next=i)&&(this.pushmod=!0));var o=e;o.elt=null,o.next=Vi.zpp_pool,Vi.zpp_pool=o,this.modified=!0,this.length--,this.pushmod=!0;break}r=(n=r).next}},pi.prototype.inlined_try_remove=function(t){for(var e,i,n=null,r=this.head,o=!1;null!=r;){if(r.elt==t){null==n?(i=(e=this.head).next,this.head=i,null==this.head&&(this.pushmod=!0)):(i=(e=n.next).next,null==(n.next=i)&&(this.pushmod=!0));var s=e;s.elt=null,s.next=Vi.zpp_pool,Vi.zpp_pool=s,this.modified=!0,this.length--,o=this.pushmod=!0;break}r=(n=r).next}return o},pi.prototype.erase=function(t){var e;null==t?(e=(i=this.head).next,this.head=e,null==this.head&&(this.pushmod=!0)):(e=(i=t.next).next,null==(t.next=e)&&(this.pushmod=!0));var i=i;return i.elt=null,i.next=Vi.zpp_pool,Vi.zpp_pool=i,this.modified=!0,this.length--,this.pushmod=!0,e},pi.prototype.inlined_erase=function(t){var e;null==t?(e=(i=this.head).next,this.head=e,null==this.head&&(this.pushmod=!0)):(e=(i=t.next).next,null==(t.next=e)&&(this.pushmod=!0));var i=i;return i.elt=null,i.next=Vi.zpp_pool,Vi.zpp_pool=i,this.modified=!0,this.length--,this.pushmod=!0,e},pi.prototype.splice=function(t,e){for(;0<e--&&null!=t.next;)this.erase(t);return t.next},pi.prototype.clear=function(){for(;null!=this.head;){var t=this.head;this.head=t.next,t.elt=null,t.next=Vi.zpp_pool,Vi.zpp_pool=t,null==this.head&&(this.pushmod=!0),this.modified=!0,this.length--}this.pushmod=!0},pi.prototype.inlined_clear=function(){for(;null!=this.head;){var t=this.head;this.head=t.next,t.elt=null,t.next=Vi.zpp_pool,Vi.zpp_pool=t,null==this.head&&(this.pushmod=!0),this.modified=!0,this.length--}this.pushmod=!0},pi.prototype.reverse=function(){for(var t=this.head,e=null;null!=t;){var i=t.next;t.next=e,e=this.head=t,t=i}this.modified=!0,this.pushmod=!0},pi.prototype.empty=function(){return null==this.head},pi.prototype.size=function(){return this.length},pi.prototype.has=function(t){for(var e=!1,i=this.head;null!=i;){if(i.elt==t){e=!0;break}i=i.next}return e},pi.prototype.inlined_has=function(t){for(var e=!1,i=this.head;null!=i;){if(i.elt==t){e=!0;break}i=i.next}return e},pi.prototype.front=function(){return this.head.elt},pi.prototype.back=function(){for(var t=this.head,e=t;null!=e;)e=(t=e).next;return t.elt},pi.prototype.iterator_at=function(t){for(var e=this.head;0<t--&&null!=e;)e=e.next;return e},pi.prototype.at=function(t){t=this.iterator_at(t);return null!=t?t.elt:null},pi.prototype.__class__=pi;var ui=zpp_nape.util.ZNPList_ZPP_Shape=function(){this.length=0,this.pushmod=!1,this.modified=!1,this.head=null};ui.__name__=["zpp_nape","util","ZNPList_ZPP_Shape"],ui.prototype.head=null,ui.prototype.begin=function(){return this.head},ui.prototype.modified=null,ui.prototype.pushmod=null,ui.prototype.length=null,ui.prototype.setbegin=function(t){this.head=t,this.modified=!0,this.pushmod=!0},ui.prototype.add=function(t){null==Wi.zpp_pool?e=new Wi:(e=Wi.zpp_pool,Wi.zpp_pool=e.next,e.next=null),e.elt=t;var e=e;return e.next=this.head,this.head=e,this.modified=!0,this.length++,t},ui.prototype.inlined_add=function(t){null==Wi.zpp_pool?e=new Wi:(e=Wi.zpp_pool,Wi.zpp_pool=e.next,e.next=null),e.elt=t;var e=e;return e.next=this.head,this.head=e,this.modified=!0,this.length++,t},ui.prototype.addAll=function(t){for(var e=t.head;null!=e;)this.add(e.elt),e=e.next},ui.prototype.insert=function(t,e){null==Wi.zpp_pool?i=new Wi:(i=Wi.zpp_pool,Wi.zpp_pool=i.next,i.next=null),i.elt=e;var i=i;return null==t?(i.next=this.head,this.head=i):(i.next=t.next,t.next=i),this.pushmod=this.modified=!0,this.length++,i},ui.prototype.inlined_insert=function(t,e){null==Wi.zpp_pool?i=new Wi:(i=Wi.zpp_pool,Wi.zpp_pool=i.next,i.next=null),i.elt=e;var i=i;return null==t?(i.next=this.head,this.head=i):(i.next=t.next,t.next=i),this.pushmod=this.modified=!0,this.length++,i},ui.prototype.pop=function(){var t=this.head;this.head=t.next,t.elt=null,t.next=Wi.zpp_pool,Wi.zpp_pool=t,null==this.head&&(this.pushmod=!0),this.modified=!0,this.length--},ui.prototype.inlined_pop=function(){var t=this.head;this.head=t.next,t.elt=null,t.next=Wi.zpp_pool,Wi.zpp_pool=t,null==this.head&&(this.pushmod=!0),this.modified=!0,this.length--},ui.prototype.pop_unsafe=function(){var t=this.head.elt;return this.pop(),t},ui.prototype.inlined_pop_unsafe=function(){var t=this.head.elt;return this.pop(),t},ui.prototype.remove=function(t){for(var e,i,n=null,r=this.head;null!=r;){if(r.elt==t){null==n?(i=(e=this.head).next,this.head=i,null==this.head&&(this.pushmod=!0)):(i=(e=n.next).next,null==(n.next=i)&&(this.pushmod=!0));var o=e;o.elt=null,o.next=Wi.zpp_pool,Wi.zpp_pool=o,this.modified=!0,this.length--,this.pushmod=!0;break}r=(n=r).next}},ui.prototype.try_remove=function(t){for(var e=null,i=this.head,n=!1;null!=i;){if(i.elt==t){this.erase(e),n=!0;break}i=(e=i).next}return n},ui.prototype.inlined_remove=function(t){for(var e,i,n=null,r=this.head;null!=r;){if(r.elt==t){null==n?(i=(e=this.head).next,this.head=i,null==this.head&&(this.pushmod=!0)):(i=(e=n.next).next,null==(n.next=i)&&(this.pushmod=!0));var o=e;o.elt=null,o.next=Wi.zpp_pool,Wi.zpp_pool=o,this.modified=!0,this.length--,this.pushmod=!0;break}r=(n=r).next}},ui.prototype.inlined_try_remove=function(t){for(var e,i,n=null,r=this.head,o=!1;null!=r;){if(r.elt==t){null==n?(i=(e=this.head).next,this.head=i,null==this.head&&(this.pushmod=!0)):(i=(e=n.next).next,null==(n.next=i)&&(this.pushmod=!0));var s=e;s.elt=null,s.next=Wi.zpp_pool,Wi.zpp_pool=s,this.modified=!0,this.length--,o=this.pushmod=!0;break}r=(n=r).next}return o},ui.prototype.erase=function(t){var e;null==t?(e=(i=this.head).next,this.head=e,null==this.head&&(this.pushmod=!0)):(e=(i=t.next).next,null==(t.next=e)&&(this.pushmod=!0));var i=i;return i.elt=null,i.next=Wi.zpp_pool,Wi.zpp_pool=i,this.modified=!0,this.length--,this.pushmod=!0,e},ui.prototype.inlined_erase=function(t){var e;null==t?(e=(i=this.head).next,this.head=e,null==this.head&&(this.pushmod=!0)):(e=(i=t.next).next,null==(t.next=e)&&(this.pushmod=!0));var i=i;return i.elt=null,i.next=Wi.zpp_pool,Wi.zpp_pool=i,this.modified=!0,this.length--,this.pushmod=!0,e},ui.prototype.splice=function(t,e){for(;0<e--&&null!=t.next;)this.erase(t);return t.next},ui.prototype.clear=function(){for(;null!=this.head;){var t=this.head;this.head=t.next,t.elt=null,t.next=Wi.zpp_pool,Wi.zpp_pool=t,null==this.head&&(this.pushmod=!0),this.modified=!0,this.length--}this.pushmod=!0},ui.prototype.inlined_clear=function(){for(;null!=this.head;){var t=this.head;this.head=t.next,t.elt=null,t.next=Wi.zpp_pool,Wi.zpp_pool=t,null==this.head&&(this.pushmod=!0),this.modified=!0,this.length--}this.pushmod=!0},ui.prototype.reverse=function(){for(var t=this.head,e=null;null!=t;){var i=t.next;t.next=e,e=this.head=t,t=i}this.modified=!0,this.pushmod=!0},ui.prototype.empty=function(){return null==this.head},ui.prototype.size=function(){return this.length},ui.prototype.has=function(t){for(var e=!1,i=this.head;null!=i;){if(i.elt==t){e=!0;break}i=i.next}return e},ui.prototype.inlined_has=function(t){for(var e=!1,i=this.head;null!=i;){if(i.elt==t){e=!0;break}i=i.next}return e},ui.prototype.front=function(){return this.head.elt},ui.prototype.back=function(){for(var t=this.head,e=t;null!=e;)e=(t=e).next;return t.elt},ui.prototype.iterator_at=function(t){for(var e=this.head;0<t--&&null!=e;)e=e.next;return e},ui.prototype.at=function(t){t=this.iterator_at(t);return null!=t?t.elt:null},ui.prototype.__class__=ui;var di=zpp_nape.util.ZNPList_ZPP_Body=function(){this.length=0,this.pushmod=!1,this.modified=!1,this.head=null};di.__name__=["zpp_nape","util","ZNPList_ZPP_Body"],di.prototype.head=null,di.prototype.begin=function(){return this.head},di.prototype.modified=null,di.prototype.pushmod=null,di.prototype.length=null,di.prototype.setbegin=function(t){this.head=t,this.modified=!0,this.pushmod=!0},di.prototype.add=function(t){null==Xi.zpp_pool?e=new Xi:(e=Xi.zpp_pool,Xi.zpp_pool=e.next,e.next=null),e.elt=t;var e=e;return e.next=this.head,this.head=e,this.modified=!0,this.length++,t},di.prototype.inlined_add=function(t){null==Xi.zpp_pool?e=new Xi:(e=Xi.zpp_pool,Xi.zpp_pool=e.next,e.next=null),e.elt=t;var e=e;return e.next=this.head,this.head=e,this.modified=!0,this.length++,t},di.prototype.addAll=function(t){for(var e=t.head;null!=e;)this.add(e.elt),e=e.next},di.prototype.insert=function(t,e){null==Xi.zpp_pool?i=new Xi:(i=Xi.zpp_pool,Xi.zpp_pool=i.next,i.next=null),i.elt=e;var i=i;return null==t?(i.next=this.head,this.head=i):(i.next=t.next,t.next=i),this.pushmod=this.modified=!0,this.length++,i},di.prototype.inlined_insert=function(t,e){null==Xi.zpp_pool?i=new Xi:(i=Xi.zpp_pool,Xi.zpp_pool=i.next,i.next=null),i.elt=e;var i=i;return null==t?(i.next=this.head,this.head=i):(i.next=t.next,t.next=i),this.pushmod=this.modified=!0,this.length++,i},di.prototype.pop=function(){var t=this.head;this.head=t.next,t.elt=null,t.next=Xi.zpp_pool,Xi.zpp_pool=t,null==this.head&&(this.pushmod=!0),this.modified=!0,this.length--},di.prototype.inlined_pop=function(){var t=this.head;this.head=t.next,t.elt=null,t.next=Xi.zpp_pool,Xi.zpp_pool=t,null==this.head&&(this.pushmod=!0),this.modified=!0,this.length--},di.prototype.pop_unsafe=function(){var t=this.head.elt;return this.pop(),t},di.prototype.inlined_pop_unsafe=function(){var t=this.head.elt;return this.pop(),t},di.prototype.remove=function(t){for(var e,i,n=null,r=this.head;null!=r;){if(r.elt==t){null==n?(i=(e=this.head).next,this.head=i,null==this.head&&(this.pushmod=!0)):(i=(e=n.next).next,null==(n.next=i)&&(this.pushmod=!0));var o=e;o.elt=null,o.next=Xi.zpp_pool,Xi.zpp_pool=o,this.modified=!0,this.length--,this.pushmod=!0;break}r=(n=r).next}},di.prototype.try_remove=function(t){for(var e=null,i=this.head,n=!1;null!=i;){if(i.elt==t){this.erase(e),n=!0;break}i=(e=i).next}return n},di.prototype.inlined_remove=function(t){for(var e,i,n=null,r=this.head;null!=r;){if(r.elt==t){null==n?(i=(e=this.head).next,this.head=i,null==this.head&&(this.pushmod=!0)):(i=(e=n.next).next,null==(n.next=i)&&(this.pushmod=!0));var o=e;o.elt=null,o.next=Xi.zpp_pool,Xi.zpp_pool=o,this.modified=!0,this.length--,this.pushmod=!0;break}r=(n=r).next}},di.prototype.inlined_try_remove=function(t){for(var e,i,n=null,r=this.head,o=!1;null!=r;){if(r.elt==t){null==n?(i=(e=this.head).next,this.head=i,null==this.head&&(this.pushmod=!0)):(i=(e=n.next).next,null==(n.next=i)&&(this.pushmod=!0));var s=e;s.elt=null,s.next=Xi.zpp_pool,Xi.zpp_pool=s,this.modified=!0,this.length--,o=this.pushmod=!0;break}r=(n=r).next}return o},di.prototype.erase=function(t){var e;null==t?(e=(i=this.head).next,this.head=e,null==this.head&&(this.pushmod=!0)):(e=(i=t.next).next,null==(t.next=e)&&(this.pushmod=!0));var i=i;return i.elt=null,i.next=Xi.zpp_pool,Xi.zpp_pool=i,this.modified=!0,this.length--,this.pushmod=!0,e},di.prototype.inlined_erase=function(t){var e;null==t?(e=(i=this.head).next,this.head=e,null==this.head&&(this.pushmod=!0)):(e=(i=t.next).next,null==(t.next=e)&&(this.pushmod=!0));var i=i;return i.elt=null,i.next=Xi.zpp_pool,Xi.zpp_pool=i,this.modified=!0,this.length--,this.pushmod=!0,e},di.prototype.splice=function(t,e){for(;0<e--&&null!=t.next;)this.erase(t);return t.next},di.prototype.clear=function(){for(;null!=this.head;){var t=this.head;this.head=t.next,t.elt=null,t.next=Xi.zpp_pool,Xi.zpp_pool=t,null==this.head&&(this.pushmod=!0),this.modified=!0,this.length--}this.pushmod=!0},di.prototype.inlined_clear=function(){for(;null!=this.head;){var t=this.head;this.head=t.next,t.elt=null,t.next=Xi.zpp_pool,Xi.zpp_pool=t,null==this.head&&(this.pushmod=!0),this.modified=!0,this.length--}this.pushmod=!0},di.prototype.reverse=function(){for(var t=this.head,e=null;null!=t;){var i=t.next;t.next=e,e=this.head=t,t=i}this.modified=!0,this.pushmod=!0},di.prototype.empty=function(){return null==this.head},di.prototype.size=function(){return this.length},di.prototype.has=function(t){for(var e=!1,i=this.head;null!=i;){if(i.elt==t){e=!0;break}i=i.next}return e},di.prototype.inlined_has=function(t){for(var e=!1,i=this.head;null!=i;){if(i.elt==t){e=!0;break}i=i.next}return e},di.prototype.front=function(){return this.head.elt},di.prototype.back=function(){for(var t=this.head,e=t;null!=e;)e=(t=e).next;return t.elt},di.prototype.iterator_at=function(t){for(var e=this.head;0<t--&&null!=e;)e=e.next;return e},di.prototype.at=function(t){t=this.iterator_at(t);return null!=t?t.elt:null},di.prototype.__class__=di;var ci=zpp_nape.util.ZNPList_ZPP_Compound=function(){this.length=0,this.pushmod=!1,this.modified=!1,this.head=null};ci.__name__=["zpp_nape","util","ZNPList_ZPP_Compound"],ci.prototype.head=null,ci.prototype.begin=function(){return this.head},ci.prototype.modified=null,ci.prototype.pushmod=null,ci.prototype.length=null,ci.prototype.setbegin=function(t){this.head=t,this.modified=!0,this.pushmod=!0},ci.prototype.add=function(t){null==qi.zpp_pool?e=new qi:(e=qi.zpp_pool,qi.zpp_pool=e.next,e.next=null),e.elt=t;var e=e;return e.next=this.head,this.head=e,this.modified=!0,this.length++,t},ci.prototype.inlined_add=function(t){null==qi.zpp_pool?e=new qi:(e=qi.zpp_pool,qi.zpp_pool=e.next,e.next=null),e.elt=t;var e=e;return e.next=this.head,this.head=e,this.modified=!0,this.length++,t},ci.prototype.addAll=function(t){for(var e=t.head;null!=e;)this.add(e.elt),e=e.next},ci.prototype.insert=function(t,e){null==qi.zpp_pool?i=new qi:(i=qi.zpp_pool,qi.zpp_pool=i.next,i.next=null),i.elt=e;var i=i;return null==t?(i.next=this.head,this.head=i):(i.next=t.next,t.next=i),this.pushmod=this.modified=!0,this.length++,i},ci.prototype.inlined_insert=function(t,e){null==qi.zpp_pool?i=new qi:(i=qi.zpp_pool,qi.zpp_pool=i.next,i.next=null),i.elt=e;var i=i;return null==t?(i.next=this.head,this.head=i):(i.next=t.next,t.next=i),this.pushmod=this.modified=!0,this.length++,i},ci.prototype.pop=function(){var t=this.head;this.head=t.next,t.elt=null,t.next=qi.zpp_pool,qi.zpp_pool=t,null==this.head&&(this.pushmod=!0),this.modified=!0,this.length--},ci.prototype.inlined_pop=function(){var t=this.head;this.head=t.next,t.elt=null,t.next=qi.zpp_pool,qi.zpp_pool=t,null==this.head&&(this.pushmod=!0),this.modified=!0,this.length--},ci.prototype.pop_unsafe=function(){var t=this.head.elt;return this.pop(),t},ci.prototype.inlined_pop_unsafe=function(){var t=this.head.elt;return this.pop(),t},ci.prototype.remove=function(t){for(var e,i,n=null,r=this.head;null!=r;){if(r.elt==t){null==n?(i=(e=this.head).next,this.head=i,null==this.head&&(this.pushmod=!0)):(i=(e=n.next).next,null==(n.next=i)&&(this.pushmod=!0));var o=e;o.elt=null,o.next=qi.zpp_pool,qi.zpp_pool=o,this.modified=!0,this.length--,this.pushmod=!0;break}r=(n=r).next}},ci.prototype.try_remove=function(t){for(var e=null,i=this.head,n=!1;null!=i;){if(i.elt==t){this.erase(e),n=!0;break}i=(e=i).next}return n},ci.prototype.inlined_remove=function(t){for(var e,i,n=null,r=this.head;null!=r;){if(r.elt==t){null==n?(i=(e=this.head).next,this.head=i,null==this.head&&(this.pushmod=!0)):(i=(e=n.next).next,null==(n.next=i)&&(this.pushmod=!0));var o=e;o.elt=null,o.next=qi.zpp_pool,qi.zpp_pool=o,this.modified=!0,this.length--,this.pushmod=!0;break}r=(n=r).next}},ci.prototype.inlined_try_remove=function(t){for(var e,i,n=null,r=this.head,o=!1;null!=r;){if(r.elt==t){null==n?(i=(e=this.head).next,this.head=i,null==this.head&&(this.pushmod=!0)):(i=(e=n.next).next,null==(n.next=i)&&(this.pushmod=!0));var s=e;s.elt=null,s.next=qi.zpp_pool,qi.zpp_pool=s,this.modified=!0,this.length--,o=this.pushmod=!0;break}r=(n=r).next}return o},ci.prototype.erase=function(t){var e;null==t?(e=(i=this.head).next,this.head=e,null==this.head&&(this.pushmod=!0)):(e=(i=t.next).next,null==(t.next=e)&&(this.pushmod=!0));var i=i;return i.elt=null,i.next=qi.zpp_pool,qi.zpp_pool=i,this.modified=!0,this.length--,this.pushmod=!0,e},ci.prototype.inlined_erase=function(t){var e;null==t?(e=(i=this.head).next,this.head=e,null==this.head&&(this.pushmod=!0)):(e=(i=t.next).next,null==(t.next=e)&&(this.pushmod=!0));var i=i;return i.elt=null,i.next=qi.zpp_pool,qi.zpp_pool=i,this.modified=!0,this.length--,this.pushmod=!0,e},ci.prototype.splice=function(t,e){for(;0<e--&&null!=t.next;)this.erase(t);return t.next},ci.prototype.clear=function(){for(;null!=this.head;){var t=this.head;this.head=t.next,t.elt=null,t.next=qi.zpp_pool,qi.zpp_pool=t,null==this.head&&(this.pushmod=!0),this.modified=!0,this.length--}this.pushmod=!0},ci.prototype.inlined_clear=function(){for(;null!=this.head;){var t=this.head;this.head=t.next,t.elt=null,t.next=qi.zpp_pool,qi.zpp_pool=t,null==this.head&&(this.pushmod=!0),this.modified=!0,this.length--}this.pushmod=!0},ci.prototype.reverse=function(){for(var t=this.head,e=null;null!=t;){var i=t.next;t.next=e,e=this.head=t,t=i}this.modified=!0,this.pushmod=!0},ci.prototype.empty=function(){return null==this.head},ci.prototype.size=function(){return this.length},ci.prototype.has=function(t){for(var e=!1,i=this.head;null!=i;){if(i.elt==t){e=!0;break}i=i.next}return e},ci.prototype.inlined_has=function(t){for(var e=!1,i=this.head;null!=i;){if(i.elt==t){e=!0;break}i=i.next}return e},ci.prototype.front=function(){return this.head.elt},ci.prototype.back=function(){for(var t=this.head,e=t;null!=e;)e=(t=e).next;return t.elt},ci.prototype.iterator_at=function(t){for(var e=this.head;0<t--&&null!=e;)e=e.next;return e},ci.prototype.at=function(t){t=this.iterator_at(t);return null!=t?t.elt:null},ci.prototype.__class__=ci;var yi=zpp_nape.util.ZNPList_ZPP_Arbiter=function(){this.length=0,this.pushmod=!1,this.modified=!1,this.head=null};yi.__name__=["zpp_nape","util","ZNPList_ZPP_Arbiter"],yi.prototype.head=null,yi.prototype.begin=function(){return this.head},yi.prototype.modified=null,yi.prototype.pushmod=null,yi.prototype.length=null,yi.prototype.setbegin=function(t){this.head=t,this.modified=!0,this.pushmod=!0},yi.prototype.add=function(t){null==er.zpp_pool?e=new er:(e=er.zpp_pool,er.zpp_pool=e.next,e.next=null),e.elt=t;var e=e;return e.next=this.head,this.head=e,this.modified=!0,this.length++,t},yi.prototype.inlined_add=function(t){null==er.zpp_pool?e=new er:(e=er.zpp_pool,er.zpp_pool=e.next,e.next=null),e.elt=t;var e=e;return e.next=this.head,this.head=e,this.modified=!0,this.length++,t},yi.prototype.addAll=function(t){for(var e=t.head;null!=e;)this.add(e.elt),e=e.next},yi.prototype.insert=function(t,e){null==er.zpp_pool?i=new er:(i=er.zpp_pool,er.zpp_pool=i.next,i.next=null),i.elt=e;var i=i;return null==t?(i.next=this.head,this.head=i):(i.next=t.next,t.next=i),this.pushmod=this.modified=!0,this.length++,i},yi.prototype.inlined_insert=function(t,e){null==er.zpp_pool?i=new er:(i=er.zpp_pool,er.zpp_pool=i.next,i.next=null),i.elt=e;var i=i;return null==t?(i.next=this.head,this.head=i):(i.next=t.next,t.next=i),this.pushmod=this.modified=!0,this.length++,i},yi.prototype.pop=function(){var t=this.head;this.head=t.next,t.elt=null,t.next=er.zpp_pool,er.zpp_pool=t,null==this.head&&(this.pushmod=!0),this.modified=!0,this.length--},yi.prototype.inlined_pop=function(){var t=this.head;this.head=t.next,t.elt=null,t.next=er.zpp_pool,er.zpp_pool=t,null==this.head&&(this.pushmod=!0),this.modified=!0,this.length--},yi.prototype.pop_unsafe=function(){var t=this.head.elt;return this.pop(),t},yi.prototype.inlined_pop_unsafe=function(){var t=this.head.elt;return this.pop(),t},yi.prototype.remove=function(t){for(var e,i,n=null,r=this.head;null!=r;){if(r.elt==t){null==n?(i=(e=this.head).next,this.head=i,null==this.head&&(this.pushmod=!0)):(i=(e=n.next).next,null==(n.next=i)&&(this.pushmod=!0));var o=e;o.elt=null,o.next=er.zpp_pool,er.zpp_pool=o,this.modified=!0,this.length--,this.pushmod=!0;break}r=(n=r).next}},yi.prototype.try_remove=function(t){for(var e=null,i=this.head,n=!1;null!=i;){if(i.elt==t){this.erase(e),n=!0;break}i=(e=i).next}return n},yi.prototype.inlined_remove=function(t){for(var e,i,n=null,r=this.head;null!=r;){if(r.elt==t){null==n?(i=(e=this.head).next,this.head=i,null==this.head&&(this.pushmod=!0)):(i=(e=n.next).next,null==(n.next=i)&&(this.pushmod=!0));var o=e;o.elt=null,o.next=er.zpp_pool,er.zpp_pool=o,this.modified=!0,this.length--,this.pushmod=!0;break}r=(n=r).next}},yi.prototype.inlined_try_remove=function(t){for(var e,i,n=null,r=this.head,o=!1;null!=r;){if(r.elt==t){null==n?(i=(e=this.head).next,this.head=i,null==this.head&&(this.pushmod=!0)):(i=(e=n.next).next,null==(n.next=i)&&(this.pushmod=!0));var s=e;s.elt=null,s.next=er.zpp_pool,er.zpp_pool=s,this.modified=!0,this.length--,o=this.pushmod=!0;break}r=(n=r).next}return o},yi.prototype.erase=function(t){var e;null==t?(e=(i=this.head).next,this.head=e,null==this.head&&(this.pushmod=!0)):(e=(i=t.next).next,null==(t.next=e)&&(this.pushmod=!0));var i=i;return i.elt=null,i.next=er.zpp_pool,er.zpp_pool=i,this.modified=!0,this.length--,this.pushmod=!0,e},yi.prototype.inlined_erase=function(t){var e;null==t?(e=(i=this.head).next,this.head=e,null==this.head&&(this.pushmod=!0)):(e=(i=t.next).next,null==(t.next=e)&&(this.pushmod=!0));var i=i;return i.elt=null,i.next=er.zpp_pool,er.zpp_pool=i,this.modified=!0,this.length--,this.pushmod=!0,e},yi.prototype.splice=function(t,e){for(;0<e--&&null!=t.next;)this.erase(t);return t.next},yi.prototype.clear=function(){for(;null!=this.head;){var t=this.head;this.head=t.next,t.elt=null,t.next=er.zpp_pool,er.zpp_pool=t,null==this.head&&(this.pushmod=!0),this.modified=!0,this.length--}this.pushmod=!0},yi.prototype.inlined_clear=function(){for(;null!=this.head;){var t=this.head;this.head=t.next,t.elt=null,t.next=er.zpp_pool,er.zpp_pool=t,null==this.head&&(this.pushmod=!0),this.modified=!0,this.length--}this.pushmod=!0},yi.prototype.reverse=function(){for(var t=this.head,e=null;null!=t;){var i=t.next;t.next=e,e=this.head=t,t=i}this.modified=!0,this.pushmod=!0},yi.prototype.empty=function(){return null==this.head},yi.prototype.size=function(){return this.length},yi.prototype.has=function(t){for(var e=!1,i=this.head;null!=i;){if(i.elt==t){e=!0;break}i=i.next}return e},yi.prototype.inlined_has=function(t){for(var e=!1,i=this.head;null!=i;){if(i.elt==t){e=!0;break}i=i.next}return e},yi.prototype.front=function(){return this.head.elt},yi.prototype.back=function(){for(var t=this.head,e=t;null!=e;)e=(t=e).next;return t.elt},yi.prototype.iterator_at=function(t){for(var e=this.head;0<t--&&null!=e;)e=e.next;return e},yi.prototype.at=function(t){t=this.iterator_at(t);return null!=t?t.elt:null},yi.prototype.__class__=yi;var vi=zpp_nape.util.ZNPList_ZPP_CbSetPair=function(){this.length=0,this.pushmod=!1,this.modified=!1,this.head=null};vi.__name__=["zpp_nape","util","ZNPList_ZPP_CbSetPair"],vi.prototype.head=null,vi.prototype.begin=function(){return this.head},vi.prototype.modified=null,vi.prototype.pushmod=null,vi.prototype.length=null,vi.prototype.setbegin=function(t){this.head=t,this.modified=!0,this.pushmod=!0},vi.prototype.add=function(t){null==Zi.zpp_pool?e=new Zi:(e=Zi.zpp_pool,Zi.zpp_pool=e.next,e.next=null),e.elt=t;var e=e;return e.next=this.head,this.head=e,this.modified=!0,this.length++,t},vi.prototype.inlined_add=function(t){null==Zi.zpp_pool?e=new Zi:(e=Zi.zpp_pool,Zi.zpp_pool=e.next,e.next=null),e.elt=t;var e=e;return e.next=this.head,this.head=e,this.modified=!0,this.length++,t},vi.prototype.addAll=function(t){for(var e=t.head;null!=e;)this.add(e.elt),e=e.next},vi.prototype.insert=function(t,e){null==Zi.zpp_pool?i=new Zi:(i=Zi.zpp_pool,Zi.zpp_pool=i.next,i.next=null),i.elt=e;var i=i;return null==t?(i.next=this.head,this.head=i):(i.next=t.next,t.next=i),this.pushmod=this.modified=!0,this.length++,i},vi.prototype.inlined_insert=function(t,e){null==Zi.zpp_pool?i=new Zi:(i=Zi.zpp_pool,Zi.zpp_pool=i.next,i.next=null),i.elt=e;var i=i;return null==t?(i.next=this.head,this.head=i):(i.next=t.next,t.next=i),this.pushmod=this.modified=!0,this.length++,i},vi.prototype.pop=function(){var t=this.head;this.head=t.next,t.elt=null,t.next=Zi.zpp_pool,Zi.zpp_pool=t,null==this.head&&(this.pushmod=!0),this.modified=!0,this.length--},vi.prototype.inlined_pop=function(){var t=this.head;this.head=t.next,t.elt=null,t.next=Zi.zpp_pool,Zi.zpp_pool=t,null==this.head&&(this.pushmod=!0),this.modified=!0,this.length--},vi.prototype.pop_unsafe=function(){var t=this.head.elt;return this.pop(),t},vi.prototype.inlined_pop_unsafe=function(){var t=this.head.elt;return this.pop(),t},vi.prototype.remove=function(t){for(var e,i,n=null,r=this.head;null!=r;){if(r.elt==t){null==n?(i=(e=this.head).next,this.head=i,null==this.head&&(this.pushmod=!0)):(i=(e=n.next).next,null==(n.next=i)&&(this.pushmod=!0));var o=e;o.elt=null,o.next=Zi.zpp_pool,Zi.zpp_pool=o,this.modified=!0,this.length--,this.pushmod=!0;break}r=(n=r).next}},vi.prototype.try_remove=function(t){for(var e=null,i=this.head,n=!1;null!=i;){if(i.elt==t){this.erase(e),n=!0;break}i=(e=i).next}return n},vi.prototype.inlined_remove=function(t){for(var e,i,n=null,r=this.head;null!=r;){if(r.elt==t){null==n?(i=(e=this.head).next,this.head=i,null==this.head&&(this.pushmod=!0)):(i=(e=n.next).next,null==(n.next=i)&&(this.pushmod=!0));var o=e;o.elt=null,o.next=Zi.zpp_pool,Zi.zpp_pool=o,this.modified=!0,this.length--,this.pushmod=!0;break}r=(n=r).next}},vi.prototype.inlined_try_remove=function(t){for(var e,i,n=null,r=this.head,o=!1;null!=r;){if(r.elt==t){null==n?(i=(e=this.head).next,this.head=i,null==this.head&&(this.pushmod=!0)):(i=(e=n.next).next,null==(n.next=i)&&(this.pushmod=!0));var s=e;s.elt=null,s.next=Zi.zpp_pool,Zi.zpp_pool=s,this.modified=!0,this.length--,o=this.pushmod=!0;break}r=(n=r).next}return o},vi.prototype.erase=function(t){var e;null==t?(e=(i=this.head).next,this.head=e,null==this.head&&(this.pushmod=!0)):(e=(i=t.next).next,null==(t.next=e)&&(this.pushmod=!0));var i=i;return i.elt=null,i.next=Zi.zpp_pool,Zi.zpp_pool=i,this.modified=!0,this.length--,this.pushmod=!0,e},vi.prototype.inlined_erase=function(t){var e;null==t?(e=(i=this.head).next,this.head=e,null==this.head&&(this.pushmod=!0)):(e=(i=t.next).next,null==(t.next=e)&&(this.pushmod=!0));var i=i;return i.elt=null,i.next=Zi.zpp_pool,Zi.zpp_pool=i,this.modified=!0,this.length--,this.pushmod=!0,e},vi.prototype.splice=function(t,e){for(;0<e--&&null!=t.next;)this.erase(t);return t.next},vi.prototype.clear=function(){for(;null!=this.head;){var t=this.head;this.head=t.next,t.elt=null,t.next=Zi.zpp_pool,Zi.zpp_pool=t,null==this.head&&(this.pushmod=!0),this.modified=!0,this.length--}this.pushmod=!0},vi.prototype.inlined_clear=function(){for(;null!=this.head;){var t=this.head;this.head=t.next,t.elt=null,t.next=Zi.zpp_pool,Zi.zpp_pool=t,null==this.head&&(this.pushmod=!0),this.modified=!0,this.length--}this.pushmod=!0},vi.prototype.reverse=function(){for(var t=this.head,e=null;null!=t;){var i=t.next;t.next=e,e=this.head=t,t=i}this.modified=!0,this.pushmod=!0},vi.prototype.empty=function(){return null==this.head},vi.prototype.size=function(){return this.length},vi.prototype.has=function(t){for(var e=!1,i=this.head;null!=i;){if(i.elt==t){e=!0;break}i=i.next}return e},vi.prototype.inlined_has=function(t){for(var e=!1,i=this.head;null!=i;){if(i.elt==t){e=!0;break}i=i.next}return e},vi.prototype.front=function(){return this.head.elt},vi.prototype.back=function(){for(var t=this.head,e=t;null!=e;)e=(t=e).next;return t.elt},vi.prototype.iterator_at=function(t){for(var e=this.head;0<t--&&null!=e;)e=e.next;return e},vi.prototype.at=function(t){t=this.iterator_at(t);return null!=t?t.elt:null},vi.prototype.__class__=vi;var wi=zpp_nape.util.ZNPList_ZPP_CutInt=function(){this.length=0,this.pushmod=!1,this.modified=!1,this.head=null};wi.__name__=["zpp_nape","util","ZNPList_ZPP_CutInt"],wi.prototype.head=null,wi.prototype.begin=function(){return this.head},wi.prototype.modified=null,wi.prototype.pushmod=null,wi.prototype.length=null,wi.prototype.setbegin=function(t){this.head=t,this.modified=!0,this.pushmod=!0},wi.prototype.add=function(t){null==Qi.zpp_pool?e=new Qi:(e=Qi.zpp_pool,Qi.zpp_pool=e.next,e.next=null),e.elt=t;var e=e;return e.next=this.head,this.head=e,this.modified=!0,this.length++,t},wi.prototype.inlined_add=function(t){null==Qi.zpp_pool?e=new Qi:(e=Qi.zpp_pool,Qi.zpp_pool=e.next,e.next=null),e.elt=t;var e=e;return e.next=this.head,this.head=e,this.modified=!0,this.length++,t},wi.prototype.addAll=function(t){for(var e=t.head;null!=e;)this.add(e.elt),e=e.next},wi.prototype.insert=function(t,e){null==Qi.zpp_pool?i=new Qi:(i=Qi.zpp_pool,Qi.zpp_pool=i.next,i.next=null),i.elt=e;var i=i;return null==t?(i.next=this.head,this.head=i):(i.next=t.next,t.next=i),this.pushmod=this.modified=!0,this.length++,i},wi.prototype.inlined_insert=function(t,e){null==Qi.zpp_pool?i=new Qi:(i=Qi.zpp_pool,Qi.zpp_pool=i.next,i.next=null),i.elt=e;var i=i;return null==t?(i.next=this.head,this.head=i):(i.next=t.next,t.next=i),this.pushmod=this.modified=!0,this.length++,i},wi.prototype.pop=function(){var t=this.head;this.head=t.next,t.elt=null,t.next=Qi.zpp_pool,Qi.zpp_pool=t,null==this.head&&(this.pushmod=!0),this.modified=!0,this.length--},wi.prototype.inlined_pop=function(){var t=this.head;this.head=t.next,t.elt=null,t.next=Qi.zpp_pool,Qi.zpp_pool=t,null==this.head&&(this.pushmod=!0),this.modified=!0,this.length--},wi.prototype.pop_unsafe=function(){var t=this.head.elt;return this.pop(),t},wi.prototype.inlined_pop_unsafe=function(){var t=this.head.elt;return this.pop(),t},wi.prototype.remove=function(t){for(var e,i,n=null,r=this.head;null!=r;){if(r.elt==t){null==n?(i=(e=this.head).next,this.head=i,null==this.head&&(this.pushmod=!0)):(i=(e=n.next).next,null==(n.next=i)&&(this.pushmod=!0));var o=e;o.elt=null,o.next=Qi.zpp_pool,Qi.zpp_pool=o,this.modified=!0,this.length--,this.pushmod=!0;break}r=(n=r).next}},wi.prototype.try_remove=function(t){for(var e=null,i=this.head,n=!1;null!=i;){if(i.elt==t){this.erase(e),n=!0;break}i=(e=i).next}return n},wi.prototype.inlined_remove=function(t){for(var e,i,n=null,r=this.head;null!=r;){if(r.elt==t){null==n?(i=(e=this.head).next,this.head=i,null==this.head&&(this.pushmod=!0)):(i=(e=n.next).next,null==(n.next=i)&&(this.pushmod=!0));var o=e;o.elt=null,o.next=Qi.zpp_pool,Qi.zpp_pool=o,this.modified=!0,this.length--,this.pushmod=!0;break}r=(n=r).next}},wi.prototype.inlined_try_remove=function(t){for(var e,i,n=null,r=this.head,o=!1;null!=r;){if(r.elt==t){null==n?(i=(e=this.head).next,this.head=i,null==this.head&&(this.pushmod=!0)):(i=(e=n.next).next,null==(n.next=i)&&(this.pushmod=!0));var s=e;s.elt=null,s.next=Qi.zpp_pool,Qi.zpp_pool=s,this.modified=!0,this.length--,o=this.pushmod=!0;break}r=(n=r).next}return o},wi.prototype.erase=function(t){var e;null==t?(e=(i=this.head).next,this.head=e,null==this.head&&(this.pushmod=!0)):(e=(i=t.next).next,null==(t.next=e)&&(this.pushmod=!0));var i=i;return i.elt=null,i.next=Qi.zpp_pool,Qi.zpp_pool=i,this.modified=!0,this.length--,this.pushmod=!0,e},wi.prototype.inlined_erase=function(t){var e;null==t?(e=(i=this.head).next,this.head=e,null==this.head&&(this.pushmod=!0)):(e=(i=t.next).next,null==(t.next=e)&&(this.pushmod=!0));var i=i;return i.elt=null,i.next=Qi.zpp_pool,Qi.zpp_pool=i,this.modified=!0,this.length--,this.pushmod=!0,e},wi.prototype.splice=function(t,e){for(;0<e--&&null!=t.next;)this.erase(t);return t.next},wi.prototype.clear=function(){for(;null!=this.head;){var t=this.head;this.head=t.next,t.elt=null,t.next=Qi.zpp_pool,Qi.zpp_pool=t,null==this.head&&(this.pushmod=!0),this.modified=!0,this.length--}this.pushmod=!0},wi.prototype.inlined_clear=function(){for(;null!=this.head;){var t=this.head;this.head=t.next,t.elt=null,t.next=Qi.zpp_pool,Qi.zpp_pool=t,null==this.head&&(this.pushmod=!0),this.modified=!0,this.length--}this.pushmod=!0},wi.prototype.reverse=function(){for(var t=this.head,e=null;null!=t;){var i=t.next;t.next=e,e=this.head=t,t=i}this.modified=!0,this.pushmod=!0},wi.prototype.empty=function(){return null==this.head},wi.prototype.size=function(){return this.length},wi.prototype.has=function(t){for(var e=!1,i=this.head;null!=i;){if(i.elt==t){e=!0;break}i=i.next}return e},wi.prototype.inlined_has=function(t){for(var e=!1,i=this.head;null!=i;){if(i.elt==t){e=!0;break}i=i.next}return e},wi.prototype.front=function(){return this.head.elt},wi.prototype.back=function(){for(var t=this.head,e=t;null!=e;)e=(t=e).next;return t.elt},wi.prototype.iterator_at=function(t){for(var e=this.head;0<t--&&null!=e;)e=e.next;return e},wi.prototype.at=function(t){t=this.iterator_at(t);return null!=t?t.elt:null},wi.prototype.__class__=wi;var zi=zpp_nape.util.ZNPList_ZPP_CutVert=function(){this.length=0,this.pushmod=!1,this.modified=!1,this.head=null};zi.__name__=["zpp_nape","util","ZNPList_ZPP_CutVert"],zi.prototype.head=null,zi.prototype.begin=function(){return this.head},zi.prototype.modified=null,zi.prototype.pushmod=null,zi.prototype.length=null,zi.prototype.setbegin=function(t){this.head=t,this.modified=!0,this.pushmod=!0},zi.prototype.add=function(t){null==$i.zpp_pool?e=new $i:(e=$i.zpp_pool,$i.zpp_pool=e.next,e.next=null),e.elt=t;var e=e;return e.next=this.head,this.head=e,this.modified=!0,this.length++,t},zi.prototype.inlined_add=function(t){null==$i.zpp_pool?e=new $i:(e=$i.zpp_pool,$i.zpp_pool=e.next,e.next=null),e.elt=t;var e=e;return e.next=this.head,this.head=e,this.modified=!0,this.length++,t},zi.prototype.addAll=function(t){for(var e=t.head;null!=e;)this.add(e.elt),e=e.next},zi.prototype.insert=function(t,e){null==$i.zpp_pool?i=new $i:(i=$i.zpp_pool,$i.zpp_pool=i.next,i.next=null),i.elt=e;var i=i;return null==t?(i.next=this.head,this.head=i):(i.next=t.next,t.next=i),this.pushmod=this.modified=!0,this.length++,i},zi.prototype.inlined_insert=function(t,e){null==$i.zpp_pool?i=new $i:(i=$i.zpp_pool,$i.zpp_pool=i.next,i.next=null),i.elt=e;var i=i;return null==t?(i.next=this.head,this.head=i):(i.next=t.next,t.next=i),this.pushmod=this.modified=!0,this.length++,i},zi.prototype.pop=function(){var t=this.head;this.head=t.next,t.elt=null,t.next=$i.zpp_pool,$i.zpp_pool=t,null==this.head&&(this.pushmod=!0),this.modified=!0,this.length--},zi.prototype.inlined_pop=function(){var t=this.head;this.head=t.next,t.elt=null,t.next=$i.zpp_pool,$i.zpp_pool=t,null==this.head&&(this.pushmod=!0),this.modified=!0,this.length--},zi.prototype.pop_unsafe=function(){var t=this.head.elt;return this.pop(),t},zi.prototype.inlined_pop_unsafe=function(){var t=this.head.elt;return this.pop(),t},zi.prototype.remove=function(t){for(var e,i,n=null,r=this.head;null!=r;){if(r.elt==t){null==n?(i=(e=this.head).next,this.head=i,null==this.head&&(this.pushmod=!0)):(i=(e=n.next).next,null==(n.next=i)&&(this.pushmod=!0));var o=e;o.elt=null,o.next=$i.zpp_pool,$i.zpp_pool=o,this.modified=!0,this.length--,this.pushmod=!0;break}r=(n=r).next}},zi.prototype.try_remove=function(t){for(var e=null,i=this.head,n=!1;null!=i;){if(i.elt==t){this.erase(e),n=!0;break}i=(e=i).next}return n},zi.prototype.inlined_remove=function(t){for(var e,i,n=null,r=this.head;null!=r;){if(r.elt==t){null==n?(i=(e=this.head).next,this.head=i,null==this.head&&(this.pushmod=!0)):(i=(e=n.next).next,null==(n.next=i)&&(this.pushmod=!0));var o=e;o.elt=null,o.next=$i.zpp_pool,$i.zpp_pool=o,this.modified=!0,this.length--,this.pushmod=!0;break}r=(n=r).next}},zi.prototype.inlined_try_remove=function(t){for(var e,i,n=null,r=this.head,o=!1;null!=r;){if(r.elt==t){null==n?(i=(e=this.head).next,this.head=i,null==this.head&&(this.pushmod=!0)):(i=(e=n.next).next,null==(n.next=i)&&(this.pushmod=!0));var s=e;s.elt=null,s.next=$i.zpp_pool,$i.zpp_pool=s,this.modified=!0,this.length--,o=this.pushmod=!0;break}r=(n=r).next}return o},zi.prototype.erase=function(t){var e;null==t?(e=(i=this.head).next,this.head=e,null==this.head&&(this.pushmod=!0)):(e=(i=t.next).next,null==(t.next=e)&&(this.pushmod=!0));var i=i;return i.elt=null,i.next=$i.zpp_pool,$i.zpp_pool=i,this.modified=!0,this.length--,this.pushmod=!0,e},zi.prototype.inlined_erase=function(t){var e;null==t?(e=(i=this.head).next,this.head=e,null==this.head&&(this.pushmod=!0)):(e=(i=t.next).next,null==(t.next=e)&&(this.pushmod=!0));var i=i;return i.elt=null,i.next=$i.zpp_pool,$i.zpp_pool=i,this.modified=!0,this.length--,this.pushmod=!0,e},zi.prototype.splice=function(t,e){for(;0<e--&&null!=t.next;)this.erase(t);return t.next},zi.prototype.clear=function(){for(;null!=this.head;){var t=this.head;this.head=t.next,t.elt=null,t.next=$i.zpp_pool,$i.zpp_pool=t,null==this.head&&(this.pushmod=!0),this.modified=!0,this.length--}this.pushmod=!0},zi.prototype.inlined_clear=function(){for(;null!=this.head;){var t=this.head;this.head=t.next,t.elt=null,t.next=$i.zpp_pool,$i.zpp_pool=t,null==this.head&&(this.pushmod=!0),this.modified=!0,this.length--}this.pushmod=!0},zi.prototype.reverse=function(){for(var t=this.head,e=null;null!=t;){var i=t.next;t.next=e,e=this.head=t,t=i}this.modified=!0,this.pushmod=!0},zi.prototype.empty=function(){return null==this.head},zi.prototype.size=function(){return this.length},zi.prototype.has=function(t){for(var e=!1,i=this.head;null!=i;){if(i.elt==t){e=!0;break}i=i.next}return e},zi.prototype.inlined_has=function(t){for(var e=!1,i=this.head;null!=i;){if(i.elt==t){e=!0;break}i=i.next}return e},zi.prototype.front=function(){return this.head.elt},zi.prototype.back=function(){for(var t=this.head,e=t;null!=e;)e=(t=e).next;return t.elt},zi.prototype.iterator_at=function(t){for(var e=this.head;0<t--&&null!=e;)e=e.next;return e},zi.prototype.at=function(t){t=this.iterator_at(t);return null!=t?t.elt:null},zi.prototype.__class__=zi;var bi=zpp_nape.util.ZNPList_ZPP_PartitionVertex=function(){this.length=0,this.pushmod=!1,this.modified=!1,this.head=null};bi.__name__=["zpp_nape","util","ZNPList_ZPP_PartitionVertex"],bi.prototype.head=null,bi.prototype.begin=function(){return this.head},bi.prototype.modified=null,bi.prototype.pushmod=null,bi.prototype.length=null,bi.prototype.setbegin=function(t){this.head=t,this.modified=!0,this.pushmod=!0},bi.prototype.add=function(t){null==tn.zpp_pool?e=new tn:(e=tn.zpp_pool,tn.zpp_pool=e.next,e.next=null),e.elt=t;var e=e;return e.next=this.head,this.head=e,this.modified=!0,this.length++,t},bi.prototype.inlined_add=function(t){null==tn.zpp_pool?e=new tn:(e=tn.zpp_pool,tn.zpp_pool=e.next,e.next=null),e.elt=t;var e=e;return e.next=this.head,this.head=e,this.modified=!0,this.length++,t},bi.prototype.addAll=function(t){for(var e=t.head;null!=e;)this.add(e.elt),e=e.next},bi.prototype.insert=function(t,e){null==tn.zpp_pool?i=new tn:(i=tn.zpp_pool,tn.zpp_pool=i.next,i.next=null),i.elt=e;var i=i;return null==t?(i.next=this.head,this.head=i):(i.next=t.next,t.next=i),this.pushmod=this.modified=!0,this.length++,i},bi.prototype.inlined_insert=function(t,e){null==tn.zpp_pool?i=new tn:(i=tn.zpp_pool,tn.zpp_pool=i.next,i.next=null),i.elt=e;var i=i;return null==t?(i.next=this.head,this.head=i):(i.next=t.next,t.next=i),this.pushmod=this.modified=!0,this.length++,i},bi.prototype.pop=function(){var t=this.head;this.head=t.next,t.elt=null,t.next=tn.zpp_pool,tn.zpp_pool=t,null==this.head&&(this.pushmod=!0),this.modified=!0,this.length--},bi.prototype.inlined_pop=function(){var t=this.head;this.head=t.next,t.elt=null,t.next=tn.zpp_pool,tn.zpp_pool=t,null==this.head&&(this.pushmod=!0),this.modified=!0,this.length--},bi.prototype.pop_unsafe=function(){var t=this.head.elt;return this.pop(),t},bi.prototype.inlined_pop_unsafe=function(){var t=this.head.elt;return this.pop(),t},bi.prototype.remove=function(t){for(var e,i,n=null,r=this.head;null!=r;){if(r.elt==t){null==n?(i=(e=this.head).next,this.head=i,null==this.head&&(this.pushmod=!0)):(i=(e=n.next).next,null==(n.next=i)&&(this.pushmod=!0));var o=e;o.elt=null,o.next=tn.zpp_pool,tn.zpp_pool=o,this.modified=!0,this.length--,this.pushmod=!0;break}r=(n=r).next}},bi.prototype.try_remove=function(t){for(var e=null,i=this.head,n=!1;null!=i;){if(i.elt==t){this.erase(e),n=!0;break}i=(e=i).next}return n},bi.prototype.inlined_remove=function(t){for(var e,i,n=null,r=this.head;null!=r;){if(r.elt==t){null==n?(i=(e=this.head).next,this.head=i,null==this.head&&(this.pushmod=!0)):(i=(e=n.next).next,null==(n.next=i)&&(this.pushmod=!0));var o=e;o.elt=null,o.next=tn.zpp_pool,tn.zpp_pool=o,this.modified=!0,this.length--,this.pushmod=!0;break}r=(n=r).next}},bi.prototype.inlined_try_remove=function(t){for(var e,i,n=null,r=this.head,o=!1;null!=r;){if(r.elt==t){null==n?(i=(e=this.head).next,this.head=i,null==this.head&&(this.pushmod=!0)):(i=(e=n.next).next,null==(n.next=i)&&(this.pushmod=!0));var s=e;s.elt=null,s.next=tn.zpp_pool,tn.zpp_pool=s,this.modified=!0,this.length--,o=this.pushmod=!0;break}r=(n=r).next}return o},bi.prototype.erase=function(t){var e;null==t?(e=(i=this.head).next,this.head=e,null==this.head&&(this.pushmod=!0)):(e=(i=t.next).next,null==(t.next=e)&&(this.pushmod=!0));var i=i;return i.elt=null,i.next=tn.zpp_pool,tn.zpp_pool=i,this.modified=!0,this.length--,this.pushmod=!0,e},bi.prototype.inlined_erase=function(t){var e;null==t?(e=(i=this.head).next,this.head=e,null==this.head&&(this.pushmod=!0)):(e=(i=t.next).next,null==(t.next=e)&&(this.pushmod=!0));var i=i;return i.elt=null,i.next=tn.zpp_pool,tn.zpp_pool=i,this.modified=!0,this.length--,this.pushmod=!0,e},bi.prototype.splice=function(t,e){for(;0<e--&&null!=t.next;)this.erase(t);return t.next},bi.prototype.clear=function(){for(;null!=this.head;){var t=this.head;this.head=t.next,t.elt=null,t.next=tn.zpp_pool,tn.zpp_pool=t,null==this.head&&(this.pushmod=!0),this.modified=!0,this.length--}this.pushmod=!0},bi.prototype.inlined_clear=function(){for(;null!=this.head;){var t=this.head;this.head=t.next,t.elt=null,t.next=tn.zpp_pool,tn.zpp_pool=t,null==this.head&&(this.pushmod=!0),this.modified=!0,this.length--}this.pushmod=!0},bi.prototype.reverse=function(){for(var t=this.head,e=null;null!=t;){var i=t.next;t.next=e,e=this.head=t,t=i}this.modified=!0,this.pushmod=!0},bi.prototype.empty=function(){return null==this.head},bi.prototype.size=function(){return this.length},bi.prototype.has=function(t){for(var e=!1,i=this.head;null!=i;){if(i.elt==t){e=!0;break}i=i.next}return e},bi.prototype.inlined_has=function(t){for(var e=!1,i=this.head;null!=i;){if(i.elt==t){e=!0;break}i=i.next}return e},bi.prototype.front=function(){return this.head.elt},bi.prototype.back=function(){for(var t=this.head,e=t;null!=e;)e=(t=e).next;return t.elt},bi.prototype.iterator_at=function(t){for(var e=this.head;0<t--&&null!=e;)e=e.next;return e},bi.prototype.at=function(t){t=this.iterator_at(t);return null!=t?t.elt:null},bi.prototype.__class__=bi;var Si=zpp_nape.util.ZNPList_ZPP_SimplifyP=function(){this.length=0,this.pushmod=!1,this.modified=!1,this.head=null};Si.__name__=["zpp_nape","util","ZNPList_ZPP_SimplifyP"],Si.prototype.head=null,Si.prototype.begin=function(){return this.head},Si.prototype.modified=null,Si.prototype.pushmod=null,Si.prototype.length=null,Si.prototype.setbegin=function(t){this.head=t,this.modified=!0,this.pushmod=!0},Si.prototype.add=function(t){null==en.zpp_pool?e=new en:(e=en.zpp_pool,en.zpp_pool=e.next,e.next=null),e.elt=t;var e=e;return e.next=this.head,this.head=e,this.modified=!0,this.length++,t},Si.prototype.inlined_add=function(t){null==en.zpp_pool?e=new en:(e=en.zpp_pool,en.zpp_pool=e.next,e.next=null),e.elt=t;var e=e;return e.next=this.head,this.head=e,this.modified=!0,this.length++,t},Si.prototype.addAll=function(t){for(var e=t.head;null!=e;)this.add(e.elt),e=e.next},Si.prototype.insert=function(t,e){null==en.zpp_pool?i=new en:(i=en.zpp_pool,en.zpp_pool=i.next,i.next=null),i.elt=e;var i=i;return null==t?(i.next=this.head,this.head=i):(i.next=t.next,t.next=i),this.pushmod=this.modified=!0,this.length++,i},Si.prototype.inlined_insert=function(t,e){null==en.zpp_pool?i=new en:(i=en.zpp_pool,en.zpp_pool=i.next,i.next=null),i.elt=e;var i=i;return null==t?(i.next=this.head,this.head=i):(i.next=t.next,t.next=i),this.pushmod=this.modified=!0,this.length++,i},Si.prototype.pop=function(){var t=this.head;this.head=t.next,t.elt=null,t.next=en.zpp_pool,en.zpp_pool=t,null==this.head&&(this.pushmod=!0),this.modified=!0,this.length--},Si.prototype.inlined_pop=function(){var t=this.head;this.head=t.next,t.elt=null,t.next=en.zpp_pool,en.zpp_pool=t,null==this.head&&(this.pushmod=!0),this.modified=!0,this.length--},Si.prototype.pop_unsafe=function(){var t=this.head.elt;return this.pop(),t},Si.prototype.inlined_pop_unsafe=function(){var t=this.head.elt;return this.pop(),t},Si.prototype.remove=function(t){for(var e,i,n=null,r=this.head;null!=r;){if(r.elt==t){null==n?(i=(e=this.head).next,this.head=i,null==this.head&&(this.pushmod=!0)):(i=(e=n.next).next,null==(n.next=i)&&(this.pushmod=!0));var o=e;o.elt=null,o.next=en.zpp_pool,en.zpp_pool=o,this.modified=!0,this.length--,this.pushmod=!0;break}r=(n=r).next}},Si.prototype.try_remove=function(t){for(var e=null,i=this.head,n=!1;null!=i;){if(i.elt==t){this.erase(e),n=!0;break}i=(e=i).next}return n},Si.prototype.inlined_remove=function(t){for(var e,i,n=null,r=this.head;null!=r;){if(r.elt==t){null==n?(i=(e=this.head).next,this.head=i,null==this.head&&(this.pushmod=!0)):(i=(e=n.next).next,null==(n.next=i)&&(this.pushmod=!0));var o=e;o.elt=null,o.next=en.zpp_pool,en.zpp_pool=o,this.modified=!0,this.length--,this.pushmod=!0;break}r=(n=r).next}},Si.prototype.inlined_try_remove=function(t){for(var e,i,n=null,r=this.head,o=!1;null!=r;){if(r.elt==t){null==n?(i=(e=this.head).next,this.head=i,null==this.head&&(this.pushmod=!0)):(i=(e=n.next).next,null==(n.next=i)&&(this.pushmod=!0));var s=e;s.elt=null,s.next=en.zpp_pool,en.zpp_pool=s,this.modified=!0,this.length--,o=this.pushmod=!0;break}r=(n=r).next}return o},Si.prototype.erase=function(t){var e;null==t?(e=(i=this.head).next,this.head=e,null==this.head&&(this.pushmod=!0)):(e=(i=t.next).next,null==(t.next=e)&&(this.pushmod=!0));var i=i;return i.elt=null,i.next=en.zpp_pool,en.zpp_pool=i,this.modified=!0,this.length--,this.pushmod=!0,e},Si.prototype.inlined_erase=function(t){var e;null==t?(e=(i=this.head).next,this.head=e,null==this.head&&(this.pushmod=!0)):(e=(i=t.next).next,null==(t.next=e)&&(this.pushmod=!0));var i=i;return i.elt=null,i.next=en.zpp_pool,en.zpp_pool=i,this.modified=!0,this.length--,this.pushmod=!0,e},Si.prototype.splice=function(t,e){for(;0<e--&&null!=t.next;)this.erase(t);return t.next},Si.prototype.clear=function(){for(;null!=this.head;){var t=this.head;this.head=t.next,t.elt=null,t.next=en.zpp_pool,en.zpp_pool=t,null==this.head&&(this.pushmod=!0),this.modified=!0,this.length--}this.pushmod=!0},Si.prototype.inlined_clear=function(){for(;null!=this.head;){var t=this.head;this.head=t.next,t.elt=null,t.next=en.zpp_pool,en.zpp_pool=t,null==this.head&&(this.pushmod=!0),this.modified=!0,this.length--}this.pushmod=!0},Si.prototype.reverse=function(){for(var t=this.head,e=null;null!=t;){var i=t.next;t.next=e,e=this.head=t,t=i}this.modified=!0,this.pushmod=!0},Si.prototype.empty=function(){return null==this.head},Si.prototype.size=function(){return this.length},Si.prototype.has=function(t){for(var e=!1,i=this.head;null!=i;){if(i.elt==t){e=!0;break}i=i.next}return e},Si.prototype.inlined_has=function(t){for(var e=!1,i=this.head;null!=i;){if(i.elt==t){e=!0;break}i=i.next}return e},Si.prototype.front=function(){return this.head.elt},Si.prototype.back=function(){for(var t=this.head,e=t;null!=e;)e=(t=e).next;return t.elt},Si.prototype.iterator_at=function(t){for(var e=this.head;0<t--&&null!=e;)e=e.next;return e},Si.prototype.at=function(t){t=this.iterator_at(t);return null!=t?t.elt:null},Si.prototype.__class__=Si;var Ci=zpp_nape.util.ZNPList_ZPP_PartitionedPoly=function(){this.length=0,this.pushmod=!1,this.modified=!1,this.head=null};Ci.__name__=["zpp_nape","util","ZNPList_ZPP_PartitionedPoly"],Ci.prototype.head=null,Ci.prototype.begin=function(){return this.head},Ci.prototype.modified=null,Ci.prototype.pushmod=null,Ci.prototype.length=null,Ci.prototype.setbegin=function(t){this.head=t,this.modified=!0,this.pushmod=!0},Ci.prototype.add=function(t){null==sn.zpp_pool?e=new sn:(e=sn.zpp_pool,sn.zpp_pool=e.next,e.next=null),e.elt=t;var e=e;return e.next=this.head,this.head=e,this.modified=!0,this.length++,t},Ci.prototype.inlined_add=function(t){null==sn.zpp_pool?e=new sn:(e=sn.zpp_pool,sn.zpp_pool=e.next,e.next=null),e.elt=t;var e=e;return e.next=this.head,this.head=e,this.modified=!0,this.length++,t},Ci.prototype.addAll=function(t){for(var e=t.head;null!=e;)this.add(e.elt),e=e.next},Ci.prototype.insert=function(t,e){null==sn.zpp_pool?i=new sn:(i=sn.zpp_pool,sn.zpp_pool=i.next,i.next=null),i.elt=e;var i=i;return null==t?(i.next=this.head,this.head=i):(i.next=t.next,t.next=i),this.pushmod=this.modified=!0,this.length++,i},Ci.prototype.inlined_insert=function(t,e){null==sn.zpp_pool?i=new sn:(i=sn.zpp_pool,sn.zpp_pool=i.next,i.next=null),i.elt=e;var i=i;return null==t?(i.next=this.head,this.head=i):(i.next=t.next,t.next=i),this.pushmod=this.modified=!0,this.length++,i},Ci.prototype.pop=function(){var t=this.head;this.head=t.next,t.elt=null,t.next=sn.zpp_pool,sn.zpp_pool=t,null==this.head&&(this.pushmod=!0),this.modified=!0,this.length--},Ci.prototype.inlined_pop=function(){var t=this.head;this.head=t.next,t.elt=null,t.next=sn.zpp_pool,sn.zpp_pool=t,null==this.head&&(this.pushmod=!0),this.modified=!0,this.length--},Ci.prototype.pop_unsafe=function(){var t=this.head.elt;return this.pop(),t},Ci.prototype.inlined_pop_unsafe=function(){var t=this.head.elt;return this.pop(),t},Ci.prototype.remove=function(t){for(var e,i,n=null,r=this.head;null!=r;){if(r.elt==t){null==n?(i=(e=this.head).next,this.head=i,null==this.head&&(this.pushmod=!0)):(i=(e=n.next).next,null==(n.next=i)&&(this.pushmod=!0));var o=e;o.elt=null,o.next=sn.zpp_pool,sn.zpp_pool=o,this.modified=!0,this.length--,this.pushmod=!0;break}r=(n=r).next}},Ci.prototype.try_remove=function(t){for(var e=null,i=this.head,n=!1;null!=i;){if(i.elt==t){this.erase(e),n=!0;break}i=(e=i).next}return n},Ci.prototype.inlined_remove=function(t){for(var e,i,n=null,r=this.head;null!=r;){if(r.elt==t){null==n?(i=(e=this.head).next,this.head=i,null==this.head&&(this.pushmod=!0)):(i=(e=n.next).next,null==(n.next=i)&&(this.pushmod=!0));var o=e;o.elt=null,o.next=sn.zpp_pool,sn.zpp_pool=o,this.modified=!0,this.length--,this.pushmod=!0;break}r=(n=r).next}},Ci.prototype.inlined_try_remove=function(t){for(var e,i,n=null,r=this.head,o=!1;null!=r;){if(r.elt==t){null==n?(i=(e=this.head).next,this.head=i,null==this.head&&(this.pushmod=!0)):(i=(e=n.next).next,null==(n.next=i)&&(this.pushmod=!0));var s=e;s.elt=null,s.next=sn.zpp_pool,sn.zpp_pool=s,this.modified=!0,this.length--,o=this.pushmod=!0;break}r=(n=r).next}return o},Ci.prototype.erase=function(t){var e;null==t?(e=(i=this.head).next,this.head=e,null==this.head&&(this.pushmod=!0)):(e=(i=t.next).next,null==(t.next=e)&&(this.pushmod=!0));var i=i;return i.elt=null,i.next=sn.zpp_pool,sn.zpp_pool=i,this.modified=!0,this.length--,this.pushmod=!0,e},Ci.prototype.inlined_erase=function(t){var e;null==t?(e=(i=this.head).next,this.head=e,null==this.head&&(this.pushmod=!0)):(e=(i=t.next).next,null==(t.next=e)&&(this.pushmod=!0));var i=i;return i.elt=null,i.next=sn.zpp_pool,sn.zpp_pool=i,this.modified=!0,this.length--,this.pushmod=!0,e},Ci.prototype.splice=function(t,e){for(;0<e--&&null!=t.next;)this.erase(t);return t.next},Ci.prototype.clear=function(){for(;null!=this.head;){var t=this.head;this.head=t.next,t.elt=null,t.next=sn.zpp_pool,sn.zpp_pool=t,null==this.head&&(this.pushmod=!0),this.modified=!0,this.length--}this.pushmod=!0},Ci.prototype.inlined_clear=function(){for(;null!=this.head;){var t=this.head;this.head=t.next,t.elt=null,t.next=sn.zpp_pool,sn.zpp_pool=t,null==this.head&&(this.pushmod=!0),this.modified=!0,this.length--}this.pushmod=!0},Ci.prototype.reverse=function(){for(var t=this.head,e=null;null!=t;){var i=t.next;t.next=e,e=this.head=t,t=i}this.modified=!0,this.pushmod=!0},Ci.prototype.empty=function(){return null==this.head},Ci.prototype.size=function(){return this.length},Ci.prototype.has=function(t){for(var e=!1,i=this.head;null!=i;){if(i.elt==t){e=!0;break}i=i.next}return e},Ci.prototype.inlined_has=function(t){for(var e=!1,i=this.head;null!=i;){if(i.elt==t){e=!0;break}i=i.next}return e},Ci.prototype.front=function(){return this.head.elt},Ci.prototype.back=function(){for(var t=this.head,e=t;null!=e;)e=(t=e).next;return t.elt},Ci.prototype.iterator_at=function(t){for(var e=this.head;0<t--&&null!=e;)e=e.next;return e},Ci.prototype.at=function(t){t=this.iterator_at(t);return null!=t?t.elt:null},Ci.prototype.__class__=Ci;var Pi=zpp_nape.util.ZNPList_ZPP_GeomVert=function(){this.length=0,this.pushmod=!1,this.modified=!1,this.head=null};Pi.__name__=["zpp_nape","util","ZNPList_ZPP_GeomVert"],Pi.prototype.head=null,Pi.prototype.begin=function(){return this.head},Pi.prototype.modified=null,Pi.prototype.pushmod=null,Pi.prototype.length=null,Pi.prototype.setbegin=function(t){this.head=t,this.modified=!0,this.pushmod=!0},Pi.prototype.add=function(t){null==an.zpp_pool?e=new an:(e=an.zpp_pool,an.zpp_pool=e.next,e.next=null),e.elt=t;var e=e;return e.next=this.head,this.head=e,this.modified=!0,this.length++,t},Pi.prototype.inlined_add=function(t){null==an.zpp_pool?e=new an:(e=an.zpp_pool,an.zpp_pool=e.next,e.next=null),e.elt=t;var e=e;return e.next=this.head,this.head=e,this.modified=!0,this.length++,t},Pi.prototype.addAll=function(t){for(var e=t.head;null!=e;)this.add(e.elt),e=e.next},Pi.prototype.insert=function(t,e){null==an.zpp_pool?i=new an:(i=an.zpp_pool,an.zpp_pool=i.next,i.next=null),i.elt=e;var i=i;return null==t?(i.next=this.head,this.head=i):(i.next=t.next,t.next=i),this.pushmod=this.modified=!0,this.length++,i},Pi.prototype.inlined_insert=function(t,e){null==an.zpp_pool?i=new an:(i=an.zpp_pool,an.zpp_pool=i.next,i.next=null),i.elt=e;var i=i;return null==t?(i.next=this.head,this.head=i):(i.next=t.next,t.next=i),this.pushmod=this.modified=!0,this.length++,i},Pi.prototype.pop=function(){var t=this.head;this.head=t.next,t.elt=null,t.next=an.zpp_pool,an.zpp_pool=t,null==this.head&&(this.pushmod=!0),this.modified=!0,this.length--},Pi.prototype.inlined_pop=function(){var t=this.head;this.head=t.next,t.elt=null,t.next=an.zpp_pool,an.zpp_pool=t,null==this.head&&(this.pushmod=!0),this.modified=!0,this.length--},Pi.prototype.pop_unsafe=function(){var t=this.head.elt;return this.pop(),t},Pi.prototype.inlined_pop_unsafe=function(){var t=this.head.elt;return this.pop(),t},Pi.prototype.remove=function(t){for(var e,i,n=null,r=this.head;null!=r;){if(r.elt==t){null==n?(i=(e=this.head).next,this.head=i,null==this.head&&(this.pushmod=!0)):(i=(e=n.next).next,null==(n.next=i)&&(this.pushmod=!0));var o=e;o.elt=null,o.next=an.zpp_pool,an.zpp_pool=o,this.modified=!0,this.length--,this.pushmod=!0;break}r=(n=r).next}},Pi.prototype.try_remove=function(t){for(var e=null,i=this.head,n=!1;null!=i;){if(i.elt==t){this.erase(e),n=!0;break}i=(e=i).next}return n},Pi.prototype.inlined_remove=function(t){for(var e,i,n=null,r=this.head;null!=r;){if(r.elt==t){null==n?(i=(e=this.head).next,this.head=i,null==this.head&&(this.pushmod=!0)):(i=(e=n.next).next,null==(n.next=i)&&(this.pushmod=!0));var o=e;o.elt=null,o.next=an.zpp_pool,an.zpp_pool=o,this.modified=!0,this.length--,this.pushmod=!0;break}r=(n=r).next}},Pi.prototype.inlined_try_remove=function(t){for(var e,i,n=null,r=this.head,o=!1;null!=r;){if(r.elt==t){null==n?(i=(e=this.head).next,this.head=i,null==this.head&&(this.pushmod=!0)):(i=(e=n.next).next,null==(n.next=i)&&(this.pushmod=!0));var s=e;s.elt=null,s.next=an.zpp_pool,an.zpp_pool=s,this.modified=!0,this.length--,o=this.pushmod=!0;break}r=(n=r).next}return o},Pi.prototype.erase=function(t){var e;null==t?(e=(i=this.head).next,this.head=e,null==this.head&&(this.pushmod=!0)):(e=(i=t.next).next,null==(t.next=e)&&(this.pushmod=!0));var i=i;return i.elt=null,i.next=an.zpp_pool,an.zpp_pool=i,this.modified=!0,this.length--,this.pushmod=!0,e},Pi.prototype.inlined_erase=function(t){var e;null==t?(e=(i=this.head).next,this.head=e,null==this.head&&(this.pushmod=!0)):(e=(i=t.next).next,null==(t.next=e)&&(this.pushmod=!0));var i=i;return i.elt=null,i.next=an.zpp_pool,an.zpp_pool=i,this.modified=!0,this.length--,this.pushmod=!0,e},Pi.prototype.splice=function(t,e){for(;0<e--&&null!=t.next;)this.erase(t);return t.next},Pi.prototype.clear=function(){for(;null!=this.head;){var t=this.head;this.head=t.next,t.elt=null,t.next=an.zpp_pool,an.zpp_pool=t,null==this.head&&(this.pushmod=!0),this.modified=!0,this.length--}this.pushmod=!0},Pi.prototype.inlined_clear=function(){for(;null!=this.head;){var t=this.head;this.head=t.next,t.elt=null,t.next=an.zpp_pool,an.zpp_pool=t,null==this.head&&(this.pushmod=!0),this.modified=!0,this.length--}this.pushmod=!0},Pi.prototype.reverse=function(){for(var t=this.head,e=null;null!=t;){var i=t.next;t.next=e,e=this.head=t,t=i}this.modified=!0,this.pushmod=!0},Pi.prototype.empty=function(){return null==this.head},Pi.prototype.size=function(){return this.length},Pi.prototype.has=function(t){for(var e=!1,i=this.head;null!=i;){if(i.elt==t){e=!0;break}i=i.next}return e},Pi.prototype.inlined_has=function(t){for(var e=!1,i=this.head;null!=i;){if(i.elt==t){e=!0;break}i=i.next}return e},Pi.prototype.front=function(){return this.head.elt},Pi.prototype.back=function(){for(var t=this.head,e=t;null!=e;)e=(t=e).next;return t.elt},Pi.prototype.iterator_at=function(t){for(var e=this.head;0<t--&&null!=e;)e=e.next;return e},Pi.prototype.at=function(t){t=this.iterator_at(t);return null!=t?t.elt:null},Pi.prototype.__class__=Pi;var Mi=zpp_nape.util.ZNPList_ZPP_SimpleVert=function(){this.length=0,this.pushmod=!1,this.modified=!1,this.head=null};Mi.__name__=["zpp_nape","util","ZNPList_ZPP_SimpleVert"],Mi.prototype.head=null,Mi.prototype.begin=function(){return this.head},Mi.prototype.modified=null,Mi.prototype.pushmod=null,Mi.prototype.length=null,Mi.prototype.setbegin=function(t){this.head=t,this.modified=!0,this.pushmod=!0},Mi.prototype.add=function(t){null==hn.zpp_pool?e=new hn:(e=hn.zpp_pool,hn.zpp_pool=e.next,e.next=null),e.elt=t;var e=e;return e.next=this.head,this.head=e,this.modified=!0,this.length++,t},Mi.prototype.inlined_add=function(t){null==hn.zpp_pool?e=new hn:(e=hn.zpp_pool,hn.zpp_pool=e.next,e.next=null),e.elt=t;var e=e;return e.next=this.head,this.head=e,this.modified=!0,this.length++,t},Mi.prototype.addAll=function(t){for(var e=t.head;null!=e;)this.add(e.elt),e=e.next},Mi.prototype.insert=function(t,e){null==hn.zpp_pool?i=new hn:(i=hn.zpp_pool,hn.zpp_pool=i.next,i.next=null),i.elt=e;var i=i;return null==t?(i.next=this.head,this.head=i):(i.next=t.next,t.next=i),this.pushmod=this.modified=!0,this.length++,i},Mi.prototype.inlined_insert=function(t,e){null==hn.zpp_pool?i=new hn:(i=hn.zpp_pool,hn.zpp_pool=i.next,i.next=null),i.elt=e;var i=i;return null==t?(i.next=this.head,this.head=i):(i.next=t.next,t.next=i),this.pushmod=this.modified=!0,this.length++,i},Mi.prototype.pop=function(){var t=this.head;this.head=t.next,t.elt=null,t.next=hn.zpp_pool,hn.zpp_pool=t,null==this.head&&(this.pushmod=!0),this.modified=!0,this.length--},Mi.prototype.inlined_pop=function(){var t=this.head;this.head=t.next,t.elt=null,t.next=hn.zpp_pool,hn.zpp_pool=t,null==this.head&&(this.pushmod=!0),this.modified=!0,this.length--},Mi.prototype.pop_unsafe=function(){var t=this.head.elt;return this.pop(),t},Mi.prototype.inlined_pop_unsafe=function(){var t=this.head.elt;return this.pop(),t},Mi.prototype.remove=function(t){for(var e,i,n=null,r=this.head;null!=r;){if(r.elt==t){null==n?(i=(e=this.head).next,this.head=i,null==this.head&&(this.pushmod=!0)):(i=(e=n.next).next,null==(n.next=i)&&(this.pushmod=!0));var o=e;o.elt=null,o.next=hn.zpp_pool,hn.zpp_pool=o,this.modified=!0,this.length--,this.pushmod=!0;break}r=(n=r).next}},Mi.prototype.try_remove=function(t){for(var e=null,i=this.head,n=!1;null!=i;){if(i.elt==t){this.erase(e),n=!0;break}i=(e=i).next}return n},Mi.prototype.inlined_remove=function(t){for(var e,i,n=null,r=this.head;null!=r;){if(r.elt==t){null==n?(i=(e=this.head).next,this.head=i,null==this.head&&(this.pushmod=!0)):(i=(e=n.next).next,null==(n.next=i)&&(this.pushmod=!0));var o=e;o.elt=null,o.next=hn.zpp_pool,hn.zpp_pool=o,this.modified=!0,this.length--,this.pushmod=!0;break}r=(n=r).next}},Mi.prototype.inlined_try_remove=function(t){for(var e,i,n=null,r=this.head,o=!1;null!=r;){if(r.elt==t){null==n?(i=(e=this.head).next,this.head=i,null==this.head&&(this.pushmod=!0)):(i=(e=n.next).next,null==(n.next=i)&&(this.pushmod=!0));var s=e;s.elt=null,s.next=hn.zpp_pool,hn.zpp_pool=s,this.modified=!0,this.length--,o=this.pushmod=!0;break}r=(n=r).next}return o},Mi.prototype.erase=function(t){var e;null==t?(e=(i=this.head).next,this.head=e,null==this.head&&(this.pushmod=!0)):(e=(i=t.next).next,null==(t.next=e)&&(this.pushmod=!0));var i=i;return i.elt=null,i.next=hn.zpp_pool,hn.zpp_pool=i,this.modified=!0,this.length--,this.pushmod=!0,e},Mi.prototype.inlined_erase=function(t){var e;null==t?(e=(i=this.head).next,this.head=e,null==this.head&&(this.pushmod=!0)):(e=(i=t.next).next,null==(t.next=e)&&(this.pushmod=!0));var i=i;return i.elt=null,i.next=hn.zpp_pool,hn.zpp_pool=i,this.modified=!0,this.length--,this.pushmod=!0,e},Mi.prototype.splice=function(t,e){for(;0<e--&&null!=t.next;)this.erase(t);return t.next},Mi.prototype.clear=function(){for(;null!=this.head;){var t=this.head;this.head=t.next,t.elt=null,t.next=hn.zpp_pool,hn.zpp_pool=t,null==this.head&&(this.pushmod=!0),this.modified=!0,this.length--}this.pushmod=!0},Mi.prototype.inlined_clear=function(){for(;null!=this.head;){var t=this.head;this.head=t.next,t.elt=null,t.next=hn.zpp_pool,hn.zpp_pool=t,null==this.head&&(this.pushmod=!0),this.modified=!0,this.length--}this.pushmod=!0},Mi.prototype.reverse=function(){for(var t=this.head,e=null;null!=t;){var i=t.next;t.next=e,e=this.head=t,t=i}this.modified=!0,this.pushmod=!0},Mi.prototype.empty=function(){return null==this.head},Mi.prototype.size=function(){return this.length},Mi.prototype.has=function(t){for(var e=!1,i=this.head;null!=i;){if(i.elt==t){e=!0;break}i=i.next}return e},Mi.prototype.inlined_has=function(t){for(var e=!1,i=this.head;null!=i;){if(i.elt==t){e=!0;break}i=i.next}return e},Mi.prototype.front=function(){return this.head.elt},Mi.prototype.back=function(){for(var t=this.head,e=t;null!=e;)e=(t=e).next;return t.elt},Mi.prototype.iterator_at=function(t){for(var e=this.head;0<t--&&null!=e;)e=e.next;return e},Mi.prototype.at=function(t){t=this.iterator_at(t);return null!=t?t.elt:null},Mi.prototype.__class__=Mi;var Ti=zpp_nape.util.ZNPList_ZPP_SimpleEvent=function(){this.length=0,this.pushmod=!1,this.modified=!1,this.head=null};Ti.__name__=["zpp_nape","util","ZNPList_ZPP_SimpleEvent"],Ti.prototype.head=null,Ti.prototype.begin=function(){return this.head},Ti.prototype.modified=null,Ti.prototype.pushmod=null,Ti.prototype.length=null,Ti.prototype.setbegin=function(t){this.head=t,this.modified=!0,this.pushmod=!0},Ti.prototype.add=function(t){null==ln.zpp_pool?e=new ln:(e=ln.zpp_pool,ln.zpp_pool=e.next,e.next=null),e.elt=t;var e=e;return e.next=this.head,this.head=e,this.modified=!0,this.length++,t},Ti.prototype.inlined_add=function(t){null==ln.zpp_pool?e=new ln:(e=ln.zpp_pool,ln.zpp_pool=e.next,e.next=null),e.elt=t;var e=e;return e.next=this.head,this.head=e,this.modified=!0,this.length++,t},Ti.prototype.addAll=function(t){for(var e=t.head;null!=e;)this.add(e.elt),e=e.next},Ti.prototype.insert=function(t,e){null==ln.zpp_pool?i=new ln:(i=ln.zpp_pool,ln.zpp_pool=i.next,i.next=null),i.elt=e;var i=i;return null==t?(i.next=this.head,this.head=i):(i.next=t.next,t.next=i),this.pushmod=this.modified=!0,this.length++,i},Ti.prototype.inlined_insert=function(t,e){null==ln.zpp_pool?i=new ln:(i=ln.zpp_pool,ln.zpp_pool=i.next,i.next=null),i.elt=e;var i=i;return null==t?(i.next=this.head,this.head=i):(i.next=t.next,t.next=i),this.pushmod=this.modified=!0,this.length++,i},Ti.prototype.pop=function(){var t=this.head;this.head=t.next,t.elt=null,t.next=ln.zpp_pool,ln.zpp_pool=t,null==this.head&&(this.pushmod=!0),this.modified=!0,this.length--},Ti.prototype.inlined_pop=function(){var t=this.head;this.head=t.next,t.elt=null,t.next=ln.zpp_pool,ln.zpp_pool=t,null==this.head&&(this.pushmod=!0),this.modified=!0,this.length--},Ti.prototype.pop_unsafe=function(){var t=this.head.elt;return this.pop(),t},Ti.prototype.inlined_pop_unsafe=function(){var t=this.head.elt;return this.pop(),t},Ti.prototype.remove=function(t){for(var e,i,n=null,r=this.head;null!=r;){if(r.elt==t){null==n?(i=(e=this.head).next,this.head=i,null==this.head&&(this.pushmod=!0)):(i=(e=n.next).next,null==(n.next=i)&&(this.pushmod=!0));var o=e;o.elt=null,o.next=ln.zpp_pool,ln.zpp_pool=o,this.modified=!0,this.length--,this.pushmod=!0;break}r=(n=r).next}},Ti.prototype.try_remove=function(t){for(var e=null,i=this.head,n=!1;null!=i;){if(i.elt==t){this.erase(e),n=!0;break}i=(e=i).next}return n},Ti.prototype.inlined_remove=function(t){for(var e,i,n=null,r=this.head;null!=r;){if(r.elt==t){null==n?(i=(e=this.head).next,this.head=i,null==this.head&&(this.pushmod=!0)):(i=(e=n.next).next,null==(n.next=i)&&(this.pushmod=!0));var o=e;o.elt=null,o.next=ln.zpp_pool,ln.zpp_pool=o,this.modified=!0,this.length--,this.pushmod=!0;break}r=(n=r).next}},Ti.prototype.inlined_try_remove=function(t){for(var e,i,n=null,r=this.head,o=!1;null!=r;){if(r.elt==t){null==n?(i=(e=this.head).next,this.head=i,null==this.head&&(this.pushmod=!0)):(i=(e=n.next).next,null==(n.next=i)&&(this.pushmod=!0));var s=e;s.elt=null,s.next=ln.zpp_pool,ln.zpp_pool=s,this.modified=!0,this.length--,o=this.pushmod=!0;break}r=(n=r).next}return o},Ti.prototype.erase=function(t){var e;null==t?(e=(i=this.head).next,this.head=e,null==this.head&&(this.pushmod=!0)):(e=(i=t.next).next,null==(t.next=e)&&(this.pushmod=!0));var i=i;return i.elt=null,i.next=ln.zpp_pool,ln.zpp_pool=i,this.modified=!0,this.length--,this.pushmod=!0,e},Ti.prototype.inlined_erase=function(t){var e;null==t?(e=(i=this.head).next,this.head=e,null==this.head&&(this.pushmod=!0)):(e=(i=t.next).next,null==(t.next=e)&&(this.pushmod=!0));var i=i;return i.elt=null,i.next=ln.zpp_pool,ln.zpp_pool=i,this.modified=!0,this.length--,this.pushmod=!0,e},Ti.prototype.splice=function(t,e){for(;0<e--&&null!=t.next;)this.erase(t);return t.next},Ti.prototype.clear=function(){for(;null!=this.head;){var t=this.head;this.head=t.next,t.elt=null,t.next=ln.zpp_pool,ln.zpp_pool=t,null==this.head&&(this.pushmod=!0),this.modified=!0,this.length--}this.pushmod=!0},Ti.prototype.inlined_clear=function(){for(;null!=this.head;){var t=this.head;this.head=t.next,t.elt=null,t.next=ln.zpp_pool,ln.zpp_pool=t,null==this.head&&(this.pushmod=!0),this.modified=!0,this.length--}this.pushmod=!0},Ti.prototype.reverse=function(){for(var t=this.head,e=null;null!=t;){var i=t.next;t.next=e,e=this.head=t,t=i}this.modified=!0,this.pushmod=!0},Ti.prototype.empty=function(){return null==this.head},Ti.prototype.size=function(){return this.length},Ti.prototype.has=function(t){for(var e=!1,i=this.head;null!=i;){if(i.elt==t){e=!0;break}i=i.next}return e},Ti.prototype.inlined_has=function(t){for(var e=!1,i=this.head;null!=i;){if(i.elt==t){e=!0;break}i=i.next}return e},Ti.prototype.front=function(){return this.head.elt},Ti.prototype.back=function(){for(var t=this.head,e=t;null!=e;)e=(t=e).next;return t.elt},Ti.prototype.iterator_at=function(t){for(var e=this.head;0<t--&&null!=e;)e=e.next;return e},Ti.prototype.at=function(t){t=this.iterator_at(t);return null!=t?t.elt:null},Ti.prototype.__class__=Ti;var Ai=zpp_nape.util.ZNPList_ZPP_AABBPair=function(){this.length=0,this.pushmod=!1,this.modified=!1,this.head=null};Ai.__name__=["zpp_nape","util","ZNPList_ZPP_AABBPair"],Ai.prototype.head=null,Ai.prototype.begin=function(){return this.head},Ai.prototype.modified=null,Ai.prototype.pushmod=null,Ai.prototype.length=null,Ai.prototype.setbegin=function(t){this.head=t,this.modified=!0,this.pushmod=!0},Ai.prototype.add=function(t){null==un.zpp_pool?e=new un:(e=un.zpp_pool,un.zpp_pool=e.next,e.next=null),e.elt=t;var e=e;return e.next=this.head,this.head=e,this.modified=!0,this.length++,t},Ai.prototype.inlined_add=function(t){null==un.zpp_pool?e=new un:(e=un.zpp_pool,un.zpp_pool=e.next,e.next=null),e.elt=t;var e=e;return e.next=this.head,this.head=e,this.modified=!0,this.length++,t},Ai.prototype.addAll=function(t){for(var e=t.head;null!=e;)this.add(e.elt),e=e.next},Ai.prototype.insert=function(t,e){null==un.zpp_pool?i=new un:(i=un.zpp_pool,un.zpp_pool=i.next,i.next=null),i.elt=e;var i=i;return null==t?(i.next=this.head,this.head=i):(i.next=t.next,t.next=i),this.pushmod=this.modified=!0,this.length++,i},Ai.prototype.inlined_insert=function(t,e){null==un.zpp_pool?i=new un:(i=un.zpp_pool,un.zpp_pool=i.next,i.next=null),i.elt=e;var i=i;return null==t?(i.next=this.head,this.head=i):(i.next=t.next,t.next=i),this.pushmod=this.modified=!0,this.length++,i},Ai.prototype.pop=function(){var t=this.head;this.head=t.next,t.elt=null,t.next=un.zpp_pool,un.zpp_pool=t,null==this.head&&(this.pushmod=!0),this.modified=!0,this.length--},Ai.prototype.inlined_pop=function(){var t=this.head;this.head=t.next,t.elt=null,t.next=un.zpp_pool,un.zpp_pool=t,null==this.head&&(this.pushmod=!0),this.modified=!0,this.length--},Ai.prototype.pop_unsafe=function(){var t=this.head.elt;return this.pop(),t},Ai.prototype.inlined_pop_unsafe=function(){var t=this.head.elt;return this.pop(),t},Ai.prototype.remove=function(t){for(var e,i,n=null,r=this.head;null!=r;){if(r.elt==t){null==n?(i=(e=this.head).next,this.head=i,null==this.head&&(this.pushmod=!0)):(i=(e=n.next).next,null==(n.next=i)&&(this.pushmod=!0));var o=e;o.elt=null,o.next=un.zpp_pool,un.zpp_pool=o,this.modified=!0,this.length--,this.pushmod=!0;break}r=(n=r).next}},Ai.prototype.try_remove=function(t){for(var e=null,i=this.head,n=!1;null!=i;){if(i.elt==t){this.erase(e),n=!0;break}i=(e=i).next}return n},Ai.prototype.inlined_remove=function(t){for(var e,i,n=null,r=this.head;null!=r;){if(r.elt==t){null==n?(i=(e=this.head).next,this.head=i,null==this.head&&(this.pushmod=!0)):(i=(e=n.next).next,null==(n.next=i)&&(this.pushmod=!0));var o=e;o.elt=null,o.next=un.zpp_pool,un.zpp_pool=o,this.modified=!0,this.length--,this.pushmod=!0;break}r=(n=r).next}},Ai.prototype.inlined_try_remove=function(t){for(var e,i,n=null,r=this.head,o=!1;null!=r;){if(r.elt==t){null==n?(i=(e=this.head).next,this.head=i,null==this.head&&(this.pushmod=!0)):(i=(e=n.next).next,null==(n.next=i)&&(this.pushmod=!0));var s=e;s.elt=null,s.next=un.zpp_pool,un.zpp_pool=s,this.modified=!0,this.length--,o=this.pushmod=!0;break}r=(n=r).next}return o},Ai.prototype.erase=function(t){var e;null==t?(e=(i=this.head).next,this.head=e,null==this.head&&(this.pushmod=!0)):(e=(i=t.next).next,null==(t.next=e)&&(this.pushmod=!0));var i=i;return i.elt=null,i.next=un.zpp_pool,un.zpp_pool=i,this.modified=!0,this.length--,this.pushmod=!0,e},Ai.prototype.inlined_erase=function(t){var e;null==t?(e=(i=this.head).next,this.head=e,null==this.head&&(this.pushmod=!0)):(e=(i=t.next).next,null==(t.next=e)&&(this.pushmod=!0));var i=i;return i.elt=null,i.next=un.zpp_pool,un.zpp_pool=i,this.modified=!0,this.length--,this.pushmod=!0,e},Ai.prototype.splice=function(t,e){for(;0<e--&&null!=t.next;)this.erase(t);return t.next},Ai.prototype.clear=function(){for(;null!=this.head;){var t=this.head;this.head=t.next,t.elt=null,t.next=un.zpp_pool,un.zpp_pool=t,null==this.head&&(this.pushmod=!0),this.modified=!0,this.length--}this.pushmod=!0},Ai.prototype.inlined_clear=function(){for(;null!=this.head;){var t=this.head;this.head=t.next,t.elt=null,t.next=un.zpp_pool,un.zpp_pool=t,null==this.head&&(this.pushmod=!0),this.modified=!0,this.length--}this.pushmod=!0},Ai.prototype.reverse=function(){for(var t=this.head,e=null;null!=t;){var i=t.next;t.next=e,e=this.head=t,t=i}this.modified=!0,this.pushmod=!0},Ai.prototype.empty=function(){return null==this.head},Ai.prototype.size=function(){return this.length},Ai.prototype.has=function(t){for(var e=!1,i=this.head;null!=i;){if(i.elt==t){e=!0;break}i=i.next}return e},Ai.prototype.inlined_has=function(t){for(var e=!1,i=this.head;null!=i;){if(i.elt==t){e=!0;break}i=i.next}return e},Ai.prototype.front=function(){return this.head.elt},Ai.prototype.back=function(){for(var t=this.head,e=t;null!=e;)e=(t=e).next;return t.elt},Ai.prototype.iterator_at=function(t){for(var e=this.head;0<t--&&null!=e;)e=e.next;return e},Ai.prototype.at=function(t){t=this.iterator_at(t);return null!=t?t.elt:null},Ai.prototype.__class__=Ai;var ki=zpp_nape.util.ZNPList_ZPP_Edge=function(){this.length=0,this.pushmod=!1,this.modified=!1,this.head=null};ki.__name__=["zpp_nape","util","ZNPList_ZPP_Edge"],ki.prototype.head=null,ki.prototype.begin=function(){return this.head},ki.prototype.modified=null,ki.prototype.pushmod=null,ki.prototype.length=null,ki.prototype.setbegin=function(t){this.head=t,this.modified=!0,this.pushmod=!0},ki.prototype.add=function(t){null==dn.zpp_pool?e=new dn:(e=dn.zpp_pool,dn.zpp_pool=e.next,e.next=null),e.elt=t;var e=e;return e.next=this.head,this.head=e,this.modified=!0,this.length++,t},ki.prototype.inlined_add=function(t){null==dn.zpp_pool?e=new dn:(e=dn.zpp_pool,dn.zpp_pool=e.next,e.next=null),e.elt=t;var e=e;return e.next=this.head,this.head=e,this.modified=!0,this.length++,t},ki.prototype.addAll=function(t){for(var e=t.head;null!=e;)this.add(e.elt),e=e.next},ki.prototype.insert=function(t,e){null==dn.zpp_pool?i=new dn:(i=dn.zpp_pool,dn.zpp_pool=i.next,i.next=null),i.elt=e;var i=i;return null==t?(i.next=this.head,this.head=i):(i.next=t.next,t.next=i),this.pushmod=this.modified=!0,this.length++,i},ki.prototype.inlined_insert=function(t,e){null==dn.zpp_pool?i=new dn:(i=dn.zpp_pool,dn.zpp_pool=i.next,i.next=null),i.elt=e;var i=i;return null==t?(i.next=this.head,this.head=i):(i.next=t.next,t.next=i),this.pushmod=this.modified=!0,this.length++,i},ki.prototype.pop=function(){var t=this.head;this.head=t.next,t.elt=null,t.next=dn.zpp_pool,dn.zpp_pool=t,null==this.head&&(this.pushmod=!0),this.modified=!0,this.length--},ki.prototype.inlined_pop=function(){var t=this.head;this.head=t.next,t.elt=null,t.next=dn.zpp_pool,dn.zpp_pool=t,null==this.head&&(this.pushmod=!0),this.modified=!0,this.length--},ki.prototype.pop_unsafe=function(){var t=this.head.elt;return this.pop(),t},ki.prototype.inlined_pop_unsafe=function(){var t=this.head.elt;return this.pop(),t},ki.prototype.remove=function(t){for(var e,i,n=null,r=this.head;null!=r;){if(r.elt==t){null==n?(i=(e=this.head).next,this.head=i,null==this.head&&(this.pushmod=!0)):(i=(e=n.next).next,null==(n.next=i)&&(this.pushmod=!0));var o=e;o.elt=null,o.next=dn.zpp_pool,dn.zpp_pool=o,this.modified=!0,this.length--,this.pushmod=!0;break}r=(n=r).next}},ki.prototype.try_remove=function(t){for(var e=null,i=this.head,n=!1;null!=i;){if(i.elt==t){this.erase(e),n=!0;break}i=(e=i).next}return n},ki.prototype.inlined_remove=function(t){for(var e,i,n=null,r=this.head;null!=r;){if(r.elt==t){null==n?(i=(e=this.head).next,this.head=i,null==this.head&&(this.pushmod=!0)):(i=(e=n.next).next,null==(n.next=i)&&(this.pushmod=!0));var o=e;o.elt=null,o.next=dn.zpp_pool,dn.zpp_pool=o,this.modified=!0,this.length--,this.pushmod=!0;break}r=(n=r).next}},ki.prototype.inlined_try_remove=function(t){for(var e,i,n=null,r=this.head,o=!1;null!=r;){if(r.elt==t){null==n?(i=(e=this.head).next,this.head=i,null==this.head&&(this.pushmod=!0)):(i=(e=n.next).next,null==(n.next=i)&&(this.pushmod=!0));var s=e;s.elt=null,s.next=dn.zpp_pool,dn.zpp_pool=s,this.modified=!0,this.length--,o=this.pushmod=!0;break}r=(n=r).next}return o},ki.prototype.erase=function(t){var e;null==t?(e=(i=this.head).next,this.head=e,null==this.head&&(this.pushmod=!0)):(e=(i=t.next).next,null==(t.next=e)&&(this.pushmod=!0));var i=i;return i.elt=null,i.next=dn.zpp_pool,dn.zpp_pool=i,this.modified=!0,this.length--,this.pushmod=!0,e},ki.prototype.inlined_erase=function(t){var e;null==t?(e=(i=this.head).next,this.head=e,null==this.head&&(this.pushmod=!0)):(e=(i=t.next).next,null==(t.next=e)&&(this.pushmod=!0));var i=i;return i.elt=null,i.next=dn.zpp_pool,dn.zpp_pool=i,this.modified=!0,this.length--,this.pushmod=!0,e},ki.prototype.splice=function(t,e){for(;0<e--&&null!=t.next;)this.erase(t);return t.next},ki.prototype.clear=function(){for(;null!=this.head;){var t=this.head;this.head=t.next,t.elt=null,t.next=dn.zpp_pool,dn.zpp_pool=t,null==this.head&&(this.pushmod=!0),this.modified=!0,this.length--}this.pushmod=!0},ki.prototype.inlined_clear=function(){for(;null!=this.head;){var t=this.head;this.head=t.next,t.elt=null,t.next=dn.zpp_pool,dn.zpp_pool=t,null==this.head&&(this.pushmod=!0),this.modified=!0,this.length--}this.pushmod=!0},ki.prototype.reverse=function(){for(var t=this.head,e=null;null!=t;){var i=t.next;t.next=e,e=this.head=t,t=i}this.modified=!0,this.pushmod=!0},ki.prototype.empty=function(){return null==this.head},ki.prototype.size=function(){return this.length},ki.prototype.has=function(t){for(var e=!1,i=this.head;null!=i;){if(i.elt==t){e=!0;break}i=i.next}return e},ki.prototype.inlined_has=function(t){for(var e=!1,i=this.head;null!=i;){if(i.elt==t){e=!0;break}i=i.next}return e},ki.prototype.front=function(){return this.head.elt},ki.prototype.back=function(){for(var t=this.head,e=t;null!=e;)e=(t=e).next;return t.elt},ki.prototype.iterator_at=function(t){for(var e=this.head;0<t--&&null!=e;)e=e.next;return e},ki.prototype.at=function(t){t=this.iterator_at(t);return null!=t?t.elt:null},ki.prototype.__class__=ki;var Oi=zpp_nape.util.ZNPList_ZPP_AABBNode=function(){this.length=0,this.pushmod=!1,this.modified=!1,this.head=null};Oi.__name__=["zpp_nape","util","ZNPList_ZPP_AABBNode"],Oi.prototype.head=null,Oi.prototype.begin=function(){return this.head},Oi.prototype.modified=null,Oi.prototype.pushmod=null,Oi.prototype.length=null,Oi.prototype.setbegin=function(t){this.head=t,this.modified=!0,this.pushmod=!0},Oi.prototype.add=function(t){null==cn.zpp_pool?e=new cn:(e=cn.zpp_pool,cn.zpp_pool=e.next,e.next=null),e.elt=t;var e=e;return e.next=this.head,this.head=e,this.modified=!0,this.length++,t},Oi.prototype.inlined_add=function(t){null==cn.zpp_pool?e=new cn:(e=cn.zpp_pool,cn.zpp_pool=e.next,e.next=null),e.elt=t;var e=e;return e.next=this.head,this.head=e,this.modified=!0,this.length++,t},Oi.prototype.addAll=function(t){for(var e=t.head;null!=e;)this.add(e.elt),e=e.next},Oi.prototype.insert=function(t,e){null==cn.zpp_pool?i=new cn:(i=cn.zpp_pool,cn.zpp_pool=i.next,i.next=null),i.elt=e;var i=i;return null==t?(i.next=this.head,this.head=i):(i.next=t.next,t.next=i),this.pushmod=this.modified=!0,this.length++,i},Oi.prototype.inlined_insert=function(t,e){null==cn.zpp_pool?i=new cn:(i=cn.zpp_pool,cn.zpp_pool=i.next,i.next=null),i.elt=e;var i=i;return null==t?(i.next=this.head,this.head=i):(i.next=t.next,t.next=i),this.pushmod=this.modified=!0,this.length++,i},Oi.prototype.pop=function(){var t=this.head;this.head=t.next,t.elt=null,t.next=cn.zpp_pool,cn.zpp_pool=t,null==this.head&&(this.pushmod=!0),this.modified=!0,this.length--},Oi.prototype.inlined_pop=function(){var t=this.head;this.head=t.next,t.elt=null,t.next=cn.zpp_pool,cn.zpp_pool=t,null==this.head&&(this.pushmod=!0),this.modified=!0,this.length--},Oi.prototype.pop_unsafe=function(){var t=this.head.elt;return this.pop(),t},Oi.prototype.inlined_pop_unsafe=function(){var t=this.head.elt;return this.pop(),t},Oi.prototype.remove=function(t){for(var e,i,n=null,r=this.head;null!=r;){if(r.elt==t){null==n?(i=(e=this.head).next,this.head=i,null==this.head&&(this.pushmod=!0)):(i=(e=n.next).next,null==(n.next=i)&&(this.pushmod=!0));var o=e;o.elt=null,o.next=cn.zpp_pool,cn.zpp_pool=o,this.modified=!0,this.length--,this.pushmod=!0;break}r=(n=r).next}},Oi.prototype.try_remove=function(t){for(var e=null,i=this.head,n=!1;null!=i;){if(i.elt==t){this.erase(e),n=!0;break}i=(e=i).next}return n},Oi.prototype.inlined_remove=function(t){for(var e,i,n=null,r=this.head;null!=r;){if(r.elt==t){null==n?(i=(e=this.head).next,this.head=i,null==this.head&&(this.pushmod=!0)):(i=(e=n.next).next,null==(n.next=i)&&(this.pushmod=!0));var o=e;o.elt=null,o.next=cn.zpp_pool,cn.zpp_pool=o,this.modified=!0,this.length--,this.pushmod=!0;break}r=(n=r).next}},Oi.prototype.inlined_try_remove=function(t){for(var e,i,n=null,r=this.head,o=!1;null!=r;){if(r.elt==t){null==n?(i=(e=this.head).next,this.head=i,null==this.head&&(this.pushmod=!0)):(i=(e=n.next).next,null==(n.next=i)&&(this.pushmod=!0));var s=e;s.elt=null,s.next=cn.zpp_pool,cn.zpp_pool=s,this.modified=!0,this.length--,o=this.pushmod=!0;break}r=(n=r).next}return o},Oi.prototype.erase=function(t){var e;null==t?(e=(i=this.head).next,this.head=e,null==this.head&&(this.pushmod=!0)):(e=(i=t.next).next,null==(t.next=e)&&(this.pushmod=!0));var i=i;return i.elt=null,i.next=cn.zpp_pool,cn.zpp_pool=i,this.modified=!0,this.length--,this.pushmod=!0,e},Oi.prototype.inlined_erase=function(t){var e;null==t?(e=(i=this.head).next,this.head=e,null==this.head&&(this.pushmod=!0)):(e=(i=t.next).next,null==(t.next=e)&&(this.pushmod=!0));var i=i;return i.elt=null,i.next=cn.zpp_pool,cn.zpp_pool=i,this.modified=!0,this.length--,this.pushmod=!0,e},Oi.prototype.splice=function(t,e){for(;0<e--&&null!=t.next;)this.erase(t);return t.next},Oi.prototype.clear=function(){for(;null!=this.head;){var t=this.head;this.head=t.next,t.elt=null,t.next=cn.zpp_pool,cn.zpp_pool=t,null==this.head&&(this.pushmod=!0),this.modified=!0,this.length--}this.pushmod=!0},Oi.prototype.inlined_clear=function(){for(;null!=this.head;){var t=this.head;this.head=t.next,t.elt=null,t.next=cn.zpp_pool,cn.zpp_pool=t,null==this.head&&(this.pushmod=!0),this.modified=!0,this.length--}this.pushmod=!0},Oi.prototype.reverse=function(){for(var t=this.head,e=null;null!=t;){var i=t.next;t.next=e,e=this.head=t,t=i}this.modified=!0,this.pushmod=!0},Oi.prototype.empty=function(){return null==this.head},Oi.prototype.size=function(){return this.length},Oi.prototype.has=function(t){for(var e=!1,i=this.head;null!=i;){if(i.elt==t){e=!0;break}i=i.next}return e},Oi.prototype.inlined_has=function(t){for(var e=!1,i=this.head;null!=i;){if(i.elt==t){e=!0;break}i=i.next}return e},Oi.prototype.front=function(){return this.head.elt},Oi.prototype.back=function(){for(var t=this.head,e=t;null!=e;)e=(t=e).next;return t.elt},Oi.prototype.iterator_at=function(t){for(var e=this.head;0<t--&&null!=e;)e=e.next;return e},Oi.prototype.at=function(t){t=this.iterator_at(t);return null!=t?t.elt:null},Oi.prototype.__class__=Oi;var Ei=zpp_nape.util.ZNPList_ZPP_Component=function(){this.length=0,this.pushmod=!1,this.modified=!1,this.head=null};Ei.__name__=["zpp_nape","util","ZNPList_ZPP_Component"],Ei.prototype.head=null,Ei.prototype.begin=function(){return this.head},Ei.prototype.modified=null,Ei.prototype.pushmod=null,Ei.prototype.length=null,Ei.prototype.setbegin=function(t){this.head=t,this.modified=!0,this.pushmod=!0},Ei.prototype.add=function(t){null==yn.zpp_pool?e=new yn:(e=yn.zpp_pool,yn.zpp_pool=e.next,e.next=null),e.elt=t;var e=e;return e.next=this.head,this.head=e,this.modified=!0,this.length++,t},Ei.prototype.inlined_add=function(t){null==yn.zpp_pool?e=new yn:(e=yn.zpp_pool,yn.zpp_pool=e.next,e.next=null),e.elt=t;var e=e;return e.next=this.head,this.head=e,this.modified=!0,this.length++,t},Ei.prototype.addAll=function(t){for(var e=t.head;null!=e;)this.add(e.elt),e=e.next},Ei.prototype.insert=function(t,e){null==yn.zpp_pool?i=new yn:(i=yn.zpp_pool,yn.zpp_pool=i.next,i.next=null),i.elt=e;var i=i;return null==t?(i.next=this.head,this.head=i):(i.next=t.next,t.next=i),this.pushmod=this.modified=!0,this.length++,i},Ei.prototype.inlined_insert=function(t,e){null==yn.zpp_pool?i=new yn:(i=yn.zpp_pool,yn.zpp_pool=i.next,i.next=null),i.elt=e;var i=i;return null==t?(i.next=this.head,this.head=i):(i.next=t.next,t.next=i),this.pushmod=this.modified=!0,this.length++,i},Ei.prototype.pop=function(){var t=this.head;this.head=t.next,t.elt=null,t.next=yn.zpp_pool,yn.zpp_pool=t,null==this.head&&(this.pushmod=!0),this.modified=!0,this.length--},Ei.prototype.inlined_pop=function(){var t=this.head;this.head=t.next,t.elt=null,t.next=yn.zpp_pool,yn.zpp_pool=t,null==this.head&&(this.pushmod=!0),this.modified=!0,this.length--},Ei.prototype.pop_unsafe=function(){var t=this.head.elt;return this.pop(),t},Ei.prototype.inlined_pop_unsafe=function(){var t=this.head.elt;return this.pop(),t},Ei.prototype.remove=function(t){for(var e,i,n=null,r=this.head;null!=r;){if(r.elt==t){null==n?(i=(e=this.head).next,this.head=i,null==this.head&&(this.pushmod=!0)):(i=(e=n.next).next,null==(n.next=i)&&(this.pushmod=!0));var o=e;o.elt=null,o.next=yn.zpp_pool,yn.zpp_pool=o,this.modified=!0,this.length--,this.pushmod=!0;break}r=(n=r).next}},Ei.prototype.try_remove=function(t){for(var e=null,i=this.head,n=!1;null!=i;){if(i.elt==t){this.erase(e),n=!0;break}i=(e=i).next}return n},Ei.prototype.inlined_remove=function(t){for(var e,i,n=null,r=this.head;null!=r;){if(r.elt==t){null==n?(i=(e=this.head).next,this.head=i,null==this.head&&(this.pushmod=!0)):(i=(e=n.next).next,null==(n.next=i)&&(this.pushmod=!0));var o=e;o.elt=null,o.next=yn.zpp_pool,yn.zpp_pool=o,this.modified=!0,this.length--,this.pushmod=!0;break}r=(n=r).next}},Ei.prototype.inlined_try_remove=function(t){for(var e,i,n=null,r=this.head,o=!1;null!=r;){if(r.elt==t){null==n?(i=(e=this.head).next,this.head=i,null==this.head&&(this.pushmod=!0)):(i=(e=n.next).next,null==(n.next=i)&&(this.pushmod=!0));var s=e;s.elt=null,s.next=yn.zpp_pool,yn.zpp_pool=s,this.modified=!0,this.length--,o=this.pushmod=!0;break}r=(n=r).next}return o},Ei.prototype.erase=function(t){var e;null==t?(e=(i=this.head).next,this.head=e,null==this.head&&(this.pushmod=!0)):(e=(i=t.next).next,null==(t.next=e)&&(this.pushmod=!0));var i=i;return i.elt=null,i.next=yn.zpp_pool,yn.zpp_pool=i,this.modified=!0,this.length--,this.pushmod=!0,e},Ei.prototype.inlined_erase=function(t){var e;null==t?(e=(i=this.head).next,this.head=e,null==this.head&&(this.pushmod=!0)):(e=(i=t.next).next,null==(t.next=e)&&(this.pushmod=!0));var i=i;return i.elt=null,i.next=yn.zpp_pool,yn.zpp_pool=i,this.modified=!0,this.length--,this.pushmod=!0,e},Ei.prototype.splice=function(t,e){for(;0<e--&&null!=t.next;)this.erase(t);return t.next},Ei.prototype.clear=function(){for(;null!=this.head;){var t=this.head;this.head=t.next,t.elt=null,t.next=yn.zpp_pool,yn.zpp_pool=t,null==this.head&&(this.pushmod=!0),this.modified=!0,this.length--}this.pushmod=!0},Ei.prototype.inlined_clear=function(){for(;null!=this.head;){var t=this.head;this.head=t.next,t.elt=null,t.next=yn.zpp_pool,yn.zpp_pool=t,null==this.head&&(this.pushmod=!0),this.modified=!0,this.length--}this.pushmod=!0},Ei.prototype.reverse=function(){for(var t=this.head,e=null;null!=t;){var i=t.next;t.next=e,e=this.head=t,t=i}this.modified=!0,this.pushmod=!0},Ei.prototype.empty=function(){return null==this.head},Ei.prototype.size=function(){return this.length},Ei.prototype.has=function(t){for(var e=!1,i=this.head;null!=i;){if(i.elt==t){e=!0;break}i=i.next}return e},Ei.prototype.inlined_has=function(t){for(var e=!1,i=this.head;null!=i;){if(i.elt==t){e=!0;break}i=i.next}return e},Ei.prototype.front=function(){return this.head.elt},Ei.prototype.back=function(){for(var t=this.head,e=t;null!=e;)e=(t=e).next;return t.elt},Ei.prototype.iterator_at=function(t){for(var e=this.head;0<t--&&null!=e;)e=e.next;return e},Ei.prototype.at=function(t){t=this.iterator_at(t);return null!=t?t.elt:null},Ei.prototype.__class__=Ei;var Ii=zpp_nape.util.ZNPList_ZPP_FluidArbiter=function(){this.length=0,this.pushmod=!1,this.modified=!1,this.head=null};Ii.__name__=["zpp_nape","util","ZNPList_ZPP_FluidArbiter"],Ii.prototype.head=null,Ii.prototype.begin=function(){return this.head},Ii.prototype.modified=null,Ii.prototype.pushmod=null,Ii.prototype.length=null,Ii.prototype.setbegin=function(t){this.head=t,this.modified=!0,this.pushmod=!0},Ii.prototype.add=function(t){null==rr.zpp_pool?e=new rr:(e=rr.zpp_pool,rr.zpp_pool=e.next,e.next=null),e.elt=t;var e=e;return e.next=this.head,this.head=e,this.modified=!0,this.length++,t},Ii.prototype.inlined_add=function(t){null==rr.zpp_pool?e=new rr:(e=rr.zpp_pool,rr.zpp_pool=e.next,e.next=null),e.elt=t;var e=e;return e.next=this.head,this.head=e,this.modified=!0,this.length++,t},Ii.prototype.addAll=function(t){for(var e=t.head;null!=e;)this.add(e.elt),e=e.next},Ii.prototype.insert=function(t,e){null==rr.zpp_pool?i=new rr:(i=rr.zpp_pool,rr.zpp_pool=i.next,i.next=null),i.elt=e;var i=i;return null==t?(i.next=this.head,this.head=i):(i.next=t.next,t.next=i),this.pushmod=this.modified=!0,this.length++,i},Ii.prototype.inlined_insert=function(t,e){null==rr.zpp_pool?i=new rr:(i=rr.zpp_pool,rr.zpp_pool=i.next,i.next=null),i.elt=e;var i=i;return null==t?(i.next=this.head,this.head=i):(i.next=t.next,t.next=i),this.pushmod=this.modified=!0,this.length++,i},Ii.prototype.pop=function(){var t=this.head;this.head=t.next,t.elt=null,t.next=rr.zpp_pool,rr.zpp_pool=t,null==this.head&&(this.pushmod=!0),this.modified=!0,this.length--},Ii.prototype.inlined_pop=function(){var t=this.head;this.head=t.next,t.elt=null,t.next=rr.zpp_pool,rr.zpp_pool=t,null==this.head&&(this.pushmod=!0),this.modified=!0,this.length--},Ii.prototype.pop_unsafe=function(){var t=this.head.elt;return this.pop(),t},Ii.prototype.inlined_pop_unsafe=function(){var t=this.head.elt;return this.pop(),t},Ii.prototype.remove=function(t){for(var e,i,n=null,r=this.head;null!=r;){if(r.elt==t){null==n?(i=(e=this.head).next,this.head=i,null==this.head&&(this.pushmod=!0)):(i=(e=n.next).next,null==(n.next=i)&&(this.pushmod=!0));var o=e;o.elt=null,o.next=rr.zpp_pool,rr.zpp_pool=o,this.modified=!0,this.length--,this.pushmod=!0;break}r=(n=r).next}},Ii.prototype.try_remove=function(t){for(var e=null,i=this.head,n=!1;null!=i;){if(i.elt==t){this.erase(e),n=!0;break}i=(e=i).next}return n},Ii.prototype.inlined_remove=function(t){for(var e,i,n=null,r=this.head;null!=r;){if(r.elt==t){null==n?(i=(e=this.head).next,this.head=i,null==this.head&&(this.pushmod=!0)):(i=(e=n.next).next,null==(n.next=i)&&(this.pushmod=!0));var o=e;o.elt=null,o.next=rr.zpp_pool,rr.zpp_pool=o,this.modified=!0,this.length--,this.pushmod=!0;break}r=(n=r).next}},Ii.prototype.inlined_try_remove=function(t){for(var e,i,n=null,r=this.head,o=!1;null!=r;){if(r.elt==t){null==n?(i=(e=this.head).next,this.head=i,null==this.head&&(this.pushmod=!0)):(i=(e=n.next).next,null==(n.next=i)&&(this.pushmod=!0));var s=e;s.elt=null,s.next=rr.zpp_pool,rr.zpp_pool=s,this.modified=!0,this.length--,o=this.pushmod=!0;break}r=(n=r).next}return o},Ii.prototype.erase=function(t){var e;null==t?(e=(i=this.head).next,this.head=e,null==this.head&&(this.pushmod=!0)):(e=(i=t.next).next,null==(t.next=e)&&(this.pushmod=!0));var i=i;return i.elt=null,i.next=rr.zpp_pool,rr.zpp_pool=i,this.modified=!0,this.length--,this.pushmod=!0,e},Ii.prototype.inlined_erase=function(t){var e;null==t?(e=(i=this.head).next,this.head=e,null==this.head&&(this.pushmod=!0)):(e=(i=t.next).next,null==(t.next=e)&&(this.pushmod=!0));var i=i;return i.elt=null,i.next=rr.zpp_pool,rr.zpp_pool=i,this.modified=!0,this.length--,this.pushmod=!0,e},Ii.prototype.splice=function(t,e){for(;0<e--&&null!=t.next;)this.erase(t);return t.next},Ii.prototype.clear=function(){for(;null!=this.head;){var t=this.head;this.head=t.next,t.elt=null,t.next=rr.zpp_pool,rr.zpp_pool=t,null==this.head&&(this.pushmod=!0),this.modified=!0,this.length--}this.pushmod=!0},Ii.prototype.inlined_clear=function(){for(;null!=this.head;){var t=this.head;this.head=t.next,t.elt=null,t.next=rr.zpp_pool,rr.zpp_pool=t,null==this.head&&(this.pushmod=!0),this.modified=!0,this.length--}this.pushmod=!0},Ii.prototype.reverse=function(){for(var t=this.head,e=null;null!=t;){var i=t.next;t.next=e,e=this.head=t,t=i}this.modified=!0,this.pushmod=!0},Ii.prototype.empty=function(){return null==this.head},Ii.prototype.size=function(){return this.length},Ii.prototype.has=function(t){for(var e=!1,i=this.head;null!=i;){if(i.elt==t){e=!0;break}i=i.next}return e},Ii.prototype.inlined_has=function(t){for(var e=!1,i=this.head;null!=i;){if(i.elt==t){e=!0;break}i=i.next}return e},Ii.prototype.front=function(){return this.head.elt},Ii.prototype.back=function(){for(var t=this.head,e=t;null!=e;)e=(t=e).next;return t.elt},Ii.prototype.iterator_at=function(t){for(var e=this.head;0<t--&&null!=e;)e=e.next;return e},Ii.prototype.at=function(t){t=this.iterator_at(t);return null!=t?t.elt:null},Ii.prototype.__class__=Ii;var Gi=zpp_nape.util.ZNPList_ZPP_SensorArbiter=function(){this.length=0,this.pushmod=!1,this.modified=!1,this.head=null};Gi.__name__=["zpp_nape","util","ZNPList_ZPP_SensorArbiter"],Gi.prototype.head=null,Gi.prototype.begin=function(){return this.head},Gi.prototype.modified=null,Gi.prototype.pushmod=null,Gi.prototype.length=null,Gi.prototype.setbegin=function(t){this.head=t,this.modified=!0,this.pushmod=!0},Gi.prototype.add=function(t){null==or.zpp_pool?e=new or:(e=or.zpp_pool,or.zpp_pool=e.next,e.next=null),e.elt=t;var e=e;return e.next=this.head,this.head=e,this.modified=!0,this.length++,t},Gi.prototype.inlined_add=function(t){null==or.zpp_pool?e=new or:(e=or.zpp_pool,or.zpp_pool=e.next,e.next=null),e.elt=t;var e=e;return e.next=this.head,this.head=e,this.modified=!0,this.length++,t},Gi.prototype.addAll=function(t){for(var e=t.head;null!=e;)this.add(e.elt),e=e.next},Gi.prototype.insert=function(t,e){null==or.zpp_pool?i=new or:(i=or.zpp_pool,or.zpp_pool=i.next,i.next=null),i.elt=e;var i=i;return null==t?(i.next=this.head,this.head=i):(i.next=t.next,t.next=i),this.pushmod=this.modified=!0,this.length++,i},Gi.prototype.inlined_insert=function(t,e){null==or.zpp_pool?i=new or:(i=or.zpp_pool,or.zpp_pool=i.next,i.next=null),i.elt=e;var i=i;return null==t?(i.next=this.head,this.head=i):(i.next=t.next,t.next=i),this.pushmod=this.modified=!0,this.length++,i},Gi.prototype.pop=function(){var t=this.head;this.head=t.next,t.elt=null,t.next=or.zpp_pool,or.zpp_pool=t,null==this.head&&(this.pushmod=!0),this.modified=!0,this.length--},Gi.prototype.inlined_pop=function(){var t=this.head;this.head=t.next,t.elt=null,t.next=or.zpp_pool,or.zpp_pool=t,null==this.head&&(this.pushmod=!0),this.modified=!0,this.length--},Gi.prototype.pop_unsafe=function(){var t=this.head.elt;return this.pop(),t},Gi.prototype.inlined_pop_unsafe=function(){var t=this.head.elt;return this.pop(),t},Gi.prototype.remove=function(t){for(var e,i,n=null,r=this.head;null!=r;){if(r.elt==t){null==n?(i=(e=this.head).next,this.head=i,null==this.head&&(this.pushmod=!0)):(i=(e=n.next).next,null==(n.next=i)&&(this.pushmod=!0));var o=e;o.elt=null,o.next=or.zpp_pool,or.zpp_pool=o,this.modified=!0,this.length--,this.pushmod=!0;break}r=(n=r).next}},Gi.prototype.try_remove=function(t){for(var e=null,i=this.head,n=!1;null!=i;){if(i.elt==t){this.erase(e),n=!0;break}i=(e=i).next}return n},Gi.prototype.inlined_remove=function(t){for(var e,i,n=null,r=this.head;null!=r;){if(r.elt==t){null==n?(i=(e=this.head).next,this.head=i,null==this.head&&(this.pushmod=!0)):(i=(e=n.next).next,null==(n.next=i)&&(this.pushmod=!0));var o=e;o.elt=null,o.next=or.zpp_pool,or.zpp_pool=o,this.modified=!0,this.length--,this.pushmod=!0;break}r=(n=r).next}},Gi.prototype.inlined_try_remove=function(t){for(var e,i,n=null,r=this.head,o=!1;null!=r;){if(r.elt==t){null==n?(i=(e=this.head).next,this.head=i,null==this.head&&(this.pushmod=!0)):(i=(e=n.next).next,null==(n.next=i)&&(this.pushmod=!0));var s=e;s.elt=null,s.next=or.zpp_pool,or.zpp_pool=s,this.modified=!0,this.length--,o=this.pushmod=!0;break}r=(n=r).next}return o},Gi.prototype.erase=function(t){var e;null==t?(e=(i=this.head).next,this.head=e,null==this.head&&(this.pushmod=!0)):(e=(i=t.next).next,null==(t.next=e)&&(this.pushmod=!0));var i=i;return i.elt=null,i.next=or.zpp_pool,or.zpp_pool=i,this.modified=!0,this.length--,this.pushmod=!0,e},Gi.prototype.inlined_erase=function(t){var e;null==t?(e=(i=this.head).next,this.head=e,null==this.head&&(this.pushmod=!0)):(e=(i=t.next).next,null==(t.next=e)&&(this.pushmod=!0));var i=i;return i.elt=null,i.next=or.zpp_pool,or.zpp_pool=i,this.modified=!0,this.length--,this.pushmod=!0,e},Gi.prototype.splice=function(t,e){for(;0<e--&&null!=t.next;)this.erase(t);return t.next},Gi.prototype.clear=function(){for(;null!=this.head;){var t=this.head;this.head=t.next,t.elt=null,t.next=or.zpp_pool,or.zpp_pool=t,null==this.head&&(this.pushmod=!0),this.modified=!0,this.length--}this.pushmod=!0},Gi.prototype.inlined_clear=function(){for(;null!=this.head;){var t=this.head;this.head=t.next,t.elt=null,t.next=or.zpp_pool,or.zpp_pool=t,null==this.head&&(this.pushmod=!0),this.modified=!0,this.length--}this.pushmod=!0},Gi.prototype.reverse=function(){for(var t=this.head,e=null;null!=t;){var i=t.next;t.next=e,e=this.head=t,t=i}this.modified=!0,this.pushmod=!0},Gi.prototype.empty=function(){return null==this.head},Gi.prototype.size=function(){return this.length},Gi.prototype.has=function(t){for(var e=!1,i=this.head;null!=i;){if(i.elt==t){e=!0;break}i=i.next}return e},Gi.prototype.inlined_has=function(t){for(var e=!1,i=this.head;null!=i;){if(i.elt==t){e=!0;break}i=i.next}return e},Gi.prototype.front=function(){return this.head.elt},Gi.prototype.back=function(){for(var t=this.head,e=t;null!=e;)e=(t=e).next;return t.elt},Gi.prototype.iterator_at=function(t){for(var e=this.head;0<t--&&null!=e;)e=e.next;return e},Gi.prototype.at=function(t){t=this.iterator_at(t);return null!=t?t.elt:null},Gi.prototype.__class__=Gi;var Di=zpp_nape.util.ZNPList_ZPP_Listener=function(){this.length=0,this.pushmod=!1,this.modified=!1,this.head=null};Di.__name__=["zpp_nape","util","ZNPList_ZPP_Listener"],Di.prototype.head=null,Di.prototype.begin=function(){return this.head},Di.prototype.modified=null,Di.prototype.pushmod=null,Di.prototype.length=null,Di.prototype.setbegin=function(t){this.head=t,this.modified=!0,this.pushmod=!0},Di.prototype.add=function(t){null==_n.zpp_pool?e=new _n:(e=_n.zpp_pool,_n.zpp_pool=e.next,e.next=null),e.elt=t;var e=e;return e.next=this.head,this.head=e,this.modified=!0,this.length++,t},Di.prototype.inlined_add=function(t){null==_n.zpp_pool?e=new _n:(e=_n.zpp_pool,_n.zpp_pool=e.next,e.next=null),e.elt=t;var e=e;return e.next=this.head,this.head=e,this.modified=!0,this.length++,t},Di.prototype.addAll=function(t){for(var e=t.head;null!=e;)this.add(e.elt),e=e.next},Di.prototype.insert=function(t,e){null==_n.zpp_pool?i=new _n:(i=_n.zpp_pool,_n.zpp_pool=i.next,i.next=null),i.elt=e;var i=i;return null==t?(i.next=this.head,this.head=i):(i.next=t.next,t.next=i),this.pushmod=this.modified=!0,this.length++,i},Di.prototype.inlined_insert=function(t,e){null==_n.zpp_pool?i=new _n:(i=_n.zpp_pool,_n.zpp_pool=i.next,i.next=null),i.elt=e;var i=i;return null==t?(i.next=this.head,this.head=i):(i.next=t.next,t.next=i),this.pushmod=this.modified=!0,this.length++,i},Di.prototype.pop=function(){var t=this.head;this.head=t.next,t.elt=null,t.next=_n.zpp_pool,_n.zpp_pool=t,null==this.head&&(this.pushmod=!0),this.modified=!0,this.length--},Di.prototype.inlined_pop=function(){var t=this.head;this.head=t.next,t.elt=null,t.next=_n.zpp_pool,_n.zpp_pool=t,null==this.head&&(this.pushmod=!0),this.modified=!0,this.length--},Di.prototype.pop_unsafe=function(){var t=this.head.elt;return this.pop(),t},Di.prototype.inlined_pop_unsafe=function(){var t=this.head.elt;return this.pop(),t},Di.prototype.remove=function(t){for(var e,i,n=null,r=this.head;null!=r;){if(r.elt==t){null==n?(i=(e=this.head).next,this.head=i,null==this.head&&(this.pushmod=!0)):(i=(e=n.next).next,null==(n.next=i)&&(this.pushmod=!0));var o=e;o.elt=null,o.next=_n.zpp_pool,_n.zpp_pool=o,this.modified=!0,this.length--,this.pushmod=!0;break}r=(n=r).next}},Di.prototype.try_remove=function(t){for(var e=null,i=this.head,n=!1;null!=i;){if(i.elt==t){this.erase(e),n=!0;break}i=(e=i).next}return n},Di.prototype.inlined_remove=function(t){for(var e,i,n=null,r=this.head;null!=r;){if(r.elt==t){null==n?(i=(e=this.head).next,this.head=i,null==this.head&&(this.pushmod=!0)):(i=(e=n.next).next,null==(n.next=i)&&(this.pushmod=!0));var o=e;o.elt=null,o.next=_n.zpp_pool,_n.zpp_pool=o,this.modified=!0,this.length--,this.pushmod=!0;break}r=(n=r).next}},Di.prototype.inlined_try_remove=function(t){for(var e,i,n=null,r=this.head,o=!1;null!=r;){if(r.elt==t){null==n?(i=(e=this.head).next,this.head=i,null==this.head&&(this.pushmod=!0)):(i=(e=n.next).next,null==(n.next=i)&&(this.pushmod=!0));var s=e;s.elt=null,s.next=_n.zpp_pool,_n.zpp_pool=s,this.modified=!0,this.length--,o=this.pushmod=!0;break}r=(n=r).next}return o},Di.prototype.erase=function(t){var e;null==t?(e=(i=this.head).next,this.head=e,null==this.head&&(this.pushmod=!0)):(e=(i=t.next).next,null==(t.next=e)&&(this.pushmod=!0));var i=i;return i.elt=null,i.next=_n.zpp_pool,_n.zpp_pool=i,this.modified=!0,this.length--,this.pushmod=!0,e},Di.prototype.inlined_erase=function(t){var e;null==t?(e=(i=this.head).next,this.head=e,null==this.head&&(this.pushmod=!0)):(e=(i=t.next).next,null==(t.next=e)&&(this.pushmod=!0));var i=i;return i.elt=null,i.next=_n.zpp_pool,_n.zpp_pool=i,this.modified=!0,this.length--,this.pushmod=!0,e},Di.prototype.splice=function(t,e){for(;0<e--&&null!=t.next;)this.erase(t);return t.next},Di.prototype.clear=function(){for(;null!=this.head;){var t=this.head;this.head=t.next,t.elt=null,t.next=_n.zpp_pool,_n.zpp_pool=t,null==this.head&&(this.pushmod=!0),this.modified=!0,this.length--}this.pushmod=!0},Di.prototype.inlined_clear=function(){for(;null!=this.head;){var t=this.head;this.head=t.next,t.elt=null,t.next=_n.zpp_pool,_n.zpp_pool=t,null==this.head&&(this.pushmod=!0),this.modified=!0,this.length--}this.pushmod=!0},Di.prototype.reverse=function(){for(var t=this.head,e=null;null!=t;){var i=t.next;t.next=e,e=this.head=t,t=i}this.modified=!0,this.pushmod=!0},Di.prototype.empty=function(){return null==this.head},Di.prototype.size=function(){return this.length},Di.prototype.has=function(t){for(var e=!1,i=this.head;null!=i;){if(i.elt==t){e=!0;break}i=i.next}return e},Di.prototype.inlined_has=function(t){for(var e=!1,i=this.head;null!=i;){if(i.elt==t){e=!0;break}i=i.next}return e},Di.prototype.front=function(){return this.head.elt},Di.prototype.back=function(){for(var t=this.head,e=t;null!=e;)e=(t=e).next;return t.elt},Di.prototype.iterator_at=function(t){for(var e=this.head;0<t--&&null!=e;)e=e.next;return e},Di.prototype.at=function(t){t=this.iterator_at(t);return null!=t?t.elt:null},Di.prototype.__class__=Di;var Li=zpp_nape.util.ZNPList_ZPP_ColArbiter=function(){this.length=0,this.pushmod=!1,this.modified=!1,this.head=null};Li.__name__=["zpp_nape","util","ZNPList_ZPP_ColArbiter"],Li.prototype.head=null,Li.prototype.begin=function(){return this.head},Li.prototype.modified=null,Li.prototype.pushmod=null,Li.prototype.length=null,Li.prototype.setbegin=function(t){this.head=t,this.modified=!0,this.pushmod=!0},Li.prototype.add=function(t){null==sr.zpp_pool?e=new sr:(e=sr.zpp_pool,sr.zpp_pool=e.next,e.next=null),e.elt=t;var e=e;return e.next=this.head,this.head=e,this.modified=!0,this.length++,t},Li.prototype.inlined_add=function(t){null==sr.zpp_pool?e=new sr:(e=sr.zpp_pool,sr.zpp_pool=e.next,e.next=null),e.elt=t;var e=e;return e.next=this.head,this.head=e,this.modified=!0,this.length++,t},Li.prototype.addAll=function(t){for(var e=t.head;null!=e;)this.add(e.elt),e=e.next},Li.prototype.insert=function(t,e){null==sr.zpp_pool?i=new sr:(i=sr.zpp_pool,sr.zpp_pool=i.next,i.next=null),i.elt=e;var i=i;return null==t?(i.next=this.head,this.head=i):(i.next=t.next,t.next=i),this.pushmod=this.modified=!0,this.length++,i},Li.prototype.inlined_insert=function(t,e){null==sr.zpp_pool?i=new sr:(i=sr.zpp_pool,sr.zpp_pool=i.next,i.next=null),i.elt=e;var i=i;return null==t?(i.next=this.head,this.head=i):(i.next=t.next,t.next=i),this.pushmod=this.modified=!0,this.length++,i},Li.prototype.pop=function(){var t=this.head;this.head=t.next,t.elt=null,t.next=sr.zpp_pool,sr.zpp_pool=t,null==this.head&&(this.pushmod=!0),this.modified=!0,this.length--},Li.prototype.inlined_pop=function(){var t=this.head;this.head=t.next,t.elt=null,t.next=sr.zpp_pool,sr.zpp_pool=t,null==this.head&&(this.pushmod=!0),this.modified=!0,this.length--},Li.prototype.pop_unsafe=function(){var t=this.head.elt;return this.pop(),t},Li.prototype.inlined_pop_unsafe=function(){var t=this.head.elt;return this.pop(),t},Li.prototype.remove=function(t){for(var e,i,n=null,r=this.head;null!=r;){if(r.elt==t){null==n?(i=(e=this.head).next,this.head=i,null==this.head&&(this.pushmod=!0)):(i=(e=n.next).next,null==(n.next=i)&&(this.pushmod=!0));var o=e;o.elt=null,o.next=sr.zpp_pool,sr.zpp_pool=o,this.modified=!0,this.length--,this.pushmod=!0;break}r=(n=r).next}},Li.prototype.try_remove=function(t){for(var e=null,i=this.head,n=!1;null!=i;){if(i.elt==t){this.erase(e),n=!0;break}i=(e=i).next}return n},Li.prototype.inlined_remove=function(t){for(var e,i,n=null,r=this.head;null!=r;){if(r.elt==t){null==n?(i=(e=this.head).next,this.head=i,null==this.head&&(this.pushmod=!0)):(i=(e=n.next).next,null==(n.next=i)&&(this.pushmod=!0));var o=e;o.elt=null,o.next=sr.zpp_pool,sr.zpp_pool=o,this.modified=!0,this.length--,this.pushmod=!0;break}r=(n=r).next}},Li.prototype.inlined_try_remove=function(t){for(var e,i,n=null,r=this.head,o=!1;null!=r;){if(r.elt==t){null==n?(i=(e=this.head).next,this.head=i,null==this.head&&(this.pushmod=!0)):(i=(e=n.next).next,null==(n.next=i)&&(this.pushmod=!0));var s=e;s.elt=null,s.next=sr.zpp_pool,sr.zpp_pool=s,this.modified=!0,this.length--,o=this.pushmod=!0;break}r=(n=r).next}return o},Li.prototype.erase=function(t){var e;null==t?(e=(i=this.head).next,this.head=e,null==this.head&&(this.pushmod=!0)):(e=(i=t.next).next,null==(t.next=e)&&(this.pushmod=!0));var i=i;return i.elt=null,i.next=sr.zpp_pool,sr.zpp_pool=i,this.modified=!0,this.length--,this.pushmod=!0,e},Li.prototype.inlined_erase=function(t){var e;null==t?(e=(i=this.head).next,this.head=e,null==this.head&&(this.pushmod=!0)):(e=(i=t.next).next,null==(t.next=e)&&(this.pushmod=!0));var i=i;return i.elt=null,i.next=sr.zpp_pool,sr.zpp_pool=i,this.modified=!0,this.length--,this.pushmod=!0,e},Li.prototype.splice=function(t,e){for(;0<e--&&null!=t.next;)this.erase(t);return t.next},Li.prototype.clear=function(){for(;null!=this.head;){var t=this.head;this.head=t.next,t.elt=null,t.next=sr.zpp_pool,sr.zpp_pool=t,null==this.head&&(this.pushmod=!0),this.modified=!0,this.length--}this.pushmod=!0},Li.prototype.inlined_clear=function(){for(;null!=this.head;){var t=this.head;this.head=t.next,t.elt=null,t.next=sr.zpp_pool,sr.zpp_pool=t,null==this.head&&(this.pushmod=!0),this.modified=!0,this.length--}this.pushmod=!0},Li.prototype.reverse=function(){for(var t=this.head,e=null;null!=t;){var i=t.next;t.next=e,e=this.head=t,t=i}this.modified=!0,this.pushmod=!0},Li.prototype.empty=function(){return null==this.head},Li.prototype.size=function(){return this.length},Li.prototype.has=function(t){for(var e=!1,i=this.head;null!=i;){if(i.elt==t){e=!0;break}i=i.next}return e},Li.prototype.inlined_has=function(t){for(var e=!1,i=this.head;null!=i;){if(i.elt==t){e=!0;break}i=i.next}return e},Li.prototype.front=function(){return this.head.elt},Li.prototype.back=function(){for(var t=this.head,e=t;null!=e;)e=(t=e).next;return t.elt},Li.prototype.iterator_at=function(t){for(var e=this.head;0<t--&&null!=e;)e=e.next;return e},Li.prototype.at=function(t){t=this.iterator_at(t);return null!=t?t.elt:null},Li.prototype.__class__=Li;var Bi=zpp_nape.util.ZNPList_ZPP_InteractionGroup=function(){this.length=0,this.pushmod=!1,this.modified=!1,this.head=null};Bi.__name__=["zpp_nape","util","ZNPList_ZPP_InteractionGroup"],Bi.prototype.head=null,Bi.prototype.begin=function(){return this.head},Bi.prototype.modified=null,Bi.prototype.pushmod=null,Bi.prototype.length=null,Bi.prototype.setbegin=function(t){this.head=t,this.modified=!0,this.pushmod=!0},Bi.prototype.add=function(t){null==mn.zpp_pool?e=new mn:(e=mn.zpp_pool,mn.zpp_pool=e.next,e.next=null),e.elt=t;var e=e;return e.next=this.head,this.head=e,this.modified=!0,this.length++,t},Bi.prototype.inlined_add=function(t){null==mn.zpp_pool?e=new mn:(e=mn.zpp_pool,mn.zpp_pool=e.next,e.next=null),e.elt=t;var e=e;return e.next=this.head,this.head=e,this.modified=!0,this.length++,t},Bi.prototype.addAll=function(t){for(var e=t.head;null!=e;)this.add(e.elt),e=e.next},Bi.prototype.insert=function(t,e){null==mn.zpp_pool?i=new mn:(i=mn.zpp_pool,mn.zpp_pool=i.next,i.next=null),i.elt=e;var i=i;return null==t?(i.next=this.head,this.head=i):(i.next=t.next,t.next=i),this.pushmod=this.modified=!0,this.length++,i},Bi.prototype.inlined_insert=function(t,e){null==mn.zpp_pool?i=new mn:(i=mn.zpp_pool,mn.zpp_pool=i.next,i.next=null),i.elt=e;var i=i;return null==t?(i.next=this.head,this.head=i):(i.next=t.next,t.next=i),this.pushmod=this.modified=!0,this.length++,i},Bi.prototype.pop=function(){var t=this.head;this.head=t.next,t.elt=null,t.next=mn.zpp_pool,mn.zpp_pool=t,null==this.head&&(this.pushmod=!0),this.modified=!0,this.length--},Bi.prototype.inlined_pop=function(){var t=this.head;this.head=t.next,t.elt=null,t.next=mn.zpp_pool,mn.zpp_pool=t,null==this.head&&(this.pushmod=!0),this.modified=!0,this.length--},Bi.prototype.pop_unsafe=function(){var t=this.head.elt;return this.pop(),t},Bi.prototype.inlined_pop_unsafe=function(){var t=this.head.elt;return this.pop(),t},Bi.prototype.remove=function(t){for(var e,i,n=null,r=this.head;null!=r;){if(r.elt==t){null==n?(i=(e=this.head).next,this.head=i,null==this.head&&(this.pushmod=!0)):(i=(e=n.next).next,null==(n.next=i)&&(this.pushmod=!0));var o=e;o.elt=null,o.next=mn.zpp_pool,mn.zpp_pool=o,this.modified=!0,this.length--,this.pushmod=!0;break}r=(n=r).next}},Bi.prototype.try_remove=function(t){for(var e=null,i=this.head,n=!1;null!=i;){if(i.elt==t){this.erase(e),n=!0;break}i=(e=i).next}return n},Bi.prototype.inlined_remove=function(t){for(var e,i,n=null,r=this.head;null!=r;){if(r.elt==t){null==n?(i=(e=this.head).next,this.head=i,null==this.head&&(this.pushmod=!0)):(i=(e=n.next).next,null==(n.next=i)&&(this.pushmod=!0));var o=e;o.elt=null,o.next=mn.zpp_pool,mn.zpp_pool=o,this.modified=!0,this.length--,this.pushmod=!0;break}r=(n=r).next}},Bi.prototype.inlined_try_remove=function(t){for(var e,i,n=null,r=this.head,o=!1;null!=r;){if(r.elt==t){null==n?(i=(e=this.head).next,this.head=i,null==this.head&&(this.pushmod=!0)):(i=(e=n.next).next,null==(n.next=i)&&(this.pushmod=!0));var s=e;s.elt=null,s.next=mn.zpp_pool,mn.zpp_pool=s,this.modified=!0,this.length--,o=this.pushmod=!0;break}r=(n=r).next}return o},Bi.prototype.erase=function(t){var e;null==t?(e=(i=this.head).next,this.head=e,null==this.head&&(this.pushmod=!0)):(e=(i=t.next).next,null==(t.next=e)&&(this.pushmod=!0));var i=i;return i.elt=null,i.next=mn.zpp_pool,mn.zpp_pool=i,this.modified=!0,this.length--,this.pushmod=!0,e},Bi.prototype.inlined_erase=function(t){var e;null==t?(e=(i=this.head).next,this.head=e,null==this.head&&(this.pushmod=!0)):(e=(i=t.next).next,null==(t.next=e)&&(this.pushmod=!0));var i=i;return i.elt=null,i.next=mn.zpp_pool,mn.zpp_pool=i,this.modified=!0,this.length--,this.pushmod=!0,e},Bi.prototype.splice=function(t,e){for(;0<e--&&null!=t.next;)this.erase(t);return t.next},Bi.prototype.clear=function(){for(;null!=this.head;){var t=this.head;this.head=t.next,t.elt=null,t.next=mn.zpp_pool,mn.zpp_pool=t,null==this.head&&(this.pushmod=!0),this.modified=!0,this.length--}this.pushmod=!0},Bi.prototype.inlined_clear=function(){for(;null!=this.head;){var t=this.head;this.head=t.next,t.elt=null,t.next=mn.zpp_pool,mn.zpp_pool=t,null==this.head&&(this.pushmod=!0),this.modified=!0,this.length--}this.pushmod=!0},Bi.prototype.reverse=function(){for(var t=this.head,e=null;null!=t;){var i=t.next;t.next=e,e=this.head=t,t=i}this.modified=!0,this.pushmod=!0},Bi.prototype.empty=function(){return null==this.head},Bi.prototype.size=function(){return this.length},Bi.prototype.has=function(t){for(var e=!1,i=this.head;null!=i;){if(i.elt==t){e=!0;break}i=i.next}return e},Bi.prototype.inlined_has=function(t){for(var e=!1,i=this.head;null!=i;){if(i.elt==t){e=!0;break}i=i.next}return e},Bi.prototype.front=function(){return this.head.elt},Bi.prototype.back=function(){for(var t=this.head,e=t;null!=e;)e=(t=e).next;return t.elt},Bi.prototype.iterator_at=function(t){for(var e=this.head;0<t--&&null!=e;)e=e.next;return e},Bi.prototype.at=function(t){t=this.iterator_at(t);return null!=t?t.elt:null},Bi.prototype.__class__=Bi;var Ri=zpp_nape.util.ZNPList_ZPP_ToiEvent=function(){this.length=0,this.pushmod=!1,this.modified=!1,this.head=null};Ri.__name__=["zpp_nape","util","ZNPList_ZPP_ToiEvent"],Ri.prototype.head=null,Ri.prototype.begin=function(){return this.head},Ri.prototype.modified=null,Ri.prototype.pushmod=null,Ri.prototype.length=null,Ri.prototype.setbegin=function(t){this.head=t,this.modified=!0,this.pushmod=!0},Ri.prototype.add=function(t){null==gn.zpp_pool?e=new gn:(e=gn.zpp_pool,gn.zpp_pool=e.next,e.next=null),e.elt=t;var e=e;return e.next=this.head,this.head=e,this.modified=!0,this.length++,t},Ri.prototype.inlined_add=function(t){null==gn.zpp_pool?e=new gn:(e=gn.zpp_pool,gn.zpp_pool=e.next,e.next=null),e.elt=t;var e=e;return e.next=this.head,this.head=e,this.modified=!0,this.length++,t},Ri.prototype.addAll=function(t){for(var e=t.head;null!=e;)this.add(e.elt),e=e.next},Ri.prototype.insert=function(t,e){null==gn.zpp_pool?i=new gn:(i=gn.zpp_pool,gn.zpp_pool=i.next,i.next=null),i.elt=e;var i=i;return null==t?(i.next=this.head,this.head=i):(i.next=t.next,t.next=i),this.pushmod=this.modified=!0,this.length++,i},Ri.prototype.inlined_insert=function(t,e){null==gn.zpp_pool?i=new gn:(i=gn.zpp_pool,gn.zpp_pool=i.next,i.next=null),i.elt=e;var i=i;return null==t?(i.next=this.head,this.head=i):(i.next=t.next,t.next=i),this.pushmod=this.modified=!0,this.length++,i},Ri.prototype.pop=function(){var t=this.head;this.head=t.next,t.elt=null,t.next=gn.zpp_pool,gn.zpp_pool=t,null==this.head&&(this.pushmod=!0),this.modified=!0,this.length--},Ri.prototype.inlined_pop=function(){var t=this.head;this.head=t.next,t.elt=null,t.next=gn.zpp_pool,gn.zpp_pool=t,null==this.head&&(this.pushmod=!0),this.modified=!0,this.length--},Ri.prototype.pop_unsafe=function(){var t=this.head.elt;return this.pop(),t},Ri.prototype.inlined_pop_unsafe=function(){var t=this.head.elt;return this.pop(),t},Ri.prototype.remove=function(t){for(var e,i,n=null,r=this.head;null!=r;){if(r.elt==t){null==n?(i=(e=this.head).next,this.head=i,null==this.head&&(this.pushmod=!0)):(i=(e=n.next).next,null==(n.next=i)&&(this.pushmod=!0));var o=e;o.elt=null,o.next=gn.zpp_pool,gn.zpp_pool=o,this.modified=!0,this.length--,this.pushmod=!0;break}r=(n=r).next}},Ri.prototype.try_remove=function(t){for(var e=null,i=this.head,n=!1;null!=i;){if(i.elt==t){this.erase(e),n=!0;break}i=(e=i).next}return n},Ri.prototype.inlined_remove=function(t){for(var e,i,n=null,r=this.head;null!=r;){if(r.elt==t){null==n?(i=(e=this.head).next,this.head=i,null==this.head&&(this.pushmod=!0)):(i=(e=n.next).next,null==(n.next=i)&&(this.pushmod=!0));var o=e;o.elt=null,o.next=gn.zpp_pool,gn.zpp_pool=o,this.modified=!0,this.length--,this.pushmod=!0;break}r=(n=r).next}},Ri.prototype.inlined_try_remove=function(t){for(var e,i,n=null,r=this.head,o=!1;null!=r;){if(r.elt==t){null==n?(i=(e=this.head).next,this.head=i,null==this.head&&(this.pushmod=!0)):(i=(e=n.next).next,null==(n.next=i)&&(this.pushmod=!0));var s=e;s.elt=null,s.next=gn.zpp_pool,gn.zpp_pool=s,this.modified=!0,this.length--,o=this.pushmod=!0;break}r=(n=r).next}return o},Ri.prototype.erase=function(t){var e;null==t?(e=(i=this.head).next,this.head=e,null==this.head&&(this.pushmod=!0)):(e=(i=t.next).next,null==(t.next=e)&&(this.pushmod=!0));var i=i;return i.elt=null,i.next=gn.zpp_pool,gn.zpp_pool=i,this.modified=!0,this.length--,this.pushmod=!0,e},Ri.prototype.inlined_erase=function(t){var e;null==t?(e=(i=this.head).next,this.head=e,null==this.head&&(this.pushmod=!0)):(e=(i=t.next).next,null==(t.next=e)&&(this.pushmod=!0));var i=i;return i.elt=null,i.next=gn.zpp_pool,gn.zpp_pool=i,this.modified=!0,this.length--,this.pushmod=!0,e},Ri.prototype.splice=function(t,e){for(;0<e--&&null!=t.next;)this.erase(t);return t.next},Ri.prototype.clear=function(){for(;null!=this.head;){var t=this.head;this.head=t.next,t.elt=null,t.next=gn.zpp_pool,gn.zpp_pool=t,null==this.head&&(this.pushmod=!0),this.modified=!0,this.length--}this.pushmod=!0},Ri.prototype.inlined_clear=function(){for(;null!=this.head;){var t=this.head;this.head=t.next,t.elt=null,t.next=gn.zpp_pool,gn.zpp_pool=t,null==this.head&&(this.pushmod=!0),this.modified=!0,this.length--}this.pushmod=!0},Ri.prototype.reverse=function(){for(var t=this.head,e=null;null!=t;){var i=t.next;t.next=e,e=this.head=t,t=i}this.modified=!0,this.pushmod=!0},Ri.prototype.empty=function(){return null==this.head},Ri.prototype.size=function(){return this.length},Ri.prototype.has=function(t){for(var e=!1,i=this.head;null!=i;){if(i.elt==t){e=!0;break}i=i.next}return e},Ri.prototype.inlined_has=function(t){for(var e=!1,i=this.head;null!=i;){if(i.elt==t){e=!0;break}i=i.next}return e},Ri.prototype.front=function(){return this.head.elt},Ri.prototype.back=function(){for(var t=this.head,e=t;null!=e;)e=(t=e).next;return t.elt},Ri.prototype.iterator_at=function(t){for(var e=this.head;0<t--&&null!=e;)e=e.next;return e},Ri.prototype.at=function(t){t=this.iterator_at(t);return null!=t?t.elt:null},Ri.prototype.__class__=Ri;var Fi=zpp_nape.util.ZNPList_ConvexResult=function(){this.length=0,this.pushmod=!1,this.modified=!1,this.head=null};Fi.__name__=["zpp_nape","util","ZNPList_ConvexResult"],Fi.prototype.head=null,Fi.prototype.begin=function(){return this.head},Fi.prototype.modified=null,Fi.prototype.pushmod=null,Fi.prototype.length=null,Fi.prototype.setbegin=function(t){this.head=t,this.modified=!0,this.pushmod=!0},Fi.prototype.add=function(t){null==fn.zpp_pool?e=new fn:(e=fn.zpp_pool,fn.zpp_pool=e.next,e.next=null),e.elt=t;var e=e;return e.next=this.head,this.head=e,this.modified=!0,this.length++,t},Fi.prototype.inlined_add=function(t){null==fn.zpp_pool?e=new fn:(e=fn.zpp_pool,fn.zpp_pool=e.next,e.next=null),e.elt=t;var e=e;return e.next=this.head,this.head=e,this.modified=!0,this.length++,t},Fi.prototype.addAll=function(t){for(var e=t.head;null!=e;)this.add(e.elt),e=e.next},Fi.prototype.insert=function(t,e){null==fn.zpp_pool?i=new fn:(i=fn.zpp_pool,fn.zpp_pool=i.next,i.next=null),i.elt=e;var i=i;return null==t?(i.next=this.head,this.head=i):(i.next=t.next,t.next=i),this.pushmod=this.modified=!0,this.length++,i},Fi.prototype.inlined_insert=function(t,e){null==fn.zpp_pool?i=new fn:(i=fn.zpp_pool,fn.zpp_pool=i.next,i.next=null),i.elt=e;var i=i;return null==t?(i.next=this.head,this.head=i):(i.next=t.next,t.next=i),this.pushmod=this.modified=!0,this.length++,i},Fi.prototype.pop=function(){var t=this.head;this.head=t.next,t.elt=null,t.next=fn.zpp_pool,fn.zpp_pool=t,null==this.head&&(this.pushmod=!0),this.modified=!0,this.length--},Fi.prototype.inlined_pop=function(){var t=this.head;this.head=t.next,t.elt=null,t.next=fn.zpp_pool,fn.zpp_pool=t,null==this.head&&(this.pushmod=!0),this.modified=!0,this.length--},Fi.prototype.pop_unsafe=function(){var t=this.head.elt;return this.pop(),t},Fi.prototype.inlined_pop_unsafe=function(){var t=this.head.elt;return this.pop(),t},Fi.prototype.remove=function(t){for(var e,i,n=null,r=this.head;null!=r;){if(r.elt==t){null==n?(i=(e=this.head).next,this.head=i,null==this.head&&(this.pushmod=!0)):(i=(e=n.next).next,null==(n.next=i)&&(this.pushmod=!0));var o=e;o.elt=null,o.next=fn.zpp_pool,fn.zpp_pool=o,this.modified=!0,this.length--,this.pushmod=!0;break}r=(n=r).next}},Fi.prototype.try_remove=function(t){for(var e=null,i=this.head,n=!1;null!=i;){if(i.elt==t){this.erase(e),n=!0;break}i=(e=i).next}return n},Fi.prototype.inlined_remove=function(t){for(var e,i,n=null,r=this.head;null!=r;){if(r.elt==t){null==n?(i=(e=this.head).next,this.head=i,null==this.head&&(this.pushmod=!0)):(i=(e=n.next).next,null==(n.next=i)&&(this.pushmod=!0));var o=e;o.elt=null,o.next=fn.zpp_pool,fn.zpp_pool=o,this.modified=!0,this.length--,this.pushmod=!0;break}r=(n=r).next}},Fi.prototype.inlined_try_remove=function(t){for(var e,i,n=null,r=this.head,o=!1;null!=r;){if(r.elt==t){null==n?(i=(e=this.head).next,this.head=i,null==this.head&&(this.pushmod=!0)):(i=(e=n.next).next,null==(n.next=i)&&(this.pushmod=!0));var s=e;s.elt=null,s.next=fn.zpp_pool,fn.zpp_pool=s,this.modified=!0,this.length--,o=this.pushmod=!0;break}r=(n=r).next}return o},Fi.prototype.erase=function(t){var e;null==t?(e=(i=this.head).next,this.head=e,null==this.head&&(this.pushmod=!0)):(e=(i=t.next).next,null==(t.next=e)&&(this.pushmod=!0));var i=i;return i.elt=null,i.next=fn.zpp_pool,fn.zpp_pool=i,this.modified=!0,this.length--,this.pushmod=!0,e},Fi.prototype.inlined_erase=function(t){var e;null==t?(e=(i=this.head).next,this.head=e,null==this.head&&(this.pushmod=!0)):(e=(i=t.next).next,null==(t.next=e)&&(this.pushmod=!0));var i=i;return i.elt=null,i.next=fn.zpp_pool,fn.zpp_pool=i,this.modified=!0,this.length--,this.pushmod=!0,e},Fi.prototype.splice=function(t,e){for(;0<e--&&null!=t.next;)this.erase(t);return t.next},Fi.prototype.clear=function(){for(;null!=this.head;){var t=this.head;this.head=t.next,t.elt=null,t.next=fn.zpp_pool,fn.zpp_pool=t,null==this.head&&(this.pushmod=!0),this.modified=!0,this.length--}this.pushmod=!0},Fi.prototype.inlined_clear=function(){for(;null!=this.head;){var t=this.head;this.head=t.next,t.elt=null,t.next=fn.zpp_pool,fn.zpp_pool=t,null==this.head&&(this.pushmod=!0),this.modified=!0,this.length--}this.pushmod=!0},Fi.prototype.reverse=function(){for(var t=this.head,e=null;null!=t;){var i=t.next;t.next=e,e=this.head=t,t=i}this.modified=!0,this.pushmod=!0},Fi.prototype.empty=function(){return null==this.head},Fi.prototype.size=function(){return this.length},Fi.prototype.has=function(t){for(var e=!1,i=this.head;null!=i;){if(i.elt==t){e=!0;break}i=i.next}return e},Fi.prototype.inlined_has=function(t){for(var e=!1,i=this.head;null!=i;){if(i.elt==t){e=!0;break}i=i.next}return e},Fi.prototype.front=function(){return this.head.elt},Fi.prototype.back=function(){for(var t=this.head,e=t;null!=e;)e=(t=e).next;return t.elt},Fi.prototype.iterator_at=function(t){for(var e=this.head;0<t--&&null!=e;)e=e.next;return e},Fi.prototype.at=function(t){t=this.iterator_at(t);return null!=t?t.elt:null},Fi.prototype.__class__=Fi;var Ni=zpp_nape.util.ZNPList_ZPP_GeomPoly=function(){this.length=0,this.pushmod=!1,this.modified=!1,this.head=null};Ni.__name__=["zpp_nape","util","ZNPList_ZPP_GeomPoly"],Ni.prototype.head=null,Ni.prototype.begin=function(){return this.head},Ni.prototype.modified=null,Ni.prototype.pushmod=null,Ni.prototype.length=null,Ni.prototype.setbegin=function(t){this.head=t,this.modified=!0,this.pushmod=!0},Ni.prototype.add=function(t){null==xn.zpp_pool?e=new xn:(e=xn.zpp_pool,xn.zpp_pool=e.next,e.next=null),e.elt=t;var e=e;return e.next=this.head,this.head=e,this.modified=!0,this.length++,t},Ni.prototype.inlined_add=function(t){null==xn.zpp_pool?e=new xn:(e=xn.zpp_pool,xn.zpp_pool=e.next,e.next=null),e.elt=t;var e=e;return e.next=this.head,this.head=e,this.modified=!0,this.length++,t},Ni.prototype.addAll=function(t){for(var e=t.head;null!=e;)this.add(e.elt),e=e.next},Ni.prototype.insert=function(t,e){null==xn.zpp_pool?i=new xn:(i=xn.zpp_pool,xn.zpp_pool=i.next,i.next=null),i.elt=e;var i=i;return null==t?(i.next=this.head,this.head=i):(i.next=t.next,t.next=i),this.pushmod=this.modified=!0,this.length++,i},Ni.prototype.inlined_insert=function(t,e){null==xn.zpp_pool?i=new xn:(i=xn.zpp_pool,xn.zpp_pool=i.next,i.next=null),i.elt=e;var i=i;return null==t?(i.next=this.head,this.head=i):(i.next=t.next,t.next=i),this.pushmod=this.modified=!0,this.length++,i},Ni.prototype.pop=function(){var t=this.head;this.head=t.next,t.elt=null,t.next=xn.zpp_pool,xn.zpp_pool=t,null==this.head&&(this.pushmod=!0),this.modified=!0,this.length--},Ni.prototype.inlined_pop=function(){var t=this.head;this.head=t.next,t.elt=null,t.next=xn.zpp_pool,xn.zpp_pool=t,null==this.head&&(this.pushmod=!0),this.modified=!0,this.length--},Ni.prototype.pop_unsafe=function(){var t=this.head.elt;return this.pop(),t},Ni.prototype.inlined_pop_unsafe=function(){var t=this.head.elt;return this.pop(),t},Ni.prototype.remove=function(t){for(var e,i,n=null,r=this.head;null!=r;){if(r.elt==t){null==n?(i=(e=this.head).next,this.head=i,null==this.head&&(this.pushmod=!0)):(i=(e=n.next).next,null==(n.next=i)&&(this.pushmod=!0));var o=e;o.elt=null,o.next=xn.zpp_pool,xn.zpp_pool=o,this.modified=!0,this.length--,this.pushmod=!0;break}r=(n=r).next}},Ni.prototype.try_remove=function(t){for(var e=null,i=this.head,n=!1;null!=i;){if(i.elt==t){this.erase(e),n=!0;break}i=(e=i).next}return n},Ni.prototype.inlined_remove=function(t){for(var e,i,n=null,r=this.head;null!=r;){if(r.elt==t){null==n?(i=(e=this.head).next,this.head=i,null==this.head&&(this.pushmod=!0)):(i=(e=n.next).next,null==(n.next=i)&&(this.pushmod=!0));var o=e;o.elt=null,o.next=xn.zpp_pool,xn.zpp_pool=o,this.modified=!0,this.length--,this.pushmod=!0;break}r=(n=r).next}},Ni.prototype.inlined_try_remove=function(t){for(var e,i,n=null,r=this.head,o=!1;null!=r;){if(r.elt==t){null==n?(i=(e=this.head).next,this.head=i,null==this.head&&(this.pushmod=!0)):(i=(e=n.next).next,null==(n.next=i)&&(this.pushmod=!0));var s=e;s.elt=null,s.next=xn.zpp_pool,xn.zpp_pool=s,this.modified=!0,this.length--,o=this.pushmod=!0;break}r=(n=r).next}return o},Ni.prototype.erase=function(t){var e;null==t?(e=(i=this.head).next,this.head=e,null==this.head&&(this.pushmod=!0)):(e=(i=t.next).next,null==(t.next=e)&&(this.pushmod=!0));var i=i;return i.elt=null,i.next=xn.zpp_pool,xn.zpp_pool=i,this.modified=!0,this.length--,this.pushmod=!0,e},Ni.prototype.inlined_erase=function(t){var e;null==t?(e=(i=this.head).next,this.head=e,null==this.head&&(this.pushmod=!0)):(e=(i=t.next).next,null==(t.next=e)&&(this.pushmod=!0));var i=i;return i.elt=null,i.next=xn.zpp_pool,xn.zpp_pool=i,this.modified=!0,this.length--,this.pushmod=!0,e},Ni.prototype.splice=function(t,e){for(;0<e--&&null!=t.next;)this.erase(t);return t.next},Ni.prototype.clear=function(){for(;null!=this.head;){var t=this.head;this.head=t.next,t.elt=null,t.next=xn.zpp_pool,xn.zpp_pool=t,null==this.head&&(this.pushmod=!0),this.modified=!0,this.length--}this.pushmod=!0},Ni.prototype.inlined_clear=function(){for(;null!=this.head;){var t=this.head;this.head=t.next,t.elt=null,t.next=xn.zpp_pool,xn.zpp_pool=t,null==this.head&&(this.pushmod=!0),this.modified=!0,this.length--}this.pushmod=!0},Ni.prototype.reverse=function(){for(var t=this.head,e=null;null!=t;){var i=t.next;t.next=e,e=this.head=t,t=i}this.modified=!0,this.pushmod=!0},Ni.prototype.empty=function(){return null==this.head},Ni.prototype.size=function(){return this.length},Ni.prototype.has=function(t){for(var e=!1,i=this.head;null!=i;){if(i.elt==t){e=!0;break}i=i.next}return e},Ni.prototype.inlined_has=function(t){for(var e=!1,i=this.head;null!=i;){if(i.elt==t){e=!0;break}i=i.next}return e},Ni.prototype.front=function(){return this.head.elt},Ni.prototype.back=function(){for(var t=this.head,e=t;null!=e;)e=(t=e).next;return t.elt},Ni.prototype.iterator_at=function(t){for(var e=this.head;0<t--&&null!=e;)e=e.next;return e},Ni.prototype.at=function(t){t=this.iterator_at(t);return null!=t?t.elt:null},Ni.prototype.__class__=Ni;var ji=zpp_nape.util.ZNPList_RayResult=function(){this.length=0,this.pushmod=!1,this.modified=!1,this.head=null};ji.__name__=["zpp_nape","util","ZNPList_RayResult"],ji.prototype.head=null,ji.prototype.begin=function(){return this.head},ji.prototype.modified=null,ji.prototype.pushmod=null,ji.prototype.length=null,ji.prototype.setbegin=function(t){this.head=t,this.modified=!0,this.pushmod=!0},ji.prototype.add=function(t){null==vn.zpp_pool?e=new vn:(e=vn.zpp_pool,vn.zpp_pool=e.next,e.next=null),e.elt=t;var e=e;return e.next=this.head,this.head=e,this.modified=!0,this.length++,t},ji.prototype.inlined_add=function(t){null==vn.zpp_pool?e=new vn:(e=vn.zpp_pool,vn.zpp_pool=e.next,e.next=null),e.elt=t;var e=e;return e.next=this.head,this.head=e,this.modified=!0,this.length++,t},ji.prototype.addAll=function(t){for(var e=t.head;null!=e;)this.add(e.elt),e=e.next},ji.prototype.insert=function(t,e){null==vn.zpp_pool?i=new vn:(i=vn.zpp_pool,vn.zpp_pool=i.next,i.next=null),i.elt=e;var i=i;return null==t?(i.next=this.head,this.head=i):(i.next=t.next,t.next=i),this.pushmod=this.modified=!0,this.length++,i},ji.prototype.inlined_insert=function(t,e){null==vn.zpp_pool?i=new vn:(i=vn.zpp_pool,vn.zpp_pool=i.next,i.next=null),i.elt=e;var i=i;return null==t?(i.next=this.head,this.head=i):(i.next=t.next,t.next=i),this.pushmod=this.modified=!0,this.length++,i},ji.prototype.pop=function(){var t=this.head;this.head=t.next,t.elt=null,t.next=vn.zpp_pool,vn.zpp_pool=t,null==this.head&&(this.pushmod=!0),this.modified=!0,this.length--},ji.prototype.inlined_pop=function(){var t=this.head;this.head=t.next,t.elt=null,t.next=vn.zpp_pool,vn.zpp_pool=t,null==this.head&&(this.pushmod=!0),this.modified=!0,this.length--},ji.prototype.pop_unsafe=function(){var t=this.head.elt;return this.pop(),t},ji.prototype.inlined_pop_unsafe=function(){var t=this.head.elt;return this.pop(),t},ji.prototype.remove=function(t){for(var e,i,n=null,r=this.head;null!=r;){if(r.elt==t){null==n?(i=(e=this.head).next,this.head=i,null==this.head&&(this.pushmod=!0)):(i=(e=n.next).next,null==(n.next=i)&&(this.pushmod=!0));var o=e;o.elt=null,o.next=vn.zpp_pool,vn.zpp_pool=o,this.modified=!0,this.length--,this.pushmod=!0;break}r=(n=r).next}},ji.prototype.try_remove=function(t){for(var e=null,i=this.head,n=!1;null!=i;){if(i.elt==t){this.erase(e),n=!0;break}i=(e=i).next}return n},ji.prototype.inlined_remove=function(t){for(var e,i,n=null,r=this.head;null!=r;){if(r.elt==t){null==n?(i=(e=this.head).next,this.head=i,null==this.head&&(this.pushmod=!0)):(i=(e=n.next).next,null==(n.next=i)&&(this.pushmod=!0));var o=e;o.elt=null,o.next=vn.zpp_pool,vn.zpp_pool=o,this.modified=!0,this.length--,this.pushmod=!0;break}r=(n=r).next}},ji.prototype.inlined_try_remove=function(t){for(var e,i,n=null,r=this.head,o=!1;null!=r;){if(r.elt==t){null==n?(i=(e=this.head).next,this.head=i,null==this.head&&(this.pushmod=!0)):(i=(e=n.next).next,null==(n.next=i)&&(this.pushmod=!0));var s=e;s.elt=null,s.next=vn.zpp_pool,vn.zpp_pool=s,this.modified=!0,this.length--,o=this.pushmod=!0;break}r=(n=r).next}return o},ji.prototype.erase=function(t){var e;null==t?(e=(i=this.head).next,this.head=e,null==this.head&&(this.pushmod=!0)):(e=(i=t.next).next,null==(t.next=e)&&(this.pushmod=!0));var i=i;return i.elt=null,i.next=vn.zpp_pool,vn.zpp_pool=i,this.modified=!0,this.length--,this.pushmod=!0,e},ji.prototype.inlined_erase=function(t){var e;null==t?(e=(i=this.head).next,this.head=e,null==this.head&&(this.pushmod=!0)):(e=(i=t.next).next,null==(t.next=e)&&(this.pushmod=!0));var i=i;return i.elt=null,i.next=vn.zpp_pool,vn.zpp_pool=i,this.modified=!0,this.length--,this.pushmod=!0,e},ji.prototype.splice=function(t,e){for(;0<e--&&null!=t.next;)this.erase(t);return t.next},ji.prototype.clear=function(){for(;null!=this.head;){var t=this.head;this.head=t.next,t.elt=null,t.next=vn.zpp_pool,vn.zpp_pool=t,null==this.head&&(this.pushmod=!0),this.modified=!0,this.length--}this.pushmod=!0},ji.prototype.inlined_clear=function(){for(;null!=this.head;){var t=this.head;this.head=t.next,t.elt=null,t.next=vn.zpp_pool,vn.zpp_pool=t,null==this.head&&(this.pushmod=!0),this.modified=!0,this.length--}this.pushmod=!0},ji.prototype.reverse=function(){for(var t=this.head,e=null;null!=t;){var i=t.next;t.next=e,e=this.head=t,t=i}this.modified=!0,this.pushmod=!0},ji.prototype.empty=function(){return null==this.head},ji.prototype.size=function(){return this.length},ji.prototype.has=function(t){for(var e=!1,i=this.head;null!=i;){if(i.elt==t){e=!0;break}i=i.next}return e},ji.prototype.inlined_has=function(t){for(var e=!1,i=this.head;null!=i;){if(i.elt==t){e=!0;break}i=i.next}return e},ji.prototype.front=function(){return this.head.elt},ji.prototype.back=function(){for(var t=this.head,e=t;null!=e;)e=(t=e).next;return t.elt},ji.prototype.iterator_at=function(t){for(var e=this.head;0<t--&&null!=e;)e=e.next;return e},ji.prototype.at=function(t){t=this.iterator_at(t);return null!=t?t.elt:null},ji.prototype.__class__=ji;var Ui=zpp_nape.util.ZNPNode_ZPP_CbType=function(){this.elt=null,this.next=null};Ui.__name__=["zpp_nape","util","ZNPNode_ZPP_CbType"],Ui.prototype.next=null,Ui.prototype.alloc=function(){},Ui.prototype.free=function(){this.elt=null},Ui.prototype.elt=null,Ui.prototype.elem=function(){return this.elt},Ui.prototype.__class__=Ui;var Vi=zpp_nape.util.ZNPNode_ZPP_CallbackSet=function(){this.elt=null,this.next=null};Vi.__name__=["zpp_nape","util","ZNPNode_ZPP_CallbackSet"],Vi.prototype.next=null,Vi.prototype.alloc=function(){},Vi.prototype.free=function(){this.elt=null},Vi.prototype.elt=null,Vi.prototype.elem=function(){return this.elt},Vi.prototype.__class__=Vi;var Wi=zpp_nape.util.ZNPNode_ZPP_Shape=function(){this.elt=null,this.next=null};Wi.__name__=["zpp_nape","util","ZNPNode_ZPP_Shape"],Wi.prototype.next=null,Wi.prototype.alloc=function(){},Wi.prototype.free=function(){this.elt=null},Wi.prototype.elt=null,Wi.prototype.elem=function(){return this.elt},Wi.prototype.__class__=Wi;var Xi=zpp_nape.util.ZNPNode_ZPP_Body=function(){this.elt=null,this.next=null};Xi.__name__=["zpp_nape","util","ZNPNode_ZPP_Body"],Xi.prototype.next=null,Xi.prototype.alloc=function(){},Xi.prototype.free=function(){this.elt=null},Xi.prototype.elt=null,Xi.prototype.elem=function(){return this.elt},Xi.prototype.__class__=Xi;var Hi=zpp_nape.util.ZNPNode_ZPP_Constraint=function(){this.elt=null,this.next=null};Hi.__name__=["zpp_nape","util","ZNPNode_ZPP_Constraint"],Hi.prototype.next=null,Hi.prototype.alloc=function(){},Hi.prototype.free=function(){this.elt=null},Hi.prototype.elt=null,Hi.prototype.elem=function(){return this.elt},Hi.prototype.__class__=Hi;var qi=zpp_nape.util.ZNPNode_ZPP_Compound=function(){this.elt=null,this.next=null};qi.__name__=["zpp_nape","util","ZNPNode_ZPP_Compound"],qi.prototype.next=null,qi.prototype.alloc=function(){},qi.prototype.free=function(){this.elt=null},qi.prototype.elt=null,qi.prototype.elem=function(){return this.elt},qi.prototype.__class__=qi;var er=zpp_nape.util.ZNPNode_ZPP_Arbiter=function(){this.elt=null,this.next=null};er.__name__=["zpp_nape","util","ZNPNode_ZPP_Arbiter"],er.prototype.next=null,er.prototype.alloc=function(){},er.prototype.free=function(){this.elt=null},er.prototype.elt=null,er.prototype.elem=function(){return this.elt},er.prototype.__class__=er;var ir=zpp_nape.util.ZNPNode_ZPP_InteractionListener=function(){this.elt=null,this.next=null};ir.__name__=["zpp_nape","util","ZNPNode_ZPP_InteractionListener"],ir.prototype.next=null,ir.prototype.alloc=function(){},ir.prototype.free=function(){this.elt=null},ir.prototype.elt=null,ir.prototype.elem=function(){return this.elt},ir.prototype.__class__=ir;var Yi=zpp_nape.util.ZNPNode_ZPP_CbSet=function(){this.elt=null,this.next=null};Yi.__name__=["zpp_nape","util","ZNPNode_ZPP_CbSet"],Yi.prototype.next=null,Yi.prototype.alloc=function(){},Yi.prototype.free=function(){this.elt=null},Yi.prototype.elt=null,Yi.prototype.elem=function(){return this.elt},Yi.prototype.__class__=Yi;var nr=zpp_nape.util.ZNPNode_ZPP_Interactor=function(){this.elt=null,this.next=null};nr.__name__=["zpp_nape","util","ZNPNode_ZPP_Interactor"],nr.prototype.next=null,nr.prototype.alloc=function(){},nr.prototype.free=function(){this.elt=null},nr.prototype.elt=null,nr.prototype.elem=function(){return this.elt},nr.prototype.__class__=nr;var Ki=zpp_nape.util.ZNPNode_ZPP_BodyListener=function(){this.elt=null,this.next=null};Ki.__name__=["zpp_nape","util","ZNPNode_ZPP_BodyListener"],Ki.prototype.next=null,Ki.prototype.alloc=function(){},Ki.prototype.free=function(){this.elt=null},Ki.prototype.elt=null,Ki.prototype.elem=function(){return this.elt},Ki.prototype.__class__=Ki;var Zi=zpp_nape.util.ZNPNode_ZPP_CbSetPair=function(){this.elt=null,this.next=null};Zi.__name__=["zpp_nape","util","ZNPNode_ZPP_CbSetPair"],Zi.prototype.next=null,Zi.prototype.alloc=function(){},Zi.prototype.free=function(){this.elt=null},Zi.prototype.elt=null,Zi.prototype.elem=function(){return this.elt},Zi.prototype.__class__=Zi;var Ji=zpp_nape.util.ZNPNode_ZPP_ConstraintListener=function(){this.elt=null,this.next=null};Ji.__name__=["zpp_nape","util","ZNPNode_ZPP_ConstraintListener"],Ji.prototype.next=null,Ji.prototype.alloc=function(){},Ji.prototype.free=function(){this.elt=null},Ji.prototype.elt=null,Ji.prototype.elem=function(){return this.elt},Ji.prototype.__class__=Ji;var Qi=zpp_nape.util.ZNPNode_ZPP_CutInt=function(){this.elt=null,this.next=null};Qi.__name__=["zpp_nape","util","ZNPNode_ZPP_CutInt"],Qi.prototype.next=null,Qi.prototype.alloc=function(){},Qi.prototype.free=function(){this.elt=null},Qi.prototype.elt=null,Qi.prototype.elem=function(){return this.elt},Qi.prototype.__class__=Qi;var $i=zpp_nape.util.ZNPNode_ZPP_CutVert=function(){this.elt=null,this.next=null};$i.__name__=["zpp_nape","util","ZNPNode_ZPP_CutVert"],$i.prototype.next=null,$i.prototype.alloc=function(){},$i.prototype.free=function(){this.elt=null},$i.prototype.elt=null,$i.prototype.elem=function(){return this.elt},$i.prototype.__class__=$i;var tn=zpp_nape.util.ZNPNode_ZPP_PartitionVertex=function(){this.elt=null,this.next=null};tn.__name__=["zpp_nape","util","ZNPNode_ZPP_PartitionVertex"],tn.prototype.next=null,tn.prototype.alloc=function(){},tn.prototype.free=function(){this.elt=null},tn.prototype.elt=null,tn.prototype.elem=function(){return this.elt},tn.prototype.__class__=tn;var en=zpp_nape.util.ZNPNode_ZPP_SimplifyP=function(){this.elt=null,this.next=null};en.__name__=["zpp_nape","util","ZNPNode_ZPP_SimplifyP"],en.prototype.next=null,en.prototype.alloc=function(){},en.prototype.free=function(){this.elt=null},en.prototype.elt=null,en.prototype.elem=function(){return this.elt},en.prototype.__class__=en;var sn=zpp_nape.util.ZNPNode_ZPP_PartitionedPoly=function(){this.elt=null,this.next=null};sn.__name__=["zpp_nape","util","ZNPNode_ZPP_PartitionedPoly"],sn.prototype.next=null,sn.prototype.alloc=function(){},sn.prototype.free=function(){this.elt=null},sn.prototype.elt=null,sn.prototype.elem=function(){return this.elt},sn.prototype.__class__=sn;var an=zpp_nape.util.ZNPNode_ZPP_GeomVert=function(){this.elt=null,this.next=null};an.__name__=["zpp_nape","util","ZNPNode_ZPP_GeomVert"],an.prototype.next=null,an.prototype.alloc=function(){},an.prototype.free=function(){this.elt=null},an.prototype.elt=null,an.prototype.elem=function(){return this.elt},an.prototype.__class__=an;var hn=zpp_nape.util.ZNPNode_ZPP_SimpleVert=function(){this.elt=null,this.next=null};hn.__name__=["zpp_nape","util","ZNPNode_ZPP_SimpleVert"],hn.prototype.next=null,hn.prototype.alloc=function(){},hn.prototype.free=function(){this.elt=null},hn.prototype.elt=null,hn.prototype.elem=function(){return this.elt},hn.prototype.__class__=hn;var ln=zpp_nape.util.ZNPNode_ZPP_SimpleEvent=function(){this.elt=null,this.next=null};ln.__name__=["zpp_nape","util","ZNPNode_ZPP_SimpleEvent"],ln.prototype.next=null,ln.prototype.alloc=function(){},ln.prototype.free=function(){this.elt=null},ln.prototype.elt=null,ln.prototype.elem=function(){return this.elt},ln.prototype.__class__=ln;var pn=zpp_nape.util.ZNPNode_ZPP_Vec2=function(){this.elt=null,this.next=null};pn.__name__=["zpp_nape","util","ZNPNode_ZPP_Vec2"],pn.prototype.next=null,pn.prototype.alloc=function(){},pn.prototype.free=function(){this.elt=null},pn.prototype.elt=null,pn.prototype.elem=function(){return this.elt},pn.prototype.__class__=pn;var un=zpp_nape.util.ZNPNode_ZPP_AABBPair=function(){this.elt=null,this.next=null};un.__name__=["zpp_nape","util","ZNPNode_ZPP_AABBPair"],un.prototype.next=null,un.prototype.alloc=function(){},un.prototype.free=function(){this.elt=null},un.prototype.elt=null,un.prototype.elem=function(){return this.elt},un.prototype.__class__=un;var dn=zpp_nape.util.ZNPNode_ZPP_Edge=function(){this.elt=null,this.next=null};dn.__name__=["zpp_nape","util","ZNPNode_ZPP_Edge"],dn.prototype.next=null,dn.prototype.alloc=function(){},dn.prototype.free=function(){this.elt=null},dn.prototype.elt=null,dn.prototype.elem=function(){return this.elt},dn.prototype.__class__=dn;var cn=zpp_nape.util.ZNPNode_ZPP_AABBNode=function(){this.elt=null,this.next=null};cn.__name__=["zpp_nape","util","ZNPNode_ZPP_AABBNode"],cn.prototype.next=null,cn.prototype.alloc=function(){},cn.prototype.free=function(){this.elt=null},cn.prototype.elt=null,cn.prototype.elem=function(){return this.elt},cn.prototype.__class__=cn;var yn=zpp_nape.util.ZNPNode_ZPP_Component=function(){this.elt=null,this.next=null};yn.__name__=["zpp_nape","util","ZNPNode_ZPP_Component"],yn.prototype.next=null,yn.prototype.alloc=function(){},yn.prototype.free=function(){this.elt=null},yn.prototype.elt=null,yn.prototype.elem=function(){return this.elt},yn.prototype.__class__=yn;var rr=zpp_nape.util.ZNPNode_ZPP_FluidArbiter=function(){this.elt=null,this.next=null};rr.__name__=["zpp_nape","util","ZNPNode_ZPP_FluidArbiter"],rr.prototype.next=null,rr.prototype.alloc=function(){},rr.prototype.free=function(){this.elt=null},rr.prototype.elt=null,rr.prototype.elem=function(){return this.elt},rr.prototype.__class__=rr;var or=zpp_nape.util.ZNPNode_ZPP_SensorArbiter=function(){this.elt=null,this.next=null};or.__name__=["zpp_nape","util","ZNPNode_ZPP_SensorArbiter"],or.prototype.next=null,or.prototype.alloc=function(){},or.prototype.free=function(){this.elt=null},or.prototype.elt=null,or.prototype.elem=function(){return this.elt},or.prototype.__class__=or;var _n=zpp_nape.util.ZNPNode_ZPP_Listener=function(){this.elt=null,this.next=null};_n.__name__=["zpp_nape","util","ZNPNode_ZPP_Listener"],_n.prototype.next=null,_n.prototype.alloc=function(){},_n.prototype.free=function(){this.elt=null},_n.prototype.elt=null,_n.prototype.elem=function(){return this.elt},_n.prototype.__class__=_n;var sr=zpp_nape.util.ZNPNode_ZPP_ColArbiter=function(){this.elt=null,this.next=null};sr.__name__=["zpp_nape","util","ZNPNode_ZPP_ColArbiter"],sr.prototype.next=null,sr.prototype.alloc=function(){},sr.prototype.free=function(){this.elt=null},sr.prototype.elt=null,sr.prototype.elem=function(){return this.elt},sr.prototype.__class__=sr;var mn=zpp_nape.util.ZNPNode_ZPP_InteractionGroup=function(){this.elt=null,this.next=null};mn.__name__=["zpp_nape","util","ZNPNode_ZPP_InteractionGroup"],mn.prototype.next=null,mn.prototype.alloc=function(){},mn.prototype.free=function(){this.elt=null},mn.prototype.elt=null,mn.prototype.elem=function(){return this.elt},mn.prototype.__class__=mn;var gn=zpp_nape.util.ZNPNode_ZPP_ToiEvent=function(){this.elt=null,this.next=null};gn.__name__=["zpp_nape","util","ZNPNode_ZPP_ToiEvent"],gn.prototype.next=null,gn.prototype.alloc=function(){},gn.prototype.free=function(){this.elt=null},gn.prototype.elt=null,gn.prototype.elem=function(){return this.elt},gn.prototype.__class__=gn;var fn=zpp_nape.util.ZNPNode_ConvexResult=function(){this.elt=null,this.next=null};fn.__name__=["zpp_nape","util","ZNPNode_ConvexResult"],fn.prototype.next=null,fn.prototype.alloc=function(){},fn.prototype.free=function(){this.elt=null},fn.prototype.elt=null,fn.prototype.elem=function(){return this.elt},fn.prototype.__class__=fn;var xn=zpp_nape.util.ZNPNode_ZPP_GeomPoly=function(){this.elt=null,this.next=null};xn.__name__=["zpp_nape","util","ZNPNode_ZPP_GeomPoly"],xn.prototype.next=null,xn.prototype.alloc=function(){},xn.prototype.free=function(){this.elt=null},xn.prototype.elt=null,xn.prototype.elem=function(){return this.elt},xn.prototype.__class__=xn;var vn=zpp_nape.util.ZNPNode_RayResult=function(){this.elt=null,this.next=null};vn.__name__=["zpp_nape","util","ZNPNode_RayResult"],vn.prototype.next=null,vn.prototype.alloc=function(){},vn.prototype.free=function(){this.elt=null},vn.prototype.elt=null,vn.prototype.elem=function(){return this.elt},vn.prototype.__class__=vn;var wn=zpp_nape.util.ZPP_MixVec2List=function(){this.at_index=0,this.at_ite=null,this.zip_length=!1,this._length=0,this.inner=null,Y.call(this),this.at_ite=null,this.at_index=0,this.zip_length=!0,this._length=0};wn.__name__=["zpp_nape","util","ZPP_MixVec2List"],wn.__super__=Y,wn.prototype=Object.create(Y.prototype),wn.get=function(t,e){null==e&&(e=!1);var i=new wn;return i.inner=t,i.zpp_inner.immutable=e,i},wn.prototype.inner=null,wn.prototype._length=null,wn.prototype.zip_length=null,wn.prototype.at_ite=null,wn.prototype.at_index=null,wn.prototype.zpp_gl=function(){if(this.zpp_vm(),this.zip_length){this._length=0;for(var t=this.inner.next;null!=t;)this._length++,t=t.next;this.zip_length=!1}return this._length},wn.prototype.zpp_vm=function(){this.zpp_inner.validate(),this.inner.modified&&(this.zip_length=!0,this._length=0,this.at_ite=null)},wn.prototype.at=function(t){if(this.zpp_vm(),(t=this.zpp_inner.reverse_flag?this.zpp_gl()-1-t:t)<this.at_index||null==this.at_ite)for(this.at_index=0,this.at_ite=this.inner.next;;)break;for(;this.at_index!=t;)for(this.at_index++,this.at_ite=this.at_ite.next;;)break;var e,i=this.at_ite;return null==i.outer&&(i.outer=new St,null!=(e=i.outer.zpp_inner).outer&&(e.outer.zpp_inner=null,e.outer=null),e._isimmutable=null,e._validate=null,e._invalidate=null,e.next=Gr.zpp_pool,Gr.zpp_pool=e,i.outer.zpp_inner=i),i.outer},wn.prototype.push=function(t){this.zpp_inner.modify_test(),this.zpp_vm();var e=null==this.zpp_inner.adder||this.zpp_inner.adder(t);return e&&(this.zpp_inner.reverse_flag?this.inner.add(t.zpp_inner):this.inner.insert(this.inner.iterator_at(this.zpp_gl()-1),t.zpp_inner),this.zpp_inner.invalidate(),null!=this.zpp_inner.post_adder&&this.zpp_inner.post_adder(t)),e},wn.prototype.unshift=function(t){this.zpp_inner.modify_test(),this.zpp_vm();var e=null==this.zpp_inner.adder||this.zpp_inner.adder(t);return e&&(this.zpp_inner.reverse_flag?this.inner.insert(this.inner.iterator_at(this.zpp_gl()-1),t.zpp_inner):this.inner.add(t.zpp_inner),this.zpp_inner.invalidate(),null!=this.zpp_inner.post_adder&&this.zpp_inner.post_adder(t)),e},wn.prototype.pop=function(){this.zpp_inner.modify_test(),this.zpp_vm();var t,e,i,n=null;return this.zpp_inner.reverse_flag?(null==(n=this.inner.next).outer&&(n.outer=new St,null!=(t=n.outer.zpp_inner).outer&&(t.outer.zpp_inner=null,t.outer=null),t._isimmutable=null,t._validate=null,t._invalidate=null,t.next=Gr.zpp_pool,Gr.zpp_pool=t,n.outer.zpp_inner=n),t=n.outer,null!=this.zpp_inner.subber&&this.zpp_inner.subber(t),this.zpp_inner.dontremove||this.inner.pop()):(null!=this.at_ite&&null==this.at_ite.next&&(this.at_ite=null),null==(n=(null==(i=1==this.zpp_gl()?null:this.inner.iterator_at(this.zpp_gl()-2))?this.inner:i).next).outer&&(n.outer=new St,null!=(e=n.outer.zpp_inner).outer&&(e.outer.zpp_inner=null,e.outer=null),e._isimmutable=null,e._validate=null,e._invalidate=null,e.next=Gr.zpp_pool,Gr.zpp_pool=e,n.outer.zpp_inner=n),e=n.outer,null!=this.zpp_inner.subber&&this.zpp_inner.subber(e),this.zpp_inner.dontremove||this.inner.erase(i)),this.zpp_inner.invalidate(),null==n.outer&&(n.outer=new St,null!=(i=n.outer.zpp_inner).outer&&(i.outer.zpp_inner=null,i.outer=null),i._isimmutable=null,i._validate=null,i._invalidate=null,i.next=Gr.zpp_pool,Gr.zpp_pool=i,n.outer.zpp_inner=n),n.outer},wn.prototype.shift=function(){this.zpp_inner.modify_test(),this.zpp_vm();var t,e,i,n=null;return this.zpp_inner.reverse_flag?(null!=this.at_ite&&null==this.at_ite.next&&(this.at_ite=null),null==(n=(null==(t=1==this.zpp_gl()?null:this.inner.iterator_at(this.zpp_gl()-2))?this.inner:t).next).outer&&(n.outer=new St,null!=(e=n.outer.zpp_inner).outer&&(e.outer.zpp_inner=null,e.outer=null),e._isimmutable=null,e._validate=null,e._invalidate=null,e.next=Gr.zpp_pool,Gr.zpp_pool=e,n.outer.zpp_inner=n),e=n.outer,null!=this.zpp_inner.subber&&this.zpp_inner.subber(e),this.zpp_inner.dontremove||this.inner.erase(t)):(null==(n=this.inner.next).outer&&(n.outer=new St,null!=(i=n.outer.zpp_inner).outer&&(i.outer.zpp_inner=null,i.outer=null),i._isimmutable=null,i._validate=null,i._invalidate=null,i.next=Gr.zpp_pool,Gr.zpp_pool=i,n.outer.zpp_inner=n),i=n.outer,null!=this.zpp_inner.subber&&this.zpp_inner.subber(i),this.zpp_inner.dontremove||this.inner.pop()),this.zpp_inner.invalidate(),null==n.outer&&(n.outer=new St,null!=(i=n.outer.zpp_inner).outer&&(i.outer.zpp_inner=null,i.outer=null),i._isimmutable=null,i._validate=null,i._invalidate=null,i.next=Gr.zpp_pool,Gr.zpp_pool=i,n.outer.zpp_inner=n),n.outer},wn.prototype.remove=function(t){this.zpp_inner.modify_test(),this.zpp_vm();for(var e=!1,i=this.inner.next;null!=i;){if(t.zpp_inner==i){e=!0;break}i=i.next}return e&&(null!=this.zpp_inner.subber&&this.zpp_inner.subber(t),this.zpp_inner.dontremove||this.inner.remove(t.zpp_inner),this.zpp_inner.invalidate()),e},wn.prototype.clear=function(){if(this.zpp_inner.reverse_flag)for(;!this.empty();)this.pop();else for(;!this.empty();)this.shift()},wn.prototype.__class__=wn;var zn=zpp_nape.util.ZPP_ConstraintList=function(){this.user_length=0,this.zip_length=!1,this.push_ite=null,this.at_ite=null,this.at_index=0,this.reverse_flag=!1,this.dontremove=!1,this.subber=null,this.post_adder=null,this.adder=null,this._modifiable=null,this._validate=null,this._invalidate=null,this._invalidated=!1,this.immutable=!1,this.inner=null,this.outer=null,this.inner=new Ct,this._invalidated=!0};zn.__name__=["zpp_nape","util","ZPP_ConstraintList"],zn.get=function(t,e){null==e&&(e=!1);var i=new b;return i.zpp_inner.inner=t,e&&(i.zpp_inner.immutable=!0),i.zpp_inner.zip_length=!0,i},zn.prototype.outer=null,zn.prototype.inner=null,zn.prototype.immutable=null,zn.prototype._invalidated=null,zn.prototype._invalidate=null,zn.prototype._validate=null,zn.prototype._modifiable=null,zn.prototype.adder=null,zn.prototype.post_adder=null,zn.prototype.subber=null,zn.prototype.dontremove=null,zn.prototype.reverse_flag=null,zn.prototype.valmod=function(){this.validate(),this.inner.modified&&(this.inner.pushmod&&(this.push_ite=null),this.at_ite=null,this.inner.modified=!1,this.inner.pushmod=!1,this.zip_length=!0)},zn.prototype.modified=function(){this.zip_length=!0,this.at_ite=null,this.push_ite=null},zn.prototype.modify_test=function(){},zn.prototype.validate=function(){this._invalidated&&(this._invalidated=!1,null!=this._validate&&this._validate())},zn.prototype.invalidate=function(){this._invalidated=!0,null!=this._invalidate&&this._invalidate(this)},zn.prototype.at_index=null,zn.prototype.at_ite=null,zn.prototype.push_ite=null,zn.prototype.zip_length=null,zn.prototype.user_length=null,zn.prototype.__class__=zn;var bn=zpp_nape.util.ZPP_BodyList=function(){this.user_length=0,this.zip_length=!1,this.push_ite=null,this.at_ite=null,this.at_index=0,this.reverse_flag=!1,this.dontremove=!1,this.subber=null,this.post_adder=null,this.adder=null,this._modifiable=null,this._validate=null,this._invalidate=null,this._invalidated=!1,this.immutable=!1,this.inner=null,this.outer=null,this.inner=new di,this._invalidated=!0};bn.__name__=["zpp_nape","util","ZPP_BodyList"],bn.get=function(t,e){null==e&&(e=!1);var i=new tt;return i.zpp_inner.inner=t,e&&(i.zpp_inner.immutable=!0),i.zpp_inner.zip_length=!0,i},bn.prototype.outer=null,bn.prototype.inner=null,bn.prototype.immutable=null,bn.prototype._invalidated=null,bn.prototype._invalidate=null,bn.prototype._validate=null,bn.prototype._modifiable=null,bn.prototype.adder=null,bn.prototype.post_adder=null,bn.prototype.subber=null,bn.prototype.dontremove=null,bn.prototype.reverse_flag=null,bn.prototype.valmod=function(){this.validate(),this.inner.modified&&(this.inner.pushmod&&(this.push_ite=null),this.at_ite=null,this.inner.modified=!1,this.inner.pushmod=!1,this.zip_length=!0)},bn.prototype.modified=function(){this.zip_length=!0,this.at_ite=null,this.push_ite=null},bn.prototype.modify_test=function(){},bn.prototype.validate=function(){this._invalidated&&(this._invalidated=!1,null!=this._validate&&this._validate())},bn.prototype.invalidate=function(){this._invalidated=!0,null!=this._invalidate&&this._invalidate(this)},bn.prototype.at_index=null,bn.prototype.at_ite=null,bn.prototype.push_ite=null,bn.prototype.zip_length=null,bn.prototype.user_length=null,bn.prototype.__class__=bn;var Sn=zpp_nape.util.ZPP_InteractorList=function(){this.user_length=0,this.zip_length=!1,this.push_ite=null,this.at_ite=null,this.at_index=0,this.reverse_flag=!1,this.dontremove=!1,this.subber=null,this.post_adder=null,this.adder=null,this._modifiable=null,this._validate=null,this._invalidate=null,this._invalidated=!1,this.immutable=!1,this.inner=null,this.outer=null,this.inner=new Pt,this._invalidated=!0};Sn.__name__=["zpp_nape","util","ZPP_InteractorList"],Sn.get=function(t,e){null==e&&(e=!1);var i=new at;return i.zpp_inner.inner=t,e&&(i.zpp_inner.immutable=!0),i.zpp_inner.zip_length=!0,i},Sn.prototype.outer=null,Sn.prototype.inner=null,Sn.prototype.immutable=null,Sn.prototype._invalidated=null,Sn.prototype._invalidate=null,Sn.prototype._validate=null,Sn.prototype._modifiable=null,Sn.prototype.adder=null,Sn.prototype.post_adder=null,Sn.prototype.subber=null,Sn.prototype.dontremove=null,Sn.prototype.reverse_flag=null,Sn.prototype.valmod=function(){this.validate(),this.inner.modified&&(this.inner.pushmod&&(this.push_ite=null),this.at_ite=null,this.inner.modified=!1,this.inner.pushmod=!1,this.zip_length=!0)},Sn.prototype.modified=function(){this.zip_length=!0,this.at_ite=null,this.push_ite=null},Sn.prototype.modify_test=function(){},Sn.prototype.validate=function(){this._invalidated&&(this._invalidated=!1,null!=this._validate&&this._validate())},Sn.prototype.invalidate=function(){this._invalidated=!0,null!=this._invalidate&&this._invalidate(this)},Sn.prototype.at_index=null,Sn.prototype.at_ite=null,Sn.prototype.push_ite=null,Sn.prototype.zip_length=null,Sn.prototype.user_length=null,Sn.prototype.__class__=Sn;var Cn=zpp_nape.util.ZPP_CompoundList=function(){this.user_length=0,this.zip_length=!1,this.push_ite=null,this.at_ite=null,this.at_index=0,this.reverse_flag=!1,this.dontremove=!1,this.subber=null,this.post_adder=null,this.adder=null,this._modifiable=null,this._validate=null,this._invalidate=null,this._invalidated=!1,this.immutable=!1,this.inner=null,this.outer=null,this.inner=new ci,this._invalidated=!0};Cn.__name__=["zpp_nape","util","ZPP_CompoundList"],Cn.get=function(t,e){null==e&&(e=!1);var i=new nt;return i.zpp_inner.inner=t,e&&(i.zpp_inner.immutable=!0),i.zpp_inner.zip_length=!0,i},Cn.prototype.outer=null,Cn.prototype.inner=null,Cn.prototype.immutable=null,Cn.prototype._invalidated=null,Cn.prototype._invalidate=null,Cn.prototype._validate=null,Cn.prototype._modifiable=null,Cn.prototype.adder=null,Cn.prototype.post_adder=null,Cn.prototype.subber=null,Cn.prototype.dontremove=null,Cn.prototype.reverse_flag=null,Cn.prototype.valmod=function(){this.validate(),this.inner.modified&&(this.inner.pushmod&&(this.push_ite=null),this.at_ite=null,this.inner.modified=!1,this.inner.pushmod=!1,this.zip_length=!0)},Cn.prototype.modified=function(){this.zip_length=!0,this.at_ite=null,this.push_ite=null},Cn.prototype.modify_test=function(){},Cn.prototype.validate=function(){this._invalidated&&(this._invalidated=!1,null!=this._validate&&this._validate())},Cn.prototype.invalidate=function(){this._invalidated=!0,null!=this._invalidate&&this._invalidate(this)},Cn.prototype.at_index=null,Cn.prototype.at_ite=null,Cn.prototype.push_ite=null,Cn.prototype.zip_length=null,Cn.prototype.user_length=null,Cn.prototype.__class__=Cn;var Pn=zpp_nape.util.ZPP_ListenerList=function(){this.user_length=0,this.zip_length=!1,this.push_ite=null,this.at_ite=null,this.at_index=0,this.reverse_flag=!1,this.dontremove=!1,this.subber=null,this.post_adder=null,this.adder=null,this._modifiable=null,this._validate=null,this._invalidate=null,this._invalidated=!1,this.immutable=!1,this.inner=null,this.outer=null,this.inner=new Di,this._invalidated=!0};Pn.__name__=["zpp_nape","util","ZPP_ListenerList"],Pn.get=function(t,e){null==e&&(e=!1);var i=new g;return i.zpp_inner.inner=t,e&&(i.zpp_inner.immutable=!0),i.zpp_inner.zip_length=!0,i},Pn.prototype.outer=null,Pn.prototype.inner=null,Pn.prototype.immutable=null,Pn.prototype._invalidated=null,Pn.prototype._invalidate=null,Pn.prototype._validate=null,Pn.prototype._modifiable=null,Pn.prototype.adder=null,Pn.prototype.post_adder=null,Pn.prototype.subber=null,Pn.prototype.dontremove=null,Pn.prototype.reverse_flag=null,Pn.prototype.valmod=function(){this.validate(),this.inner.modified&&(this.inner.pushmod&&(this.push_ite=null),this.at_ite=null,this.inner.modified=!1,this.inner.pushmod=!1,this.zip_length=!0)},Pn.prototype.modified=function(){this.zip_length=!0,this.at_ite=null,this.push_ite=null},Pn.prototype.modify_test=function(){},Pn.prototype.validate=function(){this._invalidated&&(this._invalidated=!1,null!=this._validate&&this._validate())},Pn.prototype.invalidate=function(){this._invalidated=!0,null!=this._invalidate&&this._invalidate(this)},Pn.prototype.at_index=null,Pn.prototype.at_ite=null,Pn.prototype.push_ite=null,Pn.prototype.zip_length=null,Pn.prototype.user_length=null,Pn.prototype.__class__=Pn;var Mn=zpp_nape.util.ZPP_CbTypeList=function(){this.user_length=0,this.zip_length=!1,this.push_ite=null,this.at_ite=null,this.at_index=0,this.reverse_flag=!1,this.dontremove=!1,this.subber=null,this.post_adder=null,this.adder=null,this._modifiable=null,this._validate=null,this._invalidate=null,this._invalidated=!1,this.immutable=!1,this.inner=null,this.outer=null,this.inner=new Et,this._invalidated=!0};Mn.__name__=["zpp_nape","util","ZPP_CbTypeList"],Mn.get=function(t,e){null==e&&(e=!1);var i=new d;return i.zpp_inner.inner=t,e&&(i.zpp_inner.immutable=!0),i.zpp_inner.zip_length=!0,i},Mn.prototype.outer=null,Mn.prototype.inner=null,Mn.prototype.immutable=null,Mn.prototype._invalidated=null,Mn.prototype._invalidate=null,Mn.prototype._validate=null,Mn.prototype._modifiable=null,Mn.prototype.adder=null,Mn.prototype.post_adder=null,Mn.prototype.subber=null,Mn.prototype.dontremove=null,Mn.prototype.reverse_flag=null,Mn.prototype.valmod=function(){this.validate(),this.inner.modified&&(this.inner.pushmod&&(this.push_ite=null),this.at_ite=null,this.inner.modified=!1,this.inner.pushmod=!1,this.zip_length=!0)},Mn.prototype.modified=function(){this.zip_length=!0,this.at_ite=null,this.push_ite=null},Mn.prototype.modify_test=function(){},Mn.prototype.validate=function(){this._invalidated&&(this._invalidated=!1,null!=this._validate&&this._validate())},Mn.prototype.invalidate=function(){this._invalidated=!0,null!=this._invalidate&&this._invalidate(this)},Mn.prototype.at_index=null,Mn.prototype.at_ite=null,Mn.prototype.push_ite=null,Mn.prototype.zip_length=null,Mn.prototype.user_length=null,Mn.prototype.__class__=Mn;var Tn=zpp_nape.util.ZPP_Vec2List=function(){this.user_length=0,this.zip_length=!1,this.push_ite=null,this.at_ite=null,this.at_index=0,this.reverse_flag=!1,this.dontremove=!1,this.subber=null,this.post_adder=null,this.adder=null,this._modifiable=null,this._validate=null,this._invalidate=null,this._invalidated=!1,this.immutable=!1,this.inner=null,this.outer=null,this.inner=new ue,this._invalidated=!0};Tn.__name__=["zpp_nape","util","ZPP_Vec2List"],Tn.get=function(t,e){null==e&&(e=!1);var i=new Y;return i.zpp_inner.inner=t,e&&(i.zpp_inner.immutable=!0),i.zpp_inner.zip_length=!0,i},Tn.prototype.outer=null,Tn.prototype.inner=null,Tn.prototype.immutable=null,Tn.prototype._invalidated=null,Tn.prototype._invalidate=null,Tn.prototype._validate=null,Tn.prototype._modifiable=null,Tn.prototype.adder=null,Tn.prototype.post_adder=null,Tn.prototype.subber=null,Tn.prototype.dontremove=null,Tn.prototype.reverse_flag=null,Tn.prototype.valmod=function(){this.validate(),this.inner.modified&&(this.inner.pushmod&&(this.push_ite=null),this.at_ite=null,this.inner.modified=!1,this.inner.pushmod=!1,this.zip_length=!0)},Tn.prototype.modified=function(){this.zip_length=!0,this.at_ite=null,this.push_ite=null},Tn.prototype.modify_test=function(){},Tn.prototype.validate=function(){this._invalidated&&(this._invalidated=!1,null!=this._validate&&this._validate())},Tn.prototype.invalidate=function(){this._invalidated=!0,null!=this._invalidate&&this._invalidate(this)},Tn.prototype.at_index=null,Tn.prototype.at_ite=null,Tn.prototype.push_ite=null,Tn.prototype.zip_length=null,Tn.prototype.user_length=null,Tn.prototype.__class__=Tn;var An=zpp_nape.util.ZPP_GeomPolyList=function(){this.user_length=0,this.zip_length=!1,this.push_ite=null,this.at_ite=null,this.at_index=0,this.reverse_flag=!1,this.dontremove=!1,this.subber=null,this.post_adder=null,this.adder=null,this._modifiable=null,this._validate=null,this._invalidate=null,this._invalidated=!1,this.immutable=!1,this.inner=null,this.outer=null,this.inner=new Ni,this._invalidated=!0};An.__name__=["zpp_nape","util","ZPP_GeomPolyList"],An.get=function(t,e){null==e&&(e=!1);var i=new mi;return i.zpp_inner.inner=t,e&&(i.zpp_inner.immutable=!0),i.zpp_inner.zip_length=!0,i},An.prototype.outer=null,An.prototype.inner=null,An.prototype.immutable=null,An.prototype._invalidated=null,An.prototype._invalidate=null,An.prototype._validate=null,An.prototype._modifiable=null,An.prototype.adder=null,An.prototype.post_adder=null,An.prototype.subber=null,An.prototype.dontremove=null,An.prototype.reverse_flag=null,An.prototype.valmod=function(){this.validate(),this.inner.modified&&(this.inner.pushmod&&(this.push_ite=null),this.at_ite=null,this.inner.modified=!1,this.inner.pushmod=!1,this.zip_length=!0)},An.prototype.modified=function(){this.zip_length=!0,this.at_ite=null,this.push_ite=null},An.prototype.modify_test=function(){},An.prototype.validate=function(){this._invalidated&&(this._invalidated=!1,null!=this._validate&&this._validate())},An.prototype.invalidate=function(){this._invalidated=!0,null!=this._invalidate&&this._invalidate(this)},An.prototype.at_index=null,An.prototype.at_ite=null,An.prototype.push_ite=null,An.prototype.zip_length=null,An.prototype.user_length=null,An.prototype.__class__=An;var kn=zpp_nape.util.ZPP_RayResultList=function(){this.user_length=0,this.zip_length=!1,this.push_ite=null,this.at_ite=null,this.at_index=0,this.reverse_flag=!1,this.dontremove=!1,this.subber=null,this.post_adder=null,this.adder=null,this._modifiable=null,this._validate=null,this._invalidate=null,this._invalidated=!1,this.immutable=!1,this.inner=null,this.outer=null,this.inner=new ji,this._invalidated=!0};kn.__name__=["zpp_nape","util","ZPP_RayResultList"],kn.get=function(t,e){null==e&&(e=!1);var i=new q;return i.zpp_inner.inner=t,e&&(i.zpp_inner.immutable=!0),i.zpp_inner.zip_length=!0,i},kn.prototype.outer=null,kn.prototype.inner=null,kn.prototype.immutable=null,kn.prototype._invalidated=null,kn.prototype._invalidate=null,kn.prototype._validate=null,kn.prototype._modifiable=null,kn.prototype.adder=null,kn.prototype.post_adder=null,kn.prototype.subber=null,kn.prototype.dontremove=null,kn.prototype.reverse_flag=null,kn.prototype.valmod=function(){this.validate(),this.inner.modified&&(this.inner.pushmod&&(this.push_ite=null),this.at_ite=null,this.inner.modified=!1,this.inner.pushmod=!1,this.zip_length=!0)},kn.prototype.modified=function(){this.zip_length=!0,this.at_ite=null,this.push_ite=null},kn.prototype.modify_test=function(){},kn.prototype.validate=function(){this._invalidated&&(this._invalidated=!1,null!=this._validate&&this._validate())},kn.prototype.invalidate=function(){this._invalidated=!0,null!=this._invalidate&&this._invalidate(this)},kn.prototype.at_index=null,kn.prototype.at_ite=null,kn.prototype.push_ite=null,kn.prototype.zip_length=null,kn.prototype.user_length=null,kn.prototype.__class__=kn;var On=zpp_nape.util.ZPP_ConvexResultList=function(){this.user_length=0,this.zip_length=!1,this.push_ite=null,this.at_ite=null,this.at_index=0,this.reverse_flag=!1,this.dontremove=!1,this.subber=null,this.post_adder=null,this.adder=null,this._modifiable=null,this._validate=null,this._invalidate=null,this._invalidated=!1,this.immutable=!1,this.inner=null,this.outer=null,this.inner=new Fi,this._invalidated=!0};On.__name__=["zpp_nape","util","ZPP_ConvexResultList"],On.get=function(t,e){null==e&&(e=!1);var i=new bt;return i.zpp_inner.inner=t,e&&(i.zpp_inner.immutable=!0),i.zpp_inner.zip_length=!0,i},On.prototype.outer=null,On.prototype.inner=null,On.prototype.immutable=null,On.prototype._invalidated=null,On.prototype._invalidate=null,On.prototype._validate=null,On.prototype._modifiable=null,On.prototype.adder=null,On.prototype.post_adder=null,On.prototype.subber=null,On.prototype.dontremove=null,On.prototype.reverse_flag=null,On.prototype.valmod=function(){this.validate(),this.inner.modified&&(this.inner.pushmod&&(this.push_ite=null),this.at_ite=null,this.inner.modified=!1,this.inner.pushmod=!1,this.zip_length=!0)},On.prototype.modified=function(){this.zip_length=!0,this.at_ite=null,this.push_ite=null},On.prototype.modify_test=function(){},On.prototype.validate=function(){this._invalidated&&(this._invalidated=!1,null!=this._validate&&this._validate())},On.prototype.invalidate=function(){this._invalidated=!0,null!=this._invalidate&&this._invalidate(this)},On.prototype.at_index=null,On.prototype.at_ite=null,On.prototype.push_ite=null,On.prototype.zip_length=null,On.prototype.user_length=null,On.prototype.__class__=On;var En=zpp_nape.util.ZPP_EdgeList=function(){this.user_length=0,this.zip_length=!1,this.push_ite=null,this.at_ite=null,this.at_index=0,this.reverse_flag=!1,this.dontremove=!1,this.subber=null,this.post_adder=null,this.adder=null,this._modifiable=null,this._validate=null,this._invalidate=null,this._invalidated=!1,this.immutable=!1,this.inner=null,this.outer=null,this.inner=new ki,this._invalidated=!0};En.__name__=["zpp_nape","util","ZPP_EdgeList"],En.get=function(t,e){null==e&&(e=!1);var i=new ct;return i.zpp_inner.inner=t,e&&(i.zpp_inner.immutable=!0),i.zpp_inner.zip_length=!0,i},En.prototype.outer=null,En.prototype.inner=null,En.prototype.immutable=null,En.prototype._invalidated=null,En.prototype._invalidate=null,En.prototype._validate=null,En.prototype._modifiable=null,En.prototype.adder=null,En.prototype.post_adder=null,En.prototype.subber=null,En.prototype.dontremove=null,En.prototype.reverse_flag=null,En.prototype.valmod=function(){this.validate(),this.inner.modified&&(this.inner.pushmod&&(this.push_ite=null),this.at_ite=null,this.inner.modified=!1,this.inner.pushmod=!1,this.zip_length=!0)},En.prototype.modified=function(){this.zip_length=!0,this.at_ite=null,this.push_ite=null},En.prototype.modify_test=function(){},En.prototype.validate=function(){this._invalidated&&(this._invalidated=!1,null!=this._validate&&this._validate())},En.prototype.invalidate=function(){this._invalidated=!0,null!=this._invalidate&&this._invalidate(this)},En.prototype.at_index=null,En.prototype.at_ite=null,En.prototype.push_ite=null,En.prototype.zip_length=null,En.prototype.user_length=null,En.prototype.__class__=En;var In=zpp_nape.util.ZPP_ShapeList=function(){this.user_length=0,this.zip_length=!1,this.push_ite=null,this.at_ite=null,this.at_index=0,this.reverse_flag=!1,this.dontremove=!1,this.subber=null,this.post_adder=null,this.adder=null,this._modifiable=null,this._validate=null,this._invalidate=null,this._invalidated=!1,this.immutable=!1,this.inner=null,this.outer=null,this.inner=new ui,this._invalidated=!0};In.__name__=["zpp_nape","util","ZPP_ShapeList"],In.get=function(t,e){null==e&&(e=!1);var i=new _t;return i.zpp_inner.inner=t,e&&(i.zpp_inner.immutable=!0),i.zpp_inner.zip_length=!0,i},In.prototype.outer=null,In.prototype.inner=null,In.prototype.immutable=null,In.prototype._invalidated=null,In.prototype._invalidate=null,In.prototype._validate=null,In.prototype._modifiable=null,In.prototype.adder=null,In.prototype.post_adder=null,In.prototype.subber=null,In.prototype.dontremove=null,In.prototype.reverse_flag=null,In.prototype.valmod=function(){this.validate(),this.inner.modified&&(this.inner.pushmod&&(this.push_ite=null),this.at_ite=null,this.inner.modified=!1,this.inner.pushmod=!1,this.zip_length=!0)},In.prototype.modified=function(){this.zip_length=!0,this.at_ite=null,this.push_ite=null},In.prototype.modify_test=function(){},In.prototype.validate=function(){this._invalidated&&(this._invalidated=!1,null!=this._validate&&this._validate())},In.prototype.invalidate=function(){this._invalidated=!0,null!=this._invalidate&&this._invalidate(this)},In.prototype.at_index=null,In.prototype.at_ite=null,In.prototype.push_ite=null,In.prototype.zip_length=null,In.prototype.user_length=null,In.prototype.__class__=In;var Gn=zpp_nape.util.ZPP_InteractionGroupList=function(){this.user_length=0,this.zip_length=!1,this.push_ite=null,this.at_ite=null,this.at_index=0,this.reverse_flag=!1,this.dontremove=!1,this.subber=null,this.post_adder=null,this.adder=null,this._modifiable=null,this._validate=null,this._invalidate=null,this._invalidated=!1,this.immutable=!1,this.inner=null,this.outer=null,this.inner=new Bi,this._invalidated=!0};Gn.__name__=["zpp_nape","util","ZPP_InteractionGroupList"],Gn.get=function(t,e){null==e&&(e=!1);var i=new F;return i.zpp_inner.inner=t,e&&(i.zpp_inner.immutable=!0),i.zpp_inner.zip_length=!0,i},Gn.prototype.outer=null,Gn.prototype.inner=null,Gn.prototype.immutable=null,Gn.prototype._invalidated=null,Gn.prototype._invalidate=null,Gn.prototype._validate=null,Gn.prototype._modifiable=null,Gn.prototype.adder=null,Gn.prototype.post_adder=null,Gn.prototype.subber=null,Gn.prototype.dontremove=null,Gn.prototype.reverse_flag=null,Gn.prototype.valmod=function(){this.validate(),this.inner.modified&&(this.inner.pushmod&&(this.push_ite=null),this.at_ite=null,this.inner.modified=!1,this.inner.pushmod=!1,this.zip_length=!0)},Gn.prototype.modified=function(){this.zip_length=!0,this.at_ite=null,this.push_ite=null},Gn.prototype.modify_test=function(){},Gn.prototype.validate=function(){this._invalidated&&(this._invalidated=!1,null!=this._validate&&this._validate())},Gn.prototype.invalidate=function(){this._invalidated=!0,null!=this._invalidate&&this._invalidate(this)},Gn.prototype.at_index=null,Gn.prototype.at_ite=null,Gn.prototype.push_ite=null,Gn.prototype.zip_length=null,Gn.prototype.user_length=null,Gn.prototype.__class__=Gn;var Dn=zpp_nape.util.ZPP_ArbiterList=function(){this.user_length=0,this.zip_length=!1,this.push_ite=null,this.at_ite=null,this.at_index=0,this.reverse_flag=!1,this.dontremove=!1,this.subber=null,this.post_adder=null,this.adder=null,this._modifiable=null,this._validate=null,this._invalidate=null,this._invalidated=!1,this.immutable=!1,this.inner=null,this.outer=null,this.inner=new yi,this._invalidated=!0};Dn.__name__=["zpp_nape","util","ZPP_ArbiterList"],Dn.get=function(t,e){null==e&&(e=!1);var i=new O;return i.zpp_inner.inner=t,e&&(i.zpp_inner.immutable=!0),i.zpp_inner.zip_length=!0,i},Dn.prototype.outer=null,Dn.prototype.inner=null,Dn.prototype.immutable=null,Dn.prototype._invalidated=null,Dn.prototype._invalidate=null,Dn.prototype._validate=null,Dn.prototype._modifiable=null,Dn.prototype.adder=null,Dn.prototype.post_adder=null,Dn.prototype.subber=null,Dn.prototype.dontremove=null,Dn.prototype.reverse_flag=null,Dn.prototype.valmod=function(){this.validate(),this.inner.modified&&(this.inner.pushmod&&(this.push_ite=null),this.at_ite=null,this.inner.modified=!1,this.inner.pushmod=!1,this.zip_length=!0)},Dn.prototype.modified=function(){this.zip_length=!0,this.at_ite=null,this.push_ite=null},Dn.prototype.modify_test=function(){},Dn.prototype.validate=function(){this._invalidated&&(this._invalidated=!1,null!=this._validate&&this._validate())},Dn.prototype.invalidate=function(){this._invalidated=!0,null!=this._invalidate&&this._invalidate(this)},Dn.prototype.at_index=null,Dn.prototype.at_ite=null,Dn.prototype.push_ite=null,Dn.prototype.zip_length=null,Dn.prototype.user_length=null,Dn.prototype.__class__=Dn;var Ln=zpp_nape.util.ZPP_ContactList=function(){this.user_length=0,this.zip_length=!1,this.push_ite=null,this.at_ite=null,this.at_index=0,this.reverse_flag=!1,this.dontremove=!1,this.subber=null,this.post_adder=null,this.adder=null,this._modifiable=null,this._validate=null,this._invalidate=null,this._invalidated=!1,this.immutable=!1,this.inner=null,this.outer=null,this.inner=new Qn,this._invalidated=!0};Ln.__name__=["zpp_nape","util","ZPP_ContactList"],Ln.get=function(t,e){null==e&&(e=!1);var i=new D;return i.zpp_inner.inner=t,e&&(i.zpp_inner.immutable=!0),i.zpp_inner.zip_length=!0,i},Ln.prototype.outer=null,Ln.prototype.inner=null,Ln.prototype.immutable=null,Ln.prototype._invalidated=null,Ln.prototype._invalidate=null,Ln.prototype._validate=null,Ln.prototype._modifiable=null,Ln.prototype.adder=null,Ln.prototype.post_adder=null,Ln.prototype.subber=null,Ln.prototype.dontremove=null,Ln.prototype.reverse_flag=null,Ln.prototype.valmod=function(){this.validate(),this.inner.modified&&(this.inner.pushmod&&(this.push_ite=null),this.at_ite=null,this.inner.modified=!1,this.inner.pushmod=!1,this.zip_length=!0)},Ln.prototype.modified=function(){this.zip_length=!0,this.at_ite=null,this.push_ite=null},Ln.prototype.modify_test=function(){},Ln.prototype.validate=function(){this._invalidated&&(this._invalidated=!1,null!=this._validate&&this._validate())},Ln.prototype.invalidate=function(){this._invalidated=!0,null!=this._invalidate&&this._invalidate(this)},Ln.prototype.at_index=null,Ln.prototype.at_ite=null,Ln.prototype.push_ite=null,Ln.prototype.zip_length=null,Ln.prototype.user_length=null,Ln.prototype.__class__=Ln;o=zpp_nape.util.ZPP_Math=function(){};o.__name__=["zpp_nape","util","ZPP_Math"],o.sqrt=function(t){return Math.sqrt(t)},o.invsqrt=function(t){return 1/Math.sqrt(t)},o.sqr=function(t){return t*t},o.clamp2=function(t,e){var i=-e;return t<i?i:e<t?e:t},o.clamp=function(t,e,i){return t<e?e:i<t?i:t},o.prototype.__class__=o;var Bn=zpp_nape.util.ZPP_PubPool=function(){};Bn.__name__=["zpp_nape","util","ZPP_PubPool"],Bn.prototype.__class__=Bn;var Rn=zpp_nape.util.ZPP_Set_ZPP_Body=function(){this.colour=0,this.parent=null,this.next=null,this.prev=null,this.data=null,this.swapped=null,this.lt=null};Rn.__name__=["zpp_nape","util","ZPP_Set_ZPP_Body"],Rn.prototype.free=function(){this.data=null,this.lt=null,this.swapped=null},Rn.prototype.alloc=function(){},Rn.prototype.lt=null,Rn.prototype.swapped=null,Rn.prototype.data=null,Rn.prototype.prev=null,Rn.prototype.next=null,Rn.prototype.parent=null,Rn.prototype.colour=null,Rn.prototype.verify=function(){if(!this.empty()){for(var t=this.parent;null!=t.prev;)t=t.prev;for(;null!=t;){var e=t.data,i=!0;if(!this.empty()){for(var n=this.parent;null!=n.prev;)n=n.prev;for(;null!=n;){var r=n.data;if(i){if(e==r)i=!1;else if(!this.lt(r,e)&&this.lt(e,r))return!1}else if(!this.lt(e,r)&&this.lt(r,e))return!1;if(null!=n.next)for(n=n.next;null!=n.prev;)n=n.prev;else{for(;null!=n.parent&&n==n.parent.next;)n=n.parent;n=n.parent}}}if(null!=t.next)for(t=t.next;null!=t.prev;)t=t.prev;else{for(;null!=t.parent&&t==t.parent.next;)t=t.parent;t=t.parent}}}return!0},Rn.prototype.empty=function(){return null==this.parent},Rn.prototype.singular=function(){return null!=this.parent&&null==this.parent.prev&&null==this.parent.next},Rn.prototype.size=function(){var t=0;if(!this.empty()){for(var e=this.parent;null!=e.prev;)e=e.prev;for(;null!=e;)if(++t,null!=e.next)for(e=e.next;null!=e.prev;)e=e.prev;else{for(;null!=e.parent&&e==e.parent.next;)e=e.parent;e=e.parent}}return t},Rn.prototype.has=function(t){return null!=this.find(t)},Rn.prototype.find=function(t){for(var e=this.parent;null!=e&&e.data!=t;)e=this.lt(t,e.data)?e.prev:e.next;return e},Rn.prototype.has_weak=function(t){return null!=this.find_weak(t)},Rn.prototype.find_weak=function(t){for(var e=this.parent;null!=e;)if(this.lt(t,e.data))e=e.prev;else{if(!this.lt(e.data,t))break;e=e.next}return e},Rn.prototype.lower_bound=function(t){var e=null;if(!this.empty()){for(var i=this.parent;null!=i.prev;)i=i.prev;for(;null!=i;){var n=i.data;if(!this.lt(n,t)){e=n;break}if(null!=i.next)for(i=i.next;null!=i.prev;)i=i.prev;else{for(;null!=i.parent&&i==i.parent.next;)i=i.parent;i=i.parent}}}return e},Rn.prototype.first=function(){for(var t=this.parent;null!=t.prev;)t=t.prev;return t.data},Rn.prototype.pop_front=function(){for(var t=this.parent;null!=t.prev;)t=t.prev;var e=t.data;return this.remove_node(t),e},Rn.prototype.remove=function(t){this.remove_node(this.find(t))},Rn.prototype.successor_node=function(t){if(null!=t.next)for(t=t.next;null!=t.prev;)t=t.prev;else{var e=t;for(t=t.parent;null!=t&&t.prev!=e;)t=(e=t).parent}return t},Rn.prototype.predecessor_node=function(t){if(null!=t.prev)for(t=t.prev;null!=t.next;)t=t.next;else{var e=t;for(t=t.parent;null!=t&&t.next!=e;)t=(e=t).parent}return t},Rn.prototype.successor=function(t){t=this.successor_node(this.find(t));return null==t?null:t.data},Rn.prototype.predecessor=function(t){t=this.predecessor_node(this.find(t));return null==t?null:t.data},Rn.prototype.remove_node=function(t){if(null!=t.next&&null!=t.prev){for(var e=t.next;null!=e.prev;)e=e.prev;var i=t.data;t.data=e.data,e.data=i,null!=this.swapped&&this.swapped(t.data,e.data),t=e}var n=null==t.prev?t.next:t.prev;if(1==t.colour)if(null!=t.prev||null!=t.next)n.colour=1;else if(null!=t.parent)for(var r=t.parent;;){r.colour++,r.prev.colour--,r.next.colour--;var o=r.prev;if(-1==o.colour){this.__fix_neg_red(o);break}if(0==o.colour){if(null!=o.prev&&0==o.prev.colour){this.__fix_dbl_red(o.prev);break}if(null!=o.next&&0==o.next.colour){this.__fix_dbl_red(o.next);break}}o=r.next;if(-1==o.colour){this.__fix_neg_red(o);break}if(0==o.colour){if(null!=o.prev&&0==o.prev.colour){this.__fix_dbl_red(o.prev);break}if(null!=o.next&&0==o.next.colour){this.__fix_dbl_red(o.next);break}}if(2==r.colour){if(null!=r.parent){r=r.parent;continue}r.colour=1}break}i=t.parent;null==i?this.parent=n:i.prev==t?i.prev=n:i.next=n,null!=n&&(n.parent=i),t.parent=t.prev=t.next=null;t.data=null,t.lt=null,t.swapped=null,t.next=Rn.zpp_pool,Rn.zpp_pool=t},Rn.prototype.clear=function(){if(null!=this.parent){for(var t,e,i=this.parent;null!=i;)i=null!=i.prev?i.prev:null!=i.next?i.next:(null!=(t=i.parent)&&(i==t.prev?t.prev=null:t.next=null,i.parent=null),(e=i).data=null,e.lt=null,e.swapped=null,e.next=Rn.zpp_pool,Rn.zpp_pool=e,t);this.parent=null}},Rn.prototype.clear_with=function(t){if(null!=this.parent){for(var e,i,n=this.parent;null!=n;)n=null!=n.prev?n.prev:null!=n.next?n.next:(t(n.data),null!=(e=n.parent)&&(n==e.prev?e.prev=null:e.next=null,n.parent=null),(i=n).data=null,i.lt=null,i.swapped=null,i.next=Rn.zpp_pool,Rn.zpp_pool=i,e);this.parent=null}},Rn.prototype.clear_node=function(t,e){e(t.data);e=t.parent;return null!=e&&(t==e.prev?e.prev=null:e.next=null,t.parent=null),t.data=null,t.lt=null,t.swapped=null,t.next=Rn.zpp_pool,Rn.zpp_pool=t,e},Rn.prototype.__fix_neg_red=function(t){var e,i,n,r,o=t.parent,s=o.prev==t?(r=t.prev,e=(n=t.next).prev,i=n.next,r.colour=0,t.colour=o.colour=1,null!=(t.next=e)&&(e.parent=t),e=o.data,o.data=n.data,n.data=e,null!=this.swapped&&this.swapped(o.data,n.data),null!=(n.prev=i)&&(i.parent=n),n.next=o.next,null!=o.next&&(o.next.parent=n),null!=(o.next=n)&&(n.parent=o),r):(s=t.next,n=(i=t.prev).next,r=i.prev,s.colour=0,t.colour=o.colour=1,null!=(t.prev=n)&&(n.parent=t),t=o.data,o.data=i.data,i.data=t,null!=this.swapped&&this.swapped(o.data,i.data),null!=(i.next=r)&&(r.parent=i),i.prev=o.prev,null!=o.prev&&(o.prev.parent=i),null!=(o.prev=i)&&(i.parent=o),s);null!=s.prev&&0==s.prev.colour?this.__fix_dbl_red(s.prev):null!=s.next&&0==s.next.colour&&this.__fix_dbl_red(s.next)},Rn.prototype.__fix_dbl_red=function(t){for(;;){var e,i,n,r,o,s,a,h=t.parent,l=h.parent;if(null==l){h.colour=1;break}h==l.prev?(a=(n=l).next,s=t==h.prev?(r=(e=t).prev,o=t.next,(i=h).next):(i=t,r=(e=h).prev,o=t.prev,t.next)):(r=(e=l).prev,a=t==h.prev?(o=(i=t).prev,s=t.next,(n=h).next):(n=t,o=(i=h).prev,s=t.prev,t.next));h=l.parent;if(null==h?this.parent=i:h.prev==l?h.prev=i:h.next=i,null!=i&&(i.parent=h),null!=(e.prev=r)&&(r.parent=e),null!=(e.next=o)&&(o.parent=e),null!=(i.prev=e)&&(e.parent=i),null!=(i.next=n)&&(n.parent=i),null!=(n.prev=s)&&(s.parent=n),null!=(n.next=a)&&(a.parent=n),i.colour=l.colour-1,e.colour=1,n.colour=1,i==this.parent)this.parent.colour=1;else if(0==i.colour&&0==i.parent.colour){t=i;continue}break}},Rn.prototype.try_insert_bool=function(t){var e=null,i=null;if(null==this.parent)null==Rn.zpp_pool?e=new Rn:(e=Rn.zpp_pool,Rn.zpp_pool=e.next,e.next=null),e.data=t,this.parent=e;else for(i=this.parent;;)if(this.lt(t,i.data)){if(null==i.prev){null==Rn.zpp_pool?e=new Rn:(e=Rn.zpp_pool,Rn.zpp_pool=e.next,e.next=null),e.data=t,(i.prev=e).parent=i;break}i=i.prev}else{if(!this.lt(i.data,t))break;if(null==i.next){null==Rn.zpp_pool?e=new Rn:(e=Rn.zpp_pool,Rn.zpp_pool=e.next,e.next=null),e.data=t,(i.next=e).parent=i;break}i=i.next}return null!=e&&(null==e.parent?e.colour=1:(e.colour=0)==e.parent.colour&&this.__fix_dbl_red(e),!0)},Rn.prototype.try_insert=function(t){var e=null,i=null;if(null==this.parent)null==Rn.zpp_pool?e=new Rn:(e=Rn.zpp_pool,Rn.zpp_pool=e.next,e.next=null),e.data=t,this.parent=e;else for(i=this.parent;;)if(this.lt(t,i.data)){if(null==i.prev){null==Rn.zpp_pool?e=new Rn:(e=Rn.zpp_pool,Rn.zpp_pool=e.next,e.next=null),e.data=t,(i.prev=e).parent=i;break}i=i.prev}else{if(!this.lt(i.data,t))break;if(null==i.next){null==Rn.zpp_pool?e=new Rn:(e=Rn.zpp_pool,Rn.zpp_pool=e.next,e.next=null),e.data=t,(i.next=e).parent=i;break}i=i.next}return null==e?i:(null==e.parent?e.colour=1:(e.colour=0)==e.parent.colour&&this.__fix_dbl_red(e),e)},Rn.prototype.insert=function(t){var e;if(null==Rn.zpp_pool?e=new Rn:(e=Rn.zpp_pool,Rn.zpp_pool=e.next,e.next=null),e.data=t,null==this.parent)this.parent=e;else for(var i=this.parent;;)if(this.lt(e.data,i.data)){if(null==i.prev){(i.prev=e).parent=i;break}i=i.prev}else{if(null==i.next){(i.next=e).parent=i;break}i=i.next}return null==e.parent?e.colour=1:(e.colour=0)==e.parent.colour&&this.__fix_dbl_red(e),e},Rn.prototype.__class__=Rn;var Fn=zpp_nape.util.ZPP_Set_ZPP_CbSetPair=function(){this.colour=0,this.parent=null,this.next=null,this.prev=null,this.data=null,this.swapped=null,this.lt=null};Fn.__name__=["zpp_nape","util","ZPP_Set_ZPP_CbSetPair"],Fn.prototype.free=function(){this.data=null,this.lt=null,this.swapped=null},Fn.prototype.alloc=function(){},Fn.prototype.lt=null,Fn.prototype.swapped=null,Fn.prototype.data=null,Fn.prototype.prev=null,Fn.prototype.next=null,Fn.prototype.parent=null,Fn.prototype.colour=null,Fn.prototype.verify=function(){if(!this.empty()){for(var t=this.parent;null!=t.prev;)t=t.prev;for(;null!=t;){var e=t.data,i=!0;if(!this.empty()){for(var n=this.parent;null!=n.prev;)n=n.prev;for(;null!=n;){var r=n.data;if(i){if(e==r)i=!1;else if(!this.lt(r,e)&&this.lt(e,r))return!1}else if(!this.lt(e,r)&&this.lt(r,e))return!1;if(null!=n.next)for(n=n.next;null!=n.prev;)n=n.prev;else{for(;null!=n.parent&&n==n.parent.next;)n=n.parent;n=n.parent}}}if(null!=t.next)for(t=t.next;null!=t.prev;)t=t.prev;else{for(;null!=t.parent&&t==t.parent.next;)t=t.parent;t=t.parent}}}return!0},Fn.prototype.empty=function(){return null==this.parent},Fn.prototype.singular=function(){return null!=this.parent&&null==this.parent.prev&&null==this.parent.next},Fn.prototype.size=function(){var t=0;if(!this.empty()){for(var e=this.parent;null!=e.prev;)e=e.prev;for(;null!=e;)if(++t,null!=e.next)for(e=e.next;null!=e.prev;)e=e.prev;else{for(;null!=e.parent&&e==e.parent.next;)e=e.parent;e=e.parent}}return t},Fn.prototype.has=function(t){return null!=this.find(t)},Fn.prototype.find=function(t){for(var e=this.parent;null!=e&&e.data!=t;)e=this.lt(t,e.data)?e.prev:e.next;return e},Fn.prototype.has_weak=function(t){return null!=this.find_weak(t)},Fn.prototype.find_weak=function(t){for(var e=this.parent;null!=e;)if(this.lt(t,e.data))e=e.prev;else{if(!this.lt(e.data,t))break;e=e.next}return e},Fn.prototype.lower_bound=function(t){var e=null;if(!this.empty()){for(var i=this.parent;null!=i.prev;)i=i.prev;for(;null!=i;){var n=i.data;if(!this.lt(n,t)){e=n;break}if(null!=i.next)for(i=i.next;null!=i.prev;)i=i.prev;else{for(;null!=i.parent&&i==i.parent.next;)i=i.parent;i=i.parent}}}return e},Fn.prototype.first=function(){for(var t=this.parent;null!=t.prev;)t=t.prev;return t.data},Fn.prototype.pop_front=function(){for(var t=this.parent;null!=t.prev;)t=t.prev;var e=t.data;return this.remove_node(t),e},Fn.prototype.remove=function(t){this.remove_node(this.find(t))},Fn.prototype.successor_node=function(t){if(null!=t.next)for(t=t.next;null!=t.prev;)t=t.prev;else{var e=t;for(t=t.parent;null!=t&&t.prev!=e;)t=(e=t).parent}return t},Fn.prototype.predecessor_node=function(t){if(null!=t.prev)for(t=t.prev;null!=t.next;)t=t.next;else{var e=t;for(t=t.parent;null!=t&&t.next!=e;)t=(e=t).parent}return t},Fn.prototype.successor=function(t){t=this.successor_node(this.find(t));return null==t?null:t.data},Fn.prototype.predecessor=function(t){t=this.predecessor_node(this.find(t));return null==t?null:t.data},Fn.prototype.remove_node=function(t){if(null!=t.next&&null!=t.prev){for(var e=t.next;null!=e.prev;)e=e.prev;var i=t.data;t.data=e.data,e.data=i,null!=this.swapped&&this.swapped(t.data,e.data),t=e}var n=null==t.prev?t.next:t.prev;if(1==t.colour)if(null!=t.prev||null!=t.next)n.colour=1;else if(null!=t.parent)for(var r=t.parent;;){r.colour++,r.prev.colour--,r.next.colour--;var o=r.prev;if(-1==o.colour){this.__fix_neg_red(o);break}if(0==o.colour){if(null!=o.prev&&0==o.prev.colour){this.__fix_dbl_red(o.prev);break}if(null!=o.next&&0==o.next.colour){this.__fix_dbl_red(o.next);break}}o=r.next;if(-1==o.colour){this.__fix_neg_red(o);break}if(0==o.colour){if(null!=o.prev&&0==o.prev.colour){this.__fix_dbl_red(o.prev);break}if(null!=o.next&&0==o.next.colour){this.__fix_dbl_red(o.next);break}}if(2==r.colour){if(null!=r.parent){r=r.parent;continue}r.colour=1}break}i=t.parent;null==i?this.parent=n:i.prev==t?i.prev=n:i.next=n,null!=n&&(n.parent=i),t.parent=t.prev=t.next=null;t.data=null,t.lt=null,t.swapped=null,t.next=Fn.zpp_pool,Fn.zpp_pool=t},Fn.prototype.clear=function(){if(null!=this.parent){for(var t,e,i=this.parent;null!=i;)i=null!=i.prev?i.prev:null!=i.next?i.next:(null!=(t=i.parent)&&(i==t.prev?t.prev=null:t.next=null,i.parent=null),(e=i).data=null,e.lt=null,e.swapped=null,e.next=Fn.zpp_pool,Fn.zpp_pool=e,t);this.parent=null}},Fn.prototype.clear_with=function(t){if(null!=this.parent){for(var e,i,n=this.parent;null!=n;)n=null!=n.prev?n.prev:null!=n.next?n.next:(t(n.data),null!=(e=n.parent)&&(n==e.prev?e.prev=null:e.next=null,n.parent=null),(i=n).data=null,i.lt=null,i.swapped=null,i.next=Fn.zpp_pool,Fn.zpp_pool=i,e);this.parent=null}},Fn.prototype.clear_node=function(t,e){e(t.data);e=t.parent;return null!=e&&(t==e.prev?e.prev=null:e.next=null,t.parent=null),t.data=null,t.lt=null,t.swapped=null,t.next=Fn.zpp_pool,Fn.zpp_pool=t,e},Fn.prototype.__fix_neg_red=function(t){var e,i,n,r,o=t.parent,s=o.prev==t?(r=t.prev,e=(n=t.next).prev,i=n.next,r.colour=0,t.colour=o.colour=1,null!=(t.next=e)&&(e.parent=t),e=o.data,o.data=n.data,n.data=e,null!=this.swapped&&this.swapped(o.data,n.data),null!=(n.prev=i)&&(i.parent=n),n.next=o.next,null!=o.next&&(o.next.parent=n),null!=(o.next=n)&&(n.parent=o),r):(s=t.next,n=(i=t.prev).next,r=i.prev,s.colour=0,t.colour=o.colour=1,null!=(t.prev=n)&&(n.parent=t),t=o.data,o.data=i.data,i.data=t,null!=this.swapped&&this.swapped(o.data,i.data),null!=(i.next=r)&&(r.parent=i),i.prev=o.prev,null!=o.prev&&(o.prev.parent=i),null!=(o.prev=i)&&(i.parent=o),s);null!=s.prev&&0==s.prev.colour?this.__fix_dbl_red(s.prev):null!=s.next&&0==s.next.colour&&this.__fix_dbl_red(s.next)},Fn.prototype.__fix_dbl_red=function(t){for(;;){var e,i,n,r,o,s,a,h=t.parent,l=h.parent;if(null==l){h.colour=1;break}h==l.prev?(a=(n=l).next,s=t==h.prev?(r=(e=t).prev,o=t.next,(i=h).next):(i=t,r=(e=h).prev,o=t.prev,t.next)):(r=(e=l).prev,a=t==h.prev?(o=(i=t).prev,s=t.next,(n=h).next):(n=t,o=(i=h).prev,s=t.prev,t.next));h=l.parent;if(null==h?this.parent=i:h.prev==l?h.prev=i:h.next=i,null!=i&&(i.parent=h),null!=(e.prev=r)&&(r.parent=e),null!=(e.next=o)&&(o.parent=e),null!=(i.prev=e)&&(e.parent=i),null!=(i.next=n)&&(n.parent=i),null!=(n.prev=s)&&(s.parent=n),null!=(n.next=a)&&(a.parent=n),i.colour=l.colour-1,e.colour=1,n.colour=1,i==this.parent)this.parent.colour=1;else if(0==i.colour&&0==i.parent.colour){t=i;continue}break}},Fn.prototype.try_insert_bool=function(t){var e=null,i=null;if(null==this.parent)null==Fn.zpp_pool?e=new Fn:(e=Fn.zpp_pool,Fn.zpp_pool=e.next,e.next=null),e.data=t,this.parent=e;else for(i=this.parent;;)if(this.lt(t,i.data)){if(null==i.prev){null==Fn.zpp_pool?e=new Fn:(e=Fn.zpp_pool,Fn.zpp_pool=e.next,e.next=null),e.data=t,(i.prev=e).parent=i;break}i=i.prev}else{if(!this.lt(i.data,t))break;if(null==i.next){null==Fn.zpp_pool?e=new Fn:(e=Fn.zpp_pool,Fn.zpp_pool=e.next,e.next=null),e.data=t,(i.next=e).parent=i;break}i=i.next}return null!=e&&(null==e.parent?e.colour=1:(e.colour=0)==e.parent.colour&&this.__fix_dbl_red(e),!0)},Fn.prototype.try_insert=function(t){var e=null,i=null;if(null==this.parent)null==Fn.zpp_pool?e=new Fn:(e=Fn.zpp_pool,Fn.zpp_pool=e.next,e.next=null),e.data=t,this.parent=e;else for(i=this.parent;;)if(this.lt(t,i.data)){if(null==i.prev){null==Fn.zpp_pool?e=new Fn:(e=Fn.zpp_pool,Fn.zpp_pool=e.next,e.next=null),e.data=t,(i.prev=e).parent=i;break}i=i.prev}else{if(!this.lt(i.data,t))break;if(null==i.next){null==Fn.zpp_pool?e=new Fn:(e=Fn.zpp_pool,Fn.zpp_pool=e.next,e.next=null),e.data=t,(i.next=e).parent=i;break}i=i.next}return null==e?i:(null==e.parent?e.colour=1:(e.colour=0)==e.parent.colour&&this.__fix_dbl_red(e),e)},Fn.prototype.insert=function(t){var e;if(null==Fn.zpp_pool?e=new Fn:(e=Fn.zpp_pool,Fn.zpp_pool=e.next,e.next=null),e.data=t,null==this.parent)this.parent=e;else for(var i=this.parent;;)if(this.lt(e.data,i.data)){if(null==i.prev){(i.prev=e).parent=i;break}i=i.prev}else{if(null==i.next){(i.next=e).parent=i;break}i=i.next}return null==e.parent?e.colour=1:(e.colour=0)==e.parent.colour&&this.__fix_dbl_red(e),e},Fn.prototype.__class__=Fn;var Nn=zpp_nape.util.ZPP_Set_ZPP_PartitionVertex=function(){this.colour=0,this.parent=null,this.next=null,this.prev=null,this.data=null,this.swapped=null,this.lt=null};Nn.__name__=["zpp_nape","util","ZPP_Set_ZPP_PartitionVertex"],Nn.prototype.free=function(){this.data=null,this.lt=null,this.swapped=null},Nn.prototype.alloc=function(){},Nn.prototype.lt=null,Nn.prototype.swapped=null,Nn.prototype.data=null,Nn.prototype.prev=null,Nn.prototype.next=null,Nn.prototype.parent=null,Nn.prototype.colour=null,Nn.prototype.verify=function(){if(!this.empty()){for(var t=this.parent;null!=t.prev;)t=t.prev;for(;null!=t;){var e=t.data,i=!0;if(!this.empty()){for(var n=this.parent;null!=n.prev;)n=n.prev;for(;null!=n;){var r=n.data;if(i){if(e==r)i=!1;else if(!this.lt(r,e)&&this.lt(e,r))return!1}else if(!this.lt(e,r)&&this.lt(r,e))return!1;if(null!=n.next)for(n=n.next;null!=n.prev;)n=n.prev;else{for(;null!=n.parent&&n==n.parent.next;)n=n.parent;n=n.parent}}}if(null!=t.next)for(t=t.next;null!=t.prev;)t=t.prev;else{for(;null!=t.parent&&t==t.parent.next;)t=t.parent;t=t.parent}}}return!0},Nn.prototype.empty=function(){return null==this.parent},Nn.prototype.singular=function(){return null!=this.parent&&null==this.parent.prev&&null==this.parent.next},Nn.prototype.size=function(){var t=0;if(!this.empty()){for(var e=this.parent;null!=e.prev;)e=e.prev;for(;null!=e;)if(++t,null!=e.next)for(e=e.next;null!=e.prev;)e=e.prev;else{for(;null!=e.parent&&e==e.parent.next;)e=e.parent;e=e.parent}}return t},Nn.prototype.has=function(t){return null!=this.find(t)},Nn.prototype.find=function(t){for(var e=this.parent;null!=e&&e.data!=t;)e=this.lt(t,e.data)?e.prev:e.next;return e},Nn.prototype.has_weak=function(t){return null!=this.find_weak(t)},Nn.prototype.find_weak=function(t){for(var e=this.parent;null!=e;)if(this.lt(t,e.data))e=e.prev;else{if(!this.lt(e.data,t))break;e=e.next}return e},Nn.prototype.lower_bound=function(t){var e=null;if(!this.empty()){for(var i=this.parent;null!=i.prev;)i=i.prev;for(;null!=i;){var n=i.data;if(!this.lt(n,t)){e=n;break}if(null!=i.next)for(i=i.next;null!=i.prev;)i=i.prev;else{for(;null!=i.parent&&i==i.parent.next;)i=i.parent;i=i.parent}}}return e},Nn.prototype.first=function(){for(var t=this.parent;null!=t.prev;)t=t.prev;return t.data},Nn.prototype.pop_front=function(){for(var t=this.parent;null!=t.prev;)t=t.prev;var e=t.data;return this.remove_node(t),e},Nn.prototype.remove=function(t){this.remove_node(this.find(t))},Nn.prototype.successor_node=function(t){if(null!=t.next)for(t=t.next;null!=t.prev;)t=t.prev;else{var e=t;for(t=t.parent;null!=t&&t.prev!=e;)t=(e=t).parent}return t},Nn.prototype.predecessor_node=function(t){if(null!=t.prev)for(t=t.prev;null!=t.next;)t=t.next;else{var e=t;for(t=t.parent;null!=t&&t.next!=e;)t=(e=t).parent}return t},Nn.prototype.successor=function(t){t=this.successor_node(this.find(t));return null==t?null:t.data},Nn.prototype.predecessor=function(t){t=this.predecessor_node(this.find(t));return null==t?null:t.data},Nn.prototype.remove_node=function(t){if(null!=t.next&&null!=t.prev){for(var e=t.next;null!=e.prev;)e=e.prev;var i=t.data;t.data=e.data,e.data=i,null!=this.swapped&&this.swapped(t.data,e.data),t=e}var n=null==t.prev?t.next:t.prev;if(1==t.colour)if(null!=t.prev||null!=t.next)n.colour=1;else if(null!=t.parent)for(var r=t.parent;;){r.colour++,r.prev.colour--,r.next.colour--;var o=r.prev;if(-1==o.colour){this.__fix_neg_red(o);break}if(0==o.colour){if(null!=o.prev&&0==o.prev.colour){this.__fix_dbl_red(o.prev);break}if(null!=o.next&&0==o.next.colour){this.__fix_dbl_red(o.next);break}}o=r.next;if(-1==o.colour){this.__fix_neg_red(o);break}if(0==o.colour){if(null!=o.prev&&0==o.prev.colour){this.__fix_dbl_red(o.prev);break}if(null!=o.next&&0==o.next.colour){this.__fix_dbl_red(o.next);break}}if(2==r.colour){if(null!=r.parent){r=r.parent;continue}r.colour=1}break}i=t.parent;null==i?this.parent=n:i.prev==t?i.prev=n:i.next=n,null!=n&&(n.parent=i),t.parent=t.prev=t.next=null;t.data=null,t.lt=null,t.swapped=null,t.next=Nn.zpp_pool,Nn.zpp_pool=t},Nn.prototype.clear=function(){if(null!=this.parent){for(var t,e,i=this.parent;null!=i;)i=null!=i.prev?i.prev:null!=i.next?i.next:(null!=(t=i.parent)&&(i==t.prev?t.prev=null:t.next=null,i.parent=null),(e=i).data=null,e.lt=null,e.swapped=null,e.next=Nn.zpp_pool,Nn.zpp_pool=e,t);this.parent=null}},Nn.prototype.clear_with=function(t){if(null!=this.parent){for(var e,i,n=this.parent;null!=n;)n=null!=n.prev?n.prev:null!=n.next?n.next:(t(n.data),null!=(e=n.parent)&&(n==e.prev?e.prev=null:e.next=null,n.parent=null),(i=n).data=null,i.lt=null,i.swapped=null,i.next=Nn.zpp_pool,Nn.zpp_pool=i,e);this.parent=null}},Nn.prototype.clear_node=function(t,e){e(t.data);e=t.parent;return null!=e&&(t==e.prev?e.prev=null:e.next=null,t.parent=null),t.data=null,t.lt=null,t.swapped=null,t.next=Nn.zpp_pool,Nn.zpp_pool=t,e},Nn.prototype.__fix_neg_red=function(t){var e,i,n,r,o=t.parent,s=o.prev==t?(r=t.prev,e=(n=t.next).prev,i=n.next,r.colour=0,t.colour=o.colour=1,null!=(t.next=e)&&(e.parent=t),e=o.data,o.data=n.data,n.data=e,null!=this.swapped&&this.swapped(o.data,n.data),null!=(n.prev=i)&&(i.parent=n),n.next=o.next,null!=o.next&&(o.next.parent=n),null!=(o.next=n)&&(n.parent=o),r):(s=t.next,n=(i=t.prev).next,r=i.prev,s.colour=0,t.colour=o.colour=1,null!=(t.prev=n)&&(n.parent=t),t=o.data,o.data=i.data,i.data=t,null!=this.swapped&&this.swapped(o.data,i.data),null!=(i.next=r)&&(r.parent=i),i.prev=o.prev,null!=o.prev&&(o.prev.parent=i),null!=(o.prev=i)&&(i.parent=o),s);null!=s.prev&&0==s.prev.colour?this.__fix_dbl_red(s.prev):null!=s.next&&0==s.next.colour&&this.__fix_dbl_red(s.next)},Nn.prototype.__fix_dbl_red=function(t){for(;;){var e,i,n,r,o,s,a,h=t.parent,l=h.parent;if(null==l){h.colour=1;break}h==l.prev?(a=(n=l).next,s=t==h.prev?(r=(e=t).prev,o=t.next,(i=h).next):(i=t,r=(e=h).prev,o=t.prev,t.next)):(r=(e=l).prev,a=t==h.prev?(o=(i=t).prev,s=t.next,(n=h).next):(n=t,o=(i=h).prev,s=t.prev,t.next));h=l.parent;if(null==h?this.parent=i:h.prev==l?h.prev=i:h.next=i,null!=i&&(i.parent=h),null!=(e.prev=r)&&(r.parent=e),null!=(e.next=o)&&(o.parent=e),null!=(i.prev=e)&&(e.parent=i),null!=(i.next=n)&&(n.parent=i),null!=(n.prev=s)&&(s.parent=n),null!=(n.next=a)&&(a.parent=n),i.colour=l.colour-1,e.colour=1,n.colour=1,i==this.parent)this.parent.colour=1;else if(0==i.colour&&0==i.parent.colour){t=i;continue}break}},Nn.prototype.try_insert_bool=function(t){var e=null,i=null;if(null==this.parent)null==Nn.zpp_pool?e=new Nn:(e=Nn.zpp_pool,Nn.zpp_pool=e.next,e.next=null),e.data=t,this.parent=e;else for(i=this.parent;;)if(this.lt(t,i.data)){if(null==i.prev){null==Nn.zpp_pool?e=new Nn:(e=Nn.zpp_pool,Nn.zpp_pool=e.next,e.next=null),e.data=t,(i.prev=e).parent=i;break}i=i.prev}else{if(!this.lt(i.data,t))break;if(null==i.next){null==Nn.zpp_pool?e=new Nn:(e=Nn.zpp_pool,Nn.zpp_pool=e.next,e.next=null),e.data=t,(i.next=e).parent=i;break}i=i.next}return null!=e&&(null==e.parent?e.colour=1:(e.colour=0)==e.parent.colour&&this.__fix_dbl_red(e),!0)},Nn.prototype.try_insert=function(t){var e=null,i=null;if(null==this.parent)null==Nn.zpp_pool?e=new Nn:(e=Nn.zpp_pool,Nn.zpp_pool=e.next,e.next=null),e.data=t,this.parent=e;else for(i=this.parent;;)if(this.lt(t,i.data)){if(null==i.prev){null==Nn.zpp_pool?e=new Nn:(e=Nn.zpp_pool,Nn.zpp_pool=e.next,e.next=null),e.data=t,(i.prev=e).parent=i;break}i=i.prev}else{if(!this.lt(i.data,t))break;if(null==i.next){null==Nn.zpp_pool?e=new Nn:(e=Nn.zpp_pool,Nn.zpp_pool=e.next,e.next=null),e.data=t,(i.next=e).parent=i;break}i=i.next}return null==e?i:(null==e.parent?e.colour=1:(e.colour=0)==e.parent.colour&&this.__fix_dbl_red(e),e)},Nn.prototype.insert=function(t){var e;if(null==Nn.zpp_pool?e=new Nn:(e=Nn.zpp_pool,Nn.zpp_pool=e.next,e.next=null),e.data=t,null==this.parent)this.parent=e;else for(var i=this.parent;;)if(this.lt(e.data,i.data)){if(null==i.prev){(i.prev=e).parent=i;break}i=i.prev}else{if(null==i.next){(i.next=e).parent=i;break}i=i.next}return null==e.parent?e.colour=1:(e.colour=0)==e.parent.colour&&this.__fix_dbl_red(e),e},Nn.prototype.__class__=Nn;var jn=zpp_nape.util.ZPP_Set_ZPP_PartitionPair=function(){this.colour=0,this.parent=null,this.next=null,this.prev=null,this.data=null,this.swapped=null,this.lt=null};jn.__name__=["zpp_nape","util","ZPP_Set_ZPP_PartitionPair"],jn.prototype.free=function(){this.data=null,this.lt=null,this.swapped=null},jn.prototype.alloc=function(){},jn.prototype.lt=null,jn.prototype.swapped=null,jn.prototype.data=null,jn.prototype.prev=null,jn.prototype.next=null,jn.prototype.parent=null,jn.prototype.colour=null,jn.prototype.verify=function(){if(!this.empty()){for(var t=this.parent;null!=t.prev;)t=t.prev;for(;null!=t;){var e=t.data,i=!0;if(!this.empty()){for(var n=this.parent;null!=n.prev;)n=n.prev;for(;null!=n;){var r=n.data;if(i){if(e==r)i=!1;else if(!this.lt(r,e)&&this.lt(e,r))return!1}else if(!this.lt(e,r)&&this.lt(r,e))return!1;if(null!=n.next)for(n=n.next;null!=n.prev;)n=n.prev;else{for(;null!=n.parent&&n==n.parent.next;)n=n.parent;n=n.parent}}}if(null!=t.next)for(t=t.next;null!=t.prev;)t=t.prev;else{for(;null!=t.parent&&t==t.parent.next;)t=t.parent;t=t.parent}}}return!0},jn.prototype.empty=function(){return null==this.parent},jn.prototype.singular=function(){return null!=this.parent&&null==this.parent.prev&&null==this.parent.next},jn.prototype.size=function(){var t=0;if(!this.empty()){for(var e=this.parent;null!=e.prev;)e=e.prev;for(;null!=e;)if(++t,null!=e.next)for(e=e.next;null!=e.prev;)e=e.prev;else{for(;null!=e.parent&&e==e.parent.next;)e=e.parent;e=e.parent}}return t},jn.prototype.has=function(t){return null!=this.find(t)},jn.prototype.find=function(t){for(var e=this.parent;null!=e&&e.data!=t;)e=this.lt(t,e.data)?e.prev:e.next;return e},jn.prototype.has_weak=function(t){return null!=this.find_weak(t)},jn.prototype.find_weak=function(t){for(var e=this.parent;null!=e;)if(this.lt(t,e.data))e=e.prev;else{if(!this.lt(e.data,t))break;e=e.next}return e},jn.prototype.lower_bound=function(t){var e=null;if(!this.empty()){for(var i=this.parent;null!=i.prev;)i=i.prev;for(;null!=i;){var n=i.data;if(!this.lt(n,t)){e=n;break}if(null!=i.next)for(i=i.next;null!=i.prev;)i=i.prev;else{for(;null!=i.parent&&i==i.parent.next;)i=i.parent;i=i.parent}}}return e},jn.prototype.first=function(){for(var t=this.parent;null!=t.prev;)t=t.prev;return t.data},jn.prototype.pop_front=function(){for(var t=this.parent;null!=t.prev;)t=t.prev;var e=t.data;return this.remove_node(t),e},jn.prototype.remove=function(t){this.remove_node(this.find(t))},jn.prototype.successor_node=function(t){if(null!=t.next)for(t=t.next;null!=t.prev;)t=t.prev;else{var e=t;for(t=t.parent;null!=t&&t.prev!=e;)t=(e=t).parent}return t},jn.prototype.predecessor_node=function(t){if(null!=t.prev)for(t=t.prev;null!=t.next;)t=t.next;else{var e=t;for(t=t.parent;null!=t&&t.next!=e;)t=(e=t).parent}return t},jn.prototype.successor=function(t){t=this.successor_node(this.find(t));return null==t?null:t.data},jn.prototype.predecessor=function(t){t=this.predecessor_node(this.find(t));return null==t?null:t.data},jn.prototype.remove_node=function(t){if(null!=t.next&&null!=t.prev){for(var e=t.next;null!=e.prev;)e=e.prev;var i=t.data;t.data=e.data,e.data=i,null!=this.swapped&&this.swapped(t.data,e.data),t=e}var n=null==t.prev?t.next:t.prev;if(1==t.colour)if(null!=t.prev||null!=t.next)n.colour=1;else if(null!=t.parent)for(var r=t.parent;;){r.colour++,r.prev.colour--,r.next.colour--;var o=r.prev;if(-1==o.colour){this.__fix_neg_red(o);break}if(0==o.colour){if(null!=o.prev&&0==o.prev.colour){this.__fix_dbl_red(o.prev);break}if(null!=o.next&&0==o.next.colour){this.__fix_dbl_red(o.next);break}}o=r.next;if(-1==o.colour){this.__fix_neg_red(o);break}if(0==o.colour){if(null!=o.prev&&0==o.prev.colour){this.__fix_dbl_red(o.prev);break}if(null!=o.next&&0==o.next.colour){this.__fix_dbl_red(o.next);break}}if(2==r.colour){if(null!=r.parent){r=r.parent;continue}r.colour=1}break}i=t.parent;null==i?this.parent=n:i.prev==t?i.prev=n:i.next=n,null!=n&&(n.parent=i),t.parent=t.prev=t.next=null;t.data=null,t.lt=null,t.swapped=null,t.next=jn.zpp_pool,jn.zpp_pool=t},jn.prototype.clear=function(){if(null!=this.parent){for(var t,e,i=this.parent;null!=i;)i=null!=i.prev?i.prev:null!=i.next?i.next:(null!=(t=i.parent)&&(i==t.prev?t.prev=null:t.next=null,i.parent=null),(e=i).data=null,e.lt=null,e.swapped=null,e.next=jn.zpp_pool,jn.zpp_pool=e,t);this.parent=null}},jn.prototype.clear_with=function(t){if(null!=this.parent){for(var e,i,n=this.parent;null!=n;)n=null!=n.prev?n.prev:null!=n.next?n.next:(t(n.data),null!=(e=n.parent)&&(n==e.prev?e.prev=null:e.next=null,n.parent=null),(i=n).data=null,i.lt=null,i.swapped=null,i.next=jn.zpp_pool,jn.zpp_pool=i,e);this.parent=null}},jn.prototype.clear_node=function(t,e){e(t.data);e=t.parent;return null!=e&&(t==e.prev?e.prev=null:e.next=null,t.parent=null),t.data=null,t.lt=null,t.swapped=null,t.next=jn.zpp_pool,jn.zpp_pool=t,e},jn.prototype.__fix_neg_red=function(t){var e,i,n,r,o=t.parent,s=o.prev==t?(r=t.prev,e=(n=t.next).prev,i=n.next,r.colour=0,t.colour=o.colour=1,null!=(t.next=e)&&(e.parent=t),e=o.data,o.data=n.data,n.data=e,null!=this.swapped&&this.swapped(o.data,n.data),null!=(n.prev=i)&&(i.parent=n),n.next=o.next,null!=o.next&&(o.next.parent=n),null!=(o.next=n)&&(n.parent=o),r):(s=t.next,n=(i=t.prev).next,r=i.prev,s.colour=0,t.colour=o.colour=1,null!=(t.prev=n)&&(n.parent=t),t=o.data,o.data=i.data,i.data=t,null!=this.swapped&&this.swapped(o.data,i.data),null!=(i.next=r)&&(r.parent=i),i.prev=o.prev,null!=o.prev&&(o.prev.parent=i),null!=(o.prev=i)&&(i.parent=o),s);null!=s.prev&&0==s.prev.colour?this.__fix_dbl_red(s.prev):null!=s.next&&0==s.next.colour&&this.__fix_dbl_red(s.next)},jn.prototype.__fix_dbl_red=function(t){for(;;){var e,i,n,r,o,s,a,h=t.parent,l=h.parent;if(null==l){h.colour=1;break}h==l.prev?(a=(n=l).next,s=t==h.prev?(r=(e=t).prev,o=t.next,(i=h).next):(i=t,r=(e=h).prev,o=t.prev,t.next)):(r=(e=l).prev,a=t==h.prev?(o=(i=t).prev,s=t.next,(n=h).next):(n=t,o=(i=h).prev,s=t.prev,t.next));h=l.parent;if(null==h?this.parent=i:h.prev==l?h.prev=i:h.next=i,null!=i&&(i.parent=h),null!=(e.prev=r)&&(r.parent=e),null!=(e.next=o)&&(o.parent=e),null!=(i.prev=e)&&(e.parent=i),null!=(i.next=n)&&(n.parent=i),null!=(n.prev=s)&&(s.parent=n),null!=(n.next=a)&&(a.parent=n),i.colour=l.colour-1,e.colour=1,n.colour=1,i==this.parent)this.parent.colour=1;else if(0==i.colour&&0==i.parent.colour){t=i;continue}break}},jn.prototype.try_insert_bool=function(t){var e=null,i=null;if(null==this.parent)null==jn.zpp_pool?e=new jn:(e=jn.zpp_pool,jn.zpp_pool=e.next,e.next=null),e.data=t,this.parent=e;else for(i=this.parent;;)if(this.lt(t,i.data)){if(null==i.prev){null==jn.zpp_pool?e=new jn:(e=jn.zpp_pool,jn.zpp_pool=e.next,e.next=null),e.data=t,(i.prev=e).parent=i;break}i=i.prev}else{if(!this.lt(i.data,t))break;if(null==i.next){null==jn.zpp_pool?e=new jn:(e=jn.zpp_pool,jn.zpp_pool=e.next,e.next=null),e.data=t,(i.next=e).parent=i;break}i=i.next}return null!=e&&(null==e.parent?e.colour=1:(e.colour=0)==e.parent.colour&&this.__fix_dbl_red(e),!0)},jn.prototype.try_insert=function(t){var e=null,i=null;if(null==this.parent)null==jn.zpp_pool?e=new jn:(e=jn.zpp_pool,jn.zpp_pool=e.next,e.next=null),e.data=t,this.parent=e;else for(i=this.parent;;)if(this.lt(t,i.data)){if(null==i.prev){null==jn.zpp_pool?e=new jn:(e=jn.zpp_pool,jn.zpp_pool=e.next,e.next=null),e.data=t,(i.prev=e).parent=i;break}i=i.prev}else{if(!this.lt(i.data,t))break;if(null==i.next){null==jn.zpp_pool?e=new jn:(e=jn.zpp_pool,jn.zpp_pool=e.next,e.next=null),e.data=t,(i.next=e).parent=i;break}i=i.next}return null==e?i:(null==e.parent?e.colour=1:(e.colour=0)==e.parent.colour&&this.__fix_dbl_red(e),e)},jn.prototype.insert=function(t){var e;if(null==jn.zpp_pool?e=new jn:(e=jn.zpp_pool,jn.zpp_pool=e.next,e.next=null),e.data=t,null==this.parent)this.parent=e;else for(var i=this.parent;;)if(this.lt(e.data,i.data)){if(null==i.prev){(i.prev=e).parent=i;break}i=i.prev}else{if(null==i.next){(i.next=e).parent=i;break}i=i.next}return null==e.parent?e.colour=1:(e.colour=0)==e.parent.colour&&this.__fix_dbl_red(e),e},jn.prototype.__class__=jn;var Un=zpp_nape.util.ZPP_Set_ZPP_SimpleVert=function(){this.colour=0,this.parent=null,this.next=null,this.prev=null,this.data=null,this.swapped=null,this.lt=null};Un.__name__=["zpp_nape","util","ZPP_Set_ZPP_SimpleVert"],Un.prototype.free=function(){this.data=null,this.lt=null,this.swapped=null},Un.prototype.alloc=function(){},Un.prototype.lt=null,Un.prototype.swapped=null,Un.prototype.data=null,Un.prototype.prev=null,Un.prototype.next=null,Un.prototype.parent=null,Un.prototype.colour=null,Un.prototype.verify=function(){if(!this.empty()){for(var t=this.parent;null!=t.prev;)t=t.prev;for(;null!=t;){var e=t.data,i=!0;if(!this.empty()){for(var n=this.parent;null!=n.prev;)n=n.prev;for(;null!=n;){var r=n.data;if(i){if(e==r)i=!1;else if(!this.lt(r,e)&&this.lt(e,r))return!1}else if(!this.lt(e,r)&&this.lt(r,e))return!1;if(null!=n.next)for(n=n.next;null!=n.prev;)n=n.prev;else{for(;null!=n.parent&&n==n.parent.next;)n=n.parent;n=n.parent}}}if(null!=t.next)for(t=t.next;null!=t.prev;)t=t.prev;else{for(;null!=t.parent&&t==t.parent.next;)t=t.parent;t=t.parent}}}return!0},Un.prototype.empty=function(){return null==this.parent},Un.prototype.singular=function(){return null!=this.parent&&null==this.parent.prev&&null==this.parent.next},Un.prototype.size=function(){var t=0;if(!this.empty()){for(var e=this.parent;null!=e.prev;)e=e.prev;for(;null!=e;)if(++t,null!=e.next)for(e=e.next;null!=e.prev;)e=e.prev;else{for(;null!=e.parent&&e==e.parent.next;)e=e.parent;e=e.parent}}return t},Un.prototype.has=function(t){return null!=this.find(t)},Un.prototype.find=function(t){for(var e=this.parent;null!=e&&e.data!=t;)e=this.lt(t,e.data)?e.prev:e.next;return e},Un.prototype.has_weak=function(t){return null!=this.find_weak(t)},Un.prototype.find_weak=function(t){for(var e=this.parent;null!=e;)if(this.lt(t,e.data))e=e.prev;else{if(!this.lt(e.data,t))break;e=e.next}return e},Un.prototype.lower_bound=function(t){var e=null;if(!this.empty()){for(var i=this.parent;null!=i.prev;)i=i.prev;for(;null!=i;){var n=i.data;if(!this.lt(n,t)){e=n;break}if(null!=i.next)for(i=i.next;null!=i.prev;)i=i.prev;else{for(;null!=i.parent&&i==i.parent.next;)i=i.parent;i=i.parent}}}return e},Un.prototype.first=function(){for(var t=this.parent;null!=t.prev;)t=t.prev;return t.data},Un.prototype.pop_front=function(){for(var t=this.parent;null!=t.prev;)t=t.prev;var e=t.data;return this.remove_node(t),e},Un.prototype.remove=function(t){this.remove_node(this.find(t))},Un.prototype.successor_node=function(t){if(null!=t.next)for(t=t.next;null!=t.prev;)t=t.prev;else{var e=t;for(t=t.parent;null!=t&&t.prev!=e;)t=(e=t).parent}return t},Un.prototype.predecessor_node=function(t){if(null!=t.prev)for(t=t.prev;null!=t.next;)t=t.next;else{var e=t;for(t=t.parent;null!=t&&t.next!=e;)t=(e=t).parent}return t},Un.prototype.successor=function(t){t=this.successor_node(this.find(t));return null==t?null:t.data},Un.prototype.predecessor=function(t){t=this.predecessor_node(this.find(t));return null==t?null:t.data},Un.prototype.remove_node=function(t){if(null!=t.next&&null!=t.prev){for(var e=t.next;null!=e.prev;)e=e.prev;var i=t.data;t.data=e.data,e.data=i,null!=this.swapped&&this.swapped(t.data,e.data),t=e}var n=null==t.prev?t.next:t.prev;if(1==t.colour)if(null!=t.prev||null!=t.next)n.colour=1;else if(null!=t.parent)for(var r=t.parent;;){r.colour++,r.prev.colour--,r.next.colour--;var o=r.prev;if(-1==o.colour){this.__fix_neg_red(o);break}if(0==o.colour){if(null!=o.prev&&0==o.prev.colour){this.__fix_dbl_red(o.prev);break}if(null!=o.next&&0==o.next.colour){this.__fix_dbl_red(o.next);break}}o=r.next;if(-1==o.colour){this.__fix_neg_red(o);break}if(0==o.colour){if(null!=o.prev&&0==o.prev.colour){this.__fix_dbl_red(o.prev);break}if(null!=o.next&&0==o.next.colour){this.__fix_dbl_red(o.next);break}}if(2==r.colour){if(null!=r.parent){r=r.parent;continue}r.colour=1}break}i=t.parent;null==i?this.parent=n:i.prev==t?i.prev=n:i.next=n,null!=n&&(n.parent=i),t.parent=t.prev=t.next=null;t.data=null,t.lt=null,t.swapped=null,t.next=Un.zpp_pool,Un.zpp_pool=t},Un.prototype.clear=function(){if(null!=this.parent){for(var t,e,i=this.parent;null!=i;)i=null!=i.prev?i.prev:null!=i.next?i.next:(null!=(t=i.parent)&&(i==t.prev?t.prev=null:t.next=null,i.parent=null),(e=i).data=null,e.lt=null,e.swapped=null,e.next=Un.zpp_pool,Un.zpp_pool=e,t);this.parent=null}},Un.prototype.clear_with=function(t){if(null!=this.parent){for(var e,i,n=this.parent;null!=n;)n=null!=n.prev?n.prev:null!=n.next?n.next:(t(n.data),null!=(e=n.parent)&&(n==e.prev?e.prev=null:e.next=null,n.parent=null),(i=n).data=null,i.lt=null,i.swapped=null,i.next=Un.zpp_pool,Un.zpp_pool=i,e);this.parent=null}},Un.prototype.clear_node=function(t,e){e(t.data);e=t.parent;return null!=e&&(t==e.prev?e.prev=null:e.next=null,t.parent=null),t.data=null,t.lt=null,t.swapped=null,t.next=Un.zpp_pool,Un.zpp_pool=t,e},Un.prototype.__fix_neg_red=function(t){var e,i,n,r,o=t.parent,s=o.prev==t?(r=t.prev,e=(n=t.next).prev,i=n.next,r.colour=0,t.colour=o.colour=1,null!=(t.next=e)&&(e.parent=t),e=o.data,o.data=n.data,n.data=e,null!=this.swapped&&this.swapped(o.data,n.data),null!=(n.prev=i)&&(i.parent=n),n.next=o.next,null!=o.next&&(o.next.parent=n),null!=(o.next=n)&&(n.parent=o),r):(s=t.next,n=(i=t.prev).next,r=i.prev,s.colour=0,t.colour=o.colour=1,null!=(t.prev=n)&&(n.parent=t),t=o.data,o.data=i.data,i.data=t,null!=this.swapped&&this.swapped(o.data,i.data),null!=(i.next=r)&&(r.parent=i),i.prev=o.prev,null!=o.prev&&(o.prev.parent=i),null!=(o.prev=i)&&(i.parent=o),s);null!=s.prev&&0==s.prev.colour?this.__fix_dbl_red(s.prev):null!=s.next&&0==s.next.colour&&this.__fix_dbl_red(s.next)},Un.prototype.__fix_dbl_red=function(t){for(;;){var e,i,n,r,o,s,a,h=t.parent,l=h.parent;if(null==l){h.colour=1;break}h==l.prev?(a=(n=l).next,s=t==h.prev?(r=(e=t).prev,o=t.next,(i=h).next):(i=t,r=(e=h).prev,o=t.prev,t.next)):(r=(e=l).prev,a=t==h.prev?(o=(i=t).prev,s=t.next,(n=h).next):(n=t,o=(i=h).prev,s=t.prev,t.next));h=l.parent;if(null==h?this.parent=i:h.prev==l?h.prev=i:h.next=i,null!=i&&(i.parent=h),null!=(e.prev=r)&&(r.parent=e),null!=(e.next=o)&&(o.parent=e),null!=(i.prev=e)&&(e.parent=i),null!=(i.next=n)&&(n.parent=i),null!=(n.prev=s)&&(s.parent=n),null!=(n.next=a)&&(a.parent=n),i.colour=l.colour-1,e.colour=1,n.colour=1,i==this.parent)this.parent.colour=1;else if(0==i.colour&&0==i.parent.colour){t=i;continue}break}},Un.prototype.try_insert_bool=function(t){var e=null,i=null;if(null==this.parent)null==Un.zpp_pool?e=new Un:(e=Un.zpp_pool,Un.zpp_pool=e.next,e.next=null),e.data=t,this.parent=e;else for(i=this.parent;;)if(this.lt(t,i.data)){if(null==i.prev){null==Un.zpp_pool?e=new Un:(e=Un.zpp_pool,Un.zpp_pool=e.next,e.next=null),e.data=t,(i.prev=e).parent=i;break}i=i.prev}else{if(!this.lt(i.data,t))break;if(null==i.next){null==Un.zpp_pool?e=new Un:(e=Un.zpp_pool,Un.zpp_pool=e.next,e.next=null),e.data=t,(i.next=e).parent=i;break}i=i.next}return null!=e&&(null==e.parent?e.colour=1:(e.colour=0)==e.parent.colour&&this.__fix_dbl_red(e),!0)},Un.prototype.try_insert=function(t){var e=null,i=null;if(null==this.parent)null==Un.zpp_pool?e=new Un:(e=Un.zpp_pool,Un.zpp_pool=e.next,e.next=null),e.data=t,this.parent=e;else for(i=this.parent;;)if(this.lt(t,i.data)){if(null==i.prev){null==Un.zpp_pool?e=new Un:(e=Un.zpp_pool,Un.zpp_pool=e.next,e.next=null),e.data=t,(i.prev=e).parent=i;break}i=i.prev}else{if(!this.lt(i.data,t))break;if(null==i.next){null==Un.zpp_pool?e=new Un:(e=Un.zpp_pool,Un.zpp_pool=e.next,e.next=null),e.data=t,(i.next=e).parent=i;break}i=i.next}return null==e?i:(null==e.parent?e.colour=1:(e.colour=0)==e.parent.colour&&this.__fix_dbl_red(e),e)},Un.prototype.insert=function(t){var e;if(null==Un.zpp_pool?e=new Un:(e=Un.zpp_pool,Un.zpp_pool=e.next,e.next=null),e.data=t,null==this.parent)this.parent=e;else for(var i=this.parent;;)if(this.lt(e.data,i.data)){if(null==i.prev){(i.prev=e).parent=i;break}i=i.prev}else{if(null==i.next){(i.next=e).parent=i;break}i=i.next}return null==e.parent?e.colour=1:(e.colour=0)==e.parent.colour&&this.__fix_dbl_red(e),e},Un.prototype.__class__=Un;var Vn=zpp_nape.util.ZPP_Set_ZPP_SimpleSeg=function(){this.colour=0,this.parent=null,this.next=null,this.prev=null,this.data=null,this.swapped=null,this.lt=null};Vn.__name__=["zpp_nape","util","ZPP_Set_ZPP_SimpleSeg"],Vn.prototype.free=function(){this.data=null,this.lt=null,this.swapped=null},Vn.prototype.alloc=function(){},Vn.prototype.lt=null,Vn.prototype.swapped=null,Vn.prototype.data=null,Vn.prototype.prev=null,Vn.prototype.next=null,Vn.prototype.parent=null,Vn.prototype.colour=null,Vn.prototype.verify=function(){if(!this.empty()){for(var t=this.parent;null!=t.prev;)t=t.prev;for(;null!=t;){var e=t.data,i=!0;if(!this.empty()){for(var n=this.parent;null!=n.prev;)n=n.prev;for(;null!=n;){var r=n.data;if(i){if(e==r)i=!1;else if(!this.lt(r,e)&&this.lt(e,r))return!1}else if(!this.lt(e,r)&&this.lt(r,e))return!1;if(null!=n.next)for(n=n.next;null!=n.prev;)n=n.prev;else{for(;null!=n.parent&&n==n.parent.next;)n=n.parent;n=n.parent}}}if(null!=t.next)for(t=t.next;null!=t.prev;)t=t.prev;else{for(;null!=t.parent&&t==t.parent.next;)t=t.parent;t=t.parent}}}return!0},Vn.prototype.empty=function(){return null==this.parent},Vn.prototype.singular=function(){return null!=this.parent&&null==this.parent.prev&&null==this.parent.next},Vn.prototype.size=function(){var t=0;if(!this.empty()){for(var e=this.parent;null!=e.prev;)e=e.prev;for(;null!=e;)if(++t,null!=e.next)for(e=e.next;null!=e.prev;)e=e.prev;else{for(;null!=e.parent&&e==e.parent.next;)e=e.parent;e=e.parent}}return t},Vn.prototype.has=function(t){return null!=this.find(t)},Vn.prototype.find=function(t){for(var e=this.parent;null!=e&&e.data!=t;)e=this.lt(t,e.data)?e.prev:e.next;return e},Vn.prototype.has_weak=function(t){return null!=this.find_weak(t)},Vn.prototype.find_weak=function(t){for(var e=this.parent;null!=e;)if(this.lt(t,e.data))e=e.prev;else{if(!this.lt(e.data,t))break;e=e.next}return e},Vn.prototype.lower_bound=function(t){var e=null;if(!this.empty()){for(var i=this.parent;null!=i.prev;)i=i.prev;for(;null!=i;){var n=i.data;if(!this.lt(n,t)){e=n;break}if(null!=i.next)for(i=i.next;null!=i.prev;)i=i.prev;else{for(;null!=i.parent&&i==i.parent.next;)i=i.parent;i=i.parent}}}return e},Vn.prototype.first=function(){for(var t=this.parent;null!=t.prev;)t=t.prev;return t.data},Vn.prototype.pop_front=function(){for(var t=this.parent;null!=t.prev;)t=t.prev;var e=t.data;return this.remove_node(t),e},Vn.prototype.remove=function(t){this.remove_node(this.find(t))},Vn.prototype.successor_node=function(t){if(null!=t.next)for(t=t.next;null!=t.prev;)t=t.prev;else{var e=t;for(t=t.parent;null!=t&&t.prev!=e;)t=(e=t).parent}return t},Vn.prototype.predecessor_node=function(t){if(null!=t.prev)for(t=t.prev;null!=t.next;)t=t.next;else{var e=t;for(t=t.parent;null!=t&&t.next!=e;)t=(e=t).parent}return t},Vn.prototype.successor=function(t){t=this.successor_node(this.find(t));return null==t?null:t.data},Vn.prototype.predecessor=function(t){t=this.predecessor_node(this.find(t));return null==t?null:t.data},Vn.prototype.remove_node=function(t){if(null!=t.next&&null!=t.prev){for(var e=t.next;null!=e.prev;)e=e.prev;var i=t.data;t.data=e.data,e.data=i,null!=this.swapped&&this.swapped(t.data,e.data),t=e}var n=null==t.prev?t.next:t.prev;if(1==t.colour)if(null!=t.prev||null!=t.next)n.colour=1;else if(null!=t.parent)for(var r=t.parent;;){r.colour++,r.prev.colour--,r.next.colour--;var o=r.prev;if(-1==o.colour){this.__fix_neg_red(o);break}if(0==o.colour){if(null!=o.prev&&0==o.prev.colour){this.__fix_dbl_red(o.prev);break}if(null!=o.next&&0==o.next.colour){this.__fix_dbl_red(o.next);break}}o=r.next;if(-1==o.colour){this.__fix_neg_red(o);break}if(0==o.colour){if(null!=o.prev&&0==o.prev.colour){this.__fix_dbl_red(o.prev);break}if(null!=o.next&&0==o.next.colour){this.__fix_dbl_red(o.next);break}}if(2==r.colour){if(null!=r.parent){r=r.parent;continue}r.colour=1}break}i=t.parent;null==i?this.parent=n:i.prev==t?i.prev=n:i.next=n,null!=n&&(n.parent=i),t.parent=t.prev=t.next=null;t.data=null,t.lt=null,t.swapped=null,t.next=Vn.zpp_pool,Vn.zpp_pool=t},Vn.prototype.clear=function(){if(null!=this.parent){for(var t,e,i=this.parent;null!=i;)i=null!=i.prev?i.prev:null!=i.next?i.next:(null!=(t=i.parent)&&(i==t.prev?t.prev=null:t.next=null,i.parent=null),(e=i).data=null,e.lt=null,e.swapped=null,e.next=Vn.zpp_pool,Vn.zpp_pool=e,t);this.parent=null}},Vn.prototype.clear_with=function(t){if(null!=this.parent){for(var e,i,n=this.parent;null!=n;)n=null!=n.prev?n.prev:null!=n.next?n.next:(t(n.data),null!=(e=n.parent)&&(n==e.prev?e.prev=null:e.next=null,n.parent=null),(i=n).data=null,i.lt=null,i.swapped=null,i.next=Vn.zpp_pool,Vn.zpp_pool=i,e);this.parent=null}},Vn.prototype.clear_node=function(t,e){e(t.data);e=t.parent;return null!=e&&(t==e.prev?e.prev=null:e.next=null,t.parent=null),t.data=null,t.lt=null,t.swapped=null,t.next=Vn.zpp_pool,Vn.zpp_pool=t,e},Vn.prototype.__fix_neg_red=function(t){var e,i,n,r,o=t.parent,s=o.prev==t?(r=t.prev,e=(n=t.next).prev,i=n.next,r.colour=0,t.colour=o.colour=1,null!=(t.next=e)&&(e.parent=t),e=o.data,o.data=n.data,n.data=e,null!=this.swapped&&this.swapped(o.data,n.data),null!=(n.prev=i)&&(i.parent=n),n.next=o.next,null!=o.next&&(o.next.parent=n),null!=(o.next=n)&&(n.parent=o),r):(s=t.next,n=(i=t.prev).next,r=i.prev,s.colour=0,t.colour=o.colour=1,null!=(t.prev=n)&&(n.parent=t),t=o.data,o.data=i.data,i.data=t,null!=this.swapped&&this.swapped(o.data,i.data),null!=(i.next=r)&&(r.parent=i),i.prev=o.prev,null!=o.prev&&(o.prev.parent=i),null!=(o.prev=i)&&(i.parent=o),s);null!=s.prev&&0==s.prev.colour?this.__fix_dbl_red(s.prev):null!=s.next&&0==s.next.colour&&this.__fix_dbl_red(s.next)},Vn.prototype.__fix_dbl_red=function(t){for(;;){var e,i,n,r,o,s,a,h=t.parent,l=h.parent;if(null==l){h.colour=1;break}h==l.prev?(a=(n=l).next,s=t==h.prev?(r=(e=t).prev,o=t.next,(i=h).next):(i=t,r=(e=h).prev,o=t.prev,t.next)):(r=(e=l).prev,a=t==h.prev?(o=(i=t).prev,s=t.next,(n=h).next):(n=t,o=(i=h).prev,s=t.prev,t.next));h=l.parent;if(null==h?this.parent=i:h.prev==l?h.prev=i:h.next=i,null!=i&&(i.parent=h),null!=(e.prev=r)&&(r.parent=e),null!=(e.next=o)&&(o.parent=e),null!=(i.prev=e)&&(e.parent=i),null!=(i.next=n)&&(n.parent=i),null!=(n.prev=s)&&(s.parent=n),null!=(n.next=a)&&(a.parent=n),i.colour=l.colour-1,e.colour=1,n.colour=1,i==this.parent)this.parent.colour=1;else if(0==i.colour&&0==i.parent.colour){t=i;continue}break}},Vn.prototype.try_insert_bool=function(t){var e=null,i=null;if(null==this.parent)null==Vn.zpp_pool?e=new Vn:(e=Vn.zpp_pool,Vn.zpp_pool=e.next,e.next=null),e.data=t,this.parent=e;else for(i=this.parent;;)if(this.lt(t,i.data)){if(null==i.prev){null==Vn.zpp_pool?e=new Vn:(e=Vn.zpp_pool,Vn.zpp_pool=e.next,e.next=null),e.data=t,(i.prev=e).parent=i;break}i=i.prev}else{if(!this.lt(i.data,t))break;if(null==i.next){null==Vn.zpp_pool?e=new Vn:(e=Vn.zpp_pool,Vn.zpp_pool=e.next,e.next=null),e.data=t,(i.next=e).parent=i;break}i=i.next}return null!=e&&(null==e.parent?e.colour=1:(e.colour=0)==e.parent.colour&&this.__fix_dbl_red(e),!0)},Vn.prototype.try_insert=function(t){var e=null,i=null;if(null==this.parent)null==Vn.zpp_pool?e=new Vn:(e=Vn.zpp_pool,Vn.zpp_pool=e.next,e.next=null),e.data=t,this.parent=e;else for(i=this.parent;;)if(this.lt(t,i.data)){if(null==i.prev){null==Vn.zpp_pool?e=new Vn:(e=Vn.zpp_pool,Vn.zpp_pool=e.next,e.next=null),e.data=t,(i.prev=e).parent=i;break}i=i.prev}else{if(!this.lt(i.data,t))break;if(null==i.next){null==Vn.zpp_pool?e=new Vn:(e=Vn.zpp_pool,Vn.zpp_pool=e.next,e.next=null),e.data=t,(i.next=e).parent=i;break}i=i.next}return null==e?i:(null==e.parent?e.colour=1:(e.colour=0)==e.parent.colour&&this.__fix_dbl_red(e),e)},Vn.prototype.insert=function(t){var e;if(null==Vn.zpp_pool?e=new Vn:(e=Vn.zpp_pool,Vn.zpp_pool=e.next,e.next=null),e.data=t,null==this.parent)this.parent=e;else for(var i=this.parent;;)if(this.lt(e.data,i.data)){if(null==i.prev){(i.prev=e).parent=i;break}i=i.prev}else{if(null==i.next){(i.next=e).parent=i;break}i=i.next}return null==e.parent?e.colour=1:(e.colour=0)==e.parent.colour&&this.__fix_dbl_red(e),e},Vn.prototype.__class__=Vn;var Wn=zpp_nape.util.ZPP_Set_ZPP_SimpleEvent=function(){this.colour=0,this.parent=null,this.next=null,this.prev=null,this.data=null,this.swapped=null,this.lt=null};Wn.__name__=["zpp_nape","util","ZPP_Set_ZPP_SimpleEvent"],Wn.prototype.free=function(){this.data=null,this.lt=null,this.swapped=null},Wn.prototype.alloc=function(){},Wn.prototype.lt=null,Wn.prototype.swapped=null,Wn.prototype.data=null,Wn.prototype.prev=null,Wn.prototype.next=null,Wn.prototype.parent=null,Wn.prototype.colour=null,Wn.prototype.verify=function(){if(!this.empty()){for(var t=this.parent;null!=t.prev;)t=t.prev;for(;null!=t;){var e=t.data,i=!0;if(!this.empty()){for(var n=this.parent;null!=n.prev;)n=n.prev;for(;null!=n;){var r=n.data;if(i){if(e==r)i=!1;else if(!this.lt(r,e)&&this.lt(e,r))return!1}else if(!this.lt(e,r)&&this.lt(r,e))return!1;if(null!=n.next)for(n=n.next;null!=n.prev;)n=n.prev;else{for(;null!=n.parent&&n==n.parent.next;)n=n.parent;n=n.parent}}}if(null!=t.next)for(t=t.next;null!=t.prev;)t=t.prev;else{for(;null!=t.parent&&t==t.parent.next;)t=t.parent;t=t.parent}}}return!0},Wn.prototype.empty=function(){return null==this.parent},Wn.prototype.singular=function(){return null!=this.parent&&null==this.parent.prev&&null==this.parent.next},Wn.prototype.size=function(){var t=0;if(!this.empty()){for(var e=this.parent;null!=e.prev;)e=e.prev;for(;null!=e;)if(++t,null!=e.next)for(e=e.next;null!=e.prev;)e=e.prev;else{for(;null!=e.parent&&e==e.parent.next;)e=e.parent;e=e.parent}}return t},Wn.prototype.has=function(t){return null!=this.find(t)},Wn.prototype.find=function(t){for(var e=this.parent;null!=e&&e.data!=t;)e=this.lt(t,e.data)?e.prev:e.next;return e},Wn.prototype.has_weak=function(t){return null!=this.find_weak(t)},Wn.prototype.find_weak=function(t){for(var e=this.parent;null!=e;)if(this.lt(t,e.data))e=e.prev;else{if(!this.lt(e.data,t))break;e=e.next}return e},Wn.prototype.lower_bound=function(t){var e=null;if(!this.empty()){for(var i=this.parent;null!=i.prev;)i=i.prev;for(;null!=i;){var n=i.data;if(!this.lt(n,t)){e=n;break}if(null!=i.next)for(i=i.next;null!=i.prev;)i=i.prev;else{for(;null!=i.parent&&i==i.parent.next;)i=i.parent;i=i.parent}}}return e},Wn.prototype.first=function(){for(var t=this.parent;null!=t.prev;)t=t.prev;return t.data},Wn.prototype.pop_front=function(){for(var t=this.parent;null!=t.prev;)t=t.prev;var e=t.data;return this.remove_node(t),e},Wn.prototype.remove=function(t){this.remove_node(this.find(t))},Wn.prototype.successor_node=function(t){if(null!=t.next)for(t=t.next;null!=t.prev;)t=t.prev;else{var e=t;for(t=t.parent;null!=t&&t.prev!=e;)t=(e=t).parent}return t},Wn.prototype.predecessor_node=function(t){if(null!=t.prev)for(t=t.prev;null!=t.next;)t=t.next;else{var e=t;for(t=t.parent;null!=t&&t.next!=e;)t=(e=t).parent}return t},Wn.prototype.successor=function(t){t=this.successor_node(this.find(t));return null==t?null:t.data},Wn.prototype.predecessor=function(t){t=this.predecessor_node(this.find(t));return null==t?null:t.data},Wn.prototype.remove_node=function(t){if(null!=t.next&&null!=t.prev){for(var e=t.next;null!=e.prev;)e=e.prev;var i=t.data;t.data=e.data,e.data=i,null!=this.swapped&&this.swapped(t.data,e.data),t=e}var n=null==t.prev?t.next:t.prev;if(1==t.colour)if(null!=t.prev||null!=t.next)n.colour=1;else if(null!=t.parent)for(var r=t.parent;;){r.colour++,r.prev.colour--,r.next.colour--;var o=r.prev;if(-1==o.colour){this.__fix_neg_red(o);break}if(0==o.colour){if(null!=o.prev&&0==o.prev.colour){this.__fix_dbl_red(o.prev);break}if(null!=o.next&&0==o.next.colour){this.__fix_dbl_red(o.next);break}}o=r.next;if(-1==o.colour){this.__fix_neg_red(o);break}if(0==o.colour){if(null!=o.prev&&0==o.prev.colour){this.__fix_dbl_red(o.prev);break}if(null!=o.next&&0==o.next.colour){this.__fix_dbl_red(o.next);break}}if(2==r.colour){if(null!=r.parent){r=r.parent;continue}r.colour=1}break}i=t.parent;null==i?this.parent=n:i.prev==t?i.prev=n:i.next=n,null!=n&&(n.parent=i),t.parent=t.prev=t.next=null;t.data=null,t.lt=null,t.swapped=null,t.next=Wn.zpp_pool,Wn.zpp_pool=t},Wn.prototype.clear=function(){if(null!=this.parent){for(var t,e,i=this.parent;null!=i;)i=null!=i.prev?i.prev:null!=i.next?i.next:(null!=(t=i.parent)&&(i==t.prev?t.prev=null:t.next=null,i.parent=null),(e=i).data=null,e.lt=null,e.swapped=null,e.next=Wn.zpp_pool,Wn.zpp_pool=e,t);this.parent=null}},Wn.prototype.clear_with=function(t){if(null!=this.parent){for(var e,i,n=this.parent;null!=n;)n=null!=n.prev?n.prev:null!=n.next?n.next:(t(n.data),null!=(e=n.parent)&&(n==e.prev?e.prev=null:e.next=null,n.parent=null),(i=n).data=null,i.lt=null,i.swapped=null,i.next=Wn.zpp_pool,Wn.zpp_pool=i,e);this.parent=null}},Wn.prototype.clear_node=function(t,e){e(t.data);e=t.parent;return null!=e&&(t==e.prev?e.prev=null:e.next=null,t.parent=null),t.data=null,t.lt=null,t.swapped=null,t.next=Wn.zpp_pool,Wn.zpp_pool=t,e},Wn.prototype.__fix_neg_red=function(t){var e,i,n,r,o=t.parent,s=o.prev==t?(r=t.prev,e=(n=t.next).prev,i=n.next,r.colour=0,t.colour=o.colour=1,null!=(t.next=e)&&(e.parent=t),e=o.data,o.data=n.data,n.data=e,null!=this.swapped&&this.swapped(o.data,n.data),null!=(n.prev=i)&&(i.parent=n),n.next=o.next,null!=o.next&&(o.next.parent=n),null!=(o.next=n)&&(n.parent=o),r):(s=t.next,n=(i=t.prev).next,r=i.prev,s.colour=0,t.colour=o.colour=1,null!=(t.prev=n)&&(n.parent=t),t=o.data,o.data=i.data,i.data=t,null!=this.swapped&&this.swapped(o.data,i.data),null!=(i.next=r)&&(r.parent=i),i.prev=o.prev,null!=o.prev&&(o.prev.parent=i),null!=(o.prev=i)&&(i.parent=o),s);null!=s.prev&&0==s.prev.colour?this.__fix_dbl_red(s.prev):null!=s.next&&0==s.next.colour&&this.__fix_dbl_red(s.next)},Wn.prototype.__fix_dbl_red=function(t){for(;;){var e,i,n,r,o,s,a,h=t.parent,l=h.parent;if(null==l){h.colour=1;break}h==l.prev?(a=(n=l).next,s=t==h.prev?(r=(e=t).prev,o=t.next,(i=h).next):(i=t,r=(e=h).prev,o=t.prev,t.next)):(r=(e=l).prev,a=t==h.prev?(o=(i=t).prev,s=t.next,(n=h).next):(n=t,o=(i=h).prev,s=t.prev,t.next));h=l.parent;if(null==h?this.parent=i:h.prev==l?h.prev=i:h.next=i,null!=i&&(i.parent=h),null!=(e.prev=r)&&(r.parent=e),null!=(e.next=o)&&(o.parent=e),null!=(i.prev=e)&&(e.parent=i),null!=(i.next=n)&&(n.parent=i),null!=(n.prev=s)&&(s.parent=n),null!=(n.next=a)&&(a.parent=n),i.colour=l.colour-1,e.colour=1,n.colour=1,i==this.parent)this.parent.colour=1;else if(0==i.colour&&0==i.parent.colour){t=i;continue}break}},Wn.prototype.try_insert_bool=function(t){var e=null,i=null;if(null==this.parent)null==Wn.zpp_pool?e=new Wn:(e=Wn.zpp_pool,Wn.zpp_pool=e.next,e.next=null),e.data=t,this.parent=e;else for(i=this.parent;;)if(this.lt(t,i.data)){if(null==i.prev){null==Wn.zpp_pool?e=new Wn:(e=Wn.zpp_pool,Wn.zpp_pool=e.next,e.next=null),e.data=t,(i.prev=e).parent=i;break}i=i.prev}else{if(!this.lt(i.data,t))break;if(null==i.next){null==Wn.zpp_pool?e=new Wn:(e=Wn.zpp_pool,Wn.zpp_pool=e.next,e.next=null),e.data=t,(i.next=e).parent=i;break}i=i.next}return null!=e&&(null==e.parent?e.colour=1:(e.colour=0)==e.parent.colour&&this.__fix_dbl_red(e),!0)},Wn.prototype.try_insert=function(t){var e=null,i=null;if(null==this.parent)null==Wn.zpp_pool?e=new Wn:(e=Wn.zpp_pool,Wn.zpp_pool=e.next,e.next=null),e.data=t,this.parent=e;else for(i=this.parent;;)if(this.lt(t,i.data)){if(null==i.prev){null==Wn.zpp_pool?e=new Wn:(e=Wn.zpp_pool,Wn.zpp_pool=e.next,e.next=null),e.data=t,(i.prev=e).parent=i;break}i=i.prev}else{if(!this.lt(i.data,t))break;if(null==i.next){null==Wn.zpp_pool?e=new Wn:(e=Wn.zpp_pool,Wn.zpp_pool=e.next,e.next=null),e.data=t,(i.next=e).parent=i;break}i=i.next}return null==e?i:(null==e.parent?e.colour=1:(e.colour=0)==e.parent.colour&&this.__fix_dbl_red(e),e)},Wn.prototype.insert=function(t){var e;if(null==Wn.zpp_pool?e=new Wn:(e=Wn.zpp_pool,Wn.zpp_pool=e.next,e.next=null),e.data=t,null==this.parent)this.parent=e;else for(var i=this.parent;;)if(this.lt(e.data,i.data)){if(null==i.prev){(i.prev=e).parent=i;break}i=i.prev}else{if(null==i.next){(i.next=e).parent=i;break}i=i.next}return null==e.parent?e.colour=1:(e.colour=0)==e.parent.colour&&this.__fix_dbl_red(e),e},Wn.prototype.__class__=Wn;var ar=zpp_nape.util.ZPP_Set_ZPP_CbSet=function(){this.colour=0,this.parent=null,this.next=null,this.prev=null,this.data=null,this.swapped=null,this.lt=null};ar.__name__=["zpp_nape","util","ZPP_Set_ZPP_CbSet"],ar.prototype.free=function(){this.data=null,this.lt=null,this.swapped=null},ar.prototype.alloc=function(){},ar.prototype.lt=null,ar.prototype.swapped=null,ar.prototype.data=null,ar.prototype.prev=null,ar.prototype.next=null,ar.prototype.parent=null,ar.prototype.colour=null,ar.prototype.verify=function(){if(!this.empty()){for(var t=this.parent;null!=t.prev;)t=t.prev;for(;null!=t;){var e=t.data,i=!0;if(!this.empty()){for(var n=this.parent;null!=n.prev;)n=n.prev;for(;null!=n;){var r=n.data;if(i){if(e==r)i=!1;else if(!this.lt(r,e)&&this.lt(e,r))return!1}else if(!this.lt(e,r)&&this.lt(r,e))return!1;if(null!=n.next)for(n=n.next;null!=n.prev;)n=n.prev;else{for(;null!=n.parent&&n==n.parent.next;)n=n.parent;n=n.parent}}}if(null!=t.next)for(t=t.next;null!=t.prev;)t=t.prev;else{for(;null!=t.parent&&t==t.parent.next;)t=t.parent;t=t.parent}}}return!0},ar.prototype.empty=function(){return null==this.parent},ar.prototype.singular=function(){return null!=this.parent&&null==this.parent.prev&&null==this.parent.next},ar.prototype.size=function(){var t=0;if(!this.empty()){for(var e=this.parent;null!=e.prev;)e=e.prev;for(;null!=e;)if(++t,null!=e.next)for(e=e.next;null!=e.prev;)e=e.prev;else{for(;null!=e.parent&&e==e.parent.next;)e=e.parent;e=e.parent}}return t},ar.prototype.has=function(t){return null!=this.find(t)},ar.prototype.find=function(t){for(var e=this.parent;null!=e&&e.data!=t;)e=this.lt(t,e.data)?e.prev:e.next;return e},ar.prototype.has_weak=function(t){return null!=this.find_weak(t)},ar.prototype.find_weak=function(t){for(var e=this.parent;null!=e;)if(this.lt(t,e.data))e=e.prev;else{if(!this.lt(e.data,t))break;e=e.next}return e},ar.prototype.lower_bound=function(t){var e=null;if(!this.empty()){for(var i=this.parent;null!=i.prev;)i=i.prev;for(;null!=i;){var n=i.data;if(!this.lt(n,t)){e=n;break}if(null!=i.next)for(i=i.next;null!=i.prev;)i=i.prev;else{for(;null!=i.parent&&i==i.parent.next;)i=i.parent;i=i.parent}}}return e},ar.prototype.first=function(){for(var t=this.parent;null!=t.prev;)t=t.prev;return t.data},ar.prototype.pop_front=function(){for(var t=this.parent;null!=t.prev;)t=t.prev;var e=t.data;return this.remove_node(t),e},ar.prototype.remove=function(t){this.remove_node(this.find(t))},ar.prototype.successor_node=function(t){if(null!=t.next)for(t=t.next;null!=t.prev;)t=t.prev;else{var e=t;for(t=t.parent;null!=t&&t.prev!=e;)t=(e=t).parent}return t},ar.prototype.predecessor_node=function(t){if(null!=t.prev)for(t=t.prev;null!=t.next;)t=t.next;else{var e=t;for(t=t.parent;null!=t&&t.next!=e;)t=(e=t).parent}return t},ar.prototype.successor=function(t){t=this.successor_node(this.find(t));return null==t?null:t.data},ar.prototype.predecessor=function(t){t=this.predecessor_node(this.find(t));return null==t?null:t.data},ar.prototype.remove_node=function(t){if(null!=t.next&&null!=t.prev){for(var e=t.next;null!=e.prev;)e=e.prev;var i=t.data;t.data=e.data,e.data=i,null!=this.swapped&&this.swapped(t.data,e.data),t=e}var n=null==t.prev?t.next:t.prev;if(1==t.colour)if(null!=t.prev||null!=t.next)n.colour=1;else if(null!=t.parent)for(var r=t.parent;;){r.colour++,r.prev.colour--,r.next.colour--;var o=r.prev;if(-1==o.colour){this.__fix_neg_red(o);break}if(0==o.colour){if(null!=o.prev&&0==o.prev.colour){this.__fix_dbl_red(o.prev);break}if(null!=o.next&&0==o.next.colour){this.__fix_dbl_red(o.next);break}}o=r.next;if(-1==o.colour){this.__fix_neg_red(o);break}if(0==o.colour){if(null!=o.prev&&0==o.prev.colour){this.__fix_dbl_red(o.prev);break}if(null!=o.next&&0==o.next.colour){this.__fix_dbl_red(o.next);break}}if(2==r.colour){if(null!=r.parent){r=r.parent;continue}r.colour=1}break}i=t.parent;null==i?this.parent=n:i.prev==t?i.prev=n:i.next=n,null!=n&&(n.parent=i),t.parent=t.prev=t.next=null;t.data=null,t.lt=null,t.swapped=null,t.next=ar.zpp_pool,ar.zpp_pool=t},ar.prototype.clear=function(){if(null!=this.parent){for(var t,e,i=this.parent;null!=i;)i=null!=i.prev?i.prev:null!=i.next?i.next:(null!=(t=i.parent)&&(i==t.prev?t.prev=null:t.next=null,i.parent=null),(e=i).data=null,e.lt=null,e.swapped=null,e.next=ar.zpp_pool,ar.zpp_pool=e,t);this.parent=null}},ar.prototype.clear_with=function(t){if(null!=this.parent){for(var e,i,n=this.parent;null!=n;)n=null!=n.prev?n.prev:null!=n.next?n.next:(t(n.data),null!=(e=n.parent)&&(n==e.prev?e.prev=null:e.next=null,n.parent=null),(i=n).data=null,i.lt=null,i.swapped=null,i.next=ar.zpp_pool,ar.zpp_pool=i,e);this.parent=null}},ar.prototype.clear_node=function(t,e){e(t.data);e=t.parent;return null!=e&&(t==e.prev?e.prev=null:e.next=null,t.parent=null),t.data=null,t.lt=null,t.swapped=null,t.next=ar.zpp_pool,ar.zpp_pool=t,e},ar.prototype.__fix_neg_red=function(t){var e,i,n,r,o=t.parent,s=o.prev==t?(r=t.prev,e=(n=t.next).prev,i=n.next,r.colour=0,t.colour=o.colour=1,null!=(t.next=e)&&(e.parent=t),e=o.data,o.data=n.data,n.data=e,null!=this.swapped&&this.swapped(o.data,n.data),null!=(n.prev=i)&&(i.parent=n),n.next=o.next,null!=o.next&&(o.next.parent=n),null!=(o.next=n)&&(n.parent=o),r):(s=t.next,n=(i=t.prev).next,r=i.prev,s.colour=0,t.colour=o.colour=1,null!=(t.prev=n)&&(n.parent=t),t=o.data,o.data=i.data,i.data=t,null!=this.swapped&&this.swapped(o.data,i.data),null!=(i.next=r)&&(r.parent=i),i.prev=o.prev,null!=o.prev&&(o.prev.parent=i),null!=(o.prev=i)&&(i.parent=o),s);null!=s.prev&&0==s.prev.colour?this.__fix_dbl_red(s.prev):null!=s.next&&0==s.next.colour&&this.__fix_dbl_red(s.next)},ar.prototype.__fix_dbl_red=function(t){for(;;){var e,i,n,r,o,s,a,h=t.parent,l=h.parent;if(null==l){h.colour=1;break}h==l.prev?(a=(n=l).next,s=t==h.prev?(r=(e=t).prev,o=t.next,(i=h).next):(i=t,r=(e=h).prev,o=t.prev,t.next)):(r=(e=l).prev,a=t==h.prev?(o=(i=t).prev,s=t.next,(n=h).next):(n=t,o=(i=h).prev,s=t.prev,t.next));h=l.parent;if(null==h?this.parent=i:h.prev==l?h.prev=i:h.next=i,null!=i&&(i.parent=h),null!=(e.prev=r)&&(r.parent=e),null!=(e.next=o)&&(o.parent=e),null!=(i.prev=e)&&(e.parent=i),null!=(i.next=n)&&(n.parent=i),null!=(n.prev=s)&&(s.parent=n),null!=(n.next=a)&&(a.parent=n),i.colour=l.colour-1,e.colour=1,n.colour=1,i==this.parent)this.parent.colour=1;else if(0==i.colour&&0==i.parent.colour){t=i;continue}break}},ar.prototype.try_insert_bool=function(t){var e=null,i=null;if(null==this.parent)null==ar.zpp_pool?e=new ar:(e=ar.zpp_pool,ar.zpp_pool=e.next,e.next=null),e.data=t,this.parent=e;else for(i=this.parent;;)if(this.lt(t,i.data)){if(null==i.prev){null==ar.zpp_pool?e=new ar:(e=ar.zpp_pool,ar.zpp_pool=e.next,e.next=null),e.data=t,(i.prev=e).parent=i;break}i=i.prev}else{if(!this.lt(i.data,t))break;if(null==i.next){null==ar.zpp_pool?e=new ar:(e=ar.zpp_pool,ar.zpp_pool=e.next,e.next=null),e.data=t,(i.next=e).parent=i;break}i=i.next}return null!=e&&(null==e.parent?e.colour=1:(e.colour=0)==e.parent.colour&&this.__fix_dbl_red(e),!0)},ar.prototype.try_insert=function(t){var e=null,i=null;if(null==this.parent)null==ar.zpp_pool?e=new ar:(e=ar.zpp_pool,ar.zpp_pool=e.next,e.next=null),e.data=t,this.parent=e;else for(i=this.parent;;)if(this.lt(t,i.data)){if(null==i.prev){null==ar.zpp_pool?e=new ar:(e=ar.zpp_pool,ar.zpp_pool=e.next,e.next=null),e.data=t,(i.prev=e).parent=i;break}i=i.prev}else{if(!this.lt(i.data,t))break;if(null==i.next){null==ar.zpp_pool?e=new ar:(e=ar.zpp_pool,ar.zpp_pool=e.next,e.next=null),e.data=t,(i.next=e).parent=i;break}i=i.next}return null==e?i:(null==e.parent?e.colour=1:(e.colour=0)==e.parent.colour&&this.__fix_dbl_red(e),e)},ar.prototype.insert=function(t){var e;if(null==ar.zpp_pool?e=new ar:(e=ar.zpp_pool,ar.zpp_pool=e.next,e.next=null),e.data=t,null==this.parent)this.parent=e;else for(var i=this.parent;;)if(this.lt(e.data,i.data)){if(null==i.prev){(i.prev=e).parent=i;break}i=i.prev}else{if(null==i.next){(i.next=e).parent=i;break}i=i.next}return null==e.parent?e.colour=1:(e.colour=0)==e.parent.colour&&this.__fix_dbl_red(e),e},ar.prototype.__class__=ar,String.prototype.__class__=String,String.__name__=!0,Array.__name__=!0;var hr={__name__:["Int"]},lr={__name__:["Dynamic"]},pr=Number;pr.__name__=["Float"];var ur=Boolean;ur.__ename__=["Bool"];var dr={__name__:["Class"]},cr={};R.__toStr={}.toString,Er.epsilon=1e-8,Er.fluidAngularDragFriction=2.5,Er.fluidAngularDrag=100,Er.fluidVacuumDrag=.5,Er.fluidLinearDrag=.5,Er.collisionSlop=.2,Er.collisionSlopCCD=.5,Er.distanceThresholdCCD=.05,Er.staticCCDLinearThreshold=.05,Er.staticCCDAngularThreshold=.005,Er.bulletCCDLinearThreshold=.125,Er.bulletCCDAngularThreshold=.0125,Er.dynamicSweepLinearThreshold=17,Er.dynamicSweepAngularThreshold=.6,Er.angularCCDSlipScale=.75,Er.arbiterExpirationDelay=6,Er.staticFrictionThreshold=2,Er.elasticThreshold=20,Er.sleepDelay=60,Er.linearSleepThreshold=.2,Er.angularSleepThreshold=.4,Er.contactBiasCoef=.3,Er.contactStaticBiasCoef=.6,Er.contactContinuousBiasCoef=.4,Er.contactContinuousStaticBiasCoef=.5,Er.constraintLinearSlop=.1,Er.constraintAngularSlop=.001,Er.illConditionedThreshold=2e8,Qt.zpp_pool=Jt.zpp_pool=Zt.zpp_pool=Kt.zpp_pool=Yt.zpp_pool=qt.zpp_pool=Ht.zpp_pool=Xt.zpp_pool=Wt.zpp_pool=Vt.zpp_pool=null,te.zpp_pool=$t.zpp_pool=null,ne.zpp_pool=ie.zpp_pool=ee.zpp_pool=null,_.FMAX=1e100,xt._Constraint=0,xt._Interactor=0,xt._CbType=0,xt._CbSet=0,xt._Listener=0,xt._ZPP_SimpleVert=0,xt._ZPP_SimpleSeg=0,xt._Space=0,xt._InteractionGroup=0,re.zpp_pool=null,Hn.zpp_pool=null,qn.zpp_pool=null,Tt.ANY_SHAPE=new u,Tt.ANY_BODY=new u,Tt.ANY_COMPOUND=new u,Tt.ANY_CONSTRAINT=new u,Yn.internal=!1,Yn.id_ImmState_ACCEPT=1,Yn.id_ImmState_IGNORE=2,Yn.id_ImmState_ALWAYS=4,Yn.id_GravMassMode_DEFAULT=0,Yn.id_GravMassMode_FIXED=1,Yn.id_GravMassMode_SCALED=2,Yn.id_InertiaMode_DEFAULT=0,Yn.id_InertiaMode_FIXED=1,Yn.id_MassMode_DEFAULT=0,Yn.id_MassMode_FIXED=1,Yn.id_BodyType_STATIC=1,Yn.id_BodyType_DYNAMIC=2,Yn.id_BodyType_KINEMATIC=3,Yn.id_ListenerType_BODY=0,Yn.id_PreFlag_ACCEPT=1,Yn.id_ListenerType_CONSTRAINT=1,Yn.id_PreFlag_IGNORE=2,Yn.id_ListenerType_INTERACTION=2,Yn.id_PreFlag_ACCEPT_ONCE=3,Yn.id_ListenerType_PRE=3,Yn.id_PreFlag_IGNORE_ONCE=4,Yn.id_CbEvent_BEGIN=0,Yn.id_InteractionType_COLLISION=1,Yn.id_CbEvent_ONGOING=6,Yn.id_InteractionType_SENSOR=2,Yn.id_CbEvent_END=1,Yn.id_InteractionType_FLUID=4,Yn.id_CbEvent_WAKE=2,Yn.id_InteractionType_ANY=7,Yn.id_CbEvent_SLEEP=3,Yn.id_CbEvent_BREAK=4,Yn.id_CbEvent_PRE=5,Yn.id_Winding_UNDEFINED=0,Yn.id_Winding_CLOCKWISE=1,Yn.id_Winding_ANTICLOCKWISE=2,Yn.id_ValidationResult_VALID=0,Yn.id_ValidationResult_DEGENERATE=1,Yn.id_ValidationResult_CONCAVE=2,Yn.id_ValidationResult_SELF_INTERSECTING=3,Yn.id_ShapeType_CIRCLE=0,Yn.id_ShapeType_POLYGON=1,Yn.id_Broadphase_DYNAMIC_AABB_TREE=0,Yn.id_Broadphase_SWEEP_AND_PRUNE=1,Yn.id_ArbiterType_COLLISION=1,Yn.id_ArbiterType_SENSOR=2,Yn.id_ArbiterType_FLUID=4,At.types=function(){null==Yn.ListenerType_BODY&&(Yn.internal=!0,Yn.ListenerType_BODY=new f,Yn.internal=!1);var t=Yn.ListenerType_BODY;null==Yn.ListenerType_CONSTRAINT&&(Yn.internal=!0,Yn.ListenerType_CONSTRAINT=new f,Yn.internal=!1);var e=Yn.ListenerType_CONSTRAINT;null==Yn.ListenerType_INTERACTION&&(Yn.internal=!0,Yn.ListenerType_INTERACTION=new f,Yn.internal=!1);var i=Yn.ListenerType_INTERACTION;return null==Yn.ListenerType_PRE&&(Yn.internal=!0,Yn.ListenerType_PRE=new f,Yn.internal=!1),[t,e,i,Yn.ListenerType_PRE]}(),At.events=function(){null==Yn.CbEvent_BEGIN&&(Yn.internal=!0,Yn.CbEvent_BEGIN=new p,Yn.internal=!1);var t=Yn.CbEvent_BEGIN;null==Yn.CbEvent_END&&(Yn.internal=!0,Yn.CbEvent_END=new p,Yn.internal=!1);var e=Yn.CbEvent_END;null==Yn.CbEvent_WAKE&&(Yn.internal=!0,Yn.CbEvent_WAKE=new p,Yn.internal=!1);var i=Yn.CbEvent_WAKE;null==Yn.CbEvent_SLEEP&&(Yn.internal=!0,Yn.CbEvent_SLEEP=new p,Yn.internal=!1);var n=Yn.CbEvent_SLEEP;null==Yn.CbEvent_BREAK&&(Yn.internal=!0,Yn.CbEvent_BREAK=new p,Yn.internal=!1);var r=Yn.CbEvent_BREAK;null==Yn.CbEvent_PRE&&(Yn.internal=!0,Yn.CbEvent_PRE=new p,Yn.internal=!1);var o=Yn.CbEvent_PRE;return null==Yn.CbEvent_ONGOING&&(Yn.internal=!0,Yn.CbEvent_ONGOING=new p,Yn.internal=!1),[t,e,i,n,r,o,Yn.CbEvent_ONGOING]}(),Be.UCbSet=new Mt,Be.VCbSet=new Mt,Be.WCbSet=new Mt,Be.UCbType=new Et,Be.VCbType=new Et,Be.WCbType=new Et,Qe.internal=!1,Qe.COL=1,Qe.FLUID=4,Qe.SENSOR=2,Qe.types=function(){null==Yn.ArbiterType_COLLISION&&(Yn.internal=!0,Yn.ArbiterType_COLLISION=new E,Yn.internal=!1);var t=Yn.ArbiterType_COLLISION;null==Yn.ArbiterType_SENSOR&&(Yn.internal=!0,Yn.ArbiterType_SENSOR=new E,Yn.internal=!1);var e=Yn.ArbiterType_SENSOR;return null==Yn.ArbiterType_FLUID&&(Yn.internal=!0,Yn.ArbiterType_FLUID=new E,Yn.internal=!1),[null,t,e,null,Yn.ArbiterType_FLUID]}(),Kn.zpp_pool=null,Zn.zpp_pool=null,Jn.FACE1=0,Jn.FACE2=1,Jn.CIRCLE=2,Jn.zpp_pool=null,Qn.internal=!1,Qn.zpp_pool=null,he.zpp_pool=null,le.SHAPE=1,le.BODY=2,De.zpp_pool=null,Ir.flowpoly=new ue,Ir.flowsegs=new ue,ce.convexPool=null,ce.rayPool=null,ce.internal=!1,gi.zpp_pool=null,fi.zpp_pool=null,xi.ints=null,xi.paths=null,nn.zpp_pool=null,me.zpp_pool=null,ge.zpp_pool=null,rn.zpp_pool=null,on.me=new on,on.look_march=[-1,224,56,216,14,-1,54,214,131,99,-1,91,141,109,181,85],fe.zpp_pool=null,ve.queue=null,ve.edges=null,we.nextId=0,we.zpp_pool=null,ze.zpp_pool=null,Se.zpp_pool=null,Ce.zpp_pool=null,Pe.zpp_pool=null,Te.sweep=null,Te.inthash=null,Te.vertices=null,Te.queue=null,Te.ints=null,Te.list_vertices=null,Te.list_queue=null,Ae.zpp_pool=null,ke.zpp_pool=null,Oe.stack=null,Ee.zpp_pool=null,Ge.zpp_pool=null,Le.queue=null,Le.stack=null,Le.edgeSet=null,Gr.zpp_pool=null,Fe.types=function(){null==Yn.BodyType_STATIC&&(Yn.internal=!0,Yn.BodyType_STATIC=new et,Yn.internal=!1);var t=Yn.BodyType_STATIC;null==Yn.BodyType_DYNAMIC&&(Yn.internal=!0,Yn.BodyType_DYNAMIC=new et,Yn.internal=!1);var e=Yn.BodyType_DYNAMIC;return null==Yn.BodyType_KINEMATIC&&(Yn.internal=!0,Yn.BodyType_KINEMATIC=new et,Yn.internal=!1),[null,t,e,Yn.BodyType_KINEMATIC]}(),Fe.bodystack=null,Fe.bodyset=null,Fe.cur_graph_depth=0,je.zpp_pool=null,Ue.zpp_pool=null,Ue.WAKE=1,Ue.PROPS=2,Ue.ANGDRAG=4,Ue.ARBITERS=8,Ve.types=function(){null==Yn.ShapeType_CIRCLE&&(Yn.internal=!0,Yn.ShapeType_CIRCLE=new mt,Yn.internal=!1);var t=Yn.ShapeType_CIRCLE;return null==Yn.ShapeType_POLYGON&&(Yn.internal=!0,Yn.ShapeType_POLYGON=new mt,Yn.internal=!1),[t,Yn.ShapeType_POLYGON]}(),Xe.zpp_pool=null,Xe.internal=!1,Ye.zpp_pool=null,Ke.zpp_pool=null,Ze.tmpaabb=new De,Je.FATTEN=3,Je.VEL_STEPS=2,$e.zpp_pool=null,ti.zpp_pool=null,tr.zpp_pool=null,ni.zpp_pool=null,hi.zpp_pool=null,Ui.zpp_pool=null,Vi.zpp_pool=null,Wi.zpp_pool=null,Xi.zpp_pool=null,Hi.zpp_pool=null,qi.zpp_pool=null,er.zpp_pool=null,ir.zpp_pool=null,Yi.zpp_pool=null,nr.zpp_pool=null,Ki.zpp_pool=null,Zi.zpp_pool=null,Ji.zpp_pool=null,Qi.zpp_pool=null,$i.zpp_pool=null,tn.zpp_pool=null,en.zpp_pool=null,sn.zpp_pool=null,an.zpp_pool=null,hn.zpp_pool=null,ln.zpp_pool=null,pn.zpp_pool=null,un.zpp_pool=null,dn.zpp_pool=null,cn.zpp_pool=null,yn.zpp_pool=null,rr.zpp_pool=null,or.zpp_pool=null,_n.zpp_pool=null,sr.zpp_pool=null,mn.zpp_pool=null,gn.zpp_pool=null,fn.zpp_pool=null,xn.zpp_pool=null,vn.zpp_pool=null,zn.internal=!1,bn.internal=!1,Sn.internal=!1,Cn.internal=!1,Pn.internal=!1,Mn.internal=!1,Tn.internal=!1,An.internal=!1,kn.internal=!1,On.internal=!1,En.internal=!1,In.internal=!1,Gn.internal=!1,Dn.internal=!1,Ln.internal=!1,Bn.poolGeomPoly=null,Bn.poolVec2=null,Bn.poolVec3=null,Rn.zpp_pool=null,Fn.zpp_pool=null,Nn.zpp_pool=null,jn.zpp_pool=null,Un.zpp_pool=null,Vn.zpp_pool=null,Wn.zpp_pool=null,ar.zpp_pool=null,c.main()}(),function(){function n(t,e,i){return t.call.apply(t.bind,arguments)}function r(e,i,t){if(!e)throw Error();if(2<arguments.length){var n=Array.prototype.slice.call(arguments,2);return function(){var t=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(t,n),e.apply(i,t)}}return function(){return e.apply(i,arguments)}}function y(t,e,i){return(y=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?n:r).apply(null,arguments)}var a=Date.now||function(){return+new Date};function e(t,e){this.a=t,this.o=e||t,this.c=this.o.document}var h=!!window.FontFace;function l(t,e,i,n){if(e=t.c.createElement(e),i)for(var r in i)i.hasOwnProperty(r)&&("style"==r?e.style.cssText=i[r]:e.setAttribute(r,i[r]));return n&&e.appendChild(t.c.createTextNode(n)),e}function p(t,e,i){(t=(t=t.c.getElementsByTagName(e)[0])||document.documentElement).insertBefore(i,t.lastChild)}function i(t){t.parentNode&&t.parentNode.removeChild(t)}function _(t,e,i){e=e||[],i=i||[];for(var n=t.className.split(/\s+/),r=0;r<e.length;r+=1){for(var o=!1,s=0;s<n.length;s+=1)if(e[r]===n[s]){o=!0;break}o||n.push(e[r])}for(e=[],r=0;r<n.length;r+=1){for(o=!1,s=0;s<i.length;s+=1)if(n[r]===i[s]){o=!0;break}o||e.push(n[r])}t.className=e.join(" ").replace(/\s+/g," ").replace(/^\s+|\s+$/,"")}function o(t,e){for(var i=t.className.split(/\s+/),n=0,r=i.length;n<r;n++)if(i[n]==e)return!0;return!1}function u(t,e,i){function n(){s&&r&&(s(o),s=null)}e=l(t,"link",{rel:"stylesheet",href:e,media:"all"});var r=!1,o=null,s=i||null;h?(e.onload=function(){r=!0,n()},e.onerror=function(){r=!0,o=Error("Stylesheet failed to load"),n()}):setTimeout(function(){r=!0,n()},0),p(t,"head",e)}function d(t,e,i,n){var r=t.c.getElementsByTagName("head")[0];if(r){var o=l(t,"script",{src:e}),s=!1;return o.onload=o.onreadystatechange=function(){s||this.readyState&&"loaded"!=this.readyState&&"complete"!=this.readyState||(s=!0,i&&i(null),o.onload=o.onreadystatechange=null,"HEAD"==o.parentNode.tagName&&r.removeChild(o))},r.appendChild(o),setTimeout(function(){s||(s=!0,i&&i(Error("Script load timeout")))},n||5e3),o}return null}function c(){this.a=0,this.c=null}function m(t){return t.a++,function(){t.a--,s(t)}}function g(t,e){t.c=e,s(t)}function s(t){0==t.a&&t.c&&(t.c(),t.c=null)}function f(t){this.a=t||"-"}function x(t,e){this.c=t,this.f=4,this.a="n";e=(e||"n4").match(/^([nio])([1-9])$/i);e&&(this.a=e[1],this.f=parseInt(e[2],10))}function v(t){var e=[];t=t.split(/,\s*/);for(var i=0;i<t.length;i++){var n=t[i].replace(/['"]/g,"");-1!=n.indexOf(" ")||/^\d/.test(n)?e.push("'"+n+"'"):e.push(n)}return e.join(",")}function w(t){return t.a+t.f}function z(t){var e="normal";return"o"===t.a?e="oblique":"i"===t.a&&(e="italic"),e}function b(t,e){this.c=t,this.f=t.o.document.documentElement,this.h=e,this.a=new f("-"),this.j=!1!==e.events,this.g=!1!==e.classes}function S(t){var e,i,n;t.g&&(e=o(t.f,t.a.c("wf","active")),i=[],n=[t.a.c("wf","loading")],e||i.push(t.a.c("wf","inactive")),_(t.f,i,n)),C(t,"inactive")}function C(t,e,i){t.j&&t.h[e]&&(i?t.h[e](i.c,w(i)):t.h[e]())}function P(){this.c={}}function M(t,e){this.c=t,this.f=e,this.a=l(this.c,"span",{"aria-hidden":"true"},this.f)}function T(t){p(t.c,"body",t.a)}function A(t){return"display:block;position:absolute;top:-9999px;left:-9999px;font-size:300px;width:auto;height:auto;line-height:normal;margin:0;padding:0;font-variant:normal;white-space:nowrap;font-family:"+v(t.c)+";font-style:"+z(t)+";font-weight:"+t.f+"00;"}function k(t,e,i,n,r,o){this.g=t,this.j=e,this.a=n,this.c=i,this.f=r||3e3,this.h=o||void 0}function O(t,e,i,n,r,o,s){this.v=t,this.B=e,this.c=i,this.a=n,this.s=s||"BESbswy",this.f={},this.w=r||3e3,this.u=o||null,this.m=this.j=this.h=this.g=null,this.g=new M(this.c,this.s),this.h=new M(this.c,this.s),this.j=new M(this.c,this.s),this.m=new M(this.c,this.s),t=A(t=new x(this.a.c+",serif",w(this.a))),this.g.a.style.cssText=t,t=A(t=new x(this.a.c+",sans-serif",w(this.a))),this.h.a.style.cssText=t,t=A(t=new x("serif",w(this.a))),this.j.a.style.cssText=t,t=A(t=new x("sans-serif",w(this.a))),this.m.a.style.cssText=t,T(this.g),T(this.h),T(this.j),T(this.m)}f.prototype.c=function(t){for(var e=[],i=0;i<arguments.length;i++)e.push(arguments[i].replace(/[\W_]+/g,"").toLowerCase());return e.join(this.a)},k.prototype.start=function(){var r=this.c.o.document,o=this,s=a(),t=new Promise(function(i,n){!function e(){var t;a()-s>=o.f?n():r.fonts.load(z(t=o.a)+" "+t.f+"00 300px "+v(t.c),o.h).then(function(t){1<=t.length?i():setTimeout(e,25)},function(){n()})}()}),i=null,e=new Promise(function(t,e){i=setTimeout(e,o.f)});Promise.race([e,t]).then(function(){i&&(clearTimeout(i),i=null),o.g(o.a)},function(){o.j(o.a)})};var E={D:"serif",C:"sans-serif"},I=null;function G(){var t;return null===I&&(t=/AppleWebKit\/([0-9]+)(?:\.([0-9]+))/.exec(window.navigator.userAgent),I=!!t&&(parseInt(t[1],10)<536||536===parseInt(t[1],10)&&parseInt(t[2],10)<=11)),I}function D(t,e,i){for(var n in E)if(E.hasOwnProperty(n)&&e===t.f[E[n]]&&i===t.f[E[n]])return!0;return!1}function L(t){var e,i=t.g.a.offsetWidth,n=t.h.a.offsetWidth;(e=!(e=i===t.f.serif&&n===t.f["sans-serif"])?G()&&D(t,i,n):e)?a()-t.A>=t.w?G()&&D(t,i,n)&&(null===t.u||t.u.hasOwnProperty(t.a.c))?B(t,t.v):B(t,t.B):setTimeout(y(function(){L(this)},t),50):B(t,t.v)}function B(t,e){setTimeout(y(function(){i(this.g.a),i(this.h.a),i(this.j.a),i(this.m.a),e(this.a)},t),0)}function R(t,e,i){this.c=t,this.a=e,this.f=0,this.m=this.j=!1,this.s=i}O.prototype.start=function(){this.f.serif=this.j.a.offsetWidth,this.f["sans-serif"]=this.m.a.offsetWidth,this.A=a(),L(this)};var F=null;function N(t){0==--t.f&&t.j&&(t.m?((t=t.a).g&&_(t.f,[t.a.c("wf","active")],[t.a.c("wf","loading"),t.a.c("wf","inactive")]),C(t,"active")):S(t.a))}function t(t){this.j=t,this.a=new P,this.h=0,this.f=this.g=!0}function j(t,e){this.c=t,this.a=e}function U(t,e){this.c=t,this.a=e}function V(t,e){this.c=t||"https://fonts.googleapis.com/css",this.a=[],this.f=[],this.g=e||""}R.prototype.g=function(t){var e=this.a;e.g&&_(e.f,[e.a.c("wf",t.c,w(t).toString(),"active")],[e.a.c("wf",t.c,w(t).toString(),"loading"),e.a.c("wf",t.c,w(t).toString(),"inactive")]),C(e,"fontactive",t),this.m=!0,N(this)},R.prototype.h=function(t){var e,i,n,r=this.a;r.g&&(e=o(r.f,r.a.c("wf",t.c,w(t).toString(),"active")),i=[],n=[r.a.c("wf",t.c,w(t).toString(),"loading")],e||i.push(r.a.c("wf",t.c,w(t).toString(),"inactive")),_(r.f,i,n)),C(r,"fontinactive",t),N(this)},t.prototype.load=function(t){this.c=new e(this.j,t.context||this.j),this.g=!1!==t.events,this.f=!1!==t.classes,function(n,t,e){var i=[],r=e.timeout;!function(t){t.g&&_(t.f,[t.a.c("wf","loading")]),C(t,"loading")}(t);var i=function(t,e,i){var n,r,o=[];for(n in e)!e.hasOwnProperty(n)||(r=t.c[n])&&o.push(r(e[n],i));return o}(n.a,e,n.c),o=new R(n.c,t,r);for(n.h=i.length,t=0,e=i.length;t<e;t++)i[t].load(function(t,e,i){var l,p,u,d,c;l=o,p=t,u=e,d=i,c=0==--(i=n).h,(i.f||i.g)&&setTimeout(function(){var t=d||null,e=u||{};if(0===p.length&&c)S(l.a);else{l.f+=p.length,c&&(l.j=c);for(var i=[],n=0;n<p.length;n++){var r,o=p[n],s=e[o.c],a=l.a,h=o;a.g&&_(a.f,[a.a.c("wf",h.c,w(h).toString(),"loading")]),C(a,"fontloading",h),a=(F=(a=null)===F?!!window.FontFace&&(h=/Gecko.*Firefox\/(\d+)/.exec(window.navigator.userAgent),r=/OS X.*Version\/10\..*Safari/.exec(window.navigator.userAgent)&&/Apple/.exec(window.navigator.vendor),h?42<parseInt(h[1],10):!r):F)?new k(y(l.g,l),y(l.h,l),l.c,o,l.s,s):new O(y(l.g,l),y(l.h,l),l.c,o,l.s,t,s),i.push(a)}for(n=0;n<i.length;n++)i[n].start()}},0)})}(this,new b(this.c,t),t)},j.prototype.load=function(s){var a,e=this,h=e.a.projectId,t=e.a.version;h?(a=e.c.o,d(this.c,(e.a.api||"https://fast.fonts.net/jsapi")+"/"+h+".js"+(t?"?v="+t:""),function(t){t?s([]):(a["__MonotypeConfiguration__"+h]=function(){return e.a},function t(){if(a["__mti_fntLst"+h]){var e,i=a["__mti_fntLst"+h](),n=[];if(i)for(var r=0;r<i.length;r++){var o=i[r].fontfamily;null!=i[r].fontStyle&&null!=i[r].fontWeight?(e=i[r].fontStyle+i[r].fontWeight,n.push(new x(o,e))):n.push(new x(o))}s(n)}else setTimeout(function(){t()},50)}())}).id="__MonotypeAPIScript__"+h):s([])},U.prototype.load=function(t){for(var e=this.a.urls||[],i=this.a.families||[],n=this.a.testStrings||{},r=new c,o=0,s=e.length;o<s;o++)u(this.c,e[o],m(r));var a=[];for(o=0,s=i.length;o<s;o++)if((e=i[o].split(":"))[1])for(var h=e[1].split(","),l=0;l<h.length;l+=1)a.push(new x(e[0],h[l]));else a.push(new x(e[0]));g(r,function(){t(a,n)})};function W(t){this.f=t,this.a=[],this.c={}}var X={latin:"BESbswy","latin-ext":"",cyrillic:"",greek:"",khmer:"",Hanuman:""},H={thin:"1",extralight:"2","extra-light":"2",ultralight:"2","ultra-light":"2",light:"3",regular:"4",book:"4",medium:"5","semi-bold":"6",semibold:"6","demi-bold":"6",demibold:"6",bold:"7","extra-bold":"8",extrabold:"8","ultra-bold":"8",ultrabold:"8",black:"9",heavy:"9",l:"3",r:"4",b:"7"},q={i:"i",italic:"i",n:"n",normal:"n"},Y=/^(thin|(?:(?:extra|ultra)-?)?light|regular|book|medium|(?:(?:semi|demi|extra|ultra)-?)?bold|black|heavy|l|r|b|[1-9]00)?(n|i|normal|italic)?$/;function K(t,e){this.c=t,this.a=e}var Z={Arimo:!0,Cousine:!0,Tinos:!0};function J(t,e){this.c=t,this.a=e}function Q(t,e){this.c=t,this.f=e,this.a=[]}K.prototype.load=function(t){var e=new c,i=this.c,n=new V(this.a.api,this.a.text),r=this.a.families;!function(t,e){for(var i=e.length,n=0;n<i;n++){var r=e[n].split(":");3==r.length&&t.f.push(r.pop());var o="";2==r.length&&""!=r[1]&&(o=":"),t.a.push(r.join(o))}}(n,r);var o=new W(r);!function(t){for(var e=t.f.length,i=0;i<e;i++){var n=t.f[i].split(":"),r=n[0].replace(/\+/g," "),o=["n4"];if(2<=n.length){var s,a,h=n[1],l=[];if(h)for(var p=(h=h.split(",")).length,u=0;u<p;u++)(a=!(a=h[u]).match(/^[\w-]+$/)||null==(s=Y.exec(a.toLowerCase()))?"":[a=null==(a=s[2])||""==a?"n":q[a],s=null==(s=s[1])||""==s?"4":H[s]||(isNaN(s)?"4":s.substr(0,1))].join(""))&&l.push(a);0<l.length&&(o=l),3==n.length&&(l=[],0<(n=(n=n[2])?n.split(","):l).length&&(n=X[n[0]])&&(t.c[r]=n))}for(t.c[r]||(n=X[r])&&(t.c[r]=n),n=0;n<o.length;n+=1)t.a.push(new x(r,o[n]))}}(o),u(i,function(t){if(0==t.a.length)throw Error("No fonts to load!");if(-1!=t.c.indexOf("kit="))return t.c;for(var e=t.a.length,i=[],n=0;n<e;n++)i.push(t.a[n].replace(/ /g,"+"));return e=t.c+"?family="+i.join("%7C"),0<t.f.length&&(e+="&subset="+t.f.join(",")),0<t.g.length&&(e+="&text="+encodeURIComponent(t.g)),e}(n),m(e)),g(e,function(){t(o.a,o.c,Z)})},J.prototype.load=function(s){var t=this.a.id,a=this.c.o;t?d(this.c,(this.a.api||"https://use.typekit.net")+"/"+t+".js",function(t){if(t)s([]);else if(a.Typekit&&a.Typekit.config&&a.Typekit.config.fn){t=a.Typekit.config.fn;for(var e=[],i=0;i<t.length;i+=2)for(var n=t[i],r=t[i+1],o=0;o<r.length;o++)e.push(new x(n,r[o]));try{a.Typekit.load({events:!1,classes:!1,async:!0})}catch(t){}s(e)}},2e3):s([])},Q.prototype.load=function(h){var t=this.f.id,e=this.c.o,l=this;t?(e.__webfontfontdeckmodule__||(e.__webfontfontdeckmodule__={}),e.__webfontfontdeckmodule__[t]=function(t,e){for(var i,n,r,o=0,s=e.fonts.length;o<s;++o){var a=e.fonts[o];l.a.push(new x(a.name,(i="font-weight:"+a.weight+";font-style:"+a.style,a=r=n=void 0,n=4,r="n",a=null,i&&((a=i.match(/(normal|oblique|italic)/i))&&a[1]&&(r=a[1].substr(0,1).toLowerCase()),(a=i.match(/([1-9]00|normal|bold)/i))&&a[1]&&(/bold/i.test(a[1])?n=7:/[1-9]00/.test(a[1])&&(n=parseInt(a[1].substr(0,1),10)))),r+n)))}h(l.a)},d(this.c,(this.f.api||"https://f.fontdeck.com/s/css/js/")+((e=this.c).o.location.hostname||e.a.location.hostname)+"/"+t+".js",function(t){t&&h([])})):h([])};var $=new t(window);$.a.c.custom=function(t,e){return new U(e,t)},$.a.c.fontdeck=function(t,e){return new Q(e,t)},$.a.c.monotype=function(t,e){return new j(e,t)},$.a.c.typekit=function(t,e){return new J(e,t)},$.a.c.google=function(t,e){return new K(e,t)};var tt={load:y($.load,$)};"function"==typeof define&&define.amd?define(function(){return tt}):"undefined"!=typeof module&&module.exports?module.exports=tt:(window.WebFont=tt,window.WebFontConfig&&$.load(window.WebFontConfig))}();var __extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(t){var e,i=(e=Phaser.State,__extends(n,e),n.prototype.adjustWorld=function(){var t=Math.min(window.innerWidth/Constants.WIDTH,window.innerHeight/Constants.HEIGHT);this.game.scale.setGameSize(window.innerWidth/t,Constants.HEIGHT),this.game.scale.setUserScale(t,t,0,0),this.camera.bounds.x=-1/0,this.camera.bounds.width=1/0,this.camera.x=-(window.innerWidth/t-Constants.WIDTH)/2,window.innerWidth<window.innerHeight?(this.game.paused=!0,Constants.RotateDevice.visible=!0,h5branding.Hosts.isYandex()&&azIntLoginPrompt&&azIntLoginPrompt.Manager.sendToBack()):(this.game.paused=!1,Constants.RotateDevice.visible=!1,h5branding.Hosts.isYandex()&&azIntLoginPrompt&&azIntLoginPrompt.Manager.bringToFront())},n.prototype.onSizeChange=function(){t.Boot.inSplash||t.Boot.InW==Math.round(window.innerWidth)&&t.Boot.InH==Math.round(window.innerHeight)&&3<t.Boot.NUMRESIZE||(t.Boot.InW=Math.round(window.innerWidth),t.Boot.InH=Math.round(window.innerHeight),GameController.JoypadLeft&&t.Boot.NUMRESIZE++,this.adjustWorld(),t.Boot.PADH=Math.round(-this.camera.x),GameController.AdjustJoypad(),GameController.AdjustPad())},n.prototype.create=function(){this.adjustWorld(),GameController.JoypadLeft&&(GameController.JoypadLeft.visible=GameController.JoypadRight.visible=!1),Constants.stateSwitcher._isSwitchingState&&Constants.stateSwitcher.openCurtains(.1)},n);function n(){return null!==e&&e.apply(this,arguments)||this}t.OzState=i}(states=states||{}),function(t){var e=(i.prototype.initialize=function(t){(t=void 0===t?null:t)&&(this.params=t),this.params?this.setParams(this.params):this._initialized=!0},i.prototype.setParams=function(t){t.view&&(this.view=t.view),t.x&&(this._x=t.x),t.y&&(this._y=t.y),t.group&&(this.group=t.group),t.radius&&(this._radius=t.radius),t.width&&(this._width=t.width),t.height&&(this._height=t.height),t.x instanceof String||t.y instanceof String||t.width instanceof String||(t.height,String),Constants.DEBUG,this._initialized=!0},Object.defineProperty(i.prototype,"inverted",{get:function(){return this._inverted},set:function(t){this._inverted=t,this.view&&(this._inverted?this.view.scale.x=-1:this.view.scale.x=1)},enumerable:!1,configurable:!0}),i.prototype.halfWidth=function(){return 0<this._width?this._width/2:this._radius},i.prototype.halfHeight=function(){return 0<this._height?this._height/2:this._radius},i.prototype.draw=function(){if(this.view)if("center"==this.registration)this.view.x=this._x+this.offsetX,this.view.y=this._y+this.offsetY;else{if("topLeft"!=this.registration)throw Error("NO SUCH REGISTRATION "+this.registration);this.view.x=this._x+this.offsetX,this.view.y=this._y+this.offsetY}},i.prototype.removeArt=function(){this.view&&this.view.parent&&this.view.parent.removeChild(this.view)},i.prototype.update=function(t){this._timeDelta=t},Object.defineProperty(i.prototype,"registration",{get:function(){return this._registration},set:function(t){this._registration=t},enumerable:!1,configurable:!0}),i.prototype.destroy=function(){this._initialized=!1},i);function i(t,e){this._ce=null,this.kill=!1,this.name=t,this.params=e,this.registration="center",this._radius=this.group=this.offsetX=this.offsetY=this._x=this._y=0,this._width=30,this._height=30,this._inverted=this._initialized=this.updateCallEnabled=!1,this.initialize(),this._ce=CitrusEngine.getInstance(),this._initialized=!0}t.CitrusObject=e}(objects=objects||{});var CitrusObject=objects.CitrusObject;!function(n){var u,t=(u=n.OzState,__extends(e,u),e.prototype.create=function(){var t=this;this.prisoners=new Array,this.burgers=0,this.achievementMC=null,this.curHero=null,this.controlsPointer=null,Constants._ce=CitrusEngine.Init(),(Constants.levelState=this)._paused=!1,this.NumSpriteGroups=7,this.groupSprites=new Array;for(var e=0;e<this.NumSpriteGroups;e++)this.groupSprites[e]=new MovieClip(null,0,0),this.game.world.addChild(this.groupSprites[e]);this._objects=new Array,this._nape=new objects.Nape("nape"),this._nape.gravity=new Vec2(0,300),this.addObject(this._nape),(new LevelParseSystem).parseFromJSON(Constants.currentLevel),new objects.FixedBox2(700,-15,10,555),new objects.FixedBox2(-10,-15,10,555),this.topPanel=new TopPanel,this.topPanel.init(),this._black=this.game.add.graphics(0,0),this._black.beginFill(0),this._black.drawRect(0,0,Constants.WIDTH,Constants.HEIGHT),this._black.endFill(),this._black.visible=!1,this.pauseSprite=this.game.add.sprite(Constants.WIDTH/2,.15*Constants.HEIGHT,"mm3_button","titlebox.png"),this.pauseSprite.anchor.set(.5,0);var i=Fabrique.LocalizationHandler.getInstance().getValue("pause"),n=new objects.StyledTranslatedText(this.game,0,.17*Constants.HEIGHT,i,42);n.onOver(),this.pauseSprite.addChild(n),h5branding.Branding.outGoingLinksAllowed()&&(this.brandingLogo=this.game.add.button(-130,226,h5branding.Branding.LOGO_KEY,function(){h5branding.Branding.openCampaignLink(Constants.GOOGLE_APP_NAME,h5branding.UtmTargets.logo)}),this.pauseSprite.addChild(this.brandingLogo));n=new Phaser.Sprite(this.game,0,.35*Constants.HEIGHT,"mm3_button","button_02.png");n.anchor.set(.5),this.pauseSprite.addChild(n);i=Fabrique.LocalizationHandler.getInstance().getValue("map"),n=new objects.StyledTranslatedText(this.game,0,.35*Constants.HEIGHT,i,20,this.goLevels,this);this.pauseSprite.addChild(n);n=new Phaser.Sprite(this.game,0,.7*Constants.HEIGHT,"mm3_button","button_03.png");n.anchor.set(.5),this.pauseSprite.addChild(n),i=Fabrique.LocalizationHandler.getInstance().getValue("back");i=new objects.StyledTranslatedText(this.game,0,.69*Constants.HEIGHT,i,24,this.unShowMenu,this);this.pauseSprite.addChild(i),this.pauseSprite.visible=!1,this.game.world.addChild(this.pauseSprite),this.topPanel._view.getChild("menuButton").makeButton(function(){t.showMenu()},!0,this),this.topPanel._view.getChild("soundButton").makeSoundButton(),this.topPanel._view.getChild("musicButton").makeMusicButton(),this.topPanel._view.getChild("replayButton").makeButton(function(){Fabrique.AdHandler.getInstance().showAd("restart_gui",function(){t.ozRestartLevel()})},!0,this),this.topPanel._view.getChild("walkthroughButton").visible=!1,this._isStarting=!0,this.isFinishing=!1,Constants.hero.controlsEnabled=Constants.dog.controlsEnabled=!1,TweenMax.delayedCall(.1,function(){Constants.hero.controlsEnabled=Constants.dog.controlsEnabled=!0,this._isStarting=!1},this),SoundManager.getInstance().playSound("GameMusic"),this.initFix=!1,this.frUpdate=0,Fabrique.PauseHandler.getInstance().onPauseCallback.add(this.onBlurPause,this)},e.prototype.completeLevel=function(){this.isFinishing||(this.completeActivities(),Constants.levelsComplete[Constants.currentLevel]=!0,this.burgers>Constants.burgers[Constants.currentLevel]&&(Constants.burgers[Constants.currentLevel]=this.burgers),StorageHelper.saveCookies(),TweenMax.delayedCall(1,this.ozGoNextLevel,this))},e.prototype.goWalkthroughIngame=function(){Constants.walkthrough(),this.topPanel._view.getChild("walkthroughButton").changeFrame1()},e.prototype.goLevels=function(){Fabrique.AdHandler.getInstance().showAd("pauseToLevelSelect",function(){Constants.stateSwitcher.switchToLevelSelect()})},e.prototype.onBlurPause=function(){this.showMenu()},e.prototype.showMenu=function(){this._paused||Constants.stateSwitcher._isSwitchingState||(this._paused=!0,this.pauseSprite.visible=!0,this._black.visible=!0,this.pauseAllAnimations(),GameController.Touch()&&GameController.HideJoypad(),TweenMax.pauseAll(),this._black.alpha=0,this.topPanel.disableInput(),TweenMax.to(this._black,.4,{alpha:.5}),TweenMax.to(this.pauseSprite,.4,{y:0,ease:"Quad.easeOut"}))},e.prototype.unShowMenu=function(){var t=this;Fabrique.AdHandler.getInstance().showAd("resume",function(){t._paused=!1,TweenMax.resumeAll(),t.resumeAllAnimations(),GameController.Touch()&&GameController.ShowJoypad(),TweenMax.to(t._black,.25,{alpha:0}),TweenMax.to(t.pauseSprite,.25,{y:-395,onComplete:t.hideMenu,onCompleteContext:t})})},e.prototype.hideMenu=function(){this._black.visible=!1,this.pauseSprite.visible=!1,this.topPanel.enableInput()},e.prototype.pauseAllAnimations=function(){for(var t=0;t<this._objects.length;t++){var e=this._objects[t];e.view&&e.view.animations&&e.view.animations.currentAnim&&(e.view.animations.paused=!0)}},e.prototype.resumeAllAnimations=function(){for(var t=0;t<this._objects.length;t++){var e=this._objects[t];e.view&&e.view.animations&&e.view.animations.currentAnim&&(e.view.animations.paused=!1)}},e.prototype.ozGoNextLevel=function(){this._paused=!0,this.topPanel.disableInput(),Constants.currentLevel==Constants.NUMLEVELS&&140<=StorageHelper.totalPoints()&&null==this.achievementMC?(this.achievementMC=new MovieClip("BurgerAchievementGraphics",0,0,"achievement"),this.world.addChild(this.achievementMC),this.achievementMC.alpha=0,TweenMax.to(this.achievementMC,.5,{alpha:1}),SoundManager.getInstance().playSound("AchievementUnlockedSound"),TweenMax.delayedCall(3,this.ozGoNextLevel,this)):Constants.currentLevel!=Constants.NUMLEVELS-1||Constants.isFinalAnimationPlayed?Constants.stateSwitcher.switchToLevelCompleted():(n.AnimationState.ID_ANIMATION=1,Constants.stateSwitcher.switchToAnimation())},e.prototype.ozRestartLevel=function(){this._paused||Constants.stateSwitcher._isSwitchingState||(Constants.DEBUG?Constants.stateSwitcher.directToPlay():(this._paused=!0,this.topPanel.disableInput(),Constants.stateSwitcher.switchToPlay()))},e.prototype.switchToLevelState=function(){},e.prototype.finishLevelComplete=function(){Constants.isFinalAnimationPlayed||(Constants.currentAnimation=!0,Constants.isFinalAnimationPlayed=!0,StorageHelper.saveCookies())},e.prototype.failLevel=function(){this.isFinishing||(this.completeActivities(),TweenMax.delayedCall(.5,this.loseLevel,this))},e.prototype.loseLevel=function(){this._paused=!0,this.topPanel.disableInput(),Constants.stateSwitcher.switchToLose()},e.prototype.restartLevel=function(){this.isFinishing||this.completeActivities()},e.prototype.goToMenu=function(){this.isFinishing||this.completeActivities()},e.prototype.completeActivities=function(){this.isFinishing=!0,Constants.dog.controlsEnabled=!1,Constants.hero.controlsEnabled=!1},e.prototype.addObject=function(t){t instanceof objects.NapePhysicsObject&&t.addPhysics(),t.view&&this.groupSprites[t.group].addChild(t.view),this._objects.push(t)},e.prototype.removeObject=function(t){t.kill=!0},e.prototype.getObjectByName=function(t){for(var e=0,i=this._objects;e<i.length;e++){var n=i[e];if(n.name==t)return n}return null},e.prototype.getObjectsByName=function(t){for(var e=null,i=0,n=this._objects;i<n.length;i++){var r=n[i];r.name==t&&(e=e||new Array).push(r)}return e},e.prototype.stateUpdate=function(t){t/=1e3;for(var e=[],i=this._objects.length,n=0;n<i;++n){var r=this._objects[n];r.kill?e.push(r):r.updateCallEnabled&&r.update(t)}for(i=e.length,n=0;n<i;++n){var o=e[n];this._objects.splice(this._objects.indexOf(o),1),o.removeArt(),o.destroy()}for(var s=0,a=this._objects;s<a.length;s++)a[s].draw()},e.prototype.butDistSquared=function(t,e){var i=t.worldX-(e.x+e.parent.x-n.Boot.PADH),e=t.worldY-(e.y+e.parent.y);return i*i+e*e},e.prototype.closerBut=function(t,e,i){return!e||this.butDistSquared(t,i)<this.butDistSquared(t,e)?i:e},e.prototype.changeControls=function(){this.curHero?this.curHero==Constants.dog?this.curHero=Constants.hero:this.curHero=Constants.dog:(this.controlsPointer=new MovieClip("cmcActiveSign"),this.groupSprites[Constants.hero.group].addChild(this.controlsPointer),this.curHero=Constants.hero),this.curHero==Constants.hero?(Constants._ce.input.setDoing(Constants.dogInputChannel,"left",!1),Constants._ce.input.setDoing(Constants.dogInputChannel,"right",!1),Constants._ce.input.setDoing(Constants.dogInputChannel,"jump",!1),Constants._ce.input.setDoing(Constants.dogInputChannel,"grabDown",!1),Constants._ce.input.setDoing(Constants.dogInputChannel,"grab",!1),GameController.JoypadRight.getChild("change").gotoAndStop(1)):(Constants._ce.input.setDoing(Constants.hustlerInputChannel,"left",!1),Constants._ce.input.setDoing(Constants.hustlerInputChannel,"right",!1),Constants._ce.input.setDoing(Constants.hustlerInputChannel,"jump",!1),Constants._ce.input.setDoing(Constants.hustlerInputChannel,"down",!1),GameController.JoypadRight.getChild("change").gotoAndStop(2)),GameController.JoypadRight.getChild("grab").visible=!1},e.prototype.update=function(){if(this.frUpdate++,!this.initFix&&1<this.frUpdate&&(this.initFix=!0,u.prototype.create.call(this),GameController.JoypadLeft||(GameController.JoypadLeft=new MovieClip("cmcJoypadLeft"),GameController.JoypadLeft.x=120,GameController.JoypadLeft.y=Constants.HEIGHT-55,this.game.stage.addChild(GameController.JoypadLeft),GameController.JoypadRight=new MovieClip("cmcJoypadRight"),GameController.JoypadRight.x=this.game.width-120,GameController.JoypadRight.y=Constants.HEIGHT-55,this.game.stage.addChild(GameController.JoypadRight),GameController.AdjustJoypad()),GameController.Touch()&&(GameController.JoypadLeft.visible=!0,GameController.JoypadRight.visible=!0,this.changeControls())),this.frUpdate%3!=0)if(this._paused)this.topPanel._lastTime=this.game.time.totalElapsedSeconds();else{if(this.topPanel.tick(),GameController.Touch()&&this.curHero){this.controlsPointer.x=this.curHero.view.x,this.controlsPointer.y=this.curHero.view.y;for(var t=!1,e=!1,i=!1,n=!1,r=!1,o=!1,s=0;s<2;s++){var a=this.game.input.pointers[s],h=null;a.isDown&&(h=this.closerBut(a,h,GameController.JoypadLeft.getChild("left")),h=this.closerBut(a,h,GameController.JoypadLeft.getChild("right")),h=this.closerBut(a,h,GameController.JoypadRight.getChild("up")),h=this.closerBut(a,h,GameController.JoypadRight.getChild("down")),GameController.JoypadRight.getChild("grab").visible&&(h=this.closerBut(a,h,GameController.JoypadRight.getChild("grab"))),h=this.closerBut(a,h,GameController.JoypadRight.getChild("change"))),h&&this.butDistSquared(a,h)<4e4&&("left"==h.name?t=!0:"right"==h.name?e=!0:"up"==h.name?i=!0:"down"==h.name?n=!0:"grab"==h.name?r=!0:"change"==h.name&&(o=!0))}var l=Constants.hustlerInputChannel;this.curHero==Constants.dog&&(l=Constants.dogInputChannel),Constants._ce.input.setDoing(l,"left",t),Constants._ce.input.setDoing(l,"right",e),Constants._ce.input.setDoing(l,"jump",i),Constants._ce.input.setDoing(l,"down",n),Constants._ce.input.setDoing(l,"grabDown",n),Constants._ce.input.setDoing(l,"grab",r),Constants._ce.input.setDoing(0,"change",o),Constants._ce.input.channels[0].change==Constants.frame&&this.changeControls()}if(Constants.frame++,this.stateUpdate(this.game.time.elapsed),!this._isStarting&&Constants._ce.playing&&!this.isFinishing){Constants.DEBUG&&(Input.getInstance().justDid("nextLevel")?(Constants.currentLevel<21?Constants.currentLevel++:Constants.currentLevel=1,Constants.stateSwitcher.directToPlay()):Input.getInstance().justDid("previousLevel")&&(1<Constants.currentLevel?Constants.currentLevel--:Constants.currentLevel=Constants.maxLevel,Constants.stateSwitcher.directToPlay())),Input.getInstance().justDid("restart")&&this.ozRestartLevel();for(var p=!0,s=0;s<this.prisoners.length;s++)this.prisoners[s].isDisabled||(p=!1);p&&this.completeLevel()}}},e.prototype.shutdown=function(){u.prototype.shutdown.call(this);for(var t=this._objects.length,e=0;e<t;++e){var i=this._objects[e];i.view&&(i.removeArt(),i.destroy())}Fabrique.PauseHandler.getInstance().onPauseCallback.remove(this.onBlurPause,this)},e);function e(){return u.call(this)||this}n.LevelState=t}(states=states||{}),function(t){var s,e=(s=t.OzState,__extends(a,s),a.prototype.create=function(){a.NumShown++,SoundManager.getInstance().playSound("MenuMusic"),this.mc=new MovieClip("cmcLevelSelect"),this.game.world.addChild(this.mc),this.mc.getChild("walkthroughButton").visible=!1;var t=this.game.add.sprite(.2*Constants.WIDTH,.9*Constants.HEIGHT,"mm3_button","button_02.png");t.anchor.set(.5),this.mc.addChild(t),this.mc.removeChild(this.mc.getChild("menuButton"));var e=Fabrique.LocalizationHandler.getInstance().getValue("menu"),i=new objects.StyledTranslatedText(this.game,.2*Constants.WIDTH,.9*Constants.HEIGHT,e,20,this.goToMenu,this);this.mc.addChild(i);t=60<=StorageHelper.totalPoints();this.mc.removeChild(this.mc.getChild("youNeed"));i=this.game.add.sprite(.61*Constants.WIDTH,.32*Constants.HEIGHT,"addObjects","youneedmoney.png");i.scale.set(1.1,1.4),i.anchor.set(.5);e=Fabrique.LocalizationHandler.getInstance().getValue("60_bags"),e=new Phaser.Text(this.game,.6*Constants.WIDTH,.32*Constants.HEIGHT,e,{font:"11px ChatNoir",fill:"#ffff00",align:"center",boundsAlignV:"middle"});e.wordWrapWidth=i.width-30,e.wordWrap=!0,e.anchor.set(.5),this.game.add.existing(e);this.burgerText=PhaserGameHelper.getInstance().game.add.text(0,0,"bubu",{font:"22px sc_gum_kidsregular",fill:"#FFFFFF",boundsAlignH:"center",boundsAlignV:"middle"}),this.burgerText.stroke="#291D1D",this.burgerText.strokeThickness=4,this.burgerText.setTextBounds(575,6,108,36),this.burgerText.text=StorageHelper.totalPoints()+(t?" / 140":" / 60"),this.mc.addChild(this.burgerText),s.prototype.create.call(this),this.buts=new Array;for(var n=1;n<21;n++){var r=new MovieClip("hamburgers",2,29),o=this.mc.getChild("l"+n);o.addChild(r),r.gotoAndStop(1+Constants.burgers[n]),this.buts.push(o),Constants.levelsComplete[n]?(o.gotoAndStop(3),o.makeButton(o.clickedLevelSelect,!1,o)):Constants.levelsComplete[n-1]?(o.gotoAndStop(2),o.makeButton(o.clickedLevelSelect,!1,o)):o.gotoAndStop(1),2==o.currentFrameNumber?o.hitArea=new Phaser.Rectangle(0,0,62,50):3==o.currentFrameNumber&&(o.hitArea=new Phaser.Rectangle(0,0,42,50))}t&&(this.mc.getChild("lock").visible=!1,i.visible=!1,e.visible=!1,(e=this.mc.getChild("bonusBag")).name="l21",e.makeButton(e.clickedLevelSelect,!1,e),e.hitArea=new Phaser.Rectangle(0,0,75,75),this.buts.push(e),TweenMax.to(this.mc.getChild("bonusHighlight"),5,{degrees:360,repeat:-1}))},a.prototype.levelSelectClick=function(t){for(var e=0;e<this.buts.length;e++)this.buts[e]==t&&(Constants.currentLevel=e+1);Constants.stateSwitcher.switchToPlay()},a.prototype.goToMenu=function(){Fabrique.AdHandler.getInstance().showAd("back_mainmenu",function(){Constants.stateSwitcher.switchToMainMenu()})},a.NumShown=0,a);function a(){return null!==s&&s.apply(this,arguments)||this}t.LevelSelectState=e}(states=states||{});var MoneyMovers3,LevelState=states.LevelState,Constants=function(){function t(){}return t.sponsor=function(){var t=PhaserGameHelper.getInstance().game;ExternalLink.Utils.openCampaignLink(t,"money-movers-3","logo")},t.walkthrough=function(){OzUtil.GetURL("https://www.agame.com/game/money-movers-3#walkthrough")},t.applyMovieClipData=function(){},t.getSpriteSheetName=function(t){return t&&null!==t?t:"Objects"},t.getLayoutData=function(t){return t&&null!==t?t:ObjectsLayouts.data},t.getLayout=function(t,e){return OzUtil.PE(t,null,"name",e)},t.WIDTH=700,t.HEIGHT=525,t.GAME_KEY="e44bd05f9bbef23699aeaf758160f8ca",t.SECRET_KEY="09002c611b4cdbd0b94bc15977753cf5480e785e",t.GOOGLE_ID="UA-78960661-15",t.GOOGLE_APP_NAME="Money Movers 3",t.GAMEDISTRIBUTION_ID="db770064d7cd45a798b096d4397a0870",t.GAMEDISTRIBUTION_USER="ABD36C6C-E74B-4BA7-BE87-0AB01F98D30D-s1",t.WIDTH_HALF=350,t.HEIGHT_HALF=262.5,t.TILE_SIZE=35,t.NUMLEVELS=21,t.DEBUG=!1,t.RotateDevice=null,t.dogInputChannel=11,t.bouncerInputChannel=11,t.hustlerInputChannel=12,t.frame=0,t.SUPPORTED_LANGUAGES=["en","ru"],t}();!function(t){var i,e=(i=Phaser.Game,__extends(n,i),n.prototype.statePreloader=function(){var e=this;libs.forEach(function(t){e.load.script(t,t)})},n.prototype.stateCreator=function(){var t=this;this.plugins.add(PhaserSuperStorage.StoragePlugin),this.plugins.add(PhaserCachebuster.CacheBuster),this.plugins.add(PhaserSpine.SpinePlugin),PhaserGameHelper.getInstance().init(this),this.state.add("Boot",states.Boot),this.state.add("MainMenu",states.MainMenuState),this.state.add("LevelSelect",states.LevelSelectState),this.state.add("Level",states.LevelState),this.state.add("Animation",states.AnimationState),this.storage.forcePromises=!0;function e(){t.recursiveUpdateText(t.stage)}WebFont.load({custom:{families:["ChatNoir"],urls:["assets/css/ChatNoir.css"]},active:e,inactive:e}),this.state.start("Boot"),this.state.remove("game")},n.prototype.recursiveUpdateText=function(t){var e=this;t instanceof Phaser.Text&&(t.dirty=!0),t.children&&0<t.children.length&&t.children.forEach(function(t){e.recursiveUpdateText(t)})},n);function n(){var e=i.call(this,{enableDebug:!1,width:Constants.WIDTH,height:Constants.HEIGHT,renderer:Phaser.AUTO,parent:"content",transparent:!0,antialias:!0,preserveDrawingBuffer:!1,physicsConfig:null,seed:"",state:null,forceSetTimeOut:!1})||this;return e.clearBeforeRender=!1,Phaser.Device.whenReady(function(){var t=e.device.desktop?"click":"touchstart";document.getElementById("content").addEventListener(t,function(t){e.gameResumed(t)})}),h5branding.SplashLoader.getInstance({gameId:"db770064d7cd45a798b096d4397a0870",gameTitle:Constants.GOOGLE_APP_NAME,gameName:Constants.GOOGLE_APP_NAME,libs:[],version:version,barColor:""}).create().then(function(){Fabrique.LocalizationHandler.getInstance(e).initBrowserDetect(),e.state.add("game",{create:e.stateCreator.bind(e),preload:e.statePreloader.bind(e)},!0)}),e}t.Game=e}(MoneyMovers3=MoneyMovers3||{});var Fabrique,addObjects=function(){function t(){}return t.data={frames:[{filename:"daddy.png",frame:{x:1,y:273,w:220,h:251},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:220,h:251},sourceSize:{w:220,h:251}},{filename:"largebutton.png",frame:{x:1,y:1,w:178,h:54},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:178,h:54},sourceSize:{w:178,h:54}},{filename:"pause.png",frame:{x:223,y:273,w:235,h:371},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:235,h:371},sourceSize:{w:235,h:371}},{filename:"play.png",frame:{x:1,y:61,w:150,h:66},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:150,h:66},sourceSize:{w:150,h:66}},{filename:"smallbutton.png",frame:{x:181,y:1,w:122,h:54},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:122,h:54},sourceSize:{w:122,h:54}},{filename:"title.png",frame:{x:1,y:129,w:484,h:142},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:484,h:142},sourceSize:{w:484,h:142}},{filename:"youneedmoney.png",frame:{x:305,y:1,w:136,h:58},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:136,h:58},sourceSize:{w:136,h:58}}],meta:{app:"https://www.codeandweb.com/texturepacker",version:"1.0",image:"addObjects.png",format:"RGBA8888",size:{w:486,h:645},scale:"1",smartupdate:"$TexturePacker:SmartUpdate:ee6b4c40e1eaf2e461cfc6f48d53aa58:4a38a69ed48e902ec2159eb1e2f18e6e:8d6d12ff4d5234f2a4b19e0a906dbf52$"}},t}(),Levels=function(){function t(){}return t.data=[{"@level":"1","@version":"1.0","@orientation":"orthogonal","@renderorder":"right-down","@width":"20","@height":"15","@tilewidth":"35","@tileheight":"35","@nextobjectid":"118",tileset:[{"@firstgid":"1","@name":"tiles","@tilewidth":"35","@tileheight":"35","@tilecount":"16",tile:[{"@id":"0",image:{"@width":"35","@height":"35","@source":"tiles/singleTile.png"}},{"@id":"1",image:{"@width":"35","@height":"35","@source":"tiles/platformLeft.png"}},{"@id":"2",image:{"@width":"35","@height":"35","@source":"tiles/platformCenter.png"}},{"@id":"3",image:{"@width":"35","@height":"35","@source":"tiles/platformRight.png"}},{"@id":"4",image:{"@width":"35","@height":"35","@source":"tiles/verticalPlatformTop.png"}},{"@id":"5",image:{"@width":"35","@height":"35","@source":"tiles/verticalPlatformCenter.png"}},{"@id":"6",image:{"@width":"35","@height":"35","@source":"tiles/verticalPlatformBottom.png"}},{"@id":"7",image:{"@width":"35","@height":"35","@source":"tiles/tileTopLeft.png"}},{"@id":"8",image:{"@width":"35","@height":"35","@source":"tiles/tileTopCenter.png"}},{"@id":"9",image:{"@width":"35","@height":"35","@source":"tiles/tileTopRight.png"}},{"@id":"10",image:{"@width":"35","@height":"35","@source":"tiles/tileCenterLeft.png"}},{"@id":"11",image:{"@width":"35","@height":"35","@source":"tiles/tileCenter.png"}},{"@id":"12",image:{"@width":"35","@height":"35","@source":"tiles/tileCenterRight.png"}},{"@id":"13",image:{"@width":"35","@height":"35","@source":"tiles/tileBottomLeft.png"}},{"@id":"14",image:{"@width":"35","@height":"35","@source":"tiles/tileBottomCenter.png"}},{"@id":"15",image:{"@width":"35","@height":"35","@source":"tiles/tileBottomRight.png"}}]},{"@firstgid":"17","@name":"active","@tilewidth":"105","@tileheight":"70","@tilecount":"14",tile:[{"@id":"0",image:{"@width":"24","@height":"11","@source":"active/PushButtonGraphics.png"}},{"@id":"1",image:{"@width":"25","@height":"19","@source":"active/TriggerGraphics.png"}},{"@id":"2",image:{"@width":"20","@height":"70","@source":"active/DoorGraphics.png"}},{"@id":"3",image:{"@width":"20","@height":"70","@source":"active/GlassDoorGraphics.png"}},{"@id":"4",image:{"@width":"70","@height":"19","@source":"active/ElevatorGraphics.png"}},{"@id":"5",image:{"@width":"105","@height":"20","@source":"active/BigElevatorGraphics.png"}},{"@id":"6",image:{"@width":"70","@height":"70","@source":"active/ExitGraphics.png"}},{"@id":"7",image:{"@width":"44","@height":"52","@source":"characters/HustlerGraphics.png"}},{"@id":"8",image:{"@width":"32","@height":"22","@source":"active/CameraGraphics.png"}},{"@id":"9",image:{"@width":"15","@height":"15","@source":"characters/EnemyLimiterGraphics.png"}},{"@id":"10",image:{"@width":"31","@height":"34","@source":"passive/MoneyBagGraphics.png"}},{"@id":"11",image:{"@width":"63","@height":"50","@source":"characters/DogGraphics.png"}},{"@id":"12",image:{"@width":"60","@height":"55","@source":"characters/Prisoner2Graphics.png"}},{"@id":"13",image:{"@width":"60","@height":"56","@source":"characters/PrisonerGraphics.png"}}]},{"@firstgid":"31","@name":"passive","@tilewidth":"210","@tileheight":"50","@tilecount":"12",tile:[{"@id":"0",image:{"@width":"50","@height":"50","@source":"passive/BigBoxGraphics.png"}},{"@id":"1",image:{"@width":"35","@height":"35","@source":"passive/BoxGraphics.png"}},{"@id":"2",image:{"@width":"37","@height":"35","@source":"passive/ToiletGraphics.png"}},{"@id":"3",image:{"@width":"35","@height":"35","@source":"passive/MonitorGraphics.png"}},{"@id":"4",image:{"@width":"35","@height":"35","@source":"passive/BasketBallGraphics.png"}},{"@id":"5",image:{"@width":"35","@height":"35","@source":"passive/StoolGraphics.png"}},{"@id":"6",image:{"@width":"150","@height":"20","@source":"passive/PlankGraphics.png"}},{"@id":"7",image:{"@width":"150","@height":"20","@source":"passive/Plank2Graphics.png"}},{"@id":"8",image:{"@width":"210","@height":"20","@source":"passive/BigPlankGraphics.png"}},{"@id":"9",image:{"@width":"100","@height":"20","@source":"passive/Plank5Graphics.png"}},{"@id":"10",image:{"@width":"150","@height":"20","@source":"passive/Plank2Graphics.png"}},{"@id":"11",image:{"@width":"35","@height":"35","@source":"passive/MirrorGraphics.png"}}]},{"@firstgid":"43","@name":"decor","@tilewidth":"232","@tileheight":"136","@tilecount":"48",tile:[{"@id":"0",image:{"@width":"232","@height":"79","@source":"decor/LevelTextGraphics.png"}},{"@id":"1",image:{"@width":"54","@height":"20","@source":"decor/Decor1Graphics.png"}},{"@id":"2",image:{"@width":"54","@height":"20","@source":"decor/Decor2Graphics.png"}},{"@id":"3",image:{"@width":"33","@height":"27","@source":"decor/Decor3Graphics.png"}},{"@id":"4",image:{"@width":"34","@height":"25","@source":"decor/Decor4Graphics.png"}},{"@id":"5",image:{"@width":"22","@height":"31","@source":"decor/Decor5Graphics.png"}},{"@id":"6",image:{"@width":"126","@height":"59","@source":"decor/Decor6Graphics.png"}},{"@id":"7",image:{"@width":"25","@height":"21","@source":"decor/Decor8Graphics.png"}},{"@id":"8",image:{"@width":"18","@height":"22","@source":"decor/Decor9Graphics.png"}},{"@id":"9",image:{"@width":"35","@height":"58","@source":"decor/Decor10Graphics.png"}},{"@id":"10",image:{"@width":"19","@height":"66","@source":"decor/Decor11Graphics.png"}},{"@id":"11",image:{"@width":"23","@height":"33","@source":"decor/Decor12Graphics.png"}},{"@id":"12",image:{"@width":"38","@height":"26","@source":"decor/Decor13Graphics.png"}},{"@id":"13",image:{"@width":"43","@height":"78","@source":"decor/Decor14Graphics.png"}},{"@id":"14",image:{"@width":"60","@height":"86","@source":"decor/Decor15Graphics.png"}},{"@id":"15",image:{"@width":"41","@height":"69","@source":"decor/Decor16Graphics.png"}},{"@id":"16",image:{"@width":"55","@height":"58","@source":"decor/Decor17Graphics.png"}},{"@id":"17",image:{"@width":"57","@height":"54","@source":"decor/Decor18Graphics.png"}},{"@id":"18",image:{"@width":"18","@height":"45","@source":"decor/Decor19Graphics.png"}},{"@id":"19",image:{"@width":"41","@height":"49","@source":"decor/Decor20Graphics.png"}},{"@id":"20",image:{"@width":"51","@height":"38","@source":"decor/Decor21Graphics.png"}},{"@id":"21",image:{"@width":"54","@height":"54","@source":"decor/Decor22Graphics.png"}},{"@id":"22",image:{"@width":"63","@height":"136","@source":"decor/Decor23Graphics.png"}},{"@id":"23",image:{"@width":"21","@height":"39","@source":"decor/Decor24Graphics.png"}},{"@id":"24",image:{"@width":"104","@height":"50","@source":"decor/Decor25Graphics.png"}},{"@id":"25",image:{"@width":"104","@height":"46","@source":"decor/Decor26Graphics.png"}},{"@id":"26",image:{"@width":"86","@height":"38","@source":"decor/Decor27Graphics.png"}},{"@id":"27",image:{"@width":"63","@height":"55","@source":"decor/Decor28Graphics.png"}},{"@id":"28",image:{"@width":"13","@height":"23","@source":"decor/Decor29Graphics.png"}},{"@id":"29",image:{"@width":"28","@height":"40","@source":"decor/Decor30Graphics.png"}},{"@id":"30",image:{"@width":"69","@height":"30","@source":"decor/Decor31Graphics.png"}},{"@id":"31",image:{"@width":"33","@height":"29","@source":"decor/Decor32Graphics.png"}},{"@id":"32",image:{"@width":"42","@height":"42","@source":"decor/Decor33Graphics.png"}},{"@id":"33",image:{"@width":"60","@height":"66","@source":"decor/Decor34Graphics.png"}},{"@id":"34",image:{"@width":"46","@height":"65","@source":"decor/Decor35Graphics.png"}},{"@id":"35",image:{"@width":"71","@height":"55","@source":"decor/Decor36Graphics.png"}},{"@id":"36",image:{"@width":"35","@height":"55","@source":"decor/Decor37Graphics.png"}},{"@id":"37",image:{"@width":"28","@height":"29","@source":"decor/Decor38Graphics.png"}},{"@id":"38",image:{"@width":"38","@height":"37","@source":"decor/Decor39Graphics.png"}},{"@id":"39",image:{"@width":"103","@height":"50","@source":"decor/Decor40Graphics.png"}},{"@id":"40",image:{"@width":"56","@height":"55","@source":"decor/Decor41Graphics.png"}},{"@id":"41",image:{"@width":"71","@height":"50","@source":"decor/Decor42Graphics.png"}},{"@id":"42",image:{"@width":"200","@height":"44","@source":"decor/TxtGraphics.png"}},{"@id":"43",image:{"@width":"97","@height":"69","@source":"decor/Tip1Graphics.png"}},{"@id":"44",image:{"@width":"97","@height":"69","@source":"decor/Tip2Graphics.png"}},{"@id":"45",image:{"@width":"97","@height":"69","@source":"decor/Tip3Graphics.png"}},{"@id":"46",image:{"@width":"97","@height":"69","@source":"decor/Tip4Graphics.png"}},{"@id":"47",image:{"@width":"78","@height":"96","@source":"decor/Tip5Graphics.png"}}]}],imagelayer:{"@name":"background",image:{"@source":"bg/Background1Graphics.png"}},objectgroup:[{"@name":"decorations",object:[{"@id":"1","@gid":"43","@x":"245","@y":"146","@width":"232","@height":"79",properties:{property:{"@name":"text","@value":"level_text_1"}}},{"@id":"114","@gid":"86","@x":"184","@y":"182","@width":"97","@height":"69"},{"@id":"115","@gid":"87","@x":"472","@y":"149","@width":"97","@height":"69"},{"@id":"116","@gid":"88","@x":"147","@y":"488","@width":"97","@height":"69"},{"@id":"117","@gid":"89","@x":"249","@y":"488","@width":"97","@height":"69"}]},{"@name":"tiles",object:[{"@id":"2","@gid":"12","@x":"0","@y":"525","@width":"35","@height":"35"},{"@id":"3","@gid":"12","@x":"35","@y":"525","@width":"35","@height":"35"},{"@id":"4","@gid":"9","@x":"595","@y":"525","@width":"35","@height":"35"},{"@id":"5","@gid":"9","@x":"560","@y":"525","@width":"35","@height":"35"},{"@id":"6","@gid":"9","@x":"490","@y":"525","@width":"35","@height":"35"},{"@id":"7","@gid":"9","@x":"525","@y":"525","@width":"35","@height":"35"},{"@id":"8","@gid":"9","@x":"280","@y":"525","@width":"35","@height":"35"},{"@id":"9","@gid":"9","@x":"350","@y":"525","@width":"35","@height":"35"},{"@id":"10","@gid":"9","@x":"315","@y":"525","@width":"35","@height":"35"},{"@id":"11","@gid":"9","@x":"70","@y":"525","@width":"35","@height":"35"},{"@id":"12","@gid":"9","@x":"175","@y":"525","@width":"35","@height":"35"},{"@id":"13","@gid":"9","@x":"140","@y":"525","@width":"35","@height":"35"},{"@id":"14","@gid":"9","@x":"105","@y":"525","@width":"35","@height":"35"},{"@id":"15","@gid":"9","@x":"210","@y":"525","@width":"35","@height":"35"},{"@id":"16","@gid":"12","@x":"665","@y":"525","@width":"35","@height":"35"},{"@id":"17","@gid":"12","@x":"0","@y":"490","@width":"35","@height":"35"},{"@id":"18","@gid":"9","@x":"455","@y":"525","@width":"35","@height":"35"},{"@id":"19","@gid":"9","@x":"420","@y":"525","@width":"35","@height":"35"},{"@id":"20","@gid":"9","@x":"385","@y":"525","@width":"35","@height":"35"},{"@id":"21","@gid":"9","@x":"630","@y":"525","@width":"35","@height":"35"},{"@id":"22","@gid":"9","@x":"245","@y":"525","@width":"35","@height":"35"},{"@id":"23","@gid":"13","@x":"35","@y":"490","@width":"35","@height":"35"},{"@id":"24","@gid":"9","@x":"105","@y":"385","@width":"35","@height":"35"},{"@id":"25","@gid":"10","@x":"140","@y":"385","@width":"35","@height":"35"},{"@id":"26","@gid":"15","@x":"140","@y":"420","@width":"35","@height":"35"},{"@id":"27","@gid":"3","@x":"175","@y":"420","@width":"35","@height":"35"},{"@id":"28","@gid":"3","@x":"210","@y":"420","@width":"35","@height":"35"},{"@id":"29","@gid":"3","@x":"245","@y":"420","@width":"35","@height":"35"},{"@id":"30","@gid":"3","@x":"280","@y":"420","@width":"35","@height":"35"},{"@id":"31","@gid":"3","@x":"315","@y":"420","@width":"35","@height":"35"},{"@id":"32","@gid":"9","@x":"350","@y":"420","@width":"35","@height":"35"},{"@id":"33","@gid":"10","@x":"385","@y":"420","@width":"35","@height":"35"},{"@id":"34","@gid":"14","@x":"350","@y":"455","@width":"35","@height":"35"},{"@id":"35","@gid":"15","@x":"385","@y":"455","@width":"35","@height":"35"},{"@id":"36","@gid":"3","@x":"420","@y":"455","@width":"35","@height":"35"},{"@id":"37","@gid":"3","@x":"455","@y":"455","@width":"35","@height":"35"},{"@id":"38","@gid":"3","@x":"490","@y":"455","@width":"35","@height":"35"},{"@id":"39","@gid":"3","@x":"560","@y":"420","@width":"35","@height":"35"},{"@id":"40","@gid":"11","@x":"665","@y":"490","@width":"35","@height":"35"},{"@id":"41","@gid":"11","@x":"665","@y":"455","@width":"35","@height":"35"},{"@id":"42","@gid":"11","@x":"665","@y":"420","@width":"35","@height":"35"},{"@id":"43","@gid":"11","@x":"665","@y":"385","@width":"35","@height":"35"},{"@id":"44","@gid":"9","@x":"665","@y":"350","@width":"35","@height":"35"},{"@id":"45","@gid":"3","@x":"630","@y":"350","@width":"35","@height":"35"},{"@id":"46","@gid":"3","@x":"560","@y":"245","@width":"35","@height":"35"},{"@id":"47","@gid":"3","@x":"525","@y":"245","@width":"35","@height":"35"},{"@id":"48","@gid":"3","@x":"490","@y":"245","@width":"35","@height":"35"},{"@id":"49","@gid":"3","@x":"455","@y":"245","@width":"35","@height":"35"},{"@id":"50","@gid":"16","@x":"420","@y":"280","@width":"35","@height":"35"},{"@id":"51","@gid":"3","@x":"350","@y":"280","@width":"35","@height":"35"},{"@id":"52","@gid":"9","@x":"315","@y":"280","@width":"35","@height":"35"},{"@id":"53","@gid":"3","@x":"175","@y":"280","@width":"35","@height":"35"},{"@id":"54","@gid":"3","@x":"210","@y":"280","@width":"35","@height":"35"},{"@id":"55","@gid":"3","@x":"245","@y":"280","@width":"35","@height":"35"},{"@id":"56","@gid":"3","@x":"280","@y":"280","@width":"35","@height":"35"},{"@id":"57","@gid":"8","@x":"105","@y":"280","@width":"35","@height":"35"},{"@id":"58","@gid":"7","@x":"105","@y":"315","@width":"35","@height":"35"},{"@id":"59","@gid":"84","@x":"280","@y":"245","@width":"71","@height":"50"},{"@id":"60","@gid":"79","@x":"576","@y":"483","@width":"35","@height":"55"},{"@id":"61","@gid":"83","@x":"35","@y":"210","@width":"56","@height":"55"},{"@id":"62","@gid":"81","@x":"455","@y":"350","@width":"38","@height":"37"},{"@id":"63","@gid":"62","@x":"490","@y":"315","@width":"41","@height":"49"},{"@id":"64","@gid":"7","@x":"315","@y":"315","@width":"35","@height":"35"},{"@id":"65","@gid":"2","@x":"595","@y":"350","@width":"35","@height":"35"},{"@id":"66","@gid":"4","@x":"595","@y":"420","@width":"35","@height":"35"},{"@id":"67","@gid":"16","@x":"525","@y":"455","@width":"35","@height":"35"},{"@id":"68","@gid":"8","@x":"525","@y":"420","@width":"35","@height":"35"},{"@id":"69","@gid":"4","@x":"595","@y":"245","@width":"35","@height":"35"},{"@id":"70","@gid":"15","@x":"385","@y":"280","@width":"35","@height":"35"},{"@id":"71","@gid":"11","@x":"385","@y":"245","@width":"35","@height":"35"},{"@id":"72","@gid":"6","@x":"385","@y":"210","@width":"35","@height":"35"},{"@id":"73","@gid":"5","@x":"385","@y":"175","@width":"35","@height":"35"},{"@id":"74","@gid":"9","@x":"420","@y":"245","@width":"35","@height":"35"},{"@id":"75","@gid":"7","@x":"105","@y":"175","@width":"35","@height":"35"},{"@id":"76","@gid":"10","@x":"105","@y":"140","@width":"35","@height":"35"},{"@id":"77","@gid":"3","@x":"70","@y":"140","@width":"35","@height":"35"},{"@id":"78","@gid":"3","@x":"35","@y":"140","@width":"35","@height":"35"},{"@id":"79","@gid":"3","@x":"0","@y":"140","@width":"35","@height":"35"},{"@id":"80","@gid":"9","@x":"35","@y":"455","@width":"35","@height":"35"},{"@id":"81","@gid":"16","@x":"105","@y":"455","@width":"35","@height":"35"},{"@id":"82","@gid":"11","@x":"70","@y":"420","@width":"35","@height":"35"},{"@id":"83","@gid":"3","@x":"140","@y":"280","@width":"35","@height":"35"},{"@id":"84","@gid":"9","@x":"0","@y":"455","@width":"35","@height":"35"},{"@id":"85","@gid":"8","@x":"70","@y":"385","@width":"35","@height":"35"},{"@id":"86","@gid":"12","@x":"105","@y":"420","@width":"35","@height":"35"},{"@id":"87","@gid":"15","@x":"70","@y":"455","@width":"35","@height":"35"}]},{"@name":"active",object:[{"@id":"88","@gid":"30","@x":"222","@y":"386","@width":"60","@height":"56"},{"@id":"89","@gid":"20","@x":"323","@y":"386","@width":"20","@height":"70"},{"@id":"90","@type":"3","@gid":"19","@x":"133","@y":"175","@width":"20","@height":"70","@rotation":"180"},{"@id":"91","@gid":"17","@x":"23","@y":"421","@width":"24","@height":"11"},{"@id":"92","@type":"3","@gid":"17","@x":"455","@y":"420","@width":"24","@height":"11"},{"@id":"93","@gid":"27","@x":"318","@y":"178","@width":"31","@height":"34"},{"@id":"94","@gid":"27","@x":"652","@y":"265","@width":"31","@height":"34"},{"@id":"95","@gid":"27","@x":"35","@y":"280","@width":"31","@height":"34"}]},{"@name":"characters",object:[{"@id":"96","@gid":"24","@x":"210","@y":"245","@width":"44","@height":"52"},{"@id":"97","@gid":"28","@x":"490","@y":"210","@width":"63","@height":"50"}]},{"@name":"physics","@visible":"0",object:[{"@id":"98","@x":"0","@y":"420","@width":"70","@height":"105"},{"@id":"99","@x":"70","@y":"385","@width":"70","@height":"70"},{"@id":"100","@x":"70","@y":"490","@width":"630","@height":"35"},{"@id":"101","@x":"70","@y":"350","@width":"105","@height":"35"},{"@id":"102","@x":"140","@y":"385","@width":"280","@height":"35"},{"@id":"103","@x":"350","@y":"420","@width":"210","@height":"35"},{"@id":"104","@x":"525","@y":"385","@width":"105","@height":"35"},{"@id":"105","@x":"105","@y":"245","@width":"350","@height":"35"},{"@id":"106","@x":"0","@y":"105","@width":"105","@height":"35"},{"@id":"107","@x":"385","@y":"140","@width":"35","@height":"105"},{"@id":"108","@x":"595","@y":"315","@width":"70","@height":"35"},{"@id":"109","@x":"665","@y":"315","@width":"35","@height":"175"},{"@id":"110","@x":"105","@y":"280","@width":"35","@height":"35"},{"@id":"111","@x":"315","@y":"280","@width":"35","@height":"35"},{"@id":"112","@x":"105","@y":"105","@width":"35","@height":"70"},{"@id":"113","@x":"420","@y":"210","@width":"210","@height":"35"}]}]},{"@level":"2","@version":"1.0","@orientation":"orthogonal","@renderorder":"right-down","@width":"20","@height":"15","@tilewidth":"35","@tileheight":"35","@nextobjectid":"129",tileset:[{"@firstgid":"1","@name":"tiles","@tilewidth":"35","@tileheight":"35","@tilecount":"16",tile:[{"@id":"0",image:{"@width":"35","@height":"35","@source":"tiles/singleTile.png"}},{"@id":"1",image:{"@width":"35","@height":"35","@source":"tiles/platformLeft.png"}},{"@id":"2",image:{"@width":"35","@height":"35","@source":"tiles/platformCenter.png"}},{"@id":"3",image:{"@width":"35","@height":"35","@source":"tiles/platformRight.png"}},{"@id":"4",image:{"@width":"35","@height":"35","@source":"tiles/verticalPlatformTop.png"}},{"@id":"5",image:{"@width":"35","@height":"35","@source":"tiles/verticalPlatformCenter.png"}},{"@id":"6",image:{"@width":"35","@height":"35","@source":"tiles/verticalPlatformBottom.png"}},{"@id":"7",image:{"@width":"35","@height":"35","@source":"tiles/tileTopLeft.png"}},{"@id":"8",image:{"@width":"35","@height":"35","@source":"tiles/tileTopCenter.png"}},{"@id":"9",image:{"@width":"35","@height":"35","@source":"tiles/tileTopRight.png"}},{"@id":"10",image:{"@width":"35","@height":"35","@source":"tiles/tileCenterLeft.png"}},{"@id":"11",image:{"@width":"35","@height":"35","@source":"tiles/tileCenter.png"}},{"@id":"12",image:{"@width":"35","@height":"35","@source":"tiles/tileCenterRight.png"}},{"@id":"13",image:{"@width":"35","@height":"35","@source":"tiles/tileBottomLeft.png"}},{"@id":"14",image:{"@width":"35","@height":"35","@source":"tiles/tileBottomCenter.png"}},{"@id":"15",image:{"@width":"35","@height":"35","@source":"tiles/tileBottomRight.png"}}]},{"@firstgid":"17","@name":"active","@tilewidth":"105","@tileheight":"70","@tilecount":"14",tile:[{"@id":"0",image:{"@width":"24","@height":"11","@source":"active/PushButtonGraphics.png"}},{"@id":"1",image:{"@width":"25","@height":"19","@source":"active/TriggerGraphics.png"}},{"@id":"2",image:{"@width":"20","@height":"70","@source":"active/DoorGraphics.png"}},{"@id":"3",image:{"@width":"20","@height":"70","@source":"active/GlassDoorGraphics.png"}},{"@id":"4",image:{"@width":"70","@height":"19","@source":"active/ElevatorGraphics.png"}},{"@id":"5",image:{"@width":"105","@height":"20","@source":"active/BigElevatorGraphics.png"}},{"@id":"6",image:{"@width":"70","@height":"70","@source":"active/ExitGraphics.png"}},{"@id":"7",image:{"@width":"44","@height":"52","@source":"characters/HustlerGraphics.png"}},{"@id":"8",image:{"@width":"32","@height":"22","@source":"active/CameraGraphics.png"}},{"@id":"9",image:{"@width":"15","@height":"15","@source":"characters/EnemyLimiterGraphics.png"}},{"@id":"10",image:{"@width":"31","@height":"34","@source":"passive/MoneyBagGraphics.png"}},{"@id":"11",image:{"@width":"63","@height":"50","@source":"characters/DogGraphics.png"}},{"@id":"12",image:{"@width":"60","@height":"55","@source":"characters/Prisoner2Graphics.png"}},{"@id":"13",image:{"@width":"60","@height":"56","@source":"characters/PrisonerGraphics.png"}}]},{"@firstgid":"31","@name":"passive","@tilewidth":"210","@tileheight":"50","@tilecount":"12",tile:[{"@id":"0",image:{"@width":"50","@height":"50","@source":"passive/BigBoxGraphics.png"}},{"@id":"1",image:{"@width":"35","@height":"35","@source":"passive/BoxGraphics.png"}},{"@id":"2",image:{"@width":"37","@height":"35","@source":"passive/ToiletGraphics.png"}},{"@id":"3",image:{"@width":"35","@height":"35","@source":"passive/MonitorGraphics.png"}},{"@id":"4",image:{"@width":"35","@height":"35","@source":"passive/BasketBallGraphics.png"}},{"@id":"5",image:{"@width":"35","@height":"35","@source":"passive/StoolGraphics.png"}},{"@id":"6",image:{"@width":"150","@height":"20","@source":"passive/PlankGraphics.png"}},{"@id":"7",image:{"@width":"150","@height":"20","@source":"passive/Plank2Graphics.png"}},{"@id":"8",image:{"@width":"210","@height":"20","@source":"passive/BigPlankGraphics.png"}},{"@id":"9",image:{"@width":"100","@height":"20","@source":"passive/Plank5Graphics.png"}},{"@id":"10",image:{"@width":"150","@height":"20","@source":"passive/Plank2Graphics.png"}},{"@id":"11",image:{"@width":"35","@height":"35","@source":"passive/MirrorGraphics.png"}}]},{"@firstgid":"43","@name":"decor","@tilewidth":"232","@tileheight":"136","@tilecount":"46",tile:[{"@id":"0",image:{"@width":"232","@height":"79","@source":"decor/LevelTextGraphics.png"}},{"@id":"1",image:{"@width":"54","@height":"20","@source":"decor/Decor1Graphics.png"}},{"@id":"2",image:{"@width":"54","@height":"20","@source":"decor/Decor2Graphics.png"}},{"@id":"3",image:{"@width":"33","@height":"27","@source":"decor/Decor3Graphics.png"}},{"@id":"4",image:{"@width":"34","@height":"25","@source":"decor/Decor4Graphics.png"}},{"@id":"5",image:{"@width":"22","@height":"31","@source":"decor/Decor5Graphics.png"}},{"@id":"6",image:{"@width":"126","@height":"59","@source":"decor/Decor6Graphics.png"}},{"@id":"7",image:{"@width":"25","@height":"21","@source":"decor/Decor8Graphics.png"}},{"@id":"8",image:{"@width":"18","@height":"22","@source":"decor/Decor9Graphics.png"}},{"@id":"9",image:{"@width":"35","@height":"58","@source":"decor/Decor10Graphics.png"}},{"@id":"10",image:{"@width":"19","@height":"66","@source":"decor/Decor11Graphics.png"}},{"@id":"11",image:{"@width":"23","@height":"33","@source":"decor/Decor12Graphics.png"}},{"@id":"12",image:{"@width":"38","@height":"26","@source":"decor/Decor13Graphics.png"}},{"@id":"13",image:{"@width":"43","@height":"78","@source":"decor/Decor14Graphics.png"}},{"@id":"14",image:{"@width":"60","@height":"86","@source":"decor/Decor15Graphics.png"}},{"@id":"15",image:{"@width":"41","@height":"69","@source":"decor/Decor16Graphics.png"}},{"@id":"16",image:{"@width":"55","@height":"58","@source":"decor/Decor17Graphics.png"}},{"@id":"17",image:{"@width":"57","@height":"54","@source":"decor/Decor18Graphics.png"}},{"@id":"18",image:{"@width":"18","@height":"45","@source":"decor/Decor19Graphics.png"}},{"@id":"19",image:{"@width":"41","@height":"49","@source":"decor/Decor20Graphics.png"}},{"@id":"20",image:{"@width":"51","@height":"38","@source":"decor/Decor21Graphics.png"}},{"@id":"21",image:{"@width":"54","@height":"54","@source":"decor/Decor22Graphics.png"}},{"@id":"22",image:{"@width":"63","@height":"136","@source":"decor/Decor23Graphics.png"}},{"@id":"23",image:{"@width":"21","@height":"39","@source":"decor/Decor24Graphics.png"}},{"@id":"24",image:{"@width":"104","@height":"50","@source":"decor/Decor25Graphics.png"}},{"@id":"25",image:{"@width":"104","@height":"46","@source":"decor/Decor26Graphics.png"}},{"@id":"26",image:{"@width":"86","@height":"38","@source":"decor/Decor27Graphics.png"}},{"@id":"27",image:{"@width":"63","@height":"55","@source":"decor/Decor28Graphics.png"}},{"@id":"28",image:{"@width":"13","@height":"23","@source":"decor/Decor29Graphics.png"}},{"@id":"29",image:{"@width":"28","@height":"40","@source":"decor/Decor30Graphics.png"}},{"@id":"30",image:{"@width":"69","@height":"30","@source":"decor/Decor31Graphics.png"}},{"@id":"31",image:{"@width":"33","@height":"29","@source":"decor/Decor32Graphics.png"}},{"@id":"32",image:{"@width":"42","@height":"42","@source":"decor/Decor33Graphics.png"}},{"@id":"33",image:{"@width":"60","@height":"66","@source":"decor/Decor34Graphics.png"}},{"@id":"34",image:{"@width":"46","@height":"65","@source":"decor/Decor35Graphics.png"}},{"@id":"35",image:{"@width":"71","@height":"55","@source":"decor/Decor36Graphics.png"}},{"@id":"36",image:{"@width":"35","@height":"55","@source":"decor/Decor37Graphics.png"}},{"@id":"37",image:{"@width":"28","@height":"29","@source":"decor/Decor38Graphics.png"}},{"@id":"38",image:{"@width":"38","@height":"37","@source":"decor/Decor39Graphics.png"}},{"@id":"39",image:{"@width":"103","@height":"50","@source":"decor/Decor40Graphics.png"}},{"@id":"40",image:{"@width":"56","@height":"55","@source":"decor/Decor41Graphics.png"}},{"@id":"41",image:{"@width":"71","@height":"50","@source":"decor/Decor42Graphics.png"}},{"@id":"42",image:{"@width":"200","@height":"44","@source":"decor/TxtGraphics.png"}},{"@id":"43",image:{"@width":"78","@height":"96","@source":"decor/Tip5Graphics.png"}},{"@id":"44",image:{"@width":"78","@height":"96","@source":"decor/Tip6Graphics.png"}},{"@id":"45",image:{"@width":"97","@height":"69","@source":"decor/Tip7Graphics.png"}}]}],imagelayer:{"@name":"background","@y":"1",image:{"@source":"bg/Background1Graphics.png"}},objectgroup:[{"@name":"decorations",object:[{"@id":"1","@gid":"43","@x":"199","@y":"369","@width":"232","@height":"79",properties:{property:{"@name":"text","@value":"level_text_2"}}},{"@id":"2","@gid":"44","@x":"535","@y":"264","@width":"54","@height":"20"},{"@id":"3","@gid":"46","@x":"455","@y":"210","@width":"33","@height":"27"},{"@id":"5","@gid":"75","@x":"446","@y":"182","@width":"42","@height":"42"},{"@id":"6","@gid":"65","@x":"55","@y":"350","@width":"63","@height":"136"},{"@id":"127","@gid":"87","@x":"49","@y":"162","@width":"78","@height":"96"},{"@id":"128","@gid":"86","@x":"574","@y":"375","@width":"78","@height":"96"}]},{"@name":"tiles",object:[{"@id":"7","@gid":"12","@x":"385","@y":"245","@width":"35","@height":"35"},{"@id":"8","@gid":"12","@x":"665","@y":"525","@width":"35","@height":"35"},{"@id":"9","@gid":"12","@x":"350","@y":"245","@width":"35","@height":"35"},{"@id":"10","@gid":"12","@x":"-132","@y":"-197","@width":"35","@height":"35"},{"@id":"11","@gid":"12","@x":"630","@y":"525","@width":"35","@height":"35"},{"@id":"12","@gid":"12","@x":"-97","@y":"-197","@width":"35","@height":"35"},{"@id":"13","@gid":"12","@x":"-62","@y":"-197","@width":"35","@height":"35"},{"@id":"14","@gid":"12","@x":"665","@y":"455","@width":"35","@height":"35"},{"@id":"15","@gid":"12","@x":"595","@y":"525","@width":"35","@height":"35"},{"@id":"16","@gid":"12","@x":"665","@y":"420","@width":"35","@height":"35"},{"@id":"17","@gid":"12","@x":"630","@y":"490","@width":"35","@height":"35"},{"@id":"18","@gid":"12","@x":"0","@y":"525","@width":"35","@height":"35"},{"@id":"19","@gid":"12","@x":"665","@y":"490","@width":"35","@height":"35"},{"@id":"20","@gid":"12","@x":"630","@y":"455","@width":"35","@height":"35"},{"@id":"21","@gid":"12","@x":"210","@y":"525","@width":"35","@height":"35"},{"@id":"22","@gid":"12","@x":"140","@y":"525","@width":"35","@height":"35"},{"@id":"23","@gid":"12","@x":"175","@y":"525","@width":"35","@height":"35"},{"@id":"24","@gid":"12","@x":"245","@y":"525","@width":"35","@height":"35"},{"@id":"25","@gid":"3","@x":"280","@y":"385","@width":"35","@height":"35"},{"@id":"26","@gid":"4","@x":"490","@y":"385","@width":"35","@height":"35"},{"@id":"27","@gid":"3","@x":"455","@y":"385","@width":"35","@height":"35"},{"@id":"28","@gid":"5","@x":"420","@y":"350","@width":"35","@height":"35"},{"@id":"29","@gid":"3","@x":"245","@y":"385","@width":"35","@height":"35"},{"@id":"30","@gid":"3","@x":"210","@y":"385","@width":"35","@height":"35"},{"@id":"31","@gid":"10","@x":"175","@y":"350","@width":"35","@height":"35"},{"@id":"32","@gid":"14","@x":"140","@y":"385","@width":"35","@height":"35"},{"@id":"33","@gid":"15","@x":"175","@y":"385","@width":"35","@height":"35"},{"@id":"34","@gid":"10","@x":"245","@y":"490","@width":"35","@height":"35"},{"@id":"35","@gid":"8","@x":"140","@y":"490","@width":"35","@height":"35"},{"@id":"36","@gid":"9","@x":"175","@y":"490","@width":"35","@height":"35"},{"@id":"37","@gid":"9","@x":"210","@y":"490","@width":"35","@height":"35"},{"@id":"38","@gid":"9","@x":"315","@y":"525","@width":"35","@height":"35"},{"@id":"39","@gid":"9","@x":"280","@y":"525","@width":"35","@height":"35"},{"@id":"40","@gid":"9","@x":"385","@y":"525","@width":"35","@height":"35"},{"@id":"41","@gid":"9","@x":"350","@y":"525","@width":"35","@height":"35"},{"@id":"42","@gid":"9","@x":"455","@y":"525","@width":"35","@height":"35"},{"@id":"43","@gid":"9","@x":"420","@y":"525","@width":"35","@height":"35"},{"@id":"44","@gid":"9","@x":"525","@y":"525","@width":"35","@height":"35"},{"@id":"45","@gid":"9","@x":"490","@y":"525","@width":"35","@height":"35"},{"@id":"46","@gid":"9","@x":"560","@y":"525","@width":"35","@height":"35"},{"@id":"47","@gid":"9","@x":"35","@y":"525","@width":"35","@height":"35"},{"@id":"48","@gid":"9","@x":"70","@y":"525","@width":"35","@height":"35"},{"@id":"49","@gid":"9","@x":"105","@y":"525","@width":"35","@height":"35"},{"@id":"50","@gid":"13","@x":"0","@y":"490","@width":"35","@height":"35"},{"@id":"51","@gid":"13","@x":"0","@y":"455","@width":"35","@height":"35"},{"@id":"52","@gid":"13","@x":"0","@y":"420","@width":"35","@height":"35"},{"@id":"53","@gid":"13","@x":"0","@y":"385","@width":"35","@height":"35"},{"@id":"54","@gid":"13","@x":"0","@y":"350","@width":"35","@height":"35"},{"@id":"55","@gid":"13","@x":"0","@y":"315","@width":"35","@height":"35"},{"@id":"56","@gid":"13","@x":"0","@y":"280","@width":"35","@height":"35"},{"@id":"57","@gid":"13","@x":"0","@y":"245","@width":"35","@height":"35"},{"@id":"58","@gid":"10","@x":"0","@y":"210","@width":"35","@height":"35"},{"@id":"59","@gid":"11","@x":"665","@y":"385","@width":"35","@height":"35"},{"@id":"60","@gid":"11","@x":"665","@y":"350","@width":"35","@height":"35"},{"@id":"61","@gid":"11","@x":"665","@y":"315","@width":"35","@height":"35"},{"@id":"62","@gid":"11","@x":"665","@y":"280","@width":"35","@height":"35"},{"@id":"63","@gid":"8","@x":"595","@y":"420","@width":"35","@height":"35"},{"@id":"64","@gid":"9","@x":"630","@y":"420","@width":"35","@height":"35"},{"@id":"65","@gid":"11","@x":"595","@y":"490","@width":"35","@height":"35"},{"@id":"66","@gid":"11","@x":"595","@y":"455","@width":"35","@height":"35"},{"@id":"67","@gid":"3","@x":"525","@y":"245","@width":"35","@height":"35"},{"@id":"68","@gid":"3","@x":"490","@y":"245","@width":"35","@height":"35"},{"@id":"69","@gid":"3","@x":"455","@y":"245","@width":"35","@height":"35"},{"@id":"70","@gid":"3","@x":"630","@y":"245","@width":"35","@height":"35"},{"@id":"71","@gid":"3","@x":"595","@y":"245","@width":"35","@height":"35"},{"@id":"72","@gid":"3","@x":"560","@y":"245","@width":"35","@height":"35"},{"@id":"73","@gid":"9","@x":"665","@y":"245","@width":"35","@height":"35"},{"@id":"74","@gid":"10","@x":"385","@y":"210","@width":"35","@height":"35"},{"@id":"75","@gid":"9","@x":"350","@y":"210","@width":"35","@height":"35"},{"@id":"76","@gid":"8","@x":"315","@y":"210","@width":"35","@height":"35"},{"@id":"77","@gid":"11","@x":"315","@y":"245","@width":"35","@height":"35"},{"@id":"78","@gid":"3","@x":"280","@y":"280","@width":"35","@height":"35"},{"@id":"79","@gid":"3","@x":"245","@y":"280","@width":"35","@height":"35"},{"@id":"80","@gid":"2","@x":"210","@y":"280","@width":"35","@height":"35"},{"@id":"81","@gid":"15","@x":"315","@y":"280","@width":"35","@height":"35"},{"@id":"82","@gid":"15","@x":"350","@y":"280","@width":"35","@height":"35"},{"@id":"83","@gid":"16","@x":"385","@y":"280","@width":"35","@height":"35"},{"@id":"84","@gid":"16","@x":"245","@y":"210","@width":"35","@height":"35"},{"@id":"85","@gid":"15","@x":"210","@y":"210","@width":"35","@height":"35"},{"@id":"86","@gid":"3","@x":"175","@y":"210","@width":"35","@height":"35"},{"@id":"87","@gid":"11","@x":"210","@y":"175","@width":"35","@height":"35"},{"@id":"88","@gid":"8","@x":"210","@y":"140","@width":"35","@height":"35"},{"@id":"89","@gid":"13","@x":"245","@y":"175","@width":"35","@height":"35"},{"@id":"90","@gid":"10","@x":"245","@y":"140","@width":"35","@height":"35"},{"@id":"91","@gid":"3","@x":"315","@y":"385","@width":"35","@height":"35"},{"@id":"92","@gid":"3","@x":"350","@y":"385","@width":"35","@height":"35"},{"@id":"93","@gid":"3","@x":"385","@y":"385","@width":"35","@height":"35"},{"@id":"94","@gid":"15","@x":"420","@y":"385","@width":"35","@height":"35"},{"@id":"95","@gid":"3","@x":"420","@y":"245","@width":"35","@height":"35"},{"@id":"96","@gid":"11","@x":"140","@y":"350","@width":"35","@height":"35"},{"@id":"97","@gid":"6","@x":"140","@y":"315","@width":"35","@height":"35"},{"@id":"98","@gid":"6","@x":"140","@y":"280","@width":"35","@height":"35"},{"@id":"99","@gid":"6","@x":"140","@y":"245","@width":"35","@height":"35"},{"@id":"100","@gid":"8","@x":"140","@y":"210","@width":"35","@height":"35"}]},{"@name":"active",object:[{"@id":"101","@gid":"30","@x":"525","@y":"210","@width":"60","@height":"56"},{"@id":"102","@gid":"27","@x":"485","@y":"315","@width":"31","@height":"34"},{"@id":"103","@gid":"27","@x":"70","@y":"427","@width":"31","@height":"34"},{"@id":"104","@gid":"27","@x":"630","@y":"140","@width":"31","@height":"34"},{"@id":"105","@type":"6","@gid":"17","@x":"166","@y":"175.5","@width":"24","@height":"11"},{"@id":"106","@type":"6","@gid":"22","@x":"35","@y":"475","@width":"105","@height":"20",properties:{property:[{"@name":"distanceY","@value":"280"},{"@name":"speedY","@value":"-45"}]}}]},{"@name":"characters",object:[{"@id":"107","@gid":"24","@x":"385","@y":"490","@width":"44","@height":"52"},{"@id":"108","@gid":"28","@x":"443","@y":"492","@width":"63","@height":"50"}]},{"@name":"physics",object:[{"@id":"109","@x":"0","@y":"490","@width":"700","@height":"35"},{"@id":"110","@x":"140","@y":"455","@width":"140","@height":"35"},{"@id":"111","@x":"0","@y":"175","@width":"35","@height":"315"},{"@id":"112","@x":"595","@y":"385","@width":"70","@height":"105"},{"@id":"113","@x":"665","@y":"245","@width":"35","@height":"245"},{"@id":"114","@x":"420","@y":"210","@width":"280","@height":"35"},{"@id":"115","@x":"315","@y":"175","@width":"105","@height":"70"},{"@id":"116","@x":"210","@y":"245","@width":"210","@height":"35"},{"@id":"120","@x":"140","@y":"315","@width":"70","@height":"70"},{"@id":"121","@x":"140","@y":"175","@width":"70","@height":"35"},{"@id":"122","@x":"210","@y":"105","@width":"70","@height":"105"},{"@id":"123","@x":"140","@y":"210","@width":"35","@height":"105"},{"@id":"124","@x":"420","@y":"315","@width":"35","@height":"35"},{"@id":"125","@x":"210","@y":"350","@width":"315","@height":"35"}]}]},{"@level":"3","@version":"1.0","@orientation":"orthogonal","@renderorder":"right-down","@width":"20","@height":"15","@tilewidth":"35","@tileheight":"35",tileset:[{"@firstgid":"1","@name":"tiles","@tilewidth":"35","@tileheight":"35",tile:[{"@id":"0",image:{"@width":"35","@height":"35","@source":"tiles/singleTile.png"}},{"@id":"1",image:{"@width":"35","@height":"35","@source":"tiles/platformLeft.png"}},{"@id":"2",image:{"@width":"35","@height":"35","@source":"tiles/platformCenter.png"}},{"@id":"3",image:{"@width":"35","@height":"35","@source":"tiles/platformRight.png"}},{"@id":"4",image:{"@width":"35","@height":"35","@source":"tiles/verticalPlatformTop.png"}},{"@id":"5",image:{"@width":"35","@height":"35","@source":"tiles/verticalPlatformCenter.png"}},{"@id":"6",image:{"@width":"35","@height":"35","@source":"tiles/verticalPlatformBottom.png"}},{"@id":"7",image:{"@width":"35","@height":"35","@source":"tiles/tileTopLeft.png"}},{"@id":"8",image:{"@width":"35","@height":"35","@source":"tiles/tileTopCenter.png"}},{"@id":"9",image:{"@width":"35","@height":"35","@source":"tiles/tileTopRight.png"}},{"@id":"10",image:{"@width":"35","@height":"35","@source":"tiles/tileCenterLeft.png"}},{"@id":"11",image:{"@width":"35","@height":"35","@source":"tiles/tileCenter.png"}},{"@id":"12",image:{"@width":"35","@height":"35","@source":"tiles/tileCenterRight.png"}},{"@id":"13",image:{"@width":"35","@height":"35","@source":"tiles/tileBottomLeft.png"}},{"@id":"14",image:{"@width":"35","@height":"35","@source":"tiles/tileBottomCenter.png"}},{"@id":"15",image:{"@width":"35","@height":"35","@source":"tiles/tileBottomRight.png"}}]},{"@firstgid":"17","@name":"active","@tilewidth":"105","@tileheight":"70",tile:[{"@id":"0",image:{"@width":"24","@height":"11","@source":"active/PushButtonGraphics.png"}},{"@id":"1",image:{"@width":"25","@height":"19","@source":"active/TriggerGraphics.png"}},{"@id":"2",image:{"@width":"20","@height":"70","@source":"active/DoorGraphics.png"}},{"@id":"3",image:{"@width":"20","@height":"70","@source":"active/GlassDoorGraphics.png"}},{"@id":"4",image:{"@width":"70","@height":"19","@source":"active/ElevatorGraphics.png"}},{"@id":"5",image:{"@width":"105","@height":"20","@source":"active/BigElevatorGraphics.png"}},{"@id":"6",image:{"@width":"70","@height":"70","@source":"active/ExitGraphics.png"}},{"@id":"7",image:{"@width":"44","@height":"52","@source":"characters/HustlerGraphics.png"}},{"@id":"8",image:{"@width":"32","@height":"22","@source":"active/CameraGraphics.png"}},{"@id":"9",image:{"@width":"15","@height":"15","@source":"characters/EnemyLimiterGraphics.png"}},{"@id":"10",image:{"@width":"31","@height":"34","@source":"passive/MoneyBagGraphics.png"}},{"@id":"11",image:{"@width":"63","@height":"50","@source":"characters/DogGraphics.png"}},{"@id":"12",image:{"@width":"60","@height":"55","@source":"characters/Prisoner2Graphics.png"}},{"@id":"13",image:{"@width":"60","@height":"56","@source":"characters/PrisonerGraphics.png"}}]},{"@firstgid":"31","@name":"passive","@tilewidth":"210","@tileheight":"50",tile:[{"@id":"0",image:{"@width":"50","@height":"50","@source":"passive/BigBoxGraphics.png"}},{"@id":"1",image:{"@width":"35","@height":"35","@source":"passive/BoxGraphics.png"}},{"@id":"2",image:{"@width":"37","@height":"35","@source":"passive/ToiletGraphics.png"}},{"@id":"3",image:{"@width":"35","@height":"35","@source":"passive/MonitorGraphics.png"}},{"@id":"4",image:{"@width":"35","@height":"35","@source":"passive/BasketBallGraphics.png"}},{"@id":"5",image:{"@width":"35","@height":"35","@source":"passive/StoolGraphics.png"}},{"@id":"6",image:{"@width":"150","@height":"20","@source":"passive/PlankGraphics.png"}},{"@id":"7",image:{"@width":"150","@height":"20","@source":"passive/Plank2Graphics.png"}},{"@id":"8",image:{"@width":"210","@height":"20","@source":"passive/BigPlankGraphics.png"}},{"@id":"9",image:{"@width":"100","@height":"20","@source":"passive/Plank5Graphics.png"}},{"@id":"10",image:{"@width":"150","@height":"20","@source":"passive/Plank2Graphics.png"}},{"@id":"11",image:{"@width":"35","@height":"35","@source":"passive/MirrorGraphics.png"}}]},{"@firstgid":"43","@name":"decor","@tilewidth":"232","@tileheight":"136",tile:[{"@id":"0",image:{"@width":"232","@height":"79","@source":"decor/LevelTextGraphics.png"}},{"@id":"1",image:{"@width":"54","@height":"20","@source":"decor/Decor1Graphics.png"}},{"@id":"2",image:{"@width":"54","@height":"20","@source":"decor/Decor2Graphics.png"}},{"@id":"3",image:{"@width":"33","@height":"27","@source":"decor/Decor3Graphics.png"}},{"@id":"4",image:{"@width":"34","@height":"25","@source":"decor/Decor4Graphics.png"}},{"@id":"5",image:{"@width":"22","@height":"31","@source":"decor/Decor5Graphics.png"}},{"@id":"6",image:{"@width":"126","@height":"59","@source":"decor/Decor6Graphics.png"}},{"@id":"7",image:{"@width":"25","@height":"21","@source":"decor/Decor8Graphics.png"}},{"@id":"8",image:{"@width":"18","@height":"22","@source":"decor/Decor9Graphics.png"}},{"@id":"9",image:{"@width":"35","@height":"58","@source":"decor/Decor10Graphics.png"}},{"@id":"10",image:{"@width":"19","@height":"66","@source":"decor/Decor11Graphics.png"}},{"@id":"11",image:{"@width":"23","@height":"33","@source":"decor/Decor12Graphics.png"}},{"@id":"12",image:{"@width":"38","@height":"26","@source":"decor/Decor13Graphics.png"}},{"@id":"13",image:{"@width":"43","@height":"78","@source":"decor/Decor14Graphics.png"}},{"@id":"14",image:{"@width":"60","@height":"86","@source":"decor/Decor15Graphics.png"}},{"@id":"15",image:{"@width":"41","@height":"69","@source":"decor/Decor16Graphics.png"}},{"@id":"16",image:{"@width":"55","@height":"58","@source":"decor/Decor17Graphics.png"}},{"@id":"17",image:{"@width":"57","@height":"54","@source":"decor/Decor18Graphics.png"}},{"@id":"18",image:{"@width":"18","@height":"45","@source":"decor/Decor19Graphics.png"}},{"@id":"19",image:{"@width":"41","@height":"49","@source":"decor/Decor20Graphics.png"}},{"@id":"20",image:{"@width":"51","@height":"38","@source":"decor/Decor21Graphics.png"}},{"@id":"21",image:{"@width":"54","@height":"54","@source":"decor/Decor22Graphics.png"}},{"@id":"22",image:{"@width":"63","@height":"136","@source":"decor/Decor23Graphics.png"}},{"@id":"23",image:{"@width":"21","@height":"39","@source":"decor/Decor24Graphics.png"}},{"@id":"24",image:{"@width":"104","@height":"50","@source":"decor/Decor25Graphics.png"}},{"@id":"25",image:{"@width":"104","@height":"46","@source":"decor/Decor26Graphics.png"}},{"@id":"26",image:{"@width":"86","@height":"38","@source":"decor/Decor27Graphics.png"}},{"@id":"27",image:{"@width":"63","@height":"55","@source":"decor/Decor28Graphics.png"}},{"@id":"28",image:{"@width":"13","@height":"23","@source":"decor/Decor29Graphics.png"}},{"@id":"29",image:{"@width":"28","@height":"40","@source":"decor/Decor30Graphics.png"}},{"@id":"30",image:{"@width":"69","@height":"30","@source":"decor/Decor31Graphics.png"}},{"@id":"31",image:{"@width":"33","@height":"29","@source":"decor/Decor32Graphics.png"}},{"@id":"32",image:{"@width":"42","@height":"42","@source":"decor/Decor33Graphics.png"}},{"@id":"33",image:{"@width":"60","@height":"66","@source":"decor/Decor34Graphics.png"}},{"@id":"34",image:{"@width":"46","@height":"65","@source":"decor/Decor35Graphics.png"}},{"@id":"35",image:{"@width":"71","@height":"55","@source":"decor/Decor36Graphics.png"}},{"@id":"36",image:{"@width":"35","@height":"55","@source":"decor/Decor37Graphics.png"}},{"@id":"37",image:{"@width":"28","@height":"29","@source":"decor/Decor38Graphics.png"}},{"@id":"38",image:{"@width":"38","@height":"37","@source":"decor/Decor39Graphics.png"}},{"@id":"39",image:{"@width":"103","@height":"50","@source":"decor/Decor40Graphics.png"}},{"@id":"40",image:{"@width":"56","@height":"55","@source":"decor/Decor41Graphics.png"}},{"@id":"41",image:{"@width":"71","@height":"50","@source":"decor/Decor42Graphics.png"}},{"@id":"42",image:{"@width":"200","@height":"44","@source":"decor/TxtGraphics.png"}}]}],imagelayer:{"@name":"background",image:{"@source":"bg/Background1Graphics.png"}},objectgroup:[{"@name":"decorations",object:[{"@gid":"43","@x":"105","@y":"350","@width":"232","@height":"79",properties:{property:{"@name":"text","@value":"level_text_3"}}},{"@gid":"49","@x":"175","@y":"455"},{"@gid":"52","@x":"70","@y":"175"},{"@gid":"47","@x":"595","@y":"385"},{"@gid":"48","@x":"245","@y":"455"},{"@gid":"58","@x":"420","@y":"210"},{"@gid":"70","@x":"33","@y":"202"},{"@gid":"69","@x":"385","@y":"490"}]},{"@name":"tiles",object:[{"@gid":"9","@x":"560","@y":"525","@width":"35","@height":"35"},{"@gid":"9","@x":"455","@y":"525","@width":"35","@height":"35"},{"@gid":"9","@x":"245","@y":"525","@width":"35","@height":"35"},{"@gid":"9","@x":"350","@y":"525","@width":"35","@height":"35"},{"@gid":"9","@x":"315","@y":"525","@width":"35","@height":"35"},{"@gid":"9","@x":"280","@y":"525","@width":"35","@height":"35"},{"@gid":"9","@x":"105","@y":"525","@width":"35","@height":"35"},{"@gid":"9","@x":"140","@y":"525","@width":"35","@height":"35"},{"@gid":"12","@x":"490","@y":"525","@width":"35","@height":"35"},{"@gid":"12","@x":"0","@y":"525","@width":"35","@height":"35"},{"@gid":"12","@x":"35","@y":"525","@width":"35","@height":"35"},{"@gid":"12","@x":"0","@y":"490","@width":"35","@height":"35"},{"@gid":"12","@x":"665","@y":"525","@width":"35","@height":"35"},{"@gid":"12","@x":"70","@y":"525","@width":"35","@height":"35"},{"@gid":"3","@x":"70","@y":"245","@width":"35","@height":"35"},{"@gid":"3","@x":"35","@y":"245","@width":"35","@height":"35"},{"@gid":"9","@x":"0","@y":"245","@width":"35","@height":"35"},{"@gid":"13","@x":"0","@y":"280","@width":"35","@height":"35"},{"@gid":"13","@x":"0","@y":"315","@width":"35","@height":"35"},{"@gid":"13","@x":"0","@y":"350","@width":"35","@height":"35"},{"@gid":"13","@x":"0","@y":"385","@width":"35","@height":"35"},{"@gid":"13","@x":"0","@y":"420","@width":"35","@height":"35"},{"@gid":"10","@x":"70","@y":"490","@width":"35","@height":"35"},{"@gid":"9","@x":"175","@y":"525","@width":"35","@height":"35"},{"@gid":"9","@x":"210","@y":"525","@width":"35","@height":"35"},{"@gid":"9","@x":"385","@y":"525","@width":"35","@height":"35"},{"@gid":"9","@x":"595","@y":"525","@width":"35","@height":"35"},{"@gid":"9","@x":"630","@y":"525","@width":"35","@height":"35"},{"@gid":"11","@x":"665","@y":"490","@width":"35","@height":"35"},{"@gid":"11","@x":"665","@y":"455","@width":"35","@height":"35"},{"@gid":"11","@x":"665","@y":"420","@width":"35","@height":"35"},{"@gid":"6","@x":"525","@y":"315","@width":"35","@height":"35"},{"@gid":"6","@x":"525","@y":"280","@width":"35","@height":"35"},{"@gid":"10","@x":"525","@y":"245","@width":"35","@height":"35"},{"@gid":"3","@x":"490","@y":"245","@width":"35","@height":"35"},{"@gid":"3","@x":"455","@y":"245","@width":"35","@height":"35"},{"@gid":"3","@x":"385","@y":"245","@width":"35","@height":"35"},{"@gid":"3","@x":"420","@y":"245","@width":"35","@height":"35"},{"@gid":"4","@x":"350","@y":"385","@width":"35","@height":"35"},{"@gid":"3","@x":"210","@y":"385","@width":"35","@height":"35"},{"@gid":"3","@x":"140","@y":"385","@width":"35","@height":"35"},{"@gid":"3","@x":"175","@y":"385","@width":"35","@height":"35"},{"@gid":"2","@x":"105","@y":"385","@width":"35","@height":"35"},{"@gid":"3","@x":"595","@y":"350","@width":"35","@height":"35"},{"@gid":"3","@x":"560","@y":"350","@width":"35","@height":"35"},{"@gid":"14","@x":"525","@y":"350"},{"@gid":"3","@x":"315","@y":"385","@width":"35","@height":"35"},{"@gid":"13","@x":"0","@y":"455","@width":"35","@height":"35"},{"@gid":"9","@x":"35","@y":"490"},{"@gid":"15","@x":"630","@y":"350"},{"@gid":"8","@x":"630","@y":"315"},{"@gid":"9","@x":"665","@y":"315"},{"@gid":"11","@x":"665","@y":"385","@width":"35","@height":"35"},{"@gid":"12","@x":"665","@y":"350"},{"@gid":"3","@x":"280","@y":"385","@width":"35","@height":"35"},{"@gid":"9","@x":"420","@y":"525","@width":"35","@height":"35"},{"@gid":"12","@x":"525","@y":"525","@width":"35","@height":"35"},{"@gid":"11","@x":"490","@y":"490"},{"@gid":"8","@x":"490","@y":"455"},{"@gid":"10","@x":"525","@y":"455"},{"@gid":"13","@x":"525","@y":"490"},{"@gid":"3","@x":"350","@y":"245","@width":"35","@height":"35"},{"@gid":"3","@x":"245","@y":"385","@width":"35","@height":"35"},{"@gid":"2","@x":"315","@y":"245"},{"@gid":"4","@x":"105","@y":"245","@width":"35","@height":"35"}]},{"@name":"active",object:[{"@type":"1","@gid":"21","@x":"560","@y":"298","@width":"70","@height":"19",properties:{property:[{"@name":"distanceY","@value":"70"},{"@name":"speedY","@value":"-45"}]}},{"@type":"1","@gid":"17","@x":"595","@y":"490","@width":"24","@height":"11"},{"@gid":"27","@x":"595","@y":"455","@width":"31","@height":"34"},{"@gid":"27","@x":"455","@y":"140","@width":"31","@height":"34"},{"@gid":"27","@x":"455","@y":"315","@width":"31","@height":"34"},{"@gid":"30","@x":"350","@y":"210","@width":"60","@height":"56",properties:{property:[{"@name":"limitLeft","@value":"20"},{"@name":"limitRight","@value":"30"}]}}]},{"@name":"characters",object:[{"@gid":"24","@x":"315","@y":"490","@width":"44","@height":"52"},{"@gid":"28","@x":"630","@y":"280","@width":"63","@height":"50"}]},{"@name":"physics",object:[{"@x":"0","@y":"210","@width":"140","@height":"35"},{"@x":"0","@y":"245","@width":"35","@height":"280"},{"@x":"35","@y":"455","@width":"70","@height":"70"},{"@x":"105","@y":"490","@width":"595","@height":"35"},{"@x":"490","@y":"420","@width":"70","@height":"70"},{"@x":"665","@y":"350","@width":"35","@height":"140"},{"@x":"560","@y":"315","@width":"140","@height":"35"},{"@x":"105","@y":"350","@width":"280","@height":"35"},{"@x":"315","@y":"210","@width":"245","@height":"35"},{"@x":"525","@y":"245","@width":"35","@height":"105"},{"@x":"630","@y":"280","@width":"70","@height":"35"}]}]},{"@level":"4","@version":"1.0","@orientation":"orthogonal","@renderorder":"right-down","@width":"20","@height":"15","@tilewidth":"35","@tileheight":"35","@nextobjectid":"136",tileset:[{"@firstgid":"1","@name":"tiles","@tilewidth":"35","@tileheight":"35","@tilecount":"16",tile:[{"@id":"0",image:{"@width":"35","@height":"35","@source":"tiles/singleTile.png"}},{"@id":"1",image:{"@width":"35","@height":"35","@source":"tiles/platformLeft.png"}},{"@id":"2",image:{"@width":"35","@height":"35","@source":"tiles/platformCenter.png"}},{"@id":"3",image:{"@width":"35","@height":"35","@source":"tiles/platformRight.png"}},{"@id":"4",image:{"@width":"35","@height":"35","@source":"tiles/verticalPlatformTop.png"}},{"@id":"5",image:{"@width":"35","@height":"35","@source":"tiles/verticalPlatformCenter.png"}},{"@id":"6",image:{"@width":"35","@height":"35","@source":"tiles/verticalPlatformBottom.png"}},{"@id":"7",image:{"@width":"35","@height":"35","@source":"tiles/tileTopLeft.png"}},{"@id":"8",image:{"@width":"35","@height":"35","@source":"tiles/tileTopCenter.png"}},{"@id":"9",image:{"@width":"35","@height":"35","@source":"tiles/tileTopRight.png"}},{"@id":"10",image:{"@width":"35","@height":"35","@source":"tiles/tileCenterLeft.png"}},{"@id":"11",image:{"@width":"35","@height":"35","@source":"tiles/tileCenter.png"}},{"@id":"12",image:{"@width":"35","@height":"35","@source":"tiles/tileCenterRight.png"}},{"@id":"13",image:{"@width":"35","@height":"35","@source":"tiles/tileBottomLeft.png"}},{"@id":"14",image:{"@width":"35","@height":"35","@source":"tiles/tileBottomCenter.png"}},{"@id":"15",image:{"@width":"35","@height":"35","@source":"tiles/tileBottomRight.png"}}]},{"@firstgid":"17","@name":"active","@tilewidth":"105","@tileheight":"70","@tilecount":"14",tile:[{"@id":"0",image:{"@width":"24","@height":"11","@source":"active/PushButtonGraphics.png"}},{"@id":"1",image:{"@width":"25","@height":"19","@source":"active/TriggerGraphics.png"}},{"@id":"2",image:{"@width":"20","@height":"70","@source":"active/DoorGraphics.png"}},{"@id":"3",image:{"@width":"20","@height":"70","@source":"active/GlassDoorGraphics.png"}},{"@id":"4",image:{"@width":"70","@height":"19","@source":"active/ElevatorGraphics.png"}},{"@id":"5",image:{"@width":"105","@height":"20","@source":"active/BigElevatorGraphics.png"}},{"@id":"6",image:{"@width":"70","@height":"70","@source":"active/ExitGraphics.png"}},{"@id":"7",image:{"@width":"44","@height":"52","@source":"characters/HustlerGraphics.png"}},{"@id":"8",image:{"@width":"32","@height":"22","@source":"active/CameraGraphics.png"}},{"@id":"9",image:{"@width":"15","@height":"15","@source":"characters/EnemyLimiterGraphics.png"}},{"@id":"10",image:{"@width":"31","@height":"34","@source":"passive/MoneyBagGraphics.png"}},{"@id":"11",image:{"@width":"63","@height":"50","@source":"characters/DogGraphics.png"}},{"@id":"12",image:{"@width":"60","@height":"55","@source":"characters/Prisoner2Graphics.png"}},{"@id":"13",image:{"@width":"60","@height":"56","@source":"characters/PrisonerGraphics.png"}}]},{"@firstgid":"31","@name":"passive","@tilewidth":"210","@tileheight":"50","@tilecount":"12",tile:[{"@id":"0",image:{"@width":"50","@height":"50","@source":"passive/BigBoxGraphics.png"}},{"@id":"1",image:{"@width":"35","@height":"35","@source":"passive/BoxGraphics.png"}},{"@id":"2",image:{"@width":"37","@height":"35","@source":"passive/ToiletGraphics.png"}},{"@id":"3",image:{"@width":"35","@height":"35","@source":"passive/MonitorGraphics.png"}},{"@id":"4",image:{"@width":"35","@height":"35","@source":"passive/BasketBallGraphics.png"}},{"@id":"5",image:{"@width":"35","@height":"35","@source":"passive/StoolGraphics.png"}},{"@id":"6",image:{"@width":"150","@height":"20","@source":"passive/PlankGraphics.png"}},{"@id":"7",image:{"@width":"150","@height":"20","@source":"passive/Plank2Graphics.png"}},{"@id":"8",image:{"@width":"210","@height":"20","@source":"passive/BigPlankGraphics.png"}},{"@id":"9",image:{"@width":"100","@height":"20","@source":"passive/Plank5Graphics.png"}},{"@id":"10",image:{"@width":"150","@height":"20","@source":"passive/Plank2Graphics.png"}},{"@id":"11",image:{"@width":"35","@height":"35","@source":"passive/MirrorGraphics.png"}}]},{"@firstgid":"43","@name":"decor","@tilewidth":"232","@tileheight":"136","@tilecount":"44",tile:[{"@id":"0",image:{"@width":"232","@height":"79","@source":"decor/LevelTextGraphics.png"}},{"@id":"1",image:{"@width":"54","@height":"20","@source":"decor/Decor1Graphics.png"}},{"@id":"2",image:{"@width":"54","@height":"20","@source":"decor/Decor2Graphics.png"}},{"@id":"3",image:{"@width":"33","@height":"27","@source":"decor/Decor3Graphics.png"}},{"@id":"4",image:{"@width":"34","@height":"25","@source":"decor/Decor4Graphics.png"}},{"@id":"5",image:{"@width":"22","@height":"31","@source":"decor/Decor5Graphics.png"}},{"@id":"6",image:{"@width":"126","@height":"59","@source":"decor/Decor6Graphics.png"}},{"@id":"7",image:{"@width":"25","@height":"21","@source":"decor/Decor8Graphics.png"}},{"@id":"8",image:{"@width":"18","@height":"22","@source":"decor/Decor9Graphics.png"}},{"@id":"9",image:{"@width":"35","@height":"58","@source":"decor/Decor10Graphics.png"}},{"@id":"10",image:{"@width":"19","@height":"66","@source":"decor/Decor11Graphics.png"}},{"@id":"11",image:{"@width":"23","@height":"33","@source":"decor/Decor12Graphics.png"}},{"@id":"12",image:{"@width":"38","@height":"26","@source":"decor/Decor13Graphics.png"}},{"@id":"13",image:{"@width":"43","@height":"78","@source":"decor/Decor14Graphics.png"}},{"@id":"14",image:{"@width":"60","@height":"86","@source":"decor/Decor15Graphics.png"}},{"@id":"15",image:{"@width":"41","@height":"69","@source":"decor/Decor16Graphics.png"}},{"@id":"16",image:{"@width":"55","@height":"58","@source":"decor/Decor17Graphics.png"}},{"@id":"17",image:{"@width":"57","@height":"54","@source":"decor/Decor18Graphics.png"}},{"@id":"18",image:{"@width":"18","@height":"45","@source":"decor/Decor19Graphics.png"}},{"@id":"19",image:{"@width":"41","@height":"49","@source":"decor/Decor20Graphics.png"}},{"@id":"20",image:{"@width":"51","@height":"38","@source":"decor/Decor21Graphics.png"}},{"@id":"21",image:{"@width":"54","@height":"54","@source":"decor/Decor22Graphics.png"}},{"@id":"22",image:{"@width":"63","@height":"136","@source":"decor/Decor23Graphics.png"}},{"@id":"23",image:{"@width":"21","@height":"39","@source":"decor/Decor24Graphics.png"}},{"@id":"24",image:{"@width":"104","@height":"50","@source":"decor/Decor25Graphics.png"}},{"@id":"25",image:{"@width":"104","@height":"46","@source":"decor/Decor26Graphics.png"}},{"@id":"26",image:{"@width":"86","@height":"38","@source":"decor/Decor27Graphics.png"}},{"@id":"27",image:{"@width":"63","@height":"55","@source":"decor/Decor28Graphics.png"}},{"@id":"28",image:{"@width":"13","@height":"23","@source":"decor/Decor29Graphics.png"}},{"@id":"29",image:{"@width":"28","@height":"40","@source":"decor/Decor30Graphics.png"}},{"@id":"30",image:{"@width":"69","@height":"30","@source":"decor/Decor31Graphics.png"}},{"@id":"31",image:{"@width":"33","@height":"29","@source":"decor/Decor32Graphics.png"}},{"@id":"32",image:{"@width":"42","@height":"42","@source":"decor/Decor33Graphics.png"}},{"@id":"33",image:{"@width":"60","@height":"66","@source":"decor/Decor34Graphics.png"}},{"@id":"34",image:{"@width":"46","@height":"65","@source":"decor/Decor35Graphics.png"}},{"@id":"35",image:{"@width":"71","@height":"55","@source":"decor/Decor36Graphics.png"}},{"@id":"36",image:{"@width":"35","@height":"55","@source":"decor/Decor37Graphics.png"}},{"@id":"37",image:{"@width":"28","@height":"29","@source":"decor/Decor38Graphics.png"}},{"@id":"38",image:{"@width":"38","@height":"37","@source":"decor/Decor39Graphics.png"}},{"@id":"39",image:{"@width":"103","@height":"50","@source":"decor/Decor40Graphics.png"}},{"@id":"40",image:{"@width":"56","@height":"55","@source":"decor/Decor41Graphics.png"}},{"@id":"41",image:{"@width":"71","@height":"50","@source":"decor/Decor42Graphics.png"}},{"@id":"42",image:{"@width":"200","@height":"44","@source":"decor/TxtGraphics.png"}},{"@id":"43",image:{"@width":"97","@height":"69","@source":"decor/Tip7Graphics.png"}}]}],imagelayer:{"@name":"background",image:{"@source":"bg/Background1Graphics.png"}},objectgroup:[{"@name":"decorations",object:[{"@id":"1","@gid":"43","@x":"230","@y":"170","@width":"232","@height":"79",properties:{property:{"@name":"text","@value":"level_text_4"}}},{"@id":"2","@gid":"44","@x":"86","@y":"194","@width":"54","@height":"20"},{"@id":"3","@gid":"50","@x":"387","@y":"307","@width":"25","@height":"21"},{"@id":"4","@gid":"49","@x":"175","@y":"455","@width":"126","@height":"59"},{"@id":"5","@gid":"64","@x":"525","@y":"210","@width":"54","@height":"54"},{"@id":"6","@gid":"68","@x":"385","@y":"490","@width":"104","@height":"46"},{"@id":"7","@gid":"73","@x":"420","@y":"455","@width":"69","@height":"30"},{"@id":"8","@gid":"80","@x":"560","@y":"455","@width":"28","@height":"29"},{"@id":"114","@gid":"86","@x":"338","@y":"233","@width":"97","@height":"69"}]},{"@name":"tiles",object:[{"@id":"9","@gid":"12","@x":"0","@y":"525","@width":"35","@height":"35"},{"@id":"10","@gid":"12","@x":"35","@y":"525","@width":"35","@height":"35"},{"@id":"11","@gid":"12","@x":"315","@y":"525","@width":"35","@height":"35"},{"@id":"12","@gid":"9","@x":"455","@y":"525","@width":"35","@height":"35"},{"@id":"13","@gid":"9","@x":"420","@y":"525","@width":"35","@height":"35"},{"@id":"14","@gid":"9","@x":"490","@y":"525","@width":"35","@height":"35"},{"@id":"15","@gid":"9","@x":"385","@y":"525","@width":"35","@height":"35"},{"@id":"16","@gid":"9","@x":"140","@y":"525","@width":"35","@height":"35"},{"@id":"17","@gid":"9","@x":"245","@y":"525","@width":"35","@height":"35"},{"@id":"18","@gid":"9","@x":"210","@y":"525","@width":"35","@height":"35"},{"@id":"19","@gid":"9","@x":"175","@y":"525","@width":"35","@height":"35"},{"@id":"20","@gid":"9","@x":"630","@y":"525","@width":"35","@height":"35"},{"@id":"21","@gid":"9","@x":"280","@y":"525","@width":"35","@height":"35"},{"@id":"22","@gid":"9","@x":"105","@y":"525","@width":"35","@height":"35"},{"@id":"23","@gid":"9","@x":"70","@y":"525","@width":"35","@height":"35"},{"@id":"24","@gid":"12","@x":"0","@y":"455","@width":"35","@height":"35"},{"@id":"25","@gid":"12","@x":"0","@y":"490","@width":"35","@height":"35"},{"@id":"26","@gid":"12","@x":"665","@y":"525","@width":"35","@height":"35"},{"@id":"27","@gid":"9","@x":"525","@y":"525","@width":"35","@height":"35"},{"@id":"28","@gid":"9","@x":"560","@y":"525","@width":"35","@height":"35"},{"@id":"29","@gid":"9","@x":"595","@y":"525","@width":"35","@height":"35"},{"@id":"30","@gid":"8","@x":"315","@y":"490","@width":"35","@height":"35"},{"@id":"31","@gid":"8","@x":"455","@y":"140","@width":"35","@height":"35"},{"@id":"32","@gid":"10","@x":"560","@y":"280","@width":"35","@height":"35"},{"@id":"33","@gid":"10","@x":"315","@y":"350","@width":"35","@height":"35"},{"@id":"34","@gid":"10","@x":"210","@y":"175","@width":"35","@height":"35"},{"@id":"35","@gid":"10","@x":"350","@y":"490","@width":"35","@height":"35"},{"@id":"36","@gid":"12","@x":"350","@y":"525","@width":"35","@height":"35"},{"@id":"37","@gid":"10","@x":"35","@y":"455","@width":"35","@height":"35"},{"@id":"38","@gid":"11","@x":"665","@y":"490","@width":"35","@height":"35"},{"@id":"39","@gid":"11","@x":"665","@y":"455","@width":"35","@height":"35"},{"@id":"40","@gid":"11","@x":"665","@y":"420","@width":"35","@height":"35"},{"@id":"41","@gid":"11","@x":"665","@y":"385","@width":"35","@height":"35"},{"@id":"42","@gid":"11","@x":"665","@y":"350","@width":"35","@height":"35"},{"@id":"43","@gid":"11","@x":"665","@y":"315","@width":"35","@height":"35"},{"@id":"44","@gid":"11","@x":"665","@y":"280","@width":"35","@height":"35"},{"@id":"45","@gid":"11","@x":"665","@y":"245","@width":"35","@height":"35"},{"@id":"46","@gid":"11","@x":"665","@y":"210","@width":"35","@height":"35"},{"@id":"47","@gid":"11","@x":"665","@y":"175","@width":"35","@height":"35"},{"@id":"48","@gid":"3","@x":"490","@y":"140","@width":"35","@height":"35"},{"@id":"49","@gid":"3","@x":"525","@y":"140","@width":"35","@height":"35"},{"@id":"50","@gid":"3","@x":"560","@y":"140","@width":"35","@height":"35"},{"@id":"51","@gid":"3","@x":"595","@y":"140","@width":"35","@height":"35"},{"@id":"52","@gid":"3","@x":"630","@y":"140","@width":"35","@height":"35"},{"@id":"53","@gid":"9","@x":"665","@y":"140","@width":"35","@height":"35"},{"@id":"54","@gid":"3","@x":"175","@y":"175","@width":"35","@height":"35"},{"@id":"55","@gid":"3","@x":"140","@y":"175","@width":"35","@height":"35"},{"@id":"56","@gid":"3","@x":"105","@y":"175","@width":"35","@height":"35"},{"@id":"57","@gid":"3","@x":"70","@y":"175","@width":"35","@height":"35"},{"@id":"58","@gid":"3","@x":"35","@y":"175","@width":"35","@height":"35"},{"@id":"59","@gid":"3","@x":"280","@y":"350","@width":"35","@height":"35"},{"@id":"60","@gid":"3","@x":"245","@y":"350","@width":"35","@height":"35"},{"@id":"61","@gid":"3","@x":"210","@y":"350","@width":"35","@height":"35"},{"@id":"62","@gid":"3","@x":"175","@y":"350","@width":"35","@height":"35"},{"@id":"63","@gid":"3","@x":"490","@y":"385","@width":"35","@height":"35"},{"@id":"64","@gid":"3","@x":"455","@y":"385","@width":"35","@height":"35"},{"@id":"65","@gid":"3","@x":"350","@y":"385","@width":"35","@height":"35"},{"@id":"66","@gid":"3","@x":"245","@y":"245","@width":"35","@height":"35"},{"@id":"67","@gid":"13","@x":"35","@y":"490","@width":"35","@height":"35"},{"@id":"68","@gid":"13","@x":"0","@y":"210","@width":"35","@height":"35"},{"@id":"69","@gid":"13","@x":"0","@y":"245","@width":"35","@height":"35"},{"@id":"70","@gid":"13","@x":"0","@y":"280","@width":"35","@height":"35"},{"@id":"71","@gid":"13","@x":"0","@y":"315","@width":"35","@height":"35"},{"@id":"72","@gid":"13","@x":"0","@y":"350","@width":"35","@height":"35"},{"@id":"73","@gid":"13","@x":"0","@y":"385","@width":"35","@height":"35"},{"@id":"74","@gid":"13","@x":"0","@y":"420","@width":"35","@height":"35"},{"@id":"75","@gid":"13","@x":"560","@y":"315","@width":"35","@height":"35"},{"@id":"76","@gid":"13","@x":"560","@y":"350","@width":"35","@height":"35"},{"@id":"77","@gid":"11","@x":"525","@y":"315","@width":"35","@height":"35"},{"@id":"78","@gid":"11","@x":"525","@y":"350","@width":"35","@height":"35"},{"@id":"79","@gid":"9","@x":"0","@y":"175","@width":"35","@height":"35"},{"@id":"80","@gid":"6","@x":"210","@y":"210","@width":"35","@height":"35"},{"@id":"81","@gid":"6","@x":"455","@y":"175","@width":"35","@height":"35"},{"@id":"82","@gid":"6","@x":"455","@y":"210","@width":"35","@height":"35"},{"@id":"83","@gid":"6","@x":"455","@y":"245","@width":"35","@height":"35"},{"@id":"84","@gid":"14","@x":"210","@y":"245","@width":"35","@height":"35"},{"@id":"85","@gid":"14","@x":"315","@y":"385","@width":"35","@height":"35"},{"@id":"86","@gid":"16","@x":"560","@y":"385","@width":"35","@height":"35"},{"@id":"87","@gid":"16","@x":"140","@y":"385","@width":"35","@height":"35"},{"@id":"88","@gid":"16","@x":"420","@y":"420","@width":"35","@height":"35"},{"@id":"89","@gid":"14","@x":"385","@y":"420","@width":"35","@height":"35"},{"@id":"90","@gid":"2","@x":"105","@y":"385","@width":"35","@height":"35"},{"@id":"91","@gid":"2","@x":"420","@y":"280","@width":"35","@height":"35"},{"@id":"92","@gid":"4","@x":"280","@y":"245","@width":"35","@height":"35"},{"@id":"93","@gid":"9","@x":"420","@y":"385","@width":"35","@height":"35"},{"@id":"94","@gid":"9","@x":"385","@y":"385","@width":"35","@height":"35"},{"@id":"95","@gid":"15","@x":"525","@y":"385","@width":"35","@height":"35"},{"@id":"96","@gid":"15","@x":"455","@y":"280","@width":"35","@height":"35"},{"@id":"97","@gid":"3","@x":"490","@y":"280","@width":"35","@height":"35"},{"@id":"98","@gid":"9","@x":"525","@y":"280","@width":"35","@height":"35"},{"@id":"99","@gid":"5","@x":"140","@y":"315","@width":"35","@height":"35"},{"@id":"100","@gid":"11","@x":"140","@y":"350","@width":"35","@height":"35"}]},{"@name":"active",object:[{"@id":"101","@gid":"25","@x":"512","@y":"310","@width":"32","@height":"22",properties:{property:[{"@name":"delay","@value":"0"},{"@name":"maxAngle","@value":"0"},{"@name":"minAngle","@value":"0"},{"@name":"speedX","@value":"0"}]}},{"@id":"102","@type":"5","@gid":"21","@x":"595","@y":"265.5","@width":"70","@height":"19",properties:{property:[{"@name":"distanceY","@value":"210"},{"@name":"speedY","@value":"45"}]}},{"@id":"103","@type":"2","@gid":"19","@x":"444","@y":"280","@width":"20","@height":"70","@rotation":"180"},{"@id":"104","@type":"5","@gid":"17","@x":"469","@y":"351","@width":"24","@height":"11"},{"@id":"105","@gid":"27","@x":"272","@y":"191","@width":"31","@height":"34"},{"@id":"106","@gid":"27","@x":"68","@y":"246","@width":"31","@height":"34"},{"@id":"107","@gid":"27","@x":"497.5","@y":"434.5","@width":"31","@height":"34"},{"@id":"108","@gid":"26","@x":"347","@y":"291","@width":"15","@height":"15"},{"@id":"109","@gid":"30","@x":"228","@y":"313","@width":"60","@height":"56"},{"@id":"110","@type":"2","@gid":"18","@x":"499","@y":"246","@width":"25","@height":"19"},{"@id":"111","@gid":"30","@x":"473","@y":"491","@width":"60","@height":"56",properties:{property:[{"@name":"limitLeft","@value":"70"},{"@name":"limitRight","@value":"60"}]}}]},{"@name":"characters",object:[{"@id":"112","@gid":"24","@x":"112","@y":"488","@width":"44","@height":"52"},{"@id":"113","@gid":"28","@x":"597.5","@y":"241","@width":"63","@height":"50"}]},{"@name":"physics",object:[{"@id":"116","@x":"0","@y":"490","@width":"700","@height":"35"},{"@id":"117","@x":"315","@y":"455","@width":"70","@height":"35"},{"@id":"118","@x":"0","@y":"420","@width":"70","@height":"70"},{"@id":"119","@x":"0","@y":"175","@width":"35","@height":"245"},{"@id":"122","@x":"0","@y":"140","@width":"245","@height":"35"},{"@id":"123","@x":"210","@y":"175","@width":"35","@height":"70"},{"@id":"125","@x":"245","@y":"210","@width":"70","@height":"35"},{"@id":"126","@x":"420","@y":"245","@width":"175","@height":"35"},{"@id":"127","@x":"455","@y":"140","@width":"35","@height":"105"},{"@id":"128","@x":"455","@y":"105","@width":"245","@height":"35"},{"@id":"129","@x":"665","@y":"140","@width":"35","@height":"350"},{"@id":"130","@x":"385","@y":"385","@width":"70","@height":"35"},{"@id":"131","@x":"315","@y":"350","@width":"280","@height":"35"},{"@id":"132","@x":"525","@y":"280","@width":"70","@height":"70"},{"@id":"133","@x":"140","@y":"315","@width":"210","@height":"35"},{"@id":"134","@x":"140","@y":"280","@width":"35","@height":"35"},{"@id":"135","@x":"105","@y":"350","@width":"70","@height":"35"}]}]},{"@level":"5","@version":"1.0","@orientation":"orthogonal","@renderorder":"right-down","@width":"20","@height":"15","@tilewidth":"35","@tileheight":"35",tileset:[{"@firstgid":"1","@name":"tiles","@tilewidth":"35","@tileheight":"35",tile:[{"@id":"0",image:{"@width":"35","@height":"35","@source":"tiles/singleTile.png"}},{"@id":"1",image:{"@width":"35","@height":"35","@source":"tiles/platformLeft.png"}},{"@id":"2",image:{"@width":"35","@height":"35","@source":"tiles/platformCenter.png"}},{"@id":"3",image:{"@width":"35","@height":"35","@source":"tiles/platformRight.png"}},{"@id":"4",image:{"@width":"35","@height":"35","@source":"tiles/verticalPlatformTop.png"}},{"@id":"5",image:{"@width":"35","@height":"35","@source":"tiles/verticalPlatformCenter.png"}},{"@id":"6",image:{"@width":"35","@height":"35","@source":"tiles/verticalPlatformBottom.png"}},{"@id":"7",image:{"@width":"35","@height":"35","@source":"tiles/tileTopLeft.png"}},{"@id":"8",image:{"@width":"35","@height":"35","@source":"tiles/tileTopCenter.png"}},{"@id":"9",image:{"@width":"35","@height":"35","@source":"tiles/tileTopRight.png"}},{"@id":"10",image:{"@width":"35","@height":"35","@source":"tiles/tileCenterLeft.png"}},{"@id":"11",image:{"@width":"35","@height":"35","@source":"tiles/tileCenter.png"}},{"@id":"12",image:{"@width":"35","@height":"35","@source":"tiles/tileCenterRight.png"}},{"@id":"13",image:{"@width":"35","@height":"35","@source":"tiles/tileBottomLeft.png"}},{"@id":"14",image:{"@width":"35","@height":"35","@source":"tiles/tileBottomCenter.png"}},{"@id":"15",image:{"@width":"35","@height":"35","@source":"tiles/tileBottomRight.png"}}]},{"@firstgid":"17","@name":"active","@tilewidth":"105","@tileheight":"70",tile:[{"@id":"0",image:{"@width":"24","@height":"11","@source":"active/PushButtonGraphics.png"}},{"@id":"1",image:{"@width":"25","@height":"19","@source":"active/TriggerGraphics.png"}},{"@id":"2",image:{"@width":"20","@height":"70","@source":"active/DoorGraphics.png"}},{"@id":"3",image:{"@width":"20","@height":"70","@source":"active/GlassDoorGraphics.png"}},{"@id":"4",image:{"@width":"70","@height":"19","@source":"active/ElevatorGraphics.png"}},{"@id":"5",image:{"@width":"105","@height":"20","@source":"active/BigElevatorGraphics.png"}},{"@id":"6",image:{"@width":"70","@height":"70","@source":"active/ExitGraphics.png"}},{"@id":"7",image:{"@width":"44","@height":"52","@source":"characters/HustlerGraphics.png"}},{"@id":"8",image:{"@width":"32","@height":"22","@source":"active/CameraGraphics.png"}},{"@id":"9",image:{"@width":"15","@height":"15","@source":"characters/EnemyLimiterGraphics.png"}},{"@id":"10",image:{"@width":"31","@height":"34","@source":"passive/MoneyBagGraphics.png"}},{"@id":"11",image:{"@width":"63","@height":"50","@source":"characters/DogGraphics.png"}},{"@id":"12",image:{"@width":"60","@height":"55","@source":"characters/Prisoner2Graphics.png"}},{"@id":"13",image:{"@width":"60","@height":"56","@source":"characters/PrisonerGraphics.png"}}]},{"@firstgid":"31","@name":"passive","@tilewidth":"210","@tileheight":"50",tile:[{"@id":"0",image:{"@width":"50","@height":"50","@source":"passive/BigBoxGraphics.png"}},{"@id":"1",image:{"@width":"35","@height":"35","@source":"passive/BoxGraphics.png"}},{"@id":"2",image:{"@width":"37","@height":"35","@source":"passive/ToiletGraphics.png"}},{"@id":"3",image:{"@width":"35","@height":"35","@source":"passive/MonitorGraphics.png"}},{"@id":"4",image:{"@width":"35","@height":"35","@source":"passive/BasketBallGraphics.png"}},{"@id":"5",image:{"@width":"35","@height":"35","@source":"passive/StoolGraphics.png"}},{"@id":"6",image:{"@width":"150","@height":"20","@source":"passive/PlankGraphics.png"}},{"@id":"7",image:{"@width":"150","@height":"20","@source":"passive/Plank2Graphics.png"}},{"@id":"8",image:{"@width":"210","@height":"20","@source":"passive/BigPlankGraphics.png"}},{"@id":"9",image:{"@width":"100","@height":"20","@source":"passive/Plank5Graphics.png"}},{"@id":"10",image:{"@width":"150","@height":"20","@source":"passive/Plank2Graphics.png"}},{"@id":"11",image:{"@width":"35","@height":"35","@source":"passive/MirrorGraphics.png"}}]},{"@firstgid":"43","@name":"decor","@tilewidth":"232","@tileheight":"136",tile:[{"@id":"0",image:{"@width":"232","@height":"79","@source":"decor/LevelTextGraphics.png"}},{"@id":"1",image:{"@width":"54","@height":"20","@source":"decor/Decor1Graphics.png"}},{"@id":"2",image:{"@width":"54","@height":"20","@source":"decor/Decor2Graphics.png"}},{"@id":"3",image:{"@width":"33","@height":"27","@source":"decor/Decor3Graphics.png"}},{"@id":"4",image:{"@width":"34","@height":"25","@source":"decor/Decor4Graphics.png"}},{"@id":"5",image:{"@width":"22","@height":"31","@source":"decor/Decor5Graphics.png"}},{"@id":"6",image:{"@width":"126","@height":"59","@source":"decor/Decor6Graphics.png"}},{"@id":"7",image:{"@width":"25","@height":"21","@source":"decor/Decor8Graphics.png"}},{"@id":"8",image:{"@width":"18","@height":"22","@source":"decor/Decor9Graphics.png"}},{"@id":"9",image:{"@width":"35","@height":"58","@source":"decor/Decor10Graphics.png"}},{"@id":"10",image:{"@width":"19","@height":"66","@source":"decor/Decor11Graphics.png"}},{"@id":"11",image:{"@width":"23","@height":"33","@source":"decor/Decor12Graphics.png"}},{"@id":"12",image:{"@width":"38","@height":"26","@source":"decor/Decor13Graphics.png"}},{"@id":"13",image:{"@width":"43","@height":"78","@source":"decor/Decor14Graphics.png"}},{"@id":"14",image:{"@width":"60","@height":"86","@source":"decor/Decor15Graphics.png"}},{"@id":"15",image:{"@width":"41","@height":"69","@source":"decor/Decor16Graphics.png"}},{"@id":"16",image:{"@width":"55","@height":"58","@source":"decor/Decor17Graphics.png"}},{"@id":"17",image:{"@width":"57","@height":"54","@source":"decor/Decor18Graphics.png"}},{"@id":"18",image:{"@width":"18","@height":"45","@source":"decor/Decor19Graphics.png"}},{"@id":"19",image:{"@width":"41","@height":"49","@source":"decor/Decor20Graphics.png"}},{"@id":"20",image:{"@width":"51","@height":"38","@source":"decor/Decor21Graphics.png"}},{"@id":"21",image:{"@width":"54","@height":"54","@source":"decor/Decor22Graphics.png"}},{"@id":"22",image:{"@width":"63","@height":"136","@source":"decor/Decor23Graphics.png"}},{"@id":"23",image:{"@width":"21","@height":"39","@source":"decor/Decor24Graphics.png"}},{"@id":"24",image:{"@width":"104","@height":"50","@source":"decor/Decor25Graphics.png"}},{"@id":"25",image:{"@width":"104","@height":"46","@source":"decor/Decor26Graphics.png"}},{"@id":"26",image:{"@width":"86","@height":"38","@source":"decor/Decor27Graphics.png"}},{"@id":"27",image:{"@width":"63","@height":"55","@source":"decor/Decor28Graphics.png"}},{"@id":"28",image:{"@width":"13","@height":"23","@source":"decor/Decor29Graphics.png"}},{"@id":"29",image:{"@width":"28","@height":"40","@source":"decor/Decor30Graphics.png"}},{"@id":"30",image:{"@width":"69","@height":"30","@source":"decor/Decor31Graphics.png"}},{"@id":"31",image:{"@width":"33","@height":"29","@source":"decor/Decor32Graphics.png"}},{"@id":"32",image:{"@width":"42","@height":"42","@source":"decor/Decor33Graphics.png"}},{"@id":"33",image:{"@width":"60","@height":"66","@source":"decor/Decor34Graphics.png"}},{"@id":"34",image:{"@width":"46","@height":"65","@source":"decor/Decor35Graphics.png"}},{"@id":"35",image:{"@width":"71","@height":"55","@source":"decor/Decor36Graphics.png"}},{"@id":"36",image:{"@width":"35","@height":"55","@source":"decor/Decor37Graphics.png"}},{"@id":"37",image:{"@width":"28","@height":"29","@source":"decor/Decor38Graphics.png"}},{"@id":"38",image:{"@width":"38","@height":"37","@source":"decor/Decor39Graphics.png"}},{"@id":"39",image:{"@width":"103","@height":"50","@source":"decor/Decor40Graphics.png"}},{"@id":"40",image:{"@width":"56","@height":"55","@source":"decor/Decor41Graphics.png"}},{"@id":"41",image:{"@width":"71","@height":"50","@source":"decor/Decor42Graphics.png"}},{"@id":"42",image:{"@width":"200","@height":"44","@source":"decor/TxtGraphics.png"}},{"@id":"43",image:{"@width":"97","@height":"69","@source":"decor/Tip8Graphics.png"}}]}],imagelayer:{"@name":"background","@y":"-1",image:{"@source":"bg/Background1Graphics.png"}},objectgroup:[{"@name":"decorations",object:[{"@gid":"43","@x":"280","@y":"140","@width":"232","@height":"79",properties:{property:{"@name":"text","@value":"level_text_5"}}},{"@gid":"44","@x":"496","@y":"334","@width":"54","@height":"20"},{"@gid":"61","@x":"140","@y":"451","@width":"18","@height":"45"},{"@gid":"58","@x":"405","@y":"391","@width":"41","@height":"69"},{"@gid":"49","@x":"525","@y":"140","@width":"126","@height":"59"},{"@gid":"74","@x":"612","@y":"264","@width":"33","@height":"29"},{"@gid":"76","@x":"455","@y":"490","@width":"60","@height":"66"},{"@gid":"86","@x":"202","@y":"195","@width":"97","@height":"69"},{"@gid":"79","@x":"315","@y":"485"}]},{"@name":"tiles",object:[{"@gid":"12","@x":"665","@y":"455","@width":"35","@height":"35"},{"@gid":"12","@x":"0","@y":"490","@width":"35","@height":"35"},{"@gid":"12","@x":"560","@y":"525","@width":"35","@height":"35"},{"@gid":"12","@x":"0","@y":"315","@width":"35","@height":"35"},{"@gid":"12","@x":"0","@y":"245","@width":"35","@height":"35"},{"@gid":"12","@x":"595","@y":"525","@width":"35","@height":"35"},{"@gid":"12","@x":"0","@y":"280","@width":"35","@height":"35"},{"@gid":"12","@x":"35","@y":"280","@width":"35","@height":"35"},{"@gid":"12","@x":"630","@y":"490","@width":"35","@height":"35"},{"@gid":"12","@x":"595","@y":"490","@width":"35","@height":"35"},{"@gid":"12","@x":"0","@y":"525","@width":"35","@height":"35"},{"@gid":"12","@x":"665","@y":"525","@width":"35","@height":"35"},{"@gid":"12","@x":"35","@y":"245","@width":"35","@height":"35"},{"@gid":"12","@x":"1330","@y":"560","@width":"35","@height":"35"},{"@gid":"12","@x":"665","@y":"490","@width":"35","@height":"35"},{"@gid":"12","@x":"525","@y":"525","@width":"35","@height":"35"},{"@gid":"12","@x":"1295","@y":"560","@width":"35","@height":"35"},{"@gid":"12","@x":"70","@y":"525","@width":"35","@height":"35"},{"@gid":"12","@x":"35","@y":"525","@width":"35","@height":"35"},{"@gid":"12","@x":"105","@y":"525","@width":"35","@height":"35"},{"@gid":"12","@x":"630","@y":"525","@width":"35","@height":"35"},{"@gid":"12","@x":"70","@y":"280","@width":"35","@height":"35"},{"@gid":"12","@x":"70","@y":"245","@width":"35","@height":"35"},{"@gid":"9","@x":"490","@y":"525","@width":"35","@height":"35"},{"@gid":"9","@x":"455","@y":"525","@width":"35","@height":"35"},{"@gid":"9","@x":"420","@y":"525","@width":"35","@height":"35"},{"@gid":"9","@x":"385","@y":"525","@width":"35","@height":"35"},{"@gid":"9","@x":"350","@y":"525","@width":"35","@height":"35"},{"@gid":"9","@x":"315","@y":"525","@width":"35","@height":"35"},{"@gid":"9","@x":"280","@y":"525","@width":"35","@height":"35"},{"@gid":"9","@x":"245","@y":"525","@width":"35","@height":"35"},{"@gid":"9","@x":"210","@y":"525","@width":"35","@height":"35"},{"@gid":"9","@x":"175","@y":"525","@width":"35","@height":"35"},{"@gid":"9","@x":"140","@y":"525","@width":"35","@height":"35"},{"@gid":"9","@x":"70","@y":"210","@width":"35","@height":"35"},{"@gid":"9","@x":"35","@y":"210","@width":"35","@height":"35"},{"@gid":"9","@x":"0","@y":"210","@width":"35","@height":"35"},{"@gid":"9","@x":"70","@y":"490","@width":"35","@height":"35"},{"@gid":"9","@x":"35","@y":"490","@width":"35","@height":"35"},{"@gid":"9","@x":"560","@y":"490","@width":"35","@height":"35"},{"@gid":"9","@x":"630","@y":"455","@width":"35","@height":"35"},{"@gid":"9","@x":"175","@y":"385","@width":"35","@height":"35"},{"@gid":"8","@x":"420","@y":"175","@width":"35","@height":"35"},{"@gid":"8","@x":"525","@y":"490","@width":"35","@height":"35"},{"@gid":"8","@x":"595","@y":"455","@width":"35","@height":"35"},{"@gid":"8","@x":"665","@y":"245","@width":"35","@height":"35"},{"@gid":"10","@x":"210","@y":"385","@width":"35","@height":"35"},{"@gid":"10","@x":"105","@y":"490","@width":"35","@height":"35"},{"@gid":"10","@x":"105","@y":"210","@width":"35","@height":"35"},{"@gid":"10","@x":"560","@y":"175","@width":"35","@height":"35"},{"@gid":"3","@x":"525","@y":"175","@width":"35","@height":"35"},{"@gid":"3","@x":"490","@y":"175","@width":"35","@height":"35"},{"@gid":"3","@x":"455","@y":"175","@width":"35","@height":"35"},{"@gid":"3","@x":"140","@y":"315","@width":"35","@height":"35"},{"@gid":"3","@x":"175","@y":"315","@width":"35","@height":"35"},{"@gid":"3","@x":"210","@y":"315","@width":"35","@height":"35"},{"@gid":"3","@x":"245","@y":"315","@width":"35","@height":"35"},{"@gid":"3","@x":"280","@y":"315","@width":"35","@height":"35"},{"@gid":"3","@x":"315","@y":"315","@width":"35","@height":"35"},{"@gid":"3","@x":"350","@y":"315","@width":"35","@height":"35"},{"@gid":"3","@x":"385","@y":"315","@width":"35","@height":"35"},{"@gid":"3","@x":"420","@y":"315","@width":"35","@height":"35"},{"@gid":"3","@x":"420","@y":"315","@width":"35","@height":"35"},{"@gid":"3","@x":"455","@y":"315","@width":"35","@height":"35"},{"@gid":"3","@x":"490","@y":"315","@width":"35","@height":"35"},{"@gid":"3","@x":"525","@y":"315","@width":"35","@height":"35"},{"@gid":"3","@x":"385","@y":"210","@width":"35","@height":"35"},{"@gid":"3","@x":"140","@y":"385","@width":"35","@height":"35"},{"@gid":"3","@x":"245","@y":"420","@width":"35","@height":"35"},{"@gid":"3","@x":"280","@y":"420","@width":"35","@height":"35"},{"@gid":"3","@x":"315","@y":"420","@width":"35","@height":"35"},{"@gid":"2","@x":"350","@y":"210","@width":"35","@height":"35"},{"@gid":"2","@x":"105","@y":"385","@width":"35","@height":"35"},{"@gid":"4","@x":"560","@y":"315","@width":"35","@height":"35"},{"@gid":"4","@x":"350","@y":"420","@width":"35","@height":"35"},{"@gid":"11","@x":"665","@y":"280","@width":"35","@height":"35"},{"@gid":"11","@x":"665","@y":"315","@width":"35","@height":"35"},{"@gid":"11","@x":"665","@y":"350","@width":"35","@height":"35"},{"@gid":"11","@x":"665","@y":"385","@width":"35","@height":"35"},{"@gid":"11","@x":"665","@y":"420","@width":"35","@height":"35"},{"@gid":"13","@x":"105","@y":"245","@width":"35","@height":"35"},{"@gid":"13","@x":"105","@y":"280","@width":"35","@height":"35"},{"@gid":"13","@x":"0","@y":"455","@width":"35","@height":"35"},{"@gid":"13","@x":"0","@y":"420","@width":"35","@height":"35"},{"@gid":"13","@x":"0","@y":"385","@width":"35","@height":"35"},{"@gid":"13","@x":"0","@y":"350","@width":"35","@height":"35"},{"@gid":"15","@x":"105","@y":"315","@width":"35","@height":"35"},{"@gid":"15","@x":"70","@y":"315","@width":"35","@height":"35"},{"@gid":"15","@x":"35","@y":"315","@width":"35","@height":"35"},{"@gid":"14","@x":"175","@y":"420","@width":"35","@height":"35"},{"@gid":"16","@x":"420","@y":"210","@width":"35","@height":"35"},{"@gid":"15","@x":"210","@y":"420","@width":"35","@height":"35"},{"@gid":"7","@x":"560","@y":"210","@width":"35","@height":"35"}]},{"@name":"active",object:[{"@gid":"27","@x":"299","@y":"367","@width":"31","@height":"34"},{"@gid":"27","@x":"238","@y":"108","@width":"31","@height":"34"},{"@gid":"27","@x":"494","@y":"223","@width":"31","@height":"34"},{"@type":"6","@gid":"17","@x":"44","@y":"455.5","@width":"24","@height":"11"},{"@type":"4","@gid":"17","@x":"318","@y":"281","@width":"24","@height":"11"},{"@type":"4","@gid":"19","@x":"138","@y":"265","@width":"20","@height":"70","@rotation":"-90"},{"@type":"6","@gid":"19","@x":"384","@y":"420","@width":"20","@height":"70","@rotation":"180"},{"@gid":"32","@x":"104","@y":"175","@width":"35","@height":"35"},{"@gid":"20","@x":"350","@y":"280","@width":"20","@height":"70"},{"@gid":"30","@x":"208","@y":"485","@width":"60","@height":"56"},{"@type":"5","@gid":"19","@x":"664","@y":"300","@width":"20","@height":"70","@rotation":"-90"},{"@type":"5","@gid":"18","@x":"491","@y":"141","@width":"25","@height":"19"},{"@gid":"29","@x":"174","@y":"280.5","@width":"60","@height":"55",properties:{property:[{"@name":"limitLeft","@value":"50"},{"@name":"limitRight","@value":"70"}]}}]},{"@name":"characters",object:[{"@gid":"24","@x":"20","@y":"176","@width":"44","@height":"52"},{"@gid":"28","@x":"511.5","@y":"280","@width":"63","@height":"50"}]},{"@name":"physics",object:[{"@x":"665","@y":"210","@width":"35","@height":"315"},{"@x":"595","@y":"420","@width":"70","@height":"105"},{"@x":"525","@y":"455","@width":"70","@height":"70"},{"@x":"35","@y":"490","@width":"490","@height":"35"},{"@x":"35","@y":"455","@width":"105","@height":"35"},{"@x":"35","@y":"280","@width":"560","@height":"35"},{"@x":"105","@y":"350","@width":"140","@height":"35"},{"@x":"175","@y":"385","@width":"210","@height":"35"},{"@x":"350","@y":"175","@width":"105","@height":"35"},{"@x":"420","@y":"140","@width":"175","@height":"35"},{"@x":"560","@y":"175","@width":"35","@height":"35"},{"@x":"0","@y":"175","@width":"140","@height":"105"},{"@x":"0","@y":"280","@width":"35","@height":"245"}]}]},{"@level":"6","@version":"1.0","@orientation":"orthogonal","@renderorder":"right-down","@width":"20","@height":"15","@tilewidth":"35","@tileheight":"35",tileset:[{"@firstgid":"1","@name":"tiles","@tilewidth":"35","@tileheight":"35",tile:[{"@id":"0",image:{"@width":"35","@height":"35","@source":"tiles/singleTile.png"}},{"@id":"1",image:{"@width":"35","@height":"35","@source":"tiles/platformLeft.png"}},{"@id":"2",image:{"@width":"35","@height":"35","@source":"tiles/platformCenter.png"}},{"@id":"3",image:{"@width":"35","@height":"35","@source":"tiles/platformRight.png"}},{"@id":"4",image:{"@width":"35","@height":"35","@source":"tiles/verticalPlatformTop.png"}},{"@id":"5",image:{"@width":"35","@height":"35","@source":"tiles/verticalPlatformCenter.png"}},{"@id":"6",image:{"@width":"35","@height":"35","@source":"tiles/verticalPlatformBottom.png"}},{"@id":"7",image:{"@width":"35","@height":"35","@source":"tiles/tileTopLeft.png"}},{"@id":"8",image:{"@width":"35","@height":"35","@source":"tiles/tileTopCenter.png"}},{"@id":"9",image:{"@width":"35","@height":"35","@source":"tiles/tileTopRight.png"}},{"@id":"10",image:{"@width":"35","@height":"35","@source":"tiles/tileCenterLeft.png"}},{"@id":"11",image:{"@width":"35","@height":"35","@source":"tiles/tileCenter.png"}},{"@id":"12",image:{"@width":"35","@height":"35","@source":"tiles/tileCenterRight.png"}},{"@id":"13",image:{"@width":"35","@height":"35","@source":"tiles/tileBottomLeft.png"}},{"@id":"14",image:{"@width":"35","@height":"35","@source":"tiles/tileBottomCenter.png"}},{"@id":"15",image:{"@width":"35","@height":"35","@source":"tiles/tileBottomRight.png"}}]},{"@firstgid":"17","@name":"active","@tilewidth":"105","@tileheight":"70",tile:[{"@id":"0",image:{"@width":"24","@height":"11","@source":"active/PushButtonGraphics.png"}},{"@id":"1",image:{"@width":"25","@height":"19","@source":"active/TriggerGraphics.png"}},{"@id":"2",image:{"@width":"20","@height":"70","@source":"active/DoorGraphics.png"}},{"@id":"3",image:{"@width":"20","@height":"70","@source":"active/GlassDoorGraphics.png"}},{"@id":"4",image:{"@width":"70","@height":"19","@source":"active/ElevatorGraphics.png"}},{"@id":"5",image:{"@width":"105","@height":"20","@source":"active/BigElevatorGraphics.png"}},{"@id":"6",image:{"@width":"70","@height":"70","@source":"active/ExitGraphics.png"}},{"@id":"7",image:{"@width":"44","@height":"52","@source":"characters/HustlerGraphics.png"}},{"@id":"8",image:{"@width":"32","@height":"22","@source":"active/CameraGraphics.png"}},{"@id":"9",image:{"@width":"15","@height":"15","@source":"characters/EnemyLimiterGraphics.png"}},{"@id":"10",image:{"@width":"31","@height":"34","@source":"passive/MoneyBagGraphics.png"}},{"@id":"11",image:{"@width":"63","@height":"50","@source":"characters/DogGraphics.png"}},{"@id":"12",image:{"@width":"60","@height":"55","@source":"characters/Prisoner2Graphics.png"}},{"@id":"13",image:{"@width":"60","@height":"56","@source":"characters/PrisonerGraphics.png"}}]},{"@firstgid":"31","@name":"passive","@tilewidth":"210","@tileheight":"50",tile:[{"@id":"0",image:{"@width":"50","@height":"50","@source":"passive/BigBoxGraphics.png"}},{"@id":"1",image:{"@width":"35","@height":"35","@source":"passive/BoxGraphics.png"}},{"@id":"2",image:{"@width":"37","@height":"35","@source":"passive/ToiletGraphics.png"}},{"@id":"3",image:{"@width":"35","@height":"35","@source":"passive/MonitorGraphics.png"}},{"@id":"4",image:{"@width":"35","@height":"35","@source":"passive/BasketBallGraphics.png"}},{"@id":"5",image:{"@width":"35","@height":"35","@source":"passive/StoolGraphics.png"}},{"@id":"6",image:{"@width":"150","@height":"20","@source":"passive/PlankGraphics.png"}},{"@id":"7",image:{"@width":"150","@height":"20","@source":"passive/Plank2Graphics.png"}},{"@id":"8",image:{"@width":"210","@height":"20","@source":"passive/BigPlankGraphics.png"}},{"@id":"9",image:{"@width":"100","@height":"20","@source":"passive/Plank5Graphics.png"}},{"@id":"10",image:{"@width":"150","@height":"20","@source":"passive/Plank2Graphics.png"}},{"@id":"11",image:{"@width":"35","@height":"35","@source":"passive/MirrorGraphics.png"}}]},{"@firstgid":"43","@name":"decor","@tilewidth":"232","@tileheight":"136",tile:[{"@id":"0",image:{"@width":"232","@height":"79","@source":"decor/LevelTextGraphics.png"}},{"@id":"1",image:{"@width":"54","@height":"20","@source":"decor/Decor1Graphics.png"}},{"@id":"2",image:{"@width":"54","@height":"20","@source":"decor/Decor2Graphics.png"}},{"@id":"3",image:{"@width":"33","@height":"27","@source":"decor/Decor3Graphics.png"}},{"@id":"4",image:{"@width":"34","@height":"25","@source":"decor/Decor4Graphics.png"}},{"@id":"5",image:{"@width":"22","@height":"31","@source":"decor/Decor5Graphics.png"}},{"@id":"6",image:{"@width":"126","@height":"59","@source":"decor/Decor6Graphics.png"}},{"@id":"7",image:{"@width":"25","@height":"21","@source":"decor/Decor8Graphics.png"}},{"@id":"8",image:{"@width":"18","@height":"22","@source":"decor/Decor9Graphics.png"}},{"@id":"9",image:{"@width":"35","@height":"58","@source":"decor/Decor10Graphics.png"}},{"@id":"10",image:{"@width":"19","@height":"66","@source":"decor/Decor11Graphics.png"}},{"@id":"11",image:{"@width":"23","@height":"33","@source":"decor/Decor12Graphics.png"}},{"@id":"12",image:{"@width":"38","@height":"26","@source":"decor/Decor13Graphics.png"}},{"@id":"13",image:{"@width":"43","@height":"78","@source":"decor/Decor14Graphics.png"}},{"@id":"14",image:{"@width":"60","@height":"86","@source":"decor/Decor15Graphics.png"}},{"@id":"15",image:{"@width":"41","@height":"69","@source":"decor/Decor16Graphics.png"}},{"@id":"16",image:{"@width":"55","@height":"58","@source":"decor/Decor17Graphics.png"}},{"@id":"17",image:{"@width":"57","@height":"54","@source":"decor/Decor18Graphics.png"}},{"@id":"18",image:{"@width":"18","@height":"45","@source":"decor/Decor19Graphics.png"}},{"@id":"19",image:{"@width":"41","@height":"49","@source":"decor/Decor20Graphics.png"}},{"@id":"20",image:{"@width":"51","@height":"38","@source":"decor/Decor21Graphics.png"}},{"@id":"21",image:{"@width":"54","@height":"54","@source":"decor/Decor22Graphics.png"}},{"@id":"22",image:{"@width":"63","@height":"136","@source":"decor/Decor23Graphics.png"}},{"@id":"23",image:{"@width":"21","@height":"39","@source":"decor/Decor24Graphics.png"}},{"@id":"24",image:{"@width":"104","@height":"50","@source":"decor/Decor25Graphics.png"}},{"@id":"25",image:{"@width":"104","@height":"46","@source":"decor/Decor26Graphics.png"}},{"@id":"26",image:{"@width":"86","@height":"38","@source":"decor/Decor27Graphics.png"}},{"@id":"27",image:{"@width":"63","@height":"55","@source":"decor/Decor28Graphics.png"}},{"@id":"28",image:{"@width":"13","@height":"23","@source":"decor/Decor29Graphics.png"}},{"@id":"29",image:{"@width":"28","@height":"40","@source":"decor/Decor30Graphics.png"}},{"@id":"30",image:{"@width":"69","@height":"30","@source":"decor/Decor31Graphics.png"}},{"@id":"31",image:{"@width":"33","@height":"29","@source":"decor/Decor32Graphics.png"}},{"@id":"32",image:{"@width":"42","@height":"42","@source":"decor/Decor33Graphics.png"}},{"@id":"33",image:{"@width":"60","@height":"66","@source":"decor/Decor34Graphics.png"}},{"@id":"34",image:{"@width":"46","@height":"65","@source":"decor/Decor35Graphics.png"}},{"@id":"35",image:{"@width":"71","@height":"55","@source":"decor/Decor36Graphics.png"}},{"@id":"36",image:{"@width":"35","@height":"55","@source":"decor/Decor37Graphics.png"}},{"@id":"37",image:{"@width":"28","@height":"29","@source":"decor/Decor38Graphics.png"}},{"@id":"38",image:{"@width":"38","@height":"37","@source":"decor/Decor39Graphics.png"}},{"@id":"39",image:{"@width":"103","@height":"50","@source":"decor/Decor40Graphics.png"}},{"@id":"40",image:{"@width":"56","@height":"55","@source":"decor/Decor41Graphics.png"}},{"@id":"41",image:{"@width":"71","@height":"50","@source":"decor/Decor42Graphics.png"}},{"@id":"42",image:{"@width":"232","@height":"79","@source":"decor/LevelTextGraphics.png"}}]}],imagelayer:{"@name":"background",image:{"@source":"bg/Background1Graphics.png"}},objectgroup:[{"@name":"decorations",object:[{"@gid":"45","@x":"350","@y":"229","@width":"54","@height":"20"},{"@gid":"69","@x":"385","@y":"385","@width":"86","@height":"38"},{"@gid":"80","@x":"420","@y":"350","@width":"28","@height":"29"},{"@gid":"83","@x":"79","@y":"185","@width":"56","@height":"55"},{"@gid":"53","@x":"595","@y":"105","@width":"19","@height":"66"},{"@gid":"54","@x":"175","@y":"471","@width":"23","@height":"33"},{"@gid":"51","@x":"560","@y":"455","@width":"18","@height":"22"},{"@gid":"57","@x":"163","@y":"231","@width":"60","@height":"86"},{"@gid":"43","@x":"315","@y":"140","@width":"232","@height":"79",properties:{property:{"@name":"text","@value":"level_text_6"}}},{"@gid":"82","@x":"315","@y":"315"}]},{"@name":"tiles",object:[{"@gid":"12","@x":"0","@y":"525","@width":"35","@height":"35"},{"@gid":"12","@x":"350","@y":"525","@width":"35","@height":"35"},{"@gid":"12","@x":"35","@y":"525","@width":"35","@height":"35"},{"@gid":"9","@x":"560","@y":"525","@width":"35","@height":"35"},{"@gid":"9","@x":"525","@y":"525","@width":"35","@height":"35"},{"@gid":"9","@x":"455","@y":"525","@width":"35","@height":"35"},{"@gid":"9","@x":"490","@y":"525","@width":"35","@height":"35"},{"@gid":"9","@x":"280","@y":"525","@width":"35","@height":"35"},{"@gid":"9","@x":"385","@y":"525","@width":"35","@height":"35"},{"@gid":"9","@x":"315","@y":"525","@width":"35","@height":"35"},{"@gid":"9","@x":"175","@y":"525","@width":"35","@height":"35"},{"@gid":"9","@x":"140","@y":"525","@width":"35","@height":"35"},{"@gid":"9","@x":"105","@y":"525","@width":"35","@height":"35"},{"@gid":"9","@x":"210","@y":"525","@width":"35","@height":"35"},{"@gid":"12","@x":"595","@y":"525","@width":"35","@height":"35"},{"@gid":"12","@x":"0","@y":"490","@width":"35","@height":"35"},{"@gid":"12","@x":"105","@y":"35","@width":"35","@height":"35"},{"@gid":"12","@x":"70","@y":"70","@width":"35","@height":"35"},{"@gid":"10","@x":"70","@y":"455","@width":"35","@height":"35"},{"@gid":"13","@x":"70","@y":"490","@width":"35","@height":"35"},{"@gid":"9","@x":"245","@y":"525","@width":"35","@height":"35"},{"@gid":"9","@x":"420","@y":"525","@width":"35","@height":"35"},{"@gid":"9","@x":"630","@y":"525","@width":"35","@height":"35"},{"@gid":"9","@x":"665","@y":"525","@width":"35","@height":"35"},{"@gid":"5","@x":"595","@y":"490","@width":"35","@height":"35"},{"@gid":"16","@x":"490","@y":"420","@width":"35","@height":"35"},{"@gid":"8","@x":"490","@y":"350","@width":"35","@height":"35"},{"@gid":"3","@x":"455","@y":"420","@width":"35","@height":"35"},{"@gid":"3","@x":"420","@y":"420","@width":"35","@height":"35"},{"@gid":"3","@x":"385","@y":"420","@width":"35","@height":"35"},{"@gid":"16","@x":"595","@y":"385","@width":"35","@height":"35"},{"@gid":"9","@x":"350","@y":"420","@width":"35","@height":"35"},{"@gid":"14","@x":"140","@y":"420","@width":"35","@height":"35"},{"@gid":"6","@x":"595","@y":"315","@width":"35","@height":"35"},{"@gid":"6","@x":"595","@y":"280","@width":"35","@height":"35"},{"@gid":"13","@x":"595","@y":"245","@width":"35","@height":"35"},{"@gid":"13","@x":"595","@y":"210","@width":"35","@height":"35"},{"@gid":"14","@x":"560","@y":"245","@width":"35","@height":"35"},{"@gid":"3","@x":"315","@y":"210","@width":"35","@height":"35"},{"@gid":"3","@x":"455","@y":"210","@width":"35","@height":"35"},{"@gid":"3","@x":"490","@y":"210","@width":"35","@height":"35"},{"@gid":"3","@x":"525","@y":"210","@width":"35","@height":"35"},{"@gid":"9","@x":"280","@y":"210","@width":"35","@height":"35"},{"@gid":"8","@x":"245","@y":"210","@width":"35","@height":"35"},{"@gid":"16","@x":"280","@y":"245","@width":"35","@height":"35"},{"@gid":"6","@x":"350","@y":"490","@width":"35","@height":"35"},{"@gid":"6","@x":"350","@y":"455","@width":"35","@height":"35"},{"@gid":"12","@x":"35","@y":"490","@width":"35","@height":"35"},{"@gid":"12","@x":"70","@y":"525","@width":"35","@height":"35"},{"@gid":"12","@x":"35","@y":"455","@width":"35","@height":"35"},{"@gid":"12","@x":"0","@y":"455","@width":"35","@height":"35"},{"@gid":"10","@x":"35","@y":"385","@width":"35","@height":"35"},{"@gid":"13","@x":"35","@y":"420","@width":"35","@height":"35"},{"@gid":"12","@x":"0","@y":"420","@width":"35","@height":"35"},{"@gid":"3","@x":"140","@y":"245","@width":"35","@height":"35"},{"@gid":"9","@x":"105","@y":"245","@width":"35","@height":"35"},{"@gid":"9","@x":"70","@y":"245","@width":"35","@height":"35"},{"@gid":"16","@x":"105","@y":"280","@width":"35","@height":"35"},{"@gid":"15","@x":"70","@y":"280","@width":"35","@height":"35"},{"@gid":"13","@x":"0","@y":"245","@width":"35","@height":"35"},{"@gid":"13","@x":"0","@y":"175","@width":"35","@height":"35"},{"@gid":"13","@x":"0","@y":"210","@width":"35","@height":"35"},{"@gid":"13","@x":"0","@y":"140","@width":"35","@height":"35"},{"@gid":"13","@x":"0","@y":"105","@width":"35","@height":"35"},{"@gid":"14","@x":"70","@y":"105","@width":"35","@height":"35"},{"@gid":"3","@x":"105","@y":"105","@width":"35","@height":"35"},{"@gid":"15","@x":"140","@y":"105","@width":"35","@height":"35"},{"@gid":"3","@x":"210","@y":"105","@width":"35","@height":"35"},{"@gid":"3","@x":"175","@y":"105","@width":"35","@height":"35"},{"@gid":"3","@x":"245","@y":"105","@width":"35","@height":"35"},{"@gid":"10","@x":"280","@y":"105","@width":"35","@height":"35"},{"@gid":"7","@x":"280","@y":"140","@width":"35","@height":"35"},{"@gid":"6","@x":"140","@y":"70","@width":"35","@height":"35"},{"@gid":"13","@x":"140","@y":"35","@width":"35","@height":"35"},{"@gid":"15","@x":"35","@y":"70","@width":"35","@height":"35"},{"@gid":"12","@x":"0","@y":"70","@width":"35","@height":"35"},{"@gid":"12","@x":"0","@y":"35","@width":"35","@height":"35"},{"@gid":"12","@x":"35","@y":"35","@width":"35","@height":"35"},{"@gid":"12","@x":"70","@y":"35","@width":"35","@height":"35"},{"@gid":"3","@x":"175","@y":"245","@width":"35","@height":"35"},{"@gid":"3","@x":"210","@y":"245","@width":"35","@height":"35"},{"@gid":"15","@x":"245","@y":"245","@width":"35","@height":"35"},{"@gid":"3","@x":"350","@y":"210","@width":"35","@height":"35"},{"@gid":"3","@x":"385","@y":"210","@width":"35","@height":"35"},{"@gid":"3","@x":"420","@y":"210","@width":"35","@height":"35"},{"@gid":"12","@x":"560","@y":"210","@width":"35","@height":"35"},{"@gid":"9","@x":"560","@y":"175","@width":"35","@height":"35"},{"@gid":"10","@x":"595","@y":"175","@width":"35","@height":"35"},{"@gid":"9","@x":"560","@y":"350","@width":"35","@height":"35"},{"@gid":"13","@x":"595","@y":"350","@width":"35","@height":"35"},{"@gid":"11","@x":"490","@y":"385","@width":"35","@height":"35"},{"@gid":"15","@x":"560","@y":"385","@width":"35","@height":"35"},{"@gid":"9","@x":"525","@y":"350","@width":"35","@height":"35"},{"@gid":"15","@x":"525","@y":"385","@width":"35","@height":"35"},{"@gid":"3","@x":"35","@y":"280","@width":"35","@height":"35"},{"@gid":"15","@x":"175","@y":"420"},{"@gid":"8","@x":"140","@y":"385"},{"@gid":"2","@x":"315","@y":"350"},{"@gid":"4","@x":"350","@y":"350"},{"@gid":"3","@x":"280","@y":"420","@width":"35","@height":"35"},{"@gid":"3","@x":"210","@y":"420","@width":"35","@height":"35"},{"@gid":"3","@x":"245","@y":"420","@width":"35","@height":"35"},{"@gid":"3","@x":"315","@y":"420","@width":"35","@height":"35"},{"@gid":"13","@x":"0","@y":"350"},{"@gid":"13","@x":"0","@y":"315"},{"@gid":"12","@x":"0","@y":"280"},{"@gid":"12","@x":"0","@y":"385","@width":"35","@height":"35"},{"@gid":"13","@x":"175","@y":"385"},{"@gid":"8","@x":"175","@y":"350"},{"@gid":"4","@x":"210","@y":"350"},{"@x":"140","@y":"350","@width":"70","@height":"35"},{"@x":"175","@y":"315","@width":"70","@height":"35"}]},{"@name":"active",object:[{"@gid":"30","@x":"385","@y":"385","@width":"60","@height":"56"},{"@type":"2","@gid":"21","@x":"630","@y":"475","@width":"70","@height":"19",properties:{property:[{"@name":"distanceY","@value":"295"},{"@name":"speedY","@value":"-45"}]}},{"@type":"2","@gid":"17","@x":"530","@y":"316","@width":"24","@height":"11"},{"@gid":"35","@x":"182","@y":"70","@width":"35","@height":"35"},{"@type":"3","@gid":"19","@x":"175","@y":"64","@width":"20","@height":"70","@rotation":"-90"},{"@type":"3","@gid":"17","@x":"490","@y":"175","@width":"24","@height":"11"},{"@gid":"17","@x":"40","@y":"246","@width":"24","@height":"11"},{"@gid":"27","@x":"420","@y":"254","@width":"31","@height":"34"},{"@gid":"27","@x":"654","@y":"106","@width":"31","@height":"34"},{"@gid":"27","@x":"316","@y":"385","@width":"31","@height":"34"},{"@gid":"25","@x":"210","@y":"371","@width":"32","@height":"22",properties:{property:[{"@name":"delay","@value":"0"},{"@name":"maxAngle","@value":"180"},{"@name":"minAngle","@value":"180"},{"@name":"speedX","@value":"1"}]}},{"@gid":"19","@x":"376","@y":"350","@width":"20","@height":"70","@rotation":"180"}]},{"@name":"characters",object:[{"@gid":"24","@x":"275","@y":"492","@width":"44","@height":"52"},{"@gid":"28","@x":"455","@y":"490","@width":"63","@height":"50"}]},{"@name":"physics",object:[{"@x":"0","@y":"420","@width":"105","@height":"105"},{"@x":"0","@y":"350","@width":"70","@height":"70"},{"@x":"105","@y":"490","@width":"595","@height":"35"},{"@x":"595","@y":"455","@width":"35","@height":"35"},{"@x":"350","@y":"420","@width":"35","@height":"70"},{"@x":"140","@y":"385","@width":"385","@height":"35"},{"@x":"315","@y":"315","@width":"70","@height":"35"},{"@x":"490","@y":"315","@width":"140","@height":"70"},{"@x":"560","@y":"140","@width":"70","@height":"105"},{"@x":"595","@y":"245","@width":"35","@height":"70"},{"@x":"245","@y":"175","@width":"315","@height":"35"},{"@x":"70","@y":"210","@width":"245","@height":"35"},{"@x":"35","@y":"0","@width":"140","@height":"70"},{"@x":"70","@y":"70","@width":"245","@height":"35"},{"@x":"280","@y":"105","@width":"35","@height":"35"},{"@x":"0","@y":"0","@width":"35","@height":"350"},{"@x":"35","@y":"245","@width":"105","@height":"35"}]}]},{"@level":"7","@version":"1.0","@orientation":"orthogonal","@renderorder":"right-down","@width":"20","@height":"15","@tilewidth":"35","@tileheight":"35",tileset:[{"@firstgid":"1","@name":"tiles","@tilewidth":"35","@tileheight":"35",tile:[{"@id":"0",image:{"@width":"35","@height":"35","@source":"tiles/singleTile.png"}},{"@id":"1",image:{"@width":"35","@height":"35","@source":"tiles/platformLeft.png"}},{"@id":"2",image:{"@width":"35","@height":"35","@source":"tiles/platformCenter.png"}},{"@id":"3",image:{"@width":"35","@height":"35","@source":"tiles/platformRight.png"}},{"@id":"4",image:{"@width":"35","@height":"35","@source":"tiles/verticalPlatformTop.png"}},{"@id":"5",image:{"@width":"35","@height":"35","@source":"tiles/verticalPlatformCenter.png"}},{"@id":"6",image:{"@width":"35","@height":"35","@source":"tiles/verticalPlatformBottom.png"}},{"@id":"7",image:{"@width":"35","@height":"35","@source":"tiles/tileTopLeft.png"}},{"@id":"8",image:{"@width":"35","@height":"35","@source":"tiles/tileTopCenter.png"}},{"@id":"9",image:{"@width":"35","@height":"35","@source":"tiles/tileTopRight.png"}},{"@id":"10",image:{"@width":"35","@height":"35","@source":"tiles/tileCenterLeft.png"}},{"@id":"11",image:{"@width":"35","@height":"35","@source":"tiles/tileCenter.png"}},{"@id":"12",image:{"@width":"35","@height":"35","@source":"tiles/tileCenterRight.png"}},{"@id":"13",image:{"@width":"35","@height":"35","@source":"tiles/tileBottomLeft.png"}},{"@id":"14",image:{"@width":"35","@height":"35","@source":"tiles/tileBottomCenter.png"}},{"@id":"15",image:{"@width":"35","@height":"35","@source":"tiles/tileBottomRight.png"}}]},{"@firstgid":"17","@name":"active","@tilewidth":"105","@tileheight":"70",tile:[{"@id":"0",image:{"@width":"24","@height":"11","@source":"active/PushButtonGraphics.png"}},{"@id":"1",image:{"@width":"25","@height":"19","@source":"active/TriggerGraphics.png"}},{"@id":"2",image:{"@width":"20","@height":"70","@source":"active/DoorGraphics.png"}},{"@id":"3",image:{"@width":"20","@height":"70","@source":"active/GlassDoorGraphics.png"}},{"@id":"4",image:{"@width":"70","@height":"19","@source":"active/ElevatorGraphics.png"}},{"@id":"5",image:{"@width":"105","@height":"20","@source":"active/BigElevatorGraphics.png"}},{"@id":"6",image:{"@width":"70","@height":"70","@source":"active/ExitGraphics.png"}},{"@id":"7",image:{"@width":"44","@height":"52","@source":"characters/HustlerGraphics.png"}},{"@id":"8",image:{"@width":"32","@height":"22","@source":"active/CameraGraphics.png"}},{"@id":"9",image:{"@width":"15","@height":"15","@source":"characters/EnemyLimiterGraphics.png"}},{"@id":"10",image:{"@width":"31","@height":"34","@source":"passive/MoneyBagGraphics.png"}},{"@id":"11",image:{"@width":"63","@height":"50","@source":"characters/DogGraphics.png"}},{"@id":"12",image:{"@width":"60","@height":"55","@source":"characters/Prisoner2Graphics.png"}},{"@id":"13",image:{"@width":"60","@height":"56","@source":"characters/PrisonerGraphics.png"}}]},{"@firstgid":"31","@name":"passive","@tilewidth":"210","@tileheight":"50",tile:[{"@id":"0",image:{"@width":"50","@height":"50","@source":"passive/BigBoxGraphics.png"}},{"@id":"1",image:{"@width":"35","@height":"35","@source":"passive/BoxGraphics.png"}},{"@id":"2",image:{"@width":"37","@height":"35","@source":"passive/ToiletGraphics.png"}},{"@id":"3",image:{"@width":"35","@height":"35","@source":"passive/MonitorGraphics.png"}},{"@id":"4",image:{"@width":"35","@height":"35","@source":"passive/BasketBallGraphics.png"}},{"@id":"5",image:{"@width":"35","@height":"35","@source":"passive/StoolGraphics.png"}},{"@id":"6",image:{"@width":"150","@height":"20","@source":"passive/PlankGraphics.png"}},{"@id":"7",image:{"@width":"150","@height":"20","@source":"passive/Plank2Graphics.png"}},{"@id":"8",image:{"@width":"210","@height":"20","@source":"passive/BigPlankGraphics.png"}},{"@id":"9",image:{"@width":"100","@height":"20","@source":"passive/Plank5Graphics.png"}},{"@id":"10",image:{"@width":"150","@height":"20","@source":"passive/Plank2Graphics.png"}},{"@id":"11",image:{"@width":"35","@height":"35","@source":"passive/MirrorGraphics.png"}}]},{"@firstgid":"43","@name":"decor","@tilewidth":"232","@tileheight":"136",tile:[{"@id":"0",image:{"@width":"232","@height":"79","@source":"decor/LevelTextGraphics.png"}},{"@id":"1",image:{"@width":"54","@height":"20","@source":"decor/Decor1Graphics.png"}},{"@id":"2",image:{"@width":"54","@height":"20","@source":"decor/Decor2Graphics.png"}},{"@id":"3",image:{"@width":"33","@height":"27","@source":"decor/Decor3Graphics.png"}},{"@id":"4",image:{"@width":"34","@height":"25","@source":"decor/Decor4Graphics.png"}},{"@id":"5",image:{"@width":"22","@height":"31","@source":"decor/Decor5Graphics.png"}},{"@id":"6",image:{"@width":"126","@height":"59","@source":"decor/Decor6Graphics.png"}},{"@id":"7",image:{"@width":"25","@height":"21","@source":"decor/Decor8Graphics.png"}},{"@id":"8",image:{"@width":"18","@height":"22","@source":"decor/Decor9Graphics.png"}},{"@id":"9",image:{"@width":"35","@height":"58","@source":"decor/Decor10Graphics.png"}},{"@id":"10",image:{"@width":"19","@height":"66","@source":"decor/Decor11Graphics.png"}},{"@id":"11",image:{"@width":"23","@height":"33","@source":"decor/Decor12Graphics.png"}},{"@id":"12",image:{"@width":"38","@height":"26","@source":"decor/Decor13Graphics.png"}},{"@id":"13",image:{"@width":"43","@height":"78","@source":"decor/Decor14Graphics.png"}},{"@id":"14",image:{"@width":"60","@height":"86","@source":"decor/Decor15Graphics.png"}},{"@id":"15",image:{"@width":"41","@height":"69","@source":"decor/Decor16Graphics.png"}},{"@id":"16",image:{"@width":"55","@height":"58","@source":"decor/Decor17Graphics.png"}},{"@id":"17",image:{"@width":"57","@height":"54","@source":"decor/Decor18Graphics.png"}},{"@id":"18",image:{"@width":"18","@height":"45","@source":"decor/Decor19Graphics.png"}},{"@id":"19",image:{"@width":"41","@height":"49","@source":"decor/Decor20Graphics.png"}},{"@id":"20",image:{"@width":"51","@height":"38","@source":"decor/Decor21Graphics.png"}},{"@id":"21",image:{"@width":"54","@height":"54","@source":"decor/Decor22Graphics.png"}},{"@id":"22",image:{"@width":"63","@height":"136","@source":"decor/Decor23Graphics.png"}},{"@id":"23",image:{"@width":"21","@height":"39","@source":"decor/Decor24Graphics.png"}},{"@id":"24",image:{"@width":"104","@height":"50","@source":"decor/Decor25Graphics.png"}},{"@id":"25",image:{"@width":"104","@height":"46","@source":"decor/Decor26Graphics.png"}},{"@id":"26",image:{"@width":"86","@height":"38","@source":"decor/Decor27Graphics.png"}},{"@id":"27",image:{"@width":"63","@height":"55","@source":"decor/Decor28Graphics.png"}},{"@id":"28",image:{"@width":"13","@height":"23","@source":"decor/Decor29Graphics.png"}},{"@id":"29",image:{"@width":"28","@height":"40","@source":"decor/Decor30Graphics.png"}},{"@id":"30",image:{"@width":"69","@height":"30","@source":"decor/Decor31Graphics.png"}},{"@id":"31",image:{"@width":"33","@height":"29","@source":"decor/Decor32Graphics.png"}},{"@id":"32",image:{"@width":"42","@height":"42","@source":"decor/Decor33Graphics.png"}},{"@id":"33",image:{"@width":"60","@height":"66","@source":"decor/Decor34Graphics.png"}},{"@id":"34",image:{"@width":"46","@height":"65","@source":"decor/Decor35Graphics.png"}},{"@id":"35",image:{"@width":"71","@height":"55","@source":"decor/Decor36Graphics.png"}},{"@id":"36",image:{"@width":"35","@height":"55","@source":"decor/Decor37Graphics.png"}},{"@id":"37",image:{"@width":"28","@height":"29","@source":"decor/Decor38Graphics.png"}},{"@id":"38",image:{"@width":"38","@height":"37","@source":"decor/Decor39Graphics.png"}},{"@id":"39",image:{"@width":"103","@height":"50","@source":"decor/Decor40Graphics.png"}},{"@id":"40",image:{"@width":"56","@height":"55","@source":"decor/Decor41Graphics.png"}},{"@id":"41",image:{"@width":"71","@height":"50","@source":"decor/Decor42Graphics.png"}},{"@id":"42",image:{"@width":"200","@height":"44","@source":"decor/TxtGraphics.png"}}]}],imagelayer:{"@name":"background",image:{"@source":"bg/Background1Graphics.png"}},objectgroup:[{"@name":"decorations",object:[{"@gid":"43","@x":"105","@y":"175","@width":"232","@height":"79",properties:{property:{"@name":"text","@value":"level_text_7"}}},{"@gid":"84","@x":"420","@y":"140","@width":"71","@height":"50"},{"@gid":"51","@x":"584","@y":"320","@width":"18","@height":"22"},{"@gid":"67","@x":"175","@y":"350","@width":"104","@height":"50"},{"@gid":"78","@x":"391","@y":"350","@width":"71","@height":"55"},{"@gid":"45","@x":"175","@y":"229","@width":"54","@height":"20"},{"@gid":"44","@x":"569","@y":"264","@width":"54","@height":"20"}]},{"@name":"tiles",object:[{"@gid":"12","@x":"-132","@y":"-197","@width":"35","@height":"35"},{"@gid":"12","@x":"-97","@y":"-197","@width":"35","@height":"35"},{"@gid":"12","@x":"0","@y":"490","@width":"35","@height":"35"},{"@gid":"12","@x":"-62","@y":"-197","@width":"35","@height":"35"},{"@gid":"12","@x":"175","@y":"525","@width":"35","@height":"35"},{"@gid":"12","@x":"0","@y":"525","@width":"35","@height":"35"},{"@gid":"12","@x":"35","@y":"525","@width":"35","@height":"35"},{"@gid":"12","@x":"595","@y":"525","@width":"35","@height":"35"},{"@gid":"12","@x":"315","@y":"315","@width":"35","@height":"35"},{"@gid":"3","@x":"70","@y":"105","@width":"35","@height":"35"},{"@gid":"3","@x":"35","@y":"105","@width":"35","@height":"35"},{"@gid":"3","@x":"0","@y":"105","@width":"35","@height":"35"},{"@gid":"16","@x":"105","@y":"105","@width":"35","@height":"35"},{"@gid":"8","@x":"105","@y":"70","@width":"35","@height":"35"},{"@gid":"3","@x":"210","@y":"70","@width":"35","@height":"35"},{"@gid":"3","@x":"175","@y":"70","@width":"35","@height":"35"},{"@gid":"3","@x":"140","@y":"70","@width":"35","@height":"35"},{"@gid":"3","@x":"315","@y":"70","@width":"35","@height":"35"},{"@gid":"3","@x":"280","@y":"70","@width":"35","@height":"35"},{"@gid":"3","@x":"245","@y":"70","@width":"35","@height":"35"},{"@gid":"3","@x":"455","@y":"70","@width":"35","@height":"35"},{"@gid":"3","@x":"420","@y":"70","@width":"35","@height":"35"},{"@gid":"3","@x":"385","@y":"70","@width":"35","@height":"35"},{"@gid":"3","@x":"490","@y":"70","@width":"35","@height":"35"},{"@gid":"9","@x":"350","@y":"70","@width":"35","@height":"35"},{"@gid":"10","@x":"525","@y":"70","@width":"35","@height":"35"},{"@gid":"14","@x":"525","@y":"105","@width":"35","@height":"35"},{"@gid":"3","@x":"560","@y":"105","@width":"35","@height":"35"},{"@gid":"3","@x":"595","@y":"105","@width":"35","@height":"35"},{"@gid":"3","@x":"630","@y":"105","@width":"35","@height":"35"},{"@gid":"9","@x":"665","@y":"105","@width":"35","@height":"35"},{"@gid":"11","@x":"665","@y":"140","@width":"35","@height":"35"},{"@gid":"11","@x":"665","@y":"175","@width":"35","@height":"35"},{"@gid":"11","@x":"665","@y":"210","@width":"35","@height":"35"},{"@gid":"3","@x":"595","@y":"245","@width":"35","@height":"35"},{"@gid":"3","@x":"630","@y":"245","@width":"35","@height":"35"},{"@gid":"2","@x":"560","@y":"245","@width":"35","@height":"35"},{"@gid":"15","@x":"665","@y":"245","@width":"35","@height":"35"},{"@gid":"6","@x":"350","@y":"105","@width":"35","@height":"35"},{"@gid":"6","@x":"350","@y":"140","@width":"35","@height":"35"},{"@gid":"6","@x":"350","@y":"175","@width":"35","@height":"35"},{"@gid":"3","@x":"385","@y":"210","@width":"35","@height":"35"},{"@gid":"10","@x":"455","@y":"210","@width":"35","@height":"35"},{"@gid":"16","@x":"455","@y":"280","@width":"35","@height":"35"},{"@gid":"3","@x":"385","@y":"280","@width":"35","@height":"35"},{"@gid":"15","@x":"420","@y":"280","@width":"35","@height":"35"},{"@gid":"13","@x":"350","@y":"315","@width":"35","@height":"35"},{"@gid":"6","@x":"350","@y":"350","@width":"35","@height":"35"},{"@gid":"9","@x":"315","@y":"280","@width":"35","@height":"35"},{"@gid":"8","@x":"280","@y":"280","@width":"35","@height":"35"},{"@gid":"11","@x":"280","@y":"315","@width":"35","@height":"35"},{"@gid":"6","@x":"280","@y":"350","@width":"35","@height":"35"},{"@gid":"16","@x":"280","@y":"385","@width":"35","@height":"35"},{"@gid":"11","@x":"350","@y":"385","@width":"35","@height":"35"},{"@gid":"7","@x":"350","@y":"420","@width":"35","@height":"35"},{"@gid":"3","@x":"245","@y":"385","@width":"35","@height":"35"},{"@gid":"3","@x":"210","@y":"385","@width":"35","@height":"35"},{"@gid":"9","@x":"175","@y":"385","@width":"35","@height":"35"},{"@gid":"3","@x":"140","@y":"385","@width":"35","@height":"35"},{"@gid":"14","@x":"70","@y":"385","@width":"35","@height":"35"},{"@gid":"3","@x":"245","@y":"210","@width":"35","@height":"35"},{"@gid":"3","@x":"140","@y":"210","@width":"35","@height":"35"},{"@gid":"3","@x":"210","@y":"210","@width":"35","@height":"35"},{"@gid":"3","@x":"175","@y":"210","@width":"35","@height":"35"},{"@gid":"4","@x":"280","@y":"210","@width":"35","@height":"35"},{"@gid":"10","@x":"0","@y":"420","@width":"35","@height":"35"},{"@gid":"13","@x":"0","@y":"455","@width":"35","@height":"35"},{"@gid":"10","@x":"35","@y":"490","@width":"35","@height":"35"},{"@gid":"9","@x":"70","@y":"525","@width":"35","@height":"35"},{"@gid":"9","@x":"105","@y":"525","@width":"35","@height":"35"},{"@gid":"9","@x":"140","@y":"525","@width":"35","@height":"35"},{"@gid":"6","@x":"175","@y":"420","@width":"35","@height":"35"},{"@gid":"6","@x":"175","@y":"455","@width":"35","@height":"35"},{"@gid":"6","@x":"175","@y":"490","@width":"35","@height":"35"},{"@gid":"9","@x":"210","@y":"525","@width":"35","@height":"35"},{"@gid":"9","@x":"245","@y":"525","@width":"35","@height":"35"},{"@gid":"9","@x":"280","@y":"525","@width":"35","@height":"35"},{"@gid":"9","@x":"315","@y":"525","@width":"35","@height":"35"},{"@gid":"9","@x":"420","@y":"525","@width":"35","@height":"35"},{"@gid":"9","@x":"385","@y":"525","@width":"35","@height":"35"},{"@gid":"9","@x":"350","@y":"525","@width":"35","@height":"35"},{"@gid":"9","@x":"455","@y":"525","@width":"35","@height":"35"},{"@gid":"9","@x":"560","@y":"525","@width":"35","@height":"35"},{"@gid":"9","@x":"525","@y":"525","@width":"35","@height":"35"},{"@gid":"9","@x":"490","@y":"525","@width":"35","@height":"35"},{"@gid":"9","@x":"665","@y":"525","@width":"35","@height":"35"},{"@gid":"9","@x":"630","@y":"525","@width":"35","@height":"35"},{"@gid":"5","@x":"595","@y":"490","@width":"35","@height":"35"},{"@gid":"4","@x":"595","@y":"385","@width":"35","@height":"35"},{"@gid":"3","@x":"560","@y":"385","@width":"35","@height":"35"},{"@gid":"3","@x":"525","@y":"385","@width":"35","@height":"35"},{"@gid":"9","@x":"490","@y":"385","@width":"35","@height":"35"},{"@gid":"3","@x":"385","@y":"385","@width":"35","@height":"35"},{"@gid":"3","@x":"420","@y":"385","@width":"35","@height":"35"},{"@gid":"3","@x":"455","@y":"385","@width":"35","@height":"35"},{"@gid":"7","@x":"490","@y":"420","@width":"35","@height":"35"},{"@gid":"8","@x":"105","@y":"210","@width":"35","@height":"35"},{"@gid":"16","@x":"105","@y":"245","@width":"35","@height":"35"},{"@gid":"3","@x":"70","@y":"245","@width":"35","@height":"35"},{"@gid":"3","@x":"0","@y":"245","@width":"35","@height":"35"},{"@gid":"3","@x":"35","@y":"245","@width":"35","@height":"35"},{"@gid":"6","@x":"350","@y":"245","@width":"35","@height":"35"},{"@gid":"12","@x":"350","@y":"280","@width":"35","@height":"35"},{"@gid":"11","@x":"350","@y":"210","@width":"35","@height":"35"},{"@gid":"15","@x":"105","@y":"385","@width":"35","@height":"35"},{"@gid":"8","@x":"70","@y":"350","@width":"35","@height":"35"},{"@gid":"10","@x":"105","@y":"350","@width":"35","@height":"35"},{"@gid":"9","@x":"420","@y":"210","@width":"35","@height":"35"},{"@gid":"13","@x":"455","@y":"245","@width":"35","@height":"35"},{"@gid":"11","@x":"420","@y":"245","@width":"35","@height":"35"}]},{"@name":"active",object:[{"@type":"3","@gid":"19","@x":"385","@y":"215","@width":"20","@height":"70","@rotation":"90"},{"@type":"2","@gid":"21","@x":"631","@y":"369","@width":"70","@height":"19",properties:{property:[{"@name":"distanceX","@value":"0"},{"@name":"distanceY","@value":"100"},{"@name":"speedX","@value":"0"},{"@name":"speedY","@value":"45"}]}},{"@gid":"19","@x":"385","@y":"371","@width":"20","@height":"70","@rotation":"-90"},{"@gid":"17","@x":"322","@y":"491","@width":"24","@height":"11"},{"@type":"2","@gid":"17","@x":"39","@y":"456","@width":"24","@height":"11"},{"@type":"5","@gid":"17","@x":"539","@y":"491","@width":"24","@height":"11"},{"@type":"4","@gid":"21","@x":"490","@y":"229.5","@width":"70","@height":"19",properties:{property:[{"@name":"distanceY","@value":"120"},{"@name":"speedY","@value":"45"}]}},{"@type":"5","@gid":"19","@x":"358","@y":"490","@width":"20","@height":"70"},{"@type":"6","@gid":"20","@x":"518","@y":"420","@width":"20","@height":"70","@rotation":"180"},{"@gid":"27","@x":"598","@y":"168","@width":"31","@height":"34"},{"@gid":"27","@x":"649","@y":"443","@width":"31","@height":"34"},{"@gid":"27","@x":"115","@y":"456","@width":"31","@height":"34"},{"@type":"3","@gid":"17","@x":"427","@y":"175.5","@width":"24","@height":"11"},{"@gid":"30","@x":"140","@y":"352","@width":"60","@height":"56"},{"@type":"4","@gid":"17","@x":"94","@y":"315","@width":"24","@height":"11"},{"@gid":"32","@x":"315","@y":"245","@width":"35","@height":"35"},{"@gid":"32","@x":"315","@y":"350","@width":"35","@height":"35"},{"@gid":"30","@x":"385","@y":"490","@width":"60","@height":"56",properties:{property:[{"@name":"distance","@value":"100"},{"@name":"distanceX","@value":"50"}]}},{"@gid":"74","@x":"245","@y":"455","@width":"33","@height":"29"}]},{"@name":"characters",object:[{"@gid":"24","@x":"35","@y":"210","@width":"44","@height":"52"},{"@gid":"28","@x":"490","@y":"210","@width":"63","@height":"50"}]},{"@name":"physics",object:[{"@x":"0","@y":"385","@width":"35","@height":"140"},{"@x":"35","@y":"455","@width":"35","@height":"70"},{"@x":"70","@y":"490","@width":"630","@height":"35"},{"@x":"595","@y":"455","@width":"35","@height":"35"},{"@x":"175","@y":"385","@width":"35","@height":"105"},{"@x":"70","@y":"350","@width":"245","@height":"35"},{"@x":"70","@y":"315","@width":"70","@height":"35"},{"@x":"280","@y":"280","@width":"35","@height":"70"},{"@x":"280","@y":"245","@width":"105","@height":"35"},{"@x":"385","@y":"350","@width":"245","@height":"35"},{"@x":"490","@y":"385","@width":"35","@height":"35"},{"@x":"385","@y":"175","@width":"105","@height":"105"},{"@x":"0","@y":"210","@width":"140","@height":"35"},{"@x":"105","@y":"175","@width":"210","@height":"35"},{"@x":"0","@y":"70","@width":"140","@height":"35"},{"@x":"105","@y":"35","@width":"455","@height":"35"},{"@x":"525","@y":"70","@width":"175","@height":"35"},{"@x":"665","@y":"105","@width":"35","@height":"105"},{"@x":"560","@y":"210","@width":"140","@height":"35"},{"@x":"350","@y":"70","@width":"35","@height":"350"}]}]},{"@level":"8","@version":"1.0","@orientation":"orthogonal","@renderorder":"right-down","@width":"20","@height":"15","@tilewidth":"35","@tileheight":"35",tileset:[{"@firstgid":"1","@name":"tiles","@tilewidth":"35","@tileheight":"35",tile:[{"@id":"0",image:{"@width":"35","@height":"35","@source":"tiles/singleTile.png"}},{"@id":"1",image:{"@width":"35","@height":"35","@source":"tiles/platformLeft.png"}},{"@id":"2",image:{"@width":"35","@height":"35","@source":"tiles/platformCenter.png"}},{"@id":"3",image:{"@width":"35","@height":"35","@source":"tiles/platformRight.png"}},{"@id":"4",image:{"@width":"35","@height":"35","@source":"tiles/verticalPlatformTop.png"}},{"@id":"5",image:{"@width":"35","@height":"35","@source":"tiles/verticalPlatformCenter.png"}},{"@id":"6",image:{"@width":"35","@height":"35","@source":"tiles/verticalPlatformBottom.png"}},{"@id":"7",image:{"@width":"35","@height":"35","@source":"tiles/tileTopLeft.png"}},{"@id":"8",image:{"@width":"35","@height":"35","@source":"tiles/tileTopCenter.png"}},{"@id":"9",image:{"@width":"35","@height":"35","@source":"tiles/tileTopRight.png"}},{"@id":"10",image:{"@width":"35","@height":"35","@source":"tiles/tileCenterLeft.png"}},{"@id":"11",image:{"@width":"35","@height":"35","@source":"tiles/tileCenter.png"}},{"@id":"12",image:{"@width":"35","@height":"35","@source":"tiles/tileCenterRight.png"}},{"@id":"13",image:{"@width":"35","@height":"35","@source":"tiles/tileBottomLeft.png"}},{"@id":"14",image:{"@width":"35","@height":"35","@source":"tiles/tileBottomCenter.png"}},{"@id":"15",image:{"@width":"35","@height":"35","@source":"tiles/tileBottomRight.png"}}]},{"@firstgid":"17","@name":"active","@tilewidth":"105","@tileheight":"70",tile:[{"@id":"0",image:{"@width":"24","@height":"11","@source":"active/PushButtonGraphics.png"}},{"@id":"1",image:{"@width":"25","@height":"19","@source":"active/TriggerGraphics.png"}},{"@id":"2",image:{"@width":"20","@height":"70","@source":"active/DoorGraphics.png"}},{"@id":"3",image:{"@width":"20","@height":"70","@source":"active/GlassDoorGraphics.png"}},{"@id":"4",image:{"@width":"70","@height":"19","@source":"active/ElevatorGraphics.png"}},{"@id":"5",image:{"@width":"105","@height":"20","@source":"active/BigElevatorGraphics.png"}},{"@id":"6",image:{"@width":"70","@height":"70","@source":"active/ExitGraphics.png"}},{"@id":"7",image:{"@width":"44","@height":"52","@source":"characters/HustlerGraphics.png"}},{"@id":"8",image:{"@width":"32","@height":"22","@source":"active/CameraGraphics.png"}},{"@id":"9",image:{"@width":"15","@height":"15","@source":"characters/EnemyLimiterGraphics.png"}},{"@id":"10",image:{"@width":"31","@height":"34","@source":"passive/MoneyBagGraphics.png"}},{"@id":"11",image:{"@width":"63","@height":"50","@source":"characters/DogGraphics.png"}},{"@id":"12",image:{"@width":"60","@height":"55","@source":"characters/Prisoner2Graphics.png"}},{"@id":"13",image:{"@width":"60","@height":"56","@source":"characters/PrisonerGraphics.png"}},{"@id":"14",image:{"@width":"50","@height":"29","@source":"active/TurrelGraphics.png"}}]},{"@firstgid":"32","@name":"passive","@tilewidth":"210","@tileheight":"50",tile:[{"@id":"0",image:{"@width":"50","@height":"50","@source":"passive/BigBoxGraphics.png"}},{"@id":"1",image:{"@width":"35","@height":"35","@source":"passive/BoxGraphics.png"}},{"@id":"2",image:{"@width":"37","@height":"35","@source":"passive/ToiletGraphics.png"}},{"@id":"3",image:{"@width":"35","@height":"35","@source":"passive/MonitorGraphics.png"}},{"@id":"4",image:{"@width":"35","@height":"35","@source":"passive/BasketBallGraphics.png"}},{"@id":"5",image:{"@width":"35","@height":"35","@source":"passive/StoolGraphics.png"}},{"@id":"6",image:{"@width":"150","@height":"20","@source":"passive/PlankGraphics.png"}},{"@id":"7",image:{"@width":"150","@height":"20","@source":"passive/Plank2Graphics.png"}},{"@id":"8",image:{"@width":"210","@height":"20","@source":"passive/BigPlankGraphics.png"}},{"@id":"9",image:{"@width":"100","@height":"20","@source":"passive/Plank5Graphics.png"}},{"@id":"10",image:{"@width":"150","@height":"20","@source":"passive/Plank2Graphics.png"}},{"@id":"11",image:{"@width":"35","@height":"35","@source":"passive/MirrorGraphics.png"}}]},{"@firstgid":"44","@name":"decor","@tilewidth":"232","@tileheight":"136",tile:[{"@id":"0",image:{"@width":"232","@height":"79","@source":"decor/LevelTextGraphics.png"}},{"@id":"1",image:{"@width":"54","@height":"20","@source":"decor/Decor1Graphics.png"}},{"@id":"2",image:{"@width":"54","@height":"20","@source":"decor/Decor2Graphics.png"}},{"@id":"3",image:{"@width":"33","@height":"27","@source":"decor/Decor3Graphics.png"}},{"@id":"4",image:{"@width":"34","@height":"25","@source":"decor/Decor4Graphics.png"}},{"@id":"5",image:{"@width":"22","@height":"31","@source":"decor/Decor5Graphics.png"}},{"@id":"6",image:{"@width":"126","@height":"59","@source":"decor/Decor6Graphics.png"}},{"@id":"7",image:{"@width":"25","@height":"21","@source":"decor/Decor8Graphics.png"}},{"@id":"8",image:{"@width":"18","@height":"22","@source":"decor/Decor9Graphics.png"}},{"@id":"9",image:{"@width":"35","@height":"58","@source":"decor/Decor10Graphics.png"}},{"@id":"10",image:{"@width":"19","@height":"66","@source":"decor/Decor11Graphics.png"}},{"@id":"11",image:{"@width":"23","@height":"33","@source":"decor/Decor12Graphics.png"}},{"@id":"12",image:{"@width":"38","@height":"26","@source":"decor/Decor13Graphics.png"}},{"@id":"13",image:{"@width":"43","@height":"78","@source":"decor/Decor14Graphics.png"}},{"@id":"14",image:{"@width":"60","@height":"86","@source":"decor/Decor15Graphics.png"}},{"@id":"15",image:{"@width":"41","@height":"69","@source":"decor/Decor16Graphics.png"}},{"@id":"16",image:{"@width":"55","@height":"58","@source":"decor/Decor17Graphics.png"}},{"@id":"17",image:{"@width":"57","@height":"54","@source":"decor/Decor18Graphics.png"}},{"@id":"18",image:{"@width":"18","@height":"45","@source":"decor/Decor19Graphics.png"}},{"@id":"19",image:{"@width":"41","@height":"49","@source":"decor/Decor20Graphics.png"}},{"@id":"20",image:{"@width":"51","@height":"38","@source":"decor/Decor21Graphics.png"}},{"@id":"21",image:{"@width":"54","@height":"54","@source":"decor/Decor22Graphics.png"}},{"@id":"22",image:{"@width":"63","@height":"136","@source":"decor/Decor23Graphics.png"}},{"@id":"23",image:{"@width":"21","@height":"39","@source":"decor/Decor24Graphics.png"}},{"@id":"24",image:{"@width":"104","@height":"50","@source":"decor/Decor25Graphics.png"}},{"@id":"25",image:{"@width":"104","@height":"46","@source":"decor/Decor26Graphics.png"}},{"@id":"26",image:{"@width":"86","@height":"38","@source":"decor/Decor27Graphics.png"}},{"@id":"27",image:{"@width":"63","@height":"55","@source":"decor/Decor28Graphics.png"}},{"@id":"28",image:{"@width":"13","@height":"23","@source":"decor/Decor29Graphics.png"}},{"@id":"29",image:{"@width":"28","@height":"40","@source":"decor/Decor30Graphics.png"}},{"@id":"30",image:{"@width":"69","@height":"30","@source":"decor/Decor31Graphics.png"}},{"@id":"31",image:{"@width":"33","@height":"29","@source":"decor/Decor32Graphics.png"}},{"@id":"32",image:{"@width":"42","@height":"42","@source":"decor/Decor33Graphics.png"}},{"@id":"33",image:{"@width":"60","@height":"66","@source":"decor/Decor34Graphics.png"}},{"@id":"34",image:{"@width":"46","@height":"65","@source":"decor/Decor35Graphics.png"}},{"@id":"35",image:{"@width":"71","@height":"55","@source":"decor/Decor36Graphics.png"}},{"@id":"36",image:{"@width":"35","@height":"55","@source":"decor/Decor37Graphics.png"}},{"@id":"37",image:{"@width":"28","@height":"29","@source":"decor/Decor38Graphics.png"}},{"@id":"38",image:{"@width":"38","@height":"37","@source":"decor/Decor39Graphics.png"}},{"@id":"39",image:{"@width":"103","@height":"50","@source":"decor/Decor40Graphics.png"}},{"@id":"40",image:{"@width":"56","@height":"55","@source":"decor/Decor41Graphics.png"}},{"@id":"41",image:{"@width":"71","@height":"50","@source":"decor/Decor42Graphics.png"}},{"@id":"42",image:{"@width":"232","@height":"79","@source":"decor/LevelTextGraphics.png"}},{"@id":"43",image:{"@width":"97","@height":"69","@source":"decor/Tip1Graphics.png"}},{"@id":"44",image:{"@width":"97","@height":"69","@source":"decor/Tip2Graphics.png"}},{"@id":"45",image:{"@width":"97","@height":"69","@source":"decor/Tip3Graphics.png"}},{"@id":"46",image:{"@width":"97","@height":"69","@source":"decor/Tip4Graphics.png"}},{"@id":"47",image:{"@width":"78","@height":"96","@source":"decor/Tip5Graphics.png"}},{"@id":"48",image:{"@width":"78","@height":"96","@source":"decor/Tip6Graphics.png"}},{"@id":"49",image:{"@width":"97","@height":"69","@source":"decor/Tip7Graphics.png"}},{"@id":"50",image:{"@width":"200","@height":"44","@source":"decor/TxtGraphics.png"}}]}],imagelayer:{"@name":"background",image:{"@source":"bg/Background1Graphics.png"}},objectgroup:[{"@name":"decorations",object:[{"@gid":"44","@x":"-448","@y":"8","@width":"232","@height":"79",properties:{property:{"@name":"text","@value":"level_text_8"}}},{"@gid":"50","@x":"490","@y":"140","@width":"126","@height":"59"},{"@gid":"70","@x":"490","@y":"490","@width":"86","@height":"38"},{"@gid":"82","@x":"490","@y":"420","@width":"38","@height":"37"}]},{"@name":"tiles",object:[{"@gid":"12","@x":"140","@y":"525","@width":"35","@height":"35"},{"@gid":"9","@x":"560","@y":"525","@width":"35","@height":"35"},{"@gid":"9","@x":"525","@y":"525","@width":"35","@height":"35"},{"@gid":"9","@x":"490","@y":"525","@width":"35","@height":"35"},{"@gid":"9","@x":"455","@y":"525","@width":"35","@height":"35"},{"@gid":"9","@x":"420","@y":"525","@width":"35","@height":"35"},{"@gid":"9","@x":"385","@y":"525","@width":"35","@height":"35"},{"@gid":"9","@x":"350","@y":"525","@width":"35","@height":"35"},{"@gid":"9","@x":"315","@y":"525","@width":"35","@height":"35"},{"@gid":"9","@x":"280","@y":"525","@width":"35","@height":"35"},{"@gid":"9","@x":"245","@y":"525","@width":"35","@height":"35"},{"@gid":"9","@x":"210","@y":"525","@width":"35","@height":"35"},{"@gid":"9","@x":"175","@y":"525","@width":"35","@height":"35"},{"@gid":"9","@x":"175","@y":"175","@width":"35","@height":"35"},{"@gid":"9","@x":"210","@y":"175","@width":"35","@height":"35"},{"@gid":"9","@x":"245","@y":"175","@width":"35","@height":"35"},{"@gid":"9","@x":"280","@y":"175","@width":"35","@height":"35"},{"@gid":"10","@x":"70","@y":"350","@width":"35","@height":"35"},{"@gid":"10","@x":"525","@y":"280","@width":"35","@height":"35"},{"@gid":"8","@x":"665","@y":"175","@width":"35","@height":"35"},{"@gid":"8","@x":"140","@y":"70","@width":"35","@height":"35"},{"@gid":"8","@x":"490","@y":"280","@width":"35","@height":"35"},{"@gid":"2","@x":"350","@y":"455","@width":"35","@height":"35"},{"@gid":"2","@x":"630","@y":"210","@width":"35","@height":"35"},{"@gid":"2","@x":"70","@y":"245","@width":"35","@height":"35"},{"@gid":"4","@x":"420","@y":"455","@width":"35","@height":"35"},{"@gid":"4","@x":"385","@y":"175","@width":"35","@height":"35"},{"@gid":"3","@x":"315","@y":"315","@width":"35","@height":"35"},{"@gid":"3","@x":"350","@y":"315","@width":"35","@height":"35"},{"@gid":"3","@x":"385","@y":"315","@width":"35","@height":"35"},{"@gid":"3","@x":"420","@y":"315","@width":"35","@height":"35"},{"@gid":"3","@x":"455","@y":"315","@width":"35","@height":"35"},{"@gid":"3","@x":"350","@y":"175","@width":"35","@height":"35"},{"@gid":"3","@x":"315","@y":"175","@width":"35","@height":"35"},{"@gid":"3","@x":"175","@y":"70","@width":"35","@height":"35"},{"@gid":"3","@x":"210","@y":"70","@width":"35","@height":"35"},{"@gid":"3","@x":"245","@y":"70","@width":"35","@height":"35"},{"@gid":"3","@x":"280","@y":"70","@width":"35","@height":"35"},{"@gid":"3","@x":"315","@y":"70","@width":"35","@height":"35"},{"@gid":"3","@x":"350","@y":"70","@width":"35","@height":"35"},{"@gid":"16","@x":"385","@y":"70","@width":"35","@height":"35"},{"@gid":"16","@x":"280","@y":"385","@width":"35","@height":"35"},{"@gid":"16","@x":"140","@y":"245","@width":"35","@height":"35"},{"@gid":"3","@x":"105","@y":"385","@width":"35","@height":"35"},{"@gid":"3","@x":"105","@y":"245","@width":"35","@height":"35"},{"@gid":"3","@x":"105","@y":"105","@width":"35","@height":"35"},{"@gid":"3","@x":"70","@y":"105","@width":"35","@height":"35"},{"@gid":"3","@x":"35","@y":"105","@width":"35","@height":"35"},{"@gid":"3","@x":"0","@y":"105","@width":"35","@height":"35"},{"@gid":"3","@x":"560","@y":"315","@width":"35","@height":"35"},{"@gid":"15","@x":"525","@y":"315","@width":"35","@height":"35"},{"@gid":"15","@x":"490","@y":"315","@width":"35","@height":"35"},{"@gid":"15","@x":"35","@y":"385","@width":"35","@height":"35"},{"@gid":"15","@x":"210","@y":"210","@width":"35","@height":"35"},{"@gid":"15","@x":"175","@y":"210","@width":"35","@height":"35"},{"@gid":"14","@x":"245","@y":"385","@width":"35","@height":"35"},{"@gid":"15","@x":"665","@y":"210","@width":"35","@height":"35"},{"@gid":"6","@x":"385","@y":"35","@width":"35","@height":"35"},{"@gid":"6","@x":"140","@y":"140","@width":"35","@height":"35"},{"@gid":"11","@x":"140","@y":"210","@width":"35","@height":"35"},{"@gid":"11","@x":"140","@y":"175","@width":"35","@height":"35"},{"@gid":"13","@x":"140","@y":"105","@width":"35","@height":"35"},{"@gid":"13","@x":"280","@y":"350","@width":"35","@height":"35"},{"@gid":"3","@x":"385","@y":"455","@width":"35","@height":"35"},{"@gid":"63","@x":"385","@y":"420","@width":"41","@height":"49"},{"@gid":"74","@x":"175","@y":"105","@width":"69","@height":"30"},{"@gid":"68","@x":"245","@y":"140","@width":"104","@height":"50"},{"@gid":"44","@x":"407","@y":"243","@width":"232","@height":"79",properties:{property:{"@name":"text","@value":"level_text_9"}}},{"@gid":"4","@x":"140","@y":"385"},{"@gid":"10","@x":"140","@y":"490"},{"@gid":"12","@x":"105","@y":"525","@width":"35","@height":"35"},{"@gid":"12","@x":"70","@y":"525","@width":"35","@height":"35"},{"@gid":"12","@x":"35","@y":"525","@width":"35","@height":"35"},{"@gid":"12","@x":"0","@y":"525","@width":"35","@height":"35"},{"@gid":"9","@x":"105","@y":"490"},{"@gid":"9","@x":"70","@y":"490"},{"@gid":"9","@x":"35","@y":"490"},{"@gid":"12","@x":"0","@y":"490"},{"@gid":"12","@x":"0","@y":"385"},{"@gid":"13","@x":"0","@y":"455"},{"@gid":"13","@x":"0","@y":"420"},{"@gid":"10","@x":"0","@y":"315","@width":"35","@height":"35"},{"@gid":"12","@x":"0","@y":"350"},{"@gid":"15","@x":"70","@y":"385","@width":"35","@height":"35"},{"@gid":"3","@x":"595","@y":"315","@width":"35","@height":"35"},{"@gid":"9","@x":"35","@y":"350"},{"@gid":"9","@x":"595","@y":"525","@width":"35","@height":"35"},{"@gid":"13","@x":"280","@y":"210"},{"@gid":"12","@x":"245","@y":"210"},{"@gid":"11","@x":"245","@y":"245"},{"@gid":"11","@x":"245","@y":"280"},{"@gid":"11","@x":"245","@y":"315"},{"@gid":"11","@x":"245","@y":"350"},{"@gid":"13","@x":"280","@y":"245"},{"@gid":"13","@x":"280","@y":"280"},{"@gid":"12","@x":"280","@y":"315"},{"@gid":"12","@x":"630","@y":"525"},{"@gid":"12","@x":"665","@y":"525"},{"@gid":"8","@x":"630","@y":"490"},{"@gid":"9","@x":"665","@y":"490"},{"@gid":"7","@x":"630","@y":"350"},{"@gid":"10","@x":"630","@y":"315"}]},{"@name":"active",object:[{"@gid":"30","@x":"497","@y":"491","@width":"60","@height":"56"},{"@gid":"30","@x":"271","@y":"142","@width":"60","@height":"56",properties:{property:[{"@name":"distance","@value":"100"},{"@name":"distanceX","@value":"50"}]}},{"@gid":"19","@x":"665","@y":"210","@width":"20","@height":"70","@rotation":"180"},{"@gid":"17","@x":"385","@y":"420","@width":"24","@height":"11"},{"@type":"5","@gid":"17","@x":"109","@y":"211","@width":"24","@height":"11"},{"@gid":"32","@x":"192","@y":"280","@width":"50","@height":"50"},{"@gid":"27","@x":"385","@y":"366","@width":"31","@height":"34"},{"@gid":"27","@x":"534","@y":"95","@width":"31","@height":"34"},{"@gid":"27","@x":"22","@y":"159","@width":"31","@height":"34"},{"@gid":"31","@x":"649","@y":"141","@width":"50","@height":"29"},{"@type":"5","@gid":"19","@x":"399","@y":"140","@width":"20","@height":"70"},{"@gid":"26","@x":"395","@y":"114","@width":"15","@height":"15"},{"@type":"3","@gid":"19","@x":"96","@y":"245","@width":"20","@height":"70","@rotation":"180"},{"@type":"6","@gid":"19","@x":"245","@y":"302","@width":"20","@height":"70","@rotation":"270"},{"@type":"3","@gid":"17","@x":"665","@y":"455","@width":"24","@height":"11"},{"@type":"6","@gid":"18","@x":"333","@y":"280"}]},{"@name":"characters",object:[{"@gid":"24","@x":"385","@y":"280","@width":"44","@height":"52",properties:{property:[{"@name":"distanceY","@value":"300"},{"@name":"speedY","@value":"45"}]}},{"@gid":"28","@x":"35","@y":"455","@width":"63","@height":"50"}]},{"@name":"physics",object:[{"@x":"0","@y":"70","@width":"140","@height":"35"},{"@x":"140","@y":"70","@width":"35","@height":"175"},{"@x":"70","@y":"210","@width":"70","@height":"35"},{"@x":"665","@y":"140","@width":"35","@height":"35"},{"@x":"630","@y":"175","@width":"70","@height":"35"},{"@x":"490","@y":"245","@width":"70","@height":"35"},{"@x":"315","@y":"280","@width":"350","@height":"35"},{"@x":"245","@y":"210","@width":"70","@height":"175"},{"@x":"350","@y":"420","@width":"105","@height":"35"},{"@x":"630","@y":"455","@width":"70","@height":"35"},{"@x":"0","@y":"490","@width":"700","@height":"35"},{"@x":"0","@y":"385","@width":"35","@height":"105"},{"@x":"0","@y":"350","@width":"175","@height":"35"},{"@x":"0","@y":"315","@width":"105","@height":"35"},{"@x":"35","@y":"455","@width":"140","@height":"35"},{"@x":"175","@y":"140","@width":"245","@height":"35"},{"@x":"175","@y":"175","@width":"140","@height":"35"},{"@x":"0","@y":"0","@width":"420","@height":"70"},{"@x":"0","@y":"280","@width":"35","@height":"35"},{"@x":"630","@y":"315","@width":"35","@height":"35"}]}]},{"@level":"9","@version":"1.0","@orientation":"orthogonal","@renderorder":"right-down","@width":"20","@height":"15","@tilewidth":"35","@tileheight":"35",tileset:[{"@firstgid":"1","@name":"tiles","@tilewidth":"35","@tileheight":"35",tile:[{"@id":"0",image:{"@width":"35","@height":"35","@source":"tiles/singleTile.png"}},{"@id":"1",image:{"@width":"35","@height":"35","@source":"tiles/platformLeft.png"}},{"@id":"2",image:{"@width":"35","@height":"35","@source":"tiles/platformCenter.png"}},{"@id":"3",image:{"@width":"35","@height":"35","@source":"tiles/platformRight.png"}},{"@id":"4",image:{"@width":"35","@height":"35","@source":"tiles/verticalPlatformTop.png"}},{"@id":"5",image:{"@width":"35","@height":"35","@source":"tiles/verticalPlatformCenter.png"}},{"@id":"6",image:{"@width":"35","@height":"35","@source":"tiles/verticalPlatformBottom.png"}},{"@id":"7",image:{"@width":"35","@height":"35","@source":"tiles/tileTopLeft.png"}},{"@id":"8",image:{"@width":"35","@height":"35","@source":"tiles/tileTopCenter.png"}},{"@id":"9",image:{"@width":"35","@height":"35","@source":"tiles/tileTopRight.png"}},{"@id":"10",image:{"@width":"35","@height":"35","@source":"tiles/tileCenterLeft.png"}},{"@id":"11",image:{"@width":"35","@height":"35","@source":"tiles/tileCenter.png"}},{"@id":"12",image:{"@width":"35","@height":"35","@source":"tiles/tileCenterRight.png"}},{"@id":"13",image:{"@width":"35","@height":"35","@source":"tiles/tileBottomLeft.png"}},{"@id":"14",image:{"@width":"35","@height":"35","@source":"tiles/tileBottomCenter.png"}},{"@id":"15",image:{"@width":"35","@height":"35","@source":"tiles/tileBottomRight.png"}}]},{"@firstgid":"17","@name":"active","@tilewidth":"105","@tileheight":"70",tile:[{"@id":"0",image:{"@width":"24","@height":"11","@source":"active/PushButtonGraphics.png"}},{"@id":"1",image:{"@width":"25","@height":"19","@source":"active/TriggerGraphics.png"}},{"@id":"2",image:{"@width":"20","@height":"70","@source":"active/DoorGraphics.png"}},{"@id":"3",image:{"@width":"20","@height":"70","@source":"active/GlassDoorGraphics.png"}},{"@id":"4",image:{"@width":"70","@height":"19","@source":"active/ElevatorGraphics.png"}},{"@id":"5",image:{"@width":"105","@height":"20","@source":"active/BigElevatorGraphics.png"}},{"@id":"6",image:{"@width":"70","@height":"70","@source":"active/ExitGraphics.png"}},{"@id":"7",image:{"@width":"44","@height":"52","@source":"characters/HustlerGraphics.png"}},{"@id":"8",image:{"@width":"32","@height":"22","@source":"active/CameraGraphics.png"}},{"@id":"9",image:{"@width":"15","@height":"15","@source":"characters/EnemyLimiterGraphics.png"}},{"@id":"10",image:{"@width":"31","@height":"34","@source":"passive/MoneyBagGraphics.png"}},{"@id":"11",image:{"@width":"63","@height":"50","@source":"characters/DogGraphics.png"}},{"@id":"12",image:{"@width":"60","@height":"55","@source":"characters/Prisoner2Graphics.png"}},{"@id":"13",image:{"@width":"60","@height":"56","@source":"characters/PrisonerGraphics.png"}}]},{"@firstgid":"31","@name":"passive","@tilewidth":"210","@tileheight":"50",tile:[{"@id":"0",image:{"@width":"50","@height":"50","@source":"passive/BigBoxGraphics.png"}},{"@id":"1",image:{"@width":"35","@height":"35","@source":"passive/BoxGraphics.png"}},{"@id":"2",image:{"@width":"37","@height":"35","@source":"passive/ToiletGraphics.png"}},{"@id":"3",image:{"@width":"35","@height":"35","@source":"passive/MonitorGraphics.png"}},{"@id":"4",image:{"@width":"35","@height":"35","@source":"passive/BasketBallGraphics.png"}},{"@id":"5",image:{"@width":"35","@height":"35","@source":"passive/StoolGraphics.png"}},{"@id":"6",image:{"@width":"150","@height":"20","@source":"passive/PlankGraphics.png"}},{"@id":"7",image:{"@width":"150","@height":"20","@source":"passive/Plank2Graphics.png"}},{"@id":"8",image:{"@width":"210","@height":"20","@source":"passive/BigPlankGraphics.png"}},{"@id":"9",image:{"@width":"100","@height":"20","@source":"passive/Plank5Graphics.png"}},{"@id":"10",image:{"@width":"150","@height":"20","@source":"passive/Plank2Graphics.png"}},{"@id":"11",image:{"@width":"35","@height":"35","@source":"passive/MirrorGraphics.png"}}]},{"@firstgid":"43","@name":"decor","@tilewidth":"232","@tileheight":"136",tile:[{"@id":"0",image:{"@width":"232","@height":"79","@source":"decor/LevelTextGraphics.png"}},{"@id":"1",image:{"@width":"54","@height":"20","@source":"decor/Decor1Graphics.png"}},{"@id":"2",image:{"@width":"54","@height":"20","@source":"decor/Decor2Graphics.png"}},{"@id":"3",image:{"@width":"33","@height":"27","@source":"decor/Decor3Graphics.png"}},{"@id":"4",image:{"@width":"34","@height":"25","@source":"decor/Decor4Graphics.png"}},{"@id":"5",image:{"@width":"22","@height":"31","@source":"decor/Decor5Graphics.png"}},{"@id":"6",image:{"@width":"126","@height":"59","@source":"decor/Decor6Graphics.png"}},{"@id":"7",image:{"@width":"25","@height":"21","@source":"decor/Decor8Graphics.png"}},{"@id":"8",image:{"@width":"18","@height":"22","@source":"decor/Decor9Graphics.png"}},{"@id":"9",image:{"@width":"35","@height":"58","@source":"decor/Decor10Graphics.png"}},{"@id":"10",image:{"@width":"19","@height":"66","@source":"decor/Decor11Graphics.png"}},{"@id":"11",image:{"@width":"23","@height":"33","@source":"decor/Decor12Graphics.png"}},{"@id":"12",image:{"@width":"38","@height":"26","@source":"decor/Decor13Graphics.png"}},{"@id":"13",image:{"@width":"43","@height":"78","@source":"decor/Decor14Graphics.png"}},{"@id":"14",image:{"@width":"60","@height":"86","@source":"decor/Decor15Graphics.png"}},{"@id":"15",image:{"@width":"41","@height":"69","@source":"decor/Decor16Graphics.png"}},{"@id":"16",image:{"@width":"55","@height":"58","@source":"decor/Decor17Graphics.png"}},{"@id":"17",image:{"@width":"57","@height":"54","@source":"decor/Decor18Graphics.png"}},{"@id":"18",image:{"@width":"18","@height":"45","@source":"decor/Decor19Graphics.png"}},{"@id":"19",image:{"@width":"41","@height":"49","@source":"decor/Decor20Graphics.png"}},{"@id":"20",image:{"@width":"51","@height":"38","@source":"decor/Decor21Graphics.png"}},{"@id":"21",image:{"@width":"54","@height":"54","@source":"decor/Decor22Graphics.png"}},{"@id":"22",image:{"@width":"63","@height":"136","@source":"decor/Decor23Graphics.png"}},{"@id":"23",image:{"@width":"21","@height":"39","@source":"decor/Decor24Graphics.png"}},{"@id":"24",image:{"@width":"104","@height":"50","@source":"decor/Decor25Graphics.png"}},{"@id":"25",image:{"@width":"104","@height":"46","@source":"decor/Decor26Graphics.png"}},{"@id":"26",image:{"@width":"86","@height":"38","@source":"decor/Decor27Graphics.png"}},{"@id":"27",image:{"@width":"63","@height":"55","@source":"decor/Decor28Graphics.png"}},{"@id":"28",image:{"@width":"13","@height":"23","@source":"decor/Decor29Graphics.png"}},{"@id":"29",image:{"@width":"28","@height":"40","@source":"decor/Decor30Graphics.png"}},{"@id":"30",image:{"@width":"69","@height":"30","@source":"decor/Decor31Graphics.png"}},{"@id":"31",image:{"@width":"33","@height":"29","@source":"decor/Decor32Graphics.png"}},{"@id":"32",image:{"@width":"42","@height":"42","@source":"decor/Decor33Graphics.png"}},{"@id":"33",image:{"@width":"60","@height":"66","@source":"decor/Decor34Graphics.png"}},{"@id":"34",image:{"@width":"46","@height":"65","@source":"decor/Decor35Graphics.png"}},{"@id":"35",image:{"@width":"71","@height":"55","@source":"decor/Decor36Graphics.png"}},{"@id":"36",image:{"@width":"35","@height":"55","@source":"decor/Decor37Graphics.png"}},{"@id":"37",image:{"@width":"28","@height":"29","@source":"decor/Decor38Graphics.png"}},{"@id":"38",image:{"@width":"38","@height":"37","@source":"decor/Decor39Graphics.png"}},{"@id":"39",image:{"@width":"103","@height":"50","@source":"decor/Decor40Graphics.png"}},{"@id":"40",image:{"@width":"56","@height":"55","@source":"decor/Decor41Graphics.png"}},{"@id":"41",image:{"@width":"71","@height":"50","@source":"decor/Decor42Graphics.png"}},{"@id":"42",image:{"@width":"200","@height":"44","@source":"decor/TxtGraphics.png"}}]}],imagelayer:{"@name":"background",image:{"@source":"bg/Background1Graphics.png"}},objectgroup:[{"@name":"decorations",object:[{"@gid":"44","@x":"420","@y":"372","@width":"54","@height":"20"},{"@gid":"67","@x":"385","@y":"455","@width":"104","@height":"50"},{"@gid":"69","@x":"385","@y":"315","@width":"86","@height":"38"},{"@gid":"75","@x":"420","@y":"280","@width":"42","@height":"42"},{"@gid":"57","@x":"105","@y":"455","@width":"60","@height":"86"},{"@gid":"65","@x":"175","@y":"376","@width":"63","@height":"136"},{"@gid":"54","@x":"127","@y":"268","@width":"23","@height":"33"},{"@gid":"84","@x":"350","@y":"175","@width":"71","@height":"50"},{"@gid":"49","@x":"560","@y":"160","@width":"126","@height":"59"},{"@gid":"50","@x":"140","@y":"105","@width":"25","@height":"21"}]},{"@name":"tiles",properties:{property:{"@name":"physics","@value":"true"}},object:[{"@gid":"12","@x":"245","@y":"525","@width":"35","@height":"35"},{"@gid":"12","@x":"0","@y":"350","@width":"35","@height":"35"},{"@gid":"12","@x":"35","@y":"525","@width":"35","@height":"35"},{"@gid":"12","@x":"630","@y":"490","@width":"35","@height":"35"},{"@gid":"12","@x":"665","@y":"245","@width":"35","@height":"35"},{"@gid":"12","@x":"0","@y":"525","@width":"35","@height":"35"},{"@gid":"12","@x":"665","@y":"420","@width":"35","@height":"35"},{"@gid":"12","@x":"70","@y":"525","@width":"35","@height":"35"},{"@gid":"12","@x":"0","@y":"490","@width":"35","@height":"35"},{"@gid":"12","@x":"140","@y":"525","@width":"35","@height":"35"},{"@gid":"12","@x":"665","@y":"455","@width":"35","@height":"35"},{"@gid":"12","@x":"105","@y":"525","@width":"35","@height":"35"},{"@gid":"12","@x":"665","@y":"490","@width":"35","@height":"35"},{"@gid":"12","@x":"350","@y":"525","@width":"35","@height":"35"},{"@gid":"12","@x":"385","@y":"525","@width":"35","@height":"35"},{"@gid":"12","@x":"525","@y":"525","@width":"35","@height":"35"},{"@gid":"12","@x":"455","@y":"525","@width":"35","@height":"35"},{"@gid":"12","@x":"420","@y":"525","@width":"35","@height":"35"},{"@gid":"12","@x":"490","@y":"525","@width":"35","@height":"35"},{"@gid":"12","@x":"630","@y":"525","@width":"35","@height":"35"},{"@gid":"12","@x":"560","@y":"525","@width":"35","@height":"35"},{"@gid":"12","@x":"595","@y":"525","@width":"35","@height":"35"},{"@gid":"12","@x":"665","@y":"525","@width":"35","@height":"35"},{"@gid":"8","@x":"560","@y":"210","@width":"35","@height":"35"},{"@gid":"8","@x":"525","@y":"315","@width":"35","@height":"35"},{"@gid":"8","@x":"630","@y":"420","@width":"35","@height":"35"},{"@gid":"8","@x":"105","@y":"315","@width":"35","@height":"35"},{"@gid":"8","@x":"105","@y":"175","@width":"35","@height":"35"},{"@gid":"8","@x":"350","@y":"490","@width":"35","@height":"35"},{"@gid":"8","@x":"350","@y":"350","@width":"35","@height":"35"},{"@gid":"8","@x":"455","@y":"140","@width":"35","@height":"35"},{"@gid":"10","@x":"245","@y":"175","@width":"35","@height":"35"},{"@gid":"10","@x":"560","@y":"315","@width":"35","@height":"35"},{"@gid":"10","@x":"140","@y":"490","@width":"35","@height":"35"},{"@gid":"10","@x":"140","@y":"315","@width":"35","@height":"35"},{"@gid":"10","@x":"490","@y":"140","@width":"35","@height":"35"},{"@gid":"10","@x":"0","@y":"175","@width":"35","@height":"35"},{"@gid":"13","@x":"0","@y":"455","@width":"35","@height":"35"},{"@gid":"13","@x":"0","@y":"420","@width":"35","@height":"35"},{"@gid":"13","@x":"0","@y":"385","@width":"35","@height":"35"},{"@gid":"13","@x":"0","@y":"315","@width":"35","@height":"35"},{"@gid":"13","@x":"0","@y":"280","@width":"35","@height":"35"},{"@gid":"13","@x":"0","@y":"245","@width":"35","@height":"35"},{"@gid":"13","@x":"0","@y":"210","@width":"35","@height":"35"},{"@gid":"9","@x":"35","@y":"490","@width":"35","@height":"35"},{"@gid":"9","@x":"70","@y":"490","@width":"35","@height":"35"},{"@gid":"9","@x":"105","@y":"490","@width":"35","@height":"35"},{"@gid":"9","@x":"385","@y":"490","@width":"35","@height":"35"},{"@gid":"9","@x":"420","@y":"490","@width":"35","@height":"35"},{"@gid":"9","@x":"455","@y":"490","@width":"35","@height":"35"},{"@gid":"9","@x":"490","@y":"490","@width":"35","@height":"35"},{"@gid":"9","@x":"525","@y":"490","@width":"35","@height":"35"},{"@gid":"9","@x":"560","@y":"490","@width":"35","@height":"35"},{"@gid":"9","@x":"595","@y":"490","@width":"35","@height":"35"},{"@gid":"9","@x":"595","@y":"210","@width":"35","@height":"35"},{"@gid":"9","@x":"630","@y":"210","@width":"35","@height":"35"},{"@gid":"9","@x":"665","@y":"210","@width":"35","@height":"35"},{"@gid":"14","@x":"560","@y":"245","@width":"35","@height":"35"},{"@gid":"15","@x":"630","@y":"245","@width":"35","@height":"35"},{"@gid":"15","@x":"595","@y":"245","@width":"35","@height":"35"},{"@gid":"15","@x":"105","@y":"350","@width":"35","@height":"35"},{"@gid":"14","@x":"105","@y":"210","@width":"35","@height":"35"},{"@gid":"7","@x":"490","@y":"245","@width":"35","@height":"35"},{"@gid":"7","@x":"350","@y":"245","@width":"35","@height":"35"},{"@gid":"7","@x":"350","@y":"385","@width":"35","@height":"35"},{"@gid":"13","@x":"490","@y":"175","@width":"35","@height":"35"},{"@gid":"13","@x":"490","@y":"210","@width":"35","@height":"35"},{"@gid":"16","@x":"140","@y":"210","@width":"35","@height":"35"},{"@gid":"16","@x":"140","@y":"350","@width":"35","@height":"35"},{"@gid":"3","@x":"35","@y":"350","@width":"35","@height":"35"},{"@gid":"3","@x":"70","@y":"350","@width":"35","@height":"35"},{"@gid":"3","@x":"280","@y":"210","@width":"35","@height":"35"},{"@gid":"3","@x":"315","@y":"210","@width":"35","@height":"35"},{"@gid":"3","@x":"385","@y":"210","@width":"35","@height":"35"},{"@gid":"3","@x":"420","@y":"210","@width":"35","@height":"35"},{"@gid":"3","@x":"210","@y":"175","@width":"35","@height":"35"},{"@gid":"3","@x":"175","@y":"175","@width":"35","@height":"35"},{"@gid":"3","@x":"385","@y":"350","@width":"35","@height":"35"},{"@gid":"3","@x":"420","@y":"350","@width":"35","@height":"35"},{"@gid":"3","@x":"455","@y":"350","@width":"35","@height":"35"},{"@gid":"3","@x":"490","@y":"350","@width":"35","@height":"35"},{"@gid":"15","@x":"525","@y":"350","@width":"35","@height":"35"},{"@gid":"15","@x":"560","@y":"350","@width":"35","@height":"35"},{"@gid":"9","@x":"140","@y":"175","@width":"35","@height":"35"},{"@gid":"9","@x":"350","@y":"210","@width":"35","@height":"35"},{"@gid":"6","@x":"245","@y":"490","@width":"35","@height":"35"},{"@gid":"6","@x":"245","@y":"455","@width":"35","@height":"35"},{"@gid":"6","@x":"245","@y":"420","@width":"35","@height":"35"},{"@gid":"6","@x":"245","@y":"385","@width":"35","@height":"35"},{"@gid":"6","@x":"245","@y":"350","@width":"35","@height":"35"},{"@gid":"6","@x":"245","@y":"315","@width":"35","@height":"35"},{"@gid":"6","@x":"245","@y":"280","@width":"35","@height":"35"},{"@gid":"6","@x":"245","@y":"245","@width":"35","@height":"35"},{"@gid":"11","@x":"245","@y":"210","@width":"35","@height":"35"},{"@gid":"9","@x":"175","@y":"525","@width":"35","@height":"35"},{"@gid":"9","@x":"210","@y":"525","@width":"35","@height":"35"},{"@gid":"9","@x":"315","@y":"525","@width":"35","@height":"35"},{"@gid":"9","@x":"280","@y":"525","@width":"35","@height":"35"},{"@gid":"11","@x":"630","@y":"455","@width":"35","@height":"35"},{"@gid":"11","@x":"665","@y":"280","@width":"35","@height":"35"},{"@gid":"11","@x":"665","@y":"315","@width":"35","@height":"35"},{"@gid":"11","@x":"665","@y":"350","@width":"35","@height":"35"},{"@gid":"11","@x":"665","@y":"385","@width":"35","@height":"35"},{"@gid":"4","@x":"595","@y":"350","@width":"35","@height":"35"},{"@gid":"15","@x":"455","@y":"210","@width":"35","@height":"35"},{"@gid":"11","@x":"455","@y":"175","@width":"35","@height":"35"}]},{"@name":"active",object:[{"@gid":"30","@x":"435","@y":"316","@width":"60","@height":"56"},{"@type":"2","@gid":"21","@x":"280","@y":"474","@width":"70","@height":"19",properties:{property:[{"@name":"distanceY","@value":"140"},{"@name":"speedY","@value":"-45"}]}},{"@type":"3","@gid":"19","@x":"350","@y":"455","@width":"20","@height":"70"},{"@type":"2","@gid":"17","@x":"54","@y":"456","@width":"24","@height":"11"},{"@type":"3","@gid":"18","@x":"567","@y":"280","@width":"25","@height":"19"},{"@gid":"25","@x":"303","@y":"230","@width":"32","@height":"22",properties:{property:[{"@name":"delay","@value":"0"},{"@name":"maxAngle","@value":"90"},{"@name":"minAngle","@value":"90"},{"@name":"speedX","@value":"0"}]}},{"@gid":"20","@x":"351","@y":"315","@width":"20","@height":"70"},{"@type":"2","@gid":"21","@x":"35","@y":"160","@width":"70","@height":"19",properties:{property:[{"@name":"distanceY","@value":"139"},{"@name":"speedY","@value":"45"}]}},{"@type":"5","@gid":"21","@x":"175","@y":"301.5","@width":"70","@height":"19",properties:{property:[{"@name":"distanceY","@value":"174"},{"@name":"speedY","@value":"45"}]}},{"@type":"5","@gid":"17","@x":"56.3333","@y":"316.167","@width":"24","@height":"11"},{"@gid":"27","@x":"618","@y":"107","@width":"31","@height":"34"},{"@gid":"27","@x":"195","@y":"223","@width":"31","@height":"34"},{"@gid":"27","@x":"578","@y":"390","@width":"31","@height":"34"},{"@gid":"42","@x":"298","@y":"456","@width":"35","@height":"35"},{"@gid":"26","@x":"349","@y":"433","@width":"15","@height":"15"},{"@gid":"26","@x":"519","@y":"304","@width":"15","@height":"15"},{"@gid":"29","@x":"490","@y":"455","@width":"60","@height":"55"}]},{"@name":"characters",object:[{"@gid":"24","@x":"104","@y":"456","@width":"44","@height":"52"},{"@gid":"28","@x":"338","@y":"175","@width":"63","@height":"50"}]},{"@name":"physics",object:[{"@x":"105","@y":"140","@width":"175","@height":"35"},{"@x":"105","@y":"175","@width":"70","@height":"35"},{"@x":"245","@y":"175","@width":"210","@height":"35"},{"@x":"455","@y":"105","@width":"70","@height":"105"},{"@x":"490","@y":"210","@width":"35","@height":"35"},{"@x":"560","@y":"175","@width":"140","@height":"70"},{"@x":"665","@y":"245","@width":"35","@height":"140"},{"@x":"350","@y":"455","@width":"280","@height":"70"},{"@x":"630","@y":"385","@width":"70","@height":"140"},{"@x":"350","@y":"315","@width":"280","@height":"35"},{"@x":"525","@y":"280","@width":"70","@height":"35"},{"@x":"350","@y":"350","@width":"35","@height":"35"},{"@x":"245","@y":"210","@width":"35","@height":"280"},{"@x":"0","@y":"490","@width":"350","@height":"35"},{"@x":"0","@y":"455","@width":"175","@height":"35"},{"@x":"0","@y":"140","@width":"35","@height":"315"},{"@x":"35","@y":"315","@width":"70","@height":"35"},{"@x":"105","@y":"280","@width":"70","@height":"70"},{"@x":"350","@y":"210","@width":"35","@height":"35"},{"@gid":"43","@x":"245","@y":"140","@width":"232","@height":"79",properties:{property:{"@name":"text","@value":"level_text_10"}}}]}]},{"@level":"10","@version":"1.0","@orientation":"orthogonal","@renderorder":"right-down","@width":"20","@height":"15","@tilewidth":"35","@tileheight":"35",tileset:[{"@firstgid":"1","@name":"tiles","@tilewidth":"35","@tileheight":"35",tile:[{"@id":"0",image:{"@width":"35","@height":"35","@source":"tiles/singleTile.png"}},{"@id":"1",image:{"@width":"35","@height":"35","@source":"tiles/platformLeft.png"}},{"@id":"2",image:{"@width":"35","@height":"35","@source":"tiles/platformCenter.png"}},{"@id":"3",image:{"@width":"35","@height":"35","@source":"tiles/platformRight.png"}},{"@id":"4",image:{"@width":"35","@height":"35","@source":"tiles/verticalPlatformTop.png"}},{"@id":"5",image:{"@width":"35","@height":"35","@source":"tiles/verticalPlatformCenter.png"}},{"@id":"6",image:{"@width":"35","@height":"35","@source":"tiles/verticalPlatformBottom.png"}},{"@id":"7",image:{"@width":"35","@height":"35","@source":"tiles/tileTopLeft.png"}},{"@id":"8",image:{"@width":"35","@height":"35","@source":"tiles/tileTopCenter.png"}},{"@id":"9",image:{"@width":"35","@height":"35","@source":"tiles/tileTopRight.png"}},{"@id":"10",image:{"@width":"35","@height":"35","@source":"tiles/tileCenterLeft.png"}},{"@id":"11",image:{"@width":"35","@height":"35","@source":"tiles/tileCenter.png"}},{"@id":"12",image:{"@width":"35","@height":"35","@source":"tiles/tileCenterRight.png"}},{"@id":"13",image:{"@width":"35","@height":"35","@source":"tiles/tileBottomLeft.png"}},{"@id":"14",image:{"@width":"35","@height":"35","@source":"tiles/tileBottomCenter.png"}},{"@id":"15",image:{"@width":"35","@height":"35","@source":"tiles/tileBottomRight.png"}}]},{"@firstgid":"17","@name":"active","@tilewidth":"105","@tileheight":"70",tile:[{"@id":"0",image:{"@width":"24","@height":"11","@source":"active/PushButtonGraphics.png"}},{"@id":"1",image:{"@width":"25","@height":"19","@source":"active/TriggerGraphics.png"}},{"@id":"2",image:{"@width":"20","@height":"70","@source":"active/DoorGraphics.png"}},{"@id":"3",image:{"@width":"20","@height":"70","@source":"active/GlassDoorGraphics.png"}},{"@id":"4",image:{"@width":"70","@height":"19","@source":"active/ElevatorGraphics.png"}},{"@id":"5",image:{"@width":"105","@height":"20","@source":"active/BigElevatorGraphics.png"}},{"@id":"6",image:{"@width":"70","@height":"70","@source":"active/ExitGraphics.png"}},{"@id":"7",image:{"@width":"44","@height":"52","@source":"characters/HustlerGraphics.png"}},{"@id":"8",image:{"@width":"32","@height":"22","@source":"active/CameraGraphics.png"}},{"@id":"9",image:{"@width":"15","@height":"15","@source":"characters/EnemyLimiterGraphics.png"}},{"@id":"10",image:{"@width":"31","@height":"34","@source":"passive/MoneyBagGraphics.png"}},{"@id":"11",image:{"@width":"63","@height":"50","@source":"characters/DogGraphics.png"}},{"@id":"12",image:{"@width":"60","@height":"55","@source":"characters/Prisoner2Graphics.png"}},{"@id":"13",image:{"@width":"60","@height":"56","@source":"characters/PrisonerGraphics.png"}}]},{"@firstgid":"31","@name":"passive","@tilewidth":"210","@tileheight":"50",tile:[{"@id":"0",image:{"@width":"50","@height":"50","@source":"passive/BigBoxGraphics.png"}},{"@id":"1",image:{"@width":"35","@height":"35","@source":"passive/BoxGraphics.png"}},{"@id":"2",image:{"@width":"37","@height":"35","@source":"passive/ToiletGraphics.png"}},{"@id":"3",image:{"@width":"35","@height":"35","@source":"passive/MonitorGraphics.png"}},{"@id":"4",image:{"@width":"35","@height":"35","@source":"passive/BasketBallGraphics.png"}},{"@id":"5",image:{"@width":"35","@height":"35","@source":"passive/StoolGraphics.png"}},{"@id":"6",image:{"@width":"150","@height":"20","@source":"passive/PlankGraphics.png"}},{"@id":"7",image:{"@width":"150","@height":"20","@source":"passive/Plank2Graphics.png"}},{"@id":"8",image:{"@width":"210","@height":"20","@source":"passive/BigPlankGraphics.png"}},{"@id":"9",image:{"@width":"100","@height":"20","@source":"passive/Plank5Graphics.png"}},{"@id":"10",image:{"@width":"150","@height":"20","@source":"passive/Plank2Graphics.png"}},{"@id":"11",image:{"@width":"35","@height":"35","@source":"passive/MirrorGraphics.png"}}]},{"@firstgid":"43","@name":"decor","@tilewidth":"232","@tileheight":"136",tile:[{"@id":"0",image:{"@width":"232","@height":"79","@source":"decor/LevelTextGraphics.png"}},{"@id":"1",image:{"@width":"54","@height":"20","@source":"decor/Decor1Graphics.png"}},{"@id":"2",image:{"@width":"54","@height":"20","@source":"decor/Decor2Graphics.png"}},{"@id":"3",image:{"@width":"33","@height":"27","@source":"decor/Decor3Graphics.png"}},{"@id":"4",image:{"@width":"34","@height":"25","@source":"decor/Decor4Graphics.png"}},{"@id":"5",image:{"@width":"22","@height":"31","@source":"decor/Decor5Graphics.png"}},{"@id":"6",image:{"@width":"126","@height":"59","@source":"decor/Decor6Graphics.png"}},{"@id":"7",image:{"@width":"25","@height":"21","@source":"decor/Decor8Graphics.png"}},{"@id":"8",image:{"@width":"18","@height":"22","@source":"decor/Decor9Graphics.png"}},{"@id":"9",image:{"@width":"35","@height":"58","@source":"decor/Decor10Graphics.png"}},{"@id":"10",image:{"@width":"19","@height":"66","@source":"decor/Decor11Graphics.png"}},{"@id":"11",image:{"@width":"23","@height":"33","@source":"decor/Decor12Graphics.png"}},{"@id":"12",image:{"@width":"38","@height":"26","@source":"decor/Decor13Graphics.png"}},{"@id":"13",image:{"@width":"43","@height":"78","@source":"decor/Decor14Graphics.png"}},{"@id":"14",image:{"@width":"60","@height":"86","@source":"decor/Decor15Graphics.png"}},{"@id":"15",image:{"@width":"41","@height":"69","@source":"decor/Decor16Graphics.png"}},{"@id":"16",image:{"@width":"55","@height":"58","@source":"decor/Decor17Graphics.png"}},{"@id":"17",image:{"@width":"57","@height":"54","@source":"decor/Decor18Graphics.png"}},{"@id":"18",image:{"@width":"18","@height":"45","@source":"decor/Decor19Graphics.png"}},{"@id":"19",image:{"@width":"41","@height":"49","@source":"decor/Decor20Graphics.png"}},{"@id":"20",image:{"@width":"51","@height":"38","@source":"decor/Decor21Graphics.png"}},{"@id":"21",image:{"@width":"54","@height":"54","@source":"decor/Decor22Graphics.png"}},{"@id":"22",image:{"@width":"63","@height":"136","@source":"decor/Decor23Graphics.png"}},{"@id":"23",image:{"@width":"21","@height":"39","@source":"decor/Decor24Graphics.png"}},{"@id":"24",image:{"@width":"104","@height":"50","@source":"decor/Decor25Graphics.png"}},{"@id":"25",image:{"@width":"104","@height":"46","@source":"decor/Decor26Graphics.png"}},{"@id":"26",image:{"@width":"86","@height":"38","@source":"decor/Decor27Graphics.png"}},{"@id":"27",image:{"@width":"63","@height":"55","@source":"decor/Decor28Graphics.png"}},{"@id":"28",image:{"@width":"13","@height":"23","@source":"decor/Decor29Graphics.png"}},{"@id":"29",image:{"@width":"28","@height":"40","@source":"decor/Decor30Graphics.png"}},{"@id":"30",image:{"@width":"69","@height":"30","@source":"decor/Decor31Graphics.png"}},{"@id":"31",image:{"@width":"33","@height":"29","@source":"decor/Decor32Graphics.png"}},{"@id":"32",image:{"@width":"42","@height":"42","@source":"decor/Decor33Graphics.png"}},{"@id":"33",image:{"@width":"60","@height":"66","@source":"decor/Decor34Graphics.png"}},{"@id":"34",image:{"@width":"46","@height":"65","@source":"decor/Decor35Graphics.png"}},{"@id":"35",image:{"@width":"71","@height":"55","@source":"decor/Decor36Graphics.png"}},{"@id":"36",image:{"@width":"35","@height":"55","@source":"decor/Decor37Graphics.png"}},{"@id":"37",image:{"@width":"28","@height":"29","@source":"decor/Decor38Graphics.png"}},{"@id":"38",image:{"@width":"38","@height":"37","@source":"decor/Decor39Graphics.png"}},{"@id":"39",image:{"@width":"103","@height":"50","@source":"decor/Decor40Graphics.png"}},{"@id":"40",image:{"@width":"56","@height":"55","@source":"decor/Decor41Graphics.png"}},{"@id":"41",image:{"@width":"71","@height":"50","@source":"decor/Decor42Graphics.png"}},{"@id":"42",image:{"@width":"200","@height":"44","@source":"decor/TxtGraphics.png"}}]}],imagelayer:{"@name":"background","@y":"1",image:{"@source":"bg/Background1Graphics.png"}},objectgroup:[{"@name":"decorations",object:[{"@gid":"47","@x":"455","@y":"245","@width":"34","@height":"25"},{"@gid":"49","@x":"70","@y":"210","@width":"126","@height":"59"},{"@gid":"55","@x":"595","@y":"455","@width":"38","@height":"26"},{"@gid":"56","@x":"582","@y":"373","@width":"43","@height":"78"},{"@gid":"78","@x":"385","@y":"483","@width":"71","@height":"55"},{"@gid":"68","@x":"119","@y":"490","@width":"104","@height":"46"},{"@gid":"43","@x":"95","@y":"419","@width":"232","@height":"79",properties:{property:{"@name":"text","@value":"level_text_11"}}},{"@gid":"72","@x":"160","@y":"453"},{"@gid":"75","@x":"264","@y":"455"}]},{"@name":"tiles",object:[{"@gid":"12","@x":"0","@y":"525","@width":"35","@height":"35"},{"@gid":"12","@x":"595","@y":"525","@width":"35","@height":"35"},{"@gid":"4","@x":"35","@y":"245","@width":"35","@height":"35"},{"@gid":"9","@x":"0","@y":"245","@width":"35","@height":"35"},{"@gid":"13","@x":"0","@y":"280","@width":"35","@height":"35"},{"@gid":"13","@x":"0","@y":"315","@width":"35","@height":"35"},{"@gid":"13","@x":"0","@y":"350","@width":"35","@height":"35"},{"@gid":"13","@x":"0","@y":"385","@width":"35","@height":"35"},{"@gid":"13","@x":"0","@y":"455","@width":"35","@height":"35"},{"@gid":"13","@x":"0","@y":"420","@width":"35","@height":"35"},{"@gid":"13","@x":"0","@y":"490","@width":"35","@height":"35"},{"@gid":"9","@x":"35","@y":"525","@width":"35","@height":"35"},{"@gid":"9","@x":"70","@y":"525","@width":"35","@height":"35"},{"@gid":"9","@x":"105","@y":"525","@width":"35","@height":"35"},{"@gid":"9","@x":"140","@y":"525","@width":"35","@height":"35"},{"@gid":"9","@x":"175","@y":"525","@width":"35","@height":"35"},{"@gid":"9","@x":"210","@y":"525","@width":"35","@height":"35"},{"@gid":"9","@x":"245","@y":"525","@width":"35","@height":"35"},{"@gid":"9","@x":"315","@y":"525","@width":"35","@height":"35"},{"@gid":"9","@x":"350","@y":"525","@width":"35","@height":"35"},{"@gid":"9","@x":"280","@y":"525","@width":"35","@height":"35"},{"@gid":"9","@x":"420","@y":"525","@width":"35","@height":"35"},{"@gid":"9","@x":"385","@y":"525","@width":"35","@height":"35"},{"@gid":"9","@x":"455","@y":"525","@width":"35","@height":"35"},{"@gid":"9","@x":"490","@y":"525","@width":"35","@height":"35"},{"@gid":"9","@x":"525","@y":"525","@width":"35","@height":"35"},{"@gid":"9","@x":"560","@y":"525","@width":"35","@height":"35"},{"@gid":"9","@x":"630","@y":"525","@width":"35","@height":"35"},{"@gid":"9","@x":"665","@y":"525","@width":"35","@height":"35"},{"@gid":"5","@x":"595","@y":"490","@width":"35","@height":"35"},{"@gid":"4","@x":"595","@y":"385","@width":"35","@height":"35"},{"@gid":"3","@x":"560","@y":"385","@width":"35","@height":"35"},{"@gid":"3","@x":"525","@y":"385","@width":"35","@height":"35"},{"@gid":"14","@x":"490","@y":"385","@width":"35","@height":"35"},{"@gid":"3","@x":"455","@y":"350","@width":"35","@height":"35"},{"@gid":"3","@x":"420","@y":"350","@width":"35","@height":"35"},{"@gid":"3","@x":"385","@y":"350","@width":"35","@height":"35"},{"@gid":"3","@x":"350","@y":"350","@width":"35","@height":"35"},{"@gid":"6","@x":"490","@y":"315","@width":"35","@height":"35"},{"@gid":"8","@x":"490","@y":"280","@width":"35","@height":"35"},{"@gid":"3","@x":"525","@y":"280","@width":"35","@height":"35"},{"@gid":"3","@x":"560","@y":"280","@width":"35","@height":"35"},{"@gid":"3","@x":"595","@y":"280","@width":"35","@height":"35"},{"@gid":"3","@x":"630","@y":"280","@width":"35","@height":"35"},{"@gid":"15","@x":"665","@y":"280","@width":"35","@height":"35"},{"@gid":"11","@x":"665","@y":"245","@width":"35","@height":"35"},{"@gid":"11","@x":"665","@y":"210","@width":"35","@height":"35"},{"@gid":"11","@x":"665","@y":"175","@width":"35","@height":"35"},{"@gid":"4","@x":"595","@y":"210","@width":"35","@height":"35"},{"@gid":"3","@x":"560","@y":"210","@width":"35","@height":"35"},{"@gid":"3","@x":"525","@y":"210","@width":"35","@height":"35"},{"@gid":"3","@x":"490","@y":"210","@width":"35","@height":"35"},{"@gid":"5","@x":"455","@y":"175","@width":"35","@height":"35"},{"@gid":"14","@x":"455","@y":"210","@width":"35","@height":"35"},{"@gid":"8","@x":"315","@y":"210","@width":"35","@height":"35"},{"@gid":"4","@x":"350","@y":"210","@width":"35","@height":"35"},{"@gid":"6","@x":"315","@y":"245","@width":"35","@height":"35"},{"@gid":"6","@x":"315","@y":"280","@width":"35","@height":"35"},{"@gid":"6","@x":"315","@y":"315","@width":"35","@height":"35"},{"@gid":"11","@x":"315","@y":"350","@width":"35","@height":"35"},{"@gid":"6","@x":"315","@y":"385","@width":"35","@height":"35"},{"@gid":"7","@x":"315","@y":"420","@width":"35","@height":"35"},{"@gid":"7","@x":"70","@y":"385","@width":"35","@height":"35"},{"@gid":"6","@x":"70","@y":"350","@width":"35","@height":"35"},{"@gid":"8","@x":"70","@y":"315","@width":"35","@height":"35"},{"@gid":"3","@x":"105","@y":"315","@width":"35","@height":"35"},{"@gid":"3","@x":"140","@y":"315","@width":"35","@height":"35"},{"@gid":"3","@x":"175","@y":"315","@width":"35","@height":"35"},{"@gid":"4","@x":"210","@y":"315","@width":"35","@height":"35"},{"@gid":"7","@x":"210","@y":"210","@width":"35","@height":"35"},{"@gid":"6","@x":"210","@y":"175","@width":"35","@height":"35"},{"@gid":"6","@x":"210","@y":"140","@width":"35","@height":"35"},{"@gid":"8","@x":"210","@y":"105","@width":"35","@height":"35"},{"@gid":"3","@x":"245","@y":"105","@width":"35","@height":"35"},{"@gid":"3","@x":"280","@y":"105","@width":"35","@height":"35"},{"@gid":"3","@x":"315","@y":"105","@width":"35","@height":"35"},{"@gid":"3","@x":"350","@y":"105","@width":"35","@height":"35"},{"@gid":"3","@x":"385","@y":"105","@width":"35","@height":"35"},{"@gid":"3","@x":"420","@y":"105","@width":"35","@height":"35"},{"@gid":"3","@x":"455","@y":"105","@width":"35","@height":"35"},{"@gid":"3","@x":"525","@y":"105","@width":"35","@height":"35"},{"@gid":"3","@x":"490","@y":"105","@width":"35","@height":"35"},{"@gid":"10","@x":"560","@y":"105","@width":"35","@height":"35"},{"@gid":"14","@x":"560","@y":"140","@width":"35","@height":"35"},{"@gid":"3","@x":"595","@y":"140","@width":"35","@height":"35"},{"@gid":"3","@x":"630","@y":"140","@width":"35","@height":"35"},{"@gid":"9","@x":"665","@y":"140","@width":"35","@height":"35"},{"@gid":"13","@x":"490","@y":"350","@width":"35","@height":"35"}]},{"@name":"active",object:[{"@gid":"25","@x":"340","@y":"285","@width":"32","@height":"22",properties:{property:[{"@name":"delay","@value":"0"},{"@name":"maxAngle","@value":"170"},{"@name":"minAngle","@value":"170"},{"@name":"speedX","@value":"0"}]}},{"@type":"2","@gid":"17","@x":"526","@y":"176","@width":"24","@height":"11"},{"@gid":"17","@x":"532","@y":"351","@width":"24","@height":"11"},{"@gid":"21","@x":"245","@y":"195.5","@width":"70","@height":"19",properties:{property:[{"@name":"distanceY","@value":"105"},{"@name":"speedY","@value":"55"}]}},{"@type":"4","@gid":"17","@x":"11","@y":"211.5","@width":"24","@height":"11"},{"@gid":"19","@x":"225","@y":"280","@width":"20","@height":"70"},{"@type":"4","@gid":"20","@x":"322","@y":"490","@width":"20","@height":"70"},{"@gid":"27","@x":"404","@y":"246","@width":"31","@height":"34"},{"@gid":"27","@x":"404","@y":"414","@width":"31","@height":"34"},{"@gid":"27","@x":"119","@y":"133","@width":"31","@height":"34"},{"@type":"2","@gid":"19","@x":"385","@y":"175","@width":"20","@height":"70","@rotation":"90"},{"@gid":"30","@x":"198","@y":"493","@width":"60","@height":"56"},{"@type":"2","@gid":"21","@x":"631","@y":"475.5","@width":"70","@height":"19",properties:{property:[{"@name":"distanceY","@value":"105"},{"@name":"speedY","@value":"-45"}]}},{"@gid":"29","@x":"105","@y":"280","@width":"60","@height":"55"}]},{"@name":"characters",object:[{"@gid":"24","@x":"330","@y":"178","@width":"44","@height":"52"},{"@gid":"28","@x":"517.5","@y":"492","@width":"63","@height":"50"}]},{"@name":"physics",object:[{"@x":"0","@y":"210","@width":"70","@height":"35"},{"@x":"0","@y":"245","@width":"35","@height":"245"},{"@x":"0","@y":"490","@width":"700","@height":"35"},{"@x":"595","@y":"455","@width":"35","@height":"35"},{"@x":"315","@y":"210","@width":"35","@height":"210"},{"@x":"315","@y":"175","@width":"70","@height":"35"},{"@x":"455","@y":"140","@width":"35","@height":"35"},{"@x":"455","@y":"175","@width":"175","@height":"35"},{"@x":"70","@y":"280","@width":"175","@height":"35"},{"@x":"70","@y":"315","@width":"35","@height":"70"},{"@x":"210","@y":"105","@width":"35","@height":"105"},{"@x":"210","@y":"70","@width":"385","@height":"35"},{"@x":"560","@y":"105","@width":"140","@height":"35"},{"@x":"665","@y":"140","@width":"35","@height":"105"},{"@x":"490","@y":"245","@width":"210","@height":"35"},{"@x":"490","@y":"280","@width":"35","@height":"105"},{"@x":"525","@y":"350","@width":"105","@height":"35"},{"@x":"350","@y":"315","@width":"140","@height":"35"}]}]},{"@level":"11","@version":"1.0","@orientation":"orthogonal","@renderorder":"right-down","@width":"20","@height":"15","@tilewidth":"35","@tileheight":"35","@nextobjectid":"145",tileset:[{"@firstgid":"1","@name":"tiles","@tilewidth":"35","@tileheight":"35","@tilecount":"16",tile:[{"@id":"0",image:{"@width":"35","@height":"35","@source":"tiles/singleTile.png"}},{"@id":"1",image:{"@width":"35","@height":"35","@source":"tiles/platformLeft.png"}},{"@id":"2",image:{"@width":"35","@height":"35","@source":"tiles/platformCenter.png"}},{"@id":"3",image:{"@width":"35","@height":"35","@source":"tiles/platformRight.png"}},{"@id":"4",image:{"@width":"35","@height":"35","@source":"tiles/verticalPlatformTop.png"}},{"@id":"5",image:{"@width":"35","@height":"35","@source":"tiles/verticalPlatformCenter.png"}},{"@id":"6",image:{"@width":"35","@height":"35","@source":"tiles/verticalPlatformBottom.png"}},{"@id":"7",image:{"@width":"35","@height":"35","@source":"tiles/tileTopLeft.png"}},{"@id":"8",image:{"@width":"35","@height":"35","@source":"tiles/tileTopCenter.png"}},{"@id":"9",image:{"@width":"35","@height":"35","@source":"tiles/tileTopRight.png"}},{"@id":"10",image:{"@width":"35","@height":"35","@source":"tiles/tileCenterLeft.png"}},{"@id":"11",image:{"@width":"35","@height":"35","@source":"tiles/tileCenter.png"}},{"@id":"12",image:{"@width":"35","@height":"35","@source":"tiles/tileCenterRight.png"}},{"@id":"13",image:{"@width":"35","@height":"35","@source":"tiles/tileBottomLeft.png"}},{"@id":"14",image:{"@width":"35","@height":"35","@source":"tiles/tileBottomCenter.png"}},{"@id":"15",image:{"@width":"35","@height":"35","@source":"tiles/tileBottomRight.png"}}]},{"@firstgid":"17","@name":"active","@tilewidth":"105","@tileheight":"70","@tilecount":"14",tile:[{"@id":"0",image:{"@width":"24","@height":"11","@source":"active/PushButtonGraphics.png"}},{"@id":"1",image:{"@width":"25","@height":"19","@source":"active/TriggerGraphics.png"}},{"@id":"2",image:{"@width":"20","@height":"70","@source":"active/DoorGraphics.png"}},{"@id":"3",image:{"@width":"20","@height":"70","@source":"active/GlassDoorGraphics.png"}},{"@id":"4",image:{"@width":"70","@height":"19","@source":"active/ElevatorGraphics.png"}},{"@id":"5",image:{"@width":"105","@height":"20","@source":"active/BigElevatorGraphics.png"}},{"@id":"6",image:{"@width":"70","@height":"70","@source":"active/ExitGraphics.png"}},{"@id":"7",image:{"@width":"44","@height":"52","@source":"characters/HustlerGraphics.png"}},{"@id":"8",image:{"@width":"32","@height":"22","@source":"active/CameraGraphics.png"}},{"@id":"9",image:{"@width":"15","@height":"15","@source":"characters/EnemyLimiterGraphics.png"}},{"@id":"10",image:{"@width":"31","@height":"34","@source":"passive/MoneyBagGraphics.png"}},{"@id":"11",image:{"@width":"63","@height":"50","@source":"characters/DogGraphics.png"}},{"@id":"12",image:{"@width":"60","@height":"55","@source":"characters/Prisoner2Graphics.png"}},{"@id":"13",image:{"@width":"60","@height":"56","@source":"characters/PrisonerGraphics.png"}}]},{"@firstgid":"31","@name":"passive","@tilewidth":"210","@tileheight":"50","@tilecount":"12",tile:[{"@id":"0",image:{"@width":"50","@height":"50","@source":"passive/BigBoxGraphics.png"}},{"@id":"1",image:{"@width":"35","@height":"35","@source":"passive/BoxGraphics.png"}},{"@id":"2",image:{"@width":"37","@height":"35","@source":"passive/ToiletGraphics.png"}},{"@id":"3",image:{"@width":"35","@height":"35","@source":"passive/MonitorGraphics.png"}},{"@id":"4",image:{"@width":"35","@height":"35","@source":"passive/BasketBallGraphics.png"}},{"@id":"5",image:{"@width":"35","@height":"35","@source":"passive/StoolGraphics.png"}},{"@id":"6",image:{"@width":"150","@height":"20","@source":"passive/PlankGraphics.png"}},{"@id":"7",image:{"@width":"150","@height":"20","@source":"passive/Plank2Graphics.png"}},{"@id":"8",image:{"@width":"210","@height":"20","@source":"passive/BigPlankGraphics.png"}},{"@id":"9",image:{"@width":"100","@height":"20","@source":"passive/Plank5Graphics.png"}},{"@id":"10",image:{"@width":"150","@height":"20","@source":"passive/Plank2Graphics.png"}},{"@id":"11",image:{"@width":"35","@height":"35","@source":"passive/MirrorGraphics.png"}}]},{"@firstgid":"43","@name":"decor","@tilewidth":"232","@tileheight":"136","@tilecount":"43",tile:[{"@id":"0",image:{"@width":"232","@height":"79","@source":"decor/LevelTextGraphics.png"}},{"@id":"1",image:{"@width":"54","@height":"20","@source":"decor/Decor1Graphics.png"}},{"@id":"2",image:{"@width":"54","@height":"20","@source":"decor/Decor2Graphics.png"}},{"@id":"3",image:{"@width":"33","@height":"27","@source":"decor/Decor3Graphics.png"}},{"@id":"4",image:{"@width":"34","@height":"25","@source":"decor/Decor4Graphics.png"}},{"@id":"5",image:{"@width":"22","@height":"31","@source":"decor/Decor5Graphics.png"}},{"@id":"6",image:{"@width":"126","@height":"59","@source":"decor/Decor6Graphics.png"}},{"@id":"7",image:{"@width":"25","@height":"21","@source":"decor/Decor8Graphics.png"}},{"@id":"8",image:{"@width":"18","@height":"22","@source":"decor/Decor9Graphics.png"}},{"@id":"9",image:{"@width":"35","@height":"58","@source":"decor/Decor10Graphics.png"}},{"@id":"10",image:{"@width":"19","@height":"66","@source":"decor/Decor11Graphics.png"}},{"@id":"11",image:{"@width":"23","@height":"33","@source":"decor/Decor12Graphics.png"}},{"@id":"12",image:{"@width":"38","@height":"26","@source":"decor/Decor13Graphics.png"}},{"@id":"13",image:{"@width":"43","@height":"78","@source":"decor/Decor14Graphics.png"}},{"@id":"14",image:{"@width":"60","@height":"86","@source":"decor/Decor15Graphics.png"}},{"@id":"15",image:{"@width":"41","@height":"69","@source":"decor/Decor16Graphics.png"}},{"@id":"16",image:{"@width":"55","@height":"58","@source":"decor/Decor17Graphics.png"}},{"@id":"17",image:{"@width":"57","@height":"54","@source":"decor/Decor18Graphics.png"}},{"@id":"18",image:{"@width":"18","@height":"45","@source":"decor/Decor19Graphics.png"}},{"@id":"19",image:{"@width":"41","@height":"49","@source":"decor/Decor20Graphics.png"}},{"@id":"20",image:{"@width":"51","@height":"38","@source":"decor/Decor21Graphics.png"}},{"@id":"21",image:{"@width":"54","@height":"54","@source":"decor/Decor22Graphics.png"}},{"@id":"22",image:{"@width":"63","@height":"136","@source":"decor/Decor23Graphics.png"}},{"@id":"23",image:{"@width":"21","@height":"39","@source":"decor/Decor24Graphics.png"}},{"@id":"24",image:{"@width":"104","@height":"50","@source":"decor/Decor25Graphics.png"}},{"@id":"25",image:{"@width":"104","@height":"46","@source":"decor/Decor26Graphics.png"}},{"@id":"26",image:{"@width":"86","@height":"38","@source":"decor/Decor27Graphics.png"}},{"@id":"27",image:{"@width":"63","@height":"55","@source":"decor/Decor28Graphics.png"}},{"@id":"28",image:{"@width":"13","@height":"23","@source":"decor/Decor29Graphics.png"}},{"@id":"29",image:{"@width":"28","@height":"40","@source":"decor/Decor30Graphics.png"}},{"@id":"30",image:{"@width":"69","@height":"30","@source":"decor/Decor31Graphics.png"}},{"@id":"31",image:{"@width":"33","@height":"29","@source":"decor/Decor32Graphics.png"}},{"@id":"32",image:{"@width":"42","@height":"42","@source":"decor/Decor33Graphics.png"}},{"@id":"33",image:{"@width":"60","@height":"66","@source":"decor/Decor34Graphics.png"}},{"@id":"34",image:{"@width":"46","@height":"65","@source":"decor/Decor35Graphics.png"}},{"@id":"35",image:{"@width":"71","@height":"55","@source":"decor/Decor36Graphics.png"}},{"@id":"36",image:{"@width":"35","@height":"55","@source":"decor/Decor37Graphics.png"}},{"@id":"37",image:{"@width":"28","@height":"29","@source":"decor/Decor38Graphics.png"}},{"@id":"38",image:{"@width":"38","@height":"37","@source":"decor/Decor39Graphics.png"}},{"@id":"39",image:{"@width":"103","@height":"50","@source":"decor/Decor40Graphics.png"}},{"@id":"40",image:{"@width":"56","@height":"55","@source":"decor/Decor41Graphics.png"}},{"@id":"41",image:{"@width":"71","@height":"50","@source":"decor/Decor42Graphics.png"}},{"@id":"42",image:{"@width":"200","@height":"44","@source":"decor/TxtGraphics.png"}}]}],imagelayer:{"@name":"background",image:{"@source":"bg/Background1Graphics.png"}},objectgroup:[{"@name":"decorations",object:[{"@id":"1","@gid":"43","@x":"143","@y":"377","@width":"232","@height":"79",properties:{property:{"@name":"text","@value":"level_text_12"}}},{"@id":"2","@gid":"78","@x":"570","@y":"455","@width":"71","@height":"55"},{"@id":"3","@gid":"62","@x":"594","@y":"387","@width":"41","@height":"49"},{"@id":"4","@gid":"65","@x":"599","@y":"214","@width":"63","@height":"136"},{"@id":"5","@gid":"81","@x":"245","@y":"210","@width":"38","@height":"37"},{"@id":"6","@gid":"67","@x":"140","@y":"245","@width":"104","@height":"50"},{"@id":"7","@gid":"55","@x":"175","@y":"455","@width":"38","@height":"26"},{"@id":"8","@gid":"57","@x":"272","@y":"469","@width":"60","@height":"86"},{"@id":"9","@gid":"44","@x":"175","@y":"159","@width":"54","@height":"20"}]},{"@name":"tiles",object:[{"@id":"10","@gid":"12","@x":"560","@y":"525","@width":"35","@height":"35"},{"@id":"11","@gid":"12","@x":"595","@y":"525","@width":"35","@height":"35"},{"@id":"12","@gid":"12","@x":"560","@y":"175","@width":"35","@height":"35"},{"@id":"13","@gid":"12","@x":"0","@y":"525","@width":"35","@height":"35"},{"@id":"14","@gid":"12","@x":"665","@y":"525","@width":"35","@height":"35"},{"@id":"15","@gid":"12","@x":"420","@y":"525","@width":"35","@height":"35"},{"@id":"16","@gid":"12","@x":"665","@y":"490","@width":"35","@height":"35"},{"@id":"17","@gid":"12","@x":"455","@y":"525","@width":"35","@height":"35"},{"@id":"18","@gid":"12","@x":"490","@y":"525","@width":"35","@height":"35"},{"@id":"19","@gid":"12","@x":"490","@y":"490","@width":"35","@height":"35"},{"@id":"20","@gid":"12","@x":"525","@y":"525","@width":"35","@height":"35"},{"@id":"21","@gid":"12","@x":"35","@y":"525","@width":"35","@height":"35"},{"@id":"22","@gid":"12","@x":"630","@y":"525","@width":"35","@height":"35"},{"@id":"23","@gid":"12","@x":"665","@y":"280","@width":"35","@height":"35"},{"@id":"24","@gid":"9","@x":"630","@y":"490","@width":"35","@height":"35"},{"@id":"25","@gid":"9","@x":"595","@y":"490","@width":"35","@height":"35"},{"@id":"26","@gid":"9","@x":"560","@y":"490","@width":"35","@height":"35"},{"@id":"27","@gid":"9","@x":"525","@y":"490","@width":"35","@height":"35"},{"@id":"28","@gid":"9","@x":"455","@y":"490","@width":"35","@height":"35"},{"@id":"29","@gid":"9","@x":"0","@y":"490","@width":"35","@height":"35"},{"@id":"30","@gid":"10","@x":"35","@y":"490","@width":"35","@height":"35"},{"@id":"31","@gid":"10","@x":"140","@y":"385","@width":"35","@height":"35"},{"@id":"32","@gid":"10","@x":"210","@y":"420","@width":"35","@height":"35"},{"@id":"33","@gid":"10","@x":"455","@y":"315","@width":"35","@height":"35"},{"@id":"34","@gid":"10","@x":"280","@y":"140","@width":"35","@height":"35"},{"@id":"35","@gid":"10","@x":"560","@y":"105","@width":"35","@height":"35"},{"@id":"36","@gid":"8","@x":"665","@y":"175","@width":"35","@height":"35"},{"@id":"37","@gid":"8","@x":"525","@y":"315","@width":"35","@height":"35"},{"@id":"38","@gid":"8","@x":"70","@y":"140","@width":"35","@height":"35"},{"@id":"39","@gid":"14","@x":"280","@y":"175","@width":"35","@height":"35"},{"@id":"40","@gid":"14","@x":"70","@y":"280","@width":"35","@height":"35"},{"@id":"41","@gid":"8","@x":"420","@y":"490","@width":"35","@height":"35"},{"@id":"42","@gid":"14","@x":"140","@y":"420","@width":"35","@height":"35"},{"@id":"43","@gid":"14","@x":"385","@y":"315","@width":"35","@height":"35"},{"@id":"44","@gid":"14","@x":"525","@y":"210","@width":"35","@height":"35"},{"@id":"45","@gid":"16","@x":"560","@y":"315","@width":"35","@height":"35"},{"@id":"46","@gid":"2","@x":"630","@y":"280","@width":"35","@height":"35"},{"@id":"47","@gid":"2","@x":"420","@y":"105","@width":"35","@height":"35"},{"@id":"48","@gid":"7","@x":"455","@y":"210","@width":"35","@height":"35"},{"@id":"49","@gid":"7","@x":"210","@y":"455","@width":"35","@height":"35"},{"@id":"50","@gid":"5","@x":"490","@y":"455","@width":"35","@height":"35"},{"@id":"51","@gid":"3","@x":"490","@y":"350","@width":"35","@height":"35"},{"@id":"52","@gid":"3","@x":"420","@y":"315","@width":"35","@height":"35"},{"@id":"53","@gid":"3","@x":"105","@y":"280","@width":"35","@height":"35"},{"@id":"54","@gid":"3","@x":"140","@y":"280","@width":"35","@height":"35"},{"@id":"55","@gid":"3","@x":"175","@y":"280","@width":"35","@height":"35"},{"@id":"56","@gid":"3","@x":"210","@y":"280","@width":"35","@height":"35"},{"@id":"57","@gid":"3","@x":"245","@y":"280","@width":"35","@height":"35"},{"@id":"58","@gid":"3","@x":"105","@y":"140","@width":"35","@height":"35"},{"@id":"59","@gid":"3","@x":"140","@y":"140","@width":"35","@height":"35"},{"@id":"60","@gid":"3","@x":"175","@y":"140","@width":"35","@height":"35"},{"@id":"61","@gid":"3","@x":"210","@y":"140","@width":"35","@height":"35"},{"@id":"62","@gid":"3","@x":"245","@y":"140","@width":"35","@height":"35"},{"@id":"63","@gid":"3","@x":"315","@y":"175","@width":"35","@height":"35"},{"@id":"64","@gid":"3","@x":"350","@y":"175","@width":"35","@height":"35"},{"@id":"65","@gid":"3","@x":"385","@y":"175","@width":"35","@height":"35"},{"@id":"66","@gid":"3","@x":"420","@y":"175","@width":"35","@height":"35"},{"@id":"67","@gid":"3","@x":"455","@y":"105","@width":"35","@height":"35"},{"@id":"68","@gid":"3","@x":"490","@y":"105","@width":"35","@height":"35"},{"@id":"69","@gid":"4","@x":"595","@y":"175","@width":"35","@height":"35"},{"@id":"70","@gid":"4","@x":"280","@y":"280","@width":"35","@height":"35"},{"@id":"71","@gid":"5","@x":"385","@y":"280","@width":"35","@height":"35"},{"@id":"72","@gid":"3","@x":"175","@y":"420","@width":"35","@height":"35"},{"@id":"73","@gid":"3","@x":"105","@y":"385","@width":"35","@height":"35"},{"@id":"74","@gid":"2","@x":"70","@y":"385","@width":"35","@height":"35"},{"@id":"75","@gid":"9","@x":"70","@y":"525","@width":"35","@height":"35"},{"@id":"76","@gid":"9","@x":"105","@y":"525","@width":"35","@height":"35"},{"@id":"77","@gid":"9","@x":"140","@y":"525","@width":"35","@height":"35"},{"@id":"78","@gid":"9","@x":"175","@y":"525","@width":"35","@height":"35"},{"@id":"79","@gid":"9","@x":"210","@y":"525","@width":"35","@height":"35"},{"@id":"80","@gid":"9","@x":"245","@y":"525","@width":"35","@height":"35"},{"@id":"81","@gid":"9","@x":"280","@y":"525","@width":"35","@height":"35"},{"@id":"82","@gid":"9","@x":"315","@y":"525","@width":"35","@height":"35"},{"@id":"83","@gid":"9","@x":"350","@y":"525","@width":"35","@height":"35"},{"@id":"84","@gid":"9","@x":"385","@y":"525","@width":"35","@height":"35"},{"@id":"85","@gid":"6","@x":"70","@y":"245","@width":"35","@height":"35"},{"@id":"86","@gid":"6","@x":"70","@y":"210","@width":"35","@height":"35"},{"@id":"87","@gid":"6","@x":"70","@y":"175","@width":"35","@height":"35"},{"@id":"88","@gid":"6","@x":"560","@y":"245","@width":"35","@height":"35"},{"@id":"89","@gid":"6","@x":"560","@y":"280","@width":"35","@height":"35"},{"@id":"90","@gid":"11","@x":"665","@y":"210","@width":"35","@height":"35"},{"@id":"91","@gid":"11","@x":"665","@y":"245","@width":"35","@height":"35"},{"@id":"92","@gid":"11","@x":"665","@y":"315","@width":"35","@height":"35"},{"@id":"93","@gid":"11","@x":"665","@y":"350","@width":"35","@height":"35"},{"@id":"94","@gid":"11","@x":"665","@y":"385","@width":"35","@height":"35"},{"@id":"95","@gid":"11","@x":"665","@y":"420","@width":"35","@height":"35"},{"@id":"96","@gid":"11","@x":"665","@y":"455","@width":"35","@height":"35"},{"@id":"97","@gid":"10","@x":"455","@y":"175","@width":"35","@height":"35"},{"@id":"98","@gid":"13","@x":"560","@y":"210","@width":"35","@height":"35"},{"@id":"99","@gid":"13","@x":"560","@y":"140","@width":"35","@height":"35"},{"@id":"100","@gid":"9","@x":"525","@y":"105","@width":"35","@height":"35"},{"@id":"101","@gid":"11","@x":"525","@y":"175","@width":"35","@height":"35"},{"@id":"102","@gid":"11","@x":"525","@y":"140","@width":"35","@height":"35"},{"@id":"103","@gid":"13","@x":"525","@y":"350","@width":"35","@height":"35"},{"@id":"104","@gid":"11","@x":"455","@y":"350","@width":"35","@height":"35"},{"@id":"105","@gid":"7","@x":"525","@y":"385","@width":"35","@height":"35"},{"@id":"106","@gid":"7","@x":"455","@y":"385","@width":"35","@height":"35"}]},{"@name":"active",object:[{"@id":"107","@gid":"25","@x":"548","@y":"240","@width":"32","@height":"22",properties:{property:[{"@name":"delay","@value":"0"},{"@name":"maxAngle","@value":"0"},{"@name":"minAngle","@value":"0"},{"@name":"speedX","@value":"0"}]}},{"@id":"108","@type":"5","@gid":"17","@x":"118","@y":"351","@width":"24","@height":"11"},{"@id":"109","@type":"2","@gid":"17","@x":"460","@y":"456","@width":"24","@height":"11"},{"@id":"110","@type":"2","@gid":"21","@x":"1","@y":"367.5","@width":"70","@height":"19",properties:{property:[{"@name":"distanceY","@value":"180"},{"@name":"speedY","@value":"-45"}]}},{"@id":"111","@type":"5","@gid":"19","@x":"497","@y":"384","@width":"20","@height":"70"},{"@id":"112","@gid":"27","@x":"419","@y":"352","@width":"31","@height":"34"},{"@id":"113","@gid":"27","@x":"595","@y":"245","@width":"31","@height":"34"},{"@id":"114","@gid":"27","@x":"193","@y":"74","@width":"31","@height":"34"},{"@id":"115","@type":"6","@gid":"17","@x":"281","@y":"245.5","@width":"24","@height":"11"},{"@id":"116","@type":"6","@gid":"19","@x":"406","@y":"175","@width":"20","@height":"70","@rotation":"180"},{"@id":"117","@gid":"32","@x":"455","@y":"140","@width":"35","@height":"35"},{"@id":"118","@gid":"40","@x":"350","@y":"139","@width":"100","@height":"20"},{"@id":"119","@gid":"30","@x":"146","@y":"246","@width":"60","@height":"56",properties:{property:[{"@name":"limitLeft"},{"@name":"limitRight"}]}}]},{"@name":"characters",object:[{"@id":"120","@gid":"24","@x":"122","@y":"488","@width":"44","@height":"52"},{"@id":"121","@gid":"28","@x":"318.5","@y":"488","@width":"63","@height":"50"}]},{"@name":"physics",object:[{"@id":"122","@x":"0","@y":"455","@width":"70","@height":"70"},{"@id":"123","@x":"70","@y":"490","@width":"350","@height":"35"},{"@id":"124","@x":"420","@y":"455","@width":"280","@height":"70"},{"@id":"125","@x":"490","@y":"420","@width":"35","@height":"35"},{"@id":"126","@x":"665","@y":"140","@width":"35","@height":"315"},{"@id":"127","@x":"630","@y":"245","@width":"35","@height":"35"},{"@id":"128","@x":"595","@y":"140","@width":"35","@height":"35"},{"@id":"129","@x":"420","@y":"70","@width":"175","@height":"35"},{"@id":"130","@x":"525","@y":"105","@width":"70","@height":"105"},{"@id":"131","@x":"560","@y":"210","@width":"35","@height":"105"},{"@id":"132","@x":"525","@y":"280","@width":"35","@height":"105"},{"@id":"133","@x":"490","@y":"315","@width":"35","@height":"35"},{"@id":"134","@x":"455","@y":"315","@width":"35","@height":"70"},{"@id":"135","@x":"385","@y":"280","@width":"105","@height":"35"},{"@id":"136","@x":"385","@y":"245","@width":"35","@height":"35"},{"@id":"137","@x":"455","@y":"175","@width":"35","@height":"35"},{"@id":"138","@x":"280","@y":"140","@width":"210","@height":"35"},{"@id":"139","@x":"70","@y":"105","@width":"245","@height":"35"},{"@id":"140","@x":"70","@y":"140","@width":"35","@height":"105"},{"@id":"141","@x":"70","@y":"245","@width":"245","@height":"35"},{"@id":"142","@x":"70","@y":"350","@width":"105","@height":"35"},{"@id":"143","@x":"140","@y":"385","@width":"105","@height":"35"},{"@id":"144","@x":"210","@y":"420","@width":"35","@height":"35"}]}]},{"@level":"12","@version":"1.0","@orientation":"orthogonal","@renderorder":"right-down","@width":"20","@height":"15","@tilewidth":"35","@tileheight":"35","@nextobjectid":"152",tileset:[{"@firstgid":"1","@name":"tiles","@tilewidth":"35","@tileheight":"35","@tilecount":"16",tile:[{"@id":"0",image:{"@width":"35","@height":"35","@source":"tiles/singleTile.png"}},{"@id":"1",image:{"@width":"35","@height":"35","@source":"tiles/platformLeft.png"}},{"@id":"2",image:{"@width":"35","@height":"35","@source":"tiles/platformCenter.png"}},{"@id":"3",image:{"@width":"35","@height":"35","@source":"tiles/platformRight.png"}},{"@id":"4",image:{"@width":"35","@height":"35","@source":"tiles/verticalPlatformTop.png"}},{"@id":"5",image:{"@width":"35","@height":"35","@source":"tiles/verticalPlatformCenter.png"}},{"@id":"6",image:{"@width":"35","@height":"35","@source":"tiles/verticalPlatformBottom.png"}},{"@id":"7",image:{"@width":"35","@height":"35","@source":"tiles/tileTopLeft.png"}},{"@id":"8",image:{"@width":"35","@height":"35","@source":"tiles/tileTopCenter.png"}},{"@id":"9",image:{"@width":"35","@height":"35","@source":"tiles/tileTopRight.png"}},{"@id":"10",image:{"@width":"35","@height":"35","@source":"tiles/tileCenterLeft.png"}},{"@id":"11",image:{"@width":"35","@height":"35","@source":"tiles/tileCenter.png"}},{"@id":"12",image:{"@width":"35","@height":"35","@source":"tiles/tileCenterRight.png"}},{"@id":"13",image:{"@width":"35","@height":"35","@source":"tiles/tileBottomLeft.png"}},{"@id":"14",image:{"@width":"35","@height":"35","@source":"tiles/tileBottomCenter.png"}},{"@id":"15",image:{"@width":"35","@height":"35","@source":"tiles/tileBottomRight.png"}}]},{"@firstgid":"17","@name":"active","@tilewidth":"105","@tileheight":"70","@tilecount":"14",tile:[{"@id":"0",image:{"@width":"24","@height":"11","@source":"active/PushButtonGraphics.png"}},{"@id":"1",image:{"@width":"25","@height":"19","@source":"active/TriggerGraphics.png"}},{"@id":"2",image:{"@width":"20","@height":"70","@source":"active/DoorGraphics.png"}},{"@id":"3",image:{"@width":"20","@height":"70","@source":"active/GlassDoorGraphics.png"}},{"@id":"4",image:{"@width":"70","@height":"19","@source":"active/ElevatorGraphics.png"}},{"@id":"5",image:{"@width":"105","@height":"20","@source":"active/BigElevatorGraphics.png"}},{"@id":"6",image:{"@width":"70","@height":"70","@source":"active/ExitGraphics.png"}},{"@id":"7",image:{"@width":"44","@height":"52","@source":"characters/HustlerGraphics.png"}},{"@id":"8",image:{"@width":"32","@height":"22","@source":"active/CameraGraphics.png"}},{"@id":"9",image:{"@width":"15","@height":"15","@source":"characters/EnemyLimiterGraphics.png"}},{"@id":"10",image:{"@width":"31","@height":"34","@source":"passive/MoneyBagGraphics.png"}},{"@id":"11",image:{"@width":"63","@height":"50","@source":"characters/DogGraphics.png"}},{"@id":"12",image:{"@width":"60","@height":"55","@source":"characters/Prisoner2Graphics.png"}},{"@id":"13",image:{"@width":"60","@height":"56","@source":"characters/PrisonerGraphics.png"}}]},{"@firstgid":"31","@name":"passive","@tilewidth":"210","@tileheight":"50","@tilecount":"12",tile:[{"@id":"0",image:{"@width":"50","@height":"50","@source":"passive/BigBoxGraphics.png"}},{"@id":"1",image:{"@width":"35","@height":"35","@source":"passive/BoxGraphics.png"}},{"@id":"2",image:{"@width":"37","@height":"35","@source":"passive/ToiletGraphics.png"}},{"@id":"3",image:{"@width":"35","@height":"35","@source":"passive/MonitorGraphics.png"}},{"@id":"4",image:{"@width":"35","@height":"35","@source":"passive/BasketBallGraphics.png"}},{"@id":"5",image:{"@width":"35","@height":"35","@source":"passive/StoolGraphics.png"}},{"@id":"6",image:{"@width":"150","@height":"20","@source":"passive/PlankGraphics.png"}},{"@id":"7",image:{"@width":"150","@height":"20","@source":"passive/Plank2Graphics.png"}},{"@id":"8",image:{"@width":"210","@height":"20","@source":"passive/BigPlankGraphics.png"}},{"@id":"9",image:{"@width":"100","@height":"20","@source":"passive/Plank5Graphics.png"}},{"@id":"10",image:{"@width":"150","@height":"20","@source":"passive/Plank2Graphics.png"}},{"@id":"11",image:{"@width":"35","@height":"35","@source":"passive/MirrorGraphics.png"}}]},{"@firstgid":"43","@name":"decor","@tilewidth":"232","@tileheight":"136","@tilecount":"43",tile:[{"@id":"0",image:{"@width":"232","@height":"79","@source":"decor/LevelTextGraphics.png"}},{"@id":"1",image:{"@width":"54","@height":"20","@source":"decor/Decor1Graphics.png"}},{"@id":"2",image:{"@width":"54","@height":"20","@source":"decor/Decor2Graphics.png"}},{"@id":"3",image:{"@width":"33","@height":"27","@source":"decor/Decor3Graphics.png"}},{"@id":"4",image:{"@width":"34","@height":"25","@source":"decor/Decor4Graphics.png"}},{"@id":"5",image:{"@width":"22","@height":"31","@source":"decor/Decor5Graphics.png"}},{"@id":"6",image:{"@width":"126","@height":"59","@source":"decor/Decor6Graphics.png"}},{"@id":"7",image:{"@width":"25","@height":"21","@source":"decor/Decor8Graphics.png"}},{"@id":"8",image:{"@width":"18","@height":"22","@source":"decor/Decor9Graphics.png"}},{"@id":"9",image:{"@width":"35","@height":"58","@source":"decor/Decor10Graphics.png"}},{"@id":"10",image:{"@width":"19","@height":"66","@source":"decor/Decor11Graphics.png"}},{"@id":"11",image:{"@width":"23","@height":"33","@source":"decor/Decor12Graphics.png"}},{"@id":"12",image:{"@width":"38","@height":"26","@source":"decor/Decor13Graphics.png"}},{"@id":"13",image:{"@width":"43","@height":"78","@source":"decor/Decor14Graphics.png"}},{"@id":"14",image:{"@width":"60","@height":"86","@source":"decor/Decor15Graphics.png"}},{"@id":"15",image:{"@width":"41","@height":"69","@source":"decor/Decor16Graphics.png"}},{"@id":"16",image:{"@width":"55","@height":"58","@source":"decor/Decor17Graphics.png"}},{"@id":"17",image:{"@width":"57","@height":"54","@source":"decor/Decor18Graphics.png"}},{"@id":"18",image:{"@width":"18","@height":"45","@source":"decor/Decor19Graphics.png"}},{"@id":"19",image:{"@width":"41","@height":"49","@source":"decor/Decor20Graphics.png"}},{"@id":"20",image:{"@width":"51","@height":"38","@source":"decor/Decor21Graphics.png"}},{"@id":"21",image:{"@width":"54","@height":"54","@source":"decor/Decor22Graphics.png"}},{"@id":"22",image:{"@width":"63","@height":"136","@source":"decor/Decor23Graphics.png"}},{"@id":"23",image:{"@width":"21","@height":"39","@source":"decor/Decor24Graphics.png"}},{"@id":"24",image:{"@width":"104","@height":"50","@source":"decor/Decor25Graphics.png"}},{"@id":"25",image:{"@width":"104","@height":"46","@source":"decor/Decor26Graphics.png"}},{"@id":"26",image:{"@width":"86","@height":"38","@source":"decor/Decor27Graphics.png"}},{"@id":"27",image:{"@width":"63","@height":"55","@source":"decor/Decor28Graphics.png"}},{"@id":"28",image:{"@width":"13","@height":"23","@source":"decor/Decor29Graphics.png"}},{"@id":"29",image:{"@width":"28","@height":"40","@source":"decor/Decor30Graphics.png"}},{"@id":"30",image:{"@width":"69","@height":"30","@source":"decor/Decor31Graphics.png"}},{"@id":"31",image:{"@width":"33","@height":"29","@source":"decor/Decor32Graphics.png"}},{"@id":"32",image:{"@width":"42","@height":"42","@source":"decor/Decor33Graphics.png"}},{"@id":"33",image:{"@width":"60","@height":"66","@source":"decor/Decor34Graphics.png"}},{"@id":"34",image:{"@width":"46","@height":"65","@source":"decor/Decor35Graphics.png"}},{"@id":"35",image:{"@width":"71","@height":"55","@source":"decor/Decor36Graphics.png"}},{"@id":"36",image:{"@width":"35","@height":"55","@source":"decor/Decor37Graphics.png"}},{"@id":"37",image:{"@width":"28","@height":"29","@source":"decor/Decor38Graphics.png"}},{"@id":"38",image:{"@width":"38","@height":"37","@source":"decor/Decor39Graphics.png"}},{"@id":"39",image:{"@width":"103","@height":"50","@source":"decor/Decor40Graphics.png"}},{"@id":"40",image:{"@width":"56","@height":"55","@source":"decor/Decor41Graphics.png"}},{"@id":"41",image:{"@width":"71","@height":"50","@source":"decor/Decor42Graphics.png"}},{"@id":"42",image:{"@width":"200","@height":"44","@source":"decor/TxtGraphics.png"}}]}],imagelayer:{"@name":"background","@y":"-1",image:{"@source":"bg/Background1Graphics.png"}},objectgroup:[{"@name":"decorations",object:[{"@id":"1","@gid":"44","@x":"105","@y":"299","@width":"54","@height":"20"},{"@id":"2","@gid":"46","@x":"490","@y":"210","@width":"33","@height":"27"},{"@id":"3","@gid":"49","@x":"560","@y":"315","@width":"126","@height":"59"},{"@id":"4","@gid":"67","@x":"385","@y":"490","@width":"104","@height":"50"},{"@id":"5","@gid":"84","@x":"560","@y":"490","@width":"71","@height":"50"},{"@id":"6","@gid":"66","@x":"493","@y":"464","@width":"21","@height":"39"},{"@id":"7","@gid":"62","@x":"128","@y":"408","@width":"41","@height":"49"},{"@id":"8","@gid":"64","@x":"15","@y":"175","@width":"54","@height":"54"},{"@id":"9","@gid":"70","@x":"8","@y":"490","@width":"63","@height":"55"}]},{"@name":"tiles",object:[{"@id":"10","@gid":"9","@x":"455","@y":"525","@width":"35","@height":"35"},{"@id":"11","@gid":"9","@x":"420","@y":"525","@width":"35","@height":"35"},{"@id":"12","@gid":"9","@x":"350","@y":"525","@width":"35","@height":"35"},{"@id":"13","@gid":"9","@x":"385","@y":"525","@width":"35","@height":"35"},{"@id":"14","@gid":"9","@x":"140","@y":"525","@width":"35","@height":"35"},{"@id":"15","@gid":"9","@x":"35","@y":"525","@width":"35","@height":"35"},{"@id":"16","@gid":"9","@x":"0","@y":"525","@width":"35","@height":"35"},{"@id":"17","@gid":"9","@x":"70","@y":"525","@width":"35","@height":"35"},{"@id":"18","@gid":"12","@x":"0","@y":"280","@width":"35","@height":"35"},{"@id":"19","@gid":"12","@x":"70","@y":"210","@width":"35","@height":"35"},{"@id":"20","@gid":"9","@x":"595","@y":"525","@width":"35","@height":"35"},{"@id":"21","@gid":"9","@x":"560","@y":"525","@width":"35","@height":"35"},{"@id":"22","@gid":"9","@x":"525","@y":"525","@width":"35","@height":"35"},{"@id":"23","@gid":"9","@x":"490","@y":"525","@width":"35","@height":"35"},{"@id":"24","@gid":"9","@x":"105","@y":"525","@width":"35","@height":"35"},{"@id":"25","@gid":"9","@x":"280","@y":"525","@width":"35","@height":"35"},{"@id":"26","@gid":"9","@x":"315","@y":"525","@width":"35","@height":"35"},{"@id":"27","@gid":"12","@x":"245","@y":"525","@width":"35","@height":"35"},{"@id":"28","@gid":"12","@x":"210","@y":"525","@width":"35","@height":"35"},{"@id":"29","@gid":"12","@x":"175","@y":"525","@width":"35","@height":"35"},{"@id":"30","@gid":"9","@x":"0","@y":"210","@width":"35","@height":"35"},{"@id":"31","@gid":"9","@x":"210","@y":"490","@width":"35","@height":"35"},{"@id":"32","@gid":"9","@x":"315","@y":"210","@width":"35","@height":"35"},{"@id":"33","@gid":"5","@x":"175","@y":"455","@width":"35","@height":"35"},{"@id":"34","@gid":"5","@x":"245","@y":"385","@width":"35","@height":"35"},{"@id":"35","@gid":"11","@x":"175","@y":"490","@width":"35","@height":"35"},{"@id":"36","@gid":"11","@x":"315","@y":"245","@width":"35","@height":"35"},{"@id":"37","@gid":"11","@x":"70","@y":"245","@width":"35","@height":"35"},{"@id":"38","@gid":"11","@x":"420","@y":"175","@width":"35","@height":"35"},{"@id":"39","@gid":"14","@x":"420","@y":"210","@width":"35","@height":"35"},{"@id":"40","@gid":"2","@x":"245","@y":"280","@width":"35","@height":"35"},{"@id":"41","@gid":"2","@x":"175","@y":"210","@width":"35","@height":"35"},{"@id":"42","@gid":"10","@x":"105","@y":"175","@width":"35","@height":"35"},{"@id":"43","@gid":"10","@x":"420","@y":"140","@width":"35","@height":"35"},{"@id":"44","@gid":"8","@x":"560","@y":"385","@width":"35","@height":"35"},{"@id":"45","@gid":"8","@x":"70","@y":"175","@width":"35","@height":"35"},{"@id":"46","@gid":"8","@x":"350","@y":"140","@width":"35","@height":"35"},{"@id":"47","@gid":"3","@x":"385","@y":"140","@width":"35","@height":"35"},{"@id":"48","@gid":"3","@x":"525","@y":"175","@width":"35","@height":"35"},{"@id":"49","@gid":"3","@x":"490","@y":"175","@width":"35","@height":"35"},{"@id":"50","@gid":"3","@x":"385","@y":"420","@width":"35","@height":"35"},{"@id":"51","@gid":"3","@x":"455","@y":"420","@width":"35","@height":"35"},{"@id":"52","@gid":"3","@x":"420","@y":"420","@width":"35","@height":"35"},{"@id":"53","@gid":"3","@x":"490","@y":"420","@width":"35","@height":"35"},{"@id":"54","@gid":"3","@x":"525","@y":"420","@width":"35","@height":"35"},{"@id":"55","@gid":"3","@x":"35","@y":"280","@width":"35","@height":"35"},{"@id":"56","@gid":"3","@x":"35","@y":"210","@width":"35","@height":"35"},{"@id":"57","@gid":"3","@x":"210","@y":"210","@width":"35","@height":"35"},{"@id":"58","@gid":"3","@x":"245","@y":"210","@width":"35","@height":"35"},{"@id":"59","@gid":"3","@x":"280","@y":"210","@width":"35","@height":"35"},{"@id":"60","@gid":"3","@x":"140","@y":"280","@width":"35","@height":"35"},{"@id":"61","@gid":"3","@x":"280","@y":"280","@width":"35","@height":"35"},{"@id":"62","@gid":"6","@x":"350","@y":"175","@width":"35","@height":"35"},{"@id":"63","@gid":"13","@x":"350","@y":"210","@width":"35","@height":"35"},{"@id":"64","@gid":"13","@x":"350","@y":"245","@width":"35","@height":"35"},{"@id":"65","@gid":"10","@x":"385","@y":"280","@width":"35","@height":"35"},{"@id":"66","@gid":"4","@x":"595","@y":"175","@width":"35","@height":"35"},{"@id":"67","@gid":"4","@x":"595","@y":"385","@width":"35","@height":"35"},{"@id":"68","@gid":"16","@x":"560","@y":"420","@width":"35","@height":"35"},{"@id":"69","@gid":"2","@x":"350","@y":"420","@width":"35","@height":"35"},{"@id":"70","@gid":"4","@x":"175","@y":"280","@width":"35","@height":"35"},{"@id":"71","@gid":"15","@x":"105","@y":"280","@width":"35","@height":"35"},{"@id":"72","@gid":"15","@x":"70","@y":"280","@width":"35","@height":"35"},{"@id":"73","@gid":"15","@x":"0","@y":"385","@width":"35","@height":"35"},{"@id":"74","@gid":"3","@x":"35","@y":"385","@width":"35","@height":"35"},{"@id":"75","@gid":"4","@x":"70","@y":"385","@width":"35","@height":"35"},{"@id":"76","@gid":"6","@x":"455","@y":"245","@width":"35","@height":"35"},{"@id":"77","@gid":"6","@x":"455","@y":"280","@width":"35","@height":"35"},{"@id":"78","@gid":"6","@x":"455","@y":"315","@width":"35","@height":"35"},{"@id":"79","@gid":"6","@x":"385","@y":"315","@width":"35","@height":"35"},{"@id":"80","@gid":"6","@x":"245","@y":"420","@width":"35","@height":"35"},{"@id":"81","@gid":"6","@x":"245","@y":"455","@width":"35","@height":"35"},{"@id":"82","@gid":"7","@x":"455","@y":"350","@width":"35","@height":"35"},{"@id":"83","@gid":"7","@x":"385","@y":"350","@width":"35","@height":"35"},{"@id":"84","@gid":"7","@x":"560","@y":"210","@width":"35","@height":"35"},{"@id":"85","@gid":"9","@x":"560","@y":"175","@width":"35","@height":"35"},{"@id":"86","@gid":"9","@x":"455","@y":"175","@width":"35","@height":"35"},{"@id":"87","@gid":"13","@x":"0","@y":"245","@width":"35","@height":"35"},{"@id":"88","@gid":"13","@x":"0","@y":"350","@width":"35","@height":"35"},{"@id":"89","@gid":"13","@x":"0","@y":"315","@width":"35","@height":"35"},{"@id":"90","@gid":"13","@x":"455","@y":"210","@width":"35","@height":"35"},{"@id":"91","@gid":"13","@x":"105","@y":"210","@width":"35","@height":"35"},{"@id":"92","@gid":"13","@x":"105","@y":"245","@width":"35","@height":"35"},{"@id":"93","@gid":"13","@x":"245","@y":"490","@width":"35","@height":"35"},{"@id":"94","@gid":"15","@x":"315","@y":"280","@width":"35","@height":"35"},{"@id":"95","@gid":"15","@x":"350","@y":"280","@width":"35","@height":"35"},{"@id":"96","@gid":"12","@x":"630","@y":"525","@width":"35","@height":"35"},{"@id":"97","@gid":"12","@x":"665","@y":"525","@width":"35","@height":"35"},{"@id":"98","@gid":"8","@x":"630","@y":"490","@width":"35","@height":"35"},{"@id":"99","@gid":"9","@x":"665","@y":"490","@width":"35","@height":"35"},{"@id":"100","@gid":"43","@x":"121","@y":"152","@width":"232","@height":"79",properties:{property:{"@name":"text","@value":"level_text_13"}}}]},{"@name":"active",object:[{"@id":"101","@gid":"30","@x":"385","@y":"490","@width":"60","@height":"56"},{"@id":"102","@gid":"25","@x":"525","@y":"198","@width":"32","@height":"22",properties:{property:[{"@name":"delay","@value":"0"},{"@name":"maxAngle","@value":"90"},{"@name":"minAngle","@value":"90"},{"@name":"speedX","@value":"0"}]}},{"@id":"103","@gid":"20","@x":"280","@y":"385","@width":"20","@height":"70","@rotation":"90"},{"@id":"104","@type":"6","@gid":"19","@x":"245","@y":"266","@width":"20","@height":"70","@rotation":"-90"},{"@id":"105","@type":"5","@gid":"21","@x":"630","@y":"370","@width":"70","@height":"19",properties:{property:[{"@name":"distanceY","@value":"210"},{"@name":"speedY","@value":"-45"}]}},{"@id":"106","@type":"2","@gid":"19","@x":"105","@y":"234","@width":"20","@height":"70","@rotation":"-90"},{"@id":"107","@type":"3","@gid":"17","@x":"215","@y":"456","@width":"24","@height":"11"},{"@id":"108","@gid":"35","@x":"206","@y":"172","@width":"35","@height":"35"},{"@id":"109","@type":"3","@gid":"19","@x":"272","@y":"280","@width":"20","@height":"70","@rotation":"180"},{"@id":"110","@type":"2","@gid":"17","@x":"146","@y":"246","@width":"24","@height":"11"},{"@id":"111","@gid":"20","@x":"347","@y":"489","@width":"20","@height":"70"},{"@id":"112","@type":"4","@gid":"19","@x":"352","@y":"212","@width":"20","@height":"70","@rotation":"90"},{"@id":"113","@type":"4","@gid":"17","@x":"287","@y":"245.5","@width":"24","@height":"11"},{"@id":"114","@type":"6","@gid":"17","@x":"419","@y":"319.5","@width":"24","@height":"11","@rotation":"90"},{"@id":"115","@gid":"27","@x":"317","@y":"332","@width":"31","@height":"34"},{"@id":"116","@gid":"27","@x":"20","@y":"99","@width":"31","@height":"34"},{"@id":"117","@gid":"27","@x":"495","@y":"255","@width":"31","@height":"34"},{"@id":"118","@type":"5","@gid":"18","@x":"38","@y":"351","@width":"25","@height":"19"},{"@id":"119","@gid":"42","@x":"280","@y":"490","@width":"35","@height":"35"},{"@id":"120","@gid":"3221225514","@x":"385.5","@y":"176.5","@width":"35","@height":"35"},{"@id":"121","@gid":"2147483690","@x":"383.5","@y":"211.5","@width":"35","@height":"35"}]},{"@name":"characters",object:[{"@id":"122","@gid":"24","@x":"86","@y":"484","@width":"44","@height":"52"},{"@id":"123","@gid":"28","@x":"630","@y":"350","@width":"63","@height":"50"}]},{"@name":"physics",object:[{"@id":"124","@x":"0","@y":"490","@width":"700","@height":"35"},{"@id":"125","@x":"630","@y":"455","@width":"70","@height":"35"},{"@id":"126","@x":"175","@y":"420","@width":"35","@height":"70"},{"@id":"127","@x":"210","@y":"455","@width":"35","@height":"35"},{"@id":"128","@x":"245","@y":"350","@width":"35","@height":"140"},{"@id":"129","@x":"350","@y":"385","@width":"245","@height":"35"},{"@id":"130","@x":"560","@y":"350","@width":"70","@height":"35"},{"@id":"131","@x":"0","@y":"350","@width":"105","@height":"35"},{"@id":"132","@x":"0","@y":"210","@width":"35","@height":"140"},{"@id":"133","@x":"0","@y":"175","@width":"70","@height":"35"},{"@id":"134","@x":"70","@y":"140","@width":"70","@height":"140"},{"@id":"135","@x":"35","@y":"245","@width":"175","@height":"35"},{"@id":"139","@x":"245","@y":"245","@width":"140","@height":"35"},{"@id":"140","@x":"385","@y":"245","@width":"35","@height":"105"},{"@id":"144","@x":"455","@y":"175","@width":"35","@height":"175"},{"@id":"145","@x":"455","@y":"140","@width":"175","@height":"35"},{"@id":"146","@x":"560","@y":"175","@width":"35","@height":"35"},{"@id":"147","@x":"420","@y":"140","@width":"35","@height":"70"},{"@id":"148","@x":"350","@y":"105","@width":"105","@height":"35"},{"@id":"149","@x":"350","@y":"140","@width":"35","@height":"105"},{"@id":"150","@x":"175","@y":"175","@width":"175","@height":"35"},{"@id":"151","@x":"315","@y":"210","@width":"35","@height":"35"}]}]},{"@level":"13","@version":"1.0","@orientation":"orthogonal","@renderorder":"right-down","@width":"20","@height":"15","@tilewidth":"35","@tileheight":"35",tileset:[{"@firstgid":"1","@name":"tiles","@tilewidth":"35","@tileheight":"35",tile:[{"@id":"0",image:{"@width":"35","@height":"35","@source":"tiles/singleTile.png"}},{"@id":"1",image:{"@width":"35","@height":"35","@source":"tiles/platformLeft.png"}},{"@id":"2",image:{"@width":"35","@height":"35","@source":"tiles/platformCenter.png"}},{"@id":"3",image:{"@width":"35","@height":"35","@source":"tiles/platformRight.png"}},{"@id":"4",image:{"@width":"35","@height":"35","@source":"tiles/verticalPlatformTop.png"}},{"@id":"5",image:{"@width":"35","@height":"35","@source":"tiles/verticalPlatformCenter.png"}},{"@id":"6",image:{"@width":"35","@height":"35","@source":"tiles/verticalPlatformBottom.png"}},{"@id":"7",image:{"@width":"35","@height":"35","@source":"tiles/tileTopLeft.png"}},{"@id":"8",image:{"@width":"35","@height":"35","@source":"tiles/tileTopCenter.png"}},{"@id":"9",image:{"@width":"35","@height":"35","@source":"tiles/tileTopRight.png"}},{"@id":"10",image:{"@width":"35","@height":"35","@source":"tiles/tileCenterLeft.png"}},{"@id":"11",image:{"@width":"35","@height":"35","@source":"tiles/tileCenter.png"}},{"@id":"12",image:{"@width":"35","@height":"35","@source":"tiles/tileCenterRight.png"}},{"@id":"13",image:{"@width":"35","@height":"35","@source":"tiles/tileBottomLeft.png"}},{"@id":"14",image:{"@width":"35","@height":"35","@source":"tiles/tileBottomCenter.png"}},{"@id":"15",image:{"@width":"35","@height":"35","@source":"tiles/tileBottomRight.png"}}]},{"@firstgid":"17","@name":"active","@tilewidth":"105","@tileheight":"70",tile:[{"@id":"0",image:{"@width":"24","@height":"11","@source":"active/PushButtonGraphics.png"}},{"@id":"1",image:{"@width":"25","@height":"19","@source":"active/TriggerGraphics.png"}},{"@id":"2",image:{"@width":"20","@height":"70","@source":"active/DoorGraphics.png"}},{"@id":"3",image:{"@width":"20","@height":"70","@source":"active/GlassDoorGraphics.png"}},{"@id":"4",image:{"@width":"70","@height":"19","@source":"active/ElevatorGraphics.png"}},{"@id":"5",image:{"@width":"105","@height":"20","@source":"active/BigElevatorGraphics.png"}},{"@id":"6",image:{"@width":"70","@height":"70","@source":"active/ExitGraphics.png"}},{"@id":"7",image:{"@width":"44","@height":"52","@source":"characters/HustlerGraphics.png"}},{"@id":"8",image:{"@width":"32","@height":"22","@source":"active/CameraGraphics.png"}},{"@id":"9",image:{"@width":"15","@height":"15","@source":"characters/EnemyLimiterGraphics.png"}},{"@id":"10",image:{"@width":"31","@height":"34","@source":"passive/MoneyBagGraphics.png"}},{"@id":"11",image:{"@width":"63","@height":"50","@source":"characters/DogGraphics.png"}},{"@id":"12",image:{"@width":"60","@height":"55","@source":"characters/Prisoner2Graphics.png"}},{"@id":"13",image:{"@width":"60","@height":"56","@source":"characters/PrisonerGraphics.png"}}]},{"@firstgid":"31","@name":"passive","@tilewidth":"210","@tileheight":"50",tile:[{"@id":"0",image:{"@width":"50","@height":"50","@source":"passive/BigBoxGraphics.png"}},{"@id":"1",image:{"@width":"35","@height":"35","@source":"passive/BoxGraphics.png"}},{"@id":"2",image:{"@width":"37","@height":"35","@source":"passive/ToiletGraphics.png"}},{"@id":"3",image:{"@width":"35","@height":"35","@source":"passive/MonitorGraphics.png"}},{"@id":"4",image:{"@width":"35","@height":"35","@source":"passive/BasketBallGraphics.png"}},{"@id":"5",image:{"@width":"35","@height":"35","@source":"passive/StoolGraphics.png"}},{"@id":"6",image:{"@width":"150","@height":"20","@source":"passive/PlankGraphics.png"}},{"@id":"7",image:{"@width":"150","@height":"20","@source":"passive/Plank2Graphics.png"}},{"@id":"8",image:{"@width":"210","@height":"20","@source":"passive/BigPlankGraphics.png"}},{"@id":"9",image:{"@width":"100","@height":"20","@source":"passive/Plank5Graphics.png"}},{"@id":"10",image:{"@width":"150","@height":"20","@source":"passive/Plank2Graphics.png"}},{"@id":"11",image:{"@width":"35","@height":"35","@source":"passive/MirrorGraphics.png"}}]},{"@firstgid":"43","@name":"decor","@tilewidth":"232","@tileheight":"136",tile:[{"@id":"0",image:{"@width":"232","@height":"79","@source":"decor/LevelTextGraphics.png"}},{"@id":"1",image:{"@width":"54","@height":"20","@source":"decor/Decor1Graphics.png"}},{"@id":"2",image:{"@width":"54","@height":"20","@source":"decor/Decor2Graphics.png"}},{"@id":"3",image:{"@width":"33","@height":"27","@source":"decor/Decor3Graphics.png"}},{"@id":"4",image:{"@width":"34","@height":"25","@source":"decor/Decor4Graphics.png"}},{"@id":"5",image:{"@width":"22","@height":"31","@source":"decor/Decor5Graphics.png"}},{"@id":"6",image:{"@width":"126","@height":"59","@source":"decor/Decor6Graphics.png"}},{"@id":"7",image:{"@width":"25","@height":"21","@source":"decor/Decor8Graphics.png"}},{"@id":"8",image:{"@width":"18","@height":"22","@source":"decor/Decor9Graphics.png"}},{"@id":"9",image:{"@width":"35","@height":"58","@source":"decor/Decor10Graphics.png"}},{"@id":"10",image:{"@width":"19","@height":"66","@source":"decor/Decor11Graphics.png"}},{"@id":"11",image:{"@width":"23","@height":"33","@source":"decor/Decor12Graphics.png"}},{"@id":"12",image:{"@width":"38","@height":"26","@source":"decor/Decor13Graphics.png"}},{"@id":"13",image:{"@width":"43","@height":"78","@source":"decor/Decor14Graphics.png"}},{"@id":"14",image:{"@width":"60","@height":"86","@source":"decor/Decor15Graphics.png"}},{"@id":"15",image:{"@width":"41","@height":"69","@source":"decor/Decor16Graphics.png"}},{"@id":"16",image:{"@width":"55","@height":"58","@source":"decor/Decor17Graphics.png"}},{"@id":"17",image:{"@width":"57","@height":"54","@source":"decor/Decor18Graphics.png"}},{"@id":"18",image:{"@width":"18","@height":"45","@source":"decor/Decor19Graphics.png"}},{"@id":"19",image:{"@width":"41","@height":"49","@source":"decor/Decor20Graphics.png"}},{"@id":"20",image:{"@width":"51","@height":"38","@source":"decor/Decor21Graphics.png"}},{"@id":"21",image:{"@width":"54","@height":"54","@source":"decor/Decor22Graphics.png"}},{"@id":"22",image:{"@width":"63","@height":"136","@source":"decor/Decor23Graphics.png"}},{"@id":"23",image:{"@width":"21","@height":"39","@source":"decor/Decor24Graphics.png"}},{"@id":"24",image:{"@width":"104","@height":"50","@source":"decor/Decor25Graphics.png"}},{"@id":"25",image:{"@width":"104","@height":"46","@source":"decor/Decor26Graphics.png"}},{"@id":"26",image:{"@width":"86","@height":"38","@source":"decor/Decor27Graphics.png"}},{"@id":"27",image:{"@width":"63","@height":"55","@source":"decor/Decor28Graphics.png"}},{"@id":"28",image:{"@width":"13","@height":"23","@source":"decor/Decor29Graphics.png"}},{"@id":"29",image:{"@width":"28","@height":"40","@source":"decor/Decor30Graphics.png"}},{"@id":"30",image:{"@width":"69","@height":"30","@source":"decor/Decor31Graphics.png"}},{"@id":"31",image:{"@width":"33","@height":"29","@source":"decor/Decor32Graphics.png"}},{"@id":"32",image:{"@width":"42","@height":"42","@source":"decor/Decor33Graphics.png"}},{"@id":"33",image:{"@width":"60","@height":"66","@source":"decor/Decor34Graphics.png"}},{"@id":"34",image:{"@width":"46","@height":"65","@source":"decor/Decor35Graphics.png"}},{"@id":"35",image:{"@width":"71","@height":"55","@source":"decor/Decor36Graphics.png"}},{"@id":"36",image:{"@width":"35","@height":"55","@source":"decor/Decor37Graphics.png"}},{"@id":"37",image:{"@width":"28","@height":"29","@source":"decor/Decor38Graphics.png"}},{"@id":"38",image:{"@width":"38","@height":"37","@source":"decor/Decor39Graphics.png"}},{"@id":"39",image:{"@width":"103","@height":"50","@source":"decor/Decor40Graphics.png"}},{"@id":"40",image:{"@width":"56","@height":"55","@source":"decor/Decor41Graphics.png"}},{"@id":"41",image:{"@width":"71","@height":"50","@source":"decor/Decor42Graphics.png"}},{"@id":"42",image:{"@width":"200","@height":"44","@source":"decor/TxtGraphics.png"}}]}],imagelayer:{"@name":"background",image:{"@source":"bg/Background1Graphics.png"}},objectgroup:[{"@name":"decorations",object:[{"@gid":"43","@x":"333","@y":"445","@width":"232","@height":"79",properties:{property:{"@name":"text","@value":"level_text_14"}}},{"@gid":"44","@x":"105","@y":"372"},{"@gid":"47","@x":"420","@y":"245"},{"@gid":"62","@x":"175","@y":"280"},{"@gid":"68","@x":"84","@y":"486"},{"@gid":"78","@x":"280","@y":"315"},{"@gid":"81","@x":"35","@y":"455"},{"@gid":"76","@x":"490","@y":"175"},{"@gid":"52","@x":"648","@y":"455"},{"@gid":"64","@x":"385","@y":"140"}]},{"@name":"tiles",object:[{"@gid":"12","@x":"280","@y":"210","@width":"35","@height":"35"},{"@gid":"12","@x":"455","@y":"210","@width":"35","@height":"35"},{"@gid":"12","@x":"560","@y":"525","@width":"35","@height":"35"},{"@gid":"12","@x":"595","@y":"525","@width":"35","@height":"35"},{"@gid":"9","@x":"525","@y":"525","@width":"35","@height":"35"},{"@gid":"9","@x":"490","@y":"525","@width":"35","@height":"35"},{"@gid":"9","@x":"455","@y":"525","@width":"35","@height":"35"},{"@gid":"9","@x":"420","@y":"525","@width":"35","@height":"35"},{"@gid":"9","@x":"385","@y":"525","@width":"35","@height":"35"},{"@gid":"9","@x":"350","@y":"525","@width":"35","@height":"35"},{"@gid":"9","@x":"315","@y":"525","@width":"35","@height":"35"},{"@gid":"9","@x":"280","@y":"525","@width":"35","@height":"35"},{"@gid":"9","@x":"245","@y":"525","@width":"35","@height":"35"},{"@gid":"9","@x":"210","@y":"525","@width":"35","@height":"35"},{"@gid":"9","@x":"175","@y":"525","@width":"35","@height":"35"},{"@gid":"9","@x":"140","@y":"525","@width":"35","@height":"35"},{"@gid":"9","@x":"105","@y":"525","@width":"35","@height":"35"},{"@gid":"9","@x":"70","@y":"525","@width":"35","@height":"35"},{"@gid":"9","@x":"35","@y":"525","@width":"35","@height":"35"},{"@gid":"9","@x":"0","@y":"525","@width":"35","@height":"35"},{"@gid":"9","@x":"630","@y":"525","@width":"35","@height":"35"},{"@gid":"9","@x":"665","@y":"525","@width":"35","@height":"35"},{"@gid":"8","@x":"560","@y":"490","@width":"35","@height":"35"},{"@gid":"10","@x":"595","@y":"490","@width":"35","@height":"35"},{"@gid":"7","@x":"210","@y":"455","@width":"35","@height":"35"},{"@gid":"8","@x":"210","@y":"420","@width":"35","@height":"35"},{"@gid":"8","@x":"315","@y":"350","@width":"35","@height":"35"},{"@gid":"8","@x":"245","@y":"70","@width":"35","@height":"35"},{"@gid":"10","@x":"0","@y":"315","@width":"35","@height":"35"},{"@gid":"10","@x":"595","@y":"210","@width":"35","@height":"35"},{"@gid":"10","@x":"105","@y":"175","@width":"35","@height":"35"},{"@gid":"4","@x":"455","@y":"350","@width":"35","@height":"35"},{"@gid":"3","@x":"350","@y":"350","@width":"35","@height":"35"},{"@gid":"3","@x":"385","@y":"350","@width":"35","@height":"35"},{"@gid":"3","@x":"420","@y":"350","@width":"35","@height":"35"},{"@gid":"3","@x":"280","@y":"420","@width":"35","@height":"35"},{"@gid":"3","@x":"245","@y":"420","@width":"35","@height":"35"},{"@gid":"16","@x":"315","@y":"420","@width":"35","@height":"35"},{"@gid":"6","@x":"315","@y":"385","@width":"35","@height":"35"},{"@gid":"6","@x":"245","@y":"140","@width":"35","@height":"35"},{"@gid":"6","@x":"245","@y":"175","@width":"35","@height":"35"},{"@gid":"6","@x":"595","@y":"245","@width":"35","@height":"35"},{"@gid":"6","@x":"595","@y":"280","@width":"35","@height":"35"},{"@gid":"6","@x":"595","@y":"315","@width":"35","@height":"35"},{"@gid":"2","@x":"560","@y":"350","@width":"35","@height":"35"},{"@gid":"2","@x":"420","@y":"210","@width":"35","@height":"35"},{"@gid":"4","@x":"245","@y":"350","@width":"35","@height":"35"},{"@gid":"4","@x":"140","@y":"210","@width":"35","@height":"35"},{"@gid":"14","@x":"245","@y":"210","@width":"35","@height":"35"},{"@gid":"3","@x":"210","@y":"350","@width":"35","@height":"35"},{"@gid":"3","@x":"175","@y":"350","@width":"35","@height":"35"},{"@gid":"3","@x":"140","@y":"350","@width":"35","@height":"35"},{"@gid":"3","@x":"105","@y":"350","@width":"35","@height":"35"},{"@gid":"3","@x":"70","@y":"350","@width":"35","@height":"35"},{"@gid":"3","@x":"35","@y":"350","@width":"35","@height":"35"},{"@gid":"15","@x":"0","@y":"350","@width":"35","@height":"35"},{"@gid":"3","@x":"70","@y":"175","@width":"35","@height":"35"},{"@gid":"3","@x":"35","@y":"175","@width":"35","@height":"35"},{"@gid":"3","@x":"0","@y":"175","@width":"35","@height":"35"},{"@gid":"7","@x":"105","@y":"245","@width":"35","@height":"35"},{"@gid":"7","@x":"455","@y":"245","@width":"35","@height":"35"},{"@gid":"5","@x":"455","@y":"175","@width":"35","@height":"35"},{"@gid":"3","@x":"490","@y":"210","@width":"35","@height":"35"},{"@gid":"3","@x":"525","@y":"210","@width":"35","@height":"35"},{"@gid":"3","@x":"560","@y":"210","@width":"35","@height":"35"},{"@gid":"11","@x":"105","@y":"210","@width":"35","@height":"35"},{"@gid":"16","@x":"595","@y":"350","@width":"35","@height":"35"},{"@gid":"14","@x":"315","@y":"245","@width":"35","@height":"35"},{"@gid":"16","@x":"350","@y":"245","@width":"35","@height":"35"},{"@gid":"10","@x":"350","@y":"210","@width":"35","@height":"35"},{"@gid":"9","@x":"315","@y":"210","@width":"35","@height":"35"},{"@gid":"3","@x":"280","@y":"210","@width":"35","@height":"35"},{"@gid":"16","@x":"315","@y":"70","@width":"35","@height":"35"},{"@gid":"3","@x":"280","@y":"70","@width":"35","@height":"35"},{"@gid":"6","@x":"315","@y":"35","@width":"35","@height":"35"},{"@gid":"6","@x":"245","@y":"105","@width":"35","@height":"35"}]},{"@name":"active",object:[{"@gid":"30","@x":"276","@y":"315","@width":"60","@height":"56",properties:{property:[{"@name":"limitLeft","@value":"0"},{"@name":"limitRight","@value":"50"}]}},{"@gid":"25","@x":"246","@y":"232","@width":"32","@height":"22",properties:{property:[{"@name":"delay","@value":"0"},{"@name":"maxAngle","@value":"90"},{"@name":"minAngle","@value":"90"},{"@name":"speedX","@value":"0"}]}},{"@type":"2","@gid":"19","@x":"245","@y":"196","@width":"20","@height":"70","@rotation":"-90"},{"@type":"6","@gid":"19","@x":"246","@y":"315","@width":"20","@height":"70","@rotation":"90"},{"@type":"3","@gid":"17","@x":"410","@y":"317","@width":"24","@height":"11"},{"@type":"3","@gid":"19","@x":"379","@y":"174","@width":"20","@height":"70","@rotation":"180"},{"@type":"5","@gid":"17","@x":"6","@y":"282","@width":"24","@height":"11"},{"@type":"4","@gid":"19","@x":"463","@y":"315","@width":"20","@height":"70"},{"@type":"5","@gid":"21","@x":"489","@y":"334.5","@width":"70","@height":"19",properties:{property:[{"@name":"distanceY","@value":"140"},{"@name":"speedY","@value":"45"}]}},{"@type":"6","@gid":"21","@x":"631","@y":"473.5","@width":"70","@height":"19",properties:{property:[{"@name":"distanceY","@value":"280"},{"@name":"speedY","@value":"-45"}]}},{"@type":"2","@gid":"17","@x":"18","@y":"491.5","@width":"24","@height":"11"},{"@gid":"27","@x":"29","@y":"234","@width":"31","@height":"34"},{"@gid":"27","@x":"530","@y":"90","@width":"31","@height":"34"},{"@gid":"27","@x":"513","@y":"272","@width":"31","@height":"34"},{"@type":"6","@gid":"17","@x":"566","@y":"316.5","@width":"24","@height":"11"},{"@type":"4","@gid":"18","@x":"292","@y":"176","@width":"25","@height":"19"},{"@gid":"32","@x":"236","@y":"387","@width":"35","@height":"35"},{"@gid":"30","@x":"104","@y":"491","@width":"60","@height":"56",properties:{property:[{"@name":"limitLeft","@value":"50"},{"@name":"limitRight","@value":"25"}]}},{"@type":"3","@gid":"19","@x":"111","@y":"315","@width":"20","@height":"70"}]},{"@name":"characters",object:[{"@gid":"24","@x":"73","@y":"141","@width":"44","@height":"52"},{"@gid":"28","@x":"437.5","@y":"488","@width":"63","@height":"50"}]},{"@name":"physics",object:[{"@x":"0","@y":"490","@width":"700","@height":"35"},{"@x":"560","@y":"455","@width":"70","@height":"35"},{"@x":"210","@y":"420","@width":"35","@height":"35"},{"@x":"210","@y":"385","@width":"140","@height":"35"},{"@x":"315","@y":"350","@width":"35","@height":"35"},{"@x":"315","@y":"315","@width":"175","@height":"35"},{"@x":"0","@y":"315","@width":"280","@height":"35"},{"@x":"0","@y":"280","@width":"35","@height":"35"},{"@x":"560","@y":"315","@width":"35","@height":"35"},{"@x":"595","@y":"210","@width":"35","@height":"140"},{"@x":"420","@y":"175","@width":"210","@height":"35"},{"@x":"455","@y":"140","@width":"35","@height":"105"},{"@x":"245","@y":"175","@width":"140","@height":"35"},{"@x":"315","@y":"210","@width":"70","@height":"35"},{"@x":"245","@y":"35","@width":"35","@height":"140"},{"@x":"280","@y":"35","@width":"70","@height":"35"},{"@x":"315","@y":"0","@width":"35","@height":"35"},{"@x":"0","@y":"140","@width":"140","@height":"35"},{"@x":"105","@y":"175","@width":"70","@height":"35"},{"@x":"105","@y":"210","@width":"35","@height":"35"}]}]},{"@level":"14","@version":"1.0","@orientation":"orthogonal","@renderorder":"right-down","@width":"20","@height":"15","@tilewidth":"35","@tileheight":"35","@nextobjectid":"168",tileset:[{"@firstgid":"1","@name":"tiles","@tilewidth":"35","@tileheight":"35","@tilecount":"16",tile:[{"@id":"0",image:{"@width":"35","@height":"35","@source":"tiles/singleTile.png"}},{"@id":"1",image:{"@width":"35","@height":"35","@source":"tiles/platformLeft.png"}},{"@id":"2",image:{"@width":"35","@height":"35","@source":"tiles/platformCenter.png"}},{"@id":"3",image:{"@width":"35","@height":"35","@source":"tiles/platformRight.png"}},{"@id":"4",image:{"@width":"35","@height":"35","@source":"tiles/verticalPlatformTop.png"}},{"@id":"5",image:{"@width":"35","@height":"35","@source":"tiles/verticalPlatformCenter.png"}},{"@id":"6",image:{"@width":"35","@height":"35","@source":"tiles/verticalPlatformBottom.png"}},{"@id":"7",image:{"@width":"35","@height":"35","@source":"tiles/tileTopLeft.png"}},{"@id":"8",image:{"@width":"35","@height":"35","@source":"tiles/tileTopCenter.png"}},{"@id":"9",image:{"@width":"35","@height":"35","@source":"tiles/tileTopRight.png"}},{"@id":"10",image:{"@width":"35","@height":"35","@source":"tiles/tileCenterLeft.png"}},{"@id":"11",image:{"@width":"35","@height":"35","@source":"tiles/tileCenter.png"}},{"@id":"12",image:{"@width":"35","@height":"35","@source":"tiles/tileCenterRight.png"}},{"@id":"13",image:{"@width":"35","@height":"35","@source":"tiles/tileBottomLeft.png"}},{"@id":"14",image:{"@width":"35","@height":"35","@source":"tiles/tileBottomCenter.png"}},{"@id":"15",image:{"@width":"35","@height":"35","@source":"tiles/tileBottomRight.png"}}]},{"@firstgid":"17","@name":"active","@tilewidth":"105","@tileheight":"70","@tilecount":"14",tile:[{"@id":"0",image:{"@width":"24","@height":"11","@source":"active/PushButtonGraphics.png"}},{"@id":"1",image:{"@width":"25","@height":"19","@source":"active/TriggerGraphics.png"}},{"@id":"2",image:{"@width":"20","@height":"70","@source":"active/DoorGraphics.png"}},{"@id":"3",image:{"@width":"20","@height":"70","@source":"active/GlassDoorGraphics.png"}},{"@id":"4",image:{"@width":"70","@height":"19","@source":"active/ElevatorGraphics.png"}},{"@id":"5",image:{"@width":"105","@height":"20","@source":"active/BigElevatorGraphics.png"}},{"@id":"6",image:{"@width":"70","@height":"70","@source":"active/ExitGraphics.png"}},{"@id":"7",image:{"@width":"44","@height":"52","@source":"characters/HustlerGraphics.png"}},{"@id":"8",image:{"@width":"32","@height":"22","@source":"active/CameraGraphics.png"}},{"@id":"9",image:{"@width":"15","@height":"15","@source":"characters/EnemyLimiterGraphics.png"}},{"@id":"10",image:{"@width":"31","@height":"34","@source":"passive/MoneyBagGraphics.png"}},{"@id":"11",image:{"@width":"63","@height":"50","@source":"characters/DogGraphics.png"}},{"@id":"12",image:{"@width":"60","@height":"55","@source":"characters/Prisoner2Graphics.png"}},{"@id":"13",image:{"@width":"60","@height":"56","@source":"characters/PrisonerGraphics.png"}}]},{"@firstgid":"31","@name":"passive","@tilewidth":"210","@tileheight":"50","@tilecount":"12",tile:[{"@id":"0",image:{"@width":"50","@height":"50","@source":"passive/BigBoxGraphics.png"}},{"@id":"1",image:{"@width":"35","@height":"35","@source":"passive/BoxGraphics.png"}},{"@id":"2",image:{"@width":"37","@height":"35","@source":"passive/ToiletGraphics.png"}},{"@id":"3",image:{"@width":"35","@height":"35","@source":"passive/MonitorGraphics.png"}},{"@id":"4",image:{"@width":"35","@height":"35","@source":"passive/BasketBallGraphics.png"}},{"@id":"5",image:{"@width":"35","@height":"35","@source":"passive/StoolGraphics.png"}},{"@id":"6",image:{"@width":"150","@height":"20","@source":"passive/PlankGraphics.png"}},{"@id":"7",image:{"@width":"150","@height":"20","@source":"passive/Plank2Graphics.png"}},{"@id":"8",image:{"@width":"210","@height":"20","@source":"passive/BigPlankGraphics.png"}},{"@id":"9",image:{"@width":"100","@height":"20","@source":"passive/Plank5Graphics.png"}},{"@id":"10",image:{"@width":"150","@height":"20","@source":"passive/Plank2Graphics.png"}},{"@id":"11",image:{"@width":"35","@height":"35","@source":"passive/MirrorGraphics.png"}}]},{"@firstgid":"43","@name":"decor","@tilewidth":"232","@tileheight":"136","@tilecount":"43",tile:[{"@id":"0",image:{"@width":"232","@height":"79","@source":"decor/LevelTextGraphics.png"}},{"@id":"1",image:{"@width":"54","@height":"20","@source":"decor/Decor1Graphics.png"}},{"@id":"2",image:{"@width":"54","@height":"20","@source":"decor/Decor2Graphics.png"}},{"@id":"3",image:{"@width":"33","@height":"27","@source":"decor/Decor3Graphics.png"}},{"@id":"4",image:{"@width":"34","@height":"25","@source":"decor/Decor4Graphics.png"}},{"@id":"5",image:{"@width":"22","@height":"31","@source":"decor/Decor5Graphics.png"}},{"@id":"6",image:{"@width":"126","@height":"59","@source":"decor/Decor6Graphics.png"}},{"@id":"7",image:{"@width":"25","@height":"21","@source":"decor/Decor8Graphics.png"}},{"@id":"8",image:{"@width":"18","@height":"22","@source":"decor/Decor9Graphics.png"}},{"@id":"9",image:{"@width":"35","@height":"58","@source":"decor/Decor10Graphics.png"}},{"@id":"10",image:{"@width":"19","@height":"66","@source":"decor/Decor11Graphics.png"}},{"@id":"11",image:{"@width":"23","@height":"33","@source":"decor/Decor12Graphics.png"}},{"@id":"12",image:{"@width":"38","@height":"26","@source":"decor/Decor13Graphics.png"}},{"@id":"13",image:{"@width":"43","@height":"78","@source":"decor/Decor14Graphics.png"}},{"@id":"14",image:{"@width":"60","@height":"86","@source":"decor/Decor15Graphics.png"}},{"@id":"15",image:{"@width":"41","@height":"69","@source":"decor/Decor16Graphics.png"}},{"@id":"16",image:{"@width":"55","@height":"58","@source":"decor/Decor17Graphics.png"}},{"@id":"17",image:{"@width":"57","@height":"54","@source":"decor/Decor18Graphics.png"}},{"@id":"18",image:{"@width":"18","@height":"45","@source":"decor/Decor19Graphics.png"}},{"@id":"19",image:{"@width":"41","@height":"49","@source":"decor/Decor20Graphics.png"}},{"@id":"20",image:{"@width":"51","@height":"38","@source":"decor/Decor21Graphics.png"}},{"@id":"21",image:{"@width":"54","@height":"54","@source":"decor/Decor22Graphics.png"}},{"@id":"22",image:{"@width":"63","@height":"136","@source":"decor/Decor23Graphics.png"}},{"@id":"23",image:{"@width":"21","@height":"39","@source":"decor/Decor24Graphics.png"}},{"@id":"24",image:{"@width":"104","@height":"50","@source":"decor/Decor25Graphics.png"}},{"@id":"25",image:{"@width":"104","@height":"46","@source":"decor/Decor26Graphics.png"}},{"@id":"26",image:{"@width":"86","@height":"38","@source":"decor/Decor27Graphics.png"}},{"@id":"27",image:{"@width":"63","@height":"55","@source":"decor/Decor28Graphics.png"}},{"@id":"28",image:{"@width":"13","@height":"23","@source":"decor/Decor29Graphics.png"}},{"@id":"29",image:{"@width":"28","@height":"40","@source":"decor/Decor30Graphics.png"}},{"@id":"30",image:{"@width":"69","@height":"30","@source":"decor/Decor31Graphics.png"}},{"@id":"31",image:{"@width":"33","@height":"29","@source":"decor/Decor32Graphics.png"}},{"@id":"32",image:{"@width":"42","@height":"42","@source":"decor/Decor33Graphics.png"}},{"@id":"33",image:{"@width":"60","@height":"66","@source":"decor/Decor34Graphics.png"}},{"@id":"34",image:{"@width":"46","@height":"65","@source":"decor/Decor35Graphics.png"}},{"@id":"35",image:{"@width":"71","@height":"55","@source":"decor/Decor36Graphics.png"}},{"@id":"36",image:{"@width":"35","@height":"55","@source":"decor/Decor37Graphics.png"}},{"@id":"37",image:{"@width":"28","@height":"29","@source":"decor/Decor38Graphics.png"}},{"@id":"38",image:{"@width":"38","@height":"37","@source":"decor/Decor39Graphics.png"}},{"@id":"39",image:{"@width":"103","@height":"50","@source":"decor/Decor40Graphics.png"}},{"@id":"40",image:{"@width":"56","@height":"55","@source":"decor/Decor41Graphics.png"}},{"@id":"41",image:{"@width":"71","@height":"50","@source":"decor/Decor42Graphics.png"}},{"@id":"42",image:{"@width":"200","@height":"44","@source":"decor/TxtGraphics.png"}}]}],imagelayer:{"@name":"background",image:{"@source":"bg/Background1Graphics.png"}},objectgroup:[{"@name":"decorations",object:[{"@id":"1","@gid":"43","@x":"35","@y":"175","@width":"232","@height":"79",properties:{property:{"@name":"text","@value":"level_text_15"}}},{"@id":"2","@gid":"44","@x":"321","@y":"160","@width":"54","@height":"20"},{"@id":"3","@gid":"56","@x":"609","@y":"385","@width":"43","@height":"78"},{"@id":"4","@gid":"57","@x":"84","@y":"454","@width":"60","@height":"86"},{"@id":"5","@gid":"69","@x":"385","@y":"350","@width":"86","@height":"38"},{"@id":"6","@gid":"71","@x":"490","@y":"350","@width":"13","@height":"23"},{"@id":"7","@gid":"84","@x":"189","@y":"347","@width":"71","@height":"50"},{"@id":"8","@gid":"55","@x":"35","@y":"260","@width":"38","@height":"26"},{"@id":"9","@gid":"49","@x":"323","@y":"447","@width":"126","@height":"59"},{"@id":"10","@gid":"50","@x":"467","@y":"200","@width":"25","@height":"21"}]},{"@name":"tiles",object:[{"@id":"11","@gid":"9","@x":"490","@y":"490","@width":"35","@height":"35"},{"@id":"12","@gid":"9","@x":"455","@y":"490","@width":"35","@height":"35"},{"@id":"13","@gid":"9","@x":"385","@y":"490","@width":"35","@height":"35"},{"@id":"14","@gid":"9","@x":"420","@y":"490","@width":"35","@height":"35"},{"@id":"15","@gid":"9","@x":"280","@y":"490","@width":"35","@height":"35"},{"@id":"16","@gid":"9","@x":"245","@y":"490","@width":"35","@height":"35"},{"@id":"17","@gid":"9","@x":"210","@y":"490","@width":"35","@height":"35"},{"@id":"18","@gid":"12","@x":"35","@y":"525","@width":"35","@height":"35"},{"@id":"19","@gid":"12","@x":"0","@y":"490","@width":"35","@height":"35"},{"@id":"20","@gid":"12","@x":"0","@y":"455","@width":"35","@height":"35"},{"@id":"21","@gid":"12","@x":"0","@y":"525","@width":"35","@height":"35"},{"@id":"22","@gid":"12","@x":"490","@y":"280","@width":"35","@height":"35"},{"@id":"23","@gid":"12","@x":"140","@y":"245","@width":"35","@height":"35"},{"@id":"24","@gid":"12","@x":"140","@y":"525","@width":"35","@height":"35"},{"@id":"25","@gid":"12","@x":"175","@y":"525","@width":"35","@height":"35"},{"@id":"26","@gid":"12","@x":"665","@y":"525","@width":"35","@height":"35"},{"@id":"27","@gid":"12","@x":"525","@y":"280","@width":"35","@height":"35"},{"@id":"28","@gid":"12","@x":"0","@y":"420","@width":"35","@height":"35"},{"@id":"29","@gid":"12","@x":"560","@y":"525","@width":"35","@height":"35"},{"@id":"30","@gid":"12","@x":"245","@y":"525","@width":"35","@height":"35"},{"@id":"31","@gid":"12","@x":"350","@y":"525","@width":"35","@height":"35"},{"@id":"32","@gid":"12","@x":"210","@y":"525","@width":"35","@height":"35"},{"@id":"33","@gid":"12","@x":"280","@y":"525","@width":"35","@height":"35"},{"@id":"34","@gid":"12","@x":"315","@y":"525","@width":"35","@height":"35"},{"@id":"35","@gid":"12","@x":"490","@y":"525","@width":"35","@height":"35"},{"@id":"36","@gid":"12","@x":"420","@y":"525","@width":"35","@height":"35"},{"@id":"37","@gid":"12","@x":"455","@y":"525","@width":"35","@height":"35"},{"@id":"38","@gid":"12","@x":"525","@y":"525","@width":"35","@height":"35"},{"@id":"39","@gid":"12","@x":"385","@y":"525","@width":"35","@height":"35"},{"@id":"40","@gid":"9","@x":"525","@y":"490","@width":"35","@height":"35"},{"@id":"41","@gid":"9","@x":"350","@y":"490","@width":"35","@height":"35"},{"@id":"42","@gid":"9","@x":"315","@y":"490","@width":"35","@height":"35"},{"@id":"43","@gid":"9","@x":"175","@y":"490","@width":"35","@height":"35"},{"@id":"44","@gid":"9","@x":"70","@y":"525","@width":"35","@height":"35"},{"@id":"45","@gid":"9","@x":"105","@y":"525","@width":"35","@height":"35"},{"@id":"46","@gid":"9","@x":"595","@y":"525","@width":"35","@height":"35"},{"@id":"47","@gid":"9","@x":"630","@y":"525","@width":"35","@height":"35"},{"@id":"48","@gid":"10","@x":"560","@y":"490","@width":"35","@height":"35"},{"@id":"49","@gid":"8","@x":"140","@y":"490","@width":"35","@height":"35"},{"@id":"50","@gid":"8","@x":"140","@y":"385","@width":"35","@height":"35"},{"@id":"51","@gid":"8","@x":"455","@y":"245","@width":"35","@height":"35"},{"@id":"52","@gid":"8","@x":"140","@y":"210","@width":"35","@height":"35"},{"@id":"53","@gid":"8","@x":"105","@y":"280","@width":"35","@height":"35"},{"@id":"54","@gid":"10","@x":"35","@y":"385","@width":"35","@height":"35"},{"@id":"55","@gid":"10","@x":"560","@y":"245","@width":"35","@height":"35"},{"@id":"56","@gid":"10","@x":"175","@y":"210","@width":"35","@height":"35"},{"@id":"57","@gid":"10","@x":"0","@y":"175","@width":"35","@height":"35"},{"@id":"58","@gid":"13","@x":"35","@y":"490","@width":"35","@height":"35"},{"@id":"59","@gid":"13","@x":"35","@y":"455","@width":"35","@height":"35"},{"@id":"60","@gid":"13","@x":"35","@y":"420","@width":"35","@height":"35"},{"@id":"61","@gid":"13","@x":"385","@y":"245","@width":"35","@height":"35"},{"@id":"62","@gid":"13","@x":"560","@y":"280","@width":"35","@height":"35"},{"@id":"63","@gid":"13","@x":"560","@y":"315","@width":"35","@height":"35"},{"@id":"64","@gid":"13","@x":"140","@y":"280","@width":"35","@height":"35"},{"@id":"65","@gid":"11","@x":"665","@y":"490","@width":"35","@height":"35"},{"@id":"66","@gid":"11","@x":"665","@y":"455","@width":"35","@height":"35"},{"@id":"67","@gid":"11","@x":"665","@y":"420","@width":"35","@height":"35"},{"@id":"68","@gid":"11","@x":"665","@y":"385","@width":"35","@height":"35"},{"@id":"69","@gid":"11","@x":"665","@y":"350","@width":"35","@height":"35"},{"@id":"70","@gid":"11","@x":"665","@y":"315","@width":"35","@height":"35"},{"@id":"71","@gid":"11","@x":"665","@y":"280","@width":"35","@height":"35"},{"@id":"72","@gid":"11","@x":"665","@y":"245","@width":"35","@height":"35"},{"@id":"73","@gid":"11","@x":"665","@y":"210","@width":"35","@height":"35"},{"@id":"74","@gid":"11","@x":"665","@y":"175","@width":"35","@height":"35"},{"@id":"75","@gid":"9","@x":"665","@y":"140","@width":"35","@height":"35"},{"@id":"76","@gid":"9","@x":"0","@y":"385","@width":"35","@height":"35"},{"@id":"77","@gid":"3","@x":"455","@y":"140","@width":"35","@height":"35"},{"@id":"78","@gid":"3","@x":"490","@y":"140","@width":"35","@height":"35"},{"@id":"79","@gid":"3","@x":"525","@y":"140","@width":"35","@height":"35"},{"@id":"80","@gid":"3","@x":"560","@y":"140","@width":"35","@height":"35"},{"@id":"81","@gid":"3","@x":"595","@y":"140","@width":"35","@height":"35"},{"@id":"82","@gid":"3","@x":"630","@y":"140","@width":"35","@height":"35"},{"@id":"83","@gid":"3","@x":"315","@y":"140","@width":"35","@height":"35"},{"@id":"84","@gid":"3","@x":"350","@y":"140","@width":"35","@height":"35"},{"@id":"85","@gid":"3","@x":"455","@y":"385","@width":"35","@height":"35"},{"@id":"86","@gid":"3","@x":"420","@y":"385","@width":"35","@height":"35"},{"@id":"87","@gid":"2","@x":"385","@y":"385","@width":"35","@height":"35"},{"@id":"88","@gid":"2","@x":"280","@y":"140","@width":"35","@height":"35"},{"@id":"89","@gid":"4","@x":"490","@y":"385","@width":"35","@height":"35"},{"@id":"90","@gid":"4","@x":"35","@y":"210","@width":"35","@height":"35"},{"@id":"91","@gid":"15","@x":"0","@y":"210","@width":"35","@height":"35"},{"@id":"92","@gid":"2","@x":"35","@y":"315","@width":"35","@height":"35"},{"@id":"93","@gid":"14","@x":"140","@y":"420","@width":"35","@height":"35"},{"@id":"94","@gid":"14","@x":"455","@y":"280","@width":"35","@height":"35"},{"@id":"95","@gid":"14","@x":"490","@y":"315","@width":"35","@height":"35"},{"@id":"96","@gid":"16","@x":"140","@y":"315","@width":"35","@height":"35"},{"@id":"97","@gid":"16","@x":"280","@y":"420","@width":"35","@height":"35"},{"@id":"98","@gid":"16","@x":"420","@y":"175","@width":"35","@height":"35"},{"@id":"99","@gid":"9","@x":"420","@y":"140","@width":"35","@height":"35"},{"@id":"100","@gid":"9","@x":"385","@y":"140","@width":"35","@height":"35"},{"@id":"101","@gid":"11","@x":"385","@y":"175","@width":"35","@height":"35"},{"@id":"102","@gid":"11","@x":"280","@y":"280","@width":"35","@height":"35"},{"@id":"103","@gid":"6","@x":"385","@y":"210","@width":"35","@height":"35"},{"@id":"104","@gid":"6","@x":"560","@y":"350","@width":"35","@height":"35"},{"@id":"105","@gid":"6","@x":"280","@y":"315","@width":"35","@height":"35"},{"@id":"106","@gid":"6","@x":"280","@y":"350","@width":"35","@height":"35"},{"@id":"107","@gid":"6","@x":"280","@y":"385","@width":"35","@height":"35"},{"@id":"108","@gid":"7","@x":"560","@y":"385","@width":"35","@height":"35"},{"@id":"109","@gid":"16","@x":"385","@y":"280","@width":"35","@height":"35"},{"@id":"110","@gid":"15","@x":"315","@y":"280","@width":"35","@height":"35"},{"@id":"111","@gid":"15","@x":"350","@y":"280","@width":"35","@height":"35"},{"@id":"112","@gid":"3","@x":"245","@y":"245","@width":"35","@height":"35"},{"@id":"113","@gid":"3","@x":"210","@y":"245","@width":"35","@height":"35"},{"@id":"114","@gid":"9","@x":"350","@y":"245","@width":"35","@height":"35"},{"@id":"115","@gid":"9","@x":"315","@y":"245","@width":"35","@height":"35"},{"@id":"116","@gid":"9","@x":"280","@y":"245","@width":"35","@height":"35"},{"@id":"117","@gid":"15","@x":"175","@y":"245","@width":"35","@height":"35"},{"@id":"118","@gid":"15","@x":"105","@y":"315","@width":"35","@height":"35"},{"@id":"119","@gid":"3","@x":"70","@y":"315","@width":"35","@height":"35"},{"@id":"120","@gid":"3","@x":"245","@y":"420","@width":"35","@height":"35"},{"@id":"121","@gid":"15","@x":"210","@y":"420","@width":"35","@height":"35"},{"@id":"122","@gid":"15","@x":"175","@y":"420","@width":"35","@height":"35"},{"@id":"123","@gid":"9","@x":"175","@y":"385","@width":"35","@height":"35"},{"@id":"124","@gid":"10","@x":"210","@y":"385","@width":"35","@height":"35"},{"@id":"125","@gid":"15","@x":"525","@y":"315","@width":"35","@height":"35"},{"@id":"126","@gid":"9","@x":"525","@y":"245","@width":"35","@height":"35"},{"@id":"127","@gid":"9","@x":"490","@y":"245","@width":"35","@height":"35"}]},{"@name":"active",object:[{"@id":"128","@gid":"30","@x":"387","@y":"349","@width":"60","@height":"56"},{"@id":"129","@type":"2","@gid":"21","@x":"595","@y":"474","@width":"70","@height":"19",properties:{property:[{"@name":"distanceY","@value":"245"},{"@name":"speedY","@value":"-45"}]}},{"@id":"130","@gid":"19","@x":"385","@y":"370","@width":"20","@height":"70","@rotation":"-90"},{"@id":"131","@gid":"35","@x":"522","@y":"211","@width":"35","@height":"35"},{"@id":"132","@type":"4","@gid":"21","@x":"70","@y":"475.5","@width":"70","@height":"19",properties:{property:[{"@name":"distanceY","@value":"105"},{"@name":"speedY","@value":"-45"}]}},{"@id":"133","@type":"4","@gid":"17","@x":"427","@y":"455.5","@width":"24","@height":"11"},{"@id":"134","@type":"3","@gid":"19","@x":"310","@y":"140","@width":"20","@height":"70","@rotation":"180"},{"@id":"135","@gid":"27","@x":"215","@y":"302","@width":"31","@height":"34"},{"@id":"136","@gid":"27","@x":"481","@y":"70","@width":"31","@height":"34"},{"@id":"137","@gid":"27","@x":"611","@y":"188","@width":"31","@height":"34"},{"@id":"138","@gid":"17","@x":"345","@y":"210.5","@width":"24","@height":"11"},{"@id":"139","@type":"2","@gid":"17","@x":"6","@y":"141.5","@width":"24","@height":"11"},{"@id":"140","@type":"6","@gid":"17","@x":"428","@y":"105.5","@width":"24","@height":"11"},{"@id":"141","@type":"3","@gid":"17","@x":"251","@y":"385.5","@width":"24","@height":"11"},{"@id":"142","@type":"6","@gid":"19","@x":"489","@y":"264","@width":"20","@height":"70","@rotation":"-90"},{"@id":"143","@type":"4","@gid":"19","@x":"160","@y":"315","@width":"20","@height":"70","@rotation":"180"},{"@id":"144","@type":"4","@gid":"19","@x":"70","@y":"315","@width":"20","@height":"70","@rotation":"180"}]},{"@name":"characters",object:[{"@id":"145","@gid":"24","@x":"210","@y":"210","@width":"44","@height":"52"},{"@id":"146","@gid":"28","@x":"472.5","@y":"457","@width":"63","@height":"50"}]},{"@name":"physics",object:[{"@id":"147","@x":"0","@y":"490","@width":"700","@height":"35"},{"@id":"148","@x":"0","@y":"350","@width":"70","@height":"140"},{"@id":"149","@x":"140","@y":"455","@width":"455","@height":"35"},{"@id":"150","@x":"665","@y":"140","@width":"35","@height":"350"},{"@id":"151","@x":"280","@y":"105","@width":"420","@height":"35"},{"@id":"152","@x":"420","@y":"140","@width":"35","@height":"35"},{"@id":"153","@x":"385","@y":"140","@width":"35","@height":"70"},{"@id":"154","@x":"140","@y":"210","@width":"280","@height":"35"},{"@id":"155","@x":"140","@y":"175","@width":"70","@height":"35"},{"@id":"156","@x":"280","@y":"245","@width":"140","@height":"35"},{"@id":"157","@x":"455","@y":"210","@width":"140","@height":"70"},{"@id":"158","@x":"490","@y":"280","@width":"105","@height":"35"},{"@id":"159","@x":"560","@y":"315","@width":"35","@height":"70"},{"@id":"160","@x":"385","@y":"350","@width":"140","@height":"35"},{"@id":"161","@x":"280","@y":"280","@width":"35","@height":"140"},{"@id":"162","@x":"140","@y":"385","@width":"140","@height":"35"},{"@id":"163","@x":"140","@y":"350","@width":"105","@height":"35"},{"@id":"164","@x":"35","@y":"280","@width":"140","@height":"35"},{"@id":"165","@x":"105","@y":"245","@width":"70","@height":"35"},{"@id":"166","@x":"0","@y":"175","@width":"70","@height":"35"},{"@id":"167","@x":"0","@y":"140","@width":"35","@height":"35"}]}]},{"@level":"15","@version":"1.0","@orientation":"orthogonal","@renderorder":"right-down","@width":"20","@height":"15","@tilewidth":"35","@tileheight":"35","@nextobjectid":"160",tileset:[{"@firstgid":"1","@name":"tiles","@tilewidth":"35","@tileheight":"35","@tilecount":"16",tile:[{"@id":"0",image:{"@width":"35","@height":"35","@source":"tiles/singleTile.png"}},{"@id":"1",image:{"@width":"35","@height":"35","@source":"tiles/platformLeft.png"}},{"@id":"2",image:{"@width":"35","@height":"35","@source":"tiles/platformCenter.png"}},{"@id":"3",image:{"@width":"35","@height":"35","@source":"tiles/platformRight.png"}},{"@id":"4",image:{"@width":"35","@height":"35","@source":"tiles/verticalPlatformTop.png"}},{"@id":"5",image:{"@width":"35","@height":"35","@source":"tiles/verticalPlatformCenter.png"}},{"@id":"6",image:{"@width":"35","@height":"35","@source":"tiles/verticalPlatformBottom.png"}},{"@id":"7",image:{"@width":"35","@height":"35","@source":"tiles/tileTopLeft.png"}},{"@id":"8",image:{"@width":"35","@height":"35","@source":"tiles/tileTopCenter.png"}},{"@id":"9",image:{"@width":"35","@height":"35","@source":"tiles/tileTopRight.png"}},{"@id":"10",image:{"@width":"35","@height":"35","@source":"tiles/tileCenterLeft.png"}},{"@id":"11",image:{"@width":"35","@height":"35","@source":"tiles/tileCenter.png"}},{"@id":"12",image:{"@width":"35","@height":"35","@source":"tiles/tileCenterRight.png"}},{"@id":"13",image:{"@width":"35","@height":"35","@source":"tiles/tileBottomLeft.png"}},{"@id":"14",image:{"@width":"35","@height":"35","@source":"tiles/tileBottomCenter.png"}},{"@id":"15",image:{"@width":"35","@height":"35","@source":"tiles/tileBottomRight.png"}}]},{"@firstgid":"17","@name":"active","@tilewidth":"105","@tileheight":"70","@tilecount":"14",tile:[{"@id":"0",image:{"@width":"24","@height":"11","@source":"active/PushButtonGraphics.png"}},{"@id":"1",image:{"@width":"25","@height":"19","@source":"active/TriggerGraphics.png"}},{"@id":"2",image:{"@width":"20","@height":"70","@source":"active/DoorGraphics.png"}},{"@id":"3",image:{"@width":"20","@height":"70","@source":"active/GlassDoorGraphics.png"}},{"@id":"4",image:{"@width":"70","@height":"19","@source":"active/ElevatorGraphics.png"}},{"@id":"5",image:{"@width":"105","@height":"20","@source":"active/BigElevatorGraphics.png"}},{"@id":"6",image:{"@width":"70","@height":"70","@source":"active/ExitGraphics.png"}},{"@id":"7",image:{"@width":"44","@height":"52","@source":"characters/HustlerGraphics.png"}},{"@id":"8",image:{"@width":"32","@height":"22","@source":"active/CameraGraphics.png"}},{"@id":"9",image:{"@width":"15","@height":"15","@source":"characters/EnemyLimiterGraphics.png"}},{"@id":"10",image:{"@width":"31","@height":"34","@source":"passive/MoneyBagGraphics.png"}},{"@id":"11",image:{"@width":"63","@height":"50","@source":"characters/DogGraphics.png"}},{"@id":"12",image:{"@width":"60","@height":"55","@source":"characters/Prisoner2Graphics.png"}},{"@id":"13",image:{"@width":"60","@height":"56","@source":"characters/PrisonerGraphics.png"}}]},{"@firstgid":"31","@name":"passive","@tilewidth":"210","@tileheight":"50","@tilecount":"12",tile:[{"@id":"0",image:{"@width":"50","@height":"50","@source":"passive/BigBoxGraphics.png"}},{"@id":"1",image:{"@width":"35","@height":"35","@source":"passive/BoxGraphics.png"}},{"@id":"2",image:{"@width":"37","@height":"35","@source":"passive/ToiletGraphics.png"}},{"@id":"3",image:{"@width":"35","@height":"35","@source":"passive/MonitorGraphics.png"}},{"@id":"4",image:{"@width":"35","@height":"35","@source":"passive/BasketBallGraphics.png"}},{"@id":"5",image:{"@width":"35","@height":"35","@source":"passive/StoolGraphics.png"}},{"@id":"6",image:{"@width":"150","@height":"20","@source":"passive/PlankGraphics.png"}},{"@id":"7",image:{"@width":"150","@height":"20","@source":"passive/Plank2Graphics.png"}},{"@id":"8",image:{"@width":"210","@height":"20","@source":"passive/BigPlankGraphics.png"}},{"@id":"9",image:{"@width":"100","@height":"20","@source":"passive/Plank5Graphics.png"}},{"@id":"10",image:{"@width":"150","@height":"20","@source":"passive/Plank2Graphics.png"}},{"@id":"11",image:{"@width":"35","@height":"35","@source":"passive/MirrorGraphics.png"}}]},{"@firstgid":"43","@name":"decor","@tilewidth":"232","@tileheight":"136","@tilecount":"43",tile:[{"@id":"0",image:{"@width":"232","@height":"79","@source":"decor/LevelTextGraphics.png"}},{"@id":"1",image:{"@width":"54","@height":"20","@source":"decor/Decor1Graphics.png"}},{"@id":"2",image:{"@width":"54","@height":"20","@source":"decor/Decor2Graphics.png"}},{"@id":"3",image:{"@width":"33","@height":"27","@source":"decor/Decor3Graphics.png"}},{"@id":"4",image:{"@width":"34","@height":"25","@source":"decor/Decor4Graphics.png"}},{"@id":"5",image:{"@width":"22","@height":"31","@source":"decor/Decor5Graphics.png"}},{"@id":"6",image:{"@width":"126","@height":"59","@source":"decor/Decor6Graphics.png"}},{"@id":"7",image:{"@width":"25","@height":"21","@source":"decor/Decor8Graphics.png"}},{"@id":"8",image:{"@width":"18","@height":"22","@source":"decor/Decor9Graphics.png"}},{"@id":"9",image:{"@width":"35","@height":"58","@source":"decor/Decor10Graphics.png"}},{"@id":"10",image:{"@width":"19","@height":"66","@source":"decor/Decor11Graphics.png"}},{"@id":"11",image:{"@width":"23","@height":"33","@source":"decor/Decor12Graphics.png"}},{"@id":"12",image:{"@width":"38","@height":"26","@source":"decor/Decor13Graphics.png"}},{"@id":"13",image:{"@width":"43","@height":"78","@source":"decor/Decor14Graphics.png"}},{"@id":"14",image:{"@width":"60","@height":"86","@source":"decor/Decor15Graphics.png"}},{"@id":"15",image:{"@width":"41","@height":"69","@source":"decor/Decor16Graphics.png"}},{"@id":"16",image:{"@width":"55","@height":"58","@source":"decor/Decor17Graphics.png"}},{"@id":"17",image:{"@width":"57","@height":"54","@source":"decor/Decor18Graphics.png"}},{"@id":"18",image:{"@width":"18","@height":"45","@source":"decor/Decor19Graphics.png"}},{"@id":"19",image:{"@width":"41","@height":"49","@source":"decor/Decor20Graphics.png"}},{"@id":"20",image:{"@width":"51","@height":"38","@source":"decor/Decor21Graphics.png"}},{"@id":"21",image:{"@width":"54","@height":"54","@source":"decor/Decor22Graphics.png"}},{"@id":"22",image:{"@width":"63","@height":"136","@source":"decor/Decor23Graphics.png"}},{"@id":"23",image:{"@width":"21","@height":"39","@source":"decor/Decor24Graphics.png"}},{"@id":"24",image:{"@width":"104","@height":"50","@source":"decor/Decor25Graphics.png"}},{"@id":"25",image:{"@width":"104","@height":"46","@source":"decor/Decor26Graphics.png"}},{"@id":"26",image:{"@width":"86","@height":"38","@source":"decor/Decor27Graphics.png"}},{"@id":"27",image:{"@width":"63","@height":"55","@source":"decor/Decor28Graphics.png"}},{"@id":"28",image:{"@width":"13","@height":"23","@source":"decor/Decor29Graphics.png"}},{"@id":"29",image:{"@width":"28","@height":"40","@source":"decor/Decor30Graphics.png"}},{"@id":"30",image:{"@width":"69","@height":"30","@source":"decor/Decor31Graphics.png"}},{"@id":"31",image:{"@width":"33","@height":"29","@source":"decor/Decor32Graphics.png"}},{"@id":"32",image:{"@width":"42","@height":"42","@source":"decor/Decor33Graphics.png"}},{"@id":"33",image:{"@width":"60","@height":"66","@source":"decor/Decor34Graphics.png"}},{"@id":"34",image:{"@width":"46","@height":"65","@source":"decor/Decor35Graphics.png"}},{"@id":"35",image:{"@width":"71","@height":"55","@source":"decor/Decor36Graphics.png"}},{"@id":"36",image:{"@width":"35","@height":"55","@source":"decor/Decor37Graphics.png"}},{"@id":"37",image:{"@width":"28","@height":"29","@source":"decor/Decor38Graphics.png"}},{"@id":"38",image:{"@width":"38","@height":"37","@source":"decor/Decor39Graphics.png"}},{"@id":"39",image:{"@width":"103","@height":"50","@source":"decor/Decor40Graphics.png"}},{"@id":"40",image:{"@width":"56","@height":"55","@source":"decor/Decor41Graphics.png"}},{"@id":"41",image:{"@width":"71","@height":"50","@source":"decor/Decor42Graphics.png"}},{"@id":"42",image:{"@width":"200","@height":"44","@source":"decor/TxtGraphics.png"}}]}],imagelayer:{"@name":"background","@y":"-2",image:{"@source":"bg/Background1Graphics.png"}},objectgroup:[{"@name":"decorations",object:[{"@id":"1","@gid":"43","@x":"175","@y":"422","@width":"232","@height":"79",properties:{property:{"@name":"text","@value":"level_text_16"}}},{"@id":"2","@gid":"44","@x":"490","@y":"404","@width":"54","@height":"20"},{"@id":"3","@gid":"49","@x":"387","@y":"206","@width":"126","@height":"59"},{"@id":"4","@gid":"73","@x":"105","@y":"161","@width":"69","@height":"30"},{"@id":"5","@gid":"78","@x":"308","@y":"487","@width":"71","@height":"55"},{"@id":"6","@gid":"65","@x":"0","@y":"385","@width":"63","@height":"136"},{"@id":"7","@gid":"64","@x":"245","@y":"105","@width":"54","@height":"54"},{"@id":"8","@gid":"81","@x":"562","@y":"316","@width":"38","@height":"37"}]},{"@name":"tiles",object:[{"@id":"9","@gid":"12","@x":"665","@y":"490","@width":"35","@height":"35"},{"@id":"10","@gid":"12","@x":"630","@y":"525","@width":"35","@height":"35"},{"@id":"11","@gid":"12","@x":"385","@y":"525","@width":"35","@height":"35"},{"@id":"12","@gid":"12","@x":"455","@y":"525","@width":"35","@height":"35"},{"@id":"13","@gid":"12","@x":"665","@y":"525","@width":"35","@height":"35"},{"@id":"14","@gid":"12","@x":"385","@y":"525","@width":"35","@height":"35"},{"@id":"15","@gid":"12","@x":"420","@y":"525","@width":"35","@height":"35"},{"@id":"16","@gid":"12","@x":"35","@y":"525","@width":"35","@height":"35"},{"@id":"17","@gid":"12","@x":"0","@y":"525","@width":"35","@height":"35"},{"@id":"18","@gid":"9","@x":"595","@y":"525","@width":"35","@height":"35"},{"@id":"19","@gid":"9","@x":"560","@y":"525","@width":"35","@height":"35"},{"@id":"20","@gid":"9","@x":"525","@y":"525","@width":"35","@height":"35"},{"@id":"21","@gid":"9","@x":"490","@y":"525","@width":"35","@height":"35"},{"@id":"22","@gid":"9","@x":"350","@y":"525","@width":"35","@height":"35"},{"@id":"23","@gid":"9","@x":"315","@y":"525","@width":"35","@height":"35"},{"@id":"24","@gid":"9","@x":"280","@y":"525","@width":"35","@height":"35"},{"@id":"25","@gid":"9","@x":"245","@y":"525","@width":"35","@height":"35"},{"@id":"26","@gid":"9","@x":"210","@y":"525","@width":"35","@height":"35"},{"@id":"27","@gid":"9","@x":"175","@y":"525","@width":"35","@height":"35"},{"@id":"28","@gid":"9","@x":"140","@y":"525","@width":"35","@height":"35"},{"@id":"29","@gid":"9","@x":"105","@y":"525","@width":"35","@height":"35"},{"@id":"30","@gid":"9","@x":"70","@y":"525","@width":"35","@height":"35"},{"@id":"31","@gid":"9","@x":"0","@y":"490","@width":"35","@height":"35"},{"@id":"32","@gid":"9","@x":"420","@y":"490","@width":"35","@height":"35"},{"@id":"33","@gid":"9","@x":"105","@y":"245","@width":"35","@height":"35"},{"@id":"34","@gid":"10","@x":"35","@y":"490","@width":"35","@height":"35"},{"@id":"35","@gid":"10","@x":"455","@y":"490","@width":"35","@height":"35"},{"@id":"36","@gid":"8","@x":"630","@y":"490","@width":"35","@height":"35"},{"@id":"37","@gid":"8","@x":"385","@y":"385","@width":"35","@height":"35"},{"@id":"38","@gid":"2","@x":"630","@y":"385","@width":"35","@height":"35"},{"@id":"39","@gid":"2","@x":"595","@y":"245","@width":"35","@height":"35"},{"@id":"40","@gid":"2","@x":"35","@y":"420","@width":"35","@height":"35"},{"@id":"41","@gid":"5","@x":"70","@y":"210","@width":"35","@height":"35"},{"@id":"42","@gid":"5","@x":"175","@y":"420","@width":"35","@height":"35"},{"@id":"43","@gid":"5","@x":"420","@y":"245","@width":"35","@height":"35"},{"@id":"44","@gid":"7","@x":"525","@y":"280","@width":"35","@height":"35"},{"@id":"45","@gid":"11","@x":"385","@y":"490","@width":"35","@height":"35"},{"@id":"46","@gid":"6","@x":"385","@y":"420","@width":"35","@height":"35"},{"@id":"47","@gid":"6","@x":"385","@y":"455","@width":"35","@height":"35"},{"@id":"48","@gid":"11","@x":"665","@y":"420","@width":"35","@height":"35"},{"@id":"49","@gid":"11","@x":"665","@y":"455","@width":"35","@height":"35"},{"@id":"50","@gid":"9","@x":"665","@y":"385","@width":"35","@height":"35"},{"@id":"51","@gid":"3","@x":"455","@y":"385","@width":"35","@height":"35"},{"@id":"52","@gid":"3","@x":"490","@y":"385","@width":"35","@height":"35"},{"@id":"53","@gid":"4","@x":"525","@y":"385","@width":"35","@height":"35"},{"@id":"54","@gid":"15","@x":"420","@y":"385","@width":"35","@height":"35"},{"@id":"55","@gid":"14","@x":"105","@y":"455","@width":"35","@height":"35"},{"@id":"56","@gid":"16","@x":"175","@y":"455","@width":"35","@height":"35"},{"@id":"57","@gid":"3","@x":"140","@y":"455","@width":"35","@height":"35"},{"@id":"58","@gid":"15","@x":"70","@y":"420","@width":"35","@height":"35"},{"@id":"59","@gid":"13","@x":"105","@y":"420","@width":"35","@height":"35"},{"@id":"60","@gid":"13","@x":"105","@y":"385","@width":"35","@height":"35"},{"@id":"61","@gid":"13","@x":"105","@y":"350","@width":"35","@height":"35"},{"@id":"62","@gid":"8","@x":"70","@y":"350","@width":"35","@height":"35"},{"@id":"63","@gid":"8","@x":"525","@y":"140","@width":"35","@height":"35"},{"@id":"64","@gid":"8","@x":"315","@y":"70","@width":"35","@height":"35"},{"@id":"65","@gid":"11","@x":"70","@y":"385","@width":"35","@height":"35"},{"@id":"66","@gid":"6","@x":"105","@y":"280","@width":"35","@height":"35"},{"@id":"67","@gid":"6","@x":"105","@y":"315","@width":"35","@height":"35"},{"@id":"68","@gid":"14","@x":"70","@y":"245","@width":"35","@height":"35"},{"@id":"69","@gid":"4","@x":"175","@y":"245","@width":"35","@height":"35"},{"@id":"70","@gid":"3","@x":"140","@y":"245","@width":"35","@height":"35"},{"@id":"71","@gid":"6","@x":"420","@y":"280","@width":"35","@height":"35"},{"@id":"72","@gid":"6","@x":"420","@y":"315","@width":"35","@height":"35"},{"@id":"73","@gid":"6","@x":"420","@y":"350","@width":"35","@height":"35"},{"@id":"74","@gid":"6","@x":"525","@y":"175","@width":"35","@height":"35"},{"@id":"75","@gid":"6","@x":"525","@y":"210","@width":"35","@height":"35"},{"@id":"76","@gid":"6","@x":"525","@y":"245","@width":"35","@height":"35"},{"@id":"77","@gid":"4","@x":"560","@y":"140","@width":"35","@height":"35"},{"@id":"78","@gid":"3","@x":"630","@y":"245","@width":"35","@height":"35"},{"@id":"79","@gid":"15","@x":"665","@y":"245","@width":"35","@height":"35"},{"@id":"80","@gid":"11","@x":"665","@y":"210","@width":"35","@height":"35"},{"@id":"81","@gid":"11","@x":"665","@y":"175","@width":"35","@height":"35"},{"@id":"82","@gid":"11","@x":"665","@y":"140","@width":"35","@height":"35"},{"@id":"83","@gid":"11","@x":"665","@y":"105","@width":"35","@height":"35"},{"@id":"84","@gid":"9","@x":"665","@y":"70","@width":"35","@height":"35"},{"@id":"85","@gid":"9","@x":"385","@y":"70","@width":"35","@height":"35"},{"@id":"86","@gid":"3","@x":"420","@y":"70","@width":"35","@height":"35"},{"@id":"87","@gid":"3","@x":"455","@y":"70","@width":"35","@height":"35"},{"@id":"88","@gid":"3","@x":"490","@y":"70","@width":"35","@height":"35"},{"@id":"89","@gid":"3","@x":"525","@y":"70","@width":"35","@height":"35"},{"@id":"90","@gid":"3","@x":"560","@y":"70","@width":"35","@height":"35"},{"@id":"91","@gid":"3","@x":"595","@y":"70","@width":"35","@height":"35"},{"@id":"92","@gid":"3","@x":"630","@y":"70","@width":"35","@height":"35"},{"@id":"93","@gid":"3","@x":"140","@y":"105","@width":"35","@height":"35"},{"@id":"94","@gid":"3","@x":"105","@y":"105","@width":"35","@height":"35"},{"@id":"95","@gid":"3","@x":"70","@y":"105","@width":"35","@height":"35"},{"@id":"96","@gid":"3","@x":"35","@y":"105","@width":"35","@height":"35"},{"@id":"97","@gid":"3","@x":"0","@y":"105","@width":"35","@height":"35"},{"@id":"98","@gid":"3","@x":"210","@y":"140","@width":"35","@height":"35"},{"@id":"99","@gid":"3","@x":"245","@y":"140","@width":"35","@height":"35"},{"@id":"100","@gid":"3","@x":"280","@y":"140","@width":"35","@height":"35"},{"@id":"101","@gid":"14","@x":"175","@y":"140","@width":"35","@height":"35"},{"@id":"102","@gid":"10","@x":"175","@y":"105","@width":"35","@height":"35"},{"@id":"103","@gid":"16","@x":"315","@y":"140","@width":"35","@height":"35"},{"@id":"104","@gid":"6","@x":"385","@y":"105","@width":"35","@height":"35"},{"@id":"105","@gid":"6","@x":"315","@y":"105","@width":"35","@height":"35"},{"@id":"106","@gid":"7","@x":"385","@y":"140","@width":"35","@height":"35"},{"@id":"107","@gid":"3","@x":"350","@y":"70","@width":"35","@height":"35"}]},{"@name":"active",object:[{"@id":"108","@gid":"25","@x":"373.833","@y":"379.667","@width":"32","@height":"22",properties:{property:[{"@name":"delay","@value":"0"},{"@name":"maxAngle","@value":"0"},{"@name":"minAngle","@value":"0"},{"@name":"speedX","@value":"0"}]}},{"@id":"109","@type":"6","@gid":"21","@x":"198.333","@y":"314.667","@width":"70","@height":"19",properties:{property:[{"@name":"distanceX","@value":"140"},{"@name":"distanceY","@value":"0"},{"@name":"speedX","@value":"30"},{"@name":"speedY","@value":"0"}]}},{"@id":"110","@gid":"20","@x":"176","@y":"316","@width":"20","@height":"70","@rotation":"-90"},{"@id":"111","@gid":"30","@x":"317.667","@y":"211.667","@width":"60","@height":"56",properties:{property:[{"@name":"limitLeft","@value":"15"},{"@name":"limitRight","@value":"60"}]}},{"@id":"112","@type":"4","@gid":"19","@x":"147","@y":"523","@width":"20","@height":"70"},{"@id":"113","@type":"6","@gid":"21","@x":"-0.66667","@y":"333.833","@width":"70","@height":"19",properties:{property:[{"@name":"distanceY","@value":"140"},{"@name":"speedY","@value":"-45"}]}},{"@id":"114","@type":"5","@gid":"19","@x":"318","@y":"120","@width":"20","@height":"70","@rotation":"90"},{"@id":"115","@gid":"3221225514","@x":"140","@y":"296","@width":"35","@height":"35"},{"@id":"116","@gid":"20","@x":"419.667","@y":"230","@width":"20","@height":"70","@rotation":"-90"},{"@id":"117","@gid":"20","@x":"349.667","@y":"230","@width":"20","@height":"70","@rotation":"-90"},{"@id":"118","@type":"5","@gid":"17","@x":"474.5","@y":"351.5","@width":"24","@height":"11"},{"@id":"119","@type":"6","@gid":"17","@x":"657","@y":"351.667","@width":"24","@height":"11"},{"@id":"120","@type":"2","@gid":"17","@x":"6","@y":"456.5","@width":"24","@height":"11"},{"@id":"121","@type":"2","@gid":"21","@x":"560","@y":"369.5","@width":"70","@height":"19",properties:{property:[{"@name":"distanceY","@value":"105"},{"@name":"speedY","@value":"45"}]}},{"@id":"122","@type":"5","@gid":"19","@x":"531","@y":"349","@width":"20","@height":"70"},{"@id":"123","@gid":"27","@x":"620","@y":"298","@width":"31","@height":"34"},{"@id":"124","@gid":"27","@x":"70","@y":"286","@width":"31","@height":"34"},{"@id":"125","@gid":"27","@x":"615","@y":"178","@width":"31","@height":"34"},{"@id":"126","@type":"4","@gid":"18","@x":"443","@y":"455","@width":"25","@height":"19"},{"@id":"127","@gid":"2147483690","@x":"214","@y":"297","@width":"35","@height":"35"},{"@id":"128","@gid":"1073741866","@x":"351","@y":"121","@width":"35","@height":"35"},{"@id":"129","@gid":"42","@x":"139","@y":"422","@width":"35","@height":"35"},{"@id":"130","@type":"5","@gid":"19","@x":"524","@y":"212","@width":"20","@height":"70","@rotation":"90"},{"@id":"131","@gid":"30","@x":"126","@y":"212","@width":"60","@height":"56",properties:{property:[{"@name":"limitLeft","@value":"30"},{"@name":"limitRight","@value":"30"}]}},{"@id":"132","@gid":"20","@x":"280","@y":"230","@width":"20","@height":"70","@rotation":"-90"}]},{"@name":"characters",object:[{"@id":"133","@gid":"24","@x":"280","@y":"490","@width":"44","@height":"52"},{"@id":"134","@gid":"28","@x":"507.833","@y":"488","@width":"63","@height":"50"}]},{"@name":"physics",object:[{"@id":"135","@x":"0","@y":"490","@width":"700","@height":"35"},{"@id":"136","@x":"0","@y":"455","@width":"70","@height":"35"},{"@id":"137","@x":"420","@y":"455","@width":"70","@height":"35"},{"@id":"138","@x":"630","@y":"455","@width":"70","@height":"35"},{"@id":"139","@x":"630","@y":"350","@width":"70","@height":"35"},{"@id":"140","@x":"665","@y":"385","@width":"35","@height":"70"},{"@id":"141","@x":"385","@y":"350","@width":"35","@height":"140"},{"@id":"142","@x":"420","@y":"350","@width":"140","@height":"35"},{"@id":"143","@x":"420","@y":"210","@width":"35","@height":"140"},{"@id":"144","@x":"105","@y":"420","@width":"105","@height":"35"},{"@id":"145","@x":"175","@y":"385","@width":"35","@height":"35"},{"@id":"146","@x":"35","@y":"385","@width":"105","@height":"35"},{"@id":"147","@x":"70","@y":"315","@width":"70","@height":"70"},{"@id":"148","@x":"105","@y":"245","@width":"35","@height":"70"},{"@id":"149","@x":"70","@y":"210","@width":"140","@height":"35"},{"@id":"150","@x":"70","@y":"175","@width":"35","@height":"35"},{"@id":"151","@x":"525","@y":"140","@width":"35","@height":"140"},{"@id":"152","@x":"525","@y":"105","@width":"70","@height":"35"},{"@id":"153","@x":"595","@y":"210","@width":"105","@height":"35"},{"@id":"154","@x":"665","@y":"70","@width":"35","@height":"140"},{"@id":"155","@x":"315","@y":"35","@width":"385","@height":"35"},{"@id":"156","@x":"385","@y":"70","@width":"35","@height":"70"},{"@id":"157","@x":"315","@y":"70","@width":"35","@height":"35"},{"@id":"158","@x":"175","@y":"105","@width":"175","@height":"35"},{"@id":"159","@x":"0","@y":"70","@width":"210","@height":"35"}]}]},{"@level":"16","@version":"1.0","@orientation":"orthogonal","@renderorder":"right-down","@width":"20","@height":"15","@tilewidth":"35","@tileheight":"35",tileset:[{"@firstgid":"1","@name":"tiles","@tilewidth":"35","@tileheight":"35",tile:[{"@id":"0",image:{"@width":"35","@height":"35","@source":"tiles/singleTile.png"}},{"@id":"1",image:{"@width":"35","@height":"35","@source":"tiles/platformLeft.png"}},{"@id":"2",image:{"@width":"35","@height":"35","@source":"tiles/platformCenter.png"}},{"@id":"3",image:{"@width":"35","@height":"35","@source":"tiles/platformRight.png"}},{"@id":"4",image:{"@width":"35","@height":"35","@source":"tiles/verticalPlatformTop.png"}},{"@id":"5",image:{"@width":"35","@height":"35","@source":"tiles/verticalPlatformCenter.png"}},{"@id":"6",image:{"@width":"35","@height":"35","@source":"tiles/verticalPlatformBottom.png"}},{"@id":"7",image:{"@width":"35","@height":"35","@source":"tiles/tileTopLeft.png"}},{"@id":"8",image:{"@width":"35","@height":"35","@source":"tiles/tileTopCenter.png"}},{"@id":"9",image:{"@width":"35","@height":"35","@source":"tiles/tileTopRight.png"}},{"@id":"10",image:{"@width":"35","@height":"35","@source":"tiles/tileCenterLeft.png"}},{"@id":"11",image:{"@width":"35","@height":"35","@source":"tiles/tileCenter.png"}},{"@id":"12",image:{"@width":"35","@height":"35","@source":"tiles/tileCenterRight.png"}},{"@id":"13",image:{"@width":"35","@height":"35","@source":"tiles/tileBottomLeft.png"}},{"@id":"14",image:{"@width":"35","@height":"35","@source":"tiles/tileBottomCenter.png"}},{"@id":"15",image:{"@width":"35","@height":"35","@source":"tiles/tileBottomRight.png"}}]},{"@firstgid":"17","@name":"active","@tilewidth":"105","@tileheight":"70",tile:[{"@id":"0",image:{"@width":"24","@height":"11","@source":"active/PushButtonGraphics.png"}},{"@id":"1",image:{"@width":"25","@height":"19","@source":"active/TriggerGraphics.png"}},{"@id":"2",image:{"@width":"20","@height":"70","@source":"active/DoorGraphics.png"}},{"@id":"3",image:{"@width":"20","@height":"70","@source":"active/GlassDoorGraphics.png"}},{"@id":"4",image:{"@width":"70","@height":"19","@source":"active/ElevatorGraphics.png"}},{"@id":"5",image:{"@width":"105","@height":"20","@source":"active/BigElevatorGraphics.png"}},{"@id":"6",image:{"@width":"70","@height":"70","@source":"active/ExitGraphics.png"}},{"@id":"7",image:{"@width":"44","@height":"52","@source":"characters/HustlerGraphics.png"}},{"@id":"8",image:{"@width":"32","@height":"22","@source":"active/CameraGraphics.png"}},{"@id":"9",image:{"@width":"15","@height":"15","@source":"characters/EnemyLimiterGraphics.png"}},{"@id":"10",image:{"@width":"31","@height":"34","@source":"passive/MoneyBagGraphics.png"}},{"@id":"11",image:{"@width":"63","@height":"50","@source":"characters/DogGraphics.png"}},{"@id":"12",image:{"@width":"60","@height":"55","@source":"characters/Prisoner2Graphics.png"}},{"@id":"13",image:{"@width":"60","@height":"56","@source":"characters/PrisonerGraphics.png"}},{"@id":"14",image:{"@width":"50","@height":"29","@source":"active/TurrelGraphics.png"}}]},{"@firstgid":"32","@name":"passive","@tilewidth":"210","@tileheight":"50",tile:[{"@id":"0",image:{"@width":"50","@height":"50","@source":"passive/BigBoxGraphics.png"}},{"@id":"1",image:{"@width":"35","@height":"35","@source":"passive/BoxGraphics.png"}},{"@id":"2",image:{"@width":"37","@height":"35","@source":"passive/ToiletGraphics.png"}},{"@id":"3",image:{"@width":"35","@height":"35","@source":"passive/MonitorGraphics.png"}},{"@id":"4",image:{"@width":"35","@height":"35","@source":"passive/BasketBallGraphics.png"}},{"@id":"5",image:{"@width":"35","@height":"35","@source":"passive/StoolGraphics.png"}},{"@id":"6",image:{"@width":"150","@height":"20","@source":"passive/PlankGraphics.png"}},{"@id":"7",image:{"@width":"150","@height":"20","@source":"passive/Plank2Graphics.png"}},{"@id":"8",image:{"@width":"210","@height":"20","@source":"passive/BigPlankGraphics.png"}},{"@id":"9",image:{"@width":"100","@height":"20","@source":"passive/Plank5Graphics.png"}},{"@id":"10",image:{"@width":"150","@height":"20","@source":"passive/Plank2Graphics.png"}},{"@id":"11",image:{"@width":"35","@height":"35","@source":"passive/MirrorGraphics.png"}}]},{"@firstgid":"44","@name":"decor","@tilewidth":"232","@tileheight":"136",tile:[{"@id":"0",image:{"@width":"232","@height":"79","@source":"decor/LevelTextGraphics.png"}},{"@id":"1",image:{"@width":"54","@height":"20","@source":"decor/Decor1Graphics.png"}},{"@id":"2",image:{"@width":"54","@height":"20","@source":"decor/Decor2Graphics.png"}},{"@id":"3",image:{"@width":"33","@height":"27","@source":"decor/Decor3Graphics.png"}},{"@id":"4",image:{"@width":"34","@height":"25","@source":"decor/Decor4Graphics.png"}},{"@id":"5",image:{"@width":"22","@height":"31","@source":"decor/Decor5Graphics.png"}},{"@id":"6",image:{"@width":"126","@height":"59","@source":"decor/Decor6Graphics.png"}},{"@id":"7",image:{"@width":"25","@height":"21","@source":"decor/Decor8Graphics.png"}},{"@id":"8",image:{"@width":"18","@height":"22","@source":"decor/Decor9Graphics.png"}},{"@id":"9",image:{"@width":"35","@height":"58","@source":"decor/Decor10Graphics.png"}},{"@id":"10",image:{"@width":"19","@height":"66","@source":"decor/Decor11Graphics.png"}},{"@id":"11",image:{"@width":"23","@height":"33","@source":"decor/Decor12Graphics.png"}},{"@id":"12",image:{"@width":"38","@height":"26","@source":"decor/Decor13Graphics.png"}},{"@id":"13",image:{"@width":"43","@height":"78","@source":"decor/Decor14Graphics.png"}},{"@id":"14",image:{"@width":"60","@height":"86","@source":"decor/Decor15Graphics.png"}},{"@id":"15",image:{"@width":"41","@height":"69","@source":"decor/Decor16Graphics.png"}},{"@id":"16",image:{"@width":"55","@height":"58","@source":"decor/Decor17Graphics.png"}},{"@id":"17",image:{"@width":"57","@height":"54","@source":"decor/Decor18Graphics.png"}},{"@id":"18",image:{"@width":"18","@height":"45","@source":"decor/Decor19Graphics.png"}},{"@id":"19",image:{"@width":"41","@height":"49","@source":"decor/Decor20Graphics.png"}},{"@id":"20",image:{"@width":"51","@height":"38","@source":"decor/Decor21Graphics.png"}},{"@id":"21",image:{"@width":"54","@height":"54","@source":"decor/Decor22Graphics.png"}},{"@id":"22",image:{"@width":"63","@height":"136","@source":"decor/Decor23Graphics.png"}},{"@id":"23",image:{"@width":"21","@height":"39","@source":"decor/Decor24Graphics.png"}},{"@id":"24",image:{"@width":"104","@height":"50","@source":"decor/Decor25Graphics.png"}},{"@id":"25",image:{"@width":"104","@height":"46","@source":"decor/Decor26Graphics.png"}},{"@id":"26",image:{"@width":"86","@height":"38","@source":"decor/Decor27Graphics.png"}},{"@id":"27",image:{"@width":"63","@height":"55","@source":"decor/Decor28Graphics.png"}},{"@id":"28",image:{"@width":"13","@height":"23","@source":"decor/Decor29Graphics.png"}},{"@id":"29",image:{"@width":"28","@height":"40","@source":"decor/Decor30Graphics.png"}},{"@id":"30",image:{"@width":"69","@height":"30","@source":"decor/Decor31Graphics.png"}},{"@id":"31",image:{"@width":"33","@height":"29","@source":"decor/Decor32Graphics.png"}},{"@id":"32",image:{"@width":"42","@height":"42","@source":"decor/Decor33Graphics.png"}},{"@id":"33",image:{"@width":"60","@height":"66","@source":"decor/Decor34Graphics.png"}},{"@id":"34",image:{"@width":"46","@height":"65","@source":"decor/Decor35Graphics.png"}},{"@id":"35",image:{"@width":"71","@height":"55","@source":"decor/Decor36Graphics.png"}},{"@id":"36",image:{"@width":"35","@height":"55","@source":"decor/Decor37Graphics.png"}},{"@id":"37",image:{"@width":"28","@height":"29","@source":"decor/Decor38Graphics.png"}},{"@id":"38",image:{"@width":"38","@height":"37","@source":"decor/Decor39Graphics.png"}},{"@id":"39",image:{"@width":"103","@height":"50","@source":"decor/Decor40Graphics.png"}},{"@id":"40",image:{"@width":"56","@height":"55","@source":"decor/Decor41Graphics.png"}},{"@id":"41",image:{"@width":"71","@height":"50","@source":"decor/Decor42Graphics.png"}},{"@id":"42",image:{"@width":"200","@height":"44","@source":"decor/TxtGraphics.png"}}]}],imagelayer:{"@name":"background",image:{"@source":"bg/Background1Graphics.png"}},objectgroup:[{"@name":"decorations",object:[{"@gid":"45","@x":"280","@y":"194","@width":"54","@height":"20"},{"@gid":"69","@x":"420","@y":"140","@width":"104","@height":"46"},{"@gid":"66","@x":"560","@y":"315","@width":"63","@height":"136"},{"@gid":"57","@x":"551","@y":"512","@width":"43","@height":"78"},{"@gid":"70","@x":"420","@y":"455","@width":"86","@height":"38"},{"@gid":"73","@x":"369","@y":"430","@width":"28","@height":"40"},{"@gid":"72","@x":"490","@y":"420","@width":"13","@height":"23"},{"@gid":"80","@x":"268","@y":"448","@width":"35","@height":"55"},{"@gid":"55","@x":"385","@y":"140","@width":"23","@height":"33"},{"@gid":"85","@x":"62","@y":"449","@width":"71","@height":"50"},{"@gid":"75","@x":"315","@y":"301","@width":"33","@height":"29"}]},{"@name":"tiles",object:[{"@gid":"12","@x":"0","@y":"490","@width":"35","@height":"35"},{"@gid":"12","@x":"385","@y":"525","@width":"35","@height":"35"},{"@gid":"12","@x":"665","@y":"525","@width":"35","@height":"35"},{"@gid":"12","@x":"455","@y":"525","@width":"35","@height":"35"},{"@gid":"12","@x":"630","@y":"525","@width":"35","@height":"35"},{"@gid":"12","@x":"245","@y":"525","@width":"35","@height":"35"},{"@gid":"12","@x":"490","@y":"525","@width":"35","@height":"35"},{"@gid":"12","@x":"280","@y":"525","@width":"35","@height":"35"},{"@gid":"12","@x":"420","@y":"525","@width":"35","@height":"35"},{"@gid":"12","@x":"70","@y":"525","@width":"35","@height":"35"},{"@gid":"12","@x":"0","@y":"525","@width":"35","@height":"35"},{"@gid":"12","@x":"35","@y":"525","@width":"35","@height":"35"},{"@gid":"12","@x":"105","@y":"525","@width":"35","@height":"35"},{"@gid":"12","@x":"140","@y":"525","@width":"35","@height":"35"},{"@gid":"12","@x":"315","@y":"525","@width":"35","@height":"35"},{"@gid":"12","@x":"350","@y":"525","@width":"35","@height":"35"},{"@gid":"12","@x":"665","@y":"490","@width":"35","@height":"35"},{"@gid":"12","@x":"665","@y":"455","@width":"35","@height":"35"},{"@gid":"3","@x":"490","@y":"70","@width":"35","@height":"35"},{"@gid":"3","@x":"525","@y":"70","@width":"35","@height":"35"},{"@gid":"3","@x":"560","@y":"70","@width":"35","@height":"35"},{"@gid":"3","@x":"595","@y":"70","@width":"35","@height":"35"},{"@gid":"3","@x":"630","@y":"70","@width":"35","@height":"35"},{"@gid":"3","@x":"665","@y":"70","@width":"35","@height":"35"},{"@gid":"14","@x":"455","@y":"70","@width":"35","@height":"35"},{"@gid":"13","@x":"455","@y":"35","@width":"35","@height":"35"},{"@gid":"15","@x":"315","@y":"35","@width":"35","@height":"35"},{"@gid":"15","@x":"280","@y":"35","@width":"35","@height":"35"},{"@gid":"15","@x":"245","@y":"35","@width":"35","@height":"35"},{"@gid":"15","@x":"210","@y":"35","@width":"35","@height":"35"},{"@gid":"15","@x":"175","@y":"35","@width":"35","@height":"35"},{"@gid":"15","@x":"140","@y":"35","@width":"35","@height":"35"},{"@gid":"11","@x":"105","@y":"35","@width":"35","@height":"35"},{"@gid":"6","@x":"105","@y":"175","@width":"35","@height":"35"},{"@gid":"6","@x":"105","@y":"140","@width":"35","@height":"35"},{"@gid":"6","@x":"105","@y":"70","@width":"35","@height":"35"},{"@gid":"7","@x":"105","@y":"210","@width":"35","@height":"35"},{"@gid":"13","@x":"105","@y":"105","@width":"35","@height":"35"},{"@gid":"3","@x":"70","@y":"105","@width":"35","@height":"35"},{"@gid":"3","@x":"35","@y":"105","@width":"35","@height":"35"},{"@gid":"3","@x":"0","@y":"105","@width":"35","@height":"35"},{"@gid":"8","@x":"175","@y":"140","@width":"35","@height":"35"},{"@gid":"10","@x":"315","@y":"140","@width":"35","@height":"35"},{"@gid":"9","@x":"210","@y":"140","@width":"35","@height":"35"},{"@gid":"14","@x":"175","@y":"175","@width":"35","@height":"35"},{"@gid":"15","@x":"210","@y":"175","@width":"35","@height":"35"},{"@gid":"2","@x":"420","@y":"175","@width":"35","@height":"35"},{"@gid":"4","@x":"595","@y":"175","@width":"35","@height":"35"},{"@gid":"3","@x":"560","@y":"175","@width":"35","@height":"35"},{"@gid":"3","@x":"490","@y":"175","@width":"35","@height":"35"},{"@gid":"3","@x":"455","@y":"175","@width":"35","@height":"35"},{"@gid":"9","@x":"525","@y":"175","@width":"35","@height":"35"},{"@gid":"6","@x":"525","@y":"210","@width":"35","@height":"35"},{"@gid":"6","@x":"525","@y":"245","@width":"35","@height":"35"},{"@gid":"6","@x":"525","@y":"280","@width":"35","@height":"35"},{"@gid":"6","@x":"105","@y":"315","@width":"35","@height":"35"},{"@gid":"5","@x":"105","@y":"280","@width":"35","@height":"35"},{"@gid":"2","@x":"455","@y":"315","@width":"35","@height":"35"},{"@gid":"9","@x":"490","@y":"315","@width":"35","@height":"35"},{"@gid":"13","@x":"525","@y":"315","@width":"35","@height":"35"},{"@gid":"13","@x":"525","@y":"350","@width":"35","@height":"35"},{"@gid":"10","@x":"595","@y":"385","@width":"35","@height":"35"},{"@gid":"3","@x":"560","@y":"385","@width":"35","@height":"35"},{"@gid":"3","@x":"455","@y":"385","@width":"35","@height":"35"},{"@gid":"14","@x":"595","@y":"420","@width":"35","@height":"35"},{"@gid":"9","@x":"630","@y":"420","@width":"35","@height":"35"},{"@gid":"9","@x":"665","@y":"420","@width":"35","@height":"35"},{"@gid":"3","@x":"315","@y":"385","@width":"35","@height":"35"},{"@gid":"3","@x":"350","@y":"385","@width":"35","@height":"35"},{"@gid":"3","@x":"385","@y":"385","@width":"35","@height":"35"},{"@gid":"3","@x":"420","@y":"385","@width":"35","@height":"35"},{"@gid":"2","@x":"245","@y":"385","@width":"35","@height":"35"},{"@gid":"15","@x":"490","@y":"385","@width":"35","@height":"35"},{"@gid":"15","@x":"525","@y":"385","@width":"35","@height":"35"},{"@gid":"11","@x":"490","@y":"350","@width":"35","@height":"35"},{"@gid":"10","@x":"490","@y":"490","@width":"35","@height":"35"},{"@gid":"10","@x":"140","@y":"490","@width":"35","@height":"35"},{"@gid":"9","@x":"455","@y":"490","@width":"35","@height":"35"},{"@gid":"9","@x":"420","@y":"490","@width":"35","@height":"35"},{"@gid":"9","@x":"385","@y":"490","@width":"35","@height":"35"},{"@gid":"9","@x":"350","@y":"490","@width":"35","@height":"35"},{"@gid":"9","@x":"315","@y":"490","@width":"35","@height":"35"},{"@gid":"9","@x":"35","@y":"490","@width":"35","@height":"35"},{"@gid":"9","@x":"70","@y":"490","@width":"35","@height":"35"},{"@gid":"9","@x":"105","@y":"490","@width":"35","@height":"35"},{"@gid":"9","@x":"280","@y":"490","@width":"35","@height":"35"},{"@gid":"8","@x":"245","@y":"490","@width":"35","@height":"35"},{"@gid":"9","@x":"210","@y":"525","@width":"35","@height":"35"},{"@gid":"9","@x":"175","@y":"525","@width":"35","@height":"35"},{"@gid":"9","@x":"595","@y":"525","@width":"35","@height":"35"},{"@gid":"9","@x":"560","@y":"525","@width":"35","@height":"35"},{"@gid":"9","@x":"525","@y":"525","@width":"35","@height":"35"},{"@gid":"10","@x":"0","@y":"420","@width":"35","@height":"35"},{"@gid":"13","@x":"0","@y":"455","@width":"35","@height":"35"},{"@gid":"13","@x":"105","@y":"350","@width":"35","@height":"35"},{"@gid":"8","@x":"70","@y":"350","@width":"35","@height":"35"},{"@gid":"11","@x":"630","@y":"455","@width":"35","@height":"35"},{"@gid":"11","@x":"630","@y":"490","@width":"35","@height":"35"},{"@gid":"14","@x":"70","@y":"385","@width":"35","@height":"35"},{"@gid":"4","@x":"140","@y":"385","@width":"35","@height":"35"},{"@gid":"15","@x":"105","@y":"385","@width":"35","@height":"35"},{"@gid":"16","@x":"315","@y":"175","@width":"35","@height":"35"},{"@gid":"9","@x":"245","@y":"140","@width":"35","@height":"35"},{"@gid":"15","@x":"245","@y":"175","@width":"35","@height":"35"},{"@gid":"9","@x":"280","@y":"140","@width":"35","@height":"35"},{"@gid":"15","@x":"280","@y":"175","@width":"35","@height":"35"},{"@gid":"15","@x":"385","@y":"35","@width":"35","@height":"35"},{"@gid":"15","@x":"350","@y":"35","@width":"35","@height":"35"},{"@gid":"15","@x":"420","@y":"35","@width":"35","@height":"35"},{"@gid":"3","@x":"280","@y":"385","@width":"35","@height":"35"}]},{"@name":"active",object:[{"@type":"4","@gid":"17","@x":"113","@y":"456","@width":"24","@height":"11"},{"@type":"5","@gid":"17","@x":"496","@y":"281","@width":"24","@height":"11"},{"@gid":"33","@x":"175","@y":"105","@width":"35","@height":"35"},{"@type":"4","@gid":"21","@x":"175","@y":"369","@width":"70","@height":"19",properties:{property:[{"@name":"distanceY","@value":"110"},{"@name":"speedY","@value":"70"}]}},{"@type":"4","@gid":"19","@x":"340","@y":"385","@width":"20","@height":"70","@rotation":"180"},{"@gid":"27","@x":"306","@y":"93","@width":"31","@height":"34"},{"@gid":"27","@x":"212","@y":"215","@width":"31","@height":"34"},{"@gid":"27","@x":"21","@y":"376","@width":"31","@height":"34"},{"@type":"3","@gid":"17","@x":"560","@y":"140","@width":"24","@height":"11"},{"@gid":"26","@x":"558","@y":"110","@width":"15","@height":"15"},{"@gid":"30","@x":"490","@y":"140","@width":"60","@height":"56"},{"@type":"5","@gid":"21","@x":"630","@y":"159","@width":"70","@height":"19",properties:{property:[{"@name":"distanceY","@value":"206"},{"@name":"speedY","@value":"45"}]}},{"@type":"6","@gid":"19","@x":"70","@y":"334","@width":"20","@height":"70","@rotation":"-90"},{"@type":"6","@gid":"17","@x":"144","@y":"350.5","@width":"24","@height":"11"},{"@gid":"20","@x":"154","@y":"455","@width":"20","@height":"70"},{"@type":"3","@gid":"19","@x":"420","@y":"159.5","@width":"20","@height":"70","@rotation":"-90"},{"@gid":"26","@x":"523","@y":"426","@width":"15","@height":"15"},{"@gid":"31","@x":"441","@y":"351","@width":"50","@height":"29"},{"@gid":"26","@x":"245","@y":"335","@width":"15","@height":"15"},{"@gid":"44","@x":"245","@y":"280","@width":"232","@height":"79",properties:{property:{"@name":"text","@value":"level_text_17"}}},{"@gid":"29","@x":"350","@y":"455","@width":"60","@height":"55"}]},{"@name":"characters",object:[{"@gid":"24","@x":"60","@y":"317","@width":"44","@height":"52"},{"@gid":"28","@x":"560","@y":"350","@width":"63","@height":"50"}]},{"@name":"physics",object:[{"@x":"0","@y":"385","@width":"35","@height":"140"},{"@x":"35","@y":"455","@width":"140","@height":"70"},{"@x":"175","@y":"490","@width":"525","@height":"35"},{"@x":"245","@y":"455","@width":"280","@height":"35"},{"@x":"630","@y":"385","@width":"70","@height":"105"},{"@x":"595","@y":"385","@width":"35","@height":"35"},{"@x":"245","@y":"350","@width":"385","@height":"35"},{"@x":"525","@y":"175","@width":"35","@height":"105"},{"@x":"420","@y":"140","@width":"210","@height":"35"},{"@x":"175","@y":"105","@width":"175","@height":"70"},{"@x":"105","@y":"245","@width":"35","@height":"70"},{"@x":"70","@y":"315","@width":"70","@height":"70"},{"@x":"140","@y":"350","@width":"35","@height":"35"},{"@x":"105","@y":"0","@width":"35","@height":"210"},{"@x":"455","@y":"0","@width":"245","@height":"70"},{"@x":"140","@y":"0","@width":"315","@height":"35"},{"@x":"0","@y":"70","@width":"105","@height":"35"},{"@x":"455","@y":"280","@width":"105","@height":"35"},{"@x":"490","@y":"315","@width":"70","@height":"35"},{"@x":"450","@y":"338","@width":"29","@height":"10"}]}]},{"@level":"17","@version":"1.0","@orientation":"orthogonal","@renderorder":"right-down","@width":"20","@height":"15","@tilewidth":"35","@tileheight":"35","@nextobjectid":"154",tileset:[{"@firstgid":"1","@name":"tiles","@tilewidth":"35","@tileheight":"35","@tilecount":"16",tile:[{"@id":"0",image:{"@width":"35","@height":"35","@source":"tiles/singleTile.png"}},{"@id":"1",image:{"@width":"35","@height":"35","@source":"tiles/platformLeft.png"}},{"@id":"2",image:{"@width":"35","@height":"35","@source":"tiles/platformCenter.png"}},{"@id":"3",image:{"@width":"35","@height":"35","@source":"tiles/platformRight.png"}},{"@id":"4",image:{"@width":"35","@height":"35","@source":"tiles/verticalPlatformTop.png"}},{"@id":"5",image:{"@width":"35","@height":"35","@source":"tiles/verticalPlatformCenter.png"}},{"@id":"6",image:{"@width":"35","@height":"35","@source":"tiles/verticalPlatformBottom.png"}},{"@id":"7",image:{"@width":"35","@height":"35","@source":"tiles/tileTopLeft.png"}},{"@id":"8",image:{"@width":"35","@height":"35","@source":"tiles/tileTopCenter.png"}},{"@id":"9",image:{"@width":"35","@height":"35","@source":"tiles/tileTopRight.png"}},{"@id":"10",image:{"@width":"35","@height":"35","@source":"tiles/tileCenterLeft.png"}},{"@id":"11",image:{"@width":"35","@height":"35","@source":"tiles/tileCenter.png"}},{"@id":"12",image:{"@width":"35","@height":"35","@source":"tiles/tileCenterRight.png"}},{"@id":"13",image:{"@width":"35","@height":"35","@source":"tiles/tileBottomLeft.png"}},{"@id":"14",image:{"@width":"35","@height":"35","@source":"tiles/tileBottomCenter.png"}},{"@id":"15",image:{"@width":"35","@height":"35","@source":"tiles/tileBottomRight.png"}}]},{"@firstgid":"17","@name":"active","@tilewidth":"105","@tileheight":"70","@tilecount":"15",tile:[{"@id":"0",image:{"@width":"24","@height":"11","@source":"active/PushButtonGraphics.png"}},{"@id":"1",image:{"@width":"25","@height":"19","@source":"active/TriggerGraphics.png"}},{"@id":"2",image:{"@width":"20","@height":"70","@source":"active/DoorGraphics.png"}},{"@id":"3",image:{"@width":"20","@height":"70","@source":"active/GlassDoorGraphics.png"}},{"@id":"4",image:{"@width":"70","@height":"19","@source":"active/ElevatorGraphics.png"}},{"@id":"5",image:{"@width":"105","@height":"20","@source":"active/BigElevatorGraphics.png"}},{"@id":"6",image:{"@width":"70","@height":"70","@source":"active/ExitGraphics.png"}},{"@id":"7",image:{"@width":"44","@height":"52","@source":"characters/HustlerGraphics.png"}},{"@id":"8",image:{"@width":"32","@height":"22","@source":"active/CameraGraphics.png"}},{"@id":"9",image:{"@width":"15","@height":"15","@source":"characters/EnemyLimiterGraphics.png"}},{"@id":"10",image:{"@width":"31","@height":"34","@source":"passive/MoneyBagGraphics.png"}},{"@id":"11",image:{"@width":"63","@height":"50","@source":"characters/DogGraphics.png"}},{"@id":"12",image:{"@width":"60","@height":"55","@source":"characters/Prisoner2Graphics.png"}},{"@id":"13",image:{"@width":"60","@height":"56","@source":"characters/PrisonerGraphics.png"}},{"@id":"14",image:{"@width":"50","@height":"29","@source":"active/TurrelGraphics.png"}}]},{"@firstgid":"32","@name":"passive","@tilewidth":"210","@tileheight":"50","@tilecount":"12",tile:[{"@id":"0",image:{"@width":"50","@height":"50","@source":"passive/BigBoxGraphics.png"}},{"@id":"1",image:{"@width":"35","@height":"35","@source":"passive/BoxGraphics.png"}},{"@id":"2",image:{"@width":"37","@height":"35","@source":"passive/ToiletGraphics.png"}},{"@id":"3",image:{"@width":"35","@height":"35","@source":"passive/MonitorGraphics.png"}},{"@id":"4",image:{"@width":"35","@height":"35","@source":"passive/BasketBallGraphics.png"}},{"@id":"5",image:{"@width":"35","@height":"35","@source":"passive/StoolGraphics.png"}},{"@id":"6",image:{"@width":"150","@height":"20","@source":"passive/PlankGraphics.png"}},{"@id":"7",image:{"@width":"150","@height":"20","@source":"passive/Plank2Graphics.png"}},{"@id":"8",image:{"@width":"210","@height":"20","@source":"passive/BigPlankGraphics.png"}},{"@id":"9",image:{"@width":"100","@height":"20","@source":"passive/Plank5Graphics.png"}},{"@id":"10",image:{"@width":"150","@height":"20","@source":"passive/Plank2Graphics.png"}},{"@id":"11",image:{"@width":"35","@height":"35","@source":"passive/MirrorGraphics.png"}}]},{"@firstgid":"44","@name":"decor","@tilewidth":"232","@tileheight":"136","@tilecount":"43",tile:[{"@id":"0",image:{"@width":"232","@height":"79","@source":"decor/LevelTextGraphics.png"}},{"@id":"1",image:{"@width":"54","@height":"20","@source":"decor/Decor1Graphics.png"}},{"@id":"2",image:{"@width":"54","@height":"20","@source":"decor/Decor2Graphics.png"}},{"@id":"3",image:{"@width":"33","@height":"27","@source":"decor/Decor3Graphics.png"}},{"@id":"4",image:{"@width":"34","@height":"25","@source":"decor/Decor4Graphics.png"}},{"@id":"5",image:{"@width":"22","@height":"31","@source":"decor/Decor5Graphics.png"}},{"@id":"6",image:{"@width":"126","@height":"59","@source":"decor/Decor6Graphics.png"}},{"@id":"7",image:{"@width":"25","@height":"21","@source":"decor/Decor8Graphics.png"}},{"@id":"8",image:{"@width":"18","@height":"22","@source":"decor/Decor9Graphics.png"}},{"@id":"9",image:{"@width":"35","@height":"58","@source":"decor/Decor10Graphics.png"}},{"@id":"10",image:{"@width":"19","@height":"66","@source":"decor/Decor11Graphics.png"}},{"@id":"11",image:{"@width":"23","@height":"33","@source":"decor/Decor12Graphics.png"}},{"@id":"12",image:{"@width":"38","@height":"26","@source":"decor/Decor13Graphics.png"}},{"@id":"13",image:{"@width":"43","@height":"78","@source":"decor/Decor14Graphics.png"}},{"@id":"14",image:{"@width":"60","@height":"86","@source":"decor/Decor15Graphics.png"}},{"@id":"15",image:{"@width":"41","@height":"69","@source":"decor/Decor16Graphics.png"}},{"@id":"16",image:{"@width":"55","@height":"58","@source":"decor/Decor17Graphics.png"}},{"@id":"17",image:{"@width":"57","@height":"54","@source":"decor/Decor18Graphics.png"}},{"@id":"18",image:{"@width":"18","@height":"45","@source":"decor/Decor19Graphics.png"}},{"@id":"19",image:{"@width":"41","@height":"49","@source":"decor/Decor20Graphics.png"}},{"@id":"20",image:{"@width":"51","@height":"38","@source":"decor/Decor21Graphics.png"}},{"@id":"21",image:{"@width":"54","@height":"54","@source":"decor/Decor22Graphics.png"}},{"@id":"22",image:{"@width":"63","@height":"136","@source":"decor/Decor23Graphics.png"}},{"@id":"23",image:{"@width":"21","@height":"39","@source":"decor/Decor24Graphics.png"}},{"@id":"24",image:{"@width":"104","@height":"50","@source":"decor/Decor25Graphics.png"}},{"@id":"25",image:{"@width":"104","@height":"46","@source":"decor/Decor26Graphics.png"}},{"@id":"26",image:{"@width":"86","@height":"38","@source":"decor/Decor27Graphics.png"}},{"@id":"27",image:{"@width":"63","@height":"55","@source":"decor/Decor28Graphics.png"}},{"@id":"28",image:{"@width":"13","@height":"23","@source":"decor/Decor29Graphics.png"}},{"@id":"29",image:{"@width":"28","@height":"40","@source":"decor/Decor30Graphics.png"}},{"@id":"30",image:{"@width":"69","@height":"30","@source":"decor/Decor31Graphics.png"}},{"@id":"31",image:{"@width":"33","@height":"29","@source":"decor/Decor32Graphics.png"}},{"@id":"32",image:{"@width":"42","@height":"42","@source":"decor/Decor33Graphics.png"}},{"@id":"33",image:{"@width":"60","@height":"66","@source":"decor/Decor34Graphics.png"}},{"@id":"34",image:{"@width":"46","@height":"65","@source":"decor/Decor35Graphics.png"}},{"@id":"35",image:{"@width":"71","@height":"55","@source":"decor/Decor36Graphics.png"}},{"@id":"36",image:{"@width":"35","@height":"55","@source":"decor/Decor37Graphics.png"}},{"@id":"37",image:{"@width":"28","@height":"29","@source":"decor/Decor38Graphics.png"}},{"@id":"38",image:{"@width":"38","@height":"37","@source":"decor/Decor39Graphics.png"}},{"@id":"39",image:{"@width":"103","@height":"50","@source":"decor/Decor40Graphics.png"}},{"@id":"40",image:{"@width":"56","@height":"55","@source":"decor/Decor41Graphics.png"}},{"@id":"41",image:{"@width":"71","@height":"50","@source":"decor/Decor42Graphics.png"}},{"@id":"42",image:{"@width":"200","@height":"44","@source":"decor/TxtGraphics.png"}}]}],imagelayer:{"@name":"background",image:{"@source":"bg/Background1Graphics.png"}},objectgroup:[{"@name":"decorations",object:[{"@id":"1","@gid":"44","@x":"140","@y":"175","@width":"232","@height":"79",properties:{property:{"@name":"text","@value":"level_text_18"}}},{"@id":"2","@gid":"50","@x":"164","@y":"280","@width":"126","@height":"59"},{"@id":"3","@gid":"57","@x":"221","@y":"472","@width":"43","@height":"78"},{"@id":"4","@gid":"71","@x":"5","@y":"323","@width":"63","@height":"55"},{"@id":"5","@gid":"85","@x":"385","@y":"490","@width":"71","@height":"50"},{"@id":"6","@gid":"84","@x":"509","@y":"208","@width":"56","@height":"55"},{"@id":"7","@gid":"30","@x":"420","@y":"210","@width":"60","@height":"56"},{"@id":"8","@gid":"29","@x":"385","@y":"350","@width":"60","@height":"55"},{"@id":"9","@gid":"66","@x":"595","@y":"175","@width":"63","@height":"136"},{"@id":"10","@gid":"69","@x":"490","@y":"105","@width":"104","@height":"46"},{"@id":"11","@gid":"76","@x":"442","@y":"338","@width":"42","@height":"42"},{"@id":"12","@gid":"53","@x":"622","@y":"315","@width":"35","@height":"58"}]},{"@name":"tiles",object:[{"@id":"13","@gid":"12","@x":"245","@y":"525","@width":"35","@height":"35"},{"@id":"14","@gid":"9","@x":"420","@y":"525","@width":"35","@height":"35"},{"@id":"15","@gid":"9","@x":"385","@y":"525","@width":"35","@height":"35"},{"@id":"16","@gid":"9","@x":"315","@y":"525","@width":"35","@height":"35"},{"@id":"17","@gid":"9","@x":"350","@y":"525","@width":"35","@height":"35"},{"@id":"18","@gid":"9","@x":"105","@y":"525","@width":"35","@height":"35"},{"@id":"19","@gid":"9","@x":"140","@y":"525","@width":"35","@height":"35"},{"@id":"20","@gid":"9","@x":"280","@y":"525","@width":"35","@height":"35"},{"@id":"21","@gid":"9","@x":"70","@y":"525","@width":"35","@height":"35"},{"@id":"22","@gid":"12","@x":"490","@y":"525","@width":"35","@height":"35"},{"@id":"23","@gid":"12","@x":"665","@y":"350","@width":"35","@height":"35"},{"@id":"24","@gid":"12","@x":"665","@y":"525","@width":"35","@height":"35"},{"@id":"25","@gid":"12","@x":"525","@y":"525","@width":"35","@height":"35"},{"@id":"26","@gid":"12","@x":"665","@y":"455","@width":"35","@height":"35"},{"@id":"27","@gid":"12","@x":"665","@y":"420","@width":"35","@height":"35"},{"@id":"28","@gid":"12","@x":"665","@y":"385","@width":"35","@height":"35"},{"@id":"29","@gid":"12","@x":"630","@y":"490","@width":"35","@height":"35"},{"@id":"30","@gid":"12","@x":"665","@y":"490","@width":"35","@height":"35"},{"@id":"31","@gid":"12","@x":"595","@y":"525","@width":"35","@height":"35"},{"@id":"32","@gid":"12","@x":"560","@y":"525","@width":"35","@height":"35"},{"@id":"33","@gid":"12","@x":"630","@y":"525","@width":"35","@height":"35"},{"@id":"34","@gid":"12","@x":"420","@y":"35","@width":"35","@height":"35"},{"@id":"35","@gid":"12","@x":"0","@y":"525","@width":"35","@height":"35"},{"@id":"36","@gid":"12","@x":"35","@y":"525","@width":"35","@height":"35"},{"@id":"37","@gid":"12","@x":"210","@y":"525","@width":"35","@height":"35"},{"@id":"38","@gid":"9","@x":"455","@y":"525","@width":"35","@height":"35"},{"@id":"39","@gid":"9","@x":"595","@y":"490","@width":"35","@height":"35"},{"@id":"40","@gid":"9","@x":"560","@y":"490","@width":"35","@height":"35"},{"@id":"41","@gid":"9","@x":"525","@y":"490","@width":"35","@height":"35"},{"@id":"42","@gid":"10","@x":"245","@y":"490","@width":"35","@height":"35"},{"@id":"43","@gid":"10","@x":"35","@y":"490","@width":"35","@height":"35"},{"@id":"44","@gid":"8","@x":"210","@y":"490","@width":"35","@height":"35"},{"@id":"45","@gid":"8","@x":"490","@y":"490","@width":"35","@height":"35"},{"@id":"46","@gid":"8","@x":"490","@y":"350","@width":"35","@height":"35"},{"@id":"47","@gid":"8","@x":"630","@y":"350","@width":"35","@height":"35"},{"@id":"48","@gid":"8","@x":"665","@y":"315","@width":"35","@height":"35"},{"@id":"49","@gid":"8","@x":"385","@y":"245","@width":"35","@height":"35"},{"@id":"50","@gid":"8","@x":"350","@y":"385","@width":"35","@height":"35"},{"@id":"51","@gid":"8","@x":"70","@y":"175","@width":"35","@height":"35"},{"@id":"52","@gid":"11","@x":"630","@y":"455","@width":"35","@height":"35"},{"@id":"53","@gid":"11","@x":"630","@y":"420","@width":"35","@height":"35"},{"@id":"54","@gid":"11","@x":"630","@y":"385","@width":"35","@height":"35"},{"@id":"55","@gid":"9","@x":"385","@y":"385","@width":"35","@height":"35"},{"@id":"56","@gid":"14","@x":"350","@y":"420","@width":"35","@height":"35"},{"@id":"57","@gid":"14","@x":"70","@y":"385","@width":"35","@height":"35"},{"@id":"58","@gid":"14","@x":"70","@y":"245","@width":"35","@height":"35"},{"@id":"59","@gid":"14","@x":"385","@y":"140","@width":"35","@height":"35"},{"@id":"60","@gid":"16","@x":"385","@y":"420","@width":"35","@height":"35"},{"@id":"61","@gid":"3","@x":"420","@y":"140","@width":"35","@height":"35"},{"@id":"62","@gid":"3","@x":"525","@y":"245","@width":"35","@height":"35"},{"@id":"63","@gid":"3","@x":"490","@y":"245","@width":"35","@height":"35"},{"@id":"64","@gid":"3","@x":"420","@y":"385","@width":"35","@height":"35"},{"@id":"65","@gid":"3","@x":"455","@y":"385","@width":"35","@height":"35"},{"@id":"66","@gid":"3","@x":"140","@y":"385","@width":"35","@height":"35"},{"@id":"67","@gid":"3","@x":"175","@y":"385","@width":"35","@height":"35"},{"@id":"68","@gid":"3","@x":"210","@y":"385","@width":"35","@height":"35"},{"@id":"69","@gid":"3","@x":"245","@y":"385","@width":"35","@height":"35"},{"@id":"70","@gid":"4","@x":"525","@y":"350","@width":"35","@height":"35"},{"@id":"71","@gid":"16","@x":"490","@y":"385","@width":"35","@height":"35"},{"@id":"72","@gid":"4","@x":"280","@y":"385","@width":"35","@height":"35"},{"@id":"73","@gid":"7","@x":"105","@y":"455","@width":"35","@height":"35"},{"@id":"74","@gid":"6","@x":"105","@y":"420","@width":"35","@height":"35"},{"@id":"75","@gid":"9","@x":"105","@y":"385","@width":"35","@height":"35"},{"@id":"76","@gid":"13","@x":"70","@y":"350","@width":"35","@height":"35"},{"@id":"77","@gid":"5","@x":"70","@y":"315","@width":"35","@height":"35"},{"@id":"78","@gid":"3","@x":"35","@y":"350","@width":"35","@height":"35"},{"@id":"79","@gid":"3","@x":"0","@y":"350","@width":"35","@height":"35"},{"@id":"80","@gid":"6","@x":"70","@y":"210","@width":"35","@height":"35"},{"@id":"81","@gid":"4","@x":"105","@y":"245","@width":"35","@height":"35"},{"@id":"82","@gid":"16","@x":"105","@y":"175","@width":"35","@height":"35"},{"@id":"83","@gid":"6","@x":"105","@y":"140","@width":"35","@height":"35"},{"@id":"84","@gid":"6","@x":"105","@y":"105","@width":"35","@height":"35"},{"@id":"85","@gid":"6","@x":"105","@y":"70","@width":"35","@height":"35"},{"@id":"86","@gid":"13","@x":"105","@y":"35","@width":"35","@height":"35"},{"@id":"87","@gid":"15","@x":"70","@y":"35","@width":"35","@height":"35"},{"@id":"88","@gid":"15","@x":"35","@y":"35","@width":"35","@height":"35"},{"@id":"89","@gid":"15","@x":"0","@y":"35","@width":"35","@height":"35"},{"@id":"90","@gid":"15","@x":"455","@y":"140","@width":"35","@height":"35"},{"@id":"91","@gid":"6","@x":"455","@y":"105","@width":"35","@height":"35"},{"@id":"92","@gid":"6","@x":"385","@y":"105","@width":"35","@height":"35"},{"@id":"93","@gid":"15","@x":"420","@y":"70","@width":"35","@height":"35"},{"@id":"94","@gid":"13","@x":"455","@y":"70","@width":"35","@height":"35"},{"@id":"95","@gid":"13","@x":"455","@y":"35","@width":"35","@height":"35"},{"@id":"96","@gid":"11","@x":"385","@y":"35","@width":"35","@height":"35"},{"@id":"97","@gid":"11","@x":"385","@y":"70","@width":"35","@height":"35"},{"@id":"98","@gid":"3","@x":"490","@y":"140","@width":"35","@height":"35"},{"@id":"99","@gid":"3","@x":"525","@y":"140","@width":"35","@height":"35"},{"@id":"100","@gid":"10","@x":"560","@y":"140","@width":"35","@height":"35"},{"@id":"101","@gid":"6","@x":"560","@y":"175","@width":"35","@height":"35"},{"@id":"102","@gid":"6","@x":"560","@y":"210","@width":"35","@height":"35"},{"@id":"103","@gid":"15","@x":"560","@y":"245","@width":"35","@height":"35"},{"@id":"104","@gid":"4","@x":"595","@y":"245","@width":"35","@height":"35"},{"@id":"105","@gid":"16","@x":"455","@y":"280","@width":"35","@height":"35"},{"@id":"106","@gid":"9","@x":"420","@y":"245","@width":"35","@height":"35"},{"@id":"107","@gid":"9","@x":"455","@y":"245","@width":"35","@height":"35"},{"@id":"108","@gid":"15","@x":"385","@y":"280","@width":"35","@height":"35"},{"@id":"109","@gid":"15","@x":"420","@y":"280","@width":"35","@height":"35"},{"@id":"110","@gid":"2","@x":"350","@y":"280","@width":"35","@height":"35"},{"@id":"111","@gid":"9","@x":"175","@y":"525","@width":"35","@height":"35"},{"@id":"112","@gid":"9","@x":"0","@y":"490","@width":"35","@height":"35"}]},{"@name":"active",object:[{"@id":"113","@type":"4","@gid":"19","@x":"350","@y":"370","@width":"20","@height":"70","@rotation":"-90"},{"@id":"114","@type":"5","@gid":"21","@x":"559","@y":"448","@width":"70","@height":"19",properties:{property:[{"@name":"distanceY","@value":"110"},{"@name":"speedY","@value":"-45"}]}},{"@id":"115","@type":"2","@gid":"19","@x":"420","@y":"77","@width":"20","@height":"70","@rotation":"90"},{"@id":"116","@type":"6","@gid":"19","@x":"371","@y":"280","@width":"20","@height":"70","@rotation":"180"},{"@id":"117","@type":"6","@gid":"17","@x":"500","@y":"316.5","@width":"24","@height":"11"},{"@id":"118","@type":"2","@gid":"17","@x":"600","@y":"211.5","@width":"24","@height":"11"},{"@id":"119","@type":"4","@gid":"17","@x":"229","@y":"456.5","@width":"24","@height":"11"},{"@id":"120","@gid":"27","@x":"21","@y":"400","@width":"31","@height":"34"},{"@id":"121","@gid":"27","@x":"575","@y":"296","@width":"31","@height":"34"},{"@id":"122","@gid":"27","@x":"217","@y":"249","@width":"31","@height":"34"},{"@id":"123","@gid":"26","@x":"400","@y":"182","@width":"15","@height":"15"},{"@id":"124","@gid":"40","@x":"365","@y":"34","@width":"210","@height":"20","@rotation":"90"},{"@id":"125","@type":"4","@gid":"21","@x":"5.68434e-14","@y":"160.5","@width":"70","@height":"19",properties:{property:[{"@name":"distanceY","@value":"140"},{"@name":"speedY","@value":"45"}]}},{"@id":"126","@type":"5","@gid":"17","@x":"20","@y":"456.5","@width":"24","@height":"11"},{"@id":"127","@gid":"30","@x":"138","@y":"351","@width":"60","@height":"56",properties:{property:[{"@name":"limitLeft","@value":"0"},{"@name":"limitRight","@value":"100"}]}},{"@id":"128","@gid":"2147483679","@x":"106","@y":"212","@width":"50","@height":"29"}]},{"@name":"characters",object:[{"@id":"129","@gid":"24","@x":"14","@y":"144","@width":"44","@height":"52"},{"@id":"130","@gid":"28","@x":"309","@y":"490","@width":"63","@height":"50"}]},{"@name":"physics",object:[{"@id":"131","@x":"0","@y":"455","@width":"70","@height":"70"},{"@id":"132","@x":"70","@y":"490","@width":"630","@height":"35"},{"@id":"133","@x":"210","@y":"455","@width":"70","@height":"35"},{"@id":"134","@x":"490","@y":"455","@width":"210","@height":"35"},{"@id":"135","@x":"630","@y":"315","@width":"70","@height":"140"},{"@id":"136","@x":"665","@y":"280","@width":"35","@height":"35"},{"@id":"137","@x":"490","@y":"315","@width":"70","@height":"35"},{"@id":"138","@x":"350","@y":"350","@width":"175","@height":"35"},{"@id":"139","@x":"350","@y":"385","@width":"70","@height":"35"},{"@id":"140","@x":"70","@y":"350","@width":"245","@height":"35"},{"@id":"141","@x":"105","@y":"385","@width":"35","@height":"70"},{"@id":"142","@x":"0","@y":"315","@width":"105","@height":"35"},{"@id":"143","@x":"70","@y":"280","@width":"35","@height":"35"},{"@id":"144","@x":"350","@y":"245","@width":"140","@height":"35"},{"@id":"145","@x":"385","@y":"210","@width":"245","@height":"35"},{"@id":"146","@x":"560","@y":"140","@width":"35","@height":"70"},{"@id":"147","@x":"385","@y":"105","@width":"210","@height":"35"},{"@id":"148","@x":"385","@y":"0","@width":"105","@height":"105"},{"@id":"149","@x":"70","@y":"210","@width":"70","@height":"35"},{"@id":"151","@x":"70","@y":"140","@width":"35","@height":"70"},{"@id":"152","@x":"105","@y":"0","@width":"35","@height":"175"},{"@id":"153","@x":"0","@y":"0","@width":"105","@height":"35"}]}]},{"@level":"18","@version":"1.0","@orientation":"orthogonal","@renderorder":"right-down","@width":"20","@height":"15","@tilewidth":"35","@tileheight":"35","@nextobjectid":"154",tileset:[{"@firstgid":"1","@name":"tiles","@tilewidth":"35","@tileheight":"35","@tilecount":"16",tile:[{"@id":"0",image:{"@width":"35","@height":"35","@source":"tiles/singleTile.png"}},{"@id":"1",image:{"@width":"35","@height":"35","@source":"tiles/platformLeft.png"}},{"@id":"2",image:{"@width":"35","@height":"35","@source":"tiles/platformCenter.png"}},{"@id":"3",image:{"@width":"35","@height":"35","@source":"tiles/platformRight.png"}},{"@id":"4",image:{"@width":"35","@height":"35","@source":"tiles/verticalPlatformTop.png"}},{"@id":"5",image:{"@width":"35","@height":"35","@source":"tiles/verticalPlatformCenter.png"}},{"@id":"6",image:{"@width":"35","@height":"35","@source":"tiles/verticalPlatformBottom.png"}},{"@id":"7",image:{"@width":"35","@height":"35","@source":"tiles/tileTopLeft.png"}},{"@id":"8",image:{"@width":"35","@height":"35","@source":"tiles/tileTopCenter.png"}},{"@id":"9",image:{"@width":"35","@height":"35","@source":"tiles/tileTopRight.png"}},{"@id":"10",image:{"@width":"35","@height":"35","@source":"tiles/tileCenterLeft.png"}},{"@id":"11",image:{"@width":"35","@height":"35","@source":"tiles/tileCenter.png"}},{"@id":"12",image:{"@width":"35","@height":"35","@source":"tiles/tileCenterRight.png"}},{"@id":"13",image:{"@width":"35","@height":"35","@source":"tiles/tileBottomLeft.png"}},{"@id":"14",image:{"@width":"35","@height":"35","@source":"tiles/tileBottomCenter.png"}},{"@id":"15",image:{"@width":"35","@height":"35","@source":"tiles/tileBottomRight.png"}}]},{"@firstgid":"17","@name":"active","@tilewidth":"105","@tileheight":"70","@tilecount":"15",tile:[{"@id":"0",image:{"@width":"24","@height":"11","@source":"active/PushButtonGraphics.png"}},{"@id":"1",image:{"@width":"25","@height":"19","@source":"active/TriggerGraphics.png"}},{"@id":"2",image:{"@width":"20","@height":"70","@source":"active/DoorGraphics.png"}},{"@id":"3",image:{"@width":"20","@height":"70","@source":"active/GlassDoorGraphics.png"}},{"@id":"4",image:{"@width":"70","@height":"19","@source":"active/ElevatorGraphics.png"}},{"@id":"5",image:{"@width":"105","@height":"20","@source":"active/BigElevatorGraphics.png"}},{"@id":"6",image:{"@width":"70","@height":"70","@source":"active/ExitGraphics.png"}},{"@id":"7",image:{"@width":"44","@height":"52","@source":"characters/HustlerGraphics.png"}},{"@id":"8",image:{"@width":"32","@height":"22","@source":"active/CameraGraphics.png"}},{"@id":"9",image:{"@width":"15","@height":"15","@source":"characters/EnemyLimiterGraphics.png"}},{"@id":"10",image:{"@width":"31","@height":"34","@source":"passive/MoneyBagGraphics.png"}},{"@id":"11",image:{"@width":"63","@height":"50","@source":"characters/DogGraphics.png"}},{"@id":"12",image:{"@width":"60","@height":"55","@source":"characters/Prisoner2Graphics.png"}},{"@id":"13",image:{"@width":"60","@height":"56","@source":"characters/PrisonerGraphics.png"}},{"@id":"14",image:{"@width":"50","@height":"29","@source":"active/TurrelGraphics.png"}}]},{"@firstgid":"32","@name":"passive","@tilewidth":"210","@tileheight":"50","@tilecount":"12",tile:[{"@id":"0",image:{"@width":"50","@height":"50","@source":"passive/BigBoxGraphics.png"}},{"@id":"1",image:{"@width":"35","@height":"35","@source":"passive/BoxGraphics.png"}},{"@id":"2",image:{"@width":"37","@height":"35","@source":"passive/ToiletGraphics.png"}},{"@id":"3",image:{"@width":"35","@height":"35","@source":"passive/MonitorGraphics.png"}},{"@id":"4",image:{"@width":"35","@height":"35","@source":"passive/BasketBallGraphics.png"}},{"@id":"5",image:{"@width":"35","@height":"35","@source":"passive/StoolGraphics.png"}},{"@id":"6",image:{"@width":"150","@height":"20","@source":"passive/PlankGraphics.png"}},{"@id":"7",image:{"@width":"150","@height":"20","@source":"passive/Plank2Graphics.png"}},{"@id":"8",image:{"@width":"210","@height":"20","@source":"passive/BigPlankGraphics.png"}},{"@id":"9",image:{"@width":"100","@height":"20","@source":"passive/Plank5Graphics.png"}},{"@id":"10",image:{"@width":"150","@height":"20","@source":"passive/Plank2Graphics.png"}},{"@id":"11",image:{"@width":"35","@height":"35","@source":"passive/MirrorGraphics.png"}}]},{"@firstgid":"44","@name":"decor","@tilewidth":"232","@tileheight":"136","@tilecount":"43",tile:[{"@id":"0",image:{"@width":"232","@height":"79","@source":"decor/LevelTextGraphics.png"}},{"@id":"1",image:{"@width":"54","@height":"20","@source":"decor/Decor1Graphics.png"}},{"@id":"2",image:{"@width":"54","@height":"20","@source":"decor/Decor2Graphics.png"}},{"@id":"3",image:{"@width":"33","@height":"27","@source":"decor/Decor3Graphics.png"}},{"@id":"4",image:{"@width":"34","@height":"25","@source":"decor/Decor4Graphics.png"}},{"@id":"5",image:{"@width":"22","@height":"31","@source":"decor/Decor5Graphics.png"}},{"@id":"6",image:{"@width":"126","@height":"59","@source":"decor/Decor6Graphics.png"}},{"@id":"7",image:{"@width":"25","@height":"21","@source":"decor/Decor8Graphics.png"}},{"@id":"8",image:{"@width":"18","@height":"22","@source":"decor/Decor9Graphics.png"}},{"@id":"9",image:{"@width":"35","@height":"58","@source":"decor/Decor10Graphics.png"}},{"@id":"10",image:{"@width":"19","@height":"66","@source":"decor/Decor11Graphics.png"}},{"@id":"11",image:{"@width":"23","@height":"33","@source":"decor/Decor12Graphics.png"}},{"@id":"12",image:{"@width":"38","@height":"26","@source":"decor/Decor13Graphics.png"}},{"@id":"13",image:{"@width":"43","@height":"78","@source":"decor/Decor14Graphics.png"}},{"@id":"14",image:{"@width":"60","@height":"86","@source":"decor/Decor15Graphics.png"}},{"@id":"15",image:{"@width":"41","@height":"69","@source":"decor/Decor16Graphics.png"}},{"@id":"16",image:{"@width":"55","@height":"58","@source":"decor/Decor17Graphics.png"}},{"@id":"17",image:{"@width":"57","@height":"54","@source":"decor/Decor18Graphics.png"}},{"@id":"18",image:{"@width":"18","@height":"45","@source":"decor/Decor19Graphics.png"}},{"@id":"19",image:{"@width":"41","@height":"49","@source":"decor/Decor20Graphics.png"}},{"@id":"20",image:{"@width":"51","@height":"38","@source":"decor/Decor21Graphics.png"}},{"@id":"21",image:{"@width":"54","@height":"54","@source":"decor/Decor22Graphics.png"}},{"@id":"22",image:{"@width":"63","@height":"136","@source":"decor/Decor23Graphics.png"}},{"@id":"23",image:{"@width":"21","@height":"39","@source":"decor/Decor24Graphics.png"}},{"@id":"24",image:{"@width":"104","@height":"50","@source":"decor/Decor25Graphics.png"}},{"@id":"25",image:{"@width":"104","@height":"46","@source":"decor/Decor26Graphics.png"}},{"@id":"26",image:{"@width":"86","@height":"38","@source":"decor/Decor27Graphics.png"}},{"@id":"27",image:{"@width":"63","@height":"55","@source":"decor/Decor28Graphics.png"}},{"@id":"28",image:{"@width":"13","@height":"23","@source":"decor/Decor29Graphics.png"}},{"@id":"29",image:{"@width":"28","@height":"40","@source":"decor/Decor30Graphics.png"}},{"@id":"30",image:{"@width":"69","@height":"30","@source":"decor/Decor31Graphics.png"}},{"@id":"31",image:{"@width":"33","@height":"29","@source":"decor/Decor32Graphics.png"}},{"@id":"32",image:{"@width":"42","@height":"42","@source":"decor/Decor33Graphics.png"}},{"@id":"33",image:{"@width":"60","@height":"66","@source":"decor/Decor34Graphics.png"}},{"@id":"34",image:{"@width":"46","@height":"65","@source":"decor/Decor35Graphics.png"}},{"@id":"35",image:{"@width":"71","@height":"55","@source":"decor/Decor36Graphics.png"}},{"@id":"36",image:{"@width":"35","@height":"55","@source":"decor/Decor37Graphics.png"}},{"@id":"37",image:{"@width":"28","@height":"29","@source":"decor/Decor38Graphics.png"}},{"@id":"38",image:{"@width":"38","@height":"37","@source":"decor/Decor39Graphics.png"}},{"@id":"39",image:{"@width":"103","@height":"50","@source":"decor/Decor40Graphics.png"}},{"@id":"40",image:{"@width":"56","@height":"55","@source":"decor/Decor41Graphics.png"}},{"@id":"41",image:{"@width":"71","@height":"50","@source":"decor/Decor42Graphics.png"}},{"@id":"42",image:{"@width":"200","@height":"44","@source":"decor/TxtGraphics.png"}}]}],imagelayer:{"@name":"background","@y":"1",image:{"@source":"bg/Background1Graphics.png"}},objectgroup:[{"@name":"decorations",object:[{"@id":"1","@gid":"45","@x":"36","@y":"299","@width":"54","@height":"20"},{"@id":"2","@gid":"53","@x":"595","@y":"455","@width":"35","@height":"58"},{"@id":"3","@gid":"57","@x":"330","@y":"386","@width":"43","@height":"78"},{"@id":"4","@gid":"59","@x":"579","@y":"325","@width":"41","@height":"69"},{"@id":"5","@gid":"70","@x":"35","@y":"245","@width":"86","@height":"38"},{"@id":"6","@gid":"69","@x":"35","@y":"455","@width":"104","@height":"46"},{"@id":"7","@gid":"78","@x":"70","@y":"385","@width":"46","@height":"65"},{"@id":"8","@gid":"44","@x":"424","@y":"169.5","@width":"232","@height":"79",properties:{property:{"@name":"text","@value":"level_text_19"}}}]},{"@name":"tiles",object:[{"@id":"9","@gid":"12","@x":"0","@y":"525","@width":"35","@height":"35"},{"@id":"10","@gid":"12","@x":"420","@y":"350","@width":"35","@height":"35"},{"@id":"11","@gid":"12","@x":"-132","@y":"-197","@width":"35","@height":"35"},{"@id":"12","@gid":"12","@x":"-97","@y":"-197","@width":"35","@height":"35"},{"@id":"13","@gid":"12","@x":"-62","@y":"-197","@width":"35","@height":"35"},{"@id":"14","@gid":"12","@x":"35","@y":"525","@width":"35","@height":"35"},{"@id":"15","@gid":"12","@x":"245","@y":"385","@width":"35","@height":"35"},{"@id":"16","@gid":"12","@x":"490","@y":"525","@width":"35","@height":"35"},{"@id":"17","@gid":"12","@x":"525","@y":"525","@width":"35","@height":"35"},{"@id":"18","@gid":"12","@x":"385","@y":"525","@width":"35","@height":"35"},{"@id":"19","@gid":"12","@x":"420","@y":"385","@width":"35","@height":"35"},{"@id":"20","@gid":"12","@x":"420","@y":"490","@width":"35","@height":"35"},{"@id":"21","@gid":"12","@x":"140","@y":"525","@width":"35","@height":"35"},{"@id":"22","@gid":"12","@x":"70","@y":"525","@width":"35","@height":"35"},{"@id":"23","@gid":"12","@x":"245","@y":"525","@width":"35","@height":"35"},{"@id":"24","@gid":"12","@x":"105","@y":"525","@width":"35","@height":"35"},{"@id":"25","@gid":"12","@x":"175","@y":"525","@width":"35","@height":"35"},{"@id":"26","@gid":"12","@x":"210","@y":"525","@width":"35","@height":"35"},{"@id":"27","@gid":"12","@x":"455","@y":"525","@width":"35","@height":"35"},{"@id":"28","@gid":"12","@x":"420","@y":"525","@width":"35","@height":"35"},{"@id":"29","@gid":"12","@x":"280","@y":"525","@width":"35","@height":"35"},{"@id":"30","@gid":"9","@x":"0","@y":"490","@width":"35","@height":"35"},{"@id":"31","@gid":"9","@x":"35","@y":"490","@width":"35","@height":"35"},{"@id":"32","@gid":"9","@x":"70","@y":"490","@width":"35","@height":"35"},{"@id":"33","@gid":"9","@x":"105","@y":"490","@width":"35","@height":"35"},{"@id":"34","@gid":"9","@x":"140","@y":"490","@width":"35","@height":"35"},{"@id":"35","@gid":"9","@x":"175","@y":"490","@width":"35","@height":"35"},{"@id":"36","@gid":"9","@x":"210","@y":"490","@width":"35","@height":"35"},{"@id":"37","@gid":"9","@x":"245","@y":"490","@width":"35","@height":"35"},{"@id":"38","@gid":"10","@x":"280","@y":"490","@width":"35","@height":"35"},{"@id":"39","@gid":"9","@x":"315","@y":"525","@width":"35","@height":"35"},{"@id":"40","@gid":"9","@x":"350","@y":"525","@width":"35","@height":"35"},{"@id":"41","@gid":"9","@x":"490","@y":"490","@width":"35","@height":"35"},{"@id":"42","@gid":"9","@x":"455","@y":"490","@width":"35","@height":"35"},{"@id":"43","@gid":"9","@x":"560","@y":"525","@width":"35","@height":"35"},{"@id":"44","@gid":"9","@x":"595","@y":"525","@width":"35","@height":"35"},{"@id":"45","@gid":"9","@x":"630","@y":"525","@width":"35","@height":"35"},{"@id":"46","@gid":"9","@x":"665","@y":"525","@width":"35","@height":"35"},{"@id":"47","@gid":"9","@x":"350","@y":"210","@width":"35","@height":"35"},{"@id":"48","@gid":"9","@x":"315","@y":"210","@width":"35","@height":"35"},{"@id":"49","@gid":"9","@x":"280","@y":"210","@width":"35","@height":"35"},{"@id":"50","@gid":"10","@x":"525","@y":"490","@width":"35","@height":"35"},{"@id":"51","@gid":"8","@x":"385","@y":"490","@width":"35","@height":"35"},{"@id":"52","@gid":"6","@x":"420","@y":"455","@width":"35","@height":"35"},{"@id":"53","@gid":"6","@x":"455","@y":"245","@width":"35","@height":"35"},{"@id":"54","@gid":"6","@x":"455","@y":"280","@width":"35","@height":"35"},{"@id":"55","@gid":"6","@x":"175","@y":"35","@width":"35","@height":"35"},{"@id":"56","@gid":"7","@x":"175","@y":"70","@width":"35","@height":"35"},{"@id":"57","@gid":"7","@x":"140","@y":"315","@width":"35","@height":"35"},{"@id":"58","@gid":"2","@x":"140","@y":"385","@width":"35","@height":"35"},{"@id":"59","@gid":"3","@x":"175","@y":"385","@width":"35","@height":"35"},{"@id":"60","@gid":"2","@x":"105","@y":"175","@width":"35","@height":"35"},{"@id":"61","@gid":"2","@x":"630","@y":"385","@width":"35","@height":"35"},{"@id":"62","@gid":"4","@x":"525","@y":"385","@width":"35","@height":"35"},{"@id":"63","@gid":"14","@x":"385","@y":"420","@width":"35","@height":"35"},{"@id":"64","@gid":"14","@x":"245","@y":"420","@width":"35","@height":"35"},{"@id":"65","@gid":"14","@x":"175","@y":"210","@width":"35","@height":"35"},{"@id":"66","@gid":"14","@x":"280","@y":"245","@width":"35","@height":"35"},{"@id":"67","@gid":"14","@x":"560","@y":"245","@width":"35","@height":"35"},{"@id":"68","@gid":"16","@x":"280","@y":"420","@width":"35","@height":"35"},{"@id":"69","@gid":"16","@x":"595","@y":"245","@width":"35","@height":"35"},{"@id":"70","@gid":"16","@x":"350","@y":"245","@width":"35","@height":"35"},{"@id":"71","@gid":"13","@x":"420","@y":"420","@width":"35","@height":"35"},{"@id":"72","@gid":"15","@x":"210","@y":"385","@width":"35","@height":"35"},{"@id":"73","@gid":"11","@x":"210","@y":"315","@width":"35","@height":"35"},{"@id":"74","@gid":"11","@x":"210","@y":"350","@width":"35","@height":"35"},{"@id":"75","@gid":"9","@x":"245","@y":"315","@width":"35","@height":"35"},{"@id":"76","@gid":"5","@x":"210","@y":"280","@width":"35","@height":"35"},{"@id":"77","@gid":"10","@x":"140","@y":"280","@width":"35","@height":"35"},{"@id":"78","@gid":"3","@x":"105","@y":"280","@width":"35","@height":"35"},{"@id":"79","@gid":"3","@x":"70","@y":"280","@width":"35","@height":"35"},{"@id":"80","@gid":"3","@x":"35","@y":"280","@width":"35","@height":"35"},{"@id":"81","@gid":"3","@x":"0","@y":"280","@width":"35","@height":"35"},{"@id":"82","@gid":"9","@x":"665","@y":"385","@width":"35","@height":"35"},{"@id":"83","@gid":"14","@x":"665","@y":"420","@width":"35","@height":"35"},{"@id":"84","@gid":"8","@x":"385","@y":"315","@width":"35","@height":"35"},{"@id":"85","@gid":"11","@x":"385","@y":"385","@width":"35","@height":"35"},{"@id":"86","@gid":"11","@x":"385","@y":"350","@width":"35","@height":"35"},{"@id":"87","@gid":"13","@x":"455","@y":"350","@width":"35","@height":"35"},{"@id":"88","@gid":"13","@x":"455","@y":"315","@width":"35","@height":"35"},{"@id":"89","@gid":"9","@x":"420","@y":"315","@width":"35","@height":"35"},{"@id":"90","@gid":"3","@x":"420","@y":"210","@width":"35","@height":"35"},{"@id":"91","@gid":"3","@x":"385","@y":"210","@width":"35","@height":"35"},{"@id":"92","@gid":"3","@x":"490","@y":"210","@width":"35","@height":"35"},{"@id":"93","@gid":"3","@x":"525","@y":"210","@width":"35","@height":"35"},{"@id":"94","@gid":"9","@x":"455","@y":"210","@width":"35","@height":"35"},{"@id":"95","@gid":"9","@x":"560","@y":"210","@width":"35","@height":"35"},{"@id":"96","@gid":"10","@x":"595","@y":"210","@width":"35","@height":"35"},{"@id":"97","@gid":"10","@x":"175","@y":"175","@width":"35","@height":"35"},{"@id":"98","@gid":"3","@x":"210","@y":"210","@width":"35","@height":"35"},{"@id":"99","@gid":"3","@x":"245","@y":"210","@width":"35","@height":"35"},{"@id":"100","@gid":"3","@x":"140","@y":"175","@width":"35","@height":"35"},{"@id":"101","@gid":"3","@x":"490","@y":"385","@width":"35","@height":"35"},{"@id":"102","@gid":"15","@x":"455","@y":"385","@width":"35","@height":"35"},{"@id":"103","@gid":"15","@x":"315","@y":"245","@width":"35","@height":"35"},{"@id":"104","@gid":"10","@x":"280","@y":"315","@width":"35","@height":"35"},{"@id":"105","@gid":"12","@x":"245","@y":"350","@width":"35","@height":"35"},{"@id":"106","@gid":"13","@x":"280","@y":"350","@width":"35","@height":"35"},{"@id":"107","@gid":"13","@x":"280","@y":"385","@width":"35","@height":"35"}]},{"@name":"active",object:[{"@id":"108","@type":"6","@gid":"21","@x":"561","@y":"369","@width":"70","@height":"19",properties:{property:[{"@name":"distanceX","@value":"0"},{"@name":"distanceY","@value":"105"},{"@name":"speedX","@value":"0"},{"@name":"speedY","@value":"45"}]}},{"@id":"109","@type":"4","@gid":"17","@x":"498","@y":"351","@width":"24","@height":"11"},{"@id":"110","@type":"2","@gid":"17","@x":"481","@y":"456","@width":"24","@height":"11"},{"@id":"111","@gid":"17","@x":"244","@y":"251","@width":"24","@height":"11","@rotation":"90"},{"@id":"112","@gid":"33","@x":"243","@y":"454","@width":"35","@height":"35"},{"@id":"113","@type":"4","@gid":"21","@x":"315","@y":"476","@width":"70","@height":"19",properties:{property:[{"@name":"distanceY","@value":"174"},{"@name":"speedY","@value":"-45"}]}},{"@id":"114","@type":"3","@gid":"17","@x":"275","@y":"207.5","@width":"24","@height":"11","@rotation":"180"},{"@id":"115","@type":"4","@gid":"19","@x":"184","@y":"142","@width":"20","@height":"70"},{"@id":"116","@gid":"27","@x":"350","@y":"140","@width":"31","@height":"34"},{"@id":"117","@gid":"27","@x":"46","@y":"104","@width":"31","@height":"34"},{"@id":"118","@gid":"27","@x":"508","@y":"278","@width":"31","@height":"34"},{"@id":"119","@type":"5","@gid":"17","@x":"115","@y":"141.5","@width":"24","@height":"11"},{"@id":"120","@type":"2","@gid":"19","@x":"141","@y":"245","@width":"20","@height":"70","@rotation":"90"},{"@id":"121","@type":"3","@gid":"19","@x":"290","@y":"222","@width":"20","@height":"70","@rotation":"90"},{"@id":"122","@gid":"19","@x":"258","@y":"384","@width":"20","@height":"70"},{"@id":"123","@type":"5","@gid":"21","@x":"630","@y":"195","@width":"70","@height":"19",properties:{property:[{"@name":"distanceY","@value":"140"},{"@name":"speedY","@value":"45"}]}},{"@id":"124","@type":"2","@gid":"19","@x":"280","@y":"372","@width":"20","@height":"70","@rotation":"270"},{"@id":"125","@type":"6","@gid":"17","@x":"427","@y":"282.5","@width":"24","@height":"11"},{"@id":"126","@gid":"25","@x":"199","@y":"64","@width":"32","@height":"22",properties:{property:[{"@name":"delay","@value":"0"},{"@name":"maxAngle","@value":"135"},{"@name":"minAngle","@value":"135"},{"@name":"speedX","@value":"0"}]}},{"@id":"127","@gid":"30","@x":"399","@y":"177","@width":"60","@height":"56",properties:{property:[{"@name":"limitLeft","@value":"50"},{"@name":"limitRight","@value":"120"}]}},{"@id":"128","@gid":"30","@x":"38","@y":"455","@width":"60","@height":"56",properties:{property:[{"@name":"limitLeft","@value":"30"},{"@name":"limitRight","@value":"80"}]}},{"@id":"129","@gid":"31","@x":"367","@y":"456","@width":"50","@height":"29"}]},{"@name":"characters",object:[{"@id":"130","@gid":"24","@x":"37","@y":"248","@width":"44","@height":"52"},{"@id":"131","@gid":"28","@x":"598","@y":"494","@width":"63","@height":"50"}]},{"@name":"physics",object:[{"@id":"132","@x":"0","@y":"455","@width":"315","@height":"70"},{"@id":"133","@x":"315","@y":"490","@width":"385","@height":"35"},{"@id":"134","@x":"385","@y":"455","@width":"175","@height":"35"},{"@id":"135","@x":"665","@y":"385","@width":"35","@height":"35"},{"@id":"136","@x":"630","@y":"350","@width":"70","@height":"35"},{"@id":"137","@x":"490","@y":"350","@width":"70","@height":"35"},{"@id":"141","@x":"455","@y":"210","@width":"35","@height":"175"},{"@id":"142","@x":"175","@y":"175","@width":"455","@height":"35"},{"@id":"143","@x":"560","@y":"210","@width":"70","@height":"35"},{"@id":"144","@x":"280","@y":"210","@width":"105","@height":"35"},{"@id":"145","@x":"105","@y":"140","@width":"105","@height":"35"},{"@id":"146","@x":"175","@y":"0","@width":"35","@height":"70"},{"@id":"147","@x":"0","@y":"245","@width":"175","@height":"35"},{"@id":"148","@x":"140","@y":"280","@width":"35","@height":"35"},{"@id":"149","@x":"140","@y":"350","@width":"70","@height":"35"},{"@id":"150","@x":"210","@y":"245","@width":"35","@height":"140"},{"@id":"151","@x":"245","@y":"280","@width":"70","@height":"140"},{"@id":"153","@x":"385","@y":"280","@width":"70","@height":"175"}]}]},{"@level":"19","@version":"1.0","@orientation":"orthogonal","@renderorder":"right-down","@width":"20","@height":"15","@tilewidth":"35","@tileheight":"35",tileset:[{"@firstgid":"1","@name":"tiles","@tilewidth":"35","@tileheight":"35",tile:[{"@id":"0",image:{"@width":"35","@height":"35","@source":"tiles/singleTile.png"}},{"@id":"1",image:{"@width":"35","@height":"35","@source":"tiles/platformLeft.png"}},{"@id":"2",image:{"@width":"35","@height":"35","@source":"tiles/platformCenter.png"}},{"@id":"3",image:{"@width":"35","@height":"35","@source":"tiles/platformRight.png"}},{"@id":"4",image:{"@width":"35","@height":"35","@source":"tiles/verticalPlatformTop.png"}},{"@id":"5",image:{"@width":"35","@height":"35","@source":"tiles/verticalPlatformCenter.png"}},{"@id":"6",image:{"@width":"35","@height":"35","@source":"tiles/verticalPlatformBottom.png"}},{"@id":"7",image:{"@width":"35","@height":"35","@source":"tiles/tileTopLeft.png"}},{"@id":"8",image:{"@width":"35","@height":"35","@source":"tiles/tileTopCenter.png"}},{"@id":"9",image:{"@width":"35","@height":"35","@source":"tiles/tileTopRight.png"}},{"@id":"10",image:{"@width":"35","@height":"35","@source":"tiles/tileCenterLeft.png"}},{"@id":"11",image:{"@width":"35","@height":"35","@source":"tiles/tileCenter.png"}},{"@id":"12",image:{"@width":"35","@height":"35","@source":"tiles/tileCenterRight.png"}},{"@id":"13",image:{"@width":"35","@height":"35","@source":"tiles/tileBottomLeft.png"}},{"@id":"14",image:{"@width":"35","@height":"35","@source":"tiles/tileBottomCenter.png"}},{"@id":"15",image:{"@width":"35","@height":"35","@source":"tiles/tileBottomRight.png"}}]},{"@firstgid":"17","@name":"active","@tilewidth":"105","@tileheight":"70",tile:[{"@id":"0",image:{"@width":"24","@height":"11","@source":"active/PushButtonGraphics.png"}},{"@id":"1",image:{"@width":"25","@height":"19","@source":"active/TriggerGraphics.png"}},{"@id":"2",image:{"@width":"20","@height":"70","@source":"active/DoorGraphics.png"}},{"@id":"3",image:{"@width":"20","@height":"70","@source":"active/GlassDoorGraphics.png"}},{"@id":"4",image:{"@width":"70","@height":"19","@source":"active/ElevatorGraphics.png"}},{"@id":"5",image:{"@width":"105","@height":"20","@source":"active/BigElevatorGraphics.png"}},{"@id":"6",image:{"@width":"70","@height":"70","@source":"active/ExitGraphics.png"}},{"@id":"7",image:{"@width":"44","@height":"52","@source":"characters/HustlerGraphics.png"}},{"@id":"8",image:{"@width":"32","@height":"22","@source":"active/CameraGraphics.png"}},{"@id":"9",image:{"@width":"15","@height":"15","@source":"characters/EnemyLimiterGraphics.png"}},{"@id":"10",image:{"@width":"31","@height":"34","@source":"passive/MoneyBagGraphics.png"}},{"@id":"11",image:{"@width":"63","@height":"50","@source":"characters/DogGraphics.png"}},{"@id":"12",image:{"@width":"60","@height":"55","@source":"characters/Prisoner2Graphics.png"}},{"@id":"13",image:{"@width":"60","@height":"56","@source":"characters/PrisonerGraphics.png"}}]},{"@firstgid":"31","@name":"passive","@tilewidth":"210","@tileheight":"50",tile:[{"@id":"0",image:{"@width":"50","@height":"50","@source":"passive/BigBoxGraphics.png"}},{"@id":"1",image:{"@width":"35","@height":"35","@source":"passive/BoxGraphics.png"}},{"@id":"2",image:{"@width":"37","@height":"35","@source":"passive/ToiletGraphics.png"}},{"@id":"3",image:{"@width":"35","@height":"35","@source":"passive/MonitorGraphics.png"}},{"@id":"4",image:{"@width":"35","@height":"35","@source":"passive/BasketBallGraphics.png"}},{"@id":"5",image:{"@width":"35","@height":"35","@source":"passive/StoolGraphics.png"}},{"@id":"6",image:{"@width":"150","@height":"20","@source":"passive/PlankGraphics.png"}},{"@id":"7",image:{"@width":"150","@height":"20","@source":"passive/Plank2Graphics.png"}},{"@id":"8",image:{"@width":"210","@height":"20","@source":"passive/BigPlankGraphics.png"}},{"@id":"9",image:{"@width":"100","@height":"20","@source":"passive/Plank5Graphics.png"}},{"@id":"10",image:{"@width":"150","@height":"20","@source":"passive/Plank2Graphics.png"}},{"@id":"11",image:{"@width":"35","@height":"35","@source":"passive/MirrorGraphics.png"}}]},{"@firstgid":"43","@name":"decor","@tilewidth":"232","@tileheight":"136",tile:[{"@id":"0",image:{"@width":"232","@height":"79","@source":"decor/LevelTextGraphics.png"}},{"@id":"1",image:{"@width":"54","@height":"20","@source":"decor/Decor1Graphics.png"}},{"@id":"2",image:{"@width":"54","@height":"20","@source":"decor/Decor2Graphics.png"}},{"@id":"3",image:{"@width":"33","@height":"27","@source":"decor/Decor3Graphics.png"}},{"@id":"4",image:{"@width":"34","@height":"25","@source":"decor/Decor4Graphics.png"}},{"@id":"5",image:{"@width":"22","@height":"31","@source":"decor/Decor5Graphics.png"}},{"@id":"6",image:{"@width":"126","@height":"59","@source":"decor/Decor6Graphics.png"}},{"@id":"7",image:{"@width":"25","@height":"21","@source":"decor/Decor8Graphics.png"}},{"@id":"8",image:{"@width":"18","@height":"22","@source":"decor/Decor9Graphics.png"}},{"@id":"9",image:{"@width":"35","@height":"58","@source":"decor/Decor10Graphics.png"}},{"@id":"10",image:{"@width":"19","@height":"66","@source":"decor/Decor11Graphics.png"}},{"@id":"11",image:{"@width":"23","@height":"33","@source":"decor/Decor12Graphics.png"}},{"@id":"12",image:{"@width":"38","@height":"26","@source":"decor/Decor13Graphics.png"}},{"@id":"13",image:{"@width":"43","@height":"78","@source":"decor/Decor14Graphics.png"}},{"@id":"14",image:{"@width":"60","@height":"86","@source":"decor/Decor15Graphics.png"}},{"@id":"15",image:{"@width":"41","@height":"69","@source":"decor/Decor16Graphics.png"}},{"@id":"16",image:{"@width":"55","@height":"58","@source":"decor/Decor17Graphics.png"}},{"@id":"17",image:{"@width":"57","@height":"54","@source":"decor/Decor18Graphics.png"}},{"@id":"18",image:{"@width":"18","@height":"45","@source":"decor/Decor19Graphics.png"}},{"@id":"19",image:{"@width":"41","@height":"49","@source":"decor/Decor20Graphics.png"}},{"@id":"20",image:{"@width":"51","@height":"38","@source":"decor/Decor21Graphics.png"}},{"@id":"21",image:{"@width":"54","@height":"54","@source":"decor/Decor22Graphics.png"}},{"@id":"22",image:{"@width":"63","@height":"136","@source":"decor/Decor23Graphics.png"}},{"@id":"23",image:{"@width":"21","@height":"39","@source":"decor/Decor24Graphics.png"}},{"@id":"24",image:{"@width":"104","@height":"50","@source":"decor/Decor25Graphics.png"}},{"@id":"25",image:{"@width":"104","@height":"46","@source":"decor/Decor26Graphics.png"}},{"@id":"26",image:{"@width":"86","@height":"38","@source":"decor/Decor27Graphics.png"}},{"@id":"27",image:{"@width":"63","@height":"55","@source":"decor/Decor28Graphics.png"}},{"@id":"28",image:{"@width":"13","@height":"23","@source":"decor/Decor29Graphics.png"}},{"@id":"29",image:{"@width":"28","@height":"40","@source":"decor/Decor30Graphics.png"}},{"@id":"30",image:{"@width":"69","@height":"30","@source":"decor/Decor31Graphics.png"}},{"@id":"31",image:{"@width":"33","@height":"29","@source":"decor/Decor32Graphics.png"}},{"@id":"32",image:{"@width":"42","@height":"42","@source":"decor/Decor33Graphics.png"}},{"@id":"33",image:{"@width":"60","@height":"66","@source":"decor/Decor34Graphics.png"}},{"@id":"34",image:{"@width":"46","@height":"65","@source":"decor/Decor35Graphics.png"}},{"@id":"35",image:{"@width":"71","@height":"55","@source":"decor/Decor36Graphics.png"}},{"@id":"36",image:{"@width":"35","@height":"55","@source":"decor/Decor37Graphics.png"}},{"@id":"37",image:{"@width":"28","@height":"29","@source":"decor/Decor38Graphics.png"}},{"@id":"38",image:{"@width":"38","@height":"37","@source":"decor/Decor39Graphics.png"}},{"@id":"39",image:{"@width":"103","@height":"50","@source":"decor/Decor40Graphics.png"}},{"@id":"40",image:{"@width":"56","@height":"55","@source":"decor/Decor41Graphics.png"}},{"@id":"41",image:{"@width":"71","@height":"50","@source":"decor/Decor42Graphics.png"}},{"@id":"42",image:{"@width":"200","@height":"44","@source":"decor/TxtGraphics.png"}}]}],imagelayer:{"@name":"background","@y":"1",image:{"@source":"bg/Background1Graphics.png"}},objectgroup:[{"@name":"decorations",object:[{"@gid":"43","@x":"161","@y":"399","@width":"232","@height":"79",properties:{property:{"@name":"text","@value":"level_text_20"}}},{"@gid":"70","@x":"630","@y":"350","@width":"63","@height":"55"},{"@gid":"82","@x":"420","@y":"385","@width":"103","@height":"50"},{"@gid":"78","@x":"490","@y":"280","@width":"71","@height":"55"},{"@gid":"84","@x":"94","@y":"379","@width":"71","@height":"50"},{"@gid":"68","@x":"560","@y":"140","@width":"104","@height":"46"},{"@gid":"54","@x":"264","@y":"468","@width":"23","@height":"33"},{"@gid":"53","@x":"45","@y":"363","@width":"19","@height":"66"}]},{"@name":"tiles",object:[{"@gid":"12","@x":"665","@y":"175","@width":"35","@height":"35"},{"@gid":"12","@x":"490","@y":"525","@width":"35","@height":"35"},{"@gid":"12","@x":"560","@y":"525","@width":"35","@height":"35"},{"@gid":"12","@x":"630","@y":"525","@width":"35","@height":"35"},{"@gid":"12","@x":"595","@y":"525","@width":"35","@height":"35"},{"@gid":"12","@x":"525","@y":"525","@width":"35","@height":"35"},{"@gid":"12","@x":"665","@y":"490","@width":"35","@height":"35"},{"@gid":"12","@x":"420","@y":"525","@width":"35","@height":"35"},{"@gid":"12","@x":"665","@y":"525","@width":"35","@height":"35"},{"@gid":"12","@x":"455","@y":"525","@width":"35","@height":"35"},{"@gid":"12","@x":"385","@y":"490","@width":"35","@height":"35"},{"@gid":"12","@x":"0","@y":"525","@width":"35","@height":"35"},{"@gid":"12","@x":"385","@y":"525","@width":"35","@height":"35"},{"@gid":"12","@x":"315","@y":"525","@width":"35","@height":"35"},{"@gid":"12","@x":"350","@y":"525","@width":"35","@height":"35"},{"@gid":"9","@x":"280","@y":"525","@width":"35","@height":"35"},{"@gid":"9","@x":"245","@y":"525","@width":"35","@height":"35"},{"@gid":"9","@x":"210","@y":"525","@width":"35","@height":"35"},{"@gid":"9","@x":"175","@y":"525","@width":"35","@height":"35"},{"@gid":"9","@x":"140","@y":"525","@width":"35","@height":"35"},{"@gid":"9","@x":"105","@y":"525","@width":"35","@height":"35"},{"@gid":"9","@x":"70","@y":"525","@width":"35","@height":"35"},{"@gid":"9","@x":"35","@y":"525","@width":"35","@height":"35"},{"@gid":"8","@x":"315","@y":"490","@width":"35","@height":"35"},{"@gid":"8","@x":"665","@y":"385","@width":"35","@height":"35"},{"@gid":"8","@x":"70","@y":"420","@width":"35","@height":"35"},{"@gid":"7","@x":"70","@y":"455","@width":"35","@height":"35"},{"@gid":"3","@x":"105","@y":"420","@width":"35","@height":"35"},{"@gid":"3","@x":"280","@y":"210","@width":"35","@height":"35"},{"@gid":"3","@x":"315","@y":"210","@width":"35","@height":"35"},{"@gid":"3","@x":"350","@y":"210","@width":"35","@height":"35"},{"@gid":"3","@x":"385","@y":"210","@width":"35","@height":"35"},{"@gid":"3","@x":"595","@y":"175","@width":"35","@height":"35"},{"@gid":"3","@x":"35","@y":"70","@width":"35","@height":"35"},{"@gid":"3","@x":"105","@y":"70","@width":"35","@height":"35"},{"@gid":"3","@x":"140","@y":"70","@width":"35","@height":"35"},{"@gid":"3","@x":"175","@y":"70","@width":"35","@height":"35"},{"@gid":"3","@x":"210","@y":"70","@width":"35","@height":"35"},{"@gid":"3","@x":"245","@y":"70","@width":"35","@height":"35"},{"@gid":"3","@x":"280","@y":"70","@width":"35","@height":"35"},{"@gid":"4","@x":"140","@y":"420","@width":"35","@height":"35"},{"@gid":"4","@x":"560","@y":"315","@width":"35","@height":"35"},{"@gid":"5","@x":"385","@y":"420","@width":"35","@height":"35"},{"@gid":"6","@x":"385","@y":"455","@width":"35","@height":"35"},{"@gid":"6","@x":"525","@y":"350","@width":"35","@height":"35"},{"@gid":"6","@x":"420","@y":"245","@width":"35","@height":"35"},{"@gid":"6","@x":"70","@y":"105","@width":"35","@height":"35"},{"@gid":"7","@x":"70","@y":"140","@width":"35","@height":"35"},{"@gid":"7","@x":"315","@y":"105","@width":"35","@height":"35"},{"@gid":"10","@x":"315","@y":"70","@width":"35","@height":"35"},{"@gid":"9","@x":"70","@y":"70","@width":"35","@height":"35"},{"@gid":"9","@x":"0","@y":"70","@width":"35","@height":"35"},{"@gid":"8","@x":"665","@y":"140","@width":"35","@height":"35"},{"@gid":"9","@x":"350","@y":"490","@width":"35","@height":"35"},{"@gid":"9","@x":"420","@y":"490","@width":"35","@height":"35"},{"@gid":"9","@x":"455","@y":"490","@width":"35","@height":"35"},{"@gid":"9","@x":"490","@y":"490","@width":"35","@height":"35"},{"@gid":"9","@x":"525","@y":"490","@width":"35","@height":"35"},{"@gid":"9","@x":"560","@y":"490","@width":"35","@height":"35"},{"@gid":"9","@x":"595","@y":"490","@width":"35","@height":"35"},{"@gid":"9","@x":"630","@y":"490","@width":"35","@height":"35"},{"@gid":"7","@x":"525","@y":"420","@width":"35","@height":"35"},{"@gid":"7","@x":"385","@y":"350","@width":"35","@height":"35"},{"@gid":"8","@x":"385","@y":"315","@width":"35","@height":"35"},{"@gid":"3","@x":"490","@y":"315","@width":"35","@height":"35"},{"@gid":"9","@x":"525","@y":"315","@width":"35","@height":"35"},{"@gid":"10","@x":"455","@y":"280","@width":"35","@height":"35"},{"@gid":"10","@x":"420","@y":"210","@width":"35","@height":"35"},{"@gid":"15","@x":"420","@y":"315","@width":"35","@height":"35"},{"@gid":"15","@x":"455","@y":"315","@width":"35","@height":"35"},{"@gid":"15","@x":"105","@y":"315","@width":"35","@height":"35"},{"@gid":"15","@x":"665","@y":"210","@width":"35","@height":"35"},{"@gid":"14","@x":"630","@y":"210","@width":"35","@height":"35"},{"@gid":"14","@x":"70","@y":"315","@width":"35","@height":"35"},{"@gid":"2","@x":"525","@y":"175","@width":"35","@height":"35"},{"@gid":"2","@x":"245","@y":"210","@width":"35","@height":"35"},{"@gid":"13","@x":"0","@y":"490","@width":"35","@height":"35"},{"@gid":"13","@x":"0","@y":"455","@width":"35","@height":"35"},{"@gid":"13","@x":"0","@y":"420","@width":"35","@height":"35"},{"@gid":"13","@x":"0","@y":"385","@width":"35","@height":"35"},{"@gid":"13","@x":"0","@y":"350","@width":"35","@height":"35"},{"@gid":"13","@x":"0","@y":"315","@width":"35","@height":"35"},{"@gid":"13","@x":"0","@y":"280","@width":"35","@height":"35"},{"@gid":"13","@x":"0","@y":"245","@width":"35","@height":"35"},{"@gid":"13","@x":"0","@y":"210","@width":"35","@height":"35"},{"@gid":"13","@x":"0","@y":"175","@width":"35","@height":"35"},{"@gid":"13","@x":"0","@y":"140","@width":"35","@height":"35"},{"@gid":"13","@x":"0","@y":"105","@width":"35","@height":"35"},{"@gid":"11","@x":"70","@y":"245","@width":"35","@height":"35"},{"@gid":"11","@x":"70","@y":"280","@width":"35","@height":"35"},{"@gid":"11","@x":"665","@y":"455","@width":"35","@height":"35"},{"@gid":"11","@x":"665","@y":"420","@width":"35","@height":"35"},{"@gid":"11","@x":"420","@y":"280","@width":"35","@height":"35"},{"@gid":"8","@x":"70","@y":"210","@width":"35","@height":"35"},{"@gid":"9","@x":"105","@y":"210","@width":"35","@height":"35"},{"@gid":"9","@x":"630","@y":"175","@width":"35","@height":"35"},{"@gid":"6","@x":"525","@y":"385","@width":"35","@height":"35"},{"@gid":"3","@x":"560","@y":"175","@width":"35","@height":"35"},{"@gid":"10","@x":"140","@y":"210"},{"@gid":"13","@x":"140","@y":"245"},{"@gid":"13","@x":"140","@y":"280"},{"@gid":"16","@x":"140","@y":"315"},{"@gid":"12","@x":"105","@y":"280"},{"@gid":"12","@x":"105","@y":"245"}]},{"@name":"active",object:[{"@type":"6","@gid":"19","@x":"1","@y":"387","@width":"20","@height":"70","@rotation":"90"},{"@type":"4","@gid":"17","@x":"41","@y":"491","@width":"24","@height":"11"},{"@gid":"21","@x":"314","@y":"424","@width":"70","@height":"19",properties:{property:[{"@name":"distanceY","@value":"100"},{"@name":"speedY","@value":"-45"}]}},{"@gid":"27","@x":"338","@y":"450","@width":"31","@height":"34"},{"@gid":"27","@x":"595","@y":"105","@width":"31","@height":"34"},{"@gid":"27","@x":"271","@y":"247","@width":"31","@height":"34"},{"@type":"2","@gid":"17","@x":"624","@y":"456.5","@width":"24","@height":"11"},{"@type":"3","@gid":"19","@x":"104","@y":"267","@width":"20","@height":"70","@rotation":"-90"},{"@type":"2","@gid":"19","@x":"175","@y":"175","@width":"20","@height":"70","@rotation":"90"},{"@gid":"39","@x":"174","@y":"406","@width":"210","@height":"20"},{"@gid":"21","@x":"175","@y":"424","@width":"80","@height":"19",properties:{property:[{"@name":"distanceY","@value":"100"},{"@name":"speedY","@value":"-45"}]}},{"@gid":"25","@x":"409","@y":"254","@width":"32","@height":"22",properties:{property:[{"@name":"delay","@value":"0"},{"@name":"maxAngle","@value":"0"},{"@name":"minAngle","@value":"0"},{"@name":"speedX","@value":"0"}]}},{"@gid":"42","@x":"70","@y":"175","@width":"35","@height":"35"},{"@type":"3","@gid":"18","@x":"392","@y":"280","@width":"25","@height":"19"},{"@gid":"25","@x":"42","@y":"91","@width":"32","@height":"22",properties:{property:[{"@name":"delay","@value":"0"},{"@name":"maxAngle","@value":"90"},{"@name":"minAngle","@value":"90"},{"@name":"speedX","@value":"0"}]}},{"@gid":"30","@x":"91","@y":"386","@width":"60","@height":"56",properties:{property:[{"@name":"limitLeft","@value":"27"},{"@name":"limitRight","@value":"23"}]}},{"@type":"6","@gid":"18","@x":"270","@y":"491","@width":"25","@height":"19"},{"@gid":"19","@x":"323","@y":"176","@width":"20","@height":"70"},{"@type":"4","@gid":"19","@x":"0","@y":"117","@width":"20","@height":"70","@rotation":"90"},{"@gid":"18","@x":"428","@y":"455","@width":"25","@height":"19"},{"@gid":"19","@x":"399","@y":"455","@width":"20","@height":"70"},{"@gid":"29","@x":"140","@y":"490","@width":"60","@height":"55"},{"@type":"3","@gid":"19","@x":"140","@y":"267","@width":"20","@height":"70","@rotation":"-90"},{"@type":"3","@gid":"19","@x":"536","@y":"525","@width":"20","@height":"70"}]},{"@name":"characters",object:[{"@gid":"24","@x":"205.333","@y":"171.667","@width":"44","@height":"52"},{"@gid":"28","@x":"381","@y":"174","@width":"63","@height":"50"}]},{"@name":"physics","@visible":"0",object:[{"@x":"0","@y":"490","@width":"700","@height":"35"},{"@x":"315","@y":"455","@width":"385","@height":"35"},{"@x":"385","@y":"385","@width":"35","@height":"70"},{"@x":"665","@y":"350","@width":"35","@height":"105"},{"@x":"525","@y":"315","@width":"35","@height":"105"},{"@x":"385","@y":"315","@width":"35","@height":"35"},{"@x":"385","@y":"280","@width":"210","@height":"35"},{"@x":"420","@y":"245","@width":"70","@height":"35"},{"@x":"420","@y":"210","@width":"35","@height":"35"},{"@x":"245","@y":"175","@width":"210","@height":"35"},{"@x":"525","@y":"140","@width":"175","@height":"35"},{"@x":"630","@y":"175","@width":"70","@height":"35"},{"@x":"665","@y":"105","@width":"35","@height":"35"},{"@x":"70","@y":"385","@width":"105","@height":"35"},{"@x":"70","@y":"420","@width":"35","@height":"35"},{"@x":"0","@y":"70","@width":"35","@height":"420"},{"@x":"70","@y":"175","@width":"105","@height":"140"},{"@x":"70","@y":"70","@width":"35","@height":"70"},{"@x":"0","@y":"35","@width":"350","@height":"35"},{"@x":"315","@y":"70","@width":"35","@height":"35"}]}]},{"@level":"20","@version":"1.0","@orientation":"orthogonal","@renderorder":"right-down","@width":"20","@height":"15","@tilewidth":"35","@tileheight":"35","@nextobjectid":"173",tileset:[{"@firstgid":"1","@name":"tiles","@tilewidth":"35","@tileheight":"35","@tilecount":"16",tile:[{"@id":"0",image:{"@width":"35","@height":"35","@source":"tiles/singleTile.png"}},{"@id":"1",image:{"@width":"35","@height":"35","@source":"tiles/platformLeft.png"}},{"@id":"2",image:{"@width":"35","@height":"35","@source":"tiles/platformCenter.png"}},{"@id":"3",image:{"@width":"35","@height":"35","@source":"tiles/platformRight.png"}},{"@id":"4",image:{"@width":"35","@height":"35","@source":"tiles/verticalPlatformTop.png"}},{"@id":"5",image:{"@width":"35","@height":"35","@source":"tiles/verticalPlatformCenter.png"}},{"@id":"6",image:{"@width":"35","@height":"35","@source":"tiles/verticalPlatformBottom.png"}},{"@id":"7",image:{"@width":"35","@height":"35","@source":"tiles/tileTopLeft.png"}},{"@id":"8",image:{"@width":"35","@height":"35","@source":"tiles/tileTopCenter.png"}},{"@id":"9",image:{"@width":"35","@height":"35","@source":"tiles/tileTopRight.png"}},{"@id":"10",image:{"@width":"35","@height":"35","@source":"tiles/tileCenterLeft.png"}},{"@id":"11",image:{"@width":"35","@height":"35","@source":"tiles/tileCenter.png"}},{"@id":"12",image:{"@width":"35","@height":"35","@source":"tiles/tileCenterRight.png"}},{"@id":"13",image:{"@width":"35","@height":"35","@source":"tiles/tileBottomLeft.png"}},{"@id":"14",image:{"@width":"35","@height":"35","@source":"tiles/tileBottomCenter.png"}},{"@id":"15",image:{"@width":"35","@height":"35","@source":"tiles/tileBottomRight.png"}}]},{"@firstgid":"17","@name":"active","@tilewidth":"105","@tileheight":"70","@tilecount":"15",tile:[{"@id":"0",image:{"@width":"24","@height":"11","@source":"active/PushButtonGraphics.png"}},{"@id":"1",image:{"@width":"25","@height":"19","@source":"active/TriggerGraphics.png"}},{"@id":"2",image:{"@width":"20","@height":"70","@source":"active/DoorGraphics.png"}},{"@id":"3",image:{"@width":"20","@height":"70","@source":"active/GlassDoorGraphics.png"}},{"@id":"4",image:{"@width":"70","@height":"19","@source":"active/ElevatorGraphics.png"}},{"@id":"5",image:{"@width":"105","@height":"20","@source":"active/BigElevatorGraphics.png"}},{"@id":"6",image:{"@width":"70","@height":"70","@source":"active/ExitGraphics.png"}},{"@id":"7",image:{"@width":"44","@height":"52","@source":"characters/HustlerGraphics.png"}},{"@id":"8",image:{"@width":"32","@height":"22","@source":"active/CameraGraphics.png"}},{"@id":"9",image:{"@width":"15","@height":"15","@source":"characters/EnemyLimiterGraphics.png"}},{"@id":"10",image:{"@width":"31","@height":"34","@source":"passive/MoneyBagGraphics.png"}},{"@id":"11",image:{"@width":"63","@height":"50","@source":"characters/DogGraphics.png"}},{"@id":"12",image:{"@width":"60","@height":"55","@source":"characters/Prisoner2Graphics.png"}},{"@id":"13",image:{"@width":"60","@height":"56","@source":"characters/PrisonerGraphics.png"}},{"@id":"14",image:{"@width":"50","@height":"29","@source":"active/TurrelGraphics.png"}}]},{"@firstgid":"32","@name":"passive","@tilewidth":"210","@tileheight":"50","@tilecount":"12",tile:[{"@id":"0",image:{"@width":"50","@height":"50","@source":"passive/BigBoxGraphics.png"}},{"@id":"1",image:{"@width":"35","@height":"35","@source":"passive/BoxGraphics.png"}},{"@id":"2",image:{"@width":"37","@height":"35","@source":"passive/ToiletGraphics.png"}},{"@id":"3",image:{"@width":"35","@height":"35","@source":"passive/MonitorGraphics.png"}},{"@id":"4",image:{"@width":"35","@height":"35","@source":"passive/BasketBallGraphics.png"}},{"@id":"5",image:{"@width":"35","@height":"35","@source":"passive/StoolGraphics.png"}},{"@id":"6",image:{"@width":"150","@height":"20","@source":"passive/PlankGraphics.png"}},{"@id":"7",image:{"@width":"150","@height":"20","@source":"passive/Plank2Graphics.png"}},{"@id":"8",image:{"@width":"210","@height":"20","@source":"passive/BigPlankGraphics.png"}},{"@id":"9",image:{"@width":"100","@height":"20","@source":"passive/Plank5Graphics.png"}},{"@id":"10",image:{"@width":"150","@height":"20","@source":"passive/Plank2Graphics.png"}},{"@id":"11",image:{"@width":"35","@height":"35","@source":"passive/MirrorGraphics.png"}}]},{"@firstgid":"44","@name":"decor","@tilewidth":"232","@tileheight":"136","@tilecount":"43",tile:[{"@id":"0",image:{"@width":"232","@height":"79","@source":"decor/LevelTextGraphics.png"}},{"@id":"1",image:{"@width":"54","@height":"20","@source":"decor/Decor1Graphics.png"}},{"@id":"2",image:{"@width":"54","@height":"20","@source":"decor/Decor2Graphics.png"}},{"@id":"3",image:{"@width":"33","@height":"27","@source":"decor/Decor3Graphics.png"}},{"@id":"4",image:{"@width":"34","@height":"25","@source":"decor/Decor4Graphics.png"}},{"@id":"5",image:{"@width":"22","@height":"31","@source":"decor/Decor5Graphics.png"}},{"@id":"6",image:{"@width":"126","@height":"59","@source":"decor/Decor6Graphics.png"}},{"@id":"7",image:{"@width":"25","@height":"21","@source":"decor/Decor8Graphics.png"}},{"@id":"8",image:{"@width":"18","@height":"22","@source":"decor/Decor9Graphics.png"}},{"@id":"9",image:{"@width":"35","@height":"58","@source":"decor/Decor10Graphics.png"}},{"@id":"10",image:{"@width":"19","@height":"66","@source":"decor/Decor11Graphics.png"}},{"@id":"11",image:{"@width":"23","@height":"33","@source":"decor/Decor12Graphics.png"}},{"@id":"12",image:{"@width":"38","@height":"26","@source":"decor/Decor13Graphics.png"}},{"@id":"13",image:{"@width":"43","@height":"78","@source":"decor/Decor14Graphics.png"}},{"@id":"14",image:{"@width":"60","@height":"86","@source":"decor/Decor15Graphics.png"}},{"@id":"15",image:{"@width":"41","@height":"69","@source":"decor/Decor16Graphics.png"}},{"@id":"16",image:{"@width":"55","@height":"58","@source":"decor/Decor17Graphics.png"}},{"@id":"17",image:{"@width":"57","@height":"54","@source":"decor/Decor18Graphics.png"}},{"@id":"18",image:{"@width":"18","@height":"45","@source":"decor/Decor19Graphics.png"}},{"@id":"19",image:{"@width":"41","@height":"49","@source":"decor/Decor20Graphics.png"}},{"@id":"20",image:{"@width":"51","@height":"38","@source":"decor/Decor21Graphics.png"}},{"@id":"21",image:{"@width":"54","@height":"54","@source":"decor/Decor22Graphics.png"}},{"@id":"22",image:{"@width":"63","@height":"136","@source":"decor/Decor23Graphics.png"}},{"@id":"23",image:{"@width":"21","@height":"39","@source":"decor/Decor24Graphics.png"}},{"@id":"24",image:{"@width":"104","@height":"50","@source":"decor/Decor25Graphics.png"}},{"@id":"25",image:{"@width":"104","@height":"46","@source":"decor/Decor26Graphics.png"}},{"@id":"26",image:{"@width":"86","@height":"38","@source":"decor/Decor27Graphics.png"}},{"@id":"27",image:{"@width":"63","@height":"55","@source":"decor/Decor28Graphics.png"}},{"@id":"28",image:{"@width":"13","@height":"23","@source":"decor/Decor29Graphics.png"}},{"@id":"29",image:{"@width":"28","@height":"40","@source":"decor/Decor30Graphics.png"}},{"@id":"30",image:{"@width":"69","@height":"30","@source":"decor/Decor31Graphics.png"}},{"@id":"31",image:{"@width":"33","@height":"29","@source":"decor/Decor32Graphics.png"}},{"@id":"32",image:{"@width":"42","@height":"42","@source":"decor/Decor33Graphics.png"}},{"@id":"33",image:{"@width":"60","@height":"66","@source":"decor/Decor34Graphics.png"}},{"@id":"34",image:{"@width":"46","@height":"65","@source":"decor/Decor35Graphics.png"}},{"@id":"35",image:{"@width":"71","@height":"55","@source":"decor/Decor36Graphics.png"}},{"@id":"36",image:{"@width":"35","@height":"55","@source":"decor/Decor37Graphics.png"}},{"@id":"37",image:{"@width":"28","@height":"29","@source":"decor/Decor38Graphics.png"}},{"@id":"38",image:{"@width":"38","@height":"37","@source":"decor/Decor39Graphics.png"}},{"@id":"39",image:{"@width":"103","@height":"50","@source":"decor/Decor40Graphics.png"}},{"@id":"40",image:{"@width":"56","@height":"55","@source":"decor/Decor41Graphics.png"}},{"@id":"41",image:{"@width":"71","@height":"50","@source":"decor/Decor42Graphics.png"}},{"@id":"42",image:{"@width":"200","@height":"44","@source":"decor/TxtGraphics.png"}}]}],imagelayer:{"@name":"background",image:{"@source":"bg/Background1Graphics.png"}},objectgroup:[{"@name":"decorations",object:[{"@id":"1","@gid":"44","@x":"357","@y":"335","@width":"232","@height":"79",properties:{property:{"@name":"text","@value":"level_text_21"}}},{"@id":"2","@gid":"68","@x":"245","@y":"490","@width":"104","@height":"50"},{"@id":"3","@gid":"67","@x":"280","@y":"455","@width":"21","@height":"39"},{"@id":"4","@gid":"64","@x":"59","@y":"332","@width":"51","@height":"38"},{"@id":"5","@gid":"75","@x":"163","@y":"409","@width":"33","@height":"29"},{"@id":"6","@gid":"76","@x":"350","@y":"105","@width":"42","@height":"42"},{"@id":"7","@gid":"82","@x":"541","@y":"438","@width":"38","@height":"37"},{"@id":"8","@gid":"80","@x":"490","@y":"490","@width":"35","@height":"55"}]},{"@name":"tiles",object:[{"@id":"9","@gid":"12","@x":"0","@y":"525","@width":"35","@height":"35"},{"@id":"10","@gid":"12","@x":"175","@y":"525","@width":"35","@height":"35"},{"@id":"11","@gid":"12","@x":"210","@y":"525","@width":"35","@height":"35"},{"@id":"12","@gid":"12","@x":"105","@y":"525","@width":"35","@height":"35"},{"@id":"13","@gid":"9","@x":"420","@y":"525","@width":"35","@height":"35"},{"@id":"14","@gid":"9","@x":"385","@y":"525","@width":"35","@height":"35"},{"@id":"15","@gid":"9","@x":"315","@y":"525","@width":"35","@height":"35"},{"@id":"16","@gid":"9","@x":"350","@y":"525","@width":"35","@height":"35"},{"@id":"17","@gid":"9","@x":"560","@y":"525","@width":"35","@height":"35"},{"@id":"18","@gid":"9","@x":"280","@y":"525","@width":"35","@height":"35"},{"@id":"19","@gid":"9","@x":"245","@y":"525","@width":"35","@height":"35"},{"@id":"20","@gid":"9","@x":"595","@y":"525","@width":"35","@height":"35"},{"@id":"21","@gid":"9","@x":"455","@y":"525","@width":"35","@height":"35"},{"@id":"22","@gid":"9","@x":"35","@y":"525","@width":"35","@height":"35"},{"@id":"23","@gid":"9","@x":"525","@y":"525","@width":"35","@height":"35"},{"@id":"24","@gid":"9","@x":"490","@y":"525","@width":"35","@height":"35"},{"@id":"25","@gid":"9","@x":"70","@y":"525","@width":"35","@height":"35"},{"@id":"26","@gid":"12","@x":"140","@y":"525","@width":"35","@height":"35"},{"@id":"27","@gid":"12","@x":"665","@y":"280","@width":"35","@height":"35"},{"@id":"28","@gid":"12","@x":"665","@y":"385","@width":"35","@height":"35"},{"@id":"29","@gid":"12","@x":"665","@y":"315","@width":"35","@height":"35"},{"@id":"30","@gid":"12","@x":"665","@y":"210","@width":"35","@height":"35"},{"@id":"31","@gid":"12","@x":"665","@y":"245","@width":"35","@height":"35"},{"@id":"32","@gid":"12","@x":"630","@y":"525","@width":"35","@height":"35"},{"@id":"33","@gid":"12","@x":"665","@y":"455","@width":"35","@height":"35"},{"@id":"34","@gid":"12","@x":"665","@y":"350","@width":"35","@height":"35"},{"@id":"35","@gid":"12","@x":"665","@y":"420","@width":"35","@height":"35"},{"@id":"36","@gid":"12","@x":"665","@y":"490","@width":"35","@height":"35"},{"@id":"37","@gid":"12","@x":"665","@y":"175","@width":"35","@height":"35"},{"@id":"38","@gid":"12","@x":"665","@y":"525","@width":"35","@height":"35"},{"@id":"39","@gid":"10","@x":"0","@y":"455","@width":"35","@height":"35"},{"@id":"40","@gid":"10","@x":"105","@y":"385","@width":"35","@height":"35"},{"@id":"41","@gid":"10","@x":"385","@y":"175","@width":"35","@height":"35"},{"@id":"42","@gid":"10","@x":"0","@y":"140","@width":"35","@height":"35"},{"@id":"43","@gid":"8","@x":"630","@y":"455","@width":"35","@height":"35"},{"@id":"44","@gid":"8","@x":"455","@y":"385","@width":"35","@height":"35"},{"@id":"45","@gid":"8","@x":"210","@y":"385","@width":"35","@height":"35"},{"@id":"46","@gid":"8","@x":"245","@y":"175","@width":"35","@height":"35"},{"@id":"47","@gid":"13","@x":"0","@y":"490","@width":"35","@height":"35"},{"@id":"48","@gid":"13","@x":"210","@y":"490","@width":"35","@height":"35"},{"@id":"49","@gid":"11","@x":"630","@y":"490","@width":"35","@height":"35"},{"@id":"50","@gid":"11","@x":"105","@y":"490","@width":"35","@height":"35"},{"@id":"51","@gid":"9","@x":"175","@y":"490","@width":"35","@height":"35"},{"@id":"52","@gid":"9","@x":"140","@y":"490","@width":"35","@height":"35"},{"@id":"53","@gid":"6","@x":"105","@y":"455","@width":"35","@height":"35"},{"@id":"54","@gid":"6","@x":"105","@y":"420","@width":"35","@height":"35"},{"@id":"55","@gid":"6","@x":"210","@y":"455","@width":"35","@height":"35"},{"@id":"56","@gid":"6","@x":"210","@y":"420","@width":"35","@height":"35"},{"@id":"57","@gid":"6","@x":"595","@y":"245","@width":"35","@height":"35"},{"@id":"58","@gid":"6","@x":"595","@y":"280","@width":"35","@height":"35"},{"@id":"59","@gid":"6","@x":"595","@y":"315","@width":"35","@height":"35"},{"@id":"60","@gid":"6","@x":"595","@y":"350","@width":"35","@height":"35"},{"@id":"61","@gid":"6","@x":"315","@y":"315","@width":"35","@height":"35"},{"@id":"62","@gid":"6","@x":"315","@y":"350","@width":"35","@height":"35"},{"@id":"63","@gid":"6","@x":"385","@y":"210","@width":"35","@height":"35"},{"@id":"64","@gid":"6","@x":"560","@y":"70","@width":"35","@height":"35"},{"@id":"65","@gid":"6","@x":"560","@y":"105","@width":"35","@height":"35"},{"@id":"66","@gid":"3","@x":"560","@y":"385","@width":"35","@height":"35"},{"@id":"67","@gid":"3","@x":"525","@y":"385","@width":"35","@height":"35"},{"@id":"68","@gid":"3","@x":"490","@y":"385","@width":"35","@height":"35"},{"@id":"69","@gid":"3","@x":"280","@y":"385","@width":"35","@height":"35"},{"@id":"70","@gid":"3","@x":"245","@y":"385","@width":"35","@height":"35"},{"@id":"71","@gid":"3","@x":"420","@y":"245","@width":"35","@height":"35"},{"@id":"72","@gid":"3","@x":"455","@y":"245","@width":"35","@height":"35"},{"@id":"73","@gid":"3","@x":"70","@y":"175","@width":"35","@height":"35"},{"@id":"74","@gid":"3","@x":"35","@y":"175","@width":"35","@height":"35"},{"@id":"75","@gid":"3","@x":"490","@y":"140","@width":"35","@height":"35"},{"@id":"76","@gid":"3","@x":"525","@y":"140","@width":"35","@height":"35"},{"@id":"77","@gid":"3","@x":"595","@y":"140","@width":"35","@height":"35"},{"@id":"78","@gid":"3","@x":"630","@y":"140","@width":"35","@height":"35"},{"@id":"79","@gid":"3","@x":"350","@y":"175","@width":"35","@height":"35"},{"@id":"80","@gid":"3","@x":"315","@y":"175","@width":"35","@height":"35"},{"@id":"81","@gid":"2","@x":"70","@y":"385","@width":"35","@height":"35"},{"@id":"82","@gid":"2","@x":"70","@y":"280","@width":"35","@height":"35"},{"@id":"83","@gid":"2","@x":"210","@y":"280","@width":"35","@height":"35"},{"@id":"84","@gid":"2","@x":"455","@y":"140","@width":"35","@height":"35"},{"@id":"85","@gid":"4","@x":"105","@y":"175","@width":"35","@height":"35"},{"@id":"86","@gid":"4","@x":"105","@y":"280","@width":"35","@height":"35"},{"@id":"87","@gid":"4","@x":"350","@y":"385","@width":"35","@height":"35"},{"@id":"88","@gid":"4","@x":"490","@y":"245","@width":"35","@height":"35"},{"@id":"89","@gid":"9","@x":"665","@y":"140","@width":"35","@height":"35"},{"@id":"90","@gid":"9","@x":"280","@y":"175","@width":"35","@height":"35"},{"@id":"91","@gid":"10","@x":"315","@y":"280","@width":"35","@height":"35"},{"@id":"92","@gid":"15","@x":"245","@y":"280","@width":"35","@height":"35"},{"@id":"93","@gid":"15","@x":"280","@y":"280","@width":"35","@height":"35"},{"@id":"94","@gid":"15","@x":"280","@y":"35","@width":"35","@height":"35"},{"@id":"95","@gid":"15","@x":"315","@y":"35","@width":"35","@height":"35"},{"@id":"96","@gid":"15","@x":"350","@y":"35","@width":"35","@height":"35"},{"@id":"97","@gid":"15","@x":"385","@y":"35","@width":"35","@height":"35"},{"@id":"98","@gid":"15","@x":"420","@y":"35","@width":"35","@height":"35"},{"@id":"99","@gid":"15","@x":"490","@y":"35","@width":"35","@height":"35"},{"@id":"100","@gid":"15","@x":"455","@y":"35","@width":"35","@height":"35"},{"@id":"101","@gid":"7","@x":"455","@y":"420","@width":"35","@height":"35"},{"@id":"102","@gid":"15","@x":"315","@y":"385","@width":"35","@height":"35"},{"@id":"103","@gid":"15","@x":"560","@y":"140","@width":"35","@height":"35"},{"@id":"104","@gid":"14","@x":"385","@y":"245","@width":"35","@height":"35"},{"@id":"105","@gid":"13","@x":"280","@y":"210","@width":"35","@height":"35"},{"@id":"106","@gid":"13","@x":"280","@y":"245","@width":"35","@height":"35"},{"@id":"107","@gid":"11","@x":"245","@y":"210","@width":"35","@height":"35"},{"@id":"108","@gid":"11","@x":"245","@y":"245","@width":"35","@height":"35"},{"@id":"109","@gid":"5","@x":"595","@y":"210","@width":"35","@height":"35"},{"@id":"110","@gid":"16","@x":"595","@y":"385","@width":"35","@height":"35"},{"@id":"111","@gid":"15","@x":"0","@y":"175","@width":"35","@height":"35"},{"@id":"112","@gid":"7","@x":"245","@y":"70","@width":"35","@height":"35"},{"@id":"113","@gid":"11","@x":"245","@y":"35","@width":"35","@height":"35"},{"@id":"114","@gid":"13","@x":"560","@y":"35","@width":"35","@height":"35"},{"@id":"115","@gid":"15","@x":"525","@y":"35","@width":"35","@height":"35"}]},{"@name":"active",object:[{"@id":"116","@gid":"20","@x":"525","@y":"210","@width":"20","@height":"70","@rotation":"90"},{"@id":"117","@type":"4","@gid":"19","@x":"211","@y":"265","@width":"20","@height":"70","@rotation":"-90"},{"@id":"118","@type":"5","@gid":"19","@x":"140","@y":"353","@width":"20","@height":"70","@rotation":"90"},{"@id":"119","@type":"3","@gid":"17","@x":"216","@y":"245","@width":"24","@height":"11"},{"@id":"120","@type":"3","@gid":"19","@x":"264","@y":"71","@width":"20","@height":"70","@rotation":"180"},{"@id":"121","@type":"2","@gid":"17","@x":"161","@y":"456","@width":"24","@height":"11"},{"@id":"122","@gid":"33","@x":"141","@y":"244","@width":"35","@height":"35"},{"@id":"123","@gid":"20","@x":"121","@y":"350","@width":"20","@height":"70"},{"@id":"124","@type":"4","@gid":"19","@x":"282","@y":"209","@width":"20","@height":"70","@rotation":"90"},{"@id":"125","@type":"5","@gid":"17","@x":"592","@y":"492","@width":"24","@height":"11"},{"@id":"126","@gid":"27","@x":"5","@y":"91","@width":"31","@height":"34"},{"@id":"127","@gid":"26","@x":"255","@y":"119","@width":"15","@height":"15"},{"@id":"128","@gid":"26","@x":"197","@y":"432","@width":"15","@height":"15"},{"@id":"129","@gid":"2147483679","@x":"36","@y":"140","@width":"50","@height":"29"},{"@id":"130","@type":"2","@gid":"21","@x":"1","@y":"264","@width":"70","@height":"19",properties:{property:[{"@name":"distanceY","@value":"70"},{"@name":"speedY","@value":"45"}]}},{"@id":"131","@type":"4","@gid":"21","@x":"385","@y":"369.5","@width":"70","@height":"19",properties:{property:[{"@name":"distanceY","@value":"110"},{"@name":"speedY","@value":"45"}]}},{"@id":"132","@type":"4","@gid":"17","@x":"529","@y":"106","@width":"24","@height":"11"},{"@id":"133","@gid":"30","@x":"231","@y":"352","@width":"60","@height":"56",properties:{property:[{"@name":"limitLeft","@value":"10"},{"@name":"limitRight","@value":"20"}]}},{"@id":"134","@gid":"25","@x":"358","@y":"195","@width":"32","@height":"22",properties:{property:[{"@name":"delay","@value":"0"},{"@name":"maxAngle","@value":"90"},{"@name":"minAngle","@value":"90"},{"@name":"speedX","@value":"0"}]}},{"@id":"135","@type":"6","@gid":"17","@x":"635","@y":"420.5","@width":"24","@height":"11"},{"@id":"136","@gid":"30","@x":"501","@y":"491","@width":"60","@height":"56",properties:{property:[{"@name":"limitLeft","@value":"5"},{"@name":"limitRight","@value":"30"}]}},{"@id":"137","@gid":"27","@x":"560","@y":"280","@width":"31","@height":"34"},{"@id":"138","@gid":"27","@x":"467","@y":"92","@width":"31","@height":"34"},{"@id":"139","@type":"6","@gid":"20","@x":"463","@y":"490","@width":"20","@height":"70"},{"@id":"140","@gid":"43","@x":"315","@y":"210","@width":"35","@height":"35"},{"@id":"141","@gid":"2147483691","@x":"490","@y":"350","@width":"35","@height":"35"},{"@id":"142","@gid":"1073741867","@x":"560","@y":"210","@width":"35","@height":"35"},{"@id":"143","@gid":"26","@x":"408.5","@y":"125.5","@width":"15","@height":"15"},{"@id":"144","@gid":"29","@x":"481","@y":"208","@width":"60","@height":"55"},{"@id":"145","@gid":"29","@x":"280","@y":"140","@width":"60","@height":"55"}]},{"@name":"characters",object:[{"@id":"146","@gid":"24","@x":"40","@y":"484","@width":"44","@height":"52"},{"@id":"147","@gid":"28","@x":"277.5","@y":"487","@width":"63","@height":"50"}]},{"@name":"physics",object:[{"@id":"148","@x":"0","@y":"490","@width":"700","@height":"35"},{"@id":"149","@x":"0","@y":"420","@width":"35","@height":"70"},{"@id":"150","@x":"630","@y":"420","@width":"35","@height":"70"},{"@id":"151","@x":"665","@y":"140","@width":"35","@height":"350"},{"@id":"152","@x":"105","@y":"385","@width":"35","@height":"105"},{"@id":"153","@x":"70","@y":"350","@width":"70","@height":"35"},{"@id":"154","@x":"210","@y":"385","@width":"35","@height":"105"},{"@id":"155","@x":"140","@y":"455","@width":"70","@height":"35"},{"@id":"156","@x":"210","@y":"350","@width":"175","@height":"35"},{"@id":"157","@x":"455","@y":"350","@width":"140","@height":"35"},{"@id":"158","@x":"455","@y":"385","@width":"35","@height":"35"},{"@id":"159","@x":"595","@y":"175","@width":"35","@height":"210"},{"@id":"160","@x":"70","@y":"245","@width":"70","@height":"35"},{"@id":"161","@x":"210","@y":"245","@width":"140","@height":"35"},{"@id":"162","@x":"315","@y":"280","@width":"35","@height":"70"},{"@id":"163","@x":"0","@y":"140","@width":"140","@height":"35"},{"@id":"164","@x":"0","@y":"105","@width":"35","@height":"35"},{"@id":"165","@x":"245","@y":"35","@width":"35","@height":"35"},{"@id":"166","@x":"245","@y":"0","@width":"350","@height":"35"},{"@id":"167","@x":"560","@y":"35","@width":"35","@height":"70"},{"@id":"168","@x":"455","@y":"105","@width":"245","@height":"35"},{"@id":"169","@x":"420","@y":"210","@width":"105","@height":"35"},{"@id":"170","@x":"385","@y":"175","@width":"35","@height":"70"},{"@id":"171","@x":"245","@y":"140","@width":"175","@height":"35"},{"@id":"172","@x":"245","@y":"175","@width":"70","@height":"70"}]}]},{"@level":"21","@version":"1.0","@orientation":"orthogonal","@renderorder":"right-down","@width":"20","@height":"15","@tilewidth":"35","@tileheight":"35",tileset:[{"@firstgid":"1","@name":"tiles","@tilewidth":"35","@tileheight":"35",tile:[{"@id":"0",image:{"@width":"35","@height":"35","@source":"tiles/singleTile.png"}},{"@id":"1",image:{"@width":"35","@height":"35","@source":"tiles/platformLeft.png"}},{"@id":"2",image:{"@width":"35","@height":"35","@source":"tiles/platformCenter.png"}},{"@id":"3",image:{"@width":"35","@height":"35","@source":"tiles/platformRight.png"}},{"@id":"4",image:{"@width":"35","@height":"35","@source":"tiles/verticalPlatformTop.png"}},{"@id":"5",image:{"@width":"35","@height":"35","@source":"tiles/verticalPlatformCenter.png"}},{"@id":"6",image:{"@width":"35","@height":"35","@source":"tiles/verticalPlatformBottom.png"}},{"@id":"7",image:{"@width":"35","@height":"35","@source":"tiles/tileTopLeft.png"}},{"@id":"8",image:{"@width":"35","@height":"35","@source":"tiles/tileTopCenter.png"}},{"@id":"9",image:{"@width":"35","@height":"35","@source":"tiles/tileTopRight.png"}},{"@id":"10",image:{"@width":"35","@height":"35","@source":"tiles/tileCenterLeft.png"}},{"@id":"11",image:{"@width":"35","@height":"35","@source":"tiles/tileCenter.png"}},{"@id":"12",image:{"@width":"35","@height":"35","@source":"tiles/tileCenterRight.png"}},{"@id":"13",image:{"@width":"35","@height":"35","@source":"tiles/tileBottomLeft.png"}},{"@id":"14",image:{"@width":"35","@height":"35","@source":"tiles/tileBottomCenter.png"}},{"@id":"15",image:{"@width":"35","@height":"35","@source":"tiles/tileBottomRight.png"}}]},{"@firstgid":"17","@name":"active","@tilewidth":"105","@tileheight":"70",tile:[{"@id":"0",image:{"@width":"24","@height":"11","@source":"active/PushButtonGraphics.png"}},{"@id":"1",image:{"@width":"25","@height":"19","@source":"active/TriggerGraphics.png"}},{"@id":"2",image:{"@width":"20","@height":"70","@source":"active/DoorGraphics.png"}},{"@id":"3",image:{"@width":"20","@height":"70","@source":"active/GlassDoorGraphics.png"}},{"@id":"4",image:{"@width":"70","@height":"19","@source":"active/ElevatorGraphics.png"}},{"@id":"5",image:{"@width":"105","@height":"20","@source":"active/BigElevatorGraphics.png"}},{"@id":"6",image:{"@width":"70","@height":"70","@source":"active/ExitGraphics.png"}},{"@id":"7",image:{"@width":"44","@height":"52","@source":"characters/HustlerGraphics.png"}},{"@id":"8",image:{"@width":"32","@height":"22","@source":"active/CameraGraphics.png"}},{"@id":"9",image:{"@width":"15","@height":"15","@source":"characters/EnemyLimiterGraphics.png"}},{"@id":"10",image:{"@width":"31","@height":"34","@source":"passive/MoneyBagGraphics.png"}},{"@id":"11",image:{"@width":"63","@height":"50","@source":"characters/DogGraphics.png"}},{"@id":"12",image:{"@width":"60","@height":"55","@source":"characters/Prisoner2Graphics.png"}},{"@id":"13",image:{"@width":"60","@height":"56","@source":"characters/PrisonerGraphics.png"}}]},{"@firstgid":"31","@name":"passive","@tilewidth":"210","@tileheight":"50",tile:[{"@id":"0",image:{"@width":"50","@height":"50","@source":"passive/BigBoxGraphics.png"}},{"@id":"1",image:{"@width":"35","@height":"35","@source":"passive/BoxGraphics.png"}},{"@id":"2",image:{"@width":"37","@height":"35","@source":"passive/ToiletGraphics.png"}},{"@id":"3",image:{"@width":"35","@height":"35","@source":"passive/MonitorGraphics.png"}},{"@id":"4",image:{"@width":"35","@height":"35","@source":"passive/BasketBallGraphics.png"}},{"@id":"5",image:{"@width":"35","@height":"35","@source":"passive/StoolGraphics.png"}},{"@id":"6",image:{"@width":"150","@height":"20","@source":"passive/PlankGraphics.png"}},{"@id":"7",image:{"@width":"150","@height":"20","@source":"passive/Plank2Graphics.png"}},{"@id":"8",image:{"@width":"210","@height":"20","@source":"passive/BigPlankGraphics.png"}},{"@id":"9",image:{"@width":"100","@height":"20","@source":"passive/Plank5Graphics.png"}},{"@id":"10",image:{"@width":"150","@height":"20","@source":"passive/Plank2Graphics.png"}},{"@id":"11",image:{"@width":"35","@height":"35","@source":"passive/MirrorGraphics.png"}}]},{"@firstgid":"43","@name":"decor","@tilewidth":"232","@tileheight":"136",tile:[{"@id":"0",image:{"@width":"232","@height":"79","@source":"decor/LevelTextGraphics.png"}},{"@id":"1",image:{"@width":"54","@height":"20","@source":"decor/Decor1Graphics.png"}},{"@id":"2",image:{"@width":"54","@height":"20","@source":"decor/Decor2Graphics.png"}},{"@id":"3",image:{"@width":"33","@height":"27","@source":"decor/Decor3Graphics.png"}},{"@id":"4",image:{"@width":"34","@height":"25","@source":"decor/Decor4Graphics.png"}},{"@id":"5",image:{"@width":"22","@height":"31","@source":"decor/Decor5Graphics.png"}},{"@id":"6",image:{"@width":"126","@height":"59","@source":"decor/Decor6Graphics.png"}},{"@id":"7",image:{"@width":"25","@height":"21","@source":"decor/Decor8Graphics.png"}},{"@id":"8",image:{"@width":"18","@height":"22","@source":"decor/Decor9Graphics.png"}},{"@id":"9",image:{"@width":"35","@height":"58","@source":"decor/Decor10Graphics.png"}},{"@id":"10",image:{"@width":"19","@height":"66","@source":"decor/Decor11Graphics.png"}},{"@id":"11",image:{"@width":"23","@height":"33","@source":"decor/Decor12Graphics.png"}},{"@id":"12",image:{"@width":"38","@height":"26","@source":"decor/Decor13Graphics.png"}},{"@id":"13",image:{"@width":"43","@height":"78","@source":"decor/Decor14Graphics.png"}},{"@id":"14",image:{"@width":"60","@height":"86","@source":"decor/Decor15Graphics.png"}},{"@id":"15",image:{"@width":"41","@height":"69","@source":"decor/Decor16Graphics.png"}},{"@id":"16",image:{"@width":"55","@height":"58","@source":"decor/Decor17Graphics.png"}},{"@id":"17",image:{"@width":"57","@height":"54","@source":"decor/Decor18Graphics.png"}},{"@id":"18",image:{"@width":"18","@height":"45","@source":"decor/Decor19Graphics.png"}},{"@id":"19",image:{"@width":"41","@height":"49","@source":"decor/Decor20Graphics.png"}},{"@id":"20",image:{"@width":"51","@height":"38","@source":"decor/Decor21Graphics.png"}},{"@id":"21",image:{"@width":"54","@height":"54","@source":"decor/Decor22Graphics.png"}},{"@id":"22",image:{"@width":"63","@height":"136","@source":"decor/Decor23Graphics.png"}},{"@id":"23",image:{"@width":"21","@height":"39","@source":"decor/Decor24Graphics.png"}},{"@id":"24",image:{"@width":"104","@height":"50","@source":"decor/Decor25Graphics.png"}},{"@id":"25",image:{"@width":"104","@height":"46","@source":"decor/Decor26Graphics.png"}},{"@id":"26",image:{"@width":"86","@height":"38","@source":"decor/Decor27Graphics.png"}},{"@id":"27",image:{"@width":"63","@height":"55","@source":"decor/Decor28Graphics.png"}},{"@id":"28",image:{"@width":"13","@height":"23","@source":"decor/Decor29Graphics.png"}},{"@id":"29",image:{"@width":"28","@height":"40","@source":"decor/Decor30Graphics.png"}},{"@id":"30",image:{"@width":"69","@height":"30","@source":"decor/Decor31Graphics.png"}},{"@id":"31",image:{"@width":"33","@height":"29","@source":"decor/Decor32Graphics.png"}},{"@id":"32",image:{"@width":"42","@height":"42","@source":"decor/Decor33Graphics.png"}},{"@id":"33",image:{"@width":"60","@height":"66","@source":"decor/Decor34Graphics.png"}},{"@id":"34",image:{"@width":"46","@height":"65","@source":"decor/Decor35Graphics.png"}},{"@id":"35",image:{"@width":"71","@height":"55","@source":"decor/Decor36Graphics.png"}},{"@id":"36",image:{"@width":"35","@height":"55","@source":"decor/Decor37Graphics.png"}},{"@id":"37",image:{"@width":"28","@height":"29","@source":"decor/Decor38Graphics.png"}},{"@id":"38",image:{"@width":"38","@height":"37","@source":"decor/Decor39Graphics.png"}},{"@id":"39",image:{"@width":"103","@height":"50","@source":"decor/Decor40Graphics.png"}},{"@id":"40",image:{"@width":"56","@height":"55","@source":"decor/Decor41Graphics.png"}},{"@id":"41",image:{"@width":"71","@height":"50","@source":"decor/Decor42Graphics.png"}},{"@id":"42",image:{"@width":"200","@height":"44","@source":"decor/TxtGraphics.png"}}]}],imagelayer:{"@name":"background","@x":"1",image:{"@source":"bg/Background1Graphics.png"}},objectgroup:[{"@name":"decorations"},{"@name":"tiles",object:[{"@gid":"12","@x":"0","@y":"525","@width":"35","@height":"35"},{"@gid":"9","@x":"455","@y":"525","@width":"35","@height":"35"},{"@gid":"9","@x":"420","@y":"525","@width":"35","@height":"35"},{"@gid":"9","@x":"350","@y":"525","@width":"35","@height":"35"},{"@gid":"9","@x":"385","@y":"525","@width":"35","@height":"35"},{"@gid":"9","@x":"140","@y":"525","@width":"35","@height":"35"},{"@gid":"9","@x":"245","@y":"525","@width":"35","@height":"35"},{"@gid":"9","@x":"210","@y":"525","@width":"35","@height":"35"},{"@gid":"9","@x":"175","@y":"525","@width":"35","@height":"35"},{"@gid":"9","@x":"630","@y":"525","@width":"35","@height":"35"},{"@gid":"9","@x":"35","@y":"525","@width":"35","@height":"35"},{"@gid":"9","@x":"105","@y":"525","@width":"35","@height":"35"},{"@gid":"9","@x":"595","@y":"525","@width":"35","@height":"35"},{"@gid":"9","@x":"70","@y":"525","@width":"35","@height":"35"},{"@gid":"12","@x":"665","@y":"525","@width":"35","@height":"35"},{"@gid":"12","@x":"245","@y":"210","@width":"35","@height":"35"},{"@gid":"12","@x":"490","@y":"175","@width":"35","@height":"35"},{"@gid":"12","@x":"0","@y":"385","@width":"35","@height":"35"},{"@gid":"12","@x":"665","@y":"210","@width":"35","@height":"35"},{"@gid":"12","@x":"0","@y":"245","@width":"35","@height":"35"},{"@gid":"9","@x":"560","@y":"525","@width":"35","@height":"35"},{"@gid":"9","@x":"525","@y":"525","@width":"35","@height":"35"},{"@gid":"9","@x":"490","@y":"525","@width":"35","@height":"35"},{"@gid":"9","@x":"315","@y":"525","@width":"35","@height":"35"},{"@gid":"9","@x":"280","@y":"525","@width":"35","@height":"35"},{"@gid":"11","@x":"665","@y":"490","@width":"35","@height":"35"},{"@gid":"11","@x":"665","@y":"455","@width":"35","@height":"35"},{"@gid":"11","@x":"665","@y":"420","@width":"35","@height":"35"},{"@gid":"11","@x":"665","@y":"385","@width":"35","@height":"35"},{"@gid":"11","@x":"665","@y":"350","@width":"35","@height":"35"},{"@gid":"11","@x":"665","@y":"315","@width":"35","@height":"35"},{"@gid":"11","@x":"665","@y":"280","@width":"35","@height":"35"},{"@gid":"11","@x":"665","@y":"245","@width":"35","@height":"35"},{"@gid":"11","@x":"665","@y":"175","@width":"35","@height":"35"},{"@gid":"11","@x":"665","@y":"140","@width":"35","@height":"35"},{"@gid":"11","@x":"665","@y":"105","@width":"35","@height":"35"},{"@gid":"11","@x":"665","@y":"70","@width":"35","@height":"35"},{"@gid":"11","@x":"665","@y":"35","@width":"35","@height":"35"},{"@gid":"13","@x":"0","@y":"490","@width":"35","@height":"35"},{"@gid":"13","@x":"0","@y":"455","@width":"35","@height":"35"},{"@gid":"13","@x":"0","@y":"420","@width":"35","@height":"35"},{"@gid":"13","@x":"0","@y":"350","@width":"35","@height":"35"},{"@gid":"13","@x":"0","@y":"315","@width":"35","@height":"35"},{"@gid":"13","@x":"0","@y":"280","@width":"35","@height":"35"},{"@gid":"13","@x":"0","@y":"210","@width":"35","@height":"35"},{"@gid":"13","@x":"0","@y":"175","@width":"35","@height":"35"},{"@gid":"13","@x":"0","@y":"140","@width":"35","@height":"35"},{"@gid":"13","@x":"0","@y":"105","@width":"35","@height":"35"},{"@gid":"13","@x":"0","@y":"70","@width":"35","@height":"35"},{"@gid":"13","@x":"0","@y":"35","@width":"35","@height":"35"},{"@gid":"4","@x":"35","@y":"245","@width":"35","@height":"35"},{"@gid":"4","@x":"560","@y":"315","@width":"35","@height":"35"},{"@gid":"4","@x":"525","@y":"455","@width":"35","@height":"35"},{"@gid":"2","@x":"455","@y":"455","@width":"35","@height":"35"},{"@gid":"2","@x":"245","@y":"455","@width":"35","@height":"35"},{"@gid":"10","@x":"525","@y":"175","@width":"35","@height":"35"},{"@gid":"10","@x":"280","@y":"175","@width":"35","@height":"35"},{"@gid":"10","@x":"140","@y":"140","@width":"35","@height":"35"},{"@gid":"8","@x":"455","@y":"175","@width":"35","@height":"35"},{"@gid":"8","@x":"105","@y":"140","@width":"35","@height":"35"},{"@gid":"14","@x":"105","@y":"175","@width":"35","@height":"35"},{"@gid":"16","@x":"175","@y":"385","@width":"35","@height":"35"},{"@gid":"16","@x":"280","@y":"455","@width":"35","@height":"35"},{"@gid":"16","@x":"420","@y":"350","@width":"35","@height":"35"},{"@gid":"5","@x":"280","@y":"420","@width":"35","@height":"35"},{"@gid":"5","@x":"420","@y":"280","@width":"35","@height":"35"},{"@gid":"5","@x":"490","@y":"140","@width":"35","@height":"35"},{"@gid":"1","@x":"560","@y":"385","@width":"35","@height":"35"},{"@gid":"15","@x":"490","@y":"455","@width":"35","@height":"35"},{"@gid":"6","@x":"490","@y":"420","@width":"35","@height":"35"},{"@gid":"6","@x":"490","@y":"385","@width":"35","@height":"35"},{"@gid":"6","@x":"490","@y":"350","@width":"35","@height":"35"},{"@gid":"3","@x":"525","@y":"315","@width":"35","@height":"35"},{"@gid":"3","@x":"455","@y":"315","@width":"35","@height":"35"},{"@gid":"9","@x":"490","@y":"315","@width":"35","@height":"35"},{"@gid":"8","@x":"245","@y":"175","@width":"35","@height":"35"},{"@gid":"3","@x":"140","@y":"385","@width":"35","@height":"35"},{"@gid":"3","@x":"105","@y":"385","@width":"35","@height":"35"},{"@gid":"3","@x":"70","@y":"385","@width":"35","@height":"35"},{"@gid":"3","@x":"35","@y":"385","@width":"35","@height":"35"},{"@gid":"3","@x":"385","@y":"350","@width":"35","@height":"35"},{"@gid":"3","@x":"350","@y":"350","@width":"35","@height":"35"},{"@gid":"3","@x":"315","@y":"350","@width":"35","@height":"35"},{"@gid":"3","@x":"280","@y":"350","@width":"35","@height":"35"},{"@gid":"3","@x":"245","@y":"350","@width":"35","@height":"35"},{"@gid":"3","@x":"210","@y":"350","@width":"35","@height":"35"},{"@gid":"8","@x":"175","@y":"350","@width":"35","@height":"35"},{"@gid":"11","@x":"420","@y":"315","@width":"35","@height":"35"},{"@gid":"13","@x":"140","@y":"175","@width":"35","@height":"35"},{"@gid":"14","@x":"140","@y":"210","@width":"35","@height":"35"},{"@gid":"3","@x":"210","@y":"210","@width":"35","@height":"35"},{"@gid":"3","@x":"175","@y":"210","@width":"35","@height":"35"},{"@gid":"3","@x":"420","@y":"210","@width":"35","@height":"35"},{"@gid":"3","@x":"385","@y":"210","@width":"35","@height":"35"},{"@gid":"3","@x":"350","@y":"210","@width":"35","@height":"35"},{"@gid":"3","@x":"315","@y":"210","@width":"35","@height":"35"},{"@gid":"3","@x":"560","@y":"210","@width":"35","@height":"35"},{"@gid":"3","@x":"595","@y":"210","@width":"35","@height":"35"},{"@gid":"3","@x":"630","@y":"210","@width":"35","@height":"35"},{"@gid":"15","@x":"455","@y":"210","@width":"35","@height":"35"},{"@gid":"15","@x":"490","@y":"210","@width":"35","@height":"35"},{"@gid":"15","@x":"525","@y":"210","@width":"35","@height":"35"},{"@gid":"7","@x":"245","@y":"245","@width":"35","@height":"35"},{"@gid":"15","@x":"280","@y":"210","@width":"35","@height":"35"}]},{"@name":"active",object:[{"@gid":"27","@x":"525","@y":"140","@width":"31","@height":"34"},{"@gid":"27","@x":"350","@y":"385","@width":"31","@height":"34"},{"@type":"2","@gid":"17","@x":"493","@y":"281.5","@width":"24","@height":"11"},{"@type":"5","@gid":"19","@x":"595","@y":"370","@width":"20","@height":"70","@rotation":"-90"},{"@gid":"27","@x":"280","@y":"385","@width":"31","@height":"34"},{"@gid":"27","@x":"315","@y":"420","@width":"31","@height":"34"},{"@gid":"27","@x":"490","@y":"105","@width":"31","@height":"34"},{"@gid":"27","@x":"420","@y":"455","@width":"31","@height":"34"},{"@gid":"27","@x":"420","@y":"105","@width":"31","@height":"34"},{"@gid":"27","@x":"315","@y":"70","@width":"31","@height":"34"},{"@gid":"27","@x":"350","@y":"105","@width":"31","@height":"34"},{"@gid":"27","@x":"420","@y":"175","@width":"31","@height":"34"},{"@gid":"27","@x":"210","@y":"105","@width":"31","@height":"34"},{"@gid":"27","@x":"210","@y":"245","@width":"31","@height":"34"},{"@gid":"27","@x":"455","@y":"140","@width":"31","@height":"34"},{"@gid":"27","@x":"350","@y":"175","@width":"31","@height":"34"},{"@gid":"27","@x":"455","@y":"70","@width":"31","@height":"34"},{"@gid":"27","@x":"35","@y":"140","@width":"31","@height":"34"},{"@gid":"27","@x":"35","@y":"350","@width":"31","@height":"34"},{"@gid":"27","@x":"140","@y":"105","@width":"31","@height":"34"},{"@gid":"27","@x":"245","@y":"420","@width":"31","@height":"34"},{"@gid":"27","@x":"175","@y":"420","@width":"31","@height":"34"},{"@gid":"27","@x":"140","@y":"245","@width":"31","@height":"34"},{"@gid":"27","@x":"70","@y":"175","@width":"31","@height":"34"},{"@gid":"27","@x":"175","@y":"280","@width":"31","@height":"34"},{"@gid":"27","@x":"420","@y":"245","@width":"31","@height":"34"},{"@gid":"27","@x":"280","@y":"105","@width":"31","@height":"34"},{"@gid":"27","@x":"70","@y":"245","@width":"31","@height":"34"},{"@gid":"27","@x":"595","@y":"70","@width":"31","@height":"34"},{"@gid":"27","@x":"315","@y":"140","@width":"31","@height":"34"},{"@gid":"27","@x":"105","@y":"350","@width":"31","@height":"34"},{"@gid":"27","@x":"105","@y":"280","@width":"31","@height":"34"},{"@gid":"27","@x":"595","@y":"350","@width":"31","@height":"34"},{"@gid":"27","@x":"525","@y":"70","@width":"31","@height":"34"},{"@gid":"27","@x":"455","@y":"350","@width":"31","@height":"34"},{"@gid":"27","@x":"490","@y":"245","@width":"31","@height":"34"},{"@gid":"27","@x":"630","@y":"245","@width":"31","@height":"34"},{"@gid":"27","@x":"630","@y":"455","@width":"31","@height":"34"},{"@gid":"27","@x":"455","@y":"490","@width":"31","@height":"34"},{"@gid":"27","@x":"385","@y":"280","@width":"31","@height":"34"},{"@gid":"27","@x":"70","@y":"105","@width":"31","@height":"34"},{"@gid":"27","@x":"385","@y":"420","@width":"31","@height":"34"},{"@gid":"27","@x":"35","@y":"280","@width":"31","@height":"34"},{"@gid":"27","@x":"385","@y":"490","@width":"31","@height":"34"},{"@gid":"27","@x":"245","@y":"140","@width":"31","@height":"34"},{"@gid":"27","@x":"560","@y":"105","@width":"31","@height":"34"},{"@gid":"27","@x":"35","@y":"210","@width":"31","@height":"34"},{"@gid":"27","@x":"525","@y":"280","@width":"31","@height":"34"},{"@gid":"27","@x":"70","@y":"315","@width":"31","@height":"34"},{"@gid":"27","@x":"315","@y":"490","@width":"31","@height":"34"},{"@gid":"27","@x":"560","@y":"245","@width":"31","@height":"34"},{"@gid":"27","@x":"455","@y":"280","@width":"31","@height":"34"},{"@gid":"27","@x":"560","@y":"455","@width":"31","@height":"34"},{"@gid":"27","@x":"420","@y":"385","@width":"31","@height":"34"},{"@gid":"27","@x":"175","@y":"140","@width":"31","@height":"34"},{"@gid":"27","@x":"350","@y":"455","@width":"31","@height":"34"},{"@gid":"27","@x":"525","@y":"350","@width":"31","@height":"34"},{"@gid":"27","@x":"280","@y":"280","@width":"31","@height":"34"},{"@gid":"27","@x":"525","@y":"490","@width":"31","@height":"34"},{"@gid":"27","@x":"210","@y":"385","@width":"31","@height":"34"},{"@gid":"27","@x":"595","@y":"280","@width":"31","@height":"34"},{"@gid":"27","@x":"175","@y":"70","@width":"31","@height":"34"},{"@gid":"27","@x":"455","@y":"420","@width":"31","@height":"34"},{"@gid":"27","@x":"210","@y":"455","@width":"31","@height":"34"},{"@gid":"27","@x":"105","@y":"490","@width":"31","@height":"34"},{"@gid":"27","@x":"630","@y":"315","@width":"31","@height":"34"},{"@gid":"27","@x":"630","@y":"105","@width":"31","@height":"34"},{"@gid":"27","@x":"595","@y":"490","@width":"31","@height":"34"},{"@gid":"27","@x":"245","@y":"490","@width":"31","@height":"34"},{"@gid":"27","@x":"595","@y":"420","@width":"31","@height":"34"},{"@gid":"27","@x":"385","@y":"70","@width":"31","@height":"34"},{"@gid":"27","@x":"105","@y":"420","@width":"31","@height":"34"},{"@gid":"27","@x":"525","@y":"420","@width":"31","@height":"34"},{"@gid":"27","@x":"140","@y":"455","@width":"31","@height":"34"},{"@gid":"27","@x":"210","@y":"175","@width":"31","@height":"34"},{"@gid":"27","@x":"245","@y":"70","@width":"31","@height":"34"},{"@gid":"27","@x":"175","@y":"490","@width":"31","@height":"34"},{"@gid":"27","@x":"385","@y":"140","@width":"31","@height":"34"},{"@gid":"27","@x":"210","@y":"315","@width":"31","@height":"34"},{"@gid":"27","@x":"630","@y":"385","@width":"31","@height":"34"},{"@gid":"27","@x":"35","@y":"420","@width":"31","@height":"34"},{"@gid":"27","@x":"140","@y":"315","@width":"31","@height":"34"},{"@type":"2","@gid":"19","@x":"251","@y":"315","@width":"20","@height":"70"},{"@type":"5","@gid":"17","@x":"283","@y":"141.5","@width":"24","@height":"11"},{"@gid":"30","@x":"308","@y":"318","@width":"60","@height":"56",properties:{property:[{"@name":"limitLeft","@value":"25"},{"@name":"limitRight","@value":"50"}]}}]},{"@name":"characters",object:[{"@gid":"24","@x":"44","@y":"491","@width":"44","@height":"52"},{"@gid":"28","@x":"581","@y":"174","@width":"63","@height":"50"}]},{"@name":"physics",object:[{"@x":"0","@y":"490","@width":"700","@height":"35"},{"@x":"665","@y":"0","@width":"35","@height":"490"},{"@x":"0","@y":"0","@width":"35","@height":"490"},{"@x":"35","@y":"210","@width":"35","@height":"35"},{"@x":"35","@y":"350","@width":"175","@height":"35"},{"@x":"175","@y":"315","@width":"280","@height":"35"},{"@x":"420","@y":"280","@width":"175","@height":"35"},{"@x":"420","@y":"245","@width":"35","@height":"35"},{"@x":"490","@y":"315","@width":"35","@height":"105"},{"@x":"455","@y":"420","@width":"105","@height":"35"},{"@x":"560","@y":"350","@width":"35","@height":"35"},{"@x":"245","@y":"420","@width":"70","@height":"35"},{"@x":"280","@y":"385","@width":"35","@height":"35"},{"@x":"245","@y":"210","@width":"35","@height":"35"},{"@x":"140","@y":"175","@width":"525","@height":"35"},{"@x":"455","@y":"140","@width":"105","@height":"35"},{"@x":"490","@y":"105","@width":"35","@height":"35"},{"@x":"245","@y":"140","@width":"70","@height":"35"},{"@x":"105","@y":"105","@width":"70","@height":"70"}]}]}],t}(),mm3_button=function(){function t(){}return t.data={frames:[{filename:"button_01.png",frame:{x:0,y:0,w:153,h:67},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:153,h:67},sourceSize:{w:153,h:67}},{filename:"button_02.png",frame:{x:153,y:0,w:176,h:54},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:176,h:54},sourceSize:{w:176,h:54}},{filename:"button_03.png",frame:{x:329,y:0,w:132,h:59},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:132,h:59},sourceSize:{w:132,h:59}},{filename:"titlebox.png",frame:{x:0,y:67,w:236,h:369},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:236,h:369},sourceSize:{w:236,h:369}},{filename:"titlebox_large.png",frame:{x:0,y:436,w:484,h:138},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:484,h:138},sourceSize:{w:484,h:138}}],meta:{app:"https://www.codeandweb.com/texturepacker",version:"1.0",image:"mm3_button.png",format:"RGBA8888",size:{w:484,h:574},scale:"1",smartupdate:"$TexturePacker:SmartUpdate:94813ff0cd8549b08dfcd21a49eff0fd:cd3a23a39c2fcb8e5cf29e9b853f9493:3ffa16b1206e2680e28a09091a54b9a2$"}},t}(),mm3_ru_logo=function(){function t(){}return t.data={frames:[{filename:"logo.png",frame:{x:0,y:0,w:317,h:259},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:317,h:259},sourceSize:{w:317,h:259}},{filename:"titlescreen.png",frame:{x:0,y:259,w:712,h:530},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:712,h:530},sourceSize:{w:712,h:530}}],meta:{app:"https://www.codeandweb.com/texturepacker",version:"1.0",image:"mm3_ru_logo.png",format:"RGBA8888",size:{w:712,h:789},scale:"1",smartupdate:"$TexturePacker:SmartUpdate:d4f65ac17b5d4cd0ab50d55bdeefda8b:361b4c1006ba7a118810c9a9ee149e77:1c17e9194a80d799793018e3f9e808e7$"}},t}(),Objects=function(){function t(){}return t.data={frames:[{filename:"BackButton0000",frame:{x:3521,y:1790,w:122,h:54},rotated:!1,trimmed:!0,spriteSourceSize:{x:.4,y:.1,w:122,h:54},sourceSize:{w:122,h:54}},{filename:"BackButton0001",frame:{x:2302,y:1792,w:122,h:54},rotated:!1,trimmed:!0,spriteSourceSize:{x:.4,y:.1,w:122,h:54},sourceSize:{w:122,h:54}},{filename:"BackButton0002",frame:{x:589,y:1793,w:122,h:54},rotated:!1,trimmed:!0,spriteSourceSize:{x:.4,y:.1,w:122,h:54},sourceSize:{w:122,h:54}},{filename:"Background1Graphics0000",frame:{x:2836,y:3,w:702,h:526},rotated:!1,trimmed:!0,spriteSourceSize:{x:-1,y:0,w:702,h:526},sourceSize:{w:702,h:526}},{filename:"BasketBallGraphics0000",frame:{x:3216,y:1323,w:35,h:35},rotated:!1,trimmed:!0,spriteSourceSize:{x:-17.6,y:-17.6,w:35,h:35},sourceSize:{w:35,h:35}},{filename:"BigBoxGraphics0000",frame:{x:1461,y:1743,w:50,h:50},rotated:!1,trimmed:!0,spriteSourceSize:{x:-25,y:-25,w:50,h:50},sourceSize:{w:50,h:50}},{filename:"BigPlankGraphics0000",frame:{x:3,y:2489,w:210,h:20},rotated:!1,trimmed:!0,spriteSourceSize:{x:-105,y:-10,w:210,h:20},sourceSize:{w:210,h:20}},{filename:"BoxGraphics0000",frame:{x:3216,y:1361,w:35,h:35},rotated:!1,trimmed:!0,spriteSourceSize:{x:-17.5,y:-17.5,w:35,h:35},sourceSize:{w:35,h:35}},{filename:"BulletFxGraphics0000",frame:{x:2818,y:584,w:15,h:9},rotated:!1,trimmed:!0,spriteSourceSize:{x:-7.1,y:-4.8,w:57,h:53},sourceSize:{w:57,h:53}},{filename:"BulletFxGraphics0001",frame:{x:1022,y:985,w:41,h:37},rotated:!1,trimmed:!0,spriteSourceSize:{x:-22.1,y:-19.8,w:57,h:53},sourceSize:{w:57,h:53}},{filename:"BulletFxGraphics0002",frame:{x:838,y:2196,w:54,h:44},rotated:!1,trimmed:!0,spriteSourceSize:{x:-29.1,y:-21.8,w:57,h:53},sourceSize:{w:57,h:53}},{filename:"BulletFxGraphics0003",frame:{x:239,y:2689,w:54,h:52},rotated:!1,trimmed:!0,spriteSourceSize:{x:-27.1,y:-26.8,w:57,h:53},sourceSize:{w:57,h:53}},{filename:"BulletFxGraphics0004",frame:{x:1363,y:2669,w:56,h:53},rotated:!1,trimmed:!0,spriteSourceSize:{x:-28.1,y:-27.8,w:57,h:53},sourceSize:{w:57,h:53}},{filename:"BulletFxGraphics0005",frame:{x:3,y:3,w:0,h:0},rotated:!1,trimmed:!0,spriteSourceSize:{x:-.1,y:-.8,w:57,h:53},sourceSize:{w:57,h:53}},{filename:"BulletGraphics0000",frame:{x:4079,y:333,w:11,h:7},rotated:!1,trimmed:!0,spriteSourceSize:{x:-5.4,y:-3.8,w:11,h:7},sourceSize:{w:11,h:7}},{filename:"BurgerAchievementGraphics0000",frame:{x:1423,y:3,w:705,h:528},rotated:!1,trimmed:!0,spriteSourceSize:{x:-2,y:-1,w:705,h:528},sourceSize:{w:705,h:528}},{filename:"BurgerGraphics0000",frame:{x:3126,y:1267,w:30,h:34},rotated:!1,trimmed:!0,spriteSourceSize:{x:-14.9,y:-20.7,w:30,h:34},sourceSize:{w:30,h:34}},{filename:"BurgerIndicator0000",frame:{x:2008,y:2061,w:114,h:42},rotated:!1,trimmed:!0,spriteSourceSize:{x:-.8,y:-3.6,w:114,h:42},sourceSize:{w:114,h:42}},{filename:"BurgerSmallGraphics0000",frame:{x:2734,y:1471,w:27,h:29},rotated:!1,trimmed:!0,spriteSourceSize:{x:-14.2,y:-17.5,w:27,h:29},sourceSize:{w:27,h:29}},{filename:"CameraGraphics0000",frame:{x:425,y:1538,w:26,h:24},rotated:!1,trimmed:!0,spriteSourceSize:{x:-6,y:-10,w:26,h:24},sourceSize:{w:26,h:24}},{filename:"CameraGun0000",frame:{x:851,y:1060,w:24,h:18},rotated:!1,trimmed:!0,spriteSourceSize:{x:-22,y:-10.9,w:68,h:23},sourceSize:{w:68,h:23}},{filename:"CameraGun0001",frame:{x:422,y:1074,w:68,h:23},rotated:!1,trimmed:!0,spriteSourceSize:{x:-22,y:-11.9,w:68,h:23},sourceSize:{w:68,h:23}},{filename:"CreditsButton0000",frame:{x:2396,y:2605,w:106,h:32},rotated:!1,trimmed:!0,spriteSourceSize:{x:0,y:.2,w:106,h:33},sourceSize:{w:106,h:33}},{filename:"CreditsButton0001",frame:{x:3222,y:2607,w:106,h:32},rotated:!1,trimmed:!0,spriteSourceSize:{x:0,y:.2,w:106,h:33},sourceSize:{w:106,h:33}},{filename:"CreditsButton0002",frame:{x:3222,y:2607,w:106,h:32},rotated:!1,trimmed:!0,spriteSourceSize:{x:0,y:.2,w:106,h:33},sourceSize:{w:106,h:33}},{filename:"Decor10Graphics0000",frame:{x:2091,y:534,w:36,h:57},rotated:!1,trimmed:!0,spriteSourceSize:{x:0,y:-57.8,w:36,h:57},sourceSize:{w:36,h:57}},{filename:"Decor11Graphics0000",frame:{x:3811,y:949,w:20,h:66},rotated:!1,trimmed:!0,spriteSourceSize:{x:0,y:-66.3,w:20,h:66},sourceSize:{w:20,h:66}},{filename:"Decor12Graphics0000",frame:{x:2734,y:1435,w:24,h:33},rotated:!1,trimmed:!0,spriteSourceSize:{x:0,y:-33,w:24,h:33},sourceSize:{w:24,h:33}},{filename:"Decor13Graphics0000",frame:{x:4055,y:1286,w:38,h:25},rotated:!1,trimmed:!0,spriteSourceSize:{x:0,y:-25.8,w:38,h:25},sourceSize:{w:38,h:25}},{filename:"Decor14Graphics0000",frame:{x:4041,y:804,w:43,h:77},rotated:!1,trimmed:!0,spriteSourceSize:{x:0,y:-77.5,w:43,h:77},sourceSize:{w:43,h:77}},{filename:"Decor15Graphics0000",frame:{x:1635,y:796,w:60,h:86},rotated:!1,trimmed:!0,spriteSourceSize:{x:0,y:-86.4,w:60,h:86},sourceSize:{w:60,h:86}},{filename:"Decor16Graphics0000",frame:{x:2086,y:659,w:42,h:68},rotated:!1,trimmed:!0,spriteSourceSize:{x:0,y:-68.9,w:42,h:68},sourceSize:{w:42,h:68}},{filename:"Decor17Graphics0000",frame:{x:3405,y:2644,w:56,h:58},rotated:!1,trimmed:!0,spriteSourceSize:{x:0,y:-58.4,w:56,h:58},sourceSize:{w:56,h:58}},{filename:"Decor18Graphics0000",frame:{x:342,y:1897,w:58,h:53},rotated:!1,trimmed:!0,spriteSourceSize:{x:0,y:-53.8,w:58,h:53},sourceSize:{w:58,h:53}},{filename:"Decor19Graphics0000",frame:{x:4071,y:44,w:18,h:44},rotated:!1,trimmed:!0,spriteSourceSize:{x:0,y:-44.5,w:18,h:44},sourceSize:{w:18,h:44}},{filename:"Decor1Graphics0000",frame:{x:1635,y:885,w:54,h:19},rotated:!1,trimmed:!0,spriteSourceSize:{x:0,y:-19.9,w:54,h:19},sourceSize:{w:54,h:19}},{filename:"Decor20Graphics0000",frame:{x:2086,y:730,w:42,h:49},rotated:!1,trimmed:!0,spriteSourceSize:{x:0,y:-49.1,w:42,h:49},sourceSize:{w:42,h:49}},{filename:"Decor21Graphics0000",frame:{x:1580,y:979,w:52,h:38},rotated:!1,trimmed:!0,spriteSourceSize:{x:0,y:-38.2,w:52,h:38},sourceSize:{w:52,h:38}},{filename:"Decor22Graphics0000",frame:{x:1305,y:2669,w:55,h:54},rotated:!1,trimmed:!0,spriteSourceSize:{x:0,y:-54.4,w:55,h:54},sourceSize:{w:55,h:54}},{filename:"Decor23Graphics0000",frame:{x:2499,y:1407,w:63,h:135},rotated:!1,trimmed:!0,spriteSourceSize:{x:0,y:-135.5,w:63,h:135},sourceSize:{w:63,h:135}},{filename:"Decor24Graphics0000",frame:{x:4071,y:3,w:22,h:38},rotated:!1,trimmed:!0,spriteSourceSize:{x:0,y:-38.7,w:22,h:38},sourceSize:{w:22,h:38}},{filename:"Decor25Graphics0000",frame:{x:950,y:1949,w:105,h:51},rotated:!1,trimmed:!0,spriteSourceSize:{x:0,y:-50.1,w:105,h:51},sourceSize:{w:105,h:51}},{filename:"Decor26Graphics0000",frame:{x:3158,y:2056,w:105,h:46},rotated:!1,trimmed:!0,spriteSourceSize:{x:-.2,y:-46.4,w:105,h:46},sourceSize:{w:105,h:46}},{filename:"Decor27Graphics0000",frame:{x:1164,y:2654,w:86,h:38},rotated:!1,trimmed:!0,spriteSourceSize:{x:-.1,y:-38.3,w:86,h:38},sourceSize:{w:86,h:38}},{filename:"Decor28Graphics0000",frame:{x:159,y:2557,w:64,h:55},rotated:!1,trimmed:!0,spriteSourceSize:{x:0,y:-55.1,w:64,h:55},sourceSize:{w:64,h:55}},{filename:"Decor29Graphics0000",frame:{x:4079,y:290,w:14,h:23},rotated:!1,trimmed:!0,spriteSourceSize:{x:0,y:-23.3,w:14,h:23},sourceSize:{w:14,h:23}},{filename:"Decor2Graphics0000",frame:{x:646,y:926,w:54,h:19},rotated:!1,trimmed:!0,spriteSourceSize:{x:0,y:-19.8,w:54,h:19},sourceSize:{w:54,h:19}},{filename:"Decor30Graphics0000",frame:{x:1266,y:1229,w:28,h:40},rotated:!1,trimmed:!0,spriteSourceSize:{x:0,y:-40.3,w:28,h:40},sourceSize:{w:28,h:40}},{filename:"Decor31Graphics0000",frame:{x:985,y:1843,w:69,h:30},rotated:!1,trimmed:!0,spriteSourceSize:{x:0,y:-30.3,w:69,h:30},sourceSize:{w:69,h:30}},{filename:"Decor32Graphics0000",frame:{x:4056,y:364,w:33,h:28},rotated:!1,trimmed:!0,spriteSourceSize:{x:0,y:-28.6,w:33,h:28},sourceSize:{w:33,h:28}},{filename:"Decor33Graphics0000",frame:{x:3411,y:1426,w:42,h:41},rotated:!1,trimmed:!0,spriteSourceSize:{x:0,y:-41.6,w:42,h:41},sourceSize:{w:42,h:41}},{filename:"Decor34Graphics0000",frame:{x:2055,y:1337,w:61,h:65},rotated:!1,trimmed:!0,spriteSourceSize:{x:0,y:-65.5,w:61,h:65},sourceSize:{w:61,h:65}},{filename:"Decor35Graphics0000",frame:{x:3458,y:1569,w:47,h:64},rotated:!1,trimmed:!0,spriteSourceSize:{x:0,y:-64.8,w:47,h:64},sourceSize:{w:47,h:64}},{filename:"Decor36Graphics0000",frame:{x:1202,y:2532,w:72,h:54},rotated:!1,trimmed:!0,spriteSourceSize:{x:0,y:-54.8,w:72,h:54},sourceSize:{w:72,h:54}},{filename:"Decor37Graphics0000",frame:{x:2091,y:594,w:36,h:55},rotated:!1,trimmed:!0,spriteSourceSize:{x:0,y:-55.3,w:36,h:55},sourceSize:{w:36,h:55}},{filename:"Decor38Graphics0000",frame:{x:2818,y:1516,w:29,h:28},rotated:!1,trimmed:!0,spriteSourceSize:{x:0,y:-28.7,w:29,h:28},sourceSize:{w:29,h:28}},{filename:"Decor39Graphics0000",frame:{x:2841,y:1130,w:38,h:37},rotated:!1,trimmed:!0,spriteSourceSize:{x:0,y:-37.2,w:38,h:37},sourceSize:{w:38,h:37}},{filename:"Decor3Graphics0000",frame:{x:3952,y:1076,w:34,h:26},rotated:!1,trimmed:!0,spriteSourceSize:{x:0,y:-26.9,w:34,h:26},sourceSize:{w:34,h:26}},{filename:"Decor40Graphics0000",frame:{x:2536,y:1999,w:103,h:49},rotated:!1,trimmed:!0,spriteSourceSize:{x:0,y:-49.6,w:103,h:49},sourceSize:{w:103,h:49}},{filename:"Decor41Graphics0000",frame:{x:2995,y:2228,w:56,h:54},rotated:!1,trimmed:!0,spriteSourceSize:{x:0,y:-54.7,w:56,h:54},sourceSize:{w:56,h:54}},{filename:"Decor42Graphics0000",frame:{x:1646,y:1024,w:72,h:49},rotated:!1,trimmed:!0,spriteSourceSize:{x:0,y:-49.6,w:72,h:49},sourceSize:{w:72,h:49}},{filename:"Decor4Graphics0000",frame:{x:2568,y:1077,w:34,h:25},rotated:!1,trimmed:!0,spriteSourceSize:{x:0,y:-25.5,w:34,h:25},sourceSize:{w:34,h:25}},{filename:"Decor5Graphics0000",frame:{x:4067,y:645,w:23,h:31},rotated:!1,trimmed:!0,spriteSourceSize:{x:0,y:-31.2,w:23,h:31},sourceSize:{w:23,h:31}},{filename:"Decor6Graphics0000",frame:{x:3646,y:1698,w:126,h:58},rotated:!1,trimmed:!0,spriteSourceSize:{x:0,y:-58.6,w:126,h:58},sourceSize:{w:126,h:58}},{filename:"Decor7Graphics0000",frame:{x:2470,y:2667,w:111,h:27},rotated:!1,trimmed:!0,spriteSourceSize:{x:-34.8,y:-27.1,w:111,h:27},sourceSize:{w:111,h:27}},{filename:"Decor8Graphics0000",frame:{x:1680,y:1284,w:25,h:21},rotated:!1,trimmed:!0,spriteSourceSize:{x:0,y:-21.4,w:25,h:21},sourceSize:{w:25,h:21}},{filename:"Decor9Graphics0000",frame:{x:400,y:1167,w:19,h:21},rotated:!1,trimmed:!0,spriteSourceSize:{x:0,y:-21.8,w:19,h:21},sourceSize:{w:19,h:21}},{filename:"DogGraphics0000",frame:{x:3583,y:1109,w:80,h:53},rotated:!1,trimmed:!0,spriteSourceSize:{x:-43,y:-51,w:92,h:73},sourceSize:{w:92,h:73}},{filename:"DogGraphics0001",frame:{x:3499,y:1214,w:80,h:53},rotated:!1,trimmed:!0,spriteSourceSize:{x:-43,y:-51,w:92,h:73},sourceSize:{w:92,h:73}},{filename:"DogGraphics0002",frame:{x:3499,y:1214,w:80,h:53},rotated:!1,trimmed:!0,spriteSourceSize:{x:-43,y:-51,w:92,h:73},sourceSize:{w:92,h:73}},{filename:"DogGraphics0003",frame:{x:169,y:2433,w:80,h:53},rotated:!1,trimmed:!0,spriteSourceSize:{x:-43,y:-51,w:92,h:73},sourceSize:{w:92,h:73}},{filename:"DogGraphics0004",frame:{x:3029,y:2438,w:80,h:53},rotated:!1,trimmed:!0,spriteSourceSize:{x:-43,y:-51,w:92,h:73},sourceSize:{w:92,h:73}},{filename:"DogGraphics0005",frame:{x:252,y:2444,w:80,h:53},rotated:!1,trimmed:!0,spriteSourceSize:{x:-43,y:-51,w:92,h:73},sourceSize:{w:92,h:73}},{filename:"DogGraphics0006",frame:{x:969,y:2445,w:80,h:53},rotated:!1,trimmed:!0,spriteSourceSize:{x:-43,y:-51,w:92,h:73},sourceSize:{w:92,h:73}},{filename:"DogGraphics0007",frame:{x:2183,y:2445,w:80,h:53},rotated:!1,trimmed:!0,spriteSourceSize:{x:-43,y:-51,w:92,h:73},sourceSize:{w:92,h:73}},{filename:"DogGraphics0008",frame:{x:2266,y:2445,w:80,h:53},rotated:!1,trimmed:!0,spriteSourceSize:{x:-43,y:-51,w:92,h:73},sourceSize:{w:92,h:73}},{filename:"DogGraphics0009",frame:{x:2349,y:2448,w:80,h:53},rotated:!1,trimmed:!0,spriteSourceSize:{x:-43,y:-51,w:92,h:73},sourceSize:{w:92,h:73}},{filename:"DogGraphics0010",frame:{x:1901,y:2454,w:80,h:53},rotated:!1,trimmed:!0,spriteSourceSize:{x:-43,y:-51,w:92,h:73},sourceSize:{w:92,h:73}},{filename:"DogGraphics0011",frame:{x:1984,y:2454,w:80,h:53},rotated:!1,trimmed:!0,spriteSourceSize:{x:-43,y:-51,w:92,h:73},sourceSize:{w:92,h:73}},{filename:"DogGraphics0012",frame:{x:497,y:2455,w:80,h:53},rotated:!1,trimmed:!0,spriteSourceSize:{x:-43,y:-51,w:92,h:73},sourceSize:{w:92,h:73}},{filename:"DogGraphics0013",frame:{x:724,y:2456,w:80,h:53},rotated:!1,trimmed:!0,spriteSourceSize:{x:-43,y:-51,w:92,h:73},sourceSize:{w:92,h:73}},{filename:"DogGraphics0014",frame:{x:807,y:2456,w:80,h:53},rotated:!1,trimmed:!0,spriteSourceSize:{x:-43,y:-51,w:92,h:73},sourceSize:{w:92,h:73}},{filename:"DogGraphics0015",frame:{x:3458,y:2466,w:80,h:53},rotated:!1,trimmed:!0,spriteSourceSize:{x:-43,y:-51,w:92,h:73},sourceSize:{w:92,h:73}},{filename:"DogGraphics0016",frame:{x:3112,y:2467,w:80,h:53},rotated:!1,trimmed:!0,spriteSourceSize:{x:-43,y:-51,w:92,h:73},sourceSize:{w:92,h:73}},{filename:"DogGraphics0017",frame:{x:3195,y:2467,w:80,h:53},rotated:!1,trimmed:!0,spriteSourceSize:{x:-43,y:-51,w:92,h:73},sourceSize:{w:92,h:73}},{filename:"DogGraphics0018",frame:{x:580,y:2469,w:80,h:53},rotated:!1,trimmed:!0,spriteSourceSize:{x:-43,y:-51,w:92,h:73},sourceSize:{w:92,h:73}},{filename:"DogGraphics0019",frame:{x:3788,y:2469,w:80,h:53},rotated:!1,trimmed:!0,spriteSourceSize:{x:-43,y:-51,w:92,h:73},sourceSize:{w:92,h:73}},{filename:"DogGraphics0020",frame:{x:3871,y:2469,w:80,h:53},rotated:!1,trimmed:!0,spriteSourceSize:{x:-43,y:-51,w:92,h:73},sourceSize:{w:92,h:73}},{filename:"DogGraphics0021",frame:{x:3954,y:2469,w:80,h:53},rotated:!1,trimmed:!0,spriteSourceSize:{x:-43,y:-51,w:92,h:73},sourceSize:{w:92,h:73}},{filename:"DogGraphics0022",frame:{x:1640,y:2471,w:80,h:53},rotated:!1,trimmed:!0,spriteSourceSize:{x:-43,y:-51,w:92,h:73},sourceSize:{w:92,h:73}},{filename:"DogGraphics0023",frame:{x:1723,y:2471,w:80,h:53},rotated:!1,trimmed:!0,spriteSourceSize:{x:-43,y:-51,w:92,h:73},sourceSize:{w:92,h:73}},{filename:"DogGraphics0024",frame:{x:1052,y:2475,w:80,h:53},rotated:!1,trimmed:!0,spriteSourceSize:{x:-43,y:-51,w:92,h:73},sourceSize:{w:92,h:73}},{filename:"DogGraphics0025",frame:{x:1135,y:2476,w:80,h:53},rotated:!1,trimmed:!0,spriteSourceSize:{x:-43,y:-51,w:92,h:73},sourceSize:{w:92,h:73}},{filename:"DogGraphics0026",frame:{x:1218,y:2476,w:80,h:53},rotated:!1,trimmed:!0,spriteSourceSize:{x:-43,y:-51,w:92,h:73},sourceSize:{w:92,h:73}},{filename:"DogGraphics0027",frame:{x:1301,y:2476,w:80,h:53},rotated:!1,trimmed:!0,spriteSourceSize:{x:-43,y:-51,w:92,h:73},sourceSize:{w:92,h:73}},{filename:"DogGraphics0028",frame:{x:3541,y:2476,w:80,h:53},rotated:!1,trimmed:!0,spriteSourceSize:{x:-43,y:-51,w:92,h:73},sourceSize:{w:92,h:73}},{filename:"DogGraphics0029",frame:{x:3624,y:2476,w:80,h:53},rotated:!1,trimmed:!0,spriteSourceSize:{x:-43,y:-51,w:92,h:73},sourceSize:{w:92,h:73}},{filename:"DogGraphics0030",frame:{x:2067,y:2478,w:80,h:53},rotated:!1,trimmed:!0,spriteSourceSize:{x:-43,y:-51,w:92,h:73},sourceSize:{w:92,h:73}},{filename:"DogGraphics0031",frame:{x:2602,y:2478,w:80,h:53},rotated:!1,trimmed:!0,spriteSourceSize:{x:-43,y:-51,w:92,h:73},sourceSize:{w:92,h:73}},{filename:"DogGraphics0032",frame:{x:1384,y:2480,w:80,h:53},rotated:!1,trimmed:!0,spriteSourceSize:{x:-43,y:-51,w:92,h:73},sourceSize:{w:92,h:73}},{filename:"DogGraphics0033",frame:{x:1467,y:2480,w:80,h:53},rotated:!1,trimmed:!0,spriteSourceSize:{x:-43,y:-51,w:92,h:73},sourceSize:{w:92,h:73}},{filename:"DogGraphics0034",frame:{x:2432,y:2481,w:80,h:53},rotated:!1,trimmed:!0,spriteSourceSize:{x:-43,y:-51,w:92,h:73},sourceSize:{w:92,h:73}},{filename:"DogGraphics0035",frame:{x:3788,y:2412,w:80,h:54},rotated:!1,trimmed:!0,spriteSourceSize:{x:-43,y:-52,w:92,h:73},sourceSize:{w:92,h:73}},{filename:"DogGraphics0036",frame:{x:3871,y:2412,w:80,h:54},rotated:!1,trimmed:!0,spriteSourceSize:{x:-43,y:-52,w:92,h:73},sourceSize:{w:92,h:73}},{filename:"DogGraphics0037",frame:{x:3954,y:2412,w:80,h:54},rotated:!1,trimmed:!0,spriteSourceSize:{x:-43,y:-52,w:92,h:73},sourceSize:{w:92,h:73}},{filename:"DogGraphics0038",frame:{x:1652,y:2414,w:80,h:54},rotated:!1,trimmed:!0,spriteSourceSize:{x:-43,y:-52,w:92,h:73},sourceSize:{w:92,h:73}},{filename:"DogGraphics0039",frame:{x:1735,y:2414,w:80,h:54},rotated:!1,trimmed:!0,spriteSourceSize:{x:-43,y:-52,w:92,h:73},sourceSize:{w:92,h:73}},{filename:"DogGraphics0040",frame:{x:1153,y:2419,w:80,h:54},rotated:!1,trimmed:!0,spriteSourceSize:{x:-43,y:-52,w:92,h:73},sourceSize:{w:92,h:73}},{filename:"DogGraphics0041",frame:{x:1236,y:2419,w:80,h:54},rotated:!1,trimmed:!0,spriteSourceSize:{x:-43,y:-52,w:92,h:73},sourceSize:{w:92,h:73}},{filename:"DogGraphics0042",frame:{x:3545,y:2419,w:80,h:54},rotated:!1,trimmed:!0,spriteSourceSize:{x:-43,y:-52,w:92,h:73},sourceSize:{w:92,h:73}},{filename:"DogGraphics0043",frame:{x:2100,y:2421,w:80,h:54},rotated:!1,trimmed:!0,spriteSourceSize:{x:-43,y:-52,w:92,h:73},sourceSize:{w:92,h:73}},{filename:"DogGraphics0044",frame:{x:1391,y:2423,w:80,h:54},rotated:!1,trimmed:!0,spriteSourceSize:{x:-43,y:-52,w:92,h:73},sourceSize:{w:92,h:73}},{filename:"DogGraphics0045",frame:{x:1474,y:2423,w:80,h:54},rotated:!1,trimmed:!0,spriteSourceSize:{x:-43,y:-52,w:92,h:73},sourceSize:{w:92,h:73}},{filename:"DogGraphics0046",frame:{x:2436,y:2424,w:80,h:54},rotated:!1,trimmed:!0,spriteSourceSize:{x:-43,y:-52,w:92,h:73},sourceSize:{w:92,h:73}},{filename:"DogGraphics0047",frame:{x:2519,y:2424,w:80,h:54},rotated:!1,trimmed:!0,spriteSourceSize:{x:-43,y:-52,w:92,h:73},sourceSize:{w:92,h:73}},{filename:"DogGraphics0048",frame:{x:3,y:2428,w:80,h:54},rotated:!1,trimmed:!0,spriteSourceSize:{x:-43,y:-52,w:92,h:73},sourceSize:{w:92,h:73}},{filename:"DogGraphics0049",frame:{x:86,y:2428,w:80,h:54},rotated:!1,trimmed:!0,spriteSourceSize:{x:-43,y:-52,w:92,h:73},sourceSize:{w:92,h:73}},{filename:"DogGraphics0050",frame:{x:414,y:2428,w:80,h:54},rotated:!1,trimmed:!0,spriteSourceSize:{x:-43,y:-52,w:92,h:73},sourceSize:{w:92,h:73}},{filename:"DogGraphics0051",frame:{x:1818,y:2428,w:80,h:54},rotated:!1,trimmed:!0,spriteSourceSize:{x:-43,y:-52,w:92,h:73},sourceSize:{w:92,h:73}},{filename:"DogGraphics0052",frame:{x:1557,y:2430,w:80,h:54},rotated:!1,trimmed:!0,spriteSourceSize:{x:-43,y:-52,w:92,h:73},sourceSize:{w:92,h:73}},{filename:"DogGraphics0053",frame:{x:2760,y:2430,w:80,h:54},rotated:!1,trimmed:!0,spriteSourceSize:{x:-43,y:-52,w:92,h:73},sourceSize:{w:92,h:73}},{filename:"DogGraphics0054",frame:{x:1842,y:1831,w:88,h:69},rotated:!1,trimmed:!0,spriteSourceSize:{x:-47,y:-67,w:92,h:73},sourceSize:{w:92,h:73}},{filename:"DogGraphics0055",frame:{x:2124,y:1842,w:88,h:69},rotated:!1,trimmed:!0,spriteSourceSize:{x:-47,y:-67,w:92,h:73},sourceSize:{w:92,h:73}},{filename:"DogGraphics0056",frame:{x:894,y:1843,w:88,h:69},rotated:!1,trimmed:!0,spriteSourceSize:{x:-47,y:-67,w:92,h:73},sourceSize:{w:92,h:73}},{filename:"DogGraphics0057",frame:{x:3521,y:1847,w:88,h:69},rotated:!1,trimmed:!0,spriteSourceSize:{x:-47,y:-67,w:92,h:73},sourceSize:{w:92,h:73}},{filename:"DogGraphics0058",frame:{x:3612,y:1847,w:88,h:69},rotated:!1,trimmed:!0,spriteSourceSize:{x:-47,y:-67,w:92,h:73},sourceSize:{w:92,h:73}},{filename:"DogGraphics0059",frame:{x:2301,y:1849,w:88,h:69},rotated:!1,trimmed:!0,spriteSourceSize:{x:-47,y:-67,w:92,h:73},sourceSize:{w:92,h:73}},{filename:"DogGraphics0060",frame:{x:589,y:1850,w:88,h:69},rotated:!1,trimmed:!0,spriteSourceSize:{x:-47,y:-67,w:92,h:73},sourceSize:{w:92,h:73}},{filename:"DogGraphics0061",frame:{x:3398,y:1851,w:88,h:69},rotated:!1,trimmed:!0,spriteSourceSize:{x:-47,y:-67,w:92,h:73},sourceSize:{w:92,h:73}},{filename:"DogGraphics0062",frame:{x:2601,y:1858,w:88,h:69},rotated:!1,trimmed:!0,spriteSourceSize:{x:-47,y:-67,w:92,h:73},sourceSize:{w:92,h:73}},{filename:"DogGraphics0063",frame:{x:1744,y:1861,w:88,h:69},rotated:!1,trimmed:!0,spriteSourceSize:{x:-47,y:-67,w:92,h:73},sourceSize:{w:92,h:73}},{filename:"DogGraphics0064",frame:{x:3823,y:1868,w:88,h:69},rotated:!1,trimmed:!0,spriteSourceSize:{x:-47,y:-67,w:92,h:73},sourceSize:{w:92,h:73}},{filename:"DogGraphics0065",frame:{x:1264,y:1872,w:88,h:69},rotated:!1,trimmed:!0,spriteSourceSize:{x:-47,y:-67,w:92,h:73},sourceSize:{w:92,h:73}},{filename:"DogGraphics0066",frame:{x:1933,y:1872,w:88,h:69},rotated:!1,trimmed:!0,spriteSourceSize:{x:-47,y:-67,w:92,h:73},sourceSize:{w:92,h:73}},{filename:"DogGraphics0067",frame:{x:3038,y:1872,w:88,h:69},rotated:!1,trimmed:!0,spriteSourceSize:{x:-47,y:-67,w:92,h:73},sourceSize:{w:92,h:73}},{filename:"DogGraphics0068",frame:{x:1152,y:1875,w:88,h:69},rotated:!1,trimmed:!0,spriteSourceSize:{x:-47,y:-67,w:92,h:73},sourceSize:{w:92,h:73}},{filename:"DogGraphics0069",frame:{x:985,y:1877,w:88,h:69},rotated:!1,trimmed:!0,spriteSourceSize:{x:-47,y:-67,w:92,h:73},sourceSize:{w:92,h:73}},{filename:"DogGraphics0070",frame:{x:1638,y:1877,w:88,h:69},rotated:!1,trimmed:!0,spriteSourceSize:{x:-47,y:-67,w:92,h:73},sourceSize:{w:92,h:73}},{filename:"DogGraphics0071",frame:{x:3914,y:1877,w:88,h:69},rotated:!1,trimmed:!0,spriteSourceSize:{x:-47,y:-67,w:92,h:73},sourceSize:{w:92,h:73}},{filename:"DogGraphics0072",frame:{x:4005,y:1877,w:88,h:69},rotated:!1,trimmed:!0,spriteSourceSize:{x:-47,y:-67,w:92,h:73},sourceSize:{w:92,h:73}},{filename:"DogGraphics0073",frame:{x:1457,y:1879,w:88,h:69},rotated:!1,trimmed:!0,spriteSourceSize:{x:-47,y:-67,w:92,h:73},sourceSize:{w:92,h:73}},{filename:"DogGraphics0074",frame:{x:3703,y:1879,w:88,h:69},rotated:!1,trimmed:!0,spriteSourceSize:{x:-47,y:-67,w:92,h:73},sourceSize:{w:92,h:73}},{filename:"DogGraphics0075",frame:{x:163,y:1880,w:88,h:69},rotated:!1,trimmed:!0,spriteSourceSize:{x:-47,y:-67,w:92,h:73},sourceSize:{w:92,h:73}},{filename:"DogGraphics0076",frame:{x:2392,y:1881,w:88,h:69},rotated:!1,trimmed:!0,spriteSourceSize:{x:-47,y:-67,w:92,h:73},sourceSize:{w:92,h:73}},{filename:"DogGraphics0077",frame:{x:413,y:1882,w:88,h:69},rotated:!1,trimmed:!0,spriteSourceSize:{x:-47,y:-67,w:92,h:73},sourceSize:{w:92,h:73}},{filename:"DogGraphics0078",frame:{x:2821,y:1884,w:88,h:69},rotated:!1,trimmed:!0,spriteSourceSize:{x:-47,y:-67,w:92,h:73},sourceSize:{w:92,h:73}},{filename:"DogGraphics0079",frame:{x:1355,y:1886,w:88,h:69},rotated:!1,trimmed:!0,spriteSourceSize:{x:-47,y:-67,w:92,h:73},sourceSize:{w:92,h:73}},{filename:"DogGraphics0080",frame:{x:680,y:1888,w:88,h:69},rotated:!1,trimmed:!0,spriteSourceSize:{x:-47,y:-67,w:92,h:73},sourceSize:{w:92,h:73}},{filename:"DogGraphics0081",frame:{x:771,y:1888,w:88,h:69},rotated:!1,trimmed:!0,spriteSourceSize:{x:-47,y:-67,w:92,h:73},sourceSize:{w:92,h:73}},{filename:"DogGraphics0082",frame:{x:1842,y:1831,w:88,h:69},rotated:!1,trimmed:!0,spriteSourceSize:{x:-47,y:-67,w:92,h:73},sourceSize:{w:92,h:73}},{filename:"DogGraphics0083",frame:{x:177,y:2166,w:71,h:47},rotated:!1,trimmed:!0,spriteSourceSize:{x:-30,y:-45,w:92,h:73},sourceSize:{w:92,h:73}},{filename:"DogGraphics0084",frame:{x:3653,y:2605,w:71,h:47},rotated:!1,trimmed:!0,spriteSourceSize:{x:-30,y:-45,w:92,h:73},sourceSize:{w:92,h:73}},{filename:"DogGraphics0085",frame:{x:2881,y:2607,w:71,h:47},rotated:!1,trimmed:!0,spriteSourceSize:{x:-30,y:-45,w:92,h:73},sourceSize:{w:92,h:73}},{filename:"DogGraphics0086",frame:{x:3331,y:2607,w:71,h:47},rotated:!1,trimmed:!0,spriteSourceSize:{x:-30,y:-45,w:92,h:73},sourceSize:{w:92,h:73}},{filename:"DogGraphics0087",frame:{x:344,y:2610,w:71,h:47},rotated:!1,trimmed:!0,spriteSourceSize:{x:-30,y:-45,w:92,h:73},sourceSize:{w:92,h:73}},{filename:"DogGraphics0088",frame:{x:1759,y:2610,w:71,h:47},rotated:!1,trimmed:!0,spriteSourceSize:{x:-30,y:-45,w:92,h:73},sourceSize:{w:92,h:73}},{filename:"DogGraphics0089",frame:{x:1495,y:2612,w:71,h:47},rotated:!1,trimmed:!0,spriteSourceSize:{x:-30,y:-45,w:92,h:73},sourceSize:{w:92,h:73}},{filename:"DogGraphics0090",frame:{x:2624,y:2612,w:71,h:47},rotated:!1,trimmed:!0,spriteSourceSize:{x:-30,y:-45,w:92,h:73},sourceSize:{w:92,h:73}},{filename:"DogGraphics0091",frame:{x:2698,y:2612,w:71,h:47},rotated:!1,trimmed:!0,spriteSourceSize:{x:-30,y:-45,w:92,h:73},sourceSize:{w:92,h:73}},{filename:"DogGraphics0092",frame:{x:2772,y:2614,w:71,h:47},rotated:!1,trimmed:!0,spriteSourceSize:{x:-30,y:-45,w:92,h:73},sourceSize:{w:92,h:73}},{filename:"DogGraphics0093",frame:{x:2955,y:2614,w:71,h:47},rotated:!1,trimmed:!0,spriteSourceSize:{x:-30,y:-45,w:92,h:73},sourceSize:{w:92,h:73}},{filename:"DogGraphics0094",frame:{x:121,y:2615,w:71,h:47},rotated:!1,trimmed:!0,spriteSourceSize:{x:-30,y:-45,w:92,h:73},sourceSize:{w:92,h:73}},{filename:"DogGraphics0095",frame:{x:195,y:2622,w:71,h:47},rotated:!1,trimmed:!0,spriteSourceSize:{x:-30,y:-45,w:92,h:73},sourceSize:{w:92,h:73}},{filename:"DogGraphics0096",frame:{x:942,y:2623,w:71,h:47},rotated:!1,trimmed:!0,spriteSourceSize:{x:-30,y:-45,w:92,h:73},sourceSize:{w:92,h:73}},{filename:"DogGraphics0097",frame:{x:2081,y:2623,w:71,h:47},rotated:!1,trimmed:!0,spriteSourceSize:{x:-30,y:-45,w:92,h:73},sourceSize:{w:92,h:73}},{filename:"DogGraphics0098",frame:{x:2155,y:2623,w:71,h:47},rotated:!1,trimmed:!0,spriteSourceSize:{x:-30,y:-45,w:92,h:73},sourceSize:{w:92,h:73}},{filename:"DogGraphics0099",frame:{x:2229,y:2626,w:71,h:47},rotated:!1,trimmed:!0,spriteSourceSize:{x:-30,y:-45,w:92,h:73},sourceSize:{w:92,h:73}},{filename:"DogGraphics0100",frame:{x:1833,y:2632,w:71,h:47},rotated:!1,trimmed:!0,spriteSourceSize:{x:-30,y:-45,w:92,h:73},sourceSize:{w:92,h:73}},{filename:"DogGraphics0101",frame:{x:1907,y:2632,w:71,h:47},rotated:!1,trimmed:!0,spriteSourceSize:{x:-30,y:-45,w:92,h:73},sourceSize:{w:92,h:73}},{filename:"DogGraphics0102",frame:{x:418,y:2633,w:71,h:47},rotated:!1,trimmed:!0,spriteSourceSize:{x:-30,y:-45,w:92,h:73},sourceSize:{w:92,h:73}},{filename:"DogGraphics0103",frame:{x:3,y:2634,w:71,h:47},rotated:!1,trimmed:!0,spriteSourceSize:{x:-30,y:-45,w:92,h:73},sourceSize:{w:92,h:73}},{filename:"DogGraphics0104",frame:{x:610,y:2634,w:71,h:47},rotated:!1,trimmed:!0,spriteSourceSize:{x:-30,y:-45,w:92,h:73},sourceSize:{w:92,h:73}},{filename:"DogGraphics0105",frame:{x:684,y:2634,w:71,h:47},rotated:!1,trimmed:!0,spriteSourceSize:{x:-30,y:-45,w:92,h:73},sourceSize:{w:92,h:73}},{filename:"DogGraphics0106",frame:{x:269,y:2639,w:71,h:47},rotated:!1,trimmed:!0,spriteSourceSize:{x:-30,y:-45,w:92,h:73},sourceSize:{w:92,h:73}},{filename:"DogGraphics0107",frame:{x:2396,y:2640,w:71,h:47},rotated:!1,trimmed:!0,spriteSourceSize:{x:-30,y:-45,w:92,h:73},sourceSize:{w:92,h:73}},{filename:"DogGraphics0108",frame:{x:3222,y:2642,w:71,h:47},rotated:!1,trimmed:!0,spriteSourceSize:{x:-30,y:-45,w:92,h:73},sourceSize:{w:92,h:73}},{filename:"DogGraphics0109",frame:{x:3029,y:2645,w:71,h:47},rotated:!1,trimmed:!0,spriteSourceSize:{x:-30,y:-45,w:92,h:73},sourceSize:{w:92,h:73}},{filename:"DogGraphics0110",frame:{x:3103,y:2645,w:71,h:47},rotated:!1,trimmed:!0,spriteSourceSize:{x:-30,y:-45,w:92,h:73},sourceSize:{w:92,h:73}},{filename:"DogGraphics0111",frame:{x:758,y:2646,w:71,h:47},rotated:!1,trimmed:!0,spriteSourceSize:{x:-30,y:-45,w:92,h:73},sourceSize:{w:92,h:73}},{filename:"DogGraphics0112",frame:{x:492,y:2647,w:71,h:47},rotated:!1,trimmed:!0,spriteSourceSize:{x:-30,y:-45,w:92,h:73},sourceSize:{w:92,h:73}},{filename:"DogGraphics0113",frame:{x:3727,y:2647,w:71,h:47},rotated:!1,trimmed:!0,spriteSourceSize:{x:-30,y:-45,w:92,h:73},sourceSize:{w:92,h:73}},{filename:"DogGraphics0114",frame:{x:3801,y:2647,w:71,h:47},rotated:!1,trimmed:!0,spriteSourceSize:{x:-30,y:-45,w:92,h:73},sourceSize:{w:92,h:73}},{filename:"DogGraphics0115",frame:{x:3875,y:2647,w:71,h:47},rotated:!1,trimmed:!0,spriteSourceSize:{x:-30,y:-45,w:92,h:73},sourceSize:{w:92,h:73}},{filename:"DogGraphics0116",frame:{x:1569,y:2649,w:71,h:47},rotated:!1,trimmed:!0,spriteSourceSize:{x:-30,y:-45,w:92,h:73},sourceSize:{w:92,h:73}},{filename:"DogGraphics0117",frame:{x:1643,y:2649,w:71,h:47},rotated:!1,trimmed:!0,spriteSourceSize:{x:-30,y:-45,w:92,h:73},sourceSize:{w:92,h:73}},{filename:"DogGraphics0118",frame:{x:3949,y:2653,w:71,h:47},rotated:!1,trimmed:!0,spriteSourceSize:{x:-30,y:-45,w:92,h:73},sourceSize:{w:92,h:73}},{filename:"DogGraphics0119",frame:{x:2881,y:2607,w:71,h:47},rotated:!1,trimmed:!0,spriteSourceSize:{x:-30,y:-45,w:92,h:73},sourceSize:{w:92,h:73}},{filename:"DogGraphics0120",frame:{x:1016,y:2654,w:71,h:47},rotated:!1,trimmed:!0,spriteSourceSize:{x:-30,y:-45,w:92,h:73},sourceSize:{w:92,h:73}},{filename:"DogGraphics0121",frame:{x:1090,y:2654,w:71,h:47},rotated:!1,trimmed:!0,spriteSourceSize:{x:-30,y:-45,w:92,h:73},sourceSize:{w:92,h:73}},{filename:"DogGraphics0122",frame:{x:1446,y:1951,w:75,h:70},rotated:!1,trimmed:!0,spriteSourceSize:{x:-34,y:-68,w:92,h:73},sourceSize:{w:92,h:73}},{filename:"DogGraphics0123",frame:{x:3663,y:1951,w:75,h:70},rotated:!1,trimmed:!0,spriteSourceSize:{x:-34,y:-68,w:92,h:73},sourceSize:{w:92,h:73}},{filename:"DogGraphics0124",frame:{x:91,y:1952,w:75,h:70},rotated:!1,trimmed:!0,spriteSourceSize:{x:-34,y:-68,w:92,h:73},sourceSize:{w:92,h:73}},{filename:"DogGraphics0125",frame:{x:169,y:1952,w:75,h:70},rotated:!1,trimmed:!0,spriteSourceSize:{x:-34,y:-68,w:92,h:73},sourceSize:{w:92,h:73}},{filename:"DogGraphics0126",frame:{x:2380,y:1953,w:75,h:70},rotated:!1,trimmed:!0,spriteSourceSize:{x:-34,y:-68,w:92,h:73},sourceSize:{w:92,h:73}},{filename:"DogGraphics0127",frame:{x:342,y:1954,w:75,h:70},rotated:!1,trimmed:!0,spriteSourceSize:{x:-34,y:-68,w:92,h:73},sourceSize:{w:92,h:73}},{filename:"DogGraphics0128",frame:{x:420,y:1954,w:75,h:70},rotated:!1,trimmed:!0,spriteSourceSize:{x:-34,y:-68,w:92,h:73},sourceSize:{w:92,h:73}},{filename:"DogGraphics0129",frame:{x:2780,y:1956,w:75,h:70},rotated:!1,trimmed:!0,spriteSourceSize:{x:-34,y:-68,w:92,h:73},sourceSize:{w:92,h:73}},{filename:"DogGraphics0130",frame:{x:1322,y:1958,w:75,h:70},rotated:!1,trimmed:!0,spriteSourceSize:{x:-34,y:-68,w:92,h:73},sourceSize:{w:92,h:73}},{filename:"DogGraphics0131",frame:{x:665,y:1960,w:75,h:70},rotated:!1,trimmed:!0,spriteSourceSize:{x:-34,y:-68,w:92,h:73},sourceSize:{w:92,h:73}},{filename:"DogGraphics0132",frame:{x:743,y:1960,w:75,h:70},rotated:!1,trimmed:!0,spriteSourceSize:{x:-34,y:-68,w:92,h:73},sourceSize:{w:92,h:73}},{filename:"DogGraphics0133",frame:{x:3086,y:1962,w:75,h:70},rotated:!1,trimmed:!0,spriteSourceSize:{x:-34,y:-68,w:92,h:73},sourceSize:{w:92,h:73}},{filename:"DogGraphics0134",frame:{x:2458,y:1963,w:75,h:70},rotated:!1,trimmed:!0,spriteSourceSize:{x:-34,y:-68,w:92,h:73},sourceSize:{w:92,h:73}},{filename:"DogGraphics0135",frame:{x:498,y:1965,w:75,h:70},rotated:!1,trimmed:!0,spriteSourceSize:{x:-34,y:-68,w:92,h:73},sourceSize:{w:92,h:73}},{filename:"DogGraphics0136",frame:{x:2858,y:1965,w:75,h:70},rotated:!1,trimmed:!0,spriteSourceSize:{x:-34,y:-68,w:92,h:73},sourceSize:{w:92,h:73}},{filename:"DogGraphics0137",frame:{x:2659,y:1969,w:75,h:70},rotated:!1,trimmed:!0,spriteSourceSize:{x:-34,y:-68,w:92,h:73},sourceSize:{w:92,h:73}},{filename:"DogGraphics0138",frame:{x:3,y:1971,w:75,h:70},rotated:!1,trimmed:!0,spriteSourceSize:{x:-34,y:-68,w:92,h:73},sourceSize:{w:92,h:73}},{filename:"DogGraphics0139",frame:{x:247,y:1971,w:75,h:70},rotated:!1,trimmed:!0,spriteSourceSize:{x:-34,y:-68,w:92,h:73},sourceSize:{w:92,h:73}},{filename:"DogGraphics0140",frame:{x:1524,y:1971,w:75,h:70},rotated:!1,trimmed:!0,spriteSourceSize:{x:-34,y:-68,w:92,h:73},sourceSize:{w:92,h:73}},{filename:"DogGraphics0141",frame:{x:2002,y:1971,w:75,h:70},rotated:!1,trimmed:!0,spriteSourceSize:{x:-34,y:-68,w:92,h:73},sourceSize:{w:92,h:73}},{filename:"DogGraphics0142",frame:{x:1781,y:1977,w:75,h:70},rotated:!1,trimmed:!0,spriteSourceSize:{x:-34,y:-68,w:92,h:73},sourceSize:{w:92,h:73}},{filename:"DogGraphics0143",frame:{x:3164,y:1983,w:75,h:70},rotated:!1,trimmed:!0,spriteSourceSize:{x:-34,y:-68,w:92,h:73},sourceSize:{w:92,h:73}},{filename:"DogGraphics0144",frame:{x:3242,y:1983,w:75,h:70},rotated:!1,trimmed:!0,spriteSourceSize:{x:-34,y:-68,w:92,h:73},sourceSize:{w:92,h:73}},{filename:"DogGraphics0145",frame:{x:2080,y:1988,w:75,h:70},rotated:!1,trimmed:!0,spriteSourceSize:{x:-34,y:-68,w:92,h:73},sourceSize:{w:92,h:73}},{filename:"DogGraphics0146",frame:{x:2158,y:1988,w:75,h:70},rotated:!1,trimmed:!0,spriteSourceSize:{x:-34,y:-68,w:92,h:73},sourceSize:{w:92,h:73}},{filename:"DogGraphics0147",frame:{x:821,y:1989,w:75,h:70},rotated:!1,trimmed:!0,spriteSourceSize:{x:-34,y:-68,w:92,h:73},sourceSize:{w:92,h:73}},{filename:"DogGraphics0148",frame:{x:1058,y:1990,w:75,h:70},rotated:!1,trimmed:!0,spriteSourceSize:{x:-34,y:-68,w:92,h:73},sourceSize:{w:92,h:73}},{filename:"DogGraphics0149",frame:{x:895,y:2136,w:75,h:44},rotated:!1,trimmed:!0,spriteSourceSize:{x:-34,y:-42,w:92,h:73},sourceSize:{w:92,h:73}},{filename:"DogGraphics0150",frame:{x:335,y:2460,w:75,h:54},rotated:!1,trimmed:!0,spriteSourceSize:{x:-39,y:-52,w:92,h:73},sourceSize:{w:92,h:73}},{filename:"DogGraphics0151",frame:{x:890,y:2467,w:75,h:54},rotated:!1,trimmed:!0,spriteSourceSize:{x:-39,y:-52,w:92,h:73},sourceSize:{w:92,h:73}},{filename:"DogGraphics0152",frame:{x:3707,y:2480,w:75,h:54},rotated:!1,trimmed:!0,spriteSourceSize:{x:-39,y:-52,w:92,h:73},sourceSize:{w:92,h:73}},{filename:"DogGraphics0153",frame:{x:2922,y:2482,w:75,h:54},rotated:!1,trimmed:!0,spriteSourceSize:{x:-39,y:-52,w:92,h:73},sourceSize:{w:92,h:73}},{filename:"DogGraphics0154",frame:{x:3278,y:2482,w:75,h:54},rotated:!1,trimmed:!0,spriteSourceSize:{x:-39,y:-52,w:92,h:73},sourceSize:{w:92,h:73}},{filename:"DogGraphics0155",frame:{x:3356,y:2482,w:75,h:54},rotated:!1,trimmed:!0,spriteSourceSize:{x:-39,y:-52,w:92,h:73},sourceSize:{w:92,h:73}},{filename:"DogGraphics0156",frame:{x:413,y:2485,w:75,h:54},rotated:!1,trimmed:!0,spriteSourceSize:{x:-39,y:-52,w:92,h:73},sourceSize:{w:92,h:73}},{filename:"DogGraphics0157",frame:{x:1806,y:2485,w:75,h:54},rotated:!1,trimmed:!0,spriteSourceSize:{x:-39,y:-52,w:92,h:73},sourceSize:{w:92,h:73}},{filename:"DogGraphics0158",frame:{x:1550,y:2487,w:75,h:54},rotated:!1,trimmed:!0,spriteSourceSize:{x:-39,y:-52,w:92,h:73},sourceSize:{w:92,h:73}},{filename:"DogGraphics0159",frame:{x:2685,y:2487,w:75,h:54},rotated:!1,trimmed:!0,spriteSourceSize:{x:-39,y:-52,w:92,h:73},sourceSize:{w:92,h:73}},{filename:"DogGraphics0160",frame:{x:2763,y:2487,w:75,h:54},rotated:!1,trimmed:!0,spriteSourceSize:{x:-39,y:-52,w:92,h:73},sourceSize:{w:92,h:73}},{filename:"DogGraphics0161",frame:{x:2841,y:2489,w:75,h:54},rotated:!1,trimmed:!0,spriteSourceSize:{x:-39,y:-52,w:92,h:73},sourceSize:{w:92,h:73}},{filename:"DogGraphics0162",frame:{x:3e3,y:2494,w:75,h:54},rotated:!1,trimmed:!0,spriteSourceSize:{x:-39,y:-52,w:92,h:73},sourceSize:{w:92,h:73}},{filename:"DogGraphics0163",frame:{x:216,y:2500,w:75,h:54},rotated:!1,trimmed:!0,spriteSourceSize:{x:-39,y:-52,w:92,h:73},sourceSize:{w:92,h:73}},{filename:"DogGraphics0164",frame:{x:968,y:2501,w:75,h:54},rotated:!1,trimmed:!0,spriteSourceSize:{x:-39,y:-52,w:92,h:73},sourceSize:{w:92,h:73}},{filename:"DogGraphics0165",frame:{x:2150,y:2501,w:75,h:54},rotated:!1,trimmed:!0,spriteSourceSize:{x:-39,y:-52,w:92,h:73},sourceSize:{w:92,h:73}},{filename:"DogGraphics0166",frame:{x:2228,y:2501,w:75,h:54},rotated:!1,trimmed:!0,spriteSourceSize:{x:-39,y:-52,w:92,h:73},sourceSize:{w:92,h:73}},{filename:"DogGraphics0167",frame:{x:2306,y:2504,w:75,h:54},rotated:!1,trimmed:!0,spriteSourceSize:{x:-39,y:-52,w:92,h:73},sourceSize:{w:92,h:73}},{filename:"DogGraphics0168",frame:{x:1884,y:2510,w:75,h:54},rotated:!1,trimmed:!0,spriteSourceSize:{x:-39,y:-52,w:92,h:73},sourceSize:{w:92,h:73}},{filename:"DogGraphics0169",frame:{x:1962,y:2510,w:75,h:54},rotated:!1,trimmed:!0,spriteSourceSize:{x:-39,y:-52,w:92,h:73},sourceSize:{w:92,h:73}},{filename:"DogGraphics0170",frame:{x:491,y:2511,w:75,h:54},rotated:!1,trimmed:!0,spriteSourceSize:{x:-39,y:-52,w:92,h:73},sourceSize:{w:92,h:73}},{filename:"DogGraphics0171",frame:{x:3,y:2512,w:75,h:54},rotated:!1,trimmed:!0,spriteSourceSize:{x:-39,y:-52,w:92,h:73},sourceSize:{w:92,h:73}},{filename:"DogGraphics0172",frame:{x:81,y:2512,w:75,h:54},rotated:!1,trimmed:!0,spriteSourceSize:{x:-39,y:-52,w:92,h:73},sourceSize:{w:92,h:73}},{filename:"DogGraphics0173",frame:{x:663,y:2512,w:75,h:54},rotated:!1,trimmed:!0,spriteSourceSize:{x:-39,y:-52,w:92,h:73},sourceSize:{w:92,h:73}},{filename:"DogGraphics0174",frame:{x:741,y:2512,w:75,h:54},rotated:!1,trimmed:!0,spriteSourceSize:{x:-39,y:-52,w:92,h:73},sourceSize:{w:92,h:73}},{filename:"DogGraphics0175",frame:{x:294,y:2517,w:75,h:54},rotated:!1,trimmed:!0,spriteSourceSize:{x:-39,y:-52,w:92,h:73},sourceSize:{w:92,h:73}},{filename:"DogGraphics0176",frame:{x:968,y:2501,w:75,h:54},rotated:!1,trimmed:!0,spriteSourceSize:{x:-39,y:-52,w:92,h:73},sourceSize:{w:92,h:73}},{filename:"DogGraphics0177",frame:{x:2150,y:2501,w:75,h:54},rotated:!1,trimmed:!0,spriteSourceSize:{x:-39,y:-52,w:92,h:73},sourceSize:{w:92,h:73}},{filename:"DogGraphics0178",frame:{x:2228,y:2501,w:75,h:54},rotated:!1,trimmed:!0,spriteSourceSize:{x:-39,y:-52,w:92,h:73},sourceSize:{w:92,h:73}},{filename:"DogGraphics0179",frame:{x:2306,y:2504,w:75,h:54},rotated:!1,trimmed:!0,spriteSourceSize:{x:-39,y:-52,w:92,h:73},sourceSize:{w:92,h:73}},{filename:"DogGraphics0180",frame:{x:1884,y:2510,w:75,h:54},rotated:!1,trimmed:!0,spriteSourceSize:{x:-39,y:-52,w:92,h:73},sourceSize:{w:92,h:73}},{filename:"DogGraphics0181",frame:{x:1962,y:2510,w:75,h:54},rotated:!1,trimmed:!0,spriteSourceSize:{x:-39,y:-52,w:92,h:73},sourceSize:{w:92,h:73}},{filename:"DogGraphics0182",frame:{x:491,y:2511,w:75,h:54},rotated:!1,trimmed:!0,spriteSourceSize:{x:-39,y:-52,w:92,h:73},sourceSize:{w:92,h:73}},{filename:"DogGraphics0183",frame:{x:3,y:2512,w:75,h:54},rotated:!1,trimmed:!0,spriteSourceSize:{x:-39,y:-52,w:92,h:73},sourceSize:{w:92,h:73}},{filename:"DogGraphics0184",frame:{x:81,y:2512,w:75,h:54},rotated:!1,trimmed:!0,spriteSourceSize:{x:-39,y:-52,w:92,h:73},sourceSize:{w:92,h:73}},{filename:"DogGraphics0185",frame:{x:3434,y:2522,w:75,h:54},rotated:!1,trimmed:!0,spriteSourceSize:{x:-39,y:-52,w:92,h:73},sourceSize:{w:92,h:73}},{filename:"DogGraphics0186",frame:{x:3078,y:2523,w:75,h:54},rotated:!1,trimmed:!0,spriteSourceSize:{x:-39,y:-52,w:92,h:73},sourceSize:{w:92,h:73}},{filename:"DogGraphics0187",frame:{x:3156,y:2523,w:75,h:54},rotated:!1,trimmed:!0,spriteSourceSize:{x:-39,y:-52,w:92,h:73},sourceSize:{w:92,h:73}},{filename:"DogGraphics0188",frame:{x:819,y:2524,w:75,h:54},rotated:!1,trimmed:!0,spriteSourceSize:{x:-39,y:-52,w:92,h:73},sourceSize:{w:92,h:73}},{filename:"DogGraphics0189",frame:{x:569,y:2525,w:75,h:54},rotated:!1,trimmed:!0,spriteSourceSize:{x:-39,y:-52,w:92,h:73},sourceSize:{w:92,h:73}},{filename:"DogGraphics0190",frame:{x:3356,y:2482,w:75,h:54},rotated:!1,trimmed:!0,spriteSourceSize:{x:-39,y:-52,w:92,h:73},sourceSize:{w:92,h:73}},{filename:"DogGraphics0191",frame:{x:3278,y:2482,w:75,h:54},rotated:!1,trimmed:!0,spriteSourceSize:{x:-39,y:-52,w:92,h:73},sourceSize:{w:92,h:73}},{filename:"DogGraphics0192",frame:{x:3785,y:2525,w:75,h:54},rotated:!1,trimmed:!0,spriteSourceSize:{x:-39,y:-52,w:92,h:73},sourceSize:{w:92,h:73}},{filename:"DogGraphics0193",frame:{x:3863,y:2525,w:75,h:54},rotated:!1,trimmed:!0,spriteSourceSize:{x:-39,y:-52,w:92,h:73},sourceSize:{w:92,h:73}},{filename:"DogGraphics0194",frame:{x:3941,y:2525,w:75,h:54},rotated:!1,trimmed:!0,spriteSourceSize:{x:-39,y:-52,w:92,h:73},sourceSize:{w:92,h:73}},{filename:"DogGraphics0195",frame:{x:1628,y:2527,w:75,h:54},rotated:!1,trimmed:!0,spriteSourceSize:{x:-39,y:-52,w:92,h:73},sourceSize:{w:92,h:73}},{filename:"DogGraphics0196",frame:{x:1706,y:2527,w:75,h:54},rotated:!1,trimmed:!0,spriteSourceSize:{x:-39,y:-52,w:92,h:73},sourceSize:{w:92,h:73}},{filename:"DogGraphics0197",frame:{x:1046,y:2531,w:75,h:54},rotated:!1,trimmed:!0,spriteSourceSize:{x:-39,y:-52,w:92,h:73},sourceSize:{w:92,h:73}},{filename:"DogGraphics0198",frame:{x:1124,y:2532,w:75,h:54},rotated:!1,trimmed:!0,spriteSourceSize:{x:-39,y:-52,w:92,h:73},sourceSize:{w:92,h:73}},{filename:"DogGraphics0199",frame:{x:1136,y:2052,w:84,h:57},rotated:!1,trimmed:!0,spriteSourceSize:{x:-39,y:-52,w:92,h:73},sourceSize:{w:92,h:73}},{filename:"DogGraphics0200",frame:{x:2125,y:2061,w:84,h:57},rotated:!1,trimmed:!0,spriteSourceSize:{x:-39,y:-52,w:92,h:73},sourceSize:{w:92,h:73}},{filename:"DogGraphics0201",frame:{x:2212,y:2061,w:84,h:57},rotated:!1,trimmed:!0,spriteSourceSize:{x:-39,y:-52,w:92,h:73},sourceSize:{w:92,h:73}},{filename:"DogGraphics0202",frame:{x:803,y:2062,w:84,h:57},rotated:!1,trimmed:!0,spriteSourceSize:{x:-39,y:-52,w:92,h:73},sourceSize:{w:92,h:73}},{filename:"DogGraphics0203",frame:{x:1047,y:2063,w:84,h:57},rotated:!1,trimmed:!0,spriteSourceSize:{x:-39,y:-52,w:92,h:73},sourceSize:{w:92,h:73}},{filename:"DogGraphics0204",frame:{x:547,y:2067,w:84,h:57},rotated:!1,trimmed:!0,spriteSourceSize:{x:-39,y:-52,w:92,h:73},sourceSize:{w:92,h:73}},{filename:"DogGraphics0205",frame:{x:3266,y:2074,w:84,h:57},rotated:!1,trimmed:!0,spriteSourceSize:{x:-39,y:-52,w:92,h:73},sourceSize:{w:92,h:73}},{filename:"DogGraphics0206",frame:{x:3353,y:2074,w:84,h:57},rotated:!1,trimmed:!0,spriteSourceSize:{x:-39,y:-52,w:92,h:73},sourceSize:{w:92,h:73}},{filename:"DogGraphics0207",frame:{x:890,y:2076,w:84,h:57},rotated:!1,trimmed:!0,spriteSourceSize:{x:-39,y:-52,w:92,h:73},sourceSize:{w:92,h:73}},{filename:"DogGraphics0208",frame:{x:2885,y:2085,w:84,h:57},rotated:!1,trimmed:!0,spriteSourceSize:{x:-39,y:-52,w:92,h:73},sourceSize:{w:92,h:73}},{filename:"DogGraphics0209",frame:{x:2972,y:2085,w:84,h:57},rotated:!1,trimmed:!0,spriteSourceSize:{x:-39,y:-52,w:92,h:73},sourceSize:{w:92,h:73}},{filename:"DogGraphics0210",frame:{x:3815,y:2087,w:84,h:57},rotated:!1,trimmed:!0,spriteSourceSize:{x:-39,y:-52,w:92,h:73},sourceSize:{w:92,h:73}},{filename:"DogGraphics0211",frame:{x:3703,y:2089,w:84,h:57},rotated:!1,trimmed:!0,spriteSourceSize:{x:-39,y:-52,w:92,h:73},sourceSize:{w:92,h:73}},{filename:"DogGraphics0212",frame:{x:3902,y:2090,w:84,h:57},rotated:!1,trimmed:!0,spriteSourceSize:{x:-39,y:-52,w:92,h:73},sourceSize:{w:92,h:73}},{filename:"DogGraphics0213",frame:{x:3989,y:2090,w:84,h:57},rotated:!1,trimmed:!0,spriteSourceSize:{x:-39,y:-52,w:92,h:73},sourceSize:{w:92,h:73}},{filename:"DogGraphics0214",frame:{x:1837,y:2092,w:84,h:57},rotated:!1,trimmed:!0,spriteSourceSize:{x:-39,y:-52,w:92,h:73},sourceSize:{w:92,h:73}},{filename:"DogGraphics0215",frame:{x:1375,y:2097,w:84,h:57},rotated:!1,trimmed:!0,spriteSourceSize:{x:-39,y:-52,w:92,h:73},sourceSize:{w:92,h:73}},{filename:"DogGraphics0216",frame:{x:3616,y:2097,w:84,h:57},rotated:!1,trimmed:!0,spriteSourceSize:{x:-39,y:-52,w:92,h:73},sourceSize:{w:92,h:73}},{filename:"DogGraphics0217",frame:{x:78,y:2098,w:84,h:57},rotated:!1,trimmed:!0,spriteSourceSize:{x:-39,y:-52,w:92,h:73},sourceSize:{w:92,h:73}},{filename:"DogGraphics0218",frame:{x:2299,y:2099,w:84,h:57},rotated:!1,trimmed:!0,spriteSourceSize:{x:-39,y:-52,w:92,h:73},sourceSize:{w:92,h:73}},{filename:"DogGraphics0219",frame:{x:316,y:2100,w:84,h:57},rotated:!1,trimmed:!0,spriteSourceSize:{x:-39,y:-52,w:92,h:73},sourceSize:{w:92,h:73}},{filename:"DogGraphics0220",frame:{x:1554,y:2101,w:84,h:57},rotated:!1,trimmed:!0,spriteSourceSize:{x:-39,y:-52,w:92,h:73},sourceSize:{w:92,h:73}},{filename:"DogGraphics0221",frame:{x:1641,y:2101,w:84,h:57},rotated:!1,trimmed:!0,spriteSourceSize:{x:-39,y:-52,w:92,h:73},sourceSize:{w:92,h:73}},{filename:"DogGraphics0222",frame:{x:2716,y:2102,w:84,h:57},rotated:!1,trimmed:!0,spriteSourceSize:{x:-39,y:-52,w:92,h:73},sourceSize:{w:92,h:73}},{filename:"DogGraphics0223",frame:{x:3440,y:2103,w:84,h:57},rotated:!1,trimmed:!0,spriteSourceSize:{x:-39,y:-52,w:92,h:73},sourceSize:{w:92,h:73}},{filename:"DogGraphics0224",frame:{x:3527,y:2103,w:84,h:57},rotated:!1,trimmed:!0,spriteSourceSize:{x:-39,y:-52,w:92,h:73},sourceSize:{w:92,h:73}},{filename:"DogGraphics0225",frame:{x:1223,y:2104,w:84,h:57},rotated:!1,trimmed:!0,spriteSourceSize:{x:-39,y:-52,w:92,h:73},sourceSize:{w:92,h:73}},{filename:"DogGraphics0226",frame:{x:3158,y:2105,w:84,h:57},rotated:!1,trimmed:!0,spriteSourceSize:{x:-39,y:-52,w:92,h:73},sourceSize:{w:92,h:73}},{filename:"DogGraphics0227",frame:{x:165,y:2106,w:84,h:57},rotated:!1,trimmed:!0,spriteSourceSize:{x:-39,y:-52,w:92,h:73},sourceSize:{w:92,h:73}},{filename:"DogGraphics0228",frame:{x:634,y:2106,w:84,h:57},rotated:!1,trimmed:!0,spriteSourceSize:{x:-39,y:-52,w:92,h:73},sourceSize:{w:92,h:73}},{filename:"DogGraphics0229",frame:{x:634,y:2106,w:84,h:57},rotated:!1,trimmed:!0,spriteSourceSize:{x:-39,y:-52,w:92,h:73},sourceSize:{w:92,h:73}},{filename:"DogGraphics0230",frame:{x:634,y:2106,w:84,h:57},rotated:!1,trimmed:!0,spriteSourceSize:{x:-39,y:-52,w:92,h:73},sourceSize:{w:92,h:73}},{filename:"DogGraphics0231",frame:{x:634,y:2106,w:84,h:57},rotated:!1,trimmed:!0,spriteSourceSize:{x:-39,y:-52,w:92,h:73},sourceSize:{w:92,h:73}},{filename:"DogGraphics0232",frame:{x:634,y:2106,w:84,h:57},rotated:!1,trimmed:!0,spriteSourceSize:{x:-39,y:-52,w:92,h:73},sourceSize:{w:92,h:73}},{filename:"DogGraphics0233",frame:{x:634,y:2106,w:84,h:57},rotated:!1,trimmed:!0,spriteSourceSize:{x:-39,y:-52,w:92,h:73},sourceSize:{w:92,h:73}},{filename:"DogGraphics0234",frame:{x:2008,y:2106,w:84,h:57},rotated:!1,trimmed:!0,spriteSourceSize:{x:-39,y:-52,w:92,h:73},sourceSize:{w:92,h:73}},{filename:"DogGraphics0235",frame:{x:3059,y:2108,w:84,h:57},rotated:!1,trimmed:!0,spriteSourceSize:{x:-39,y:-52,w:92,h:73},sourceSize:{w:92,h:73}},{filename:"DogGraphics0236",frame:{x:403,y:2111,w:84,h:57},rotated:!1,trimmed:!0,spriteSourceSize:{x:-39,y:-52,w:92,h:73},sourceSize:{w:92,h:73}},{filename:"DogGraphics0237",frame:{x:1462,y:2111,w:84,h:57},rotated:!1,trimmed:!0,spriteSourceSize:{x:-39,y:-52,w:92,h:73},sourceSize:{w:92,h:73}},{filename:"DogGraphics0238",frame:{x:1728,y:2111,w:84,h:57},rotated:!1,trimmed:!0,spriteSourceSize:{x:-39,y:-52,w:92,h:73},sourceSize:{w:92,h:73}},{filename:"DogGraphics0239",frame:{x:1134,y:2112,w:84,h:57},rotated:!1,trimmed:!0,spriteSourceSize:{x:-39,y:-52,w:92,h:73},sourceSize:{w:92,h:73}},{filename:"DogGraphics0240",frame:{x:2386,y:2112,w:84,h:57},rotated:!1,trimmed:!0,spriteSourceSize:{x:-39,y:-52,w:92,h:73},sourceSize:{w:92,h:73}},{filename:"DogGraphics0241",frame:{x:2473,y:2112,w:84,h:57},rotated:!1,trimmed:!0,spriteSourceSize:{x:-39,y:-52,w:92,h:73},sourceSize:{w:92,h:73}},{filename:"DogGraphics0242",frame:{x:2560,y:2115,w:84,h:57},rotated:!1,trimmed:!0,spriteSourceSize:{x:-39,y:-52,w:92,h:73},sourceSize:{w:92,h:73}},{filename:"DogGraphics0243",frame:{x:2095,y:2121,w:84,h:57},rotated:!1,trimmed:!0,spriteSourceSize:{x:-39,y:-52,w:92,h:73},sourceSize:{w:92,h:73}},{filename:"DogGraphics0244",frame:{x:2182,y:2121,w:84,h:57},rotated:!1,trimmed:!0,spriteSourceSize:{x:-39,y:-52,w:92,h:73},sourceSize:{w:92,h:73}},{filename:"DogGraphics0245",frame:{x:2182,y:2121,w:84,h:57},rotated:!1,trimmed:!0,spriteSourceSize:{x:-39,y:-52,w:92,h:73},sourceSize:{w:92,h:73}},{filename:"DogGraphics0246",frame:{x:2182,y:2121,w:84,h:57},rotated:!1,trimmed:!0,spriteSourceSize:{x:-39,y:-52,w:92,h:73},sourceSize:{w:92,h:73}},{filename:"DogGraphics0247",frame:{x:2182,y:2121,w:84,h:57},rotated:!1,trimmed:!0,spriteSourceSize:{x:-39,y:-52,w:92,h:73},sourceSize:{w:92,h:73}},{filename:"DogGraphics0248",frame:{x:2095,y:2121,w:84,h:57},rotated:!1,trimmed:!0,spriteSourceSize:{x:-39,y:-52,w:92,h:73},sourceSize:{w:92,h:73}},{filename:"DogGraphics0249",frame:{x:2560,y:2115,w:84,h:57},rotated:!1,trimmed:!0,spriteSourceSize:{x:-39,y:-52,w:92,h:73},sourceSize:{w:92,h:73}},{filename:"DogGraphics0250",frame:{x:721,y:2122,w:84,h:57},rotated:!1,trimmed:!0,spriteSourceSize:{x:-39,y:-52,w:92,h:73},sourceSize:{w:92,h:73}},{filename:"DogGraphics0251",frame:{x:977,y:2123,w:84,h:57},rotated:!1,trimmed:!0,spriteSourceSize:{x:-39,y:-52,w:92,h:73},sourceSize:{w:92,h:73}},{filename:"DogGraphics0252",frame:{x:490,y:2127,w:84,h:57},rotated:!1,trimmed:!0,spriteSourceSize:{x:-39,y:-52,w:92,h:73},sourceSize:{w:92,h:73}},{filename:"DogGraphics0253",frame:{x:3245,y:2134,w:84,h:57},rotated:!1,trimmed:!0,spriteSourceSize:{x:-39,y:-52,w:92,h:73},sourceSize:{w:92,h:73}},{filename:"DogGraphics0254",frame:{x:3332,y:2134,w:84,h:57},rotated:!1,trimmed:!0,spriteSourceSize:{x:-39,y:-52,w:92,h:73},sourceSize:{w:92,h:73}},{filename:"DogGraphics0255",frame:{x:808,y:2136,w:84,h:57},rotated:!1,trimmed:!0,spriteSourceSize:{x:-39,y:-52,w:92,h:73},sourceSize:{w:92,h:73}},{filename:"DogGraphics0256",frame:{x:2803,y:2145,w:84,h:57},rotated:!1,trimmed:!0,spriteSourceSize:{x:-39,y:-52,w:92,h:73},sourceSize:{w:92,h:73}},{filename:"DogGraphics0257",frame:{x:2803,y:2145,w:84,h:57},rotated:!1,trimmed:!0,spriteSourceSize:{x:-39,y:-52,w:92,h:73},sourceSize:{w:92,h:73}},{filename:"DogGraphics0258",frame:{x:2890,y:2145,w:84,h:57},rotated:!1,trimmed:!0,spriteSourceSize:{x:-39,y:-52,w:92,h:73},sourceSize:{w:92,h:73}},{filename:"DogGraphics0259",frame:{x:634,y:2106,w:84,h:57},rotated:!1,trimmed:!0,spriteSourceSize:{x:-39,y:-52,w:92,h:73},sourceSize:{w:92,h:73}},{filename:"DogGraphics0260",frame:{x:634,y:2106,w:84,h:57},rotated:!1,trimmed:!0,spriteSourceSize:{x:-39,y:-52,w:92,h:73},sourceSize:{w:92,h:73}},{filename:"DogGraphics0261",frame:{x:634,y:2106,w:84,h:57},rotated:!1,trimmed:!0,spriteSourceSize:{x:-39,y:-52,w:92,h:73},sourceSize:{w:92,h:73}},{filename:"DogGraphics0262",frame:{x:634,y:2106,w:84,h:57},rotated:!1,trimmed:!0,spriteSourceSize:{x:-39,y:-52,w:92,h:73},sourceSize:{w:92,h:73}},{filename:"DogGraphics0263",frame:{x:634,y:2106,w:84,h:57},rotated:!1,trimmed:!0,spriteSourceSize:{x:-39,y:-52,w:92,h:73},sourceSize:{w:92,h:73}},{filename:"DogGraphics0264",frame:{x:2008,y:2106,w:84,h:57},rotated:!1,trimmed:!0,spriteSourceSize:{x:-39,y:-52,w:92,h:73},sourceSize:{w:92,h:73}},{filename:"DogGraphics0265",frame:{x:3059,y:2108,w:84,h:57},rotated:!1,trimmed:!0,spriteSourceSize:{x:-39,y:-52,w:92,h:73},sourceSize:{w:92,h:73}},{filename:"DogGraphics0266",frame:{x:403,y:2111,w:84,h:57},rotated:!1,trimmed:!0,spriteSourceSize:{x:-39,y:-52,w:92,h:73},sourceSize:{w:92,h:73}},{filename:"DogGraphics0267",frame:{x:1462,y:2111,w:84,h:57},rotated:!1,trimmed:!0,spriteSourceSize:{x:-39,y:-52,w:92,h:73},sourceSize:{w:92,h:73}},{filename:"DogGraphics0268",frame:{x:1728,y:2111,w:84,h:57},rotated:!1,trimmed:!0,spriteSourceSize:{x:-39,y:-52,w:92,h:73},sourceSize:{w:92,h:73}},{filename:"DogGraphics0269",frame:{x:1134,y:2112,w:84,h:57},rotated:!1,trimmed:!0,spriteSourceSize:{x:-39,y:-52,w:92,h:73},sourceSize:{w:92,h:73}},{filename:"DogGraphics0270",frame:{x:2386,y:2112,w:84,h:57},rotated:!1,trimmed:!0,spriteSourceSize:{x:-39,y:-52,w:92,h:73},sourceSize:{w:92,h:73}},{filename:"DogGraphics0271",frame:{x:2473,y:2112,w:84,h:57},rotated:!1,trimmed:!0,spriteSourceSize:{x:-39,y:-52,w:92,h:73},sourceSize:{w:92,h:73}},{filename:"DogGraphics0272",frame:{x:2560,y:2115,w:84,h:57},rotated:!1,trimmed:!0,spriteSourceSize:{x:-39,y:-52,w:92,h:73},sourceSize:{w:92,h:73}},{filename:"DogGraphics0273",frame:{x:2095,y:2121,w:84,h:57},rotated:!1,trimmed:!0,spriteSourceSize:{x:-39,y:-52,w:92,h:73},sourceSize:{w:92,h:73}},{filename:"DogGraphics0274",frame:{x:2182,y:2121,w:84,h:57},rotated:!1,trimmed:!0,spriteSourceSize:{x:-39,y:-52,w:92,h:73},sourceSize:{w:92,h:73}},{filename:"DogGraphics0275",frame:{x:2182,y:2121,w:84,h:57},rotated:!1,trimmed:!0,spriteSourceSize:{x:-39,y:-52,w:92,h:73},sourceSize:{w:92,h:73}},{filename:"DogGraphics0276",frame:{x:2182,y:2121,w:84,h:57},rotated:!1,trimmed:!0,spriteSourceSize:{x:-39,y:-52,w:92,h:73},sourceSize:{w:92,h:73}},{filename:"DogGraphics0277",frame:{x:2182,y:2121,w:84,h:57},rotated:!1,trimmed:!0,spriteSourceSize:{x:-39,y:-52,w:92,h:73},sourceSize:{w:92,h:73}},{filename:"DogGraphics0278",frame:{x:2095,y:2121,w:84,h:57},rotated:!1,trimmed:!0,spriteSourceSize:{x:-39,y:-52,w:92,h:73},sourceSize:{w:92,h:73}},{filename:"DogGraphics0279",frame:{x:2560,y:2115,w:84,h:57},rotated:!1,trimmed:!0,spriteSourceSize:{x:-39,y:-52,w:92,h:73},sourceSize:{w:92,h:73}},{filename:"DogGraphics0280",frame:{x:721,y:2122,w:84,h:57},rotated:!1,trimmed:!0,spriteSourceSize:{x:-39,y:-52,w:92,h:73},sourceSize:{w:92,h:73}},{filename:"DogGraphics0281",frame:{x:977,y:2123,w:84,h:57},rotated:!1,trimmed:!0,spriteSourceSize:{x:-39,y:-52,w:92,h:73},sourceSize:{w:92,h:73}},{filename:"DogGraphics0282",frame:{x:490,y:2127,w:84,h:57},rotated:!1,trimmed:!0,spriteSourceSize:{x:-39,y:-52,w:92,h:73},sourceSize:{w:92,h:73}},{filename:"DogGraphics0283",frame:{x:3245,y:2134,w:84,h:57},rotated:!1,trimmed:!0,spriteSourceSize:{x:-39,y:-52,w:92,h:73},sourceSize:{w:92,h:73}},{filename:"DogGraphics0284",frame:{x:3332,y:2134,w:84,h:57},rotated:!1,trimmed:!0,spriteSourceSize:{x:-39,y:-52,w:92,h:73},sourceSize:{w:92,h:73}},{filename:"DogGraphics0285",frame:{x:808,y:2136,w:84,h:57},rotated:!1,trimmed:!0,spriteSourceSize:{x:-39,y:-52,w:92,h:73},sourceSize:{w:92,h:73}},{filename:"DogGraphics0286",frame:{x:2803,y:2145,w:84,h:57},rotated:!1,trimmed:!0,spriteSourceSize:{x:-39,y:-52,w:92,h:73},sourceSize:{w:92,h:73}},{filename:"DogGraphics0287",frame:{x:2803,y:2145,w:84,h:57},rotated:!1,trimmed:!0,spriteSourceSize:{x:-39,y:-52,w:92,h:73},sourceSize:{w:92,h:73}},{filename:"DogGraphics0288",frame:{x:2890,y:2145,w:84,h:57},rotated:!1,trimmed:!0,spriteSourceSize:{x:-39,y:-52,w:92,h:73},sourceSize:{w:92,h:73}},{filename:"DogGraphics0289",frame:{x:634,y:2106,w:84,h:57},rotated:!1,trimmed:!0,spriteSourceSize:{x:-39,y:-52,w:92,h:73},sourceSize:{w:92,h:73}},{filename:"DogGraphics0290",frame:{x:634,y:2106,w:84,h:57},rotated:!1,trimmed:!0,spriteSourceSize:{x:-39,y:-52,w:92,h:73},sourceSize:{w:92,h:73}},{filename:"DogGraphics0291",frame:{x:634,y:2106,w:84,h:57},rotated:!1,trimmed:!0,spriteSourceSize:{x:-39,y:-52,w:92,h:73},sourceSize:{w:92,h:73}},{filename:"DogGraphics0292",frame:{x:3790,y:2147,w:84,h:57},rotated:!1,trimmed:!0,spriteSourceSize:{x:-39,y:-52,w:92,h:73},sourceSize:{w:92,h:73}},{filename:"DogGraphics0293",frame:{x:3703,y:2149,w:84,h:57},rotated:!1,trimmed:!0,spriteSourceSize:{x:-39,y:-52,w:92,h:73},sourceSize:{w:92,h:73}},{filename:"DogGraphics0294",frame:{x:3877,y:2150,w:84,h:57},rotated:!1,trimmed:!0,spriteSourceSize:{x:-39,y:-52,w:92,h:73},sourceSize:{w:92,h:73}},{filename:"DogGraphics0295",frame:{x:3964,y:2150,w:84,h:57},rotated:!1,trimmed:!0,spriteSourceSize:{x:-39,y:-52,w:92,h:73},sourceSize:{w:92,h:73}},{filename:"DogGraphics0296",frame:{x:1815,y:2152,w:84,h:57},rotated:!1,trimmed:!0,spriteSourceSize:{x:-39,y:-52,w:92,h:73},sourceSize:{w:92,h:73}},{filename:"DogGraphics0297",frame:{x:1902,y:2152,w:84,h:57},rotated:!1,trimmed:!0,spriteSourceSize:{x:-39,y:-52,w:92,h:73},sourceSize:{w:92,h:73}},{filename:"DogGraphics0298",frame:{x:1310,y:2157,w:84,h:57},rotated:!1,trimmed:!0,spriteSourceSize:{x:-39,y:-52,w:92,h:73},sourceSize:{w:92,h:73}},{filename:"DogGraphics0299",frame:{x:3614,y:2157,w:84,h:57},rotated:!1,trimmed:!0,spriteSourceSize:{x:-39,y:-52,w:92,h:73},sourceSize:{w:92,h:73}},{filename:"DogGraphics0300",frame:{x:3,y:2158,w:84,h:57},rotated:!1,trimmed:!0,spriteSourceSize:{x:-39,y:-52,w:92,h:73},sourceSize:{w:92,h:73}},{filename:"DogGraphics0301",frame:{x:2269,y:2159,w:84,h:57},rotated:!1,trimmed:!0,spriteSourceSize:{x:-39,y:-52,w:92,h:73},sourceSize:{w:92,h:73}},{filename:"DogGraphics0302",frame:{x:252,y:2160,w:84,h:57},rotated:!1,trimmed:!0,spriteSourceSize:{x:-39,y:-52,w:92,h:73},sourceSize:{w:92,h:73}},{filename:"DogGraphics0303",frame:{x:1549,y:2161,w:84,h:57},rotated:!1,trimmed:!0,spriteSourceSize:{x:-39,y:-52,w:92,h:73},sourceSize:{w:92,h:73}},{filename:"DogGraphics0304",frame:{x:1636,y:2161,w:84,h:57},rotated:!1,trimmed:!0,spriteSourceSize:{x:-39,y:-52,w:92,h:73},sourceSize:{w:92,h:73}},{filename:"DogGraphics0305",frame:{x:1136,y:2052,w:84,h:57},rotated:!1,trimmed:!0,spriteSourceSize:{x:-39,y:-52,w:92,h:73},sourceSize:{w:92,h:73}},{filename:"DogGraphics0306",frame:{x:2647,y:2162,w:84,h:57},rotated:!1,trimmed:!0,spriteSourceSize:{x:-39,y:-52,w:92,h:73},sourceSize:{w:92,h:73}},{filename:"DogGraphics0307",frame:{x:3419,y:2163,w:84,h:57},rotated:!1,trimmed:!0,spriteSourceSize:{x:-39,y:-52,w:92,h:73},sourceSize:{w:92,h:73}},{filename:"DogGraphics0308",frame:{x:3506,y:2163,w:84,h:57},rotated:!1,trimmed:!0,spriteSourceSize:{x:-39,y:-52,w:92,h:73},sourceSize:{w:92,h:73}},{filename:"DogGraphics0309",frame:{x:1221,y:2164,w:84,h:57},rotated:!1,trimmed:!0,spriteSourceSize:{x:-39,y:-52,w:92,h:73},sourceSize:{w:92,h:73}},{filename:"DogGraphics0310",frame:{x:3146,y:2165,w:84,h:57},rotated:!1,trimmed:!0,spriteSourceSize:{x:-39,y:-52,w:92,h:73},sourceSize:{w:92,h:73}},{filename:"DogGraphics0311",frame:{x:90,y:2166,w:84,h:57},rotated:!1,trimmed:!0,spriteSourceSize:{x:-39,y:-52,w:92,h:73},sourceSize:{w:92,h:73}},{filename:"DogGraphics0312",frame:{x:577,y:2166,w:84,h:57},rotated:!1,trimmed:!0,spriteSourceSize:{x:-39,y:-52,w:92,h:73},sourceSize:{w:92,h:73}},{filename:"DogGraphics0313",frame:{x:1989,y:2166,w:84,h:57},rotated:!1,trimmed:!0,spriteSourceSize:{x:-39,y:-52,w:92,h:73},sourceSize:{w:92,h:73}},{filename:"DogGraphics0314",frame:{x:2977,y:2168,w:84,h:57},rotated:!1,trimmed:!0,spriteSourceSize:{x:-39,y:-52,w:92,h:73},sourceSize:{w:92,h:73}},{filename:"DogGraphics0315",frame:{x:3146,y:2165,w:84,h:57},rotated:!1,trimmed:!0,spriteSourceSize:{x:-39,y:-52,w:92,h:73},sourceSize:{w:92,h:73}},{filename:"DogGraphics0316",frame:{x:339,y:2171,w:84,h:57},rotated:!1,trimmed:!0,spriteSourceSize:{x:-39,y:-52,w:92,h:73},sourceSize:{w:92,h:73}},{filename:"DogGraphics0317",frame:{x:577,y:2166,w:84,h:57},rotated:!1,trimmed:!0,spriteSourceSize:{x:-39,y:-52,w:92,h:73},sourceSize:{w:92,h:73}},{filename:"DogGraphics0318",frame:{x:1989,y:2166,w:84,h:57},rotated:!1,trimmed:!0,spriteSourceSize:{x:-39,y:-52,w:92,h:73},sourceSize:{w:92,h:73}},{filename:"DogGraphics0319",frame:{x:2977,y:2168,w:84,h:57},rotated:!1,trimmed:!0,spriteSourceSize:{x:-39,y:-52,w:92,h:73},sourceSize:{w:92,h:73}},{filename:"DogGraphics0320",frame:{x:3146,y:2165,w:84,h:57},rotated:!1,trimmed:!0,spriteSourceSize:{x:-39,y:-52,w:92,h:73},sourceSize:{w:92,h:73}},{filename:"DogGraphics0321",frame:{x:90,y:2166,w:84,h:57},rotated:!1,trimmed:!0,spriteSourceSize:{x:-39,y:-52,w:92,h:73},sourceSize:{w:92,h:73}},{filename:"DogGraphics0322",frame:{x:577,y:2166,w:84,h:57},rotated:!1,trimmed:!0,spriteSourceSize:{x:-39,y:-52,w:92,h:73},sourceSize:{w:92,h:73}},{filename:"DogGraphics0323",frame:{x:1989,y:2166,w:84,h:57},rotated:!1,trimmed:!0,spriteSourceSize:{x:-39,y:-52,w:92,h:73},sourceSize:{w:92,h:73}},{filename:"DogGraphics0324",frame:{x:1397,y:2171,w:84,h:57},rotated:!1,trimmed:!0,spriteSourceSize:{x:-39,y:-52,w:92,h:73},sourceSize:{w:92,h:73}},{filename:"DogGraphics0325",frame:{x:2647,y:2162,w:84,h:57},rotated:!1,trimmed:!0,spriteSourceSize:{x:-39,y:-52,w:92,h:73},sourceSize:{w:92,h:73}},{filename:"DogGraphics0326",frame:{x:3419,y:2163,w:84,h:57},rotated:!1,trimmed:!0,spriteSourceSize:{x:-39,y:-52,w:92,h:73},sourceSize:{w:92,h:73}},{filename:"DogGraphics0327",frame:{x:2647,y:2162,w:84,h:57},rotated:!1,trimmed:!0,spriteSourceSize:{x:-39,y:-52,w:92,h:73},sourceSize:{w:92,h:73}},{filename:"DogGraphics0328",frame:{x:3419,y:2163,w:84,h:57},rotated:!1,trimmed:!0,spriteSourceSize:{x:-39,y:-52,w:92,h:73},sourceSize:{w:92,h:73}},{filename:"DogGraphics0329",frame:{x:1723,y:2171,w:84,h:57},rotated:!1,trimmed:!0,spriteSourceSize:{x:-39,y:-52,w:92,h:73},sourceSize:{w:92,h:73}},{filename:"DogGraphics0330",frame:{x:1064,y:2172,w:84,h:57},rotated:!1,trimmed:!0,spriteSourceSize:{x:-39,y:-52,w:92,h:73},sourceSize:{w:92,h:73}},{filename:"DogGraphics0331",frame:{x:2356,y:2172,w:84,h:57},rotated:!1,trimmed:!0,spriteSourceSize:{x:-39,y:-52,w:92,h:73},sourceSize:{w:92,h:73}},{filename:"DogGraphics0332",frame:{x:2443,y:2172,w:84,h:57},rotated:!1,trimmed:!0,spriteSourceSize:{x:-39,y:-52,w:92,h:73},sourceSize:{w:92,h:73}},{filename:"DogGraphics0333",frame:{x:2530,y:2175,w:84,h:57},rotated:!1,trimmed:!0,spriteSourceSize:{x:-39,y:-52,w:92,h:73},sourceSize:{w:92,h:73}},{filename:"DogGraphics0334",frame:{x:2076,y:2181,w:84,h:57},rotated:!1,trimmed:!0,spriteSourceSize:{x:-39,y:-52,w:92,h:73},sourceSize:{w:92,h:73}},{filename:"DogGraphics0335",frame:{x:2163,y:2181,w:84,h:57},rotated:!1,trimmed:!0,spriteSourceSize:{x:-39,y:-52,w:92,h:73},sourceSize:{w:92,h:73}},{filename:"DogGraphics0336",frame:{x:664,y:2182,w:84,h:57},rotated:!1,trimmed:!0,spriteSourceSize:{x:-39,y:-52,w:92,h:73},sourceSize:{w:92,h:73}},{filename:"DogGraphics0337",frame:{x:895,y:2183,w:84,h:57},rotated:!1,trimmed:!0,spriteSourceSize:{x:-39,y:-52,w:92,h:73},sourceSize:{w:92,h:73}},{filename:"DogGraphics0338",frame:{x:426,y:2187,w:84,h:57},rotated:!1,trimmed:!0,spriteSourceSize:{x:-39,y:-52,w:92,h:73},sourceSize:{w:92,h:73}},{filename:"DogGraphics0339",frame:{x:3233,y:2194,w:84,h:57},rotated:!1,trimmed:!0,spriteSourceSize:{x:-39,y:-52,w:92,h:73},sourceSize:{w:92,h:73}},{filename:"DogGraphics0340",frame:{x:3320,y:2194,w:84,h:57},rotated:!1,trimmed:!0,spriteSourceSize:{x:-39,y:-52,w:92,h:73},sourceSize:{w:92,h:73}},{filename:"DogGraphics0341",frame:{x:751,y:2196,w:84,h:57},rotated:!1,trimmed:!0,spriteSourceSize:{x:-39,y:-52,w:92,h:73},sourceSize:{w:92,h:73}},{filename:"DogGraphics0342",frame:{x:2734,y:2205,w:84,h:57},rotated:!1,trimmed:!0,spriteSourceSize:{x:-39,y:-52,w:92,h:73},sourceSize:{w:92,h:73}},{filename:"DogGraphics0343",frame:{x:2821,y:2205,w:84,h:57},rotated:!1,trimmed:!0,spriteSourceSize:{x:-39,y:-52,w:92,h:73},sourceSize:{w:92,h:73}},{filename:"DogGraphics0344",frame:{x:3790,y:2207,w:84,h:57},rotated:!1,trimmed:!0,spriteSourceSize:{x:-39,y:-52,w:92,h:73},sourceSize:{w:92,h:73}},{filename:"DogGraphics0345",frame:{x:3701,y:2209,w:84,h:57},rotated:!1,trimmed:!0,spriteSourceSize:{x:-39,y:-52,w:92,h:73},sourceSize:{w:92,h:73}},{filename:"DogGraphics0346",frame:{x:3877,y:2210,w:84,h:57},rotated:!1,trimmed:!0,spriteSourceSize:{x:-39,y:-52,w:92,h:73},sourceSize:{w:92,h:73}},{filename:"DogGraphics0347",frame:{x:3964,y:2210,w:84,h:57},rotated:!1,trimmed:!0,spriteSourceSize:{x:-39,y:-52,w:92,h:73},sourceSize:{w:92,h:73}},{filename:"DogGraphics0348",frame:{x:1810,y:2212,w:84,h:57},rotated:!1,trimmed:!0,spriteSourceSize:{x:-39,y:-52,w:92,h:73},sourceSize:{w:92,h:73}},{filename:"DogGraphics0349",frame:{x:1897,y:2212,w:84,h:57},rotated:!1,trimmed:!0,spriteSourceSize:{x:-39,y:-52,w:92,h:73},sourceSize:{w:92,h:73}},{filename:"DogGraphics0350",frame:{x:1308,y:2217,w:84,h:57},rotated:!1,trimmed:!0,spriteSourceSize:{x:-39,y:-52,w:92,h:73},sourceSize:{w:92,h:73}},{filename:"DogGraphics0351",frame:{x:3593,y:2217,w:84,h:57},rotated:!1,trimmed:!0,spriteSourceSize:{x:-39,y:-52,w:92,h:73},sourceSize:{w:92,h:73}},{filename:"DogGraphics0352",frame:{x:3,y:2218,w:84,h:57},rotated:!1,trimmed:!0,spriteSourceSize:{x:-39,y:-52,w:92,h:73},sourceSize:{w:92,h:73}},{filename:"DogGraphics0353",frame:{x:2250,y:2219,w:84,h:57},rotated:!1,trimmed:!0,spriteSourceSize:{x:-39,y:-52,w:92,h:73},sourceSize:{w:92,h:73}},{filename:"DogGraphics0354",frame:{x:177,y:2220,w:84,h:57},rotated:!1,trimmed:!0,spriteSourceSize:{x:-39,y:-52,w:92,h:73},sourceSize:{w:92,h:73}},{filename:"DogGraphics0355",frame:{x:2647,y:2162,w:84,h:57},rotated:!1,trimmed:!0,spriteSourceSize:{x:-39,y:-52,w:92,h:73},sourceSize:{w:92,h:73}},{filename:"DogGraphics0356",frame:{x:2647,y:2162,w:84,h:57},rotated:!1,trimmed:!0,spriteSourceSize:{x:-39,y:-52,w:92,h:73},sourceSize:{w:92,h:73}},{filename:"DogGraphics0357",frame:{x:2647,y:2162,w:84,h:57},rotated:!1,trimmed:!0,spriteSourceSize:{x:-39,y:-52,w:92,h:73},sourceSize:{w:92,h:73}},{filename:"DogGraphics0358",frame:{x:1484,y:2221,w:84,h:57},rotated:!1,trimmed:!0,spriteSourceSize:{x:-39,y:-52,w:92,h:73},sourceSize:{w:92,h:73}},{filename:"DogGraphics0359",frame:{x:1484,y:2221,w:84,h:57},rotated:!1,trimmed:!0,spriteSourceSize:{x:-39,y:-52,w:92,h:73},sourceSize:{w:92,h:73}},{filename:"DogGraphics0360",frame:{x:1484,y:2221,w:84,h:57},rotated:!1,trimmed:!0,spriteSourceSize:{x:-39,y:-52,w:92,h:73},sourceSize:{w:92,h:73}},{filename:"DogGraphics0361",frame:{x:1484,y:2221,w:84,h:57},rotated:!1,trimmed:!0,spriteSourceSize:{x:-39,y:-52,w:92,h:73},sourceSize:{w:92,h:73}},{filename:"DogGraphics0362",frame:{x:1484,y:2221,w:84,h:57},rotated:!1,trimmed:!0,spriteSourceSize:{x:-39,y:-52,w:92,h:73},sourceSize:{w:92,h:73}},{filename:"DogGraphics0363",frame:{x:1484,y:2221,w:84,h:57},rotated:!1,trimmed:!0,spriteSourceSize:{x:-39,y:-52,w:92,h:73},sourceSize:{w:92,h:73}},{filename:"DogGraphics0364",frame:{x:1484,y:2221,w:84,h:57},rotated:!1,trimmed:!0,spriteSourceSize:{x:-39,y:-52,w:92,h:73},sourceSize:{w:92,h:73}},{filename:"DogGraphics0365",frame:{x:1571,y:2221,w:84,h:57},rotated:!1,trimmed:!0,spriteSourceSize:{x:-39,y:-52,w:92,h:73},sourceSize:{w:92,h:73}},{filename:"DogGraphics0366",frame:{x:2617,y:2222,w:84,h:57},rotated:!1,trimmed:!0,spriteSourceSize:{x:-39,y:-52,w:92,h:73},sourceSize:{w:92,h:73}},{filename:"DogGraphics0367",frame:{x:3407,y:2223,w:84,h:57},rotated:!1,trimmed:!0,spriteSourceSize:{x:-39,y:-52,w:92,h:73},sourceSize:{w:92,h:73}},{filename:"DogGraphics0368",frame:{x:3494,y:2223,w:84,h:57},rotated:!1,trimmed:!0,spriteSourceSize:{x:-39,y:-52,w:92,h:73},sourceSize:{w:92,h:73}},{filename:"DogGraphics0369",frame:{x:3494,y:2223,w:84,h:57},rotated:!1,trimmed:!0,spriteSourceSize:{x:-39,y:-52,w:92,h:73},sourceSize:{w:92,h:73}},{filename:"DogGraphics0370",frame:{x:1151,y:2224,w:84,h:57},rotated:!1,trimmed:!0,spriteSourceSize:{x:-39,y:-52,w:92,h:73},sourceSize:{w:92,h:73}},{filename:"DogGraphics0371",frame:{x:3064,y:2225,w:84,h:57},rotated:!1,trimmed:!0,spriteSourceSize:{x:-39,y:-52,w:92,h:73},sourceSize:{w:92,h:73}},{filename:"DogGraphics0372",frame:{x:90,y:2226,w:84,h:57},rotated:!1,trimmed:!0,spriteSourceSize:{x:-39,y:-52,w:92,h:73},sourceSize:{w:92,h:73}},{filename:"DogGraphics0373",frame:{x:513,y:2226,w:84,h:57},rotated:!1,trimmed:!0,spriteSourceSize:{x:-39,y:-52,w:92,h:73},sourceSize:{w:92,h:73}},{filename:"DogGraphics0374",frame:{x:1984,y:2226,w:84,h:57},rotated:!1,trimmed:!0,spriteSourceSize:{x:-39,y:-52,w:92,h:73},sourceSize:{w:92,h:73}},{filename:"DogGraphics0375",frame:{x:2908,y:2228,w:84,h:57},rotated:!1,trimmed:!0,spriteSourceSize:{x:-39,y:-52,w:92,h:73},sourceSize:{w:92,h:73}},{filename:"DogGraphics0376",frame:{x:264,y:2231,w:84,h:57},rotated:!1,trimmed:!0,spriteSourceSize:{x:-39,y:-52,w:92,h:73},sourceSize:{w:92,h:73}},{filename:"DogGraphics0377",frame:{x:264,y:2231,w:84,h:57},rotated:!1,trimmed:!0,spriteSourceSize:{x:-39,y:-52,w:92,h:73},sourceSize:{w:92,h:73}},{filename:"DogGraphics0378",frame:{x:1395,y:2231,w:84,h:57},rotated:!1,trimmed:!0,spriteSourceSize:{x:-39,y:-52,w:92,h:73},sourceSize:{w:92,h:73}},{filename:"DogGraphics0379",frame:{x:1395,y:2231,w:84,h:57},rotated:!1,trimmed:!0,spriteSourceSize:{x:-39,y:-52,w:92,h:73},sourceSize:{w:92,h:73}},{filename:"DoorGraphics0000",frame:{x:1172,y:810,w:20,h:70},rotated:!1,trimmed:!0,spriteSourceSize:{x:-10,y:-35,w:20,h:70},sourceSize:{w:20,h:70}},{filename:"DoorGraphics0001",frame:{x:2606,y:899,w:20,h:70},rotated:!1,trimmed:!0,spriteSourceSize:{x:-10,y:-35,w:20,h:70},sourceSize:{w:20,h:70}},{filename:"DoorGraphics0002",frame:{x:4057,y:918,w:20,h:70},rotated:!1,trimmed:!0,spriteSourceSize:{x:-10,y:-35,w:20,h:70},sourceSize:{w:20,h:70}},{filename:"DoorGraphics0003",frame:{x:2568,y:1004,w:20,h:70},rotated:!1,trimmed:!0,spriteSourceSize:{x:-10,y:-35,w:20,h:70},sourceSize:{w:20,h:70}},{filename:"DoorGraphics0004",frame:{x:1171,y:1155,w:20,h:70},rotated:!1,trimmed:!0,spriteSourceSize:{x:-10,y:-35,w:20,h:70},sourceSize:{w:20,h:70}},{filename:"DoorGraphics0005",frame:{x:4055,y:1213,w:20,h:70},rotated:!1,trimmed:!0,spriteSourceSize:{x:-10,y:-35,w:20,h:70},sourceSize:{w:20,h:70}},{filename:"ElectroSplashGraphics0000",frame:{x:923,y:893,w:31,h:22},rotated:!1,trimmed:!0,spriteSourceSize:{x:-16,y:-10.6,w:76,h:73},sourceSize:{w:76,h:73}},{filename:"ElectroSplashGraphics0001",frame:{x:3162,y:1191,w:42,h:28},rotated:!1,trimmed:!0,spriteSourceSize:{x:-26,y:-10.6,w:76,h:73},sourceSize:{w:76,h:73}},{filename:"ElectroSplashGraphics0002",frame:{x:4039,y:1379,w:54,h:39},rotated:!1,trimmed:!0,spriteSourceSize:{x:-34,y:-13.6,w:76,h:73},sourceSize:{w:76,h:73}},{filename:"ElectroSplashGraphics0003",frame:{x:1064,y:2123,w:59,h:45},rotated:!1,trimmed:!0,spriteSourceSize:{x:-37,y:-16.6,w:76,h:73},sourceSize:{w:76,h:73}},{filename:"ElectroSplashGraphics0004",frame:{x:1588,y:1240,w:51,h:36},rotated:!1,trimmed:!0,spriteSourceSize:{x:-22,y:-22.6,w:76,h:73},sourceSize:{w:76,h:73}},{filename:"ElectroSplashGraphics0005",frame:{x:4046,y:1178,w:44,h:32},rotated:!1,trimmed:!0,spriteSourceSize:{x:-8,y:-29.6,w:76,h:73},sourceSize:{w:76,h:73}},{filename:"ElectroSplashGraphics0006",frame:{x:761,y:1020,w:50,h:37},rotated:!1,trimmed:!0,spriteSourceSize:{x:-11,y:-32.6,w:76,h:73},sourceSize:{w:76,h:73}},{filename:"ElectroSplashGraphics0007",frame:{x:2841,y:1170,w:36,h:37},rotated:!1,trimmed:!0,spriteSourceSize:{x:-12,y:-32.6,w:76,h:73},sourceSize:{w:76,h:73}},{filename:"ElectroSplashGraphics0008",frame:{x:3126,y:1225,w:33,h:39},rotated:!1,trimmed:!0,spriteSourceSize:{x:-18,y:-40.6,w:76,h:73},sourceSize:{w:76,h:73}},{filename:"ElectroSplashGraphics0009",frame:{x:923,y:846,w:36,h:44},rotated:!1,trimmed:!0,spriteSourceSize:{x:-20,y:-44.6,w:76,h:73},sourceSize:{w:76,h:73}},{filename:"ElectroSplashGraphics0010",frame:{x:4071,y:91,w:22,h:31},rotated:!1,trimmed:!0,spriteSourceSize:{x:-6,y:-30.6,w:76,h:73},sourceSize:{w:76,h:73}},{filename:"ElectroSplashGraphics0011",frame:{x:4079,y:316,w:10,h:14},rotated:!1,trimmed:!0,spriteSourceSize:{x:-1,y:-19.6,w:76,h:73},sourceSize:{w:76,h:73}},{filename:"ElectroSplashGraphics0012",frame:{x:4085,y:142,w:5,h:13},rotated:!1,trimmed:!0,spriteSourceSize:{x:-2,y:-18.6,w:76,h:73},sourceSize:{w:76,h:73}},{filename:"ElectroSplashGraphics0013",frame:{x:3,y:3,w:0,h:0},rotated:!1,trimmed:!0,spriteSourceSize:{x:-1,y:-.6,w:76,h:73},sourceSize:{w:76,h:73}},{filename:"ElectroSplashGraphics0014",frame:{x:923,y:893,w:31,h:22},rotated:!1,trimmed:!0,spriteSourceSize:{x:-16,y:-10.6,w:76,h:73},sourceSize:{w:76,h:73}},{filename:"EnemyLimiterGraphics0000",frame:{x:3523,y:532,w:15,h:15},rotated:!1,trimmed:!0,spriteSourceSize:{x:-7.5,y:-7.5,w:15,h:15},sourceSize:{w:15,h:15}},{filename:"ExitGraphics0000",frame:{x:3129,y:1888,w:85,h:71},rotated:!1,trimmed:!0,spriteSourceSize:{x:-42,y:-35.1,w:121,h:100},sourceSize:{w:121,h:100}},{filename:"ExitGraphics0001",frame:{x:3129,y:1888,w:85,h:71},rotated:!1,trimmed:!0,spriteSourceSize:{x:-42,y:-35.1,w:121,h:100},sourceSize:{w:121,h:100}},{filename:"ExitGraphics0002",frame:{x:2483,y:1889,w:85,h:71},rotated:!1,trimmed:!0,spriteSourceSize:{x:-42,y:-35.1,w:121,h:100},sourceSize:{w:121,h:100}},{filename:"ExitGraphics0003",frame:{x:2912,y:1891,w:85,h:71},rotated:!1,trimmed:!0,spriteSourceSize:{x:-42,y:-35.1,w:121,h:100},sourceSize:{w:121,h:100}},{filename:"ExitGraphics0004",frame:{x:2692,y:1895,w:85,h:71},rotated:!1,trimmed:!0,spriteSourceSize:{x:-42,y:-35.1,w:121,h:100},sourceSize:{w:121,h:100}},{filename:"ExitGraphics0005",frame:{x:3,y:1897,w:85,h:71},rotated:!1,trimmed:!0,spriteSourceSize:{x:-42,y:-35.1,w:121,h:100},sourceSize:{w:121,h:100}},{filename:"ExitGraphics0006",frame:{x:254,y:1897,w:85,h:71},rotated:!1,trimmed:!0,spriteSourceSize:{x:-42,y:-35.1,w:121,h:100},sourceSize:{w:121,h:100}},{filename:"ExitGraphics0007",frame:{x:1548,y:1897,w:85,h:71},rotated:!1,trimmed:!0,spriteSourceSize:{x:-42,y:-35.1,w:121,h:100},sourceSize:{w:121,h:100}},{filename:"ExitGraphics0008",frame:{x:2024,y:1897,w:85,h:71},rotated:!1,trimmed:!0,spriteSourceSize:{x:-42,y:-35.1,w:121,h:100},sourceSize:{w:121,h:100}},{filename:"ExitGraphics0009",frame:{x:1835,y:1903,w:85,h:71},rotated:!1,trimmed:!0,spriteSourceSize:{x:-42,y:-35.1,w:121,h:100},sourceSize:{w:121,h:100}},{filename:"ExitGraphics0010",frame:{x:3217,y:1909,w:85,h:71},rotated:!1,trimmed:!0,spriteSourceSize:{x:-42,y:-35.1,w:121,h:100},sourceSize:{w:121,h:100}},{filename:"ExitGraphics0011",frame:{x:3305,y:1909,w:85,h:71},rotated:!1,trimmed:!0,spriteSourceSize:{x:-42,y:-35.1,w:121,h:100},sourceSize:{w:121,h:100}},{filename:"ExitGraphics0012",frame:{x:2112,y:1914,w:85,h:71},rotated:!1,trimmed:!0,spriteSourceSize:{x:-42,y:-35.1,w:121,h:100},sourceSize:{w:121,h:100}},{filename:"ExitGraphics0013",frame:{x:2200,y:1914,w:85,h:71},rotated:!1,trimmed:!0,spriteSourceSize:{x:-42,y:-35.1,w:121,h:100},sourceSize:{w:121,h:100}},{filename:"ExitGraphics0014",frame:{x:862,y:1915,w:85,h:71},rotated:!1,trimmed:!0,spriteSourceSize:{x:-42,y:-35.1,w:121,h:100},sourceSize:{w:121,h:100}},{filename:"ExitGraphics0015",frame:{x:3489,y:1919,w:85,h:71},rotated:!1,trimmed:!0,spriteSourceSize:{x:-42,y:-35.1,w:121,h:100},sourceSize:{w:121,h:100}},{filename:"ExitGraphics0016",frame:{x:3489,y:1919,w:85,h:71},rotated:!1,trimmed:!0,spriteSourceSize:{x:-42,y:-35.1,w:121,h:100},sourceSize:{w:121,h:100}},{filename:"ExitGraphics0017",frame:{x:3489,y:1919,w:85,h:71},rotated:!1,trimmed:!0,spriteSourceSize:{x:-42,y:-35.1,w:121,h:100},sourceSize:{w:121,h:100}},{filename:"ExitGraphics0018",frame:{x:3489,y:1919,w:85,h:71},rotated:!1,trimmed:!0,spriteSourceSize:{x:-42,y:-35.1,w:121,h:100},sourceSize:{w:121,h:100}},{filename:"ExitGraphics0019",frame:{x:3489,y:1919,w:85,h:71},rotated:!1,trimmed:!0,spriteSourceSize:{x:-42,y:-35.1,w:121,h:100},sourceSize:{w:121,h:100}},{filename:"ExitGraphics0020",frame:{x:3489,y:1919,w:85,h:71},rotated:!1,trimmed:!0,spriteSourceSize:{x:-42,y:-35.1,w:121,h:100},sourceSize:{w:121,h:100}},{filename:"ExitGraphics0021",frame:{x:3489,y:1919,w:85,h:71},rotated:!1,trimmed:!0,spriteSourceSize:{x:-42,y:-35.1,w:121,h:100},sourceSize:{w:121,h:100}},{filename:"ExitGraphics0022",frame:{x:3489,y:1919,w:85,h:71},rotated:!1,trimmed:!0,spriteSourceSize:{x:-42,y:-35.1,w:121,h:100},sourceSize:{w:121,h:100}},{filename:"ExitGraphics0023",frame:{x:3489,y:1919,w:85,h:71},rotated:!1,trimmed:!0,spriteSourceSize:{x:-42,y:-35.1,w:121,h:100},sourceSize:{w:121,h:100}},{filename:"ExitGraphics0024",frame:{x:3938,y:920,w:116,h:85},rotated:!1,trimmed:!0,spriteSourceSize:{x:-61,y:-37.1,w:121,h:100},sourceSize:{w:121,h:100}},{filename:"ExitGraphics0025",frame:{x:427,y:926,w:113,h:87},rotated:!1,trimmed:!0,spriteSourceSize:{x:-58,y:-39.1,w:121,h:100},sourceSize:{w:121,h:100}},{filename:"ExitGraphics0026",frame:{x:215,y:909,w:111,h:90},rotated:!1,trimmed:!0,spriteSourceSize:{x:-56,y:-42.1,w:121,h:100},sourceSize:{w:121,h:100}},{filename:"ExitGraphics0027",frame:{x:646,y:954,w:112,h:87},rotated:!1,trimmed:!0,spriteSourceSize:{x:-55,y:-35.1,w:121,h:100},sourceSize:{w:121,h:100}},{filename:"ExitGraphics0028",frame:{x:192,y:1106,w:113,h:82},rotated:!1,trimmed:!0,spriteSourceSize:{x:-53,y:-47.1,w:121,h:100},sourceSize:{w:121,h:100}},{filename:"ExitGraphics0029",frame:{x:1319,y:1621,w:100,h:77},rotated:!1,trimmed:!0,spriteSourceSize:{x:-49,y:-37.1,w:121,h:100},sourceSize:{w:121,h:100}},{filename:"ExitGraphics0030",frame:{x:3257,y:1322,w:106,h:83},rotated:!1,trimmed:!0,spriteSourceSize:{x:-54,y:-43.1,w:121,h:100},sourceSize:{w:121,h:100}},{filename:"ExitGraphics0031",frame:{x:314,y:1074,w:105,h:90},rotated:!1,trimmed:!0,spriteSourceSize:{x:-53,y:-48.1,w:121,h:100},sourceSize:{w:121,h:100}},{filename:"ExitGraphics0032",frame:{x:3546,y:1386,w:101,h:86},rotated:!1,trimmed:!0,spriteSourceSize:{x:-49,y:-43.1,w:121,h:100},sourceSize:{w:121,h:100}},{filename:"ExitGraphics0033",frame:{x:3737,y:1395,w:95,h:91},rotated:!1,trimmed:!0,spriteSourceSize:{x:-47,y:-43.1,w:121,h:100},sourceSize:{w:121,h:100}},{filename:"ExitGraphics0034",frame:{x:186,y:1393,w:92,h:94},rotated:!1,trimmed:!0,spriteSourceSize:{x:-44,y:-42.1,w:121,h:100},sourceSize:{w:121,h:100}},{filename:"ExitGraphics0035",frame:{x:2552,y:1108,w:98,h:94},rotated:!1,trimmed:!0,spriteSourceSize:{x:-44,y:-42.1,w:121,h:100},sourceSize:{w:121,h:100}},{filename:"ExitGraphics0036",frame:{x:497,y:1207,w:92,h:98},rotated:!1,trimmed:!0,spriteSourceSize:{x:-44,y:-46.1,w:121,h:100},sourceSize:{w:121,h:100}},{filename:"ExitGraphics0037",frame:{x:1742,y:1208,w:92,h:98},rotated:!1,trimmed:!0,spriteSourceSize:{x:-44,y:-46.1,w:121,h:100},sourceSize:{w:121,h:100}},{filename:"ExitGraphics0038",frame:{x:1837,y:1208,w:92,h:98},rotated:!1,trimmed:!0,spriteSourceSize:{x:-44,y:-46.1,w:121,h:100},sourceSize:{w:121,h:100}},{filename:"ExitGraphics0039",frame:{x:543,y:926,w:100,h:98},rotated:!1,trimmed:!0,spriteSourceSize:{x:-52,y:-46.1,w:121,h:100},sourceSize:{w:121,h:100}},{filename:"ExitGraphics0040",frame:{x:95,y:1210,w:92,h:98},rotated:!1,trimmed:!0,spriteSourceSize:{x:-44,y:-46.1,w:121,h:100},sourceSize:{w:121,h:100}},{filename:"ExitGraphics0041",frame:{x:2291,y:1210,w:92,h:98},rotated:!1,trimmed:!0,spriteSourceSize:{x:-44,y:-46.1,w:121,h:100},sourceSize:{w:121,h:100}},{filename:"ExitGraphics0042",frame:{x:3865,y:1213,w:92,h:98},rotated:!1,trimmed:!0,spriteSourceSize:{x:-44,y:-46.1,w:121,h:100},sourceSize:{w:121,h:100}},{filename:"ExitGraphics0043",frame:{x:3960,y:1213,w:92,h:98},rotated:!1,trimmed:!0,spriteSourceSize:{x:-44,y:-46.1,w:121,h:100},sourceSize:{w:121,h:100}},{filename:"ExitGraphics0044",frame:{x:2386,y:1214,w:92,h:98},rotated:!1,trimmed:!0,spriteSourceSize:{x:-44,y:-46.1,w:121,h:100},sourceSize:{w:121,h:100}},{filename:"ExitGraphics0045",frame:{x:2841,y:1214,w:92,h:98},rotated:!1,trimmed:!0,spriteSourceSize:{x:-44,y:-46.1,w:121,h:100},sourceSize:{w:121,h:100}},{filename:"ExitGraphics0046",frame:{x:2121,y:1216,w:92,h:98},rotated:!1,trimmed:!0,spriteSourceSize:{x:-44,y:-46.1,w:121,h:100},sourceSize:{w:121,h:100}},{filename:"ExitGraphics0047",frame:{x:1303,y:1218,w:92,h:98},rotated:!1,trimmed:!0,spriteSourceSize:{x:-44,y:-46.1,w:121,h:100},sourceSize:{w:121,h:100}},{filename:"ExitGraphics0048",frame:{x:592,y:1220,w:92,h:98},rotated:!1,trimmed:!0,spriteSourceSize:{x:-44,y:-46.1,w:121,h:100},sourceSize:{w:121,h:100}},{filename:"ExitGraphics0049",frame:{x:592,y:1220,w:92,h:98},rotated:!1,trimmed:!0,spriteSourceSize:{x:-44,y:-46.1,w:121,h:100},sourceSize:{w:121,h:100}},{filename:"ExitGraphics0050",frame:{x:592,y:1220,w:92,h:98},rotated:!1,trimmed:!0,spriteSourceSize:{x:-44,y:-46.1,w:121,h:100},sourceSize:{w:121,h:100}},{filename:"ExitGraphics0051",frame:{x:592,y:1220,w:92,h:98},rotated:!1,trimmed:!0,spriteSourceSize:{x:-44,y:-46.1,w:121,h:100},sourceSize:{w:121,h:100}},{filename:"ExitGraphics0052",frame:{x:592,y:1220,w:92,h:98},rotated:!1,trimmed:!0,spriteSourceSize:{x:-44,y:-46.1,w:121,h:100},sourceSize:{w:121,h:100}},{filename:"ExitGraphics0053",frame:{x:592,y:1220,w:92,h:98},rotated:!1,trimmed:!0,spriteSourceSize:{x:-44,y:-46.1,w:121,h:100},sourceSize:{w:121,h:100}},{filename:"ExitGraphics0054",frame:{x:592,y:1220,w:92,h:98},rotated:!1,trimmed:!0,spriteSourceSize:{x:-44,y:-46.1,w:121,h:100},sourceSize:{w:121,h:100}},{filename:"ExitGraphics0055",frame:{x:687,y:1220,w:92,h:98},rotated:!1,trimmed:!0,spriteSourceSize:{x:-44,y:-46.1,w:121,h:100},sourceSize:{w:121,h:100}},{filename:"ExitGraphics0056",frame:{x:3309,y:1221,w:92,h:98},rotated:!1,trimmed:!0,spriteSourceSize:{x:-44,y:-46.1,w:121,h:100},sourceSize:{w:121,h:100}},{filename:"ExitGraphics0057",frame:{x:3404,y:1221,w:92,h:98},rotated:!1,trimmed:!0,spriteSourceSize:{x:-44,y:-46.1,w:121,h:100},sourceSize:{w:121,h:100}},{filename:"ExitGraphics0058",frame:{x:3162,y:1222,w:92,h:98},rotated:!1,trimmed:!0,spriteSourceSize:{x:-44,y:-46.1,w:121,h:100},sourceSize:{w:121,h:100}},{filename:"ExitGraphics0059",frame:{x:2936,y:1225,w:92,h:98},rotated:!1,trimmed:!0,spriteSourceSize:{x:-44,y:-46.1,w:121,h:100},sourceSize:{w:121,h:100}},{filename:"ExitGraphics0060",frame:{x:3031,y:1225,w:92,h:98},rotated:!1,trimmed:!0,spriteSourceSize:{x:-44,y:-46.1,w:121,h:100},sourceSize:{w:121,h:100}},{filename:"ExitGraphics0061",frame:{x:1171,y:1229,w:92,h:98},rotated:!1,trimmed:!0,spriteSourceSize:{x:-44,y:-46.1,w:121,h:100},sourceSize:{w:121,h:100}},{filename:"ExitGraphics0062",frame:{x:1932,y:1233,w:92,h:98},rotated:!1,trimmed:!0,spriteSourceSize:{x:-44,y:-46.1,w:121,h:100},sourceSize:{w:121,h:100}},{filename:"ExitGraphics0063",frame:{x:2650,y:1233,w:92,h:98},rotated:!1,trimmed:!0,spriteSourceSize:{x:-44,y:-46.1,w:121,h:100},sourceSize:{w:121,h:100}},{filename:"ExitGraphics0064",frame:{x:2745,y:1233,w:92,h:98},rotated:!1,trimmed:!0,spriteSourceSize:{x:-44,y:-46.1,w:121,h:100},sourceSize:{w:121,h:100}},{filename:"ExitGraphics0065",frame:{x:1398,y:1240,w:92,h:98},rotated:!1,trimmed:!0,spriteSourceSize:{x:-44,y:-46.1,w:121,h:100},sourceSize:{w:121,h:100}},{filename:"ExitGraphics0066",frame:{x:1493,y:1240,w:92,h:98},rotated:!1,trimmed:!0,spriteSourceSize:{x:-44,y:-46.1,w:121,h:100},sourceSize:{w:121,h:100}},{filename:"ExitGraphics0067",frame:{x:782,y:1241,w:92,h:98},rotated:!1,trimmed:!0,spriteSourceSize:{x:-44,y:-46.1,w:121,h:100},sourceSize:{w:121,h:100}},{filename:"ExitGraphics0068",frame:{x:782,y:1241,w:92,h:98},rotated:!1,trimmed:!0,spriteSourceSize:{x:-44,y:-46.1,w:121,h:100},sourceSize:{w:121,h:100}},{filename:"FightingGraphics0000",frame:{x:1275,y:1625,w:39,h:50},rotated:!1,trimmed:!0,spriteSourceSize:{x:-19.3,y:-19.6,w:130,h:134},sourceSize:{w:130,h:134}},{filename:"FightingGraphics0001",frame:{x:2980,y:2551,w:62,h:60},rotated:!1,trimmed:!0,spriteSourceSize:{x:-31.3,y:-22.6,w:130,h:134},sourceSize:{w:130,h:134}},{filename:"FightingGraphics0002",frame:{x:2975,y:1727,w:85,h:80},rotated:!1,trimmed:!0,spriteSourceSize:{x:-43.3,y:-36.6,w:130,h:134},sourceSize:{w:130,h:134}},{filename:"FightingGraphics0003",frame:{x:1423,y:796,w:109,h:102},rotated:!1,trimmed:!0,spriteSourceSize:{x:-55.4,y:-51.6,w:130,h:134},sourceSize:{w:130,h:134}},{filename:"FightingGraphics0004",frame:{x:2639,y:789,w:111,h:105},rotated:!1,trimmed:!0,spriteSourceSize:{x:-56.4,y:-53.6,w:130,h:134},sourceSize:{w:130,h:134}},{filename:"FightingGraphics0005",frame:{x:3290,y:787,w:114,h:108},rotated:!1,trimmed:!0,spriteSourceSize:{x:-58.4,y:-55.6,w:130,h:134},sourceSize:{w:130,h:134}},{filename:"FightingGraphics0006",frame:{x:2294,y:787,w:116,h:109},rotated:!1,trimmed:!0,spriteSourceSize:{x:-59.4,y:-56.6,w:130,h:134},sourceSize:{w:130,h:134}},{filename:"FightingGraphics0007",frame:{x:1817,y:786,w:119,h:112},rotated:!1,trimmed:!0,spriteSourceSize:{x:-60.4,y:-58.6,w:130,h:134},sourceSize:{w:130,h:134}},{filename:"FightingGraphics0008",frame:{x:3839,y:685,w:122,h:115},rotated:!1,trimmed:!0,spriteSourceSize:{x:-62.4,y:-60.6,w:130,h:134},sourceSize:{w:130,h:134}},{filename:"FightingGraphics0009",frame:{x:400,y:1206,w:94,h:96},rotated:!1,trimmed:!0,spriteSourceSize:{x:-51.4,y:-51.6,w:130,h:134},sourceSize:{w:130,h:134}},{filename:"FightingGraphics0010",frame:{x:3178,y:787,w:109,h:113},rotated:!1,trimmed:!0,spriteSourceSize:{x:-58.4,y:-63.6,w:130,h:134},sourceSize:{w:130,h:134}},{filename:"FightingGraphics0011",frame:{x:2060,y:787,w:111,h:117},rotated:!1,trimmed:!0,spriteSourceSize:{x:-59.4,y:-65.6,w:130,h:134},sourceSize:{w:130,h:134}},{filename:"FightingGraphics0012",frame:{x:1700,y:786,w:114,h:119},rotated:!1,trimmed:!0,spriteSourceSize:{x:-60.4,y:-66.6,w:130,h:134},sourceSize:{w:130,h:134}},{filename:"FightingGraphics0013",frame:{x:312,y:678,w:116,h:121},rotated:!1,trimmed:!0,spriteSourceSize:{x:-61.4,y:-67.6,w:130,h:134},sourceSize:{w:130,h:134}},{filename:"FightingGraphics0014",frame:{x:1963,y:659,w:120,h:124},rotated:!1,trimmed:!0,spriteSourceSize:{x:-63.4,y:-69.6,w:130,h:134},sourceSize:{w:130,h:134}},{filename:"FightingGraphics0015",frame:{x:3931,y:269,w:122,h:127},rotated:!1,trimmed:!0,spriteSourceSize:{x:-64.4,y:-70.6,w:130,h:134},sourceSize:{w:130,h:134}},{filename:"FightingGraphics0016",frame:{x:818,y:846,w:102,h:102},rotated:!1,trimmed:!0,spriteSourceSize:{x:-55.4,y:-49.6,w:130,h:134},sourceSize:{w:130,h:134}},{filename:"FightingGraphics0017",frame:{x:3,y:862,w:102,h:102},rotated:!1,trimmed:!0,spriteSourceSize:{x:-55.4,y:-49.6,w:130,h:134},sourceSize:{w:130,h:134}},{filename:"FightingGraphics0018",frame:{x:187,y:799,w:104,h:104},rotated:!1,trimmed:!0,spriteSourceSize:{x:-56.4,y:-50.6,w:130,h:134},sourceSize:{w:130,h:134}},{filename:"FightingGraphics0019",frame:{x:294,y:802,w:104,h:104},rotated:!1,trimmed:!0,spriteSourceSize:{x:-56.4,y:-50.6,w:130,h:134},sourceSize:{w:130,h:134}},{filename:"FightingGraphics0020",frame:{x:2958,y:790,w:108,h:105},rotated:!1,trimmed:!0,spriteSourceSize:{x:-57.4,y:-50.6,w:130,h:134},sourceSize:{w:130,h:134}},{filename:"FightingGraphics0021",frame:{x:2174,y:787,w:117,h:110},rotated:!1,trimmed:!0,spriteSourceSize:{x:-57.4,y:-53.6,w:130,h:134},sourceSize:{w:130,h:134}},{filename:"FightingGraphics0022",frame:{x:1939,y:786,w:118,h:112},rotated:!1,trimmed:!0,spriteSourceSize:{x:-57.4,y:-54.6,w:130,h:134},sourceSize:{w:130,h:134}},{filename:"FightingGraphics0023",frame:{x:3964,y:685,w:120,h:116},rotated:!1,trimmed:!0,spriteSourceSize:{x:-57.4,y:-56.6,w:130,h:134},sourceSize:{w:130,h:134}},{filename:"FightingGraphics0024",frame:{x:187,y:678,w:122,h:118},rotated:!1,trimmed:!0,spriteSourceSize:{x:-58.4,y:-57.6,w:130,h:134},sourceSize:{w:130,h:134}},{filename:"FightingGraphics0025",frame:{x:1963,y:534,w:125,h:122},rotated:!1,trimmed:!0,spriteSourceSize:{x:-60.4,y:-59.6,w:130,h:134},sourceSize:{w:130,h:134}},{filename:"FightingGraphics0026",frame:{x:3931,y:142,w:128,h:124},rotated:!1,trimmed:!0,spriteSourceSize:{x:-62.4,y:-60.6,w:130,h:134},sourceSize:{w:130,h:134}},{filename:"FightingGraphics0027",frame:{x:2413,y:789,w:110,h:107},rotated:!1,trimmed:!0,spriteSourceSize:{x:-60.4,y:-50.6,w:130,h:134},sourceSize:{w:130,h:134}},{filename:"FightingGraphics0028",frame:{x:2526,y:789,w:110,h:107},rotated:!1,trimmed:!0,spriteSourceSize:{x:-60.4,y:-50.6,w:130,h:134},sourceSize:{w:130,h:134}},{filename:"FightingGraphics0029",frame:{x:3407,y:787,w:111,h:107},rotated:!1,trimmed:!0,spriteSourceSize:{x:-61.4,y:-50.6,w:130,h:134},sourceSize:{w:130,h:134}},{filename:"FightingGraphics0030",frame:{x:1195,y:789,w:111,h:107},rotated:!1,trimmed:!0,spriteSourceSize:{x:-61.4,y:-50.6,w:130,h:134},sourceSize:{w:130,h:134}},{filename:"FightingGraphics0031",frame:{x:1309,y:789,w:111,h:107},rotated:!1,trimmed:!0,spriteSourceSize:{x:-61.4,y:-50.6,w:130,h:134},sourceSize:{w:130,h:134}},{filename:"Fragment1Graphics0000",frame:{x:3961,y:1008,w:19,h:7},rotated:!1,trimmed:!0,spriteSourceSize:{x:-9.1,y:-3.5,w:19,h:7},sourceSize:{w:19,h:7}},{filename:"Fragment2Graphics0000",frame:{x:3523,y:584,w:15,h:7},rotated:!1,trimmed:!0,spriteSourceSize:{x:-7.1,y:-3.3,w:15,h:7},sourceSize:{w:15,h:7}},{filename:"Fragment3Graphics0000",frame:{x:4079,y:343,w:11,h:5},rotated:!1,trimmed:!0,spriteSourceSize:{x:-5.4,y:-2.6,w:11,h:5},sourceSize:{w:11,h:5}},{filename:"GlassDoorGraphics0000",frame:{x:4062,y:142,w:20,h:71},rotated:!1,trimmed:!0,spriteSourceSize:{x:-10,y:-35,w:20,h:71},sourceSize:{w:20,h:71}},{filename:"GlassDoorGraphics0001",frame:{x:4062,y:216,w:20,h:71},rotated:!1,trimmed:!0,spriteSourceSize:{x:-10,y:-35,w:20,h:71},sourceSize:{w:20,h:71}},{filename:"GlassDoorGraphics0002",frame:{x:4056,y:290,w:20,h:71},rotated:!1,trimmed:!0,spriteSourceSize:{x:-10,y:-35,w:20,h:71},sourceSize:{w:20,h:71}},{filename:"GlassDoorGraphics0003",frame:{x:4067,y:423,w:20,h:71},rotated:!1,trimmed:!0,spriteSourceSize:{x:-10,y:-35,w:20,h:71},sourceSize:{w:20,h:71}},{filename:"GlassDoorGraphics0004",frame:{x:4067,y:497,w:20,h:71},rotated:!1,trimmed:!0,spriteSourceSize:{x:-10,y:-35,w:20,h:71},sourceSize:{w:20,h:71}},{filename:"GlassDoorGraphics0005",frame:{x:4067,y:571,w:20,h:71},rotated:!1,trimmed:!0,spriteSourceSize:{x:-10,y:-35,w:20,h:71},sourceSize:{w:20,h:71}},{filename:"HustlerGraphics0000",frame:{x:1662,y:2699,w:46,h:56},rotated:!1,trimmed:!0,spriteSourceSize:{x:-23,y:-53,w:86,h:78},sourceSize:{w:86,h:78}},{filename:"HustlerGraphics0001",frame:{x:3936,y:2703,w:46,h:56},rotated:!1,trimmed:!0,spriteSourceSize:{x:-23,y:-53,w:86,h:78},sourceSize:{w:86,h:78}},{filename:"HustlerGraphics0002",frame:{x:996,y:2704,w:46,h:56},rotated:!1,trimmed:!0,spriteSourceSize:{x:-23,y:-53,w:86,h:78},sourceSize:{w:86,h:78}},{filename:"HustlerGraphics0003",frame:{x:1045,y:2704,w:46,h:56},rotated:!1,trimmed:!0,spriteSourceSize:{x:-23,y:-53,w:86,h:78},sourceSize:{w:86,h:78}},{filename:"HustlerGraphics0004",frame:{x:1094,y:2704,w:46,h:56},rotated:!1,trimmed:!0,spriteSourceSize:{x:-23,y:-53,w:86,h:78},sourceSize:{w:86,h:78}},{filename:"HustlerGraphics0005",frame:{x:3402,y:2705,w:46,h:56},rotated:!1,trimmed:!0,spriteSourceSize:{x:-23,y:-53,w:86,h:78},sourceSize:{w:86,h:78}},{filename:"HustlerGraphics0006",frame:{x:3985,y:2718,w:46,h:56},rotated:!1,trimmed:!0,spriteSourceSize:{x:-23,y:-53,w:86,h:78},sourceSize:{w:86,h:78}},{filename:"HustlerGraphics0007",frame:{x:4034,y:2718,w:46,h:56},rotated:!1,trimmed:!0,spriteSourceSize:{x:-23,y:-53,w:86,h:78},sourceSize:{w:86,h:78}},{filename:"HustlerGraphics0008",frame:{x:801,y:2720,w:46,h:56},rotated:!1,trimmed:!0,spriteSourceSize:{x:-23,y:-53,w:86,h:78},sourceSize:{w:86,h:78}},{filename:"HustlerGraphics0009",frame:{x:850,y:2720,w:46,h:56},rotated:!1,trimmed:!0,spriteSourceSize:{x:-23,y:-53,w:86,h:78},sourceSize:{w:86,h:78}},{filename:"HustlerGraphics0010",frame:{x:850,y:2720,w:46,h:56},rotated:!1,trimmed:!0,spriteSourceSize:{x:-23,y:-53,w:86,h:78},sourceSize:{w:86,h:78}},{filename:"HustlerGraphics0011",frame:{x:3612,y:2720,w:46,h:56},rotated:!1,trimmed:!0,spriteSourceSize:{x:-23,y:-53,w:86,h:78},sourceSize:{w:86,h:78}},{filename:"HustlerGraphics0012",frame:{x:850,y:2720,w:46,h:56},rotated:!1,trimmed:!0,spriteSourceSize:{x:-23,y:-53,w:86,h:78},sourceSize:{w:86,h:78}},{filename:"HustlerGraphics0013",frame:{x:2836,y:2722,w:46,h:56},rotated:!1,trimmed:!0,spriteSourceSize:{x:-23,y:-53,w:86,h:78},sourceSize:{w:86,h:78}},{filename:"HustlerGraphics0014",frame:{x:2885,y:2722,w:46,h:56},rotated:!1,trimmed:!0,spriteSourceSize:{x:-23,y:-53,w:86,h:78},sourceSize:{w:86,h:78}},{filename:"HustlerGraphics0015",frame:{x:3292,y:2722,w:46,h:56},rotated:!1,trimmed:!0,spriteSourceSize:{x:-23,y:-53,w:86,h:78},sourceSize:{w:86,h:78}},{filename:"HustlerGraphics0016",frame:{x:3341,y:2722,w:46,h:56},rotated:!1,trimmed:!0,spriteSourceSize:{x:-23,y:-53,w:86,h:78},sourceSize:{w:86,h:78}},{filename:"HustlerGraphics0017",frame:{x:1422,y:2724,w:46,h:56},rotated:!1,trimmed:!0,spriteSourceSize:{x:-23,y:-53,w:86,h:78},sourceSize:{w:86,h:78}},{filename:"HustlerGraphics0018",frame:{x:296,y:2725,w:46,h:56},rotated:!1,trimmed:!0,spriteSourceSize:{x:-23,y:-53,w:86,h:78},sourceSize:{w:86,h:78}},{filename:"HustlerGraphics0019",frame:{x:345,y:2725,w:46,h:56},rotated:!1,trimmed:!0,spriteSourceSize:{x:-23,y:-53,w:86,h:78},sourceSize:{w:86,h:78}},{filename:"HustlerGraphics0020",frame:{x:1363,y:2725,w:46,h:56},rotated:!1,trimmed:!0,spriteSourceSize:{x:-23,y:-53,w:86,h:78},sourceSize:{w:86,h:78}},{filename:"HustlerGraphics0021",frame:{x:1711,y:2725,w:46,h:56},rotated:!1,trimmed:!0,spriteSourceSize:{x:-23,y:-53,w:86,h:78},sourceSize:{w:86,h:78}},{filename:"HustlerGraphics0022",frame:{x:1760,y:2725,w:46,h:56},rotated:!1,trimmed:!0,spriteSourceSize:{x:-23,y:-53,w:86,h:78},sourceSize:{w:86,h:78}},{filename:"HustlerGraphics0023",frame:{x:1662,y:2699,w:46,h:56},rotated:!1,trimmed:!0,spriteSourceSize:{x:-23,y:-53,w:86,h:78},sourceSize:{w:86,h:78}},{filename:"HustlerGraphics0024",frame:{x:2265,y:2725,w:46,h:56},rotated:!1,trimmed:!0,spriteSourceSize:{x:-23,y:-53,w:86,h:78},sourceSize:{w:86,h:78}},{filename:"HustlerGraphics0025",frame:{x:1305,y:2726,w:46,h:56},rotated:!1,trimmed:!0,spriteSourceSize:{x:-23,y:-53,w:86,h:78},sourceSize:{w:86,h:78}},{filename:"HustlerGraphics0026",frame:{x:181,y:2727,w:46,h:56},rotated:!1,trimmed:!0,spriteSourceSize:{x:-23,y:-53,w:86,h:78},sourceSize:{w:86,h:78}},{filename:"HustlerGraphics0027",frame:{x:1471,y:2727,w:46,h:56},rotated:!1,trimmed:!0,spriteSourceSize:{x:-23,y:-53,w:86,h:78},sourceSize:{w:86,h:78}},{filename:"HustlerGraphics0028",frame:{x:2592,y:2727,w:46,h:56},rotated:!1,trimmed:!0,spriteSourceSize:{x:-23,y:-53,w:86,h:78},sourceSize:{w:86,h:78}},{filename:"HustlerGraphics0029",frame:{x:2641,y:2727,w:46,h:56},rotated:!1,trimmed:!0,spriteSourceSize:{x:-23,y:-53,w:86,h:78},sourceSize:{w:86,h:78}},{filename:"HustlerGraphics0030",frame:{x:899,y:2728,w:46,h:56},rotated:!1,trimmed:!0,spriteSourceSize:{x:-23,y:-53,w:86,h:78},sourceSize:{w:86,h:78}},{filename:"HustlerGraphics0031",frame:{x:2033,y:2728,w:46,h:56},rotated:!1,trimmed:!0,spriteSourceSize:{x:-23,y:-53,w:86,h:78},sourceSize:{w:86,h:78}},{filename:"HustlerGraphics0032",frame:{x:2082,y:2728,w:46,h:56},rotated:!1,trimmed:!0,spriteSourceSize:{x:-23,y:-53,w:86,h:78},sourceSize:{w:86,h:78}},{filename:"HustlerGraphics0033",frame:{x:2131,y:2728,w:46,h:56},rotated:!1,trimmed:!0,spriteSourceSize:{x:-23,y:-53,w:86,h:78},sourceSize:{w:86,h:78}},{filename:"HustlerGraphics0034",frame:{x:62,y:2729,w:46,h:56},rotated:!1,trimmed:!0,spriteSourceSize:{x:-23,y:-53,w:86,h:78},sourceSize:{w:86,h:78}},{filename:"HustlerGraphics0035",frame:{x:1222,y:2729,w:46,h:56},rotated:!1,trimmed:!0,spriteSourceSize:{x:-23,y:-53,w:86,h:78},sourceSize:{w:86,h:78}},{filename:"HustlerGraphics0036",frame:{x:2690,y:2729,w:46,h:56},rotated:!1,trimmed:!0,spriteSourceSize:{x:-23,y:-53,w:86,h:78},sourceSize:{w:86,h:78}},{filename:"HustlerGraphics0037",frame:{x:2265,y:2725,w:46,h:56},rotated:!1,trimmed:!0,spriteSourceSize:{x:-23,y:-53,w:86,h:78},sourceSize:{w:86,h:78}},{filename:"HustlerGraphics0038",frame:{x:977,y:2076,w:56,h:44},rotated:!1,trimmed:!0,spriteSourceSize:{x:-28,y:-40,w:86,h:78},sourceSize:{w:86,h:78}},{filename:"HustlerGraphics0039",frame:{x:2647,y:2115,w:56,h:44},rotated:!1,trimmed:!0,spriteSourceSize:{x:-28,y:-40,w:86,h:78},sourceSize:{w:86,h:78}},{filename:"HustlerGraphics0040",frame:{x:1484,y:2171,w:56,h:44},rotated:!1,trimmed:!0,spriteSourceSize:{x:-28,y:-40,w:86,h:78},sourceSize:{w:86,h:78}},{filename:"HustlerGraphics0041",frame:{x:1151,y:2172,w:56,h:44},rotated:!1,trimmed:!0,spriteSourceSize:{x:-28,y:-40,w:86,h:78},sourceSize:{w:86,h:78}},{filename:"HustlerGraphics0042",frame:{x:2550,y:2235,w:56,h:44},rotated:!1,trimmed:!0,spriteSourceSize:{x:-28,y:-40,w:86,h:78},sourceSize:{w:86,h:78}},{filename:"HustlerGraphics0043",frame:{x:2488,y:2306,w:56,h:44},rotated:!1,trimmed:!0,spriteSourceSize:{x:-28,y:-40,w:86,h:78},sourceSize:{w:86,h:78}},{filename:"HustlerGraphics0044",frame:{x:4037,y:2477,w:56,h:44},rotated:!1,trimmed:!0,spriteSourceSize:{x:-28,y:-40,w:86,h:78},sourceSize:{w:86,h:78}},{filename:"HustlerGraphics0045",frame:{x:2934,y:2729,w:56,h:44},rotated:!1,trimmed:!0,spriteSourceSize:{x:-28,y:-40,w:86,h:78},sourceSize:{w:86,h:78}},{filename:"HustlerGraphics0046",frame:{x:111,y:2731,w:56,h:44},rotated:!1,trimmed:!0,spriteSourceSize:{x:-28,y:-40,w:86,h:78},sourceSize:{w:86,h:78}},{filename:"HustlerGraphics0047",frame:{x:1939,y:2731,w:56,h:44},rotated:!1,trimmed:!0,spriteSourceSize:{x:-28,y:-40,w:86,h:78},sourceSize:{w:86,h:78}},{filename:"HustlerGraphics0048",frame:{x:2180,y:2731,w:56,h:44},rotated:!1,trimmed:!0,spriteSourceSize:{x:-28,y:-40,w:86,h:78},sourceSize:{w:86,h:78}},{filename:"HustlerGraphics0049",frame:{x:1809,y:2737,w:56,h:44},rotated:!1,trimmed:!0,spriteSourceSize:{x:-28,y:-40,w:86,h:78},sourceSize:{w:86,h:78}},{filename:"HustlerGraphics0050",frame:{x:1868,y:2737,w:56,h:44},rotated:!1,trimmed:!0,spriteSourceSize:{x:-28,y:-40,w:86,h:78},sourceSize:{w:86,h:78}},{filename:"HustlerGraphics0051",frame:{x:3,y:2738,w:56,h:44},rotated:!1,trimmed:!0,spriteSourceSize:{x:-28,y:-40,w:86,h:78},sourceSize:{w:86,h:78}},{filename:"HustlerGraphics0052",frame:{x:394,y:2738,w:56,h:44},rotated:!1,trimmed:!0,spriteSourceSize:{x:-28,y:-40,w:86,h:78},sourceSize:{w:86,h:78}},{filename:"HustlerGraphics0053",frame:{x:562,y:2738,w:56,h:44},rotated:!1,trimmed:!0,spriteSourceSize:{x:-28,y:-40,w:86,h:78},sourceSize:{w:86,h:78}},{filename:"HustlerGraphics0054",frame:{x:621,y:2738,w:56,h:44},rotated:!1,trimmed:!0,spriteSourceSize:{x:-28,y:-40,w:86,h:78},sourceSize:{w:86,h:78}},{filename:"HustlerGraphics0055",frame:{x:680,y:2738,w:56,h:44},rotated:!1,trimmed:!0,spriteSourceSize:{x:-28,y:-40,w:86,h:78},sourceSize:{w:86,h:78}},{filename:"HustlerGraphics0056",frame:{x:977,y:2076,w:56,h:44},rotated:!1,trimmed:!0,spriteSourceSize:{x:-28,y:-40,w:86,h:78},sourceSize:{w:86,h:78}},{filename:"HustlerGraphics0057",frame:{x:2647,y:2115,w:56,h:44},rotated:!1,trimmed:!0,spriteSourceSize:{x:-28,y:-40,w:86,h:78},sourceSize:{w:86,h:78}},{filename:"HustlerGraphics0058",frame:{x:1484,y:2171,w:56,h:44},rotated:!1,trimmed:!0,spriteSourceSize:{x:-28,y:-40,w:86,h:78},sourceSize:{w:86,h:78}},{filename:"HustlerGraphics0059",frame:{x:1151,y:2172,w:56,h:44},rotated:!1,trimmed:!0,spriteSourceSize:{x:-28,y:-40,w:86,h:78},sourceSize:{w:86,h:78}},{filename:"HustlerGraphics0060",frame:{x:2550,y:2235,w:56,h:44},rotated:!1,trimmed:!0,spriteSourceSize:{x:-28,y:-40,w:86,h:78},sourceSize:{w:86,h:78}},{filename:"HustlerGraphics0061",frame:{x:2488,y:2306,w:56,h:44},rotated:!1,trimmed:!0,spriteSourceSize:{x:-28,y:-40,w:86,h:78},sourceSize:{w:86,h:78}},{filename:"HustlerGraphics0062",frame:{x:4037,y:2477,w:56,h:44},rotated:!1,trimmed:!0,spriteSourceSize:{x:-28,y:-40,w:86,h:78},sourceSize:{w:86,h:78}},{filename:"HustlerGraphics0063",frame:{x:2934,y:2729,w:56,h:44},rotated:!1,trimmed:!0,spriteSourceSize:{x:-28,y:-40,w:86,h:78},sourceSize:{w:86,h:78}},{filename:"HustlerGraphics0064",frame:{x:111,y:2731,w:56,h:44},rotated:!1,trimmed:!0,spriteSourceSize:{x:-28,y:-40,w:86,h:78},sourceSize:{w:86,h:78}},{filename:"HustlerGraphics0065",frame:{x:1939,y:2731,w:56,h:44},rotated:!1,trimmed:!0,spriteSourceSize:{x:-28,y:-40,w:86,h:78},sourceSize:{w:86,h:78}},{filename:"HustlerGraphics0066",frame:{x:2180,y:2731,w:56,h:44},rotated:!1,trimmed:!0,spriteSourceSize:{x:-28,y:-40,w:86,h:78},sourceSize:{w:86,h:78}},{filename:"HustlerGraphics0067",frame:{x:1809,y:2737,w:56,h:44},rotated:!1,trimmed:!0,spriteSourceSize:{x:-28,y:-40,w:86,h:78},sourceSize:{w:86,h:78}},{filename:"HustlerGraphics0068",frame:{x:1868,y:2737,w:56,h:44},rotated:!1,trimmed:!0,spriteSourceSize:{x:-28,y:-40,w:86,h:78},sourceSize:{w:86,h:78}},{filename:"HustlerGraphics0069",frame:{x:3,y:2738,w:56,h:44},rotated:!1,trimmed:!0,spriteSourceSize:{x:-28,y:-40,w:86,h:78},sourceSize:{w:86,h:78}},{filename:"HustlerGraphics0070",frame:{x:394,y:2738,w:56,h:44},rotated:!1,trimmed:!0,spriteSourceSize:{x:-28,y:-40,w:86,h:78},sourceSize:{w:86,h:78}},{filename:"HustlerGraphics0071",frame:{x:562,y:2738,w:56,h:44},rotated:!1,trimmed:!0,spriteSourceSize:{x:-28,y:-40,w:86,h:78},sourceSize:{w:86,h:78}},{filename:"HustlerGraphics0072",frame:{x:621,y:2738,w:56,h:44},rotated:!1,trimmed:!0,spriteSourceSize:{x:-28,y:-40,w:86,h:78},sourceSize:{w:86,h:78}},{filename:"HustlerGraphics0073",frame:{x:680,y:2738,w:56,h:44},rotated:!1,trimmed:!0,spriteSourceSize:{x:-28,y:-40,w:86,h:78},sourceSize:{w:86,h:78}},{filename:"HustlerGraphics0074",frame:{x:977,y:2076,w:56,h:44},rotated:!1,trimmed:!0,spriteSourceSize:{x:-28,y:-40,w:86,h:78},sourceSize:{w:86,h:78}},{filename:"HustlerGraphics0075",frame:{x:2647,y:2115,w:56,h:44},rotated:!1,trimmed:!0,spriteSourceSize:{x:-28,y:-40,w:86,h:78},sourceSize:{w:86,h:78}},{filename:"HustlerGraphics0076",frame:{x:1484,y:2171,w:56,h:44},rotated:!1,trimmed:!0,spriteSourceSize:{x:-28,y:-40,w:86,h:78},sourceSize:{w:86,h:78}},{filename:"HustlerGraphics0077",frame:{x:1151,y:2172,w:56,h:44},rotated:!1,trimmed:!0,spriteSourceSize:{x:-28,y:-40,w:86,h:78},sourceSize:{w:86,h:78}},{filename:"HustlerGraphics0078",frame:{x:2550,y:2235,w:56,h:44},rotated:!1,trimmed:!0,spriteSourceSize:{x:-28,y:-40,w:86,h:78},sourceSize:{w:86,h:78}},{filename:"HustlerGraphics0079",frame:{x:2488,y:2306,w:56,h:44},rotated:!1,trimmed:!0,spriteSourceSize:{x:-28,y:-40,w:86,h:78},sourceSize:{w:86,h:78}},{filename:"HustlerGraphics0080",frame:{x:1303,y:1126,w:56,h:62},rotated:!1,trimmed:!0,spriteSourceSize:{x:-28,y:-57,w:86,h:78},sourceSize:{w:86,h:78}},{filename:"HustlerGraphics0081",frame:{x:4034,y:1425,w:56,h:62},rotated:!1,trimmed:!0,spriteSourceSize:{x:-28,y:-57,w:86,h:78},sourceSize:{w:86,h:78}},{filename:"HustlerGraphics0082",frame:{x:3067,y:1625,w:56,h:62},rotated:!1,trimmed:!0,spriteSourceSize:{x:-28,y:-57,w:86,h:78},sourceSize:{w:86,h:78}},{filename:"HustlerGraphics0083",frame:{x:4034,y:1796,w:56,h:62},rotated:!1,trimmed:!0,spriteSourceSize:{x:-28,y:-57,w:86,h:78},sourceSize:{w:86,h:78}},{filename:"HustlerGraphics0084",frame:{x:4037,y:2412,w:56,h:62},rotated:!1,trimmed:!0,spriteSourceSize:{x:-28,y:-57,w:86,h:78},sourceSize:{w:86,h:78}},{filename:"HustlerGraphics0085",frame:{x:226,y:2557,w:56,h:62},rotated:!1,trimmed:!0,spriteSourceSize:{x:-28,y:-57,w:86,h:78},sourceSize:{w:86,h:78}},{filename:"HustlerGraphics0086",frame:{x:964,y:2558,w:56,h:62},rotated:!1,trimmed:!0,spriteSourceSize:{x:-28,y:-57,w:86,h:78},sourceSize:{w:86,h:78}},{filename:"HustlerGraphics0087",frame:{x:2101,y:2558,w:56,h:62},rotated:!1,trimmed:!0,spriteSourceSize:{x:-28,y:-57,w:86,h:78},sourceSize:{w:86,h:78}},{filename:"HustlerGraphics0088",frame:{x:2160,y:2558,w:56,h:62},rotated:!1,trimmed:!0,spriteSourceSize:{x:-28,y:-57,w:86,h:78},sourceSize:{w:86,h:78}},{filename:"HustlerGraphics0089",frame:{x:2219,y:2558,w:56,h:62},rotated:!1,trimmed:!0,spriteSourceSize:{x:-28,y:-57,w:86,h:78},sourceSize:{w:86,h:78}},{filename:"HustlerGraphics0090",frame:{x:2278,y:2561,w:56,h:62},rotated:!1,trimmed:!0,spriteSourceSize:{x:-28,y:-57,w:86,h:78},sourceSize:{w:86,h:78}},{filename:"HustlerGraphics0091",frame:{x:1845,y:2567,w:56,h:62},rotated:!1,trimmed:!0,spriteSourceSize:{x:-28,y:-57,w:86,h:78},sourceSize:{w:86,h:78}},{filename:"HustlerGraphics0092",frame:{x:1904,y:2567,w:56,h:62},rotated:!1,trimmed:!0,spriteSourceSize:{x:-28,y:-57,w:86,h:78},sourceSize:{w:86,h:78}},{filename:"HustlerGraphics0093",frame:{x:1963,y:2567,w:56,h:62},rotated:!1,trimmed:!0,spriteSourceSize:{x:-28,y:-57,w:86,h:78},sourceSize:{w:86,h:78}},{filename:"HustlerGraphics0094",frame:{x:433,y:2568,w:56,h:62},rotated:!1,trimmed:!0,spriteSourceSize:{x:-28,y:-57,w:86,h:78},sourceSize:{w:86,h:78}},{filename:"HustlerGraphics0095",frame:{x:492,y:2568,w:56,h:62},rotated:!1,trimmed:!0,spriteSourceSize:{x:-28,y:-57,w:86,h:78},sourceSize:{w:86,h:78}},{filename:"HustlerGraphics0096",frame:{x:3,y:2569,w:56,h:62},rotated:!1,trimmed:!0,spriteSourceSize:{x:-28,y:-57,w:86,h:78},sourceSize:{w:86,h:78}},{filename:"HustlerGraphics0097",frame:{x:62,y:2569,w:56,h:62},rotated:!1,trimmed:!0,spriteSourceSize:{x:-28,y:-57,w:86,h:78},sourceSize:{w:86,h:78}},{filename:"HustlerGraphics0098",frame:{x:647,y:2569,w:56,h:62},rotated:!1,trimmed:!0,spriteSourceSize:{x:-28,y:-57,w:86,h:78},sourceSize:{w:86,h:78}},{filename:"HustlerGraphics0099",frame:{x:706,y:2569,w:56,h:62},rotated:!1,trimmed:!0,spriteSourceSize:{x:-28,y:-57,w:86,h:78},sourceSize:{w:86,h:78}},{filename:"HustlerGraphics0100",frame:{x:285,y:2574,w:56,h:62},rotated:!1,trimmed:!0,spriteSourceSize:{x:-28,y:-57,w:86,h:78},sourceSize:{w:86,h:78}},{filename:"HustlerGraphics0101",frame:{x:3417,y:2579,w:56,h:62},rotated:!1,trimmed:!0,spriteSourceSize:{x:-28,y:-57,w:86,h:78},sourceSize:{w:86,h:78}},{filename:"HustlerGraphics0102",frame:{x:3045,y:2580,w:56,h:62},rotated:!1,trimmed:!0,spriteSourceSize:{x:-28,y:-57,w:86,h:78},sourceSize:{w:86,h:78}},{filename:"HustlerGraphics0103",frame:{x:3104,y:2580,w:56,h:62},rotated:!1,trimmed:!0,spriteSourceSize:{x:-28,y:-57,w:86,h:78},sourceSize:{w:86,h:78}},{filename:"HustlerGraphics0104",frame:{x:3163,y:2580,w:56,h:62},rotated:!1,trimmed:!0,spriteSourceSize:{x:-28,y:-57,w:86,h:78},sourceSize:{w:86,h:78}},{filename:"HustlerGraphics0105",frame:{x:765,y:2581,w:56,h:62},rotated:!1,trimmed:!0,spriteSourceSize:{x:-28,y:-57,w:86,h:78},sourceSize:{w:86,h:78}},{filename:"HustlerGraphics0106",frame:{x:824,y:2581,w:56,h:62},rotated:!1,trimmed:!0,spriteSourceSize:{x:-28,y:-57,w:86,h:78},sourceSize:{w:86,h:78}},{filename:"HustlerGraphics0107",frame:{x:551,y:2582,w:56,h:62},rotated:!1,trimmed:!0,spriteSourceSize:{x:-28,y:-57,w:86,h:78},sourceSize:{w:86,h:78}},{filename:"HustlerGraphics0108",frame:{x:3756,y:2582,w:56,h:62},rotated:!1,trimmed:!0,spriteSourceSize:{x:-28,y:-57,w:86,h:78},sourceSize:{w:86,h:78}},{filename:"HustlerGraphics0109",frame:{x:3815,y:2582,w:56,h:62},rotated:!1,trimmed:!0,spriteSourceSize:{x:-28,y:-57,w:86,h:78},sourceSize:{w:86,h:78}},{filename:"HustlerGraphics0110",frame:{x:3874,y:2582,w:56,h:62},rotated:!1,trimmed:!0,spriteSourceSize:{x:-28,y:-57,w:86,h:78},sourceSize:{w:86,h:78}},{filename:"HustlerGraphics0111",frame:{x:3933,y:2582,w:56,h:62},rotated:!1,trimmed:!0,spriteSourceSize:{x:-28,y:-57,w:86,h:78},sourceSize:{w:86,h:78}},{filename:"HustlerGraphics0112",frame:{x:1582,y:2584,w:56,h:62},rotated:!1,trimmed:!0,spriteSourceSize:{x:-28,y:-57,w:86,h:78},sourceSize:{w:86,h:78}},{filename:"HustlerGraphics0113",frame:{x:1641,y:2584,w:56,h:62},rotated:!1,trimmed:!0,spriteSourceSize:{x:-28,y:-57,w:86,h:78},sourceSize:{w:86,h:78}},{filename:"HustlerGraphics0114",frame:{x:1700,y:2584,w:56,h:62},rotated:!1,trimmed:!0,spriteSourceSize:{x:-28,y:-57,w:86,h:78},sourceSize:{w:86,h:78}},{filename:"HustlerGraphics0115",frame:{x:1023,y:2588,w:56,h:62},rotated:!1,trimmed:!0,spriteSourceSize:{x:-28,y:-57,w:86,h:78},sourceSize:{w:86,h:78}},{filename:"HustlerGraphics0116",frame:{x:3992,y:2588,w:56,h:62},rotated:!1,trimmed:!0,spriteSourceSize:{x:-28,y:-57,w:86,h:78},sourceSize:{w:86,h:78}},{filename:"HustlerGraphics0117",frame:{x:1082,y:2589,w:56,h:62},rotated:!1,trimmed:!0,spriteSourceSize:{x:-28,y:-57,w:86,h:78},sourceSize:{w:86,h:78}},{filename:"HustlerGraphics0118",frame:{x:1141,y:2589,w:56,h:62},rotated:!1,trimmed:!0,spriteSourceSize:{x:-28,y:-57,w:86,h:78},sourceSize:{w:86,h:78}},{filename:"HustlerGraphics0119",frame:{x:1200,y:2589,w:56,h:62},rotated:!1,trimmed:!0,spriteSourceSize:{x:-28,y:-57,w:86,h:78},sourceSize:{w:86,h:78}},{filename:"HustlerGraphics0120",frame:{x:883,y:2590,w:56,h:62},rotated:!1,trimmed:!0,spriteSourceSize:{x:-28,y:-57,w:86,h:78},sourceSize:{w:86,h:78}},{filename:"HustlerGraphics0121",frame:{x:1259,y:2600,w:56,h:62},rotated:!1,trimmed:!0,spriteSourceSize:{x:-28,y:-57,w:86,h:78},sourceSize:{w:86,h:78}},{filename:"HustlerGraphics0122",frame:{x:3476,y:2600,w:56,h:62},rotated:!1,trimmed:!0,spriteSourceSize:{x:-28,y:-57,w:86,h:78},sourceSize:{w:86,h:78}},{filename:"HustlerGraphics0123",frame:{x:3535,y:2600,w:56,h:62},rotated:!1,trimmed:!0,spriteSourceSize:{x:-28,y:-57,w:86,h:78},sourceSize:{w:86,h:78}},{filename:"HustlerGraphics0124",frame:{x:3594,y:2600,w:56,h:62},rotated:!1,trimmed:!0,spriteSourceSize:{x:-28,y:-57,w:86,h:78},sourceSize:{w:86,h:78}},{filename:"HustlerGraphics0125",frame:{x:2022,y:2602,w:56,h:62},rotated:!1,trimmed:!0,spriteSourceSize:{x:-28,y:-57,w:86,h:78},sourceSize:{w:86,h:78}},{filename:"HustlerGraphics0126",frame:{x:2506,y:2602,w:56,h:62},rotated:!1,trimmed:!0,spriteSourceSize:{x:-28,y:-57,w:86,h:78},sourceSize:{w:86,h:78}},{filename:"HustlerGraphics0127",frame:{x:2565,y:2602,w:56,h:62},rotated:!1,trimmed:!0,spriteSourceSize:{x:-28,y:-57,w:86,h:78},sourceSize:{w:86,h:78}},{filename:"HustlerGraphics0128",frame:{x:1318,y:2604,w:56,h:62},rotated:!1,trimmed:!0,spriteSourceSize:{x:-28,y:-57,w:86,h:78},sourceSize:{w:86,h:78}},{filename:"HustlerGraphics0129",frame:{x:1377,y:2604,w:56,h:62},rotated:!1,trimmed:!0,spriteSourceSize:{x:-28,y:-57,w:86,h:78},sourceSize:{w:86,h:78}},{filename:"HustlerGraphics0130",frame:{x:1436,y:2604,w:56,h:62},rotated:!1,trimmed:!0,spriteSourceSize:{x:-28,y:-57,w:86,h:78},sourceSize:{w:86,h:78}},{filename:"HustlerGraphics0131",frame:{x:2337,y:2605,w:56,h:62},rotated:!1,trimmed:!0,spriteSourceSize:{x:-28,y:-57,w:86,h:78},sourceSize:{w:86,h:78}},{filename:"HustlerGraphics0132",frame:{x:1092,y:1024,w:71,h:70},rotated:!1,trimmed:!0,spriteSourceSize:{x:-25,y:-62,w:86,h:78},sourceSize:{w:86,h:78}},{filename:"HustlerGraphics0133",frame:{x:2764,y:1334,w:71,h:70},rotated:!1,trimmed:!0,spriteSourceSize:{x:-25,y:-62,w:86,h:78},sourceSize:{w:86,h:78}},{filename:"HustlerGraphics0134",frame:{x:3320,y:2001,w:71,h:70},rotated:!1,trimmed:!0,spriteSourceSize:{x:-25,y:-62,w:86,h:78},sourceSize:{w:86,h:78}},{filename:"HustlerGraphics0135",frame:{x:3394,y:2001,w:71,h:70},rotated:!1,trimmed:!0,spriteSourceSize:{x:-25,y:-62,w:86,h:78},sourceSize:{w:86,h:78}},{filename:"HustlerGraphics0136",frame:{x:899,y:2003,w:71,h:70},rotated:!1,trimmed:!0,spriteSourceSize:{x:-25,y:-62,w:86,h:78},sourceSize:{w:86,h:78}},{filename:"HustlerGraphics0137",frame:{x:973,y:2003,w:71,h:70},rotated:!1,trimmed:!0,spriteSourceSize:{x:-25,y:-62,w:86,h:78},sourceSize:{w:86,h:78}},{filename:"HustlerGraphics0138",frame:{x:2936,y:2012,w:71,h:70},rotated:!1,trimmed:!0,spriteSourceSize:{x:-25,y:-62,w:86,h:78},sourceSize:{w:86,h:78}},{filename:"HustlerGraphics0139",frame:{x:3010,y:2012,w:71,h:70},rotated:!1,trimmed:!0,spriteSourceSize:{x:-25,y:-62,w:86,h:78},sourceSize:{w:86,h:78}},{filename:"HustlerGraphics0140",frame:{x:3872,y:2014,w:71,h:70},rotated:!1,trimmed:!0,spriteSourceSize:{x:-25,y:-62,w:86,h:78},sourceSize:{w:86,h:78}},{filename:"HustlerGraphics0141",frame:{x:3741,y:2016,w:71,h:70},rotated:!1,trimmed:!0,spriteSourceSize:{x:-25,y:-62,w:86,h:78},sourceSize:{w:86,h:78}},{filename:"HustlerGraphics0142",frame:{x:3946,y:2017,w:71,h:70},rotated:!1,trimmed:!0,spriteSourceSize:{x:-25,y:-62,w:86,h:78},sourceSize:{w:86,h:78}},{filename:"HustlerGraphics0143",frame:{x:1227,y:2019,w:71,h:70},rotated:!1,trimmed:!0,spriteSourceSize:{x:-25,y:-62,w:86,h:78},sourceSize:{w:86,h:78}},{filename:"HustlerGraphics0144",frame:{x:1859,y:2019,w:71,h:70},rotated:!1,trimmed:!0,spriteSourceSize:{x:-25,y:-62,w:86,h:78},sourceSize:{w:86,h:78}},{filename:"HustlerGraphics0145",frame:{x:1400,y:2024,w:71,h:70},rotated:!1,trimmed:!0,spriteSourceSize:{x:-25,y:-62,w:86,h:78},sourceSize:{w:86,h:78}},{filename:"HustlerGraphics0146",frame:{x:3629,y:2024,w:71,h:70},rotated:!1,trimmed:!0,spriteSourceSize:{x:-25,y:-62,w:86,h:78},sourceSize:{w:86,h:78}},{filename:"HustlerGraphics0147",frame:{x:81,y:2025,w:71,h:70},rotated:!1,trimmed:!0,spriteSourceSize:{x:-25,y:-62,w:86,h:78},sourceSize:{w:86,h:78}},{filename:"HustlerGraphics0148",frame:{x:155,y:2025,w:71,h:70},rotated:!1,trimmed:!0,spriteSourceSize:{x:-25,y:-62,w:86,h:78},sourceSize:{w:86,h:78}},{filename:"HustlerGraphics0149",frame:{x:2321,y:2026,w:71,h:70},rotated:!1,trimmed:!0,spriteSourceSize:{x:-25,y:-62,w:86,h:78},sourceSize:{w:86,h:78}},{filename:"HustlerGraphics0150",frame:{x:325,y:2027,w:71,h:70},rotated:!1,trimmed:!0,spriteSourceSize:{x:-25,y:-62,w:86,h:78},sourceSize:{w:86,h:78}},{filename:"HustlerGraphics0151",frame:{x:399,y:2027,w:71,h:70},rotated:!1,trimmed:!0,spriteSourceSize:{x:-25,y:-62,w:86,h:78},sourceSize:{w:86,h:78}},{filename:"HustlerGraphics0152",frame:{x:1602,y:2028,w:71,h:70},rotated:!1,trimmed:!0,spriteSourceSize:{x:-25,y:-62,w:86,h:78},sourceSize:{w:86,h:78}},{filename:"HustlerGraphics0153",frame:{x:1676,y:2028,w:71,h:70},rotated:!1,trimmed:!0,spriteSourceSize:{x:-25,y:-62,w:86,h:78},sourceSize:{w:86,h:78}},{filename:"HustlerGraphics0154",frame:{x:2737,y:2029,w:71,h:70},rotated:!1,trimmed:!0,spriteSourceSize:{x:-25,y:-62,w:86,h:78},sourceSize:{w:86,h:78}},{filename:"HustlerGraphics0155",frame:{x:3468,y:2030,w:71,h:70},rotated:!1,trimmed:!0,spriteSourceSize:{x:-25,y:-62,w:86,h:78},sourceSize:{w:86,h:78}},{filename:"HustlerGraphics0156",frame:{x:3542,y:2030,w:71,h:70},rotated:!1,trimmed:!0,spriteSourceSize:{x:-25,y:-62,w:86,h:78},sourceSize:{w:86,h:78}},{filename:"HustlerGraphics0157",frame:{x:1301,y:2031,w:71,h:70},rotated:!1,trimmed:!0,spriteSourceSize:{x:-25,y:-62,w:86,h:78},sourceSize:{w:86,h:78}},{filename:"HustlerGraphics0158",frame:{x:655,y:2033,w:71,h:70},rotated:!1,trimmed:!0,spriteSourceSize:{x:-25,y:-62,w:86,h:78},sourceSize:{w:86,h:78}},{filename:"HustlerGraphics0159",frame:{x:729,y:2033,w:71,h:70},rotated:!1,trimmed:!0,spriteSourceSize:{x:-25,y:-62,w:86,h:78},sourceSize:{w:86,h:78}},{filename:"HustlerGraphics0160",frame:{x:3084,y:2035,w:71,h:70},rotated:!1,trimmed:!0,spriteSourceSize:{x:-25,y:-62,w:86,h:78},sourceSize:{w:86,h:78}},{filename:"HustlerGraphics0161",frame:{x:2395,y:2036,w:71,h:70},rotated:!1,trimmed:!0,spriteSourceSize:{x:-25,y:-62,w:86,h:78},sourceSize:{w:86,h:78}},{filename:"HustlerGraphics0162",frame:{x:473,y:2038,w:71,h:70},rotated:!1,trimmed:!0,spriteSourceSize:{x:-25,y:-62,w:86,h:78},sourceSize:{w:86,h:78}},{filename:"HustlerGraphics0163",frame:{x:2811,y:2038,w:71,h:70},rotated:!1,trimmed:!0,spriteSourceSize:{x:-25,y:-62,w:86,h:78},sourceSize:{w:86,h:78}},{filename:"HustlerGraphics0164",frame:{x:2642,y:2042,w:71,h:70},rotated:!1,trimmed:!0,spriteSourceSize:{x:-25,y:-62,w:86,h:78},sourceSize:{w:86,h:78}},{filename:"HustlerGraphics0165",frame:{x:4039,y:1314,w:50,h:62},rotated:!1,trimmed:!0,spriteSourceSize:{x:-24,y:-55,w:86,h:78},sourceSize:{w:86,h:78}},{filename:"HustlerGraphics0166",frame:{x:2085,y:1522,w:50,h:62},rotated:!1,trimmed:!0,spriteSourceSize:{x:-24,y:-55,w:86,h:78},sourceSize:{w:86,h:78}},{filename:"HustlerGraphics0167",frame:{x:3673,y:1599,w:50,h:62},rotated:!1,trimmed:!0,spriteSourceSize:{x:-24,y:-55,w:86,h:78},sourceSize:{w:86,h:78}},{filename:"HustlerGraphics0168",frame:{x:2302,y:1723,w:50,h:62},rotated:!1,trimmed:!0,spriteSourceSize:{x:-24,y:-55,w:86,h:78},sourceSize:{w:86,h:78}},{filename:"HustlerGraphics0169",frame:{x:3741,y:1951,w:50,h:62},rotated:!1,trimmed:!0,spriteSourceSize:{x:-24,y:-55,w:86,h:78},sourceSize:{w:86,h:78}},{filename:"HustlerGraphics0170",frame:{x:3815,y:2016,w:50,h:62},rotated:!1,trimmed:!0,spriteSourceSize:{x:-24,y:-55,w:86,h:78},sourceSize:{w:86,h:78}},{filename:"HustlerGraphics0171",frame:{x:4023,y:2653,w:50,h:62},rotated:!1,trimmed:!0,spriteSourceSize:{x:-24,y:-55,w:86,h:78},sourceSize:{w:86,h:78}},{filename:"HustlerGraphics0172",frame:{x:832,y:2655,w:50,h:62},rotated:!1,trimmed:!0,spriteSourceSize:{x:-24,y:-55,w:86,h:78},sourceSize:{w:86,h:78}},{filename:"HustlerGraphics0173",frame:{x:885,y:2655,w:50,h:62},rotated:!1,trimmed:!0,spriteSourceSize:{x:-24,y:-55,w:86,h:78},sourceSize:{w:86,h:78}},{filename:"HustlerGraphics0174",frame:{x:3653,y:2655,w:50,h:62},rotated:!1,trimmed:!0,spriteSourceSize:{x:-24,y:-55,w:86,h:78},sourceSize:{w:86,h:78}},{filename:"HustlerGraphics0175",frame:{x:3653,y:2655,w:50,h:62},rotated:!1,trimmed:!0,spriteSourceSize:{x:-24,y:-55,w:86,h:78},sourceSize:{w:86,h:78}},{filename:"HustlerGraphics0176",frame:{x:2846,y:2657,w:50,h:62},rotated:!1,trimmed:!0,spriteSourceSize:{x:-24,y:-55,w:86,h:78},sourceSize:{w:86,h:78}},{filename:"HustlerGraphics0177",frame:{x:2899,y:2657,w:50,h:62},rotated:!1,trimmed:!0,spriteSourceSize:{x:-24,y:-55,w:86,h:78},sourceSize:{w:86,h:78}},{filename:"HustlerGraphics0178",frame:{x:3296,y:2657,w:50,h:62},rotated:!1,trimmed:!0,spriteSourceSize:{x:-24,y:-55,w:86,h:78},sourceSize:{w:86,h:78}},{filename:"HustlerGraphics0179",frame:{x:3349,y:2657,w:50,h:62},rotated:!1,trimmed:!0,spriteSourceSize:{x:-24,y:-55,w:86,h:78},sourceSize:{w:86,h:78}},{filename:"HustlerGraphics0180",frame:{x:343,y:2660,w:50,h:62},rotated:!1,trimmed:!0,spriteSourceSize:{x:-24,y:-55,w:86,h:78},sourceSize:{w:86,h:78}},{filename:"HustlerGraphics0181",frame:{x:1717,y:2660,w:50,h:62},rotated:!1,trimmed:!0,spriteSourceSize:{x:-24,y:-55,w:86,h:78},sourceSize:{w:86,h:78}},{filename:"HustlerGraphics0182",frame:{x:1770,y:2660,w:50,h:62},rotated:!1,trimmed:!0,spriteSourceSize:{x:-24,y:-55,w:86,h:78},sourceSize:{w:86,h:78}},{filename:"HustlerGraphics0183",frame:{x:1495,y:2662,w:50,h:62},rotated:!1,trimmed:!0,spriteSourceSize:{x:-24,y:-55,w:86,h:78},sourceSize:{w:86,h:78}},{filename:"HustlerGraphics0184",frame:{x:2624,y:2662,w:50,h:62},rotated:!1,trimmed:!0,spriteSourceSize:{x:-24,y:-55,w:86,h:78},sourceSize:{w:86,h:78}},{filename:"HustlerGraphics0185",frame:{x:2677,y:2662,w:50,h:62},rotated:!1,trimmed:!0,spriteSourceSize:{x:-24,y:-55,w:86,h:78},sourceSize:{w:86,h:78}},{filename:"HustlerGraphics0186",frame:{x:2730,y:2664,w:50,h:62},rotated:!1,trimmed:!0,spriteSourceSize:{x:-24,y:-55,w:86,h:78},sourceSize:{w:86,h:78}},{filename:"HustlerGraphics0187",frame:{x:2783,y:2664,w:50,h:62},rotated:!1,trimmed:!0,spriteSourceSize:{x:-24,y:-55,w:86,h:78},sourceSize:{w:86,h:78}},{filename:"HustlerGraphics0188",frame:{x:2952,y:2664,w:50,h:62},rotated:!1,trimmed:!0,spriteSourceSize:{x:-24,y:-55,w:86,h:78},sourceSize:{w:86,h:78}},{filename:"HustlerGraphics0189",frame:{x:1271,y:1791,w:84,h:78},rotated:!1,trimmed:!0,spriteSourceSize:{x:-29,y:-70,w:86,h:78},sourceSize:{w:86,h:78}},{filename:"HustlerGraphics0190",frame:{x:1945,y:1791,w:84,h:78},rotated:!1,trimmed:!0,spriteSourceSize:{x:-29,y:-70,w:86,h:78},sourceSize:{w:86,h:78}},{filename:"HustlerGraphics0191",frame:{x:3063,y:1791,w:84,h:78},rotated:!1,trimmed:!0,spriteSourceSize:{x:-29,y:-70,w:86,h:78},sourceSize:{w:86,h:78}},{filename:"HustlerGraphics0192",frame:{x:1177,y:1794,w:84,h:78},rotated:!1,trimmed:!0,spriteSourceSize:{x:-29,y:-70,w:86,h:78},sourceSize:{w:86,h:78}},{filename:"HustlerGraphics0193",frame:{x:1065,y:1796,w:84,h:78},rotated:!1,trimmed:!0,spriteSourceSize:{x:-29,y:-70,w:86,h:78},sourceSize:{w:86,h:78}},{filename:"HustlerGraphics0194",frame:{x:3947,y:1796,w:84,h:78},rotated:!1,trimmed:!0,spriteSourceSize:{x:-29,y:-70,w:86,h:78},sourceSize:{w:86,h:78}},{filename:"HustlerGraphics0195",frame:{x:1461,y:1798,w:84,h:78},rotated:!1,trimmed:!0,spriteSourceSize:{x:-29,y:-70,w:86,h:78},sourceSize:{w:86,h:78}},{filename:"HustlerGraphics0196",frame:{x:3736,y:1798,w:84,h:78},rotated:!1,trimmed:!0,spriteSourceSize:{x:-29,y:-70,w:86,h:78},sourceSize:{w:86,h:78}},{filename:"HustlerGraphics0197",frame:{x:163,y:1799,w:84,h:78},rotated:!1,trimmed:!0,spriteSourceSize:{x:-29,y:-70,w:86,h:78},sourceSize:{w:86,h:78}},{filename:"HustlerGraphics0198",frame:{x:2427,y:1800,w:84,h:78},rotated:!1,trimmed:!0,spriteSourceSize:{x:-29,y:-70,w:86,h:78},sourceSize:{w:86,h:78}},{filename:"HustlerGraphics0199",frame:{x:2864,y:1803,w:84,h:78},rotated:!1,trimmed:!0,spriteSourceSize:{x:-29,y:-70,w:86,h:78},sourceSize:{w:86,h:78}},{filename:"HustlerGraphics0200",frame:{x:714,y:1807,w:84,h:78},rotated:!1,trimmed:!0,spriteSourceSize:{x:-29,y:-70,w:86,h:78},sourceSize:{w:86,h:78}},{filename:"HustlerGraphics0201",frame:{x:2514,y:1808,w:84,h:78},rotated:!1,trimmed:!0,spriteSourceSize:{x:-29,y:-70,w:86,h:78},sourceSize:{w:86,h:78}},{filename:"HustlerGraphics0202",frame:{x:2951,y:1810,w:84,h:78},rotated:!1,trimmed:!0,spriteSourceSize:{x:-29,y:-70,w:86,h:78},sourceSize:{w:86,h:78}},{filename:"HustlerGraphics0203",frame:{x:1277,y:2532,w:58,h:65},rotated:!1,trimmed:!0,spriteSourceSize:{x:-29,y:-57,w:86,h:78},sourceSize:{w:86,h:78}},{filename:"HustlerGraphics0204",frame:{x:3512,y:2532,w:58,h:65},rotated:!1,trimmed:!0,spriteSourceSize:{x:-29,y:-57,w:86,h:78},sourceSize:{w:86,h:78}},{filename:"HustlerGraphics0205",frame:{x:3573,y:2532,w:58,h:65},rotated:!1,trimmed:!0,spriteSourceSize:{x:-29,y:-57,w:86,h:78},sourceSize:{w:86,h:78}},{filename:"HustlerGraphics0206",frame:{x:3634,y:2532,w:58,h:65},rotated:!1,trimmed:!0,spriteSourceSize:{x:-29,y:-57,w:86,h:78},sourceSize:{w:86,h:78}},{filename:"HustlerGraphics0207",frame:{x:2040,y:2534,w:58,h:65},rotated:!1,trimmed:!0,spriteSourceSize:{x:-29,y:-57,w:86,h:78},sourceSize:{w:86,h:78}},{filename:"HustlerGraphics0208",frame:{x:2515,y:2534,w:58,h:65},rotated:!1,trimmed:!0,spriteSourceSize:{x:-29,y:-57,w:86,h:78},sourceSize:{w:86,h:78}},{filename:"HustlerGraphics0209",frame:{x:2576,y:2534,w:58,h:65},rotated:!1,trimmed:!0,spriteSourceSize:{x:-29,y:-57,w:86,h:78},sourceSize:{w:86,h:78}},{filename:"HustlerGraphics0210",frame:{x:1338,y:2536,w:58,h:65},rotated:!1,trimmed:!0,spriteSourceSize:{x:-29,y:-57,w:86,h:78},sourceSize:{w:86,h:78}},{filename:"HustlerGraphics0211",frame:{x:1399,y:2536,w:58,h:65},rotated:!1,trimmed:!0,spriteSourceSize:{x:-29,y:-57,w:86,h:78},sourceSize:{w:86,h:78}},{filename:"HustlerGraphics0212",frame:{x:1460,y:2536,w:58,h:65},rotated:!1,trimmed:!0,spriteSourceSize:{x:-29,y:-57,w:86,h:78},sourceSize:{w:86,h:78}},{filename:"HustlerGraphics0213",frame:{x:2384,y:2537,w:58,h:65},rotated:!1,trimmed:!0,spriteSourceSize:{x:-29,y:-57,w:86,h:78},sourceSize:{w:86,h:78}},{filename:"HustlerGraphics0214",frame:{x:2445,y:2537,w:58,h:65},rotated:!1,trimmed:!0,spriteSourceSize:{x:-29,y:-57,w:86,h:78},sourceSize:{w:86,h:78}},{filename:"HustlerGraphics0215",frame:{x:3695,y:2537,w:58,h:65},rotated:!1,trimmed:!0,spriteSourceSize:{x:-29,y:-57,w:86,h:78},sourceSize:{w:86,h:78}},{filename:"HustlerGraphics0216",frame:{x:2919,y:2539,w:58,h:65},rotated:!1,trimmed:!0,spriteSourceSize:{x:-29,y:-57,w:86,h:78},sourceSize:{w:86,h:78}},{filename:"HustlerGraphics0217",frame:{x:3234,y:2539,w:58,h:65},rotated:!1,trimmed:!0,spriteSourceSize:{x:-29,y:-57,w:86,h:78},sourceSize:{w:86,h:78}},{filename:"HustlerGraphics0218",frame:{x:3295,y:2539,w:58,h:65},rotated:!1,trimmed:!0,spriteSourceSize:{x:-29,y:-57,w:86,h:78},sourceSize:{w:86,h:78}},{filename:"HustlerGraphics0219",frame:{x:3356,y:2539,w:58,h:65},rotated:!1,trimmed:!0,spriteSourceSize:{x:-29,y:-57,w:86,h:78},sourceSize:{w:86,h:78}},{filename:"HustlerGraphics0220",frame:{x:3356,y:2539,w:58,h:65},rotated:!1,trimmed:!0,spriteSourceSize:{x:-29,y:-57,w:86,h:78},sourceSize:{w:86,h:78}},{filename:"HustlerGraphics0221",frame:{x:3356,y:2539,w:58,h:65},rotated:!1,trimmed:!0,spriteSourceSize:{x:-29,y:-57,w:86,h:78},sourceSize:{w:86,h:78}},{filename:"HustlerGraphics0222",frame:{x:3356,y:2539,w:58,h:65},rotated:!1,trimmed:!0,spriteSourceSize:{x:-29,y:-57,w:86,h:78},sourceSize:{w:86,h:78}},{filename:"HustlerGraphics0223",frame:{x:3356,y:2539,w:58,h:65},rotated:!1,trimmed:!0,spriteSourceSize:{x:-29,y:-57,w:86,h:78},sourceSize:{w:86,h:78}},{filename:"HustlerGraphics0224",frame:{x:3356,y:2539,w:58,h:65},rotated:!1,trimmed:!0,spriteSourceSize:{x:-29,y:-57,w:86,h:78},sourceSize:{w:86,h:78}},{filename:"HustlerGraphics0225",frame:{x:3356,y:2539,w:58,h:65},rotated:!1,trimmed:!0,spriteSourceSize:{x:-29,y:-57,w:86,h:78},sourceSize:{w:86,h:78}},{filename:"HustlerGraphics0226",frame:{x:3356,y:2539,w:58,h:65},rotated:!1,trimmed:!0,spriteSourceSize:{x:-29,y:-57,w:86,h:78},sourceSize:{w:86,h:78}},{filename:"HustlerGraphics0227",frame:{x:372,y:2542,w:58,h:65},rotated:!1,trimmed:!0,spriteSourceSize:{x:-29,y:-57,w:86,h:78},sourceSize:{w:86,h:78}},{filename:"HustlerGraphics0228",frame:{x:1784,y:2542,w:58,h:65},rotated:!1,trimmed:!0,spriteSourceSize:{x:-29,y:-57,w:86,h:78},sourceSize:{w:86,h:78}},{filename:"HustlerGraphics0229",frame:{x:1521,y:2544,w:58,h:65},rotated:!1,trimmed:!0,spriteSourceSize:{x:-29,y:-57,w:86,h:78},sourceSize:{w:86,h:78}},{filename:"HustlerGraphics0230",frame:{x:2637,y:2544,w:58,h:65},rotated:!1,trimmed:!0,spriteSourceSize:{x:-29,y:-57,w:86,h:78},sourceSize:{w:86,h:78}},{filename:"HustlerGraphics0231",frame:{x:2698,y:2544,w:58,h:65},rotated:!1,trimmed:!0,spriteSourceSize:{x:-29,y:-57,w:86,h:78},sourceSize:{w:86,h:78}},{filename:"HustlerGraphics0232",frame:{x:2759,y:2544,w:58,h:65},rotated:!1,trimmed:!0,spriteSourceSize:{x:-29,y:-57,w:86,h:78},sourceSize:{w:86,h:78}},{filename:"HustlerGraphics0233",frame:{x:2820,y:2546,w:58,h:65},rotated:!1,trimmed:!0,spriteSourceSize:{x:-29,y:-57,w:86,h:78},sourceSize:{w:86,h:78}},{filename:"HustlerGraphics0234",frame:{x:2621,y:2282,w:65,h:68},rotated:!1,trimmed:!0,spriteSourceSize:{x:-29,y:-60,w:86,h:78},sourceSize:{w:86,h:78}},{filename:"HustlerGraphics0235",frame:{x:74,y:2286,w:65,h:68},rotated:!1,trimmed:!0,spriteSourceSize:{x:-29,y:-60,w:86,h:78},sourceSize:{w:86,h:78}},{filename:"HustlerGraphics0236",frame:{x:493,y:2286,w:65,h:68},rotated:!1,trimmed:!0,spriteSourceSize:{x:-29,y:-60,w:86,h:78},sourceSize:{w:86,h:78}},{filename:"HustlerGraphics0237",frame:{x:1960,y:2286,w:65,h:68},rotated:!1,trimmed:!0,spriteSourceSize:{x:-29,y:-60,w:86,h:78},sourceSize:{w:86,h:78}},{filename:"HustlerGraphics0238",frame:{x:1624,y:2288,w:65,h:68},rotated:!1,trimmed:!0,spriteSourceSize:{x:-29,y:-60,w:86,h:78},sourceSize:{w:86,h:78}},{filename:"HustlerGraphics0239",frame:{x:2846,y:2288,w:65,h:68},rotated:!1,trimmed:!0,spriteSourceSize:{x:-29,y:-60,w:86,h:78},sourceSize:{w:86,h:78}},{filename:"HustlerGraphics0240",frame:{x:2914,y:2288,w:65,h:68},rotated:!1,trimmed:!0,spriteSourceSize:{x:-29,y:-60,w:86,h:78},sourceSize:{w:86,h:78}},{filename:"HustlerGraphics0241",frame:{x:248,y:2291,w:65,h:68},rotated:!1,trimmed:!0,spriteSourceSize:{x:-29,y:-60,w:86,h:78},sourceSize:{w:86,h:78}},{filename:"HustlerGraphics0242",frame:{x:1380,y:2291,w:65,h:68},rotated:!1,trimmed:!0,spriteSourceSize:{x:-29,y:-60,w:86,h:78},sourceSize:{w:86,h:78}},{filename:"HustlerGraphics0243",frame:{x:3084,y:2296,w:65,h:68},rotated:!1,trimmed:!0,spriteSourceSize:{x:-29,y:-60,w:86,h:78},sourceSize:{w:86,h:78}},{filename:"HustlerGraphics0244",frame:{x:3152,y:2296,w:65,h:68},rotated:!1,trimmed:!0,spriteSourceSize:{x:-29,y:-60,w:86,h:78},sourceSize:{w:86,h:78}},{filename:"HustlerGraphics0245",frame:{x:316,y:2302,w:65,h:68},rotated:!1,trimmed:!0,spriteSourceSize:{x:-29,y:-60,w:86,h:78},sourceSize:{w:86,h:78}},{filename:"HustlerGraphics0246",frame:{x:1051,y:2303,w:65,h:68},rotated:!1,trimmed:!0,spriteSourceSize:{x:-29,y:-60,w:86,h:78},sourceSize:{w:86,h:78}},{filename:"HustlerGraphics0247",frame:{x:2284,y:2303,w:65,h:68},rotated:!1,trimmed:!0,spriteSourceSize:{x:-29,y:-60,w:86,h:78},sourceSize:{w:86,h:78}},{filename:"HustlerGraphics0248",frame:{x:2284,y:2303,w:65,h:68},rotated:!1,trimmed:!0,spriteSourceSize:{x:-29,y:-60,w:86,h:78},sourceSize:{w:86,h:78}},{filename:"HustlerGraphics0249",frame:{x:2352,y:2303,w:65,h:68},rotated:!1,trimmed:!0,spriteSourceSize:{x:-29,y:-60,w:86,h:78},sourceSize:{w:86,h:78}},{filename:"HustlerGraphics0250",frame:{x:2420,y:2306,w:65,h:68},rotated:!1,trimmed:!0,spriteSourceSize:{x:-29,y:-60,w:86,h:78},sourceSize:{w:86,h:78}},{filename:"HustlerGraphics0251",frame:{x:2028,y:2312,w:65,h:68},rotated:!1,trimmed:!0,spriteSourceSize:{x:-29,y:-60,w:86,h:78},sourceSize:{w:86,h:78}},{filename:"HustlerGraphics0252",frame:{x:2096,y:2312,w:65,h:68},rotated:!1,trimmed:!0,spriteSourceSize:{x:-29,y:-60,w:86,h:78},sourceSize:{w:86,h:78}},{filename:"HustlerGraphics0253",frame:{x:561,y:2313,w:65,h:68},rotated:!1,trimmed:!0,spriteSourceSize:{x:-29,y:-60,w:86,h:78},sourceSize:{w:86,h:78}},{filename:"HustlerGraphics0254",frame:{x:629,y:2313,w:65,h:68},rotated:!1,trimmed:!0,spriteSourceSize:{x:-29,y:-60,w:86,h:78},sourceSize:{w:86,h:78}},{filename:"HustlerGraphics0255",frame:{x:813,y:2314,w:65,h:68},rotated:!1,trimmed:!0,spriteSourceSize:{x:-29,y:-60,w:86,h:78},sourceSize:{w:86,h:78}},{filename:"HustlerGraphics0256",frame:{x:881,y:2314,w:65,h:68},rotated:!1,trimmed:!0,spriteSourceSize:{x:-29,y:-60,w:86,h:78},sourceSize:{w:86,h:78}},{filename:"HustlerGraphics0257",frame:{x:384,y:2318,w:65,h:68},rotated:!1,trimmed:!0,spriteSourceSize:{x:-29,y:-60,w:86,h:78},sourceSize:{w:86,h:78}},{filename:"HustlerGraphics0258",frame:{x:949,y:2325,w:65,h:68},rotated:!1,trimmed:!0,spriteSourceSize:{x:-29,y:-60,w:86,h:78},sourceSize:{w:86,h:78}},{filename:"HustlerGraphics0259",frame:{x:3220,y:2325,w:65,h:68},rotated:!1,trimmed:!0,spriteSourceSize:{x:-29,y:-60,w:86,h:78},sourceSize:{w:86,h:78}},{filename:"HustlerGraphics0260",frame:{x:3288,y:2325,w:65,h:68},rotated:!1,trimmed:!0,spriteSourceSize:{x:-29,y:-60,w:86,h:78},sourceSize:{w:86,h:78}},{filename:"HustlerGraphics0261",frame:{x:697,y:2327,w:65,h:68},rotated:!1,trimmed:!0,spriteSourceSize:{x:-29,y:-60,w:86,h:78},sourceSize:{w:86,h:78}},{filename:"HustlerGraphics0262",frame:{x:1119,y:2333,w:65,h:68},rotated:!1,trimmed:!0,spriteSourceSize:{x:-29,y:-60,w:86,h:78},sourceSize:{w:86,h:78}},{filename:"HustlerGraphics0263",frame:{x:2689,y:2336,w:65,h:68},rotated:!1,trimmed:!0,spriteSourceSize:{x:-29,y:-60,w:86,h:78},sourceSize:{w:86,h:78}},{filename:"HustlerGraphics0264",frame:{x:2757,y:2336,w:65,h:68},rotated:!1,trimmed:!0,spriteSourceSize:{x:-29,y:-60,w:86,h:78},sourceSize:{w:86,h:78}},{filename:"HustlerGraphics0265",frame:{x:3751,y:2338,w:65,h:68},rotated:!1,trimmed:!0,spriteSourceSize:{x:-29,y:-60,w:86,h:78},sourceSize:{w:86,h:78}},{filename:"HustlerGraphics0266",frame:{x:2982,y:2340,w:65,h:68},rotated:!1,trimmed:!0,spriteSourceSize:{x:-29,y:-60,w:86,h:78},sourceSize:{w:86,h:78}},{filename:"HustlerGraphics0267",frame:{x:3356,y:2340,w:65,h:68},rotated:!1,trimmed:!0,spriteSourceSize:{x:-29,y:-60,w:86,h:78},sourceSize:{w:86,h:78}},{filename:"HustlerGraphics0268",frame:{x:3424,y:2340,w:65,h:68},rotated:!1,trimmed:!0,spriteSourceSize:{x:-29,y:-60,w:86,h:78},sourceSize:{w:86,h:78}},{filename:"HustlerGraphics0269",frame:{x:3492,y:2340,w:65,h:68},rotated:!1,trimmed:!0,spriteSourceSize:{x:-29,y:-60,w:86,h:78},sourceSize:{w:86,h:78}},{filename:"HustlerGraphics0270",frame:{x:3652,y:2340,w:65,h:68},rotated:!1,trimmed:!0,spriteSourceSize:{x:-29,y:-60,w:86,h:78},sourceSize:{w:86,h:78}},{filename:"HustlerGraphics0271",frame:{x:3819,y:2341,w:65,h:68},rotated:!1,trimmed:!0,spriteSourceSize:{x:-29,y:-60,w:86,h:78},sourceSize:{w:86,h:78}},{filename:"HustlerGraphics0272",frame:{x:3887,y:2341,w:65,h:68},rotated:!1,trimmed:!0,spriteSourceSize:{x:-29,y:-60,w:86,h:78},sourceSize:{w:86,h:78}},{filename:"HustlerGraphics0273",frame:{x:3955,y:2341,w:65,h:68},rotated:!1,trimmed:!0,spriteSourceSize:{x:-29,y:-60,w:86,h:78},sourceSize:{w:86,h:78}},{filename:"HustlerGraphics0274",frame:{x:4023,y:2341,w:65,h:68},rotated:!1,trimmed:!0,spriteSourceSize:{x:-29,y:-60,w:86,h:78},sourceSize:{w:86,h:78}},{filename:"HustlerGraphics0275",frame:{x:1692,y:2343,w:65,h:68},rotated:!1,trimmed:!0,spriteSourceSize:{x:-29,y:-60,w:86,h:78},sourceSize:{w:86,h:78}},{filename:"HustlerGraphics0276",frame:{x:1760,y:2343,w:65,h:68},rotated:!1,trimmed:!0,spriteSourceSize:{x:-29,y:-60,w:86,h:78},sourceSize:{w:86,h:78}},{filename:"HustlerGraphics0277",frame:{x:1828,y:2343,w:65,h:68},rotated:!1,trimmed:!0,spriteSourceSize:{x:-29,y:-60,w:86,h:78},sourceSize:{w:86,h:78}},{filename:"HustlerGraphics0278",frame:{x:1187,y:2348,w:65,h:68},rotated:!1,trimmed:!0,spriteSourceSize:{x:-29,y:-60,w:86,h:78},sourceSize:{w:86,h:78}},{filename:"HustlerGraphics0279",frame:{x:1255,y:2348,w:65,h:68},rotated:!1,trimmed:!0,spriteSourceSize:{x:-29,y:-60,w:86,h:78},sourceSize:{w:86,h:78}},{filename:"HustlerGraphics0280",frame:{x:3560,y:2348,w:65,h:68},rotated:!1,trimmed:!0,spriteSourceSize:{x:-29,y:-60,w:86,h:78},sourceSize:{w:86,h:78}},{filename:"HustlerGraphics0281",frame:{x:3,y:2349,w:65,h:68},rotated:!1,trimmed:!0,spriteSourceSize:{x:-29,y:-60,w:86,h:78},sourceSize:{w:86,h:78}},{filename:"HustlerGraphics0282",frame:{x:2164,y:2350,w:65,h:68},rotated:!1,trimmed:!0,spriteSourceSize:{x:-29,y:-60,w:86,h:78},sourceSize:{w:86,h:78}},{filename:"HustlerGraphics0283",frame:{x:142,y:2351,w:65,h:68},rotated:!1,trimmed:!0,spriteSourceSize:{x:-29,y:-60,w:86,h:78},sourceSize:{w:86,h:78}},{filename:"HustlerGraphics0284",frame:{x:1448,y:2352,w:65,h:68},rotated:!1,trimmed:!0,spriteSourceSize:{x:-29,y:-60,w:86,h:78},sourceSize:{w:86,h:78}},{filename:"HustlerGraphics0285",frame:{x:1516,y:2352,w:65,h:68},rotated:!1,trimmed:!0,spriteSourceSize:{x:-29,y:-60,w:86,h:78},sourceSize:{w:86,h:78}},{filename:"HustlerGraphics0286",frame:{x:2488,y:2353,w:65,h:68},rotated:!1,trimmed:!0,spriteSourceSize:{x:-29,y:-60,w:86,h:78},sourceSize:{w:86,h:78}},{filename:"HustlerGraphics0287",frame:{x:2556,y:2353,w:65,h:68},rotated:!1,trimmed:!0,spriteSourceSize:{x:-29,y:-60,w:86,h:78},sourceSize:{w:86,h:78}},{filename:"HustlerGraphics0288",frame:{x:71,y:2357,w:65,h:68},rotated:!1,trimmed:!0,spriteSourceSize:{x:-29,y:-60,w:86,h:78},sourceSize:{w:86,h:78}},{filename:"HustlerGraphics0289",frame:{x:452,y:2357,w:65,h:68},rotated:!1,trimmed:!0,spriteSourceSize:{x:-29,y:-60,w:86,h:78},sourceSize:{w:86,h:78}},{filename:"HustlerGraphics0290",frame:{x:1896,y:2357,w:65,h:68},rotated:!1,trimmed:!0,spriteSourceSize:{x:-29,y:-60,w:86,h:78},sourceSize:{w:86,h:78}},{filename:"HustlerGraphics0291",frame:{x:1584,y:2359,w:65,h:68},rotated:!1,trimmed:!0,spriteSourceSize:{x:-29,y:-60,w:86,h:78},sourceSize:{w:86,h:78}},{filename:"HustlerGraphics0292",frame:{x:2825,y:2359,w:65,h:68},rotated:!1,trimmed:!0,spriteSourceSize:{x:-29,y:-60,w:86,h:78},sourceSize:{w:86,h:78}},{filename:"HustlerGraphics0293",frame:{x:2893,y:2359,w:65,h:68},rotated:!1,trimmed:!0,spriteSourceSize:{x:-29,y:-60,w:86,h:78},sourceSize:{w:86,h:78}},{filename:"HustlerGraphics0294",frame:{x:210,y:2362,w:65,h:68},rotated:!1,trimmed:!0,spriteSourceSize:{x:-29,y:-60,w:86,h:78},sourceSize:{w:86,h:78}},{filename:"HustlerGraphics0295",frame:{x:1323,y:2362,w:65,h:68},rotated:!1,trimmed:!0,spriteSourceSize:{x:-29,y:-60,w:86,h:78},sourceSize:{w:86,h:78}},{filename:"HustlerGraphics0296",frame:{x:3050,y:2367,w:65,h:68},rotated:!1,trimmed:!0,spriteSourceSize:{x:-29,y:-60,w:86,h:78},sourceSize:{w:86,h:78}},{filename:"HustlerGraphics0297",frame:{x:3118,y:2367,w:65,h:68},rotated:!1,trimmed:!0,spriteSourceSize:{x:-29,y:-60,w:86,h:78},sourceSize:{w:86,h:78}},{filename:"HustlerGraphics0298",frame:{x:278,y:2373,w:65,h:68},rotated:!1,trimmed:!0,spriteSourceSize:{x:-29,y:-60,w:86,h:78},sourceSize:{w:86,h:78}},{filename:"HustlerGraphics0299",frame:{x:1017,y:2374,w:65,h:68},rotated:!1,trimmed:!0,spriteSourceSize:{x:-29,y:-60,w:86,h:78},sourceSize:{w:86,h:78}},{filename:"HustlerGraphics0300",frame:{x:2232,y:2374,w:65,h:68},rotated:!1,trimmed:!0,spriteSourceSize:{x:-29,y:-60,w:86,h:78},sourceSize:{w:86,h:78}},{filename:"HustlerGraphics0301",frame:{x:2300,y:2374,w:65,h:68},rotated:!1,trimmed:!0,spriteSourceSize:{x:-29,y:-60,w:86,h:78},sourceSize:{w:86,h:78}},{filename:"HustlerGraphics0302",frame:{x:2368,y:2377,w:65,h:68},rotated:!1,trimmed:!0,spriteSourceSize:{x:-29,y:-60,w:86,h:78},sourceSize:{w:86,h:78}},{filename:"HustlerGraphics0303",frame:{x:1964,y:2383,w:65,h:68},rotated:!1,trimmed:!0,spriteSourceSize:{x:-29,y:-60,w:86,h:78},sourceSize:{w:86,h:78}},{filename:"HustlerGraphics0304",frame:{x:2032,y:2383,w:65,h:68},rotated:!1,trimmed:!0,spriteSourceSize:{x:-29,y:-60,w:86,h:78},sourceSize:{w:86,h:78}},{filename:"HustlerGraphics0305",frame:{x:520,y:2384,w:65,h:68},rotated:!1,trimmed:!0,spriteSourceSize:{x:-29,y:-60,w:86,h:78},sourceSize:{w:86,h:78}},{filename:"HustlerGraphics0306",frame:{x:588,y:2384,w:65,h:68},rotated:!1,trimmed:!0,spriteSourceSize:{x:-29,y:-60,w:86,h:78},sourceSize:{w:86,h:78}},{filename:"HustlerGraphics0307",frame:{x:765,y:2385,w:65,h:68},rotated:!1,trimmed:!0,spriteSourceSize:{x:-29,y:-60,w:86,h:78},sourceSize:{w:86,h:78}},{filename:"HustlerGraphics0308",frame:{x:833,y:2385,w:65,h:68},rotated:!1,trimmed:!0,spriteSourceSize:{x:-29,y:-60,w:86,h:78},sourceSize:{w:86,h:78}},{filename:"HustlerGraphics0309",frame:{x:346,y:2389,w:65,h:68},rotated:!1,trimmed:!0,spriteSourceSize:{x:-29,y:-60,w:86,h:78},sourceSize:{w:86,h:78}},{filename:"HustlerGraphics0310",frame:{x:901,y:2396,w:65,h:68},rotated:!1,trimmed:!0,spriteSourceSize:{x:-29,y:-60,w:86,h:78},sourceSize:{w:86,h:78}},{filename:"HustlerGraphics0311",frame:{x:3186,y:2396,w:65,h:68},rotated:!1,trimmed:!0,spriteSourceSize:{x:-29,y:-60,w:86,h:78},sourceSize:{w:86,h:78}},{filename:"HustlerGraphics0312",frame:{x:3254,y:2396,w:65,h:68},rotated:!1,trimmed:!0,spriteSourceSize:{x:-29,y:-60,w:86,h:78},sourceSize:{w:86,h:78}},{filename:"HustlerGraphics0313",frame:{x:656,y:2398,w:65,h:68},rotated:!1,trimmed:!0,spriteSourceSize:{x:-29,y:-60,w:86,h:78},sourceSize:{w:86,h:78}},{filename:"HustlerGraphics0314",frame:{x:1085,y:2404,w:65,h:68},rotated:!1,trimmed:!0,spriteSourceSize:{x:-29,y:-60,w:86,h:78},sourceSize:{w:86,h:78}},{filename:"HustlerGraphics0315",frame:{x:2624,y:2407,w:65,h:68},rotated:!1,trimmed:!0,spriteSourceSize:{x:-29,y:-60,w:86,h:78},sourceSize:{w:86,h:78}},{filename:"HustlerGraphics0316",frame:{x:2692,y:2407,w:65,h:68},rotated:!1,trimmed:!0,spriteSourceSize:{x:-29,y:-60,w:86,h:78},sourceSize:{w:86,h:78}},{filename:"HustlerGraphics0317",frame:{x:3720,y:2409,w:65,h:68},rotated:!1,trimmed:!0,spriteSourceSize:{x:-29,y:-60,w:86,h:78},sourceSize:{w:86,h:78}},{filename:"HustlerGraphics0318",frame:{x:2961,y:2411,w:65,h:68},rotated:!1,trimmed:!0,spriteSourceSize:{x:-29,y:-60,w:86,h:78},sourceSize:{w:86,h:78}},{filename:"HustlerGraphics0319",frame:{x:3322,y:2411,w:65,h:68},rotated:!1,trimmed:!0,spriteSourceSize:{x:-29,y:-60,w:86,h:78},sourceSize:{w:86,h:78}},{filename:"HustlerGraphics0320",frame:{x:3390,y:2411,w:65,h:68},rotated:!1,trimmed:!0,spriteSourceSize:{x:-29,y:-60,w:86,h:78},sourceSize:{w:86,h:78}},{filename:"HustlerGraphics0321",frame:{x:2352,y:2303,w:65,h:68},rotated:!1,trimmed:!0,spriteSourceSize:{x:-29,y:-60,w:86,h:78},sourceSize:{w:86,h:78}},{filename:"HustlerGraphics0322",frame:{x:2142,y:1417,w:68,h:68},rotated:!1,trimmed:!0,spriteSourceSize:{x:-31,y:-60,w:86,h:78},sourceSize:{w:86,h:78}},{filename:"HustlerGraphics0323",frame:{x:982,y:2183,w:68,h:68},rotated:!1,trimmed:!0,spriteSourceSize:{x:-31,y:-60,w:86,h:78},sourceSize:{w:86,h:78}},{filename:"HustlerGraphics0324",frame:{x:3151,y:2225,w:68,h:68},rotated:!1,trimmed:!0,spriteSourceSize:{x:-31,y:-60,w:86,h:78},sourceSize:{w:86,h:78}},{filename:"HustlerGraphics0325",frame:{x:351,y:2231,w:68,h:68},rotated:!1,trimmed:!0,spriteSourceSize:{x:-31,y:-60,w:86,h:78},sourceSize:{w:86,h:78}},{filename:"HustlerGraphics0326",frame:{x:1053,y:2232,w:68,h:68},rotated:!1,trimmed:!0,spriteSourceSize:{x:-31,y:-60,w:86,h:78},sourceSize:{w:86,h:78}},{filename:"HustlerGraphics0327",frame:{x:2337,y:2232,w:68,h:68},rotated:!1,trimmed:!0,spriteSourceSize:{x:-31,y:-60,w:86,h:78},sourceSize:{w:86,h:78}},{filename:"HustlerGraphics0328",frame:{x:2408,y:2232,w:68,h:68},rotated:!1,trimmed:!0,spriteSourceSize:{x:-31,y:-60,w:86,h:78},sourceSize:{w:86,h:78}},{filename:"HustlerGraphics0329",frame:{x:2479,y:2235,w:68,h:68},rotated:!1,trimmed:!0,spriteSourceSize:{x:-31,y:-60,w:86,h:78},sourceSize:{w:86,h:78}},{filename:"HustlerGraphics0330",frame:{x:2071,y:2241,w:68,h:68},rotated:!1,trimmed:!0,spriteSourceSize:{x:-31,y:-60,w:86,h:78},sourceSize:{w:86,h:78}},{filename:"HustlerGraphics0331",frame:{x:2142,y:2241,w:68,h:68},rotated:!1,trimmed:!0,spriteSourceSize:{x:-31,y:-60,w:86,h:78},sourceSize:{w:86,h:78}},{filename:"HustlerGraphics0332",frame:{x:600,y:2242,w:68,h:68},rotated:!1,trimmed:!0,spriteSourceSize:{x:-31,y:-60,w:86,h:78},sourceSize:{w:86,h:78}},{filename:"HustlerGraphics0333",frame:{x:671,y:2242,w:68,h:68},rotated:!1,trimmed:!0,spriteSourceSize:{x:-31,y:-60,w:86,h:78},sourceSize:{w:86,h:78}},{filename:"HustlerGraphics0334",frame:{x:838,y:2243,w:68,h:68},rotated:!1,trimmed:!0,spriteSourceSize:{x:-31,y:-60,w:86,h:78},sourceSize:{w:86,h:78}},{filename:"HustlerGraphics0335",frame:{x:909,y:2243,w:68,h:68},rotated:!1,trimmed:!0,spriteSourceSize:{x:-31,y:-60,w:86,h:78},sourceSize:{w:86,h:78}},{filename:"HustlerGraphics0336",frame:{x:422,y:2247,w:68,h:68},rotated:!1,trimmed:!0,spriteSourceSize:{x:-31,y:-60,w:86,h:78},sourceSize:{w:86,h:78}},{filename:"HustlerGraphics0337",frame:{x:980,y:2254,w:68,h:68},rotated:!1,trimmed:!0,spriteSourceSize:{x:-31,y:-60,w:86,h:78},sourceSize:{w:86,h:78}},{filename:"HustlerGraphics0338",frame:{x:3222,y:2254,w:68,h:68},rotated:!1,trimmed:!0,spriteSourceSize:{x:-31,y:-60,w:86,h:78},sourceSize:{w:86,h:78}},{filename:"HustlerGraphics0339",frame:{x:3293,y:2254,w:68,h:68},rotated:!1,trimmed:!0,spriteSourceSize:{x:-31,y:-60,w:86,h:78},sourceSize:{w:86,h:78}},{filename:"HustlerGraphics0340",frame:{x:742,y:2256,w:68,h:68},rotated:!1,trimmed:!0,spriteSourceSize:{x:-31,y:-60,w:86,h:78},sourceSize:{w:86,h:78}},{filename:"HustlerGraphics0341",frame:{x:2704,y:2265,w:68,h:68},rotated:!1,trimmed:!0,spriteSourceSize:{x:-31,y:-60,w:86,h:78},sourceSize:{w:86,h:78}},{filename:"HustlerGraphics0342",frame:{x:2775,y:2265,w:68,h:68},rotated:!1,trimmed:!0,spriteSourceSize:{x:-31,y:-60,w:86,h:78},sourceSize:{w:86,h:78}},{filename:"HustlerGraphics0343",frame:{x:3788,y:2267,w:68,h:68},rotated:!1,trimmed:!0,spriteSourceSize:{x:-31,y:-60,w:86,h:78},sourceSize:{w:86,h:78}},{filename:"HustlerGraphics0344",frame:{x:3680,y:2269,w:68,h:68},rotated:!1,trimmed:!0,spriteSourceSize:{x:-31,y:-60,w:86,h:78},sourceSize:{w:86,h:78}},{filename:"HustlerGraphics0345",frame:{x:3859,y:2270,w:68,h:68},rotated:!1,trimmed:!0,spriteSourceSize:{x:-31,y:-60,w:86,h:78},sourceSize:{w:86,h:78}},{filename:"HustlerGraphics0346",frame:{x:3930,y:2270,w:68,h:68},rotated:!1,trimmed:!0,spriteSourceSize:{x:-31,y:-60,w:86,h:78},sourceSize:{w:86,h:78}},{filename:"HustlerGraphics0347",frame:{x:4001,y:2270,w:68,h:68},rotated:!1,trimmed:!0,spriteSourceSize:{x:-31,y:-60,w:86,h:78},sourceSize:{w:86,h:78}},{filename:"HustlerGraphics0348",frame:{x:1747,y:2272,w:68,h:68},rotated:!1,trimmed:!0,spriteSourceSize:{x:-31,y:-60,w:86,h:78},sourceSize:{w:86,h:78}},{filename:"HustlerGraphics0349",frame:{x:1818,y:2272,w:68,h:68},rotated:!1,trimmed:!0,spriteSourceSize:{x:-31,y:-60,w:86,h:78},sourceSize:{w:86,h:78}},{filename:"HustlerGraphics0350",frame:{x:1889,y:2272,w:68,h:68},rotated:!1,trimmed:!0,spriteSourceSize:{x:-31,y:-60,w:86,h:78},sourceSize:{w:86,h:78}},{filename:"HustlerGraphics0351",frame:{x:1238,y:2277,w:68,h:68},rotated:!1,trimmed:!0,spriteSourceSize:{x:-31,y:-60,w:86,h:78},sourceSize:{w:86,h:78}},{filename:"HustlerGraphics0352",frame:{x:1309,y:2277,w:68,h:68},rotated:!1,trimmed:!0,spriteSourceSize:{x:-31,y:-60,w:86,h:78},sourceSize:{w:86,h:78}},{filename:"HustlerGraphics0353",frame:{x:3581,y:2277,w:68,h:68},rotated:!1,trimmed:!0,spriteSourceSize:{x:-31,y:-60,w:86,h:78},sourceSize:{w:86,h:78}},{filename:"HustlerGraphics0354",frame:{x:3,y:2278,w:68,h:68},rotated:!1,trimmed:!0,spriteSourceSize:{x:-31,y:-60,w:86,h:78},sourceSize:{w:86,h:78}},{filename:"HustlerGraphics0355",frame:{x:2213,y:2279,w:68,h:68},rotated:!1,trimmed:!0,spriteSourceSize:{x:-31,y:-60,w:86,h:78},sourceSize:{w:86,h:78}},{filename:"HustlerGraphics0356",frame:{x:177,y:2280,w:68,h:68},rotated:!1,trimmed:!0,spriteSourceSize:{x:-31,y:-60,w:86,h:78},sourceSize:{w:86,h:78}},{filename:"HustlerGraphics0357",frame:{x:1482,y:2281,w:68,h:68},rotated:!1,trimmed:!0,spriteSourceSize:{x:-31,y:-60,w:86,h:78},sourceSize:{w:86,h:78}},{filename:"HustlerGraphics0358",frame:{x:1553,y:2281,w:68,h:68},rotated:!1,trimmed:!0,spriteSourceSize:{x:-31,y:-60,w:86,h:78},sourceSize:{w:86,h:78}},{filename:"HustlerGraphics0359",frame:{x:2550,y:2282,w:68,h:68},rotated:!1,trimmed:!0,spriteSourceSize:{x:-31,y:-60,w:86,h:78},sourceSize:{w:86,h:78}},{filename:"LevelIconGraphics0000",frame:{x:3366,y:1514,w:42,h:49},rotated:!1,trimmed:!0,spriteSourceSize:{x:0,y:0,w:62,h:50},sourceSize:{w:62,h:50}},{filename:"LevelIconGraphics0001",frame:{x:91,y:1897,w:62,h:50},rotated:!1,trimmed:!0,spriteSourceSize:{x:0,y:0,w:62,h:50},sourceSize:{w:62,h:50}},{filename:"LevelIconGraphics0002",frame:{x:1400,y:1958,w:42,h:49},rotated:!1,trimmed:!0,spriteSourceSize:{x:0,y:0,w:62,h:50},sourceSize:{w:62,h:50}},{filename:"LevelTextGraphics0000",frame:{x:4089,y:125,w:4,h:4},rotated:!1,trimmed:!0,spriteSourceSize:{x:-2,y:-2,w:4,h:4},sourceSize:{w:4,h:4}},{filename:"LevelsMapButton0000",frame:{x:3043,y:1065,w:176,h:54},rotated:!1,trimmed:!0,spriteSourceSize:{x:1,y:1,w:176,h:54},sourceSize:{w:176,h:54}},{filename:"LevelsMapButton0001",frame:{x:2018,y:1073,w:176,h:54},rotated:!1,trimmed:!0,spriteSourceSize:{x:1,y:1,w:176,h:54},sourceSize:{w:176,h:54}},{filename:"LevelsMapButton0002",frame:{x:2703,y:1073,w:176,h:54},rotated:!1,trimmed:!0,spriteSourceSize:{x:1,y:1,w:176,h:54},sourceSize:{w:176,h:54}},{filename:"MenuButtonGraphics0000",frame:{x:2126,y:974,w:40,h:39},rotated:!1,trimmed:!0,spriteSourceSize:{x:0,y:0,w:40,h:39},sourceSize:{w:40,h:39}},{filename:"MenuButtonGraphics0001",frame:{x:3456,y:1322,w:40,h:39},rotated:!1,trimmed:!0,spriteSourceSize:{x:0,y:0,w:40,h:39},sourceSize:{w:40,h:39}},{filename:"MenuButtonGraphics0002",frame:{x:2126,y:974,w:40,h:39},rotated:!1,trimmed:!0,spriteSourceSize:{x:0,y:0,w:40,h:39},sourceSize:{w:40,h:39}},{filename:"MirrorGraphics0000",frame:{x:3508,y:1515,w:35,h:35},rotated:!1,trimmed:!0,spriteSourceSize:{x:-17.3,y:-17.3,w:35,h:35},sourceSize:{w:35,h:35}},{filename:"MonitorGraphics0000",frame:{x:2900,y:1551,w:35,h:35},rotated:!1,trimmed:!0,spriteSourceSize:{x:-17.3,y:-17.2,w:35,h:35},sourceSize:{w:35,h:35}},{filename:"MonitorGraphics0001",frame:{x:2764,y:1720,w:35,h:35},rotated:!1,trimmed:!0,spriteSourceSize:{x:-17.3,y:-17.2,w:35,h:35},sourceSize:{w:35,h:35}},{filename:"MonitorGraphics0002",frame:{x:2614,y:1724,w:35,h:35},rotated:!1,trimmed:!0,spriteSourceSize:{x:-17.3,y:-17.2,w:35,h:35},sourceSize:{w:35,h:35}},{filename:"MusicButtonGraphics0000",frame:{x:1096,y:1567,w:40,h:39},rotated:!1,trimmed:!0,spriteSourceSize:{x:0,y:0,w:40,h:39},sourceSize:{w:40,h:39}},{filename:"MusicButtonGraphics0001",frame:{x:1361,y:1701,w:40,h:39},rotated:!1,trimmed:!0,spriteSourceSize:{x:0,y:0,w:40,h:39},sourceSize:{w:40,h:39}},{filename:"MusicButtonGraphics0002",frame:{x:2717,y:1788,w:40,h:39},rotated:!1,trimmed:!0,spriteSourceSize:{x:0,y:0,w:40,h:39},sourceSize:{w:40,h:39}},{filename:"MusicButtonGraphics0003",frame:{x:2821,y:1831,w:40,h:39},rotated:!1,trimmed:!0,spriteSourceSize:{x:0,y:0,w:40,h:39},sourceSize:{w:40,h:39}},{filename:"NicheGraphics0000",frame:{x:3794,y:1940,w:75,h:73},rotated:!1,trimmed:!0,spriteSourceSize:{x:-37.1,y:-36.7,w:75,h:73},sourceSize:{w:75,h:73}},{filename:"Plank10Graphics0000",frame:{x:1303,y:1191,w:50,h:20},rotated:!1,trimmed:!0,spriteSourceSize:{x:-25,y:-10,w:50,h:20},sourceSize:{w:50,h:20}},{filename:"Plank11Graphics0000",frame:{x:2882,y:1080,w:51,h:20},rotated:!1,trimmed:!0,spriteSourceSize:{x:-25,y:-10,w:51,h:20},sourceSize:{w:51,h:20}},{filename:"Plank2Graphics0000",frame:{x:3464,y:2665,w:150,h:20},rotated:!1,trimmed:!0,spriteSourceSize:{x:-75,y:-10,w:150,h:20},sourceSize:{w:150,h:20}},{filename:"Plank3Graphics0000",frame:{x:2314,y:2745,w:100,h:20},rotated:!1,trimmed:!0,spriteSourceSize:{x:-50,y:-10,w:100,h:20},sourceSize:{w:100,h:20}},{filename:"Plank4Graphics0000",frame:{x:2993,y:2749,w:100,h:20},rotated:!1,trimmed:!0,spriteSourceSize:{x:-50,y:-10,w:100,h:20},sourceSize:{w:100,h:20}},{filename:"Plank5Graphics0000",frame:{x:2417,y:2751,w:100,h:20},rotated:!1,trimmed:!0,spriteSourceSize:{x:-50,y:-10,w:100,h:20},sourceSize:{w:100,h:20}},{filename:"Plank6Graphics0000",frame:{x:1835,y:1080,w:71,h:21},rotated:!1,trimmed:!0,spriteSourceSize:{x:-35,y:-10,w:71,h:21},sourceSize:{w:71,h:21}},{filename:"Plank7Graphics0000",frame:{x:2573,y:1303,w:71,h:20},rotated:!1,trimmed:!0,spriteSourceSize:{x:-35,y:-10,w:71,h:20},sourceSize:{w:71,h:20}},{filename:"Plank8Graphics0000",frame:{x:3865,y:1187,w:70,h:21},rotated:!1,trimmed:!0,spriteSourceSize:{x:-35,y:-10.1,w:70,h:21},sourceSize:{w:70,h:21}},{filename:"Plank9Graphics0000",frame:{x:1209,y:1099,w:50,h:20},rotated:!1,trimmed:!0,spriteSourceSize:{x:-25,y:-10,w:50,h:20},sourceSize:{w:50,h:20}},{filename:"PlankGraphics0000",frame:{x:3931,y:399,w:150,h:21},rotated:!1,trimmed:!0,spriteSourceSize:{x:-75,y:-10.1,w:150,h:21},sourceSize:{w:150,h:21}},{filename:"PlayGameButton0000",frame:{x:1636,y:1949,w:142,h:40},rotated:!1,trimmed:!0,spriteSourceSize:{x:-.3,y:0,w:143,h:41},sourceSize:{w:143,h:41}},{filename:"PlayGameButton0001",frame:{x:1076,y:1947,w:143,h:40},rotated:!1,trimmed:!0,spriteSourceSize:{x:-.3,y:0,w:143,h:41},sourceSize:{w:143,h:41}},{filename:"PlayGameButton0002",frame:{x:1076,y:1947,w:143,h:40},rotated:!1,trimmed:!0,spriteSourceSize:{x:-.3,y:0,w:143,h:41},sourceSize:{w:143,h:41}},{filename:"Prisoner2Graphics0000",frame:{x:3309,y:1110,w:91,h:100},rotated:!1,trimmed:!0,spriteSourceSize:{x:-51,y:-74.6,w:127,h:112},sourceSize:{w:127,h:112}},{filename:"Prisoner2Graphics0001",frame:{x:3952,y:1110,w:91,h:100},rotated:!1,trimmed:!0,spriteSourceSize:{x:-51,y:-74.6,w:127,h:112},sourceSize:{w:127,h:112}},{filename:"Prisoner2Graphics0002",frame:{x:1224,y:1535,w:92,h:87},rotated:!1,trimmed:!0,spriteSourceSize:{x:-51,y:-74.6,w:127,h:112},sourceSize:{w:127,h:112}},{filename:"Prisoner2Graphics0003",frame:{x:108,y:906,w:104,h:97},rotated:!1,trimmed:!0,spriteSourceSize:{x:-51,y:-74.6,w:127,h:112},sourceSize:{w:127,h:112}},{filename:"Prisoner2Graphics0004",frame:{x:2900,y:1613,w:84,h:92},rotated:!1,trimmed:!0,spriteSourceSize:{x:-42,y:-75.6,w:127,h:112},sourceSize:{w:127,h:112}},{filename:"Prisoner2Graphics0005",frame:{x:168,y:1705,w:79,h:91},rotated:!1,trimmed:!0,spriteSourceSize:{x:-39,y:-75.6,w:127,h:112},sourceSize:{w:127,h:112}},{filename:"Prisoner2Graphics0006",frame:{x:3,y:1487,w:82,h:102},rotated:!1,trimmed:!0,spriteSourceSize:{x:-40,y:-75.6,w:127,h:112},sourceSize:{w:127,h:112}},{filename:"Prisoner2Graphics0007",frame:{x:3277,y:1004,w:93,h:103},rotated:!1,trimmed:!0,spriteSourceSize:{x:-40,y:-75.6,w:127,h:112},sourceSize:{w:127,h:112}},{filename:"Prisoner2Graphics0008",frame:{x:1006,y:1668,w:80,h:93},rotated:!1,trimmed:!0,spriteSourceSize:{x:-39,y:-76.6,w:127,h:112},sourceSize:{w:127,h:112}},{filename:"Prisoner2Graphics0009",frame:{x:1614,y:1528,w:80,h:100},rotated:!1,trimmed:!0,spriteSourceSize:{x:-39,y:-76.6,w:127,h:112},sourceSize:{w:127,h:112}},{filename:"Prisoner2Graphics0010",frame:{x:2028,y:907,w:95,h:106},rotated:!1,trimmed:!0,spriteSourceSize:{x:-52,y:-76.6,w:127,h:112},sourceSize:{w:127,h:112}},{filename:"Prisoner2Graphics0011",frame:{x:3775,y:1285,w:84,h:107},rotated:!1,trimmed:!0,spriteSourceSize:{x:-40,y:-76.6,w:127,h:112},sourceSize:{w:127,h:112}},{filename:"Prisoner2Graphics0012",frame:{x:3810,y:1607,w:80,h:97},rotated:!1,trimmed:!0,spriteSourceSize:{x:-40,y:-76.6,w:127,h:112},sourceSize:{w:127,h:112}},{filename:"Prisoner2Graphics0013",frame:{x:1446,y:1442,w:79,h:106},rotated:!1,trimmed:!0,spriteSourceSize:{x:-39,y:-76.6,w:127,h:112},sourceSize:{w:127,h:112}},{filename:"Prisoner2Graphics0014",frame:{x:964,y:810,w:101,h:106},rotated:!1,trimmed:!0,spriteSourceSize:{x:-57,y:-76.6,w:127,h:112},sourceSize:{w:127,h:112}},{filename:"Prisoner2Graphics0015",frame:{x:2469,y:1004,w:96,h:100},rotated:!1,trimmed:!0,spriteSourceSize:{x:-39,y:-76.6,w:127,h:112},sourceSize:{w:127,h:112}},{filename:"Prisoner2Graphics0016",frame:{x:455,y:1412,w:104,h:83},rotated:!1,trimmed:!0,spriteSourceSize:{x:-53,y:-76.6,w:127,h:112},sourceSize:{w:127,h:112}},{filename:"Prisoner2Graphics0017",frame:{x:2944,y:1004,w:96,h:100},rotated:!1,trimmed:!0,spriteSourceSize:{x:-52,y:-76.6,w:127,h:112},sourceSize:{w:127,h:112}},{filename:"Prisoner2Graphics0018",frame:{x:2174,y:900,w:96,h:107},rotated:!1,trimmed:!0,spriteSourceSize:{x:-39,y:-76.6,w:127,h:112},sourceSize:{w:127,h:112}},{filename:"Prisoner2Graphics0019",frame:{x:2565,y:1428,w:79,h:107},rotated:!1,trimmed:!0,spriteSourceSize:{x:-39,y:-76.6,w:127,h:112},sourceSize:{w:127,h:112}},{filename:"Prisoner2Graphics0020",frame:{x:102,y:1100,w:87,h:107},rotated:!1,trimmed:!0,spriteSourceSize:{x:-43,y:-76.6,w:127,h:112},sourceSize:{w:127,h:112}},{filename:"Prisoner2Graphics0021",frame:{x:1266,y:1319,w:83,h:107},rotated:!1,trimmed:!0,spriteSourceSize:{x:-39,y:-76.6,w:127,h:112},sourceSize:{w:127,h:112}},{filename:"Prisoner2Graphics0022",frame:{x:1068,y:1363,w:82,h:106},rotated:!1,trimmed:!0,spriteSourceSize:{x:-42,y:-76.6,w:127,h:112},sourceSize:{w:127,h:112}},{filename:"Prisoner2Graphics0023",frame:{x:3716,y:949,w:92,h:106},rotated:!1,trimmed:!0,spriteSourceSize:{x:-39,y:-76.6,w:127,h:112},sourceSize:{w:127,h:112}},{filename:"Prisoner2Graphics0024",frame:{x:2400,y:1507,w:84,h:98},rotated:!1,trimmed:!0,spriteSourceSize:{x:-41,y:-75.6,w:127,h:112},sourceSize:{w:127,h:112}},{filename:"Prisoner2Graphics0025",frame:{x:3737,y:1489,w:80,h:104},rotated:!1,trimmed:!0,spriteSourceSize:{x:-40,y:-75.6,w:127,h:112},sourceSize:{w:127,h:112}},{filename:"Prisoner2Graphics0026",frame:{x:88,y:1521,w:79,h:102},rotated:!1,trimmed:!0,spriteSourceSize:{x:-39,y:-75.6,w:127,h:112},sourceSize:{w:127,h:112}},{filename:"Prisoner2Graphics0027",frame:{x:1012,y:1567,w:81,h:98},rotated:!1,trimmed:!0,spriteSourceSize:{x:-41,y:-75.6,w:127,h:112},sourceSize:{w:127,h:112}},{filename:"Prisoner2Graphics0028",frame:{x:1167,y:1005,w:105,h:91},rotated:!1,trimmed:!0,spriteSourceSize:{x:-52,y:-75.6,w:127,h:112},sourceSize:{w:127,h:112}},{filename:"Prisoner2Graphics0029",frame:{x:2142,y:1494,w:82,h:101},rotated:!1,trimmed:!0,spriteSourceSize:{x:-39,y:-75.6,w:127,h:112},sourceSize:{w:127,h:112}},{filename:"Prisoner2Graphics0030",frame:{x:3546,y:1475,w:94,h:89},rotated:!1,trimmed:!0,spriteSourceSize:{x:-51,y:-74.6,w:127,h:112},sourceSize:{w:127,h:112}},{filename:"Prisoner2Graphics0031",frame:{x:978,y:1363,w:87,h:100},rotated:!1,trimmed:!0,spriteSourceSize:{x:-46,y:-74.6,w:127,h:112},sourceSize:{w:127,h:112}},{filename:"Prisoner2Graphics0032",frame:{x:2197,y:1113,w:91,h:100},rotated:!1,trimmed:!0,spriteSourceSize:{x:-51,y:-74.6,w:127,h:112},sourceSize:{w:127,h:112}},{filename:"Prisoner2Graphics0033",frame:{x:3456,y:1374,w:87,h:100},rotated:!1,trimmed:!0,spriteSourceSize:{x:-46,y:-74.6,w:127,h:112},sourceSize:{w:127,h:112}},{filename:"Prisoner2Graphics0034",frame:{x:3952,y:1110,w:91,h:100},rotated:!1,trimmed:!0,spriteSourceSize:{x:-51,y:-74.6,w:127,h:112},sourceSize:{w:127,h:112}},{filename:"Prisoner2Graphics0035",frame:{x:1362,y:1115,w:91,h:100},rotated:!1,trimmed:!0,spriteSourceSize:{x:-51,y:-74.6,w:127,h:112},sourceSize:{w:127,h:112}},{filename:"Prisoner2Graphics0036",frame:{x:3309,y:1110,w:91,h:100},rotated:!1,trimmed:!0,spriteSourceSize:{x:-51,y:-74.6,w:127,h:112},sourceSize:{w:127,h:112}},{filename:"Prisoner2Graphics0037",frame:{x:3393,y:1661,w:82,h:91},rotated:!1,trimmed:!0,spriteSourceSize:{x:-43,y:-65.6,w:127,h:112},sourceSize:{w:127,h:112}},{filename:"Prisoner2Graphics0038",frame:{x:2565,y:1633,w:86,h:88},rotated:!1,trimmed:!0,spriteSourceSize:{x:-42,y:-62.6,w:127,h:112},sourceSize:{w:127,h:112}},{filename:"Prisoner2Graphics0039",frame:{x:3067,y:1699,w:82,h:89},rotated:!1,trimmed:!0,spriteSourceSize:{x:-42,y:-63.6,w:127,h:112},sourceSize:{w:127,h:112}},{filename:"Prisoner2Graphics0040",frame:{x:517,y:1624,w:87,h:88},rotated:!1,trimmed:!0,spriteSourceSize:{x:-42,y:-63.6,w:127,h:112},sourceSize:{w:127,h:112}},{filename:"Prisoner2Graphics0041",frame:{x:2358,y:1700,w:82,h:89},rotated:!1,trimmed:!0,spriteSourceSize:{x:-41,y:-64.6,w:127,h:112},sourceSize:{w:127,h:112}},{filename:"Prisoner2Graphics0042",frame:{x:3775,y:1707,w:82,h:88},rotated:!1,trimmed:!0,spriteSourceSize:{x:-41,y:-63.6,w:127,h:112},sourceSize:{w:127,h:112}},{filename:"Prisoner2Graphics0043",frame:{x:425,y:1591,w:89,h:89},rotated:!1,trimmed:!0,spriteSourceSize:{x:-48,y:-63.6,w:127,h:112},sourceSize:{w:127,h:112}},{filename:"Prisoner2Graphics0044",frame:{x:1703,y:1502,w:94,h:88},rotated:!1,trimmed:!0,spriteSourceSize:{x:-49,y:-62.6,w:127,h:112},sourceSize:{w:127,h:112}},{filename:"Prisoner2Graphics0045",frame:{x:2216,y:1311,w:102,h:88},rotated:!1,trimmed:!0,spriteSourceSize:{x:-50,y:-62.6,w:127,h:112},sourceSize:{w:127,h:112}},{filename:"Prisoner2Graphics0046",frame:{x:1680,y:1685,w:84,h:88},rotated:!1,trimmed:!0,spriteSourceSize:{x:-42,y:-62.6,w:127,h:112},sourceSize:{w:127,h:112}},{filename:"Prisoner2Graphics0047",frame:{x:824,y:1625,w:87,h:88},rotated:!1,trimmed:!0,spriteSourceSize:{x:-40,y:-62.6,w:127,h:112},sourceSize:{w:127,h:112}},{filename:"Prisoner2Graphics0048",frame:{x:250,y:1689,w:83,h:89},rotated:!1,trimmed:!0,spriteSourceSize:{x:-41,y:-63.6,w:127,h:112},sourceSize:{w:127,h:112}},{filename:"Prisoner2Graphics0049",frame:{x:2395,y:1608,w:87,h:89},rotated:!1,trimmed:!0,spriteSourceSize:{x:-41,y:-63.6,w:127,h:112},sourceSize:{w:127,h:112}},{filename:"Prisoner2Graphics0050",frame:{x:1342,y:1528,w:89,h:90},rotated:!1,trimmed:!0,spriteSourceSize:{x:-48,y:-64.6,w:127,h:112},sourceSize:{w:127,h:112}},{filename:"Prisoner2Graphics0051",frame:{x:3820,y:1514,w:90,h:90},rotated:!1,trimmed:!0,spriteSourceSize:{x:-49,y:-64.6,w:127,h:112},sourceSize:{w:127,h:112}},{filename:"Prisoner2Graphics0052",frame:{x:3561,y:1697,w:82,h:90},rotated:!1,trimmed:!0,spriteSourceSize:{x:-41,y:-64.6,w:127,h:112},sourceSize:{w:127,h:112}},{filename:"Prisoner2Graphics0053",frame:{x:3411,y:1477,w:94,h:89},rotated:!1,trimmed:!0,spriteSourceSize:{x:-48,y:-63.6,w:127,h:112},sourceSize:{w:127,h:112}},{filename:"Prisoner2Graphics0054",frame:{x:607,y:1701,w:82,h:89},rotated:!1,trimmed:!0,spriteSourceSize:{x:-42,y:-63.6,w:127,h:112},sourceSize:{w:127,h:112}},{filename:"Prisoner2Graphics0055",frame:{x:455,y:1498,w:92,h:90},rotated:!1,trimmed:!0,spriteSourceSize:{x:-47,y:-64.6,w:127,h:112},sourceSize:{w:127,h:112}},{filename:"Prisoner2Graphics0056",frame:{x:3393,y:1661,w:82,h:91},rotated:!1,trimmed:!0,spriteSourceSize:{x:-43,y:-65.6,w:127,h:112},sourceSize:{w:127,h:112}},{filename:"Prisoner2Graphics0057",frame:{x:3577,y:1919,w:83,h:72},rotated:!1,trimmed:!0,spriteSourceSize:{x:-45,y:-67.6,w:127,h:112},sourceSize:{w:127,h:112}},{filename:"Prisoner2Graphics0058",frame:{x:3646,y:1759,w:87,h:78},rotated:!1,trimmed:!0,spriteSourceSize:{x:-44,y:-64.6,w:127,h:112},sourceSize:{w:127,h:112}},{filename:"Prisoner2Graphics0059",frame:{x:2216,y:1810,w:82,h:77},rotated:!1,trimmed:!0,spriteSourceSize:{x:-43,y:-63.6,w:127,h:112},sourceSize:{w:127,h:112}},{filename:"Prisoner2Graphics0060",frame:{x:503,y:1715,w:83,h:84},rotated:!1,trimmed:!0,spriteSourceSize:{x:-43,y:-62.6,w:127,h:112},sourceSize:{w:127,h:112}},{filename:"Prisoner2Graphics0061",frame:{x:3961,y:1949,w:82,h:65},rotated:!1,trimmed:!0,spriteSourceSize:{x:-42,y:-63.6,w:127,h:112},sourceSize:{w:127,h:112}},{filename:"Prisoner2Graphics0062",frame:{x:3e3,y:1944,w:83,h:65},rotated:!1,trimmed:!0,spriteSourceSize:{x:-42,y:-64.6,w:127,h:112},sourceSize:{w:127,h:112}},{filename:"Prisoner2Graphics0063",frame:{x:2571,y:1930,w:85,h:66},rotated:!1,trimmed:!0,spriteSourceSize:{x:-43,y:-65.6,w:127,h:112},sourceSize:{w:127,h:112}},{filename:"Prisoner2Graphics0064",frame:{x:642,y:1614,w:92,h:84},rotated:!1,trimmed:!0,spriteSourceSize:{x:-41,y:-64.6,w:127,h:112},sourceSize:{w:127,h:112}},{filename:"Prisoner2Graphics0065",frame:{x:3588,y:1599,w:82,h:95},rotated:!1,trimmed:!0,spriteSourceSize:{x:-42,y:-63.6,w:127,h:112},sourceSize:{w:127,h:112}},{filename:"Prisoner2Graphics0066",frame:{x:550,y:1531,w:89,h:90},rotated:!1,trimmed:!0,spriteSourceSize:{x:-49,y:-63.6,w:127,h:112},sourceSize:{w:127,h:112}},{filename:"Prisoner2Graphics0067",frame:{x:250,y:1781,w:82,h:80},rotated:!1,trimmed:!0,spriteSourceSize:{x:-43,y:-63.6,w:127,h:112},sourceSize:{w:127,h:112}},{filename:"Prisoner2Graphics0068",frame:{x:503,y:1802,w:83,h:77},rotated:!1,trimmed:!0,spriteSourceSize:{x:-44,y:-65.6,w:127,h:112},sourceSize:{w:127,h:112}},{filename:"Prisoner2Graphics0069",frame:{x:1177,y:1714,w:91,h:77},rotated:!1,trimmed:!0,spriteSourceSize:{x:-47,y:-66.6,w:127,h:112},sourceSize:{w:127,h:112}},{filename:"Prisoner2Graphics0070",frame:{x:3577,y:1919,w:83,h:72},rotated:!1,trimmed:!0,spriteSourceSize:{x:-45,y:-67.6,w:127,h:112},sourceSize:{w:127,h:112}},{filename:"Prisoner2Graphics0071",frame:{x:3309,y:1110,w:91,h:100},rotated:!1,trimmed:!0,spriteSourceSize:{x:-51,y:-74.6,w:127,h:112},sourceSize:{w:127,h:112}},{filename:"Prisoner2Graphics0072",frame:{x:2842,y:910,w:99,h:100},rotated:!1,trimmed:!0,spriteSourceSize:{x:-46,y:-78.6,w:127,h:112},sourceSize:{w:127,h:112}},{filename:"Prisoner2Graphics0073",frame:{x:229,y:2044,w:84,h:59},rotated:!1,trimmed:!0,spriteSourceSize:{x:-45,y:-58.6,w:127,h:112},sourceSize:{w:127,h:112}},{filename:"Prisoner2Graphics0074",frame:{x:1703,y:1413,w:100,h:86},rotated:!1,trimmed:!0,spriteSourceSize:{x:-50,y:-72.6,w:127,h:112},sourceSize:{w:127,h:112}},{filename:"Prisoner2Graphics0075",frame:{x:754,y:1342,w:109,h:80},rotated:!1,trimmed:!0,spriteSourceSize:{x:-51,y:-61.6,w:127,h:112},sourceSize:{w:127,h:112}},{filename:"Prisoner2Graphics0076",frame:{x:2288,y:1921,w:89,h:67},rotated:!1,trimmed:!0,spriteSourceSize:{x:-40,y:-52.6,w:127,h:112},sourceSize:{w:127,h:112}},{filename:"Prisoner2Graphics0077",frame:{x:3872,y:1949,w:86,h:62},rotated:!1,trimmed:!0,spriteSourceSize:{x:-37,y:-60.6,w:127,h:112},sourceSize:{w:127,h:112}},{filename:"Prisoner2Graphics0078",frame:{x:1548,y:1821,w:87,h:73},rotated:!1,trimmed:!0,spriteSourceSize:{x:-46,y:-58.6,w:127,h:112},sourceSize:{w:127,h:112}},{filename:"Prisoner2Graphics0079",frame:{x:973,y:1764,w:89,h:76},rotated:!1,trimmed:!0,spriteSourceSize:{x:-37,y:-61.6,w:127,h:112},sourceSize:{w:127,h:112}},{filename:"Prisoner2Graphics0080",frame:{x:3,y:1381,w:84,h:103},rotated:!1,trimmed:!0,spriteSourceSize:{x:-46,y:-77.6,w:127,h:112},sourceSize:{w:127,h:112}},{filename:"Prisoner2Graphics0081",frame:{x:2214,y:1402,w:97,h:89},rotated:!1,trimmed:!0,spriteSourceSize:{x:-51,y:-63.6,w:127,h:112},sourceSize:{w:127,h:112}},{filename:"Prisoner2Graphics0082",frame:{x:329,y:909,w:95,h:105},rotated:!1,trimmed:!0,spriteSourceSize:{x:-51,y:-79.6,w:127,h:112},sourceSize:{w:127,h:112}},{filename:"Prisoner2Graphics0083",frame:{x:3669,y:1058,w:91,h:104},rotated:!1,trimmed:!0,spriteSourceSize:{x:-51,y:-78.6,w:127,h:112},sourceSize:{w:127,h:112}},{filename:"Prisoner2Graphics0084",frame:{x:2407,y:1407,w:89,h:97},rotated:!1,trimmed:!0,spriteSourceSize:{x:-51,y:-71.6,w:127,h:112},sourceSize:{w:127,h:112}},{filename:"Prisoner2Graphics0085",frame:{x:743,y:1425,w:96,h:89},rotated:!1,trimmed:!0,spriteSourceSize:{x:-51,y:-63.6,w:127,h:112},sourceSize:{w:127,h:112}},{filename:"Prisoner2Graphics0086",frame:{x:609,y:1117,w:91,h:100},rotated:!1,trimmed:!0,spriteSourceSize:{x:-51,y:-74.6,w:127,h:112},sourceSize:{w:127,h:112}},{filename:"Prisoner2Graphics0087",frame:{x:2294,y:899,w:101,h:102},rotated:!1,trimmed:!0,spriteSourceSize:{x:-51,y:-74.6,w:127,h:112},sourceSize:{w:127,h:112}},{filename:"Prisoner2Graphics0088",frame:{x:3583,y:1165,w:89,h:102},rotated:!1,trimmed:!0,spriteSourceSize:{x:-51,y:-74.6,w:127,h:112},sourceSize:{w:127,h:112}},{filename:"Prisoner2Graphics0089",frame:{x:3839,y:913,w:96,h:103},rotated:!1,trimmed:!0,spriteSourceSize:{x:-51,y:-74.6,w:127,h:112},sourceSize:{w:127,h:112}},{filename:"Prisoner2Graphics0090",frame:{x:2672,y:1334,w:89,h:98},rotated:!1,trimmed:!0,spriteSourceSize:{x:-51,y:-76.6,w:127,h:112},sourceSize:{w:127,h:112}},{filename:"Prisoner2Graphics0091",frame:{x:835,y:1532,w:89,h:90},rotated:!1,trimmed:!0,spriteSourceSize:{x:-51,y:-68.6,w:127,h:112},sourceSize:{w:127,h:112}},{filename:"Prisoner2Graphics0092",frame:{x:3216,y:1408,w:89,h:97},rotated:!1,trimmed:!0,spriteSourceSize:{x:-51,y:-68.6,w:127,h:112},sourceSize:{w:127,h:112}},{filename:"Prisoner2Graphics0093",frame:{x:3015,y:1326,w:91,h:96},rotated:!1,trimmed:!0,spriteSourceSize:{x:-51,y:-74.6,w:127,h:112},sourceSize:{w:127,h:112}},{filename:"Prisoner2Graphics0094",frame:{x:1981,y:1613,w:91,h:85},rotated:!1,trimmed:!0,spriteSourceSize:{x:-51,y:-63.6,w:127,h:112},sourceSize:{w:127,h:112}},{filename:"Prisoner2Graphics0095",frame:{x:308,y:1167,w:89,h:102},rotated:!1,trimmed:!0,spriteSourceSize:{x:-51,y:-80.6,w:127,h:112},sourceSize:{w:127,h:112}},{filename:"Prisoner2Graphics0096",frame:{x:1835,y:1108,w:95,h:97},rotated:!1,trimmed:!0,spriteSourceSize:{x:-51,y:-74.6,w:127,h:112},sourceSize:{w:127,h:112}},{filename:"Prisoner2Graphics0097",frame:{x:1375,y:1005,w:89,h:107},rotated:!1,trimmed:!0,spriteSourceSize:{x:-51,y:-80.6,w:127,h:112},sourceSize:{w:127,h:112}},{filename:"Prisoner2Graphics0098",frame:{x:1068,y:810,w:101,h:105},rotated:!1,trimmed:!0,spriteSourceSize:{x:-51,y:-77.6,w:127,h:112},sourceSize:{w:127,h:112}},{filename:"Prisoner2Graphics0099",frame:{x:703,y:1117,w:91,h:100},rotated:!1,trimmed:!0,spriteSourceSize:{x:-51,y:-74.6,w:127,h:112},sourceSize:{w:127,h:112}},{filename:"Prisoner2Graphics0100",frame:{x:2398,y:899,w:101,h:102},rotated:!1,trimmed:!0,spriteSourceSize:{x:-51,y:-74.6,w:127,h:112},sourceSize:{w:127,h:112}},{filename:"Prisoner2Graphics0101",frame:{x:3,y:1172,w:89,h:102},rotated:!1,trimmed:!0,spriteSourceSize:{x:-51,y:-74.6,w:127,h:112},sourceSize:{w:127,h:112}},{filename:"Prisoner2Graphics0102",frame:{x:1068,y:918,w:96,h:103},rotated:!1,trimmed:!0,spriteSourceSize:{x:-51,y:-74.6,w:127,h:112},sourceSize:{w:127,h:112}},{filename:"Prisoner2Graphics0103",frame:{x:1963,y:1337,w:89,h:98},rotated:!1,trimmed:!0,spriteSourceSize:{x:-51,y:-76.6,w:127,h:112},sourceSize:{w:127,h:112}},{filename:"Prisoner2Graphics0104",frame:{x:835,y:1532,w:89,h:90},rotated:!1,trimmed:!0,spriteSourceSize:{x:-51,y:-68.6,w:127,h:112},sourceSize:{w:127,h:112}},{filename:"Prisoner2Graphics0105",frame:{x:3216,y:1408,w:89,h:97},rotated:!1,trimmed:!0,spriteSourceSize:{x:-51,y:-68.6,w:127,h:112},sourceSize:{w:127,h:112}},{filename:"Prisoner2Graphics0106",frame:{x:3015,y:1425,w:89,h:96},rotated:!1,trimmed:!0,spriteSourceSize:{x:-51,y:-74.6,w:127,h:112},sourceSize:{w:127,h:112}},{filename:"Prisoner2Graphics0107",frame:{x:1153,y:1417,w:101,h:85},rotated:!1,trimmed:!0,spriteSourceSize:{x:-51,y:-63.6,w:127,h:112},sourceSize:{w:127,h:112}},{filename:"Prisoner2Graphics0108",frame:{x:743,y:1517,w:89,h:91},rotated:!1,trimmed:!0,spriteSourceSize:{x:-51,y:-68.6,w:127,h:112},sourceSize:{w:127,h:112}},{filename:"Prisoner2Graphics0109",frame:{x:422,y:1101,w:91,h:102},rotated:!1,trimmed:!0,spriteSourceSize:{x:-51,y:-74.6,w:127,h:112},sourceSize:{w:127,h:112}},{filename:"Prisoner2Graphics0110",frame:{x:609,y:1117,w:91,h:100},rotated:!1,trimmed:!0,spriteSourceSize:{x:-51,y:-74.6,w:127,h:112},sourceSize:{w:127,h:112}},{filename:"Prisoner2Graphics0111",frame:{x:1375,y:901,w:101,h:101},rotated:!1,trimmed:!0,spriteSourceSize:{x:-51,y:-74.6,w:127,h:112},sourceSize:{w:127,h:112}},{filename:"Prisoner2Graphics0112",frame:{x:3839,y:913,w:96,h:103},rotated:!1,trimmed:!0,spriteSourceSize:{x:-51,y:-74.6,w:127,h:112},sourceSize:{w:127,h:112}},{filename:"Prisoner2Graphics0113",frame:{x:914,y:1652,w:89,h:85},rotated:!1,trimmed:!0,spriteSourceSize:{x:-51,y:-63.6,w:127,h:112},sourceSize:{w:127,h:112}},{filename:"Prisoner2Graphics0114",frame:{x:3216,y:1408,w:89,h:97},rotated:!1,trimmed:!0,spriteSourceSize:{x:-51,y:-68.6,w:127,h:112},sourceSize:{w:127,h:112}},{filename:"Prisoner2Graphics0115",frame:{x:3931,y:1425,w:100,h:85},rotated:!1,trimmed:!0,spriteSourceSize:{x:-51,y:-63.6,w:127,h:112},sourceSize:{w:127,h:112}},{filename:"Prisoner2Graphics0116",frame:{x:923,y:919,w:96,h:103},rotated:!1,trimmed:!0,spriteSourceSize:{x:-51,y:-80.6,w:127,h:112},sourceSize:{w:127,h:112}},{filename:"Prisoner2Graphics0117",frame:{x:3407,y:897,w:101,h:103},rotated:!1,trimmed:!0,spriteSourceSize:{x:-51,y:-77.6,w:127,h:112},sourceSize:{w:127,h:112}},{filename:"Prisoner2Graphics0118",frame:{x:609,y:1117,w:91,h:100},rotated:!1,trimmed:!0,spriteSourceSize:{x:-51,y:-74.6,w:127,h:112},sourceSize:{w:127,h:112}},{filename:"Prisoner2Graphics0119",frame:{x:3173,y:903,w:101,h:100},rotated:!1,trimmed:!0,spriteSourceSize:{x:-51,y:-74.6,w:127,h:112},sourceSize:{w:127,h:112}},{filename:"Prisoner2Graphics0120",frame:{x:2974,y:1122,w:91,h:100},rotated:!1,trimmed:!0,spriteSourceSize:{x:-51,y:-74.6,w:127,h:112},sourceSize:{w:127,h:112}},{filename:"Prisoner2Graphics0121",frame:{x:3068,y:1122,w:91,h:100},rotated:!1,trimmed:!0,spriteSourceSize:{x:-51,y:-74.6,w:127,h:112},sourceSize:{w:127,h:112}},{filename:"Prisoner2Graphics0122",frame:{x:1209,y:1126,w:91,h:100},rotated:!1,trimmed:!0,spriteSourceSize:{x:-51,y:-74.6,w:127,h:112},sourceSize:{w:127,h:112}},{filename:"Prisoner2Graphics0123",frame:{x:1933,y:1130,w:91,h:100},rotated:!1,trimmed:!0,spriteSourceSize:{x:-51,y:-74.6,w:127,h:112},sourceSize:{w:127,h:112}},{filename:"Prisoner2Graphics0124",frame:{x:3511,y:949,w:98,h:100},rotated:!1,trimmed:!0,spriteSourceSize:{x:-51,y:-74.6,w:127,h:112},sourceSize:{w:127,h:112}},{filename:"Prisoner2Graphics0125",frame:{x:2027,y:1130,w:91,h:100},rotated:!1,trimmed:!0,spriteSourceSize:{x:-51,y:-74.6,w:127,h:112},sourceSize:{w:127,h:112}},{filename:"Prisoner2Graphics0126",frame:{x:2653,y:1130,w:91,h:100},rotated:!1,trimmed:!0,spriteSourceSize:{x:-51,y:-74.6,w:127,h:112},sourceSize:{w:127,h:112}},{filename:"Prisoner2Graphics0127",frame:{x:2747,y:1130,w:91,h:100},rotated:!1,trimmed:!0,spriteSourceSize:{x:-51,y:-74.6,w:127,h:112},sourceSize:{w:127,h:112}},{filename:"Prisoner2Graphics0128",frame:{x:1456,y:1137,w:91,h:100},rotated:!1,trimmed:!0,spriteSourceSize:{x:-51,y:-74.6,w:127,h:112},sourceSize:{w:127,h:112}},{filename:"Prisoner2Graphics0129",frame:{x:1550,y:1137,w:91,h:100},rotated:!1,trimmed:!0,spriteSourceSize:{x:-51,y:-74.6,w:127,h:112},sourceSize:{w:127,h:112}},{filename:"Prisoner2Graphics0130",frame:{x:797,y:1138,w:91,h:100},rotated:!1,trimmed:!0,spriteSourceSize:{x:-51,y:-74.6,w:127,h:112},sourceSize:{w:127,h:112}},{filename:"Prisoner2Graphics0131",frame:{x:3309,y:1110,w:91,h:100},rotated:!1,trimmed:!0,spriteSourceSize:{x:-51,y:-74.6,w:127,h:112},sourceSize:{w:127,h:112}},{filename:"Prisoner2Graphics0132",frame:{x:3728,y:1596,w:79,h:99},rotated:!1,trimmed:!0,spriteSourceSize:{x:-39,y:-73.6,w:127,h:112},sourceSize:{w:127,h:112}},{filename:"Prisoner2Graphics0133",frame:{x:3280,y:1514,w:83,h:98},rotated:!1,trimmed:!0,spriteSourceSize:{x:-43,y:-72.6,w:127,h:112},sourceSize:{w:127,h:112}},{filename:"Prisoner2Graphics0134",frame:{x:742,y:1611,w:79,h:98},rotated:!1,trimmed:!0,spriteSourceSize:{x:-39,y:-72.6,w:127,h:112},sourceSize:{w:127,h:112}},{filename:"Prisoner2Graphics0135",frame:{x:927,y:1552,w:82,h:97},rotated:!1,trimmed:!0,spriteSourceSize:{x:-42,y:-71.6,w:127,h:112},sourceSize:{w:127,h:112}},{filename:"Prisoner2Graphics0136",frame:{x:1789,y:1613,w:79,h:98},rotated:!1,trimmed:!0,spriteSourceSize:{x:-39,y:-72.6,w:127,h:112},sourceSize:{w:127,h:112}},{filename:"Prisoner2Graphics0137",frame:{x:82,y:1725,w:78,h:87},rotated:!1,trimmed:!0,spriteSourceSize:{x:-40,y:-61.6,w:127,h:112},sourceSize:{w:127,h:112}},{filename:"Prisoner2Graphics0138",frame:{x:3127,y:1609,w:89,h:87},rotated:!1,trimmed:!0,spriteSourceSize:{x:-45,y:-61.6,w:127,h:112},sourceSize:{w:127,h:112}},{filename:"Prisoner2Graphics0139",frame:{x:2817,y:1655,w:75,h:100},rotated:!1,trimmed:!0,spriteSourceSize:{x:-37,y:-74.6,w:127,h:112},sourceSize:{w:127,h:112}},{filename:"Prisoner2Graphics0140",frame:{x:3150,y:1803,w:77,h:82},rotated:!1,trimmed:!0,spriteSourceSize:{x:-39,y:-58.6,w:127,h:112},sourceSize:{w:127,h:112}},{filename:"Prisoner2Graphics0141",frame:{x:2655,y:1538,w:75,h:77},rotated:!1,trimmed:!0,spriteSourceSize:{x:-37,y:-55.6,w:127,h:112},sourceSize:{w:127,h:112}},{filename:"Prisoner2Graphics0142",frame:{x:336,y:1719,w:77,h:89},rotated:!1,trimmed:!0,spriteSourceSize:{x:-37,y:-74.6,w:127,h:112},sourceSize:{w:127,h:112}},{filename:"Prisoner2Graphics0143",frame:{x:562,y:1426,w:83,h:102},rotated:!1,trimmed:!0,spriteSourceSize:{x:-42,y:-78.6,w:127,h:112},sourceSize:{w:127,h:112}},{filename:"Prisoner2Graphics0144",frame:{x:3,y:1694,w:76,h:96},rotated:!1,trimmed:!0,spriteSourceSize:{x:-38,y:-77.6,w:127,h:112},sourceSize:{w:127,h:112}},{filename:"Prisoner2Graphics0145",frame:{x:1243,y:1944,w:76,h:72},rotated:!1,trimmed:!0,spriteSourceSize:{x:-38,y:-71.6,w:127,h:112},sourceSize:{w:127,h:112}},{filename:"Prisoner2Graphics0146",frame:{x:1750,y:2050,w:84,h:58},rotated:!1,trimmed:!0,spriteSourceSize:{x:-46,y:-57.6,w:127,h:112},sourceSize:{w:127,h:112}},{filename:"Prisoner2Graphics0147",frame:{x:1275,y:1701,w:83,h:87},rotated:!1,trimmed:!0,spriteSourceSize:{x:-45,y:-61.6,w:127,h:112},sourceSize:{w:127,h:112}},{filename:"Prisoner2Graphics0148",frame:{x:335,y:1811,w:75,h:83},rotated:!1,trimmed:!0,spriteSourceSize:{x:-37,y:-57.6,w:127,h:112},sourceSize:{w:127,h:112}},{filename:"Prisoner2Graphics0149",frame:{x:425,y:1683,w:75,h:99},rotated:!1,trimmed:!0,spriteSourceSize:{x:-37,y:-73.6,w:127,h:112},sourceSize:{w:127,h:112}},{filename:"Prisoner2Graphics0150",frame:{x:3,y:1793,w:75,h:87},rotated:!1,trimmed:!0,spriteSourceSize:{x:-37,y:-61.6,w:127,h:112},sourceSize:{w:127,h:112}},{filename:"Prisoner2Graphics0151",frame:{x:1867,y:1739,w:75,h:89},rotated:!1,trimmed:!0,spriteSourceSize:{x:-37,y:-63.6,w:127,h:112},sourceSize:{w:127,h:112}},{filename:"Prisoner2Graphics0152",frame:{x:170,y:1601,w:77,h:101},rotated:!1,trimmed:!0,spriteSourceSize:{x:-37,y:-75.6,w:127,h:112},sourceSize:{w:127,h:112}},{filename:"Prisoner2Graphics0153",frame:{x:1434,y:1551,w:79,h:101},rotated:!1,trimmed:!0,spriteSourceSize:{x:-39,y:-75.6,w:127,h:112},sourceSize:{w:127,h:112}},{filename:"Prisoner2Graphics0154",frame:{x:1434,y:1551,w:79,h:101},rotated:!1,trimmed:!0,spriteSourceSize:{x:-39,y:-75.6,w:127,h:112},sourceSize:{w:127,h:112}},{filename:"Prisoner2Graphics0155",frame:{x:1434,y:1551,w:79,h:101},rotated:!1,trimmed:!0,spriteSourceSize:{x:-39,y:-75.6,w:127,h:112},sourceSize:{w:127,h:112}},{filename:"Prisoner2Graphics0156",frame:{x:1434,y:1551,w:79,h:101},rotated:!1,trimmed:!0,spriteSourceSize:{x:-39,y:-75.6,w:127,h:112},sourceSize:{w:127,h:112}},{filename:"Prisoner2Graphics0157",frame:{x:1434,y:1551,w:79,h:101},rotated:!1,trimmed:!0,spriteSourceSize:{x:-39,y:-75.6,w:127,h:112},sourceSize:{w:127,h:112}},{filename:"Prisoner2Graphics0158",frame:{x:1434,y:1551,w:79,h:101},rotated:!1,trimmed:!0,spriteSourceSize:{x:-39,y:-75.6,w:127,h:112},sourceSize:{w:127,h:112}},{filename:"Prisoner2Graphics0159",frame:{x:1434,y:1551,w:79,h:101},rotated:!1,trimmed:!0,spriteSourceSize:{x:-39,y:-75.6,w:127,h:112},sourceSize:{w:127,h:112}},{filename:"Prisoner2Graphics0160",frame:{x:1434,y:1551,w:79,h:101},rotated:!1,trimmed:!0,spriteSourceSize:{x:-39,y:-75.6,w:127,h:112},sourceSize:{w:127,h:112}},{filename:"Prisoner2Graphics0161",frame:{x:1434,y:1551,w:79,h:101},rotated:!1,trimmed:!0,spriteSourceSize:{x:-39,y:-75.6,w:127,h:112},sourceSize:{w:127,h:112}},{filename:"Prisoner2Graphics0162",frame:{x:1434,y:1551,w:79,h:101},rotated:!1,trimmed:!0,spriteSourceSize:{x:-39,y:-75.6,w:127,h:112},sourceSize:{w:127,h:112}},{filename:"Prisoner2Graphics0163",frame:{x:1434,y:1551,w:79,h:101},rotated:!1,trimmed:!0,spriteSourceSize:{x:-39,y:-75.6,w:127,h:112},sourceSize:{w:127,h:112}},{filename:"Prisoner2Graphics0164",frame:{x:1434,y:1551,w:79,h:101},rotated:!1,trimmed:!0,spriteSourceSize:{x:-39,y:-75.6,w:127,h:112},sourceSize:{w:127,h:112}},{filename:"Prisoner2Graphics0165",frame:{x:1434,y:1551,w:79,h:101},rotated:!1,trimmed:!0,spriteSourceSize:{x:-39,y:-75.6,w:127,h:112},sourceSize:{w:127,h:112}},{filename:"Prisoner2Graphics0166",frame:{x:3393,y:1661,w:82,h:91},rotated:!1,trimmed:!0,spriteSourceSize:{x:-44,y:-65.6,w:127,h:112},sourceSize:{w:127,h:112}},{filename:"Prisoner2Graphics0167",frame:{x:1894,y:1541,w:84,h:95},rotated:!1,trimmed:!0,spriteSourceSize:{x:-44,y:-76.6,w:127,h:112},sourceSize:{w:127,h:112}},{filename:"Prisoner2Graphics0168",frame:{x:81,y:1815,w:79,h:79},rotated:!1,trimmed:!0,spriteSourceSize:{x:-47,y:-64.6,w:127,h:112},sourceSize:{w:127,h:112}},{filename:"Prisoner2Graphics0169",frame:{x:1673,y:1776,w:68,h:98},rotated:!1,trimmed:!0,spriteSourceSize:{x:-34,y:-74.6,w:127,h:112},sourceSize:{w:127,h:112}},{filename:"Prisoner2Graphics0170",frame:{x:2291,y:1113,w:71,h:94},rotated:!1,trimmed:!0,spriteSourceSize:{x:-30,y:-74.6,w:127,h:112},sourceSize:{w:127,h:112}},{filename:"Prisoner2Graphics0171",frame:{x:791,y:1716,w:79,h:88},rotated:!1,trimmed:!0,spriteSourceSize:{x:-33,y:-76.6,w:127,h:112},sourceSize:{w:127,h:112}},{filename:"Prisoner2Graphics0172",frame:{x:1310,y:2104,w:60,h:50},rotated:!1,trimmed:!0,spriteSourceSize:{x:-31,y:-48.6,w:127,h:112},sourceSize:{w:127,h:112}},{filename:"Prisoner2Graphics0173",frame:{x:1238,y:2224,w:58,h:50},rotated:!1,trimmed:!0,spriteSourceSize:{x:-30,y:-48.6,w:127,h:112},sourceSize:{w:127,h:112}},{filename:"Prisoner2Graphics0174",frame:{x:3,y:2684,w:56,h:51},rotated:!1,trimmed:!0,spriteSourceSize:{x:-29,y:-49.6,w:127,h:112},sourceSize:{w:127,h:112}},{filename:"Prisoner2Graphics0175",frame:{x:566,y:2684,w:56,h:51},rotated:!1,trimmed:!0,spriteSourceSize:{x:-29,y:-49.6,w:127,h:112},sourceSize:{w:127,h:112}},{filename:"Prisoner2Graphics0176",frame:{x:3822,y:2697,w:54,h:51},rotated:!1,trimmed:!0,spriteSourceSize:{x:-28,y:-49.6,w:127,h:112},sourceSize:{w:127,h:112}},{filename:"Prisoner2Graphics0177",frame:{x:3879,y:2697,w:54,h:51},rotated:!1,trimmed:!0,spriteSourceSize:{x:-28,y:-49.6,w:127,h:112},sourceSize:{w:127,h:112}},{filename:"Prisoner2Graphics0178",frame:{x:1548,y:2699,w:54,h:51},rotated:!1,trimmed:!0,spriteSourceSize:{x:-28,y:-49.6,w:127,h:112},sourceSize:{w:127,h:112}},{filename:"Prisoner2Graphics0179",frame:{x:3234,y:2692,w:55,h:51},rotated:!1,trimmed:!0,spriteSourceSize:{x:-29,y:-49.6,w:127,h:112},sourceSize:{w:127,h:112}},{filename:"Prisoner2Graphics0180",frame:{x:1164,y:2695,w:55,h:51},rotated:!1,trimmed:!0,spriteSourceSize:{x:-29,y:-49.6,w:127,h:112},sourceSize:{w:127,h:112}},{filename:"Prisoner2Graphics0181",frame:{x:3005,y:2695,w:55,h:51},rotated:!1,trimmed:!0,spriteSourceSize:{x:-29,y:-49.6,w:127,h:112},sourceSize:{w:127,h:112}},{filename:"Prisoner2Graphics0182",frame:{x:3063,y:2695,w:55,h:51},rotated:!1,trimmed:!0,spriteSourceSize:{x:-29,y:-49.6,w:127,h:112},sourceSize:{w:127,h:112}},{filename:"Prisoner2Graphics0183",frame:{x:743,y:2696,w:55,h:51},rotated:!1,trimmed:!0,spriteSourceSize:{x:-29,y:-49.6,w:127,h:112},sourceSize:{w:127,h:112}},{filename:"Prisoner2Graphics0184",frame:{x:454,y:2697,w:55,h:51},rotated:!1,trimmed:!0,spriteSourceSize:{x:-29,y:-49.6,w:127,h:112},sourceSize:{w:127,h:112}},{filename:"Prisoner2Graphics0185",frame:{x:2418,y:2697,w:55,h:51},rotated:!1,trimmed:!0,spriteSourceSize:{x:-29,y:-49.6,w:127,h:112},sourceSize:{w:127,h:112}},{filename:"Prisoner2Graphics0186",frame:{x:2476,y:2697,w:55,h:51},rotated:!1,trimmed:!0,spriteSourceSize:{x:-29,y:-49.6,w:127,h:112},sourceSize:{w:127,h:112}},{filename:"Prisoner2Graphics0187",frame:{x:2534,y:2697,w:55,h:51},rotated:!1,trimmed:!0,spriteSourceSize:{x:-29,y:-49.6,w:127,h:112},sourceSize:{w:127,h:112}},{filename:"Prisoner2Graphics0188",frame:{x:3706,y:2697,w:55,h:51},rotated:!1,trimmed:!0,spriteSourceSize:{x:-29,y:-49.6,w:127,h:112},sourceSize:{w:127,h:112}},{filename:"Prisoner2Graphics0189",frame:{x:3706,y:2697,w:55,h:51},rotated:!1,trimmed:!0,spriteSourceSize:{x:-29,y:-49.6,w:127,h:112},sourceSize:{w:127,h:112}},{filename:"Prisoner2Graphics0190",frame:{x:3706,y:2697,w:55,h:51},rotated:!1,trimmed:!0,spriteSourceSize:{x:-29,y:-49.6,w:127,h:112},sourceSize:{w:127,h:112}},{filename:"Prisoner2Graphics0191",frame:{x:3764,y:2697,w:55,h:51},rotated:!1,trimmed:!0,spriteSourceSize:{x:-29,y:-49.6,w:127,h:112},sourceSize:{w:127,h:112}},{filename:"Prisoner2Graphics0192",frame:{x:3764,y:2697,w:55,h:51},rotated:!1,trimmed:!0,spriteSourceSize:{x:-29,y:-49.6,w:127,h:112},sourceSize:{w:127,h:112}},{filename:"Prisoner2Graphics0193",frame:{x:3764,y:2697,w:55,h:51},rotated:!1,trimmed:!0,spriteSourceSize:{x:-29,y:-49.6,w:127,h:112},sourceSize:{w:127,h:112}},{filename:"Prisoner2Graphics0194",frame:{x:3764,y:2697,w:55,h:51},rotated:!1,trimmed:!0,spriteSourceSize:{x:-29,y:-49.6,w:127,h:112},sourceSize:{w:127,h:112}},{filename:"Prisoner2Graphics0195",frame:{x:3764,y:2697,w:55,h:51},rotated:!1,trimmed:!0,spriteSourceSize:{x:-29,y:-49.6,w:127,h:112},sourceSize:{w:127,h:112}},{filename:"Prisoner2Graphics0196",frame:{x:3764,y:2697,w:55,h:51},rotated:!1,trimmed:!0,spriteSourceSize:{x:-29,y:-49.6,w:127,h:112},sourceSize:{w:127,h:112}},{filename:"Prisoner2Graphics0197",frame:{x:3764,y:2697,w:55,h:51},rotated:!1,trimmed:!0,spriteSourceSize:{x:-29,y:-49.6,w:127,h:112},sourceSize:{w:127,h:112}},{filename:"Prisoner2Graphics0198",frame:{x:3764,y:2697,w:55,h:51},rotated:!1,trimmed:!0,spriteSourceSize:{x:-29,y:-49.6,w:127,h:112},sourceSize:{w:127,h:112}},{filename:"Prisoner2Graphics0199",frame:{x:3764,y:2697,w:55,h:51},rotated:!1,trimmed:!0,spriteSourceSize:{x:-29,y:-49.6,w:127,h:112},sourceSize:{w:127,h:112}},{filename:"Prisoner2Graphics0200",frame:{x:3764,y:2697,w:55,h:51},rotated:!1,trimmed:!0,spriteSourceSize:{x:-29,y:-49.6,w:127,h:112},sourceSize:{w:127,h:112}},{filename:"Prisoner2Graphics0201",frame:{x:891,y:1138,w:91,h:100},rotated:!1,trimmed:!0,spriteSourceSize:{x:-51,y:-74.6,w:127,h:112},sourceSize:{w:127,h:112}},{filename:"Prisoner2Graphics0202",frame:{x:2647,y:1435,w:84,h:100},rotated:!1,trimmed:!0,spriteSourceSize:{x:-46,y:-74.6,w:127,h:112},sourceSize:{w:127,h:112}},{filename:"Prisoner2Graphics0203",frame:{x:3931,y:1513,w:92,h:89},rotated:!1,trimmed:!0,spriteSourceSize:{x:-51,y:-63.6,w:127,h:112},sourceSize:{w:127,h:112}},{filename:"Prisoner2Graphics0204",frame:{x:1767,y:1714,w:97,h:72},rotated:!1,trimmed:!0,spriteSourceSize:{x:-51,y:-54.6,w:127,h:112},sourceSize:{w:127,h:112}},{filename:"Prisoner2Graphics0205",frame:{x:801,y:1813,w:90,h:72},rotated:!1,trimmed:!0,spriteSourceSize:{x:-38,y:-55.6,w:127,h:112},sourceSize:{w:127,h:112}},{filename:"Prisoner2Graphics0206",frame:{x:2938,y:1524,w:94,h:86},rotated:!1,trimmed:!0,spriteSourceSize:{x:-53,y:-65.6,w:127,h:112},sourceSize:{w:127,h:112}},{filename:"Prisoner2Graphics0207",frame:{x:2197,y:1010,w:70,h:100},rotated:!1,trimmed:!0,spriteSourceSize:{x:-29,y:-78.6,w:127,h:112},sourceSize:{w:127,h:112}},{filename:"Prisoner2Graphics0208",frame:{x:2407,y:1315,w:69,h:79},rotated:!1,trimmed:!0,spriteSourceSize:{x:-41,y:-76.6,w:127,h:112},sourceSize:{w:127,h:112}},{filename:"Prisoner2Graphics0209",frame:{x:2218,y:1723,w:81,h:84},rotated:!1,trimmed:!0,spriteSourceSize:{x:-38,y:-62.6,w:127,h:112},sourceSize:{w:127,h:112}},{filename:"Prisoner2Graphics0210",frame:{x:2032,y:1823,w:89,h:71},rotated:!1,trimmed:!0,spriteSourceSize:{x:-46,y:-42.6,w:127,h:112},sourceSize:{w:127,h:112}},{filename:"Prisoner2Graphics0211",frame:{x:3393,y:1923,w:77,h:75},rotated:!1,trimmed:!0,spriteSourceSize:{x:-34,y:-50.6,w:127,h:112},sourceSize:{w:127,h:112}},{filename:"Prisoner2Graphics0212",frame:{x:2717,y:1831,w:101,h:61},rotated:!1,trimmed:!0,spriteSourceSize:{x:-31,y:-56.6,w:127,h:112},sourceSize:{w:127,h:112}},{filename:"Prisoner2Graphics0213",frame:{x:3312,y:1828,w:83,h:75},rotated:!1,trimmed:!0,spriteSourceSize:{x:-29,y:-57.6,w:127,h:112},sourceSize:{w:127,h:112}},{filename:"Prisoner2Graphics0214",frame:{x:2216,y:1216,w:71,h:84},rotated:!1,trimmed:!0,spriteSourceSize:{x:-28,y:-57.6,w:127,h:112},sourceSize:{w:127,h:112}},{filename:"Prisoner2Graphics0215",frame:{x:1076,y:1877,w:69,h:66},rotated:!1,trimmed:!0,spriteSourceSize:{x:-27,y:-39.6,w:127,h:112},sourceSize:{w:127,h:112}},{filename:"Prisoner2Graphics0216",frame:{x:2481,y:1214,w:67,h:77},rotated:!1,trimmed:!0,spriteSourceSize:{x:-26,y:-51.6,w:127,h:112},sourceSize:{w:127,h:112}},{filename:"Prisoner2Graphics0217",frame:{x:2121,y:1130,w:72,h:78},rotated:!1,trimmed:!0,spriteSourceSize:{x:-26,y:-51.6,w:127,h:112},sourceSize:{w:127,h:112}},{filename:"Prisoner2Graphics0218",frame:{x:4020,y:2017,w:70,h:68},rotated:!1,trimmed:!0,spriteSourceSize:{x:-26,y:-42.6,w:127,h:112},sourceSize:{w:127,h:112}},{filename:"Prisoner2Graphics0219",frame:{x:3,y:2044,w:72,h:68},rotated:!1,trimmed:!0,spriteSourceSize:{x:-29,y:-42.6,w:127,h:112},sourceSize:{w:127,h:112}},{filename:"Prisoner2Graphics0220",frame:{x:1933,y:2044,w:72,h:68},rotated:!1,trimmed:!0,spriteSourceSize:{x:-29,y:-42.6,w:127,h:112},sourceSize:{w:127,h:112}},{filename:"PrisonerGraphics0000",frame:{x:2027,y:1233,w:89,h:101},rotated:!1,trimmed:!0,spriteSourceSize:{x:-52,y:-75.9,w:121,h:120},sourceSize:{w:121,h:120}},{filename:"PrisonerGraphics0001",frame:{x:972,y:1259,w:89,h:101},rotated:!1,trimmed:!0,spriteSourceSize:{x:-52,y:-75.9,w:121,h:120},sourceSize:{w:121,h:120}},{filename:"PrisonerGraphics0002",frame:{x:1990,y:1522,w:92,h:88},rotated:!1,trimmed:!0,spriteSourceSize:{x:-52,y:-75.9,w:121,h:120},sourceSize:{w:121,h:120}},{filename:"PrisonerGraphics0003",frame:{x:1921,y:901,w:104,h:98},rotated:!1,trimmed:!0,spriteSourceSize:{x:-52,y:-75.9,w:121,h:120},sourceSize:{w:121,h:120}},{filename:"PrisonerGraphics0004",frame:{x:1096,y:1615,w:84,h:92},rotated:!1,trimmed:!0,spriteSourceSize:{x:-43,y:-75.9,w:121,h:120},sourceSize:{w:121,h:120}},{filename:"PrisonerGraphics0005",frame:{x:2895,y:1708,w:77,h:92},rotated:!1,trimmed:!0,spriteSourceSize:{x:-40,y:-76.9,w:121,h:120},sourceSize:{w:121,h:120}},{filename:"PrisonerGraphics0006",frame:{x:1257,y:1429,w:82,h:103},rotated:!1,trimmed:!0,spriteSourceSize:{x:-41,y:-76.9,w:121,h:120},sourceSize:{w:121,h:120}},{filename:"PrisonerGraphics0007",frame:{x:3394,y:1003,w:93,h:104},rotated:!1,trimmed:!0,spriteSourceSize:{x:-41,y:-76.9,w:121,h:120},sourceSize:{w:121,h:120}},{filename:"PrisonerGraphics0008",frame:{x:3478,y:1673,w:80,h:93},rotated:!1,trimmed:!0,spriteSourceSize:{x:-40,y:-76.9,w:121,h:120},sourceSize:{w:121,h:120}},{filename:"PrisonerGraphics0009",frame:{x:2312,y:1531,w:80,h:100},rotated:!1,trimmed:!0,spriteSourceSize:{x:-40,y:-76.9,w:121,h:120},sourceSize:{w:121,h:120}},{filename:"PrisonerGraphics0010",frame:{x:2744,y:907,w:95,h:106},rotated:!1,trimmed:!0,spriteSourceSize:{x:-53,y:-76.9,w:121,h:120},sourceSize:{w:121,h:120}},{filename:"PrisonerGraphics0011",frame:{x:3403,y:1110,w:84,h:108},rotated:!1,trimmed:!0,spriteSourceSize:{x:-41,y:-77.9,w:121,h:120},sourceSize:{w:121,h:120}},{filename:"PrisonerGraphics0012",frame:{x:2736,y:1619,w:78,h:98},rotated:!1,trimmed:!0,spriteSourceSize:{x:-41,y:-77.9,w:121,h:120},sourceSize:{w:121,h:120}},{filename:"PrisonerGraphics0013",frame:{x:1144,y:1505,w:77,h:107},rotated:!1,trimmed:!0,spriteSourceSize:{x:-40,y:-77.9,w:121,h:120},sourceSize:{w:121,h:120}},{filename:"PrisonerGraphics0014",frame:{x:3839,y:803,w:101,h:107},rotated:!1,trimmed:!0,spriteSourceSize:{x:-58,y:-77.9,w:121,h:120},sourceSize:{w:121,h:120}},{filename:"PrisonerGraphics0015",frame:{x:3,y:967,w:96,h:101},rotated:!1,trimmed:!0,spriteSourceSize:{x:-40,y:-77.9,w:121,h:120},sourceSize:{w:121,h:120}},{filename:"PrisonerGraphics0016",frame:{x:1156,y:1330,w:104,h:84},rotated:!1,trimmed:!0,spriteSourceSize:{x:-54,y:-77.9,w:121,h:120},sourceSize:{w:121,h:120}},{filename:"PrisonerGraphics0017",frame:{x:215,y:1002,w:96,h:101},rotated:!1,trimmed:!0,spriteSourceSize:{x:-53,y:-77.9,w:121,h:120},sourceSize:{w:121,h:120}},{filename:"PrisonerGraphics0018",frame:{x:1276,y:899,w:96,h:108},rotated:!1,trimmed:!0,spriteSourceSize:{x:-40,y:-77.9,w:121,h:120},sourceSize:{w:121,h:120}},{filename:"PrisonerGraphics0019",frame:{x:177,y:1490,w:77,h:108},rotated:!1,trimmed:!0,spriteSourceSize:{x:-40,y:-77.9,w:121,h:120},sourceSize:{w:121,h:120}},{filename:"PrisonerGraphics0020",frame:{x:3862,y:1076,w:87,h:108},rotated:!1,trimmed:!0,spriteSourceSize:{x:-44,y:-77.9,w:121,h:120},sourceSize:{w:121,h:120}},{filename:"PrisonerGraphics0021",frame:{x:3953,y:1314,w:83,h:108},rotated:!1,trimmed:!0,spriteSourceSize:{x:-40,y:-77.9,w:121,h:120},sourceSize:{w:121,h:120}},{filename:"PrisonerGraphics0022",frame:{x:2930,y:1326,w:82,h:107},rotated:!1,trimmed:!0,spriteSourceSize:{x:-43,y:-77.9,w:121,h:120},sourceSize:{w:121,h:120}},{filename:"PrisonerGraphics0023",frame:{x:818,y:951,w:92,h:106},rotated:!1,trimmed:!0,spriteSourceSize:{x:-40,y:-76.9,w:121,h:120},sourceSize:{w:121,h:120}},{filename:"PrisonerGraphics0024",frame:{x:257,y:1490,w:84,h:99},rotated:!1,trimmed:!0,spriteSourceSize:{x:-42,y:-76.9,w:121,h:120},sourceSize:{w:121,h:120}},{filename:"PrisonerGraphics0025",frame:{x:344,y:1509,w:78,h:105},rotated:!1,trimmed:!0,spriteSourceSize:{x:-41,y:-76.9,w:121,h:120},sourceSize:{w:121,h:120}},{filename:"PrisonerGraphics0026",frame:{x:3508,y:1567,w:77,h:103},rotated:!1,trimmed:!0,spriteSourceSize:{x:-40,y:-76.9,w:121,h:120},sourceSize:{w:121,h:120}},{filename:"PrisonerGraphics0027",frame:{x:1516,y:1597,w:79,h:99},rotated:!1,trimmed:!0,spriteSourceSize:{x:-42,y:-76.9,w:121,h:120},sourceSize:{w:121,h:120}},{filename:"PrisonerGraphics0028",frame:{x:102,y:1006,w:105,h:91},rotated:!1,trimmed:!0,spriteSourceSize:{x:-53,y:-75.9,w:121,h:120},sourceSize:{w:121,h:120}},{filename:"PrisonerGraphics0029",frame:{x:2227,y:1494,w:82,h:101},rotated:!1,trimmed:!0,spriteSourceSize:{x:-40,y:-75.9,w:121,h:120},sourceSize:{w:121,h:120}},{filename:"PrisonerGraphics0030",frame:{x:1806,y:1428,w:94,h:90},rotated:!1,trimmed:!0,spriteSourceSize:{x:-52,y:-75.9,w:121,h:120},sourceSize:{w:121,h:120}},{filename:"PrisonerGraphics0031",frame:{x:3366,y:1322,w:87,h:101},rotated:!1,trimmed:!0,spriteSourceSize:{x:-47,y:-75.9,w:121,h:120},sourceSize:{w:121,h:120}},{filename:"PrisonerGraphics0032",frame:{x:1064,y:1259,w:89,h:101},rotated:!1,trimmed:!0,spriteSourceSize:{x:-52,y:-75.9,w:121,h:120},sourceSize:{w:121,h:120}},{filename:"PrisonerGraphics0033",frame:{x:3126,y:1323,w:87,h:101},rotated:!1,trimmed:!0,spriteSourceSize:{x:-47,y:-75.9,w:121,h:120},sourceSize:{w:121,h:120}},{filename:"PrisonerGraphics0034",frame:{x:972,y:1259,w:89,h:101},rotated:!1,trimmed:!0,spriteSourceSize:{x:-52,y:-75.9,w:121,h:120},sourceSize:{w:121,h:120}},{filename:"PrisonerGraphics0035",frame:{x:3499,y:1270,w:89,h:101},rotated:!1,trimmed:!0,spriteSourceSize:{x:-52,y:-75.9,w:121,h:120},sourceSize:{w:121,h:120}},{filename:"PrisonerGraphics0036",frame:{x:2027,y:1233,w:89,h:101},rotated:!1,trimmed:!0,spriteSourceSize:{x:-52,y:-75.9,w:121,h:120},sourceSize:{w:121,h:120}},{filename:"PrisonerGraphics0037",frame:{x:90,y:1416,w:84,h:102},rotated:!1,trimmed:!0,spriteSourceSize:{x:-44,y:-76.9,w:121,h:120},sourceSize:{w:121,h:120}},{filename:"PrisonerGraphics0038",frame:{x:566,y:1321,w:87,h:102},rotated:!1,trimmed:!0,spriteSourceSize:{x:-44,y:-76.9,w:121,h:120},sourceSize:{w:121,h:120}},{filename:"PrisonerGraphics0039",frame:{x:1536,y:1388,w:84,h:103},rotated:!1,trimmed:!0,spriteSourceSize:{x:-44,y:-77.9,w:121,h:120},sourceSize:{w:121,h:120}},{filename:"PrisonerGraphics0040",frame:{x:95,y:1311,w:88,h:102},rotated:!1,trimmed:!0,spriteSourceSize:{x:-44,y:-77.9,w:121,h:120},sourceSize:{w:121,h:120}},{filename:"PrisonerGraphics0041",frame:{x:656,y:1417,w:84,h:102},rotated:!1,trimmed:!0,spriteSourceSize:{x:-44,y:-77.9,w:121,h:120},sourceSize:{w:121,h:120}},{filename:"PrisonerGraphics0042",frame:{x:2314,y:1426,w:83,h:102},rotated:!1,trimmed:!0,spriteSourceSize:{x:-43,y:-77.9,w:121,h:120},sourceSize:{w:121,h:120}},{filename:"PrisonerGraphics0043",frame:{x:3490,y:1109,w:90,h:102},rotated:!1,trimmed:!0,spriteSourceSize:{x:-49,y:-77.9,w:121,h:120},sourceSize:{w:121,h:120}},{filename:"PrisonerGraphics0044",frame:{x:1921,y:1002,w:94,h:103},rotated:!1,trimmed:!0,spriteSourceSize:{x:-50,y:-77.9,w:121,h:120},sourceSize:{w:121,h:120}},{filename:"PrisonerGraphics0045",frame:{x:2639,y:897,w:102,h:102},rotated:!1,trimmed:!0,spriteSourceSize:{x:-51,y:-76.9,w:121,h:120},sourceSize:{w:121,h:120}},{filename:"PrisonerGraphics0046",frame:{x:401,y:802,w:85,h:102},rotated:!1,trimmed:!0,spriteSourceSize:{x:-43,y:-76.9,w:121,h:120},sourceSize:{w:121,h:120}},{filename:"PrisonerGraphics0047",frame:{x:3862,y:1314,w:88,h:102},rotated:!1,trimmed:!0,spriteSourceSize:{x:-42,y:-76.9,w:121,h:120},sourceSize:{w:121,h:120}},{filename:"PrisonerGraphics0048",frame:{x:2055,y:1417,w:84,h:102},rotated:!1,trimmed:!0,spriteSourceSize:{x:-42,y:-76.9,w:121,h:120},sourceSize:{w:121,h:120}},{filename:"PrisonerGraphics0049",frame:{x:2840,y:1315,w:87,h:103},rotated:!1,trimmed:!0,spriteSourceSize:{x:-42,y:-77.9,w:121,h:120},sourceSize:{w:121,h:120}},{filename:"PrisonerGraphics0050",frame:{x:516,y:1101,w:90,h:103},rotated:!1,trimmed:!0,spriteSourceSize:{x:-49,y:-77.9,w:121,h:120},sourceSize:{w:121,h:120}},{filename:"PrisonerGraphics0051",frame:{x:1741,y:1080,w:91,h:103},rotated:!1,trimmed:!0,spriteSourceSize:{x:-50,y:-77.9,w:121,h:120},sourceSize:{w:121,h:120}},{filename:"PrisonerGraphics0052",frame:{x:3650,y:1389,w:84,h:103},rotated:!1,trimmed:!0,spriteSourceSize:{x:-43,y:-77.9,w:121,h:120},sourceSize:{w:121,h:120}},{filename:"PrisonerGraphics0053",frame:{x:2606,y:1002,w:94,h:103},rotated:!1,trimmed:!0,spriteSourceSize:{x:-49,y:-77.9,w:121,h:120},sourceSize:{w:121,h:120}},{filename:"PrisonerGraphics0054",frame:{x:3107,y:1427,w:83,h:102},rotated:!1,trimmed:!0,spriteSourceSize:{x:-43,y:-76.9,w:121,h:120},sourceSize:{w:121,h:120}},{filename:"PrisonerGraphics0055",frame:{x:1646,y:1080,w:92,h:102},rotated:!1,trimmed:!0,spriteSourceSize:{x:-48,y:-76.9,w:121,h:120},sourceSize:{w:121,h:120}},{filename:"PrisonerGraphics0056",frame:{x:90,y:1416,w:84,h:102},rotated:!1,trimmed:!0,spriteSourceSize:{x:-44,y:-76.9,w:121,h:120},sourceSize:{w:121,h:120}},{filename:"PrisonerGraphics0057",frame:{x:3960,y:1709,w:84,h:84},rotated:!1,trimmed:!0,spriteSourceSize:{x:-45,y:-79.9,w:121,h:120},sourceSize:{w:121,h:120}},{filename:"PrisonerGraphics0058",frame:{x:2565,y:1538,w:87,h:92},rotated:!1,trimmed:!0,spriteSourceSize:{x:-45,y:-78.9,w:121,h:120},sourceSize:{w:121,h:120}},{filename:"PrisonerGraphics0059",frame:{x:3219,y:1615,w:84,h:92},rotated:!1,trimmed:!0,spriteSourceSize:{x:-45,y:-78.9,w:121,h:120},sourceSize:{w:121,h:120}},{filename:"PrisonerGraphics0060",frame:{x:3193,y:1508,w:84,h:98},rotated:!1,trimmed:!0,spriteSourceSize:{x:-45,y:-76.9,w:121,h:120},sourceSize:{w:121,h:120}},{filename:"PrisonerGraphics0061",frame:{x:416,y:1785,w:84,h:79},rotated:!1,trimmed:!0,spriteSourceSize:{x:-43,y:-77.9,w:121,h:120},sourceSize:{w:121,h:120}},{filename:"PrisonerGraphics0062",frame:{x:3860,y:1786,w:84,h:79},rotated:!1,trimmed:!0,spriteSourceSize:{x:-43,y:-78.9,w:121,h:120},sourceSize:{w:121,h:120}},{filename:"PrisonerGraphics0063",frame:{x:3433,y:1769,w:85,h:79},rotated:!1,trimmed:!0,spriteSourceSize:{x:-44,y:-78.9,w:121,h:120},sourceSize:{w:121,h:120}},{filename:"PrisonerGraphics0064",frame:{x:877,y:1241,w:92,h:98},rotated:!1,trimmed:!0,spriteSourceSize:{x:-43,y:-78.9,w:121,h:120},sourceSize:{w:121,h:120}},{filename:"PrisonerGraphics0065",frame:{x:3222,y:1110,w:84,h:109},rotated:!1,trimmed:!0,spriteSourceSize:{x:-43,y:-77.9,w:121,h:120},sourceSize:{w:121,h:120}},{filename:"PrisonerGraphics0066",frame:{x:2367,y:1104,w:90,h:103},rotated:!1,trimmed:!0,spriteSourceSize:{x:-50,y:-76.9,w:121,h:120},sourceSize:{w:121,h:120}},{filename:"PrisonerGraphics0067",frame:{x:257,y:1592,w:84,h:94},rotated:!1,trimmed:!0,spriteSourceSize:{x:-44,y:-77.9,w:121,h:120},sourceSize:{w:121,h:120}},{filename:"PrisonerGraphics0068",frame:{x:3306,y:1661,w:84,h:90},rotated:!1,trimmed:!0,spriteSourceSize:{x:-44,y:-78.9,w:121,h:120},sourceSize:{w:121,h:120}},{filename:"PrisonerGraphics0069",frame:{x:1800,y:1521,w:91,h:89},rotated:!1,trimmed:!0,spriteSourceSize:{x:-48,y:-78.9,w:121,h:120},sourceSize:{w:121,h:120}},{filename:"PrisonerGraphics0070",frame:{x:3960,y:1709,w:84,h:84},rotated:!1,trimmed:!0,spriteSourceSize:{x:-45,y:-79.9,w:121,h:120},sourceSize:{w:121,h:120}},{filename:"PrisonerGraphics0071",frame:{x:2027,y:1233,w:89,h:101},rotated:!1,trimmed:!0,spriteSourceSize:{x:-52,y:-75.9,w:121,h:120},sourceSize:{w:121,h:120}},{filename:"PrisonerGraphics0072",frame:{x:2367,y:1004,w:99,h:97},rotated:!1,trimmed:!0,spriteSourceSize:{x:-47,y:-75.9,w:121,h:120},sourceSize:{w:121,h:120}},{filename:"PrisonerGraphics0073",frame:{x:1136,y:1990,w:88,h:59},rotated:!1,trimmed:!0,spriteSourceSize:{x:-46,y:-58.9,w:121,h:120},sourceSize:{w:121,h:120}},{filename:"PrisonerGraphics0074",frame:{x:2614,y:1788,w:100,h:67},rotated:!1,trimmed:!0,spriteSourceSize:{x:-51,y:-53.9,w:121,h:120},sourceSize:{w:121,h:120}},{filename:"PrisonerGraphics0075",frame:{x:866,y:1363,w:109,h:80},rotated:!1,trimmed:!0,spriteSourceSize:{x:-52,y:-61.9,w:121,h:120},sourceSize:{w:121,h:120}},{filename:"PrisonerGraphics0076",frame:{x:1744,y:1789,w:95,h:69},rotated:!1,trimmed:!0,spriteSourceSize:{x:-47,y:-54.9,w:121,h:120},sourceSize:{w:121,h:120}},{filename:"PrisonerGraphics0077",frame:{x:2267,y:1634,w:88,h:86},rotated:!1,trimmed:!0,spriteSourceSize:{x:-40,y:-85.9,w:121,h:120},sourceSize:{w:121,h:120}},{filename:"PrisonerGraphics0078",frame:{x:3643,y:1495,w:82,h:101},rotated:!1,trimmed:!0,spriteSourceSize:{x:-42,y:-86.9,w:121,h:120},sourceSize:{w:121,h:120}},{filename:"PrisonerGraphics0079",frame:{x:3675,y:1177,w:89,h:102},rotated:!1,trimmed:!0,spriteSourceSize:{x:-38,y:-87.9,w:121,h:120},sourceSize:{w:121,h:120}},{filename:"PrisonerGraphics0080",frame:{x:1275,y:1010,w:84,h:113},rotated:!1,trimmed:!0,spriteSourceSize:{x:-47,y:-87.9,w:121,h:120},sourceSize:{w:121,h:120}},{filename:"PrisonerGraphics0081",frame:{x:1535,y:796,w:97,h:113},rotated:!1,trimmed:!0,spriteSourceSize:{x:-52,y:-87.9,w:121,h:120},sourceSize:{w:121,h:120}},{filename:"PrisonerGraphics0082",frame:{x:3943,y:804,w:95,h:113},rotated:!1,trimmed:!0,spriteSourceSize:{x:-52,y:-87.9,w:121,h:120},sourceSize:{w:121,h:120}},{filename:"PrisonerGraphics0083",frame:{x:1635,y:908,w:89,h:113},rotated:!1,trimmed:!0,spriteSourceSize:{x:-52,y:-87.9,w:121,h:120},sourceSize:{w:121,h:120}},{filename:"PrisonerGraphics0084",frame:{x:2273,y:1004,w:91,h:106},rotated:!1,trimmed:!0,spriteSourceSize:{x:-52,y:-80.9,w:121,h:120},sourceSize:{w:121,h:120}},{filename:"PrisonerGraphics0085",frame:{x:648,y:1522,w:91,h:89},rotated:!1,trimmed:!0,spriteSourceSize:{x:-52,y:-63.9,w:121,h:120},sourceSize:{w:121,h:120}},{filename:"PrisonerGraphics0086",frame:{x:290,y:1272,w:89,h:101},rotated:!1,trimmed:!0,spriteSourceSize:{x:-52,y:-75.9,w:121,h:120},sourceSize:{w:121,h:120}},{filename:"PrisonerGraphics0087",frame:{x:2958,y:898,w:101,h:103},rotated:!1,trimmed:!0,spriteSourceSize:{x:-52,y:-75.9,w:121,h:120},sourceSize:{w:121,h:120}},{filename:"PrisonerGraphics0088",frame:{x:1864,y:1334,w:96,h:91},rotated:!1,trimmed:!0,spriteSourceSize:{x:-52,y:-63.9,w:121,h:120},sourceSize:{w:121,h:120}},{filename:"PrisonerGraphics0089",frame:{x:3835,y:1419,w:93,h:92},rotated:!1,trimmed:!0,spriteSourceSize:{x:-52,y:-63.9,w:121,h:120},sourceSize:{w:121,h:120}},{filename:"PrisonerGraphics0090",frame:{x:3,y:1071,w:96,h:98},rotated:!1,trimmed:!0,spriteSourceSize:{x:-52,y:-76.9,w:121,h:120},sourceSize:{w:121,h:120}},{filename:"PrisonerGraphics0091",frame:{x:3035,y:1532,w:89,h:90},rotated:!1,trimmed:!0,spriteSourceSize:{x:-52,y:-68.9,w:121,h:120},sourceSize:{w:121,h:120}},{filename:"PrisonerGraphics0092",frame:{x:2460,y:1107,w:89,h:104},rotated:!1,trimmed:!0,spriteSourceSize:{x:-52,y:-75.9,w:121,h:120},sourceSize:{w:121,h:120}},{filename:"PrisonerGraphics0093",frame:{x:2119,y:1317,w:92,h:97},rotated:!1,trimmed:!0,spriteSourceSize:{x:-52,y:-75.9,w:121,h:120},sourceSize:{w:121,h:120}},{filename:"PrisonerGraphics0094",frame:{x:363,y:1409,w:89,h:97},rotated:!1,trimmed:!0,spriteSourceSize:{x:-52,y:-75.9,w:121,h:120},sourceSize:{w:121,h:120}},{filename:"PrisonerGraphics0095",frame:{x:1422,y:1655,w:89,h:85},rotated:!1,trimmed:!0,spriteSourceSize:{x:-52,y:-63.9,w:121,h:120},sourceSize:{w:121,h:120}},{filename:"PrisonerGraphics0096",frame:{x:656,y:1321,w:95,h:93},rotated:!1,trimmed:!0,spriteSourceSize:{x:-52,y:-70.9,w:121,h:120},sourceSize:{w:121,h:120}},{filename:"PrisonerGraphics0097",frame:{x:2882,y:1107,w:89,h:104},rotated:!1,trimmed:!0,spriteSourceSize:{x:-52,y:-77.9,w:121,h:120},sourceSize:{w:121,h:120}},{filename:"PrisonerGraphics0098",frame:{x:714,y:846,w:101,h:105},rotated:!1,trimmed:!0,spriteSourceSize:{x:-52,y:-77.9,w:121,h:120},sourceSize:{w:121,h:120}},{filename:"PrisonerGraphics0099",frame:{x:3,y:1277,w:89,h:101},rotated:!1,trimmed:!0,spriteSourceSize:{x:-52,y:-75.9,w:121,h:120},sourceSize:{w:121,h:120}},{filename:"PrisonerGraphics0100",frame:{x:3290,y:898,w:101,h:103},rotated:!1,trimmed:!0,spriteSourceSize:{x:-52,y:-75.9,w:121,h:120},sourceSize:{w:121,h:120}},{filename:"PrisonerGraphics0101",frame:{x:2573,y:1334,w:96,h:91},rotated:!1,trimmed:!0,spriteSourceSize:{x:-52,y:-63.9,w:121,h:120},sourceSize:{w:121,h:120}},{filename:"PrisonerGraphics0102",frame:{x:2764,y:1421,w:93,h:92},rotated:!1,trimmed:!0,spriteSourceSize:{x:-52,y:-63.9,w:121,h:120},sourceSize:{w:121,h:120}},{filename:"PrisonerGraphics0103",frame:{x:3763,y:1076,w:96,h:98},rotated:!1,trimmed:!0,spriteSourceSize:{x:-52,y:-76.9,w:121,h:120},sourceSize:{w:121,h:120}},{filename:"PrisonerGraphics0104",frame:{x:3035,y:1532,w:89,h:90},rotated:!1,trimmed:!0,spriteSourceSize:{x:-52,y:-68.9,w:121,h:120},sourceSize:{w:121,h:120}},{filename:"PrisonerGraphics0105",frame:{x:2460,y:1107,w:89,h:104},rotated:!1,trimmed:!0,spriteSourceSize:{x:-52,y:-75.9,w:121,h:120},sourceSize:{w:121,h:120}},{filename:"PrisonerGraphics0106",frame:{x:1697,y:1593,w:89,h:89},rotated:!1,trimmed:!0,spriteSourceSize:{x:-52,y:-67.9,w:121,h:120},sourceSize:{w:121,h:120}},{filename:"PrisonerGraphics0107",frame:{x:3612,y:949,w:101,h:97},rotated:!1,trimmed:!0,spriteSourceSize:{x:-52,y:-75.9,w:121,h:120},sourceSize:{w:121,h:120}},{filename:"PrisonerGraphics0108",frame:{x:1352,y:1341,w:89,h:98},rotated:!1,trimmed:!0,spriteSourceSize:{x:-52,y:-75.9,w:121,h:120},sourceSize:{w:121,h:120}},{filename:"PrisonerGraphics0109",frame:{x:1050,y:1472,w:91,h:92},rotated:!1,trimmed:!0,spriteSourceSize:{x:-52,y:-64.9,w:121,h:120},sourceSize:{w:121,h:120}},{filename:"PrisonerGraphics0110",frame:{x:290,y:1272,w:89,h:101},rotated:!1,trimmed:!0,spriteSourceSize:{x:-52,y:-75.9,w:121,h:120},sourceSize:{w:121,h:120}},{filename:"PrisonerGraphics0111",frame:{x:2502,y:899,w:101,h:102},rotated:!1,trimmed:!0,spriteSourceSize:{x:-52,y:-75.9,w:121,h:120},sourceSize:{w:121,h:120}},{filename:"PrisonerGraphics0112",frame:{x:3835,y:1419,w:93,h:92},rotated:!1,trimmed:!0,spriteSourceSize:{x:-52,y:-63.9,w:121,h:120},sourceSize:{w:121,h:120}},{filename:"PrisonerGraphics0113",frame:{x:2085,y:1598,w:92,h:85},rotated:!1,trimmed:!0,spriteSourceSize:{x:-52,y:-63.9,w:121,h:120},sourceSize:{w:121,h:120}},{filename:"PrisonerGraphics0114",frame:{x:2460,y:1107,w:89,h:104},rotated:!1,trimmed:!0,spriteSourceSize:{x:-52,y:-75.9,w:121,h:120},sourceSize:{w:121,h:120}},{filename:"PrisonerGraphics0115",frame:{x:3308,y:1426,w:100,h:85},rotated:!1,trimmed:!0,spriteSourceSize:{x:-52,y:-63.9,w:121,h:120},sourceSize:{w:121,h:120}},{filename:"PrisonerGraphics0116",frame:{x:1183,y:1625,w:89,h:86},rotated:!1,trimmed:!0,spriteSourceSize:{x:-52,y:-63.9,w:121,h:120},sourceSize:{w:121,h:120}},{filename:"PrisonerGraphics0117",frame:{x:1172,y:899,w:101,h:103},rotated:!1,trimmed:!0,spriteSourceSize:{x:-52,y:-77.9,w:121,h:120},sourceSize:{w:121,h:120}},{filename:"PrisonerGraphics0118",frame:{x:290,y:1272,w:89,h:101},rotated:!1,trimmed:!0,spriteSourceSize:{x:-52,y:-75.9,w:121,h:120},sourceSize:{w:121,h:120}},{filename:"PrisonerGraphics0119",frame:{x:1817,y:901,w:101,h:101},rotated:!1,trimmed:!0,spriteSourceSize:{x:-52,y:-75.9,w:121,h:120},sourceSize:{w:121,h:120}},{filename:"PrisonerGraphics0120",frame:{x:3591,y:1282,w:89,h:101},rotated:!1,trimmed:!0,spriteSourceSize:{x:-52,y:-75.9,w:121,h:120},sourceSize:{w:121,h:120}},{filename:"PrisonerGraphics0121",frame:{x:1588,y:1284,w:89,h:101},rotated:!1,trimmed:!0,spriteSourceSize:{x:-52,y:-75.9,w:121,h:120},sourceSize:{w:121,h:120}},{filename:"PrisonerGraphics0122",frame:{x:3683,y:1285,w:89,h:101},rotated:!1,trimmed:!0,spriteSourceSize:{x:-52,y:-75.9,w:121,h:120},sourceSize:{w:121,h:120}},{filename:"PrisonerGraphics0123",frame:{x:190,y:1289,w:89,h:101},rotated:!1,trimmed:!0,spriteSourceSize:{x:-52,y:-75.9,w:121,h:120},sourceSize:{w:121,h:120}},{filename:"PrisonerGraphics0124",frame:{x:1479,y:912,w:98,h:101},rotated:!1,trimmed:!0,spriteSourceSize:{x:-52,y:-75.9,w:121,h:120},sourceSize:{w:121,h:120}},{filename:"PrisonerGraphics0125",frame:{x:2481,y:1303,w:89,h:101},rotated:!1,trimmed:!0,spriteSourceSize:{x:-52,y:-75.9,w:121,h:120},sourceSize:{w:121,h:120}},{filename:"PrisonerGraphics0126",frame:{x:382,y:1305,w:89,h:101},rotated:!1,trimmed:!0,spriteSourceSize:{x:-52,y:-75.9,w:121,h:120},sourceSize:{w:121,h:120}},{filename:"PrisonerGraphics0127",frame:{x:474,y:1308,w:89,h:101},rotated:!1,trimmed:!0,spriteSourceSize:{x:-52,y:-75.9,w:121,h:120},sourceSize:{w:121,h:120}},{filename:"PrisonerGraphics0128",frame:{x:1680,y:1309,w:89,h:101},rotated:!1,trimmed:!0,spriteSourceSize:{x:-52,y:-75.9,w:121,h:120},sourceSize:{w:121,h:120}},{filename:"PrisonerGraphics0129",frame:{x:1772,y:1309,w:89,h:101},rotated:!1,trimmed:!0,spriteSourceSize:{x:-52,y:-75.9,w:121,h:120},sourceSize:{w:121,h:120}},{filename:"PrisonerGraphics0130",frame:{x:985,y:1155,w:90,h:101},rotated:!1,trimmed:!0,spriteSourceSize:{x:-52,y:-75.9,w:121,h:120},sourceSize:{w:121,h:120}},{filename:"PrisonerGraphics0131",frame:{x:2027,y:1233,w:89,h:101},rotated:!1,trimmed:!0,spriteSourceSize:{x:-52,y:-75.9,w:121,h:120},sourceSize:{w:121,h:120}},{filename:"PrisonerGraphics0132",frame:{x:3913,y:1605,w:77,h:101},rotated:!1,trimmed:!0,spriteSourceSize:{x:-40,y:-75.9,w:121,h:120},sourceSize:{w:121,h:120}},{filename:"PrisonerGraphics0133",frame:{x:2734,y:1516,w:81,h:100},rotated:!1,trimmed:!0,spriteSourceSize:{x:-44,y:-74.9,w:121,h:120},sourceSize:{w:121,h:120}},{filename:"PrisonerGraphics0134",frame:{x:2485,y:1608,w:77,h:99},rotated:!1,trimmed:!0,spriteSourceSize:{x:-40,y:-73.9,w:121,h:120},sourceSize:{w:121,h:120}},{filename:"PrisonerGraphics0135",frame:{x:3,y:1592,w:80,h:99},rotated:!1,trimmed:!0,spriteSourceSize:{x:-43,y:-73.9,w:121,h:120},sourceSize:{w:121,h:120}},{filename:"PrisonerGraphics0136",frame:{x:2987,y:1625,w:77,h:99},rotated:!1,trimmed:!0,spriteSourceSize:{x:-40,y:-73.9,w:121,h:120},sourceSize:{w:121,h:120}},{filename:"PrisonerGraphics0137",frame:{x:344,y:1617,w:78,h:99},rotated:!1,trimmed:!0,spriteSourceSize:{x:-41,y:-73.9,w:121,h:120},sourceSize:{w:121,h:120}},{filename:"PrisonerGraphics0138",frame:{x:2443,y:1710,w:81,h:87},rotated:!1,trimmed:!0,spriteSourceSize:{x:-38,y:-61.9,w:121,h:120},sourceSize:{w:121,h:120}},{filename:"PrisonerGraphics0139",frame:{x:1078,y:1155,w:90,h:101},rotated:!1,trimmed:!0,spriteSourceSize:{x:-46,y:-75.9,w:121,h:120},sourceSize:{w:121,h:120}},{filename:"PrisonerGraphics0140",frame:{x:1623,y:1413,w:77,h:112},rotated:!1,trimmed:!0,spriteSourceSize:{x:-40,y:-88.9,w:121,h:120},sourceSize:{w:121,h:120}},{filename:"PrisonerGraphics0141",frame:{x:504,y:1882,w:75,h:80},rotated:!1,trimmed:!0,spriteSourceSize:{x:-38,y:-58.9,w:121,h:120},sourceSize:{w:121,h:120}},{filename:"PrisonerGraphics0142",frame:{x:1593,y:1730,w:77,h:88},rotated:!1,trimmed:!0,spriteSourceSize:{x:-38,y:-74.9,w:121,h:120},sourceSize:{w:121,h:120}},{filename:"PrisonerGraphics0143",frame:{x:2321,y:1315,w:83,h:108},rotated:!1,trimmed:!0,spriteSourceSize:{x:-43,y:-84.9,w:121,h:120},sourceSize:{w:121,h:120}},{filename:"PrisonerGraphics0144",frame:{x:1514,y:1699,w:76,h:96},rotated:!1,trimmed:!0,spriteSourceSize:{x:-39,y:-77.9,w:121,h:120},sourceSize:{w:121,h:120}},{filename:"PrisonerGraphics0145",frame:{x:1923,y:1944,w:76,h:72},rotated:!1,trimmed:!0,spriteSourceSize:{x:-39,y:-71.9,w:121,h:120},sourceSize:{w:121,h:120}},{filename:"PrisonerGraphics0146",frame:{x:2469,y:2051,w:84,h:58},rotated:!1,trimmed:!0,spriteSourceSize:{x:-47,y:-57.9,w:121,h:120},sourceSize:{w:121,h:120}},{filename:"PrisonerGraphics0147",frame:{x:1952,y:1701,w:83,h:87},rotated:!1,trimmed:!0,spriteSourceSize:{x:-46,y:-61.9,w:121,h:120},sourceSize:{w:121,h:120}},{filename:"PrisonerGraphics0148",frame:{x:282,y:1376,w:78,h:111},rotated:!1,trimmed:!0,spriteSourceSize:{x:-41,y:-85.9,w:121,h:120},sourceSize:{w:121,h:120}},{filename:"PrisonerGraphics0149",frame:{x:2655,y:1619,w:78,h:99},rotated:!1,trimmed:!0,spriteSourceSize:{x:-41,y:-73.9,w:121,h:120},sourceSize:{w:121,h:120}},{filename:"PrisonerGraphics0150",frame:{x:2860,y:1436,w:75,h:112},rotated:!1,trimmed:!0,spriteSourceSize:{x:-38,y:-86.9,w:121,h:120},sourceSize:{w:121,h:120}},{filename:"PrisonerGraphics0151",frame:{x:2138,y:1750,w:75,h:89},rotated:!1,trimmed:!0,spriteSourceSize:{x:-38,y:-63.9,w:121,h:120},sourceSize:{w:121,h:120}},{filename:"PrisonerGraphics0152",frame:{x:3993,y:1605,w:77,h:101},rotated:!1,trimmed:!0,spriteSourceSize:{x:-38,y:-75.9,w:121,h:120},sourceSize:{w:121,h:120}},{filename:"PrisonerGraphics0153",frame:{x:2818,y:1551,w:79,h:101},rotated:!1,trimmed:!0,spriteSourceSize:{x:-40,y:-75.9,w:121,h:120},sourceSize:{w:121,h:120}},{filename:"PrisonerGraphics0154",frame:{x:2818,y:1551,w:79,h:101},rotated:!1,trimmed:!0,spriteSourceSize:{x:-40,y:-75.9,w:121,h:120},sourceSize:{w:121,h:120}},{filename:"PrisonerGraphics0155",frame:{x:2818,y:1551,w:79,h:101},rotated:!1,trimmed:!0,spriteSourceSize:{x:-40,y:-75.9,w:121,h:120},sourceSize:{w:121,h:120}},{filename:"PrisonerGraphics0156",frame:{x:2818,y:1551,w:79,h:101},rotated:!1,trimmed:!0,spriteSourceSize:{x:-40,y:-75.9,w:121,h:120},sourceSize:{w:121,h:120}},{filename:"PrisonerGraphics0157",frame:{x:2818,y:1551,w:79,h:101},rotated:!1,trimmed:!0,spriteSourceSize:{x:-40,y:-75.9,w:121,h:120},sourceSize:{w:121,h:120}},{filename:"PrisonerGraphics0158",frame:{x:2818,y:1551,w:79,h:101},rotated:!1,trimmed:!0,spriteSourceSize:{x:-40,y:-75.9,w:121,h:120},sourceSize:{w:121,h:120}},{filename:"PrisonerGraphics0159",frame:{x:2818,y:1551,w:79,h:101},rotated:!1,trimmed:!0,spriteSourceSize:{x:-40,y:-75.9,w:121,h:120},sourceSize:{w:121,h:120}},{filename:"PrisonerGraphics0160",frame:{x:2818,y:1551,w:79,h:101},rotated:!1,trimmed:!0,spriteSourceSize:{x:-40,y:-75.9,w:121,h:120},sourceSize:{w:121,h:120}},{filename:"PrisonerGraphics0161",frame:{x:2818,y:1551,w:79,h:101},rotated:!1,trimmed:!0,spriteSourceSize:{x:-40,y:-75.9,w:121,h:120},sourceSize:{w:121,h:120}},{filename:"PrisonerGraphics0162",frame:{x:2818,y:1551,w:79,h:101},rotated:!1,trimmed:!0,spriteSourceSize:{x:-40,y:-75.9,w:121,h:120},sourceSize:{w:121,h:120}},{filename:"PrisonerGraphics0163",frame:{x:2818,y:1551,w:79,h:101},rotated:!1,trimmed:!0,spriteSourceSize:{x:-40,y:-75.9,w:121,h:120},sourceSize:{w:121,h:120}},{filename:"PrisonerGraphics0164",frame:{x:2818,y:1551,w:79,h:101},rotated:!1,trimmed:!0,spriteSourceSize:{x:-40,y:-75.9,w:121,h:120},sourceSize:{w:121,h:120}},{filename:"PrisonerGraphics0165",frame:{x:2818,y:1551,w:79,h:101},rotated:!1,trimmed:!0,spriteSourceSize:{x:-40,y:-75.9,w:121,h:120},sourceSize:{w:121,h:120}},{filename:"PrisonerGraphics0166",frame:{x:1903,y:1438,w:84,h:100},rotated:!1,trimmed:!0,spriteSourceSize:{x:-45,y:-75.9,w:121,h:120},sourceSize:{w:121,h:120}},{filename:"PrisonerGraphics0167",frame:{x:2180,y:1598,w:84,h:93},rotated:!1,trimmed:!0,spriteSourceSize:{x:-45,y:-75.9,w:121,h:120},sourceSize:{w:121,h:120}},{filename:"PrisonerGraphics0168",frame:{x:3230,y:1827,w:79,h:79},rotated:!1,trimmed:!0,spriteSourceSize:{x:-48,y:-65.9,w:121,h:120},sourceSize:{w:121,h:120}},{filename:"PrisonerGraphics0169",frame:{x:1990,y:1438,w:62,h:79},rotated:!1,trimmed:!0,spriteSourceSize:{x:-40,y:-55.9,w:121,h:120},sourceSize:{w:121,h:120}},{filename:"PrisonerGraphics0170",frame:{x:582,y:1922,w:80,h:73},rotated:!1,trimmed:!0,spriteSourceSize:{x:-40,y:-54.9,w:121,h:120},sourceSize:{w:121,h:120}},{filename:"PrisonerGraphics0171",frame:{x:2938,y:1436,w:74,h:85},rotated:!1,trimmed:!0,spriteSourceSize:{x:-34,y:-74.9,w:121,h:120},sourceSize:{w:121,h:120}},{filename:"PrisonerGraphics0172",frame:{x:252,y:2106,w:60,h:50},rotated:!1,trimmed:!0,spriteSourceSize:{x:-32,y:-49.9,w:121,h:120},sourceSize:{w:121,h:120}},{filename:"PrisonerGraphics0173",frame:{x:2624,y:2353,w:58,h:51},rotated:!1,trimmed:!0,spriteSourceSize:{x:-31,y:-50.9,w:121,h:120},sourceSize:{w:121,h:120}},{filename:"PrisonerGraphics0174",frame:{x:625,y:2684,w:56,h:51},rotated:!1,trimmed:!0,spriteSourceSize:{x:-30,y:-50.9,w:121,h:120},sourceSize:{w:121,h:120}},{filename:"PrisonerGraphics0175",frame:{x:684,y:2684,w:56,h:51},rotated:!1,trimmed:!0,spriteSourceSize:{x:-30,y:-50.9,w:121,h:120},sourceSize:{w:121,h:120}},{filename:"PrisonerGraphics0176",frame:{x:1605,y:2699,w:54,h:51},rotated:!1,trimmed:!0,spriteSourceSize:{x:-29,y:-50.9,w:121,h:120},sourceSize:{w:121,h:120}},{filename:"PrisonerGraphics0177",frame:{x:2361,y:2690,w:54,h:52},rotated:!1,trimmed:!0,spriteSourceSize:{x:-29,y:-51.9,w:121,h:120},sourceSize:{w:121,h:120}},{filename:"PrisonerGraphics0178",frame:{x:3177,y:2692,w:54,h:52},rotated:!1,trimmed:!0,spriteSourceSize:{x:-29,y:-51.9,w:121,h:120},sourceSize:{w:121,h:120}},{filename:"PrisonerGraphics0179",frame:{x:1422,y:2669,w:55,h:52},rotated:!1,trimmed:!0,spriteSourceSize:{x:-30,y:-51.9,w:121,h:120},sourceSize:{w:121,h:120}},{filename:"PrisonerGraphics0180",frame:{x:2303,y:2670,w:55,h:52},rotated:!1,trimmed:!0,spriteSourceSize:{x:-30,y:-51.9,w:121,h:120},sourceSize:{w:121,h:120}},{filename:"PrisonerGraphics0181",frame:{x:181,y:2672,w:55,h:52},rotated:!1,trimmed:!0,spriteSourceSize:{x:-30,y:-51.9,w:121,h:120},sourceSize:{w:121,h:120}},{filename:"PrisonerGraphics0182",frame:{x:938,y:2673,w:55,h:52},rotated:!1,trimmed:!0,spriteSourceSize:{x:-30,y:-51.9,w:121,h:120},sourceSize:{w:121,h:120}},{filename:"PrisonerGraphics0183",frame:{x:2033,y:2673,w:55,h:52},rotated:!1,trimmed:!0,spriteSourceSize:{x:-30,y:-51.9,w:121,h:120},sourceSize:{w:121,h:120}},{filename:"PrisonerGraphics0184",frame:{x:2091,y:2673,w:55,h:52},rotated:!1,trimmed:!0,spriteSourceSize:{x:-30,y:-51.9,w:121,h:120},sourceSize:{w:121,h:120}},{filename:"PrisonerGraphics0185",frame:{x:2149,y:2673,w:55,h:52},rotated:!1,trimmed:!0,spriteSourceSize:{x:-30,y:-51.9,w:121,h:120},sourceSize:{w:121,h:120}},{filename:"PrisonerGraphics0186",frame:{x:2207,y:2676,w:55,h:52},rotated:!1,trimmed:!0,spriteSourceSize:{x:-30,y:-51.9,w:121,h:120},sourceSize:{w:121,h:120}},{filename:"PrisonerGraphics0187",frame:{x:1823,y:2682,w:55,h:52},rotated:!1,trimmed:!0,spriteSourceSize:{x:-30,y:-51.9,w:121,h:120},sourceSize:{w:121,h:120}},{filename:"PrisonerGraphics0188",frame:{x:1881,y:2682,w:55,h:52},rotated:!1,trimmed:!0,spriteSourceSize:{x:-30,y:-51.9,w:121,h:120},sourceSize:{w:121,h:120}},{filename:"PrisonerGraphics0189",frame:{x:1881,y:2682,w:55,h:52},rotated:!1,trimmed:!0,spriteSourceSize:{x:-30,y:-50.9,w:121,h:120},sourceSize:{w:121,h:120}},{filename:"PrisonerGraphics0190",frame:{x:1881,y:2682,w:55,h:52},rotated:!1,trimmed:!0,spriteSourceSize:{x:-30,y:-51.9,w:121,h:120},sourceSize:{w:121,h:120}},{filename:"PrisonerGraphics0191",frame:{x:396,y:2683,w:55,h:52},rotated:!1,trimmed:!0,spriteSourceSize:{x:-30,y:-51.9,w:121,h:120},sourceSize:{w:121,h:120}},{filename:"PrisonerGraphics0192",frame:{x:396,y:2683,w:55,h:52},rotated:!1,trimmed:!0,spriteSourceSize:{x:-30,y:-51.9,w:121,h:120},sourceSize:{w:121,h:120}},{filename:"PrisonerGraphics0193",frame:{x:396,y:2683,w:55,h:52},rotated:!1,trimmed:!0,spriteSourceSize:{x:-30,y:-51.9,w:121,h:120},sourceSize:{w:121,h:120}},{filename:"PrisonerGraphics0194",frame:{x:396,y:2683,w:55,h:52},rotated:!1,trimmed:!0,spriteSourceSize:{x:-30,y:-51.9,w:121,h:120},sourceSize:{w:121,h:120}},{filename:"PrisonerGraphics0195",frame:{x:396,y:2683,w:55,h:52},rotated:!1,trimmed:!0,spriteSourceSize:{x:-30,y:-51.9,w:121,h:120},sourceSize:{w:121,h:120}},{filename:"PrisonerGraphics0196",frame:{x:396,y:2683,w:55,h:52},rotated:!1,trimmed:!0,spriteSourceSize:{x:-30,y:-51.9,w:121,h:120},sourceSize:{w:121,h:120}},{filename:"PrisonerGraphics0197",frame:{x:396,y:2683,w:55,h:52},rotated:!1,trimmed:!0,spriteSourceSize:{x:-30,y:-51.9,w:121,h:120},sourceSize:{w:121,h:120}},{filename:"PrisonerGraphics0198",frame:{x:396,y:2683,w:55,h:52},rotated:!1,trimmed:!0,spriteSourceSize:{x:-30,y:-51.9,w:121,h:120},sourceSize:{w:121,h:120}},{filename:"PrisonerGraphics0199",frame:{x:396,y:2683,w:55,h:52},rotated:!1,trimmed:!0,spriteSourceSize:{x:-30,y:-51.9,w:121,h:120},sourceSize:{w:121,h:120}},{filename:"PrisonerGraphics0200",frame:{x:396,y:2683,w:55,h:52},rotated:!1,trimmed:!0,spriteSourceSize:{x:-30,y:-51.9,w:121,h:120},sourceSize:{w:121,h:120}},{filename:"PrisonerGraphics0201",frame:{x:1444,y:1341,w:89,h:98},rotated:!1,trimmed:!0,spriteSourceSize:{x:-52,y:-73.9,w:121,h:120},sourceSize:{w:121,h:120}},{filename:"PrisonerGraphics0202",frame:{x:3990,y:1008,w:96,h:99},rotated:!1,trimmed:!0,spriteSourceSize:{x:-52,y:-73.9,w:121,h:120},sourceSize:{w:121,h:120}},{filename:"PrisonerGraphics0203",frame:{x:1727,y:908,w:87,h:112},rotated:!1,trimmed:!0,spriteSourceSize:{x:-45,y:-85.9,w:121,h:120},sourceSize:{w:121,h:120}},{filename:"PrisonerGraphics0204",frame:{x:2527,y:1724,w:84,h:81},rotated:!1,trimmed:!0,spriteSourceSize:{x:-45,y:-59.9,w:121,h:120},sourceSize:{w:121,h:120}},{filename:"PrisonerGraphics0205",frame:{x:3152,y:1710,w:78,h:90},rotated:!1,trimmed:!0,spriteSourceSize:{x:-39,y:-85.9,w:121,h:120},sourceSize:{w:121,h:120}},{filename:"PrisonerGraphics0206",frame:{x:1528,y:1494,w:83,h:100},rotated:!1,trimmed:!0,spriteSourceSize:{x:-46,y:-85.9,w:121,h:120},sourceSize:{w:121,h:120}},{filename:"PrisonerGraphics0207",frame:{x:576,y:1998,w:76,h:66},rotated:!1,trimmed:!0,spriteSourceSize:{x:-40,y:-61.9,w:121,h:120},sourceSize:{w:121,h:120}},{filename:"PrisonerGraphics0208",frame:{x:1871,y:1639,w:78,h:97},rotated:!1,trimmed:!0,spriteSourceSize:{x:-40,y:-78.9,w:121,h:120},sourceSize:{w:121,h:120}},{filename:"PrisonerGraphics0209",frame:{x:3062,y:905,w:101,h:100},rotated:!1,trimmed:!0,spriteSourceSize:{x:-60,y:-84.9,w:121,h:120},sourceSize:{w:121,h:120}},{filename:"PrisonerGraphics0210",frame:{x:1089,y:1710,w:85,h:83},rotated:!1,trimmed:!0,spriteSourceSize:{x:-32,y:-60.9,w:121,h:120},sourceSize:{w:121,h:120}},{filename:"PrisonerGraphics0211",frame:{x:1474,y:2044,w:77,h:64},rotated:!1,trimmed:!0,spriteSourceSize:{x:-37,y:-39.9,w:121,h:120},sourceSize:{w:121,h:120}},{filename:"PrisonerGraphics0212",frame:{x:2654,y:1721,w:107,h:64},rotated:!1,trimmed:!0,spriteSourceSize:{x:-46,y:-60.9,w:121,h:120},sourceSize:{w:121,h:120}},{filename:"PrisonerGraphics0213",frame:{x:1358,y:1816,w:96,h:67},rotated:!1,trimmed:!0,spriteSourceSize:{x:-46,y:-41.9,w:121,h:120},sourceSize:{w:121,h:120}},{filename:"PrisonerGraphics0214",frame:{x:1124,y:2284,w:98,h:46},rotated:!1,trimmed:!0,spriteSourceSize:{x:-47,y:-43.9,w:121,h:120},sourceSize:{w:121,h:120}},{filename:"PrisonerGraphics0215",frame:{x:1658,y:2231,w:86,h:54},rotated:!1,trimmed:!0,spriteSourceSize:{x:-47,y:-40.9,w:121,h:120},sourceSize:{w:121,h:120}},{filename:"PrisonerGraphics0216",frame:{x:692,y:1712,w:96,h:73},rotated:!1,trimmed:!0,spriteSourceSize:{x:-47,y:-53.9,w:121,h:120},sourceSize:{w:121,h:120}},{filename:"PrisonerGraphics0217",frame:{x:3860,y:1709,w:97,h:74},rotated:!1,trimmed:!0,spriteSourceSize:{x:-47,y:-51.9,w:121,h:120},sourceSize:{w:121,h:120}},{filename:"PrisonerGraphics0218",frame:{x:1342,y:1442,w:101,h:83},rotated:!1,trimmed:!0,spriteSourceSize:{x:-47,y:-60.9,w:121,h:120},sourceSize:{w:121,h:120}},{filename:"PrisonerGraphics0219",frame:{x:842,y:1446,w:101,h:83},rotated:!1,trimmed:!0,spriteSourceSize:{x:-48,y:-60.9,w:121,h:120},sourceSize:{w:121,h:120}},{filename:"PrisonerGraphics0220",frame:{x:946,y:1466,w:101,h:83},rotated:!1,trimmed:!0,spriteSourceSize:{x:-48,y:-60.9,w:121,h:120},sourceSize:{w:121,h:120}},{filename:"ReplayButtonGraphics0000",frame:{x:1747,y:2231,w:40,h:38},rotated:!1,trimmed:!0,spriteSourceSize:{x:0,y:0,w:40,h:38},sourceSize:{w:40,h:38}},{filename:"ReplayButtonGraphics0001",frame:{x:765,y:2327,w:40,h:38},rotated:!1,trimmed:!0,spriteSourceSize:{x:0,y:0,w:40,h:38},sourceSize:{w:40,h:38}},{filename:"ReplayButtonGraphics0002",frame:{x:1747,y:2231,w:40,h:38},rotated:!1,trimmed:!0,spriteSourceSize:{x:0,y:0,w:40,h:38},sourceSize:{w:40,h:38}},{filename:"SkipButton0000",frame:{x:3,y:2115,w:65,h:36},rotated:!1,trimmed:!0,spriteSourceSize:{x:0,y:0,w:65,h:37},sourceSize:{w:65,h:37}},{filename:"SkipButton0001",frame:{x:2734,y:2162,w:65,h:36},rotated:!1,trimmed:!0,spriteSourceSize:{x:0,y:0,w:65,h:37},sourceSize:{w:65,h:37}},{filename:"SkipButton0002",frame:{x:3233,y:1710,w:65,h:37},rotated:!1,trimmed:!0,spriteSourceSize:{x:0,y:0,w:65,h:37},sourceSize:{w:65,h:37}},{filename:"SoundButtonGraphics0000",frame:{x:1781,y:1933,w:40,h:39},rotated:!1,trimmed:!0,spriteSourceSize:{x:0,y:0,w:40,h:39},sourceSize:{w:40,h:39}},{filename:"SoundButtonGraphics0001",frame:{x:2737,y:1969,w:40,h:39},rotated:!1,trimmed:!0,spriteSourceSize:{x:0,y:0,w:40,h:39},sourceSize:{w:40,h:39}},{filename:"SoundButtonGraphics0002",frame:{x:2885,y:2038,w:40,h:39},rotated:!1,trimmed:!0,spriteSourceSize:{x:0,y:0,w:40,h:39},sourceSize:{w:40,h:39}},{filename:"SoundButtonGraphics0003",frame:{x:1554,y:2044,w:40,h:39},rotated:!1,trimmed:!0,spriteSourceSize:{x:0,y:0,w:40,h:39},sourceSize:{w:40,h:39}},{filename:"StoolGraphics0000",frame:{x:577,y:2127,w:35,h:35},rotated:!1,trimmed:!0,spriteSourceSize:{x:-17.5,y:-17.5,w:35,h:35},sourceSize:{w:35,h:35}},{filename:"Tip1Graphics0000",frame:{x:873,y:1740,w:97,h:70},rotated:!1,trimmed:!0,spriteSourceSize:{x:-1.2,y:-68.2,w:97,h:70},sourceSize:{w:97,h:70}},{filename:"Tip2Graphics0000",frame:{x:2764,y:1758,w:97,h:70},rotated:!1,trimmed:!0,spriteSourceSize:{x:-1.2,y:-68.2,w:97,h:70},sourceSize:{w:97,h:70}},{filename:"Tip3Graphics0000",frame:{x:1361,y:1743,w:97,h:70},rotated:!1,trimmed:!0,spriteSourceSize:{x:-1.2,y:-68.2,w:97,h:70},sourceSize:{w:97,h:70}},{filename:"Tip4Graphics0000",frame:{x:2038,y:1750,w:97,h:70},rotated:!1,trimmed:!0,spriteSourceSize:{x:-1.2,y:-68.2,w:97,h:70},sourceSize:{w:97,h:70}},{filename:"Tip5Graphics0000",frame:{x:86,y:1626,w:79,h:96},rotated:!1,trimmed:!0,spriteSourceSize:{x:0,y:-96.2,w:79,h:96},sourceSize:{w:79,h:96}},{filename:"Tip6Graphics0000",frame:{x:1598,y:1631,w:79,h:96},rotated:!1,trimmed:!0,spriteSourceSize:{x:0,y:-96.2,w:79,h:96},sourceSize:{w:79,h:96}},{filename:"Tip7Graphics0000",frame:{x:3233,y:1754,w:97,h:70},rotated:!1,trimmed:!0,spriteSourceSize:{x:-1.2,y:-68.2,w:97,h:70},sourceSize:{w:97,h:70}},{filename:"Tip8Graphics0000",frame:{x:3333,y:1755,w:97,h:70},rotated:!1,trimmed:!0,spriteSourceSize:{x:-1.2,y:-68.2,w:97,h:70},sourceSize:{w:97,h:70}},{filename:"ToiletGraphics0000",frame:{x:4019,y:2525,w:67,h:60},rotated:!1,trimmed:!0,spriteSourceSize:{x:-18.3,y:-23.3,w:67,h:60},sourceSize:{w:67,h:60}},{filename:"TurrelGraphics0000",frame:{x:3222,y:1074,w:50,h:29},rotated:!1,trimmed:!0,spriteSourceSize:{x:-28.4,y:-16.5,w:99,h:71},sourceSize:{w:99,h:71}},{filename:"TurrelGraphics0001",frame:{x:3306,y:1615,w:56,h:35},rotated:!1,trimmed:!0,spriteSourceSize:{x:-34.4,y:-22.5,w:99,h:71},sourceSize:{w:99,h:71}},{filename:"TurrelGraphics0002",frame:{x:108,y:862,w:64,h:41},rotated:!1,trimmed:!0,spriteSourceSize:{x:-40.4,y:-28.5,w:99,h:71},sourceSize:{w:99,h:71}},{filename:"TurrelGraphics0003",frame:{x:1859,y:1977,w:60,h:39},rotated:!1,trimmed:!0,spriteSourceSize:{x:-37.4,y:-26.5,w:99,h:71},sourceSize:{w:99,h:71}},{filename:"TurrelGraphics0004",frame:{x:2936,y:1965,w:57,h:44},rotated:!1,trimmed:!0,spriteSourceSize:{x:-35.4,y:-31.5,w:99,h:71},sourceSize:{w:99,h:71}},{filename:"TurrelGraphics0005",frame:{x:431,y:749,w:55,h:48},rotated:!1,trimmed:!0,spriteSourceSize:{x:-33.4,y:-35.5,w:99,h:71},sourceSize:{w:99,h:71}},{filename:"TurrelGraphics0006",frame:{x:1692,y:2288,w:52,h:52},rotated:!1,trimmed:!0,spriteSourceSize:{x:-30.4,y:-39.5,w:99,h:71},sourceSize:{w:99,h:71}},{filename:"TurrelGraphics0007",frame:{x:2739,y:2729,w:46,h:55},rotated:!1,trimmed:!0,spriteSourceSize:{x:-24.4,y:-42.5,w:99,h:71},sourceSize:{w:99,h:71}},{filename:"TurrelGraphics0008",frame:{x:1253,y:2665,w:49,h:61},rotated:!1,trimmed:!0,spriteSourceSize:{x:-24.4,y:-48.5,w:99,h:71},sourceSize:{w:99,h:71}},{filename:"TurrelGraphics0009",frame:{x:3162,y:1122,w:57,h:66},rotated:!1,trimmed:!0,spriteSourceSize:{x:-27.4,y:-53.5,w:99,h:71},sourceSize:{w:99,h:71}},{filename:"TurrelGraphics0010",frame:{x:2882,y:1013,w:59,h:64},rotated:!1,trimmed:!0,spriteSourceSize:{x:-27.4,y:-51.5,w:99,h:71},sourceSize:{w:99,h:71}},{filename:"TurrelGraphics0011",frame:{x:3127,y:1532,w:63,h:64},rotated:!1,trimmed:!0,spriteSourceSize:{x:-28.4,y:-51.5,w:99,h:71},sourceSize:{w:99,h:71}},{filename:"TurrelGraphics0012",frame:{x:897,y:2524,w:64,h:63},rotated:!1,trimmed:!0,spriteSourceSize:{x:-28.4,y:-50.5,w:99,h:71},sourceSize:{w:99,h:71}},{filename:"TurrelGraphics0013",frame:{x:4026,y:1513,w:67,h:63},rotated:!1,trimmed:!0,spriteSourceSize:{x:-28.4,y:-50.5,w:99,h:71},sourceSize:{w:99,h:71}},{filename:"TurrelGraphics0014",frame:{x:3628,y:2411,w:70,h:62},rotated:!1,trimmed:!0,spriteSourceSize:{x:-28.4,y:-49.5,w:99,h:71},sourceSize:{w:99,h:71}},{filename:"TurrelGraphics0015",frame:{x:2487,y:1545,w:73,h:59},rotated:!1,trimmed:!0,spriteSourceSize:{x:-27.4,y:-46.5,w:99,h:71},sourceSize:{w:99,h:71}},{filename:"TurrelGraphics0016",frame:{x:2843,y:2430,w:76,h:56},rotated:!1,trimmed:!0,spriteSourceSize:{x:-27.4,y:-43.5,w:99,h:71},sourceSize:{w:99,h:71}},{filename:"TurrelGraphics0017",frame:{x:3064,y:2168,w:78,h:54},rotated:!1,trimmed:!0,spriteSourceSize:{x:-26.4,y:-41.5,w:99,h:71},sourceSize:{w:99,h:71}},{filename:"TurrelGraphics0018",frame:{x:2515,y:2481,w:82,h:50},rotated:!1,trimmed:!0,spriteSourceSize:{x:-26.4,y:-37.5,w:99,h:71},sourceSize:{w:99,h:71}},{filename:"TurrelGraphics0019",frame:{x:3458,y:2411,w:84,h:52},rotated:!1,trimmed:!0,spriteSourceSize:{x:-27.4,y:-39.5,w:99,h:71},sourceSize:{w:99,h:71}},{filename:"TurrelGraphics0020",frame:{x:2995,y:2285,w:86,h:52},rotated:!1,trimmed:!0,spriteSourceSize:{x:-27.4,y:-39.5,w:99,h:71},sourceSize:{w:99,h:71}},{filename:"TurrelGraphics0021",frame:{x:3364,y:2283,w:85,h:54},rotated:!1,trimmed:!0,spriteSourceSize:{x:-26.4,y:-41.5,w:99,h:71},sourceSize:{w:99,h:71}},{filename:"TurrelGraphics0022",frame:{x:3452,y:2283,w:85,h:54},rotated:!1,trimmed:!0,spriteSourceSize:{x:-26.4,y:-41.5,w:99,h:71},sourceSize:{w:99,h:71}},{filename:"TurrelGraphics0023",frame:{x:2556,y:2051,w:83,h:57},rotated:!1,trimmed:!0,spriteSourceSize:{x:-24.4,y:-44.5,w:99,h:71},sourceSize:{w:99,h:71}},{filename:"TurrelGraphics0024",frame:{x:2236,y:1991,w:82,h:62},rotated:!1,trimmed:!0,spriteSourceSize:{x:-24.4,y:-44.5,w:99,h:71},sourceSize:{w:99,h:71}},{filename:"TurrelGraphics0025",frame:{x:3257,y:1289,w:40,h:28},rotated:!1,trimmed:!0,spriteSourceSize:{x:-18.4,y:-15.5,w:99,h:71},sourceSize:{w:99,h:71}},{filename:"WaterSplashGraphics0000",frame:{x:4051,y:2150,w:42,h:64},rotated:!1,trimmed:!0,spriteSourceSize:{x:-22.2,y:-64.9,w:53,h:65},sourceSize:{w:53,h:65}},{filename:"WaterSplashGraphics0001",frame:{x:4046,y:1949,w:44,h:64},rotated:!1,trimmed:!0,spriteSourceSize:{x:-23.2,y:-64.9,w:53,h:65},sourceSize:{w:53,h:65}},{filename:"WaterSplashGraphics0002",frame:{x:3513,y:2688,w:45,h:63},rotated:!1,trimmed:!0,spriteSourceSize:{x:-23.2,y:-63.9,w:53,h:65},sourceSize:{w:53,h:65}},{filename:"WaterSplashGraphics0003",frame:{x:3464,y:2688,w:46,h:62},rotated:!1,trimmed:!0,spriteSourceSize:{x:-23.2,y:-62.9,w:53,h:65},sourceSize:{w:53,h:65}},{filename:"WaterSplashGraphics0004",frame:{x:1022,y:919,w:43,h:63},rotated:!1,trimmed:!0,spriteSourceSize:{x:-20.2,y:-63.9,w:53,h:65},sourceSize:{w:53,h:65}},{filename:"WaterSplashGraphics0005",frame:{x:2126,y:907,w:45,h:64},rotated:!1,trimmed:!0,spriteSourceSize:{x:-21.2,y:-64.9,w:53,h:65},sourceSize:{w:53,h:65}},{filename:"WaterSplashGraphics0006",frame:{x:4047,y:1709,w:46,h:65},rotated:!1,trimmed:!0,spriteSourceSize:{x:-22.2,y:-65.9,w:53,h:65},sourceSize:{w:53,h:65}},{filename:"WaterSplashGraphics0007",frame:{x:4046,y:1110,w:47,h:65},rotated:!1,trimmed:!0,spriteSourceSize:{x:-23.2,y:-65.9,w:53,h:65},sourceSize:{w:53,h:65}},{filename:"WaterSplashGraphics0008",frame:{x:3222,y:1006,w:48,h:65},rotated:!1,trimmed:!0,spriteSourceSize:{x:-23.2,y:-65.9,w:53,h:65},sourceSize:{w:53,h:65}},{filename:"WaterSplashGraphics0009",frame:{x:3257,y:1222,w:48,h:64},rotated:!1,trimmed:!0,spriteSourceSize:{x:-23.2,y:-64.9,w:53,h:65},sourceSize:{w:53,h:65}},{filename:"WaterSplashGraphics0010",frame:{x:130,y:2665,w:48,h:63},rotated:!1,trimmed:!0,spriteSourceSize:{x:-24.2,y:-63.9,w:53,h:65},sourceSize:{w:53,h:65}},{filename:"WaterSplashGraphics0011",frame:{x:1981,y:2667,w:49,h:61},rotated:!1,trimmed:!0,spriteSourceSize:{x:-24.2,y:-61.9,w:53,h:65},sourceSize:{w:53,h:65}},{filename:"WaterSplashGraphics0012",frame:{x:1391,y:2362,w:50,h:58},rotated:!1,trimmed:!0,spriteSourceSize:{x:-24.2,y:-58.9,w:53,h:65},sourceSize:{w:53,h:65}},{filename:"WaterSplashGraphics0013",frame:{x:948,y:2728,w:45,h:57},rotated:!1,trimmed:!0,spriteSourceSize:{x:-18.2,y:-57.9,w:53,h:65},sourceSize:{w:53,h:65}},{filename:"WaterSplashGraphics0014",frame:{x:512,y:2697,w:47,h:56},rotated:!1,trimmed:!0,spriteSourceSize:{x:-19.2,y:-56.9,w:53,h:65},sourceSize:{w:53,h:65}},{filename:"WaterSplashGraphics0015",frame:{x:3121,y:2695,w:48,h:56},rotated:!1,trimmed:!0,spriteSourceSize:{x:-20.2,y:-56.9,w:53,h:65},sourceSize:{w:53,h:65}},{filename:"WaterSplashGraphics0016",frame:{x:3561,y:2688,w:48,h:59},rotated:!1,trimmed:!0,spriteSourceSize:{x:-20.2,y:-59.9,w:53,h:65},sourceSize:{w:53,h:65}},{filename:"WaterSplashGraphics0017",frame:{x:77,y:2665,w:50,h:61},rotated:!1,trimmed:!0,spriteSourceSize:{x:-21.2,y:-61.9,w:53,h:65},sourceSize:{w:53,h:65}},{filename:"WaterSplashGraphics0018",frame:{x:761,y:954,w:51,h:63},rotated:!1,trimmed:!0,spriteSourceSize:{x:-22.2,y:-63.9,w:53,h:65},sourceSize:{w:53,h:65}},{filename:"WaterSplashGraphics0019",frame:{x:1580,y:912,w:51,h:64},rotated:!1,trimmed:!0,spriteSourceSize:{x:-22.2,y:-64.9,w:53,h:65},sourceSize:{w:53,h:65}},{filename:"_beam0000",frame:{x:1817,y:1005,w:100,h:8},rotated:!1,trimmed:!0,spriteSourceSize:{x:-100,y:-4,w:100,h:8},sourceSize:{w:100,h:8}},{filename:"_beam0001",frame:{x:453,y:2756,w:100,h:8},rotated:!1,trimmed:!0,spriteSourceSize:{x:-100,y:-4,w:100,h:8},sourceSize:{w:100,h:8}},{filename:"_beam0002",frame:{x:3873,y:2762,w:100,h:8},rotated:!1,trimmed:!0,spriteSourceSize:{x:-100,y:-4,w:100,h:8},sourceSize:{w:100,h:8}},{filename:"_bigElevBack0000",frame:{x:3172,y:2747,w:105,h:20},rotated:!1,trimmed:!0,spriteSourceSize:{x:-52.5,y:-10,w:105,h:20},sourceSize:{w:105,h:20}},{filename:"_bigElevatorFront0000",frame:{x:493,y:1027,w:103,h:11},rotated:!1,trimmed:!0,spriteSourceSize:{x:-51.7,y:-5.1,w:103,h:11},sourceSize:{w:103,h:11}},{filename:"_bigElevatorFront0001",frame:{x:866,y:1342,w:103,h:11},rotated:!1,trimmed:!0,spriteSourceSize:{x:-51.7,y:-5.1,w:103,h:11},sourceSize:{w:103,h:11}},{filename:"_bigElevatorFront0002",frame:{x:3661,y:2751,w:103,h:11},rotated:!1,trimmed:!0,spriteSourceSize:{x:-51.7,y:-5.1,w:103,h:11},sourceSize:{w:103,h:11}},{filename:"_bigElevatorFront0003",frame:{x:3767,y:2751,w:103,h:11},rotated:!1,trimmed:!0,spriteSourceSize:{x:-51.7,y:-5.1,w:103,h:11},sourceSize:{w:103,h:11}},{filename:"_bigElevatorFront0004",frame:{x:1520,y:2753,w:103,h:11},rotated:!1,trimmed:!0,spriteSourceSize:{x:-51.7,y:-5.1,w:103,h:11},sourceSize:{w:103,h:11}},{filename:"_bigElevatorFront0005",frame:{x:3451,y:2754,w:103,h:11},rotated:!1,trimmed:!0,spriteSourceSize:{x:-51.7,y:-5.1,w:103,h:11},sourceSize:{w:103,h:11}},{filename:"_burg10000",frame:{x:2753,y:790,w:101,h:114},rotated:!1,trimmed:!0,spriteSourceSize:{x:-45.2,y:-55.7,w:101,h:114},sourceSize:{w:101,h:114}},{filename:"_burg20000",frame:{x:3069,y:790,w:101,h:112},rotated:!1,trimmed:!0,spriteSourceSize:{x:-48.2,y:-56.8,w:101,h:112},sourceSize:{w:101,h:112}},{filename:"_burg30000",frame:{x:2857,y:790,w:98,h:117},rotated:!1,trimmed:!0,spriteSourceSize:{x:-53.3,y:-53.7,w:98,h:117},sourceSize:{w:98,h:117}},{filename:"_burgersBackground0000",frame:{x:714,y:677,w:247,h:166},rotated:!1,trimmed:!0,spriteSourceSize:{x:-123.2,y:-77.6,w:247,h:166},sourceSize:{w:247,h:166}},{filename:"_buttonTop0000",frame:{x:1172,y:883,w:20,h:7},rotated:!1,trimmed:!0,spriteSourceSize:{x:-10,y:-3.5,w:20,h:7},sourceSize:{w:20,h:7}},{filename:"_buttonTop0001",frame:{x:1479,y:901,w:20,h:7},rotated:!1,trimmed:!0,spriteSourceSize:{x:-10,y:-3.5,w:20,h:7},sourceSize:{w:20,h:7}},{filename:"_buttonTop0002",frame:{x:1502,y:901,w:20,h:7},rotated:!1,trimmed:!0,spriteSourceSize:{x:-10,y:-3.5,w:20,h:7},sourceSize:{w:20,h:7}},{filename:"_buttonTop0003",frame:{x:3511,y:935,w:20,h:7},rotated:!1,trimmed:!0,spriteSourceSize:{x:-10,y:-3.5,w:20,h:7},sourceSize:{w:20,h:7}},{filename:"_buttonTop0004",frame:{x:2703,y:1002,w:20,h:7},rotated:!1,trimmed:!0,spriteSourceSize:{x:-10,y:-3.5,w:20,h:7},sourceSize:{w:20,h:7}},{filename:"_buttonTop0005",frame:{x:3938,y:1008,w:20,h:7},rotated:!1,trimmed:!0,spriteSourceSize:{x:-10,y:-3.5,w:20,h:7},sourceSize:{w:20,h:7}},{filename:"_cogwheel0000",frame:{x:2273,y:900,w:18,h:18},rotated:!1,trimmed:!0,spriteSourceSize:{x:-9,y:-8.9,w:18,h:18},sourceSize:{w:18,h:18}},{filename:"_cogwheel20000",frame:{x:2273,y:921,w:18,h:18},rotated:!1,trimmed:!0,spriteSourceSize:{x:-9,y:-9,w:18,h:18},sourceSize:{w:18,h:18}},{filename:"_elevatorBack0000",frame:{x:1933,y:1108,w:70,h:17},rotated:!1,trimmed:!0,spriteSourceSize:{x:-35,y:-8.5,w:70,h:17},sourceSize:{w:70,h:17}},{filename:"_elevatorFront0000",frame:{x:672,y:1044,w:69,h:11},rotated:!1,trimmed:!0,spriteSourceSize:{x:-34.5,y:-5.3,w:69,h:11},sourceSize:{w:69,h:11}},{filename:"_elevatorFront0001",frame:{x:1742,y:1186,w:69,h:11},rotated:!1,trimmed:!0,spriteSourceSize:{x:-34.5,y:-5.3,w:69,h:11},sourceSize:{w:69,h:11}},{filename:"_elevatorFront0002",frame:{x:2764,y:1407,w:69,h:11},rotated:!1,trimmed:!0,spriteSourceSize:{x:-34.5,y:-5.3,w:69,h:11},sourceSize:{w:69,h:11}},{filename:"_elevatorFront0003",frame:{x:714,y:1788,w:69,h:11},rotated:!1,trimmed:!0,spriteSourceSize:{x:-34.5,y:-5.3,w:69,h:11},sourceSize:{w:69,h:11}},{filename:"_elevatorFront0004",frame:{x:894,y:1813,w:69,h:11},rotated:!1,trimmed:!0,spriteSourceSize:{x:-34.5,y:-5.3,w:69,h:11},sourceSize:{w:69,h:11}},{filename:"_elevatorFront0005",frame:{x:894,y:1827,w:69,h:11},rotated:!1,trimmed:!0,spriteSourceSize:{x:-34.5,y:-5.3,w:69,h:11},sourceSize:{w:69,h:11}},{filename:"_levelCompletedSign0000",frame:{x:3,y:537,w:484,h:138},rotated:!1,trimmed:!0,spriteSourceSize:{x:-241.3,y:-3.3,w:484,h:138},sourceSize:{w:484,h:138}},{filename:"_levelFailedSign0000",frame:{x:490,y:537,w:484,h:137},rotated:!1,trimmed:!0,spriteSourceSize:{x:-241.9,y:-3.7,w:484,h:137},sourceSize:{w:484,h:137}},{filename:"_mainMenuButton0000",frame:{x:1467,y:1081,w:176,h:53},rotated:!1,trimmed:!0,spriteSourceSize:{x:1,y:-.4,w:176,h:53},sourceSize:{w:176,h:53}},{filename:"_mainMenuButton0001",frame:{x:851,y:1082,w:176,h:53},rotated:!1,trimmed:!0,spriteSourceSize:{x:1,y:-.4,w:176,h:53},sourceSize:{w:176,h:53}},{filename:"_mainMenuButton0002",frame:{x:1030,y:1099,w:176,h:53},rotated:!1,trimmed:!0,spriteSourceSize:{x:1,y:-.4,w:176,h:53},sourceSize:{w:176,h:53}},{filename:"_moreButton0000",frame:{x:3473,y:1994,w:153,h:33},rotated:!1,trimmed:!0,spriteSourceSize:{x:1,y:0,w:156,h:33},sourceSize:{w:156,h:33}},{filename:"_moreButton0001",frame:{x:1602,y:1992,w:156,h:33},rotated:!1,trimmed:!0,spriteSourceSize:{x:0,y:0,w:156,h:33},sourceSize:{w:156,h:33}},{filename:"_moreButton0002",frame:{x:3473,y:1994,w:153,h:33},rotated:!1,trimmed:!0,spriteSourceSize:{x:1,y:0,w:156,h:33},sourceSize:{w:156,h:33}},{filename:"_nextButton0000",frame:{x:3043,y:1008,w:176,h:54},rotated:!1,trimmed:!0,spriteSourceSize:{x:1,y:1,w:176,h:54},sourceSize:{w:176,h:54}},{filename:"_nextButton0001",frame:{x:2018,y:1016,w:176,h:54},rotated:!1,trimmed:!0,spriteSourceSize:{x:1,y:1,w:176,h:54},sourceSize:{w:176,h:54}},{filename:"_nextButton0002",frame:{x:2703,y:1016,w:176,h:54},rotated:!1,trimmed:!0,spriteSourceSize:{x:1,y:1,w:176,h:54},sourceSize:{w:176,h:54}},{filename:"_pushButtonBase0000",frame:{x:493,y:1016,w:23,h:5},rotated:!1,trimmed:!0,spriteSourceSize:{x:-11.9,y:-2.3,w:23,h:5},sourceSize:{w:23,h:5}},{filename:"_replayButton0000",frame:{x:314,y:1017,w:176,h:54},rotated:!1,trimmed:!0,spriteSourceSize:{x:1,y:1,w:176,h:54},sourceSize:{w:176,h:54}},{filename:"_replayButton0001",frame:{x:3811,y:1019,w:176,h:54},rotated:!1,trimmed:!0,spriteSourceSize:{x:1,y:1,w:176,h:54},sourceSize:{w:176,h:54}},{filename:"_replayButton0002",frame:{x:1727,y:1023,w:176,h:54},rotated:!1,trimmed:!0,spriteSourceSize:{x:1,y:1,w:176,h:54},sourceSize:{w:176,h:54}},{filename:"_triggerBase0000",frame:{x:427,y:907,w:30,h:14},rotated:!1,trimmed:!0,spriteSourceSize:{x:-15,y:-7,w:30,h:14},sourceSize:{w:30,h:14}},{filename:"_triggerBase0001",frame:{x:4057,y:991,w:30,h:14},rotated:!1,trimmed:!0,spriteSourceSize:{x:-15,y:-7,w:30,h:14},sourceSize:{w:30,h:14}},{filename:"_triggerBase0002",frame:{x:599,y:1027,w:30,h:14},rotated:!1,trimmed:!0,spriteSourceSize:{x:-15,y:-7,w:30,h:14},sourceSize:{w:30,h:14}},{filename:"_triggerBase0003",frame:{x:3763,y:1058,w:30,h:14},rotated:!1,trimmed:!0,spriteSourceSize:{x:-15,y:-7,w:30,h:14},sourceSize:{w:30,h:14}},{filename:"_triggerBase0004",frame:{x:878,y:1060,w:30,h:14},rotated:!1,trimmed:!0,spriteSourceSize:{x:-15,y:-7,w:30,h:14},sourceSize:{w:30,h:14}},{filename:"_triggerBase0005",frame:{x:1030,y:1082,w:30,h:14},rotated:!1,trimmed:!0,spriteSourceSize:{x:-15,y:-7,w:30,h:14},sourceSize:{w:30,h:14}},{filename:"_triggerHandle0000",frame:{x:4071,y:125,w:15,h:14},rotated:!1,trimmed:!0,spriteSourceSize:{x:-15,y:-14,w:15,h:14},sourceSize:{w:15,h:14}},{filename:"_triggerHandle0001",frame:{x:2818,y:533,w:15,h:14},rotated:!1,trimmed:!0,spriteSourceSize:{x:-15,y:-14,w:15,h:14},sourceSize:{w:15,h:14}},{filename:"_triggerHandle0002",frame:{x:2818,y:550,w:15,h:14},rotated:!1,trimmed:!0,spriteSourceSize:{x:-15,y:-14,w:15,h:14},sourceSize:{w:15,h:14}},{filename:"_triggerHandle0003",frame:{x:3523,y:550,w:15,h:14},rotated:!1,trimmed:!0,spriteSourceSize:{x:-15,y:-14,w:15,h:14},sourceSize:{w:15,h:14}},{filename:"_triggerHandle0004",frame:{x:2818,y:567,w:15,h:14},rotated:!1,trimmed:!0,spriteSourceSize:{x:-15,y:-14,w:15,h:14},sourceSize:{w:15,h:14}},{filename:"_triggerHandle0005",frame:{x:3523,y:567,w:15,h:14},rotated:!1,trimmed:!0,spriteSourceSize:{x:-15,y:-14,w:15,h:14},sourceSize:{w:15,h:14}},{filename:"_walkthroughButton0000",frame:{x:1467,y:1024,w:176,h:54},rotated:!1,trimmed:!0,spriteSourceSize:{x:1,y:.2,w:176,h:54},sourceSize:{w:176,h:54}},{filename:"_walkthroughButton0001",frame:{x:913,y:1025,w:176,h:54},rotated:!1,trimmed:!0,spriteSourceSize:{x:1,y:.2,w:176,h:54},sourceSize:{w:176,h:54}},{filename:"_walkthroughButton0002",frame:{x:493,y:1044,w:176,h:54},rotated:!1,trimmed:!0,spriteSourceSize:{x:1,y:.2,w:176,h:54},sourceSize:{w:176,h:54}},{filename:"_walkthroughButtonBig0000",frame:{x:3490,y:1052,w:176,h:54},rotated:!1,trimmed:!0,spriteSourceSize:{x:1,y:-.2,w:176,h:54},sourceSize:{w:176,h:54}},{filename:"_walkthroughButtonBig0001",frame:{x:672,y:1060,w:176,h:54},rotated:!1,trimmed:!0,spriteSourceSize:{x:1,y:-.2,w:176,h:54},sourceSize:{w:176,h:54}},{filename:"_walkthroughButtonBig0002",frame:{x:672,y:1060,w:176,h:54},rotated:!1,trimmed:!0,spriteSourceSize:{x:1,y:-.2,w:176,h:54},sourceSize:{w:176,h:54}},{filename:"cbtnArrow0000",frame:{x:1644,y:1186,w:95,h:95},rotated:!1,trimmed:!0,spriteSourceSize:{x:-47.5,y:-47.5,w:95,h:95},sourceSize:{w:95,h:95}},{filename:"cbtnChange0000",frame:{x:3767,y:1187,w:95,h:95},rotated:!1,trimmed:!0,spriteSourceSize:{x:-47.5,y:-47.5,w:95,h:95},sourceSize:{w:95,h:95}},{filename:"cbtnChange0001",frame:{x:192,y:1191,w:95,h:95},rotated:!1,trimmed:!0,spriteSourceSize:{x:-47.5,y:-47.5,w:95,h:95},sourceSize:{w:95,h:95}},{filename:"cbtnGrab0000",frame:{x:2552,y:1205,w:95,h:95},rotated:!1,trimmed:!0,spriteSourceSize:{x:-47.5,y:-47.5,w:95,h:95},sourceSize:{w:95,h:95}},{filename:"cmcActiveSign0000",frame:{x:460,y:907,w:25,h:16},rotated:!1,trimmed:!0,spriteSourceSize:{x:-12.5,y:6.5,w:25,h:16},sourceSize:{w:25,h:16}},{filename:"cmcAnim10000",frame:{x:1195,y:537,w:224,h:249},rotated:!1,trimmed:!0,spriteSourceSize:{x:8.6,y:8.3,w:224,h:249},sourceSize:{w:224,h:249}},{filename:"cmcAnim100000",frame:{x:2131,y:533,w:342,h:251},rotated:!1,trimmed:!0,spriteSourceSize:{x:7,y:268.5,w:342,h:251},sourceSize:{w:342,h:251}},{filename:"cmcAnim110000",frame:{x:3,y:678,w:181,h:181},rotated:!1,trimmed:!0,spriteSourceSize:{x:185.3,y:214.5,w:181,h:181},sourceSize:{w:181,h:181}},{filename:"cmcAnim120000",frame:{x:2476,y:533,w:339,h:253},rotated:!1,trimmed:!0,spriteSourceSize:{x:356.1,y:266.8,w:339,h:253},sourceSize:{w:339,h:253}},{filename:"cmcAnim20000",frame:{x:1700,y:534,w:260,h:249},rotated:!1,trimmed:!0,spriteSourceSize:{x:231.4,y:7.5,w:260,h:249},sourceSize:{w:260,h:249}},{filename:"cmcAnim30000",frame:{x:3931,y:3,w:137,h:136},rotated:!1,trimmed:!0,spriteSourceSize:{x:412.8,y:12,w:137,h:136},sourceSize:{w:137,h:136}},{filename:"cmcAnim40000",frame:{x:490,y:677,w:221,h:246},rotated:!1,trimmed:!0,spriteSourceSize:{x:473.5,y:7.5,w:221,h:246},sourceSize:{w:221,h:246}},{filename:"cmcAnim50000",frame:{x:3839,y:424,w:225,h:258},rotated:!1,trimmed:!0,spriteSourceSize:{x:8,y:261.4,w:225,h:258},sourceSize:{w:225,h:258}},{filename:"cmcAnim60000",frame:{x:1423,y:534,w:274,h:259},rotated:!1,trimmed:!0,spriteSourceSize:{x:201.6,y:259.1,w:274,h:259},sourceSize:{w:274,h:259}},{filename:"cmcAnim70000",frame:{x:977,y:537,w:215,h:270},rotated:!1,trimmed:!0,spriteSourceSize:{x:479.2,y:248.4,w:215,h:270},sourceSize:{w:215,h:270}},{filename:"cmcAnim80000",frame:{x:2836,y:532,w:339,h:255},rotated:!1,trimmed:!0,spriteSourceSize:{x:7,y:7,w:339,h:255},sourceSize:{w:339,h:255}},{filename:"cmcAnim90000",frame:{x:3178,y:532,w:342,h:252},rotated:!1,trimmed:!0,spriteSourceSize:{x:352.4,y:7.4,w:342,h:252},sourceSize:{w:342,h:252}},{filename:"cmcBonusBag0000",frame:{x:431,y:678,w:56,h:68},rotated:!1,trimmed:!0,spriteSourceSize:{x:7,y:0,w:56,h:68},sourceSize:{w:56,h:68}},{filename:"cmcBonusHighlight0000",frame:{x:3366,y:1569,w:89,h:89},rotated:!1,trimmed:!0,spriteSourceSize:{x:-44.9,y:-44.8,w:89,h:89},sourceSize:{w:89,h:89}},{filename:"cmcCreditsDialog0000",frame:{x:3541,y:424,w:295,h:522},rotated:!1,trimmed:!0,spriteSourceSize:{x:-1.7,y:-4.2,w:295,h:522},sourceSize:{w:295,h:522}},{filename:"cmcLevelSelectBG0000",frame:{x:2131,y:3,w:702,h:527},rotated:!1,trimmed:!0,spriteSourceSize:{x:-.7,y:0,w:702,h:527},sourceSize:{w:702,h:527}},{filename:"cmcLock0000",frame:{x:3511,y:897,w:25,h:35},rotated:!1,trimmed:!0,spriteSourceSize:{x:-2.4,y:-2.4,w:25,h:35},sourceSize:{w:25,h:35}},{filename:"cmcMainMenuBack0000",frame:{x:3,y:3,w:712,h:531},rotated:!1,trimmed:!0,spriteSourceSize:{x:-11.1,y:-1.1,w:712,h:531},sourceSize:{w:712,h:531}},{filename:"cmcPanelBG0000",frame:{x:718,y:3,w:702,h:531},rotated:!1,trimmed:!0,spriteSourceSize:{x:-.1,y:-4.2,w:702,h:531},sourceSize:{w:702,h:531}},{filename:"cmcPauseDialog0000",frame:{x:3541,y:3,w:387,h:418},rotated:!1,trimmed:!0,spriteSourceSize:{x:-78.2,y:-3.6,w:387,h:418},sourceSize:{w:387,h:418}},{filename:"cmcYouNeed0000",frame:{x:2075,y:1694,w:140,h:53},rotated:!1,trimmed:!0,spriteSourceSize:{x:1.4,y:-1.6,w:140,h:53},sourceSize:{w:140,h:53}},{filename:"crossPoint0000",frame:{x:2606,y:972,w:26,h:26},rotated:!1,trimmed:!0,spriteSourceSize:{x:-11,y:-11,w:26,h:26},sourceSize:{w:26,h:26}},{filename:"crossPoint0001",frame:{x:1224,y:1505,w:26,h:26},rotated:!1,trimmed:!0,spriteSourceSize:{x:-11,y:-11,w:26,h:26},sourceSize:{w:26,h:26}},{filename:"crossPoint0002",frame:{x:425,y:1509,w:26,h:26},rotated:!1,trimmed:!0,spriteSourceSize:{x:-11,y:-11,w:26,h:26},sourceSize:{w:26,h:26}},{filename:"grabbedObject0000",frame:{x:3508,y:1477,w:35,h:35},rotated:!1,trimmed:!0,spriteSourceSize:{x:-17.5,y:-17.5,w:35,h:35},sourceSize:{w:35,h:35}},{filename:"hamburgers0000",frame:{x:3,y:3,w:0,h:0},rotated:!1,trimmed:!0,spriteSourceSize:{x:-.8,y:-.2,w:49,h:43},sourceSize:{w:49,h:43}},{filename:"hamburgers0001",frame:{x:1266,y:1272,w:28,h:30},rotated:!1,trimmed:!0,spriteSourceSize:{x:.2,y:-.2,w:49,h:43},sourceSize:{w:49,h:43}},{filename:"hamburgers0002",frame:{x:4041,y:884,w:48,h:31},rotated:!1,trimmed:!0,spriteSourceSize:{x:-2.8,y:-1.2,w:49,h:43},sourceSize:{w:49,h:43}},{filename:"hamburgers0003",frame:{x:1536,y:1341,w:48,h:43},rotated:!1,trimmed:!0,spriteSourceSize:{x:-3.8,y:-12.2,w:49,h:43},sourceSize:{w:49,h:43}},{filename:"platformCenter0000",frame:{x:3736,y:1759,w:35,h:35},rotated:!1,trimmed:!0,spriteSourceSize:{x:0,y:-35.1,w:35,h:35},sourceSize:{w:35,h:35}},{filename:"platformLeft0000",frame:{x:3e3,y:1891,w:35,h:35},rotated:!1,trimmed:!0,spriteSourceSize:{x:0,y:-35,w:35,h:35},sourceSize:{w:35,h:35}},{filename:"platformRight0000",frame:{x:2780,y:1895,w:35,h:35},rotated:!1,trimmed:!0,spriteSourceSize:{x:0,y:-35,w:35,h:35},sourceSize:{w:35,h:35}},{filename:"singleTile0000",frame:{x:3703,y:2024,w:35,h:35},rotated:!1,trimmed:!0,spriteSourceSize:{x:0,y:-35,w:35,h:35},sourceSize:{w:35,h:35}},{filename:"tileBottomCenter0000",frame:{x:513,y:2187,w:35,h:35},rotated:!1,trimmed:!0,spriteSourceSize:{x:0,y:-35,w:35,h:35},sourceSize:{w:35,h:35}},{filename:"tileBottomLeft0000",frame:{x:4051,y:2217,w:35,h:35},rotated:!1,trimmed:!0,spriteSourceSize:{x:0,y:-35,w:35,h:35},sourceSize:{w:35,h:35}},{filename:"tileBottomRight0000",frame:{x:3540,y:2283,w:35,h:35},rotated:!1,trimmed:!0,spriteSourceSize:{x:0,y:-35,w:35,h:35},sourceSize:{w:35,h:35}},{filename:"tileCenter0000",frame:{x:2164,y:2312,w:35,h:35},rotated:!1,trimmed:!0,spriteSourceSize:{x:0,y:-35,w:35,h:35},sourceSize:{w:35,h:35}},{filename:"tileCenterLeft0000",frame:{x:452,y:2318,w:35,h:35},rotated:!1,trimmed:!0,spriteSourceSize:{x:0,y:-35,w:35,h:35},sourceSize:{w:35,h:35}},{filename:"tileCenterRight0000",frame:{x:1652,y:2359,w:35,h:35},rotated:!1,trimmed:!0,spriteSourceSize:{x:0,y:-35,w:35,h:35},sourceSize:{w:35,h:35}},{filename:"tileTopCenter0000",frame:{x:2436,y:2377,w:35,h:35},rotated:!1,trimmed:!0,spriteSourceSize:{x:0,y:-35.1,w:35,h:35},sourceSize:{w:35,h:35}},{filename:"tileTopLeft0000",frame:{x:2100,y:2383,w:35,h:35},rotated:!1,trimmed:!0,spriteSourceSize:{x:0,y:-35.1,w:35,h:35},sourceSize:{w:35,h:35}},{filename:"tileTopRight0000",frame:{x:414,y:2389,w:35,h:35},rotated:!1,trimmed:!0,spriteSourceSize:{x:0,y:-35.1,w:35,h:35},sourceSize:{w:35,h:35}},{filename:"verticalPlatformBottom0000",frame:{x:969,y:2396,w:35,h:35},rotated:!1,trimmed:!0,spriteSourceSize:{x:0,y:-35.1,w:35,h:35},sourceSize:{w:35,h:35}},{filename:"verticalPlatformCenter0000",frame:{x:724,y:2398,w:35,h:35},rotated:!1,trimmed:!0,spriteSourceSize:{x:0,y:-35,w:35,h:35},sourceSize:{w:35,h:35}},{filename:"verticalPlatformTop0000",frame:{x:2922,y:2430,w:35,h:35},rotated:!1,trimmed:!0,spriteSourceSize:{x:0,y:-35.1,w:35,h:35},sourceSize:{w:35,h:35}}],meta:{app:"Adobe Flash Professional",version:"13.1.0.226",image:"Objects.png",format:"RGBA8888",size:{w:4096,h:4096},scale:"1"}},t}(),ObjectsLayouts=function(){function t(){}return t.data=[{name:"BigElevatorGraphics",children:[{mc:"_bigElevBack",name:"",x:0,y:0},{mc:"_cogwheel",name:"cogwheel1",x:-14,y:0},{mc:"_cogwheel2",name:"cogwheel2",x:14,y:0},{mc:"_bigElevatorFront",name:"front",x:0,y:-4}]},{name:"cmcCredits",children:[{mc:"cmcCreditsDialog",name:"",x:0,y:0},{mc:"BackButton",name:"backButton",x:89,y:491}]},{name:"cmcJoypadLeft",children:[{mc:"cbtnArrow",name:"right",x:55,y:0,degrees:90},{mc:"cbtnArrow",name:"left",x:-55,y:0,degrees:-90}]},{name:"cmcJoypadRight",children:[{mc:"cbtnArrow",name:"up",x:54,y:0},{mc:"cbtnArrow",name:"down",x:-54,y:0,degrees:180},{mc:"cbtnGrab",name:"grab",x:-54,y:-108},{mc:"cbtnChange",name:"change",x:54,y:-108}]},{name:"cmcLevelSelect",children:[{mc:"cmcLevelSelectBG",name:"",x:-2,y:0},{mc:"cmcYouNeed",name:"youNeed",x:363,y:142},{mc:"_walkthroughButtonBig",name:"walkthroughButton",x:508,y:464},{mc:"_mainMenuButton",name:"menuButton",x:22,y:465},{mc:"cmcBonusHighlight",name:"bonusHighlight",x:544,y:169},{mc:"cmcBonusBag",name:"bonusBag",x:505,y:130},{mc:"cmcLock",name:"lock",x:501,y:176},{mc:"LevelIconGraphics",name:"l1",x:151,y:344},{mc:"LevelIconGraphics",name:"l2",x:221,y:372},{mc:"LevelIconGraphics",name:"l3",x:287,y:339},{mc:"LevelIconGraphics",name:"l4",x:356,y:336},{mc:"LevelIconGraphics",name:"l5",x:425,y:371},{mc:"LevelIconGraphics",name:"l6",x:490,y:347},{mc:"LevelIconGraphics",name:"l7",x:535,y:300},{mc:"LevelIconGraphics",name:"l8",x:532,y:236},{mc:"LevelIconGraphics",name:"l9",x:467,y:224},{mc:"LevelIconGraphics",name:"l10",x:405,y:206},{mc:"LevelIconGraphics",name:"l11",x:343,y:229},{mc:"LevelIconGraphics",name:"l12",x:275,y:213},{mc:"LevelIconGraphics",name:"l13",x:206,y:230},{mc:"LevelIconGraphics",name:"l14",x:130,y:211},{mc:"LevelIconGraphics",name:"l15",x:119,y:154},{mc:"LevelIconGraphics",name:"l16",x:159,y:99},{mc:"LevelIconGraphics",name:"l17",x:213,y:67},{mc:"LevelIconGraphics",name:"l18",x:288,y:82},{mc:"LevelIconGraphics",name:"l19",x:353,y:69},{mc:"LevelIconGraphics",name:"l20",x:425,y:83}]},{name:"cmcMainMenu",children:[{mc:"cmcMainMenuBack",name:"",x:0,y:0},{mc:"CreditsButton",name:"creditsButton",x:298,y:373},{mc:"PlayGameButton",name:"playButton",x:275,y:312,scaleX:1.0999755859375,scaleY:1.0999755859375},{mc:"_moreButton",name:"moreButton",x:278,y:429}]},{name:"cmcPause",children:[{mc:"cmcPauseDialog",name:"",x:0,y:0},{mc:"LevelsMapButton",name:"menuButton",x:27,y:156},{mc:"BackButton",name:"backButton",x:59,y:337}]},{name:"cmcYouLose",children:[{mc:"_levelFailedSign",name:"levelFailed",x:354,y:-203},{mc:"_walkthroughButton",name:"walkthroughButton",x:465,y:618},{mc:"_replayButton",name:"replayButton",x:271,y:618},{mc:"LevelsMapButton",name:"levelsButton",x:74,y:618}]},{name:"cmcYouWin",children:[{mc:"_levelCompletedSign",name:"levelCompleted",x:354,y:-203},{mc:"LevelsMapButton",name:"levelsButton",x:76,y:608},{mc:"_replayButton",name:"replayButton",x:269,y:608},{mc:"_nextButton",name:"nextButton",x:464,y:608},{mc:"_burgersBackground",name:"burgerBG",x:350,y:223},{mc:"_burg1",name:"b1",x:282,y:237},{mc:"_burg2",name:"b2",x:348,y:203},{mc:"_burg3",name:"b3",x:418,y:236}]},{name:"ElevatorGraphics",children:[{mc:"_elevatorBack",name:"",x:0,y:1},{mc:"_cogwheel",name:"cogwheel1",x:-8,y:2},{mc:"_cogwheel2",name:"cogwheel2",x:8,y:2},{mc:"_elevatorFront",name:"front",x:0,y:-2}]},{name:"PushButtonGraphics",children:[{mc:"_buttonTop",name:"top",x:0,y:-1},{mc:"_pushButtonBase",name:"",x:0,y:4}]},{name:"TopPanelBonusGraphics",children:[{mc:"cmcPanelBG",name:"panelBG",x:0,y:0},{mc:"_walkthroughButton",name:"walkthroughButton",x:273,y:4,scaleX:.75,scaleY:.75},{mc:"MenuButtonGraphics",name:"menuButton",x:530,y:4},{mc:"ReplayButtonGraphics",name:"replayButton",x:572,y:4},{mc:"SoundButtonGraphics",name:"soundButton",x:614,y:4},{mc:"MusicButtonGraphics",name:"musicButton",x:656,y:5}]},{name:"TopPanelGraphics",children:[{mc:"cmcPanelBG",name:"panelBG",x:0,y:0},{mc:"MenuButtonGraphics",name:"menuButton",x:530,y:4},{mc:"ReplayButtonGraphics",name:"replayButton",x:572,y:4},{mc:"SoundButtonGraphics",name:"soundButton",x:614,y:4},{mc:"MusicButtonGraphics",name:"musicButton",x:656,y:5},{mc:"_walkthroughButton",name:"walkthroughButton",x:280,y:4,scaleX:.75,scaleY:.75},{mc:"BurgerIndicator",name:"burgerPanel",x:28,y:7},{mc:"BurgerSmallGraphics",name:"b1",x:52,y:23},{mc:"BurgerSmallGraphics",name:"b2",x:83,y:23},{mc:"BurgerSmallGraphics",name:"b3",x:114,y:24}]},{name:"TriggerGraphics",children:[{mc:"_triggerHandle",name:"handle",x:2,y:5,scaleX:.999969482421875,scaleY:.999969482421875},{mc:"_triggerBase",name:"base",x:0,y:6}]}],t}(),PreloaderObjects=function(){function t(){}return t.data={frames:[{filename:"BigMenuButtonGraphics0000",frame:{x:585,y:1648,w:52,h:50},rotated:!1,trimmed:!0,spriteSourceSize:{x:0,y:0,w:52,h:50},sourceSize:{w:52,h:50}},{filename:"BigMenuButtonGraphics0001",frame:{x:640,y:1648,w:52,h:50},rotated:!1,trimmed:!0,spriteSourceSize:{x:0,y:0,w:52,h:50},sourceSize:{w:52,h:50}},{filename:"BigMenuButtonGraphics0002",frame:{x:585,y:1648,w:52,h:50},rotated:!1,trimmed:!0,spriteSourceSize:{x:0,y:0,w:52,h:50},sourceSize:{w:52,h:50}},{filename:"BigMusicMenuButton0000",frame:{x:491,y:1766,w:52,h:50},rotated:!1,trimmed:!0,spriteSourceSize:{x:0,y:0,w:52,h:50},sourceSize:{w:52,h:50}},{filename:"BigMusicMenuButton0001",frame:{x:491,y:1819,w:52,h:50},rotated:!1,trimmed:!0,spriteSourceSize:{x:0,y:0,w:52,h:50},sourceSize:{w:52,h:50}},{filename:"BigMusicMenuButton0002",frame:{x:546,y:1766,w:52,h:50},rotated:!1,trimmed:!0,spriteSourceSize:{x:0,y:0,w:52,h:50},sourceSize:{w:52,h:50}},{filename:"BigMusicMenuButton0003",frame:{x:546,y:1819,w:52,h:50},rotated:!1,trimmed:!0,spriteSourceSize:{x:0,y:0,w:52,h:50},sourceSize:{w:52,h:50}},{filename:"BigReplayButtonGraphics0000",frame:{x:585,y:1595,w:53,h:50},rotated:!1,trimmed:!0,spriteSourceSize:{x:0,y:0,w:53,h:50},sourceSize:{w:53,h:50}},{filename:"BigReplayButtonGraphics0001",frame:{x:641,y:1595,w:53,h:50},rotated:!1,trimmed:!0,spriteSourceSize:{x:0,y:0,w:53,h:50},sourceSize:{w:53,h:50}},{filename:"BigReplayButtonGraphics0002",frame:{x:585,y:1595,w:53,h:50},rotated:!1,trimmed:!0,spriteSourceSize:{x:0,y:0,w:53,h:50},sourceSize:{w:53,h:50}},{filename:"BigSoundButtonGraphics0000",frame:{x:601,y:1766,w:52,h:50},rotated:!1,trimmed:!0,spriteSourceSize:{x:0,y:0,w:52,h:50},sourceSize:{w:52,h:50}},{filename:"BigSoundButtonGraphics0001",frame:{x:649,y:1701,w:52,h:50},rotated:!1,trimmed:!0,spriteSourceSize:{x:0,y:0,w:52,h:50},sourceSize:{w:52,h:50}},{filename:"BigSoundButtonGraphics0002",frame:{x:601,y:1819,w:52,h:50},rotated:!1,trimmed:!0,spriteSourceSize:{x:0,y:0,w:52,h:50},sourceSize:{w:52,h:50}},{filename:"BigSoundButtonGraphics0003",frame:{x:1064,y:1591,w:52,h:50},rotated:!1,trimmed:!0,spriteSourceSize:{x:0,y:0,w:52,h:50},sourceSize:{w:52,h:50}},{filename:"LeftCurtainGraphics0000",frame:{x:708,y:532,w:470,h:528},rotated:!1,trimmed:!0,spriteSourceSize:{x:-1.5,y:-1.1,w:470,h:528},sourceSize:{w:470,h:528}},{filename:"MusicButtonGraphics0000",frame:{x:656,y:1754,w:40,h:39},rotated:!1,trimmed:!0,spriteSourceSize:{x:0,y:0,w:40,h:39},sourceSize:{w:40,h:39}},{filename:"MusicButtonGraphics0001",frame:{x:656,y:1796,w:40,h:39},rotated:!1,trimmed:!0,spriteSourceSize:{x:0,y:0,w:40,h:39},sourceSize:{w:40,h:39}},{filename:"MusicButtonGraphics0002",frame:{x:656,y:1838,w:40,h:39},rotated:!1,trimmed:!0,spriteSourceSize:{x:0,y:0,w:40,h:39},sourceSize:{w:40,h:39}},{filename:"MusicButtonGraphics0003",frame:{x:3,y:1835,w:40,h:39},rotated:!1,trimmed:!0,spriteSourceSize:{x:0,y:0,w:40,h:39},sourceSize:{w:40,h:39}},{filename:"RightCurtainGraphics0000",frame:{x:1141,y:1063,w:370,h:527},rotated:!1,trimmed:!0,spriteSourceSize:{x:-368.9,y:-.8,w:370,h:527},sourceSize:{w:370,h:527}},{filename:"SoundButtonGraphics0000",frame:{x:46,y:1835,w:40,h:39},rotated:!1,trimmed:!0,spriteSourceSize:{x:0,y:0,w:40,h:39},sourceSize:{w:40,h:39}},{filename:"SoundButtonGraphics0001",frame:{x:89,y:1835,w:40,h:39},rotated:!1,trimmed:!0,spriteSourceSize:{x:0,y:0,w:40,h:39},sourceSize:{w:40,h:39}},{filename:"SoundButtonGraphics0002",frame:{x:132,y:1835,w:40,h:39},rotated:!1,trimmed:!0,spriteSourceSize:{x:0,y:0,w:40,h:39},sourceSize:{w:40,h:39}},{filename:"SoundButtonGraphics0003",frame:{x:175,y:1835,w:40,h:39},rotated:!1,trimmed:!0,spriteSourceSize:{x:0,y:0,w:40,h:39},sourceSize:{w:40,h:39}},{filename:"cbtnPlay0000",frame:{x:429,y:1595,w:153,h:67},rotated:!1,trimmed:!0,spriteSourceSize:{x:-1.1,y:0,w:153,h:67},sourceSize:{w:153,h:67}},{filename:"cbtnPlay0001",frame:{x:167,y:1642,w:153,h:67},rotated:!1,trimmed:!0,spriteSourceSize:{x:-1.1,y:0,w:153,h:67},sourceSize:{w:153,h:67}},{filename:"cbtnPlay0002",frame:{x:3,y:1685,w:153,h:67},rotated:!1,trimmed:!0,spriteSourceSize:{x:-1.1,y:0,w:153,h:67},sourceSize:{w:153,h:67}},{filename:"cmcFinalAnimationBG0000",frame:{x:3,y:537,w:702,h:526},rotated:!1,trimmed:!0,spriteSourceSize:{x:0,y:0,w:702,h:526},sourceSize:{w:702,h:526}},{filename:"cmcIntroAnimationBG0000",frame:{x:3,y:1066,w:702,h:526},rotated:!1,trimmed:!0,spriteSourceSize:{x:0,y:0,w:702,h:526},sourceSize:{w:702,h:526}},{filename:"cmcKizi0000",frame:{x:3,y:1595,w:161,h:87},rotated:!1,trimmed:!0,spriteSourceSize:{x:0,y:1.7,w:161,h:87},sourceSize:{w:161,h:87}},{filename:"cmcLoaderBar0000",frame:{x:323,y:1665,w:241,h:20},rotated:!1,trimmed:!0,spriteSourceSize:{x:9.6,y:12.8,w:241,h:20},sourceSize:{w:241,h:20}},{filename:"cmcLoaderBar0001",frame:{x:323,y:1688,w:241,h:20},rotated:!1,trimmed:!0,spriteSourceSize:{x:9.6,y:12.8,w:241,h:20},sourceSize:{w:241,h:20}},{filename:"cmcLoaderBar0002",frame:{x:159,y:1743,w:241,h:20},rotated:!1,trimmed:!0,spriteSourceSize:{x:9.6,y:12.8,w:241,h:20},sourceSize:{w:241,h:20}},{filename:"cmcLoaderBar0003",frame:{x:403,y:1743,w:241,h:20},rotated:!1,trimmed:!0,spriteSourceSize:{x:9.6,y:12.8,w:241,h:20},sourceSize:{w:241,h:20}},{filename:"cmcLoaderBar0004",frame:{x:405,y:1711,w:241,h:20},rotated:!1,trimmed:!0,spriteSourceSize:{x:9.6,y:12.8,w:241,h:20},sourceSize:{w:241,h:20}},{filename:"cmcLoaderBar0005",frame:{x:3,y:1766,w:241,h:20},rotated:!1,trimmed:!0,spriteSourceSize:{x:9.6,y:12.8,w:241,h:20},sourceSize:{w:241,h:20}},{filename:"cmcLoaderBar0006",frame:{x:247,y:1766,w:241,h:20},rotated:!1,trimmed:!0,spriteSourceSize:{x:9.6,y:12.8,w:241,h:20},sourceSize:{w:241,h:20}},{filename:"cmcLoaderBar0007",frame:{x:3,y:1789,w:241,h:20},rotated:!1,trimmed:!0,spriteSourceSize:{x:9.6,y:12.8,w:241,h:20},sourceSize:{w:241,h:20}},{filename:"cmcLoaderBar0008",frame:{x:247,y:1789,w:241,h:20},rotated:!1,trimmed:!0,spriteSourceSize:{x:9.6,y:12.8,w:241,h:20},sourceSize:{w:241,h:20}},{filename:"cmcLoaderBar0009",frame:{x:3,y:1812,w:241,h:20},rotated:!1,trimmed:!0,spriteSourceSize:{x:9.6,y:12.8,w:241,h:20},sourceSize:{w:241,h:20}},{filename:"cmcLoaderBar0010",frame:{x:247,y:1812,w:241,h:20},rotated:!1,trimmed:!0,spriteSourceSize:{x:9.6,y:12.8,w:241,h:20},sourceSize:{w:241,h:20}},{filename:"cmcLoaderBarBack0000",frame:{x:159,y:1712,w:243,h:28},rotated:!1,trimmed:!0,spriteSourceSize:{x:8,y:9.3,w:243,h:28},sourceSize:{w:243,h:28}},{filename:"cmcLoaderBarFront0000",frame:{x:167,y:1595,w:259,h:44},rotated:!1,trimmed:!0,spriteSourceSize:{x:0,y:-1,w:259,h:44},sourceSize:{w:259,h:44}},{filename:"cmcPanelBG0000",frame:{x:3,y:3,w:702,h:531},rotated:!1,trimmed:!0,spriteSourceSize:{x:-.1,y:-4.2,w:702,h:531},sourceSize:{w:702,h:531}},{filename:"cmcPreloaderBG0000",frame:{x:708,y:3,w:702,h:526},rotated:!1,trimmed:!0,spriteSourceSize:{x:-1,y:-.7,w:702,h:526},sourceSize:{w:702,h:526}},{filename:"cmcSidePad0000",frame:{x:708,y:1063,w:430,h:525},rotated:!1,trimmed:!0,spriteSourceSize:{x:-430,y:0,w:430,h:525},sourceSize:{w:430,h:525}},{filename:"cmcTitlePreloader0000",frame:{x:708,y:1591,w:353,h:259},rotated:!1,trimmed:!0,spriteSourceSize:{x:-11.5,y:0,w:353,h:259},sourceSize:{w:353,h:259}}],meta:{app:"Adobe Flash Professional",version:"13.1.0.226",image:"PreloaderObjects.png",format:"RGBA8888",size:{w:2048,h:2048},scale:"1"}},t}(),PreloaderObjectsLayouts=function(){function t(){}return t.data=[{name:"cmcPreloader",children:[{mc:"cmcPreloaderBG",name:"bg",x:0,y:0},{mc:"cbtnPlay",name:"btnPlay",x:279,y:423},{mc:"cmcLoaderBarBack",name:"barBack",x:222,y:432},{mc:"MusicButtonGraphics",name:"btnMusic",x:657,y:3},{mc:"SoundButtonGraphics",name:"btnSound",x:613,y:3},{mc:"cmcTitlePreloader",name:"title",x:197,y:136},{mc:"cmcLoaderBar",name:"bar",x:222,y:431},{mc:"cmcLoaderBarFront",name:"barFront",x:222,y:432}]}],t}(),WinningObjects=function(){function t(){}return t.data={frames:[{filename:"cmcCopLose0000",frame:{x:3664,y:979,w:172,h:205},rotated:!1,trimmed:!0,spriteSourceSize:{x:18,y:8.5,w:172,h:205},sourceSize:{w:172,h:205}},{filename:"cmcCopWin0000",frame:{x:1984,y:826,w:185,h:207},rotated:!1,trimmed:!0,spriteSourceSize:{x:-610.7,y:-80.8,w:587,h:252},sourceSize:{w:587,h:252}},{filename:"cmcCopWin0001",frame:{x:2704,y:217,w:193,h:228},rotated:!1,trimmed:!0,spriteSourceSize:{x:-564.7,y:-101.8,w:587,h:252},sourceSize:{w:587,h:252}},{filename:"cmcCopWin0002",frame:{x:2973,y:213,w:203,h:241},rotated:!1,trimmed:!0,spriteSourceSize:{x:-518.7,y:-115.8,w:587,h:252},sourceSize:{w:587,h:252}},{filename:"cmcCopWin0003",frame:{x:3759,y:198,w:213,h:249},rotated:!1,trimmed:!0,spriteSourceSize:{x:-472.7,y:-124.8,w:587,h:252},sourceSize:{w:587,h:252}},{filename:"cmcCopWin0004",frame:{x:3252,y:3,w:224,h:250},rotated:!1,trimmed:!0,spriteSourceSize:{x:-426.7,y:-125.8,w:587,h:252},sourceSize:{w:587,h:252}},{filename:"cmcCopWin0005",frame:{x:3479,y:206,w:200,h:249},rotated:!1,trimmed:!0,spriteSourceSize:{x:-380.7,y:-125.8,w:587,h:252},sourceSize:{w:587,h:252}},{filename:"cmcCopWin0006",frame:{x:1604,y:233,w:176,h:247},rotated:!1,trimmed:!0,spriteSourceSize:{x:-340.7,y:-123.8,w:587,h:252},sourceSize:{w:587,h:252}},{filename:"cmcCopWin0007",frame:{x:781,y:250,w:176,h:245},rotated:!1,trimmed:!0,spriteSourceSize:{x:-327.7,y:-121.8,w:587,h:252},sourceSize:{w:587,h:252}},{filename:"cmcCopWin0008",frame:{x:247,y:254,w:175,h:243},rotated:!1,trimmed:!0,spriteSourceSize:{x:-316.7,y:-119.8,w:587,h:252},sourceSize:{w:587,h:252}},{filename:"cmcCopWin0009",frame:{x:2389,y:397,w:175,h:241},rotated:!1,trimmed:!0,spriteSourceSize:{x:-306.7,y:-116.8,w:587,h:252},sourceSize:{w:587,h:252}},{filename:"cmcCopWin0010",frame:{x:2117,y:409,w:174,h:238},rotated:!1,trimmed:!0,spriteSourceSize:{x:-295.7,y:-113.8,w:587,h:252},sourceSize:{w:587,h:252}},{filename:"cmcCopWin0011",frame:{x:1318,y:421,w:174,h:235},rotated:!1,trimmed:!0,spriteSourceSize:{x:-284.7,y:-109.8,w:587,h:252},sourceSize:{w:587,h:252}},{filename:"cmcCopWin0012",frame:{x:425,y:426,w:173,h:230},rotated:!1,trimmed:!0,spriteSourceSize:{x:-271.7,y:-104.8,w:587,h:252},sourceSize:{w:587,h:252}},{filename:"cmcCopWin0013",frame:{x:3912,y:450,w:172,h:222},rotated:!1,trimmed:!0,spriteSourceSize:{x:-254.7,y:-95.8,w:587,h:252},sourceSize:{w:587,h:252}},{filename:"cmcCopWin0014",frame:{x:2418,y:986,w:170,h:206},rotated:!1,trimmed:!0,spriteSourceSize:{x:-231.7,y:-79.8,w:587,h:252},sourceSize:{w:587,h:252}},{filename:"cmcCopWin0015",frame:{x:3163,y:987,w:168,h:204},rotated:!1,trimmed:!0,spriteSourceSize:{x:-200.7,y:-77.8,w:587,h:252},sourceSize:{w:587,h:252}},{filename:"cmcCopWin0016",frame:{x:3839,y:979,w:172,h:205},rotated:!1,trimmed:!0,spriteSourceSize:{x:-200.7,y:-78.8,w:587,h:252},sourceSize:{w:587,h:252}},{filename:"cmcCopWin0017",frame:{x:3487,y:979,w:174,h:206},rotated:!1,trimmed:!0,spriteSourceSize:{x:-200.7,y:-79.8,w:587,h:252},sourceSize:{w:587,h:252}},{filename:"cmcCopWin0018",frame:{x:2985,y:963,w:175,h:206},rotated:!1,trimmed:!0,spriteSourceSize:{x:-200.7,y:-79.8,w:587,h:252},sourceSize:{w:587,h:252}},{filename:"cmcCopWin0019",frame:{x:870,y:953,w:176,h:207},rotated:!1,trimmed:!0,spriteSourceSize:{x:-200.7,y:-80.8,w:587,h:252},sourceSize:{w:587,h:252}},{filename:"cmcCopWin0020",frame:{x:690,y:953,w:177,h:208},rotated:!1,trimmed:!0,spriteSourceSize:{x:-200.7,y:-81.8,w:587,h:252},sourceSize:{w:587,h:252}},{filename:"cmcCopWin0021",frame:{x:2591,y:987,w:168,h:208},rotated:!1,trimmed:!0,spriteSourceSize:{x:-200.7,y:-81.8,w:587,h:252},sourceSize:{w:587,h:252}},{filename:"cmcCopWin0022",frame:{x:2762,y:987,w:168,h:208},rotated:!1,trimmed:!0,spriteSourceSize:{x:-200.7,y:-81.8,w:587,h:252},sourceSize:{w:587,h:252}},{filename:"cmcCopWin20000",frame:{x:2172,y:992,w:160,h:209},rotated:!1,trimmed:!0,spriteSourceSize:{x:-187.2,y:-96.9,w:160,h:209},sourceSize:{w:160,h:209}},{filename:"cmcCopWin20001",frame:{x:1610,y:1001,w:160,h:209},rotated:!1,trimmed:!0,spriteSourceSize:{x:-187.2,y:-96.9,w:160,h:209},sourceSize:{w:160,h:209}},{filename:"cmcCopWin20002",frame:{x:1773,y:1001,w:160,h:209},rotated:!1,trimmed:!0,spriteSourceSize:{x:-187.2,y:-96.9,w:160,h:209},sourceSize:{w:160,h:209}},{filename:"cmcCopWin20003",frame:{x:222,y:1011,w:160,h:209},rotated:!1,trimmed:!0,spriteSourceSize:{x:-187.2,y:-96.9,w:160,h:209},sourceSize:{w:160,h:209}},{filename:"cmcCopWin20004",frame:{x:1049,y:1012,w:160,h:209},rotated:!1,trimmed:!0,spriteSourceSize:{x:-187.2,y:-96.9,w:160,h:209},sourceSize:{w:160,h:209}},{filename:"cmcCopWin20005",frame:{x:1212,y:1012,w:160,h:209},rotated:!1,trimmed:!0,spriteSourceSize:{x:-187.2,y:-96.9,w:160,h:209},sourceSize:{w:160,h:209}},{filename:"cmcCopWin20006",frame:{x:385,y:1028,w:160,h:209},rotated:!1,trimmed:!0,spriteSourceSize:{x:-187.2,y:-96.9,w:160,h:209},sourceSize:{w:160,h:209}},{filename:"cmcCopWin20007",frame:{x:1936,y:1036,w:160,h:209},rotated:!1,trimmed:!0,spriteSourceSize:{x:-187.2,y:-96.9,w:160,h:209},sourceSize:{w:160,h:209}},{filename:"cmcCopWin20008",frame:{x:1375,y:1113,w:160,h:209},rotated:!1,trimmed:!0,spriteSourceSize:{x:-187.2,y:-96.9,w:160,h:209},sourceSize:{w:160,h:209}},{filename:"cmcCopWin20009",frame:{x:3,y:1133,w:160,h:209},rotated:!1,trimmed:!0,spriteSourceSize:{x:-187.2,y:-96.9,w:160,h:209},sourceSize:{w:160,h:209}},{filename:"cmcCopWin20010",frame:{x:2661,y:1198,w:160,h:208},rotated:!1,trimmed:!0,spriteSourceSize:{x:-187.2,y:-95.9,w:160,h:209},sourceSize:{w:160,h:209}},{filename:"cmcCopWin20011",frame:{x:2099,y:1204,w:160,h:208},rotated:!1,trimmed:!0,spriteSourceSize:{x:-187.2,y:-95.9,w:160,h:209},sourceSize:{w:160,h:209}},{filename:"cmcCopWin20012",frame:{x:1538,y:1213,w:160,h:208},rotated:!1,trimmed:!0,spriteSourceSize:{x:-187.2,y:-95.9,w:160,h:209},sourceSize:{w:160,h:209}},{filename:"cmcCopWin20013",frame:{x:1701,y:1213,w:160,h:208},rotated:!1,trimmed:!0,spriteSourceSize:{x:-187.2,y:-95.9,w:160,h:209},sourceSize:{w:160,h:209}},{filename:"cmcCopWin20014",frame:{x:166,y:1223,w:160,h:208},rotated:!1,trimmed:!0,spriteSourceSize:{x:-187.2,y:-95.9,w:160,h:209},sourceSize:{w:160,h:209}},{filename:"cmcCopWin20015",frame:{x:1033,y:1224,w:160,h:208},rotated:!1,trimmed:!0,spriteSourceSize:{x:-187.2,y:-95.9,w:160,h:209},sourceSize:{w:160,h:209}},{filename:"cmcCopWin20016",frame:{x:1196,y:1224,w:160,h:208},rotated:!1,trimmed:!0,spriteSourceSize:{x:-187.2,y:-95.9,w:160,h:209},sourceSize:{w:160,h:209}},{filename:"cmcCopWin20017",frame:{x:329,y:1240,w:160,h:208},rotated:!1,trimmed:!0,spriteSourceSize:{x:-187.2,y:-95.9,w:160,h:209},sourceSize:{w:160,h:209}},{filename:"cmcCopWin20018",frame:{x:3823,y:1399,w:160,h:207},rotated:!1,trimmed:!0,spriteSourceSize:{x:-187.2,y:-94.9,w:160,h:209},sourceSize:{w:160,h:209}},{filename:"cmcCopWin20019",frame:{x:3823,y:1399,w:160,h:207},rotated:!1,trimmed:!0,spriteSourceSize:{x:-187.2,y:-94.9,w:160,h:209},sourceSize:{w:160,h:209}},{filename:"cmcCopWin20020",frame:{x:3259,y:1400,w:160,h:207},rotated:!1,trimmed:!0,spriteSourceSize:{x:-187.2,y:-94.9,w:160,h:209},sourceSize:{w:160,h:209}},{filename:"cmcCopWin20021",frame:{x:3422,y:1400,w:160,h:207},rotated:!1,trimmed:!0,spriteSourceSize:{x:-187.2,y:-94.9,w:160,h:209},sourceSize:{w:160,h:209}},{filename:"cmcCopWin20022",frame:{x:3422,y:1400,w:160,h:207},rotated:!1,trimmed:!0,spriteSourceSize:{x:-187.2,y:-94.9,w:160,h:209},sourceSize:{w:160,h:209}},{filename:"cmcCopWin20023",frame:{x:1864,y:1248,w:160,h:208},rotated:!1,trimmed:!0,spriteSourceSize:{x:-187.2,y:-95.9,w:160,h:209},sourceSize:{w:160,h:209}},{filename:"cmcCopWin20024",frame:{x:1359,y:1325,w:160,h:208},rotated:!1,trimmed:!0,spriteSourceSize:{x:-187.2,y:-95.9,w:160,h:209},sourceSize:{w:160,h:209}},{filename:"cmcCopWin20025",frame:{x:3,y:1345,w:160,h:208},rotated:!1,trimmed:!0,spriteSourceSize:{x:-187.2,y:-95.9,w:160,h:209},sourceSize:{w:160,h:209}},{filename:"cmcCopWin20026",frame:{x:711,y:1375,w:160,h:208},rotated:!1,trimmed:!0,spriteSourceSize:{x:-187.2,y:-95.9,w:160,h:209},sourceSize:{w:160,h:209}},{filename:"cmcCopWin20027",frame:{x:492,y:1376,w:160,h:208},rotated:!1,trimmed:!0,spriteSourceSize:{x:-187.2,y:-95.9,w:160,h:209},sourceSize:{w:160,h:209}},{filename:"cmcCopWin20028",frame:{x:2824,y:1384,w:160,h:208},rotated:!1,trimmed:!0,spriteSourceSize:{x:-187.2,y:-95.9,w:160,h:209},sourceSize:{w:160,h:209}},{filename:"cmcCopWin20029",frame:{x:3660,y:1399,w:160,h:208},rotated:!1,trimmed:!0,spriteSourceSize:{x:-187.2,y:-95.9,w:160,h:209},sourceSize:{w:160,h:209}},{filename:"cmcCopWin20030",frame:{x:870,y:1163,w:160,h:209},rotated:!1,trimmed:!0,spriteSourceSize:{x:-187.2,y:-96.9,w:160,h:209},sourceSize:{w:160,h:209}},{filename:"cmcCopWin20031",frame:{x:548,y:1164,w:160,h:209},rotated:!1,trimmed:!0,spriteSourceSize:{x:-187.2,y:-96.9,w:160,h:209},sourceSize:{w:160,h:209}},{filename:"cmcCopWin20032",frame:{x:2933,y:1172,w:160,h:209},rotated:!1,trimmed:!0,spriteSourceSize:{x:-187.2,y:-96.9,w:160,h:209},sourceSize:{w:160,h:209}},{filename:"cmcCopWin20033",frame:{x:3664,y:1187,w:160,h:209},rotated:!1,trimmed:!0,spriteSourceSize:{x:-187.2,y:-96.9,w:160,h:209},sourceSize:{w:160,h:209}},{filename:"cmcCopWin20034",frame:{x:3827,y:1187,w:160,h:209},rotated:!1,trimmed:!0,spriteSourceSize:{x:-187.2,y:-96.9,w:160,h:209},sourceSize:{w:160,h:209}},{filename:"cmcCopWin20035",frame:{x:3334,y:1188,w:160,h:209},rotated:!1,trimmed:!0,spriteSourceSize:{x:-187.2,y:-96.9,w:160,h:209},sourceSize:{w:160,h:209}},{filename:"cmcCopWin20036",frame:{x:3497,y:1188,w:160,h:209},rotated:!1,trimmed:!0,spriteSourceSize:{x:-187.2,y:-96.9,w:160,h:209},sourceSize:{w:160,h:209}},{filename:"cmcCopWin20037",frame:{x:3096,y:1194,w:160,h:209},rotated:!1,trimmed:!0,spriteSourceSize:{x:-187.2,y:-96.9,w:160,h:209},sourceSize:{w:160,h:209}},{filename:"cmcCopWin20038",frame:{x:2335,y:1195,w:160,h:209},rotated:!1,trimmed:!0,spriteSourceSize:{x:-187.2,y:-96.9,w:160,h:209},sourceSize:{w:160,h:209}},{filename:"cmcCopWin20039",frame:{x:2498,y:1198,w:160,h:209},rotated:!1,trimmed:!0,spriteSourceSize:{x:-187.2,y:-96.9,w:160,h:209},sourceSize:{w:160,h:209}},{filename:"cmcCopWin20040",frame:{x:2172,y:992,w:160,h:209},rotated:!1,trimmed:!0,spriteSourceSize:{x:-187.2,y:-96.9,w:160,h:209},sourceSize:{w:160,h:209}},{filename:"cmcDogLose0000",frame:{x:3,y:963,w:216,h:167},rotated:!1,trimmed:!0,spriteSourceSize:{x:-27.7,y:16.2,w:216,h:167},sourceSize:{w:216,h:167}},{filename:"cmcDogWin0000",frame:{x:1074,y:3,w:261,h:234},rotated:!1,trimmed:!0,spriteSourceSize:{x:288.4,y:-105.6,w:629,h:250},sourceSize:{w:629,h:250}},{filename:"cmcDogWin0001",frame:{x:811,y:3,w:260,h:244},rotated:!1,trimmed:!0,spriteSourceSize:{x:242.4,y:-116.6,w:629,h:250},sourceSize:{w:629,h:250}},{filename:"cmcDogWin0002",frame:{x:272,y:3,w:262,h:248},rotated:!1,trimmed:!0,spriteSourceSize:{x:193.4,y:-121.6,w:629,h:250},sourceSize:{w:629,h:250}},{filename:"cmcDogWin0003",frame:{x:3,y:3,w:266,h:246},rotated:!1,trimmed:!0,spriteSourceSize:{x:145.4,y:-119.6,w:629,h:250},sourceSize:{w:629,h:250}},{filename:"cmcDogWin0004",frame:{x:537,y:3,w:271,h:238},rotated:!1,trimmed:!0,spriteSourceSize:{x:97.4,y:-112.6,w:629,h:250},sourceSize:{w:629,h:250}},{filename:"cmcDogWin0005",frame:{x:1338,y:3,w:263,h:232},rotated:!1,trimmed:!0,spriteSourceSize:{x:73.4,y:-107.6,w:629,h:250},sourceSize:{w:629,h:250}},{filename:"cmcDogWin0006",frame:{x:1604,y:3,w:266,h:227},rotated:!1,trimmed:!0,spriteSourceSize:{x:56.4,y:-103.6,w:629,h:250},sourceSize:{w:629,h:250}},{filename:"cmcDogWin0007",frame:{x:1873,y:3,w:269,h:223},rotated:!1,trimmed:!0,spriteSourceSize:{x:43.4,y:-98.6,w:629,h:250},sourceSize:{w:629,h:250}},{filename:"cmcDogWin0008",frame:{x:2145,y:3,w:271,h:219},rotated:!1,trimmed:!0,spriteSourceSize:{x:31.4,y:-94.6,w:629,h:250},sourceSize:{w:629,h:250}},{filename:"cmcDogWin0009",frame:{x:2419,y:3,w:273,h:216},rotated:!1,trimmed:!0,spriteSourceSize:{x:21.5,y:-90.6,w:629,h:250},sourceSize:{w:629,h:250}},{filename:"cmcDogWin0010",frame:{x:2695,y:3,w:275,h:211},rotated:!1,trimmed:!0,spriteSourceSize:{x:10.5,y:-85.6,w:629,h:250},sourceSize:{w:629,h:250}},{filename:"cmcDogWin0011",frame:{x:2973,y:3,w:276,h:207},rotated:!1,trimmed:!0,spriteSourceSize:{x:-.5,y:-80.6,w:629,h:250},sourceSize:{w:629,h:250}},{filename:"cmcDogWin0012",frame:{x:3479,y:3,w:277,h:200},rotated:!1,trimmed:!0,spriteSourceSize:{x:-12.5,y:-73.6,w:629,h:250},sourceSize:{w:629,h:250}},{filename:"cmcDogWin0013",frame:{x:3759,y:3,w:279,h:192},rotated:!1,trimmed:!0,spriteSourceSize:{x:-29.6,y:-64.6,w:629,h:250},sourceSize:{w:629,h:250}},{filename:"cmcDogWin0014",frame:{x:2419,y:222,w:282,h:172},rotated:!1,trimmed:!0,spriteSourceSize:{x:-57.6,y:-44.6,w:629,h:250},sourceSize:{w:629,h:250}},{filename:"cmcDogWin0015",frame:{x:1783,y:413,w:245,h:168},rotated:!1,trimmed:!0,spriteSourceSize:{x:-79.6,y:-39.6,w:629,h:250},sourceSize:{w:629,h:250}},{filename:"cmcDogWin0016",frame:{x:3179,y:256,w:241,h:175},rotated:!1,trimmed:!0,spriteSourceSize:{x:-79.6,y:-46.6,w:629,h:250},sourceSize:{w:629,h:250}},{filename:"cmcDogWin0017",frame:{x:3,y:252,w:241,h:178},rotated:!1,trimmed:!0,spriteSourceSize:{x:-79.6,y:-49.6,w:629,h:250},sourceSize:{w:629,h:250}},{filename:"cmcDogWin0018",frame:{x:1338,y:238,w:241,h:180},rotated:!1,trimmed:!0,spriteSourceSize:{x:-79.6,y:-51.6,w:629,h:250},sourceSize:{w:629,h:250}},{filename:"cmcDogWin0019",frame:{x:2145,y:225,w:241,h:181},rotated:!1,trimmed:!0,spriteSourceSize:{x:-79.6,y:-52.6,w:629,h:250},sourceSize:{w:629,h:250}},{filename:"cmcDogWin0020",frame:{x:1873,y:229,w:241,h:181},rotated:!1,trimmed:!0,spriteSourceSize:{x:-79.6,y:-52.6,w:629,h:250},sourceSize:{w:629,h:250}},{filename:"cmcDogWin0021",frame:{x:1074,y:240,w:241,h:180},rotated:!1,trimmed:!0,spriteSourceSize:{x:-79.6,y:-51.6,w:629,h:250},sourceSize:{w:629,h:250}},{filename:"cmcDogWin0022",frame:{x:537,y:244,w:241,h:179},rotated:!1,trimmed:!0,spriteSourceSize:{x:-79.6,y:-50.6,w:629,h:250},sourceSize:{w:629,h:250}},{filename:"cmcDogWin20000",frame:{x:232,y:835,w:226,h:173},rotated:!1,trimmed:!0,spriteSourceSize:{x:-54,y:-60.9,w:229,h:174},sourceSize:{w:229,h:174}},{filename:"cmcDogWin20001",frame:{x:2798,y:634,w:226,h:174},rotated:!1,trimmed:!0,spriteSourceSize:{x:-54,y:-61.9,w:229,h:174},sourceSize:{w:229,h:174}},{filename:"cmcDogWin20002",frame:{x:465,y:675,w:226,h:174},rotated:!1,trimmed:!0,spriteSourceSize:{x:-54,y:-61.9,w:229,h:174},sourceSize:{w:229,h:174}},{filename:"cmcDogWin20003",frame:{x:3179,y:434,w:227,h:174},rotated:!1,trimmed:!0,spriteSourceSize:{x:-55,y:-61.9,w:229,h:174},sourceSize:{w:229,h:174}},{filename:"cmcDogWin20004",frame:{x:2567,y:448,w:227,h:174},rotated:!1,trimmed:!0,spriteSourceSize:{x:-55,y:-61.9,w:229,h:174},sourceSize:{w:229,h:174}},{filename:"cmcDogWin20005",frame:{x:3682,y:450,w:227,h:174},rotated:!1,trimmed:!0,spriteSourceSize:{x:-55,y:-61.9,w:229,h:174},sourceSize:{w:229,h:174}},{filename:"cmcDogWin20006",frame:{x:1524,y:760,w:226,h:174},rotated:!1,trimmed:!0,spriteSourceSize:{x:-54,y:-61.9,w:229,h:174},sourceSize:{w:229,h:174}},{filename:"cmcDogWin20007",frame:{x:1152,y:836,w:226,h:173},rotated:!1,trimmed:!0,spriteSourceSize:{x:-54,y:-60.9,w:229,h:174},sourceSize:{w:229,h:174}},{filename:"cmcDogWin20008",frame:{x:461,y:852,w:226,h:173},rotated:!1,trimmed:!0,spriteSourceSize:{x:-54,y:-60.9,w:229,h:174},sourceSize:{w:229,h:174}},{filename:"cmcDogWin20009",frame:{x:3027,y:787,w:227,h:173},rotated:!1,trimmed:!0,spriteSourceSize:{x:-55,y:-60.9,w:229,h:174},sourceSize:{w:229,h:174}},{filename:"cmcDogWin20010",frame:{x:3489,y:803,w:227,h:173},rotated:!1,trimmed:!0,spriteSourceSize:{x:-55,y:-60.9,w:229,h:174},sourceSize:{w:229,h:174}},{filename:"cmcDogWin20011",frame:{x:1725,y:584,w:228,h:173},rotated:!1,trimmed:!0,spriteSourceSize:{x:-56,y:-60.9,w:229,h:174},sourceSize:{w:229,h:174}},{filename:"cmcDogWin20012",frame:{x:3,y:433,w:228,h:174},rotated:!1,trimmed:!0,spriteSourceSize:{x:-56,y:-61.9,w:229,h:174},sourceSize:{w:229,h:174}},{filename:"cmcDogWin20013",frame:{x:831,y:600,w:228,h:173},rotated:!1,trimmed:!0,spriteSourceSize:{x:-56,y:-60.9,w:229,h:174},sourceSize:{w:229,h:174}},{filename:"cmcDogWin20014",frame:{x:1062,y:600,w:228,h:173},rotated:!1,trimmed:!0,spriteSourceSize:{x:-56,y:-60.9,w:229,h:174},sourceSize:{w:229,h:174}},{filename:"cmcDogWin20015",frame:{x:3,y:610,w:228,h:173},rotated:!1,trimmed:!0,spriteSourceSize:{x:-56,y:-60.9,w:229,h:174},sourceSize:{w:229,h:174}},{filename:"cmcDogWin20016",frame:{x:3027,y:611,w:228,h:173},rotated:!1,trimmed:!0,spriteSourceSize:{x:-56,y:-60.9,w:229,h:174},sourceSize:{w:229,h:174}},{filename:"cmcDogWin20017",frame:{x:3639,y:627,w:228,h:173},rotated:!1,trimmed:!0,spriteSourceSize:{x:-56,y:-60.9,w:229,h:174},sourceSize:{w:229,h:174}},{filename:"cmcDogWin20018",frame:{x:2187,y:817,w:228,h:172},rotated:!1,trimmed:!0,spriteSourceSize:{x:-56,y:-59.9,w:229,h:174},sourceSize:{w:229,h:174}},{filename:"cmcDogWin20019",frame:{x:2567,y:634,w:228,h:173},rotated:!1,trimmed:!0,spriteSourceSize:{x:-56,y:-60.9,w:229,h:174},sourceSize:{w:229,h:174}},{filename:"cmcDogWin20020",frame:{x:1753,y:826,w:228,h:172},rotated:!1,trimmed:!0,spriteSourceSize:{x:-56,y:-59.9,w:229,h:174},sourceSize:{w:229,h:174}},{filename:"cmcDogWin20021",frame:{x:3258,y:635,w:228,h:173},rotated:!1,trimmed:!0,spriteSourceSize:{x:-56,y:-60.9,w:229,h:174},sourceSize:{w:229,h:174}},{filename:"cmcDogWin20022",frame:{x:2294,y:641,w:228,h:173},rotated:!1,trimmed:!0,spriteSourceSize:{x:-56,y:-60.9,w:229,h:174},sourceSize:{w:229,h:174}},{filename:"cmcDogWin20023",frame:{x:960,y:423,w:229,h:174},rotated:!1,trimmed:!0,spriteSourceSize:{x:-57,y:-61.9,w:229,h:174},sourceSize:{w:229,h:174}},{filename:"cmcDogWin20024",frame:{x:1956,y:650,w:228,h:173},rotated:!1,trimmed:!0,spriteSourceSize:{x:-56,y:-60.9,w:229,h:174},sourceSize:{w:229,h:174}},{filename:"cmcDogWin20025",frame:{x:234,y:659,w:228,h:173},rotated:!1,trimmed:!0,spriteSourceSize:{x:-56,y:-60.9,w:229,h:174},sourceSize:{w:229,h:174}},{filename:"cmcDogWin20026",frame:{x:1293,y:660,w:228,h:173},rotated:!1,trimmed:!0,spriteSourceSize:{x:-56,y:-60.9,w:229,h:174},sourceSize:{w:229,h:174}},{filename:"cmcDogWin20027",frame:{x:3719,y:803,w:227,h:173},rotated:!1,trimmed:!0,spriteSourceSize:{x:-55,y:-60.9,w:229,h:174},sourceSize:{w:229,h:174}},{filename:"cmcDogWin20028",frame:{x:2525,y:810,w:227,h:173},rotated:!1,trimmed:!0,spriteSourceSize:{x:-55,y:-60.9,w:229,h:174},sourceSize:{w:229,h:174}},{filename:"cmcDogWin20029",frame:{x:2755,y:811,w:227,h:173},rotated:!1,trimmed:!0,spriteSourceSize:{x:-55,y:-60.9,w:229,h:174},sourceSize:{w:229,h:174}},{filename:"cmcDogWin20030",frame:{x:3257,y:811,w:227,h:173},rotated:!1,trimmed:!0,spriteSourceSize:{x:-55,y:-60.9,w:229,h:174},sourceSize:{w:229,h:174}},{filename:"cmcDogWin20031",frame:{x:2797,y:457,w:227,h:174},rotated:!1,trimmed:!0,spriteSourceSize:{x:-55,y:-61.9,w:229,h:174},sourceSize:{w:229,h:174}},{filename:"cmcDogWin20032",frame:{x:3409,y:458,w:227,h:174},rotated:!1,trimmed:!0,spriteSourceSize:{x:-55,y:-61.9,w:229,h:174},sourceSize:{w:229,h:174}},{filename:"cmcDogWin20033",frame:{x:1495,y:483,w:227,h:174},rotated:!1,trimmed:!0,spriteSourceSize:{x:-55,y:-61.9,w:229,h:174},sourceSize:{w:229,h:174}},{filename:"cmcDogWin20034",frame:{x:601,y:498,w:227,h:174},rotated:!1,trimmed:!0,spriteSourceSize:{x:-55,y:-61.9,w:229,h:174},sourceSize:{w:229,h:174}},{filename:"cmcDogWin20035",frame:{x:694,y:776,w:226,h:174},rotated:!1,trimmed:!0,spriteSourceSize:{x:-54,y:-61.9,w:229,h:174},sourceSize:{w:229,h:174}},{filename:"cmcDogWin20036",frame:{x:923,y:776,w:226,h:174},rotated:!1,trimmed:!0,spriteSourceSize:{x:-54,y:-61.9,w:229,h:174},sourceSize:{w:229,h:174}},{filename:"cmcDogWin20037",frame:{x:1381,y:937,w:226,h:173},rotated:!1,trimmed:!0,spriteSourceSize:{x:-54,y:-60.9,w:229,h:174},sourceSize:{w:229,h:174}},{filename:"cmcDogWin20038",frame:{x:1381,y:937,w:226,h:173},rotated:!1,trimmed:!0,spriteSourceSize:{x:-54,y:-60.9,w:229,h:174},sourceSize:{w:229,h:174}},{filename:"cmcDogWin20039",frame:{x:3,y:786,w:226,h:174},rotated:!1,trimmed:!0,spriteSourceSize:{x:-54,y:-61.9,w:229,h:174},sourceSize:{w:229,h:174}},{filename:"cmcDogWin20040",frame:{x:232,y:835,w:226,h:173},rotated:!1,trimmed:!0,spriteSourceSize:{x:-54,y:-60.9,w:229,h:174},sourceSize:{w:229,h:174}}],meta:{app:"Adobe Flash Professional",version:"13.1.0.226",image:"WinningObjects.png",format:"RGBA8888",size:{w:4096,h:4096},scale:"1"}},t}(),WinningObjectsLayouts=function(){function t(){}return t.data=[],t}();!function(r){var o;(t=o=o||{}).PAUSED="Paused",t.RESUMED="Resumed";var t=(e.getInstance=function(){return e.instance=!e.instance?new e:e.instance},e.prototype.init=function(){var t=new h5ads.GameDistribution("db770064d7cd45a798b096d4397a0870");h5ads.adWrapper.setAdProvider(t),window.hasOwnProperty("fbrqSA")&&!0===window.fbrqSA&&(h5branding.Utils.ASSET_LOCATION="assets/")},e.prototype.showAd=function(t,e,i){var n=this;r.LoaderHelper.show(),h5ads.adWrapper.once(h5ads.AdEvents.CONTENT_PAUSED,function(){r.LoaderHelper.hide(),i&&i.call(n),n.contentStatus=o.PAUSED,r.PauseHandler.getInstance().pause()}),h5ads.adWrapper.once(h5ads.AdEvents.CONTENT_RESUMED,function(){r.LoaderHelper.hide(),h5ads.adWrapper.removeAllListeners(h5ads.AdEvents.CONTENT_PAUSED),h5ads.adWrapper.removeAllListeners(h5ads.AdEvents.CONTENT_RESUMED),n.contentStatus=o.RESUMED,r.PauseHandler.getInstance().resume(),SoundManager.setAudioStatus(),e&&e.call(n)}),h5ads.adWrapper.showAd(h5ads.AdType.interstitial)},e.prototype.isAdPlaying=function(){return this.contentStatus===o.PAUSED},e);function e(){this.contentStatus=o.RESUMED}r.AdHandler=t}(Fabrique=Fabrique||{}),function(t){var e=(i.show=function(){var t=document.getElementById("loader");t&&(t.style.display="block")},i.hide=function(){var t=document.getElementById("loader");t&&(t.style.display="none")},i);function i(){}t.LoaderHelper=e}(Fabrique=Fabrique||{}),function(t){var i;(e=i=t.LocalizationType||(t.LocalizationType={})).English="en",e.Russian="ru";var e=(n.getInstance=function(t){return n.instance=!n.instance?new n(t):n.instance},n.prototype.initBrowserDetect=function(){languageDetector=new i18nextBrowserLanguageDetector(null,{order:["navigator","querystring","cookie","localStorage","sessionStorage","htmlTag"],lookupQuerystring:"lng",lookupCookie:"i18next",lookupLocalStorage:"i18nextLng",lookupSessionStorage:"i18nextLng",caches:["localStorage"],excludeCacheFor:["cimode"]})},n.prototype.initI18Next=function(){var e=this;i18next.use(languageDetector).init({fallbackLng:"en",debug:!1,resources:{en:{translation:this.game.cache.getJSON(i.English)},ru:{translation:this.game.cache.getJSON(i.Russian)}}}).then(function(t){i18next.changeLanguage("none"!==h5branding.Utils.LANGUAGE?h5branding.Utils.LANGUAGE:e.getDefaultLanguage())})},n.prototype.getDefaultLanguage=function(){if("none"!==h5branding.Utils.LANGUAGE)return h5branding.Utils.LANGUAGE;var t=i18next.language;return-1!==t.indexOf("-")&&(t=t.split("-")[0]),t=-1===Constants.SUPPORTED_LANGUAGES.indexOf(t)?i.English:t},n.prototype.getValue=function(t){return i18next.t(t)},n.prototype.getInterpolatedValue=function(t,e){return i18next.t(t,e)},n);function n(t){this.game=t}t.LocalizationHandler=e}(Fabrique=Fabrique||{}),function(t){var e=(i.getInstance=function(t){return i.instance=!i.instance?new i(t):i.instance},i.prototype.init=function(){var t=this;this.game.stage.disableVisibilityChange=!0,this.onPauseCallback=new Phaser.Signal,h5branding.Utils.isOnDevice()&&(document.addEventListener("pause",function(){return t.onPause()}),document.addEventListener("resume",function(){return t.onResume()})),this.game.onBlur.add(this.onBlur,this),this.game.onFocus.add(this.onFocus,this),this.game.onPause.add(this.onPause,this),this.game.onResume.add(this.onResume,this)},i.prototype.onBlur=function(){this.focused=!1,this.game.onPause.dispatch()},i.prototype.onFocus=function(){this.focused=!0,t.AdHandler.getInstance().isAdPlaying()||this.game.onResume.dispatch()},i.prototype.onPause=function(){this.game.sound.setMute(),this.onPauseCallback&&this.onPauseCallback.dispatch()},i.prototype.onResume=function(){this.game.sound.unsetMute()},i.prototype.pause=function(){this.game.onPause.dispatch()},i.prototype.resume=function(){this.hasFocus&&this.game.onResume.dispatch()},Object.defineProperty(i.prototype,"hasFocus",{get:function(){return this.focused},enumerable:!1,configurable:!0}),i);function i(t){this.game=t,this.focused=!0}t.PauseHandler=e}(Fabrique=Fabrique||{});var SaveDataManager=function(){function e(t){var e=this;this.nameSpace="mm3",this.reviewed=!1,this.musicOff=!0,this.sfxOff=!0,this.game=t,this.game.storage.setNamespace(this.nameSpace),this.game.storage.getItem("sg").then(function(t){null==t?(e.reviewed=!1,e.musicOff=!0,e.sfxOff=!0,e.save()):e.restore()})}return e.getInstance=function(t){return e.instance=!e.instance?new e(t):e.instance},Object.defineProperty(e.prototype,"isReviewed",{get:function(){return this.reviewed},set:function(t){this.reviewed=t,this.save()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isMusicOff",{get:function(){return this.musicOff},set:function(t){this.musicOff=t,this.save()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isSfxOff",{get:function(){return this.sfxOff},set:function(t){this.sfxOff=t,this.save()},enumerable:!1,configurable:!0}),e.prototype.save=function(){var t=JSON.stringify({r:this.reviewed,m:this.musicOff,sfx:this.sfxOff}),e=this.hash(t);this.game.storage.setItem("sg",t),this.game.storage.setItem("sgh",e)},e.prototype.restore=function(){var i,n,r=this,t=this.game.storage.getItem("sg"),e=this.game.storage.getItem("sgh");Promise.all([t,e]).then(function(t){if(i=t[0]||"",n=t[1]||"0",""!==i&&n===r.hash(i)&&i&&""!==i)try{var e=JSON.parse(i);r.reviewed=e.r,r.musicOff=e.m,r.sfxOff=e.sfx,r.save()}catch(t){}})},e.prototype.hash=function(t){var e,i,n=0;if(0===t.length)return n.toString();for(e=0,i=t.length;e<i;e++)n=(n<<5)-n+t.charCodeAt(e),n|=0;return n.toString()},e}(),TweenMax=function(){function d(){this.dummy=0}return d.Init=function(t){d.game=t},d.delayedCall=function(t,e,i){var n=new d;return t*=1e3,n.tween=this.game.add.tween(n).to({dummy:1},t,Phaser.Easing.Linear.None,!0),n.tween.onComplete.add(e,i),n},d.to=function(t,e,i){var n=new d,r=0;i.delay&&(r=i.delay,delete i.delay);var o=!1;i.yoyo&&(o=i.yoyo,delete i.yoyo);var s=0;i.repeat&&(s=i.repeat,delete i.repeat);var a=0;i.repeatDelay&&(a=i.repeatDelay,delete i.repeatDelay);var h=null;i.onComplete&&(h=i.onComplete,delete i.onComplete);var l=t;i.onCompleteContext&&(l=i.onCompleteContext,delete i.onCompleteContext);var p,u=Phaser.Easing.Linear.None;return i.ease&&("Linear.easeNone"==(p=i.ease)?u=Phaser.Easing.Linear.None:"Quad.easeOut"==p?u=Phaser.Easing.Quadratic.Out:"Quad.easeIn"==p?u=Phaser.Easing.Quadratic.In:"Back.easeOut"==p?u=Phaser.Easing.Back.Out:"Back.easeIn"==p&&(u=Phaser.Easing.Back.In),delete i.ease),n.tween=this.game.add.tween(t).to(i,1e3*e,u,!0,1e3*r,s,o),h&&n.tween.onComplete.add(h,l),0!=a&&(n.tween.repeatDelay(1e3*a),o&&n.tween.yoyoDelay(1e3*a)),n},d.pauseAll=function(){d.game.tweens.pauseAll()},d.resumeAll=function(){d.game.tweens.resumeAll()},d.prototype.pause=function(){this.tween.pause()},d.prototype.paused=function(){return this.tween.isPaused},d.prototype.resume=function(){this.tween.resume()},d.prototype.kill=function(){this.tween.stop()},d}();!function(t){var i,e=(i=t.CitrusObject,__extends(n,i),n.prototype.addPhysics=function(){this._nape=Constants.levelState._nape,this.defineBody(),this.createBody(),this.createMaterial(),this.createShape(),this.createFilter(),this.createConstraint()},n.prototype.destroy=function(){n.space.bodies.remove(this._body)},n.prototype.handlePreContact=function(t){return nape.callbacks.PreFlag.ACCEPT},n.prototype.handleBeginContact=function(t){},n.prototype.handleEndContact=function(t){},n.prototype.defineBody=function(){this._bodyType=nape.phys.BodyType.DYNAMIC},n.prototype.createBody=function(){var t,e,i,n,r;this._body=new nape.phys.Body(this._bodyType,new nape.geom.Vec2(this._x,this._y)),(this._body.userData.myData=this).view&&(n=i=e=t=0,"topLeft"==this.registration&&(r=Math.round((this.view.degrees+360)%360/90),"TriggerGraphics"==this.view.mc?1==r?(i=-5,n=-2):3==r&&(i=-4):"PushButtonGraphics"==this.view.mc?(2==r&&(n=-1),3==r&&(i=n=-7)):(t=-this.width/2,e=-this.height/2)),this._body.rotate(new nape.geom.Vec2(this._x+t,this._y+e),this.view.degrees*Math.PI/180),0!=i&&(this.x+=i),0!=n&&(this.y+=n)),this._body.rotate(new nape.geom.Vec2(this._x,this._y),this._rotation)},n.prototype.createMaterial=function(){this._material=new nape.phys.Material(.65,.57,1.2,1,0)},n.prototype.createShape=function(){if(null!=this.points&&1<this.points.length){for(var t=new nape.geom.Vec2List,e=0,i=this.points;e<i.length;e++){var n=i[e];t.push(new nape.geom.Vec2(n.x,n.y))}var r=new nape.shape.Polygon(t,this._material),o=r.validity();if(o!=nape.shape.ValidationResult.VALID){if(o!=nape.shape.ValidationResult.CONCAVE)throw new Error("Invalid polygon/polyline");return void new nape.geom.GeomPoly(t).convexDecomposition().foreach(function(t){this._body.shapes.add(new nape.shape.Polygon(t))})}this._shape=r}else 0!=this._radius?this._shape=new nape.shape.Circle(this._radius,null,this._material):this._shape=new nape.shape.Polygon(nape.shape.Polygon.box(this._width,this._height),this._material);this._body.shapes.add(this._shape)},n.prototype.createFilter=function(){this._body.setShapeFilters(new nape.dynamics.InteractionFilter(t.PhysicsCollisionCategories.Get("Level"),t.PhysicsCollisionCategories.GetAll()))},n.prototype.createConstraint=function(){this._body.space=n.space,this._body.cbTypes.add(n.PHYSICS_OBJECT)},Object.defineProperty(n.prototype,"visible",{get:function(){return this._visible},set:function(t){this._visible=t},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"x",{get:function(){return this._body?this._body.position.x:this._x},set:function(t){this._x=t,this._body&&((t=this._body.position).x=this._x,this._body.position=t)},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"y",{get:function(){return this._body?this._body.position.y:this._y},set:function(t){this._y=t,this._body&&((t=this._body.position).y=this._y,this._body.position=t)},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"z",{get:function(){return 0},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"rotation",{get:function(){return this._body?180*this._body.rotation/Math.PI:180*this._rotation/Math.PI},set:function(t){this._rotation=t*Math.PI/180,this._body&&(this._body.rotation=this._rotation)},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"width",{get:function(){return this._width},set:function(t){this._width=t,this._initialized},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"height",{get:function(){return this._height},set:function(t){this._height=t,this._initialized},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"depth",{get:function(){return 0},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"radius",{get:function(){return this._radius},set:function(t){this._radius=t,this._initialized},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"body",{get:function(){return this._body},enumerable:!1,configurable:!0}),n.prototype.getBody=function(){return this._body},Object.defineProperty(n.prototype,"velocity",{get:function(){return[this._body.velocity.x,this._body.velocity.y,0]},set:function(t){this._body.velocity.setxy(t[0],t[1])},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"beginContactCallEnabled",{get:function(){return this._beginContactCallEnabled},set:function(t){this._beginContactCallEnabled=t},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"endContactCallEnabled",{get:function(){return this._endContactCallEnabled},set:function(t){this._endContactCallEnabled=t},enumerable:!1,configurable:!0}),n.prototype.draw=function(){this.view&&(this.view.degrees=this.rotation,this.view.x=this.x+this.offsetX,this.view.y=this.y+this.offsetY)},n.PHYSICS_OBJECT=new nape.callbacks.CbType,n);function n(t,e){t=i.call(this,t,e)||this;return t._rotation=0,t._bodyType=null,t._body=null,t._shape=null,t._material=null,t._beginContactCallEnabled=!1,t._endContactCallEnabled=!1,t._visible=!0,t.points=null,e.rotation&&(t.rotation=e.rotation),t}t.NapePhysicsObject=e}(objects=objects||{});var NapeBody=nape.phys.Body;!function(t){var i,e=(i=t.NapePhysicsObject,__extends(n,i),n.prototype.hit=function(t){},n.prototype.action=function(){},n.prototype.moveHorizontally=function(t,e){(0<e&&t.velocity.x<e||e<0&&t.velocity.x>e)&&(t.velocity.x=e)},n.prototype.createMaterial=function(){i.prototype.createMaterial.call(this),this._material.elasticity=0,this._material.density=1,this._material.staticFriction=.1,this._material.dynamicFriction=1},n.prototype.destroy=function(){i.prototype.destroy.call(this),Constants.levelState.removeObject(this)},n);function n(t,e){e=i.call(this,t,e)||this;return e._vec=new Vec2,e.registration="topLeft",Constants.levelState.addObject(e),e}t.LevelObject=e}(objects=objects||{});var Vec2=nape.geom.Vec2;!function(t){var e,i=(e=t.LevelObject,__extends(n,e),n.prototype.createMaterial=function(){e.prototype.createMaterial.call(this),this._material.elasticity=1,this._material.density=1.4,this._material.staticFriction=.5,this._material.dynamicFriction=1},n.prototype.handleBeginContact=function(t){},n);function n(t){t=e.call(this,"ball",{view:t,radius:17,x:+t.x+18,y:+t.y-18,group:4})||this;return t.beginContactCallEnabled=!0,t.body.allowRotation=!0,t}t.BasketBall=i}(objects=objects||{}),function(t){var e,i=(e=t.LevelObject,__extends(n,e),n.prototype.createMaterial=function(){e.prototype.createMaterial.call(this),this._material.elasticity=.1,this._material.density=.9,this._material.staticFriction=.1,this._material.dynamicFriction=.35},n.prototype.handleBeginContact=function(t){22<this._body.velocity.y&&(SoundManager.getInstance().playSound("BoxDownSound"),this._isReadyToPlaySound=!1,TweenMax.delayedCall(1.25,function(){this._isReadyToPlaySound=!0},this))},n);function n(t){t=e.call(this,"bigBox",{view:t,width:t.width,height:t.height,x:+t.x+t.width/2,y:+t.y-t.height/2,group:4})||this;return t.beginContactCallEnabled=!0,t._isReadyToPlaySound=!0,t}t.BigBox=i}(objects=objects||{}),function(t){var e,i=(e=t.LevelObject,__extends(n,e),n.prototype.createMaterial=function(){e.prototype.createMaterial.call(this),this._material.density=1.5},n.prototype.handleBeginContact=function(t){22<this._body.velocity.y&&(SoundManager.getInstance().playSound("BoxDownSound"),this._isReadyToPlaySound=!1,TweenMax.delayedCall(1.25,this.isReadyToPlaySoundTrue,this))},n.prototype.isReadyToPlaySoundTrue=function(){this._isReadyToPlaySound=!0},n);function n(t){t=e.call(this,"box",{view:t,width:33,height:33,x:+t.x+16.5,y:+t.y-16.5,group:4})||this;return t.beginContactCallEnabled=!0,t._isReadyToPlaySound=!0,t}t.Box=i}(objects=objects||{}),function(e){var i,t=(i=e.LevelObject,__extends(n,i),n.prototype.handleBeginContact=function(t){t=NapeUtils.CollisionGetOther(this,t);"hero"==t.name||"dog"==t.name?(Constants.hero.giveUp(),Constants.dog.giveUp(),Constants.levelState.failLevel(),this.die()):"fixedBox"==t.name||t instanceof e.Door||t instanceof e.Elevator?(SoundManager.getInstance().playSound("RicochetSound"),this.die()):"prisoner"==t.name?this.die():"box"!=t.name&&"plank"!=t.name&&"removable"!=t.name||(SoundManager.getInstance().playSound("RicochetSound"),this.die())},n.prototype.hit=function(t){this.die()},n.prototype.die=function(){this.kill=!0;var t=new MovieClip("BulletFxGraphics");t.x=this.x,t.y=this.y,Constants.levelState.groupSprites[Constants.levelState.NumSpriteGroups-1].addChild(t),t.playOnce(),TweenMax.delayedCall(.75,t.remove,t)},n.prototype.defineBody=function(){this._bodyType=BodyType.KINEMATIC},n);function n(){var t=this,e=new MovieClip("BulletGraphics");return(t=i.call(this,"bullet",{view:e,width:12,height:6,group:5})||this)._shape.sensorEnabled=!0,t.beginContactCallEnabled=!0,t}e.Bullet=t}(objects=objects||{}),function(e){var i,t=(i=e.LevelObject,__extends(n,i),n.prototype.handleBeginContact=function(t){t=NapeUtils.CollisionGetOther(this,t);"hero"!=t.name&&"dog"!=t.name||Constants.levelState.topPanel.collectBurger(this)},n.prototype.defineBody=function(){this._bodyType=BodyType.STATIC},n);function n(t){t=i.call(this,"burger",{view:t,radius:12,x:+t.x+14,y:+t.y-12,group:4})||this;return t._shape.sensorEnabled=!0,t.beginContactCallEnabled=!0,t._body.setShapeFilters(new InteractionFilter(e.PhysicsCollisionCategories.Get("hidden"),-1,e.PhysicsCollisionCategories.Get("hidden"))),t}e.Burger=t}(objects=objects||{});var Ray=nape.geom.Ray,RayResult=nape.geom.RayResult;!function(n){var r,t=(r=n.LevelObject,__extends(e,r),e.prototype.defineBody=function(){this._bodyType=BodyType.STATIC},e.prototype.relax=function(){"alert"==this._state&&this._currentTarget.cameraGoneAway(),this._state="relax",this._rayClip.gotoAndStop(e.GREEN_BEAM),this._crossPoint.gotoAndStop(e.GREEN_CROSS),this._motionTween&&this._motionTween.resume(),this._dangerTween&&(this._dangerTween.kill(),this._dangerTween=null)},e.prototype.danger=function(){this._currentTarget.detectByCamera(this.lastObjectInChain),this._state="danger",SoundManager.getInstance().playSound("YellowCameraSound"),this._rayClip.gotoAndStop(e.YELLOW_BEAM),this._crossPoint.gotoAndStop(e.YELLOW_CROSS),this._motionTween&&this._motionTween.pause(),this._relaxTween&&this._relaxTween.kill(),this._relaxTween=null,this._dangerTween&&this._dangerTween.paused()?this._dangerTween.resume():this._dangerTween=TweenMax.delayedCall(.7,this.alert,this)},e.prototype.suspect=function(){this._state="suspect",this._dangerTween.pause(),this._relaxTween||(this._relaxTween=TweenMax.delayedCall(1,this.relax,this))},e.prototype.alert=function(){"alert"!=this._state&&(SoundManager.getInstance().playSound("RedCameraSound"),this._rayClip.gotoAndStop(e.RED_BEAM),this._crossPoint.gotoAndStop(e.RED_CROSS)),this._state="alert",this._currentTarget.makeGiveUp()},e.prototype.update=function(t){r.prototype.update.call(this,t),this._ray=new Ray(this._body.worldCOM,Vec2.fromPolar(1,(this._camera.degrees+180)/180*Math.PI)),this._ray.maxDistance=1e3,this._rayResult=this._body.space.rayCast(this._ray,!1,this._filter),this._rayResult&&(t=this._ray.at(this._rayResult.distance),this._crossPoint.visible=!0,this._crossPoint.x=t.x,this._crossPoint.y=t.y,this._rayClip.scale.x=(this._rayResult.distance-15.75)/100,this.process(this,this._rayResult,t.x,t.y))},e.prototype.process=function(t,e,i,n){var r=e.shape.body.userData.myData.name;"prisoner"!=r||e.shape.body.userData.myData.isDisabled?"mirror"==r?(this.lastObjectInChain=e.shape.body.userData.myData,e.shape.body.userData.myData.drawRay(t,i,n,this)):"danger"==this._state?this.suspect():"alert"==this._state&&this.relax():"relax"==this._state||"suspect"==this._state?(this._currentTarget=e.shape.body.userData.myData,this.danger()):"alert"==this._state&&this.alert()},e.prototype.destroy=function(){r.prototype.destroy.call(this),this._motionTween&&this._motionTween.kill(),this._dangerTween&&this._dangerTween.kill(),this._relaxTween&&this._relaxTween.kill()},e.RED_CROSS=1,e.RED_BEAM=1,e.YELLOW_CROSS=3,e.YELLOW_BEAM=2,e.GREEN_CROSS=2,e.GREEN_BEAM=3,e);function e(t){var e=r.call(this,"camera",{view:t,width:20,height:20,x:+t.x+13,y:+t.y-13,group:4})||this;e._shape.sensorEnabled=!0,e.updateCallEnabled=!0,e.lastObjectInChain=e,t.stop(),e._camera=new MovieClip("CameraGun",0,0),e._crossPoint=new MovieClip("crossPoint",-18,0),e._rayClip=new MovieClip("_beam",-18,0),e.view.addChild(e._camera),e._camera.addChild(e._rayClip),e.view.parent.addChild(e._crossPoint),e._filter=new InteractionFilter(1,n.PhysicsCollisionCategories.GetAllExcept("hidden","mirror")),e._minAngle=e._maxAngle=0,t.params.minAngle&&0!=(i=parseFloat(t.params.minAngle))&&(e._minAngle=-i),t.params.maxAngle&&0!=(i=parseFloat(t.params.maxAngle))&&(e._maxAngle=-i),e._delay=parseFloat(t.params.delay);var i=1;return t.params.speedX&&(i=parseFloat(t.params.speedX)),e._camera.degrees=e._minAngle,e._minAngle!=e._maxAngle&&(e._motionTween=TweenMax.to(e._camera,Math.abs(e._minAngle-e._maxAngle)/6/i,{degrees:e._maxAngle,repeat:-1,yoyo:!0,repeatDelay:e._delay})),e.relax(),e}n.Camera=t}(objects=objects||{}),function(t){var i,e=(i=t.CitrusObject,__extends(n,i),n);function n(t,e){e=i.call(this,t,e)||this;return e._registration="topLeft",1<e.view.totalFrames()&&e.view.playLoop(),e}t.CitrusSprite=e}(objects=objects||{});var NBody=nape.phys.Body;!function(t){var i,e=(i=t.LevelObject,__extends(n,i),Object.defineProperty(n.prototype,"controlsEnabled",{get:function(){return this._controlsEnabled},set:function(t){this._controlsEnabled=t,this._body.velocity=Vec2.weak()},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"onGround",{get:function(){return this._onGround},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"dynamicFriction",{get:function(){return this._dynamicFriction},set:function(t){this._material.dynamicFriction=this._dynamicFriction=t},enumerable:!1,configurable:!0}),n.prototype.update=function(t){i.prototype.update.call(this,t);var e=this._body.velocity;this._controlsEnabled&&(this._isMoveKeyPressed=!1,this._ce.input.isDoing("right",this.inputChannel)?(e.x+=this.acceleration,this._isMoveKeyPressed=!0,this.inverted=!1):this._ce.input.isDoing("left",this.inputChannel)?(e.x-=this.acceleration,this._isMoveKeyPressed=!0,this.inverted=!0):e.x*=.75,this._isMoveKeyPressed&&!this._playerMovingHero?(this._playerMovingHero=!0,this._material.dynamicFriction=0):!this._isMoveKeyPressed&&this._playerMovingHero&&(this._playerMovingHero=!1,this._material.dynamicFriction=this._dynamicFriction),this._onGround&&this._ce.input.isDoing("jump",this.inputChannel)&&(this._isMoveKeyPressed=!0,"dog"==name?0<this._groundContacts.length&&this._groundContacts[0]==Constants.hero.body&&0==Constants.hero.onGround||(e.y=-this.jumpHeight,this.jump()):0<this._groundContacts.length&&this._groundContacts[0]==Constants.dog.body&&0==Constants.dog.onGround||(e.y=-this.jumpHeight,this.jump())),e.x>this.maxVelocity?e.x=this.maxVelocity:e.x<-this.maxVelocity&&(e.x=-this.maxVelocity),this._body.velocity=e),this.updateAnimation(t)},n.prototype.createBody=function(){i.prototype.createBody.call(this),this._body.allowRotation=!1},n.prototype.createMaterial=function(){i.prototype.createMaterial.call(this),this._material.elasticity=0,this._material.staticFriction=0},n.prototype.handleBeginContact=function(t){var e=NapeUtils.CollisionGetOther(this,t);0<t.arbiters.length&&t.arbiters.at(0).collisionArbiter&&((45<=(t=Math.round(180*t.arbiters.at(0).collisionArbiter.normal.angle/Math.PI))&&t<=135||-30<t&&t<10||-90==t||-135==t)&&(1<t||t<-1)&&(this._groundContacts.push(e.body),this._onGround=!0))},n.prototype.handleEndContact=function(t){t=NapeUtils.CollisionGetOther(this,t),t=this._groundContacts.indexOf(t.body);-1!=t&&(this._groundContacts.splice(t,1),0==this._groundContacts.length&&(this._onGround=!1))},n.prototype.jump=function(){this._isJustJumped=!0,this._onGround=!1},n.prototype.updateAnimation=function(t){},n);function n(t,e){e=i.call(this,t,e=void 0===e?null:e)||this;return e.acceleration=30,e.maxVelocity=240,e.jumpHeight=330,e.inputChannel=0,e._groundContacts=[],e._groundContactsCount=0,e._onGround=!1,e._dynamicFriction=.5,e._playerMovingHero=!1,e._controlsEnabled=!0,e._isMoveKeyPressed=!1,e._isJustJumped=!1,e.registration="center",e.updateCallEnabled=!0,e.beginContactCallEnabled=!0,e.endContactCallEnabled=!0,e}t.Hero=e}(objects=objects||{}),function(t){var e,i=(e=t.Hero,__extends(n,e),n.prototype.initialize2=function(t){void 0===t&&(t=null),this._clip=this.view,(Constants.hero=this).inputChannel=Constants.hustlerInputChannel,this.jumpHeight=225,this.maxVelocity=80,this.acceleration=26,this._idleTime=0,this._isReadyToPlayStepSound=!0,this._isReadyToPlayPushSound=!0,this.offsetX=0,this.offsetY=25,this._clip.addAnimation("Stand",1,24,40,!0),this._clip.addAnimation("StandStill",1,1,1),this._clip.addAnimation("Walk",25,38,40,!0),this._clip.addAnimation("Sit",39,39,1),this._clip.addAnimation("SitWalk",39,56,40,!0),this._clip.addAnimation("JumpUp",81,89,40),this._clip.addAnimation("JumpDown",90,97,40),this._clip.addAnimation("Push",104,121,20,!0),this._clip.addAnimation("GiveUp",113,113,1),this._clip.addAnimation("Idle1",122,176,40,!1,this.stand,this),this._clip.addAnimation("Idle2",177,249,40,!1,this.stand,this),this._clip.addAnimation("Balance",250,322,40,!0),this._clip.addAnimation("Handcuff",323,359,40,!1,this.stand2,this),this._clip.addAnimation("Hurt",360,360,1),this._clip.playAnimation("Stand"),this.beginContactCallEnabled=!1,this.endContactCallEnabled=!1},n.prototype.jump=function(){this._isJustJumped||(this._clip.playAnimation("JumpUp"),SoundManager.getInstance().playSound("HustlerJumpSound"),this._isJustJumped=!0,TweenMax.delayedCall(.1,this.isJustJumpedFalse,this),this._onGround=!1)},n.prototype.isJustJumpedFalse=function(){this._isJustJumped=!1},n.prototype.giveUp=function(){this.controlsEnabled=!1,this._isGaveUp=!0,this._clip.playAnimation("Hurt")},n.prototype.handcuff=function(t){this.controlsEnabled=!1,t.x>this.x?this.inverted=!0:this.inverted=!1,this._clip.playAnimation("Handcuff"),SoundManager.getInstance().playSound("HandcuffSound"),Constants.dog.happy()},n.prototype.stand=function(){this._clip.playAnimation("Stand")},n.prototype.stand2=function(){Constants.levelState.isFinishing||(this.controlsEnabled=!0),this._clip.playAnimation("Stand")},n.prototype.createFilter=function(){this._filter=new InteractionFilter(t.PhysicsCollisionCategories.Get("hero"),t.PhysicsCollisionCategories.GetAllExcept("enemy")),this._shape.filter=this._filter,this._enemySensor.filter=new InteractionFilter(1,t.PhysicsCollisionCategories.GetNone(),1,t.PhysicsCollisionCategories.Get("enemy")),this._topShape.filter=new InteractionFilter(1,t.PhysicsCollisionCategories.GetNone(),1,-1),this._pushSensor.filter=new InteractionFilter(1,t.PhysicsCollisionCategories.GetNone(),1,t.PhysicsCollisionCategories.GetAllExcept("tile","hidden")),this._balanceLeftSensor.filter=new InteractionFilter(1,t.PhysicsCollisionCategories.GetNone(),1,t.PhysicsCollisionCategories.GetAllExcept("hidden")),this._balanceRightSensor.filter=new InteractionFilter(1,t.PhysicsCollisionCategories.GetNone(),1,t.PhysicsCollisionCategories.GetAllExcept("hidden"))},n.prototype.createShape=function(){var t=this._width,e=this._height,i=e;this._shape=new Polygon([new Vec2(-t/2,-8),new Vec2(t/2,-8),new Vec2(t/2,e/2-5),new Vec2(t/2-8,e/2),new Vec2(-t/2+8,e/2),new Vec2(-t/2,e/2-5)],this._material),this._body.shapes.add(this._shape),this._enemySensor=new Polygon([new Vec2(-t/2,-8),new Vec2(t/2,-8),new Vec2(t/2,e/2-5),new Vec2(t/2-5,e/2),new Vec2(-t/2+5,e/2),new Vec2(-t/2,e/2-5)],this._material),this._enemySensor.sensorEnabled=!0,this._enemySensor.group=CollisionHelper.nonCollidable,this._body.shapes.add(this._enemySensor),this._topShape=new Polygon([new Vec2(-t/2+4,-20),new Vec2(t/2-4,-20),new Vec2(t/2-4,-8),new Vec2(-t/2+4,-8)],this._material),this._topShape.sensorEnabled=!0,this._body.shapes.add(this._topShape),this._topShape.group=CollisionHelper.nonCollidable,this._pushSensor=new Polygon([new Vec2(-t/2-4,-4),new Vec2(t/2+4,-4),new Vec2(t/2+4,0),new Vec2(-t/2-4,0)],this._material),this._pushSensor.sensorEnabled=!0,this._body.shapes.add(this._pushSensor),this._pushSensor.group=CollisionHelper.nonCollidable,this._balanceLeftSensor=new Polygon([new Vec2(-t/2+1,i/2+2),new Vec2(-2,i/2+2),new Vec2(-2,i/2+5),new Vec2(-t/2+1,i/2+5)],this._material),this._balanceLeftSensor.sensorEnabled=!0,this._body.shapes.add(this._balanceLeftSensor),this._balanceLeftSensor.group=CollisionHelper.nonCollidable,this._balanceRightSensor=new Polygon([new Vec2(2,i/2+2),new Vec2(t/2-1,i/2+2),new Vec2(t/2-1,i/2+5),new Vec2(2,i/2+5)],this._material),this._balanceRightSensor.sensorEnabled=!0,this._body.shapes.add(this._balanceRightSensor),this._balanceRightSensor.group=CollisionHelper.nonCollidable},n.prototype.handleBeginContact=function(t){},n.prototype.handleEndContact=function(t){},n.prototype.checkCollisions=function(){this._isObstacleOnLeft=!1,this._isObstacleOnRight=!1,this._isLeftBalanceSensor=!1,this._isRightBalanceSensor=!1;for(var t=this._groundContactsCount=0;t<this._body.arbiters.length;t++){var e,i=this._body.arbiters.at(t);i.shape1!=this._topShape&&i.shape2!=this._topShape||(e=i.shape1,(e=i.shape1==this._topShape?i.shape2:e).sensorEnabled||(this._isDuck=!0)),i.shape1==this._pushSensor?i.body2.position.x<this.x?this._isObstacleOnLeft=!0:this._isObstacleOnRight=!0:i.shape2==this._pushSensor&&(i.body1.position.x<this.x?this._isObstacleOnLeft=!0:this._isObstacleOnRight=!0),i.shape1==this._balanceLeftSensor||i.shape2==this._balanceLeftSensor?this._isLeftBalanceSensor=!0:i.shape1!=this._balanceRightSensor&&i.shape2!=this._balanceRightSensor||(this._isRightBalanceSensor=!0),i.shape1==this._shape?this.checkGround(i,i.body2):i.shape2==this._shape&&this.checkGround(i,i.body1)}0==this._groundContactsCount&&(this._onGround=!1)},n.prototype.checkGround=function(t,e){t.collisionArbiter&&(t=Math.round(180*t.collisionArbiter.normal.angle/Math.PI),(e!=Constants.dog.body||Constants.dog.onGround)&&(15<=t&&t<=175||-30<t&&t<10||-90==t||-135==t)&&(1<t||t<-1)&&this._body.position.y<e.position.y-15&&(this._groundContactsCount++,this._onGround=!0))},n.prototype.update=function(t){this.checkCollisions(),e.prototype.update.call(this,t),Constants._ce.input.isDoing("down",this.inputChannel)?this._isDuck=!0:this._isDuck=!1},n.prototype.updateAnimation=function(t){this._isGaveUp||"Handcuff"==this._clip.currentAnimation||(this._isMoveKeyPressed||this._isDuck?this._idleTime=0:this._idleTime+=t,14<this._idleTime&&(.5<Math.random()?(this._idleTime=0,SoundManager.getInstance().playSound("CopIdle1Sound"),this._clip.playAnimation("Idle1")):(this._idleTime=0,SoundManager.getInstance().playSound("CopIdle2Sound"),this._clip.playAnimation("Idle2"))),t=this._body.velocity.x,this._onGround&&!this._isJustJumped?Constants._ce.input.isDoing("right",this.inputChannel)&&this._isObstacleOnRight||Constants._ce.input.isDoing("left",this.inputChannel)&&this._isObstacleOnLeft?(this._isReadyToPlayPushSound&&(this._isReadyToPlayPushSound=!1,TweenMax.delayedCall(2,this.isReadyToPlayPushSoundTrue,this),SoundManager.getInstance().playSound("HustlerPushSound")),this._clip.playAnimation("Push")):t<-10||10<t?(SoundManager.getInstance().stopSound("HustlerPushSound"),this._isDuck?this._clip.playAnimation("SitWalk"):this._isMoveKeyPressed&&(SoundManager.getInstance().stopSound("CopIdle1Sound"),SoundManager.getInstance().stopSound("CopIdle2Sound"),this._clip.playAnimation("Walk")),this._isReadyToPlayStepSound&&(this._isReadyToPlayStepSound=!1,TweenMax.delayedCall(.2,this.isReadyToPlayStepSoundTrue,this),SoundManager.getInstance().playSound("HustlerStepSound"))):"Idle1"!=this._clip.currentAnimation&&"Idle2"!=this._clip.currentAnimation&&(SoundManager.getInstance().stopSound("HustlerPushSound"),this._isDuck?this._clip.playAnimation("Sit"):this._isLeftBalanceSensor&&!this._isRightBalanceSensor?(this._clip.playAnimation("Balance"),this.inverted=!0):!this._isLeftBalanceSensor&&this._isRightBalanceSensor?(this._clip.playAnimation("Balance"),this.inverted=!1):(this.inverted=!1,this._clip.playAnimation("Stand"))):"JumpDown"!=this._clip.currentAnimation&&50<this._body.velocity.y&&this._clip.playAnimation("JumpDown"))},n.prototype.isReadyToPlayPushSoundTrue=function(){this._isReadyToPlayPushSound=!0},n.prototype.isReadyToPlayStepSoundTrue=function(){this._isReadyToPlayStepSound=!0},n);function n(t){t=e.call(this,"hero",{view:t,width:31,height:47,x:+t.x+23,y:+t.y-24,group:4})||this;return t._idleTime=0,t._isReadyToPlayStepSound=t._isReadyToPlayPushSound=!1,t._isObstacleOnLeft=t._isObstacleOnRight=t._isGaveUp=t._isLeftBalanceSensor=t._isRightBalanceSensor=!1,t.initialize2(),t.dynamicFriction=0,t}t.Cop=i}(objects=objects||{});var PivotJoint=nape.constraint.PivotJoint,Shape=nape.shape.Shape,InteractionFilter=nape.dynamics.InteractionFilter,Polygon=nape.shape.Polygon,Arbiter=nape.dynamics.Arbiter;!function(t){var e,i=(e=t.Hero,__extends(n,e),n.prototype.initialize2=function(t){void 0===t&&(t=null),this._clip=this.view,(Constants.dog=this).inputChannel=Constants.dogInputChannel,this.jumpHeight=165,this.maxVelocity=86,this.acceleration=23,this._idleTime=0,this._isReadyToPlayStepSound=!0,this._isReadyToPlayPushSound=!0,this._isReadyToPlayBarkAnimation=!0,this.offsetX=0,this.offsetY=24,this._clip.addAnimation("Stand",1,35,40,!0),this._clip.addAnimation("Walk",36,54,40,!0),this._clip.addAnimation("JumpUp",55,63,40),this._clip.addAnimation("JumpDown",79,83,30),this._clip.addAnimation("Balance",84,122,40),this._clip.addAnimation("Push",123,149,40,!0),this._clip.addAnimation("Hurt",150,150,1),this._clip.addAnimation("Idle1",151,199,40,!1,this.stand,this),this._clip.addAnimation("Idle2",200,306,40,!1,this.stand,this),this._clip.addAnimation("Bark",307,327,40,!1,this.stand,this),this._clip.addAnimation("Roar",328,358,40,!1,this.stand,this),this._clip.addAnimation("Happy",359,380,40,!0),this._clip.playAnimation("Stand")},n.prototype.handleBeginContact=function(t){"hero"==NapeUtils.CollisionGetOther(this,t).name&&(this._isMainHeroTouching=!0)},n.prototype.handleEndContact=function(t){"hero"==NapeUtils.CollisionGetOther(this,t).name&&(this._isMainHeroTouching=!1)},n.prototype.jump=function(){this._isJustJumped||(this._clip.playAnimation("JumpUp"),SoundManager.getInstance().playSound("DogJumpSound"),this._isJustJumped=!0,TweenMax.delayedCall(.1,this.isJustJumpedFalse,this),this._onGround=!1)},n.prototype.isJustJumpedFalse=function(){this._isJustJumped=!1},n.prototype.giveUp=function(){this.controlsEnabled=!1,this._isGaveUp=!0,this._clip.playAnimation("Hurt")},n.prototype.bark=function(){this._isReadyToPlayBarkAnimation&&(this._isReadyToPlayBarkAnimation=!1,this.controlsEnabled=!1,this._clip.playAnimation("Bark"),SoundManager.getInstance().playSound("DogBarkSound"),TweenMax.delayedCall(.45,this.controlsEnabledTrue,this),TweenMax.delayedCall(3,this.isReadyToPlayBarkAnimationTrue,this))},n.prototype.controlsEnabledTrue=function(){this.controlsEnabled=!0},n.prototype.isReadyToPlayBarkAnimationTrue=function(){this._isReadyToPlayBarkAnimation=!0},n.prototype.happy=function(){this._clip.playAnimation("Happy"),TweenMax.delayedCall(1,this.stand,this)},n.prototype.stand=function(){this._clip.playAnimation("Stand")},n.prototype.createFilter=function(){this._filter=new InteractionFilter(t.PhysicsCollisionCategories.Get("hero"),t.PhysicsCollisionCategories.GetAllExcept("enemy")),this._shape.filter=this._filter,this._shapeReversed.filter=this._filter,this._enemySensor.filter=new InteractionFilter(1,t.PhysicsCollisionCategories.Get("tile"),1,t.PhysicsCollisionCategories.Get("tile")),this._pushSensor.filter=new InteractionFilter(1,t.PhysicsCollisionCategories.GetNone(),1,t.PhysicsCollisionCategories.GetAllExcept("tile","hidden","enemy")),this._balanceLeftSensor.filter=new InteractionFilter(1,t.PhysicsCollisionCategories.GetNone(),1,t.PhysicsCollisionCategories.GetAllExcept("hidden")),this._balanceRightSensor.filter=new InteractionFilter(1,t.PhysicsCollisionCategories.GetNone(),1,t.PhysicsCollisionCategories.GetAllExcept("hidden"))},n.prototype.createMaterial=function(){e.prototype.createMaterial.call(this),this._material.density=1.2},n.prototype.createShape=function(){var t=this.width,e=this._height,i=this.height;this._shape=new Polygon([new Vec2(-t/2,-e/2+18),new Vec2(-t/2+4,-e/2+15),new Vec2(t/2-15,-e/2+15),new Vec2(t/2+4,5),new Vec2(t/2+4,e/2-14),new Vec2(t/2-18,e/2),new Vec2(-t/2+15,e/2),new Vec2(-t/2,e/2-6)],this._material),this._body.shapes.add(this._shape),this._shapeReversed=new Polygon([new Vec2(-t/2-4,5),new Vec2(-t/2+15,-e/2+15),new Vec2(t/2-4,-e/2+15),new Vec2(t/2,-e/2+18),new Vec2(t/2,e/2-6),new Vec2(t/2-18,e/2),new Vec2(-t/2+15,e/2),new Vec2(-t/2-4,e/2-14)],this._material),this._body.shapes.add(this._shapeReversed),this._enemySensor=new Polygon([new Vec2(-t/2,-e/2+9),new Vec2(t/2,-e/2+9),new Vec2(t/2,-e/2+12),new Vec2(-t/2,-e/2+12)],this._material),this._body.shapes.add(this._enemySensor),this._pushSensor=new Polygon([new Vec2(-t/2-4,0),new Vec2(t/2+4,0),new Vec2(t/2+2,2),new Vec2(t/2-4,e/2-6),new Vec2(-t/2+4,e/2-6),new Vec2(-t/2-2,2)],this._material),this._pushSensor.sensorEnabled=!0,this._body.shapes.add(this._pushSensor),this._pushSensor.group=CollisionHelper.nonCollidable,this._balanceLeftSensor=new Polygon([new Vec2(-t/2+1,i/2+2),new Vec2(-10,i/2+2),new Vec2(-10,i/2+5),new Vec2(-t/2+1,i/2+5)],this._material),this._balanceLeftSensor.sensorEnabled=!0,this._body.shapes.add(this._balanceLeftSensor),this._balanceLeftSensor.group=CollisionHelper.nonCollidable,this._balanceRightSensor=new Polygon([new Vec2(10,i/2+2),new Vec2(t/2-1,i/2+2),new Vec2(t/2-1,i/2+5),new Vec2(10,i/2+5)],this._material),this._balanceRightSensor.sensorEnabled=!0,this._body.shapes.add(this._balanceRightSensor),this._balanceRightSensor.group=CollisionHelper.nonCollidable},n.prototype.checkCollisions=function(){this._isObstacleOnLeft=!1,this._isObstacleOnRight=!1,this._isLeftBalanceSensor=!1,this._isRightBalanceSensor=!1;for(var t=this._groundContactsCount=0;t<this._body.arbiters.length;t++){var e=this._body.arbiters.at(t);e.shape1==this._pushSensor?e.body2.position.x<this.x?this._isObstacleOnLeft=!0:this._isObstacleOnRight=!0:e.shape2==this._pushSensor&&(e.body1.position.x<this.x?this._isObstacleOnLeft=!0:this._isObstacleOnRight=!0),e.shape1==this._balanceLeftSensor||e.shape2==this._balanceLeftSensor?this._isLeftBalanceSensor=!0:e.shape1!=this._balanceRightSensor&&e.shape2!=this._balanceRightSensor||(this._isRightBalanceSensor=!0),e.shape1==this._shape||e.shape1==this._shapeReversed?this.checkGround(e,e.body2):e.shape2!=this._shape&&e.shape2!=this._shapeReversed||this.checkGround(e,e.body1)}0==this._groundContactsCount&&(this._onGround=!1)},n.prototype.checkGround=function(t,e){t.collisionArbiter&&(t=Math.round(180*t.collisionArbiter.normal.angle/Math.PI),(e!=Constants.hero.body||Constants.hero.onGround)&&(15<=t&&t<=175||-30<t&&t<10||-90==t||-135==t)&&(1<t||t<-1)&&this._body.position.y<e.position.y-15&&(this._groundContactsCount++,this._onGround=!0))},n.prototype.update=function(t){this.checkCollisions(),e.prototype.update.call(this,t)},n.prototype.updateAnimation=function(t){this._isGaveUp||"Grab"==this._clip.currentAnimation||"Bark"==this._clip.currentAnimation||"Happy"==this._clip.currentAnimation||(this._isMoveKeyPressed||this._isMainHeroTouching?this._idleTime=0:this._idleTime+=t,17<this._idleTime&&(.5<Math.random()?(this._idleTime=0,SoundManager.getInstance().playSound("DogIdle1Sound"),this._clip.playAnimation("Idle1")):(this._idleTime=0,SoundManager.getInstance().playSound("DogIdle2Sound"),this._clip.playAnimation("Idle2"))),(t=this._body.velocity.x)<0?(this._shape.sensorEnabled=!1,this._shapeReversed.sensorEnabled=!0,this.inverted=!0):0<t&&(this._shape.sensorEnabled=!0,this._shapeReversed.sensorEnabled=!1,this.inverted=!1),this._onGround&&!this._isJustJumped?Constants._ce.input.isDoing("right",this.inputChannel)&&this._isObstacleOnRight||Constants._ce.input.isDoing("left",this.inputChannel)&&this._isObstacleOnLeft?(this._isReadyToPlayStepSound&&(this._isReadyToPlayStepSound=!1,TweenMax.delayedCall(.4,this.isReadyToPlayStepSoundTrue,this),SoundManager.getInstance().playSound("DogStepSound")),this._clip.playAnimation("Push")):t<-7||7<t?this._isMoveKeyPressed&&(SoundManager.getInstance().stopSound("DogIdle1Sound"),SoundManager.getInstance().stopSound("DogIdle2Sound"),this._clip.playAnimation("Walk"),this._isReadyToPlayStepSound&&(this._isReadyToPlayStepSound=!1,TweenMax.delayedCall(.4,this.isReadyToPlayStepSoundTrue,this),SoundManager.getInstance().playSound("DogStepSound"))):"Idle1"!=this._clip.currentAnimation&&"Idle2"!=this._clip.currentAnimation&&(this._isLeftBalanceSensor&&!this._isRightBalanceSensor?(this._clip.playAnimation("Balance"),this.inverted=!1):!this._isLeftBalanceSensor&&this._isRightBalanceSensor?(this._clip.playAnimation("Balance"),this.inverted=!0):this._clip.playAnimation("Stand")):"JumpDown"!=this._clip.currentAnimation&&50<this._body.velocity.y&&this._clip.playAnimation("JumpDown"))},n.prototype.isReadyToPlayStepSoundTrue=function(){this._isReadyToPlayStepSound=!0},n);function n(t){t=e.call(this,"dog",{view:t,width:48,height:46,x:+t.x+33,y:+t.y-24,group:4})||this;return t._idleTime=0,t._isReadyToPlayStepSound=t._isReadyToPlayPushSound=t._isReadyToPlayBarkAnimation=!1,t._isObstacleOnLeft=t._isObstacleOnRight=t._isGaveUp=t._isLeftBalanceSensor=t._isRightBalanceSensor=!1,t._isMainHeroTouching=!1,t.initialize2(),t.dynamicFriction=0,t}t.Dog=i}(objects=objects||{}),function(o){var s,t=(s=o.LevelObject,__extends(a,s),a.prototype.action=function(){this._isOpened?this._isOpened=!1:this._isOpened=!0,this._isMoving=!0,SoundManager.getInstance().playSound("OpenDoorSound")},a.prototype.stop=function(){this._isMoving=!1,this.body.velocity.x=0,this.body.velocity.y=0},a.prototype.defineBody=function(){this._bodyType=BodyType.KINEMATIC},a.prototype.update=function(t){s.prototype.update.call(this,t),this._isMoving&&(this._direction==a.UP?this._isOpened?this.y<=this._initY-69.5?this.stop():this._body.velocity.y=-50:this.y>=this._initY-.5?this.stop():this._body.velocity.y=50:this._direction==a.DOWN?this._isOpened?this.y>=this._initY+69.5?this.stop():this._body.velocity.y=50:this.y<=this._initY+.5?this.stop():this._body.velocity.y=-50:this._direction==a.LEFT?this._isOpened?this.x<=this._initX-69.5?this.stop():this._body.velocity.x=-50:this.x>=this._initX-.5?this.stop():this._body.velocity.x=50:this._direction==a.RIGHT&&(this._isOpened?this.x>=this._initX+69.5?this.stop():this._body.velocity.x=50:this.x<=this._initX+.5?this.stop():this._body.velocity.x=-50))},a.UP=1,a.DOWN=2,a.LEFT=3,a.RIGHT=4,a);function a(t){var e=this,i=t._degrees,n=t.rotation=0,r="subject"+(n=0==(n=t.params.type?Math.round(parseFloat(t.params.type)):n)?1:n);return t.gotoAndStop(n),(e=s.call(this,r,{view:t,rotation:i,width:20,height:69,x:+t.x+10*Math.cos(i/180*Math.PI)+35*Math.sin(i/180*Math.PI),y:+t.y-35*Math.cos(i/180*Math.PI)+10*Math.sin(i/180*Math.PI),group:2})||this)._isGlass=0<=t.frameName.indexOf("GlassDoorGraphics"),i=(i%360+360)%360,0==Math.round(i)?e._direction=a.UP:180==Math.round(i)?e._direction=a.DOWN:90==Math.round(i)?e._direction=a.LEFT:270==Math.round(i)&&(e._direction=a.RIGHT),e._initX=e.x,e._initY=e.y,e.updateCallEnabled=!0,e._isGlass&&e._body.setShapeFilters(new InteractionFilter(o.PhysicsCollisionCategories.Get("hidden"))),e}o.Door=t}(objects=objects||{}),function(t){var o,e=(o=t.LevelObject,__extends(s,o),s.prototype.action=function(){this._isMovingToTarget?this._isMovingToTarget=!1:this._isMovingToTarget=!0,this._isMoving=!0},s.prototype.defineBody=function(){this._bodyType=BodyType.KINEMATIC},s.prototype.createShape=function(){o.prototype.createShape.call(this),this._isBig?(this._sensor1=new Polygon(OzUtil.verticesArrayToVec2([[56,0],[56,13],[10,13],[10,0]]),this._material),this._sensor2=new Polygon(OzUtil.verticesArrayToVec2([[-56,0],[-56,13],[-10,13],[-10,0]]),this._material)):(this._sensor1=new Polygon(OzUtil.verticesArrayToVec2([[40,0],[40,13],[10,13],[10,0]]),this._material),this._sensor2=new Polygon(OzUtil.verticesArrayToVec2([[-40,0],[-40,13],[-10,13],[-10,0]]),this._material)),this._sensor3=new Polygon(OzUtil.verticesArrayToVec2([[-33,0],[-33,13],[33,13],[33,0]]),this._material),this._sensor1.sensorEnabled=!0,this._sensor2.sensorEnabled=!0,this._sensor3.sensorEnabled=!0,this._body.shapes.add(this._sensor1),this._body.shapes.add(this._sensor2),this._body.shapes.add(this._sensor3)},s.prototype.createMaterial=function(){o.prototype.createMaterial.call(this),this._material.elasticity=0,this._material.dynamicFriction=8},s.prototype.pause=function(){this._isPaused=!0,this.body.velocity.x=0,this.body.velocity.y=0},s.prototype.stop=function(){this._isMoving=!1,this.body.velocity.x=0,this.body.velocity.y=0},s.prototype.update=function(t){if(this._isPaused=!1,this._isMoving){for(var e=0;e<this._body.arbiters.length;e++){var i=this._body.arbiters.at(e);this._direction==s.LEFT&&!this._isMovingToTarget||this._direction==s.RIGHT&&this._isMovingToTarget?i.shape1==this._sensor1?i.body2.type==BodyType.DYNAMIC&&"box"!=i.body2.userData.myData.name&&this.pause():i.shape2==this._sensor1&&i.body1.type==BodyType.DYNAMIC&&"box"!=i.body1.userData.myData.name&&this.pause():this._direction==s.LEFT&&this._isMovingToTarget||this._direction==s.RIGHT&&!this._isMovingToTarget?i.shape1==this._sensor2?i.body2.type==BodyType.DYNAMIC&&"box"!=i.body2.userData.myData.name&&this.pause():i.shape2==this._sensor2&&i.body1.type==BodyType.DYNAMIC&&"box"!=i.body1.userData.myData.name&&this.pause():(this._direction==s.DOWN&&this._isMovingToTarget||this._direction==s.UP&&!this._isMovingToTarget)&&(i.shape1==this._sensor3?i.body2.type==BodyType.DYNAMIC&&"box"!=i.body2.userData.myData.name&&this.pause():i.shape2==this._sensor3&&i.body1.type==BodyType.DYNAMIC&&"box"!=i.body1.userData.myData.name&&this.pause())}this._direction==s.UP?this._isMovingToTarget?this.y<=this._initY-this._distanceY?this.stop():this._isPaused||(this._body.velocity.y=this._speedY):this.y>=this._initY?this.stop():this._isPaused||(this._body.velocity.y=-this._speedY):this._direction==s.DOWN?this._isMovingToTarget?this.y>=this._initY+this._distanceY?this.stop():this._isPaused||(this._body.velocity.y=this._speedY):this.y<=this._initY?this.stop():this._isPaused||(this._body.velocity.y=-this._speedY):this._direction==s.LEFT?this._isMovingToTarget?this.x<=this._initX-this._distanceX?this.stop():this._isPaused||(this._body.velocity.x=this._speedX):this.x>=this._initX?this.stop():this._isPaused||(this._body.velocity.x=-this._speedX):this._direction==s.RIGHT&&(this._isMovingToTarget?this.x>=this._initX+this._distanceX?this.stop():this._isPaused||(this._body.velocity.x=this._speedX):this.x<=this._initX?this.stop():this._isPaused||(this._body.velocity.x=-this._speedX))}0!=this.body.velocity.x||0!=this.body.velocity.y?(this._isMovingToTarget?(this.view.getChild("cogwheel1").degrees-=6,this.view.getChild("cogwheel2").degrees+=6):(this.view.getChild("cogwheel1").degrees+=6,this.view.getChild("cogwheel2").degrees-=6),this._isPlayingSound||(SoundManager.getInstance().playSound("ElevatorSound"),this._isPlayingSound=!0)):this._isPlayingSound&&(SoundManager.getInstance().stopSound("ElevatorSound"),this._isPlayingSound=!1),o.prototype.update.call(this,t)},s.prototype.destroy=function(){o.prototype.destroy.call(this),SoundManager.getInstance().stopSound("ElevatorSound")},s.UP=1,s.DOWN=2,s.LEFT=3,s.RIGHT=4,s);function s(t){var e=this,i=0;0==(i=t.params.type?Math.round(parseFloat(t.params.type)):i)&&(i=1);var n="subject"+String(i),r=!1;return"BigElevatorGraphics"==t.mc&&(r=!0),(e=o.call(this,n,{view:t,width:+(r?102:70),height:+(r?20:16),x:+t.x+(r?104:70)/2,y:+t.y-(r?10:12),group:4})||this).view.getChild("front").gotoAndStop(i),e._isBig=r,e._distanceX=parseFloat(t.params.distanceX),e._distanceY=parseFloat(t.params.distanceY),e._speedX=parseFloat(t.params.speedX),e._speedY=parseFloat(t.params.speedY),e._speedY<0?e._direction=s.UP:0<e._speedY?e._direction=s.DOWN:e._speedX<0?e._direction=s.LEFT:0<e._speedX&&(e._direction=s.RIGHT),e._initX=e.x,e._initY=e.y,e.updateCallEnabled=!0,e}t.Elevator=e}(objects=objects||{});var BodyType=nape.phys.BodyType;!function(t){var e,i=(e=t.LevelObject,__extends(n,e),n.prototype.createFilter=function(){this._body.setShapeFilters(new InteractionFilter(t.PhysicsCollisionCategories.Get("limiter"),t.PhysicsCollisionCategories.Get("enemy"),t.PhysicsCollisionCategories.Get("limiter"),t.PhysicsCollisionCategories.Get("enemy")))},n.prototype.defineBody=function(){this._bodyType=BodyType.STATIC},n);function n(t){return e.call(this,"limiter",{width:15,height:15,x:+t.x+7.5,y:+t.y-7.5})||this}t.EnemyLimiter=i}(objects=objects||{}),function(t){var e,i=(e=t.LevelObject,__extends(n,e),n.prototype.defineBody=function(){this._bodyType=BodyType.STATIC},n.prototype.createFilter=function(){this._body.setShapeFilters(new InteractionFilter(t.PhysicsCollisionCategories.Get("tile"),t.PhysicsCollisionCategories.GetAll(),t.PhysicsCollisionCategories.Get("tile"),t.PhysicsCollisionCategories.GetAll()))},n);function n(t){return e.call(this,"fixedBox",{width:+t.width,height:+t.height,x:+(t.x+t.width/2),y:+(t.y+t.height/2)})||this}t.FixedBox=i}(objects=objects||{}),function(t){var r,e=(r=t.LevelObject,__extends(i,r),i.prototype.defineBody=function(){this._bodyType=BodyType.STATIC},i.prototype.createFilter=function(){this._body.setShapeFilters(new InteractionFilter(t.PhysicsCollisionCategories.Get("tile"),t.PhysicsCollisionCategories.GetAll(),t.PhysicsCollisionCategories.Get("tile"),t.PhysicsCollisionCategories.GetAll()))},i);function i(t,e,i,n){return r.call(this,"fixedBox",{width:+i,height:+n,x:+(+t+ +i/2),y:+(+e+ +n/2)})||this}t.FixedBox2=e}(objects=objects||{}),function(t){var i,e=(i=t.CitrusSprite,__extends(n,i),n.prototype.destroy=function(){i.prototype.destroy.call(this),Constants.levelState.removeObject(this)},n);function n(t){var e=i.call(this,"levelText",{view:t,x:+t.x+116,y:+t.y-45-13})||this;e.game=PhaserGameHelper.getInstance().game;var t=Fabrique.LocalizationHandler.getInstance().getValue("level");e.text1=e.game.add.text(0,0,t+Constants.currentLevel+":",{font:"18px ChatNoir",fill:"#F7E35C",boundsAlignH:"center",boundsAlignV:"middle"}),e.text1.stroke="#824E26",e.text1.strokeThickness=4,e.text1.setTextBounds(-96,-26,192,33);t=Fabrique.LocalizationHandler.getInstance().getValue(e.view.params.name);return e.text2=e.game.add.text(0,0,t,{font:"18px ChatNoir",fill:"#FFFFFF",boundsAlignH:"center",boundsAlignV:"top"}),e.text2.stroke="#824E26",e.text2.strokeThickness=4,e.text2.setTextBounds(-116,-2,232,64),e.view.addChild(e.text1),e.view.addChild(e.text2),Constants.levelState.addObject(e),e}t.LevelText=e}(objects=objects||{}),function(e){var i,t=(i=e.LevelObject,__extends(n,i),n.prototype.constructor2=function(){this.rayRotation=0,this._isFlipped=this._isBottomHidden=this._isRayActive=!1,this._previousSource=null,1==this.view.params.flippedHorizontally&&(this.view.scaleX=-1,this._isFlipped=!0),1==this.view.params.flippedVertically&&(this._isBottomHidden=!0),this.beginContactCallEnabled=!0,this.updateCallEnabled=!0,this._isReadyToPlaySound=!0,this._body.allowRotation=!1,this.view.stop(),this.box=this.view,this._crossPoint=new MovieClip("crossPoint",0,0),this._rayClip=new MovieClip("_beam",0,0),this.view.addChild(this._rayClip),this.view.addChild(this._crossPoint),this._rayPosition=new Vec2,this._filter=new InteractionFilter(1,e.PhysicsCollisionCategories.GetAllExcept("hidden","mirror"))},n.prototype.createFilter=function(){this._isBottomHidden?(this._shape.filter=new InteractionFilter(e.PhysicsCollisionCategories.Get("mirror"),e.PhysicsCollisionCategories.GetAll()),this._shape2.filter=new InteractionFilter(e.PhysicsCollisionCategories.Get("Level"),e.PhysicsCollisionCategories.GetAll())):(this._shape.filter=new InteractionFilter(e.PhysicsCollisionCategories.Get("Level"),e.PhysicsCollisionCategories.GetAll()),this._shape2.filter=new InteractionFilter(e.PhysicsCollisionCategories.Get("mirror"),e.PhysicsCollisionCategories.GetAll()))},n.prototype.drawRay=function(t,e,i,n){this._previousSource=t,this._camera||(this._camera=n,this.calculateRayDirection()),this._isRayActive=!0,this._rayPosition.setxy(e,i),this._isFlipped?this._rayClip.x=this.x-e:this._rayClip.x=e-this.x,this._rayClip.y=i-this.y,this._rayClip.degrees=this.rayRotation,this._isFlipped&&(0<this.rayRotation?this._rayClip.degrees=180-this.rayRotation:this._rayClip.degrees=-180-this.rayRotation)},n.prototype.calculateRayDirection=function(){for(var t=this._previousSource instanceof e.Camera?Math.round(this._previousSource._camera.degrees):Math.round(this._previousSource.rayRotation);t<-180;)t+=360;for(;180<t;)t-=360;-90==(t=Math.round(t))?this._isBottomHidden?this.rayRotation=90:this._isFlipped?this.rayRotation=0:this.rayRotation=180:0==t?this._isFlipped?this._isBottomHidden?this.rayRotation=-90:this.rayRotation=180:this._isBottomHidden?this.rayRotation=180:this.rayRotation=90:-180==t||180==t?this._isFlipped?this._isBottomHidden?this.rayRotation=0:this.rayRotation=90:this._isBottomHidden?this.rayRotation=-90:this.rayRotation=0:90==t&&(this._isBottomHidden?this._isFlipped?this.rayRotation=180:this.rayRotation=0:this.rayRotation=-90)},n.prototype.createShape=function(){this.constructor2();var t=this._width,e=this._height;this._isFlipped?(this._shape=new Polygon([new Vec2(-t/2,e/2),new Vec2(t/2,-e/2),new Vec2(t/2,e/2)],this._material),this._body.shapes.add(this._shape),this._shape2=new Polygon([new Vec2(-t/2,-e/2),new Vec2(t/2,-e/2),new Vec2(-t/2,e/2)],this._material)):(this._shape=new Polygon([new Vec2(-t/2,-e/2),new Vec2(t/2,e/2),new Vec2(-t/2,e/2)],this._material),this._body.shapes.add(this._shape),this._shape2=new Polygon([new Vec2(-t/2,-e/2),new Vec2(t/2,-e/2),new Vec2(t/2,e/2)],this._material)),this._body.shapes.add(this._shape2)},n.prototype.createMaterial=function(){i.prototype.createMaterial.call(this)},n.prototype.handleBeginContact=function(t){15<Math.abs(this._body.velocity.y)&&(SoundManager.getInstance().playSound("BoxDownSound"),this._isReadyToPlaySound=!1,TweenMax.delayedCall(1.25,this.isReadToPlaySoundTrue,this))},n.prototype.isReadToPlaySoundTrue=function(){this._isReadyToPlaySound=!0},n.prototype.update=function(t){i.prototype.update.call(this,t),this._isRayActive?(this._rayClip.visible=!0,this._crossPoint.visible=!0,this._isRayActive=!1,this._ray=new Ray(this._rayPosition,Vec2.fromPolar(1,(this.rayRotation+180)/180*Math.PI)),this._ray.maxDistance=1e3,this._rayResult=this._body.space.rayCast(this._ray,!1,this._filter),this._rayResult&&(t=this._ray.at(this._rayResult.distance),this._crossPoint.visible=!0,this._crossPoint.x=t.x-this.x,this._isFlipped&&(this._crossPoint.x=-this._crossPoint.x),this._crossPoint.y=t.y-this.y,this._rayClip.scaleX=this._rayResult.distance/100,this._rayClip.gotoAndStop(this._camera._rayClip.currentFrameNumber),this._crossPoint.gotoAndStop(this._camera._crossPoint.currentFrameNumber),this._camera.process(this,this._rayResult,t.x,t.y))):(this._crossPoint.visible=!1,this._rayClip.visible=!1)},n.RED_CROSS=1,n.RED_BEAM=1,n.YELLOW_CROSS=3,n.YELLOW_BEAM=2,n.GREEN_CROSS=2,n.GREEN_BEAM=3,n);function n(t){return i.call(this,"mirror",{view:t,width:33,height:33,x:+t.x+16.5,y:+t.y-16.5,group:2})||this}e.Mirror=t}(objects=objects||{});var InteractionGroup=nape.dynamics.InteractionGroup;!function(e){var i,t=(i=e.LevelObject,__extends(n,i),n.prototype.action=function(){var t;this._body.type==BodyType.STATIC&&(this._body.space=null,this._body.type=BodyType.DYNAMIC,this._body.space=this._nape.space,this.view.gotoAndStop(2),t=new MovieClip("ElectroSplashGraphics"),this.fountain=new e.CitrusObject("electro",{view:t,x:this.x-1,y:this.y+14}),t.playLoop(),Constants.levelState.addObject(this.fountain),SoundManager.getInstance().playSound("ElectricitySound"),TweenMax.delayedCall(1,this.removeFountain,this))},n.prototype.removeFountain=function(){this.fountain.kill=!0},n.prototype.createBody=function(){this._bodyType=BodyType.STATIC,i.prototype.createBody.call(this)},n.prototype.handleBeginContact=function(t){100<NapeUtils.CollisionGetOther(this,t).body.normalImpulse(this.body,!0).xy(!0).length&&this._body.type==BodyType.DYNAMIC&&(this.view.gotoAndStop(3),this.beginContactCallEnabled=!1,SoundManager.getInstance().playSound("MonitorCrashSound"),t=new InteractionGroup(!0),this._body.group=t,this.fragment1=new e.NapePhysicsObject("f",{view:new MovieClip("Fragment1Graphics"),registration:"topLeft",x:this.x+5,y:this.y-2,width:18,height:4,group:2}),Constants.levelState.addObject(this.fragment1),this.fragment1.body.group=t,this.fragment1.body.applyImpulse(Vec2.weak(3*Math.random(),-12)),this.fragment1.body.applyAngularImpulse(40*Math.random()),this.fragment2=new e.NapePhysicsObject("f",{view:new MovieClip("Fragment2Graphics"),registration:"topLeft",x:this.x-4,y:this.y,width:14,height:4,group:2}),Constants.levelState.addObject(this.fragment2),this.fragment2.body.group=t,this.fragment2.body.applyImpulse(Vec2.weak(-3*Math.random(),-10)),this.fragment2.body.applyAngularImpulse(-40*Math.random()),this.fragment3=new e.NapePhysicsObject("f",{view:new MovieClip("Fragment3Graphics"),registration:"topLeft",x:this.x-4,y:this.y,width:14,height:4,group:2}),Constants.levelState.addObject(this.fragment3),this.fragment3.body.group=t,this.fragment3.body.applyImpulse(Vec2.weak(-.5*Math.random(),-10)),this.fragment3.body.applyAngularImpulse(35*Math.random()),this.fragment1.body.setShapeFilters(new InteractionFilter(1,e.PhysicsCollisionCategories.GetAllExcept("tile","hidden"))),this.fragment2.body.setShapeFilters(new InteractionFilter(1,e.PhysicsCollisionCategories.GetAllExcept("tile","hidden"))),this.fragment3.body.setShapeFilters(new InteractionFilter(1,e.PhysicsCollisionCategories.GetAllExcept("tile","hidden"))),TweenMax.delayedCall(2.5,this.removeFragments,this))},n.prototype.removeFragments=function(){this.fragment1.kill=!0,this.fragment2.kill=!0,this.fragment3.kill=!0},n);function n(t){var e=i.call(this,"removable",{view:t,width:33,height:33,x:+t.x+16.5,y:+t.y-16.5,group:4})||this;return t.stop(),e.beginContactCallEnabled=!0,e}e.Monitor=t}(objects=objects||{});var MovieClip=function(s){function a(t,e,i,n,r,o){void 0===t&&(t=null),void 0===e&&(e=0),void 0===i&&(i=0),void 0===n&&(n=""),void 0===r&&(r=null),void 0===o&&(o=null);e=s.call(this,PhaserGameHelper.getInstance().game,e,i,null)||this;e.game=PhaserGameHelper.getInstance().game,r=r||"Objects",o=o||ObjectsLayouts.data;i=OzUtil.PE(o,null,"name",t);return t&&(i?e.createLayout(o,t,r):e.loadTexture(r,t+"0000")),e.mc=t,e.name=n,e.params={},e.spriteSheetName=r,e._currentFrameNumber=1,e._degrees=e.rotation=0,e.butFrameOffset=0,e}return __extends(a,s),a.RegisterSpritesheet=function(t,e){(a.SpriteSheetDatas=!a.SpriteSheetDatas?{}:a.SpriteSheetDatas)[t]=e},a.FrameRate=function(t){return t<0?40:Math.round(60*t/40)},Object.defineProperty(a.prototype,"tintRed",{get:function(){return this.tint>>16&255},set:function(t){this.tint=(Math.round(Math.min(255,Math.max(0,t)))<<16)+(65535&this.tint)},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"tintGreen",{get:function(){return this.tint>>8&255},set:function(t){this.tint=(Math.round(Math.min(255,Math.max(0,t)))<<8)+(this.tint&510<<16)},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"tintBlue",{get:function(){return 255&this.tint},set:function(t){this.tint=Math.round(Math.min(255,Math.max(0,t)))+(16776960&this.tint)},enumerable:!1,configurable:!0}),a.prototype.generateDefaultAnimation=function(){var t=Phaser.Animation.generateFrameNames(this.mc,0,this.totalFrames(),"",4);this.animations.add("_null",t,a.FrameRate(-1))},a.prototype.playLoop=function(){this.animations.getAnimation("_null")||this.generateDefaultAnimation(),this.play("_null",a.FrameRate(-1),!0)},a.prototype.playOnce=function(){this.animations.getAnimation("_null")||this.generateDefaultAnimation(),this.play("_null",a.FrameRate(-1),!1)},Object.defineProperty(a.prototype,"scaleX",{get:function(){return this.scale.x},set:function(t){this.scale.x=t},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"scaleY",{get:function(){return this.scale.y},set:function(t){this.scale.y=t},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"degrees",{get:function(){return 180*this.rotation/Math.PI},set:function(t){this._degrees=t,this.rotation=t*Math.PI/180},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"currentFrameNumber",{get:function(){return this._currentFrameNumber},set:function(t){this.gotoAndStop(Math.round(t))},enumerable:!1,configurable:!0}),a.prototype.totalFrames=function(){for(var t=0;;){var e=this.mc+a.getPaddedNumber(t,4),i=a.SpriteSheetDatas[this.spriteSheetName];if(!OzUtil.PE(i,"frames","filename",e))break;t++}return t},a.getPaddedNumber=function(t,e){for(var i=""+Math.round(t),n=e-i.length,r=0;r<n;r++)i="0"+i;return i},a.prototype.addAnimation=function(t,e,i,n,r,o,s){void 0===r&&(r=!1),void 0===o&&(o=null),void 0===s&&(s=null);i=Phaser.Animation.generateFrameNames(this.mc,e-1,i-1,"",4),r=this.animations.add(t,i,a.FrameRate(n),r);o&&r.onComplete.add(o,s)},a.prototype.playAnimation=function(t){this.currentAnimation=t;this.animations.play(t)},a.prototype.gotoAndStop=function(t){this._currentFrameNumber=t;var e=this.mc;e+=a.getPaddedNumber(--t,4),this.frameName=e},a.prototype.stop=function(){this.animations.stop()},a.prototype.getChild=function(t){for(var e=0,i=this.children;e<i.length;e++){var n=i[e];if(n instanceof a)if(n.name==t)return n}return null},a.prototype.clickedLevelSelect=function(){PhaserGameHelper.getInstance().game.state.getCurrentState().levelSelectClick(this)},a.prototype.makeButton=function(t,e,i,n){void 0===e&&(e=!0),void 0===n&&(n=!0),i=(i=void 0===i?null:i)||this,this.inputEnabled=!0,this.input.useHandCursor=!0,this.events.onInputDown.add(t,i),e&&(GameController.Touch()?(this.events.onInputDown.add(this.changeFrame2,this),this.events.onInputUp.add(this.changeFrame1,this)):(this.events.onInputOver.add(this.changeFrame2,this),this.events.onInputOut.add(this.changeFrame1,this),n&&this.events.onInputOver.add(this.mouseOverSound,this)),n&&this.events.onInputDown.add(this.mouseClickSound,this))},a.prototype.mouseOverSound=function(){SoundManager.getInstance().playSound("MouseOverSound")},a.prototype.mouseClickSound=function(){SoundManager.getInstance().playSound("MouseClickSound")},a.prototype.getButFrameOffset=function(){return this.butFrameOffset},a.prototype.changeButtonFrameOffset=function(t){var e=t-this.butFrameOffset;this.butFrameOffset=t,this.currentFrameNumber=this.currentFrameNumber+e},a.prototype.changeFrame1=function(){this.currentFrameNumber=1+this.butFrameOffset},a.prototype.changeFrame2=function(){this.currentFrameNumber=2+this.butFrameOffset},a.prototype.makeMusicButton=function(){this.butFrameOffset=SoundManager.muteMusic?2:0,this.changeFrame1(),this.makeButton(this.toggleMuteMusic,!0,this,!1)},a.prototype.toggleMuteMusic=function(){SoundManager.ToggleMuteMusic(),this.changeButtonFrameOffset(1<this.getButFrameOffset()?0:2)},a.prototype.makeSoundButton=function(){this.butFrameOffset=SoundManager.muteSound?2:0,this.changeFrame1(),this.makeButton(this.toggleMuteSound,!0,this,!1)},a.prototype.toggleMuteSound=function(){SoundManager.ToggleMuteSound(),this.changeButtonFrameOffset(1<this.getButFrameOffset()?0:2)},a.prototype.createLayout=function(t,e,i){for(var e=OzUtil.PE(t,null,"name",e),n=OzUtil.ARR(e.children),r=0;r<n.length;r++){var o=n[r],s=new a(o.mc,o.x,o.y,o.name,i,t);o.degrees&&(s.degrees=o.degrees),o.scaleX&&(s.scale.x=o.scaleX),o.scaleY&&(s.scale.y=o.scaleY),o.alpha&&(s.alpha=o.alpha),this.addChild(s)}},a.prototype.changeChildByName=function(t,e,i,n){t=this.getChild(t);this.removeChild(t);n=new a(e,t.x,t.y,t.name,i,n);this.addChild(n)},a.prototype.remove=function(){this.parent&&this.parent.removeChild(this)},a}(Phaser.Sprite),Space=nape.space.Space;!function(e){var i,t=(i=e.CitrusObject,__extends(n,i),n.prototype.initialize=function(t){void 0===t&&(t=null),i.prototype.initialize.call(this),this._space=new Space(this._gravity),this._contactListener=new e.NapeContactListener(this._space),e.NapePhysicsObject.space=this._space,e.PhysicsCollisionCategories.Add("GoodGuys"),e.PhysicsCollisionCategories.Add("BadGuys"),e.PhysicsCollisionCategories.Add("Level"),e.PhysicsCollisionCategories.Add("Items")},n.prototype.destroy=function(){this._contactListener.destroy(),this._space.clear(),i.prototype.destroy.call(this)},Object.defineProperty(n.prototype,"space",{get:function(){return this._space},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"gravity",{get:function(){return this._gravity},set:function(t){this._gravity=t,this._space&&(this._space.gravity=this._gravity)},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"contactListener",{get:function(){return this._contactListener},enumerable:!1,configurable:!0}),n.prototype.update=function(t){i.prototype.update.call(this,t),this._space.step(this.timeStep,this.velocityIterations,this.positionIterations)},n);function n(t){t=i.call(this,t,{})||this;return t.timeStep=.05,t.velocityIterations=8,t.positionIterations=8,t._gravity=new Vec2(0,450),t.updateCallEnabled=!0,t}e.Nape=t}(objects=objects||{});var InteractionListener=nape.callbacks.InteractionListener,InteractionType=nape.callbacks.InteractionType,CbType=nape.callbacks.CbType,CbEvent=nape.callbacks.CbEvent;!function(t){var e=(i.prototype.destroy=function(){this._space.listeners.clear()},i.prototype.onInteractionBegin=function(t){var e=t.int1.userData.myData,i=t.int2.userData.myData;e.beginContactCallEnabled&&e.handleBeginContact(t),i.beginContactCallEnabled&&i.handleBeginContact(t)},i.prototype.onInteractionEnd=function(t){var e=t.int1.userData.myData,i=t.int2.userData.myData;e.endContactCallEnabled&&e.handleEndContact(t),i.endContactCallEnabled&&i.handleEndContact(t)},i);function i(t){this._space=t,this._space.listeners.add(new InteractionListener(nape.callbacks.CbEvent.BEGIN,InteractionType.ANY,CbType.ANY_BODY,CbType.ANY_BODY,this.onInteractionBegin)),this._space.listeners.add(new InteractionListener(nape.callbacks.CbEvent.END,InteractionType.ANY,CbType.ANY_BODY,CbType.ANY_BODY,this.onInteractionEnd))}t.NapeContactListener=e}(objects=objects||{}),function(e){var i,t=(i=e.LevelObject,__extends(n,i),n.prototype.defineBody=function(){this._bodyType=BodyType.STATIC},n);function n(t){t=i.call(this,"niche",{view:t,width:4,height:20,x:+t.x+ +t.width/2,y:+t.y-t.height/2+25})||this;return t.isOccupied=!1,t._shape.sensorEnabled=!0,t.offsetY=-25,t._body.group=CollisionHelper.nonCollidable,t._body.setShapeFilters(new nape.dynamics.InteractionFilter(e.PhysicsCollisionCategories.Get("hidden"),-1,e.PhysicsCollisionCategories.Get("hidden"),-1)),t}e.Niche=t}(objects=objects||{}),function(t){var e=(s.Has=function(t,e){return Boolean(t&e)},s.Add=function(t){if(15==s._numCategories)throw new Error("You can only have 15 categories.");s._categoryNames[t]||(s._categoryNames[t]=s._categoryIndexes[s._numCategories],s._allCategories|=s._categoryIndexes[s._numCategories],s._numCategories++)},s.Get=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var i=0,n=0,r=t;n<r.length;n++){var o=r[n];0!=s._categoryNames[o]&&(i|=s._categoryNames[o])}return i},s.GetAll=function(){return s._allCategories},s.GetAllExcept=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var i=s._allCategories,n=0,r=t;n<r.length;n++){var o=r[n];0!=s._categoryNames[o]&&(i&=~s._categoryNames[o])}return i},s.GetNone=function(){return 0},s._allCategories=0,s._numCategories=0,s._categoryIndexes=[1,2,4,8,16,32,64,128,256,512,1024,2048,4096,8192,16384],s._categoryNames={},s);function s(){}t.PhysicsCollisionCategories=e}(objects=objects||{}),function(t){var o,e=(o=t.LevelObject,__extends(i,o),i.prototype.createMaterial=function(){o.prototype.createMaterial.call(this),this._material.density=.8,this._material.staticFriction=.3,this._material.dynamicFriction=.65},i.prototype.handleBeginContact=function(t){15<Math.abs(this._body.velocity.y)&&(SoundManager.getInstance().playSound("PlankDownSound"),this._isReadyToPlaySound=!1,TweenMax.delayedCall(1.25,function(){this._isReadyToPlaySound=!0},this))},i);function i(t){var e=this,i=50;175<t.width?i=210:125<t.width?i=150:80<t.width?i=100:60<t.width&&(i=70);for(var n=0,r=t._degrees;r<-180;)r+=360;for(;180<r;)r-=360;return 90!=r&&-90!=r||(n+=20),(e=o.call(this,"plank",{view:t,width:+i,height:20,x:+t.x+n+i/2,y:+t.y-10,group:4})||this).beginContactCallEnabled=!0,e._isReadyToPlaySound=!0,e}t.Plank=e}(objects=objects||{}),function(t){var e,i=(e=t.LevelObject,__extends(n,e),n.prototype.initialize2=function(t){void 0===t&&(t=null),this._clip=this.view,this.updateCallEnabled=!0,this.beginContactCallEnabled=!0,this._isReadyToPlayStepSound=!0,this._timeNotMoving=0,this._direction=1,this.offsetX=0,this.offsetY=25,this._clip.addAnimation("Stand",1,37,30,!0),this._clip.addAnimation("Walk",38,57,40,!0),this._clip.addAnimation("Run",58,71,40,!0),this._clip.addAnimation("GiveUp",132,166,40,!1),this._clip.addAnimation("Handcuff",167,201,40,!1),this._clip.addAnimation("Wound",202,221,30,!1),this._taskManager=new TaskManager(!0),this.assignTasks(),Constants.levelState.prisoners.push(this)},n.prototype.woundStatic=function(){this._clip.playAnimation("WoundStatic")},n.prototype.assignTasks=function(){this._taskManager.removeAllTasks(),this._taskManager.addTask(this,this.wait),this._taskManager.addPause(80),this._taskManager.addInstantTask(this,this.startPatrol),this._taskManager.addTask(this,this.patrol)},n.prototype.handleBeginContact=function(t){var e;this.isDisabled||(("box"==(e=NapeUtils.CollisionGetOther(this,t)).name||"removable"==e.name||"plank"==e.name)&&30<e.body.normalImpulse(this.body,!0).xy(!0).length&&e.y<this.y||"bullet"==e.name?this._taskManager.addUrgentInstantTask(this,this.wound):"hero"==e.name&&(this._taskManager.currentTask!=this.giveUp?(this._taskManager.removeAllTasks(),this._taskManager.addTask(this,this.stand),this._body.velocity.x=0,this._clip.playAnimation("Stand"),Constants.hero.giveUp(),Constants.dog.giveUp(),(t=new MovieClip("FightingGraphics")).playOnce(),t.y=this.y,t.x=this.x+.5*(e.x-this.x),Constants.levelState.groupSprites[Constants.levelState.NumSpriteGroups-1].addChild(t),SoundManager.getInstance().playSound("AttackSound"),TweenMax.delayedCall(.5,Constants.levelState.failLevel,Constants.levelState)):this.handcuff()))},n.prototype.handleEndContact=function(t){e.prototype.handleEndContact.call(this,t);NapeUtils.CollisionGetOther(this,t)},n.prototype.createShape=function(){var t=this._width,e=this._height;this._shape=new Polygon([new Vec2(-t/2,-e/2+3),new Vec2(0,-e/2-2),new Vec2(t/2,-e/2+3),new Vec2(t/2,e/2-8),new Vec2(t/2-6,e/2),new Vec2(-t/2+6,e/2),new Vec2(-t/2,e/2-8)],this._material),this._body.shapes.add(this._shape)},n.prototype.createMaterial=function(){e.prototype.createMaterial.call(this),this._material.elasticity=0,this._material.density=1,this._material.staticFriction=.01,this._material.dynamicFriction=.01},n.prototype.createFilter=function(){this._body.setShapeFilters(new InteractionFilter(t.PhysicsCollisionCategories.Get("enemy"),t.PhysicsCollisionCategories.GetAllExcept("enemy","hero"),t.PhysicsCollisionCategories.Get("enemy"),t.PhysicsCollisionCategories.GetAllExcept("enemy","hero")))},n.prototype.detectByCamera=function(t){this._taskManager.currentTask!=this.fearEscape&&(this._target=t,this._taskManager.addUrgentTask(this,this.fearEscape))},n.prototype.wait=function(){return SoundManager.getInstance().stopSound("GuardianStepSound"),SoundManager.getInstance().stopSound("GuardianRunSound"),this._clip.playAnimation("Stand"),!0},n.prototype.stand=function(){return!0},n.prototype.startPatrol=function(){this.moveHorizontally(this._body,this.WALK_SPEED*this._direction),0<this._direction?this.inverted=!1:this.inverted=!0},n.prototype.isReadyToPlayStepSoundTrue=function(){this._isReadyToPlayStepSound=!0},n.prototype.patrol=function(){return this._isReadyToPlayStepSound&&(this._isReadyToPlayStepSound=!1,TweenMax.delayedCall(.32,this.isReadyToPlayStepSoundTrue,this),SoundManager.getInstance().playSound("GuardianStepSound")),"Walk"!=this._clip.currentAnimation&&this._clip.playAnimation("Walk"),Math.abs(this._body.velocity.x)<=.05&&.05<this._timeNotMoving||this.x>this._limitRight&&1==this._direction&&this.x-this._limitRight<12||this.x<this._limitLeft&&-1==this._direction&&this._limitLeft-this.x<12?(this._direction=-this._direction,!0):(this.moveHorizontally(this._body,this.WALK_SPEED*this._direction),!1)},n.prototype.pursue=function(){return this._target.x<this.x?(this.inverted=!0,this.moveHorizontally(this._body,-this.RUN_SPEED)):(this.inverted=!1,this.moveHorizontally(this._body,this.RUN_SPEED)),1.5<this._timeNotMoving?this._clip.playAnimation("Stand"):"Run"!=this._clip.currentAnimation?this._clip.playAnimation("Run"):this._isReadyToPlayStepSound&&(this._isReadyToPlayStepSound=!1,TweenMax.delayedCall(.45,this.isReadyToPlayStepSoundTrue,this),SoundManager.getInstance().playSound("GuardianRunSound")),!1},n.prototype.fearEscapeTweenFunc=function(){this._fearTween=null,this._taskManager.currentTask==this.fearEscape&&this.assignTasks()},n.prototype.fearEscape=function(){return this._fearTween||(this._fearTween=TweenMax.delayedCall(2,this.fearEscapeTweenFunc,this)),this._target.x<this.x?(this.inverted=!1,this.moveHorizontally(this._body,this.RUN_SPEED)):(this.inverted=!0,this.moveHorizontally(this._body,-this.RUN_SPEED)),1.5<this._timeNotMoving?this._clip.playAnimation("Stand"):"Run"!=this._clip.currentAnimation?this._clip.playAnimation("Run"):this._isReadyToPlayStepSound&&(this._isReadyToPlayStepSound=!1,TweenMax.delayedCall(.45,this.isReadyToPlayStepSoundTrue,this),SoundManager.getInstance().playSound("GuardianRunSound")),!1},n.prototype.giveUp=function(){return this._body.velocity.x=0,"GiveUp"!=this._clip.currentAnimation&&this._clip.playAnimation("GiveUp"),!0},n.prototype.handcuff=function(){"Handcuff"!=this._clip.currentAnimation&&this._clip.playAnimation("Handcuff"),this.x>Constants.hero.x?this.inverted=!1:this.inverted=!0,Constants.hero.handcuff(this),this.disable()},n.prototype.disable=function(){this.isDisabled=!0,this.group=0,this._body.space=null,Constants.levelState.groupSprites[0].addChild(this.view),TweenMax.to(this.view,.6,{tintRed:41,tintGreen:29,tintBlue:29,delay:.5})},n.prototype.wound=function(){this.isDisabled||(this.disable(),this._clip.playAnimation("Wound"),this._taskManager.removeAllTasks(),SoundManager.getInstance().playSound("GuardianHurtSound"),TweenMax.delayedCall(.25,this.playGuardianStarsSound,this))},n.prototype.playGuardianStarsSound=function(){SoundManager.getInstance().playSound("GuardianStarsSound")},n.prototype.makeGiveUp=function(){this._taskManager.currentTask!=this.giveUp&&(this._taskManager.removeAllTasks(),this._taskManager.addUrgentInstantTask(this,this.giveUp))},n.prototype.cameraGoneAway=function(){this._taskManager.addInstantTask(this,this.startPatrol),this._taskManager.addTask(this,this.patrol)},n.prototype.update=function(t){e.prototype.update.call(this,t),this.isDisabled||this._taskManager.currentTask==this.stand||(Math.abs(this._body.velocity.x)<=.05?this._timeNotMoving+=t:this._timeNotMoving=0,this._taskManager.update(),Math.abs(this.y-Constants.dog.y)<60&&Math.abs(this.x-Constants.dog.x)<80?this._taskManager.currentTask!=this.giveUp&&(Constants.dog.bark(),this._taskManager.addUrgentInstantTask(this,this.giveUp)):this._taskManager.currentTask==this.giveUp||(Math.abs(this.y-Constants.dog.y)<60&&Math.abs(this.x-Constants.dog.x)<160?(this._target=Constants.dog,this._taskManager.currentTask!=this.fearEscape&&this._taskManager.addUrgentTask(this,this.fearEscape)):Math.abs(this.y-Constants.hero.y)<60&&(this._body.velocity.x<.5&&this.x-Constants.hero.x<155&&-10<this.x-Constants.hero.x||-.5<this._body.velocity.x&&Constants.hero.x-this.x<155&&-10<Constants.hero.x-this.x)?(this._target=Constants.hero,this._taskManager.currentTask!=this.pursue&&this._taskManager.addUrgentTask(this,this.pursue)):Math.abs(this.y-Constants.dog.y)<60&&Math.abs(this.x-Constants.dog.x)<200||this._taskManager.currentTask==this.pursue&&this.assignTasks()))},n.prototype.destroy=function(){e.prototype.destroy.call(this),Constants.levelState.prisoners.splice(Constants.levelState.prisoners.indexOf(this),1)},n);function n(t){t=e.call(this,"prisoner",{view:t,width:38,height:48,x:+t.x+28,y:+t.y-24,group:4})||this;return t.isDisabled=t._isReadyToPlayStepSound=!1,t._direction=t._timeNotMoving=0,t.WALK_SPEED=25,t.RUN_SPEED=36,t._body.allowRotation=!1,t.initialize2(),t._limitLeft=-1e5,t._limitRight=1e5,t.view.params.limitLeft&&(t._limitLeft=t.x-parseInt(t.view.params.limitLeft)),t.view.params.limitRight&&(t._limitRight=t.x+parseInt(t.view.params.limitRight)),t}t.Prisoner=i}(objects=objects||{}),function(r){var o,t=(o=r.LevelObject,__extends(e,o),e.prototype.defineBody=function(){this._bodyType=BodyType.STATIC},e.prototype.handleBeginContact=function(t){if(this._touchingObjects++,1==this._touchingObjects){this._targets||(this._targets=Constants.levelState.getObjectsByName(this._name));for(var e=0,i=this._targets;e<i.length;e++){var n=i[e];n instanceof r.LevelObject&&n.action()}this.view.totalFrames();TweenMax.to(this.view.getChild("top"),.3,{y:3}),SoundManager.getInstance().playSound("PushButtonSound")}},e.prototype.handleEndContact=function(t){if(this._touchingObjects--,0==this._touchingObjects){for(var e=0,i=this._targets;e<i.length;e++){var n=i[e];n instanceof r.LevelObject&&n.action()}TweenMax.to(this.view.getChild("top"),.3,{y:-1}),SoundManager.getInstance().playSound("PushButtonSound")}},e.prototype.createFilter=function(){this._body.setShapeFilters(new InteractionFilter(r.PhysicsCollisionCategories.Get("hidden"),-1,r.PhysicsCollisionCategories.Get("hidden"),-1))},e);function e(t){var e=this,i=t._degrees;for(t.rotation=0;i<-180;)i+=360;for(;180<i;)i-=360;var n=12,r=-6;180==i?(n=-13,r=6):90==i?(n=6.5,r=12):-90==i&&(n=-6.5,r=-13);r=(e=o.call(this,t.name,{view:t,width:22,height:11,rotation:+i,x:+t.x+n,y:+t.y+r,group:5})||this)._touchingObjects=0;return 0==(r=t.params.type?Math.round(parseFloat(t.params.type)):r)&&(r=1),e._name="subject"+String(r),t.getChild("top").gotoAndStop(r),e.beginContactCallEnabled=!0,e.endContactCallEnabled=!0,e._shape.sensorEnabled=!0,e}r.PushButton=t}(objects=objects||{});var objects,states,InteractionCallback=nape.callbacks.InteractionCallback;!function(t){var e,i=(e=t.LevelObject,__extends(n,e),n.prototype.handleBeginContact=function(t){15<Math.abs(this._body.velocity.y)&&(SoundManager.getInstance().playSound("StoolDownSound"),this._isReadyToPlaySound=!1,TweenMax.delayedCall(1.25,function(){this._isReadyToPlaySound=!0},this))},n);function n(t){t=e.call(this,"box",{view:t,width:+t.width-2,height:+t.height-3,x:+t.x+t.width/2,y:+t.y-t.height/2,group:4})||this;return t.beginContactCallEnabled=!0,t._isReadyToPlaySound=!0,t}t.Stool=i}(objects=objects||{}),function(t){var h,e=(h=Phaser.Text,__extends(i,h),i.prototype.onOver=function(){this.fill="#ffff00",this.scale.set(1.01)},i.prototype.onOut=function(){this.setFillToGradient(),this.scale.set(1)},i.prototype.setFillToGradient=function(){var t=this.context.createLinearGradient(0,0,0,this.height);t.addColorStop(0,"#ffffff"),t.addColorStop(1,"#b3fffc"),this.fill=t},i);function i(t,e,i,n,r,o,s){void 0===o&&(o=void 0),void 0===s&&(s=void 0);var a=this;return(a=h.call(this,t,e,i,n,{font:r+"px ChatNoir",stroke:"#101742",strokeThickness:9})||this).anchor.set(.5),a.setFillToGradient(),a.setShadow(0,-2.5,"rgba(255, 255, 0, 1)",0,!0,!1),void 0!==o&&(a.inputEnabled=!0,a.events.onInputOver.add(a.onOver,a),a.events.onInputOut.add(a.onOut,a),a.events.onInputDown.add(o,s)),a}t.StyledTranslatedText=e}(objects=objects||{}),function(t){var e,i=(e=t.LevelObject,__extends(n,e),n.prototype.defineBody=function(){this._bodyType=BodyType.STATIC},n.prototype.createFilter=function(){this._body.setShapeFilters(new InteractionFilter(t.PhysicsCollisionCategories.Get("tile"),t.PhysicsCollisionCategories.GetAll(),t.PhysicsCollisionCategories.Get("tile"),t.PhysicsCollisionCategories.GetAll()))},n);function n(t){t=e.call(this,"fixedBox",{width:35,height:35,x:+(+t.x+17.5),y:+(+t.y-17.5)})||this;return t}t.Tile=i}(objects=objects||{}),function(t){var e,i=(e=t.CitrusSprite,__extends(n,e),n.prototype.destroy=function(){e.prototype.destroy.call(this),Constants.levelState.removeObject(this)},n);function n(t){t=e.call(this,"tile",{view:t,x:+t.x,y:+t.y,group:3})||this;return Constants.levelState.addObject(t),t}t.TileVisual=i}(objects=objects||{}),function(i){var e,t=(e=i.LevelObject,__extends(n,e),n.prototype.action=function(){var t,e;this._body.type==BodyType.STATIC&&(this._body.space=null,this._body.type=BodyType.DYNAMIC,this._body.space=i.NapePhysicsObject.space,SoundManager.getInstance().playSound("ToiletSound"),SoundManager.getInstance().playSound("WaterSound"),t=new MovieClip("WaterSplashGraphics"),e=new i.CitrusObject("water",{view:t,x:this.x-1,y:this.y+16}),t.playLoop(),Constants.levelState.addObject(e))},n.prototype.createBody=function(){this._bodyType=BodyType.STATIC,e.prototype.createBody.call(this)},n.prototype.handleBeginContact=function(t){10<Math.abs(this._body.velocity.y)&&(SoundManager.getInstance().playSound("ToiletSound"),this._isReadyToPlaySound=!1,TweenMax.delayedCall(1.25,function(){this._isReadyToPlaySound=!0},this))},n);function n(t){t=e.call(this,"removable",{view:t,width:33,height:33,x:+t.x+16.5+2,y:+t.y-16.5,group:4})||this;return t.beginContactCallEnabled=!0,t._isReadyToPlaySound=!0,t}i.Toilet=t}(objects=objects||{}),function(t){var e,i=(e=t.LevelObject,__extends(n,e),n.prototype.defineBody=function(){this._bodyType=BodyType.STATIC},n);function n(t){t=e.call(this,"sprite",{view:t,width:+t.width,height:+t.height,x:+t.x+ +t.width/2,y:+t.y-t.height/2,group:4})||this;return t._shape.sensorEnabled=!0,t}t.TopDecoration=i}(objects=objects||{}),function(r){var o,t=(o=r.LevelObject,__extends(e,o),e.prototype.defineBody=function(){this._bodyType=BodyType.STATIC},e.prototype.handleBeginContact=function(t){t=NapeUtils.CollisionGetOther(this,t);if("dog"==t.name||"hero"==t.name){this._targets||(this._targets=Constants.levelState.getObjectsByName(this._name));for(var e=0,i=this._targets;e<i.length;e++){var n=i[e];n instanceof r.LevelObject&&n.action()}this._isActivated=!this._isActivated,SoundManager.getInstance().playSound("TriggerSound"),this._isActivated?TweenMax.to(this.view.getChild("handle"),.5,{degrees:90}):TweenMax.to(this.view.getChild("handle"),.5,{degrees:0})}},e.prototype.createFilter=function(){this._body.setShapeFilters(new InteractionFilter(r.PhysicsCollisionCategories.Get("hidden"),-1,r.PhysicsCollisionCategories.Get("hidden"),-1))},e);function e(t){var e=this,i=t._degrees;for(t.rotation=0;i<-180;)i+=360;for(;180<i;)i-=360;var n=12.5,r=-11.5;180==i?(n=-13.5,r=11):90==i?(n=11.5,r=12):-90==i&&(n=-11,r=-13.5);e=o.call(this,t.name,{view:t,width:22,height:22,x:+t.x+n,rotation:+i,y:+t.y+r,group:5})||this,r=0;return 0==(r=t.params.type?Math.round(parseFloat(t.params.type)):r)&&(r=1),e._name="subject"+String(r),t.getChild("handle").gotoAndStop(r),t.getChild("base").gotoAndStop(r),t.stop(),e.beginContactCallEnabled=!0,e._shape.sensorEnabled=!0,e}r.Trigger=t}(objects=objects||{}),function(e){var i,t=(i=e.LevelObject,__extends(n,i),n.prototype.initialize2=function(t){void 0===t&&(t=null),this._clip.addAnimation("Stop",26,26,1),this._clip.addAnimation("Fire",1,26,40,!1),this._clip.playAnimation("Stop")},n.prototype.fire=function(){var t=new e.Bullet;t.x=this.x+(this.inverted?17:-17),t.y=this.y-8,t.body.velocity=new Vec2(this.inverted?120:-120,0),Constants.DEBUG,this._clip.playAnimation("Fire"),SoundManager.getInstance().playSound("TurrelFireSound"),this._fireTween=TweenMax.delayedCall(4.5,this.fire,this)},n.prototype.defineBody=function(){this._bodyType=BodyType.STATIC},n.prototype.destroy=function(){i.prototype.destroy.call(this),this._fireTween&&this._fireTween.kill()},n);function n(t){var e=i.call(this,"turrel",{view:t,width:35,height:35,x:+t.x+28,y:+t.y-13,group:6})||this;return e._clip=t,e._shape.sensorEnabled=!0,e.initialize2(),1==e.view.params.flippedHorizontally&&(e.inverted=!0),e._fireTween=TweenMax.delayedCall(4.5,e.fire,e),e}e.Turrel=t}(objects=objects||{}),function(t){var e,i=(e=t.CitrusSprite,__extends(n,e),n.prototype.destroy=function(){e.prototype.destroy.call(this),Constants.levelState.removeObject(this)},n);function n(t){t=e.call(this,"levelText",{view:t,x:+t.x+t.width/2,y:+t.y-t.height/2-2})||this;return Constants.levelState.addObject(t),t}t.Txt=i}(objects=objects||{}),function(t){var r,e=(r=t.OzState,__extends(o,r),o.prototype.create=function(){var t=this;if(r.prototype.create.call(this),this.delayedCalls=new Array,SoundManager.getInstance().playSound("MenuMusic"),this.mc=new MovieClip,this.game.world.addChild(this.mc),0==o.ID_ANIMATION){this._currentFrame=0,this._finalFrame=8,this.mc.addChild(new MovieClip("cmcIntroAnimationBG",0,0,"bg","PreloaderObjects",PreloaderObjectsLayouts.data)),this.mc.makeButton(this.playFrame,!1,this,!1),this.mc.input.useHandCursor=!1;for(var e=this._finalFrame-1;e>this._currentFrame;e--)this.mc.addChild(new MovieClip("cmcAnim"+e,0,0,"anim"+e))}else{this._currentFrame=7,this._finalFrame=13,this.mc.addChild(new MovieClip("cmcFinalAnimationBG",0,0,"bg","PreloaderObjects",PreloaderObjectsLayouts.data)),this.mc.makeButton(this.playFrame,!1,this,!1),this.mc.input.useHandCursor=!1;for(e=this._finalFrame-1;e>this._currentFrame;e--)this.mc.addChild(new MovieClip("cmcAnim"+e,0,0,"anim"+e))}for(e=1;e<this._delays.length;e++){var i=this.mc.getChild("anim"+e);i&&(i.alpha=0)}var n=Fabrique.LocalizationHandler.getInstance().getValue("skip"),n=new objects.StyledTranslatedText(this.game,615,480,n,18,function(){Fabrique.AdHandler.getInstance().showAd("skip_animation",function(){t.endThis()})},this);this.mc.addChild(n);this.sub=new Phaser.Text(this.game,250,450,"",{font:"16px ChatNoir",fill:"#FFFFFF",boundsAlignH:"center",boundsAlignV:"top"}),this.sub.stroke="#824E26",this.sub.anchor.set(.5),this.sub.strokeThickness=2,this.sub.wordWrap=!0,this.sub.wordWrapWidth=400,this.mc.addChild(this.sub),this.delayedCalls.push(TweenMax.delayedCall(1.3,this.playFrame,this))},o.prototype.clearDelayedCalls=function(){for(var t=0;t<this.delayedCalls.length;t++){var e=this.delayedCalls[t];e&&e.kill()}this.delayedCalls=[]},o.prototype.playFrame=function(){var t,e;this.clearDelayedCalls(),this._currentFrame>=this._finalFrame?this.endThis():(this._currentFrame++,(e=this.mc.getChild("anim"+(this._currentFrame-1)))&&(e.alpha=1),this._currentFrame<this._finalFrame?(t=(t=this._sounds[this._currentFrame-1])||this._sounds[this._currentFrame-2],(e=this._sounds[this._currentFrame])&&SoundManager.getInstance().stopSound(t),e&&(t=(this._currentFrame-1).toString(),this.sub.text=Fabrique.LocalizationHandler.getInstance().getValue(t),SoundManager.getInstance().playSound(e)),(e=this.mc.getChild("anim"+this._currentFrame))&&this.delayedCalls.push(TweenMax.to(e,1,{alpha:1})),this.delayedCalls.push(TweenMax.delayedCall(this._delays[this._currentFrame],this.playFrame,this))):this.delayedCalls.push(TweenMax.delayedCall(3,this.playFrame,this)))},o.prototype.endThis=function(){this.clearDelayedCalls(),0==o.ID_ANIMATION?(Constants.currentLevel=1,Constants.stateSwitcher.switchToPlay()):Constants.stateSwitcher.switchToLevelSelect(),Constants.isIntroAnimationPlayed=!0,StorageHelper.saveCookies()},o.prototype.shutdown=function(){for(var t=0;t<this._sounds.length;t++)this._sounds[t]&&SoundManager.getInstance().stopSound(this._sounds[t])},o.ID_ANIMATION=0,o);function o(){var t=null!==r&&r.apply(this,arguments)||this;return t._sounds=[null,"Comix1Sound","Comix2Sound",null,"Comix3Sound","Comix4Sound","Comix5Sound","Comix6Sound","Comix7Sound","Comix8Sound","Comix9Sound","Comix10Sound","Comix11Sound",null],t._delays=[0,3,1,2.5,5.8,3,3.5,4,2.8,3.1,3.6,5.2,5,0],t}t.AnimationState=e}(states=states||{}),function(t){var e,i=(e=t.OzState,__extends(n,e),n.prototype.init=function(){Fabrique.AdHandler.getInstance().init(),Fabrique.PauseHandler.getInstance(this.game).init(),SaveDataManager.getInstance(this.game)},n.prototype.preload=function(){var e=this;Fabrique.LoaderHelper.hide(),this.game.load.onFileComplete.add(function(t){h5branding.SplashLoader.getInstance().setLoadProgress(t)}),this.game.load.onLoadComplete.add(function(){h5branding.SplashLoader.getInstance().setLoadProgress(100)}),h5ads.adWrapper.preloadAd(h5ads.AdType.interstitial),h5branding.SplashLoader.getInstance().setButtonCallback(function(){h5branding.SplashLoader.getInstance().destroy(),SoundManager.decodeSounds(),Fabrique.LocalizationHandler.getInstance().initI18Next(),SoundManager.setAudioStatus(),h5branding.Utils.inGDGameZone()||e.game.device.cordova?(Fabrique.LoaderHelper.hide(),e.game.state.start("MainMenu")):Fabrique.AdHandler.getInstance().showAd("splash",function(){var t;azIntLoginPrompt.Manager.init({loginText:Fabrique.LocalizationHandler.getInstance().getValue("loginSaveResult"),confirmText:Fabrique.LocalizationHandler.getInstance().getValue("yes"),cancelText:Fabrique.LocalizationHandler.getInstance().getValue("no")}),null!==(t=window._azerionIntegration)&&void 0!==t&&t.rType&&azIntRatings.Wrapper.create(null===(t=window._azerionIntegration)||void 0===t?void 0:t.rType),e.game.state.start("MainMenu")})}),this.game.load.atlas("Objects","assets/images/Objects.png",null,Objects.data),this.game.load.atlas("WinningObjects","assets/images/WinningObjects.png",null,WinningObjects.data),this.game.load.atlas("addObjects","assets/images/addObjects.png",null,addObjects.data),this.game.load.atlas("mm3_ru_logo","assets/images/mm3_ru_logo.png",null,mm3_ru_logo.data),this.game.load.atlas("mm3_button","assets/images/mm3_button.png",null,mm3_button.data),SoundManager.Preload(),Constants.maxLevel=21,Constants.currentLevel=1,GameController.LEFT_CURTAIN_OPEN_X=-386,GameController.RIGHT_CURTAIN_OPEN_X=Constants.WIDTH+422,StorageHelper.readCookies(),TweenMax.Init(this.game),this.game.load.cacheBuster="undefined"==typeof version?null:version,this.load.image("AzerionLogo","assets/images/AZERION_logo_txt_stencil_white.png"),this.load.image("rotateDevice","assets/images/rotateDevice.png"),this.load.atlas("PreloaderObjects","assets/images/PreloaderObjects.png",null,PreloaderObjects.data),MovieClip.RegisterSpritesheet("Objects",Objects.data),MovieClip.RegisterSpritesheet("PreloaderObjects",PreloaderObjects.data),MovieClip.RegisterSpritesheet("WinningObjects",WinningObjects.data),Constants.SUPPORTED_LANGUAGES.forEach(function(t){e.load.json(t,"assets/locales/"+t+".json")}),this.game.load.crossOrigin=!0,h5branding.Utils.getBrandingDomain()!==h5branding.BrandingDomain.Neutral&&this.game.load.image(h5branding.Branding.LOGO_KEY,h5branding.Branding.brandingLogoUrl)},n.prototype.create=function(){var e=this;this.game.stage.backgroundColor=0,this.game.scale.scaleMode=Phaser.ScaleManager.USER_SCALE,this.game.scale.fullScreenScaleMode=Phaser.ScaleManager.USER_SCALE,this.game.scale.pageAlignHorizontally=!0,this.game.scale.pageAlignVertically=!0,this.game.scale.windowConstraints.right="layout",this.game.scale.windowConstraints.bottom="visual",this.game.canvas.oncontextmenu=function(t){t.preventDefault()},this.initializeHelpers(),this.game.scale.setGameSize(window.innerWidth,window.innerHeight),this.game.scale.setUserScale(1,1,0,0),document.addEventListener("fullscreenchange",function(t){e.onSizeChange()}),window.addEventListener("resize",function(t){e.onSizeChange()}),window.addEventListener("resize",function(t){e.onSizeChange()}),this.onSizeChange()},n.prototype.initializeHelpers=function(){SoundManager.Init(),Constants.levelParser=new LevelParseSystem,Constants.stateSwitcher=new StateSwitchSystem,CollisionHelper.initCollisionCategories()},n.InW=-1,n.InH=-1,n.PADH=0,n.NUMRESIZE=0,n.inSplash=!0,n);function n(){return null!==e&&e.apply(this,arguments)||this}t.Boot=i}(states=states||{}),function(t){var e,i=(e=t.OzState,__extends(n,e),n.prototype.preload=function(){t.Boot.inSplash=!1,this.initGameController(),this.game.scale.refresh(),this.onSizeChange()},n.prototype.create=function(){this.cnt=0,n.NumShown++,SoundManager.getInstance().playSound("MenuMusic"),this.mc=new MovieClip("cmcMainMenu"),this.game.world.addChild(this.mc),"ru"===i18next.language&&(this.mc.removeChild(this.mc.getChild("")),e=new Phaser.Sprite(this.game,-11,0,"mm3_ru_logo","titlescreen.png"),this.mc.addChild(e)),this.mc.removeChild(this.mc.getChild("playButton"));var t,e,i=Fabrique.LocalizationHandler.getInstance().getValue("play");this.playBtn=new objects.StyledTranslatedText(this.game,Constants.WIDTH/2,Constants.HEIGHT/2+60,i,32,this.goLevels,this),this.game.add.existing(this.playBtn),this.mc.removeChild(this.mc.getChild("creditsButton")),i=Fabrique.LocalizationHandler.getInstance().getValue("credits"),this.creditsBtn=new objects.StyledTranslatedText(this.game,Constants.WIDTH/2,Constants.HEIGHT/2+130,i,26,this.showCredits,this),this.game.add.existing(this.creditsBtn),this.mc.removeChild(this.mc.getChild("moreButton")),i=Fabrique.LocalizationHandler.getInstance().getValue("more_games"),this.moreGamesBtn=new objects.StyledTranslatedText(this.game,Constants.WIDTH/2,Constants.HEIGHT/2+190,i,26,Constants.sponsor,this),this.game.add.existing(this.moreGamesBtn),!h5branding.Branding.outGoingLinksAllowed()||this.game.device.cordova?this.moreGamesBtn.visible=!1:this.brandingLogo=this.game.add.button(480,425,h5branding.Branding.LOGO_KEY,function(){h5branding.Branding.openCampaignLink(Constants.GOOGLE_APP_NAME,h5branding.UtmTargets.logo)}),this.mc.addChild(new MovieClip("SoundButtonGraphics",613,3,"btnSound","PreloaderObjects",PreloaderObjectsLayouts.data)),this.mc.addChild(new MovieClip("MusicButtonGraphics",657,3,"btnMusic","PreloaderObjects",PreloaderObjectsLayouts.data)),GameController.Touch()&&(this.mc.changeChildByName("btnSound","BigSoundButtonGraphics","PreloaderObjects",PreloaderObjectsLayouts.data),this.mc.changeChildByName("btnMusic","BigMusicMenuButton","PreloaderObjects",PreloaderObjectsLayouts.data),t=this.mc.getChild("btnMusic"),e=this.mc.getChild("btnSound"),t.x=647,t.y=3,e.x=594,e.y=3),this.mc.getChild("btnMusic").makeMusicButton(),this.mc.getChild("btnSound").makeSoundButton(),this.creditsSprite=new MovieClip("cmcCredits",203,-556),this.game.world.addChild(this.creditsSprite),this.creditsSprite.visible=!1,this.creditsSprite.removeChild(this.creditsSprite.getChild("backButton")),this.backBtn=new Phaser.Sprite(this.game,.22*Constants.WIDTH,.74*Constants.WIDTH,"mm3_button","button_03.png"),this.backBtn.anchor.set(.5),this.creditsSprite.addChild(this.backBtn);var i=Fabrique.LocalizationHandler.getInstance().getValue("back"),i=new objects.StyledTranslatedText(this.game,.21*Constants.WIDTH,.73*Constants.WIDTH,i,26,this.unShowCredits,this);this.creditsSprite.addChild(i),this.game.device.cordova&&((i=this.game.add.image(10,0,"AzerionLogo")).y=this.game.height-i.height-10)},n.prototype.onSizeChange=function(){t.Boot.inSplash||t.Boot.InW==Math.round(window.innerWidth)&&t.Boot.InH==Math.round(window.innerHeight)&&3<t.Boot.NUMRESIZE||(t.Boot.InW=Math.round(window.innerWidth),t.Boot.InH=Math.round(window.innerHeight),GameController.JoypadLeft&&t.Boot.NUMRESIZE++,this.adjustWorld(),t.Boot.PADH=Math.round(-this.camera.x),GameController.AdjustJoypad(),GameController.AdjustPad(),GameController.JoypadLeft)},n.prototype.update=function(){e.prototype.update.call(this),1==this.cnt&&e.prototype.create.call(this),this.cnt++},n.prototype.goLevels=function(){Constants.isIntroAnimationPlayed?Constants.stateSwitcher.switchToLevelSelect():(t.AnimationState.ID_ANIMATION=0,Constants.stateSwitcher.switchToAnimation())},n.prototype.showCredits=function(){this.creditsSprite.visible||(this.creditsSprite.visible=!0,this.disableInput(),TweenMax.to(this.creditsSprite,.4,{y:-25,ease:"Quad.easeOut"}))},n.prototype.unShowCredits=function(){var t=this;Fabrique.AdHandler.getInstance().showAd("hide_credits",function(){TweenMax.to(t.creditsSprite,.25,{y:-556,onComplete:t.hideCredits,onCompleteContext:t})})},n.prototype.hideCredits=function(){this.creditsSprite.visible=!1,this.enableInput()},n.prototype.depressButtons=function(){this.mc.getChild("playButton").changeFrame1(),this.mc.getChild("creditsButton").changeFrame1(),this.mc.getChild("moreButton").changeFrame1()},n.prototype.disableInput=function(){this.creditsSprite.inputEnabled=!1,this.playBtn.input.enabled=!1,this.creditsBtn.input.enabled=!1,this.moreGamesBtn.input.enabled=!1},n.prototype.enableInput=function(){this.playBtn.input.enabled=!0,this.creditsBtn.input.enabled=!0,this.moreGamesBtn.input.enabled=!0},n.prototype.initGameController=function(){GameController.PadLeft||(GameController.CurtainContainer=new MovieClip,this.game.stage.addChild(GameController.CurtainContainer),GameController.LeftCurtain=new MovieClip("LeftCurtainGraphics",0,0,null,"PreloaderObjects",PreloaderObjectsLayouts.data),GameController.LeftCurtain.x=GameController.LEFT_CURTAIN_OPEN_X,GameController.CurtainContainer.addChild(GameController.LeftCurtain),GameController.RightCurtain=new MovieClip("RightCurtainGraphics",0,0,null,"PreloaderObjects",PreloaderObjectsLayouts.data),GameController.RightCurtain.x=GameController.RIGHT_CURTAIN_OPEN_X,GameController.CurtainContainer.addChild(GameController.RightCurtain),GameController.PadLeft=new MovieClip("cmcSidePad",0,0,null,"PreloaderObjects",PreloaderObjectsLayouts.data),GameController.PadLeft.x=0,this.game.stage.addChild(GameController.PadLeft),GameController.PadRight=new MovieClip("cmcSidePad",0,0,null,"PreloaderObjects",PreloaderObjectsLayouts.data),GameController.PadRight.x=Constants.WIDTH,GameController.PadRight.scaleX=-1,this.game.stage.addChild(GameController.PadRight),GameController.AdjustPad(),Constants.RotateDevice=this.game.add.image(0,0,"rotateDevice"),this.game.stage.addChild(Constants.RotateDevice),Constants.RotateDevice.visible=!1)},n.NumShown=0,n);function n(){var t=null!==e&&e.apply(this,arguments)||this;return t.cnt=0,t}t.MainMenuState=i}(states=states||{});var ExternalLink,CitrusEngine=function(){function t(){this._playing=!0,this.input=Input.Init(),this.input.addKeyAction("jump",Phaser.Keyboard.UP,Constants.dogInputChannel),this.input.addKeyAction("right",Phaser.Keyboard.RIGHT,Constants.dogInputChannel),this.input.addKeyAction("left",Phaser.Keyboard.LEFT,Constants.dogInputChannel),this.input.addKeyAction("grab",Phaser.Keyboard.SPACEBAR,Constants.dogInputChannel),this.input.addKeyAction("grabDown",Phaser.Keyboard.DOWN,Constants.dogInputChannel),this.input.addKeyAction("down",Phaser.Keyboard.S,Constants.hustlerInputChannel),this.input.addKeyAction("jump",Phaser.Keyboard.W,Constants.hustlerInputChannel),this.input.addKeyAction("right",Phaser.Keyboard.D,Constants.hustlerInputChannel),this.input.addKeyAction("left",Phaser.Keyboard.A,Constants.hustlerInputChannel),this.input.addKeyAction("restart",Phaser.Keyboard.R),this.input.addKeyAction("pause",Phaser.Keyboard.P),this.input.addKeyAction("next",Phaser.Keyboard.SPACEBAR),this.input.addKeyAction("change",Phaser.Keyboard.C),this.input.addKeyAction("previousLevel",Phaser.Keyboard.ONE),this.input.addKeyAction("nextLevel",Phaser.Keyboard.TWO)}return t.getInstance=function(){return t.instance=null==t.instance?new t:t.instance},t.Init=function(){return t.instance=new t},Object.defineProperty(t.prototype,"playing",{get:function(){return this._playing},set:function(t){this._playing=t},enumerable:!1,configurable:!0}),t.instance=null,t}(),CollisionHelper=function(){function t(){}return t.initCollisionCategories=function(){objects.PhysicsCollisionCategories.Add("grab"),objects.PhysicsCollisionCategories.Add("hidden"),objects.PhysicsCollisionCategories.Add("enemy"),objects.PhysicsCollisionCategories.Add("limiter"),objects.PhysicsCollisionCategories.Add("tile"),objects.PhysicsCollisionCategories.Add("hero"),objects.PhysicsCollisionCategories.Add("mirror"),this.nonCollidable=new InteractionGroup(!0)},t}();!function(t){var e=(i.openCampaignLink=function(t,e,i){if(!h5branding.Branding.outGoingLinksAllowed())return null;var n=h5branding.Utils.getSourceSite();return window.op3n("http://www.kizi.com/?utm_source="+n+"&utm_medium=html5&utm_term="+e+"&utm_content="+i+"&utm_campaign=sponsored_games","_blank")},i);function i(){}t.Utils=e}(ExternalLink=ExternalLink||{});var Boot=states.Boot,GameController=function(){function e(){}return e.Touch=function(){var t=PhaserGameHelper.getInstance().game;return e.isTouchInitted||(e.isTouchInitted=!0,e.isTouch=!t.device.desktop&&t.device.touch),e.isTouch},e.AdjustPad=function(){e.PadLeft&&(e.PadLeft.x=Math.floor(Boot.PADH+1.9),e.PadLeft.y=0,e.PadRight.x=Boot.PADH+Constants.WIDTH,e.PadRight.y=0,e.CurtainContainer.x=Boot.PADH)},e.AdjustJoypad=function(){var t=PhaserGameHelper.getInstance().game;e.JoypadLeft&&(e.JoypadLeft.x=120,e.JoypadLeft.y=Constants.HEIGHT-55,e.JoypadRight.x=t.width-120,e.JoypadRight.y=Constants.HEIGHT-55,e.Touch()||e.HideJoypad())},e.HideJoypad=function(){e.JoypadLeft&&(e.JoypadLeft.visible=e.JoypadRight.visible=!1)},e.ShowJoypad=function(){e.JoypadLeft&&(e.JoypadLeft.visible=e.JoypadRight.visible=!0)},e.isTouchInitted=!1,e.isTouch=!1,e.JoypadLeft=null,e.JoypadRight=null,e.PadLeft=null,e.PadRight=null,e.CurtainContainer=null,e.LeftCurtain=null,e.RightCurtain=null,e}(),Input=function(){function e(){this.channels=new Array;for(var t=0;t<e.NUM_CHANNELS;t++)this.channels[t]={}}return e.getInstance=function(){return e.instance=null==e.instance?new e:e.instance},e.Init=function(){return e.instance=new e},e.prototype.addKeyAction=function(t,e,i){void 0===i&&(i=0);var n=PhaserGameHelper.getInstance().game;this.channels[i][t]=-1;e=n.input.keyboard.addKey(e);e.onDown.add(function(){this.channels[i][t]=Constants.frame},this),e.onUp.add(function(){this.channels[i][t]=-1},this)},e.prototype.setDoing=function(t,e,i){i?this.channels[t][e]<0&&(this.channels[t][e]=Constants.frame):this.channels[t][e]=-1},e.prototype.isDoing=function(t,e){return 0<=this.channels[e=void 0===e?0:e][t]},e.prototype.justDid=function(t,e){t=this.channels[e=void 0===e?0:e][t];return 0<=t&&Constants.frame-t==1},e.NUM_CHANNELS=20,e.instance=null,e}(),LevelParseSystem=function(){function c(){this._objectsList=[]}return c.prototype.parse=function(t){},c.prototype.parseFromJSON=function(t){var e,i,t=OzUtil.PE(Levels.data,null,"@level",""+t);this._map=t,this.parseTileset("tiles"),this.parseTileset("decor"),this.parseTileset("active"),this.parseTileset("passive"),t.imagelayer&&(e=t.imagelayer.image["@source"].split(".")[0].split("/").pop(),i=new MovieClip(e),this.createLevelObject(i)),OzUtil.PE(t,"objectgroup","@name","decorations")&&this.parseObjectGroup("decorations"),OzUtil.PE(t,"objectgroup","@name","active")&&this.parseObjectGroup("active"),OzUtil.PE(t,"objectgroup","@name","tiles")&&(e=null,(e=(i=OzUtil.PE(t,"objectgroup","@name","tiles").properties)?OzUtil.PE(i,"property","@name","physics"):e)?this.parseObjectGroup("tiles",!0):this.parseObjectGroup("tiles")),OzUtil.PE(t,"objectgroup","@name","physics")&&this.parseObjectGroup("physics"),OzUtil.PE(t,"objectgroup","@name","characters")&&this.parseObjectGroup("characters")},c.prototype.parseTileset=function(t){for(var t=OzUtil.PE(this._map,"tileset","@name",t),e=parseInt(t["@firstgid"]),i=0,n=OzUtil.ARR(t,"tile");i<n.length;i++){var r=n[i],o=r.image["@source"].split(".")[0];this._objectsList[parseInt(r["@id"])+e]=o.split("/").pop()}},c.prototype.parseObjectGroup=function(t,e){void 0===e&&(e=!1);var t=OzUtil.PE(this._map,"objectgroup","@name",t),i=null,t=OzUtil.ARR(t,"object");if(t)for(var n=0,r=t;n<r.length;n++){var o=r[n],s=parseInt(o["@gid"]),a=0!=(s&c.FLIPPED_HORIZONTALLY_MASK),h=0!=(s&c.FLIPPED_VERTICALLY_MASK);if(0==(s&=~(c.FLIPPED_HORIZONTALLY_MASK|c.FLIPPED_VERTICALLY_MASK)))new objects.FixedBox2(o["@x"],o["@y"],o["@width"],o["@height"]);else{s=this._objectsList[s];(i=new MovieClip(s="MoneyBagGraphics"==s?"BurgerGraphics":s)).x=o["@x"],i.y=o["@y"],a&&(i.params.flippedHorizontally=!0),h&&(i.params.flippedVertically=!0);h=o["@rotation"];h&&(i.degrees=parseFloat(h)),(u=o["@name"])&&(i.name=u);h=o["@type"];h&&(i.params.type=h);o=o.properties;if(o)for(var l=0,p=OzUtil.ARR(o,"property");l<p.length;l++){var u,d=p[l];"target"==(u=d["@name"])?i.params.target=d["@value"]:"target2"==u?i.params.target2=d["@value"]:"target3"==u?i.params.target3=d["@value"]:"speedX"==u?i.params.speedX=d["@value"]:"speedY"==u?i.params.speedY=d["@value"]:"distanceX"==u?i.params.distanceX=d["@value"]:"distanceY"==u?i.params.distanceY=d["@value"]:"limitRight"==u?i.params.limitRight=d["@value"]:"limitLeft"==u?i.params.limitLeft=d["@value"]:"minAngle"==u?i.params.minAngle=d["@value"]:"maxAngle"==u?i.params.maxAngle=d["@value"]:"delay"==u?i.params.delay=d["@value"]:"text"==u&&(i.params.name=d["@value"])}e&&new objects.Tile(i),this.createLevelObject(i)}}},c.prototype.createLevelObject=function(t){var e=t.mc;0<=["Guardian2Graphics"].indexOf(e)?new objects.Cop(t):0<=["DogGraphics"].indexOf(e)?new objects.Dog(t):0<=["HustlerGraphics"].indexOf(e)?new objects.Cop(t):0<=["BlockGraphics"].indexOf(e)?new objects.FixedBox(t):0<=["DoorGraphics","GlassDoorGraphics"].indexOf(e)?new objects.Door(t):0<=["BoxGraphics"].indexOf(e)?new objects.Box(t):0<=["MirrorGraphics"].indexOf(e)?new objects.Mirror(t):0<=["PlankGraphics","Plank2Graphics","Plank3Graphics","Plank4Graphics","Plank5Graphics","Plank6Graphics","Plank7Graphics","Plank8Graphics","Plank9Graphics","Plank10Graphics","Plank11Graphics","BigPlankGraphics"].indexOf(e)?new objects.Plank(t):0<=["BurgerGraphics"].indexOf(e)?new objects.Burger(t):0<=["BasketBall"].indexOf(e)?new objects.Stool(t):0<=["ToiletGraphics"].indexOf(e)?new objects.Toilet(t):0<=["MonitorGraphics"].indexOf(e)?new objects.Monitor(t):0<=["BasketBallGraphics"].indexOf(e)?new objects.BasketBall(t):0<=["BigBoxGraphics"].indexOf(e)?new objects.BigBox(t):0<=["PushButtonGraphics"].indexOf(e)?new objects.PushButton(t):0<=["TriggerGraphics"].indexOf(e)?new objects.Trigger(t):0<=["ElevatorGraphics","BigElevatorGraphics"].indexOf(e)?new objects.Elevator(t):0<=["TurrelGraphics"].indexOf(e)?new objects.Turrel(t):0<=["CameraGraphics"].indexOf(e)?new objects.Camera(t):0<=["EnemyLimiterGraphics"].indexOf(e)?new objects.EnemyLimiter(t):0<=["Prisoner2Graphics","PrisonerGraphics"].indexOf(e)?new objects.Prisoner(t):0<=["platformCenter","platformLeft","platformRight","singleTile","tileBottomCenter","tileBottomLeft","tileBottomRight","tileCenter","tileCenterLeft","tileCenterRight","tileTopCenter","tileTopLeft","tileTopRight","verticalPlatformBottom","verticalPlatformCenter","verticalPlatformTop"].indexOf(e)?new objects.TileVisual(t):"LevelTextGraphics"==e?new objects.LevelText(t):"TxtGraphics"==e?new objects.Txt(t):Constants.levelState.addObject(new objects.CitrusSprite("sprite",{view:t,x:+t.x,y:+t.y}))},c.FLIPPED_HORIZONTALLY_MASK=2147483648,c.FLIPPED_VERTICALLY_MASK=1073741824,c}(),NapeUtils=function(){function t(){}return t.CollisionGetOther=function(t,e){return(t==e.int1.userData.myData?e.int2:e.int1).userData.myData},t.CollisionGetSelf=function(t,e){return(t==e.int1.userData.myData?e.int1:e.int2).userData.myData},t}(),OzUtil=function(){function t(){}return t.PE=function(t,e,i,n){if(t)if(t instanceof Array){for(var r=0,o=t;r<o.length;r++)if((s=o[r])[i]==n)return s}else if(t instanceof Object){e=t[e];if(e instanceof Array){for(var s,a=0,h=e;a<h.length;a++)if((s=h[a])[i]==n)return s}else if(e instanceof Object&&e[i]==n)return t}return null},t.ARR=function(t,e){if(void 0===e&&(e=null),t instanceof Array)return t;if(t instanceof Object){e=t[e];if(e instanceof Array)return e;if(e instanceof Object)return[e]}return null},t.verticesArrayToVec2=function(t){for(var e=new Array,i=0,n=t;i<n.length;i++){var r=n[i];e.push(new Vec2(r[0],r[1]))}return e},t.GetURL=function(t){window.op3n(t,"_blank")},t}(),PhaserGameHelper=function(){function t(){}return t.prototype.init=function(t){this.game=t},t.getInstance=function(){return t.instance=null==t.instance?new t:t.instance},t.instance=null,t}(),SoundManager=function(){function r(){}return r.AddSound=function(t,e){PhaserGameHelper.getInstance().game.load.audio(t,["assets/sound/"+t+".mp3","assets/sound/"+t+".ogg"]),this.dicSounds[t]={},e.music?this.dicSounds[t].music=!0:this.dicSounds[t].music=!1,10<e.loops?this.dicSounds[t].loops=!0:this.dicSounds[t].loops=!1,e.volume?this.dicSounds[t].volume=e.volume:this.dicSounds[t].volume=1,r.NumSounds++},r.Init=function(){r.AllDecoded=!1,r.NumSounds=0,r.muteMusic=!1,r.muteSound=!1,r.curMusic=null,r.arrSounds=new Array},r.decodeSounds=function(){var e=PhaserGameHelper.getInstance().game;Object.keys(r.dicSounds).forEach(function(t){r.dicSounds[t].sound=e.add.audio(t)})},r.Preload=function(){r.AddSound("GameMusic",{music:!0,loops:9999,volume:.45}),r.AddSound("MenuMusic",{music:!0,loops:9999,volume:.65}),r.AddSound("MouseClickSound",{}),r.AddSound("MouseOverSound",{volume:.6}),r.AddSound("ExitSound",{}),r.AddSound("LevelCompleteAnimationSound",{}),r.AddSound("LevelWinSound",{}),r.AddSound("LevelFailedSound",{}),r.AddSound("BoxDownSound",{volume:.6}),r.AddSound("PlankDownSound",{}),r.AddSound("Hamburger1Sound",{}),r.AddSound("Hamburger2Sound",{}),r.AddSound("Hamburger3Sound",{}),r.AddSound("GetHamburger1Sound",{}),r.AddSound("GetHamburger2Sound",{}),r.AddSound("GetHamburger3Sound",{}),r.AddSound("BrickWallOpenSound",{}),r.AddSound("BrickWallCloseSound",{}),r.AddSound("WaterSound",{}),r.AddSound("YellowCameraSound",{}),r.AddSound("RedCameraSound",{}),r.AddSound("OpenDoorSound",{volume:1}),r.AddSound("ElevatorSound",{loops:9999,volume:.4}),r.AddSound("TriggerSound",{}),r.AddSound("PushButtonSound",{}),r.AddSound("AttackSound",{}),r.AddSound("StoolDownSound",{}),r.AddSound("TurrelFireSound",{volume:.7}),r.AddSound("RicochetSound",{volume:.7}),r.AddSound("Comix1Sound",{}),r.AddSound("Comix2Sound",{}),r.AddSound("Comix3Sound",{}),r.AddSound("Comix4Sound",{}),r.AddSound("Comix5Sound",{}),r.AddSound("Comix6Sound",{}),r.AddSound("Comix7Sound",{}),r.AddSound("Comix8Sound",{}),r.AddSound("Comix9Sound",{}),r.AddSound("Comix10Sound",{}),r.AddSound("Comix11Sound",{}),r.AddSound("AchievementUnlockedSound",{}),r.AddSound("DogJumpSound",{}),r.AddSound("DogStepSound",{volume:1}),r.AddSound("DogBarkSound",{volume:.5}),r.AddSound("DogIdle2Sound",{}),r.AddSound("DogIdle1Sound",{}),r.AddSound("HustlerJumpSound",{}),r.AddSound("HustlerStepSound",{volume:.5}),r.AddSound("HustlerPushSound",{volume:.5}),r.AddSound("CopIdle1Sound",{}),r.AddSound("CopIdle2Sound",{}),r.AddSound("HandcuffSound",{volume:.5}),r.AddSound("GuardianStepSound",{volume:.5}),r.AddSound("GuardianRunSound",{volume:.5}),r.AddSound("GuardianHurtSound",{}),r.AddSound("GuardianStarsSound",{})},r.getInstance=function(){return r.instance=null==r.instance?new r:r.instance},r.prototype.stopMusic=function(){},r.prototype.playSound=function(t){var e,i=r.dicSounds[t];i&&(i.music?(!r.playingMusic||r.playingMusic==t||(e=r.dicSounds[r.playingMusic]).sound&&e.sound.stop(),r.curMusic!=t&&t&&(r.muteMusic?r.playingMusic=null:(r._playSound(t,i.volume,i.loops),r.playingMusic=t),r.curMusic=t)):r.muteSound||(this.isPlaying(t)&&this.stopSound(t),r._playSound(t,i.volume,i.loops)))},r.prototype.stopSound=function(t){var e=r.dicSounds[t];e&&(e.sound.stop(),r.playingMusic==t&&(r.playingMusic=null))},r.prototype.isPlaying=function(t){t=r.dicSounds[t];return!(!t||!t.sound)&&t.sound.isPlaying},r.ToggleMuteMusic=function(){var t;r.muteMusic=!r.muteMusic,SaveDataManager.getInstance().isMusicOff=r.muteMusic,r.muteMusic?r.playingMusic&&(t=r.dicSounds[r.playingMusic]).sound&&t.sound.pause():r.curMusic&&(r.playingMusic?(t=r.dicSounds[r.playingMusic]).sound&&t.sound.resume():(t=r.dicSounds[r.curMusic],r._playSound(r.curMusic,t.volume,t.loops),r.playingMusic=r.curMusic))},r._playSound=function(t,e,i){var n=r.dicSounds[t].sound;i?(n.loopFull(e),n.onLoop.getNumListeners()<1&&n.onLoop.add(r._loopSound,r,0,t,e)):n.play("",0,e)},r._loopSound=function(t,e,i){t.loopFull(i)},r.ToggleMuteSound=function(){if(r.muteSound=!r.muteSound,SaveDataManager.getInstance().isSfxOff=r.muteSound,r.muteSound)for(var t in r.dicSounds){var t=r.dicSounds[t];t.music||(t=t.sound)&&t.isPlaying&&t.stop()}},r.setAudioStatus=function(){r.muteSound=SaveDataManager.getInstance().isSfxOff,r.muteMusic=SaveDataManager.getInstance().isMusicOff},r.instance=null,r.dicSounds={},r}(),StateSwitchSystem=function(){function t(){this.game=PhaserGameHelper.getInstance().game,this._ce=CitrusEngine.getInstance(),this._isSwitchingState=!1}return t.prototype.delayLevelCompleteAnimationSound=function(){SoundManager.getInstance().playSound("LevelCompleteAnimationSound")},t.prototype.delayLevelWinSound=function(){SoundManager.getInstance().playSound("LevelWinSound")},t.prototype.delayHamburger1Sound=function(){SoundManager.getInstance().playSound("Hamburger1Sound")},t.prototype.delayHamburger2Sound=function(){SoundManager.getInstance().playSound("Hamburger2Sound")},t.prototype.delayHamburger3Sound=function(){SoundManager.getInstance().playSound("Hamburger3Sound")},t.prototype.switchToLevelCompleted=function(){Constants.stateSwitcher._isSwitchingState||(Constants.stateSwitcher._isSwitchingState=!0,this.closeCurtains(this.requestReview))},t.prototype.requestReview=function(){var e=this,i=function(){azIntRatings.Wrapper.canReview().then(function(t){t.value?(azIntRatings.Wrapper.requestReview(),e.showWin()):"NO_AUTH"===t.reason?(SaveDataManager.getInstance().isReviewed?e.showWin():(SaveDataManager.getInstance().isReviewed=!0,azIntLoginPrompt.Manager.updateLoginText(Fabrique.LocalizationHandler.getInstance().getValue("loginRateResult")),azIntLoginPrompt.Manager.setConfirmCallback(function(){window._YaSDK.auth.openAuthDialog().then(function(){i()}).catch(function(t){e.showWin()})}),azIntLoginPrompt.Manager.setCancelCallback(function(){e.showWin()}),azIntLoginPrompt.Manager.showPopUp()),azIntRatings.Wrapper.setReviewed(!0)):e.showWin()})};5!==Constants.currentLevel||azIntRatings.Wrapper.getReviewed()?this.showWin():i()},t.prototype.showWin=function(){this.winSprite=new MovieClip("cmcYouWin"),GameController.CurtainContainer.addChild(this.winSprite),this.winSprite.addChild(new MovieClip("cmcCopWin",414,275,"winnerCop","WinningObjects",null)),this.winSprite.addChild(new MovieClip("cmcDogWin",414,275,"winnerDog","WinningObjects",null)),this.winSprite.removeChild(this.winSprite.getChild("levelCompleted")),this.levelCompleted=new Phaser.Sprite(this.game,.5*Constants.WIDTH,.13*Constants.HEIGHT,"mm3_button","titlebox_large.png"),this.levelCompleted.anchor.set(.5),this.winSprite.addChild(this.levelCompleted);var t=Fabrique.LocalizationHandler.getInstance().getValue("completed"),e=new objects.StyledTranslatedText(this.game,.5*Constants.WIDTH,.17*Constants.HEIGHT,t,36);this.winSprite.addChild(e),e.onOver(),this.winSprite.removeChild(this.winSprite.getChild("levelsButton")),this.levelsBtn=new Phaser.Sprite(this.game,.2*Constants.WIDTH,.85*Constants.HEIGHT,"mm3_button","button_02.png"),this.levelsBtn.anchor.set(.5),this.winSprite.addChild(this.levelsBtn);t=Fabrique.LocalizationHandler.getInstance().getValue("map"),e=new objects.StyledTranslatedText(this.game,.2*Constants.WIDTH,.85*Constants.HEIGHT,t,18,this.goLevelSelectFromWin,this);this.winSprite.addChild(e),this.winSprite.removeChild(this.winSprite.getChild("replayButton")),this.replayBtn=new Phaser.Sprite(this.game,.48*Constants.WIDTH,.85*Constants.HEIGHT,"mm3_button","button_02.png"),this.replayBtn.anchor.set(.5),this.winSprite.addChild(this.replayBtn),t=Fabrique.LocalizationHandler.getInstance().getValue("replay");e=new objects.StyledTranslatedText(this.game,.48*Constants.WIDTH,.85*Constants.HEIGHT,t,18,this.goRestartFromWin,this);this.winSprite.addChild(e),this.winSprite.removeChild(this.winSprite.getChild("nextButton")),this.nextBtn=new Phaser.Sprite(this.game,.8*Constants.WIDTH,.85*Constants.HEIGHT,"mm3_button","button_02.png"),this.nextBtn.anchor.set(.5),this.winSprite.addChild(this.nextBtn),t=Fabrique.LocalizationHandler.getInstance().getValue("next");t=new objects.StyledTranslatedText(this.game,.8*Constants.WIDTH,.85*Constants.HEIGHT,t,15,this.goNextFromWin,this);this.winSprite.addChild(t),Constants.currentLevel>=Constants.NUMLEVELS-1&&(this.nextBtn.visible=!1,t.visible=!1,this.replayBtn.x=this.nextBtn.x,e.x=t.x),this.winSprite.getChild("burgerBG").visible=!1,this.winSprite.getChild("b1").visible=!1,this.winSprite.getChild("b2").visible=!1,this.winSprite.getChild("b3").visible=!1,h5branding.Branding.outGoingLinksAllowed()&&(this.brandingLogo=this.game.add.button(220,320,h5branding.Branding.LOGO_KEY,function(){h5branding.Branding.openCampaignLink(Constants.GOOGLE_APP_NAME,h5branding.UtmTargets.logo)}),this.winSprite.addChild(this.brandingLogo)),this.winSprite.getChild("winnerCop").addAnimation("win",1,23,27,!1,this.showWin2,this),this.winSprite.getChild("winnerDog").addAnimation("win",1,23,27,!1),this.winSprite.getChild("winnerCop").playAnimation("win"),this.winSprite.getChild("winnerDog").playAnimation("win"),this.delayLevelCompleteAnimationSound(),TweenMax.delayedCall(1.8,this.delayLevelWinSound,this)},t.prototype.showWin2=function(){var t=this.winSprite.getChild("burgerBG"),e=this.winSprite.getChild("b1"),i=this.winSprite.getChild("b2"),n=this.winSprite.getChild("b3");t.visible=!0,t.scaleX=t.scaleY=0,TweenMax.to(t,.2,{scaleX:1,scaleY:1,ease:"Back.easeOut"}),(21==Constants.currentLevel&&26<Constants.levelState.burgers||Constants.currentLevel<21&&0<Constants.levelState.burgers)&&(e.visible=!0,e.scaleX=e.scaleY=0,TweenMax.to(e,.4,{scaleX:1,scaleY:1,degrees:360,ease:"Back.easeOut"}),TweenMax.delayedCall(.05,this.delayHamburger1Sound,this)),(21==Constants.currentLevel&&54<Constants.levelState.burgers||Constants.currentLevel<21&&1<Constants.levelState.burgers)&&(i.visible=!0,i.scaleX=i.scaleY=0,TweenMax.to(i,.4,{scaleX:1,scaleY:1,degrees:360,ease:"Back.easeOut",delay:.15}),TweenMax.delayedCall(.2,this.delayHamburger2Sound,this)),(21==Constants.currentLevel&&79<Constants.levelState.burgers||Constants.currentLevel<21&&2<Constants.levelState.burgers)&&(n.visible=!0,n.scaleX=n.scaleY=0,TweenMax.to(n,.4,{scaleX:1,scaleY:1,degrees:360,ease:"Back.easeOut",delay:.3}),TweenMax.delayedCall(.35,this.delayHamburger3Sound,this)),this.winSprite.removeChild(this.winSprite.getChild("winnerCop")),this.winSprite.removeChild(this.winSprite.getChild("winnerDog")),this.winSprite.addChild(new MovieClip("cmcCopWin2",403,290,"winnerCop","WinningObjects",null)),this.winSprite.addChild(new MovieClip("cmcDogWin2",403,290,"winnerDog","WinningObjects",null)),this.winSprite.getChild("winnerCop").playLoop(),this.winSprite.getChild("winnerDog").playLoop(),TweenMax.to(this.winSprite.getChild("winnerCop"),.6,{x:218,ease:"Back.easeOut"}),TweenMax.to(this.winSprite.getChild("winnerDog"),.6,{x:544,ease:"Back.easeOut"})},t.prototype.goLevelSelectFromWin=function(){var t=this;Fabrique.AdHandler.getInstance().showAd("winToLevelSelect",function(){t.hideWin(t.directToLevelSelect)})},t.prototype.goRestartFromWin=function(){var t=this;Fabrique.AdHandler.getInstance().showAd("winRestart",function(){t.hideWin(t.directToPlay)})},t.prototype.goNextFromWin=function(){var t=this;Fabrique.AdHandler.getInstance().showAd("next_win",function(){Constants.currentLevel<=19?(Constants.currentLevel++,t.hideWin(t.directToPlay)):t.hideWin(t.directToLevelSelect)})},t.prototype.hideWin=function(t){var e,i,n;this.winSprite&&(TweenMax.to(this.winSprite.getChild("winnerCop"),.5,{x:21,ease:"Back.easeIn"}),TweenMax.to(this.winSprite.getChild("winnerDog"),.5,{x:760,ease:"Back.easeIn"}),this.winSprite.visible=!1,e=this.winSprite.getChild("b1"),i=this.winSprite.getChild("b2"),n=this.winSprite.getChild("b3"),TweenMax.to(e,.2,{scaleX:0,scaleY:0}),TweenMax.to(i,.2,{scaleX:0,scaleY:0,delay:.1}),TweenMax.to(n,.2,{scaleX:0,scaleY:0,delay:.2}),TweenMax.to(this.winSprite.getChild("burgerBG"),.2,{scaleX:0,scaleY:0,delay:.3}),TweenMax.delayedCall(.55,t,this))},t.prototype.removeWin=function(){this.winSprite&&(this.winSprite.visible=!1,GameController.CurtainContainer.removeChild(this.winSprite),this.winSprite=null)},t.prototype.switchToLose=function(){Constants.stateSwitcher._isSwitchingState||(Constants.stateSwitcher._isSwitchingState=!0,this.closeCurtains(this.showLose),SoundManager.getInstance().playSound("LevelFailedSound"))},t.prototype.showLose=function(){this.loseSprite=new MovieClip("cmcYouLose"),GameController.CurtainContainer.addChild(this.loseSprite),this.loseSprite.addChild(new MovieClip("cmcCopLose",-207,160,"loserCop","WinningObjects",null)),this.loseSprite.addChild(new MovieClip("cmcDogLose",742,188,"loserDog","WinningObjects",null)),this.loseSprite.removeChild(this.loseSprite.getChild("levelFailed")),this.levelFailed=new Phaser.Sprite(this.game,.5*Constants.WIDTH,.13*Constants.HEIGHT,"mm3_button","titlebox_large.png"),this.levelFailed.anchor.set(.5),this.loseSprite.addChild(this.levelFailed);var t=Fabrique.LocalizationHandler.getInstance().getValue("failed"),e=new objects.StyledTranslatedText(this.game,.5*Constants.WIDTH,.17*Constants.HEIGHT,t,36);this.loseSprite.addChild(e),e.onOver(),this.loseSprite.removeChild(this.loseSprite.getChild("levelsButton")),this.levelsBtn=new Phaser.Sprite(this.game,.2*Constants.WIDTH,.85*Constants.HEIGHT,"mm3_button","button_02.png"),this.levelsBtn.anchor.set(.5),this.loseSprite.addChild(this.levelsBtn);t=Fabrique.LocalizationHandler.getInstance().getValue("map"),e=new objects.StyledTranslatedText(this.game,.2*Constants.WIDTH,.85*Constants.HEIGHT,t,18,this.goLevelsFromLose,this);this.loseSprite.addChild(e),this.loseSprite.removeChild(this.loseSprite.getChild("replayButton")),this.replayBtn=new Phaser.Sprite(this.game,.48*Constants.WIDTH,.85*Constants.HEIGHT,"mm3_button","button_02.png"),this.replayBtn.anchor.set(.5),this.loseSprite.addChild(this.replayBtn),t=Fabrique.LocalizationHandler.getInstance().getValue("replay");t=new objects.StyledTranslatedText(this.game,.48*Constants.WIDTH,.85*Constants.HEIGHT,t,18,this.goRestartFromLose,this);this.loseSprite.addChild(t),this.loseSprite.getChild("walkthroughButton").visible=!1;TweenMax.to(this.loseSprite.getChild("loserCop"),.5,{x:8,ease:"Back.easeOut"}),TweenMax.to(this.loseSprite.getChild("loserDog"),.5,{x:512,ease:"Back.easeOut"}),TweenMax.to(this.loseSprite.getChild("walkthroughButton"),.5,{y:418,ease:"Back.easeOut"})},t.prototype.goRestartFromLose=function(){var t=this;Fabrique.AdHandler.getInstance().showAd("loseRestart",function(){t.hideLose(t.directToPlay)})},t.prototype.goLevelsFromLose=function(){var t=this;Fabrique.AdHandler.getInstance().showAd("loseToLevelSelect",function(){t.hideLose(t.directToLevelSelect)})},t.prototype.hideLose=function(t){this.loseSprite&&(TweenMax.to(this.loseSprite.getChild("loserCop"),.5,{x:-207,ease:"Back.easeIn"}),TweenMax.to(this.loseSprite.getChild("loserDog"),.5,{x:742,ease:"Back.easeIn"}),TweenMax.delayedCall(.55,t,this),this.loseSprite.visible=!1)},t.prototype.removeLoss=function(){void 0!==this.loseSprite&&null!==this.loseSprite&&(this.loseSprite.visible=!1,GameController.CurtainContainer.removeChild(this.loseSprite),this.loseSprite=null)},t.prototype.switchToAnimation=function(){Constants.stateSwitcher._isSwitchingState||(Constants.stateSwitcher._isSwitchingState=!0,this.closeCurtains(this.directToAnimation))},t.prototype.switchToMainMenu=function(){var t=this;Constants.stateSwitcher._isSwitchingState||(Constants.stateSwitcher._isSwitchingState=!0,Fabrique.AdHandler.getInstance().showAd("levelSelect",function(){t.closeCurtains(t.directToMainMenu)}))},t.prototype.switchToLevelSelect=function(){Constants.stateSwitcher._isSwitchingState||(Constants.stateSwitcher._isSwitchingState=!0,this.closeCurtains(this.directToLevelSelect))},t.prototype.switchToPlay=function(){Constants.stateSwitcher._isSwitchingState||(Constants.stateSwitcher._isSwitchingState=!0,this.closeCurtains(this.directToPlay))},t.prototype.directToPlay=function(){this.game.state.start("Level")},t.prototype.directToLevelSelect=function(){this.game.state.start("LevelSelect")},t.prototype.directToMainMenu=function(){this.game.state.start("MainMenu")},t.prototype.directToAnimation=function(){this.game.state.start("Animation")},t.prototype.closeCurtains=function(t){(t=void 0===t?null:t)!=this.directToPlay&&GameController.HideJoypad(),GameController.LeftCurtain.visible=GameController.RightCurtain.visible=!0,GameController.LeftCurtain.x=GameController.LEFT_CURTAIN_OPEN_X,GameController.RightCurtain.x=GameController.RIGHT_CURTAIN_OPEN_X,SoundManager.getInstance().playSound("BrickWallCloseSound"),TweenMax.to(GameController.LeftCurtain,.5,{x:0,ease:"Quad.easeOut"}),TweenMax.to(GameController.RightCurtain,.5,{x:Constants.WIDTH,onComplete:t,onCompleteContext:this,ease:"Quad.easeOut"})},t.prototype.openCurtains=function(t){TweenMax.delayedCall(t,this.delayBrickWallOpenSound,this),TweenMax.to(GameController.LeftCurtain,.5,{x:GameController.LEFT_CURTAIN_OPEN_X,ease:"Quad.easeIn",delay:t}),TweenMax.to(GameController.RightCurtain,.5,{x:GameController.RIGHT_CURTAIN_OPEN_X,ease:"Quad.easeIn",delay:t,onComplete:this.dispose})},t.prototype.delayBrickWallOpenSound=function(){SoundManager.getInstance().playSound("BrickWallOpenSound")},t.prototype.dispose=function(){GameController.LeftCurtain.visible=GameController.RightCurtain.visible=!1,Constants.stateSwitcher._isSwitchingState=!1},t}(),StorageHelper=function(){function e(){}return e.LS=function(t){return t+e.LocalStorageName},e.initCookies=function(){},e.readCookies=function(){e.clearProgress(),!e.storageAvailable||localStorage.getItem(e.LS("levelsComplete"))&&(Constants.levelsComplete=JSON.parse(localStorage.getItem(e.LS("levelsComplete")))||Constants.levelsComplete,Constants.burgers=JSON.parse(localStorage.getItem(e.LS("burgers")))||Constants.burgers,Constants.isIntroAnimationPlayed=JSON.parse(localStorage.getItem(e.LS("isIntroAnimationPlayed")))||Constants.isIntroAnimationPlayed,Constants.isFinalAnimationPlayed=JSON.parse(localStorage.getItem(e.LS("isFinalAnimationPlayed")))||Constants.isFinalAnimationPlayed)},e.saveCookies=function(){e.storageAvailable&&(localStorage.setItem(e.LS("levelsComplete"),JSON.stringify(Constants.levelsComplete)),localStorage.setItem(e.LS("burgers"),JSON.stringify(Constants.burgers)),localStorage.setItem(e.LS("isIntroAnimationPlayed"),JSON.stringify(Constants.isIntroAnimationPlayed)),localStorage.setItem(e.LS("isFinalAnimationPlayed"),JSON.stringify(Constants.isFinalAnimationPlayed)))},e.totalPoints=function(){for(var t=0,e=1;e<=Constants.NUMLEVELS;e++)t+=Constants.burgers[e];return t},e.clearProgress=function(){Constants.isIntroAnimationPlayed=!1,Constants.isFinalAnimationPlayed=!1,Constants.burgers=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],Constants.levelsComplete=[!0,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1]},e.isLocalStorageSupport=function(){try{if("object"==typeof localStorage)return localStorage.setItem("testingLocalStorage","foo"),localStorage.removeItem("testingLocalStorage"),!0}catch(t){return!1}return!1},e.LocalStorageName="DODGERS3_ozdy",e.storageAvailable=e.isLocalStorageSupport(),e}(),TaskManager=function(){function t(t){void 0===t&&(t=!1),this._tasks=[],this._pauseCount=0,this.isStarted=!1,this.isPaused=!1,this.cycle=t,this._tasks=new Array,this._pauseCount=0,this.isStarted=this.isPaused=this.result=!1}return Object.defineProperty(t.prototype,"currentTask",{get:function(){return 0<this._tasks.length?this._tasks[0].func:null},enumerable:!1,configurable:!0}),t.prototype.addTask=function(t,e,i,n){this._tasks.push({func:e,params:i=void 0===i?null:i,ignoreCycle:n=void 0===n?!1:n,context:t}),this.start()},t.prototype.addInstantTask=function(t,e,i,n){this._tasks.push({func:e,params:i=void 0===i?null:i,ignoreCycle:n=void 0===n?!1:n,isInstant:!0,context:t}),this.start()},t.prototype.addUrgentTask=function(t,e,i,n){this._tasks.unshift({func:e,params:i=void 0===i?null:i,ignoreCycle:n=void 0===n?!1:n,context:t}),this.start()},t.prototype.addUrgentInstantTask=function(t,e,i,n){this._tasks.unshift({func:e,params:i=void 0===i?null:i,ignoreCycle:n=void 0===n?!1:n,isInstant:!0,context:t}),this.start()},t.prototype.addPause=function(t,e){this.addTask(this,this.timerFrame,[t],e=void 0===e?!1:e)},t.prototype.timerFrame=function(t){this._pauseCount++,this._pauseCount>=t&&(this._pauseCount=0,this.nextTask())},t.prototype.removeAllTasks=function(){this._tasks=new Array},t.prototype.nextTask=function(t){void 0===t&&(t=!1),this.cycle&&!t?this._tasks.push(this._tasks.shift()):this._tasks.shift()},t.prototype.start=function(){this.isStarted||(this.isStarted=!0,this.isPaused=!1)},t.prototype.stop=function(){this.isStarted=!1},t.prototype.update=function(){var t=this._tasks[0];t?(this.result=t.func.call(t.context,t.params),t==this._tasks[0]&&(t.isInstant||this.result)&&this.nextTask(t.ignoreCycle)):stop()},Object.defineProperty(t.prototype,"pause",{get:function(){return this.isPaused},set:function(t){t&&!this.isPaused?this.isPaused=!0:this._tasks[0]&&this.isPaused&&(this.isPaused=!1)},enumerable:!1,configurable:!0}),t.prototype.tasksNum=function(){return this._tasks.length},t.ALL_TASKS_DONE="allTasksDone",t}(),TopPanel=function(){function t(){this.game=PhaserGameHelper.getInstance().game,21==Constants.currentLevel?this._view=new MovieClip("TopPanelBonusGraphics"):this._view=new MovieClip("TopPanelGraphics"),this.game.world.addChild(this._view)}return t.prototype.depressButtons=function(){this._view.getChild("musicButton").changeFrame1(),this._view.getChild("soundButton").changeFrame1(),this._view.getChild("replayButton").changeFrame1(),this._view.getChild("menuButton").changeFrame1(),this._view.getChild("walkthroughButton").changeFrame1()},t.prototype.disableInput=function(){this._view.getChild("musicButton").inputEnabled=!1,this._view.getChild("soundButton").inputEnabled=!1,this._view.getChild("replayButton").inputEnabled=!1,this._view.getChild("menuButton").inputEnabled=!1,this._view.getChild("walkthroughButton").inputEnabled=!1,TweenMax.delayedCall(.1,this.depressButtons,this)},t.prototype.enableInput=function(){this._view.getChild("musicButton").inputEnabled=!0,this._view.getChild("soundButton").inputEnabled=!0,this._view.getChild("replayButton").inputEnabled=!0,this._view.getChild("menuButton").inputEnabled=!0,this._view.getChild("walkthroughButton").inputEnabled=!0},t.prototype.init=function(){var t,e,i,n;GameController.Touch()&&(this._view.changeChildByName("musicButton","BigMusicMenuButton","PreloaderObjects",PreloaderObjectsLayouts.data),this._view.changeChildByName("soundButton","BigSoundButtonGraphics","PreloaderObjects",PreloaderObjectsLayouts.data),this._view.changeChildByName("replayButton","BigReplayButtonGraphics","PreloaderObjects",PreloaderObjectsLayouts.data),this._view.changeChildByName("menuButton","BigMenuButtonGraphics","PreloaderObjects",PreloaderObjectsLayouts.data),t=this._view.getChild("musicButton"),e=this._view.getChild("soundButton"),i=this._view.getChild("replayButton"),n=this._view.getChild("menuButton"),t.x=647,t.y=3,e.x=594,e.y=3,i.x=541,i.y=3,n.x=488,n.y=3),21==Constants.currentLevel?(this._secondsLeft=45,this._maxBonusHearts=Constants.levelState.getObjectsByName("burger").length,this.heartsText=this.game.add.text(0,0,"Level "+Constants.currentLevel+":",{font:"26px sc_gum_kidsregular",fill:"#FFFFFF",boundsAlignH:"center",boundsAlignV:"middle"}),this.heartsText.stroke="#4F2E1F",this.heartsText.strokeThickness=4,this.heartsText.setTextBounds(31,6,105,38),this.heartsText.text="00 / "+String(this._maxBonusHearts),this._view.addChild(this.heartsText),this.timerText1=this.game.add.text(0,0,"Level "+Constants.currentLevel+":",{font:"28px sc_gum_kidsregular",fill:"#FFFF00",boundsAlignH:"right",boundsAlignV:"middle"}),this.timerText1.stroke="#4F2E1F",this.timerText1.strokeThickness=4,this.timerText1.setTextBounds(301,221,50,41),this.timerText1.text="30.",this._view.addChild(this.timerText1),this.timerText2=this.game.add.text(0,0,"Level "+Constants.currentLevel+":",{font:"20px sc_gum_kidsregular",fill:"#FFFF00",boundsAlignH:"left",boundsAlignV:"middle"}),this.timerText2.stroke="#4F2E1F",this.timerText2.strokeThickness=4,this.timerText2.setTextBounds(348,230,48,30),this.timerText2.text="00",this._view.addChild(this.timerText2),this._lastTime=this.game.time.totalElapsedSeconds()):(this._view.getChild("b1").scaleX=this._view.getChild("b1").scaleY=0,this._view.getChild("b2").scaleX=this._view.getChild("b2").scaleY=0,this._view.getChild("b3").scaleX=this._view.getChild("b3").scaleY=0)},t.prototype.tick=function(){if(21==Constants.currentLevel){var t=this.game.time.totalElapsedSeconds();this._secondsLeft-=t-this._lastTime,this._secondsLeft=Math.max(0,this._secondsLeft),this._lastTime=t;t=String(Math.floor(this._secondsLeft))+".";this.timerText1.text=t;for(var e=String(this._secondsLeft-Math.floor(this._secondsLeft)).substr(2,2);e.length<2;)e="0"+e;this.timerText2.text=e,0<this._secondsLeft||Constants.levelState.failLevel()}},t.prototype.getHeartX=function(){return 21==Constants.currentLevel?60:(0==Constants.levelState.burgers?this._view.getChild("b1"):1==Constants.levelState.burgers?this._view.getChild("b2"):this._view.getChild("b3")).x},t.prototype.getHeartY=function(){return 21==Constants.currentLevel?19:this._view.getChild("b1").y},t.prototype.collectBurger=function(t){var e=new MovieClip("BurgerSmallGraphics");e.x=t.x,e.y=t.y,this._view.addChild(e),TweenMax.to(e,.6,{x:this.getHeartX(),y:this.getHeartY(),rotation:360,onComplete:function(){e&&e.parent&&e.parent.removeChild(e);{var t;21==Constants.currentLevel?((t=String(i)).length<2&&(t="0"+t),Constants.levelState.topPanel.heartsText.text=t+" / "+String(Constants.levelState.topPanel._maxBonusHearts)):(t=Constants.levelState.topPanel._view,1==i?t.getChild("b1").scaleX=t.getChild("b1").scaleY=1:2==i?t.getChild("b2").scaleX=t.getChild("b2").scaleY=1:3==i&&(t.getChild("b3").scaleX=t.getChild("b3").scaleY=1))}}}),Constants.levelState.burgers++,t.kill=!0,1==Constants.levelState.burgers?SoundManager.getInstance().playSound("GetHamburger1Sound"):2==Constants.levelState.burgers?SoundManager.getInstance().playSound("GetHamburger2Sound"):SoundManager.getInstance().playSound("GetHamburger3Sound");var i=Constants.levelState.burgers},t.prototype.dispose=function(){},t}();