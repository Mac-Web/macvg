(function(R){var k=k||function(l){function g(){}var u={},p=u.lib={},a=p.Base={extend:function(e){g.prototype=this;var n=new g;return e&&n.mixIn(e),n.hasOwnProperty("init")||(n.init=function(){n.$super.init.apply(this,arguments)}),(n.init.prototype=n).$super=this,n},create:function(){var e=this.extend();return e.init.apply(e,arguments),e},init:function(){},mixIn:function(e){for(var n in e)e.hasOwnProperty(n)&&(this[n]=e[n]);e.hasOwnProperty("toString")&&(this.toString=e.toString)},clone:function(){return this.init.prototype.extend(this)}},r=p.WordArray=a.extend({init:function(e,n){e=this.words=e||[],this.sigBytes=n!=null?n:4*e.length},toString:function(e){return(e||f).stringify(this)},concat:function(e){var n=this.words,s=e.words,c=this.sigBytes;if(e=e.sigBytes,this.clamp(),c%4)for(var v=0;v<e;v++)n[c+v>>>2]|=(s[v>>>2]>>>24-v%4*8&255)<<24-(c+v)%4*8;else if(65535<s.length)for(v=0;v<e;v+=4)n[c+v>>>2]=s[v>>>2];else n.push.apply(n,s);return this.sigBytes+=e,this},clamp:function(){var e=this.words,n=this.sigBytes;e[n>>>2]&=4294967295<<32-n%4*8,e.length=l.ceil(n/4)},clone:function(){var e=a.clone.call(this);return e.words=this.words.slice(0),e},random:function(e){for(var n=[],s=0;s<e;s+=4)n.push(4294967296*l.random()|0);return new r.init(n,e)}}),o=u.enc={},f=o.Hex={stringify:function(e){var n=e.words;e=e.sigBytes;for(var s=[],c=0;c<e;c++){var v=n[c>>>2]>>>24-c%4*8&255;s.push((v>>>4).toString(16)),s.push((15&v).toString(16))}return s.join("")},parse:function(e){for(var n=e.length,s=[],c=0;c<n;c+=2)s[c>>>3]|=parseInt(e.substr(c,2),16)<<24-c%8*4;return new r.init(s,n/2)}},d=o.Latin1={stringify:function(e){var n=e.words;e=e.sigBytes;for(var s=[],c=0;c<e;c++)s.push(String.fromCharCode(n[c>>>2]>>>24-c%4*8&255));return s.join("")},parse:function(e){for(var n=e.length,s=[],c=0;c<n;c++)s[c>>>2]|=(255&e.charCodeAt(c))<<24-c%4*8;return new r.init(s,n)}},E=o.Utf8={stringify:function(e){try{return decodeURIComponent(escape(d.stringify(e)))}catch(n){throw Error("Malformed UTF-8 data")}},parse:function(e){return d.parse(unescape(encodeURIComponent(e)))}},t=p.BufferedBlockAlgorithm=a.extend({reset:function(){this._data=new r.init,this._nDataBytes=0},_append:function(e){typeof e=="string"&&(e=E.parse(e)),this._data.concat(e),this._nDataBytes+=e.sigBytes},_process:function(e){var n=this._data,s=n.words,c=n.sigBytes,v=this.blockSize,m=c/(4*v);if(e=(m=e?l.ceil(m):l.max((0|m)-this._minBufferSize,0))*v,c=l.min(4*e,c),e){for(var A=0;A<e;A+=v)this._doProcessBlock(s,A);A=s.splice(0,e),n.sigBytes-=c}return new r.init(A,c)},clone:function(){var e=a.clone.call(this);return e._data=this._data.clone(),e},_minBufferSize:0});p.Hasher=t.extend({cfg:a.extend(),init:function(e){this.cfg=this.cfg.extend(e),this.reset()},reset:function(){t.reset.call(this),this._doReset()},update:function(e){return this._append(e),this._process(),this},finalize:function(e){return e&&this._append(e),this._doFinalize()},blockSize:16,_createHelper:function(e){return function(n,s){return new e.init(s).finalize(n)}},_createHmacHelper:function(e){return function(n,s){return new i.HMAC.init(e,s).finalize(n)}}});var i=u.algo={};return u}(Math);(function(l){function g(s){return 4294967296*(s-(0|s))|0}for(var u=k,p=(r=u.lib).WordArray,a=r.Hasher,r=u.algo,o=[],f=[],d=2,E=0;E<64;){var t;e:{t=d;for(var i=l.sqrt(t),e=2;e<=i;e++)if(!(t%e)){t=!1;break e}t=!0}t&&(E<8&&(o[E]=g(l.pow(d,.5))),f[E]=g(l.pow(d,1/3)),E++),d++}var n=[];r=r.SHA256=a.extend({_doReset:function(){this._hash=new p.init(o.slice(0))},_doProcessBlock:function(s,c){for(var v=this._hash.words,m=v[0],A=v[1],S=v[2],h=v[3],y=v[4],C=v[5],T=v[6],G=v[7],I=0;I<64;I++){if(I<16)n[I]=0|s[c+I];else{var _=n[I-15],w=n[I-2];n[I]=((_<<25|_>>>7)^(_<<14|_>>>18)^_>>>3)+n[I-7]+((w<<15|w>>>17)^(w<<13|w>>>19)^w>>>10)+n[I-16]}_=G+((y<<26|y>>>6)^(y<<21|y>>>11)^(y<<7|y>>>25))+(y&C^~y&T)+f[I]+n[I],w=((m<<30|m>>>2)^(m<<19|m>>>13)^(m<<10|m>>>22))+(m&A^m&S^A&S),G=T,T=C,C=y,y=h+_|0,h=S,S=A,A=m,m=_+w|0}v[0]=v[0]+m|0,v[1]=v[1]+A|0,v[2]=v[2]+S|0,v[3]=v[3]+h|0,v[4]=v[4]+y|0,v[5]=v[5]+C|0,v[6]=v[6]+T|0,v[7]=v[7]+G|0},_doFinalize:function(){var s=this._data,c=s.words,v=8*this._nDataBytes,m=8*s.sigBytes;return c[m>>>5]|=128<<24-m%32,c[14+(64+m>>>9<<4)]=l.floor(v/4294967296),c[15+(64+m>>>9<<4)]=v,s.sigBytes=4*c.length,this._process(),this._hash},clone:function(){var s=a.clone.call(this);return s._hash=this._hash.clone(),s}}),u.SHA256=a._createHelper(r),u.HmacSHA256=a._createHmacHelper(r)})(Math),function(){var l=k.enc.Utf8;k.algo.HMAC=k.lib.Base.extend({init:function(g,u){g=this._hasher=new g.init,typeof u=="string"&&(u=l.parse(u));var p=g.blockSize,a=4*p;u.sigBytes>a&&(u=g.finalize(u)),u.clamp();for(var r=this._oKey=u.clone(),o=this._iKey=u.clone(),f=r.words,d=o.words,E=0;E<p;E++)f[E]^=1549556828,d[E]^=909522486;r.sigBytes=o.sigBytes=a,this.reset()},reset:function(){var g=this._hasher;g.reset(),g.update(this._iKey)},update:function(g){return this._hasher.update(g),this},finalize:function(g){var u=this._hasher;return g=u.finalize(g),u.reset(),u.finalize(this._oKey.clone().concat(g))}})}(),function(){var l=k.lib.WordArray;k.enc.Base64={stringify:function(g){var u=g.words,p=g.sigBytes,a=this._map;g.clamp(),g=[];for(var r=0;r<p;r+=3)for(var o=(u[r>>>2]>>>24-r%4*8&255)<<16|(u[r+1>>>2]>>>24-(r+1)%4*8&255)<<8|u[r+2>>>2]>>>24-(r+2)%4*8&255,f=0;f<4&&r+.75*f<p;f++)g.push(a.charAt(o>>>6*(3-f)&63));if(u=a.charAt(64))for(;g.length%4;)g.push(u);return g.join("")},parse:function(g){var u=g.length,p=this._map;!(a=p.charAt(64))||(a=g.indexOf(a))!=-1&&(u=a);for(var a=[],r=0,o=0;o<u;o++)if(o%4){var f=p.indexOf(g.charAt(o-1))<<o%4*2,d=p.indexOf(g.charAt(o))>>>6-o%4*2;a[r>>>2]|=(f|d)<<24-r%4*8,r++}return l.create(a,r)},_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="}}(),function(l){var g,u,p,a,r,o,f,d,E,t,i,e,n;(g=l.EGAErrorSeverity||(l.EGAErrorSeverity={}))[g.Undefined=0]="Undefined",g[g.Debug=1]="Debug",g[g.Info=2]="Info",g[g.Warning=3]="Warning",g[g.Error=4]="Error",g[g.Critical=5]="Critical",(u=l.EGAProgressionStatus||(l.EGAProgressionStatus={}))[u.Undefined=0]="Undefined",u[u.Start=1]="Start",u[u.Complete=2]="Complete",u[u.Fail=3]="Fail",(p=l.EGAResourceFlowType||(l.EGAResourceFlowType={}))[p.Undefined=0]="Undefined",p[p.Source=1]="Source",p[p.Sink=2]="Sink",(a=l.EGAAdAction||(l.EGAAdAction={}))[a.Undefined=0]="Undefined",a[a.Clicked=1]="Clicked",a[a.Show=2]="Show",a[a.FailedShow=3]="FailedShow",a[a.RewardReceived=4]="RewardReceived",(r=l.EGAAdError||(l.EGAAdError={}))[r.Undefined=0]="Undefined",r[r.Unknown=1]="Unknown",r[r.Offline=2]="Offline",r[r.NoFill=3]="NoFill",r[r.InternalError=4]="InternalError",r[r.InvalidRequest=5]="InvalidRequest",r[r.UnableToPrecache=6]="UnableToPrecache",(o=l.EGAAdType||(l.EGAAdType={}))[o.Undefined=0]="Undefined",o[o.Video=1]="Video",o[o.RewardedVideo=2]="RewardedVideo",o[o.Playable=3]="Playable",o[o.Interstitial=4]="Interstitial",o[o.OfferWall=5]="OfferWall",o[o.Banner=6]="Banner",f=l.http||(l.http={}),(d=f.EGAHTTPApiResponse||(f.EGAHTTPApiResponse={}))[d.NoResponse=0]="NoResponse",d[d.BadResponse=1]="BadResponse",d[d.RequestTimeout=2]="RequestTimeout",d[d.JsonEncodeFailed=3]="JsonEncodeFailed",d[d.JsonDecodeFailed=4]="JsonDecodeFailed",d[d.InternalServerError=5]="InternalServerError",d[d.BadRequest=6]="BadRequest",d[d.Unauthorized=7]="Unauthorized",d[d.UnknownResponseCode=8]="UnknownResponseCode",d[d.Ok=9]="Ok",d[d.Created=10]="Created",E=l.events||(l.events={}),(t=E.EGASdkErrorCategory||(E.EGASdkErrorCategory={}))[t.Undefined=0]="Undefined",t[t.EventValidation=1]="EventValidation",t[t.Database=2]="Database",t[t.Init=3]="Init",t[t.Http=4]="Http",t[t.Json=5]="Json",(i=E.EGASdkErrorArea||(E.EGASdkErrorArea={}))[i.Undefined=0]="Undefined",i[i.BusinessEvent=1]="BusinessEvent",i[i.ResourceEvent=2]="ResourceEvent",i[i.ProgressionEvent=3]="ProgressionEvent",i[i.DesignEvent=4]="DesignEvent",i[i.ErrorEvent=5]="ErrorEvent",i[i.InitHttp=9]="InitHttp",i[i.EventsHttp=10]="EventsHttp",i[i.ProcessEvents=11]="ProcessEvents",i[i.AddEventsToStore=12]="AddEventsToStore",i[i.AdEvent=20]="AdEvent",(e=E.EGASdkErrorAction||(E.EGASdkErrorAction={}))[e.Undefined=0]="Undefined",e[e.InvalidCurrency=1]="InvalidCurrency",e[e.InvalidShortString=2]="InvalidShortString",e[e.InvalidEventPartLength=3]="InvalidEventPartLength",e[e.InvalidEventPartCharacters=4]="InvalidEventPartCharacters",e[e.InvalidStore=5]="InvalidStore",e[e.InvalidFlowType=6]="InvalidFlowType",e[e.StringEmptyOrNull=7]="StringEmptyOrNull",e[e.NotFoundInAvailableCurrencies=8]="NotFoundInAvailableCurrencies",e[e.InvalidAmount=9]="InvalidAmount",e[e.NotFoundInAvailableItemTypes=10]="NotFoundInAvailableItemTypes",e[e.WrongProgressionOrder=11]="WrongProgressionOrder",e[e.InvalidEventIdLength=12]="InvalidEventIdLength",e[e.InvalidEventIdCharacters=13]="InvalidEventIdCharacters",e[e.InvalidProgressionStatus=15]="InvalidProgressionStatus",e[e.InvalidSeverity=16]="InvalidSeverity",e[e.InvalidLongString=17]="InvalidLongString",e[e.DatabaseTooLarge=18]="DatabaseTooLarge",e[e.DatabaseOpenOrCreate=19]="DatabaseOpenOrCreate",e[e.JsonError=25]="JsonError",e[e.FailHttpJsonDecode=29]="FailHttpJsonDecode",e[e.FailHttpJsonEncode=30]="FailHttpJsonEncode",e[e.InvalidAdAction=31]="InvalidAdAction",e[e.InvalidAdType=32]="InvalidAdType",e[e.InvalidString=33]="InvalidString",(n=E.EGASdkErrorParameter||(E.EGASdkErrorParameter={}))[n.Undefined=0]="Undefined",n[n.Currency=1]="Currency",n[n.CartType=2]="CartType",n[n.ItemType=3]="ItemType",n[n.ItemId=4]="ItemId",n[n.Store=5]="Store",n[n.FlowType=6]="FlowType",n[n.Amount=7]="Amount",n[n.Progression01=8]="Progression01",n[n.Progression02=9]="Progression02",n[n.Progression03=10]="Progression03",n[n.EventId=11]="EventId",n[n.ProgressionStatus=12]="ProgressionStatus",n[n.Severity=13]="Severity",n[n.Message=14]="Message",n[n.AdAction=15]="AdAction",n[n.AdType=16]="AdType",n[n.AdSdkName=17]="AdSdkName",n[n.AdPlacement=18]="AdPlacement"}(b=b||{});var b,V=b.EGAErrorSeverity,U=b.EGAProgressionStatus,M=b.EGAResourceFlowType;(function(l){(function(g){var u,p;(p=u=u||{})[p.Error=0]="Error",p[p.Warning=1]="Warning",p[p.Info=2]="Info",p[p.Debug=3]="Debug";var a=(r.setInfoLog=function(o){r.instance.infoLogEnabled=o},r.setVerboseLog=function(o){r.instance.infoLogVerboseEnabled=o},r.i=function(o){if(r.instance.infoLogEnabled){var f="Info/"+r.Tag+": "+o;r.instance.sendNotificationMessage(f,u.Info)}},r.w=function(o){var f="Warning/"+r.Tag+": "+o;r.instance.sendNotificationMessage(f,u.Warning)},r.e=function(o){var f="Error/"+r.Tag+": "+o;r.instance.sendNotificationMessage(f,u.Error)},r.ii=function(o){if(r.instance.infoLogVerboseEnabled){var f="Verbose/"+r.Tag+": "+o;r.instance.sendNotificationMessage(f,u.Info)}},r.d=function(o){if(r.debugEnabled){var f="Debug/"+r.Tag+": "+o;r.instance.sendNotificationMessage(f,u.Debug)}},r.prototype.sendNotificationMessage=function(o,f){switch(f){case u.Error:console.error(o);break;case u.Warning:console.warn(o);break;case u.Debug:typeof console.debug=="function"?console.debug(o):console.log(o);break;case u.Info:console.log(o)}},r.instance=new r,r.Tag="GameAnalytics",r);function r(){r.debugEnabled=!1}g.GALogger=a})(l.logging||(l.logging={}))})(b=b||{}),function(l){var g,u,p;function a(){}g=l.utilities||(l.utilities={}),u=l.logging.GALogger,a.getHmac=function(r,o){var f=k.HmacSHA256(o,r);return k.enc.Base64.stringify(f)},a.stringMatch=function(r,o){return!(!r||!o)&&o.test(r)},a.joinStringArray=function(r,o){for(var f="",d=0,E=r.length;d<E;d++)0<d&&(f+=o),f+=r[d];return f},a.stringArrayContainsString=function(r,o){if(r.length===0)return!1;for(var f in r)if(r[f]===o)return!0;return!1},a.encode64=function(r){r=encodeURI(r);for(var o,f,d,E,t,i="",e=0,n=0,s=0;d=(o=r.charCodeAt(s++))>>2,E=(3&o)<<4|(f=r.charCodeAt(s++))>>4,t=(15&f)<<2|(e=r.charCodeAt(s++))>>6,n=63&e,isNaN(f)?t=n=64:isNaN(e)&&(n=64),i=i+a.keyStr.charAt(d)+a.keyStr.charAt(E)+a.keyStr.charAt(t)+a.keyStr.charAt(n),o=f=e=0,d=E=t=n=0,s<r.length;);return i},a.decode64=function(r){var o,f,d,E,t="",i=0,e=0,n=0;for(/[^A-Za-z0-9\+\/\=]/g.exec(r)&&u.w("There were invalid base64 characters in the input text. Valid base64 characters are A-Z, a-z, 0-9, '+', '/',and '='. Expect errors in decoding."),r=r.replace(/[^A-Za-z0-9\+\/\=]/g,"");o=a.keyStr.indexOf(r.charAt(n++))<<2|(d=a.keyStr.indexOf(r.charAt(n++)))>>4,f=(15&d)<<4|(E=a.keyStr.indexOf(r.charAt(n++)))>>2,i=(3&E)<<6|(e=a.keyStr.indexOf(r.charAt(n++))),t+=String.fromCharCode(o),E!=64&&(t+=String.fromCharCode(f)),e!=64&&(t+=String.fromCharCode(i)),o=f=i=0,d=E=e=0,n<r.length;);return decodeURI(t)},a.timeIntervalSince1970=function(){var r=new Date;return Math.round(r.getTime()/1e3)},a.createGuid=function(){return(a.s4()+a.s4()+"-"+a.s4()+"-4"+a.s4().substr(0,3)+"-"+a.s4()+"-"+a.s4()+a.s4()+a.s4()).toLowerCase()},a.s4=function(){return(65536*(1+Math.random())|0).toString(16).substring(1)},a.keyStr="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",p=a,g.GAUtilities=p}(b=b||{}),function(l){(function(g){var u=l.logging.GALogger,p=l.utilities.GAUtilities,a=l.events.EGASdkErrorCategory,r=l.events.EGASdkErrorArea,o=l.events.EGASdkErrorAction,f=l.events.EGASdkErrorParameter,d=function(i,e,n,s,c){this.category=i,this.area=e,this.action=n,this.parameter=s,this.reason=c};g.ValidationResult=d;var E=(t.validateBusinessEvent=function(i,e,n,s,c){return t.validateCurrency(i)?e<0?(u.w("Validation fail - business event - amount. Cannot be less than 0. Failed amount: "+e),new d(a.EventValidation,r.BusinessEvent,o.InvalidAmount,f.Amount,e+"")):t.validateShortString(n,!0)?t.validateEventPartLength(s,!1)?t.validateEventPartCharacters(s)?t.validateEventPartLength(c,!1)?t.validateEventPartCharacters(c)?null:(u.w("Validation fail - business event - itemId: Cannot contain other characters than A-z, 0-9, -_., ()!?. String: "+c),new d(a.EventValidation,r.BusinessEvent,o.InvalidEventPartCharacters,f.ItemId,c)):(u.w("Validation fail - business event - itemId. Cannot be (null), empty or above 64 characters. String: "+c),new d(a.EventValidation,r.BusinessEvent,o.InvalidEventPartLength,f.ItemId,c)):(u.w("Validation fail - business event - itemType: Cannot contain other characters than A-z, 0-9, -_., ()!?. String: "+s),new d(a.EventValidation,r.BusinessEvent,o.InvalidEventPartCharacters,f.ItemType,s)):(u.w("Validation fail - business event - itemType: Cannot be (null), empty or above 64 characters. String: "+s),new d(a.EventValidation,r.BusinessEvent,o.InvalidEventPartLength,f.ItemType,s)):(u.w("Validation fail - business event - cartType. Cannot be above 32 length. String: "+n),new d(a.EventValidation,r.BusinessEvent,o.InvalidShortString,f.CartType,n)):(u.w("Validation fail - business event - currency: Cannot be (null) and need to be A-Z, 3 characters and in the standard at openexchangerates.org. Failed currency: "+i),new d(a.EventValidation,r.BusinessEvent,o.InvalidCurrency,f.Currency,i))},t.validateResourceEvent=function(i,e,n,s,c,v,m){return i==l.EGAResourceFlowType.Undefined?(u.w("Validation fail - resource event - flowType: Invalid flow type."),new d(a.EventValidation,r.ResourceEvent,o.InvalidFlowType,f.FlowType,"")):e?p.stringArrayContainsString(v,e)?0<n?s?t.validateEventPartLength(s,!1)?t.validateEventPartCharacters(s)?p.stringArrayContainsString(m,s)?t.validateEventPartLength(c,!1)?t.validateEventPartCharacters(c)?null:(u.w("Validation fail - resource event - itemId: Cannot contain other characters than A-z, 0-9, -_., ()!?. String: "+c),new d(a.EventValidation,r.ResourceEvent,o.InvalidEventPartCharacters,f.ItemId,c)):(u.w("Validation fail - resource event - itemId: Cannot be (null), empty or above 64 characters. String: "+c),new d(a.EventValidation,r.ResourceEvent,o.InvalidEventPartLength,f.ItemId,c)):(u.w("Validation fail - resource event - itemType: Not found in list of pre-defined available resource itemTypes. String: "+s),new d(a.EventValidation,r.ResourceEvent,o.NotFoundInAvailableItemTypes,f.ItemType,s)):(u.w("Validation fail - resource event - itemType: Cannot contain other characters than A-z, 0-9, -_., ()!?. String: "+s),new d(a.EventValidation,r.ResourceEvent,o.InvalidEventPartCharacters,f.ItemType,s)):(u.w("Validation fail - resource event - itemType: Cannot be (null), empty or above 64 characters. String: "+s),new d(a.EventValidation,r.ResourceEvent,o.InvalidEventPartLength,f.ItemType,s)):(u.w("Validation fail - resource event - itemType: Cannot be (null)"),new d(a.EventValidation,r.ResourceEvent,o.StringEmptyOrNull,f.ItemType,"")):(u.w("Validation fail - resource event - amount: Float amount cannot be 0 or negative. Value: "+n),new d(a.EventValidation,r.ResourceEvent,o.InvalidAmount,f.Amount,n+"")):(u.w("Validation fail - resource event - currency: Not found in list of pre-defined available resource currencies. String: "+e),new d(a.EventValidation,r.ResourceEvent,o.NotFoundInAvailableCurrencies,f.Currency,e)):(u.w("Validation fail - resource event - currency: Cannot be (null)"),new d(a.EventValidation,r.ResourceEvent,o.StringEmptyOrNull,f.Currency,""))},t.validateProgressionEvent=function(i,e,n,s){if(i==l.EGAProgressionStatus.Undefined)return u.w("Validation fail - progression event: Invalid progression status."),new d(a.EventValidation,r.ProgressionEvent,o.InvalidProgressionStatus,f.ProgressionStatus,"");if(s&&!n&&e)return u.w("Validation fail - progression event: 03 found but 01+02 are invalid. Progression must be set as either 01, 01+02 or 01+02+03."),new d(a.EventValidation,r.ProgressionEvent,o.WrongProgressionOrder,f.Undefined,e+":"+n+":"+s);if(n&&!e)return u.w("Validation fail - progression event: 02 found but not 01. Progression must be set as either 01, 01+02 or 01+02+03"),new d(a.EventValidation,r.ProgressionEvent,o.WrongProgressionOrder,f.Undefined,e+":"+n+":"+s);if(!e)return u.w("Validation fail - progression event: progression01 not valid. Progressions must be set as either 01, 01+02 or 01+02+03"),new d(a.EventValidation,r.ProgressionEvent,o.WrongProgressionOrder,f.Undefined,(e||"")+":"+(n||"")+":"+(s||""));if(!t.validateEventPartLength(e,!1))return u.w("Validation fail - progression event - progression01: Cannot be (null), empty or above 64 characters. String: "+e),new d(a.EventValidation,r.ProgressionEvent,o.InvalidEventPartLength,f.Progression01,e);if(!t.validateEventPartCharacters(e))return u.w("Validation fail - progression event - progression01: Cannot contain other characters than A-z, 0-9, -_., ()!?. String: "+e),new d(a.EventValidation,r.ProgressionEvent,o.InvalidEventPartCharacters,f.Progression01,e);if(n){if(!t.validateEventPartLength(n,!0))return u.w("Validation fail - progression event - progression02: Cannot be empty or above 64 characters. String: "+n),new d(a.EventValidation,r.ProgressionEvent,o.InvalidEventPartLength,f.Progression02,n);if(!t.validateEventPartCharacters(n))return u.w("Validation fail - progression event - progression02: Cannot contain other characters than A-z, 0-9, -_., ()!?. String: "+n),new d(a.EventValidation,r.ProgressionEvent,o.InvalidEventPartCharacters,f.Progression02,n)}if(s){if(!t.validateEventPartLength(s,!0))return u.w("Validation fail - progression event - progression03: Cannot be empty or above 64 characters. String: "+s),new d(a.EventValidation,r.ProgressionEvent,o.InvalidEventPartLength,f.Progression03,s);if(!t.validateEventPartCharacters(s))return u.w("Validation fail - progression event - progression03: Cannot contain other characters than A-z, 0-9, -_., ()!?. String: "+s),new d(a.EventValidation,r.ProgressionEvent,o.InvalidEventPartCharacters,f.Progression03,s)}return null},t.validateDesignEvent=function(i){return t.validateEventIdLength(i)?t.validateEventIdCharacters(i)?null:(u.w("Validation fail - design event - eventId: Non valid characters. Only allowed A-z, 0-9, -_., ()!?. String: "+i),new d(a.EventValidation,r.DesignEvent,o.InvalidEventIdCharacters,f.EventId,i)):(u.w("Validation fail - design event - eventId: Cannot be (null) or empty. Only 5 event parts allowed seperated by :. Each part need to be 64 characters or less. String: "+i),new d(a.EventValidation,r.DesignEvent,o.InvalidEventIdLength,f.EventId,i))},t.validateErrorEvent=function(i,e){return i==l.EGAErrorSeverity.Undefined?(u.w("Validation fail - error event - severity: Severity was unsupported value."),new d(a.EventValidation,r.ErrorEvent,o.InvalidSeverity,f.Severity,"")):t.validateLongString(e,!0)?null:(u.w("Validation fail - error event - message: Message cannot be above 8192 characters."),new d(a.EventValidation,r.ErrorEvent,o.InvalidLongString,f.Message,e))},t.validateAdEvent=function(i,e,n,s){return i==l.EGAAdAction.Undefined?(u.w("Validation fail - error event - severity: Severity was unsupported value."),new d(a.EventValidation,r.AdEvent,o.InvalidAdAction,f.AdAction,"")):e==l.EGAAdType.Undefined?(u.w("Validation fail - ad event - adType: Ad type was unsupported value."),new d(a.EventValidation,r.AdEvent,o.InvalidAdType,f.AdType,"")):t.validateShortString(n,!1)?t.validateString(s,!1)?null:(u.w("Validation fail - ad event - message: Ad placement cannot be above 64 characters."),new d(a.EventValidation,r.AdEvent,o.InvalidString,f.AdPlacement,s)):(u.w("Validation fail - ad event - message: Ad SDK name cannot be above 32 characters."),new d(a.EventValidation,r.AdEvent,o.InvalidShortString,f.AdSdkName,n))},t.validateSdkErrorEvent=function(i,e,n,s,c){return!(!t.validateKeys(i,e)||(n===a.Undefined?(u.w("Validation fail - sdk error event - type: Category was unsupported value."),1):s===r.Undefined?(u.w("Validation fail - sdk error event - type: Area was unsupported value."),1):c===o.Undefined&&(u.w("Validation fail - sdk error event - type: Action was unsupported value."),1)))},t.validateKeys=function(i,e){return!(!p.stringMatch(i,/^[A-z0-9]{32}$/)||!p.stringMatch(e,/^[A-z0-9]{40}$/))},t.validateCurrency=function(i){return!!i&&!!p.stringMatch(i,/^[A-Z]{3}$/)},t.validateEventPartLength=function(i,e){return!(!e||i)||!!i&&!(64<i.length)},t.validateEventPartCharacters=function(i){return!!p.stringMatch(i,/^[A-Za-z0-9\s\-_\.\(\)\!\?]{1,64}$/)},t.validateEventIdLength=function(i){return!!i&&!!p.stringMatch(i,/^[^:]{1,64}(?::[^:]{1,64}){0,4}$/)},t.validateEventIdCharacters=function(i){return!!i&&!!p.stringMatch(i,/^[A-Za-z0-9\s\-_\.\(\)\!\?]{1,64}(:[A-Za-z0-9\s\-_\.\(\)\!\?]{1,64}){0,4}$/)},t.validateAndCleanInitRequestResponse=function(i,e){if(i==null)return u.w("validateInitRequestResponse failed - no response dictionary."),null;var n={};try{var s=i.server_ts;if(!(0<s))return u.w("validateInitRequestResponse failed - invalid value in 'server_ts' field."),null;n.server_ts=s}catch(S){return u.w("validateInitRequestResponse failed - invalid type in 'server_ts' field. type="+typeof i.server_ts+", value="+i.server_ts+", "+S),null}if(e){try{var c=i.configs;n.configs=c}catch(S){return u.w("validateInitRequestResponse failed - invalid type in 'configs' field. type="+typeof i.configs+", value="+i.configs+", "+S),null}try{var v=i.configs_hash;n.configs_hash=v}catch(S){return u.w("validateInitRequestResponse failed - invalid type in 'configs_hash' field. type="+typeof i.configs_hash+", value="+i.configs_hash+", "+S),null}try{var m=i.ab_id;n.ab_id=m}catch(S){return u.w("validateInitRequestResponse failed - invalid type in 'ab_id' field. type="+typeof i.ab_id+", value="+i.ab_id+", "+S),null}try{var A=i.ab_variant_id;n.ab_variant_id=A}catch(S){return u.w("validateInitRequestResponse failed - invalid type in 'ab_variant_id' field. type="+typeof i.ab_variant_id+", value="+i.ab_variant_id+", "+S),null}}return n},t.validateBuild=function(i){return!!t.validateShortString(i,!1)},t.validateSdkWrapperVersion=function(i){return!!p.stringMatch(i,/^(unity|unreal|gamemaker|cocos2d|construct|defold|godot) [0-9]{0,5}(\.[0-9]{0,5}){0,2}$/)},t.validateEngineVersion=function(i){return!(!i||!p.stringMatch(i,/^(unity|unreal|gamemaker|cocos2d|construct|defold|godot) [0-9]{0,5}(\.[0-9]{0,5}){0,2}$/))},t.validateUserId=function(i){return!!t.validateString(i,!1)||(u.w("Validation fail - user id: id cannot be (null), empty or above 64 characters."),!1)},t.validateShortString=function(i,e){return!(!e||i)||!(!i||32<i.length)},t.validateString=function(i,e){return!(!e||i)||!(!i||64<i.length)},t.validateLongString=function(i,e){return!(!e||i)||!(!i||8192<i.length)},t.validateConnectionType=function(i){return p.stringMatch(i,/^(wwan|wifi|lan|offline)$/)},t.validateCustomDimensions=function(i){return t.validateArrayOfStrings(20,32,!1,"custom dimensions",i)},t.validateResourceCurrencies=function(i){if(!t.validateArrayOfStrings(20,64,!1,"resource currencies",i))return!1;for(var e=0;e<i.length;++e)if(!p.stringMatch(i[e],/^[A-Za-z]+$/))return u.w("resource currencies validation failed: a resource currency can only be A-Z, a-z. String was: "+i[e]),!1;return!0},t.validateResourceItemTypes=function(i){if(!t.validateArrayOfStrings(20,32,!1,"resource item types",i))return!1;for(var e=0;e<i.length;++e)if(!t.validateEventPartCharacters(i[e]))return u.w("resource item types validation failed: a resource item type cannot contain other characters than A-z, 0-9, -_., ()!?. String was: "+i[e]),!1;return!0},t.validateDimension01=function(i,e){return!i||!!p.stringArrayContainsString(e,i)},t.validateDimension02=function(i,e){return!i||!!p.stringArrayContainsString(e,i)},t.validateDimension03=function(i,e){return!i||!!p.stringArrayContainsString(e,i)},t.validateArrayOfStrings=function(i,e,n,s,c){var v=s;if(v=v||"Array",!c)return u.w(v+" validation failed: array cannot be null. "),!1;if(n==0&&c.length==0)return u.w(v+" validation failed: array cannot be empty. "),!1;if(0<i&&c.length>i)return u.w(v+" validation failed: array cannot exceed "+i+" values. It has "+c.length+" values."),!1;for(var m=0;m<c.length;++m){var A=c[m]?c[m].length:0;if(A===0)return u.w(v+" validation failed: contained an empty string. Array="+JSON.stringify(c)),!1;if(0<e&&e<A)return u.w(v+" validation failed: a string exceeded max allowed length (which is: "+e+"). String was: "+c[m]),!1}return!0},t.validateClientTs=function(i){return!(i<0||99999999999<i)},t);function t(){}g.GAValidator=E})(l.validators||(l.validators={}))}(b=b||{}),function(l){(function(g){var u=function(o,f,d){this.name=o,this.value=f,this.version=d};g.NameValueVersion=u;var p=function(o,f){this.name=o,this.version=f};g.NameVersion=p;var a=(r.touch=function(){},r.getRelevantSdkVersion=function(){return r.sdkGameEngineVersion?r.sdkGameEngineVersion:r.sdkWrapperVersion},r.getConnectionType=function(){return r.connectionType},r.updateConnectionType=function(){navigator.onLine?r.connectionType=r.buildPlatform==="ios"||r.buildPlatform==="android"?"wwan":"lan":r.connectionType="offline"},r.getOSVersionString=function(){return r.buildPlatform+" "+r.osVersionPair.version},r.runtimePlatformToString=function(){return r.osVersionPair.name},r.getBrowserVersionString=function(){var o,f=navigator.userAgent,d=f.match(/(opera|chrome|safari|firefox|ubrowser|msie|trident|fbav(?=\/))\/?\s*(\d+)/i)||[];if(d.length==0&&r.buildPlatform==="ios")return"webkit_"+r.osVersion;if(/trident/i.test(d[1]))return"IE "+((o=/\brv[ :]+(\d+)/g.exec(f)||[])[1]||"");if(d[1]==="Chrome"&&(o=f.match(/\b(OPR|Edge|UBrowser)\/(\d+)/))!=null)return o.slice(1).join(" ").replace("OPR","Opera").replace("UBrowser","UC").toLowerCase();if(d[1]&&d[1].toLowerCase()==="fbav"&&(d[1]="facebook",d[2]))return"facebook "+d[2];var E=d[2]?[d[1],d[2]]:[navigator.appName,navigator.appVersion,"-?"];return(o=f.match(/version\/(\d+)/i))!=null&&E.splice(1,1,o[1]),E.join(" ").toLowerCase()},r.getDeviceModel=function(){return"unknown"},r.getDeviceManufacturer=function(){return"unknown"},r.matchItem=function(o,f){var d,E,t,i,e=new p("unknown","0.0.0"),n=0,s=0;for(n=0;n<f.length;n+=1)if(new RegExp(f[n].value,"i").test(o)){if(d=new RegExp(f[n].version+"[- /:;]([\\d._]+)","i"),i="",(E=o.match(d))&&E[1]&&(t=E[1]),t){var c=t.split(/[._]+/);for(s=0;s<Math.min(c.length,3);s+=1)i+=c[s]+(s<Math.min(c.length,3)-1?".":"")}else i="0.0.0";return e.name=f[n].name,e.version=i,e}return e},r.sdkWrapperVersion="javascript 4.2.0",r.osVersionPair=r.matchItem([navigator.platform,navigator.userAgent,navigator.appVersion,navigator.vendor].join(" "),[new u("windows_phone","Windows Phone","OS"),new u("windows","Win","NT"),new u("ios","iPhone","OS"),new u("ios","iPad","OS"),new u("ios","iPod","OS"),new u("android","Android","Android"),new u("blackBerry","BlackBerry","/"),new u("mac_osx","Mac","OS X"),new u("tizen","Tizen","Tizen"),new u("linux","Linux","rv"),new u("kai_os","KAIOS","KAIOS")]),r.buildPlatform=r.runtimePlatformToString(),r.deviceModel=r.getDeviceModel(),r.deviceManufacturer=r.getDeviceManufacturer(),r.osVersion=r.getOSVersionString(),r.browserVersion=r.getBrowserVersionString(),r);function r(){}g.GADevice=a})(l.device||(l.device={}))}(b=b||{}),function(l){var g,u;function p(a){this.deadline=a,this.ignore=!1,this.async=!1,this.running=!1,this.id=++p.idCounter}g=l.threading||(l.threading={}),p.idCounter=0,u=p,g.TimedBlock=u}(b=b||{}),function(l){var g,u;function p(a){this.comparer=a,this._subQueues={},this._sortedKeys=[]}g=l.threading||(l.threading={}),p.prototype.enqueue=function(a,r){this._sortedKeys.indexOf(a)===-1&&this.addQueueOfPriority(a),this._subQueues[a].push(r)},p.prototype.addQueueOfPriority=function(a){var r=this;this._sortedKeys.push(a),this._sortedKeys.sort(function(o,f){return r.comparer.compare(o,f)}),this._subQueues[a]=[]},p.prototype.peek=function(){if(this.hasItems())return this._subQueues[this._sortedKeys[0]][0];throw new Error("The queue is empty")},p.prototype.hasItems=function(){return 0<this._sortedKeys.length},p.prototype.dequeue=function(){if(this.hasItems())return this.dequeueFromHighPriorityQueue();throw new Error("The queue is empty")},p.prototype.dequeueFromHighPriorityQueue=function(){var a=this._sortedKeys[0],r=this._subQueues[a].shift();return this._subQueues[a].length===0&&(this._sortedKeys.shift(),delete this._subQueues[a]),r},u=p,g.PriorityQueue=u}(b=b||{}),function(l){(function(g){var u,p,a,r,o=l.logging.GALogger;(p=u=g.EGAStoreArgsOperator||(g.EGAStoreArgsOperator={}))[p.Equal=0]="Equal",p[p.LessOrEqual=1]="LessOrEqual",p[p.NotEqual=2]="NotEqual",(r=a=g.EGAStore||(g.EGAStore={}))[r.Events=0]="Events",r[r.Sessions=1]="Sessions",r[r.Progression=2]="Progression";var f=(d.isStorageAvailable=function(){return d.storageAvailable},d.isStoreTooLargeForEvents=function(){return d.instance.eventsStore.length+d.instance.sessionsStore.length>d.MaxNumberOfEntries},d.select=function(E,t,i,e){t===void 0&&(t=[]),i===void 0&&(i=!1),e===void 0&&(e=0);var n=d.getStore(E);if(!n)return null;for(var s=[],c=0;c<n.length;++c){for(var v=n[c],m=!0,A=0;A<t.length;++A){var S=t[A];if(v[S[0]])switch(S[1]){case u.Equal:m=v[S[0]]==S[2];break;case u.LessOrEqual:m=v[S[0]]<=S[2];break;case u.NotEqual:m=v[S[0]]!=S[2];break;default:m=!1}else m=!1;if(!m)break}m&&s.push(v)}return i&&s.sort(function(h,y){return h.client_ts-y.client_ts}),0<e&&s.length>e&&(s=s.slice(0,e+1)),s},d.update=function(E,t,i){i===void 0&&(i=[]);var e=d.getStore(E);if(!e)return!1;for(var n=0;n<e.length;++n){for(var s=e[n],c=!0,v=0;v<i.length;++v){var m=i[v];if(s[m[0]])switch(m[1]){case u.Equal:c=s[m[0]]==m[2];break;case u.LessOrEqual:c=s[m[0]]<=m[2];break;case u.NotEqual:c=s[m[0]]!=m[2];break;default:c=!1}else c=!1;if(!c)break}if(c)for(v=0;v<t.length;++v){var A=t[v];s[A[0]]=A[1]}}return!0},d.delete=function(E,t){var i=d.getStore(E);if(i)for(var e=0;e<i.length;++e){for(var n=i[e],s=!0,c=0;c<t.length;++c){var v=t[c];if(n[v[0]])switch(v[1]){case u.Equal:s=n[v[0]]==v[2];break;case u.LessOrEqual:s=n[v[0]]<=v[2];break;case u.NotEqual:s=n[v[0]]!=v[2];break;default:s=!1}else s=!1;if(!s)break}s&&(i.splice(e,1),--e)}},d.insert=function(E,t,i,e){i===void 0&&(i=!1),e===void 0&&(e=null);var n=d.getStore(E);if(n)if(i){if(!e)return;for(var s=!1,c=0;c<n.length;++c){var v=n[c];if(v[e]==t[e]){for(var m in t)v[m]=t[m];s=!0;break}}s||n.push(t)}else n.push(t)},d.save=function(E){d.isStorageAvailable()?(localStorage.setItem(d.StringFormat(d.KeyFormat,E,d.EventsStoreKey),JSON.stringify(d.instance.eventsStore)),localStorage.setItem(d.StringFormat(d.KeyFormat,E,d.SessionsStoreKey),JSON.stringify(d.instance.sessionsStore)),localStorage.setItem(d.StringFormat(d.KeyFormat,E,d.ProgressionStoreKey),JSON.stringify(d.instance.progressionStore)),localStorage.setItem(d.StringFormat(d.KeyFormat,E,d.ItemsStoreKey),JSON.stringify(d.instance.storeItems))):o.w("Storage is not available, cannot save.")},d.load=function(E){if(d.isStorageAvailable()){try{d.instance.eventsStore=JSON.parse(localStorage.getItem(d.StringFormat(d.KeyFormat,E,d.EventsStoreKey))),d.instance.eventsStore||(d.instance.eventsStore=[])}catch(t){o.w("Load failed for 'events' store. Using empty store."),d.instance.eventsStore=[]}try{d.instance.sessionsStore=JSON.parse(localStorage.getItem(d.StringFormat(d.KeyFormat,E,d.SessionsStoreKey))),d.instance.sessionsStore||(d.instance.sessionsStore=[])}catch(t){o.w("Load failed for 'sessions' store. Using empty store."),d.instance.sessionsStore=[]}try{d.instance.progressionStore=JSON.parse(localStorage.getItem(d.StringFormat(d.KeyFormat,E,d.ProgressionStoreKey))),d.instance.progressionStore||(d.instance.progressionStore=[])}catch(t){o.w("Load failed for 'progression' store. Using empty store."),d.instance.progressionStore=[]}try{d.instance.storeItems=JSON.parse(localStorage.getItem(d.StringFormat(d.KeyFormat,E,d.ItemsStoreKey))),d.instance.storeItems||(d.instance.storeItems={})}catch(t){o.w("Load failed for 'items' store. Using empty store."),d.instance.progressionStore=[]}}else o.w("Storage is not available, cannot load.")},d.setItem=function(E,t,i){var e=d.StringFormat(d.KeyFormat,E,t);i?d.instance.storeItems[e]=i:e in d.instance.storeItems&&delete d.instance.storeItems[e]},d.getItem=function(E,t){var i=d.StringFormat(d.KeyFormat,E,t);return i in d.instance.storeItems?d.instance.storeItems[i]:null},d.getStore=function(E){switch(E){case a.Events:return d.instance.eventsStore;case a.Sessions:return d.instance.sessionsStore;case a.Progression:return d.instance.progressionStore;default:return o.w("GAStore.getStore(): Cannot find store: "+E),null}},d.instance=new d,d.MaxNumberOfEntries=2e3,d.StringFormat=function(E){for(var t=[],i=1;i<arguments.length;i++)t[i-1]=arguments[i];return E.replace(/{(\d+)}/g,function(e,n){return t[n]||""})},d.KeyFormat="GA::{0}::{1}",d.EventsStoreKey="ga_event",d.SessionsStoreKey="ga_session",d.ProgressionStoreKey="ga_progression",d.ItemsStoreKey="ga_items",d);function d(){this.eventsStore=[],this.sessionsStore=[],this.progressionStore=[],this.storeItems={};try{typeof localStorage=="object"?(localStorage.setItem("testingLocalStorage","yes"),localStorage.removeItem("testingLocalStorage"),d.storageAvailable=!0):d.storageAvailable=!1}catch(E){}}g.GAStore=f})(l.store||(l.store={}))}(b=b||{}),function(l){var g,u,p,a,r,o,f,d,E;function t(){this.availableCustomDimensions01=[],this.availableCustomDimensions02=[],this.availableCustomDimensions03=[],this.availableResourceCurrencies=[],this.availableResourceItemTypes=[],this.configurations={},this.remoteConfigsListeners=[],this.beforeUnloadListeners=[],this.sdkConfigDefault={},this.sdkConfig={},this.progressionTries={},this._isEventSubmissionEnabled=!0,this.isUnloading=!1}g=l.state||(l.state={}),u=l.validators.GAValidator,p=l.utilities.GAUtilities,a=l.logging.GALogger,r=l.store.GAStore,o=l.device.GADevice,f=l.store.EGAStore,d=l.store.EGAStoreArgsOperator,t.setUserId=function(i){t.instance.userId=i,t.cacheIdentifier()},t.getIdentifier=function(){return t.instance.identifier},t.isInitialized=function(){return t.instance.initialized},t.setInitialized=function(i){t.instance.initialized=i},t.getSessionStart=function(){return t.instance.sessionStart},t.getSessionNum=function(){return t.instance.sessionNum},t.getTransactionNum=function(){return t.instance.transactionNum},t.getSessionId=function(){return t.instance.sessionId},t.getCurrentCustomDimension01=function(){return t.instance.currentCustomDimension01},t.getCurrentCustomDimension02=function(){return t.instance.currentCustomDimension02},t.getCurrentCustomDimension03=function(){return t.instance.currentCustomDimension03},t.getGameKey=function(){return t.instance.gameKey},t.getGameSecret=function(){return t.instance.gameSecret},t.getAvailableCustomDimensions01=function(){return t.instance.availableCustomDimensions01},t.setAvailableCustomDimensions01=function(i){u.validateCustomDimensions(i)&&(t.instance.availableCustomDimensions01=i,t.validateAndFixCurrentDimensions(),a.i("Set available custom01 dimension values: ("+p.joinStringArray(i,", ")+")"))},t.getAvailableCustomDimensions02=function(){return t.instance.availableCustomDimensions02},t.setAvailableCustomDimensions02=function(i){u.validateCustomDimensions(i)&&(t.instance.availableCustomDimensions02=i,t.validateAndFixCurrentDimensions(),a.i("Set available custom02 dimension values: ("+p.joinStringArray(i,", ")+")"))},t.getAvailableCustomDimensions03=function(){return t.instance.availableCustomDimensions03},t.setAvailableCustomDimensions03=function(i){u.validateCustomDimensions(i)&&(t.instance.availableCustomDimensions03=i,t.validateAndFixCurrentDimensions(),a.i("Set available custom03 dimension values: ("+p.joinStringArray(i,", ")+")"))},t.getAvailableResourceCurrencies=function(){return t.instance.availableResourceCurrencies},t.setAvailableResourceCurrencies=function(i){u.validateResourceCurrencies(i)&&(t.instance.availableResourceCurrencies=i,a.i("Set available resource currencies: ("+p.joinStringArray(i,", ")+")"))},t.getAvailableResourceItemTypes=function(){return t.instance.availableResourceItemTypes},t.setAvailableResourceItemTypes=function(i){u.validateResourceItemTypes(i)&&(t.instance.availableResourceItemTypes=i,a.i("Set available resource item types: ("+p.joinStringArray(i,", ")+")"))},t.getBuild=function(){return t.instance.build},t.setBuild=function(i){t.instance.build=i,a.i("Set build version: "+i)},t.getUseManualSessionHandling=function(){return t.instance.useManualSessionHandling},t.isEventSubmissionEnabled=function(){return t.instance._isEventSubmissionEnabled},t.getABTestingId=function(){return t.instance.abId},t.getABTestingVariantId=function(){return t.instance.abVariantId},t.prototype.setDefaultId=function(i){this.defaultUserId=i||"",t.cacheIdentifier()},t.getDefaultId=function(){return t.instance.defaultUserId},t.getSdkConfig=function(){var i,e=0;for(var n in t.instance.sdkConfig)e===0&&(i=n),++e;if(i&&0<e)return t.instance.sdkConfig;for(var n in e=0,t.instance.sdkConfigCached)e===0&&(i=n),++e;return i&&0<e?t.instance.sdkConfigCached:t.instance.sdkConfigDefault},t.isEnabled=function(){return!!t.instance.initAuthorized},t.setCustomDimension01=function(i){t.instance.currentCustomDimension01=i,r.setItem(t.getGameKey(),t.Dimension01Key,i),a.i("Set custom01 dimension value: "+i)},t.setCustomDimension02=function(i){t.instance.currentCustomDimension02=i,r.setItem(t.getGameKey(),t.Dimension02Key,i),a.i("Set custom02 dimension value: "+i)},t.setCustomDimension03=function(i){t.instance.currentCustomDimension03=i,r.setItem(t.getGameKey(),t.Dimension03Key,i),a.i("Set custom03 dimension value: "+i)},t.incrementSessionNum=function(){var i=t.getSessionNum()+1;t.instance.sessionNum=i},t.incrementTransactionNum=function(){var i=t.getTransactionNum()+1;t.instance.transactionNum=i},t.incrementProgressionTries=function(i){var e=t.getProgressionTries(i)+1;t.instance.progressionTries[i]=e;var n={};n.progression=i,n.tries=e,r.insert(f.Progression,n,!0,"progression")},t.getProgressionTries=function(i){return i in t.instance.progressionTries?t.instance.progressionTries[i]:0},t.clearProgressionTries=function(i){i in t.instance.progressionTries&&delete t.instance.progressionTries[i];var e=[];e.push(["progression",d.Equal,i]),r.delete(f.Progression,e)},t.setKeys=function(i,e){t.instance.gameKey=i,t.instance.gameSecret=e},t.setManualSessionHandling=function(i){t.instance.useManualSessionHandling=i,a.i("Use manual session handling: "+i)},t.setEnabledEventSubmission=function(i){t.instance._isEventSubmissionEnabled=i},t.getEventAnnotations=function(){var i={v:2};i.user_id=t.instance.identifier,i.client_ts=t.getClientTsAdjusted(),i.sdk_version=o.getRelevantSdkVersion(),i.os_version=o.osVersion,i.manufacturer=o.deviceManufacturer,i.device=o.deviceModel,i.browser_version=o.browserVersion,i.platform=o.buildPlatform,i.session_id=t.instance.sessionId,i[t.SessionNumKey]=t.instance.sessionNum;var e=o.getConnectionType();if(u.validateConnectionType(e)&&(i.connection_type=e),o.gameEngineVersion&&(i.engine_version=o.gameEngineVersion),t.instance.configurations){var n=0;for(var s in t.instance.configurations){n++;break}0<n&&(i.configurations=t.instance.configurations)}return t.instance.abId&&(i.ab_id=t.instance.abId),t.instance.abVariantId&&(i.ab_variant_id=t.instance.abVariantId),t.instance.build&&(i.build=t.instance.build),i},t.getSdkErrorEventAnnotations=function(){var i={v:2};i.category=t.CategorySdkError,i.sdk_version=o.getRelevantSdkVersion(),i.os_version=o.osVersion,i.manufacturer=o.deviceManufacturer,i.device=o.deviceModel,i.platform=o.buildPlatform;var e=o.getConnectionType();return u.validateConnectionType(e)&&(i.connection_type=e),o.gameEngineVersion&&(i.engine_version=o.gameEngineVersion),i},t.getInitAnnotations=function(){var i={};return t.getIdentifier()||t.cacheIdentifier(),i.user_id=t.getIdentifier(),i.sdk_version=o.getRelevantSdkVersion(),i.os_version=o.osVersion,i.platform=o.buildPlatform,t.getBuild()?i.build=t.getBuild():i.build=null,i.session_num=t.getSessionNum(),i.random_salt=t.getSessionNum(),i},t.getClientTsAdjusted=function(){var i=p.timeIntervalSince1970(),e=i+t.instance.clientServerTimeOffset;return u.validateClientTs(e)?e:i},t.sessionIsStarted=function(){return t.instance.sessionStart!=0},t.cacheIdentifier=function(){t.instance.userId?t.instance.identifier=t.instance.userId:t.instance.defaultUserId&&(t.instance.identifier=t.instance.defaultUserId)},t.ensurePersistedStates=function(){r.isStorageAvailable()&&r.load(t.getGameKey());var i=t.instance;i.setDefaultId(r.getItem(t.getGameKey(),t.DefaultUserIdKey)!=null?r.getItem(t.getGameKey(),t.DefaultUserIdKey):p.createGuid()),i.sessionNum=r.getItem(t.getGameKey(),t.SessionNumKey)!=null?Number(r.getItem(t.getGameKey(),t.SessionNumKey)):0,i.transactionNum=r.getItem(t.getGameKey(),t.TransactionNumKey)!=null?Number(r.getItem(t.getGameKey(),t.TransactionNumKey)):0,i.currentCustomDimension01?r.setItem(t.getGameKey(),t.Dimension01Key,i.currentCustomDimension01):(i.currentCustomDimension01=r.getItem(t.getGameKey(),t.Dimension01Key)!=null?r.getItem(t.getGameKey(),t.Dimension01Key):"",i.currentCustomDimension01),i.currentCustomDimension02?r.setItem(t.getGameKey(),t.Dimension02Key,i.currentCustomDimension02):(i.currentCustomDimension02=r.getItem(t.getGameKey(),t.Dimension02Key)!=null?r.getItem(t.getGameKey(),t.Dimension02Key):"",i.currentCustomDimension02),i.currentCustomDimension03?r.setItem(t.getGameKey(),t.Dimension03Key,i.currentCustomDimension03):(i.currentCustomDimension03=r.getItem(t.getGameKey(),t.Dimension03Key)!=null?r.getItem(t.getGameKey(),t.Dimension03Key):"",i.currentCustomDimension03);var e=r.getItem(t.getGameKey(),t.SdkConfigCachedKey)!=null?r.getItem(t.getGameKey(),t.SdkConfigCachedKey):"";if(e){var n=JSON.parse(p.decode64(e));n&&(i.sdkConfigCached=n)}var s=t.getSdkConfig();i.configsHash=s.configs_hash?s.configs_hash:"",i.abId=s.ab_id?s.ab_id:"",i.abVariantId=s.ab_variant_id?s.ab_variant_id:"";var c=r.select(f.Progression);if(c)for(var v=0;v<c.length;++v){var m=c[v];m&&(i.progressionTries[m.progression]=m.tries)}},t.calculateServerTimeOffset=function(i){return i-p.timeIntervalSince1970()},t.validateAndCleanCustomFields=function(i){var e={};if(i){var n=0;for(var s in i){var c=i[s];if(s&&c)if(n<t.MAX_CUSTOM_FIELDS_COUNT){var v=new RegExp("^[a-zA-Z0-9_]{1,"+t.MAX_CUSTOM_FIELDS_KEY_LENGTH+"}$");if(p.stringMatch(s,v)){var m=typeof c;if(m=="string"||c instanceof String)c.length<=t.MAX_CUSTOM_FIELDS_VALUE_STRING_LENGTH&&0<c.length?(e[s]=c,++n):a.w("validateAndCleanCustomFields: entry with key="+s+", value="+c+" has been omitted because its value is an empty string or exceeds the max number of characters ("+t.MAX_CUSTOM_FIELDS_VALUE_STRING_LENGTH+")");else if(m=="number"||c instanceof Number){var A=c;e[s]=A,++n}else a.w("validateAndCleanCustomFields: entry with key="+s+", value="+c+" has been omitted because its value is not a string or number")}else a.w("validateAndCleanCustomFields: entry with key="+s+", value="+c+" has been omitted because its key contains illegal character, is empty or exceeds the max number of characters ("+t.MAX_CUSTOM_FIELDS_KEY_LENGTH+")")}else a.w("validateAndCleanCustomFields: entry with key="+s+", value="+c+" has been omitted because it exceeds the max number of custom fields ("+t.MAX_CUSTOM_FIELDS_COUNT+")");else a.w("validateAndCleanCustomFields: entry with key="+s+", value="+c+" has been omitted because its key or value is null")}}return e},t.validateAndFixCurrentDimensions=function(){u.validateDimension01(t.getCurrentCustomDimension01(),t.getAvailableCustomDimensions01())||t.setCustomDimension01(""),u.validateDimension02(t.getCurrentCustomDimension02(),t.getAvailableCustomDimensions02())||t.setCustomDimension02(""),u.validateDimension03(t.getCurrentCustomDimension03(),t.getAvailableCustomDimensions03())||t.setCustomDimension03("")},t.getConfigurationStringValue=function(i,e){return t.instance.configurations[i]?t.instance.configurations[i].toString():e},t.isRemoteConfigsReady=function(){return t.instance.remoteConfigsIsReady},t.addRemoteConfigsListener=function(i){t.instance.remoteConfigsListeners.indexOf(i)<0&&t.instance.remoteConfigsListeners.push(i)},t.removeRemoteConfigsListener=function(i){var e=t.instance.remoteConfigsListeners.indexOf(i);-1<e&&t.instance.remoteConfigsListeners.splice(e,1)},t.getRemoteConfigsContentAsString=function(){return JSON.stringify(t.instance.configurations)},t.populateConfigurations=function(i){var e=i.configs;if(e){t.instance.configurations={};for(var n=0;n<e.length;++n){var s=e[n];if(s){var c=s.key,v=s.value,m=s.start_ts?s.start_ts:Number.MIN_VALUE,A=s.end_ts?s.end_ts:Number.MAX_VALUE,S=t.getClientTsAdjusted();c&&v&&m<S&&S<A&&(t.instance.configurations[c]=v)}}}t.instance.remoteConfigsIsReady=!0;var h=t.instance.remoteConfigsListeners;for(n=0;n<h.length;++n)h[n]&&h[n].onRemoteConfigsUpdated()},t.addOnBeforeUnloadListener=function(i){t.instance.beforeUnloadListeners.indexOf(i)<0&&t.instance.beforeUnloadListeners.push(i)},t.removeOnBeforeUnloadListener=function(i){var e=t.instance.beforeUnloadListeners.indexOf(i);-1<e&&t.instance.beforeUnloadListeners.splice(e,1)},t.notifyBeforeUnloadListeners=function(){for(var i=t.instance.beforeUnloadListeners,e=0;e<i.length;++e)i[e]&&i[e].onBeforeUnload()},t.CategorySdkError="sdk_error",t.MAX_CUSTOM_FIELDS_COUNT=50,t.MAX_CUSTOM_FIELDS_KEY_LENGTH=64,t.MAX_CUSTOM_FIELDS_VALUE_STRING_LENGTH=256,t.instance=new t,t.DefaultUserIdKey="default_user_id",t.SessionNumKey="session_num",t.TransactionNumKey="transaction_num",t.Dimension01Key="dimension01",t.Dimension02Key="dimension02",t.Dimension03Key="dimension03",t.SdkConfigCachedKey="sdk_config_cached",E=t,g.GAState=E}(b=b||{}),function(l){var g,u,p,a;function r(){}g=l.tasks||(l.tasks={}),u=l.utilities.GAUtilities,p=l.logging.GALogger,r.execute=function(o,f,d,E){var t=new Date;if(r.timestampMap[f]||(r.timestampMap[f]=t),r.countMap[f]||(r.countMap[f]=0),3600<=(t.getTime()-r.timestampMap[f].getTime())/1e3&&(r.timestampMap[f]=t,r.countMap[f]=0),!(r.countMap[f]>=r.MaxCount)){var i=u.getHmac(E,d),e=new XMLHttpRequest;e.onreadystatechange=function(){if(e.readyState===4){if(!e.responseText)return;if(e.status!=200)return void p.w("sdk error failed. response code not 200. status code: "+e.status+", description: "+e.statusText+", body: "+e.responseText);r.countMap[f]=r.countMap[f]+1}},e.open("POST",o,!0),e.setRequestHeader("Content-Type","application/json"),e.setRequestHeader("Authorization",i);try{e.send(d)}catch(n){console.error(n)}}},r.MaxCount=10,r.countMap={},r.timestampMap={},a=r,g.SdkErrorTask=a}(b=b||{}),function(l){var g,u,p,a,r,o,f,d,E,t,i;function e(){this.protocol="https",this.hostName="api.gameanalytics.com",this.version="v2",this.remoteConfigsVersion="v1",this.baseUrl="patch/json/null.json?"+this.protocol+"://"+this.hostName+"/"+this.version,this.remoteConfigsBaseUrl="patch/json/null.json?"+this.protocol+"://"+this.hostName+"/remote_configs/"+this.remoteConfigsVersion,this.initializeUrlPath="init",this.eventsUrlPath="events",this.useGzip=!1}g=l.http||(l.http={}),u=l.state.GAState,p=l.logging.GALogger,a=l.utilities.GAUtilities,r=l.validators.GAValidator,o=l.tasks.SdkErrorTask,f=l.events.EGASdkErrorCategory,d=l.events.EGASdkErrorArea,E=l.events.EGASdkErrorAction,t=l.events.EGASdkErrorParameter,e.prototype.requestInit=function(n,s){var c=u.getGameKey(),v=this.remoteConfigsBaseUrl+"/"+this.initializeUrlPath+"?game_key="+c+"&interval_seconds=0&configs_hash="+n,m=u.getInitAnnotations(),A=JSON.stringify(m);if(A){var S=this.createPayloadData(A,this.useGzip),h=[];h.push(A),e.sendRequest(v,S,h,this.useGzip,e.initRequestCallback,s)}else s(g.EGAHTTPApiResponse.JsonEncodeFailed,null)},e.prototype.sendEventsInArray=function(n,s,c){if(n.length!=0){var v=u.getGameKey(),m=this.baseUrl+"/"+v+"/"+this.eventsUrlPath,A=JSON.stringify(n);if(A){var S=this.createPayloadData(A,this.useGzip),h=[];h.push(A),h.push(s),h.push(n.length.toString()),e.sendRequest(m,S,h,this.useGzip,e.sendEventInArrayRequestCallback,c)}else c(g.EGAHTTPApiResponse.JsonEncodeFailed,null,s,n.length)}},e.prototype.sendSdkErrorEvent=function(n,s,c,v,m,A,S){if(u.isEventSubmissionEnabled()&&r.validateSdkErrorEvent(A,S,n,s,c)){var h,y=this.baseUrl+"/"+A+"/"+this.eventsUrlPath,C="",T=u.getSdkErrorEventAnnotations(),G=e.sdkErrorCategoryString(n);C+=T.error_category=G;var I=e.sdkErrorAreaString(s);C+=":"+(T.error_area=I);var _=e.sdkErrorActionString(c);T.error_action=_;var w=e.sdkErrorParameterString(v);if(0<w.length&&(T.error_parameter=w),0<m.length){var P=m;m.length>e.MAX_ERROR_MESSAGE_LENGTH&&(P=m.substring(0,e.MAX_ERROR_MESSAGE_LENGTH)),T.reason=P}var D=[];D.push(T),(h=JSON.stringify(D))?o.execute(y,C,h,S):p.w("sendSdkErrorEvent: JSON encoding failed.")}},e.sendEventInArrayRequestCallback=function(n,s,c,v){v===void 0&&(v=null),v[0],v[1];var m,A,S=v[2],h=parseInt(v[3]);m=n.responseText,A=n.status;var y=e.instance.processRequestResponse(A,n.statusText,m,"Events");if(y==g.EGAHTTPApiResponse.Ok||y==g.EGAHTTPApiResponse.Created||y==g.EGAHTTPApiResponse.BadRequest){var C=m?JSON.parse(m):{};if(C==null)return c(g.EGAHTTPApiResponse.JsonDecodeFailed,null,S,h),void e.instance.sendSdkErrorEvent(f.Http,d.EventsHttp,E.FailHttpJsonDecode,t.Undefined,m,u.getGameKey(),u.getGameSecret());g.EGAHTTPApiResponse.BadRequest,c(y,C,S,h)}else c(y,null,S,h)},e.sendRequest=function(n,s,c,v,m,A){var S=new XMLHttpRequest,h=u.getGameSecret(),y=a.getHmac(h,s),C=[];for(var T in C.push(y),c)C.push(c[T]);if(S.onreadystatechange=function(){S.readyState===4&&m(S,n,A,C)},S.open("POST",n,!0),S.setRequestHeader("Content-Type","application/json"),S.setRequestHeader("Authorization",y),v)throw new Error("gzip not supported");try{S.send(s)}catch(G){console.error(G.stack)}},e.initRequestCallback=function(n,s,c,v){var m,A;v===void 0&&(v=null),v[0],v[1],m=n.responseText,A=n.status;var S=m?JSON.parse(m):{},h=e.instance.processRequestResponse(A,n.statusText,m,"Init");if(h==g.EGAHTTPApiResponse.Ok||h==g.EGAHTTPApiResponse.Created||h==g.EGAHTTPApiResponse.BadRequest){if(S==null)return c(g.EGAHTTPApiResponse.JsonDecodeFailed,null,"",0),void e.instance.sendSdkErrorEvent(f.Http,d.InitHttp,E.FailHttpJsonDecode,t.Undefined,m,u.getGameKey(),u.getGameSecret());if(h!==g.EGAHTTPApiResponse.BadRequest){var y=r.validateAndCleanInitRequestResponse(S,h===g.EGAHTTPApiResponse.Created);y?c(h,y,"",0):c(g.EGAHTTPApiResponse.BadResponse,null,"",0)}else c(h,null,"",0)}else c(h,null,"",0)},e.prototype.createPayloadData=function(n,s){if(s)throw new Error("gzip not supported");return n},e.prototype.processRequestResponse=function(n,s,c,v){return c?n===200?g.EGAHTTPApiResponse.Ok:n===201?g.EGAHTTPApiResponse.Created:n===0||n===401?g.EGAHTTPApiResponse.Unauthorized:n===400?g.EGAHTTPApiResponse.BadRequest:n===500?g.EGAHTTPApiResponse.InternalServerError:g.EGAHTTPApiResponse.UnknownResponseCode:g.EGAHTTPApiResponse.NoResponse},e.sdkErrorCategoryString=function(n){switch(n){case f.EventValidation:return"event_validation";case f.Database:return"db";case f.Init:return"init";case f.Http:return"http";case f.Json:return"json"}return""},e.sdkErrorAreaString=function(n){switch(n){case d.BusinessEvent:return"business";case d.ResourceEvent:return"resource";case d.ProgressionEvent:return"progression";case d.DesignEvent:return"design";case d.ErrorEvent:return"error";case d.InitHttp:return"init_http";case d.EventsHttp:return"events_http";case d.ProcessEvents:return"process_events";case d.AddEventsToStore:return"add_events_to_store"}return""},e.sdkErrorActionString=function(n){switch(n){case E.InvalidCurrency:return"invalid_currency";case E.InvalidShortString:return"invalid_short_string";case E.InvalidEventPartLength:return"invalid_event_part_length";case E.InvalidEventPartCharacters:return"invalid_event_part_characters";case E.InvalidStore:return"invalid_store";case E.InvalidFlowType:return"invalid_flow_type";case E.StringEmptyOrNull:return"string_empty_or_null";case E.NotFoundInAvailableCurrencies:return"not_found_in_available_currencies";case E.InvalidAmount:return"invalid_amount";case E.NotFoundInAvailableItemTypes:return"not_found_in_available_item_types";case E.WrongProgressionOrder:return"wrong_progression_order";case E.InvalidEventIdLength:return"invalid_event_id_length";case E.InvalidEventIdCharacters:return"invalid_event_id_characters";case E.InvalidProgressionStatus:return"invalid_progression_status";case E.InvalidSeverity:return"invalid_severity";case E.InvalidLongString:return"invalid_long_string";case E.DatabaseTooLarge:return"db_too_large";case E.DatabaseOpenOrCreate:return"db_open_or_create";case E.JsonError:return"json_error";case E.FailHttpJsonDecode:return"fail_http_json_decode";case E.FailHttpJsonEncode:return"fail_http_json_encode"}return""},e.sdkErrorParameterString=function(n){switch(n){case t.Currency:return"currency";case t.CartType:return"cart_type";case t.ItemType:return"item_type";case t.ItemId:return"item_id";case t.Store:return"store";case t.FlowType:return"flow_type";case t.Amount:return"amount";case t.Progression01:return"progression01";case t.Progression02:return"progression02";case t.Progression03:return"progression03";case t.EventId:return"event_id";case t.ProgressionStatus:return"progression_status";case t.Severity:return"severity";case t.Message:return"message"}return""},e.instance=new e,e.MAX_ERROR_MESSAGE_LENGTH=256,i=e,g.GAHTTPApi=i}(b=b||{}),function(l){var g,u,p,a,r,o,f,d,E,t,i;function e(){}g=l.events||(l.events={}),u=l.store.GAStore,p=l.store.EGAStore,a=l.store.EGAStoreArgsOperator,r=l.state.GAState,o=l.logging.GALogger,f=l.utilities.GAUtilities,d=l.http.EGAHTTPApiResponse,E=l.http.GAHTTPApi,t=l.validators.GAValidator,e.addSessionStartEvent=function(){if(r.isEventSubmissionEnabled()){var n={};n.category=e.CategorySessionStart,r.incrementSessionNum(),u.setItem(r.getGameKey(),r.SessionNumKey,r.getSessionNum().toString()),e.addDimensionsToEvent(n),e.addEventToStore(n),o.i("Add SESSION START event"),e.processEvents(e.CategorySessionStart,!1)}},e.addSessionEndEvent=function(){if(r.isEventSubmissionEnabled()){var n=r.getSessionStart(),s=r.getClientTsAdjusted()-n;s<0&&(o.w("Session length was calculated to be less then 0. Should not be possible. Resetting to 0."),s=0);var c={};c.category=e.CategorySessionEnd,c.length=s,e.addDimensionsToEvent(c),e.addEventToStore(c),o.i("Add SESSION END event."),e.processEvents("",!1)}},e.addBusinessEvent=function(n,s,c,v,m,A){if(m===void 0&&(m=null),r.isEventSubmissionEnabled()){var S=t.validateBusinessEvent(n,s,m,c,v);if(S==null){var h={};r.incrementTransactionNum(),u.setItem(r.getGameKey(),r.TransactionNumKey,r.getTransactionNum().toString()),h.event_id=c+":"+v,h.category=e.CategoryBusiness,h.currency=n,h.amount=s,h[r.TransactionNumKey]=r.getTransactionNum(),m&&(h.cart_type=m),e.addDimensionsToEvent(h),e.addFieldsToEvent(h,r.validateAndCleanCustomFields(A)),o.i("Add BUSINESS event: {currency:"+n+", amount:"+s+", itemType:"+c+", itemId:"+v+", cartType:"+m+"}"),e.addEventToStore(h)}else E.instance.sendSdkErrorEvent(S.category,S.area,S.action,S.parameter,S.reason,r.getGameKey(),r.getGameSecret())}},e.addResourceEvent=function(n,s,c,v,m,A){if(r.isEventSubmissionEnabled()){var S=t.validateResourceEvent(n,s,c,v,m,r.getAvailableResourceCurrencies(),r.getAvailableResourceItemTypes());if(S==null){n===l.EGAResourceFlowType.Sink&&(c*=-1);var h={},y=e.resourceFlowTypeToString(n);h.event_id=y+":"+s+":"+v+":"+m,h.category=e.CategoryResource,h.amount=c,e.addDimensionsToEvent(h),e.addFieldsToEvent(h,r.validateAndCleanCustomFields(A)),o.i("Add RESOURCE event: {currency:"+s+", amount:"+c+", itemType:"+v+", itemId:"+m+"}"),e.addEventToStore(h)}else E.instance.sendSdkErrorEvent(S.category,S.area,S.action,S.parameter,S.reason,r.getGameKey(),r.getGameSecret())}},e.addProgressionEvent=function(n,s,c,v,m,A,S){if(r.isEventSubmissionEnabled()){var h=e.progressionStatusToString(n),y=t.validateProgressionEvent(n,s,c,v);if(y==null){var C,T={};C=c?v?s+":"+c+":"+v:s+":"+c:s,T.category=e.CategoryProgression,T.event_id=h+":"+C;var G=0;A&&n!=l.EGAProgressionStatus.Start&&(T.score=m),n===l.EGAProgressionStatus.Fail&&r.incrementProgressionTries(C),n===l.EGAProgressionStatus.Complete&&(r.incrementProgressionTries(C),G=r.getProgressionTries(C),T.attempt_num=G,r.clearProgressionTries(C)),e.addDimensionsToEvent(T),e.addFieldsToEvent(T,r.validateAndCleanCustomFields(S)),o.i("Add PROGRESSION event: {status:"+h+", progression01:"+s+", progression02:"+c+", progression03:"+v+", score:"+m+", attempt:"+G+"}"),e.addEventToStore(T)}else E.instance.sendSdkErrorEvent(y.category,y.area,y.action,y.parameter,y.reason,r.getGameKey(),r.getGameSecret())}},e.addDesignEvent=function(n,s,c,v){if(r.isEventSubmissionEnabled()){var m=t.validateDesignEvent(n);if(m==null){var A={};A.category=e.CategoryDesign,A.event_id=n,c&&(A.value=s),e.addDimensionsToEvent(A),e.addFieldsToEvent(A,r.validateAndCleanCustomFields(v)),o.i("Add DESIGN event: {eventId:"+n+", value:"+s+"}"),e.addEventToStore(A)}else E.instance.sendSdkErrorEvent(m.category,m.area,m.action,m.parameter,m.reason,r.getGameKey(),r.getGameSecret())}},e.addErrorEvent=function(n,s,c){if(r.isEventSubmissionEnabled()){var v=e.errorSeverityToString(n),m=t.validateErrorEvent(n,s);if(m==null){var A={};A.category=e.CategoryError,A.severity=v,A.message=s,e.addDimensionsToEvent(A),e.addFieldsToEvent(A,r.validateAndCleanCustomFields(c)),o.i("Add ERROR event: {severity:"+v+", message:"+s+"}"),e.addEventToStore(A)}else E.instance.sendSdkErrorEvent(m.category,m.area,m.action,m.parameter,m.reason,r.getGameKey(),r.getGameSecret())}},e.addAdEvent=function(n,s,c,v,m,A,S,h){if(r.isEventSubmissionEnabled()){var y=e.adActionToString(n),C=e.adTypeToString(s),T=e.adErrorToString(m),G=t.validateAdEvent(n,s,c,v);if(G==null){var I={};I.category=e.CategoryAds,I.ad_sdk_name=c,I.ad_placement=v,I.ad_type=C,I.ad_action=y,n==l.EGAAdAction.FailedShow&&0<T.length&&(I.ad_fail_show_reason=T),!S||s!=l.EGAAdType.RewardedVideo&&s!=l.EGAAdType.Video||(I.ad_duration=A),e.addDimensionsToEvent(I),e.addFieldsToEvent(I,r.validateAndCleanCustomFields(h)),o.i("Add AD event: {ad_sdk_name:"+c+", ad_placement:"+v+", ad_type:"+C+", ad_action:"+y+(n==l.EGAAdAction.FailedShow&&0<T.length?", ad_fail_show_reason:"+T:"")+(!S||s!=l.EGAAdType.RewardedVideo&&s!=l.EGAAdType.Video?"":", ad_duration:"+A)+"}"),e.addEventToStore(I)}else E.instance.sendSdkErrorEvent(G.category,G.area,G.action,G.parameter,G.reason,r.getGameKey(),r.getGameSecret())}},e.processEvents=function(n,s){if(r.isEventSubmissionEnabled())try{var c=f.createGuid();s&&(e.cleanupEvents(),e.fixMissingSessionEndEvents());var v=[];v.push(["status",a.Equal,"new"]);var m=[];m.push(["status",a.Equal,"new"]),n&&(v.push(["category",a.Equal,n]),m.push(["category",a.Equal,n]));var A=[];A.push(["status",c]);var S=u.select(p.Events,v);if(!S||S.length==0)return o.i("Event queue: No events to send"),void e.updateSessionStore();if(S.length>e.MaxEventCount){if(!(S=u.select(p.Events,v,!0,e.MaxEventCount)))return;var h=S[S.length-1].client_ts;if(v.push(["client_ts",a.LessOrEqual,h]),!(S=u.select(p.Events,v)))return;m.push(["client_ts",a.LessOrEqual,h])}if(o.i("Event queue: Sending "+S.length+" events."),!u.update(p.Events,A,m))return;for(var y=[],C=0;C<S.length;++C){var T=S[C],G=JSON.parse(f.decode64(T.event));if(G.length!=0){var I=G.client_ts;I&&!t.validateClientTs(I)&&delete G.client_ts,y.push(G)}}E.instance.sendEventsInArray(y,c,e.processEventsCallback)}catch(_){o.e("Error during ProcessEvents(): "+_.stack),E.instance.sendSdkErrorEvent(g.EGASdkErrorCategory.Json,g.EGASdkErrorArea.ProcessEvents,g.EGASdkErrorAction.JsonError,g.EGASdkErrorParameter.Undefined,_.stack,r.getGameKey(),r.getGameSecret())}},e.processEventsCallback=function(n,s,c,v){var m=[];if(m.push(["status",a.Equal,c]),n===d.Ok)u.delete(p.Events,m),o.i("Event queue: "+v+" events sent.");else if(n===d.NoResponse){var A=[];A.push(["status","new"]),o.w("Event queue: Failed to send events to collector - Retrying next time"),u.update(p.Events,A,m)}else{if(s){var S,h=0;for(var y in s)h==0&&(S=s[y]),++h;n===d.BadRequest&&S.constructor===Array?o.w("Event queue: "+v+" events sent. "+h+" events failed GA server validation."):o.w("Event queue: Failed to send events.")}else o.w("Event queue: Failed to send events.");u.delete(p.Events,m)}},e.cleanupEvents=function(){u.update(p.Events,[["status","new"]])},e.fixMissingSessionEndEvents=function(){if(r.isEventSubmissionEnabled()){var n=[];n.push(["session_id",a.NotEqual,r.getSessionId()]);var s=u.select(p.Sessions,n);if(s&&s.length!=0){o.i(s.length+" session(s) located with missing session_end event.");for(var c=0;c<s.length;++c){var v=JSON.parse(f.decode64(s[c].event)),m=v.client_ts-s[c].timestamp;m=Math.max(0,m),v.category=e.CategorySessionEnd,v.length=m,e.addEventToStore(v)}}}},e.addEventToStore=function(n){if(r.isEventSubmissionEnabled())if(r.isInitialized())try{if(u.isStoreTooLargeForEvents()&&!f.stringMatch(n.category,/^(user|session_end|business)$/))return o.w("Database too large. Event has been blocked."),void E.instance.sendSdkErrorEvent(g.EGASdkErrorCategory.Database,g.EGASdkErrorArea.AddEventsToStore,g.EGASdkErrorAction.DatabaseTooLarge,g.EGASdkErrorParameter.Undefined,"",r.getGameKey(),r.getGameSecret());var s=r.getEventAnnotations(),c=f.encode64(JSON.stringify(s));for(var v in n)s[v]=n[v];var m=JSON.stringify(s);o.ii("Event added to queue: "+m);var A={status:"new"};A.category=s.category,A.session_id=s.session_id,A.client_ts=s.client_ts,A.event=f.encode64(JSON.stringify(s)),u.insert(p.Events,A),n.category==e.CategorySessionEnd?u.delete(p.Sessions,[["session_id",a.Equal,s.session_id]]):((A={}).session_id=s.session_id,A.timestamp=r.getSessionStart(),A.event=c,u.insert(p.Sessions,A,!0,"session_id")),u.isStorageAvailable()&&u.save(r.getGameKey())}catch(S){o.e("addEventToStore: error"),o.e(S.stack),E.instance.sendSdkErrorEvent(g.EGASdkErrorCategory.Database,g.EGASdkErrorArea.AddEventsToStore,g.EGASdkErrorAction.DatabaseTooLarge,g.EGASdkErrorParameter.Undefined,S.stack,r.getGameKey(),r.getGameSecret())}else o.w("Could not add event: SDK is not initialized")},e.updateSessionStore=function(){if(r.sessionIsStarted()){var n={};n.session_id=r.instance.sessionId,n.timestamp=r.getSessionStart(),n.event=f.encode64(JSON.stringify(r.getEventAnnotations())),u.insert(p.Sessions,n,!0,"session_id"),u.isStorageAvailable()&&u.save(r.getGameKey())}},e.addDimensionsToEvent=function(n){n&&(r.getCurrentCustomDimension01()&&(n.custom_01=r.getCurrentCustomDimension01()),r.getCurrentCustomDimension02()&&(n.custom_02=r.getCurrentCustomDimension02()),r.getCurrentCustomDimension03()&&(n.custom_03=r.getCurrentCustomDimension03()))},e.addFieldsToEvent=function(n,s){n&&s&&0<Object.keys(s).length&&(n.custom_fields=s)},e.resourceFlowTypeToString=function(n){return n==l.EGAResourceFlowType.Source||n==l.EGAResourceFlowType[l.EGAResourceFlowType.Source]?"Source":n==l.EGAResourceFlowType.Sink||n==l.EGAResourceFlowType[l.EGAResourceFlowType.Sink]?"Sink":""},e.progressionStatusToString=function(n){return n==l.EGAProgressionStatus.Start||n==l.EGAProgressionStatus[l.EGAProgressionStatus.Start]?"Start":n==l.EGAProgressionStatus.Complete||n==l.EGAProgressionStatus[l.EGAProgressionStatus.Complete]?"Complete":n==l.EGAProgressionStatus.Fail||n==l.EGAProgressionStatus[l.EGAProgressionStatus.Fail]?"Fail":""},e.errorSeverityToString=function(n){return n==l.EGAErrorSeverity.Debug||n==l.EGAErrorSeverity[l.EGAErrorSeverity.Debug]?"debug":n==l.EGAErrorSeverity.Info||n==l.EGAErrorSeverity[l.EGAErrorSeverity.Info]?"info":n==l.EGAErrorSeverity.Warning||n==l.EGAErrorSeverity[l.EGAErrorSeverity.Warning]?"warning":n==l.EGAErrorSeverity.Error||n==l.EGAErrorSeverity[l.EGAErrorSeverity.Error]?"error":n==l.EGAErrorSeverity.Critical||n==l.EGAErrorSeverity[l.EGAErrorSeverity.Critical]?"critical":""},e.adActionToString=function(n){return n==l.EGAAdAction.Clicked||n==l.EGAAdAction[l.EGAAdAction.Clicked]?"clicked":n==l.EGAAdAction.Show||n==l.EGAAdAction[l.EGAAdAction.Show]?"show":n==l.EGAAdAction.FailedShow||n==l.EGAAdAction[l.EGAAdAction.FailedShow]?"failed_show":n==l.EGAAdAction.RewardReceived||n==l.EGAAdAction[l.EGAAdAction.RewardReceived]?"reward_received":""},e.adErrorToString=function(n){return n==l.EGAAdError.Unknown||n==l.EGAAdError[l.EGAAdError.Unknown]?"unknown":n==l.EGAAdError.Offline||n==l.EGAAdError[l.EGAAdError.Offline]?"offline":n==l.EGAAdError.NoFill||n==l.EGAAdError[l.EGAAdError.NoFill]?"no_fill":n==l.EGAAdError.InternalError||n==l.EGAAdError[l.EGAAdError.InternalError]?"internal_error":n==l.EGAAdError.InvalidRequest||n==l.EGAAdError[l.EGAAdError.InvalidRequest]?"invalid_request":n==l.EGAAdError.UnableToPrecache||n==l.EGAAdError[l.EGAAdError.UnableToPrecache]?"unable_to_precache":""},e.adTypeToString=function(n){return n==l.EGAAdType.Video||n==l.EGAAdType[l.EGAAdType.Video]?"video":n==l.EGAAdType.RewardedVideo||n==l.EGAAdError[l.EGAAdType.RewardedVideo]?"rewarded_video":n==l.EGAAdType.Playable||n==l.EGAAdError[l.EGAAdType.Playable]?"playable":n==l.EGAAdType.Interstitial||n==l.EGAAdError[l.EGAAdType.Interstitial]?"interstitial":n==l.EGAAdType.OfferWall||n==l.EGAAdError[l.EGAAdType.OfferWall]?"offer_wall":n==l.EGAAdType.Banner||n==l.EGAAdError[l.EGAAdType.Banner]?"banner":""},e.CategorySessionStart="user",e.CategorySessionEnd="session_end",e.CategoryDesign="design",e.CategoryBusiness="business",e.CategoryProgression="progression",e.CategoryResource="resource",e.CategoryError="error",e.CategoryAds="ads",e.MaxEventCount=500,i=e,g.GAEvents=i}(b=b||{}),function(l){var g,u,p,a,r;function o(){this.blocks=new g.PriorityQueue({compare:function(f,d){return f-d}}),this.id2TimedBlockMap={},o.startThread()}g=l.threading||(l.threading={}),u=l.logging.GALogger,p=l.state.GAState,a=l.events.GAEvents,o.createTimedBlock=function(f){f===void 0&&(f=0);var d=new Date;return d.setSeconds(d.getSeconds()+f),new g.TimedBlock(d)},o.performTaskOnGAThread=function(f,d){d===void 0&&(d=0);var E=new Date;E.setSeconds(E.getSeconds()+d);var t=new g.TimedBlock(E);t.block=f,o.instance.id2TimedBlockMap[t.id]=t,o.instance.addTimedBlock(t)},o.performTimedBlockOnGAThread=function(f){o.instance.id2TimedBlockMap[f.id]=f,o.instance.addTimedBlock(f)},o.scheduleTimer=function(f,d){var E=new Date;E.setSeconds(E.getSeconds()+f);var t=new g.TimedBlock(E);return t.block=d,o.instance.id2TimedBlockMap[t.id]=t,o.instance.addTimedBlock(t),t.id},o.getTimedBlockById=function(f){return f in o.instance.id2TimedBlockMap?o.instance.id2TimedBlockMap[f]:null},o.ensureEventQueueIsRunning=function(){o.instance.keepRunning=!0,o.instance.isRunning||(o.instance.isRunning=!0,o.scheduleTimer(o.ProcessEventsIntervalInSeconds,o.processEventQueue))},o.endSessionAndStopQueue=function(){p.isInitialized()&&(u.i("Ending session."),o.stopEventQueue(),p.isEnabled()&&p.sessionIsStarted()&&(a.addSessionEndEvent(),p.instance.sessionStart=0))},o.stopEventQueue=function(){o.instance.keepRunning=!1},o.ignoreTimer=function(f){f in o.instance.id2TimedBlockMap&&(o.instance.id2TimedBlockMap[f].ignore=!0)},o.setEventProcessInterval=function(f){0<f&&(o.ProcessEventsIntervalInSeconds=f)},o.prototype.addTimedBlock=function(f){this.blocks.enqueue(f.deadline.getTime(),f)},o.run=function(){clearTimeout(o.runTimeoutId);try{for(var f;f=o.getNextBlock();)if(!f.ignore)if(f.async){if(!f.running){f.running=!0,f.block();break}}else f.block();return void(o.runTimeoutId=setTimeout(o.run,o.ThreadWaitTimeInMs))}catch(d){u.e("Error on GA thread"),u.e(d.stack)}},o.startThread=function(){o.runTimeoutId=setTimeout(o.run,0)},o.getNextBlock=function(){var f=new Date;return o.instance.blocks.hasItems()&&o.instance.blocks.peek().deadline.getTime()<=f.getTime()?o.instance.blocks.peek().async&&o.instance.blocks.peek().running?o.instance.blocks.peek():o.instance.blocks.dequeue():null},o.processEventQueue=function(){a.processEvents("",!0),o.instance.keepRunning?o.scheduleTimer(o.ProcessEventsIntervalInSeconds,o.processEventQueue):o.instance.isRunning=!1},o.instance=new o,o.ThreadWaitTimeInMs=1e3,o.ProcessEventsIntervalInSeconds=8,r=o,g.GAThreading=r}(b=b||{}),function(l){var g=l.threading.GAThreading,u=l.logging.GALogger,p=l.store.GAStore,a=l.state.GAState,r=l.http.GAHTTPApi,o=l.device.GADevice,f=l.validators.GAValidator,d=l.http.EGAHTTPApiResponse,E=l.utilities.GAUtilities,t=l.events.GAEvents,i=(e.getGlobalObject=function(){return typeof globalThis!="undefined"?globalThis:typeof self!="undefined"?self:typeof window!="undefined"?window:typeof global!="undefined"?global:void 0},e.init=function(){if(o.touch(),e.methodMap.configureAvailableCustomDimensions01=e.configureAvailableCustomDimensions01,e.methodMap.configureAvailableCustomDimensions02=e.configureAvailableCustomDimensions02,e.methodMap.configureAvailableCustomDimensions03=e.configureAvailableCustomDimensions03,e.methodMap.configureAvailableResourceCurrencies=e.configureAvailableResourceCurrencies,e.methodMap.configureAvailableResourceItemTypes=e.configureAvailableResourceItemTypes,e.methodMap.configureBuild=e.configureBuild,e.methodMap.configureSdkGameEngineVersion=e.configureSdkGameEngineVersion,e.methodMap.configureGameEngineVersion=e.configureGameEngineVersion,e.methodMap.configureUserId=e.configureUserId,e.methodMap.initialize=e.initialize,e.methodMap.addBusinessEvent=e.addBusinessEvent,e.methodMap.addResourceEvent=e.addResourceEvent,e.methodMap.addProgressionEvent=e.addProgressionEvent,e.methodMap.addDesignEvent=e.addDesignEvent,e.methodMap.addErrorEvent=e.addErrorEvent,e.methodMap.addErrorEvent=e.addErrorEvent,e.methodMap.setEnabledInfoLog=e.setEnabledInfoLog,e.methodMap.setEnabledVerboseLog=e.setEnabledVerboseLog,e.methodMap.setEnabledManualSessionHandling=e.setEnabledManualSessionHandling,e.methodMap.setEnabledEventSubmission=e.setEnabledEventSubmission,e.methodMap.setCustomDimension01=e.setCustomDimension01,e.methodMap.setCustomDimension02=e.setCustomDimension02,e.methodMap.setCustomDimension03=e.setCustomDimension03,e.methodMap.setEventProcessInterval=e.setEventProcessInterval,e.methodMap.startSession=e.startSession,e.methodMap.endSession=e.endSession,e.methodMap.onStop=e.onStop,e.methodMap.onResume=e.onResume,e.methodMap.addRemoteConfigsListener=e.addRemoteConfigsListener,e.methodMap.removeRemoteConfigsListener=e.removeRemoteConfigsListener,e.methodMap.getRemoteConfigsValueAsString=e.getRemoteConfigsValueAsString,e.methodMap.isRemoteConfigsReady=e.isRemoteConfigsReady,e.methodMap.getRemoteConfigsContentAsString=e.getRemoteConfigsContentAsString,e.methodMap.addOnBeforeUnloadListener=e.addOnBeforeUnloadListener,e.methodMap.removeOnBeforeUnloadListener=e.removeOnBeforeUnloadListener,e.getGlobalObject()!==void 0&&e.getGlobalObject().GameAnalytics!==void 0&&e.getGlobalObject().GameAnalytics.q!==void 0){var n=e.getGlobalObject().GameAnalytics.q;for(var s in n)e.gaCommand.apply(null,n[s])}window.addEventListener("beforeunload",function(c){console.log("addEventListener unload"),a.instance.isUnloading=!0,a.notifyBeforeUnloadListeners(),g.endSessionAndStopQueue(),a.instance.isUnloading=!1})},e.gaCommand=function(){for(var n=[],s=0;s<arguments.length;s++)n[s]=arguments[s];0<n.length&&n[0]in l.GameAnalytics.methodMap&&(1<n.length?l.GameAnalytics.methodMap[n[0]].apply(null,Array.prototype.slice.call(n,1)):l.GameAnalytics.methodMap[n[0]]())},e.configureAvailableCustomDimensions01=function(n){n===void 0&&(n=[]),g.performTaskOnGAThread(function(){e.isSdkReady(!0,!1)?u.w("Available custom dimensions must be set before SDK is initialized"):a.setAvailableCustomDimensions01(n)})},e.configureAvailableCustomDimensions02=function(n){n===void 0&&(n=[]),g.performTaskOnGAThread(function(){e.isSdkReady(!0,!1)?u.w("Available custom dimensions must be set before SDK is initialized"):a.setAvailableCustomDimensions02(n)})},e.configureAvailableCustomDimensions03=function(n){n===void 0&&(n=[]),g.performTaskOnGAThread(function(){e.isSdkReady(!0,!1)?u.w("Available custom dimensions must be set before SDK is initialized"):a.setAvailableCustomDimensions03(n)})},e.configureAvailableResourceCurrencies=function(n){n===void 0&&(n=[]),g.performTaskOnGAThread(function(){e.isSdkReady(!0,!1)?u.w("Available resource currencies must be set before SDK is initialized"):a.setAvailableResourceCurrencies(n)})},e.configureAvailableResourceItemTypes=function(n){n===void 0&&(n=[]),g.performTaskOnGAThread(function(){e.isSdkReady(!0,!1)?u.w("Available resource item types must be set before SDK is initialized"):a.setAvailableResourceItemTypes(n)})},e.configureBuild=function(n){n===void 0&&(n=""),g.performTaskOnGAThread(function(){e.isSdkReady(!0,!1)?u.w("Build version must be set before SDK is initialized."):f.validateBuild(n)?a.setBuild(n):u.i("Validation fail - configure build: Cannot be null, empty or above 32 length. String: "+n)})},e.configureSdkGameEngineVersion=function(n){n===void 0&&(n=""),g.performTaskOnGAThread(function(){e.isSdkReady(!0,!1)||(f.validateSdkWrapperVersion(n)?o.sdkGameEngineVersion=n:u.i("Validation fail - configure sdk version: Sdk version not supported. String: "+n))})},e.configureGameEngineVersion=function(n){n===void 0&&(n=""),g.performTaskOnGAThread(function(){e.isSdkReady(!0,!1)||(f.validateEngineVersion(n)?o.gameEngineVersion=n:u.i("Validation fail - configure game engine version: Game engine version not supported. String: "+n))})},e.configureUserId=function(n){n===void 0&&(n=""),g.performTaskOnGAThread(function(){e.isSdkReady(!0,!1)?u.w("A custom user id must be set before SDK is initialized."):f.validateUserId(n)?a.setUserId(n):u.i("Validation fail - configure user_id: Cannot be null, empty or above 64 length. Will use default user_id method. Used string: "+n)})},e.initialize=function(n,s){n===void 0&&(n=""),s===void 0&&(s=""),o.updateConnectionType();var c=g.createTimedBlock();c.async=!0,e.initTimedBlockId=c.id,c.block=function(){e.isSdkReady(!0,!1)?u.w("SDK already initialized. Can only be called once."):f.validateKeys(n,s)?(a.setKeys(n,s),e.internalInitialize()):u.w("SDK failed initialize. Game key or secret key is invalid. Can only contain characters A-z 0-9, gameKey is 32 length, gameSecret is 40 length. Failed keys - gameKey: "+n+", secretKey: "+s)},g.performTimedBlockOnGAThread(c)},e.addBusinessEvent=function(n,s,c,v,m){if(n===void 0&&(n=""),s===void 0&&(s=0),c===void 0&&(c=""),v===void 0&&(v=""),m===void 0&&(m=""),o.updateConnectionType(),a.instance.isUnloading){if(!e.isSdkReady(!0,!0,"Could not add business event"))return;t.addBusinessEvent(n,s,c,v,m,{})}else g.performTaskOnGAThread(function(){e.isSdkReady(!0,!0,"Could not add business event")&&t.addBusinessEvent(n,s,c,v,m,{})})},e.addResourceEvent=function(n,s,c,v,m){if(n===void 0&&(n=l.EGAResourceFlowType.Undefined),s===void 0&&(s=""),c===void 0&&(c=0),v===void 0&&(v=""),m===void 0&&(m=""),o.updateConnectionType(),a.instance.isUnloading){if(!e.isSdkReady(!0,!0,"Could not add resource event"))return;t.addResourceEvent(n,s,c,v,m,{})}else g.performTaskOnGAThread(function(){e.isSdkReady(!0,!0,"Could not add resource event")&&t.addResourceEvent(n,s,c,v,m,{})})},e.addProgressionEvent=function(n,s,c,v,m){if(n===void 0&&(n=l.EGAProgressionStatus.Undefined),s===void 0&&(s=""),c===void 0&&(c=""),v===void 0&&(v=""),o.updateConnectionType(),a.instance.isUnloading){if(!e.isSdkReady(!0,!0,"Could not add progression event"))return;var A=typeof m=="number";t.addProgressionEvent(n,s,c,v,A?m:0,A,{})}else g.performTaskOnGAThread(function(){if(e.isSdkReady(!0,!0,"Could not add progression event")){var S=typeof m=="number";t.addProgressionEvent(n,s,c,v,S?m:0,S,{})}})},e.addDesignEvent=function(n,s){if(o.updateConnectionType(),a.instance.isUnloading){if(!e.isSdkReady(!0,!0,"Could not add design event"))return;var c=typeof s=="number";t.addDesignEvent(n,c?s:0,c,{})}else g.performTaskOnGAThread(function(){if(e.isSdkReady(!0,!0,"Could not add design event")){var v=typeof s=="number";t.addDesignEvent(n,v?s:0,v,{})}})},e.addErrorEvent=function(n,s){if(n===void 0&&(n=l.EGAErrorSeverity.Undefined),s===void 0&&(s=""),o.updateConnectionType(),a.instance.isUnloading){if(!e.isSdkReady(!0,!0,"Could not add error event"))return;t.addErrorEvent(n,s,{})}else g.performTaskOnGAThread(function(){e.isSdkReady(!0,!0,"Could not add error event")&&t.addErrorEvent(n,s,{})})},e.addAdEventWithNoAdReason=function(n,s,c,v,m){if(n===void 0&&(n=l.EGAAdAction.Undefined),s===void 0&&(s=l.EGAAdType.Undefined),c===void 0&&(c=""),v===void 0&&(v=""),m===void 0&&(m=l.EGAAdError.Undefined),o.updateConnectionType(),a.instance.isUnloading){if(!e.isSdkReady(!0,!0,"Could not add ad event"))return;t.addAdEvent(n,s,c,v,m,0,!1,{})}else g.performTaskOnGAThread(function(){e.isSdkReady(!0,!0,"Could not add ad event")&&t.addAdEvent(n,s,c,v,m,0,!1,{})})},e.addAdEventWithDuration=function(n,s,c,v,m){if(n===void 0&&(n=l.EGAAdAction.Undefined),s===void 0&&(s=l.EGAAdType.Undefined),c===void 0&&(c=""),v===void 0&&(v=""),m===void 0&&(m=0),o.updateConnectionType(),a.instance.isUnloading){if(!e.isSdkReady(!0,!0,"Could not add ad event"))return;t.addAdEvent(n,s,c,v,l.EGAAdError.Undefined,m,!0,{})}else g.performTaskOnGAThread(function(){e.isSdkReady(!0,!0,"Could not add ad event")&&t.addAdEvent(n,s,c,v,l.EGAAdError.Undefined,m,!0,{})})},e.addAdEvent=function(n,s,c,v){if(n===void 0&&(n=l.EGAAdAction.Undefined),s===void 0&&(s=l.EGAAdType.Undefined),c===void 0&&(c=""),v===void 0&&(v=""),o.updateConnectionType(),a.instance.isUnloading){if(!e.isSdkReady(!0,!0,"Could not add ad event"))return;t.addAdEvent(n,s,c,v,l.EGAAdError.Undefined,0,!1,{})}else g.performTaskOnGAThread(function(){e.isSdkReady(!0,!0,"Could not add ad event")&&t.addAdEvent(n,s,c,v,l.EGAAdError.Undefined,0,!1,{})})},e.setEnabledInfoLog=function(n){n===void 0&&(n=!1),g.performTaskOnGAThread(function(){n?(u.setInfoLog(n),u.i("Info logging enabled")):(u.i("Info logging disabled"),u.setInfoLog(n))})},e.setEnabledVerboseLog=function(n){n===void 0&&(n=!1),g.performTaskOnGAThread(function(){n?(u.setVerboseLog(n),u.i("Verbose logging enabled")):(u.i("Verbose logging disabled"),u.setVerboseLog(n))})},e.setEnabledManualSessionHandling=function(n){n===void 0&&(n=!1),g.performTaskOnGAThread(function(){a.setManualSessionHandling(n)})},e.setEnabledEventSubmission=function(n){n===void 0&&(n=!1),g.performTaskOnGAThread(function(){n?(a.setEnabledEventSubmission(n),u.i("Event submission enabled")):(u.i("Event submission disabled"),a.setEnabledEventSubmission(n))})},e.setCustomDimension01=function(n){n===void 0&&(n=""),g.performTaskOnGAThread(function(){f.validateDimension01(n,a.getAvailableCustomDimensions01())?a.setCustomDimension01(n):u.w("Could not set custom01 dimension value to '"+n+"'. Value not found in available custom01 dimension values")})},e.setCustomDimension02=function(n){n===void 0&&(n=""),g.performTaskOnGAThread(function(){f.validateDimension02(n,a.getAvailableCustomDimensions02())?a.setCustomDimension02(n):u.w("Could not set custom02 dimension value to '"+n+"'. Value not found in available custom02 dimension values")})},e.setCustomDimension03=function(n){n===void 0&&(n=""),g.performTaskOnGAThread(function(){f.validateDimension03(n,a.getAvailableCustomDimensions03())?a.setCustomDimension03(n):u.w("Could not set custom03 dimension value to '"+n+"'. Value not found in available custom03 dimension values")})},e.setEventProcessInterval=function(n){g.performTaskOnGAThread(function(){g.setEventProcessInterval(n)})},e.startSession=function(){if(a.isInitialized()){var n=g.createTimedBlock();n.async=!0,e.initTimedBlockId=n.id,n.block=function(){a.isEnabled()&&a.sessionIsStarted()&&g.endSessionAndStopQueue(),e.resumeSessionAndStartQueue()},g.performTimedBlockOnGAThread(n)}},e.endSession=function(){e.onStop()},e.onStop=function(){g.performTaskOnGAThread(function(){try{g.endSessionAndStopQueue()}catch(n){}})},e.onResume=function(){var n=g.createTimedBlock();n.async=!0,e.initTimedBlockId=n.id,n.block=function(){e.resumeSessionAndStartQueue()},g.performTimedBlockOnGAThread(n)},e.getRemoteConfigsValueAsString=function(n,s){return s===void 0&&(s=null),a.getConfigurationStringValue(n,s)},e.isRemoteConfigsReady=function(){return a.isRemoteConfigsReady()},e.addRemoteConfigsListener=function(n){a.addRemoteConfigsListener(n)},e.removeRemoteConfigsListener=function(n){a.removeRemoteConfigsListener(n)},e.getRemoteConfigsContentAsString=function(){return a.getRemoteConfigsContentAsString()},e.getABTestingId=function(){return a.getABTestingId()},e.getABTestingVariantId=function(){return a.getABTestingVariantId()},e.addOnBeforeUnloadListener=function(n){a.addOnBeforeUnloadListener(n)},e.removeOnBeforeUnloadListener=function(n){a.removeOnBeforeUnloadListener(n)},e.internalInitialize=function(){a.ensurePersistedStates(),p.setItem(a.getGameKey(),a.DefaultUserIdKey,a.getDefaultId()),a.setInitialized(!0),e.newSession(),a.isEnabled()&&g.ensureEventQueueIsRunning()},e.newSession=function(){u.i("Starting a new session."),a.validateAndFixCurrentDimensions(),r.instance.requestInit(a.instance.configsHash,e.startNewSessionCallback)},e.startNewSessionCallback=function(n,s){if(n!==d.Ok&&n!==d.Created||!s)n==d.Unauthorized?(u.w("Initialize SDK failed - Unauthorized"),a.instance.initAuthorized=!1):(n===d.NoResponse||n===d.RequestTimeout?u.i("Init call (session start) failed - no response. Could be offline or timeout."):n===d.BadResponse||n===d.JsonEncodeFailed||n===d.JsonDecodeFailed?u.i("Init call (session start) failed - bad response. Could be bad response from proxy or GA servers."):n!==d.BadRequest&&n!==d.UnknownResponseCode||u.i("Init call (session start) failed - bad request or unknown response."),a.instance.sdkConfig==null?a.instance.sdkConfigCached!=null?(u.i("Init call (session start) failed - using cached init values."),a.instance.sdkConfig=a.instance.sdkConfigCached):(u.i("Init call (session start) failed - using default init values."),a.instance.sdkConfig=a.instance.sdkConfigDefault):u.i("Init call (session start) failed - using cached init values."),a.instance.initAuthorized=!0);else{var c=0;if(s.server_ts){var v=s.server_ts;c=a.calculateServerTimeOffset(v)}if(s.time_offset=c,n!=d.Created){var m=a.getSdkConfig();m.configs&&(s.configs=m.configs),m.configs_hash&&(s.configs_hash=m.configs_hash),m.ab_id&&(s.ab_id=m.ab_id),m.ab_variant_id&&(s.ab_variant_id=m.ab_variant_id)}a.instance.configsHash=s.configs_hash?s.configs_hash:"",a.instance.abId=s.ab_id?s.ab_id:"",a.instance.abVariantId=s.ab_variant_id?s.ab_variant_id:"",p.setItem(a.getGameKey(),a.SdkConfigCachedKey,E.encode64(JSON.stringify(s))),a.instance.sdkConfigCached=s,a.instance.sdkConfig=s,a.instance.initAuthorized=!0}if(a.instance.clientServerTimeOffset=a.getSdkConfig().time_offset?a.getSdkConfig().time_offset:0,a.populateConfigurations(a.getSdkConfig()),!a.isEnabled())return u.w("Could not start session: SDK is disabled."),void g.stopEventQueue();g.ensureEventQueueIsRunning();var A=E.createGuid();a.instance.sessionId=A,a.instance.sessionStart=a.getClientTsAdjusted(),t.addSessionStartEvent();var S=g.getTimedBlockById(e.initTimedBlockId);S!=null&&(S.running=!1),e.initTimedBlockId=-1},e.resumeSessionAndStartQueue=function(){a.isInitialized()&&(u.i("Resuming session."),a.sessionIsStarted()||e.newSession())},e.isSdkReady=function(n,s,c){return s===void 0&&(s=!0),c===void 0&&(c=""),c&&(c+=": "),n&&!a.isInitialized()?(s&&u.w(c+"SDK is not initialized"),!1):n&&!a.isEnabled()?(s&&u.w(c+"SDK is disabled"),!1):!(n&&!a.sessionIsStarted()&&(s&&u.w(c+"Session has not started yet"),1))},e.initTimedBlockId=-1,e.methodMap={},e);function e(){}l.GameAnalytics=i}(b=b||{}),b.GameAnalytics.init();var O=b.GameAnalytics.gaCommand;R.gameanalytics=b,R.GameAnalytics=O})(this);
